# StackOverflow 问答 10153000-10153999

# regex - 使用 perl 正则表达式找到最小大小为 45 个碱基的 ORF - 为什么这个正则表达式不起作用

> ID：10153000
> 
> 赞同：1
> 
> 时间：2012-04-14T10:48:44.850
> 
> 标签：regex, perl

我正在使用 perl 和正则表达式来查找最小大小为 45 个碱基的 ORF（开放阅读框）。基本上它的意思是： 找到一个子串 一个仅由字母 ATGC（没有空格或换行符）组成的字符串：

1.  以“ATG”开头
2.  以“TAG”或“TAA”或“TGA”结尾，
3.  至少有 39 个字符长
4.  可被 3 整除

我的第一个代码是：

```
$CDSString = "ATGCACACACACACACACACACACACACACACACACACACACACACACACACACACATGA";
if($CDSString =~ m/(ATG.{45,}(TAG|TAA|TGA))/) 
{
    my $CDSCurrent = $1;
    if ((length($CDSCurrent) % 3) == 0)
    { 
        # do something
    }
} 
```

效果很好，但我认为可能有更好的方法。所以我尝试了：

```
$CDSString = "ATGCACACACACACACACACACACACACACACACACACACACACACACACACACACATGA";
if ($CDSString =~ m/ATG(...){13,}(TAG|TAA|TGA)/ )
{
    # do something
} 
```

但由于某种原因，它与上面的字符串不匹配，我不知道为什么。任何人都可以弄清楚吗？先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:33:29.100

您的正则表达式不能确保起始密码子和终止密码子之间的所有内容实际上`ATGC`仅由字母组成。你应该使用：

```
if ($CDSString =~ m/ATG(?:[ATGC]{3}){13,}(?:TAG|TAA|TGA)/i) {...} 
```

（但是你原来的正则表达式也可以工作，它不会拒绝无效的匹配。所以其他地方可能还有另一个问题。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-09T18:24:44.553

到目前为止，代码存在问题。您应该寻找的是终止密码子的第一个实例。如果您的 CDS 不好，它可能包含内部止损。内部终止密码子会产生无效的 ORF，因此您需要更巧妙的方法：

```
if($CDSString =~ m/ATG(?:[ATGC]{3}(?<!TAG|TAA|TGA)){13,}(?:TAG|TAA|TGA)/i) {...} 
```

这将返回一个没有内部终止的序列，在起始和第一个终止之间至少有 13 个密码子。

这部分代码：`(?:[ATGC]{3}(?<!TAG|TAA|TGA))`说“匹配三个不是 TAG、TAA 或 TGA 的核苷酸”。这 （？

以下是它的实际效果：

```
perl -e '$CDSString = "ATGCACACACACACACACACACACACACACACACACACACACACACACACACACACATAGTAGTAGTGA";if ($CDSString =~ m/(ATG(?:[ATGC]{3}(?<\!TAG|TAA|TGA)){13,}(TAG|TAA|TGA))/ ){print "$1\n"}'
ATGCACACACACACACACACACACACACACACACACACACACACACACACACACACATAG 
```

请注意，最后 3 个终止密码子 (TAGTAGTGA) 不会作为序列的一部分返回。

# java - GSON：应为 BEGIN_ARRAY，但为 BEGIN_OBJECT

> ID：10153002
> 
> 赞同：0
> 
> 时间：2012-04-14T10:48:49.390
> 
> 标签：java, json, gson

我对 gson 反序列化有疑问。传入的 json 看起来像这样`{"roles":{"name":"bla" "perm" : "bla"}}` ，或者当有更多可用的角色时，它看起来像这样 `{"roles":[{"name":"bla" "perm" : "bla"}{"name":"hihi" "perm" : "hihi"}]}`。所以第一次参数角色是一个对象，第二次是一个对象数组。

当我的 java 类具有字段 Role[] 角色时会出现问题；并且在 json 参数角色中只是一个对象异常被抛出“预期 BEGIN_ARRAY 但是 BEGIN_OBJECT”。

谢谢你的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:42:07.497

您可以使用自己的 TypeAdapter 来处理单实例情况，对其进行反序列化，然后转换为数组并将其设置在字段上，使其统一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T10:56:34.620

这是一个有点虚假的情况——你不能指望这个库会同时为 json 正确处理两个不同的模式。但是，当我的客户使用 GSON 来使用服务时，我遇到了类似的问题，但它们是使用 Jersey 配置的。

添加 Jackson 以及正确的配置使我的服务始终服务于一个数组，这是问题的实际解决方案。有关如何修复服务的说明，请参阅[此线程。](https://stackoverflow.com/q/2199453/1108032)

# java - 管理多个 Jlabel 的事件

> ID：10153009
> 
> 赞同：0
> 
> 时间：2012-04-14T10:50:14.793
> 
> 标签：java, events, jlabel, actionlistener, cardlayout

我有一个带有多个 Jlabels 的左面板，我将它们用作按钮来更改使用 CardLayout 布局的主面板的内容。

![在此处输入图像描述](../Images/2f8e58781f4dcf9a2ce2d7f745f7ea28.png)

我不能完美地处理这些事件：

```
mouseEntered : to make highlight effect to the jlabel 
mouseExited  : to take off the highlight effect.
mouseClicked : to change the content of the main Panel and start some threads 
```

这里找不到事件或方法的问题告诉我已单击另一个 Jlabel，因此我可以停止在 mouseClicked 事件中启动的线程，

**或者**

一个事件或方法告诉我 CardLayout 中的 JPanel 已显示或隐藏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T11:24:25.843

您的问题是找不到合适的事件。我认为您正在使用可视化 GUI 构建器执行此操作，并希望解决所有开箱即用的问题。它不会那样工作，你需要编写一些真正的代码。例如，编写一个方法，您将从三个 JLabel 中的每一个的鼠标单击侦听器中调用该方法。因此，您将安排为每次 JLabel 单击调用此方法。然后在方法中做相应的处理。这只是一个粗略的大纲，您没有提供太多细节来提供任何进一步的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T11:34:41.723

听起来您需要`FocusEvents`和`FocusListeners`。这些都支持所有`JComponents`喜欢`JPanel`, `JLabel`, 和`JButton`, 例如通过调用`addFocusListener();`

基本上 a`FocusListener`可以告诉您何时`JComponent`获得焦点（例如通过单击`JComponent`）以及何时失去焦点（例如通过单击不同的`JComponent`）。

有关详细信息，请参阅[http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/event/FocusListener.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/event/FocusListener.html)

# facebook-javascript-sdk - Facebook Javascript - 高分 API - 找到分数但无法返回

> ID：10153015
> 
> 赞同：0
> 
> 时间：2012-04-14T10:51:04.957
> 
> 标签：facebook-javascript-sdk

我正在经历一个非常奇怪的问题。我希望通过 FB api 登录 facebook 时登录用户的高分。我正在使用以下代码

```
 function returnhighscore()
    {
        FB.api("/"+FB.getUserID()+"/scores", 'get', {}, function(response) { 
          if (!response || response.error) {
            alert('Error occured');
          } else {
            var high_score1 = response.data[0].score;
            //document.getElementById("fbtestVal").innerHTML = response.data[0].score;
            return(high_score1);

          }
        }); 
    } 
```

FB加载后，我调用这个函数。奇怪的是，这个没有返回任何东西，但是当我警告或控制台记录回调中的值时，它会显示我的分数。

任何人都可以帮忙吗？

雅各布

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T16:48:54.580

回调函数不应该返回值。相反，它们应该处理给它们的任何参数，并可能与更高范围的变量交互。

在您的情况下，我认为您可以在 returnhighscore 函数的范围内声明一个变量，然后进行 FB.api 调用，在回调函数中更新此变量的值，最后返回该变量（再次在您的函数范围内） ：

```
function returnhighscore()
{
    //declare variable in function scope
    var highscore = null;

    //call facebook api
    FB.api("/"+FB.getUserID()+"/scores", 'get', {}, function(response) { 
      if (!response || response.error) {
        alert('Error occured');
      } else {
        var high_score1 = response.data[0].score;
        //document.getElementById("fbtestVal").innerHTML = response.data[0].score;

        //update value of function scope variable
        highscore = high_score1;
      }
    });

    //return updated value
    return highscore;
} 
```

# html - 激活CKEditor时如何在HTML5 textarea中显示占位符属性？

> ID：10153018
> 
> 赞同：3
> 
> 时间：2012-04-14T10:51:55.940
> 
> 标签：html, textarea, ckeditor, placeholder

我在 HTML5 网站中有一个带有适当 placeholder="Sample text" 属性的文本区域。在我通过 CKEditor 添加 RichText 支持之前，它显示得很好。CKEditor GUI 正在重新创建文本区域，并且没有在其中显示占位符文本。有没有办法在 CKEditor 中显示占位符或切换一些配置选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T20:52:31.217

您可以使用新版本的 configHelper 插件：[http](http://alfonsoml.blogspot.com.es/2012/04/placeholder-text-in-ckeditor.html) ://alfonsoml.blogspot.com.es/2012/04/placeholder-text-in-ckeditor.html它将自动使用您的 textarea 的占位符属性

# firefox - 如何在使用 Firefox Add-On SDK 选择文本后运行 JavaScript 代码？

> ID：10153021
> 
> 赞同：0
> 
> 时间：2012-04-14T10:52:06.050
> 
> 标签：firefox, firefox-addon, firefox-addon-sdk

我正在尝试使用在线插件 SDK 创建一个 Firefox 插件。

我想要做的是在我选择文本时运行一段 JavaScript 代码，即，一旦文本的选择完成，我的代码就应该运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T21:23:21.700

我认为您正在寻找该`selection`模块。在你的插件中尝试这样的事情：

```
var selection = require("selection");
selection.on('select', 
             function() {
               // run your code here with selection.text
               console.log(selection.text);
             }); 
```

在您进行文本选择后，应调用上述内容，然后您可以使用`selection.text`参考对其进行处理。

在此处查看文档中的更多信息： [https ://addons.mozilla.org/en-US/developers/docs/sdk/1.7/packages/addon-kit/selection.html](https://addons.mozilla.org/en-US/developers/docs/sdk/1.7/packages/addon-kit/selection.html)

# linux - 压缩文件和目录

> ID：10153024
> 
> 赞同：0
> 
> 时间：2012-04-14T10:52:28.833
> 
> 标签：linux, compression, gzip, tar

我需要压缩某些文件和一个目录。假设它们被放置在 /root/project 中。问题是我需要以具有特定名称（name.tar.gz）和“根”目录的gzip-tarball格式压缩它们，我的意思是，只要我打开.tar.gz所有文件和我要压缩的目录在那里。

我尝试使用以下命令：

```
tar czfv name.tar.gz /root/project
tar czfv name.tar.gz /root/project/* 
```

但随后整个子结构被压缩（我的意思是，当我打开 .tar.gz 时，我必须浏览目录根 / 项目 .. 我不需要，我需要文件在我在“/”中打开时立即我想）

我希望我已经解释了自己......对不起我的英语不好，提前谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T14:42:33.183

如果您使用的是 GNU tar，则可以使用以下命令：

`tar -C /root/project -zcvf /root/name.tar.gz .`

导致 tar在将目录添加到存档之前`-C`更改为该目录。确保存档的目标目录不在您要存档的目录 (/root/project) 中。此示例在 /root 中创建存档。`/root/project``.`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T10:58:32.530

如果您希望 tarball 中的文件名都有一个`project/`前缀（这通常是可取的），请执行

```
(cd /root && tar czvf `pwd`/name.tar.gz project) 
```

如果您根本不想要前缀，请执行

```
(cd /root/project && tar czvf `pwd`/name.tar.gz .) 
```

（在执行`pwd`之前捕获当前工作目录`cd`；括号在子shell中执行命令，因此您当前的shell保持在同一目录中。）

# android - 视图相互重叠

> ID：10153026
> 
> 赞同：0
> 
> 时间：2012-04-14T10:53:11.250
> 
> 标签：android, android-layout, android-fragments, android-view, android-tablelayout

我有一个活动，其中我的视图（表格和标题表）重叠

```
private ViewGroup createTable(ViewGroup root) {
    // TODO Auto-generated method stub
    TableLayout table = new TableLayout(getActivity());
    table.setStretchAllColumns(true);
    table.setShrinkAllColumns(true);

    TableLayout headertable = new TableLayout(getActivity());
    headertable.setStretchAllColumns(true);
    headertable.setShrinkAllColumns(true);

    /* Adding stuff to headertable which contains...  */
            /* ...table content I DO NOT WANT to scroll*/

    root.addView(headertable);

    for (int i = -2; i <= 100; i++) {

                    if (i > 0) {
            /*Set up empty views*/
                /*...3 empty views will be set*/
                    }

        /* Adding stuff to table which contains...  */
                    /* ...table content I WANT to scroll*/

    }

    ScrollView sv = new ScrollView(getActivity());
    sv.addView(table);
    root.addView(sv);
    return root;
} 
```

我基本上把一张桌子分成了标题表和表格。我想滚动表格但不是标题表。但是，我的表（应该在标题表下方）与它重叠。因此，正如您在上面看到的，我添加了空视图（因此它从 headertable （有三行）下方开始），但意识到这不起作用。一旦我向下滚动，空视图就会向上滑动，并且我的标题表再次被阻塞。

我所有的观点都是以编程方式提出的。这个活动是一个片段活动。XML 文件包含

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="#ffffff" >

</FrameLayout> 
```

任何帮助，将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T14:03:25.280

我不知道这是否是最好的方法，但我是这样做的：

**主要的.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
<FrameLayout
    android:id="@+id/pane"
    android:layout_width="match_parent"
    android:layout_height="match_parent" />
</LinearLayout> 
```

**header_list.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
    <TextView
            android:id="@+id/header"
            android:layout_width="fill_parent"
            android:layout_height="30dp"
            android:layout_alignParentTop="true" />
    <ListView
            android:id="@id/android:list"
            android:layout_width="match_parent"
            android:layout_height="0dp"
            android:layout_below="@id/header" />
    <TextView
            android:id="@android:id/empty"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_below="@id/header"
            android:gravity="center" />
</RelativeLayout> 
```

**RecipeListFragment.java**

```
public class RecipeListFragment extends ListFragment {
    private TextView header;
    private TextView empty;
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
        View v = inflater.inflate(R.layout.common_list, container, false);
        header = (TextView) v.findViewById(R.id.header);
        empty = (TextView) v.findViewById(android.R.id.empty);
        header.setText(R.string.header_recipe);
        empty.setText(R.string.empty_recipes);
        return v;
    }
    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        // List code here
    }
} 
```

这段代码只有一个标题行，但您可以将该 TextView 更改为 TableLayout，然后以相同的方式填充它，为您提供标题表并将列表放在它下面，这样它就不会滚动到它的顶部。

希望这可以帮助！

# ruby-on-rails-3 - validates_inclusion_of Rails 3 查询未按预期工作

> ID：10153027
> 
> 赞同：3
> 
> 时间：2012-04-14T10:53:18.803
> 
> 标签：ruby-on-rails-3, validation, activerecord, client-side-validation

我对 Rails 很陌生，我正面临一个问题。我有

楷模

```
Model1
id: integer
account_id: integer

Account
id: integer 
```

我在 Model1 中进行了如下验证，

型号代码：

```
validates :account_id, :inclusion => { :in => Account.find(:all).collect(&:id)} 
```

我使用查看代码的下拉列表：

```
<%= f.select :account_id, @accounts.collect {|acc| [acc.name, acc.id]}, {:prompt => 'Select Account' }, { :selected => @defaultaccount, :class => 'selectwidth' } %> 
```

我在提交表单之前使用客户端验证来验证字段。我正在使用 Heroku 来部署我的应用程序。

我先创建一个帐户，然后从表单中尝试创建一个新模型1。下拉列表中填充了我拥有的所有帐户。然后我从下拉列表中选择一个我创建的帐户，客户端验证生效并显示“无效”，这是 validates_inclusion_of 的错误消息，就好像该帐户不存在一样。不确定发生了什么，我检查了数据库并创建了帐户，这就是下拉列表首先加载帐户的原因。

我将 validates_inclusion_of 更改为 rails 3 validates :account_id, :inclusion => { :in => {} } 语法并重新部署。现在我尝试在新的 model1 表单中选择该帐户，下拉菜单不会显示先前创建的帐户的错误。

然后我创建了一个新帐户并尝试为新帐户创建一个新模型1，验证失败再次出现。

所以它就像一个缓存问题？这是客户端验证问题吗？我尽我所能尝试找出问题所在，但我对正在发生的事情一无所知。

所以每次我创建一个帐户时，它都希望我重新部署它会杀死应用程序的功能。我该如何摆脱这个问题？不太确定发生了什么。

在 Heroku 中部署的 Config、Rails 3 使用资产管道

Gems：客户端验证 Kaminari

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T10:58:20.483

目前，一旦服务器启动，该语句就会被执行（正如您正确意识到的那样）。您需要将其包装在 lambda 中，因此每次验证完成时都会执行它。

1.8.7 语法：

```
validates :account_id, :inclusion => { :in => lambda {Account.find(:all).collect(&:id)}} 
```

1.9.2 语法：

```
validates :account_id, :inclusion => { :in => ->{Account.find(:all).collect(&:id)]} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T10:58:21.713

它没有按您的意愿工作，因为 `:in => Account.find(:all).collect(&:id)`它在生产模式下只评估一次，当 Rails 加载类时。我承认我不明白这种验证背后的原因。无论如何，如果你真的想实现这一点，你必须使用[自定义验证器。](http://guides.rubyonrails.org/active_record_validations_callbacks.html#performing-custom-validations)

# image - PhotoPaint 的“减法”叠加模式背后的算法？

> ID：10153036
> 
> 赞同：0
> 
> 时间：2012-04-14T10:54:04.160
> 
> 标签：image, image-processing

在 Corel PhotoPaint 中，当您使用“减去”模式而不是“正常”模式叠加两个图像时，您将在顶部图像的较暗区域中获得更饱和、更“整洁”的颜色。有谁知道这种叠加方法背后的算法是什么？例如，我正在考虑在 Objective-C 和 PHP 中模拟它。

为了比较，我创建了一个模糊的黑色中心圆的叠加图像，在顶部使用普通叠加模式，在底部使用减法模式。正常模式将导致产生的较暗区域看起来更加灰色。

![普通的](../Images/3f61adeac0283896bf14741e50f31fbc.png) 普通的

![减去](../Images/81a2b79f686d13cb7aced0714a7b842c.png)减去

将此 CPT 文件导出为 PSD 并在 Photoshop 中打开，减去模式不可用并且丢失了，所以我什至不确定它在 Photoshop 中的名称。

谢谢你的帮助！（原图 CC 授权[iPyo](http://www.flickr.com/photos/ipyo/4948872706/)。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:03:59.420

组合两个图像时，您将有不同的选择。这种组合的一般算法是

```
for each pixel in resultImage
   resultImage[pixel] = sourceA[pixel] OP sourceB[pixel] 
```

好吧，然后你选择OP。在您的问题中，这是一个“-”（减法）。但也可以是+、*、/、MOD、DIV等。

通常，您还需要执行某种范围检查，以便结果图像的像素强度不会溢出或下溢。但是，那么您也可能想要故意做这样的事情。

# ruby-on-rails - 停止设计清除会话

> ID：10153040
> 
> 赞同：22
> 
> 时间：2012-04-14T10:54:16.037
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise

似乎当用户通过标准的 Devise 控制器注销时，Devise 会破坏整个会话存储，而不仅仅是它自己的数据。有什么办法可以避免这种行为？我还有其他不相关的数据应该保留。

```
session[:my_var] = "123" 
```

通过设备注销...

```
puts session[:my_var]
# => nil 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-09-26T09:54:03.903

在设计的最新版本中，不需要覆盖会话控制器，而是您可以使用：

```
config.sign_out_all_scopes = false 
```

在`devise.rb`文件中获得所需的行为。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-04-14T20:17:19.973

`destroy`¹ 方法包含以下`SessionsController`行：

```
signed_out = Devise.sign_out_all_scopes ? sign_out : sign_out(resource_name) 
```

`sign_out_all_scopes`² 方法调用`warden.logout`不带任何参数，而³`sign_out`方法调用`warden.logout(scope)`.

`logout`⁴ 方法的文档说明：

> ```
> # Logout everyone and clear the session
> env['warden'].logout
> 
> # Logout the default user but leave the rest of the session alone
> env['warden'].logout(:default) 
> ```

结论：`sign_out`在给定特定范围时应保留会话。但是，我没有看到任何方法可以做到这一点。*总是*`sign_out_all_scopes`首先被调用，并且只有在它无法注销任何用户时才会返回。*`false`*

 *我建议要么在他们的问题跟踪器上[发布功能请求](https://github.com/plataformatec/devise/issues/new)，要么开发自己的身份验证解决方案。Rails 现在提供了[`has_secure_password`](http://api.rubyonrails.org/classes/ActiveModel/SecurePassword/ClassMethods.html#method-i-has_secure_password)，而现在人们似乎倾向于后者以避免遇到这些问题。

* * *

¹[`Devise::SessionsController#destroy`](https://github.com/plataformatec/devise/blob/master/app/controllers/devise/sessions_controller.rb#L20)

²[`Devise::Controllers::Helpers#sign_out_all_scopes`](https://github.com/plataformatec/devise/blob/master/lib/devise/controllers/helpers.rb#L149)

³[`Devise::Controllers::Helpers#sign_out`](https://github.com/plataformatec/devise/blob/master/lib/devise/controllers/helpers.rb#L137)

⁴[`Warden::Proxy#logout`](https://github.com/hassox/warden/blob/master/lib/warden/proxy.rb#L218)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-05-11T14:14:09.513

您可以重写 Devise 的 SessionController，就像我为保留购物车所做的那样：

**session_controller.rb**

```
class SessionsController < Devise::SessionsController

    def destroy
        order_id = session[:order_id] 
        super  
        session[:order_id] = order_id
    end

end 
```

**路线.rb**

```
devise_for :users, :controllers => { :sessions => "sessions" } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-03T08:18:25.787

除了马修斯。该声明

```
signed_out = (Devise.sign_out_all_scopes ? sign_out : sign_out(resource_name)) 
```

考虑到以多个角色登录的可能性，这可能是最好的一般注销语句。对于您而言，如果您的用户仅作为一个角色登录，并且您希望在退出时保留会话的其余部分，最简单的方法是：

```
$ git clone git://github.com/plataformatec/devise.git
$ cd devise
$ git branch my_devise
$ git checkout my_devise 
```

在编辑器中打开 app/controllers/devise/sessions_controller.rb。在销毁方法中，替换

```
signed_out = (Devise.sign_out_all_scopes ? sign_out : sign_out(resource_name)) 
```

和

```
signed_out = sign_out(resource_name) 
```

保存并退出编辑器并执行

```
$ git commit -am "remove only warden data from session on logout, preserve other data." 
```

在项目的 Gemfile 中，描述要设计的依赖项

```
gem 'devise', :path => "[YOUR PATH]/devise", :branch => "my_devise" 
```*

# java - 将jar文件转换为exe

> ID：10153041
> 
> 赞同：0
> 
> 时间：2012-04-14T10:54:18.013
> 
> 标签：java, windows, jar, exe

> **可能重复：**
> [如何将我的 Java 程序转换为 .exe 文件？](https://stackoverflow.com/questions/147181/how-can-i-convert-my-java-program-to-an-exe-file)

有没有免费的工具可以将jar转换成exe？？我搜索但找不到有效的软件都只提供试用版！

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T11:00:20.367

虽然我从未将 jar 转换为 exe，但在搜索该术语时，我发现了以下免费实用程序：

JSmooth .exe 包装器 JSmooth 是一个 Java 可执行包装器。它为您的 Java 应用程序创建本机 Windows 启动器（标准 .exe）。下载：http: [//jsmooth.sourceforge.net/](http://jsmooth.sourceforge.net/)

来源：http: [//viralpatel.net/blogs/2009/02/convert-jar-to-exe-executable-jar-file-to-exe-converting.html](http://viralpatel.net/blogs/2009/02/convert-jar-to-exe-executable-jar-file-to-exe-converting.html)

# c# - SQL 报告中的数字格式（本地、rdlc）

> ID：10153043
> 
> 赞同：0
> 
> 时间：2012-04-14T10:55:02.247
> 
> 标签：c#, .net, rdlc, reporting-services

只有在使用这些小数位时，我才要求在客户端报告中显示带有小数位的数值。源数据是从 SQL 货币列填充的 Decimal 数据类型。

例如：

*   28.0000 将显示为“28”
*   2.5000 将显示为“2.5”
*   2.5500 将显示为“2.55”

我找不到执行此操作的格式选项。我在“#,###.####”中得到的最接近的值，但即使后面没有任何内容，它仍然显示小数点。

请提出建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:15:56.997

假设您的数据字段是 UnitPrice，那么您可以对文本框的格式应用表达式（*右键单击 ===> 文本框属性 => 数字 => 自定义 => 按 fx*）显示字段的值像这个。

```
=IIF( Floor(Fields!UnitPrice.Value) = Fields!UnitPrice.Value,"#,0;(#,0)",
IIF(Floor(Fields!UnitPrice.Value * 10) = Fields!UnitPrice.Value * 10,"#,0.0;(#,0.0)","#,0.00;(#,0.00)")
) 
```

希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-21T12:05:30.550

Lets take an example as Amount is your field

In the expression screen just add this following line.

```
Format(CDec(Fields!Amount.Value),"#.##") 
```

# makefile - 跨不同目录为源文件编写makefile

> ID：10153044
> 
> 赞同：2
> 
> 时间：2012-04-14T10:55:07.677
> 
> 标签：makefile

当我的源代码文件位于不同的目录时，我一直在编写 Makefile。

目录结构如下：

我的源文件 (.cc) 在文件夹 FOLDER1 和 FOLDER2 中，头文件位于名为 INCLUDE 的文件夹中。我的 makefile 存在于 FOLDER1 中。

```
 program_NAME := myprogram
       program_C_SRCS := $(wildcard *.cc)
       program_C_OBJS := ${program_C_SRCS:.cc=.o}
       program_OBJS := $(program_C_OBJS) 
       program_INCLUDE_DIRS := ../INCLUDE
       program_LIBRARY_DIRS := 
       program_LIBRARIES :=
       CPPFLAGS += $(foreach includedir,$(program_INCLUDE_DIRS),-I$(includedir))
       LDFLAGS += $(foreach librarydir,$(program_LIBRARY_DIRS),-L$(librarydir))
       LDFLAGS += $(foreach library,$(program_LIBRARIES),-l$(library))

       .PHONY: all clean distclean

       all: $(program_NAME)

       $(program_NAME): $(program_OBJS)
       $(LINK.cc) $(program_OBJS) -o $(program_NAME)

       clean:
           @- $(RM) $(program_NAME)
           @- $(RM) $(program_OBJS)

       distclean: clean 
```

在这里，如果我将所有源 (.cc) 文件保存在 FOLDER1 中，那么它可以工作，但是在将一些文件移动到 FOLDER2 时，它会给出未定义引用的错误。

请帮助我了解如何修改我的 makefile，以便我可以将所有头文件保存在一个目录中，比如 INCLUDE，并将我的源文件分布在不同的目录中。

谢谢 ！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T11:17:53.450

问题是，那

```
program_C_SRCS := $(wildcard *.cc) 
```

仅在同一目录中添加源文件。因此，在链接时，您没有第二个文件夹的目标文件。您可能可以通过简单地将其他文件夹的源文件添加到您的 program_C_SRCS 来解决问题：

```
program_C_SRCS += $(wildcard ../FOLDER2/*.cc) 
```

**包括目录**

我猜你正在使用 gcc/g++，在这种情况下[http://gcc.gnu.org/onlinedocs/cpp/Search-Path.html](http://gcc.gnu.org/onlinedocs/cpp/Search-Path.html)说，标题路径是从左到右搜索的，这意味着给出的第一个路径是首先搜索。因此，您只需在 -I INCLUDE1 选项之前添加 -I INCLUDE2 即可实现您想要的。您的起始 makefile 已经对多个包含路径进行了一些转换：

```
 CPPFLAGS += $(foreach includedir,$(program_INCLUDE_DIRS),-I$(includedir)) 
```

所以你只需要重写你的包含路径：

```
program_INCLUDE_DIRS := ../INCLUDE2
program_INCLUDE_DIRS += ../INCLUDE1 
```

# php - 检查两个表PHP PDO上是否存在用户名？

> ID：10153045
> 
> 赞同：1
> 
> 时间：2012-04-14T10:55:23.133
> 
> 标签：php, pdo, mysqli, multi-query

我有一个**users**表和一个**users_banlist**表。

在我的注册表单上，我想在一个查询中检查某人在表单上输入的用户名是否存在于 users 表中，并查看它是否也存在于 users_banlist 表中。

我可以在单独的查询中自己完成它们，但宁愿一次性完成。

这是我得到的，但即使我输入了一个已被占用的用户名，它也不会告诉我它已经被占用了。

```
$stmt = $dbh->prepare("
SELECT
  users.user_login,
  users_banlist.user_banlist
FROM
  users ,
  users_banlist
WHERE
  users.user_login = ? OR
  users_banlist.user_banlist = ?");

// checker if username exists in users table or users_banlist table
$stmt->execute(array($username, $username));

if ( $stmt->rowCount() > 0 ) {
    $error[] = 'Username already taken';
} 
```

基本上我认为这与执行或rowCount（）有关，谁能告诉我哪里出错了？作为 pdo 的新手，我现在发现它有点令人困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:24:10.203

改用 SQL JOINS

```
SELECT
  users.user_login,
  users_banlist.user_banlist
FROM
  users INNER JOIN
  users_banlist ON users.ID=users_banlist.user_id
WHERE
  users.user_login = ? OR
  users_banlist.user_banlist = ? 
```

其中 users.ID 和 users_banlist.user_id 相同

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T11:04:20.350

您可以使用查询

```
SELECT
  users.user_login
FROM
 users 
WHERE
  users.user_login = ? 
UNION ALL
SELECT
  users_banlist.user_banlist
FROM
  users_banlist
WHERE
  users_banlist.user_banlist = ? 
```

然后正常进行。您使用的是 CROSS JOIN，它返回生成行的笛卡尔积，这些行将第一个表中的每一行与第二个表中的每一行组合起来。如果其中一个表返回 0 行，您将获得 0 个结果

# c++ - 在文件后添加新选项卡 -> 新建

> ID：10153048
> 
> 赞同：0
> 
> 时间：2012-04-14T10:55:58.013
> 
> 标签：c++, qt

我正在用 Qt 和 C++ 编写一个简单的编辑器。我想要标签，所以在创建新文档后，我想在新标签中打开它。我的代码：

```
// mainwindow.cpp

#include "mainwindow.h"
#include "ui_mainwindow.h"

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
    setWindowTitle("emacs");
}

MainWindow::~MainWindow()
{
    delete ui;
}

void MainWindow::on_actionExit_triggered()
{
    qApp->exit(0);
}

void MainWindow::on_actionNew_triggered()
{
    // what to write here?
}

// main.cpp

#include <QtGui/QApplication>
#include "mainwindow.h"

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    MainWindow w;
    w.show();

    return a.exec();
}

// mainwindow.h

#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include <QMainWindow>

namespace Ui {
    class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();

private slots:
    void on_actionExit_triggered();
    void on_actionNew_triggered();

private:
    Ui::MainWindow *ui;
};

#endif // MAINWINDOW_H 
```

我已经成功地创建了一个退出程序的动作。但是当我尝试这样的事情时：`tabWidget->addTab(new QWidget(),"new tab");`是抱怨 tabWidget 没有在范围内声明。有人吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T10:59:25.283

`tabWidget`不是您`MainWindow`班级的成员，我猜它是您在`ui`文件中定义的对象，因此请尝试：

```
ui->tabWidget->addTab(...); 
```

# bash - 如何在 CSV 文件的末尾添加额外的分隔符，发现某些分隔符丢失？

> ID：10153057
> 
> 赞同：4
> 
> 时间：2012-04-14T10:57:32.700
> 
> 标签：bash, csv, awk

我有一个格式如下的 CSV 文件：

```
A @ B @ C @ D @ E 
```

它应该有五列，不幸的是，有些缺少最后一列，例如：

```
A @ B @ C @ D 
```

如何`@`在缺少最后一列的每一行末尾添加额外内容？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-14T14:01:41.317

假设空格是字段内容的一部分，并且分隔符是单独的“@”（尽管可以很容易地适应其他变体）：

```
awk 'BEGIN {FS = OFS = "@"} {$5 = $5; print}' inputfile 
```

AWK 创建缺少的中间字段。如果字段已存在，则将字段值设置为自身会保留现有内容，或者将其和任何介入的已创建字段设置为空字符串。

```
$ cat inputfile
A @ B @ C @ D @ E
A @ B @ C @ D
A @ B @ C
$ awk 'BEGIN {FS = OFS = "@"} {$5 = $5; print}' inputfile
A @ B @ C @ D @ E
A @ B @ C @ D @
A @ B @ C @@ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T12:29:09.630

这可能对您有用：

```
sed 's/@/&/4;t;s/\s*$/ @/' file 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T14:05:12.087

未经测试，但类似：

```
perl -lpe '$n = tr/@/@/; $_ .= "@" x (4-$n)' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T11:10:31.617

像这样的东西可以工作：

```
cat foo.csv | sed -E "s/([^\@]+\@){3}([^\@]+)/&@/" | sed -E "s/\@\@/\@/" 
```

这会读取 foo.csv 文件，然后在第四列之后添加一个 @，然后删除已经有一个的行上的重复项。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-14T11:18:44.840

如果您可以使用 Python，这里有一个稍微聪明的解决方案，可以根据需要添加尽可能多的 @：

```
from sys import *

for line in stdin.readlines():
    stdout.write(line.strip())
    if (line.count('@') < int(argv[1])):
        stdout.write(' @' * (int(argv[1]) - line.count('@')))
    stdout.write('\n') 
```

像这样称呼它：`cat foo.csv | python fixcsv.py 4`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-14T11:22:46.180

```
awk -F'@' '{printf $0; if (NF == 4) {print "@"}}' 
```

注意：输入`A @ B @ C @ D`将导致输出`A @ B @ C @ D@`。我故意将第 4 个值保持不变，但您当然可以选择添加一个额外的空间

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-14T12:28:34.247

假设您的字段不能包含@，并且您只希望在恰好有 4 个字段时发生替换，这应该是一个有效的 sed 解决方案：

```
$ sed -r 's/^([^@]*[[:space:]]@){3}[^@]+$/& @/' <<EOF
> A @ B @ C @ D @ E
> A @ B @ C @ D
> EOF
A @ B @ C @ D @ E
A @ B @ C @ D @ 
```

请注意，`sed -r`假设 GNU sed。

替换为与文件一起使用的不同重定向。

# matlab - 在 Matlab 中使用“标签分组”绘制时间序列

> ID：10153059
> 
> 赞同：2
> 
> 时间：2012-04-14T10:57:37.693
> 
> 标签：matlab, plot, timestamp, time-series, datestamp

在 Matlab 中，我有以下形式的数据：

*   “z”，一个 17'256x1 双精度，包含回归的残差，例如 -0.0596
*   “日期”，一个 17'256x1 的单元格，包含回归中每个观测值（以及残差）的日期和时间戳，例如 '10/3/2011 9:30:00 PM'

我想做的事：将**残差**与日期**戳**绘制为标签。观察结果不是来自连续的几天序列（即，可能有一些间隔，几天之间没有观察结果），并且有些日子的观察结果比其他日子多。每次观察我不能有一个标签，因为那将是太多标签。所以我需要以某种方式对它们进行分组，按天或按月。即在当天的所有观测值下仅显示月份和日期（例如 10/3），或者在该月的所有观测值下仅显示月份（例如 3）。使用我拥有的数据，我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T11:57:11.233

您应该能够在没有“分组”的情况下绘制它。如果您将日期转换为时间戳：

```
timestamps = cellfun(@(date)datenum(date), dates); 
```

然后你可以做一个正常的情节：

```
plot(timestamps, z); 
```

Matlab 将处理 xaxis 标签本身（即，它将它们均匀地分布在日期的时间范围内），但它们将是时间戳数字。要在 xaxis 上获取格式化日期，请使用：

```
datetick('x'); 
```

# jquery - jqgrid 固定列标题和固定页脚

> ID：10153062
> 
> 赞同：3
> 
> 时间：2012-04-14T10:58:01.217
> 
> 标签：jquery, jqgrid

我正在寻找修复 jqgrid 列标题和固定页脚。当有其他项目以及带有数据的 jqgrid 时，我正在寻找修复标题，以便用户始终知道他在看什么。

[这是我正在寻找的样本](http://cross-browser.com/x/examples/xthf-demo.php)

请注意，这里我正在查看浏览器滚动条。jqgrid 支持这个吗？

**编辑**

因为 JQGrid 毕竟是 html 表格，所以我尝试使用[jQuery TH Float Plugin](http://rommelsantor.com/jquery/thfloat/)。现在事实证明，JqGrid 由三个表组成，一个用于页眉，一个用于数据，另一个用于页脚。所以看来我要么必须修改 thfloat 以适应这一点，要么想出别的东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T14:19:10.233

这是一个难以破解的难题。

我让它通过 First css 覆盖默认值溢出：隐藏到

```
.ui-jqgrid .ui-jqgrid-sdiv{overflow:visible;}
.ui-jqgrid .ui-jqgrid-hdiv{overflow:visible;} 
```

在 javascript JQuery 来救我我实现了以下

```
function screenBottom() {
    return $(window).scrollTop() + $(window).height();
}     
$(window).scroll(function () {
        var dataTableTop = dataTable.offset().top;
        var dataTableHeight = dataTableTop + dataTable.outerHeight();
        var windowTop = $(window).scrollTop();
        var windowBottom = screenBottom();
        //Scroll down         
        if (windowTop > dataTableTop - headerTable.height()
                && windowTop < (dataTableHeight - headerTable.height())) {
            headerTable.offset({ top: windowTop, left: headerTable.offset().left });
        }
        //For footer
        if (windowBottom > dataTable.offset().top + footerTable.outerHeight()
                && windowBottom < dataTableHeight + footerTable.outerHeight()) {
            footerTable.offset({ top: windowBottom - footerTable.outerHeight(), left: footerTable.offset().left });
        }
        //Re adjust of the movement is too fast
        if (windowTop < (dataTableTop - headerTable.height())
            && dataTableTop < (headerTable.offset().top + headerTable.height())) {
            headerTable.offset({ top: dataTable.offset().top - headerTable.height(), left: headerTable.offset().left });
        }
        if (windowBottom > dataTableHeight + footerTable.outerHeight()) {
            footerTable.offset({ top: dataTableHeight, left: footerTable.offset().left });
        }

    }); 
```

然后在调整窗口大小时检查页脚和页眉

```
 $(window).resize(function () {
            setInitializeHeadersAndFootersPosition();
        });
function setInitializeHeadersAndFootersPosition() {
            var dataTableTop = dataTable.offset().top;
            var dataTableHeight = dataTableTop + dataTable.outerHeight();
            var windowTop = $(window).scrollTop();
            var windowBottom = screenBottom();
            if (windowBottom > dataTableTop && windowBottom < dataTableHeight) {
                footerTable.offset({ top: windowBottom - footerTable.outerHeight(), left: footerTable.offset().left });
            }
            if (footerTable.offset().top < dataTableHeight && windowBottom > dataTableHeight) {
                footerTable.offset({ top: dataTableHeight, left: footerTable.offset().left });
            }
            if (windowTop > dataTableTop && windowTop < dataTableHeight) {
                headerTable.offset({ top: windowTop, left: headerTable.offset().left }); //Header does not need the offset
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-02T23:17:39.803

Sarath，多么棒的解决方案，对我帮助很大。我已经扩展了您的工作，因此当它第一次从页面滚动/重新定位时，标题只会“反弹”一次。之后位置切换到固定，但是还有很多其他元素需要补偿。享受！

```
$(window).bind('scroll', function () {
    var _grid = $('#jqGrid');  // jqgrid name
    var dataTable = $(_grid[0].grid.bDiv);
    var headerTable = $(_grid[0].grid.hDiv);
    var dataTableTop = dataTable.offset().top;
    var dataTableHeight = dataTableTop + dataTable.outerHeight();
    var windowTop = $(window).scrollTop();
    var headerTablePosition = headerTable[0].style.position;

    //Scroll down         
    if (windowTop > dataTableTop - headerTable.height() && windowTop < (dataTableHeight - headerTable.height()) && headerTablePosition != "fixed")
    {
        var leftOffset = headerTable.offset().left + 'px';  // grab the offset before changing postition
        $(dataTable).css("top", (headerTable.height()+1) + "px");  // +1 to account for the border width of the header
        headerTable[0].style.position = "fixed";
        headerTable[0].style.top = "0px";
        headerTable[0].style.left = leftOffset;
        dataTable[0].style.height = "auto";
        $($(_grid[0].grid.sDiv)).css("top", (headerTable.height() + 1) + "px");  // footer table, +1 to account for the border width of the header
        var gridHeightString = $('#gview_jqGrid').css("height").replace("px", "");
        var newGridHeight = parseInt(gridHeightString) + headerTable.height() + 1;  // +1 to account for the border width of the header
        $("#gview_jqGrid").css("height", newGridHeight + "px"); //outermost grid element
    }
    //Scroll up
    else if (windowTop < (dataTableTop - headerTable.height()) && headerTablePosition == "fixed") 
    {
        headerTable[0].style.left = "0px";
        headerTable[0].style.position = "relative";
        $(dataTable).css("top", "0px");  
        $($(_grid[0].grid.sDiv)).css("top", "0px");  // footer table
        $("#gview_jqGrid").css("height", "100%");  //outermost grid element
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-18T16:22:35.443

我想我会提到如何填充缺失的变量。

```
//grid = $("#yourGrid").jqGrid( ...

dataTable = $(grid[0].grid.bDiv);
footerTable = $(grid[0].grid.sDiv);
headerTable = $(grid[0].grid.hDiv);
//my header column was behind the grid
headerTable.css('z-index', '1000');
setInitializeHeadersAndFootersPosition(); 
```

# java - 更改用作 Map 键的对象

> ID：10153063
> 
> 赞同：3
> 
> 时间：2012-04-14T10:58:01.857
> 
> 标签：java, map

假设 V 是一个具有名为 K 的单个属性及其 getter 和 setter 的类。

如果我这样做会发生什么：

```
V v = new V();
v.setK("a");
HashMap<K,V> map = new HashMap<K,V>();
map.put(v.getk(),v);
v.setK("b"); 
```

据我所知，这应该会导致某种问题，因为映射键应该是不变的。这里会发生什么？

编辑：考虑键不是一个字符串，而是一个可变对象，如下面的评论中所述。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T12:15:59.313

引用“地图”接口JavaDoc：

> *如果将可变对象用作映射键，则必须非常小心。如果对象的值以影响等于比较的方式更改，而对象是映射中的键，则不指定映射的行为。*

你根本不应该改变键（以改变它们的“hashCode”/“equals”的方式）。如果你尝试，你肯定会有很长很糟糕的调试。

就像你在图书馆交换书籍一样。索引变得不可靠。您搜索“Bradbury”，但找到“Simak”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T11:01:19.063

如果您尝试使用`v.getk()`它来查找地图，则不会找到条目，因为您已经更改了 v 上的 getter 返回的值。

或者换句话说，地图并没有神奇地与你的 v 对象发生的事情保持同步——它使用（并继续使用）在`put()`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T11:10:09.800

```
V v = new V();
v.setK("a");
HashMap<K,V> map = new HashMap<K,V>();
map.put(v.getk(),v);

//Nothing will change in the hashmap with this step
v.setK("b"); 
```

但问题将出在从地图中获取对象 V 时。如果你调用 map.get(v.getk())，你会得到 null，因为 map 中的值是用对象“a”映射的。但是，由于这个 String "a" 是 inter 你总是可以通过`map.get("a");`or从 map 中获取这个对象

```
V v = new V();
v.setK("a");
map.get(v.getK()); 
```

PS：我没有尝试运行这个

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T11:01:23.367

通过调用 v.setK()，您不会更改 HashMap 中的键。因此，您的 V 对象中只会有错误的信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-14T11:05:46.710

这个问题的标题具有误导性——您没有更改映射键，就像*改变用作映射键的对象一样*。当您说 时`map.put(x, y)`，您正在创建一个聚合两个独立值的*映射条目*：一个*键*和一个*值*。地图看不到密钥的来源，它只是两个对象。因此，您已经创建了一个映射条目`("a", v)`，之后您只是更改了 v 的状态——这不可能影响映射条目的键“a”。另一方面，如果你有一个自己制作的对象 K，比如

```
public class K { 
  private String s;
  public K(String s) { this.s = s; }
  public void setS(String s) { this.s = s; }
  public boolean equals(Object o) { return ((K)o).s.equals(this.s); }
  public int hashCode() { return s.hashCode(); } 
```

}

现在你做了

```
final K k = new K("a");
map.put(k, v);
k.setS("b");
map.get(k); 
```

那么您将面临问题 - 您**改变了用作映射键的对象**。

# css - CSS选择输入，其中父级不是“类名”

> ID：10153072
> 
> 赞同：2
> 
> 时间：2012-04-14T10:59:03.157
> 
> 标签：css, css-selectors

我的样式表中有这条规则：

```
input:not([type='button']):not([type='submit']):not([type='checkbox']):not([type='radio']),
select {
    padding:8px;
    width:224px;
    border:1px solid #CCC;
    border-radius:5px;
} 
```

这针对我页面上的所有文本字段，但我需要防止它影响具有特定类的元素内的输入。我正在使用 ckeditor 并且不需要影响它创建的对话框中的字段 - 这意味着我不能只是在之后覆盖规则。

我试过添加`:not(.cke_editor_pageContent_dialog input)`，但由于明显的原因这不起作用。我似乎无法在任何地方找到答案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T11:06:52.063

正确的方法可能是采用“白名单”方法而不是“黑名单”方法（告诉浏览器*不要*选择什么）。

一方面，它避免了您遇到的问题。此外，`:not()`选择器在 IE8 或更低版本中不起作用（不确定这是否重要）。最后（只是一个猜测）我必须相信复杂`:not`的陈述评估起来更昂贵。

我建议将明确的类名放在有问题的元素上，或者更好的是，将所有非编辑器元素包装在一个元素中并将其用作样式容器。

```
<div class="myStyles">
    <!-- elements that should be styled -->
    <input type="text" />
</div>

.myStyles input[type="text"]{
    padding:8px;
    width:224px;
    border:1px solid #CCC;
    border-radius:5px;
} 
```

我意识到这可能需要更多的标记，但从长远来看可能更容易维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T11:15:41.830

从长远来看，如此长而复杂的选择器将很快变得无法维护。

在您想要以相同方式设置样式的元素上添加一个**公共类**会更容易和更清晰。

```
.text-field {
    padding:8px;
    width:224px;
    border:1px solid #CCC;
    border-radius:5px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T11:29:55.833

I know the better answer has already been given, but just for the record, and to augment Tim's answer.

If you want to work with inputs that either have `type="text"` or don't have a `type` attribute at all, use this selector:

```
input:not([type]), input[type='text'] 
```

# vim - 语法区域：以组开头

> ID：10153078
> 
> 赞同：2
> 
> 时间：2012-04-14T11:00:28.390
> 
> 标签：vim

那是针对汇编编码的：我想突出显示以单操作数助记符开头但包含逗号的行。

我试过这样的事情：

```
sy keyword ONE_OP_MNEM jal jr " <--- this are mnemonics expecting 1 operand
sy match COMMA /,/ " <--- group to be used in next line
sy region ERROR start=one_op_mnemonic end=/[;$]/ contains=comma 
```

vim 抱怨`start=ONE_OP_MNEM`. 有人可以纠正我的语法或建议另一种方式来突出这种操作数不匹配吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T12:47:53.723

尽量不要在定义关键字的同一行包含注释

# windows - 等效于 ps -A | Windows中的grep -c进程？

> ID：10153087
> 
> 赞同：25
> 
> 时间：2012-04-14T11:02:38.550
> 
> 标签：windows, linux, process, grep, ps

我正在`ps -A | grep -c script.php`为 ms windows 寻找 Linux 的等效/替代方案？

干杯，/马辛

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-04-14T11:30:09.453

简单的命令：

```
tasklist | FIND "script.php" 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-08-26T16:01:52.373

已接受答案的替代解决方案

```
tasklist /fi "Imagename eq script*" 
```

如果你需要这个循环

```
for /l %x in (1, 0, 2) do (timeout /t 2 | tasklist /fi "Imagename eq script*") 
```

来源： [https ://technet.microsoft.com/en-us/library/bb491010.aspx](https://technet.microsoft.com/en-us/library/bb491010.aspx)

# java - 字符串编码不会输出所有字符

> ID：10153090
> 
> 赞同：2
> 
> 时间：2012-04-14T11:02:49.343
> 
> 标签：java, android, html, encoding

我的客户端使用 InputStreamReader/BufferedReader 从 Internet 获取文本。但是，当我将文本保存到 *.txt 时，文本会显示额外的奇怪特殊符号，例如“Â”。

*   我已经尝试将字符串转换为 ASCII，但是我使用的 å,ä,ö,Ø 搞砸了。

*   我试过食物 =`food.replace("Â", ""); and IndexOf();` 但字符串找不到。但它在 HEX 编辑器中。

所以总结：当我使用`text.setText`（Android）时，输出看起来很好，没有奇怪的符号，但是当我将文本保存到 *.txt 时，我得到了大约 4 个“Â”。我不想要 ASCII，因为我使用其他非 ASCII 字符。'Â' 在我的 Android 和记事本中显示为空白。

谢谢！

周末愉快！

编辑：通过删除所有非破坏空间来解决它：

```
myString.replaceAll("\\u00a0"," "); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:34:42.807

你说你是这样取的：

```
in = new BufferedReader(new InputStreamReader(url.openStream(),"UTF-8")); 
```

您获取的内容很有可能没有以 UTF-8 编码。

您需要调用`getContentType()`HttpURLConnection 对象，如果它不为 null，请提取编码并在创建`InputStreamReader`. 如果响应未提供具有有效编码的内容类型，则仅假定为“UTF-8”。

* * *

仔细想想，虽然您应该注意服务器返回的内容类型，但真正的问题要么在于您编写 *.txt 文件的方式，要么在于显示奇怪字符的显示工具。

*   目前尚不清楚您使用什么编码来写入文件。也许你选错了。
*   显示工具可能假设文件具有不同的编码。也许它检测到文件是 UTF-8 或 UTF-16 是否有 BOM。
*   显示工具可能是完全损坏的，并且不理解不间断的空格。

当您使用 HEX 编辑器显示文件时，很可能使用 8 位字符集来呈现字节，并且该字符集很可能是 Latin-1。但显然，该文件实际上编码不同。

无论如何，替换不间断空格的方法是（IMO）一种hack，它不会处理您将来可能遇到的其他东西。因此，我建议您花时间真正了解问题，并正确解决问题。

* * *

Finally, I think I understand why you might be getting Â characters. A Unicode NON-BREAKING-SPACE character is `u00a0`. When you encode that as UTF-8, you get C2 A0\. But C2 in Latin-1 is CAPITAL-A-CIRCUMFLEX, and A0 in Latin-1 is NON-BREAKING-SPACE. So the "confusion" is most likely that your program is writing the *.txt file in UTF-8 and the tool is reading it as Latin-1.

# antlr - ANTLR 解析语法 -> 树语法

> ID：10153091
> 
> 赞同：2
> 
> 时间：2012-04-14T11:03:12.210
> 
> 标签：antlr, tree-grammar

我们对编译器理论课的最后一项任务是为 Java 的一小部分（不是 MiniJava）创建一个编译器。我们的教授给了我们使用任何我们想要的工具的选项，经过大量的探索，我选择了 ANTLR。我设法让扫描仪和解析器启动并运行，解析器输出 AST。我现在被困在试图编译一个树语法文件。我理解的基本思想是从解析器中复制语法规则并消除大部分代码，将重写规则留在原处，但它似乎不想编译（offendingToken 错误）。我在正确的轨道上吗？我错过了一些微不足道的事情吗？

树语法：

```
tree grammar J0_SemanticAnalysis;

options {
  language = Java;
  tokenVocab = J0_Parser;
  ASTLabelType = CommonTree;
}

@header 
{ 
  package ritterre.a4; 
  import java.util.Map;
  import java.util.HashMap;
}

@members
{

}

walk
  : compilationunit
  ;

compilationunit
  : ^(UNIT importdeclaration* classdeclaration*)
  ;

importdeclaration
  : ^(IMP_DEC IDENTIFIER+)
  ;

classdeclaration
  : ^(CLASS IDENTIFIER ^(EXTENDS IDENTIFIER)? fielddeclaration* methoddeclaration*)
  ;

fielddeclaration
  : ^(FIELD_DEC IDENTIFIER type visibility? STATIC?)
  ;

methoddeclaration
  : ^(METHOD_DEC IDENTIFIER type visibility? STATIC? ^(PARAMS parameter+)? body)
  ;

visibility
  : PRIVATE 
  | PUBLIC
  ;

parameter
  : ^(PARAM IDENTIFIER type)
  ;

body
  : ^(BODY ^(DECLARATIONS localdeclaration*) ^(STATEMENTS statement*))
  ;

localdeclaration 
  : ^(DECLARATION type IDENTIFIER)
  ;

statement
  : assignment      
  | ifstatement     
  | whilestatement  
  | returnstatement 
  | callstatement   
  | printstatement  
  | block
  ;

assignment
  : ^(ASSIGN IDENTIFIER+ expression? expression)
  ;

ifstatement
  : ^(IF relation statement ^(ELSE statement)?)
  ;

whilestatement
  : ^(WHILE relation statement)
  ;

returnstatement
  : ^(RETURN expression?)
  ;

callstatement
  : ^(CALL IDENTIFIER+ expression+)
  ;

printstatement
  : ^(PRINT expression)
  ;

block
  : ^(STATEMENTS statement*)
  ;

relation
//  : expression (LTHAN | GTHAN | EQEQ | NEQ)^ expression
  : ^(LTHAN expression expression)
  | ^(GTHAN expression expression)
  | ^(EQEQ expression expression)
  | ^(NEQ expression expression)
  ;

expression
//  : (PLUS | MINUS)? term ((PLUS | MINUS)^ term)*
  : ^(PLUS term term)
  | ^(MINUS term term)
  ;

term
//  : factor ((MULT | DIV)^ factor)*
  : ^(MULT factor factor)
  | ^(DIV factor factor)
  ;

factor
  : NUMBER
  | IDENTIFIER (DOT IDENTIFIER | LBRAC expression RBRAC)?
  | NULL
  | NEW IDENTIFIER LPAREN RPAREN
  | NEW (INT | IDENTIFIER) (LBRAC RBRAC)?
  ;

type
  : (INT | IDENTIFIER) (LBRAC RBRAC)? 
  | VOID
  ; 
```

解析器语法：

```
parser grammar J0_Parser;

options
{
  output = AST;             // Output an AST
  tokenVocab = J0_Scanner;   // Pull Tokens from Scanner
  //greedy = true; // forcing this throughout?! success!!
  //cannot force greedy true throughout. bad things happen and the parser doesnt build
}

tokens
{
  UNIT;
  IMP_DEC;
  FIELD_DEC;
  METHOD_DEC;
  PARAMS;
  PARAM;
  BODY;
  DECLARATIONS;
  STATEMENTS;
  DECLARATION;
  ASSIGN;
  CALL;
}

@header { package ritterre.a4; }

// J0 - Extended Specification - EBNF
parse
  : compilationunit EOF -> compilationunit
  ;

compilationunit
  : importdeclaration* classdeclaration*
    -> ^(UNIT importdeclaration* classdeclaration*)
  ;

importdeclaration
  : IMPORT IDENTIFIER (DOT IDENTIFIER)* SCOLON
    -> ^(IMP_DEC IDENTIFIER+)
  ;

classdeclaration
  : (PUBLIC)? CLASS n=IDENTIFIER (EXTENDS e=IDENTIFIER)? LBRAK (fielddeclaration|methoddeclaration)* RBRAK
    -> ^(CLASS $n ^(EXTENDS $e)? fielddeclaration* methoddeclaration*)
  ;

fielddeclaration
  : visibility? STATIC? type IDENTIFIER SCOLON
    -> ^(FIELD_DEC IDENTIFIER type visibility? STATIC?)
  ;

methoddeclaration
  : visibility? STATIC? type IDENTIFIER LPAREN (parameter (COMMA parameter)*)? RPAREN body
    -> ^(METHOD_DEC IDENTIFIER type visibility? STATIC? ^(PARAMS parameter+)? body)
  ;

visibility
  : PRIVATE 
  | PUBLIC
  ;

parameter
  : type IDENTIFIER
    -> ^(PARAM IDENTIFIER type)
  ;

body
  : LBRAK localdeclaration* statement* RBRAK
    -> ^(BODY ^(DECLARATIONS localdeclaration*) ^(STATEMENTS statement*))
  ;

localdeclaration 
  : type IDENTIFIER SCOLON
    -> ^(DECLARATION type IDENTIFIER)
  ;

statement
  : assignment
  | ifstatement
  | whilestatement
  | returnstatement
  | callstatement
  | printstatement
  | block
  ;

assignment
  : IDENTIFIER (DOT IDENTIFIER | LBRAC a=expression RBRAC)? EQ b=expression SCOLON
    -> ^(ASSIGN IDENTIFIER+ $a? $b)
  ;

ifstatement
  : IF LPAREN relation RPAREN statement (options {greedy=true;} : ELSE statement)?
    -> ^(IF relation statement ^(ELSE statement)?)
  ;

whilestatement
  : WHILE LPAREN relation RPAREN statement
    -> ^(WHILE relation statement)
  ;

returnstatement
  : RETURN expression? SCOLON
    -> ^(RETURN expression?)
  ;

callstatement
  : IDENTIFIER (DOT IDENTIFIER)? LPAREN (expression (COMMA expression)*)? RPAREN SCOLON
    -> ^(CALL IDENTIFIER+ expression+)
  ;

printstatement
  : PRINT LPAREN expression RPAREN SCOLON
    -> ^(PRINT expression)
  ;

block
  : LBRAK statement* RBRAK
    -> ^(STATEMENTS statement*)
  ;

relation
  : expression (LTHAN | GTHAN | EQEQ | NEQ)^ expression
  ;

expression
  : (PLUS | MINUS)? term ((PLUS | MINUS)^ term)*
  ;

term
  : factor ((MULT | DIV)^ factor)*
  ;

factor
  : NUMBER
  | IDENTIFIER (DOT IDENTIFIER | LBRAC expression RBRAC)?
  | NULL
  | NEW IDENTIFIER LPAREN RPAREN
  | NEW (INT | IDENTIFIER) (LBRAC RBRAC)?
  ;

type
  : (INT | IDENTIFIER) (LBRAC RBRAC)? 
  | VOID
  ; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T14:23:46.113

问题是在您的树语法中，您执行以下操作（我相信 3 次）：

```
classdeclaration
  : ^(CLASS ... ^(EXTENDS IDENTIFIER)? ... )
  ; 
```

该`^(EXTENDS IDENTIFIER)?`部分是错误的：您需要将树包裹在括号中，然后才将其设为可选：

```
classdeclaration
  : ^(CLASS ... (^(EXTENDS IDENTIFIER))? ... )
  ; 
```

但是，如果仅此而已，那就太容易了，不是吗？:)

当您解决上述问题时，ANTLR 会在尝试从您的树语法生成树遍历器时抱怨树语法不明确。ANTLR 将向您抛出以下内容：

> 错误（211）：J0_SemanticAnalysis.g:61:26：[致命] 规则分配具有非 LL(*) 决策，因为可以从 alts 1,2 访问递归规则调用。通过左分解或使用句法谓词或使用 backtrack=true 选项来解决。

它抱怨`assignment`您语法中的规则：

```
assignment
  : ^(ASSIGN IDENTIFIER+ expression? expression)
  ; 
```

由于 ANTLR 是一个**LL**解析器生成器¹，它从左到右解析标记。因此，可选表达式 in`IDENTIFIER+ expression? expression`使语法模棱两可。通过将`?`移到最后来解决此问题`expression`：

```
assignment
  : ^(ASSIGN IDENTIFIER+ expression expression?)
  ; 
```

* * *

¹不要让 ANT **LR**名称中的最后两个字母误导您，它们代表**L** anguage **R** ecognition，*而不是*它生成的解析器类！

# ruby-on-rails - ActiveAdmin 表单（新/编辑）belongs_to 关联？

> ID：10153095
> 
> 赞同：6
> 
> 时间：2012-04-14T11:03:49.137
> 
> 标签：ruby-on-rails, activeadmin

我将 Active Admin gem 用于 Ruby on Rails。我有模块 Team 和 Coach，它们具有 has_many 和 belongs_to 关系。

```
class Team < ActiveRecord::Base
  belongs_to :coach
end

class Coach < ActiveRecord::Base
  has_many :teams
end 
```

我想出了如何在索引和显示页面上显示名字和姓氏（我是这样做的：）

```
 index do
    column :name
    column "Coach" do |team|
      team.coach.firstname + " " + team.coach.lastname
    end  
     default_actions
  end 
```

我想要的是如何在下拉菜单中以团队形式（新建和编辑页面）显示教练的名字和姓氏？请帮我解决一下这个。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T07:35:52.550

你能试试这个

```
f.input :coach_name, :as => :select, :collection => Coach.all.map {|u| [u.firstname, u.id]}, :include_blank => false 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-06T20:56:41.070

我有同样的问题。编辑页面在选择菜单中显示对象实例，例如，

```
#<Coach:0x00eff180c85c8> 
```

要解决它并访问每个实例的字段，请使用它，

```
form do |f| 
  f.inputs "Coaches" do
    f.input :name
    f.input :coach, member_label: Proc.new { |c| "#{c.firstname} #{c.lastname}"
  end
  f.actions
end 
```

ActiveAdmin 使用 Formtastic，它的[文档](http://rdoc.info/github/justinfrench/formtastic/Formtastic/Inputs/RadioInput)有更多示例。

这个 stackoverflow[答案](https://stackoverflow.com/a/17229692/1366534)帮助我得到了这个解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-08T05:52:46.473

尝试这个：

```
f.input :coach_name, :as => :select, :collection => Coach.all.map {|u| [u.firstname.to_s, u.id]} 
```

# delphi - 像 PsSuspend 一样暂停/恢复进程

> ID：10153097
> 
> 赞同：14
> 
> 时间：2012-04-14T11:04:04.083
> 
> 标签：delphi, winapi, windows-7, process, 32-bit

我希望这篇文章不是重复的。让我解释：

我考虑过类似的帖子[如何在 Windows 下暂停/恢复任何外部进程？](https://stackoverflow.com/questions/100480/how-to-pause-resume-any-external-process-under-windows)但有 C++/Python 偏好，但截至发帖时还没有公认的答案。

* * *

**我的问题：**

我对*Windows Sysinternals*的*Mark Russinovich*的[PsSuspend](http://technet.microsoft.com/en-us/sysinternals/bb897540)提供的功能在 Delphi 中的可能实现感兴趣。

 **引号：

> PsSuspend 允许您暂停本地或远程系统上的进程，这在某个进程正在消耗您希望允许不同进程使用的资源（例如网络、CPU 或磁盘）的情况下是可取的。挂起不是杀死消耗资源的进程，而是允许您让它在以后的某个时间点继续运行。

谢谢你。

* * *

**编辑：**

部分实现就可以了。可以删除远程功能。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-14T12:46:39.480

您可以尝试使用以下代码。它使用未记录的函数`NtSuspendProcess`和`NtResumeProcess`. 我已经从 Delphi 2009 中内置的 32 位应用程序在 Windows 7 64 位上进行了尝试，它适用于我。请注意，这些函数未记录在案，因此可以从未来版本的 Windows 中删除。

***更新***

以下代码中的`SuspendProcess`和`ResumeProcess`包装器现在是函数，如果成功则返回 True，否则返回 False。

```
type
  NTSTATUS = LongInt;
  TProcFunction = function(ProcHandle: THandle): NTSTATUS; stdcall;

const
  STATUS_SUCCESS = $00000000;
  PROCESS_SUSPEND_RESUME = $0800;

function SuspendProcess(const PID: DWORD): Boolean;
var
  LibHandle: THandle;
  ProcHandle: THandle;
  NtSuspendProcess: TProcFunction;
begin
  Result := False;
  LibHandle := SafeLoadLibrary('ntdll.dll');
  if LibHandle <> 0 then
  try
    @NtSuspendProcess := GetProcAddress(LibHandle, 'NtSuspendProcess');
    if @NtSuspendProcess <> nil then
    begin
      ProcHandle := OpenProcess(PROCESS_SUSPEND_RESUME, False, PID);
      if ProcHandle <> 0 then
      try
        Result := NtSuspendProcess(ProcHandle) = STATUS_SUCCESS;
      finally
        CloseHandle(ProcHandle);
      end;
    end;
  finally
    FreeLibrary(LibHandle);
  end;
end;

function ResumeProcess(const PID: DWORD): Boolean;
var
  LibHandle: THandle;
  ProcHandle: THandle;
  NtResumeProcess: TProcFunction;
begin
  Result := False;
  LibHandle := SafeLoadLibrary('ntdll.dll');
  if LibHandle <> 0 then
  try
    @NtResumeProcess := GetProcAddress(LibHandle, 'NtResumeProcess');
    if @NtResumeProcess <> nil then
    begin
      ProcHandle := OpenProcess(PROCESS_SUSPEND_RESUME, False, PID);
      if ProcHandle <> 0 then
      try
        Result := NtResumeProcess(ProcHandle) = STATUS_SUCCESS;
      finally
        CloseHandle(ProcHandle);
      end;
    end;
  finally
    FreeLibrary(LibHandle);
  end;
end; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-14T11:59:18.287

Windows中没有`SuspendProcess`API 调用。所以你需要做的是：

1.  枚举进程中的所有线程。有关示例代码，请参阅[RRUZ 的答案](https://stackoverflow.com/questions/2055642/how-can-i-get-a-list-with-all-the-threads-created-by-my-application#answer-2057866)。
2.  调用[`SuspendThread`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686345.aspx)这些线程中的每一个。
3.  为了实现程序的恢复部分，调用[`ResumeThread`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms685086.aspx)每个线程。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-12T02:27:06.243

“挂起所有线程”实现存在竞争条件 - 如果您尝试挂起的程序在您创建快照和完成挂起时间之间创建一个或多个线程，会发生什么？

您可以循环，获取另一个快照并挂起任何未挂起的线程，只有在没有找到时才退出。

未记录的函数避免了这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T07:45:41.453

[我刚刚在这里](http://www.delphibasics.info/home/delphibasicssnippets/howtosuspendprocessresumeprocess)找到了以下片段（作者：steve10120）。

我认为它们是贵重物品，我不禁将它们发布为我自己问题的替代答案。

* * *

**简历流程：**

```
function ResumeProcess(ProcessID: DWORD): Boolean;
 var
   Snapshot,cThr: DWORD;
   ThrHandle: THandle;
   Thread:TThreadEntry32;
 begin
   Result := False;
   cThr := GetCurrentThreadId;
   Snapshot := CreateToolhelp32Snapshot(TH32CS_SNAPTHREAD, 0);
   if Snapshot <> INVALID_HANDLE_VALUE then
    begin
     Thread.dwSize := SizeOf(TThreadEntry32);
     if Thread32First(Snapshot, Thread) then
      repeat
       if (Thread.th32ThreadID <> cThr) and (Thread.th32OwnerProcessID = ProcessID) then
        begin
         ThrHandle := OpenThread(THREAD_ALL_ACCESS, false, Thread.th32ThreadID);
         if ThrHandle = 0 then Exit;
         ResumeThread(ThrHandle);
         CloseHandle(ThrHandle);
        end;
      until not Thread32Next(Snapshot, Thread);
      Result := CloseHandle(Snapshot);
     end;
 end; 
```

* * *

**暂停过程：**

```
function SuspendProcess(PID:DWORD):Boolean;
 var
 hSnap:  THandle;
 THR32:  THREADENTRY32;
 hOpen:  THandle;
 begin
   Result := FALSE;
   hSnap := CreateToolhelp32Snapshot(TH32CS_SNAPTHREAD, 0);
   if hSnap <> INVALID_HANDLE_VALUE then
   begin
     THR32.dwSize := SizeOf(THR32);
     Thread32First(hSnap, THR32);
     repeat
       if THR32.th32OwnerProcessID = PID then
       begin
         hOpen := OpenThread($0002, FALSE, THR32.th32ThreadID);
         if hOpen <> INVALID_HANDLE_VALUE then
         begin
           Result := TRUE;
           SuspendThread(hOpen);
           CloseHandle(hOpen);
         end;
       end;
     until Thread32Next(hSnap, THR32) = FALSE;
     CloseHandle(hSnap);
   end;
 end; 
```

* * *

**免责声明：**

我根本没有测试它们。请享受，不要忘记反馈。**

# facebook - 使用 JavaScript SDK 或 Php SDK 以用户身份将照片（带标题）发布到粉丝专页墙

> ID：10153098
> 
> 赞同：0
> 
> 时间：2012-04-14T11:04:09.480
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk, facebook-php-sdk

我想做以下事情：作为用户，将照片（带标题）发布到 FanPage Wall，这样在 FanPage Wall 上，我可以看到谁（哪个用户）发布了该照片。（也通过 Graph API，我可以看到哪个用户发布了照片，而不是通过 Facebook 应用程序）

我想通过 Graph API 来实现，或者使用 PHP sdk 或 JavaScript SDK。

我如何实现目标？

我目前尝试了以下教程： 1) [http://developers.facebook.com/blog/post/498/](http://developers.facebook.com/blog/post/498/) 这可行，但该示例用于将照片发布到用户墙。我更改了代码，使 UserID（我）现在是 FanPage Id。它有效，（因为用户是管理员并且喜欢 FanPage ）。但问题是照片没有出现在墙上。相反，它会显示一个附件图标。

以下屏幕截图显示了我的意思： ![在此处输入图像描述](../Images/a8283dc5aef5d195be4c47924194dc0d.png)

2）[http://www.webspeaks.in/2011/12/upload-photos-to-facebook-fan-page.html](http://www.webspeaks.in/2011/12/upload-photos-to-facebook-fan-page.html) 这工作正常，但正如标题所说，它将照片上传到album_id。我使用了 Wall Photos 的 album_id，但在成功上传照片后，我无法找出是谁（哪个 facebook 用户）上传了照片。

但是，如果 facebook 用户登录到 Facebook，例如 FanPage，并在 FanPage Wall 上发帖，我可以找出发帖的用户。

有什么意见或建议吗？

非常感谢！

最好的。

注意：用户不是 FanPage 的管理员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T01:59:04.300

我认为这是不可能实现的，因为要在 facebook 页面中创建照片，您需要具有 manage_pages 权限。这意味着您必须是页面的管理员。所有上传到 facebook 相册的照片都是代表页面创建的，而不是上传它们的用户。您可以使用 facebook 图形资源管理器查看此内容，检查从相册中获得的 json 结果的“来自”字段。

# ruby - Ruby - 比 Time.now.utc 更准确的时间戳

> ID：10153112
> 
> 赞同：3
> 
> 时间：2012-04-14T11:06:14.153
> 
> 标签：ruby

通常我`Time.now.utc`在我的项目中使用时间戳。但这一次它看起来不够准确，仅使用`Time.now.utc`.

它看起来`Time.now.utc`在第二级（它正确吗？），并不像我想要的那样准确。

有没有办法在毫秒级别生成时间戳？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-14T11:21:52.187

根据[文档](http://www.ruby-doc.org/core-1.9.3/Time.html)：

> 时间在内部存储为自 1970 年 1 月 1 日 00:00 UTC 纪元以来的秒数

您可以使用该[`to_f`](http://www.ruby-doc.org/core-1.9.3/Time.html#to_f-method)方法访问内部浮点表示，例如

```
irb> Time.now.to_f
=> 1334401921.06418 
```

或者您可以使用该[`strftime`](http://www.ruby-doc.org/core-1.9.3/Time.html#method-i-strftime)方法很好地打印出来，例如：

```
irb> Time.now.strftime("%Y-%m-%d %H:%M:%S.%L")
=> "2012-04-14 21:20:58.100" 
```

（至少在理论上，我不能`%L`在 Ruby 1.8 上工作，但它确实可以在 1.9 上工作）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-14T11:16:26.973

来自[时间](http://www.ruby-doc.org/core-1.9.3/Time.html#method-c-new)文档：

> 创建的对象将使用系统时钟上可用的分辨率创建，因此可能包括小数秒。

例子：

```
a = Time.new 
"%.6f" % a.to_f

=> "1334402161.334542" 
```

# objective-c - NSThread 问题如何解决？

> ID：10153116
> 
> 赞同：-1
> 
> 时间：2012-04-14T11:07:10.900
> 
> 标签：objective-c, ios

我正在编写以下代码。

```
#import <objc/objc.h>
#import <Foundation/Foundation.h>

@interface myT :NSObject
-(void) startT;
-(void) tfun;
@end

@implementation myT 
-(void) tfun
{
 NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
NSLog (@"Inside thread Function .. ");
[pool drain];
}

-(void) startT
{
  [NSThread detachNewThreadSelector:@selector(tfun) toTarget:self withObject:nil ];
}
@end

int main ( int argc, char ** argv)
{
   myT *t = [[myT alloc] init];
   [t startT];
   return 0;
} 
```

它编译，并导致运行时错误。我做错了什么？我熟悉pthread。我怎样才能等到线程完成，即：pthread_wait 种类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T11:18:48.790

您可以旋转运行循环，直到设置一个完整的标志，例如：

```
-(void) startT
{
   [NSThread detachNewThreadSelector:@selector(tfun) toTarget:self withObject:nil ];

   do {

        [[NSRunLoop currentRunLoop] runMode:NSDefaultRunLoopMode beforeDate:[NSDate distantFuture]];

   } while (!self.completed);
} 
```

在你的 tfun 方法中

```
-(void) tfun
{
   NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
   NSLog (@"Inside thread Function .. ");
   [pool drain];
   self.complete = YES;
} 
```

# c++ - C++：有 unicode 控制台标题..？

> ID：10153124
> 
> 赞同：3
> 
> 时间：2012-04-14T11:09:32.320
> 
> 标签：c++, unicode, console, title

当我尝试将控制台的标题设置为其中包含 unicode 字符的字符串时，使用`SetConsoleTitle()`，标题仅显示一些垃圾字符。
我也尝试了 SetConsoleTitleW() 函数，但这给了我以下错误：

```
error: cannot convert 'const char*' to 'const WCHAR*' for argument '1' to 'BOOL SetConsoleTitleW(const WCHAR*)' 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-14T11:11:37.760

您必须使用宽字符串文字，即：

```
SetConsoleTitleW(L"DиD"); 
```

,`L`在引号之前表示这是一个`wchar_t*`字符串。

另外，为了完整起见，我不得不说，在 C++11 中，定义了新的字符串字面前缀：

```
const char a[] = u8"for a UTF-8 string.";
const char_16_t b[] = u"for a UTF-16 string.";
const char_32_t c[] = U"for a UTF-32 string."; 
```

像往常一样，[维基百科](http://en.wikipedia.org/wiki/C%2B%2B0x#New_string_literals)对此有更详细的说明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T11:14:20.787

看起来好像您正在尝试将 UTF-8 编码数据发送到需要 UTF-16 编码数据的函数。

您需要在将字符串文字`WCHAR*`传递给函数之前将其转换为 UTF-16（即），或者将文字创建为`WCHAR*`文字（我相信这是使用语法完成的`L"DиD"`）。

# jquery - 带有 Rails 问题的 jQuery - datepicker()

> ID：10153129
> 
> 赞同：1
> 
> 时间：2012-04-14T11:10:39.590
> 
> 标签：jquery, ruby-on-rails-3, twitter-bootstrap, jquery-ui-datepicker

我有一个 Rails 应用程序，我想添加 jQuery datepicker，以显示用户何时选择表单中的字段。

该字段是使用以下代码构建的：

```
<%= f.text_field :collection_date_time %> 
```

导致：

```
<input class="input-medium" id="pick_collection_date_time" name="pick[collection_date_time]" size="30" type="text" /> 
```

我已将以下内容添加到我的`pick.js.coffee`文件中，但是当我选择该字段时，没有任何反应。

```
$ -> $("#pick_collection_date_time").datepicker() 
```

对于信息，我也在使用 twitter 引导框架（和相关的 js）。

任何想法为什么这不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:17:39.490

在这种情况下要做的第一件事是打开 firbug 或 chrome 检查器并检查他是否可以找到该文件。接下来检查`development.log`您是否发现资产有任何问题。也许你在某个地方做了一个简单的错字:)

可能你需要去`app/assets/javascripts/application.js`检查你是否有类似“//= require_tree”的东西。如果不添加此文件的要求，否则您将不得不去`config/environments/<env>.rb`并将其添加到行中`config.assets.precompile += %w( <name>.js )`，以便他将与休息一起预编译。

# ios - Core Data 中的自定义访问器方法，为什么要使用 KVO？

> ID：10153130
> 
> 赞同：4
> 
> 时间：2012-04-14T11:11:10.367
> 
> 标签：ios, core-data, key-value-observing, accessor, kvc

一个典型的自定义访问器方法可以写成如下：

```
- (NSString *)name
{
    [self willAccessValueForKey:@"name"];
    NSString *myName = [self primitiveName];
    [self didAccessValueForKey:@"name"];
    return myName;
}

- (void)setName:(NSString *)newName
{
    [self willChangeValueForKey:@"name"];
    [self setPrimitiveName:newName];
    [self didChangeValueForKey:@"name"];
} 
```

的意思就很清楚了`setPrimitiveName`。它允许您在没有 KVC 的情况下访问“原始”变量（防止访问器内部的运行循环）并设置传入的值。同样的观察可以应用于 getter。

从文档中可以清楚地看出`setPrimitiveName`禁用更改通知方法：`willChangeValueForKey`和对应方法。

现在我的问题如下：为什么需要将该方法包装在`willChangeValueForKey:`和`didChangeValueForKey:`方法中？

阅读那里的核心数据编程是这样写的：

> NSManagedObject 对建模属性禁用自动键值观察 (KVO) 更改通知，并且原始访问器方法不会调用访问和更改通知方法。对于未建模的属性，在 Mac OS X v10.4 Core Data 上也禁用了自动 KVO；在 Mac OS X v10.5 及更高版本上，Core Data 采用了 NSObject 的行为。

为什么我需要通知我已准备好访问密钥（访问器或实例变量），然后我已经完成了它？谁被告知？

希望我的问题很清楚。先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T11:27:50.337

您需要它来通知视图，您的值已更改。例如，您将使用**MKMapView**并在其上添加一些注释，从 Core Data 获取坐标，然后以某种方式更改它的位置。

If you getter/setter didn't post these notifications, **MKMapView** wouldn't know of these changes in locations, and wouldn't move it to the new one.

You can also track the date of creation/change of your objects with these notifications.

I guess, that redo/undo is also made by this.

# NOTE

I would like to know, if Core Data uses these notifications somehow under the hood. Does anybody has any ideas on this subject?

# gwt - GWT - 使用 GWTP 创建类似 MobileWebApp 的东西

> ID：10153133
> 
> 赞同：0
> 
> 时间：2012-04-14T11:11:48.183
> 
> 标签：gwt, mobile, tablet, gwt-mvp, gwt-platform

我正在尝试创建一个应用程序，该应用程序将对移动设备、台式机和平板电脑具有不同的视图。它位于 GWT 的 MobileWebApp 示例中。我正在查看 GWT MVP 教程并且有一个基本的应用程序正在运行。我在考虑是否应该使用 GWTP，以及使用 GWTP 代替 GWT MVP（活动和地点）是否有任何优势。此外，任何想法如何将不同的视图绑定到同一个演示者。移动视图和桌面视图上可用的功能可能有所不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T07:05:28.697

我做过类似的事情，虽然是在活动和地点之前。所以当时我自己编写了 MVP 框架。我将所有通用代码，例如 Presenters、TransferObjects 和 Utilities 放在一个单独的 GWT 模块中。然后每个 UI 也变成了一个单独的项目，包含它的 View 类和 UiBinder 东西，继承自公共模块。所以实际上每个 UI 项目都是一个完整的 GWT 应用程序。GWT 应用程序必须部署在不同的上下文中，因此具有不同的 URL。然后，您需要在欢迎页面上使用一些智能 JavaScript 来根据设备重定向访问者。

我认为您无法在一个 GWT 应用程序中解决此问题。或者你必须想出一个非常聪明的解决方案，使用延迟绑定（可能是替换功能）和链接器子系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T05:27:01.037

您可以在 gwtp 中为演示者创建不同的视图。GWTP 使处理这种情况变得更加容易。有一个开源客户体验框架，其中包含使用 GWTP 创建移动网络应用程序的示例。你可以在这里查看 - [http://code.google.com/p/gwt-cx/](http://code.google.com/p/gwt-cx/)

# html - 基本 HTML 内部链接在 IE8 中不起作用

> ID：10153140
> 
> 赞同：1
> 
> 时间：2012-04-14T11:13:27.333
> 
> 标签：html, internal-link

这个让我摸不着头脑。我有一个带有多个内部链接的页面，将用户带到页面下方以获取更多内容。在各个部分下方有进一步的内部链接，可将用户带回顶部。这在所有浏览器中都可以正常工作，除了 IE8（实际的 IE8 - 不是 IE8 模式下的 IE9），它们的工作会停止，但不会恢复！

例子：

```
<a href="page.php?v=35&amp;u=admin-videos#a">A &ndash; General</a>
.... //travelling DOWN the page
<h3><strong>A &ndash; General<a name="a"></a></strong></h3>

<a name="top"></a>
.... //travelling back up
<a href="page.php?v=35&amp;u=admin-videos#top">Back to top.</a> 
```

我试过用“顶部”锚点填充，`&nbsp;`但这并没有改变它。有任何想法吗？

实际用例：[http ://databizsolutions.ie/contents/page.php?v=35&u=admin-videos](http://databizsolutions.ie/contents/page.php?v=35&u=admin-videos)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:17:21.487

试着给它喜欢

```
<a href="#top">Back to top.</a> 
```

把它这样说，我希望它会工作

```
 <a name="top">Title Text here</a>  
    <a href="#top">go to top</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T11:32:04.883

两件事情：

1.  使用`<a name="...">`与上个千年一样古老。`id`在现有元素上使用属性。最好是您的目标。然后你可以用`:target`CSS 选择器做一些很酷的事情。
2.  当您只想更改哈希时，不要包含完整的文件名。工作得`<a href="#top">`很好。

# c++ - 使用 wxWidgets 在 Windows 7 中的外观

> ID：10153142
> 
> 赞同：1
> 
> 时间：2012-04-14T11:13:41.053
> 
> 标签：c++, wxwidgets

我刚刚开始学习 wxWidgets，并且一直在 CODE::BLOCKS 上进行试验。首先，我跟着这个例子[http://www.wxwidgets.org/docs/tutorials/hworld2.txt](http://www.wxwidgets.org/docs/tutorials/hworld2.txt)。该应用程序在 Windows 7 上看起来并不那么原生，看起来我的应用程序在 Windows 98 上运行。OK 按钮看起来不应该是，同样，wxTextCtrl 也是（我自己尝试过）。我想念什么？我是否必须添加一些特殊代码或其他任何东西？

这是图片：[http ://angsila.cs.buu.ac.th/~52030937/Capture.PNG](http://angsila.cs.buu.ac.th/~52030937/Capture.PNG)

谢谢先进

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T12:22:11.823

您可以将 .rc 文件添加到您的项目中，并在其中包含“wx/msw/wx.rc”。然后应该将主题应用于您的 GUI（查看与 wxWidgets 捆绑的默认示例 - [http://screencast.com/t/QTaQqCxO692w](http://screencast.com/t/QTaQqCxO692w)）。

# android - 在智能手机上测试 phonegap/android 应用程序

> ID：10153148
> 
> 赞同：0
> 
> 时间：2012-04-14T11:15:40.223
> 
> 标签：android, testing, cordova, executable, smartphone

我已经用 PhoneGap/Android 开发了我的第一个应用程序，通常它可以在任何智能手机上运行，​​我现在有一个黑莓，我想知道如何创建我的应用程序的可执行文件，然后在智能手机上测试它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T13:03:54.537

您可以为此使用[PhoneGap 构建](https://build.phonegap.com/apps)！创建一个帐户，然后上传您的 Web 应用程序的 .zip 文件，然后您可以为许多移动 SE 构建可执行文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T11:18:05.140

查看phonegap的[入门指南](http://phonegap.com/start/#blackberry)

# java - Spring + JPA 项目的数据库管理站点

> ID：10153150
> 
> 赞同：5
> 
> 时间：2012-04-14T11:15:50.817
> 
> 标签：java, database, spring, jpa

我想知道是否有任何方法可以为 Spring + JPA 项目自动生成数据库管理站点。它应该采用带注释的 JPA 实体并动态生成站点以跟踪域 Java 类中的任何更改。

我正在寻找类似于 Django 管理站点的东西（我认为您也可以对 Ruby on Rails 做同样的事情），它允许用户：

*   无需开发任何额外代码即可查看和更新​​不同表中的数据
*   处理表之间的关系、不同类型的数据（数字、日期等）

在 Java 世界中，我只知道 Spring Roo，但它不能很好地满足我的需求，因为我想将它集成到已经开发的第三方项目中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T15:40:04.950

试试[玩！框架的 CRUD 模块](http://www.playframework.org/documentation/1.0.1/crud)

# c - 将原始结构内容（字节）写入 C 中的文件。对写入的实际大小感到困惑

> ID：10153155
> 
> 赞同：7
> 
> 时间：2012-04-14T11:16:50.397
> 
> 标签：c, struct, sizeof, fwrite

基本问题，但我希望这个结构占用 13 个字节的空间（1 个用于 char，12 个用于 3 个无符号整数）。相反，`sizeof(ESPR_REL_HEADER)`给了我 16 个字节。

```
typedef struct {
  unsigned char version;
  unsigned int  root_node_num;
  unsigned int  node_size;
  unsigned int  node_count;
} ESPR_REL_HEADER; 
```

我要做的是用一些值初始化这个结构，并将它包含的数据（原始字节）写入文件的开头，这样当我打开这个文件时，我以后可以重建这个结构并获得一些元数据有关文件其余部分包含的内容的数据。

我正在初始化结构并将其写入文件，如下所示：

```
int esprime_write_btree_header(FILE * fp, unsigned int node_size) {
  ESPR_REL_HEADER header = {
    .version       = 1,
    .root_node_num = 0,
    .node_size     = node_size,
    .node_count    = 1
  };

  return fwrite(&header, sizeof(ESPR_REL_HEADER), 1, fp);
} 
```

`node_size`我实验时，目前在哪里4。

将结构写入文件后，该文件包含以下数据：

```
-bash$  hexdump test.dat
0000000 01 bf f9 8b 00 00 00 00 04 00 00 00 01 00 00 00
0000010 
```

我希望它实际上包含：

```
-bash$  hexdump test.dat
0000000 01 00 00 00 00 04 00 00 00 01 00 00 00
0000010 
```

原谅新手。我正在努力学习:) 如何有效地将结构的数据组件写入文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T11:22:20.553

微处理器并非旨在从任意地址获取数据。诸如 4-byte 之类`int`的对象只能存储在可被四整除的地址处。此要求称为[对齐](http://en.wikipedia.org/wiki/Data_structure_alignment)。

C 使编译器可以自由地在结构成员之间插入[填充字节](http://en.wikipedia.org/wiki/Data_structure_alignment#Data_structure_padding)以对齐它们。填充量只是不同平台之间的一个变量，另一个主要变量是[字节序](http://en.wikipedia.org/wiki/Endianness)。这就是为什么如果您希望程序在多台机器上运行，您不应该简单地将结构“转储”到磁盘。

最佳实践是显式编写每个成员，并用于[`htonl`](http://pubs.opengroup.org/onlinepubs/7908799/xns/htonl.html)在二进制输出之前将字节序固定为大字节序。回读时，用于`memcpy`移动原始字节，不要使用

```
char *buffer_ptr;
...
++ buffer_ptr;
struct.member = * (int *) buffer_ptr; /* potential alignment error */ 
```

而是做

```
memcpy( buffer_ptr, (char *) & struct.member, sizeof struct.member );
struct.member = ntohl( struct.member ); /* if member is 4 bytes */ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T11:18:51.690

这是因为结构填充，请参阅[http://en.wikipedia.org/wiki/Sizeof#Implementation](http://en.wikipedia.org/wiki/Sizeof#Implementation)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T11:23:27.043

当您按原样编写结构时`fwrite`，您将按原样写入内存，包括由于*填充*而插入的结构内的“死字节” 。此外，您的多字节数据是使用系统的*字节序*写入的。

如果您不希望这种情况发生，请编写一个函数来*序列化*结构中的数据。您可以只写入非填充区域，也可以以可预测的顺序（例如[网络字节顺序](http://beej.us/guide/bgnet/output/html/multipage/htonsman.html)）写入多字节数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T11:23:59.940

该结构受对齐规则的约束，这意味着其中的某些项目被填充。看着它，看起来第一个`unsigned char`字段已经被填充到了 4 个字节。

这里的问题之一是规则可能因系统而异，因此，如果您`fwrite`在一个平台上使用一个编译器编译的程序中将结构作为一个整体编写，然后尝试在另一个平台上使用它来读取它`fread`，您可以得到垃圾，因为第二个程序将假定数据已对齐以适合其结构布局的概念。

通常，您必须：

1.  确定保存的数据文件仅对共享某些特征的程序构建有效（取决于您使用的编译器的记录行为），或

2.  不是将整个结构写成一个整体，而是实现一种更正式的数据格式，其中每个元素都是单独编写的，其大小显式控制。

（一个相关的问题是字节顺序可能不同；同样的选择通常也适用于那里，除了在选项 2 中您要明确指定数据格式的字节顺序。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-14T11:25:50.627

这是因为所谓的内存对齐。第一个字符被扩展为占用 4 个字节的内存。事实上，像这样的更大类型`int`只能在 4 字节块的开头“开始”，因此编译器用字节填充以达到这一点。

我对位图标题有同样的问题，从 2 个字符开始。我`char bm[2]`在结构内部使用了 a 并想知道 2 天 #$%^ 标头的第 3 和第 4 个字节去哪儿了...

如果你想防止这种情况，你可以使用`__attribute__((packed))`但[要小心，内存对齐**是**你的程序方便运行所必需的](http://digitalvampire.org/blog/index.php/2006/07/31/why-you-shouldnt-use-__attribute__packed/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-14T11:26:51.273

努力不要这样做！大小差异是由编译器/链接器使用的填充和对齐来优化对 vars 的访问速度造成的。语言和操作系统的填充和对齐规则。此外，由于字节顺序，在不同的硬件上写入和读取整数可能会出现问题。

将您的元数据逐个字节地写入一个不会被误解的结构中。以 Null 结尾的 ASCII 字符串是可以的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-14T11:37:20.630

I use a awesome open source piece of code written by Troy D. Hanson called TPL: [http://tpl.sourceforge.net/](http://tpl.sourceforge.net/). With TPL you don't have any external dependency. It's as simple as including tpl.c and tpl.h into your own program and use TPL API.

Here is the guide: [http://tpl.sourceforge.net/userguide.html](http://tpl.sourceforge.net/userguide.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-14T11:24:02.120

如果要以特定格式写入数据，请使用`unsigned char`...的数组

```
unsigned char outputdata[13];
outputdata[0] = 1;
outputdata[1] = 0;
/* ... of course, use data from struct ... */
outputdata[12] = 0;
fwrite(outputdata, sizeof outputdata, 1, fp); 
```

# xml - sharepoint 2007 中的 feature.xml 中的多个 Elements.xml

> ID：10153156
> 
> 赞同：0
> 
> 时间：2012-04-14T11:16:50.927
> 
> 标签：xml, sharepoint-2007

我只是在和我的团队成员讨论用一个共享点功能做多件事。讨论以一个挑战结束，我在这里需要你的一点帮助。

我有一个问题：

1.  我们可以在功能上做多件事吗，比如我想创建一个列表，同时还想为创建的同一个列表添加新的 ECB 菜单项链接。

所以一个功能在feature.xml中有多个elements.xml现在是我脑海中的一个大问题。实际上我关注了这些链接，它让我感到困惑， [http: //social.msdn.microsoft.com/forums/en-US/sharepointdevelopment/thread/40076dc2-8be6-4019-bf1e-54067880e8a8/](http://social.msdn.microsoft.com/forums/en-US/sharepointdevelopment/thread/40076dc2-8be6-4019-bf1e-54067880e8a8/)

不确定sharepoint 2007是否允许这些？？？

谢谢，穆克什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T13:23:04.037

是的，一个功能可以有多个元素清单。

来自[ElementManifest 元素（功能）](http://msdn.microsoft.com/en-us/library/ms453427%28v=office.12%29.aspx)：

> **出现次数**
> 
> 最小值：0
> 
> 最大值：无界

此外，[Feature.xml 文件](http://msdn.microsoft.com/en-us/library/ms475601%28v=office.12%29.aspx)中的示例显示了单个功能中的多个元素清单：

```
<Feature 
  Id="11111111-1111-1111-1111-11111111111" 
  Title="Location Services"
  Description="This Feature contains lists and parts that let you link location data to your customer lists."
  Scope="Web">
  <ActivationDependencies>
    <ActivationDependency
      FeatureId="11111111-1111-1111-1111-111111111111" />
  </ActivationDependencies>
  <ElementManifests>
    <ElementManifest 
      Location="Location\LocationPart.xml"/>
    <ElementManifest 
      Location="CustomerLocation\CustomerLocationList.xml"/>
    <ElementFile 
      Location="test.aspx"/>
  </ElementManifests>
  <Properties>
    <Property
      Key="Color"
      Value="Blue"/>
    <Property
      Key="Shape"
      Value="Triangle"/>
  </Properties> 
</Feature> 
```

需要注意的一点是，您特别询问了单个功能是否可以包含多个名为 Elements.xml 的文件。答案也是肯定的，前提是每个 Elements.xml 文件都位于唯一的目录中。由于这些功能依赖于文件系统，因此您显然不能在同一个目录中同时拥有两个名为 Elements.xml 的不同文件。

# c# - XNA 音乐实时混音

> ID：10153162
> 
> 赞同：2
> 
> 时间：2012-04-14T11:17:55.997
> 
> 标签：c#, xna, xna-4.0, mixing, background-music

我创建了一个“格式”来存储音乐片段（前奏部分、重复部分、结尾部分）和这些片段的时间信息（偏移量、得分长度），这样我就可以实时混合它，就好像它是一个一段音乐，同时无限期地重复重复的部分（可选）。这样，片段可以在播放下一个片段的位置存储衰减，而前一个片段已完成。（我在 Java 中为此创建了一个播放器，并使用了 Clip 类。）

我想要这种格式，所以我可以提供有限长度的音乐（用于点唱机功能），同时我在游戏中播放无限长度的音乐。

但是，当我想在 XNA 中编写一个管理这种“格式”的类时，我注意到，没有明显的方法可以同时/重叠播放“歌曲”。我该怎么做/什么是最佳实践，而不是离开 XNA 框架？（我不想创建无限的播放列表。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T20:13:34.053

您可能想研究[XACT](http://msdn.microsoft.com/en-us/library/bb203895%28v=xnagamestudio.20%29.aspx)。它应该随您的 XNA 副本一起安装。XACT 是一款试听软件，可让您为游戏中的音频设置一些逻辑。它与 XNA 基本无缝集成。我认为，如果您研究 XACT 的一些高级功能，您也许可以让它完成您需要的工作。它非常强大，但有一个学习曲线。

在 XACT 之外，您会遇到更困难的情况。我想不出任何办法在香草 C#/XNA 代码中做到这一点。不过，XACT 旨在弥补这个缺点，因此您应该使用它。

至于 XACT 的未来，我相信它已经死了（就像，将来可能不会被支持）。至少 DirectX 版本是。不过，我不认为他们会完全放弃这个想法，因为就像我说的那样——在 XNA 中以这种级别的控制来管理音频确实没有可比的方法。

# excel - Visual Basic Excel 宏

> ID：10153163
> 
> 赞同：0
> 
> 时间：2012-04-14T11:17:58.180
> 
> 标签：excel, vba

我想在excel中有一个小宏。宏应该从 A1 中获取一个双数并将这个数字乘以 5 并将其返回到 A1 但我总是收到错误消息等。

到目前为止我的代码：

```
Function multiply()
Dim a As Long
For a = 1 To 65563
cell(a,3) = cell(a,3).Value * 5
next a
End Function 
```

我以前没有使用过 VBA。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T11:41:56.407

这可以满足您的要求，但它是一个子项，因为您无法使用函数编辑工作表值

```
 Public Sub multiply()
    On Error GoTo err
    Dim val As Long
    val = ActiveSheet.Cells(1, 1).Value
    ActiveSheet.Cells(1, 1).Value = val * 5
    Exit Sub
 err:
 End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T11:59:41.710

你不需要使用函数，只需使用这些潜艇：

您可以在下面对所有 **列 A **值进行多重播放：

```
Sub example()
For a = 1 To 65563
Cells(a, 1).Value = Cells(a, 1).Value * 5
Next a
End Sub 
```

考虑到 65563 CELLS 不是一个好主意，我建议您使用下面的 sub 来计算行数并减少内存使用量。

```
Sub example2()

Dim countrows As Long
   countrows = Range("A" & Rows.Count).End(xlUp).Row
For a = 1 To countrows
Cells(a, 1).Value = Cells(a, 1).Value * 5
Next a
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T04:50:12.870

您实际上并不需要宏 - 尽管如果您确实想使用 VBA，您可以完全避免耗时的循环

**`1 Manual Method using Paste Special - Multiply`**

从[沃肯巴赫](http://j-walk.com/ss/excel/usertips/tip059.htm)

要将值范围增加 5 倍：

1.  在任何空白单元格中输入 5。
2.  选择单元格并选择编辑、复制。
3.  选择值的范围（在您的示例中为 A 列），然后选择“编辑”、“选择性粘贴”。
4.  选择乘法选项，然后单击确定。
5.  删除包含 5 的单元格

**`2 Code using Paste Special - Multiply`**

[使用来自vbax](http://www.vbaexpress.com/kb/getarticle.php?kb_id=47)的 Zack Barresse 的代码- 稍作修改

此代码使用用户输入的乘数更新所选范围

```
Sub psMultiply()
    ' http://www.vbaexpress.com/kb/getarticle.php?kb_id=47
    Dim y As Long 'The multiplier value, user-defined
    Dim x As Range 'Just a blank cell for variable
    Dim z As Range 'Selection to work with
    Set z = Selection
    y = Application.InputBox("Enter selection multiplier:", _
    Title:="Selection multiplier", Default:=10, Type:=1)
    Set x = Cells(Rows.Count, "A").End(xlUp).Offset(1)
    If y = 0 Then Exit Sub 'Cancel button will = 0, hence cancel
    If x <> "" Then
        Exit Sub
    Else: x.Value = y
        x.Copy
        z.PasteSpecial Paste:=xlPasteAll, Operation:=xlMultiply
        Application.CutCopyMode = False 'Kill copy mode
    End If
    x.ClearContents 'Back to normal
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T15:02:50.100

为什么不通过仅乘以您选择的数字使其更通用一点：

```
Sub MultiplyByFive()
    Dim cl As Range

    For Each cl In Selection
        cl = cl * 5
    Next cl
End Sub 
```

这样可以避免`65536`硬编码。

# solr - Solr / Lucene 测试查询agains doc没有索引

> ID：10153164
> 
> 赞同：0
> 
> 时间：2012-04-14T11:18:03.390
> 
> 标签：solr, lucene

在实际索引它们之前，我需要测试某些文档是否与查询匹配。你会怎么做？我正在考虑的一种可能性是在内存（ramdisk？）上运行一个普通的 lucene 索引，并在将它发送到实际的 Solr 服务器之前，为我拥有的每个新文档执行一个索引 -> 测试查询 -> 删除循环。

谁能想到一个更好的解决方案来解决这个问题？

非常感谢。

**更新：**

看起来这可能是一个很好的起点：[http ://www.lucenetutorial.com/lucene-in-5-minutes.html](http://www.lucenetutorial.com/lucene-in-5-minutes.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T11:59:21.173

由于 Solr 允许事务/提交，您实际上可以对它们进行索引，并且在您提交之前声明一个删除查询，该查询会删除所有不匹配的文档。

```
/**
 * @author Omnaest
 */
public class SolrSimpleIndexingTest
{
  protected SolrServer solrServer = newSolrServerInstance();

  @Test
  public void testSolr() throws IOException,
                        SolrServerException
  {

    {
      SolrInputDocument solrInputDocument = new SolrInputDocument();
      {
        solrInputDocument.addField( "id", "0" );
        solrInputDocument.addField( "text", "test1" );
      }
      this.solrServer.add( solrInputDocument );
    }
    {
      SolrInputDocument solrInputDocument = new SolrInputDocument();
      {
        solrInputDocument.addField( "id", "1" );
        solrInputDocument.addField( "text", "test2" );
      }
      this.solrServer.add( solrInputDocument );
    }
    this.solrServer.deleteByQuery( "text:([* TO *] -test2)" );
    this.solrServer.commit();

    /*
     * Now your index does only contain the document with id=1 !!
     */

    QueryResponse queryResponse = this.solrServer.query( new SolrQuery().setQuery( "*:*" ) );
    SolrDocumentList solrDocumentList = queryResponse.getResults();

    assertEquals( 1, solrDocumentList.size() );
    assertEquals( "1", solrDocumentList.get( 0 ).getFieldValue( "id" ) );
  }

  /**
   * @return
   */
  private static CommonsHttpSolrServer newSolrServerInstance()
  {
    try
    {
      return new CommonsHttpSolrServer( "http://localhost:8983/solr" );
    }
    catch ( MalformedURLException e )
    {
      e.printStackTrace();
      fail();
    }
    return null;
  }
} 
```

# java - Java多线程和文件

> ID：10153166
> 
> 赞同：0
> 
> 时间：2012-04-14T11:18:28.940
> 
> 标签：java, multithreading, concurrency, io, directory

我正在做项目。其中一部分是读取给定的文件夹文件。程序深入并收集我包装到我自己的 DFile 类中的文件名和其他信息，并将其放入集合中以供进一步工作。它在单线程（使用递归读取）时工作，但我想从多线程的角度来做，忽略磁盘 IO 和多线程不会提高性能的事情。我想要它用于学习目的。

到目前为止，我一直在从一个决定跳到另一个决定，改变计划如何去做，但不能做得很好。您的帮助将不胜感激。

我想要什么，我提供根文件夹名称，并且我的程序运行几个小线程（为此目的，用户定义的线程数），每个线程读取给定的文件夹内容： - 当它找到文件时，将其包装到 DFile 并放入共享之间线程集合 - 当它找到文件夹时，将文件夹（作为文件对象）放入 jobQueue，以便其他可用线程对其进行处理。

我无法正确获取此系统。我一直在更改代码，考虑应该从一个具有静态集合的类到多个类。到目前为止，我在这里列出的几类：

DirectoryCrawler [http://pastebin.com/8tVGpGT9](http://pastebin.com/8tVGpGT9)

不会发布我的其余工作（可能在其他主题中，因为这里绝对没有涵盖程序的目的）。程序应该读取文件夹并在其中列出文件列表，然后对其进行排序（我可能也会使用多线程），然后搜索相同的散列文件，并且有不断工作的线程将这些相同的文件组写入结果文件。我不需要获得任何性能，文件会很小，因为一开始我正在研究速度，我现在不需要它。

任何有关阅读设计的帮助将不胜感激

编辑：

非常头疼:((。不能正常工作:(到目前为止：爬虫（就像一个用于读取一个文件夹的迷你线程，找到的文件进入其他类的fileList，以及进入队列的文件夹）pastebin.com/AkJLAUhD

扫描仪类（甚至不知道它是否可以运行）。DirectoryScanner（主要，应该控制爬虫，保存主要文件列表）pastebin。com/2abGMgG9 。

DFile 本身 pastebin。com/8uqPWh6Z（散列出现问题，现在排序时得到相同的散列..工作..（散列用于其他不相关的任务））。

过去 ebin 的文件列表。com/Q2yM6ZwS

测试代码：

```
DirectoryScanner reader = new DirectoryScanner(4);
for (int i = 0; i < 4; i ++) {
    reader.runTask(new DirectoryCrawler("myroot", reader));
}
try {
    reader.kill();
    while (!reader.isDone()) {
        System.out.println("notdone");
    }
    reader.getFileList().print();
} 
```

myroot 是一个文件夹，其中包含一些用于测试的文件

任何事情，我什至想不出扫描仪本身应该是可运行的，还是只能是爬虫。因为在扫描时，我实际上不想开始做其他的事情，比如排序（因为没有收集所有文件时没有任何东西可以排序）..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T12:17:59.853

您需要 Executor 线程池和一些类：

一个 Fsearch 类。这包含您的结果容器。它还有一个工厂方法，该方法返回一个 Ffolder，对“foldersOutstanding”计数器进行计数，以及一个 OnComplete，它通过对“foldersOutstanding”进行计数来重新计算它们：

您需要一个 Ffolder 类来表示一个文件夹，并将其路径作为 ctor 参数传递。它应该有一个迭代的运行方法是作为参数提供的文件夹路径以及 Fsearch 实例。

使用根文件夹创建并加载一个 Fsearch 并将其发射到池中。它创建一个文件夹类，传递它的根路径和它的文件，然后加载它。然后它等待“searchComplete”事件。

第一个 Ffolder 迭代其文件夹，为每个“普通”文件创建（或分离）DFiles，并将它们推送到 Fsearch 容器中。如果它找到一个文件夹，它会从 Fsearch 中获取另一个 Ffolder，用新路径加载它，并将其加载到池中。

当 Ffolder 完成对自己的文件夹的迭代时，它会调用 Fsearch 的 OnComplete' 方法。OnComplete 正在倒计时“foldersOutstanding”，当它减到零时，所有文件夹都已被扫描并已处理文件。执行此最终减量的线程向 searchComplete 事件发出信号，以便 Fsearch 可以继续。Fsearch 可以调用一些在创建时传递的“OnSearchComplete”事件。

毫无疑问，Fsearch 回调必须是线程安全的。

这样的练习不一定是学术性的。所有 DFile 所在的 Fsearch 中的容器可能是一个生产者-消费者队列。其他线程可以在搜索过程中开始处理 DFile，而不是等到结束。

我以前做过这个（但不是在 Java 中），它工作正常。像这样的设计可以轻松地并行执行多个搜索 - 一次发出多个硬盘驱动器根的 Fsearch 很有趣 - 咔哒声令人印象深刻

忘了说 - 这种设计的最大好处是在搜索多个具有高延迟的网络驱动器时。它们都可以并行搜索。单线程顺序搜索的速度提升了很多倍。当单线程搜索完成对一个驱动器的 DFile 的排队时，多重搜索已经搜索了四个驱动器并且已经处理了大部分 DFile。

笔记：

1) 如果按照上面严格执行，执行 FSearch 的线程池线程在 'OnSearchComplete' 事件上被阻塞，直到搜索结束，所以'用完'一个线程。因此，线程池线程必须比活动的 Fsearch 实例多，否则将没有剩余线程来进行实际搜索（是的，这当然发生在我身上：）。

2) 与单线程搜索不同，结果不会以任何可预测或可重复的顺序返回。例如，如果您在结果进入 GUI 线程时发出信号并尝试在 TreeView 中显示它们，则每个结果通过 treeview 组件的路径可能会有所不同，更新可视化 treeview 会很长。这可能会导致 Windows GUI 输入队列变满（10000 个限制），因为 GUI 无法跟上，或者，如果将对象池用于 Ffolder 等，池可能会清空，从而降低性能，并且如果 GUI 线程尝试获取一个 Ffolder 从空池中发出新的搜索等阻塞，所有 Ffolder 实例都卡在 Windows 消息中的全面死锁（是的，当然这发生在我身上：）。最好不要让这样的事情发生！

示例 - 我发现类似这样的东西 - 它是相当旧的 Windows/C++ Builder 代码，但它仍然有效 - 我在我的 Rad Studio 2009 上尝试过，删除了所有遗留/专有工具并添加了一些额外的注释。它在这里所做的只是计算文件夹和文件，就像一个例子一样。只有几个“可运行”类 myPool->submit() 方法将一个可运行对象加载到池中，然后它的 run() 方法被执行。基本 ctor 有一个 'OnComplete' EventHander，（TNotifyEvent），delgate 参数 - 当 run() 方法返回时由池线程触发。

//************************************ 类 **************** ******************

```
class DirSearch; // forward dec.

class ScanDir:public PoolTask{
    String FmyDirPath;
    DirSearch *FmySearch;
    TStringList *filesAndFolderNames;
public:                              // Counts for FmyDirPath only
    int fileCount,folderCount;
    ScanDir(String thisDirPath,DirSearch *mySearch);
    void run();                        // an override - called by pool thread
};

class DirSearch:public PoolTask{
    TNotifyEvent FonComplete;
    int dirCount;
    TEvent *searchCompleteEvent;
    CRITICAL_SECTION countLock;
public:
    String FdirPath;
    int totalFileCount,totalFolderCount;  // Count totals for all ScanDir's

    DirSearch(String dirPath, TNotifyEvent onComplete);
    ScanDir* getScanDir(String path);      // get a ScanDir and inc's count
    void run();                           // an override - called by pool thread
    void __fastcall scanCompleted(TObject *Sender); // called by ScanDir's
}; 
```

//******************************* 方法 **************** ******************

```
// ctor - just calls base ctor an initialzes stuff..
ScanDir::ScanDir(String thisDirPath,DirSearch *mySearch):FmySearch(mySearch),
        FmyDirPath(thisDirPath),fileCount(0),folderCount(0),
        PoolTask(0,mySearch->scanCompleted){};

void ScanDir::run()  // an override - called by pool thread
{
//  fileCount=0;
//  folderCount=0;
    filesAndFolderNames=listAllFoldersAndFiles(FmyDirPath); // gets files
    for (int index = 0; index < filesAndFolderNames->Count; index++)
    { // for all files in the folder..
        if((int)filesAndFolderNames->Objects[index]&faDirectory){
            folderCount++;  //do count and, if it's a folder, start another ScanDir
            String newFolderPath=FmyDirPath+"\\"+filesAndFolderNames->Strings[index];
            ScanDir* newScanDir=FmySearch->getScanDir(newFolderPath);
            myPool->submit(newScanDir);
        }
        else fileCount++; // inc 'ordinary' file count
    }
    delete(filesAndFolderNames); // don't leak the TStringList of filenames
};

DirSearch::DirSearch(String dirPath, TNotifyEvent onComplete):FdirPath(dirPath),
    FonComplete(onComplete),totalFileCount(0),totalFolderCount(0),dirCount(0),
    PoolTask(0,onComplete)
{
    InitializeCriticalSection(&countLock);  // thread-safe count
    searchCompleteEvent=new TEvent(NULL,false,false,"",false); // an event
                                        // for DirSearch to wait on till all ScanDir's done
};

ScanDir* DirSearch::getScanDir(String path)
{  // up the dirCount while providing a new DirSearch
    EnterCriticalSection(&countLock);
    dirCount++;
    LeaveCriticalSection(&countLock);
    return new ScanDir(path,this);
};

void DirSearch::run()  // called on pool thread
{
    ScanDir *firstScanDir=getScanDir(FdirPath); // get first ScanDir for top
    myPool->submit(firstScanDir);               // folder and set it going
    searchCompleteEvent->WaitFor(INFINITE);     // wait for them all to finish
}

/* NOTE - this is a DirSearch method, but it's called by the pool threads
running the DirScans when they complete.  The 'DirSearch' pool thread is stuck
on the searchCompleteEvent, waiting for all the DirScans to complete, at which
point the dirCount will be zero and the searchCompleteEvent signalled.
*/
void __fastcall DirSearch::scanCompleted(TObject *Sender){ // a DirSearch done
    ScanDir* thiscan=(ScanDir*)Sender;  // get the instance that completed back
    EnterCriticalSection(&countLock);   // thread-safe
    totalFileCount+=thiscan->fileCount;     // add DirSearch countst to totals
    totalFolderCount+=thiscan->folderCount;
    dirCount--;                           // another one gone..
    LeaveCriticalSection(&countLock);
    if(!dirCount) searchCompleteEvent->SetEvent(); // if all done, signal
    delete(thiscan);                      // another one bites the dust..
}; 
```

..在这里，工作：

![代码工作！](../Images/87c3c96f861a12df66a22ee56170ca87.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T11:34:03.163

如果你想通过一些实际的实现来学习一些多线程，最好选择从单线程活动切换到多线程活动实际上有意义的东西。

在这种情况下，它没有任何意义。而且，要实现它，需要编写一些难看的代码。这是因为您可以让一个线程仅处理一个子文件夹（根文件夹之后的第一级）。但是如果你从 200 个子文件夹开始呢？或者更多......在这种情况下200个线程有意义吗？我对此表示怀疑...

# xpages - 您如何将 onClick 事件添加到

> ID：10153168
> 
> 赞同：1
> 
> 时间：2012-04-14T11:18:39.880
> 
> 标签：xpages

我想让一个面板“可点击”并运行 SSJS 代码。以前，当我完成此操作时，我在面板中添加了一个表格 1 单元格 1 行，因为它有一个 onClick 事件。有没有办法在面板本身上做到这一点？

另外-如果有办法将 onClick 放在面板上，如果该面板包含链接，我假设该链接将位于面板本身的“上方”并且可以独立点击....对吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T14:52:11.893

只需在面板中添加一个 onClick 事件。以下是一些在单击面板时重定向到“另一个页面”的示例代码：

```
<xp:panel id="test">
    Click me
    <xp:eventHandler event="onclick" submit="true" refreshMode="complete">
        <xp:this.action><![CDATA[#{javascript:context.redirectToPage("anotherpage.xsp")}]]></xp:this.action>
    </xp:eventHandler>
</xp:panel> 
```

如果您向面板添加链接，则该链接位于面板“上方”：

```
<xp:panel id="test">
    Click me!
    <xp:link escape="true" text="and me!" id="link1">
        <xp:eventHandler event="onclick" submit="true" refreshMode="complete">
            <xp:this.action><![CDATA[#{javascript:context.redirectToPage("page.xsp")}]]></xp:this.action>
        </xp:eventHandler>
    </xp:link>

    <xp:eventHandler event="onclick" submit="true" refreshMode="complete">
        <xp:this.action><![CDATA[#{javascript:context.redirectToPage("window.xsp")}]]></xp:this.action>
    </xp:eventHandler>
</xp:panel> 
```

# java - 在 Tomcat 应用程序的 shell 脚本/访问中设置环境变量

> ID：10153174
> 
> 赞同：9
> 
> 时间：2012-04-14T11:19:04.980
> 
> 标签：java, linux, tomcat, environment-variables, ubuntu-10.04

我想添加可以通过我的 tomcat web-app 访问的环境变量。我已经浏览了[这个链接](https://stackoverflow.com/questions/10140182/set-environment-variable-in-shell-script-access-in-java-program/10140291#10140291)，但我想在 root 用户中设置环境变量。怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-12-11T07:52:27.383

根据文档（[http://tomcat.apache.org/tomcat-7.0-doc/RUNNING.txt](http://tomcat.apache.org/tomcat-7.0-doc/RUNNING.txt)），您应该在 $CATALINA_HOME/bin/setenv.sh 中设置所有环境变量

编辑：为了完整起见，我想值得一提的是，即使这是推荐的方式，上面的文档指出：

> 默认情况下不存在 setenv 脚本文件。如果脚本文件同时存在于 CATALINA_BASE 和 CATALINA_HOME 中，则首选 CATALINA_BASE 中的那个。

如果它不存在，您可能还想在以下位置查找环境变量：

*   `/etc/tomcat/tomcat[67].conf`（使用）或
*   `/etc/default/tomcat[67].conf`（例如ubuntu）或
*   `/etc/sysconfig/tomcat[67].conf`（rhel，软呢帽）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-17T08:14:45.820

这是你可以做到的

1.  sudo su 和 cd 到 /var/lib/tomcat8/bin/ （或者你的 tomcat bin 路径）
2.  触摸 setenv.sh（如果它不存在），如果文件已经存在，则执行 'vi setenv.sh'
3.  chmod 777 setenv.sh（使文件可执行）
4.  vi setenv.sh 并在 setenv.sh export key=value 中设置以下行
5.  sudo systemctl 重启 tomcat.service

在您的 java 文件中，您可以使用以下代码检查变量是否已设置

```
private static void printEnv() {
    System.out.println("******************************Environment Vars*****************************");
    Map<String, String> enviorntmentVars = System.getenv();
    enviorntmentVars.entrySet().forEach(System.out::println);

    System.out.println("******************************system Vars*****************************");
    Properties enviorntmentProperties = System.getProperties();
    enviorntmentVars.entrySet().forEach(System.out::println);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T08:59:36.547

得到了解决方案......我所做的是我将导出语句放在 `/etc/init.d/tomcat6`顶部并通过命令重新启动服务器`sudo /etc/init.d/tomcat6 restart`。所以现在我在 tomcat 服务器中运行的 web 应用程序可以访问该变量。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-14T12:09:36.767

这行不通吗？

转到您的环境文件。sudo vi /etc/environment 并添加所需的变量。并保存文件。

我认为在最近的 Ubuntu 中，您必须重新启动系统才能使更改生效。

# android - 如何通过 Facebook Android SDK 向好友发送应用请求

> ID：10153175
> 
> 赞同：6
> 
> 时间：2012-04-14T11:19:09.070
> 
> 标签：android, facebook, facebook-graph-api

目前我正在为我使用 Facebook SDK 开发一个 Android 应用程序。将消息发布到墙上等效果很好，但是通过这个 SDK 我无法向其他人发送应用程序请求。

谁能帮我吗？

这是我的代码片段：

```
Bundle params = new Bundle();
params.putString("message", getString(R.string.request_message));
Utility.mFacebook.dialog(Hackbook.this, "apprequests", params, new AppRequestsListener()); 
```

和*AppRequestsListener*：

```
public class AppRequestsListener extends BaseDialogListener {
    @Override
    public void onComplete(Bundle values) {
        Toast toast = Toast.makeText(getApplicationContext(), "App request sent", Toast.LENGTH_SHORT);
        toast.show();
    }

    @Override
    public void onFacebookError(FacebookError error) {
        Toast.makeText(getApplicationContext(), "Facebook Error: " + error.getMessage(), Toast.LENGTH_SHORT).show();
    }

    @Override
    public void onCancel() {
        Toast toast = Toast.makeText(getApplicationContext(), "App request cancelled", Toast.LENGTH_SHORT);
        toast.show();
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-14T14:06:38.903

从 SDK 版本 3.0 开始，您使用 WebDialog。下面是一个示例，说明如何使用提供的 Builder 来创建一个，该 Builder 使用所有可用参数：

```
private void sendRequestDialog() {
    Bundle params = new Bundle();
    params.putString("title", "Send a Request");
    params.putString("message", "Learn how to make your Android apps social");
    params.putString("to", "12343543,32423534");  // comma seperated list of facebook IDs to preset the recipients. If left out, it will show a Friend Picker.
    params.putString("data",
        "{\"badge_of_awesomeness\":\"1\"," +
        "\"social_karma\":\"5\"}");  // any additional data

    WebDialog requestsDialog = (
        new WebDialog.RequestsDialogBuilder(getActivity(), Session.getActiveSession(), params))
            .setOnCompleteListener(new OnCompleteListener() {

                @Override
                public void onComplete(Bundle values, FacebookException error) {
                    // do something, e.g. show toast message
                }   
            })
            .build();
    requestsDialog.show();
} 
```

参考：[Android 版 Facebook SDK 3.0：发送请求](http://developers.facebook.com/docs/howtos/androidsdk/3.0/send-requests/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-20T09:24:41.787

**使用 Facebook API 3.0**

**1.发送好友请求**

```
Bundle params = new Bundle();
params.putString("message", "Learn how to make your Android apps social");

RequestsDialogBuilder builder = new RequestsDialogBuilder(MainActivity.this,
                                    Session.getActiveSession(), params);

builder.setOnCompleteListener(new OnCompleteListener() {

    @Override
    public void onComplete(Bundle values, FacebookException error) {

        if (error != null){
            if (error instanceof FacebookOperationCanceledException){
                Toast.makeText(MainActivity.this,"Request cancelled",Toast.LENGTH_SHORT).show();
            }
            else{
                Toast.makeText(MainActivity.this,"Network Error",Toast.LENGTH_SHORT).show();
            }
        }
        else{

            final String requestId = values.getString("request");
            if (requestId != null) {
                Toast.makeText(MainActivity.this,"Request sent",Toast.LENGTH_SHORT).show();
            } 
            else {
                Toast.makeText(MainActivity.this,"Request cancelled",Toast.LENGTH_SHORT).show();
            }
        }
    }
});

WebDialog requestDialog = builder.build();
requestDialog.show(); 
```

**2.发送应用请求**

```
Bundle parameters = new Bundle();
parameters.putString("message", "Send Request");

WebDialog.Builder builder = new Builder(MainActivity.this, Session.getActiveSession(),
                                "apprequests", parameters);

builder.setOnCompleteListener(new OnCompleteListener() {

    @Override
    public void onComplete(Bundle values, FacebookException error) {
        if (error != null){
            if (error instanceof FacebookOperationCanceledException){
                Toast.makeText(MainActivity.this,"Request cancelled",Toast.LENGTH_SHORT).show();
            }
            else{
                Toast.makeText(MainActivity.this,"Network Error",Toast.LENGTH_SHORT).show();
            }
        }
        else{

            final String requestId = values.getString("request");
            if (requestId != null) {
                Toast.makeText(MainActivity.this,"Request sent",Toast.LENGTH_SHORT).show();
            } 
            else {
                Toast.makeText(MainActivity.this,"Request cancelled",Toast.LENGTH_SHORT).show();
            }
        }                       
    }
});

WebDialog webDialog = builder.build();
webDialog.show(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-14T12:21:27.767

android sdk 有您可以使用的[对话框](http://developers.facebook.com/docs/reference/androidsdk/dialog/)，当您打开一个对话框时，您可以指定要打开哪个对话框。

[您可以在Dialogs](http://developers.facebook.com/docs/reference/dialogs/)文档中查看可用对话框的列表。其中一个对话框是[请求对话框](http://developers.facebook.com/docs/reference/dialogs/requests/)，您也可以从 android sdk 打开它，例如：

```
Facebook facebook = new Facebook("YOUR_APP_ID");

....

Bundle params = new Bundle();
params.putString("title", "invite friends");
facebook.dialog(this, "apprequests", params, new DialogListener() {
    @Override
    public void onComplete(Bundle values) {}

    @Override
    public void onFacebookError(FacebookError error) {}

    @Override
    public void onError(DialogError e) {}

    @Override
    public void onCancel() {}
}); 
```

您可以为此对话框添加更多参数，使用文档查看您需要什么。

* * *

# 编辑

好的，看看这段代码：

```
Bundle paramsOut = new Bundle(), paramsIn = this.getIntent().getExtras();
paramsOut.putString("message", paramsIn.getString("message"));
this.facebook.dialog(this, "apprequests", paramsOut, new InviteListener(this)); 
```

我使用它，它对我来说效果很好，正在发送应用程序请求并且用户接收它。由于您的代码非常相似，因此可以安全地假设问题出在不同之处，因此您应该将代码发布到不同之处。

那么，您的*AppRequestsListener*中有什么？说它只是显示一个弹出窗口并不能帮助我帮助你。另外，这个 *Hackbook 是什么？它是一项活动吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-09T10:24:00.293

这段代码在 Facebook Sdk 3.0 中对我来说很好用

```
 private void sendRequestDialog(final String userId) {
         Bundle params = new Bundle();       
         params.putString("title", "Invite Friend");
         params.putString("message", "has invite has you to try out " +
                 "The perfect gamified experience for today's smart and social Cricket fan " +
                 "Download now on your ANDROID device!");
         // comma seperated list of facebook IDs to preset the recipients. If left out, it will show a Friend Picker.
         params.putString("to",  userId);  // your friend id

         WebDialog requestsDialog = ( new WebDialog.RequestsDialogBuilder(MainActivity.this,
                 Session.getActiveSession(), params)).setOnCompleteListener(new OnCompleteListener() {
            @Override
            public void onComplete(Bundle values, FacebookException error) {
                //   Auto-generated method stub                     
                if (error != null) {
                    if (error instanceof FacebookOperationCanceledException) {
                        Toast.makeText(MainActivity.this.getApplicationContext(), 
                                "Request cancelled", Toast.LENGTH_SHORT).show();
                    } else {
                        Toast.makeText(MainActivity.this.getApplicationContext(), 
                                "Network Error",  Toast.LENGTH_SHORT).show();
                    }
                } else {
                    final String requestId = values.getString("request");
                    if (requestId != null) {
                        Toast.makeText(MainActivity.this.getApplicationContext(), 
                                "Request sent",  Toast.LENGTH_SHORT).show();
                        Log.i("TAG", " onComplete req dia ");                                   
                    } else {
                        Toast.makeText(MainActivity.this.getApplicationContext(), 
                                "Request cancelled", Toast.LENGTH_SHORT).show();
                    }
                }                   
            }
         }).build();
         requestsDialog.show();
     } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-04T00:47:27.997

我认为您缺少实际发送请求的 onComplete 中的代码。您在 onComplete 中所拥有的只是祝酒词，这就是为什么您会收到一条消息说请求已发送的原因。您需要一个返回 ID 才能实际发送请求。

```
public void onComplete(Bundle values) {
    final String returnId = values.getString("request");

    if (returnId != null) {
        Toast.makeText(getApplicationContext(),
                       "Request sent " + returnId,
                       Toast.LENGTH_SHORT).show();
    }
} 
```

您必须实际发送 onComplete 的值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-29T03:38:22.247

**使用 Facebook Api < 3.0 - 发送应用请求**

参考：[https ://stackoverflow.com/users/1237937/kirit](https://stackoverflow.com/users/1237937/kirit)

```
public void run() {
            Bundle parameters = new Bundle();
            parameters.putString("message", "Send Request");

        WebDialog.Builder builder = new WebDialog.Builder(ConnectionSearchFacebook.this, facebookConnector.getFacebook().getSession(),
                "apprequests", parameters);

        builder.setOnCompleteListener(new WebDialog.OnCompleteListener() {
            @Override
            public void onComplete(Bundle values, FacebookException error) {
                if (error != null){
                    if (error instanceof FacebookOperationCanceledException){
                        Toast.makeText(ConnectionSearchFacebook.this,"Request cancelled",Toast.LENGTH_SHORT).show();
                    }
                    else{
                        Toast.makeText(ConnectionSearchFacebook.this,"Network Error",Toast.LENGTH_SHORT).show();
                    }
                }
                else{

                    final String requestId = values.getString("request");
                    if (requestId != null) {
                        Toast.makeText(ConnectionSearchFacebook.this,"Request sent",Toast.LENGTH_SHORT).show();
                    }
                    else {
                        Toast.makeText(ConnectionSearchFacebook.this,"Request cancelled",Toast.LENGTH_SHORT).show();
                    }
                }
            }
        });

        WebDialog webDialog = builder.build();
        webDialog.show();

    } 
```

# java - JSmooth Java 1.4 或更高版本未找到错误

> ID：10153176
> 
> 赞同：2
> 
> 时间：2012-04-14T11:19:18.050
> 
> 标签：java, jar, exe, jsmooth

我已经安装了 JSmooth。我的电脑有 JDK 1.7 和 JRE 1.7。但它说需要java 1.4或更高版本才能打开并尝试下载。这是为什么 ？？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-08-18T11:18:57.367

您需要将`JAVA_HOME`环境变量设置为您的 JDK 或 JRE 基本路径，例如`C:\Program Files\Java\jdk1.8.0_91`. 为此，请转到控制面板 -> 高级系统设置 -> 高级 -> 环境变量 -> 系统变量 -> 新建。

我最初对同样的问题感到困惑，因为`java`并且`javac`正在命令行上工作，所以我认为所有变量都已设置，但`JAVA_HOME`在安装 JDK 时似乎没有默认设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T09:10:31.927

我一整夜也遇到同样的问题。我再次安装了JVM，再次安装了JSmooth，没有发生任何事情......然后我下载并安装了[这个](http://www.dmt.com/jvm_download.htm)，突然它识别出了JVM。我想，要访问 JVM，这个应用程序需要 Microsoft VM ......不过是粗略的猜测！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T11:27:17.503

来自 JSmooth 文档

> 启动时出现问题，包装器不会启动我的 java 应用程序。我该如何调查？
> 
> 首先要做的是使用附加参数 -JskelDebug=1 运行包装器（该选项区分大小写）。这将以调试模式启动包装器，显示一个控制台（或使用当前的控制台，用于控制台包装器），并输出许多有用的信息。

# permissions - 在 Plesk 主机的根文件夹中更改权限时不运行 Orchard cms

> ID：10153178
> 
> 赞同：0
> 
> 时间：2012-04-14T11:19:34.793
> 
> 标签：permissions, orchardcms, plesk

我将果园 cms 部署到 Plesk 主机

我的网站在 Plesk Hosting 中运行良好

我去主页>域>（我的域）>虚拟目录>目录属性

目前我允许写权限和脚本和可执行文件

当我取消选中“写入权限”和“脚本和可执行文件”=> 它在 Chrome 中显示“此虚拟目录不允许列出内容”和在 IE9 中显示“网站拒绝显示此网页”

我再次检查“写入权限”和“脚本和可执行文件”，网站仍然无法正常工作

请告诉我如何调试，请救救我！

预先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T16:39:23.627

这个问题有一个超级简单的解决方案：不要删除写权限。他们是需要的。至于为什么重新检查这些框并没有恢复网站，您应该与您的托管公司交谈，这似乎是他们方面的一个问题。您可能需要重新启动 appdomain，看看它是否有所作为。如果您想对需要写入权限的内容进行更细粒度的控制，app_data、模块、主题和媒体都需要它。

# php - 用户类 - “加载”数据

> ID：10153180
> 
> 赞同：0
> 
> 时间：2012-04-14T11:19:42.307
> 
> 标签：php

```
<?php

class User {

    private $id;
    private $username;

    public function __construct($id = null) {
        $this->id = $id;

        if (!is_null($this->id)) {
            $this->load();
        }
    }

    public function load() {

    }

}

?> 
```

在“加载”方法中，我将从当前用户 (id) 加载所有信息，但我想知道如何加载所有信息的最佳方式。我可以获取所有数据，然后分配所有私有变量，但我认为必须有另一种“更便宜”的方式来获取所有数据，这样我就可以这样使用

$this->变量；

并且不必分配每个数据行，我在加载方法中选择。如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:25:49.080

我假设以下内容：

*   每个用户对象代表数据库中的 1 行
*   您可以在关联数组中检索用户的信息：

    `$user = array('name' => 'John', 'age' => 20);`

那么也许在你的方法中使用变量 variables 可能是一个可行的解决方案`load()`：

```
foreach($user as $key => $userData){
   $this->$$key = $userData; //Note the use of variables variable
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T11:22:36.770

您可以在 php 中像这样分配多个变量：

```
private function getUserData() {
  return array("42", "JohnDoe");
}

public function load() {
  list($this->id, $this->username) = getUserData();
} 
```

# css - CSS3中的极坐标变换？

> ID：10153184
> 
> 赞同：13
> 
> 时间：2012-04-14T11:20:34.140
> 
> 标签：css, css-transforms

在 GIMP 等图形程序中，将一条线变成一个环是一项简单的任务：

[![过滤器⇒扭曲⇒极坐标](../Images/129c4a730d28fd883c4316a4de3c0abf.png)](https://i.stack.imgur.com/7lQZe.png)
[（来源：[adamhaskell.net](http://adamhaskell.net/img/transform.png)）]

我正在尝试确定是否可以在 CSS 中产生相同的效果。

所以我制定了以下内容：

*   上述算法映射`x`到`r`和`y`到`θ`
*   为此，`x`缩放到 的范围`[0,w/2]`，其中`w`是图像的宽度
*   此外，`y`被缩放到的范围`[0,2π]`
*   将极坐标转换回笛卡尔：`xc = rp*cos(θp)`和`yc = rp*sin(θp)`
*   然后翻译结果，使原点位于图像的中心。
*   所以我们有：

```
x' = (x/2)*cos(y/h*2π) + w/2;  
y' = (x/2)*sin(y/h*2π) + h/2; 
```

这一切都很好而且很花哨，但是我怎样才能在 CSS 中产生这样的转换呢？大概没有一个关键字是有用的，所以它必须是矩阵变换。好吧，我不知道如何从上面的两个方程构建一个矩阵，更不用说如何在 CSS 变换中表示它了。

谁能帮我完成这最后一步？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T12:04:57.330

我从来没有使用过 CSS 变换矩阵，但我认为你想要的是**不可能的**。使用变换矩阵，您可以进行**线性变换**。线性变换总是**将直线映射到直线**或 0。[查看 Wikipedia 了解更多信息](http://en.wikipedia.org/wiki/Linear_transformation)。

因此，使用矩阵将直线映射到圆是不可能的。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-14T12:26:02.407

至少你可以使用 2 个对称的三阶贝塞尔曲线

Y(t) = (t^3,t^2,t,1) * M * (P0,P1,P2,P3)

t - 时间

P0 - P3 控制点坐标。这个向量必须是垂直的。我不知道如何在这个编辑器中制作垂直向量。

Y(t) - 曲线坐标

M - 4*4 矩阵 第 1 行 (-1,3,-3,1) 第 2 行 (3,-6,-3,0) 第 3 行 (-3,3,0,0) 第 4 行 (1,0 ,0,0)

现在您只需要一个从您的线坐标定义控制点的函数。

# security - 内网规划/我需要什么

> ID：10153185
> 
> 赞同：0
> 
> 时间：2012-04-14T11:20:51.877
> 
> 标签：security, content-management-system, intranet

好的，所以我的任务是为我的公司的潜在新客户构建 Intranet 进行“研究”，他们希望在周一之前得到某种答案（就像任何公司一样，他们真的想要这个项目）。

也就是说，我一直在做“研究”，并且打开了很多选项卡/窗口，以至于我发疯了，因为我的研究没有方向而迷失了方向……吸收太多，需要帮助。

经过简短的解释后，我有 2 个问题。

> 从本质上讲，根据我的理解，Intranet 是......简单来说，一个离线的网站？由于可用的文件（我认为它适用于学校）以及可以访问它们但也可以访问互联网的人，因此具有更深的框架？因为它是针对一所学校的（不确定它是主要针对教师还是教师 **和**学生），所以无论哪种方式，我都假设了很多文件。

除了隐私之外，在我的整个研究过程中，我阅读了很多关于文件安全、防火墙和……而且……我开始不知所措。

我自己，是一名网页设计师/马马虎虎的开发人员。对 js/jquery 和 php/mysql 的体面了解，虽然我觉得我刚刚开始涉足网络开发部分。对标准 HTML/css、设计器工具等有很好的了解...

也就是说，这些是我的问题。

1.计划创建这个实际上涉及什么？我可以使用哪些工具（如果可能，请阅读 CMS）来创建这些工具。想让这件事发生我真正需要什么，需要知道什么？我应该采取什么方向。如果你能指导我并帮助我关闭分布在我的 3 台显示器上的 30 多个链接中的一些，我欠你哈哈。

1.  我可以建造很多东西，而且不介意给它一个艰难的尝试，但是，这似乎是一个巨大的项目，而且我确信如果我的公司接受这份工作，我一定会去做。现在我可以做这个项目的一些部分，但不能 100% 确定我是合适的人选。他们指望我对我是否能做是/否的回答（他们知道这很重要，而且需要时间来完成）但是所以......以我上面发布的技能，我是合适的人吗？还是这更像是一个经过实践检验的真正的开发人员？

感谢您抽出宝贵的时间，任何提示/链接/cms 信息/我的意思是任何能让这更容易的东西，请不要犹豫分享。我不介意做研究，但我需要方向。

我不想告诉他们“是的，我可以做到”，并且在一两个月后，我的暂停卡住了，“是”变成了“不，我做不到”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:33:45.080

如果您没有建立网络的经验，那么您可能不是这份工作的人选（除非您的客户愿意让您在不成功、不收费的基础上尝试一下）。当然不要过度承诺和交付不足！

我与很多学校打交道，我知道许多较小的学校会使用秘书的计算机作为服务器，通过简单的 Windows 家庭网络将文件放置在共享目录中。在他们自己的管理技能范围内，这是一种廉价而愉快的选择。

您还应该与具有相关监督的政府部门（我想是教育部）联系，以了解可用或需要哪些指导方针、要求*和补助金。*这里可能有一个特定的推荐路线，并为您提供量身定制的防火墙保护。

较大的学校将投资购买适当的服务器，并配备自动外部备份。但是，我没有资格就如何设置它们提供建议。希望这里的其他人会:)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T11:30:49.143

CMS 可以作为 Intranet 网站包含在内，但 Intranet 包含的内容远不止 CMS。你最好的策略是告诉你的老板找一个网络系统集成商来合作完成这个项目。Intranet 涉及更多的网络技术（L2、L3、交换、路由、防火墙、无线等）和物理仪器（例如布线）。

# android - 放置 where 条件

> ID：10153189
> 
> 赞同：0
> 
> 时间：2012-04-14T11:21:50.200
> 
> 标签：android, android-emulator, sqlite

我想出了以下查询：

```
SELECT ROOMNO,BUILDINGNO 
FROM MRM_ROOM_DETAILS 
WHERE ROOMID IN (
    SELECT distinct roomid 
    FROM MRM_BOOKING_DETAILS 
    WHERE (CHECKIN NOT BETWEEN '2012-04-13 09:50:00' AND '2012-04-13 10:20:00') 
    AND (CHECKOUT NOT BETWEEN '2012-04-13 09:50:00' AND '2012-04-13 10:20:00')) 
AND CAPACITY > 15 
AND PROJECTIONSTATUS = 'NO'; 
```

我需要将此查询放在 SQLiteDatabase.query() 方法中并相应地获取行。我无法理解如何放置这个大的 where 条件（也包含一个子查询）来代替“字符串选择”，即方法的第三个参数。我应该将整个 where 部分（包括子查询）简单地写为第三个参数中的字符串，还是有其他更好的方法来做同样的事情？

请建议我最好的方法来做同样的事情。

问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:40:29.527

我肯定会使用[rawQuery](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#rawQuery%28java.lang.String,%20java.lang.String%5B%5D%29)而不是查询。这里重要的是您使用`selectionArgs`参数来防止注入。

```
string sql = "SELECT ROOMNO,BUILDINGNO 
FROM MRM_ROOM_DETAILS 
WHERE ROOMID IN (
    SELECT distinct roomid 
    FROM MRM_BOOKING_DETAILS 
    WHERE (CHECKIN NOT BETWEEN '2012-04-13 09:50:00' AND '2012-04-13 10:20:00') 
    AND (CHECKOUT NOT BETWEEN '2012-04-13 09:50:00' AND '2012-04-13 10:20:00')) 
AND CAPACITY > 15 
AND PROJECTIONSTATUS = 'NO';";
db.rawQuery(sql, null); // <---- here null would be replaced with your 
                        // parameters in order to prevent injection 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T11:41:38.310

是的，您只需提供完整的“where 条件”（不包括“WHERE”，包括逐字查询）作为`selection`SqliteDatabase.query() 的参数。

您需要担心的是*性能*。您事先不知道您将在数据库设备上遇到什么 SQLite 版本，并且众所周知，子查询有时会执行得相当糟糕，尤其是与 LIMIT 子句结合使用时。

确保在多个设备上测试此查询（除非受影响的行数微不足道）。您可以通过将其拆分为多个语句来获得一些性能，首先简单地检索预订详细信息，然后获取房间详细信息。

# iphone - 使用 iphone 中的按钮点击在视图中的多个位置创建文本字段

> ID：10153191
> 
> 赞同：-1
> 
> 时间：2012-04-14T11:21:54.000
> 
> 标签：iphone, ios4, iphone-sdk-3.0

朋友们

我有两个按钮，一个用于在视图中创建文本字段，另一个用于从视图中删除文本字段，但每个文本字段都处于不同的 2 位置，所以请帮助我，谢谢。对不起我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T08:40:35.263

在您的视图控制器中，为文本字段设置一个数组 -

。H -

```
@property (nonatomic, retain) NSMutableArray *myTextFields; 
```

.m -

```
#define kScreenWidth                480.0 // or set this up elsewhere according to device, etc
#define kScreenHeight               320.0
#define kTextFieldWidth             150.0
#define kTextFieldHeight            36.0

@synthesize myTextFields;

-(id)init {

    self = [super initWithNibName:@"MyViewController" bundle:nil];
    if (self) {
        myTextFields = [[NSMutableArray alloc] init];
    }
    return self;
}

-(IBAction)addTextField {

    CGFloat x = ((CGFloat) rand() / RAND_MAX) * (kScreenWidth - kTextFieldWidth);
    CGFloat y = ((CGFloat) rand() / RAND_MAX) * (kScreenHeight - kTextFieldHeight);

    UITextField *theTextField = [[[UITextField alloc] initWithFrame:CGRectMake(x, y, kTextFieldWidth, kTextFieldHeight)] autorelease];

    theTextField.tag = [myTextFields count] + 1; // so you know which one is being edited

    // set up other text field properties here, like delegate, background, font, etc.

    [self.view addSubview:theTextField];
    [myTextFields addObject:theTextField];

}

-(IBAction)removeTextField {

    if (![myTextFields count]) return;

    UITextField *theTextField = [myTextFields lastObject];

    [theTextField removeFromSuperview];
    [myTextFields removeLastObject];

} 
```

如果您不希望任何文本字段重叠，则必须在生成随机位置时进行检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T02:44:02.597

在这里，我为您提供示例代码。此代码将生成 100 个（//或者您可以根据您的要求生成任何文本字段）具有随机位置的文本字段，您只需单击一下即可删除所有此文本字段...

```
UITextField *t[100];//declare it in .h file...

-(void)randomtextfield
{
int n = 100;
int temp;
  for (int i = 0 ; i < 100 ; i++)
  {
    int r = arc4random()%n;
    if(r != temp){
        temp = r;
        CGRect r1 = t[i].frame;      
        t[i].frame = t[temp].frame;
        t[temp].frame = r1; 

        n--;
        [self.view addSubview:t[i]];
     }

 }

}

-(IBAction)addtextfield
{
int x,y;
x=0;
y=0;

for (int i = 0; i<100;i++)
{

    t[i] = [[UITextField alloc]init];
    t[i].frame = CGRectMake(x, y, 100, 30);
    t[i].borderStyle = UITextBorderStyleBezel;

    if(x<320)
    {
        x = x+100;
    }

    else
    {
        x=0;
    }

    if (y<480)
    {
        y= y+30;
    }

    else
    {
        y=0;
    }
  }
  [self randomtextfield];

 }

-(IBAction)removertextfield:(id)sender
{
  NSMutableArray *array = [[NSMutableSet alloc]initWithArray:[self.view subviews]];
   {
    [textfield removeFromSuperview];
   }
 [array release];
} 
```

希望这会帮助你。

# asp.net - 成功插入数据后如何清除单选按钮列表？

> ID：10153199
> 
> 赞同：6
> 
> 时间：2012-04-14T11:23:12.780
> 
> 标签：asp.net, visual-studio

任何人都可以帮我解决这个简单的问题。如何在表单提交后清除单选按钮列表的选择。我需要在我的 asp.net Web 应用程序中使用它。当用户单击清除按钮时，我需要清除单选按钮列表的选择。提前致谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-14T11:36:47.490

您可以 - 设置 myrbList.SelectedIndex = -1，- 或通过其 .Items 进行 foreach 并设置每个 item.Selected = false

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-11T03:09:09.003

```
RadioButtonList1.ClearSelection(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-04T11:20:20.003

//代码示例：

foreach(ListItem li in RadioButtonList1)`
{
if(li.Selected)
{
li.Selected = false;
}
}
//或者使用这个（这是最好的
RadioButtonList1.SelectIndex = -1

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-23T12:06:13.717

使用这行代码 insted 循环遍历每个项目，使用 foreach 清除 RadioButtonList

```
RadioButtonList1.SelectedIndex=-1; 
```

# php - 使用 IE 浏览器中的复制粘贴发送 html 电子邮件

> ID：10153201
> 
> 赞同：0
> 
> 时间：2012-04-14T11:23:34.043
> 
> 标签：php, internet-explorer, email, outlook

我有 html 必须通过电子邮件发送。

当我使用邮件功能通过 php 发送它时，它在 gmail、outlook、yahoo 等中看起来不错。

但是当我在 IE 浏览器中看到该 html 并将粘贴复制到 Outlook 并发送电子邮件时，邮件不会呈现我使用 php 邮件获得的正确 html。

我可以在 Outlook 中管理相同的复制过去吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:15:40.600

我有类似的问题，将文本从一个应用程序复制粘贴到下一个应用程序。

通常我会通过其他一些应用程序来解决问题：例如，您可以尝试将文本从 IE 复制到 Word 或记事本或其他任何东西，然后从那里复制到 Outlook，而不是从 IE 复制文本到 Outlook。您也可以尝试使用 Firefox 或 Chrome 并将文本从那里复制到 Outlook。

我只有 UTF-8 文本有这个问题，所以如果你自己是你复制的 HTML 的作者，你也可以尝试在另一个字符集中编码 HTML。

此外，检查 Outlook 中的默认字符集设置。如果您以 ISO-8859-1 格式打开一封新（空）电子邮件，然后复制编码为 UTF-8 的文本，这可能会导致问题。

# c# - XPathNavigator.Evaluate 返回不正确的值？

> ID：10153204
> 
> 赞同：0
> 
> 时间：2012-04-14T11:23:47.610
> 
> 标签：c#, xml, xpath

我期待这段代码返回true，但它没有？我在这里想念什么。

```
 string xml = @"<!DOCTYPE root [ <!ELEMENT e (e*) ><!ATTLIST e  id    ID    #REQUIRED>]>
         <data><e id=""NUM_CPUS"">2</e><e id=""ACE_PRESENT"">1</e></data>";
  XPathDocument doc = new XPathDocument(new StringReader(xml));
  string expr = "(id('NUM_CPUS'))>=1 and (id('ACE_PRESENT'))=1";
  XPathNavigator nav = doc.CreateNavigator();

  XPathExpression query = nav.Compile(expr);

  object result = nav.Evaluate(query);
  bool b = bool.Parse(result.ToString());

  if (!b)
    throw new Exception("Should be true"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T15:06:28.307

添加标题，使这项工作：

```
<!DOCTYPE root [ <!ELEMENT e (e*) ><!ATTLIST e  id    ID    #REQUIRED>]> 
```

# html - datatables.net 插件将左侧菜单隐藏在 IE 中的表格后面

> ID：10153214
> 
> 赞同：0
> 
> 时间：2012-04-14T11:25:17.843
> 
> 标签：html, css, jquery-datatables

我有一个在 IE 中完美运行的页面。然后我使用 DOMReady 中的这段代码和这段代码
添加了精彩的 jQuery 插件[Datatables](http://datatables.net/)

```
$('#articlestable-container table').dataTable({
    "bPaginate": true,
    "bLengthChange": false,
    "bFilter": true,
    "bSort": false,
    "bInfo": false,
    "bAutoWidth": false
}); 
```

在 Webkit 和 Firefox 浏览器中一切正常。看图片。

![在 Firefox 中渲染](../Images/ddd073a581cb1d909391b5906d9954c0.png)

但是在 IE 中，表格隐藏了理想情况下应该像这样在表格上方出现的菜单。

![在 IE 中渲染](../Images/ca32e215eceedb7ae080cf643ec9bb9a.png)

如您所见，子菜单呈现在表格后面。

我不认为 z-index 是这里的罪魁祸首。`z-index: 9999;`无论如何，子菜单都有。
有什么问题？解决此问题的任何指示都将非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:15:48.490

一直在使用 datatables.net 附带的默认 CSS。这里的包装器有`position:relative;`. 只需删除该代码，菜单就会正确显示。

```
.dataTables_wrapper {
    /*position: relative;*/
    clear: both;
    zoom: 1;  /*Feeling sorry for IE */
} 
```

我猜这是一个 IE 错误。[http://www.gobdg.com/blog/2009/04/positionrelative-z-index-ie-bug/](http://www.gobdg.com/blog/2009/04/positionrelative-z-index-ie-bug/)
但是手动设置`z-index:1;`对我不起作用。

免责声明：我还不知道这实际上是如何解决问题的。我不是 CSS 大师。

# asp.net - 加载 UserControl ASP.net 后的 page_load 填充数据

> ID：10153216
> 
> 赞同：0
> 
> 时间：2012-04-14T11:25:27.517
> 
> 标签：asp.net, user-controls, ascx, pageload

我有一个 aspx 页面，其中包含一个包含文本框的 userControl。

在 page_load 方法中，它从数据库中读取，我想用读取的数据填充用户控件的文本框。

我面临的问题是，页面加载流程是

页面的Page_Load，我在其中分配文本字段，然后是userControl的page_load，所以这里所有的数据都将被删除，然后它将显示页面。

我该如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T23:31:30.250

使用 OnDataBinding 或 OnPreRender

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T06:50:37.327

在这种情况下，您必须在Page_Init而不是Page_Load中填充UserControl的数据，这里的问题将得到解决:)

# php - preg_replace：如何不删除整个部分？

> ID：10153219
> 
> 赞同：1
> 
> 时间：2012-04-14T11:25:41.720
> 
> 标签：php, preg-replace

我得到了这个字符串：

```
$string = "hello123hello237ihello523"; 
```

我想搜索一个“o”后跟一个数字。然后我只想删除“o”。

我一直在尝试：

```
preg_replace("/kl[0-9]/", "", $string); 
```

问题是它也删除了数字。我只想删除“o”。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T11:29:26.910

使用积极的前瞻：

```
echo preg_replace("/o(?=[0-9])/", "", $string); 
```

欲了解更多信息：[http ://www.regular-expressions.info/lookaround.html](http://www.regular-expressions.info/lookaround.html)

另一种选择是：

```
echo preg_replace("/o([0-9])/", "\\1", $string); 
```

这将用 [number] 替换 o[number]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T11:36:52.197

您可以使用反向引用：

```
echo preg_replace('/o([0-9])/', '$1', $string); 
```

有关引用子模式的信息，请参阅[文档](http://www.php.net/manual/en/function.preg-replace.php)。

# c# - 找不到类型或命名空间名称“DropCreateDatabaseIfModelChanges”（您是否缺少 using 指令或程序集引用？）

> ID：10153231
> 
> 赞同：1
> 
> 时间：2012-04-14T11:27:24.043
> 
> 标签：c#, asp.net-mvc-3, entity-framework-4.1

我在 MVC3 中收到以下代码的错误，对此的任何帮助将不胜感激：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:29:54.767

您需要添加命名空间：

```
 using System.Data.Entity; 
```

并添加对`EntityFramework.dll`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-05T20:32:41.173

尝试使用 DropCreateDatabaseIfModelChanges，而不是 DropCreateDatabaseWhenModelChanges：

```
Database.SetInitializer<Context>(new DropCreateDatabaseIfModelChanges<Context>()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-07T08:01:04.700

用这个：`Database.SetInitializer(new DropCreateDatabaseIfModelChanges<YourDbContext>());`

# android - 只显示通知而不启动活动

> ID：10153232
> 
> 赞同：2
> 
> 时间：2012-04-14T11:27:30.173
> 
> 标签：android, notifications

我正在尝试开发一个用于组织的应用程序。因此，在为特定时间设置任务后，我创建了一个通知，因此此通知显示在状态栏上，当用户触摸此通知时，将出现当前活动。
我的问题是：当通知出现时，活动也启动了。
有什么办法可以防止这种情况发生吗？我的意思是当通知出现时活动不会自动启动，用户必须点击通知才能唤醒活动。

我里面有“Main”类和一个警报管理器。此警报管理器将在特定时间触发并启动另一个活动 (DisplayNotification)。

```
{
    Intent intent = new Intent("com.test.DisplayNotification");
    intent.putExtra("alarm_message", "Alarm");
    intent.putExtra("item_name", "message");
    PendingIntent broadcast = PendingIntent.getActivity(getBaseContext(), 0, intent, 0);
    AlarmManager am = (AlarmManager) getSystemService(Activity.ALARM_SERVICE);
    am.set(AlarmManager.RTC_WAKEUP, mili, broadcast);
} 
```

在 DisplayNotification 类中我有

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        String message = getIntent().getExtras().getString("item_name");

        Intent i = new Intent("com.test.Main");

        PendingIntent detailsIntent = 
            PendingIntent.getActivity(this, 0, i, 0);

        NotificationManager nm = (NotificationManager)
            getSystemService(NOTIFICATION_SERVICE);
        Notification notif = new Notification(
            R.drawable.icon, 
            "Time's up!",
            System.currentTimeMillis());

        CharSequence from = "AlarmManager - Time's up!";
        notif.setLatestEventInfo(this, from, message, detailsIntent);

        nm.notify(1, notif);
        //---destroy the activity---
        finish();

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T12:04:37.513

使用 a`BroadcastReceiver`来“监听”警报的结果，然后让它`Notification`在其`onReceive(...)`方法中创建。

# android - 在 Android 中使用 WindowManager 时发生类转换异常

> ID：10153238
> 
> 赞同：1
> 
> 时间：2012-04-14T11:28:28.030
> 
> 标签：android

我动态获取屏幕高度的代码：

```
Display display = ((Activity) getContext()).getWindowManager().getDefaultDisplay();
    Point size = new Point();
    display.getSize(size);
    int width = size.x;
    int height = size.y; 
```

错误：错误：java.lang.ClassCastException：android.app.Application 完整日志猫： http: [//pastebin.com/8zUNFUYn](http://pastebin.com/8zUNFUYn)

编辑：将代码更改为：

```
Display display =  (activity).getWindowManager().getDefaultDisplay();

        Point size = new Point();
        display.getSize(size);
        int width = size.x;
        int height = size.y; 
```

工作但是，给出了一个新错误，即 display.getSize(size) is not a method。该 API 是否已弃用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T11:44:05.017

> 语境

是 Application 和 Activity 的基类。由于您使用 获取应用程序`getContext()`，因此将其转换`Activity`为`ClassCastExecption`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T11:34:50.853

用这个替换你的行：

如果您在活动中使用此代码，请使用以下代码：

```
Display display = this.getContext().getWindowManager().getDefaultDisplay(); 
```

# extjs - 使用相同的函数重新渲染条形图，但 ExtJS 中的数据不同

> ID：10153239
> 
> 赞同：0
> 
> 时间：2012-04-14T11:28:41.873
> 
> 标签：extjs

我正在使用 extjs 使用函数创建条形图，该函数在更新时仍显示以前的条形图以及新的条形图。我想删除以前的条形图并显示当前图。我在同一个标​​签上使用了 renderTo。如何删除以前的条形图，或者有更好的方法来呈现新的条形图？

随着年份的变化，我的功能每次都会重复。

```
function drawchart () {
    genresC = new Ext.data.Store({
        reader: new Ext.data.JsonReader({
            fields: ['years', 'caseno'],
            record: 'rows',
            root: 'rows'
        }),
        baseParams: {
            param1: year,
            param2: ward_name
        },
        proxy: new Ext.data.HttpProxy({
            url: filetogo,
            method: 'GET'
        }),
        autoLoad: true
    });

    var baryear = new Ext.chart.ColumnChart({
        renderTo: "baryear",
        width: 250,
        height: 250,
        store: genresC,
        xField: 'years',
        yField: 'caseno'

    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T13:32:06.410

当您刷新商店时，图表应该会自动更新。

尝试这个：

```
var drawchart = (function() {
    var genresC;
    return function (year, ward_name, filetogo) {
        if (genresC) {
            genresC.setBaseParam('param1', newyear);
            genresC.setBaseParam('param2', ward_name);
            genresC.reload();
        } else {
            genresC = new Ext.data.Store({/*...as above*/});
            new Ext.chart.ColumnChart({/*...as above*/});
        }
    };
})(); 
```

# mysql - mysql索引合并问题

> ID：10153243
> 
> 赞同：1
> 
> 时间：2012-04-14T11:29:08.670
> 
> 标签：mysql, optimization, indexing

为什么mysql不使用index_merge？

看起来我的服务器有 index_merge ON，但优化器仍然没有考虑。

```
optimizer switch    index_merge=on,index_merge_union=on,index_merge_sort_union=on,index_merge_intersection=on

explain SELECT a,b FROM `zip25` WHERE b=91367 OR a=91367

id  select_type table   type    possible_keys   key key_len ref rows    Extra
1   SIMPLE          zip25   ALL a,b         NULL    NULL    NULL    752299  Using where 
```

**[编辑]**
表定义

```
CREATE TABLE `zip25` (
  `a` char(5) DEFAULT NULL,
  `b` char(5) DEFAULT NULL,
  `distance` float NOT NULL,
  KEY `a` (`a`),
  KEY `b` (`b`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:11:02.383

字段的数据类型是 char，但您在查询中使用整数。发生的事情是隐式转换为 char。这看起来不是什么严重的问题，但实际上它完全阻止了 MySQL 使用索引！始终注意数据类型！

将您的查询更改为：

`explain SELECT a,b FROM`zip25`WHERE b="91367" OR a="91367"`

# c - *(int*)NULL = 1 导致线程崩溃；有问题？

> ID：10153246
> 
> 赞同：6
> 
> 时间：2012-04-14T11:29:42.373
> 
> 标签：c, clang, assert, volatile, gcc-warning

我在一个多线程的 c 应用程序中发现了这一点。作者评论说，它用于在自定义断言函数中使线程崩溃。GCC 没问题，但 clang 发出以下警告：

```
note: consider using __builtin_trap() or qualifying pointer with 'volatile' 
```

并且还针对 assert 函数的每次使用发出其中一个：

```
warning: indirection of non-volatile null pointer will be deleted, not trap 
```

这里发生了什么？__builtin_trap 是特定于 clang 的吗？我应该使用它吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-14T11:44:00.747

不能保证写入`NULL`地址会可靠地使您的程序崩溃，因此为此[引入了 GCC`__builtin_trap`](http://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html)。

看起来 clang 决定走得更远，完全消除此类写入，几乎迫使您使用`__builtin_trap`. `NULL`与 相比，他们转换为指针的其他选项`volatile`看起来并不吸引人`__builtin_trap`，因为它“仅仅是”未定义的行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T11:42:29.000

该声明会引发未定义的行为。特别是编译器没有义务尝试在地址存储一些东西，`0`并且可以优化它。这就是编译器告诉你的。

使用`exit()`or`abort()`或一些派生类来终止整个流程的执行。这是便携式的。(C11 有`exit`, `_Exit`,`quick_exit`和`abort`)

# ios - 如何“安全地”更改 UIWindow 框架？

> ID：10153250
> 
> 赞同：1
> 
> 时间：2012-04-14T11:30:39.790
> 
> 标签：ios, cocoa-touch, uikit

背景：我正在努力创建一个临时显示在状态栏下的附加状态栏（实现为新的 UIWindow）。

为了实现我将应用程序的 keyWindow 向下偏移 20px: (0 20; 320 460) -> (0 40; 320 440) 然后向后向上 20px: (0 40; 320 440) -> (0 20; 320 460 ) 到目前为止，一切都按预期工作，keyWindow 向下移动然后向上移动。伟大的！

接下来，我将 keyWindow 的 rootViewController 从一个想要FullScreenLayout (UINavCtrl) 的一个更改为一个不需要的（一个普通的 UIViewCtrl）。问题来了，关键窗口向下移动了 20px。为什么？？？;(

我做了一些测试，当 rootViewController 从一个想要FullScreenLayout 的一个变为一个不需要的（反之亦然）时，它看起来像“通常”系统调整keyWindow 的框架 - 太棒了！但是，一旦“手动”更改了关键窗口框架，即使 rootViewController 更改之前的框架与操作系统设置时的框架完全相同（或者只是“未触及”，这个基于操作系统的自动布局似乎也被禁用了换句话说）。：/

# php - Mysqli DELETE QUERY 在 PHP 脚本中不起作用

> ID：10153255
> 
> 赞同：3
> 
> 时间：2012-04-14T11:31:11.333
> 
> 标签：php, database, mysqli

我使用以下代码从表中删除一个条目我想要做的是检查是否从表中删除了任何值。如果删除了一个值，脚本应该打印成功，否则为 false。这就是我已经取得的成就现在。请帮忙

```
<?PHP
    $mysqli = new mysqli("SQLHOST.COM","CLIENT","PASSWORD", "DNAME", 1234);

    if ($mysqli->connect_errno) {
        printf("Connect failed: %s\n", $mysqli->connect_error);
        exit();
    }
    else
    {

    printf("cONN Sucees");

    if ($result = $mysqli->query("DELETE FROM ktable WHERE code='value'")) {
        printf("Select returned %d rows.\n", $result->num_rows);

     printf($result->num_rows);
        $result->close();
    }

    }
    ?> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-14T11:36:30.860

你删除你需要返回的是`affected_rows` [http://www.php.net/manual/en/mysqli.affected-rows.php](http://www.php.net/manual/en/mysqli.affected-rows.php)

你需要更换什么

```
if ($result = $mysqli->query("DELETE FROM ktable WHERE code='value'")) {
    printf("Select returned %d rows.\n", $result->num_rows);

    printf($result->num_rows);
    $result->close();
} 
```

工作代码

```
$value = ""; // Set To any Value
$mysqli = new mysqli ( "SQLHOST.COM", "CLIENT", "PASSWORD", "DNAME", 1234 );
if ($mysqli->connect_errno) {
    printf ( "Connect failed: %s\n", $mysqli->connect_error );
    exit ();
} else {
    printf ( "cONN Sucees" );
    if ($mysqli->query (sprintf ( "DELETE FROM ktable WHERE code='%s'", mysqli_real_escape_string ( $mysqli, $value ) ) )) {
        printf ( "Affected Rows  %d rows.\n", $mysqli->affected_rows );
    }
} 
```

你应该有一个工作输出

# jsf - 用户成功登录后如何调用方法？

> ID：10153259
> 
> 赞同：0
> 
> 时间：2012-04-14T11:31:28.860
> 
> 标签：jsf

在 Glassfish 上使用容器管理的安全性，您如何制作单独的“个人资料”页面并限制只有登录的人才能更改它？假设你有用户“John”和“Amanda”，他们都有“用户”角色，你怎么能确定只有“John”可以改变他的个人资料页面，而不是“Amanda”？

```
<form method="POST" action="j_security_check">
    <table>
        <tr>
            <td>User name:</td>
            <td><input type="text" name="j_username" /></td>
        </tr>
        <tr>
            <td>Password:</td>
            <td><input type="password" name="j_password" /></td>
        </tr>
        <tr>
            <td><input type="submit" value="Login" /></td>
        </tr>
    </table>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:40:22.337

您不能检查会话中的登录用户和您被要求从数据库中获取的配置文件是否相同？如果它们不匹配，则用户无法编辑该页面。理想情况下，我会将这种用户会话逻辑放在服务器过滤器中，这样它就可以处理所有请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T05:41:02.783

这可以通过 SEAM Framework 轻松完成。您只需创建安全接口@Admin，然后创建一个检查器方法 public @Secure @Admin checkAdmin(Identity identity) {}

之后，您可以将 @Admin 添加到您的方法中。

您可以做的另一件事更容易：只需使用属性“rendered”并检查哪个用户已登录。

# c++ - SDL - C++ 中 LoopTimer 的 FPS 问题

> ID：10153260
> 
> 赞同：1
> 
> 时间：2012-04-14T11:31:37.947
> 
> 标签：c++, sdl, game-engine, frame-rate, game-loop

我们正在为我们的 c++ 类制作游戏引擎，除了 FPS 有一些小问题外，我们几乎完成了所有工作。它的运行速度总是比我们设置的慢 10-20%，我们想知道这是由于错误/蹩脚的代码还是它就是这样？如果我们将其设置为 500+，它的上限为 350，但这主要是由于计算机无法处理更多。如果我们将其设置为 50，我们会得到大约 40-44。

这是处理计时器的 LoopTimer 类的一些片段

标题：

```
class LoopTimer {
public:
    LoopTimer(const int fps = 50);
    ~LoopTimer();

    void Update();
    void SleepUntilNextFrame();

    float GetFPS() const;
    float GetDeltaFrameTime() const { return _deltaFrameTime; }

    void SetWantedFPS(const int wantedFPS);
    void SetAccumulatorInterval(const int accumulatorInterval);

private:
    int _wantedFPS;
    int _oldFrameTime;
    int _newFrameTime;
    int _deltaFrameTime;
    int _frames;
    int _accumulator;
    int _accumulatorInterval;
    float _averageFPS;
}; 
```

文件

```
LoopTimer::LoopTimer(const int fps)
{
    _wantedFPS = fps;
    _oldFrameTime = 0;
    _newFrameTime = 0;
    _deltaFrameTime = 0;
    _frames = 0;
    _accumulator = 0;
    _accumulatorInterval = 1000;
    _averageFPS = 0.0;
}
void LoopTimer::Update()
{
    _oldFrameTime = _newFrameTime;
    _newFrameTime = SDL_GetTicks();
    _deltaFrameTime = _newFrameTime - _oldFrameTime;

    _frames++;
    _accumulator += _deltaFrameTime;

    if(_accumulatorInterval < _accumulator)
    {
        _averageFPS = static_cast<float>(_frames / (_accumulator / 1000.f));
        //cout << "FPS: " << fixed << setprecision(1) << _averageFPS << endl;
        _frames = 0;
        _accumulator = 0;
    }
}

void LoopTimer::SleepUntilNextFrame()
{
    int timeThisFrame = SDL_GetTicks() - _newFrameTime;
    if(timeThisFrame < (1000 / _wantedFPS))
    {
        // Sleep the remaining frame time.
        SDL_Delay((1000 / _wantedFPS) - timeThisFrame);
    }
} 
```

更新基本上是在我们的 GameManager 中的 run 方法中调用的：

```
int GameManager::Run()
{
while(QUIT != _gameStatus)
    {
        SDL_Event ev;

        while(SDL_PollEvent(&ev))
    {
            _HandleEvent(&ev);
    }

    _Update();
    _Draw();

    _timer.SleepUntilNextFrame();
   }    
    return 0;
} 
```

如果需要，我可以提供更多代码，或者我很乐意将代码提供给任何可能需要它的人。包括 sdl_net 函数和诸如此类的东西在内发生了很多事情，所以没有必要将它们全部倾倒在这里。

无论如何，我希望有人对帧率有一个聪明的提示，无论是如何改进它，一个不同的循环定时器功能，或者只是告诉我在 fps 中有一点损失是正常的 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T14:35:48.103

我认为你的功能有误

```
int timeThisFrame = /* do you mean */ _deltaFrameTime;  //SDL_GetTicks() - _newFrameTime; 
```

# actionscript-3 - Actionscript 3.0 - 随机补间电影剪辑并随时间更改其字体系列

> ID：10153261
> 
> 赞同：0
> 
> 时间：2012-04-14T11:31:51.117
> 
> 标签：actionscript-3, tween, flash-cs5.5

我有一个电影剪辑，它由一个包含一些文本的文本框组成。

我正在尝试对这个影片剪辑进行补间，使其要么在整个动画中随机移动，要么让影片剪辑从边缘反弹，类似于您可能看到的标准屏幕保护程序。虽然通过许多不同的字体系列慢慢改变它的文本

是否可以通过动画随机补间电影剪辑，是否可以在缓慢的过渡中将文本更改为许多不同的系列。

我希望这是有道理的 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T12:51:17.637

查看[此链接](http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118a9b90204-7e0a.html)以获取有关脚本动画的一些指示。由于您想将此应用到一个`MovieClip`（在我接受它的 Flash IDE 中？），您必须扩展您的类并将`MovieClip`其分配给库中的影片剪辑。

将其从边缘反弹等是您必须自己编写代码的行为。我建议使用当前的运动矢量，例如

```
private var movement:Point; 
```

将其初始化为随机方向和值：

```
movement = new Point(Math.random(), Math.random());
movement.normalize(INITIAL_VELOCITY); 
```

以及每一帧，将其添加到影片剪辑的当前位置：

```
public function update():void {
    x += movement.x;
    y ++ movement.y;
    doBounce();
} 
```

弹跳：

```
public function doBounce():void {
    // something like:
    if (x + width + MARGIN) >= stage.width) movement.x *= -1; // bounce off right side
    if (x + MARGIN <= 0) movement.x *= -1; // bounce off left side
    // similar for y and height
} 
```

这是未经测试的代码，但应该可以帮助您入门。

关于字体之间的过渡主题：这取决于您想要的过渡。您可以淡出 1 （随着时间的推移`TextField`将其属性减少为 0），同时使用不同的字体淡入第二个。`alpha`如果你想在字体形状之间变形——我认为动态文本不可能，因为我认为你不能`Graphics`在 API 中“渲染”字体轮廓/字形，但不能 100% 确定。

# javascript - 迭代 json 响应

> ID：10153266
> 
> 赞同：0
> 
> 时间：2012-04-14T11:32:44.687
> 
> 标签：javascript

[http://paste.pocoo.org/show/VEB0PT7yZO1yuOxtrXGP/](http://paste.pocoo.org/show/VEB0PT7yZO1yuOxtrXGP/)

**我尝试了以下方式，但我无法得到结果。**

```
 for (i = 0, len = json.PatientListGetResult.Appointments.length; i < len && i <= 100; i++) {
          alert(json.PatientListGetResult.Appointments[i].Patient.PatientID);
      } 
```

我如何迭代此响应，以便我可以获得每个患者的姓名和 ID。共有 11 行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:36:31.580

在这里工作：http: [//jsfiddle.net/UsvFV/](http://jsfiddle.net/UsvFV/)

在 json 响应中，您错过了“}”（最后一个右大括号）

# java - 在Android中创建一个没有xml的ProgressBar

> ID：10153269
> 
> 赞同：4
> 
> 时间：2012-04-14T11:33:00.343
> 
> 标签：java, android, android-progressbar

我正在尝试仅使用 java创建一个 progressBar （不是一个**progressBar 对话框）。**

我不能让它工作，我得到的是：

![在此处输入图像描述](../Images/341e656b5e031b14bb80194b5b5a08d1.png)

*（不断转圈的图像）*

这是我的代码：

```
 b4 = new Button(this);
    t4 = new ProgressBar(this);

    b4.setId(4);
    b4.setText(SensorData.sensorName[4]);
    b4.setTypeface(null, 1);
    b4.setTextSize(15);
    b4.setGravity(Gravity.LEFT);
    b4.setTextColor(R.color.black);
    b4.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.icon, 0); // down

    // t4.setId(4);
    t4.setPadding(20, 10, 10, 10);
    t4.setIndeterminate(false);
    t4.setProgress(0);
    t4.setScrollBarStyle(ProgressBar.SCROLLBARS_OUTSIDE_INSET);
    t4.setMax(100);
    t4.setVisibility(t4.VISIBLE);

    sensorsView.addView(b4, new TableLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
    sensorsView.addView(t4, new TableLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));

    b4.setOnClickListener(this); 
```

我想要的是一个水平进度条，你知道我该怎么做吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T11:41:00.247

改变这个：

```
t4 = new ProgressBar(this); 
```

对此：

```
t4 = new ProgressBar(this, null, android.R.attr.progressBarStyleHorizontal); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-14T11:42:10.803

你可以这样做：

```
t4.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL) 
```

# c - 如何使用 C 学习 OpenGL 3.x？

> ID：10153272
> 
> 赞同：10
> 
> 时间：2012-04-14T11:33:34.133
> 
> 标签：c, opengl, cross-platform

我知道那里有*很多*关于 OpenGL 的教程，但是我发现所有好的教程都使用了一些 C++ 库（主要是 GLM），这使得想要使用 C 或/并且特定于 Microsoft Windows 的人很难理解。

我的问题是：

1.  有人知道使用 C 且不是 Windows 特定的优秀 OpenGL 3.x 教程吗？
2.  OpenGL“红皮书”使用哪种编程语言？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-14T11:48:10.820

> 有人知道使用 C 且不是 Windows 特定的优秀 OpenGL 3.x 教程吗？

如果我没记错的话，[Nicol Bolas 的教程](https://web.archive.org/web/20140209181347/http://www.arcsynthesis.org/gltut/)使用 C++（用于 GLM）。[我建议您在适用的情况下用我的linmath.h](https://github.com/datenwolf/linmath.h)替换 GLM 。

> OpenGL“红皮书”使用哪种编程语言？

较旧的版本（<= OpenGL-2.1）使用纯 C。较新的版本我实际上没有读过。

# c# - 需要在 TextChanged 中更改 TextBox.Text，迫使表单关闭

> ID：10153274
> 
> 赞同：3
> 
> 时间：2012-04-14T11:33:50.683
> 
> 标签：c#, winforms, textbox

我正在使 TextBox 的行为就像它可以存储空值一样。为了做到这一点，我有一个变量 NullMode 指示存储的值是否为 Null，在 TextChanged 中我将其设置为 false，在特定的用户操作中我将其设置为 true，将 Text 设置为指示存在的值文本框内为空。然后，基于 NullMode，以不同的方式绘制文本框。

现在，我有一种类似信号量的方法，以防止在我不需要事件句柄时触发它。这是它的外观：

```
 private void input_TextChanged(object sender, EventArgs e)
        {
            if (_preventTextBoxEvents) 
                return;

            _preventTextBoxEvents = true;

            //if (NullMode)
            //  Text = "";
            NullMode = false;
            ValidateInput();

            _preventTextBoxEvents = false;
        } 
```

现在，如果我需要将文本框文本设置为在 null 模式下应该显示的内容，我只需在执行之前将 _preventTextBoxEvents 设置为 true，它就可以正常工作。

但！当用户尝试在文本框中输入内容时，我还需要删除文本！所以我需要将文本设置为“”。问题是，如果我取消注释，表单在事件处理程序退出后关闭。我无法阻止它（FormClosing 中的 e.Cancel = true 无济于事！）并且不明白是什么原因造成的。也没有错误消息（而且我没有尝试捕获）。

我的逻辑，当我做 Text="" 时。OnTextChanged 应该触发，它应该调用我的 TextChanged 并且它会看到 _preventTextBoxEvents 为真并退出，因此不会有堆栈溢出/无限递归。

到底是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T11:40:01.557

应该是这样（假设您的文本框被调用`input`）

```
if (NullMode) 
    input.Text = ""; 
```

单独的文本是指当前表单标题，而不是 input.Text 属性。
但是，让我说您的方法很危险。如果由于某种原因，您的 ValidateInput 引发异常，您将退出事件处理程序而不将全局 _preventTextBoxEvents 恢复为 false；

添加一个try-catch-finally

```
 private void input_TextChanged(object sender, EventArgs e)   
    {   
        if (_preventTextBoxEvents)    
            return;   

        _preventTextBoxEvents = true;   
        try
        {
           if (NullMode) input.Text = "";   
           NullMode = false;   
           ValidateInput();   
        }
        catch(Exception ex)
        {
            // Inform user of the exception occurred inside your ValidateInput
            MessageBox.Show(ex.Message);
        }
        finally
        {
            // Be sure to restore this global to a functioning value.
            _preventTextBoxEvents = false;   
        }
    } 
```

此外，您可以删除**_preventTextBoxEvents**的逻辑，只需在程序输入事件代码时断开 TextChanged 事件：

```
try
{
    input.TextChanged -= new EventArgs(input_TextChanged);
    // Now, the input textbox is no more connected to this code, you 
    // could happily change the textbox text without worry to reenter in this code
}
...
finally
{
    // Work finished, reconnect this code to the event TextChanged
    input.TextChanged += new EventArgs(input_TextChanged);
} 
```

# android - 如果我想知道它何时结束但我不需要结果或关心它是否被取消，我该如何启动它？

> ID：10153277
> 
> 赞同：0
> 
> 时间：2012-04-14T11:34:10.480
> 
> 标签：android, android-activity

长解释如下。

我的主要活动 A 是按顺序开始其他 3 个活动 B、C 和 D。

我需要 B 发生并完成或被取消，然后 C 在这里我需要知道它是否被取消或按下按钮然后如果 C 没有被取消 D 将被启动。

B 几乎只是一个闪屏，所以我想让用户通过后退按钮跳过它。这就是为什么我不在乎它如何完成。我只需要知道它什么时候结束。所以A可以启动C。

C 就像应用程序的主菜单。因此，如果用户退出它，那么我想“退出”应用程序。我还不确定我希望该退出如何发生，但现在它只是一个调用完成（）。如果用户选择了一个选项，那么其他活动将从 A 调用，我现在只是调用它们 D。这将是 C 中 resultCode 的一个开关。

我应该在启动 A 时只使用 startActivityForResult 然后忽略结果是什么，还是有更好的方法我错过了？

我对 android 活动还不是很熟悉，所以我完全有可能只是在 API 中遗漏了一些明显的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:48:30.073

可以从B开始C吗？这样，您可以在按钮（或计时器）事件处理程序中处理 C 的启动并完成 B。

# image - 罪恶之城效应

> ID：10153283
> 
> 赞同：3
> 
> 时间：2012-04-14T11:35:16.817
> 
> 标签：image, algorithm, image-processing, effects

如标题所示，我正在寻找一种算法来产生罪恶之城电影中使用的效果，即从图像中选择一种颜色并对其余部分进行去饱和处理。

![图片](../Images/154ac43649de94abcab94ba256289051.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T11:41:59.917

理论上，它应该足够简单：

*   将每个像素转换为[HSL](http://en.wikipedia.org/wiki/HLS_color_space)。
*   如果色调在给定范围内，则将饱和度增加一定量。
*   否则，将饱和度设置为 0。
*   将 HSL 值转换回 RGB 并继续下一个像素。

您需要进行试验以确定您需要多大的色调范围，以及增加多少饱和度。

这可能不会给你完美的结果。即使输入场景中的人已经是绿色，而其他所有颜色都绝对不是绿色（除非你故意这样安排，否则你不能指望它），你可能会得到一些不太理想的结果“绿人”和“背景”的界限。考虑到电影必须使用的那种预算，我怀疑他们在需要的地方做了很多手动修饰。但是您可以靠近并尝试从那里进行调整。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T11:44:12.743

将图像转换为 HSV 空间，并将所有色调的饱和度设置为零，除了您要保留的色调。

# xml - 将 XML 存储在关系数据库中的基本原理

> ID：10153285
> 
> 赞同：1
> 
> 时间：2012-04-14T11:35:35.067
> 
> 标签：xml, oracle, sql-server-2008

我需要解释为什么我们需要将 XML 文档存储在数据库中。

在好的方面：

1.  无需将单个元素分解为表格并归属于列
2.  无需维护表之间的关系，因为它们自包含在 XML 中
3.  可跨共享 XML 的系统移植
4.  如果有需要，实际上所有 DBMS 都支持 XML 操作以将 XML 作为关系实体进行查询。

不利的一面：

1.  网络有效负载比 RDBMS 计数器部分大得多。
2.  要求客户端应用程序将它们分解为可用组件。

这些理由是否有效？谁能想到更多？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T13:25:23.807

没有真正的明确的赞成名单 - 它取决于你想要做什么。但这里还有几个供您考虑：

1.  并非所有 SQL 数据库都支持 XML xpath（超出`blob like '%xxx%'`）。也许您被困在一个不支持 XML 功能的旧版本的数据库上（例如，Mysql 4）。Sqlite 和 hsql 等更轻量级的 SQL 数据库也属于这个阵营。
2.  即使可以在数据库中搜索 XML，它也不是最优的。XML 的 SQL 搜索不能利用 SQL 服务器内置的搜索优化（即索引）。
3.  根据您使用的数据库，数据库中的 XML 文档也无法利用 SQL 服务器的验证和类型功能。例如，Oracle 可以进行 XML 模式验证，而我看不到 Mysql 可以。
4.  您可以执行的查询的性能无法与标准列查询进行比较。
5.  数据库大小。如果您将 XML 存储在数据库中，它会变得更大。你可以压缩它，但是查询它会很困难/不可能。
6.  [规范化](http://en.wikipedia.org/wiki/Database_normalization)问题可能会成为相关问题 - 也许您不希望在某些时候使用 SQL 来查询 XML，但后来它决定实际需要某些字段。您可能需要将该字段从 XML 中提取出来并填充一个实际的列，以便获得所需的性能……在这种情况下，您现在的数据库中有冗余信息。

利弊实际上取决于您将要存储的内容及其用途。

1.  如果它本质上是二进制/配置信息，您只需要粘贴在某个地方，并且出于某种原因更喜欢粘贴在您的 SQL 数据库中……那么，关于查询的考虑是不相关的。在这种情况下，重要的问题将涉及空间以及如何将其最小化（即压缩）。
2.  如果有任何可能需要定期搜索 XML，那么您将面临查询缓慢和我上面提到的冗余问题的风险。在这种情况下，您应该预先仔细考虑您*的长期设计：您真的需要将这些数据存储为 XML 吗？*从该数据构造 XML 会更好吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T12:43:34.507

讨论您的评论：

1.  不存储单个元素也意味着不对它们实施约束
2.  同样，不存储表之间的约束
3.  仅当目标系统确认相同的模式时才可移植。
4.  是的，但性能会有所不同。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-14T11:53:25.617

这两种情况都有利有弊，这取决于您的使用场景。

存储为 XML 本身的主要缺点是我们无法快速搜索特定数据。要执行搜索，我们必须检索并解析所有 XML 文件。

我们在一个项目中遇到了类似的情况。经过讨论，我们采取了一种中间立场：所有主要信息（需要快速查询的信息）都存储在相关表中。我们还存储了 XML；但我们没有像这样存储 XML，而是将 XML 保存到磁盘并在表中使用该文件路径。

# java - JAVA：gmt到本地时间的转换

> ID：10153286
> 
> 赞同：7
> 
> 时间：2012-04-14T11:35:49.590
> 
> 标签：java, timezone

我正在用java开发一个软件。

我从服务器获得 GMT 时间戳。该软件可以在世界任何地方使用。现在我想获取软件运行的本地时区，并将这个 GMT 时间转换为本地时间。

请告诉我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T11:51:23.687

要获取您的本地时区：

Calendar.getInstance().getTimeZone().getDisplayName()

对于转换：

[java中的日期时区转换？](https://stackoverflow.com/questions/5422089/date-timezone-conversion-in-java)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-14T12:25:18.357

假设您`timestamp`是 a`Date`或`Number`：

```
final DateFormat formatter = DateFormat.getDateTimeInstance();
formatter.setTimeZone(TimeZone.getTimeZone("America/New_York"));
System.out.println(formatter.format(timestamp)); 
```

如果您的时间戳记为`String`，您首先必须对其进行解析。您会在 中找到大量具有自定义格式的示例[`SimpleDateFormat`](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)，这是一个具有内置格式的简单示例：

```
final DateFormat formatter = DateFormat.getDateTimeInstance();
formatter.setTimeZone(TimeZone.getTimeZone("GMT"));
final Date timezone = formatter.parse("2012-04-14 14:23:34");
formatter.setTimeZone(TimeZone.getTimeZone("America/New_York"));
System.out.println(formatter.format(timezone)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T11:41:35.970

看看乔达时间。它具有人们需要的所有与日期相关的功能

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-14T19:35:05.210

假设格式中的服务器时间`yyyy/MM/dd HH:mm:ss.SSS`有效：

```
String serverTime = "2017/12/06 21:04:07.406"; // GMT
ZonedDateTime gmtTime = LocalDateTime.parse(serverTime, DateTimeFormatter.ofPattern("yyyy/MM/dd HH:mm:ss.SSS")).atZone(ZoneId.of("GMT"));
LocalDateTime localTime = gmtTime.withZoneSameInstant(ZoneId.systemDefault()).toLocalDateTime(); 
```

# vb.net - 将 c 结构编组到 .NET 时结构大小无效

> ID：10153287
> 
> 赞同：2
> 
> 时间：2012-04-14T11:35:52.943
> 
> 标签：vb.net, marshalling, wrapper, sizeof, structure

我遇到了以下 c 结构的问题：

```
typedef struct tagTEXTUREPROP
{
   DWORD  dwSize;
   DOUBLE eGloss;
   DOUBLE eContrast;
   BOOL   bRepeat;
   DOUBLE eDropX;
   DOUBLE eDropY;
   DOUBLE ePlacingPointX;
   DOUBLE ePlacingPointY;
   DOUBLE eWidth;
   DOUBLE eHeight;
   LONG   nTransformation;
} 
TEXTUREPROP; 
```

在哪里

```
TYPE     C/C++            Description
-------------------------------------------------------------------
DWORD    unsigned long    Unsigned 32-bit integer.
DOUBLE   double           Double precision floating point (64-bit).
BOOL     int              Signed 32-bit integer.
LONG     long             Signed 32-bit integer. 
```

我从上面的代码和定义中了解到，结构的大小必须是 76 字节。这就是我当前使用的原始 DLL 函数期望的结构成员 dwSize 的值。任何其他值都会生成无效的结构大小错误消息。

我正在生成一个 .NET 包装器，因此我必须进行一些编组。这是我对结构的翻译：

```
 <StructLayoutAttribute(LayoutKind.Explicit)> 
  Friend Structure TEXTUREPROP
    <FieldOffset(0)> <MarshalAsAttribute(UnmanagedType.U4)> Public dwSize As UInteger
    <FieldOffset(4)> <MarshalAsAttribute(UnmanagedType.R8)> Public eGloss As Double
    <FieldOffset(12)> <MarshalAsAttribute(UnmanagedType.R8)> Public eContrast As Double
    <FieldOffset(20)> <MarshalAsAttribute(UnmanagedType.I4)> Public bRepeat As Integer
    <FieldOffset(24)> <MarshalAsAttribute(UnmanagedType.R8)> Public eDropX As Double
    <FieldOffset(32)> <MarshalAsAttribute(UnmanagedType.R8)> Public eDropY As Double
    <FieldOffset(40)> <MarshalAsAttribute(UnmanagedType.R8)> Public ePlacingPointX As Double
    <FieldOffset(48)> <MarshalAsAttribute(UnmanagedType.R8)> Public ePlacingPointY As Double
    <FieldOffset(56)> <MarshalAsAttribute(UnmanagedType.R8)> Public eWidth As Double
    <FieldOffset(64)> <MarshalAsAttribute(UnmanagedType.R8)> Public eHeight As Double
    <FieldOffset(72)> <MarshalAsAttribute(UnmanagedType.I4)> Public nTransformation As Integer
  End Structure 
```

为了计算结构的大小，我使用以下代码：

```
Dim pFTP As New TEXTUREPROP With {.dwSize = Marshal.SizeOf(GetType(TEXTUREPROP))} 
```

但是 dwSize 的结果值现在是 80 而不是 76，这会导致上面提到的无效结构大小错误。

```
When I change the structure to:

<StructLayoutAttribute(LayoutKind.Explicit, Size:=76, CharSet:=CharSet.Ansi)> _
  Friend Structure FACE_TEXTUREPROP
    [...]
  End Structure 
```

Marshal.SizeOf 显然计算了 76 的大小，并且它与 DLL 函数一起使用，但它让我有一些不好的感觉。有什么不对吗？有没有我现在没有想到的错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:52:31.160

您指定的显式布局与 [StructLayout] 的默认 Pack 值不兼容。默认值为 8，这需要在 Double 之前插入额外的 4 字节填充以保持对齐。pinvoke marshaller 通过仍然基于打包计算结构大小来解决这个问题。

通过明确指定包装来解决此问题：

```
<StructLayout(LayoutKind.Explicit, Pack:=4)> _
Friend Structure TEXTUREPROP
    '' etc
End Structure 
```

显式设置 Size 属性也将修复它：

```
<StructLayout(LayoutKind.Explicit, Size:=76)> _
'' etc 
```

正确指定打包的更大优势是您现在不再需要显式指定偏移量。只有普通的 LayoutKind.Sequential 才能正常工作。

# javascript - 在html中添加跨域

> ID：10153298
> 
> 赞同：1
> 
> 时间：2012-04-14T11:37:45.300
> 
> 标签：javascript, xml

当我在本地服务器上下载 xml 文件时，我从 xml 文件中获取数据，它工作正常，但是当我提供 xml 文件的在线路径时，它不起作用。我读到了一些关于我认为这是一个跨域问题的内容，但是如何在 html 中调用跨域文件。

```
<script type="text/javascript">
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }

xmlhttp.open("GET","http://www.mydomain.com./myfile/xml_9646.xml",false);
xmlhttp.send();

xmlDoc=xmlhttp.responseXML; 

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T11:49:28.220

如果服务器实施[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)，您可以

[https://stackoverflow.com/a/10083975/295783](https://stackoverflow.com/a/10083975/295783)

```
$(document).ready(function() {
  jQuery.support.cors = true; // IMPERATIVE for IE(8) support
  $.ajax({
    type: "GET",
    url: "http://itunes.apple.com/au/rss/topfreeapplications/limit=10/xml?partnerId=1002&partnerUrl=http%3A%2F%2Fwww.s2d6.com%2Fx%2F%3Fx%3Dc%26z%3Ds%26v%3D3868801%26t%3D",
    dataType: "xml",
    success: function(xml) {
      $(xml).find('...').each(function(){
        var id = $(this).find("...").text();
        // ....

      });
    }
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T11:43:53.733

如果您可以控制域的后端，则可以使用[PHP 之类的东西为您读取远程](http://www.php-mysql-tutorial.com/wikis/php-tutorial/reading-a-remote-file-using-php.aspx)XML。您的服务器将充当 JS 代码和远程 XML 的桥梁/代理。由于[JS 不能与其他域对话](http://en.wikipedia.org/wiki/Same_origin_policy)，因此您要求您的服务器（在您的域中）为您读取它。

# java - 设计用于在 java 中读取大型 excel 文件的应用程序中的问题

> ID：10153300
> 
> 赞同：0
> 
> 时间：2012-04-14T11:38:35.863
> 
> 标签：java, apache-poi

目前我正在构建一个示例应用程序，它应该读取一个中等大小的 excel 表（10-15MB），然后选择几列并创建与 excel 表中的行数一样多的文本文件，但只包含选定的列。

例如，为了清楚起见。假设我的 xl 表包含 5 列 Name、empid、email、mobileNo：和 address，总行数或记录为 50000。现在我想创建 50000 个文本文件，每个文件包含 Name、mobileNo：和仅 emailId

由于 excel 表的大小很大，而且 excel 表可以是 xlsx 或 xls，我正在使用 apache poi 来阅读它。但我无法决定在此之后要遵循的任何最佳方法。

方法 1：我是否应该尝试将整个 excel 工作表移动到 mysql 之类的数据库中。因此，我将不得不根据检索到的标题列动态创建一个表并转储其中的所有行。然后使用选择查询我可以获得必要的列并创建文本文件

方法 2：我阅读了可以动态创建类文件的 ASM 库。我正在考虑每行创建一个对象并将所有内容添加到列表中。但是在这里检索特定列将涉及大量迭代，并且列表的大小将与 excel 表中的行成正比，这将是巨大的。

目前我无法决定任何方法。我确信这两种方法都很糟糕:(。任何关于如何进行的建议都会对我有很大的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:06:40.310

你为什么不创建一个内存数据结构来保存电子表格的信息内容并从中工作。

它可以像字符串数组列表一样简单，其中每个数组代表一行。要处理列名，请使用将列名映射到列号的哈希图。

* * *

您的方法 1 太过分了……除非电子表格太大而无法存储在内存中。

您的方法 2 不必要地复杂。动态创建类文件并不能实现使用简单的通用数据结构无法实现的任何事情。

# linux - perl - 用另一个字符替换每第 n 个（和多次）出现的字符

> ID：10153302
> 
> 赞同：3
> 
> 时间：2012-04-14T11:38:47.567
> 
> 标签：linux, perl, shell, unix, command-line

有谁知道任何 unix 命令/perl 脚本会在特定字符的第 n 个重复出现的位置插入特定字符（可以输入为十六进制（即 7C）或实际字符（即 |））。即`perl script.pl "," 3 "|" data.txt` 会用管道替换每个第 3、6、9... 等逗号。

因此，如果 data.txt 在脚本运行之前具有以下内容：

```
fd,3232,gfd67gf,
peas,989767,jkdfnfgjhf,
dhdhjsk,267,ujfdsy,fuyds,637296,ldosi,fduy,
873,fuisouyd,try
save,2837,ipoi 
```

在脚本运行后它应该有这个：

```
fd,3232,gfd67gf|
peas,989767,jkdfnfgjhf|
dhdhjsk,267,ujfdsy|fuyds,637296,ldosi|fduy,
873,fuisouyd|try
save,2837,ipoi 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T12:36:10.967

小 perl hack 来解决这个问题。使用`index`函数查找逗号、模数替换正确的一个，并`substr`执行替换。

```
use strict;
use warnings;

while (<>) {
    my $x=index($_,","); 
    my $i = 0; 
    while ($x != -1) {
        $i++; 
        unless ($i % 3) { 
            $_ = substr($_,0,$x) ."|". substr($_,$x+1); 
        }
        $x = index($_,",",$x + 1) 
    } 
    print;
} 
```

运行`perl script.pl file.csv`。

注意：您可以将声明`my $i`放在`while(<>)`循环之前以便进行全局计数，而不是对每一行单独计数。不太确定我是否理解你在这方面的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T15:16:43.543

一个漂亮、简单`awk`的单线怎么样？

```
awk -v RS=, '{ORS=(++i%3?",":"|");print}' file.csv 
```

我刚刚想到一个小错误：它会打印一个`,`或`|`作为最后一个字符。为了避免这种情况，我们需要稍微改变一下：

```
awk -v RS=, '{ORS=(++i%3?",":"|");print}END{print ""}' file.csv | sed '$d' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-14T12:39:40.950

```
use File::Slurp qw(read_file);
my ($from, $to, $every, $fname) = @ARGV;
my $counter = 0;
my $in = read_file $fname;
my $out = $in;
# copy is important because pos magic attached to $in resets with substr
while ($in =~ /\Q$from/gms) {
    $counter++;
    substr $out, pos($in)-1, length($from), $to unless $counter % $every;
};
print $out; 
```

如果`$from`和`$to`参数的长度不同，您仍然需要稍微弄乱第二个参数`substr`以使其正常工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T15:00:37.957

这一次处理一行输入文件（没有 slurping :)
对于十六进制输入，只需传递`'\x7C'`或其他任何内容，如`$1`

```
#!/bin/bash  

b="${1:-,}"                             # the "before" field delimiter 
n="${2:-3}"                             # the number of fields in a group
a="${3:-|}"; [[ $a == [\|] ]] && a='\|' # the "after" group delimiter

sed -nr "x;G; /(([^$b]+$b){$((n-1))}[^$b]+)$b/{s//\1$a/g}
         s/.*\n//; h; /.*$a/{s///; x}; p" input_file 
```

* * *

又来了，有一些评论。

```
sed -nr "x;G    # pat = hold + pat
  /(([^$b]+$b){$((n-1))}[^$b]+)$b/{s//\1$a/g}
  s/.*\n//      # del fields from prev line
  h             # hold = mod*\n
  /.*$a/{ s///  #  pat = unmodified
          x     # hold = unmodified, pat = mod*\n
        }            
  p             # print line"  input_file 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-14T16:11:23.673

```
# Get params and create part of the regex.
my $delim   = "\\" . shift;
my $n       = shift;
my $repl    = shift;
my $wild    = '.*?';
my $pattern = ($wild . $delim) x ($n - 1);

# Slurp.
$/       = undef;
my $text = <>;

# Replace and print.
$text =~ s/($pattern$wild)$delim/$1$repl/sg;
print $text; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-05-24T16:32:33.467

我在 bash 脚本中有一个想法：

```
perl -pe 's/,/(++$n % 3 == 0) ? "|" : $&/ge'  data.txt 
```

那会成功的。

# objective-c - 实例方法参数中的“o”是什么意思？

> ID：10153303
> 
> 赞同：3
> 
> 时间：2012-04-14T11:39:10.353
> 
> 标签：objective-c, ios

新的objective-c，

```
-(void) myfunction : (int) d 
```

这意味着返回 'void' 并采用 int 类型的单个参数。

以下是什么意思？

```
-(void) myfunction:o 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T11:46:49.090

它转化为

```
- (void) myfunction:(id) o 
```

例如，方法

```
-(void) myfunction:o:p:q {
    NSLog(@"%@, %@, %@", o,p,q);
} 
```

当与

```
[self myfunction:@"test" :[NSNumber numberWithInt:4] :nil]; 
```

打印出来：

```
2012-04-14 08:02:20.470 Test[36499:f803] test, 4, (null) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-14T11:43:30.230

**两者都是一样的**

在objective-c中，第一个参数名被认为是函数名

# java - CXF 中的格式化 XML 输出？

> ID：10153306
> 
> 赞同：6
> 
> 时间：2012-04-14T11:39:22.887
> 
> 标签：java, xml, cxf, jax-rs

我知道在使用 Marshaller 时如何打开格式化的可能性。但我正在使用 Apache CXF (JAX-RS) 并返回类似`return Response.ok(entity).build();`.

我还没有找到如何格式化输出的任何选项。我该怎么做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-14T17:53:20.730

首先，获取 XML 格式输出的方法是在编组器上设置正确的属性（通常是使用 CXF 时的 JAXB，因为 JAXB 做得不错）。也就是说，您将在某处执行此操作：

```
marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true); 
```

问题是您不一定要格式化*所有输出。*它增加了相当多的开销。幸运的是，您已经生成了一个 explicit `Response`，所以我们可以使用它的更多功能：

```
Marshaller marshaller = JAXBContext.newInstance(entity.getClass()).createMarshaller();
marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
StringWriter sw = new StringWriter();
marshaller.marshal(entity, sw);

return Response.ok(sw.toString(), MediaType.APPLICATION_XML_TYPE).build(); 
```

* * *

[这个 JIRA 问题](https://issues.apache.org/jira/browse/CXF-3861)中提到了另一种方法（本身已关闭，但这对您来说不是什么大问题）：

> 解决方法是注册一个自定义输出处理程序，它可以检查用于请求可选缩进的任何自定义查询：

> http://svn.apache.org/repos/asf/cxf/trunk/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/FormatResponseHandler.java

> JAXBElementProvider 和 JSONProvider 由 JAXB Marshaller 驱动，因此默认情况下它们会检查当前消息的 Marshaller.JAXB_FORMATTED_OUTPUT 属性。

这导致如下代码：

```
public class FormattedJAXBInterceptor extends AbstractPhaseInterceptor<Message> {
    public FormattedJAXBInterceptor() {
        super(Phase.PRE_STREAM);
    }

    public void handleMessage(Message message) {
        message.put(Marshaller.JAXB_FORMATTED_OUTPUT, Boolean.TRUE);
    }

    public void handleFault(Message message) {
        message.put(Marshaller.JAXB_FORMATTED_OUTPUT, Boolean.TRUE);
    }
} 
```

CXF 网站[讨论了拦截器的注册](http://cxf.apache.org/docs/interceptors.html#Interceptors-Addinginterceptorsthroughconfiguration)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T21:06:46.713

你可以实现一个`MessageBodyWriter`. 这是一种 JAX-RS 机制，允许您覆盖对象编组为 XML 的方式。

```
package org.example;

import java.io.*;
import java.lang.annotation.Annotation;
import java.lang.reflect.*;

import javax.ws.rs.*;
import javax.ws.rs.core.*;
import javax.ws.rs.ext.*;
import javax.xml.bind.*;

@Provider
@Produces(MediaType.APPLICATION_XML)
public class FormattingWriter implements MessageBodyWriter<Object>{

    @Context
    protected Providers providers;

    public boolean isWriteable(Class<?> type, Type genericType,
        Annotation[] annotations, MediaType mediaType) {
        return true;
    }

    public void writeTo(Object object, Class<?> type, Type genericType,
        Annotation[] annotations, MediaType mediaType,
        MultivaluedMap<String, Object> httpHeaders,
        OutputStream entityStream) throws IOException,
        WebApplicationException {
        try {
            ContextResolver<JAXBContext> resolver 
                = providers.getContextResolver(JAXBContext.class, mediaType);
            JAXBContext jaxbContext;
            if(null == resolver || null == (jaxbContext = resolver.getContext(type))) {
                jaxbContext = JAXBContext.newInstance(type);
            }
            Marshaller m = jaxbContext.createMarshaller();
            m.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
            m.marshal(object, entityStream);
        } catch(JAXBException jaxbException) {
            throw new WebApplicationException(jaxbException);
        }
    }

    public long getSize(Object t, Class<?> type, Type genericType,
        Annotation[] annotations, MediaType mediaType) {
        return -1;
    }

} 
```

**了解更多信息**

Below is a link to a complete example where a `MessageBodyWriter` is used as part of a JAX-RS service.

*   [http://blog.bdoughan.com/2012/03/moxy-as-your-jax-rs-json-provider.html](http://blog.bdoughan.com/2012/03/moxy-as-your-jax-rs-json-provider.html)

# java - 在该行中搜索文本时如何返回该行

> ID：10153310
> 
> 赞同：0
> 
> 时间：2012-04-14T11:39:48.467
> 
> 标签：java, file, search, text, line

我想获取文件的行，在该行中搜索特定文本，然后返回该行以及文件中具有相同特定文本的所有其他行。

到目前为止我有这个：

```
public String searchText(String text, String file)
{
    StringBuffer sb = new StringBuffer();

    try {
        BufferedReader br = new BufferedReader(new FileReader(file));
        String line = null;

        while((line = br.readLine()) != null)
        {
            while(line.indexOf(text) > 0)
            {
                sb.append(line);
            }
        }

        return sb.toString();
    } catch (Exception e) {
        e.printStackTrace();        
    }
    return sb.toString();
} 
```

它必须是我需要时可以使用的功能。我希望你们能理解我想要做什么，并提前感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T11:50:42.703

看起来您的代码非常好，并且您正在以正确的方式解决问题。你只需要一些东西来整理它，例如用`\n`换行符分隔每一行，并`br.close();`在你读完文件后调用。我也不确定你为什么使用`while(line.indexOf(text) > 0)`- 它真的应该是一个`if`声明。

根据您在找到这些行后想要如何使用它们，您可能会发现使用 a`ArrayList<String>`并且仅`add()`使用匹配的行（而不是当前的`StringBuffer`）会更好。如果从方法返回时要单独使用每一行，这可能是一个更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T11:43:09.727

没有真正的问题，但我看到的是您没有附加换行符，这将导致搜索结果在一行很长。添加

```
sb.append('\n'); 
```

并将您的内部更改`while`为`if`. 所以最终的代码应该是这样的：

```
 while((line = br.readLine()) != null)
    {
        if (line.indexOf(text) > 0)
        {
            sb.append(line);
            sb.append('\n');
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-11T16:59:20.560

明确地说，那个内部的while循环是一个无限循环。
因为你没有改变`line`或者`text`在循环内，如果条件匹配了一次，就会一直匹配到你超过max size`StringBuffer`或者内存用完为止。
所以不仅仅是那个循环**应该**是一个 if 语句——它**必须**是。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T11:47:02.707

除了函数返回的字符串将是单行之外，您在正确的轨道上，因此您无法识别行数。

所以只需在每次追加后在最终字符串中添加换行符

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-14T11:47:52.307

*   使用 Apache 的 IOUtils 从 a 逐行读取`File`或将整个`File`转换为`String`.
*   使用`String`'s`replaceAll` *方法*替换任何 更改为`Sting`使用正*则表达式*（这几天非常流行）或只是简单的 s`File``String`*`String`*

# ios - 同时平移多个图像

> ID：10153315
> 
> 赞同：0
> 
> 时间：2012-04-14T11:40:29.777
> 
> 标签：ios, ipad, uigesturerecognizer, uipangesturerecognizer

我想知道是否可以使用多点触控同时拖动/平移多个图像

即：使用一根手指拖动一个图像，同时使用另一根手指拖动另一个图像，我想使用 UIGestureRecognizer 来实现这一点。

如果是这样，我想知道我应该怎么做。

编辑：我用于平移的代码

```
CGPoint ltouch = [gestureRecognizer translationInView:self.view];
if ([gestureRecognizer state] == UIGestureRecognizerStateBegan) 
{
      self.pointOnImage = [gestureRecognizer view].center;
}
ltouch = CGPointMake(self.pointOnImage.x + ltouch.x, self.pointOnImage.y + ltouch.y);

[gestureRecognizer.view  setCenter:CGPointMake(ltouch.x, ltouch.y)]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:25:53.617

是的，你可以从[这里](https://github.com/AalokParikh/pinch-and-uiguesture)下载一个 zip， 这说明了如何做到这一点。这不是我创建的演示，而是在某个站点上找到的

# node.js - 无法在 Centos 服务器上安装 bcrypt node.js 模块

> ID：10153317
> 
> 赞同：8
> 
> 时间：2012-04-14T11:40:42.603
> 
> 标签：node.js, centos, npm, bcrypt

我正在尝试在 CentOS 服务器上安装 bcrypt，但出现以下错误：

```
info postuninstall bcrypt@0.5.0
ERR! bcrypt@0.5.0 install: `make build`
ERR! `sh "-c" "make build"` failed with 2
ERR!
ERR! Failed at the bcrypt@0.5.0 install script.
ERR! This is most likely a problem with the bcrypt package,
ERR! not with npm itself.
ERR! Tell the author that this fails on your system:
ERR!     make build
ERR! You can get their info via:
ERR!     npm owner ls bcrypt
ERR! There is likely additional logging output above.
ERR!
ERR! System Linux 2.6.18-028stab095.1
ERR! command "nodejs" "/usr/bin/npm" "install" "bcrypt"
ERR! cwd /root/grouplo
ERR! node -v v0.6.15
ERR! npm -v 1.1.16
ERR! code ELIFECYCLE
ERR! message bcrypt@0.5.0 install: `make build`
ERR! message `sh "-c" "make build"` failed with 2
ERR! errno {} 
```

我能做些什么来解决这个问题？谢谢，

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-16T16:40:28.897

还有一个不需要编译的原生 js 版本的 bcrypt。 [https://github.com/shaneGirish/bcrypt-nodejs](https://github.com/shaneGirish/bcrypt-nodejs)

```
npm install bcrypt-nodejs 
```

该 api 与编译版本非常相似。以下内容直接摘自自述文件

## 基本用法：

同步

```
var hash = bcrypt.hashSync("bacon");

bcrypt.compareSync("bacon", hash); // true
bcrypt.compareSync("veggies", hash); // false 
```

异步

```
bcrypt.hash("bacon", null, null, function(err, hash) {
    // Store hash in your password DB.
});

// Load hash from your password DB.
bcrypt.compare("bacon", hash, function(err, res) {
    // res == true
});
bcrypt.compare("veggies", hash, function(err, res) {
    // res = false
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-01-03T02:35:46.310

对我来说，答案是确保我安装了 gcc、openssl 和 node-gyp。

要安装 gcc 和 openssl，请使用 yum：

```
sudo yum install gcc-c++ openssl-devel 
```

要安装 node-gyp（全局），请使用 npm：

```
npm install -g node-gyp 
```

然后 bcrypt 的 npm install 在 centos 上运行良好

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-13T00:18:43.377

我在执行 npm install bcrypt 时遇到了同样的问题。另一种选择是从源代码安装它。

```
git clone git://github.com/ncb000gt/node.bcrypt.js.git
cd node.bcrypt.js
node-gyp configure
node-gyp build 
```

将 node.bcrypt.js 文件夹重命名为 bcrypt，并将其移动到项目的 node_modules 中。

您可以通过执行 npm install -g node-gyp 来安装 node-gyp（-g 全局安装它）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-05-02T17:02:23.927

预构建的二进制文件通常在 bcrypt 新版本发布后的几个小时内或新 NodeJS 版本发布后的几天后可用于 bcrypt。

但是，请记住，提供二进制文件只是为了方便。

如果您看到如下错误：

`在 CentOS / RHEL / Fedora 上你需要以下软件包

*   `gcc-c++`- 为了安装编译器链来编译节点模块。
*   `make`- 通过 node-gyp 运行生成的 Makefile，它按顺序调用编译器
*   `python`- RHEL 和 CentOS 附带安装所需的 python 版本

确保使用此命令安装所有依赖项，

`yum install -y gcc-c++ make`

然后继续 bcrypt 安装。

对于其他系统，请参阅：[https ://github.com/kelektiv/node.bcrypt.js/wiki/Installation-Instructions](https://github.com/kelektiv/node.bcrypt.js/wiki/Installation-Instructions)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-08T10:24:55.833

我也有这个问题，原来我`node`的不兼容`bcrypt`。我使用的是节点版本 lts `12`，但我的 bcrypt 版本`package.json`是`5`，必须是`3`。

[您可以在此处](https://www.npmjs.com/package/bcrypt#user-content-version-compatibility)检查 node 和 bcrypt 不同版本的兼容性。

希望它对某人有所帮助

# iphone - 如何在 UIButton 中向 UIImage 添加叠加层

> ID：10153319
> 
> 赞同：0
> 
> 时间：2012-04-14T11:41:22.553
> 
> 标签：iphone, ipad, uiview, colors

在 Objective C 中，对于 iPhone/iPad 我正在努力尝试在 UIButton 中更改 UIImage 的颜色（红色/黄色/绿色）。如何才能做到这一点。是否需要子类？有人可以提供一个例子。

即这是一个完整的单色叠加。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T02:34:11.023

如果您想在 UIButton 顶部放置一个半透明图像蒙版（这不会完全改变颜色，但可以添加彩色阴影效果），然后创建一个半透明 PNG，将其添加到您的支持文件组，然后在某个地方添加以下代码行，例如`viewDidLoad`视图控制器以在 UIButton 顶部添加掩码：

```
[myButton addSubview:[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"overlay.png"]]]; 
```

# c# - 控制台应用程序异常

> ID：10153325
> 
> 赞同：-1
> 
> 时间：2012-04-14T11:41:54.380
> 
> 标签：c#

根据我们前辈的要求，我们被要求创建一个应用程序，用户可以在其中输入并获取他/她的储蓄信息的详细信息......

它工作得很好，除了当我按下 Enter 键时，我得到一个异常并且我的程序崩溃了。

请向我提供信息，以便在我的控制台应用程序中，即使我按 Enter 键，我也不会收到异常，而是返回程序。

非常感谢，非常感谢帮助。

这是我的程序。

```
using System;

using System.Collections.Generic;

using System.Text;

namespace bankprob {

    class sav_acc

    {

        public float amount;

        public sav_acc(float amount)
        {

            this.amount = amount;

        }

        public void getdeposit(float depos)
        {

            amount += depos;

        }

        public void display()
        {

            Console.WriteLine("Balance of Customer :{0} ", amount);

        }

        public void withdrawl(float amt)
        {

            amount =amount - amt;

        }

        public void minbal()
        {

            if (amount < 1000)
            {

                Console.WriteLine("You cannot withdraw beyond the minimum balance of rupees 1000\. ");
                return;
            }

        }

    }

    class cur_acc 
    {

        public float amount = 0;

        public cur_acc( float amount)

        {

            this.amount = amount;

        }

        public void getdeposit(float depos)
        {

            amount += depos;

        }

        public void display()
        {

            Console.WriteLine("Balance of Customer : {0}", amount);

        }

        public void withdrawl(float amt)
        {

            amount = amount - amt;

        }

        public void minbal()
        {

            if (amount < 1000)
            {

                Console.WriteLine(" Your balance is less than 1000, and u cannot make any withdrawals");

            }

            else

                Console.WriteLine("Balance is greater than Rs 1000 no need to panality");

        }

    }

    class Program
    {

        public static void Main(string[] args)
        {
            Console.WriteLine("Welcome Mr.Sayeed");
            Console.WriteLine("Please select the type of account.\n1.Savings 2.Current 3.Exit");

            int ch; 
            ch = int.Parse(Console.ReadLine()); 
            switch (ch)
            {

                case 1:

                    Console.WriteLine("Enter Initail Amount : ");

                    float amt = int.Parse(Console.ReadLine());

                    sav_acc s = new sav_acc(amt);

                    Console.WriteLine("Enter deposit money : ");

                    float depos = float.Parse(Console.ReadLine());

                    s.getdeposit(depos);

                    s.display();

                    Console.WriteLine("Enter withdrawl Amount");

                    float wamt = float.Parse(Console.ReadLine());

                    s.withdrawl(wamt);

                    s.display();

                    s.minbal();

                    s.display();

                    break;

                case 2:

                    Console.WriteLine("Enter Initail Amount : ");

                    float am = int.Parse(Console.ReadLine());

                    cur_acc c = new cur_acc(am);

                    Console.WriteLine("Enter deposit money : ");

                    float depo = float.Parse(Console.ReadLine());

                    c.getdeposit(depo);

                    c.display();

                    Console.WriteLine("Enter withdrawl Amount");

                    float wam = float.Parse(Console.ReadLine());

                    c.withdrawl(wam);

                    c.display();

                    c.minbal();

                    c.display();

                    break;
                case 3:
                    Console.WriteLine("Thank you for Using this applicaton");
                    return;

                default:
                    Console.WriteLine("You have made a wrong choice, Thank you...");
                    return;

            }

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T11:44:45.313

`int.Parse(Console.ReadLine())`要求您输入一个有效的整数。如果只按回车而不输入值，该方法将抛出异常。改为使用`int.TryParse`。

```
int ch = 0; 
int.TryParse(Console.ReadLine(), ch); 
switch (ch) {
    ...
} 
```

# ssh - 当 ssh 被管理员阻止时 ssh 进入 aws EC2 实例

> ID：10153333
> 
> 赞同：2
> 
> 时间：2012-04-14T11:42:48.860
> 
> 标签：ssh, amazon-web-services, stunnel

我有一个新的 aws EC2 实例，在家一切正常。现在 ssh 访问在大学被阻止了！我想知道如何绕过它并通过 ssh 进入我的 ec2 实例。我有什么方法可以做到？另外，我怎样才能使用 stunnel 来做到这一点？简短的解释与解决方案一起受到赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:10:27.967

我会尝试以下方法：

*   将 EC2 实例上的 SSH 侦听器移动到 22/tcp 以外的端口，例如 2222/tcp。他们可能只是在防火墙上阻止了指定的端口号。
*   如果他们使用深度数据包检查，移动端口将无济于事，因为防火墙仍会检测到 SSH 握手并阻止它。在这种情况下，您将需要一个 stunnel 式的解决方案来加密握手本身。

如果他们使用深度数据包检查，我建议遵循以下说明： [http ://www.terranpro.org/Tunnel%20SSH%20over%20SSL%20or%20HTTPS.html](http://www.terranpro.org/Tunnel%20SSH%20over%20SSL%20or%20HTTPS.html)

stunnel 解决方案有很多活动部分：

*   RSA 密钥生成（使用 openssl）
*   Stunnel 服务器配置（在 EC2 端）
*   Proxytunnel 安装（在 SSH 客户端上）

另外，您还要对所有内容进行双重加密，因此性能会受到影响。祝你好运！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-15T12:58:36.580

必须阻止用于 SSH 的端口 22。您需要获得大学管理员的许可才能在您的计算机上打开它。

# iphone - iPhone核心数据获取主键

> ID：10153335
> 
> 赞同：2
> 
> 时间：2012-04-14T11:42:59.000
> 
> 标签：iphone, core-data, primary-key

我正在开发一个使用 CoreData 的应用程序。

所以在**.sqlite**文件中，它自己管理主键。

主键属性名称是**Z_PK**。

我的问题是，我希望表中的数据按主键升序排序。

我正在使用该代码

```
NSSortDescriptor *sort = [[NSSortDescriptor alloc] initWithKey:@"_PK" ascending:YES];
[fetchRequest setSortDescriptors:[NSArray arrayWithObject:sort]];
[sort release]; 
```

但它不起作用。

当我使用“_PK”的“标题”时，它工作正常

```
NSSortDescriptor *sort = [[NSSortDescriptor alloc] initWithKey:@"title" ascending:YES];
[fetchRequest setSortDescriptors:[NSArray arrayWithObject:sort]];
[sort release]; 
```

那么有什么不同的方式来使用 Table 的主键呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T04:09:35.470

CoreData 管理持久对象图。它不是 RDBM。您无法控制唯一主键，因此您无法控制其值。它只是一个实现细节，不应以任何理由引用。

因此，为什么要根据它进行排序？我能想到几个原因...

1.  您希望按照对象添加到数据库的顺序访问对象。但是，您可以通过多种方式轻松地做到这一点。

1a。您可以为每个实体添加一个字段。您可以将其设置为 UUID 或递增整数。

1b。您可以有一个实体，例如“EntityList”，它与“Entity”具有有序的一对多关系。

1c。您可以添加从实体到自身的一对一关系，然后像链接列表一样管理它。每次添加实体时，将其放在列表末尾。

这两种解决方案都使您能够按添加顺序访问 Entity 对象。

1.  或者，你真的不在乎你看到它们的顺序，但你想要一个一致的顺序。

2a. 添加一个 primaryKey 属性，并为其分配一个 UUID。

2b。使用有序对多关系。

最后，如果您真的想要基于主键的访问，我建议您拥有一个单独的 sqlite 数据库，用于特殊键访问。然后，您可以将键关联到 CoreData 存储中对象的 objectID。

# php - PHP Apc：如何查看 APC 中的缓存条目

> ID：10153339
> 
> 赞同：2
> 
> 时间：2012-04-14T11:43:41.320
> 
> 标签：php, apache, apc

我有 php 5.3.6-13ubuntu3.6。

我通过以下方式安装了 apc：

```
$ sudo apt-get install php-apc 
```

（虽然我后来发现了许多其他方法）。

我想查看我的缓存条目和其他信息。我用谷歌搜索，发现查找和放置`apc.php` 文件可以满足`/var/www/`我的需要。

我通过命令没有找到这样的文件

```
$ find -name apc.php | grep apc . 
```

我应该怎么办 ？

PS：我不是专家，这是我的第一个网站。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-07T21:11:58.570

只需下载与您的 APC 版本匹配的存档文件之一 - [http://pecl.php.net/package/APC](http://pecl.php.net/package/APC)，浏览存档文件以找到 apc.php 文件并将其解压缩到您的 docroot 中，然后就可以使用了。

# android - Android：View.setClickable 消耗点击事件

> ID：10153342
> 
> 赞同：7
> 
> 时间：2012-04-14T11:44:01.213
> 
> 标签：android, ontouchlistener, clickable

我有一个用于水平滚动的自定义库视图和几个子视图，它们都应该是可点击的。

设置`childview.setOnClickListener()`不起作用，因为它总是消耗触摸事件。

因此，我使用`childview.setOnTouchListener()`并让它的onTouch 方法返回false，这样Gallery 就可以滚动了。

这一切都很好。

现在的问题是，childView 的 onTouch 方法只触发**ACTION_DOWN**事件。除非我通过设置使 View 可点击，否则它不会传递**MotionEvent ACTION_UP**`childview.setClickable()`。但是，设置 View clickable 本身似乎会消耗 onTouch 事件，因此画廊 View 变得不可滚动。

好像我在这里转了一圈。我会很感激任何帮助。

这是我的代码

画廊视图：

```
public class myGallery extends Gallery {

    public myGallery(Context ctx, AttributeSet attrSet) {
        super(ctx, attrSet);
        // TODO Auto-generated constructor stub
    }

    private boolean isScrollingLeft(MotionEvent e1, MotionEvent e2){ 
           return e2.getX() > e1.getX(); 
        }

    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY){
      int kEvent;
      if(isScrollingLeft(e1, e2)){ //Check if scrolling left
        kEvent = KeyEvent.KEYCODE_DPAD_LEFT;
      }else{ //Otherwise scrolling right
        kEvent = KeyEvent.KEYCODE_DPAD_RIGHT;
      }
      onKeyDown(kEvent, null);
      return true;  
    }
} 
```

在我的活动中：

```
gallery.setOnItemSelectedListener(new OnItemSelectedListener(){
     public void onItemSelected(AdapterView<?> parent, View view,
                    int position, long id) {

         //  childView.setClickable(true);   // can't use this
                                             // click event would get consumed
                                            // and gallery would not scroll 

         // therefore, I can only use the ACTION_DOWN event below:

         childView.setOnTouchListener(new OnTouchListener() {
              public boolean onTouch(View v, MotionEvent event) {

              switch (event.getAction()) {
                  case MotionEvent.ACTION_DOWN:
                       //doStuff();
              }

              return false;
              }
         });
    }

    public void onNothingSelected(AdapterView<?> arg0) {}
     });
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-02T20:11:11.663

如果我是你，我会尝试覆盖`ViewGroup.onInterceptTouchEvent(...)`方法而不是设置`OnTouchListener`。这样，您应该能够在不实际使用它们的情况下拦截触摸事件。

[查看 javadoc](http://developer.android.com/reference/android/view/ViewGroup.html#onInterceptTouchEvent%28android.view.MotionEvent%29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T12:01:12.760

OnTouch 需要返回 true 以指示您想要其余的事件。这是一个摘录：

•onTouch() - 这将返回一个布尔值来指示您的侦听器是否使用此事件。重要的是这个事件可以有多个相互跟随的动作。因此，如果在接收到 down 操作事件时返回 false，则表明您尚未消费该事件，并且对该事件的后续操作也不感兴趣。因此，事件中的任何其他操作都不会调用您，例如手指手势或最终的向上操作事件。

[来自 android 开发指南](http://developer.android.com/guide/topics/ui/ui-events.html)

# c# - 在 ASP.NET 数据列表中显示/隐藏复选框（嵌套）

> ID：10153347
> 
> 赞同：0
> 
> 时间：2012-04-14T11:44:32.100
> 
> 标签：c#, asp.net, checkbox, nested, datalist

我有一个嵌套的 ASP 数据列表，其中包含一个标签和一个在页面加载时绑定的复选框。

在绑定期间，将一个字符串解析为 datalist 绑定方法。如果此字符串等于值**1**，我希望该复选框对嵌套数据列表中的每个项目都可见。

并且保持隐藏的是值**不是 1**。

但是，代码会编译并运行。它将字符串值检测为 1，但随后不会使复选框可见。我究竟做错了什么？我该如何解决这个问题？

数据列表：

```
<asp:DataList runat="server" id="dgQuestionnaire" DataKeyField="QuestionID" CssClass="confirm">
    <ItemTemplate>
        <div class="content_box" id="added_question">
            <h3>Question <asp:Label ID="lblOrder" runat="server" Text='<%# Container.ItemIndex  + 1 %>'></asp:Label></h3>
            <p>Question Type</p>
            <p><%# DataBinder.Eval(Container.DataItem, "QuestionText") %></p>
            <asp:DataList ID="nestedDataList" runat="server">
                <ItemTemplate>
                    <asp:CheckBox runat="server" ID="sampleCheckbox" Visible="false" />
                    <p class="confirm_answer new"><%# DataBinder.Eval(Container.DataItem, "AnswerTitle") %></p>
                </ItemTemplate>
            </asp:DataList>
        </div>    
    </ItemTemplate> 
</asp:DataList> 
```

这是背后的代码：

```
public void BindParentDataList(int questionnaireID)
{
    // populate the datalist with items from the datatable.
    SendData = new OsqarSQL();
    DT = SendData.GetQuestionNameDataList(questionnaireID);
    dgQuestionnaire.DataSource = DT;
    dgQuestionnaire.DataBind();

    // each item in the datalist call BindNestedDataList method.
    foreach (DataListItem Item in dgQuestionnaire.Items)
    {
        BindNestedDataList(Item.ItemIndex, DT.Rows[Item.ItemIndex][2].ToString());
    }
}

public void BindNestedDataList(int ItemIndex, string _questionType)
{
    // get questionID value for the current datalist item and populate the answers for the question.
    int questionID = Convert.ToInt32(dgQuestionnaire.DataKeys[ItemIndex]);
    DT = SendData.GetAnswerTitle(questionID);
    DataList nestedDataList = (DataList)dgQuestionnaire.Items[ItemIndex].FindControl("nestedDataList");

    if(_questionType == "1")
    {                
        foreach (DataListItem Item in nestedDataList.Items)
        {
            CheckBox checkbox = (CheckBox)Item.FindControl("sampleCheckbox");
            checkbox.Visible = true;
        } 
    }
    nestedDataList.DataSource = DT;
    nestedDataList.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T11:54:45.340

一切似乎都是正确的，只是您将代码写在错误的位置，将其写入 Row/Item 绑定事件并获取当前绑定行而不是 row[itemindex]

# ios5 - 在 iOS 应用程序中包含 ObjectiveGit 库

> ID：10153349
> 
> 赞同：1
> 
> 时间：2012-04-14T11:45:06.377
> 
> 标签：ios5, frameworks, xcode4.3, dynamic-library, libgit2

打开 ObjectieGitFramework.xcodeproj 文件时，我现在可以成功构建 iOS 方案。虽然需要进行大量的实验。让我们从头开始——我是怎么做到的。

**我做了什么：**

首先，我克隆了一个 ObjectiveGit 的分支。

```
git clone git@github.com:Eonil/objective-git.git --recurse-submodules
cd objective-git
cd ./Scripts/libgit2-make-ios/; sh ./download-make-clean-deploy.sh "./../../libgit2.a"; cd ../.. 
```

源：[https ://github.com/libgit2/objective-git/pull/54](https://github.com/libgit2/objective-git/pull/54)

现在打开项目并构建会导致一个错误和一个警告。我让 Xcode 自动更新项目设置来解决警告。 ![错误](../Images/95911bba01c75be9bbac5b700c1ccd33.png)

现在我进入目录并使用[cmake](http://www.cmake.org/)`libgit2`构建：

```
$ mkdir build && cd build
$ cmake ..
$ cmake --build . 
```

源：[https ://github.com/libgit2/libgit2](https://github.com/libgit2/libgit2)

除其他外，这会导致`libgit2.0.15.0.dylib`正在创建的文件中。 ![查找器中的文件图像](../Images/ef4811b116fcf6fe5dc42c6f18c41ed9.png)

我将它拖入 Xcode 并将其添加到 ObjectiveGit 和 iOS 目标。现在我转到 ObjectiveGit-iOS 的构建阶段选项卡，让它看起来像这样：

![在此处输入图像描述](../Images/6f8f8543989b7b3b1293a6dd928eeb3c.png)

**问题**

此时我可以构建项目，并且可以使用`ObjectiveGit`. 但是，当我将项目拖到另一个项目中，添加`ObjectiveGit-iOS`为目标依赖项并添加`libObjectiveGit-iOS.a`时，`link binary with libraries`我无法导入`ObjectiveGit/ObjectiveGit.h`，而且我遇到了一些其他奇怪的错误（见下图）。我对 xcode 中的库知之甚少，所以我根本不知道为什么这不起作用。

![在此处输入图像描述](../Images/a63897ec22ef4b840f62c16fca87e1f8.png) ![在此处输入图像描述](../Images/de38518c84803215028e135ef3b861db.png)

现在，这是我曾经遇到的一个错误，但现在没有了。我不知道我做了什么导致它。 ![在此处输入图像描述](../Images/f9c1bfebcd850e8122ce714c78c28c27.png)

**更新**

```
 $(SRCROOT)/frameworks/ObjectiveGit/Classes
 $(SRCROOT)/frameworks/ObjectiveGit/libgit2/include
 $(SRCROOT)/frameworks/ObjectiveGit/Classes/Categories 
```

当将此添加到`header search path`奇怪的事情发生时。它导致没有找到文件，而是 70 个其他 Mach-o 错误。

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T13:50:06.500

iOS 不支持动态库。您必须使用静态库。

需要明确的是：iOS当然支持动态库，但只有苹果分发的那些。

# class - Visual Basic 6 类属性类型可以是枚举吗

> ID：10153350
> 
> 赞同：4
> 
> 时间：2012-04-14T11:45:26.727
> 
> 标签：class, vb6

我正在开发一个旧的 vb6 应用程序（长话短说，.NET Framework 不可用）。

我想知道，我可以将 vb6 类属性项声明为枚举吗？

例如

```
Public Enum WinInetPort
    INTERNET_INVALID_PORT_NUMBER = 0
    INTERNET_DEFAULT_FTP_PORT = 21
    INTERNET_DEFAULT_GOPHER_PORT = 70
    INTERNET_DEFAULT_HTTP_PORT = 80
    INTERNET_DEFAULT_HTTPS_PORT = 443
    INTERNET_DEFAULT_SOCKS_PORT = 1080
End Enum 
```

类模块：

```
Private m_Port As WinInetPort
Public Property Get Port() As WinInetPort
    Port = m_Port
End Property
Public Property Let Port(val As WinInetPort)
    m_Port = val
End Property 
```

但是，编译时出现错误

> End Sub、End Function 或 End Property 之后只能出现注释

该错误在类中的下一个 Private 语句中突出显示。

我在网上某处读过 vb6 类不能公开公共常量 - 有解决方法吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T13:14:06.557

确保您的所有 Private 声明都放在 Property 声明之上。

# java - 非嵌套双整数 java 库

> ID：10153352
> 
> 赞同：3
> 
> 时间：2012-04-14T11:45:41.127
> 
> 标签：java, integral

我正在寻找一个无需嵌套即可计算双积分的 java 库。我已经找到了一个允许我执行以下操作的库：

```
 Integral of x*x*{integral of y*y} for x between 0 and 1 and for y between x and 5 
```

我必须先解决内部积分，然后我才能解决外部积分。这工作正常，如果

```
 f(x,y) = x^2 * y^2 can be seperated into two functions, g(x) = x^2 and h(y) = y^2\. 
```

但是我需要整合的是以下内容：

```
 Integral of e^((x-y)^2) for x between 5 and 10 and y between 3 and 7 
```

有没有一个图书馆可以让我调用这样的东西

```
 Integrate (e^((x-y)^2), {x,5,10}, {y,3;7}) 
```

我需要这是一个 java 库而不是外部工具，因为整个代码最好导出为库并在 android 手机上使用。

# django - 如何让tastepie给出文件的url而不是它的路径？

> ID：10153355
> 
> 赞同：1
> 
> 时间：2012-04-14T11:46:30.133
> 
> 标签：django, tastypie

我正在使用 Django 和 Tastypie 创建一个 RESTful Web 应用程序。我有一个这样的模型

```
class Picture(models.Model):
    # some other fields
    image = models.ImageField('Image')
    def image_url(self):
        return self.image.url 
```

Tastypie 会给出图像的路径，但实际上我需要它的 url。如何编写正确的资源 api 来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T14:00:22.877

默认情况下，TastyPie 应该返回 ImageField 和 FileField 的 URL。见这里：[https ://github.com/toastdriven/django-tastypie/blob/master/tastypie/fields.py#L185](https://github.com/toastdriven/django-tastypie/blob/master/tastypie/fields.py#L185)

```
# Try to return the URL if it's a ``File``, falling back to the string
# itself if it's been overridden or is a default.
return getattr(value, 'url', value) 
```

请确保您使用的是最新版本的 TastyPie。

# javascript - Xcode：uiwebview 加载其内容时的分配和泄漏？

> ID：10153360
> 
> 赞同：0
> 
> 时间：2012-04-14T11:47:52.517
> 
> 标签：javascript, objective-c, ipad, memory, allocation

我的应用程序使用 uiwebview 加载 html5 页面时遇到问题，该页面上有一个带有一些图像的画布。我不知道 html5 何时静态加载，但是当我使用来自 JQuery 的触摸事件放大画布上的图像时，内存分配开始迅速从 2mb 增加到 8 或 10mb。即使 uiwebview 被释放，高内存分配也不会减少。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:16:56.973

没有理由相信这是实际的内存泄漏。它很可能是 WebKit 缓存数据。相关的事情是当应用程序收到内存警告时释放内存的天气。您可以使用此代码段强制内存警告：

```
[[UIApplication sharedApplication] performSelector:@selector(_performMemoryWarning)]; 
```

**只有在调试时才这样做！**如果您使用此方法调用提交应用程序，它将被 Apple 拒绝。

您可以创建一个按钮来触发内存警告，或者使用计时器每隔几秒触发一次。当内存警告被触发时，你应该看到内存被释放（很可能即使 web 视图还没有被释放）。

# ios - iOS：detailViewConroller 未实现

> ID：10153366
> 
> 赞同：-1
> 
> 时间：2012-04-14T11:48:48.667
> 
> 标签：ios, objective-c, iphone, uitableview, storyboard

我在制作 iOS 应用程序时遇到问题。我使用最新的 SDK 和带有 tableView 的情节提要。如果我在 ipad 上测试应用程序没问题，但在 iphone detailviewcontroler 上没有实现。

我的代码

```
- (void)tableView:(UITableView *)sender didSelectRowAtIndexPath:(NSIndexPath *)path {
    self.detailViewController.title = [[self.items objectAtIndex:path.row] title];
    [self.detailViewController.detailWebView loadHTMLString:[[self.items objectAtIndex:path.row] content] baseURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] bundlePath]]];
} 
```

我用 ipad 故事板控制了一切，并且参考是相同的。

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T12:11:40.177

在使用任何类的属性之前，你先初始化它的类，所以试试这个

```
-(void)tableView:(UITableView *)sender didSelectRowAtIndexPath:(NSIndexPath *)path {

self.detailViewController =[[DetailViewController alloc]init]; 

self.detailViewController.title = [[self.items objectAtIndex:path.row] title];

[self.detailViewController.detailWebView loadHTMLString:[[self.items objectAtIndex:path.row] content] baseURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] bundlePath]]];

 } 
```

在这里我假设你的类名是 DetailViewController

# cordova - 在 PhoneGap 中保护敏感信息？

> ID：10153367
> 
> 赞同：4
> 
> 时间：2012-04-14T11:48:49.833
> 
> 标签：cordova

我有许多想要保护的 REST API 密钥（Google Places 等）。阅读 Google Groups 和 SO 似乎混淆不是解决方案，使用钥匙串也不是，那么当 IPA 包可以被解包和阅读时，你如何建议加密/保护敏感信息？（我不想在 Objective-C 中重写应用程序）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:23:50.667

如果您可以选择自己托管网络服务，则可以让设备与您自己的服务器而不是 Google 的服务器通信。它将充当代理：设备使用您选择的方案对您的服务进行身份验证，并且永远不会看到安全地存放在您的服务器上的 API 密钥。该过程与在网站上的工作方式非常相似（浏览器也不直接与后端服务提供商对话，而是由网络服务器代表它进行）。

# java - setContentView 麻烦之前的代码

> ID：10153376
> 
> 赞同：3
> 
> 时间：2012-04-14T11:50:39.313
> 
> 标签：java, android, android-activity, android-view

我的问题是是否可以在 main`setContentView()`的方法中编写代码。在下面的代码中，我想调用before但这会导致我的应用程序崩溃。如果我打电话后，它工作正常。为什么是这样？`onCreate()``Activity``setVariables()``setContentView()``setVariables()``setContentView()`

```
package com.oxinos.android.moc;

import android.app.Activity;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.res.Resources;
import android.os.Bundle;
import android.view.View;
import android.widget.CheckBox;

public class mocActivity extends Activity {
    /** Called when the activity is first created. */

    public static String prefsFile = "mocPrefs";
    SharedPreferences mocPrefs;
    public Resources res;
    public CheckBox cafesCB, barsRestCB, clothingCB, groceriesCB, miscCB;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setVariables();
        setContentView(R.layout.main);

        mocPrefs = getSharedPreferences(prefsFile,0);
    }

    private void setVariables(){
        res = getResources();
        cafesCB = (CheckBox) findViewById(R.id.cafesCheckBox);
        barsRestCB = (CheckBox) findViewById(R.id.barsRestCheckBox);
        clothingCB = (CheckBox) findViewById(R.id.clothingCheckBox);
        groceriesCB = (CheckBox) findViewById(R.id.groceriesCheckBox);
        miscCB = (CheckBox) findViewById(R.id.miscCheckBox);

    }
    public void submitHandler(View view){
        switch (view.getId()) {
        case R.id.submitButton:
            boolean cafes = cafesCB.isChecked();
            boolean barsRest = barsRestCB.isChecked();
            boolean clothing = clothingCB.isChecked();
            boolean groceries = groceriesCB.isChecked();
            boolean misc = miscCB.isChecked();

            SharedPreferences.Editor editor = mocPrefs.edit();

            editor.putBoolean(res.getString(R.string.cafesBool), cafes);
            editor.putBoolean(res.getString(R.string.barsRestBool), barsRest);
            editor.putBoolean(res.getString(R.string.clothingBool), clothing);
            editor.putBoolean(res.getString(R.string.groceriesBool), groceries);    
            editor.putBoolean(res.getString(R.string.miscBool), misc);
            editor.commit();
            startActivity(new Intent(this, mocActivity2.class));
            break;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-14T11:54:33.950

您可以在方法之前执行*您想要的任何代码*`setContentView()`，只要它不引用（部分）`View`尚未设置的 。

由于您的`setVariables()`方法引用了 的内容`View`，因此无法执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T12:02:45.337

该`setContentView()`方法将您的 XML 文件的内容设置为`View`，如`Activity`.

您在`setVariables()`指定`View`要显示的任何内容之前调用。

这就是引发错误的原因。编译器不知道它`View`属于哪里。如果你想使用 a `ResourceView`，你必须先设置它。

# c++ - 查找字典中包含的最长前缀

> ID：10153383
> 
> 赞同：2
> 
> 时间：2012-04-14T11:51:11.020
> 
> 标签：c++, algorithm, data-structures, zip

我正在实施 Lempel-Ziv 压缩，我想到了一个问题。

给定一个“字典”和一个字符串。我希望能够计算字典中包含的字符串的最长前缀。

这是给定的字符串：

```
0 : AABB
1 : ABA
2 : AAAB 
```

和查询字符串 'AABBABA' 我希望能够进行返回 '0' 的查找，这应该在与前缀长度成线性关系的时间内完成。

接下来我希望能够在恒定时间内将新前缀“AABBAB”添加到字典中。

是否有标准且简单的方法/算法来执行此操作？

我最初的想法是用指针列表构建一个标准的 n 路树，然后搜索它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T11:54:37.943

您正在描述一个简单的[trie](http://en.wikipedia.org/wiki/Trie)查找，但即使有多余的字符，您也会返回一个叶节点。

不确定您对 n 路树的想法，但很可能是完全相同的，因为它是显而易见的解决方案 :v) 。如果你想更有效率，你可以研究不同类型的尝试。

# jquery - div刷新不起作用 - jquery

> ID：10153388
> 
> 赞同：-1
> 
> 时间：2012-04-14T11:51:58.367
> 
> 标签：jquery

我有一个问题并进行了一些研究，但没有达到任何目标。

我用 jquery 插入数据库。但是，插入后，我想要的是刷新 div

```
 if(response =='ok'){
             alert("Başarıyla eklendi");
             $('#loaddiv').fadeOut('tabberlive').load('urlofmypage').fadeIn("slow");
        } 
```

那有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T12:03:28.643

也许你可以做这样的事情

```
$('#loaddiv').fadeOut('tabberlive', function() {
    $(this).load('urlofmypage', function() {
        $(this).fadeIn("slow");
    });
});​ 
```

**演示：**检查[这](http://jsfiddle.net/dhirajbodicherla/63VNe/)是否有效？这是你想要的吗？

# c++ - CUDA程序比CPU程序慢，但内核更快？

> ID：10153390
> 
> 赞同：-1
> 
> 时间：2012-04-14T11:52:33.183
> 
> 标签：c++, matrix, cuda, parallel-processing

问题的标题可能听起来很混乱，但实际上.. 它是！

我有一个执行这一行的程序

```
new_matrix = matrix1 + matrix2 + CPU_GIVE_ME_A_MATRIX(); 
```

“+”运算符被重载，我创建了一个简单的矩阵类来简化代码阅读。

```
 myMatrixClass operator+ (const myMatrixClass& mt)
{

    myMatrixClass result(this->rows, this->columns);
    // Sum each couple of values
    for(int i=0; i<rows; i++)
    {
        for(int j=0; j<columns; j++)
            result.values[i*columns+j] = this->values[i*columns+j] + mt.values[i*columns+j];
    }
    return result;
} 
```

我有另一个版本的程序，它用 CUDA 计算第三项

```
new_matrix = matrix1 + matrix2 + GPU_GIVE_ME_A_MATRIX(); 
```

在分析了一下之后，我发现：

整个 GPU_GIVE_ME_A_MATRIX() 函数比 CPU_GIVE_ME_A_MATRIX() 函数更快（包括内存传输），所以 CUDA 完成了它的工作。

但是 new_matrix = matrix1 + matrix2 + CPU_GIVE_ME_A_MATRIX(); 比 new_matrix = matrix1 + matrix2 + GPU_GIVE_ME_A_MATRIX() 快；

什么可能导致这种奇怪的行为？CPU缓存什么？

由于这条线被执行了几次（渲染需要），整个CUDA程序比CPU版本慢，但正如我所说的GPU_GIVE_ME_A_MATRIX（）函数比CPU_GIVE_ME_A_FUNCTION（）快

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T21:47:49.937

CPU 版本将生成的矩阵放入 CPU 缓存中（或者至少可以），而 GPU 版本的结果必须从系统内存中读取。虽然在大多数情况下这是需要的（您不想在每个设备到主机传输时污染 CPU 缓存），但这意味着 CPU 读取此数据（至少是第一次）将比计算数据的主机慢-边。

通常建议尽可能长时间地保留设备上的内存，并尽可能少地传输回来。在这种情况下，听起来 GPU 没有得到足够的工作使其值得。也许比计算单个矩阵更大的任务可以交给 GPU？

# javascript - 合并排序 - 自下而上比自上而下更快吗？

> ID：10153393
> 
> 赞同：14
> 
> 时间：2012-04-14T11:53:09.943
> 
> 标签：javascript, algorithm, sorting, language-agnostic, mergesort

我一直在阅读 Sedgewick & Wayne 的“Algorithms, 4th Ed”，并且在此过程中我一直在实现 JavaScript 中讨论的算法。

我最近采用了书中提供的合并排序示例来比较自上而下和自下而上的方法……但我发现自下而上的运行速度更快（我认为）。在我的博客上查看我的分析。- [http://www.akawebdesign.com/2012/04/13/javascript-mergesort-top-down-vs-bottom-up/](http://www.akawebdesign.com/2012/04/13/javascript-mergesort-top-down-vs-bottom-up/)

我还没有找到任何讨论说一种合并排序方法应该比另一种更快。我的实施（或分析）有缺陷吗？

注意：我的分析测量算法的迭代循环，而不是严格的数组比较/移动。也许这是有缺陷或无关紧要的？

编辑：**我的分析实际上并没有计时速度，所以我关于它运行“更快”的说法有点误导。**我正在通过递归方法（自上而下）和 for 循环（自下而上）跟踪“迭代”——自下而上似乎使用较少的迭代。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-09T10:11:23.587

> 我还没有找到任何讨论说一种合并排序方法应该比另一种更快。

自下而上和自上而下的合并排序以及其他变体在 90 年代已得到很好的研究。简而言之，如果以单个key的比较次数来衡量成本，最好的成本相同（~（n lg n）/2），自顶向下的最差成本低于或等于最差自下而上的情况（但都〜n lg n）和自上而下的平均成本低于或等于自下而上的平均情况（但都〜n lg n），其中“lg n”是二进制对数。差异源于线性项。当然，如果n=2^p，这两种变体其实是完全一样的。这意味着，比较而言，自上而下总是比自下而上好。进一步证明了自顶向下归并排序的“半半”分裂策略是最优的。研究论文来自 Flajolet、Golin、Panny、

以下是我在 Erlang 的书*Design and Analysis of Purely Functional Programs*（College Publications，UK）中提出的内容：

```
tms([X|T=[_|U]]) -> cutr([X],T,U);
tms(T)           -> T.

cutr(S,[Y|T],[_,_|U]) -> cutr([Y|S],T,U);
cutr(S,    T,      U) -> mrg(tms(S),tms(T)).

mrg(     [],    T)            -> T;
mrg(      S,   [])            -> S;
mrg(S=[X|_],[Y|T]) when X > Y -> [Y|mrg(S,T)];
mrg(  [X|S],    T)            -> [X|mrg(S,T)]. 
```

请注意，这*不是*一个稳定的排序。此外，在 Erlang（和 OCaml）中，如果要节省内存，则需要在模式中使用*别名(ALIAS=...)。*这里的诀窍是在不知道其长度的情况下找到列表的中间位置。这是由 cutr/3 完成的，它处理两个指向输入列表的指针：一个增加一，另一个增加二，所以当第二个到达末尾时，第一个在中间。（我从 Olivier Danvy 的一篇论文中了解到这一点。）这样，您不需要跟踪长度，也不需要复制列表后半部分的单元格，因此您只需要 (1/2 )n lg n 额外空间，与 n lg n。这不是众所周知的。

人们经常声称自下而上的变体更适合函数式语言或链表（Knuth、Panny、Prodinger），但我认为这不是真的。

由于缺乏关于归并排序的讨论，我和你一样感到困惑，所以我做了自己的研究并写了一大章。我目前正在准备一个新版本，其中包含更多关于合并排序的材料。

顺便说一句，还有其他变体：队列合并排序和在线合并排序（我在书中讨论了后者）。

[编辑：由于成本的衡量标准是比较次数，因此选择数组与链表之间没有区别。当然，如果你用链表实现自上而下的变体，你必须很聪明，因为你不一定知道键的数量，但你每次都需要遍历至少一半的键，并且重新分配总共 (1/2)n lg n 个单元格（如果你很聪明的话）。使用链表的自下而上合并排序实际上需要更多额外的内存，n lg n + n 个单元格。因此，即使使用链表，自上而下的变体也是最佳选择。就程序的长度而言，您的里程可能会有所不同，但在函数式语言中，如果不需要稳定性，自顶向下的合并排序可以比自底向上的排序更短。有一些论文讨论了合并排序的实现问题，*合并排序程序的细致分析*，Katajainen 和 Larsson Traff (1997)。]

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-02T05:12:32.763

[我曾在本课程](https://www.coursera.org/course/algs4partI)2012 年 8 月版的 coursera 课堂论坛上问过同样的问题。普林斯顿大学的 Kevin wayne 教授回答说，在许多情况下，递归比迭代更快，因为缓存提高了性能。

所以我当时得到的简短回答是，由于缓存原因，自上而下的合并排序将比自下而上的合并排序更快。

请注意，该课程是用 Java 编程语言（不是 Javascript）教授的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-14T13:24:52.440

如果更快意味着更少的“迭代”，那么是的。如果您想知道执行时间。

原因是这 21,513 次迭代中的一些迭代次数超过了 22,527 次迭代。

从源代码来看，您的图表中的一些叶节点似乎是一起排序的，而不是单独排序，导致合并和排序更少，但它们花费的时间更长。

# css - 为一个字体系列中的每种字体分配不同的字体大小

> ID：10153403
> 
> 赞同：10
> 
> 时间：2012-04-14T11:53:55.200
> 
> 标签：css, fonts

我正在用英语以外的语言制作网页。

所以文本包含英语和其他语言的混合。

我分配了类似的字体系列

```
p{
font-family: 'EnglishFont', 'NonEnglishFont';
font-size:14px;
} 
```

它工作正常，但字体的原始矢量大小不同，导致句子在混合语言中看起来很奇怪。

所以我想在一个css类中为字体分配不同的大小，比如

```
p{
font-family: 'EnglishFont', 'NonEnglishFont';
font-size:14px, 16px;
} 
```

有什么办法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-14T12:13:07.250

您不能将字体大小设置为取决于字体系列。

相反，请尝试在页面上找到适合两种（或所有）语言的字体。字体设计师应该考虑到不同书写系统的不同特点。通常为亚洲语言设计的字体也有拉丁字母（至少是基本的拉丁字母，这对于英语来说已经足够了）。

如果你真的想为不同的书写系统设置不同的字体属性，你需要使用区分不同语言的标记，例如`lang`在 HTML 中使用属性和在 CSS 中基于它们的选择器。但是通常使用不同的字体是一个需要避免的问题，而不是一个解决方案。

# ipad - iPad HTML音频检测`load`

> ID：10153413
> 
> 赞同：0
> 
> 时间：2012-04-14T11:56:30.330
> 
> 标签：ipad, html, audio

我想检测音频何时加载到 iPad 上。我的代码加载并播放 mp3，但事件侦听器从不触发。

```
 $mp3.load()
        $mp3.addEventListener("load", function() {
            alert('Happy days') // <~~ this never fires
        }, true)
        $mp3.play() 
```

我正在使用 iOS 4.2。我知道所有这些可能不适用于最新的 iOS，我不介意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T22:10:29.193

您需要为 canplaythrough 添加一个事件侦听器，例如

`addEventListener("canplaythrough", this.onLoad.bind(this), false);`

然后一旦触发，将其删除，这样您就不会再次获得它：

`onLoad:function () { arguments.callee.removeEventListener("canplaythrough", this.onLoad.bind(this), false); // do something }`

# ruby-on-rails - Ruby on Rails - 关联问题 :(

> ID：10153414
> 
> 赞同：0
> 
> 时间：2012-04-14T11:56:55.120
> 
> 标签：ruby-on-rails, associations, one-to-one

我是一个新手，已经搜索了很多帖子和 railscast 教程，但仍然无法解决这个关联问题。

我有 2 个模型，一个酒店（由脚手架创建）和设施。

关键是将设施与酒店相关联，但由于我的设施表包含它需要的所有布尔类型的列），因此该表中的一行可以用于一家酒店。

问题是，我无法显示和保存/编辑/更新设施。在创建模型设施时，我创建了一个 hotel_id 列。我的代码是：

楷模：

```
class Facility < ActiveRecord::Base

  belongs_to :hotel

  attr_accessible :concierge, :hotel_id, :room24h

end

class Hotel < ActiveRecord::Base

  has_one :facility, :dependent => :destroy

  accepts_nested_attributes_for :facility, :allow_destroy => true

  attr_accessible :name, :rating, :recommended, :facility_attributes

end 
```

我在视图中的形式是：

* * *

```
<%= form_for(@hotel) do |f| %>

  <div class="field">
    <%= f.label :name %><br />
    <%= f.text_field :name %>
  </div>

  <div class="field">
    <%= f.label :rating %><br />
    <%= f.number_field :rating %>
  </div>

  <div class="field">
    <%= f.label :recommended %><br />
    <%= f.check_box :recommended %>
  </div>

  <br />
    Hotel Facilities

    <%= f.fields_for :facility do |facility_fields| %>
 <div class="field">
    <%= facility_fields.label :room24h, "24h Room Service:" %>
    <%= facility_fields.check_box :room24h %>
  </div>

 <div class="field">
    <%= facility_fields.label "Concierge:" %>
    <%= facility_fields.check_box :concierge %>
  </div>

<%end%>

  <div class="actions">
    <%= f.submit %>
  </div>
<%end%> 
```

* * *

至于控制器，hotels_controller 就像你刚刚搭好脚手架，而我的 facility_controller 是空的一样。

它现在在表单中显示设施，但是当我单击“创建”并提交时，我得到：

```
"Can't mass-assign protected attributes: @hotel" 
```

和

```
app/controllers/hotels_controller.rb:46:in `new'
app/controllers/hotels_controller.rb:46:in `create' 
```

至于参数输入：

```
{"hotel"=>{"rating"=>"1",
 "name"=>"aaa",
 "recommended"=>"0",
 "@hotel"=>{"room24h"=>"1",
 "concierge"=>"1"}},
 "commit"=>"Create Hotel",
 "utf8"=>"✓",
 "authenticity_token"=>"YU7KEJ8qz0iQcXPGkLP6BSJn7JL6df1HvuS5JnjK2eU="} 
```

有任何想法吗？控制器中缺少什么？再次提前感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:20:36.567

在新建/编辑操作中创建@hotel.facility || @hotel.build_facility

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T10:07:22.607

问题解决了。对于有相同问题的任何人：添加到新控制器中：

```
@facility=@hotel.build_facility 
```

@klump，在尝试正确的语法后，该语法不正确是：

`<%= f.fields_for :facility do |fc|%>`

因此，感谢 Amar，为我指明了正确的方向。

# android - 以编程方式安装 .apk 文件

> ID：10153417
> 
> 赞同：0
> 
> 时间：2012-04-14T11:57:35.697
> 
> 标签：android

我想在我的应用程序中以编程方式安装apk文件，为此我编写代码如下

```
 f=new File("l.o.p-1.apk");
        Intent i=new Intent(android.content.Intent.ACTION_VIEW);
        i.setDataAndType(Uri.fromFile(f),"application/vnd.android.package-archive");
        startActivity(i); 
```

但它不起作用，并显示一个警告对话框，并显示消息解析错误：解析包问题为什么我收到此错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T11:59:48.833

尝试从谷歌网站上传相同的 APK 并检查它是否可以工作，如果它显示相同的错误，这意味着你的 apk 有问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:27:56.287

检查您要安装的位置。

例如，当我将 apk 下载到我的[缓存](http://developer.android.com/reference/android/content/Context.html#getCacheDir%28%29)文件夹时，安装时出现解析错误，但将其下载到我的[外部缓存](http://developer.android.com/reference/android/content/Context.html#getExternalCacheDir%28%29)文​​件夹允许安装正常进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T12:10:23.280

您可以尝试使用命令安装它并检查是否出现错误：

```
adb install [your.apk] 
```

如果有效，还要检查 apk 文件的位置。（我认为它应该在手机的 sdcard 上.. 我不确定..）

希望这可以帮助！

# php - 从 CodeIgniter（或任何 MVC 平台）中的数据库中提取数据？

> ID：10153419
> 
> 赞同：4
> 
> 时间：2012-04-14T11:57:58.923
> 
> 标签：php, mysql, sql, model-view-controller, codeigniter

我在模型中有这个：

```
public function index_loop() { 
        $post_user = $this->db->query("SELECT posts.post_title, posts.post_content, posts.post_date, users.username FROM posts LEFT JOIN users ON posts.user_id = users.user_id ORDER BY posts.post_ID DESC");
        //$categories = $this->db->query("SELECT categories.cat_name, categories.cat_id FROM  
        //$comments = $this->db->query("SELECT COUNT(comment_id) FROM comments WHERE
        return $post_user->result_array();
    } 
```

我需要的是显示每个帖子和评论的类别（尽管我想如果我弄清楚类别传递而不是评论是相同的方式）

在查看文件中：

```
 <?php foreach($posts as $zz) { ?>
         <div class="article">
           <h2><?php echo $zz['post_title']; ?></h2>
           <p>Posted by <a href=""><?php echo $zz['username']; ?></a> | Filed under <a href="#">templates</a>, <a href=>internet</a></p>
            <p><?php echo $zz['post_content']; ?></p>
           <p><a href=>Read more</a> | <a href=>Comments (5)</a> | <?php echo $zz['post_date']; ?></p>
        </div> <?php } ?> 
```

所以，如果我想在每个博客上循环类别，我需要那个博客 ID，如果我从 Model 进行所有查询，我该如何获取它？评论也一样

我做一个大的复杂的数据库查询（这很难，但我可以做到）或者我可以做 2 或 3 个单独的小查询，这很好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T07:52:36.040

Codeigniter 允许您将数据库结果作为对象（例如模型对象）返回，这使得数据更易于使用。您可以向`Posts`表发出初始查询，在结果集中包含该`posts.id`字段，并将`Post_model`类的名称传递给`$db->query->result()`函数以告诉 codeigniter 您希望将结果作为`Post_model`类的实例返回。

然后，您可以在`Post_model`类上定义`GetCategories`by`post_id`和`GetComments`by`post_id`方法，然后调用这些方法来填充您的`$categories`和`$comments`集合，以获取`Post_model`从查询返回的每个。

这是一个例子，我希望它有帮助：

```
 public class Post_model extends CI_Model
    {

        // All the properties in the Posts table, as well as a couple variables to hold the categories and comments for this Post:
        public $id;
        public $post_title;
        public $post_content;
        public $post_date;
        public $username;        
        public $categories;
        public $comments;

        public function index_loop() 
        { 
                return $this->GetAllPosts();
        }

        // function to get all posts from the database, including comments and categories.
        // returns an array of Post_model objects
        public function GetAllPosts()
        {
                // define an empty array to hold the results of you query.
                $all_posts = array();

                // define your sql query. NOTE the POSTS.ID field has been added to the field list
                $sql = "SELECT posts.id, 
                               posts.post_title, 
                               posts.post_content, 
                               posts.post_date,
                               users.username
                        FROM posts LEFT JOIN users ON posts.user_id = users.user_id
                        ORDER BY posts.post_id DESC";

                // issue the query
                $query = $this->db->query($sql);

                // loop through the query results, passing a string to result() which represents a class to instantiate 
                //for each result object (note: this class must be loaded)

                foreach($query->result("Post_model") as $post)
                {
                        $post->categories = $this->GetPostCategories($post->id);
                        $post->comments = $this->GetPostComments($post->id);
                        $all_posts[] = $post;
                }

                return $all_posts;
        }

        // function to return categories for a given post_id.
        // returns an array of Category_model objects.
        public function GetPostCategories($post_id)
        {
                $sql = "SELECT category.id, ... WHERE post_id = ?";
                $query = $this->db->query($sql, array($post_id));
                $categories = array();
                foreach($query->result("Category_model") as $category)
                {
                        $categories[] = $category;
                }
                return $categories;
        }

        // function to return comments for a given post_id. 
        //returns an array of Comment_model objects
        public function GetPostComments($post_id)
        {
                $sql = "SELECT comment.id, ... WHERE post_id = ?";
                $query = $this->db->query($sql, array($post_id));
                $comments = array();
                foreach($query->result("Comment_model") as $comment)
                {
                        $comments[] = $comment;
                }
                return $comments;
        }    
} 
```

然后，在您看来，您可以将 $posts 数组作为 Post_model 对象而不是 result_arrays 访问：

```
<?php foreach($posts as $zz) { ?>
         <div class="article">
           <h2><?php echo $zz->post_title; ?></h2>
           <p>Posted by <a href=""><?php echo $zz->username; ?></a> | 

              Filed under 
               <?php foreach($zz->categories as $category) {
                        echo '<a href="#">{$category->name}</a>, ';
                     }
               ?>
           </p>
           <p><?php echo $zz->post_content; ?></p>
           <p><a href=>Read more</a> | <a href=>Comments (5)</a> | <?php echo $zz->post_date; ?></p>
        </div> <?php } ?> 
```

至于效率问题，这将取决于很多因素（数据库是否与 Web 服务器位于同一台机器上？有多少帖子？等等）。单个大型查询通常比几个较小的查询执行得更快，但需要进行分析才能真正确定性能提升是否值得寻求。我总是更喜欢尝试编写可读/可理解的代码，而不是以增加复杂性为代价进行优化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T15:59:49.910

你可以做一件事。

制作不同的类别表和评论表。

category_id 将与 post 表中的 category_id 列链接。

在评论表中，创建列 post_id 将与 post 表中的 post_id 链接。

然后您可以通过此扩展查询一次检索所有信息。

```
$post_user = $this->db->query("SELECT posts.post_title, posts.post_content, posts.post_date, users.username FROM posts LEFT JOIN users ON posts.user_id = users.user_id LEFT JOIN category ON category.category_id = post.category_id ORDER BY posts.post_ID DESC"); 
```

在这里你得到了类别。

对于评论，我不确定您希望输出如何。一种方法，正如严所说。如果您可以更具体，我可以建议一些更简单的方法。

# c - 如何使用 WebKitGTK 加载带有 Flash 的 HTML？

> ID：10153422
> 
> 赞同：3
> 
> 时间：2012-04-14T11:58:17.723
> 
> 标签：c, linux, flash, webkit, gtk

使用 Linux、GTK 3 和 WebKitGTK，如何在 WebKitWebView 中加载带有 Flash 的 HTML 文件？我成功打开了像“ [http://www.google.com](http://www.google.com) ”这样的普通 URL，但是当我想打开一个 URL 播放 Flash 文件时，Flash 没有显示在 web 视图中，而是显示“缺少插件”。如何在 WebKitGTK 中加载 Flash 插件？

# c# - windows phone mango c#中的文本框边框消失了

> ID：10153424
> 
> 赞同：1
> 
> 时间：2012-04-14T11:58:50.750
> 
> 标签：c#, windows-phone-7

我不是 windows phone mango UI 设计专家。当我将layoutroot的背景更改为白色时，当我尝试编辑文本框中的任何值时，文本框边框消失...请建议

代码

```
<phone:PhoneApplicationPage 
    x:Class="WP7MangoSocketsTest.Page1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    Foreground="{StaticResource PhoneForegroundBrush}"
    SupportedOrientations="Portrait" Orientation="Portrait"
    mc:Ignorable="d" d:DesignHeight="768" d:DesignWidth="480"
    shell:SystemTray.IsVisible="True">

    <!--LayoutRoot is the root grid where all page content is placed-->
    <Grid x:Name="LayoutRoot" Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!--TitlePanel contains the name of the application and page title-->
        <StackPanel x:Name="TitlePanel" Grid.Row="0" Margin="12,17,0,28">
            <TextBlock x:Name="ApplicationTitle" Text="MY APPLICATION" Style="{StaticResource PhoneTextNormalStyle}"/>
            <TextBlock x:Name="PageTitle" Text="page name" Margin="9,-7,0,0" Style="{StaticResource PhoneTextTitle1Style}"/>
        </StackPanel>

        <!--ContentPanel - place additional content here-->
        <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
            <TextBox Foreground="Black" Height="72" HorizontalAlignment="Left" Margin="127,23,0,0" Name="textBox1" Text="TextBox" VerticalAlignment="Top" Width="217" />
        </Grid>
    </Grid>

    <!--Sample code showing usage of ApplicationBar-->
    <!--<phone:PhoneApplicationPage.ApplicationBar>
        <shell:ApplicationBar IsVisible="True" IsMenuEnabled="True">
            <shell:ApplicationBarIconButton IconUri="/Images/appbar_button1.png" Text="Button 1"/>
            <shell:ApplicationBarIconButton IconUri="/Images/appbar_button2.png" Text="Button 2"/>
            <shell:ApplicationBar.MenuItems>
                <shell:ApplicationBarMenuItem Text="MenuItem 1"/>
                <shell:ApplicationBarMenuItem Text="MenuItem 2"/>
            </shell:ApplicationBar.MenuItems>
        </shell:ApplicationBar>
    </phone:PhoneApplicationPage.ApplicationBar>-->

</phone:PhoneApplicationPage> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:12:32.333

即使您没有将背景设置为白色，也会发生这种情况。这是因为 textBox 有一种样式，当它被选中/聚焦时，它会忽略边框。要使其使用边框，您必须定义自定义 TextBox 样式（如本文中所示）[。](http://forums.create.msdn.com/forums/p/63388/388622.aspx)

# android - 将大型 Android 项目切片到 Android 库中会缩短构建时间吗？

> ID：10153425
> 
> 赞同：3
> 
> 时间：2012-04-14T11:58:53.013
> 
> 标签：android, android-library

我有一个相当大的 Android 项目，sdk 需要花费大量时间来进行资源解析/ dexing / 等。我想以某种方式改进这一点。

我读过 Android 库项目现在也可以包含资源。所以我们也可以在里面放Activity、Fragments等。

这是否意味着，如果我将大型项目的一部分导出到我从主项目引用的库项目中，那么当我重建主项目时，我不必再次重建已经构建（而不是修改）的库？所以我只需要对修改后的库和可能的主项目进行资源解析/索引等，在大多数情况下减少了整体构建时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T04:10:01.483

> 这是否意味着，如果我将大型项目的一部分导出到我从主项目引用的库项目中，那么当我重建主项目时，我不必再次重建已经构建（而不是修改）的库？

部分不，Android Library Project 不是直接构建的，它始终与依赖的 Main Project 一起构建，当 SDK 编译/构建 Main Project 时，SDK 工具将 Library Project 编译为临时 JAR 文件并在主项目中使用它。每当您重新构建主项目时，引用的库项目都会作为主项目构建生命周期的一部分重新构建，即使库项目中没有任何更改。查看在您的 app-lib/bin 文件夹下生成的临时 JAR 的时间戳以获取证据，每次构建主项目时它总是会更改。

引用[官方开发指南](http://developer.android.com/guide/developing/projects/index.html#LibraryProjects)：

> 但是，库项目与标准 Android 应用程序项目的不同之处在于，您不能将其直接编译为自己的 .apk 并在 Android 设备上运行。同样，您不能将库项目导出到自包含的 JAR 文件，就像对真正的库所做的那样。相反，您必须通过在依赖应用程序中引用库并构建该应用程序来间接编译库。
> 
> 当您构建依赖于库项目的应用程序时，SDK 工具会将库编译为临时 JAR 文件并在主项目中使用，然后使用结果生成 .apk。如果在应用程序和库中都定义了资源 ID，这些工具会确保应用程序中声明的资源获得优先级，并且库项目中的资源不会编译到应用程序 .apk 中。这使您的应用程序可以灵活地使用或重新定义在任何库中定义的任何资源行为或值。

Android 库项目不同于常规的 java 库项目。您可以在其中一次将所有内容编译并构建到 jar 库中，然后开始从主项目中的参考 jar 依赖项中导入/使用该类。目前 Android 库项目是基于源代码的机制设计的，而不是基于编译代码的库机制，正如[这个 Android 博客](http://android-developers.blogspot.co.nz/2011/10/changes-to-library-projects-in-android.html)中所提到的，尽管在未来的版本中承诺了自包含的 jar 分发（不幸的是，r15、r16、r17 和 r18 都没有然而）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T04:21:19.600

I wouldn't expect huge time savings here.

In my experience, the slowest step of compilation is actually the `dex`ing of the output files, which can not be performed incrementally, so moving your code into libraries will not speed things up. Similarly, incremental compilation (when it works — it often doesn't with the Android toolchain) will work equally well with unchanged files spread over a bunch of projects as will unchanged files in a single project.

Of course, the best way to find the answer for your actual use case is to experiment on your actual code base. And there may also be code maintainability benefits to splitting your project up into independent modules.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T12:05:15.393

是的...除非您构建 Clean，否则构建系统会重建需要构建的内容。

# python - 如何以前瞻性的方式扩展 django 视图/模板

> ID：10153430
> 
> 赞同：1
> 
> 时间：2012-04-14T11:59:48.053
> 
> 标签：python, django, templates, views

我正在寻找一种方法来扩展 django 模板/视图。

我的第一个实现包括两个模型（`clients/models.py`）：

```
class Client(models.Model):
    ...

class Address(models.Model):
    client = models.ForeignKey(Client)
    ... 
```

及其相当简单的模板 ( `clients/detail.html`) ：

```
{{client.name}}
Address: {{client.address.street}}, {{client.address.zipcode}} {{client.address.city}} 
```

随着我的应用程序的增长，一个新的应用程序诞生了：“发票”。

同样非常简单（`invoices/models.py`）：

```
class Invoice(models.Model):
    client = models.ForeignKey(clients.models.Client)
    ... 
```

现在我的客户详细信息视图需要显示发票，所以我`clients/detail.html`在我的“发票”应用程序中创建和覆盖。

现在很好。

后来我创建了第三个应用程序“报价”。我的客户详细信息视图再次需要显示报价。

如果我`clients/detail.html`在我的“客户”中创建，我将失去显示发票的能力。

因为“发票”和“报价”应用程序是独立的。

我的第一个想法是创建类似 SubView 类的东西，它可以扩展“发票”和“报价”，然后在某处注册它们的实现。

模板应如下所示：

```
{{client.name}}
Address: {{client.address.street}}, {{client.address.zipcode}} {{client.address.city}}

{% for view in views %}
    <h1>{{view.title}}</h1>
    {{view.get_html}}
{% endfor %} 
```

这是一个好方法吗？我应该使用类似`admin.site`的实现来注册我的子视图吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T12:08:59.563

在 Django`url`中，`urls.py`理想情况下应该使用*one* `view`，以保持简单。

因此，我将采用将所有必需的上下文放在此屏幕的*一个*视图中的方法（我认为您已经通过模型中的外键获得了这个）。然后，我不会做你所谓的“SubView-class”，而是选择 Django 模板[include tag](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#include)。

例子：

```
{% for invoice in client.invoices %}
    {% include "invoice-detail.html" with invoice=invoice %}
{% endfor %} 
```

这将为`client`. 请注意这如何符合[DRY 原则](https://docs.djangoproject.com/en/dev/misc/design-philosophies/#don-t-repeat-yourself-dry)。

# delphi - 我需要调用 RtlQueryProcessHeapInformation 的原型

> ID：10153434
> 
> 赞同：1
> 
> 时间：2012-04-14T12:00:37.330
> 
> 标签：delphi, winapi, function-prototypes

我需要在 Delphi 中调用 RtlQueryProcessHeapInformation。RtlQueryProcessHeapInformation 是从 ntdll.dll 导出的函数。我没有这个函数的原型。我收到“未声明的标识符”错误。

```
asm 
 ...
 xchg ebx, eax
 pop ebp
 call RtlQueryProcessHeapInformation
 dec ebp
 ...
end; 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T12:28:36.563

一些网络搜索导致[这个页面](http://read.pudn.com/downloads50/sourcecode/hack/trojan/170997/win32toolkit/ntdll.h__.htm)或[这个](http://read.pudn.com/downloads3/sourcecode/windows/248345/win2k/private/ntos/dll/query.c__.htm)表明该功能如下所示：

```
NTSTATUS NTAPI RtlQueryProcessHeapInformation( 
    IN OUT PRTL_DEBUG_INFORMATION Buffer 
); 
```

`NTSTATUS`您已经从[上一个问题](https://stackoverflow.com/questions/10138048/import-a-system-function-windows-ntsystem-dll-for-use-in-inline-assembly)中知道了什么。至于`NTAPI`，那是`__stdcall`。这意味着 Delphi 中的函数声明是：

```
function RtlQueryProcessHeapInformation(
    Buffer: PRTL_DEBUG_INFORMATION
): NTSTATUS; stdcall; external 'ntdll.dll'; 
```

我链接到的页面还包含一个声明，`PRTL_DEBUG_INFORMATION`我相信你可以自己翻译。您仍然需要对参数的含义进行逆向工程，因为这是一个实现私有的、未记录的函数。

* * *

这是您提出的第二个几乎相同的问题。在这两个问题中，您都将问题作为汇编程序问题提出。但事实并非如此。在这两个问题中，您都需要制定函数的声明，以及如何从外部 DLL 中导入它。你应该从中得到的是，当你需要调用另一个 DLL 中的函数时，你可以做以下两件事之一：

1.  `external`使用我在您的两个问题中显示的代码隐式导入它。这是更简单的方法。
2.  使用`LoadLibrary`and`GetProcAddress`显式导入它。这是比较费力的方法。

请不要采取错误的方式——我只是想向您展示您需要知道什么才能自己解决这些问题。

# ssh - 关闭 ssh 会话时防止终端清除

> ID：10153435
> 
> 赞同：2
> 
> 时间：2012-04-14T12:00:52.857
> 
> 标签：ssh, terminal

当我在某些主机上退出 ssh 会话时，我的终端将清除。如果这永远不会发生，我会喜欢它，有没有简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T12:35:34.640

通常不应该。如果它对你有用，那么你可能在`.bash_logout`你已经进入的盒子里有类似的东西，这会导致服务器上的外壳在你注销时清除终端。

# postgresql - 如何在 PostgreSQL 中匹配模式时转义字符串

> ID：10153440
> 
> 赞同：4
> 
> 时间：2012-04-14T12:01:47.460
> 
> 标签：postgresql, go, sql-like

我想查找文本列以用户给定字符串开头的行，例如，`SELECT * FROM users WHERE name LIKE 'rob%'`但“rob”是未经验证的用户输入。如果用户写入一个包含特殊模式字符（如“rob_”）的字符串，它将匹配“robert42”和“rob_the_man”。我需要确保字符串在字面上匹配，我该怎么做？我是否需要在应用程序级别处理转义，还是一种更漂亮的方式？

我正在使用 PostgreSQL 9.1 和[go-pgsql](https://github.com/lxn/go-pgsql) for Go。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-14T16:37:08.713

_ 和 % 字符必须被引用才能在 LIKE 语句中进行字面匹配，这是没有办法的。选择是在客户端还是服务器端（通常使用 SQL replace()，见下文）。此外，为了在一般情况下 100% 正确，还有一些事情需要考虑。

默认情况下，在 _ 或 % 之前使用的引号字符是反斜杠 (\)，但可以使用紧跟在 LIKE 子句之后的 ESCAPE 子句来更改它。在任何情况下，引号字符都必须在模式中重复两次才能按字面意思作为一个字符进行匹配。

示例：`... WHERE field like 'john^%node1^^node2.uucp@%' ESCAPE '^'`将匹配*john%node1^node2.uccp@*后跟任何内容。

[反斜杠的默认选择存在问题：当standard_conforming_strings](http://www.postgresql.org/docs/current/static/runtime-config-compatible.html#GUC-STANDARD-CONFORMING-STRINGS)为 OFF时，它已经用于其他目的（PG 9.1 默认将其设置为 ON，但以前的版本仍在广泛使用，这是需要考虑的一点）。

此外，如果在用户输入注入场景中对 LIKE 通配符的引用是在客户端完成的，那么**除了**用户输入中已经需要的正常字符串引用之外，它还会出现。

看一下 go-pgsql 示例就知道它使用 $N 样式的占位符来表示变量...所以这里尝试以某种通用的方式编写它：它与 standard_conforming_strings 一起工作，无论是 ON 还是 OFF，使用服务器端替换[%_]，另一种引号字符，引号字符的引用，避免sql注入：

```
 db.Query("SELECT * from USERS where name like replace(replace(replace($1,'^','^^'),'%','^%'),'_','^_') ||'%' ESCAPE '^'",
     variable_user_input); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-14T16:29:13.297

要转义`like`表达式中要在模式中使用的下划线和百分比，请使用转义字符：

```
SELECT * FROM users WHERE name LIKE replace(replace(user_input, '_', '\\_'), '%', '\\%'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T16:34:41.680

据我所知，LIKE 运算符唯一的特殊字符是百分比和下划线，这些可以很容易地使用反斜杠手动转义。它不是很漂亮，但它有效。

```
SELECT * FROM users WHERE name LIKE
regexp_replace('rob', '(%|_)', '\\\1', 'g') || '%'; 
```

我觉得奇怪的是 PostgreSQL 没有附带这样的功能。谁希望他们的用户编写自己的模式？

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-16T21:47:20.030

最好的答案是您根本不应该将用户输入插入到您的 sql 中。即使转义 sql 仍然很危险。

下面使用 go 的 db/sql 库说明了一种更安全的方法。用您的 go postgresql 库的等效项替换 Prepare 和 Exec 调用。

```
// The question mark tells the database server that we will provide
// the LIKE parameter later in the Exec call
sql := "SELECT * FROM users where name LIKE ?"
// no need to escape since this won't be interpolated into the sql string.
value := "%" + user_input
// prepare the completely safe sql string.
stmt, err := db.Prepare(sql)
// Now execute that sql with the values for every occurence of the question mark.
result, err := stmt.Exec(value) 
```

这样做的好处是可以安全地使用用户输入，而不必担心它将 sql 注入到您运行的语句中。您还可以获得为多个查询重用准备好的 sql 的好处，这在某些情况下可能更有效。

# c++ - 函数返回字符串和 const char* 中的错误值

> ID：10153442
> 
> 赞同：0
> 
> 时间：2012-04-14T12:01:55.820
> 
> 标签：c++, string

我的程序中有这个功能

```
const char* Graph::toChar() {
    std::string str;
    const char* toret;
    str = "";
    for (vector<Edge*>::iterator it = pile.begin(); it != pile.end(); it++) {
        str += (*it)->toString();
    }
    toret = str.c_str();
    return toret;
} 
```

然后我正在调试该功能，一切正常，直到我 *返回 toret；*线。我按下 step over ，调试器将转到*std::string str;* line 和所有字符串和字符变量都变成*""*，所以函数的最终返回是*""*（什么都没有）。

我究竟做错了什么？

*(*它)->toString();* 工作正常，当调试器执行 *toret = str.c_str();* *toret*中的值是正确的。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T12:09:43.413

你在这里做的很糟糕：你正在返回`c_str`一个`std::string`超出范围时即将被删除的。不管调试模式与否，这意味着不可预测的行为。实际上相当可预测 - 你的程序会崩溃:)

您应该返回`const std::string`、接受`std:string &`作为参数并构建它，或者使用`strdup()`将字符串的 c_str 复制到将保留在内存中的内容。请记住，使用 strdup() 意味着您必须稍后将其删除。

以下是可以使用的两种形式的函数：

```
const std::string Graph::toChar() {
    std::string str;
    for (vector<Edge*>::iterator it = pile.begin(); it != pile.end(); it++) {
        str += (*it)->toString();
    }
    return str;
} 
```

或者

```
void Graph::toChar(std::string &out) {
    out = ""
    for (vector<Edge*>::iterator it = pile.begin(); it != pile.end(); it++) {
        out += (*it)->toString();
    }
} 
```

# c - 井字游戏在第三步后重置棋盘

> ID：10153443
> 
> 赞同：-1
> 
> 时间：2012-04-14T12:01:56.153
> 
> 标签：c

所以一切正常，直到第四步。然后它重置板并将 X 放在第一个框中。它出什么问题了？另外，我希望我能被引导到答案，而不仅仅是给出答案，而是为了学习。我还尝试通过切割一个部分并检查它的作用来在没有任何帮助的情况下找到答案。（不知道如何使用调试器，因为它总是给出，文件名没有调试信息）。

```
#include <stdio.h>
#include <stdlib.h>
int clear(void);
int displayboard(void);
int initialize(void);
int startgame(void);
int checkwin(char);
int canwin(void);
int getmove(void);
int makemove(void);
int canblock(void);
char board[3][3];
int main()
{   
    int menuchoice;
    while(1)
    {
        printf("            |\\  /| | |    /\\   |\\  |\n");
        printf("            | \\/ | | |   /--\\  | \\ |\n");
        printf("            |    | | |_ /    \\ |  \\|\n");
        printf("              Tic-tac-toe Version 1 \n\n");
        printf("                  [Main Menu]\n");
        printf("                 1 - Start game\n");
        printf("                 2 - Exit game\n");
        scanf("%d",&menuchoice);
        if(menuchoice==1)
        {
            clear();
            startgame();
        }
        else if(menuchoice==2)
        {
            exit(EXIT_SUCCESS);
        }
    }
}
/* Prints newlines to refresh the page */
int clear(void)
{
    int i;
    for(i=0;i<25;i++)
    {
        printf("\n");
    }
    return 0;
}
/* Makes the board blank */
int initialize(void)
{
    int numrow,numcol;
    numrow=0;
    numcol=0;
    while(numrow<3)
    {   
        while(numcol<3)
        {   
            board[numrow][numcol]=' ';
            numcol++;
        }
        numcol=0;
        numrow++;
    }
    return 0;
}
/* Prints the board */
int displayboard(void)
{
    printf("                 1    2    3\n\n\n");
    printf("              1   %c | %c | %c \n",board[0][0],board[0][1],board[0][2]);
    printf("                ------------- \n");
    printf("              2   %c | %c | %c  \n",board[1][0],board[1][1],board[1][2]);
    printf("                ------------- \n");
    printf("              3   %c | %c | %c  \n",board[2][0],board[2][1],board[2][2]);
    return 0;
}
/* Function that controls the game*/
int startgame(void)
{

    int movecount;
    while(1)
    {
        movecount=0;
        initialize();   
        displayboard();
        board[1][1]='X';
        clear();
        displayboard();
        getmove();
        makemove();
        movecount=3;
        while(1)
        {
            clear();
            displayboard();
            getmove();
            /* I believe the problem starts here */
            if(checkwin('O')==1)
            {
                printf("\n\t\t\tYou WIN!!!!");
                /*just to test*/
                exit(EXIT_SUCCESS);
            }
            movecount++;
            canwin(); /* Checks if it can make winning move */
            if(canblock()==0) /*if a move to block has not been made*/
            {
                makemove();
                movecount++;
            }
            else if(canblock()==1) /*if a move to block has been made*/
            {
                movecount++;
            }
            if(checkwin('X')==1)
            {
                printf("\n\t\t\tYou LOSE!!!");
                /* just to test */
                exit(EXIT_SUCCESS);
            }
            if(movecount==9)
            {
                printf("                Its a DRAW!!!");
                /*Just to test */
                exit(EXIT_SUCCESS);
            }
        }
    }
}
/* Function to check win */
int checkwin(char ltr)
{
    int rownumber,colnumber;
    for(rownumber=0;rownumber<3;rownumber++)
    {
        if(board[rownumber][0]==ltr && board[rownumber][1]==ltr && board[rownumber][2]==ltr)
        {
            return 1;
        }
    }
    for(colnumber=0;colnumber<3;colnumber++)
    {
        if(board[0][colnumber]==ltr && board[1][colnumber]==ltr && board[2][colnumber]==1)
        {
            return 1;
        }
    }
    if(board[0][0]==ltr && board[1][1]==ltr && board[2][2]==ltr)
    {
        return 1;
    }
    else if(board[0][2]==ltr && board[1][1]==ltr && board[2][0]==ltr)
    {
        return 1;
    }
    else
        return 0;
}
/* Function to get move */
int getmove(void)
{
    int colnumber,rownumber;
    printf("\n\t\t\tWhat row do you want to put your move?\n");
    scanf("%d",&rownumber);
    printf("\n\t\t\tWhat column do you want to put your move?\n");
    scanf("%d",&colnumber);
    board[rownumber-1][colnumber-1]='O';
    return 0;
}
/* Function to makemove */
int makemove(void)
{
    if(board[0][0]==' ')
    {
        board[0][0]='X';
        return 0;
    }
    else if(board[0][2]==' ')
    {
        board[0][2]='X';
        return 0;
    }
    else if(board[2][0]==' ')
    {
        board[2][0]='X';
        return 0;
    }
    else if(board[2][2]==' ')
    {
        board[2][2]='X';
        return 0;
    }
    else if(board[0][1]==' ')
    {
        board[0][1]=='X';
        return 0;
    }
    else if(board[1][0]==' ')
    {
        board[1][0]='X';
        return 0;
    }
    else if(board[1][2]==' ')
    {
        board[1][2]='X';
        return 0;
    }
    else if(board[2][1]==' ')
    {
        board[2][1]='X';
        return 0;
    }
}
/* Function to make winning move */
int canwin(void)
{
    int rownumber,colnumber;
    for(rownumber=0;rownumber<3;rownumber++)
    {
        for(colnumber=0;colnumber<3;colnumber++)
        {
            board[rownumber][colnumber]='X';
            if(checkwin('X')==1)
            {
                return 1;
            }
            board[rownumber][colnumber]=' ';
        }
    }
    return 0;
}
/* Function to block winning move */
int canblock(void)
{
    int rownumber,colnumber;
    for(rownumber=0;rownumber<3;rownumber++)
    {
        for(colnumber=0;colnumber<3;colnumber++)
        {
            board[rownumber][colnumber]='O';
            if(checkwin('O')==1)
            {
                board[rownumber][colnumber]='X';
                return 1;
            }
            else if(checkwin('O')==0)
            {
                board[rownumber][colnumber]=' ';
            }
        }
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T12:24:21.880

我认为您的`canwin()`功能存在问题，据我了解，您希望 AI 测试它是否可以做出成功的举动。但是看功能

```
int canwin(void)
{
    int rownumber,colnumber;
    for(rownumber=0;rownumber<3;rownumber++)
    {
        for(colnumber=0;colnumber<3;colnumber++)
        {
            board[rownumber][colnumber]='X'; // <--- Problem here
            if(checkwin('X')==1)
            {
                return 1;
            }
            board[rownumber][colnumber]=' ';
        }
    }
    return 0;
} 
```

你实际上是用 覆盖你的棋盘的当前位置`'X'`，而不检查那里是否已经有一个符号！因此，您实际上是在用`'X'`es 覆盖您的棋盘，检查 X-player 是否赢了，如果没有“重置”到空白空间`' '`！

您可以通过在写入之前插入支票来解决此问题，如下所示：

```
if (board[rownumber][colnumber] == ' ')
{
    board[rownumber][colnumber]='X';
    ... 
```

# jquery - HTML5 和 jQuery：使用音频播放器作为 if 语句的计时器？

> ID：10153444
> 
> 赞同：0
> 
> 时间：2012-04-14T12:02:06.667
> 
> 标签：jquery, html, audio, timer, html5-audio

我有一个带有 3 秒音频样本的 html5 音频播放器。是否可以使用此音频播放器的计时器/计数器？因为我想在几秒钟内添加文本或图像。

我用Javascript做了一个（不工作的例子）。但我认为使用 jQuery 会更好，所以我可以使用 .append 函数。

[JsFiddle在这里](http://jsfiddle.net/t946k/)

HTML：

```
<audio id="audio_2" controls="controls">
<source src="http://www.pachd.com/sfx/metallic-clonks.wav">
</audio>

    <div id="div1"></div>

    <div id="div2"></div>

    <div id="div3"></div> 
```

JS：

```
document.getElementById('audio_2').addEventListener('addingthings', function() {
if (this.currentTime == 1) {
    document.getElementById('div1').innerHTML = 'second second';
}
if (this.currentTime == 2) {
    document.getElementById('div2').innerHTML = 'second second';
}
if (this.currentTime == 3) {
    document.getElementById('div3').innerHTML = 'third second';
} 
```

});

CSS：

```
#audio_2
{
height: 20px;
width: 200px;
float: left;
}

#div1{
width: 80px;
height: 30px;
background: lightblue;  
color: blue;  
border-bottom: 5px solid blue;    
float: left;
margin-left: 5px;
}

#div2{
width: 80px;
height: 30px;
background: lightblue;  
color: blue;  
border-bottom: 5px solid blue;
float: left;
margin-left: 5px;    
}

#div3{
width: 80px;
height: 30px;
background: lightblue;  
color: blue;  
border-bottom: 5px solid blue;
float: left;
margin-left: 5px;   
} 
```

我的问题是：是否可以使用 HTML 音频播放器的计时器/计数器？如果是，我如何使用 jQuery 将 if 语句添加到各个秒？先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T12:25:47.197

您可能想查看 HTML5 媒体元素事件： [http](http://dev.w3.org/html5/spec/media-elements.html#mediaevents) ://dev.w3.org/html5/spec/media-elements.html#mediaevents （该`ontimeupdate`事件听起来对您来说很有趣！）。

您还需要四舍五入，`currentTime`因为`onTimeUpdate`1 秒周期内不会触发。

```
Math.floor(this.currentTime) == 1 
```

看看这个工作示例：

[http://jsfiddle.net/t946k/1/](http://jsfiddle.net/t946k/1/)

# regex - 正则表达式数值范围 1 - 1 百万

> ID：10153445
> 
> 赞同：0
> 
> 时间：2012-04-14T12:02:14.807
> 
> 标签：regex

我正在寻找用于货币目的的表达式范围。它需要为 1 - 1 百万，并允许逗号和句点。对于正确的格式，我不需要 (, 和 .) 的最小值/最大值，但我希望一段时间后的数字对于实际的美分值来说是 2 的最小值/最大值。谢谢

范围内：640 或 5,000.35 或 999,000

不在范围内：01 或 1,000,000.01 或 333,567.678

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:12:56.107

这应该这样做：

```
^(1(\.\d{2})?|[1-9]\d{0,2}(,?\d{3})?(\.\d{2})?)|1((,000){0,2}|(000){0,2})(\.00)?$ 
```

但是，如果您首先对值进行规范化（例如，删除除数字和 之外的任何字符`.`）然后解析它，它可能会更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T12:20:34.907

我的建议是：

*   使用类似的东西来验证输入是否具有特定格式：

    （这是一个演示 - [http://regexr.com?30l28](http://regexr.com?30l28)）

    `(1[\.,])?([0-9]{1,3}[\.,])?([0-9]{1,3})([\.,][0-9]{1,2})`

*   然后测试值范围：

    是`value<1.000.000`？

* * *

我的正则表达式绝不是 100% 完成的，但它确实验证了您的通用数字格式。

# javascript - 捕获 jQuery 表单提交事件

> ID：10153446
> 
> 赞同：2
> 
> 时间：2012-04-14T12:02:20.047
> 
> 标签：javascript, jquery, form-submit, jquery-events

我不知道这有什么问题，因为我在每一步都遵循 jquery.com 关于表单提交事件的教程。

我的Javascript：

[办公室。包括最新的 jQuery 库]。

```
<script type="text/javascript">
$("form#addFav").submit(function(event) { event.preventDefault(); alert("hello"); });
</script> 
```

还尝试了该`$(document).ready()`事件：

```
$(document).ready(function(){
$("form#addFav").submit(function(event) { event.preventDefault(); alert("hello"); });
}); 
```

这是我的 HTML 表单代码：

```
<form action="" id="addFav">
     <input type="text" name="name" class="thin-d"/>
     <input type="submit" value="Send"/>
</form> 
```

所以，关于上面的 Javascript 代码，它应该可以工作（我的意思是它应该阻止默认操作 [提交表单] 然后发送警报），但这一切都不起作用 - 尝试了数千种组合，但我失败了'd。所以我在等你的解决方案。我会很感激每一个人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T12:05:19.370

您可能在其他地方有一些语法错误或类似的东西，因为[您所拥有的只是工作](http://jsfiddle.net/PeeHaa/MaEQU/)。

你确定没有任何JS错误吗？

PS 在尝试附加事件之前，我总是会选择后一个代码以确保元素位于 DOM 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-14T10:17:38.383

对于遇到相同问题并且仍在努力解决此问题的其他人，请尝试查看您是否**非法重用了 id**，并尝试将表单 id 更改为**unique**。

我不小心将 id 赋予了两个不同的 DOM 元素，并且事件被绑定到具有各自 id 的第一个元素，而我的表单是第二个元素，因此它从未被捕获。这让我长时间安静下来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-22T14:21:10.073

我最近遇到了同样的问题。提交时的 Jquery 不适用于表单，但只需将其更改为单击事件即可。还是不知道为什么`.on(submit)`或`.submit()`事件会认不出表格。

```
$("form#addFav").click(function (event) {
    event.preventDefault(); alert("hello");
    $(this).submit();
});
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-12T02:37:04.940

这个问题很老，但是..您可能在触发之前触发了另一个提交事件。如果这些其他事件包含“return false”；声明然后事件执行被中断并且您的代码从未触发。要将代码放在这些事件之前，您可以使用 ONSUBMIT 表单属性，您可以在其中放置将在其他事件之前或同时触发的代码。

# c# - C# 正则表达式使用其内容替换文本

> ID：10153447
> 
> 赞同：0
> 
> 时间：2012-04-14T12:02:32.687
> 
> 标签：c#, regex

我有文字

```
<column caption='TZ_Shift' datatype='real' name='[total_millis Parameter]' 
param-domain-type='any' role='measure' type='quantitative' 
value='-0.16666666699999999'> 
```

这也可以像

```
<column caption='TZ_Shift' value='-0.16666666699999999'> 
```

这会重复几次，我想更换`value`它的一部分。

所以我希望结果是这样的

```
<column caption='TZ_Shift' datatype='real' name='[total_millis Parameter]' 
param-domain-type='any' role='measure' type='quantitative' 
value='-0.73783'> 
```

和

```
<column caption='TZ_Shift' value='-0.73783'> 
```

分别其中 0.73783 是新的 val

我提到了这个问题[c# regex to find and replace reusing part of the match text](https://stackoverflow.com/questions/806072/c-sharp-regex-to-find-and-replace-reusing-part-of-the-matched-text)

但我无法理解解决方案的正则表达式

有人可以用正则表达式帮助我吗？

Xml 解析应该是最好的解决方案，但我无法使用 xml 解析（出于某种原因）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T12:53:58.040

如果您只想更改每个`value`属性的内容，那么我只需使用
`(<column[^>]* value=')([^']+)('[^>]*>)`as 模式并将其替换为`$1-0.73783$3`.

在 C# 中，这可以按如下方式完成：

```
Regex re = new Regex("(<column[^>]* value=')([^']+)('[^>]*>)");  
string input = @"<column caption='TZ_Shift' value='-0.16666666699999999'>";
string output = re.Replace(input, "$1-0.73783$3"); 
```

（编辑：扩展正则表达式以仅匹配`<column>`元素）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T02:02:43.527

您不会说输入值是否始终相同（即，如果始终为-0.16666666699999999）。如果它总是相同，那么你甚至不需要正则表达式。

```
s = s.Replace("-0.16666666699999999", "-0.73783"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T12:35:03.010

尝试匹配类似的东西 `(<column((\s+[\-A-Za-z0-9]+=('[^']*')|("[^"]*"))*)\s+value=)(('[^']*')|("[^"]*"))((\s+[\-A-Za-z0-9]+=('[^']*')|("[^"]*"))*\s*>)`并替换为`$1'-0.73783'$9`

如果他们愿意，其他人可以清理它，如果您确定 stuff 属性顺序并且您的所有属性值都包含在 ' 而不是 " 或可能的混合中，您可以简化它。您可能必须进一步复杂化它以指定表达式中的列名。

# javascript - JavaScript：如何添加属性？

> ID：10153449
> 
> 赞同：0
> 
> 时间：2012-04-14T12:02:48.053
> 
> 标签：javascript

I'm trying to add the target attribute to some anchors when a radio button is checked; 但是它不起作用。

这是我的代码：

```
<body>
<ul id="main">
    <li><a href="https://www.google.co.uk/">Google</a></li>
    <li><a href="http://www.youtube.com/">YouTube</a></li>
    <li><a href="https://twitter.com/">Twitter</a></li>
</ul>
<input type="radio" name="input" id="input" />
<script type="text/javascript">
document.getElementById('input').checked = function changeTarget() {
    document.anchors.setAttribute('target', '_blank');
}
</script>
</body> 
```

我究竟做错了什么？（注意：我不想要 JQuery 解决方案）

谢谢。

编辑：呸。感谢所有答案，这是我的最终代码：

```
 document.getElementById('input').onclick = function changeTarget() {
    if(this.checked) {
        var b = document.getElementsByTagName('a');
        for (a = 0; a < b.length; a++) {
            b[a].target = '_blank';
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T12:08:00.687

您正在将单选按钮的“选中”属性设置为一个函数。“checked”属性是一个**布尔值**，指示当前是否选中了单选按钮。因此，该语句具有将其设置为 的效果`true`。您可能打算让它成为一个事件处理程序，因此它可能应该是“onclick”而不是“checked”。

设置标签的“目标”属性`<a>`不能这样完成。您必须使用`document.getElementsByTagName()`然后遍历返回的节点列表，设置每个节点的“目标”属性。无需使用`.setAttribute()`；只需直接在 DOM 节点上设置属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T12:08:23.197

`document.anchors`是一个集合，因此您需要对其进行迭代。您还需要该`onclick`事件 - 在那里您可以确定是否检查输入。

```
document.getElementById('input').onclick = function changeTarget() {
    if( this.checked ) {
        var anchors = document.getElementsByTagName("a");
        for(var i = anchors.length - 1; i>=0; i--) {
            anchors[i].target = '_blank';
        }
    }
} 
```

根据 MDN -`document.anchors`仅返回具有名称属性的锚点 - gEBTN 将返回所有锚点。

或者：

```
document.getElementById('input').addEventListener("click", changeTarget, false); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T12:35:45.787

使用您编辑的代码，您每次`_blank`单击单选按钮时都将目标设置为。在这种情况下， -collection`anchors`也不适合使用。

```
document.getElementById('input').onclick = function changeTarget() {
    var n,a=document.links.length;
    if(document.getElementById('input').checked){
        for(n=0;n<a;n++){
            document.links[n].target='_blank';
        }   
    }
} 
```

`document.links`是一个集合对象，包含`A`文档中具有`href`或- 属性的 -`nohref`元素。集合对象与数组非常相似，您可以使用索引 ( `n`) 来引用它的成员。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T12:11:38.180

据我所知，`checked`是一个属性，所以你不能给它分配一个函数。您可以附加点击事件`#input`以更改锚点`target`：

```
document.getElementById('input').onclick = function()
{
    var anchors = document.getElementsByTagName('a');
    if(this.checked)
        for(var i = 0, s = anchors.length; i < s; i++) {
          anchors[i].target = '_blank';
        }
    else
        for(var i = 0, s = anchors.length; i < s; i++) {
          anchors[i].target = '_self';
        }
} 
```

更新：在我的代码中#input 必须是一个复选框

```
<input type="checkbox" id="input" /> 
```

# c++ - 不同类型的 C++ 模板运算符重载

> ID：10153450
> 
> 赞同：2
> 
> 时间：2012-04-14T12:03:07.313
> 
> 标签：c++, templates, types, overloading, operator-keyword

下面的示例定义了一个基本的 podtype 容器类。然后使用此类创建一系列 typedef，它们代表基本 podtype 的 OOP 版本。当我们开始将这些类型相互分配时，问题就出现了。

我尝试将运算符定义为使用普通 PodObjects 作为类型的 lhs 和 rhs 参数的朋友方法，但没有任何成功。有没有人可能经历过类似的事情或知道这个问题的其他解决方案。

提前致谢。

```
#include <stdint.h>

template <typename T>
class PodObject {
protected:
    T _value;

public:
    PodObject<T>(int rhs) {
        this->_value = static_cast<T>(rhs);
    }   

    PodObject<T> operator+= (PodObject<T> const &rhs){
        this->_value = rhs._value;
        return *this;
    }   
};  

typedef PodObject<int8_t> Int8;
typedef PodObject<int16_t> Int16;

int main() {
    Int16 a = 10; 
    Int8 b = 15; 

    a += b; // Source of problem
    return 0;
} 
```

结果编译器输出：

```
example.cpp:26:11: error: no viable overloaded '+='
        a += b;
        ~ ^  ~
example.cpp:13:22: note: candidate function not viable: no known conversion from 'Int8' (aka 'PodObject<int8_t>') to 'const PodObject<short>'
      for 1st argument
        PodObject<T> operator+= (PodObject<T> const &rhs){ 
```

* * *

编辑：

下面的朋友方法为我完成了这项工作：

```
template<typename U, typename W>
friend PodObject<U> operator+= (PodObject<U> &lhs, PodObject<W> const &rhs) {
    lhs._value += rhs._value;
    return lhs;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T12:06:02.777

您需要一个模板`operator +`，因为您正在尝试添加*不同的*类型：

```
template <typename U>
PodObject<T> operator+= (PodObject<U> const &rhs){
    this->_value = rhs._value;
    return *this;
} 
```

也就是说，整个代码看起来像一个反模式。您的“基本 podtype 的 OOP 版本”不是一个有意义的概念，也不是一般有用的概念。

# search - 如何使 wcm 7 的内容可搜索

> ID：10153452
> 
> 赞同：0
> 
> 时间：2012-04-14T12:03:32.740
> 
> 标签：search, websphere, wcm

我基本上是想让 WCM 7 的内容*可搜索*。也就是说，搜索将在 WCM 7 的数据上完成。

但我被困住了，我该如何继续？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T09:29:33.853

使用以下链接：

[http://infolib.lotus.com/resources/portal/7.0.0/doc/en_us/pt700abd004/html-wrapper-wcm.html#wcm_dev_search](http://infolib.lotus.com/resources/portal/7.0.0/doc/en_us/pt700abd004/html-wrapper-wcm.html#wcm_dev_search)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T04:28:45.753

我的一个项目使用 Omnifind 在 WCM 中搜索内容，它比内置搜索功能更强大。

# c# - 在线程中使用委托时出现 invalidOperationException

> ID：10153455
> 
> 赞同：0
> 
> 时间：2012-04-14T12:03:56.780
> 
> 标签：c#, multithreading, delegates, invalidoperationexception

我将程序分为 3 层；GUI、BL、IO 并试图将文件从我的服务器抓取到我的电脑。我把它做成了多线程并且 zorks 很好，但是当我尝试向它添加一个委托以将消息从我的 IO 发送到我的 GUI 时，它困扰着我。它说的是：

> 不允许通过各种线程执行操作：它来自另一个线程，它比创建元素的线程有权访问控制标签下载进度。

我所拥有的是：

图形用户界面

```
private void buttonDownload_Click(object sender, EventArgs e)
{
    download = new BL_DataTransfer(Wat.FILM, titel, this.downloadDel);
    t = new Thread(new ThreadStart(download.DownLoadFiles));    
    t.Start();
}
private void UpdateDownloadLabel(string File)
{
        labelDownloadProgress.Text = "Downloading: " + File;
} 
```

提单

```
 public void DownLoadFiles()
    {
        //bestanden zoeken op server
        string map = BASEDIR + this.wat.ToString() + @"\" + this.titel + @"\";
        string[] files = IO_DataTransfer.GrapFiles(map);

        //pad omvormen
        string[] downloadFiles = this.VeranderNaarDownLoadPad(files,this.titel);
        IO_DataTransfer.DownloadFiles(@".\" + this.titel + @"\", files, downloadFiles, this.obserdelegate);
    } 
```

IO

```
 public static void DownloadFiles(string map, string[] bestanden, string[] uploadPlaats, ObserverDelegate observerDelegete)
    {
        try
        {
            Directory.CreateDirectory(map);

            for (int i = 0; i < bestanden.Count(); i++)
            {
                observerDelegete(bestanden[i]);
                File.Copy(bestanden[i], uploadPlaats[i]);
            }
        }
        catch (UnauthorizedAccessException uoe) { }
        catch (FileNotFoundException fnfe) { }
        catch (Exception e) { }        
    } 
```

德尔盖特

```
 public delegate void ObserverDelegate(string fileName); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:10:47.073

假设这是失败的标签更新，您需要将事件编组到 UI 线程。为此，请将您的更新代码更改为：

```
private void UpdateDownloadLabel(string File)
{
    if (labelDownloadProgress.InvokeRequired)
    {
        labelDownloadProgress.Invoke(new Action(() =>
            {
                labelDownloadProgress.Text = "Downloading: " + File;
            });
    }
    else
    {
        labelDownloadProgress.Text = "Downloading: " + File;
    }
} 
```

我最终为此创建了一个我可以调用的扩展方法 - 从而减少了我的应用程序中重复代码的数量：

```
public static void InvokeIfRequired(this Control control, Action action)
{
    if (control.InvokeRequired)
    {
        control.Invoke(action);
    }
    else
    {
        action();
    }
} 
```

然后这样调用：

```
private void UpdateDownloadLabel(string File)
{
    this.labelDownloadProgress.InvokeIfRequired(() =>
       labelDownloadProgress.Text = "Downloading: " + File);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T12:09:30.873

如果`UpdateDownloadLabel`函数在某个控制代码文件中，请使用如下模式：

```
private void UpdateDownloadLabel(string File)
{
     this.Invoke(new Action(()=> {
             labelDownloadProgress.Text = "Downloading: " + File;
      })));
} 
```

您需要在 UI 线程上调用分配，以便能够更改标签上的某些内容。

# javascript - 输入类型按钮以获取对象在左、中和右位置

> ID：10153456
> 
> 赞同：0
> 
> 时间：2012-04-14T12:03:56.930
> 
> 标签：javascript, dom, svg

我在上一个问题中确实对这个问题有帮助，但现在我想使用 svg 而不是 css 我有以下代码[http://jsfiddle.net/Len1/wzNjm/3/](http://jsfiddle.net/Len1/wzNjm/3/)但形状不会向右，中间并在按下相应的按钮时离开，有人可以帮我吗

我的意思的例子

左键按下形状转到屏幕左侧

右键按下形状转到屏幕右侧

中间按钮按下形状转到屏幕中间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T12:48:08.207

我已经用[一个可行的解决方案](http://jsfiddle.net/bclennox/wzNjm/4/)更新了你的小提琴。一些提示：

1.  将你的 CSS 移动到一个`<style>`元素中，而不是内联编写它。这样可以避免拼写错误`<div style="min-height:450px"; style="min-width:600px">`（两个单独的样式属性和错误的逗号）。
2.  用于`margin: 0 auto;`居中块级元素。
3.  您的`<rect>`元素的宽度与其包含`<svg>`元素的宽度不同，因此它的行为很奇怪。

我还为主要的`<div>`红色着色，以便更容易看到发生了什么。

# .net - 一起引用多个列表中的元素

> ID：10153458
> 
> 赞同：0
> 
> 时间：2012-04-14T12:04:05.460
> 
> 标签：.net, vb.net, list, inheritance, combinatorics

对于我的第一篇文章，我有一个棘手的问题。

我已经完成了教程，但还不足以加入开源社区。

感谢这个[问题](https://stackoverflow.com/questions/208807/how-can-a-beginner-escape-tutorial-land-and-actually-get-programming)，我正在尝试创建一个跟踪炼金术游戏中使用的组合的程序（通常在手机等上）

我有以下课程

*   类 Game 包含元素和组合的属性
*   类元素继承列表（元素的）
*   类组合继承列表(Of Combination)
*   类元素
*   班级组合

组合包含元素 1 和元素 2 以及结果的 List(Of Element)

### 我的问题：

使用 Game.Elements 如何为该元素的组合添加只读属性。IE

假设元素有

*   火
*   地球
*   水
*   空气
*   活力

和组合有

*   火+土=能量
*   地球 + 空气 = 泥浆

我想

Game.Elements("Energy").Combinations 返回包含 1 个匹配项的组合。

*   火+土=能量

到目前为止，我似乎无法通过 Game 类访问组合

我非常愿意接受任何建议或意见

到目前为止我的完整代码是

```
Option Explicit On

'TODO: Add classes for Combinations
'TODO: Edit Elements class for Various filters (Filter by Category, Generation etc)

Public Class Game

    Private pElements As Elements
    Private pOptions As Options

    Public Property Options() As Options
        Get
            Return pOptions
        End Get
        Set(ByVal value As Options)
            pOptions = value
        End Set
    End Property

    Public Property Elements() As Elements
        Get
            Return pElements
        End Get
        Set(ByVal value As Elements)
            pElements = value
        End Set
    End Property

    Public Sub New()
        Me.Elements = New Elements()
        Me.Options = New Options()
    End Sub

    Public Sub New(ByVal TotalElements As Long, _
                   Optional ByVal TotalCategories As Long = 1, _
                   Optional ByVal Categories As Boolean = False, _
                   Optional ByVal Terminated As Boolean = False, _
                   Optional ByVal SelfCombination As Boolean = True, _
                   Optional ByVal ReverseCombination As Boolean = False)
        Me.Elements = New Elements()
        Me.Options = New Options(TotalElements, _
                                 TotalCategories, _
                                 Categories, _
                                 Terminated, _
                                 SelfCombination, _
                                 ReverseCombination)
    End Sub

End Class

#Region "Combinations"

Public Class Combinations
    Inherits List(Of Combination)
    Implements IEnumerable(Of Combination)

End Class

Public Class Combination

    Private pElements As List(Of Element)
    Private pResult As List(Of Element)

    Public Property Elements() As List(Of Element)
        Get
            Return pElements
        End Get
        Set(ByVal value As List(Of Element))
            pElements = value
        End Set
    End Property

    Public Property Result() As List(Of Element)
        Get
            Return pResult
        End Get
        Set(ByVal value As List(Of Element))
            pResult = value
        End Set
    End Property

End Class

#End Region

#Region "Elements"

Public Class Elements
    Inherits List(Of Element)
    Implements System.Collections.Generic.IComparer(Of Element)
    Implements IEnumerable(Of Element)

    Public Function Compare(ByVal e1 As Element, ByVal e2 As Element) As Integer Implements IComparer(Of Element).Compare
#If CONFIG = "Debug" Then
        Debug.WriteLine("{0} - {1}", e1.Name, e2.Name)
#End If
        Select Case e1.Generation
            Case Is = e2.Generation
                Select Case e1.Category.Name
                    Case Is = e2.Category.Name
                        Select Case e1.Name
                            Case Is = e2.Name
                                Return 0
                            Case Is > e2.Name
                                Return 1
                            Case Else '< e2.Name
                                Return -1
                        End Select
                    Case Is > e2.Category.Name
                        Return 1
                    Case Else '< e2.Category
                        Return -1
                End Select
            Case Is > e2.Generation
                Return 1
            Case Else '< e2.Generation
                Return -1
        End Select
    End Function

    Default Public Overloads ReadOnly Property Item(ByVal Name As String) As Element
        Get
            Return Me.Where(Function(k As Element) k.Name = Name).ElementAt(0)
        End Get
    End Property

End Class

Public Class Element
    Implements System.IComparable(Of Element)

    Public Name As String
    Public Category As Category
    Public Generation As Integer
    Public Terminal As Boolean

    Public Sub New()
        With Me
            .Name = "Blank"
            .Category = New Category()
            .Generation = 0
            .Terminal = False
        End With
    End Sub

    Public Sub New(ByVal Name As String, Optional ByVal Category As String = "N/A", Optional ByVal Generation As Long = 0, Optional ByVal Terminal As Boolean = False)
        With Me
            .Name = Name
            .Category = New Category(Category)
            .Generation = Generation
            .Terminal = Terminal
        End With
    End Sub

    Public Shared Operator =(ByVal e1 As Element, ByVal e2 As Element) As Boolean
        Return (e1.Category.Name = e2.Category.Name And _
               e1.Name = e2.Name And _
               e1.Generation = e2.Generation And _
               e1.Terminal = e2.Terminal)
    End Operator
    Public Shared Operator <>(ByVal e1 As Element, ByVal e2 As Element) As Boolean
        Return Not e1 = e2
    End Operator
    Public Shared Operator >(ByVal e1 As Element, ByVal e2 As Element) As Boolean
        'Generation
        'Category
        'Name
        Select Case e1.Generation
            Case Is = e2.Generation
                Select Case e1.Category.Name
                    Case Is = e2.Category.Name
                        Select Case e1.Name
                            Case Is = e2.Name
                                Return False
                            Case Is > e2.Name
                                Return True
                            Case Else '< e2.Name
                                Return False
                        End Select
                    Case Is > e2.Category.Name
                        Return True
                    Case Else '< e2.Category
                        Return False
                End Select
            Case Is > e2.Generation
                Return True
            Case Else '< e2.Generation
                Return False
        End Select
    End Operator
    Public Shared Operator <(ByVal e1 As Element, ByVal e2 As Element) As Boolean
        Return Not (e1 >= e2)
    End Operator
    Public Shared Operator >=(ByVal e1 As Element, ByVal e2 As Element) As Boolean
        Return (e1 = e2 OrElse e1 > e2)
    End Operator
    Public Shared Operator <=(ByVal e1 As Element, ByVal e2 As Element) As Boolean
        Return (e1 = e2 OrElse e1 < e2)
    End Operator

    Public Function CompareTo(ByVal e1 As Element) As Integer Implements IComparable(Of Element).CompareTo
        Select Case Me.Generation
            Case Is = e1.Generation
                Select Case Me.Category.Name
                    Case Is = e1.Category.Name
                        Select Case Me.Name
                            Case Is = e1.Name
                                Return 0
                            Case Is > e1.Name
                                Return 1
                            Case Else '< e2.Name
                                Return -1
                        End Select
                    Case Is > e1.Category.Name
                        Return 1
                    Case Else '< e2.Category
                        Return -1
                End Select
            Case Is > e1.Generation
                Return 1
            Case Else '< e2.Generation
                Return -1
        End Select
    End Function
    Public Overrides Function ToString() As String
        With Me
            Return .WL("{0} - {1} - {2} - {3}", .Name, .Category.Name, .Generation, Terminal)
        End With
    End Function
    Private Function WL(ByVal value As String, ByVal ParamArray args As String()) As String
        For i = LBound(args) To UBound(args)
            value = value.Replace("{" & i & "}", args(i))
        Next
        Return value
    End Function
End Class

Public Class ElementComparer
    Implements System.Collections.Generic.IComparer(Of Element)
    Public Function Compare(ByVal e1 As Element, ByVal e2 As Element) As Integer Implements IComparer(Of Alchemy.Element).Compare

        Select Case e1.Generation
            Case Is = e2.Generation
                Select Case e1.Category.Name
                    Case Is = e2.Category.Name
                        Select Case e1.Name
                            Case Is = e2.Name
                                Return 0
                            Case Is > e2.Name
                                Return 1
                            Case Else '< e2.Name
                                Return -1
                        End Select
                    Case Is > e2.Category.Name
                        Return 1
                    Case Else '< e2.Category
                        Return -1
                End Select
            Case Is > e2.Generation
                Return 1
            Case Else '< e2.Generation
                Return -1
        End Select
    End Function
End Class

#End Region

Public Class Options

#Region "Properties"
    Private pAllowCategories As Boolean
    Private pAllowTerminatedElements As Boolean
    Private pAllowSelfCombination As Boolean
    Private pAllowReverseCombination As Boolean
    Private pTotalElements As Long
    Private pTotalCategories As Long
#End Region

#Region "Property Set"
    Public Property AllowCategories() As Boolean
        Get
            Return pAllowCategories
        End Get
        Set(ByVal value As Boolean)
            pAllowCategories = value
        End Set
    End Property
    Public Property AllowTerminatedElements() As Boolean
        Get
            Return pAllowTerminatedElements
        End Get
        Set(ByVal value As Boolean)
            pAllowTerminatedElements = value
        End Set
    End Property
    Public Property AllowSelfCombination() As Boolean
        Get
            Return pAllowSelfCombination
        End Get
        Set(ByVal value As Boolean)
            pAllowSelfCombination = value
        End Set
    End Property
    Public Property AllowReverseCombination() As Boolean
        Get
            Return pAllowReverseCombination
        End Get
        Set(ByVal value As Boolean)
            pAllowReverseCombination = value
        End Set
    End Property
    Public Property TotalElements() As Long
        Get
            Return pTotalElements
        End Get
        Set(ByVal value As Long)
            pTotalElements = value
        End Set
    End Property
    Public Property TotalCategories() As Long
        Get
            Return pTotalCategories
        End Get
        Set(ByVal value As Long)
            pTotalCategories = value
        End Set
    End Property
#End Region

#Region "Methods"
    Public Sub New(ByVal TotalElements As Long, _
                   Optional ByVal TotalCategories As Long = 1, _
                   Optional ByVal Categories As Boolean = False, _
                   Optional ByVal Terminated As Boolean = False, _
                   Optional ByVal SelfCombination As Boolean = True, _
                   Optional ByVal ReverseCombination As Boolean = False)
        With Me
            .TotalCategories = TotalCategories
            .TotalElements = TotalElements
            .AllowCategories = Categories
            .AllowTerminatedElements = Terminated
            .AllowSelfCombination = SelfCombination
            .AllowReverseCombination = ReverseCombination
        End With
    End Sub

    Public Sub New()
        With Me
            .TotalCategories = 1
            .TotalElements = 1
            .AllowCategories = False
            .AllowTerminatedElements = False
            .AllowSelfCombination = True
            .AllowReverseCombination = False
        End With
    End Sub

#End Region

End Class

Public Class Category

    Private pName As String
    Private pID As UInteger

    Public Property Name() As String
        Get
            Return pName
        End Get
        Set(ByVal value As String)
            pName = value
        End Set
    End Property

    Public Property ID() As UInteger
        Get
            Return pID
        End Get
        Set(ByVal value As UInteger)
            pID = value
        End Set
    End Property

    Public Sub New()
        Me.Name = "N/A"
        Me.ID = 0
    End Sub

    Public Sub New(ByVal Name As String, Optional ByVal ID As UInteger = 0)
        Me.Name = Name
        Me.ID = ID
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T11:33:52.287

我找到了解决方案。

```
Public Class cGame
    Public Elements as cElements
    Public Sub New()
        cElements.Parent = Me
    End Sub
End Class
Public Class cElements
    Protected Friend Shared Parent As cGame
End Class
Public Class cCombinations
    Protected Friend Shared Parent As cGame
End Class 
```

然后我引用它

```
MyGame.Elements.Parent 
```

然后可以分支到组合中，例如

```
MyGame.Elements.Parent.Combinations 
```

并且它将始终引用相同的数据。

:)

# html - 光标停留在文本框的左侧

> ID：10153460
> 
> 赞同：1
> 
> 时间：2012-04-14T12:04:22.640
> 
> 标签：html, css

我正在尝试调整从 Javascript 加载的小部件。我正在使用 jQuery 重新设置它的样式。

它有一个行为异常的文本框。光标停留在框的左侧，当用户键入时，文本向右流动。在文本中单击会使光标正常运行。

有谁知道可能是什么原因造成的？我试过改变“方向”属性，但没有帮助。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:05:06.170

我认为你的 CSS 有 text-align:right

尝试这个

```
 text-align:left !important 
```

# graphviz - 在 DOT 中的图形的一侧强制边

> ID：10153461
> 
> 赞同：0
> 
> 时间：2012-04-14T12:04:23.697
> 
> 标签：graphviz, dot

在下图中的 DOT

```
graph {
rankdir=LR;
ranksep="1.0";
    "v_1086" [label="A"];
    "v_1023" [label="B"];
    "v_1181" [label="C"];
    "q_-888017763" [label="Q"];
    "c_-961691100" [label="1"];
    "c_-1161934348" [label="2"];
    "c_556655049" [label="3"];
    "v_1023"--"c_-961691100"[label="1.0"];
    "v_1086"--"c_-1161934348"[label="1.0"];
    "v_1181"--"c_556655049"[label="0.9925742574257426"];
    "q_-888017763"--"v_1086" [color="green"];
    "q_-888017763"--"v_1181" [color="indigo"];
    "q_-888017763"--"v_1023" [color="khaki4"];
    "c_-1161934348"--"c_-961691100"[label="1.0"];
    "c_556655049"--"c_-1161934348"[label="0.10282888897110791"];
    "c_556655049"--"c_-961691100"[label="0.006661529339994344"];
    {rank = same;
        "v_1086";
        "v_1023";
        "v_1181";
    };
    {rank = same;
        "q_-888017763";
    };
    {rank = same;
    };
    {rank = same;
        "c_-961691100";
        "c_-1161934348";
        "c_556655049";
    };
} 
```

如何将数字节点之间的边缘向左移动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:56:38.083

问题中的点呈现为：

![图形](../Images/c38dd6cc3a72087e1263ff88a3eda290.png)

在那种情况下，我不明白这个问题：数字节点在右边，而不是左边，我不明白你为什么要移动它们之间的边缘。把它们移到哪里？

抱歉，这不是答案，但我无法在评论中嵌入图片。

# batch-file - 根据简单规则转换文件名

> ID：10153477
> 
> 赞同：0
> 
> 时间：2012-04-14T12:06:49.873
> 
> 标签：batch-file, batch-rename

我想批量修剪文件名，例如：从“This IsGood 1.1.png”到“tig11.png”

条件是脚本应该从文件名中获取所有大写字母，将它们转换为小写字母，然后形成修剪后的文件名，其中没有任何空格......

请我帮助完成这项任务..谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T17:24:04.387

您可以从文件名的简单迭代开始

```
set str=This IsGood 1.1
:again
set chr=%str:~0,1%
set str=%str:~1%
if not  "%chr%"=="" echo %chr% 
if not "%str%"=="" goto :again 
```

阅读`HELP SET`，`HELP IF`和`HELP GOTO`

现在，如果理解，请继续将`echo`命令更改为调用...

```
 if not  "%chr%"=="" call :checkchar %chr% 
 ...
 :checkchar 
 echo %1
 goto :eof 
```

读`HELP CALL`

然后实现用于检查字符是否为大写的实际代码

```
:checkchar 
for %%c in (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z 0 1 2 3 4 5 6 7 8 9) do if .%1==.%%c echo %%1
goto :eof 
```

读`HELP FOR`

现在将此新`echo`命令更改为对函数的新调用以将变量设置为小写

现在将结果连接到一个`fn`变量中，您需要将其初始化为空白。

并使用适当的文件名处理包装所有内容，仅提取文件名（请参阅处理参数语法中的 ~n 选项），然后用新名称组合回完整路径（使用 ~d ~p ~x 选项）

```
@echo off
set fn=
call :upcaseonly %~n1
echo %~dp1%fn%%~x1
goto :eof

:upcaseonly
set str=%*
:again
set chr=%str:~0,1%
set str=%str:~1%
if not  "%chr%"=="" call :checkchar %chr% 
if not "%str%"=="" goto :again
goto :eof

:checkchar
for %%c in (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z 0 1 2 3 4 5 6 7 8 9) do if .%1==.%%c set fn=%fn%%1
goto :eof 
```

以此为起点。您必须添加自己的逻辑来重命名文件并处理文件是否已存在或文件无法重命名...

# git - Git：简单的部署，我怎样才能避免'拉不可能，因为你有未合并的文件'

> ID：10153481
> 
> 赞同：0
> 
> 时间：2012-04-14T12:07:48.063
> 
> 标签：git, deployment

我拥有的是一个本地存储库和 2 个远程存储库（一个`bare`称为裸机，一个非裸机称为 dev）。

我想要实现的是一个简单的部署，这样当我推送到裸存储库时，开发存储库会提取更改。

我在裸存储库上使用了一个接收后挂钩，它只是做：-

```
cd (path-to-dev-repo)
unset GIT_DIR
git reset --hard HEAD # This is my failed attempt at stopping the merge conflicts
git pull origin master 
```

当我对本地存储库进行更改并将它们推送到裸露时，当开发人员尝试提取时，它会给我以下信息：-

```
CONFLICT (add/add): Merge conflict in application/01_sql_schema.sql 
```

但是，我所做的唯一文件更改是本地文件 - 我不明白为什么仅在一个地方更改更改时无法自动合并更改。

任何帮助深表感谢。

**编辑：替代可能的解决方案**

拥有 2 个裸存储库并将开发的存储库从挂钩中签出到所需的文件夹会更好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:47:52.697

为什么要为已部署的版本使用存储库？

只需使用`GIT_DIR=path/to/app git checkout -f`将文件从裸仓库签出到应用程序位置，即可避免此类问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T12:31:27.617

尝试存储更改，然后将其弹出：

```
cd (path-to-dev-repo)
unset GIT_DIR
git stash
git pull origin master
git stash pop 
```

# php - 使用 PHP 编写站点地图

> ID：10153483
> 
> 赞同：0
> 
> 时间：2012-04-14T12:08:08.440
> 
> 标签：php, sitemap

我有一个将我的站点地图内容分配给 php 变量的函数，我需要从[http://www.mysite.com/sitemap.xml](http://www.mysite.com/sitemap.xml)打开“sitemap.xml”文件并将内容替换为变量的内容，如何我可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:12:46.563

使用[`file_put_contents`](http://php.net/manual/en/function.file-put-contents.php).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T12:14:28.613

如果它是一个本地文件，你[可以简单地做](http://php.net/manual/en/function.file-put-contents.php)：

```
file_put_contents('/path/to/file' , $dataVar); 
```

这将用新内容替换内容。

> 该函数等同于依次调用 fopen()、fwrite() 和 fclose() 将数据写入文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T12:15:28.340

编写一个函数，该函数使用 php 变量并将其转换为 xml 使用`SimpleXMLElement`而不是保存内容 is using `$xml->asXML("sitemap.xml");`where `$xml`is the root element of your xml

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-07T04:37:44.287

你可以试试这个

```
file_put_contents('sitemap.xml' , $output); 
```

这里的sitemap.xml是一个输出文件，`$output`是xml动态内容的输出。

# java - java中数据库字典的最佳实践

> ID：10153485
> 
> 赞同：4
> 
> 时间：2012-04-14T12:08:38.803
> 
> 标签：java, dictionary, enums, persistence

是否有一种“规范”的方式来表示通过 java 持久性数据库维护的字典？

假设我有一张人桌，并且有一列“职业”。

专业范围有限，但可以扩展。有些职业对系统有一些特殊的含义，比如军队，或者医生。

1.  [我可以将枚举用于职业并将字符串（name() 方法）值存储在数据库中，如此处](https://stackoverflow.com/a/229919/1331274)所示。它简单易读。
2.  在数据库中，我可以有一个带有专业（id，name_of_profession）的字典表'profession'，以及具有来自表'profession'的外键（id_profession）的表'people'。枚举将有一个整数 id 值，该值映射到“专业”表中的 id 列。

第一个解决方案简短易行。但在这种情况下，没有应用程序的数据库就没有完整性。第二种“遗留”方式不合适吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T12:15:50.070

我想你已经确定了这两种方法的优缺点。这真的取决于您来决定哪个更好......对于您的特定应用程序。

或者换句话说，“最佳实践”取决于您的应用程序的实际需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T12:32:10.453

您可以使用两种方案的组合：

*   有一个`Professions`带有[单个主键](https://stackoverflow.com/q/517579/507519)的表，即职业名称。

*   在列中有一个`People`带有外键约束的表`profession`。

使用字符串作为主键/外键会影响更新性能，但它会使每一行都处于`People`自包含状态，这有利于检索操作。因此，除非基准另有说明，否则这种替代方案可能是可能的。

# git - 如何在 Github 和本地删除最后 n 次提交？

> ID：10153486
> 
> 赞同：187
> 
> 时间：2012-04-14T12:08:39.730
> 
> 标签：git, github, commit

我正在尝试从我的一个 GitHub 存储库中删除最后 2 个提交。我已经按照[这里](https://stackoverflow.com/questions/448919/how-can-i-remove-a-commit-on-github)的建议尝试过：`git push -f origin HEAD^^:master`。似乎它有效，因为最后两个提交已被删除。

然后我从我的本地存储库中删除了它们`git rebase -i HEAD~2`。我删除了与这些提交相关的行，并检查`git log`它们是否被正确删除。

之后，我在本地存储库中进行了一些更改，进行新的提交，然后推送到 GitHub。问题是，在我的 GitHub 帐户中，我有前两次尝试删除的提交。

我认为问题出在我的本地存储库中，因为如果我将 Github 存储库克隆到本地并在此处进行一些更改，当我推送新提交时，这些旧提交不会推送到 GitHub。

* * *

## 回答 #1

> 赞同：267
> 
> 时间：2012-04-14T12:14:51.967

要在本地删除最后两个提交，我建议使用：

```
git reset --hard HEAD^^ 
```

Rebase 是一个完全不同的操作，在这里对您没有帮助。

* * *

## 回答 #2

> 赞同：175
> 
> 时间：2016-08-03T13:13:20.500

如果您想删除 2（两次）最后一次提交，有一个简单的命令可以做到这一点：

```
git reset --hard HEAD~2 
```

您可以更改`2`要删除的任意数量的最后提交。

要将此更改推送到远程，您需要`git push`使用*force* ( `-f`) 参数：

```
git push -f 
```

但是，如果在要删除此提交**之后**远程（Github）上有**新的提交，****我不建议**执行任何`git`命令`-f`或涉及的选项。在这种情况下，请始终使用.`--hard`****`git revert`****

 ***** * *

## 回答 #3

> 赞同：49
> 
> 时间：2016-08-02T14:53:33.600

以下对我有用

```
git reset HEAD~n 
```

它`n`从本地 repo 中删除最后一次提交，因为`HEAD^`只删除一个。如果您需要从远程删除这些更改，您可能需要强制推送，因为您将落后于远程。

```
git push -f origin <branch> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2021-07-02T10:32:15.107

要删除最后 n 次提交：

```
git reset HEAD~n 
```

如果您需要从远程删除这些更改，您可能需要强制推送，因为您将落后于远程。

```
git push -f origin <Branch Name> 
```****

# javascript - HTML 5 - iOS 上的输入类型日期格式

> ID：10153492
> 
> 赞同：4
> 
> 时间：2012-04-14T12:09:17.347
> 
> 标签：javascript, html

我在 iPhone 上使用 HTML 5 表单。此表单具有如下输入元素：

```
<input id="birthdate" type="date" /> 
```

当用户单击此字段时，将出现 iOS 日期选择器。用户选择一个日期后，它会将日期放在显示为如下内容的字段中：2012 年 4 月 14 日。

我的问题是，有没有办法格式化这个日期，使它在文本框中看起来像 04-14-2012？或者，最好有一种直接的方法将 iOS 日期格式转换为 JavaScript Date 对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T12:18:41.870

我一直认为格式应该是`YYYY-MM-DD`.

[W3C 规范](http://dev.w3.org/html5/markup/input.date.html)和[RFC3339](http://dev.w3.org/html5/markup/references.html#refsRFC3339)。

无论如何，您可以使用 JavaScript 对其进行转换。

```
var dateInput = document.getElementById('birthdate');

dateInput.addEventListener('change', function() {
    dateInput.value = new Date(dateInput.value).toISOString().split('T')[0];
}, false); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T13:59:46.403

不。

有两种格式在起作用：

*   显示格式
*   暴露给 JavaScript 并发送到服务器的内部格式

您无法更改显示格式。由浏览器决定如何向用户显示日期（实际上它由系统的区域设置决定）。

您也不能更改内部格式。无论浏览器/语言环境如何，它*始终是ISO8601。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T19:14:43.447

我同意@PorneL 的回答，但是，您可以做一些工作来模拟您想要的结果。我会规定这不是最好的方法。

在伪代码中：

*   有两个输入，一个是日期类型，另一个是文本类型。
*   使日期输入不可见或在侧面 1px x 1px，并使输入的大小与您想要的日期相同
*   关注文本输入时，自动将焦点设置在相邻的日期输入上。
*   此时，用户将编辑日期输入字段
*   在更改日期字段时，获取值并使用您喜欢的任何格式将其插入到文本字段中。

同样，它可能不是最好的解决方案，但它可以以这种方式工作。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-06T16:40:44.310

以下应该做到这一点。

```
$dat = new DateTime($_POST['MyDATE']);
$new_format = $dat->format('Y-m-d'); 
```

# .net - 由于缺少 Microsoft.VC80.CRT v8.0.50727.6195 导致应用程序崩溃

> ID：10153496
> 
> 赞同：1
> 
> 时间：2012-04-14T12:10:12.107
> 
> 标签：.net, assemblies, side-by-side

我编写了一个 C# 应用程序来从火线相机中获取图像。我已经安装了相机供应商的 SDK，其中包括火线驱动程序和 SDK dll (.NET)。SDK dll 在安装过程中部署在 GAC 中。

我在应用程序中引用的 SDK dll 依赖于 Microsoft.VC80.CRT v8.0.50727.6195。我将清单文件和 dll msvcr80.dll、msvcm80.dll 和 msvcp80.dll 复制到与我的应用程序相同的文件夹中，我尝试运行我的应用程序，但 .NET 运行时仍然无法找到 VCRT dll，我的应用程序正在崩溃。

我收到以下异常：“无法加载文件或程序集‘CameraSDK.dll’或其依赖项之一。应用程序无法启动，因为它的并排配置不正确。请查看应用程序事件日志或使用命令行 sxstrace.exe 工具了解更多详细信息。（来自 HRESULT 的异常：0x800736B1）。

我搜索了一下，发现我需要安装 Microsoft Visual C++ 2005 Service Pack 1 才能获得 VCRT v8.0.50727.6195。我下载并尝试安装 VCRedist 但它没有安装 dll。我的机器有 VS2008 和 VS2010，我认为 VCRedist 安装程序在我的机器上找到了一个最新版本，它跳过了安装。

如何让我的应用程序在本地目录中查找依赖的 dll？任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T12:50:58.050

我有一个类似的问题，来自[http://www.microsoft.com/en-us/download/details.aspx?id=26347](http://www.microsoft.com/en-us/download/details.aspx?id=26347)的 vcredist_x64.EXE只是没有出现在我的已安装程序列表中，尽管没有错误消息在安装过程中。我尝试了 vcredist_x86.EXE 并且成功了。

# php - 如何使用 php 在 FTP 服务器上上传大文件？

> ID：10153502
> 
> 赞同：3
> 
> 时间：2012-04-14T12:11:12.003
> 
> 标签：php, file-upload, ftp

```
$ftp_server = 'ftp.abc.com';
$remote_file = "myvideo.avi";  // file size 210MB
$file = "myvideo.avi";        // file size 210MB
$conn_id = ftp_connect($ftp_server);  // set up basic connection

// login with username and password
$login_result = ftp_login($conn_id, 'faraz@abc.com', 'password');

ftp_pasv($conn_id, true); // turn passive mode on
// upload a file
if (ftp_put($conn_id, $remote_file, $file, FTP_ASCII)) {
     echo "successfully uploaded $file\n";
} else {
     echo "There was a problem while uploading $file\n";
}
    // close the connection
    ftp_close($conn_id);

i already edit php.in for
upload_max_filesize = 1024M 
```

上面的代码片段适用于所有类型的文件上传，
但是当我尝试上传大文件时，它会上传到服务器上，但上传后大小会有所不同。
本地机器上的视频文件大小为 210MB，
但上传后，它在 FTP 服务器上显示文件大小为 328KB。
我不知道我在哪里检查，如果有人有建议，那么我很感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T12:54:11.153

使用`FTP_BINARY`而不是`FTP_ASCII`. 后者可能会在第一个 NUL 字节处停止。

除此之外，现在没有充分的理由使用 ascii 模式，即使是 ascii 文件也是如此。如果您的cgi 脚本包含在本地具有 windows 换行符的 shebang 行，则**唯一重要的情况是。**

# c# - ServiceStack.Text json 反序列化创建错误的对象，而不是抛出无效的 json 输入字符串

> ID：10153503
> 
> 赞同：14
> 
> 时间：2012-04-14T12:11:22.570
> 
> 标签：c#, json, servicestack

当我尝试反序列化这个无效`}]`的 json 字符串时（最后丢失）：

```
[{"ExtId":"2","Name":"VIP sj�lland","Mobiles":["4533333333","4544444444"] 
```

通过做这个：

```
var result = JsonSerializer.DeserializeFromString<T>(str); 
```

ServiceStack json 反序列化器接受字符串，但它创建了一个错误的对象，因为我最终得到了一个具有以下值的 C# 对象：

```
ExtId : "2"                                      // ok fine.
Name: "VIP sj�lland"                            // ok fine
Mobiles: ["4533333333","4544444444", "544444444"]// Aarg! An array with 3 objects ?!? 
                                                 // There were only two in the JSON string. 
```

在这种情况下，最好抛出异常而不是继续处理错误数据。因此我尝试使用：

```
JsConfig.ThrowOnDeserializationError = true; 
```

就在调用 DeserializeFromString 但没有引发异常之前。一月份我问了这个问题[Configure ServiceStack.Text to throw on invalid JSON](https://stackoverflow.com/questions/8972556/configure-servicestack-text-to-throw-on-invalid-json)，答案是 ServiceStack 有利于弹性，我可以在 GitHub 中提出拉取请求。

现在还是这样吗？有没有人已经这样做了，省去了我的麻烦？否则，我的日程安排很紧，所以如果有人有一些代码或建议来说明如何创建选项标志以使 ServiceStack 引发反序列化错误，请在此处回复，以便我可以更快地完成这项工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-16T12:52:05.127

这在 ServiceStack.Text **v4+**中得到解决，默认情况下不会填充不完整的集合，例如：

```
public class Poco
{
    public string ExtId { get; set; }
    public string Name { get; set; }
    public string[] Mobiles { get; set; }
}

var json = "[{\"ExtId\":\"2\",\"Name\":\"VIP sj�lland\",\"Mobiles\":[\"4533333333\",\"4544444444\"]";

var dto = json.FromJson<Poco[]>();

Assert.That(dto[0].ExtId, Is.EqualTo("2"));
Assert.That(dto[0].Name, Is.EqualTo("VIP sj�lland"));
Assert.That(dto[0].Mobiles, Is.Null); 
```

或者如果首选可以抛出错误：

```
JsConfig.ThrowOnDeserializationError = true;

Assert.Throws<SerializationException>(() => 
    json.FromJson<Poco[]>()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-10T14:05:40.917

我试过这个，当我最后错过了 } 时抛出了异常。

在 C# 中，JSON 的格式是 {"name", "value"} 而不是 [{"name", "value"}]。

```
class M
        {
            public string ExtId { get; set; }
            public string Name { get; set; }
            public List<string> Mobiles { get; set; }
        }

string str = "{\"ExtId\":\"2\",\"Name\":\"VIP\",\"Mobiles\":[\"4533333333\",\"4544444444\"]";

M m = JsonConvert.DeserializeObject<M>(str); 
```

运行此程序时，您将收到错误，因为缺少 }。

使用：

```
string str = "{\"ExtId\":\"2\",\"Name\":\"VIP\",\"Mobiles\":[\"4533333333\",\"4544444444\"]}"; 
```

该对象已反序列化。

您可以从以下位置查看此对象的 JSON：

```
string s = JsonConvert.SerializeObject(m); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-16T09:30:06.970

C# 对 JSON 有点挑剔。以下将是**有效**的！注意我没有匿名对象数组作为默认元素。

```
{
    "ExtItem": [
        {
            "ExtId": "2",
            "Name": "VIPsj�lland",
            "Mobiles": [
                "4533333333",
                "4544444444"
            ]
        }
    ]
} 
```

如果我从中生成 POCO，我会得到

```
public class Rootobject
{
    public Extitem[] ExtItem { get; set; }
}

public class Extitem
{
    public string ExtId { get; set; }
    public string Name { get; set; }
    public string[] Mobiles { get; set; }
} 
```

我个人使用扩展方法来串

```
public static class Extensions
{
    public  static bool DeserializeJson<T>(this String str, out T item)
    {
        item = default(T);
        try
        {
            item = new JavaScriptSerializer().Deserialize<T>(str);
            return true;
        }
        catch (Exception ex)
        {
            return false;
        }
    }
} 
```

这将使我能够写：

```
Rootobject ext;
const string validJson = @"
{
    ""ExtItem"": [
        {
            ""ExtId"":""2"",
            ""Name"":""VIPsj�lland"",
            ""Mobiles"":[
                ""4533333333"",
                ""4544444444""
            ]
        }
    ]
}";
if (validJson.DeserializeJson(out ext))
{ //valid input 
    // following would print 2 elements : 4533333333, 4544444444
    Console.WriteLine(string.Join(", ", ext.ExtItem.First().Mobiles)); 
} //invalid input 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-09-16T10:04:39.327

我只是使用`Newtonsoft.Json` `T JsonConvert.DeserializeObject<T>(string value)`它，它会引发异常；

如果我使用`object JsonConvert.DeserializeObject(string value)`这个，它会通过简单地放置丢失的对象来创建正确的对象`}]`

我发现这是一个非常可靠和快速的库。

# forms - html5 x-webkit-speech 是否有“onFinishedSpeeking”选项？

> ID：10153509
> 
> 赞同：0
> 
> 时间：2012-04-14T12:12:15.470
> 
> 标签：forms, html, webkit

我正在创建一个使用 x-webkit-speech 的 html5 应用程序。

对于那些不熟悉 x-webkit-speech 的人，它被添加到像这样的常规输入中`<input type="text" x-webkit-speech />`，然后让用户能够使用他们的声音而不是键盘。

我想知道你说完后如何提交表格。谷歌在他们的主页上做，所以我知道这是可能的，我只是不知道怎么做。

谢谢，伊恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T16:34:07.650

查看 stoyan stefanov 的[这个 webkit 演示](http://www.phpied.com/files/speech-input/speech.html)，您正在寻找的事件是`onwebkitspeechchange`

# android - 单击布局 xml 文件时，eclipse 会关闭吗？

> ID：10153510
> 
> 赞同：0
> 
> 时间：2012-04-14T12:12:28.283
> 
> 标签：android, xml, eclipse

我在 Eclipse 中遇到了一个问题，每当我单击布局 xml 文件以自动打开时，Eclipse 就会关闭。我正在做 android 应用程序。为什么会发生这种情况。你的绝妙想法可以帮助我。

在此先感谢 Bamadeva。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T12:24:39.917

您是否尝试过使用 -clean 选项运行 eclipse

```
eclipse -clean 
```

您可能在使用 android 插件时遇到了问题，可能设计器崩溃了，可能再次安装插件可能会起作用...

# c++ - 如何包含来自另一个目录的 DLL

> ID：10153511
> 
> 赞同：2
> 
> 时间：2012-04-14T12:12:29.017
> 
> 标签：c++, c, winapi, dll

我制作了一个名为 dll 的 dll `test.dll`。我有相同的 .lib 文件和头文件。

我在程序 A 和程序 B 文件夹中粘贴了`.lib`文件和头文件，但我想要一个公共文件夹，我可以在其中粘贴我的. 文件`test.dll`，以便 A 和 B 都可以使用它。

我正在使用 VS 2008。语言是 C++

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T12:30:52.210

您需要将公共目录添加到您的 PATH，或者从同一目录（也将包含 DLL）启动 A 和 B。

有关详细信息/选项，请参阅此[MSDN 文章...](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682586%28v=vs.85%29.aspx)

- 更多的 -

默认情况下，系统将在以下位置查找...

1.  加载应用程序的目录。
2.  系统目录。
3.  16 位系统目录。
4.  Windows 目录。
5.  当前目录。
6.  PATH 环境变量中列出的目录。

您无法以编程方式更改它们，但您可以通过在运行程序之前将公共文件夹位置添加到 PATH 环境变量来获得所需的结果

# java - 如何在 Android 中获取“onTouchEnd”事件？

> ID：10153516
> 
> 赞同：0
> 
> 时间：2012-04-14T12:13:02.850
> 
> 标签：java, android, touch

一旦用户停止触摸 View 对象的屏幕，调用的事件的名称是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T12:16:03.837

onTouchEvent 以 ACTION_UP 类型触发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T12:15:49.237

您可以在此处查看所有可用事件：http: [//developer.android.com/reference/android/view/MotionEvent.html#ACTION_UP](http://developer.android.com/reference/android/view/MotionEvent.html#ACTION_UP)

适合您的是 ACTION_UP。

希望这可以帮助！

更新：

此外，当您在没有向上移动手指的情况下移出视图时，会调用 ACTION_CANCEL。所以你应该同时处理这两个问题。

# java - 访问 servlet 中的 jstl 变量

> ID：10153524
> 
> 赞同：1
> 
> 时间：2012-04-14T12:14:39.950
> 
> 标签：java, jsp, servlets, jstl

我通过在 jsp 中迭代客户列表来填充客户数据，如下所示。

```
<form action="CustomerUpdate" method="post">
<c:forEach var="listItems" items="${customers}">          
   <label> First Name: </label><c:out value="${listItems.fname}" />  
   <label> Last Name: </label><c:out value="${listItems.lname}" />
   <label> Address: </label><c:out value="${listItems.address}" /> &nbsp;
   <input type="submit" value="Edit" name="edit">
   <input type="submit" value="Delete" name="delete"><br />     
</c:forEach> 
</form> 
```

现在在操作中编辑或删除我想要跟踪需要编辑/删除的客户的每条记录。因此，在 servlet 中，我如何访问 var listItems 中的客户对象。如果不可能，我是否需要隐藏带有值的输入变量并使用 servlet 中的 getParameter 访问它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T12:43:43.067

这只是一个关于如何做的简单示例。以这种方式更改您的代码：

```
<c:forEach var="listItems" items="${customers}">          
  <form action="CustomerUpdate" method="post">
    <input type="hidden" value="${listItems.id}" name="id">
    <label> First Name: </label><c:out value="${listItems.fname}" />  
    <label> Last Name: </label><c:out value="${listItems.lname}" />
    <label> Address: </label><c:out value="${listItems.address}" /> &nbsp;
    <input type="submit" value="Edit" name="action">
    <input type="submit" value="Delete" name="action"><br />     
  </form>
</c:forEach> 
```

**更新**

为每一行创建一个表单元素，并为每一行放置一个带有`id`. 因此，当您按下该按钮时，您将在请求中收到一个值，使您能够检测到该行。这样：

```
String id = request.getParameter("id");
String action = request.getParameter("action"); 
```

现在您知道了`id`和`action`类型（编辑或删除）。

**替代解决方案**

不要使用表单和提交来调用您的操作，而是使用直接链接。

```
<c:forEach var="listItems" items="${customers}">          
  <input type="hidden" value="" name="id">
  <label> First Name: </label><c:out value="${listItems.fname}" />  
  <label> Last Name: </label><c:out value="${listItems.lname}" />
  <label> Address: </label><c:out value="${listItems.address}" /> &nbsp;
  <button onclick="window.location.href='CustomerUpdate?action=edit&id=${listItems.id}'">Edit</button>
  <button onclick="window.location.href='CustomerUpdate?action=delete&id=${listItems.id}'">Delete</button>
</c:forEach> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T16:39:09.360

在**servlet**中检查单击了哪个按钮：

```
if (request.getParameter("action") != null) //if action is not null
        {
            String action = request.getParameter("action");
String id = request.getParameter("id");

            if (action.equals("edit")) //edit button clicked
            {
               //do your work here
            }
            else if (action.equals("delete")) //delete button clicked
            {
                //your work here
            }
} 
```

# php - MySQL 和 PHP 上的表情符号：为什么有些符号是，有些不是？

> ID：10153529
> 
> 赞同：8
> 
> 时间：2012-04-14T12:15:09.510
> 
> 标签：php, mysql, emoji, utf8mb4

在阅读了关于 SO 的所有关于表情符号的主题后，我一定会寻求帮助。问题似乎几乎相同：我有一个 iPhone 应用程序通过 PHP 表情符号发送到 MySQL DB，我可以在记录上看到一些符号，例如“伞”和“云”，但其他不是（愤怒的脸、笑脸和其他）。

为什么有些是，有些不是？

*   MySQL 排序规则：utf8mb_unicode_ci
*   表排序：utf8mb_unicode_ci
*   字段、varchar、排序规则：utf8mb_unicode_ci

PHP设置：

```
 mysql_query("SET CHARACTER SET utf8mb4");
    mysql_query("SET NAMES utf8mb4"); 
```

记录中未显示的符号显示为问号“？”

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-02T15:54:43.627

一些表情符号使用 3 个字节编码。如果您的计算机支持表情符号，以下是 3 字节的表情符号：

☺❤✨❕❔✊✌✋☝☀☔☁⛄⚡☎➿✂⚽⚾⛳♠♥♣♦〽☕⛪⛺⛲⛵✈⛽⚠♨1⃣2⃣3⃣4⃣5⃣6⃣7⃣8⃣9⃣0⃣＃⃣◀▶▶▶⏪⏩♿ ㊙㊗✳✴♈♉♊♋♌♍♎♏♐♑♒♓⛎⭕❌©®™

其余的使用 4 个字节编码，除非您将 mysql 更新为 utf8mb4，否则将无法正常工作。听起来您没有以某种方式完全升级到 utf8mb4。

# c++ - 不同结构的静态大小数组

> ID：10153530
> 
> 赞同：2
> 
> 时间：2012-04-14T12:15:23.320
> 
> 标签：c++, struct, shared-memory

我有一个应用程序，它由多个使用共享内存共享公共数据的任务组成。到目前为止，共享内存中的数据如下所示：

```
struct Store = {
    int id;
    Array<Module, 5> modules;
}; 
```

其中`Module`定义为

```
struct Module = {
    uint32_t a;
    char b[64];
    Array<Component, 10> components;
}; 
```

该`Store`结构具有固定大小，可以在共享内存中轻松使用。

但是现在我必须支持其他模块，比如说`ModuleA`和`ModuleB`. 在*正常*的C++ 上下文中，我将这些建模为：

```
struct ModuleBase {
    // common informations
};
struct ModuleA : public ModuleBase {
    // ...
};
struct ModuleB : public ModuleBase {
    // ...
}; 
```

并替换`Module`为`Module*`.`Store`

但在**共享内存中**，这并不容易。访问共享内存中的数据很容易修复结构，这就是使用编译时数组的原因。我想将此属性与我的不同模块一起使用。

## 理念一

```
union Module {
    ModuleType type;
    ModuleA moduleA;
    ModuleB moduleB;
}; 
```

问题是我的`Module`类有构造函数，这在`union`. `type`使用然后`Module.moduleX` **修复**很容易访问：消除对构造函数的需要

## 想法 2

使用评估给定类的最大大小的模板，例如

```
const size_t max_module_size = MaxTMP<ModuleA, ModuleB>::value; 
```

这是我需要存储模块的缓冲区大小：

```
char ModuleBuffer[max_module_size]; 
```

（也许`ModuleBuffer`必须封装在结构中，以便与 一起使用`Array`）

访问很棘手，必须将 的内容`ModuleBuffer`投射到`ModuleBase`并根据`type`to `ModuleX`。那是因为我认为我需要一些`reinterpret_cast`. 而且我还需要以某种方式将“ModuleX”投射到`ModuleBuffer`.

# 问题

我不喜欢这两种想法，但我无法想象另一种方法来处理这个问题。您有任何意见或 - 甚至更好的 - 解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:59:28.583

实际上，您介于岩石和坚硬的地方之间。

我会尝试一下`boost::variant`，因为它附带的设施，否则重新创建类似的东西并不太难，但是它很长......

* * *

除了尺寸之外，您还需要注意对齐。在这里使用 C++11 会有所帮助，尽管可以在 C++03 中使用几个库/扩展来编写它。

请注意， a`union`并不是什么特别的东西，您可以轻松地以某种方式实现您自己的，并且喜欢`boost::variant`将其“标记”。

几个助手会很好地提供帮助：

```
/// Size and Alignment utilties
constexpr size_t max(size_t t) { return t; }

template <typename... U>
constexpr size_t max(size_t l, size_t r, U... tail) {
    return l > max(r, tail...) ? l : max(r, tail...);
}

template <typename... T>
struct size { static size_t const value = max(sizeof(T)...); };

template <typename... T>
struct alignment { static size_t const value = max(alignof(T)...); };

/// Position of a type in the list
template <typename...> struct position;

template <typename T>
struct position<T> {
    static size_t const value = 0;
};

template <typename T, typename Head, typename... Tail>
struct position<T, Head, Tail...> {
    static size_t const value =
        std::is_same<T, Head>::value ? 0 : 1 + position<T, Tail...>::value;
};

/// Type at a given position
template <size_t, typename...> struct at;

template <size_t N, typename T, typename... Tail>
struct at<N, T, Tail...> { typedef typename at<N-1, Tail..>::type type; };

template <typename T, typename... Tail>
struct at<0, T, Tail...> { typedef T type; }; 
```

现在真正的乐趣开始了：如何以类型安全的方式应用一个函数，该函数的类型可能在运行时发生变化 :x ？

```
/// Function application
template <typename...> struct Apply;

template <typename H, typename... Tail>
struct Apply<H, Tail...> {
    // Mutable
    template <typename Func>
    static void Do(Func& f, void* storage, size_t tag) {
         if (tag == 0) { f(*reinterpret_cast<H*>(storage)); }
         else { Apply<Tail...>::Do(f, storage, tag-1); }
    }
    template <typename Func>
    static void Do(Func const& f, void* storage, size_t tag) {
         if (tag == 0) { f(*reinterpret_cast<H*>(storage)); }
         else { Apply<Tail...>::Do(f, storage, tag-1); }
    }

    // Const
    template <typename Func>
    static void Do(Func& f, void const* storage, size_t tag) {
         if (tag == 0) { f(*reinterpret_cast<H const*>(storage)); }
         else { Apply<Tail...>::Do(f, storage, tag-1); }
    }
    template <typename Func>
    static void Do(Func const& f, void const* storage, size_t tag) {
         if (tag == 0) { f(*reinterpret_cast<H const*>(storage)); }
         else { Apply<Tail...>::Do(f, storage, tag-1); }
    }
}; // struct Apply

/// We need recursion to end quietly even though `tag` is a runtime argument
/// we place the precondition that `tag` should be a valid index in the type
/// list so this should never be reached.
template <>
struct Apply<> {
    template <typename... T>
    static void Do(T...&&) { abort(); }
}; // struct Apply 
```

现在我们可以使用它以类型安全的方式动态调度。

```
/// Variant itself
template <typename... List>
class Variant {
public:
    /// Constructor & co
    Variant() {
        typedef typename at<0, List...>::type First;
        new (&_storage) First();
    }

    Variant(Variant const& other) {
        this->initialize(other);
    }

    Variant& operator=(Variant const& other) {
        this->destroy();
        this->initialize(other);
        return *this;
    }

    ~Variant() { this->destroy(); }

    /// Conversions
    template <typename T>
    explicit Variant(T const& t) {
        _tag = position<T, List...>::value;
        new (&_storage) T(t);
    }

    template <typename T>
    Variant& operator=(T const& t) {
        _tag = position<T, List...>::value;
        this->destroy();
        new (&_storage) T(t);
        return *this;
    }

    /// Applying a func
    template <typename Func>
    void apply(Func& f) { Apply<List...>::Do(f, &_storage, _tag); }

    template <typename Func>
    void apply(Func& f) const { Apply<List...>::Do(f, &_storage, _tag); }

    template <typename Func>
    void apply(Func const& f) { Apply<List...>::Do(f, &_storage, _tag); }

    template <typename Func>
    void apply(Func const& f) const { Apply<List...>::Do(f, &_storage, _tag); }

private:
    void initialize(Variant const& v) {
        struct {
            template <typename T>
            void operator()(T& t) const { new (_storage) T(t); }
            void* _storage;
        } copier = { &_storage };

        v.apply(copier);
        _tag = v._tag;
    }

    void destroy() {
        struct {
            template <typename T>
            void operator()(T& t) const { t.~T(); }
        } eraser;

        this->apply(eraser);
    }

    std::aligned_storage<size<List...>::value,
                         alignment<List...>::value> _storage;
    size_t _tag;
}; // class Variant 
```

我说容易吗？

好吧，还有一个微妙的问题：`operator=`实现不是异常安全的。在您的情况下，这应该不是问题，因为您在这些类型中没有动态内存分配。

参考：

*   [`std::aligned_storage`](http://en.cppreference.com/w/cpp/types/aligned_storage)

# ruby-on-rails - 如何根据 sphinx 中的多个因素获得搜索排名？

> ID：10153532
> 
> 赞同：3
> 
> 时间：2012-04-14T12:15:38.260
> 
> 标签：ruby-on-rails, ruby, search-engine, sphinx

你好stackoverflow的人，

我们有一个不断增长的 Rails 项目，现在我们在搜索中遇到了第一个性能问题，因为我们不知道如何正确地利用 sphinx 来满足我们的需求。我们有像“Java PHP Software developer”这样的搜索查询。我们现在的问题是排名应该适用于多种情况。

作为搜索字段，我们有标签列表、描述和标题。如果其中一个术语在其中一个字段内，它应该得到例如 2 分。如果它在多个字段中，则为更多点，但如果它在同一字段中不止一次，则不是多个点。下一个问题是我有一个包含同义词的大文件，也应该检查它。它看起来像这样：

```
Java > Java
Java-EE > Java
... 
```

因此，如果发现 Java-EE，它也应该得到一些分数，但会因为成为同义词而受到惩罚。

最大点数将是 5，如显示的 5 颗星。任何快速的解决方案都会很好，因为目前它是用普通的 ruby​​ 完成的，而且速度很慢，因为我们无法在 sphinx 中正确排名。

如果有另一个搜索引擎的解决方案也很好，因为它可以改变。

提前感谢所有的努力。欢迎所有拼写更正和问题以清除问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T08:13:35.523

大多数性能问题都可以通过改变使用 sphinx 的方式来解决。首先，您需要解决如何索引 sphinx 中的数据。在索引期间进行一些处理将使搜索更快并且结果更相关。其次，处理搜索词，最后但并非最不重要的是，决定要使用的排名算法。

我将使用“标题”字段作为示例，但可以为所有字段复制逻辑。

**索引**

向 sphinx 添加两个字段（“title”和“title_synonyms”）。对于数据库中的每条记录，请执行以下操作：-

*   对单词执行 DISTINCT 以删除重复项（“Ruby Developer / Java Developer”将变为“Ruby Developer / Java”。这将阻止记录在搜索时获得两个重复分数。这进入“title”

*   从上面取 DISTINCT 标题并将所有单词替换为其扩展的同义词等效项。我建议将同义词放在数据库中以使扩展更容易。然后文本将变为“Ruby Developer / Java-EE”。每个单词都必须替换为所有同义词。如果 Java 有两个同义词，则它们都必须在该字段中。这进入“title_synonyms”

**搜索**

因为现在 sphinx 中有两个字段，我们可以给它们分别赋予不同的权重；“title”可以获得“10”的权重，“title_synonyms”可以获得“3”的权重。这意味着一条记录必须匹配 4 个同义词才能排名高于原始标题的一个。您可以根据自己的需要调整重量。

假设用户正在搜索“Java Developer”。对于搜索短语，请执行以下操作：-

*   删除重复的单词
*   获取搜索词组中每个单词的同义词
*   将 Sphinx 中的匹配模式设置为 SPH_MATCH_EXTENDED

上述规则将意味着 sphinx 中的搜索如下所示：-

@title "Java 开发者" | @title_synonyms "Java-EE"

如果您想对精确匹配进行排名高于词位，则搜索查询将如下所示：-

@title ("Java 开发者" | "=Java =开发者") | @title_synonyms ("Java-EE" | "=Java-EE")

您将需要使用 SPH_RANK_PROXIMITY_BM25 或 SPH_RANK_SPH04 才能使其正常工作。

**排行**

您可以尝试任何内置的排名算法，看看结果如何。我推荐 SPH_RANK_MATCHENY 或 SPH_RANK_WORDCOUNT 作为开始。

对于接近度和精确匹配排名，请使用 SPH_RANK_PROXIMITY_BM25、SPH_RANK_SPH04 或 SPH_RANK_EXPR，您可以在其中使用自己的算法。

**结论**

您现在应该有一个既快速又准确的搜索。Ruby 应用程序需要做的工作很少，大部分工作都在 sphinx 中完成（它应该在哪里）。

希望这可以帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T14:40:54.830

这个性能问题是一个算法问题。

如果您无法以使用后端工具（如 sphinx 或数据库引擎）的方式表达问题，那么您正在使用 ruby​​ 进行处理，这很容易出现性能问题。

首先，尽可能多地使用 sphinx（或任何其他搜索引擎）和数据库。进入 ruby​​ 的数据越预先消化，您在 ruby​​ 代码中要做的事情就越少，而且这可能会更快，因为在过去半个世纪中数据库已经高度优化。

因此，例如，在关键字上运行 sphinx。还要在同义词上运行 sphinx。将所有答案限制在排名靠前的结果，然后合并结果。这样，您的 ruby​​ 代码将仅限于可能的高结果，而不必考虑整个条目数据库。

一旦进入 ruby​​，最重要的是避免使用高阶算法，即确保您使用的是低阶算法。

在处理原始数据时，如果您将最重要的结果保存在一个数组中并尝试对数组进行排序或扫描，您将得到一个 N 平方顺序。也就是说，您的订单将是原始条目数和您保留在数组中的元素数的乘积。

解决您的问题的最佳算法是由类似堆的容器或 b 树实现的优先级队列。两者都有 N-log-N 顺序（N 乘以 N 的 log），或者原始数据记录的数量乘以您将保留在容器中的项目数量的 log。

堆是一棵二叉树，树中的每个节点（不仅是叶子，还有每个节点）都有一个评级记录。每条记录下方的节点都具有较低的等级。这称为堆条件。

有一些算法可以添加元素，取出排名最高的元素，并替换保持堆状态的最低排名元素。在维基百科中查找[二进制堆](http://en.wikipedia.org/wiki/Binary_heap)。

假设您的网站将显示排名前 100 的结果。维护根排名*最低*的帮助。通过添加您正在处理的前 100 条原始记录来填充堆。

现在对于记录 101 及之后的记录，将其排名与根进行比较。如果新记录的排名更高，请使用删除算法将堆减少到 99 个节点（这将删除堆中排名最低的记录）并将新记录添加到堆中。

浏览完所有记录后，您将获得排名前 100 的结果。堆删除算法将以相反的顺序将它们拉出。

# php - jquery输入验证+背景色

> ID：10153539
> 
> 赞同：0
> 
> 时间：2012-04-14T12:16:16.583
> 
> 标签：php, jquery, jquery-ui, validation

我有一个 HTML 表单，我想在其中添加一些验证逻辑。在那种形式中，我有两个输入字段，其中一个必须始终获取整数值，而另一个必须始终获取浮点值。（第一个是项目编号，另一个是总成本）。如果输入值错误（例如，作为项目编号的浮点值），我希望这些输入字段将背景颜色更改为浅红色，并且我只想关心它的逻辑，也许我可以猜到 jQuery 可以处理所有事情否则，但我在互联网上找不到任何关于如何在不重新发明轮子的情况下完成这项工作的帮助。有人对如何做到这一点有一些提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T12:20:03.457

您似乎在谈论表单验证

您可以在 javascript 或 jQuery 中编写您自己的代码......或 google 关于表单验证，您将获得大量结果......

对于入门，您可以查看此 jQuery 验证插件

```
http://jquery.bassistance.de/validate/demo/

http://docs.jquery.com/Plugins/Validation 
```

# jpa - jpa查询列上的算术运算

> ID：10153541
> 
> 赞同：0
> 
> 时间：2012-04-14T12:16:38.997
> 
> 标签：jpa

我对jpa有点陌生。我创建了一些简单的查询。但现在我遇到了一个简单查询的问题。我有一个包含 3 列（Id、Amount1、Amount2）的实体 Payment。现在我想从 Payment 中找到 Amount1+Amount2 大于 somevalue 的所有行。我尝试了类似的方法：

```
Query query = getEntityManager().createQuery(
  "Select p from Payment p WHERE p.Amount1 + p.Amount2 >' " + someamount +" ' "); 
```

但它不起作用。我也尝试使用 SUM ，但这只是一列。谁能帮我这个。谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-14T12:58:59.380

假设您的实体已正确定义，以下查询应该可以正常工作：

```
final BigDecimal threshold = BigDecimal.valueOf(1000);
TypedQuery<Payment> query = getEntityManager().createQuery(
      "SELECT p FROM Payment p WHERE p.Amount1 + p.Amount2> :value",
      Payment.class);
query.setParameter("value", threshold);
List<Payment> results = query.getResultList(); 
```

# android - 将声音添加到 android 系统声音列表

> ID：10153546
> 
> 赞同：0
> 
> 时间：2012-04-14T12:18:05.903
> 
> 标签：android, audio, notifications

我正在寻找如何将我自己的通知声音添加到 android 设备的解决方案。声音应该在 RightoneManager 显示的列表中可见。我的应用程序的上下文是用户可以为某些操作选择一些通知声音，我想将默认声音设置为我自己的声音。我正在使用[此](https://stackoverflow.com/questions/2724871/how-to-bring-up-list-of-available-notification-sounds-on-android)代码调用 RightToneManager。我搜索了一段时间的解决方案，但不幸的是我没有找到任何相关的东西。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T22:03:12.077

在 SD 卡的根目录中，创建一个名为“Notifications”的文件夹。将您的自定义通知声音（我的以 .m4a 编码，不确定支持哪种格式）放在此文件夹中，它应该出现在系统范围的通知声音选择器中。

您可以使用 java.io.File 对象以编程方式创建“通知”目录（如果它尚不存在）并将您的声音复制到此目录中

如果你想添加自己的铃声，你可以做同样的事情，但是这一次，你必须创建一个“铃声”文件夹。

编辑：看起来目录位置可能因Android版本而异。您应该考虑为您的自定义声音使用以下位置：/sdcard/system/media/audio/notifications

# android - 如何让 Android 2.2 模拟器显示不同的语言字体，例如印地语/马拉地语？

> ID：10153547
> 
> 赞同：1
> 
> 时间：2012-04-14T12:18:14.320
> 
> 标签：android, fonts, android-emulator, android-2.2-froyo, hindi

当我在 Android 模拟器上运行我的应用程序时，我打算显示马拉地语/印地语。你能建议如何做到这一点吗？

我在互联网上搜索并找到了诸如root之类的解决方案。但生根适用于安卓手机，而不是安卓模拟器。

请建议。这是至关重要的。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-03-29T07:38:09.273

你不需要根你的手机来支持印地语或马拉地语。我已经在我的应用程序中使用了马拉地语字体检查下面的链接它会对你有所帮助[链接](http://palewar.com/2012/04/how-to-use-hindi-font-in-android-app/)

# javascript - Twitter Bootstrap Typeahead gon gem 并将数据从模型传递到 JS - 以 json 格式

> ID：10153548
> 
> 赞同：0
> 
> 时间：2012-04-14T12:18:15.223
> 
> 标签：javascript, jquery, ruby-on-rails, ruby-on-rails-3, twitter-bootstrap

我希望将我的“公司”的名称传递到表格上的自动完成输入中。

我正在使用 twitter bootstrap 和 gon gem 将数据传递到 Json 并使其可用于 js。

但是我无法让该字段做出响应，我不认为数据可用于表单并且不明白为什么。

我的公司控制器执行以下操作，将公司名称分配给 gon 变量。

```
gon.firms = Firm.all.map &:name 
```

我的 Application.html.erb 在其标头中有以下内容，以使 gon 变量可用于 js。

```
<%= include_gon %>
<script type="text/javascript">
    jQuery(document).ready(function() {
        $(.typeahead).typeahead({source:gon.firms});
    });
    </script> 
```

然后我有了我想分配 typeahead 的表格，我已经分配了 class="typeahead" 给它。

```
<%= form_tag firms_path, :method => 'get', :class => 'typeahead'  do %>
<%= text_field_tag :search, params[:search], :class => 'input-medium search-query', :placeholder => 'Firm name' %>
<%= submit_tag "Search", :name => nil ,:class => 'btn' %>
<% end %> 
```

最后，根据 twitter 引导文档，application.js 文件相关的 jquery。

```
$(function() {  
    $('.typeahead .input-medium search-query').typeahead({source:[gon.firms]});
} 
```

我的应用程序 .js 还具有以下库

```
//= require jquery
//= require jquery_ujs
//= require jquery-ui
//= require twitter/bootstrap
//= require_tree . 
```

我检查了 gon.firms 是否可用作变量，但开发控制台出现以下错误

```
uncaught syntax error: Unexpected token 
```

有什么想法可能导致这种情况吗？

有什么明显的错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:40:56.740

首先确保`gon.firms`按照您的预期填充（检查您的 Web 开发工具控制台）。然后，当您在那里时，请确保您在框中键入时没有 js 错误。最后，根据[docs](http://twitter.github.com/bootstrap/javascript.html#typeahead)，您似乎想将插件附加到文本字段，而不是表单：

```
$('.typeahead .search-query').typeahead( { source: gon.firms } ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T06:33:11.103

这是因为 gon.firms 是 ruby​​ 数组而不是 js 数组。

您可以将字符串传输到 js，然后将其拆分为这样的数组：

```
$(function() {
    var col = "<%= @pon.firms.join(",") %>".split(",");
    $(".search-query").typeahead({ source: col });
}); 
```

# r - 循环加载文件对

> ID：10153551
> 
> 赞同：1
> 
> 时间：2012-04-14T12:18:42.363
> 
> 标签：r

我正在编写一个循环，每次运行 ega0.txt 和 b0.txt 需要两个文件。我正在运行从 a0.txt 和 b0.txt 到 a999.txt 和 b999.txt 的 100 多个文件。如果我对文件 a0 和 b0 到 a9 和 b9 运行目录中只有文件对 0-9，则我使用的模式函数非常有效。但是当我在目录中放置更多文件并从'0:10 开始运行时，循环失败并混淆文件中的向量。我认为这是因为我使用的模式

```
 list.files(pattern=paste('.', x, '\\.txt', sep='')) 
```

这仅查找具有`'.',x,//txt.`

因此，如果`'.'=a`它`x=1`找到了 file `a1`。但我认为它在运行更多文件时`a0`和运行时会感到困惑。`a10`但我似乎找不到合适的循环来搜索那些也查找文件的文件，直到`a999`和`b999`，以及。

谁能提供更好的方法来做到这一点？下面的代码。

```
dostuff <- function(x) 
{
files <- list.files(pattern=paste('.', x, '\\.txt', sep=''))
a <- read.table(files[1],header=FALSE)  #file a0.txt 
G <- a$V1-a$V2
b <- read.table(files[2],header=FALSE) #file b0.txt
as.factor(b$V2)
q <- tapply(b$V3,b$V2,Fun=length)
H <- b$V1-b$V2
model <- lm(G~H)
return(model$coefficients[2],q)
}

results <- sapply(0:10,dostuff)
Error in tapply(b$V3, b$V2, FUN = length) : arguments must have same length 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:58:10.380

如果两个文件的开头始终相同（在您的示例中为 a，b）；您可以在模式中使用此信息：

```
x <- 1
list.files(pattern=paste('[a,b]', x, '\\.txt', sep=''))
# [1] "a1.txt" "b1.txt"
x <- 11
list.files(pattern=paste('[a,b]', x, '\\.txt', sep=''))
# [1] "a11.txt" "b11.txt" 
```

**编辑**：你也应该包括`^`Wojciech 建议的。`^`匹配一行的开头，或者在您的情况下匹配文件名的开头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T02:16:37.613

如何直接获取文件，无需搜索。IE

```
dostuff <- function(x) 
{
    a.filename <- paste('a', x, '.txt', sep='') # a<x>.txt
    b.filename <- paste('b', x, '.txt', sep='') # b<x>.txt
    a <- read.table(a.filename, header=FALSE)  
    # [...]
    b <- read.table(b.filename, header=FALSE)
    # [...]
} 
```

但是错误消息说问题是由调用引起的，`tapply`而不是由不正确的文件名引起的，我真的不知道这是怎么发生的，因为我认为一个数据框（它`read.table`创建）总是具有相同的行数每一列。您是否从 R 中复制粘贴了该错误消息？（我觉得可能有错字，所以它是，例如，`q <- tapply(a$V3,b$V2,Fun=length)`。但我很容易出错）

此外，`as.factor(b$V2)`不修改`b$V2`，它只是返回一个表示`b$V2`: after you call的因子`as.factor` `b$V2`仍然是一个向量。您需要将其分配给某些东西，例如：

```
V2.factor <- as.factor(b$V2) 
```

# c# - 这是 BindingList 应该工作的方式吗？

> ID：10153554
> 
> 赞同：3
> 
> 时间：2012-04-14T12:19:06.047
> 
> 标签：c#, winforms, devexpress, gridcontrol

我有一个绑定到 BindingList 的 DevExpress GridControl。我使用了 BindingList，以便将更改自动应用于绑定控件。

当我从列表中添加或删除项目时，它工作得很好，但是当我更改一个项目时，它不会按照我想要的方式退出工作。

我创建了一个在另一个线程中运行的 foreach 循环（以保持 UI 线程可以自由更新），该循环遍历 BindingList 中的所有对象并更改它们的一些属性。

我期望它工作的方式是每个属性都在 GridControl 上实时更新更新。但是更新非常“笨拙”。有时它一次更新 2 行，有时我必须单击 GridControl 才能获取新值。

为什么会这样？

`DataControl.RefreshDataSource()`在每个项目之后调用是一个好的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T16:24:47.823

> 但是当我改变一个项目时，它并没有按照我想要的方式退出工作。

因为项目中的更改不是 BindingList 所关心的——这就是项目应该实现 INotifyPropertyChanged 的​​原因。

基本上，绑定列表说明 LIST 何时更改，但是如果您更新一个属性 - 列表应该如何知道 ;) 以及它为什么要关心 - 每个项目分别负责使用所述接口发布对其属性的更新。

> 在每个项目之后调用 DataControl.RefreshDataSource() 是一个好的解决方案吗？

最坏的方式。确保项目实现 INotifyPropertyChange 并相应地引发 PropertyChanged 事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T16:01:51.320

您的对象`BindingList`应该实现接口并在其属性值更改时`INotifyPropertyChanged`引发事件。`PropertyChanged`

# php - 根据订单的选择重新排列列表

> ID：10153559
> 
> 赞同：0
> 
> 时间：2012-04-14T12:20:15.253
> 
> 标签：php, jquery, mysql

我有一个以表格格式显示的默认列表。现在在表格上方，我有一个排序选项。现在，如果不提供该排序选项的表单和按钮，我将如何根据下拉选择框中选择的顺序选项更改记录。我正在尝试通过使用 jquery 来做到这一点。但最终，徒劳无功。我的代码是这样的：

```
<?php
$other_account_sql = "SELECT `admin_id`,`username`,`admin_name`,`role`,`status`,`email`,`contact_no`,`location`,`creation_date` FROM `admin_details` WHERE `username` <> '".$_SESSION['existingUser']."'"; //this is for getting default lists 
?> 
```

* * *

```
<!-- html code-->
<select name="sort_selection" id="sort_selection" class="soring_select">
    <option value="">--Select One--</option>
    <option value="admin_name" >Name</option>
    <option value="email" >Email Id</option>
    <option value="location">Location</option>
    <option value="contact_no">Contact No</option>
</select> 
<!--end of html code-->

<!-- js code-->
<script type="application/javascript" src="js/jquery-1.7.2.js" language="javascript"></script>
<script type="application/javascript">
   $(document).ready(function(){
     $('#sort_selection').change(function(){
    var str = "";
     $("select option:selected").each(function () {
        str += $(this).text() + " ";
     });
    }); 
    });
</script>
<!-- end of js code--> 
```

现在我的问题是如何根据选择更改查询？请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:08:56.773

给你，伙计

```
<?php
$other_account_sql = "SELECT `admin_id`,`username`,`admin_name`,`role`,`status`,`email`,`contact_no`,`location`,`creation_date` FROM `admin_details` WHERE `username` <> '".$_SESSION['existingUser']."'" ORDER BY ". $_POST['sort_selection'].: ASC;
?> 
```

祝你好运

# javascript - 动态对象数组

> ID：10153561
> 
> 赞同：2
> 
> 时间：2012-04-14T12:20:24.767
> 
> 标签：javascript

在 javascript 中，我们有一个包含静态对象数量的数组。

```
objectArray = [{}, {}, {}]; 
```

有人可以向我解释如何使这个数字动态化吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-14T12:23:21.720

你不必让它动态，它已经是。您只需要在数组中添加更多对象：

```
// Add some new objects
objectArray.push({});
objectArray.push({});
console.log(objectArray.length); // 5

// Remove the last one
objectArray.pop();
console.log(objectArray.length); // 4 
```

在 JavaScript 中，不需要声明数组长度。它们总是动态的。

您可以通过数组键修改单个对象：

```
// Add a property to the second object:
objectArray[1].newProperty = "a new property value!"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T12:24:21.537

如果您不想，在首次创建数组时不需要指定数组大小。您可以使用：

```
var objectArray=new Array(); 
```

通过以下方式创建数组并添加元素：

```
objectArray[0] = "something";
objectArray[1] = "another thing";
objectArray[2] = "and so on"; 
```

# xml - 为什么 Windows 输出重定向在 ant 中不起作用

> ID：10153566
> 
> 赞同：1
> 
> 时间：2012-04-14T12:20:45.453
> 
> 标签：xml, ant

我正在尝试`cmd.exe /C echo Please write this to a file >> output.txt`使用 ant`<exec>`任务执行。从命令行执行时，此命令可以正常工作。但是在使用 ant 执行时不起作用。这是我想要做的。

```
 <exec executable="${env.ComSpec}" osfamily="windows">
    <arg value="/C"/>
    <arg value="echo"/>
    <arg value="Please write this to file"/>
    <arg value=">>"/>
    <arg value="output.txt"/>
</exec> 
```

有人可以告诉我哪里出错了吗？

提前感谢您的投入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:28:03.520

`>>`不是`cmd.exe`您即将执行的参数，而是当前shell

试试[exec](http://ant.apache.org/manual/Tasks/exec.html) ant任务的`output`参数

```
<exec executable="${env.ComSpec}" osfamily="windows" output="output.txt"> 
  <arg value="/C"/> 
  <arg value="echo"/> 
  <arg value="Please write this to file"/> 
</exec> 
```

# java - Hibernate保存关系表

> ID：10153567
> 
> 赞同：1
> 
> 时间：2012-04-14T12:20:55.800
> 
> 标签：java, hibernate, annotations

我有一个具有以下表结构的数据库...

> *Customer*表有两列：id、name。
> 
> *Order*表有两列：id、customer_id
> 
> 这两个表之间存在一对一的关系

当我运行下面给出的代码时，出现以下异常：

```
Hibernate: insert into customer (name) values (?)
Hibernate: insert into order (customer_id) values (?)
05:02:46,374  WARN [main] JDBCExceptionReporter:233 - SQL Error: 0, SQLState: 42601
05:02:46,379 ERROR [main] JDBCExceptionReporter:234 - ERROR: syntax error at or near "order" 
```

这是我的代码。有人可以帮助解释问题的原因...

```
@Entity
@Table(name = "customer")
public class Customer implements Serializable {

    public Customer() {
    }

    private long id;
    private String name;

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "id", insertable = false, updatable = false, nullable = false)
    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id;
    }

    @Column(name = "name")
    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
}

@Entity
@Table(name = "order")

public class Order implements Serializable {
    public Order() {
    }

    public Order(Customer customer) {
        this.customer = customer;
    }

    private long id;
    private Customer customer;

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "id", insertable = false, updatable = false, nullable = false)
    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id;
    }

    @OneToOne(cascade = { CascadeType.ALL })
    @JoinColumn(name = "customer_id")
    public Customer getCustomer() {
        return customer;
    }

    public void setCustomer(Customer customer) {
        this.customer = customer;
        // setCustomerId(customer.getId());
    }
}

public static void main(String[] args) {

    Customer cm = new Customer();
    cm.setName("John");

    Order ord = new Order(cm);

    SessionFactory sessionFactory = new Configuration().configure().buildSessionFactory();
    Session session = sessionFactory.openSession();

    Transaction transaction = null;

    try {
        transaction = session.beginTransaction();
        session.save(ord);
        transaction.commit();
}
    catch (HibernateException e) {
        transaction.rollback();
        e.printStackTrace();
    }
    finally {
        session.close();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:22:30.800

ORDER BY 是一个 SQL 关键字。也许表名使解析器感到困惑。我建议您重命名它并重试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T12:34:24.157

`order`是一个 SQL 关键字。如果您无法更改数据库名称，请尝试使用：

```
@Table( name = "\"order\"" ) 
```

但如果您仍在开发中，请更改表名和列名以避免使用 SQL 关键字。

# oracle - 将批量记录插入 oracle DB 的替代方法是什么？

> ID：10153569
> 
> 赞同：1
> 
> 时间：2012-04-14T12:21:00.357
> 
> 标签：oracle, stored-procedures, plsql

我正在使用 oracle CURSOR 迭代大量记录以从一个表插入到另一个表。我发现插入需要很长时间。有没有其他方法可以在不使用 CURSOR 的情况下处理批量记录。这是我正在执行的活动。

```
CURSOR FIRST_TAB(bu_emp_id IN Number) IS
  SELECT * FROM FIRST_TABLE lst
  where lst.emp_id =  bu_emp_id;

v_first FIRST_TAB%ROWTYPE;

CURSOR SECOND_TAB(bu_emp_id IN Number) IS
  SELECT * FROM SECOND_TABLE 2nd WHERE 2nd.emp_id= bu_emp_id;

v_second SECOND_TAB%ROWTYPE;

CURSOR THIRD_TAB(bu_emp_id IN Number) IS
  SELECT * FROM THIRD_TABLE 3rd WHERE 3rd.emp_id = bu_emp_id;

v_third THIRD_TAB%ROWTYPE;
------------------------------------------------------------------------

open FIRST_TAB(bu_emp_id);
  loop
    fetch FIRST_TAB into r_first;
    exit when FIRST_TAB %NOTFOUND;

-- iNSERT STATEMENT-------

  open SECOND_TAB(bu_emp_id);
     loop
       fetch SECOND_TAB into v_second;
       exit when SECOND_TAB %NOTFOUND;

-- iNSERT STATEMENT-------

       open THIRD_TAB(bu_emp_id);
         loop
           fetch THIRD_TAB into v_third ;
           exit when THIRD_TAB %NOTFOUND;

-- iNSERT STATEMENT-------

         end loop;
      close THIRD_TAB;
    end loop;
    close SECOND_TAB;
  end loop;
  close FIRST_TAB; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:56:26.530

找到一种直接使用 SQL 的方法。从您的示例中不清楚您的数据是否适合这种方法，但请努力做到这一点。您不会完全在引擎中的一个语句中改进做事。

# php - php 从 mysql 查询中选择输入复选框

> ID：10153570
> 
> 赞同：0
> 
> 时间：2012-04-14T12:21:23.907
> 
> 标签：php, mysql

如何`checked="yes"`从 php mysql 结果中添加什么时候`$row['checkbox'] == input.value`？

例如：如果现在 如何`$row['checkbox']='3'`添加？谢谢。`checked="yes"``<li><input type="checkbox" name="my_check" value="3" checked="yes" />Guangzhou</li>`

```
<?php
// db_connect, mysql_query
while($row = mysql_fetch_array($query)){
// If($row['checkbox']='3)
?>
<li><input type="checkbox" name="my_check" value="1" />Beijing</li>
<li><input type="checkbox" name="my_check" value="2" />Shanghai</li>
<li><input type="checkbox" name="my_check" value="3" />Guangzhou</li>
<li><input type="checkbox" name="my_check" value="4" />Chongqin</li>
<li><input type="checkbox" name="my_check" value="5" />Tianjing</li>
<li><input type="checkbox" name="my_check" value="6" />Chengdu</li>
<li><input type="checkbox" name="my_check" value="7" />Wuhan</li>
<li><input type="checkbox" name="my_check" value="8" />Nanjing</li>
<li><input type="checkbox" name="my_check" value="9" />Shenzhen</li>
<li><input type="checkbox" name="my_check" value="10" />Hangzhou</li>
<li><input type="checkbox" name="my_check" value="11" />Ningbo</li>
<?php
}
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T12:28:14.577

我会首先为复选框创建一个数组：

```
$checkBoxes = array(1=>'Beijing',
                    2=>'Shanghai',
                    3=>'Guangzhou',
                    4=>'etc',
                    ); 
```

然后我会简单地遍历它们：

```
<?php
while($row = mysql_fetch_array($query)){
    foreach($checkBoxes as $value => $name) {
        $checked = '';
        if ($row['value'] == $value) $checked = ' checked="true"';
        echo '<li><input type="checkbox" name="my_check" value="' . $value . '"' . $checked . ' />' . $name . '</li>';
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T12:33:11.110

试试这个

```
<?php
// db_connect, mysql_query
while($row = mysql_fetch_array($query)){
// If($row['checkbox']='3)
$checked[$row['checkbox']] = ' checked="checked" ';
?>
<li><input type="checkbox" name="my_check" value="1" <?php echo $checked[1] ?> />Beijing</li>
<li><input type="checkbox" name="my_check" value="2" <?php echo $checked[2] ?> />Shanghai</li>
<li><input type="checkbox" name="my_check" value="3" <?php echo $checked[3] ?> />Guangzhou</li>
<li><input type="checkbox" name="my_check" value="4" <?php echo $checked[4] ?> />Chongqin</li>
<li><input type="checkbox" name="my_check" value="5" <?php echo $checked[5] ?> />Tianjing</li>
<li><input type="checkbox" name="my_check" value="6" <?php echo $checked[6] ?> />Chengdu</li>
<li><input type="checkbox" name="my_check" value="7" <?php echo $checked[7] ?> />Wuhan</li>
<li><input type="checkbox" name="my_check" value="8" <?php echo $checked[8] ?> />Nanjing</li>
<li><input type="checkbox" name="my_check" value="9" <?php echo $checked[9] ?> />Shenzhen</li>
<li><input type="checkbox" name="my_check" value="10" <?php echo $checked[10] ?> />Hangzhou</li>
<li><input type="checkbox" name="my_check" value="11" <?php echo $checked[11] ?> />Ningbo</li>
<?php
}
?> 
```

祝你好运

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T12:25:00.667

```
 <input type="checkbox" name="my_check" value="3" <?php if($row['checkbox']=='3') checked="yes" ?>/> 
```

# android - android - 在图像 onTouch 事件中隐藏点

> ID：10153573
> 
> 赞同：0
> 
> 时间：2012-04-14T12:21:42.113
> 
> 标签：android, imageview, touch-event

我的 Android 应用程序中有 Imageview 和 Image。我希望用户触摸的图像上的点会消失。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T12:28:40.003

将 OnTouchListener 添加到该视图，并在触摸时获取坐标并重绘视图并在画布上绘制您想要的像素，即白色像素，到您想要的位置。

这个流量差不多。。

希望这可以帮助！

# c# - SQL Server CE：在 Where 子句中使用 DateTime 更新语句

> ID：10153576
> 
> 赞同：1
> 
> 时间：2012-04-14T12:22:07.953
> 
> 标签：c#, datetime, sql-server-ce, sql-update

我需要能够更新表中一行的时间信息。id 不是唯一的，所以我也使用该`startTime`列来查找特定行。我正在使用 SQL Server CE 和 C#，所以日期对象是`DateTime`C# 中的一个对象。

还有其他方法可以优化吗？我似乎无法与该`WHERE`子句和`startTime`? `startTime`是`datetime`SQL Server CE 中的一种数据类型。

```
UPDATE tablename
SET endTime = '14/04/2012 9:42:58 PM', duration = '0.052003'
WHERE (startTime = CONVERT(DATETIME, '2012-04-14 21:42:58.000', 120)) AND (id= '14363204') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:25:14.097

两件事情：

1.  从一个简单的 SELECT 语句而不是 UPDATE 开始。先让它工作。
2.  使用日期时间文字。

尝试这个：

```
SELECT *
FROM tablename
WHERE startTime = '2012-04-14 21:42:58.000' AND id = '14363204' 
```

如果这不起作用，最可能的问题是时间不完全匹配。可能的原因包括：

*   数据库中的日期时间可能以毫秒精度存储，但您的查询使用的值似乎已四舍五入到最接近的秒数。这可能会导致匹配失败。
*   数据库中的日期可能已存储在不同的时区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T12:46:03.840

您正在使用 120 日期样式转换您的时间，这会去掉毫秒。例如，如果 startTime 值是使用 GETDATE() 生成的，它将不匹配。

我建议您在处理 SQL（样式 121）中的日期时坚持使用 ISO-8601 日期格式，因为它消除了对 CONVERT() 调用的需要，更重要的是它不依赖于区域设置（您的代码例如，在法语或德语 SQL Server 上会失败）。

```
UPDATE tablename
SET endTime = '20120414 21:42:58', duration = '0.052003'
WHERE startTime = '20120414 21:42:58.000' AND id = '14363204' 
```

尝试 a`SELECT CONVERT(DATETIME, startTime, 121) FROM tablename WHERE id = '14363204'`查看您要更新的 startTime 是否有任何毫秒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T12:41:51.793

为什么`CONVERT(DATETIME, '2012-04-14 21:42:58.000', 120)`？您是否将 startTime 作为字符串传递？这可能是个问题。startTime.ToString() （在 C# 中）可能会产生比您预期的另一种格式？您是否使用动态 SQL（意思是：您在 C# 中将查询构建为字符串，然后触发它）？

分解您的查询并检查传递的参数。

```
DECLARE @startTime DATETIME = '2012-04-14 21:42:58.000'
DECLARE @endTime DATETIME = '14/04/2012 9:42:58 PM'
DECLARE @duration DECIMAL = 0.052003
DECLARE @id INT = 14363204

-- debug - check if your input parameters are as expected
SELECT @startTime AS startTime, @endTime AS endTime, @duration AS duration

-- do the update
UPDATE  tablename
SET  endTime = @endTime, duration = @duration
WHERE  startTime = @startTime AND id = @id 
```

我建议您将上述内容包装到`CREATE PROCEDURE`C# 中并执行存储过程，而不是使用动态 SQL。

我不知道在 SQL CE 中是否可行，但在完整版中，您拥有 SQL Profiler，它使您能够捕获和检查应用程序发送到 SQL Server 的查询。

# iphone - MKMapView addOverlays 线程错误

> ID：10153578
> 
> 赞同：0
> 
> 时间：2012-04-14T12:22:19.150
> 
> 标签：iphone, ios5, mkmapview

在我的应用程序中，我想向地图添加叠加层，当用户拖动滑块时，叠加层圆半径必须改变，但有时会抛出线程异常。我的代码：

```
- (void)addCircleWithRadius:(NSNumber *)radius
    {

        MKCircle *circle = [MKCircle circleWithCenterCoordinate:userlocation radius:[radius doubleValue] ];
        [circle setTitle:@"background"];

        MKCircle *circleLine = [MKCircle circleWithCenterCoordinate:userlocation radius:[radius doubleValue]];
        [circleLine setTitle:@"line"];

        NSArray *overlays = [NSArray arrayWithObjects:circle,circleLine, nil];
        [mapView addOverlays:overlays];

    }

-(void)slider_change:(id)sender
{
    @try {
        [mapView removeOverlays:[mapView overlays]];
        if([mapView.overlays count] == 0)
        {
            CLLocationCoordinate2D _coordinate ;
            _coordinate.latitude = 35.692995;
            _coordinate.longitude = 51.421509;
            NSNumber *value = [NSNumber numberWithFloat:slider.value * 1000];
            [self addCircleWithRadius:value];
        }
    }
    @catch (id exception) {

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T10:55:30.193

```
-(IBAction)slider_action:(id)sender
{

    [map removeOverlays:[map overlays]];

    double radius1 = (slider.value * 5000);

    NSLog(@"%f",radius1);

    [self addCircleWithRadius:radius1 addCircleWithCoordinate:theCoordinate1];
}

-(void) addCircleWithRadius:(double)radius1 addCircleWithCoordinate: (CLLocationCoordinate2D) coordinate
{
    MKCircle *circle1 = [MKCircle circleWithCenterCoordinate:coordinate radius:radius1];

    [map addOverlay:circle1];
}
- (MKOverlayView *)mapView:(MKMapView *)map viewForOverlay:(id <MKOverlay>)overlay
{

    MKCircle* circle1 = overlay;
    MKCircleView *circleView = [[MKCircleView alloc] initWithCircle:circle1];

    circleView.alpha = 0.25;
    circleView.lineWidth = 2.0;

    circleView.strokeColor = [UIColor blackColor];
    circleView.fillColor = [UIColor redColor];

    return circleView;
} 
```

# java - 在 JPanel 中调用 super.paintComponent(g) 后先前的绘图丢失

> ID：10153586
> 
> 赞同：1
> 
> 时间：2012-04-14T12:23:59.633
> 
> 标签：java, swing

我正在尝试用 Swings 构建画笔。我想在其中一个 JPanel 上自由手绘，所以我覆盖了它的 PaintComponent，并画了一些东西，这很好。但是我没有得到任何背景，我需要白色背景，所以我在paintComponent（）中调用了super.paintComponent（g），现在我能够获得背景但是每次在mouseDragged事件上调用我的repaint（），我丢失了我之前在 JPanel 上的绘图。有什么方法可以让我获得背景颜色，而且我以前的画也不会丢失？

任何帮助将不胜感激。谢谢

**JPanel 油漆组件（）**

```
public void paintComponent(Graphics g) {
        // super.paintComponent(g);
      g.setColor(Color.red);
      g.fillOval(xpos, ypos, 5, 5);

    } 
```

**鼠标拖动（）**

```
public void mouseDragged(MouseEvent arg0) {
        xpos= arg0.getX();
         ypos= arg0.getY();
         repaint();
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T12:31:48.280

如果使用通过调用组件获得的 Graphics 对象进行绘制，通常会发生这种情况，`getGraphics()`因为由此获得的 Graphics 对象不是持久的。所有的绘图都应该在paintComponent 中或从paintComponent 调用的方法中完成。

**编辑**
好的，感谢您发布一些代码。所以我看到你在代码中只画了一个椭圆，所以 super 会阻止你画线也就不足为奇了。

可能的解决方案：

*   在您的`mouseDragged(...)`方法中，将 Points 添加到 a`List<Point>`并在您的`paintComponent(...)`方法中，遍历该列表绘制您的线条（设置 Graphics2D Stroke 以更改线条粗细）
*   或绘制到 BufferedImage 并在您的 paintComponent(...) 方法中显示 BufferedImage。

For example, please have a look at my StackOverflow answer to this question: [Changing JPanel Graphics g color drawing line](https://stackoverflow.com/a/6105437/522444)

# android - udp连接IP问题

> ID：10153595
> 
> 赞同：0
> 
> 时间：2012-04-14T12:25:15.300
> 
> 标签：android, udp, ip, 3g

我正在通过 3G 在 PC 和移动设备（Android 设备）之间建立 udp 连接，以流式传输视频和其他内容。我通过 Wifi 连接测试了我的代码，它工作得很好。

问题是：通过3G连接时，除非IP的前两个字段相同，否则连接不起作用

例如：

*   如果`PC IP = 10.220.x.x`和`mobile IP = 10.220.x.x`，则连接有效。
*   如果`PC IP = 10.220.x.x`和`mobile IP = 10.219.x.x`，则**连接不起作用**。

任何人都知道问题出在哪里或如何解决？我的意思是很难获得类似的 IP，我可以不断断开连接并重新连接以永远获得不同的 IP，并且百万分之一只能获得两个类似的 IP（因为我无法在 3G 网络中手动更改 IP），它正在驱使我疯狂的。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:05:06.337

大多数移动网络都针对 Internet 进行了 NAT（阻止 UDP 流量）。此外，您的运营商似乎也有不同的子网，这些子网相互之间有防火墙，阻止了所有 UDP 流量。

一般来说，现在在移动网络中使用 UDP 是一个坏主意。UDP 的常见用法是 IP 语音，这是几乎所有移动网络运营商都不允许的用例，因为这可能会使他们失去利润。

# magento - Magento 产品创建错误...SQLSTATE [23000]：完整性约束违规：1062 重复条目？

> ID：10153596
> 
> 赞同：2
> 
> 时间：2012-04-14T12:25:17.510
> 
> 标签：magento, constraints, product, mysql-error-1062, duplicates

![1062 Duplicate entry][2] 在 Magento 的产品创建代码中，我在**/htdocs/magento/app/code/core/Mage/Adminhtml/controllers/Catalog/ProductController.php**中添加了我自己的自定义代码我已经建立了外部 mysql 连接并使用它在自定义表中插入产品 id 和 sku。（我知道这不是推荐的方式，但只是为了测试目的，我这样做了。）

我的代码-：

```
public function saveAction()
{
        $storeId        = $this->getRequest()->getParam('store');
        $redirectBack   = $this->getRequest()->getParam('back', false);
        $productId      = $this->getRequest()->getParam('id');
        $isEdit         = (int)($this->getRequest()->getParam('id') != null);

        $data = $this->getRequest()->getPost();
        if ($data) {
            if (!isset($data['product']['stock_data']['use_config_manage_stock'])) {
                $data['product']['stock_data']['use_config_manage_stock'] = 0;
            }
            $product = $this->_initProductSave();

            try {
                $product->save();
                $productId = $product->getId();
//-------My code start---------------------------------
     $db_name = "magento";
             $con = mysql_connect  ("www.xyz.com", "magento", "password");
            If(!$con)
    {
        die('Could not connect: ' . mysql_error());
        mysql_close($con);
    }
    $seldb = mysql_select_db($db_name, $con);

    $query_fetch = "SELECT cpe.entity_id, cpe.sku FROM catalog_product_entity cpe
               WHERE cpe.entity_id = ".$productId;

    $result_query_fetch = mysql_query($query_fetch);
    while($row = mysql_fetch_array($result_query_fetch))
    {
        $entity_id = ($row["entity_id"]);
        $sku = ($row["sku"]);           
        $result_fetch = "$entity_id".",'".$sku."'";
    }

         $query_insert = "INSERT into product_creation(entity_id,sku,creation_date) VALUES(".$result_fetch.", NOW())";
    $result_insert = mysql_query($query_insert);

    mysql_close($con);
  //--------------------------My code End-----------------------------------------

                /**
                 * Do copying data to stores
                 */
                if (isset($data['copy_to_stores'])) {
                    foreach ($data['copy_to_stores'] as $storeTo=>$storeFrom) {
                        $newProduct = Mage::getModel('catalog/product')
                            ->setStoreId($storeFrom)
                            ->load($productId)
                            ->setStoreId($storeTo)
                            ->save();
                    }
                }

                Mage::getModel('catalogrule/rule')->applyAllRulesToProduct($productId);

                $this->_getSession()->addSuccess($this->__('The product has been saved.'));

            }
            catch (Mage_Core_Exception $e) {
                $this->_getSession()->addError($e->getMessage())
                    ->setProductData($data);
                $redirectBack = true;
            }
            catch (Exception $e) {
                Mage::logException($e);
                $this->_getSession()->addError($e->getMessage());
                $redirectBack = true;
            }
        }

        if ($redirectBack) {
            $this->_redirect('*/*/edit', array(
                'id'    => $productId,
                '_current'=>true
            ));
        }
        else if($this->getRequest()->getParam('popup')) {
            $this->_redirect('*/*/created', array(
                '_current'   => true,
                'id'         => $productId,
                'edit'       => $isEdit
            ));
        }
        else {
            $this->_redirect('*/*/', array('store'=>$storeId));
        }
    } 
```

所以从这段代码中，产品数据被插入到两个表中，但我**收到错误**

**SQLSTATE [23000]：违反完整性约束：1062 键 'IDX_STOCK_PRODUCT' 的重复条目 '1949-1'**

谁能帮我解决这个问题...

**我试过的解决方案-：**

-删除 /var/cache 和 /var/session

-清除浏览器缓存和cookies

- 在 app/etc/config.xml 中，更改此项

设置名称 utf8 到这个

设置名称 utf8; 设置 FOREIGN_KEY_CHECKS=0；SET UNIQUE_CHECKS=0；

仍然得到同样的错误......或者请告诉我我应该在我的代码中改变什么？

PS-我知道这不是推荐的方式，因为我正在更改核心文件的代码并且还使用外部连接而不是使用 ZEND 连接......但这只是为了测试目的......

这个问题有什么解决办法吗？

请帮帮我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:29:14.933

该错误非常清楚您的问题是什么：您有一个唯一的键约束 IDX_STOCK_PRODUCT 并且在该键涵盖的任何列中都已经有一条值为“1949-1”的记录。

# php - 不同的页面直接取决于字段是否为空

> ID：10153601
> 
> 赞同：2
> 
> 时间：2012-04-14T12:26:02.000
> 
> 标签：php, mysql

请帮忙！这是我试图设置必填字段的代码。如果该字段为空，它应该在完成后显示错误，它应该重定向到 myaccount.php。使用下面的代码，它只是一直将我重定向到 myaccount.php。有问题的字段是一个很大的文本区域。PHP：

```
session_start();
$link = mysql_connect(DB_HOST, DB_USER, DB_PASS) or die("Couldn't make connection.");
$err = array();
if (isset($_POST['doThesis']) && $_POST['doThesis'] == 'Save')
{
if ( ! isset($_SESSION['user_id']))
{
    exit(header("Location:login.php\r\n"));
}

{
$result = mysql_query("SELECT `id` FROM users WHERE `banned` = '0'") or 
die (mysql_error());

list($id) = mysql_fetch_row($result);

$_SESSION['user_id']= $id;
foreach($_POST as $key => $value)

if(empty($abstract))
{
$err[] = "ERROR - Enter Native Language";
//    header("Location: language.php?msg=$err[0]");
}

/// Automatically collects the hostname or domain  like example.com)
$host  = $_SERVER['HTTP_HOST'];
$host_upper = strtoupper($host);
$path   = rtrim(dirname($_SERVER['PHP_SELF']), '/\\');

if(empty($err)) {
    $thesis_Name = mysql_real_escape_string($_POST['thesis_Name']);
    $abstract = mysql_real_escape_string($_POST['abstract']);

$sql_insert = "INSERT into `thesis`
    (`user_id`,`thesis_Name`,`abstract` )
VALUES
    ('$id','$thesis_Name','$abstract') ";

mysql_query($sql_insert,$link) or die("Insertion Failed:" . mysql_error());
}
header("Location: myaccount.php?id=' . $_SESSION[user_id] .'");
exit();

}
} 
```

登录表格：

```
$err = array();

foreach($_GET as $key => $value) {
$get[$key] = filter($value); //get variables are filtered.
}

if (@$_POST['doLogin']=='Login')
{

foreach($_POST as $key => $value) {
$data[$key] = filter($value); // post variables are filtered
}

$user_email = $data['usr_email'];
$pass = $data['pwd'];

if (strpos($user_email,'@') === false) {
$user_cond = "user_name='$user_email'";
} else {
$user_cond = "user_email='$user_email'";

}

$result = mysql_query("SELECT `id`,`pwd`,`full_name`,`approved`,`user_level` FROM users
  WHERE 
       $user_cond
        AND `banned` = '0'
        ") or die (mysql_error()); 
$num = mysql_num_rows($result);

// Match row found with more than 1 results  - the user is authenticated. 
if ( $num > 0 ) { 

list($id,$pwd,$full_name,$approved,$user_level) = mysql_fetch_row($result);

//header("Location: login.php?msg=$msg");
 //exit();
 }

if(empty($err)){            

 // this sets session and logs user in  
    session_start();
   session_regenerate_id (true); //prevent against session fixation attacks.

   // this sets variables in the session 
    $_SESSION['user_id']= $id;  
    $_SESSION['user_name'] = $full_name;
    $_SESSION['user_level'] = $user_level;
    $_SESSION['HTTP_USER_AGENT'] = md5($_SERVER['HTTP_USER_AGENT']);

    //update the timestamp and key for cookie
    $stamp = time();
    $ckey = GenKey();
    mysql_query("update users set `ctime`='$stamp', `ckey` = '$ckey' 
where id='$id'") or die(mysql_error());

    //set a cookie 

    header("Location: myaccount.php?id=' . $_SESSION[user_id] .'");
    exit();
     }
    }
    else
    {
    //$msg = urlencode("Invalid Login. Please try again with correct 
user email and password. ");
    $err[] = "Invalid Login. Please try again with correct user email
and password.";
    //header("Location: login.php?msg=$msg");
    }
} else {
    $err[] = "Error - Invalid login. No such user exists";
  } 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T12:32:36.997

我可以看到的第一个问题是您在调用 session_start(); 之前检查会话值；

移动 session_start(); 到页面顶部，看看是否有帮助

```
<?php
    session_start();
    ..... 
```

这看起来是错误的，有两个原因我可以看到

```
if (empty($_SESSION['$user_id'])) { } 
```

首先，里面有一个$，是不是应该在那里？

其次，它将所有其余代码包装在您的页面中，实际上并没有做我认为您希望它做的事情。

试试这个

```
if (isset($_POST['doThesis']) && $_POST['doThesis'] == 'Save')
{
    if ( ! isset($_SESSION['user_id']))
    {
        exit(header("Location: someotherpage.php\r\n"));
    }
    // the rest of your code
} 
```

我又看了一遍你的代码，我建议你自己再看一遍。

似乎您正在检查是否设置了 $_SESSION['user_id'] 并且您正在从一个非常“松散”的 sql“SELECT id FROM users WHERE ban = 0”中重新为其分配一个新值，你怎么知道哪个 id 去要从这里返回？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T12:44:44.977

> *   不是testest，但应该是这样的：

```
<?php
$err = array();

// if not logged in no reason to go further
if (empty($_SESSION['user_id'])) {
    header('Location: signup.php');
    // or login.php
}

// otherwise
if (isset($_POST['doThesis'])) {
    $link = mysql_connect(DB_HOST, DB_USER, DB_PASS) or die("Couldn't make connection.");
    $user_id = intval($_SESSION['user_id']);
    // check if current user is banned
    $the_query = sprintf("SELECT COUNT(*) FROM users WHERE `banned` = '0' AND `id` = '%d'", $user_id);
    $result = mysql_query($the_query, $link);
    if ($result) {
        $user_check = mysql_num_rows($result);
        // user is ok
        if ($user_check > 0) {

            // required field name goes here...
            $required_fields = array('thesis_Name');
            // check for empty fields
            foreach ($required_fields as $field_name) {
                $value = trim($_POST[$field_name]);
                if (empty($value)) {
                    $err[] = "ERROR - $field_name is left blank!";
                }
            }
            // no errors
            if (empty($err)) {

                $thesis_Name = mysql_real_escape_string($_POST['thesis_Name']);
                $abstract = mysql_real_escape_string($_POST['abstract']);

                // insert into the database
                $the_query = sprintf("INSERT INTO `thesis` (`user_id`,`thesis_Name`,`abstract`) VALUES ('%d','%s','%s')", $user_id, $thesis_Name, $abstract);

                // query is ok?
                if (mysql_query($the_query, $link)) {

                    // redirect to user profile
                    header('Location: myaccount.php?id=' . $user_id);
                } else {
                    echo mysql_error();
                }
            }
        }
    } else {
        echo mysql_error();
    }
}
?> 
```

# javascript - 在脚本切换菜单中添加“if”条件（jquery）

> ID：10153603
> 
> 赞同：1
> 
> 时间：2012-04-14T12:26:28.790
> 
> 标签：javascript, jquery, html, drop-down-menu, toggle

请不要打败我下面写的很多代码。

```
var flip = 0;
$('#btn').click(function () {
$('#blck').toggle( flip++ % 2 == 0 );
$('#menu-btn') .removeClass('close') .addClass('open')
}); 
```

我把2段代码放在一起，他应该执行打开和关闭div，同时改变另一个div的类。问题是第二个对象的类不会变回第二次点击......据我所知，它应该是一个条件**IF**。帮助我理解语言的语法。

提前非常感谢，抱歉英语不好。

问题已结束。谢谢吉尔斯克。**_** 您的建议无效，我不得不补充：

```
var flip = 0;
$('#btn').click(function () {
$('#blck').toggle( flip++ % 2 == 0 );
$('#menu-btn').toggleClass('close open');
}); 
```

现在一切都井井有条

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T12:37:14.023

您不需要 if，只需切换类，块也一样，只需切换它。

```
 $('#btn').click(function () {
        $('#blck').toggle();
        $('#menu-btn').toggleClass('close open');
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T12:31:10.360

```
var flip = 0;

$('#btn').click(function () {
    var menu_button = $('#menu-btn');

    $('#blck').toggle( flip++ % 2 == 0 );

    if (menu_button.hasClass('open')) {
        menu_button.removeClass('close');
        menu_button.addClass('open');
    } else {
        menu_button.removeClass('open');
        menu_button.addClass('close');
    }
}; 
```

# javascript - jquery tablesorter 如何仅将类添加到第二个 td？

> ID：10153606
> 
> 赞同：1
> 
> 时间：2012-04-14T12:26:49.807
> 
> 标签：javascript, jquery, html, tablesorter

我使用 jquery tablesorter 类，我只想在 mouseOver 事件上将类添加到第二个 td：

<tr>
<td>1</td>
<td>2</td>
</tr>

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T12:33:44.867

```
$('#table').mouseover(function() {
   $("#table td:nth-child(2)").addClass("tablesorter");
} 
```

# iphone - xcode4.2导航栏中的多个右栏按钮

> ID：10153607
> 
> 赞同：0
> 
> 时间：2012-04-14T12:27:27.867
> 
> 标签：iphone, ios5, uinavigationbar, rightbarbuttonitem

我想在导航栏的右侧创建三个按钮。我正在使用情节提要来创建 UIView 控制器。在 DetailViewController 中嵌入了一个使用故事板的导航栏，然后以编程方式创建三个 UIBarButtonItem，然后将它们添加到数组中，然后将其分配给 navigationitem。这工作正常。

```
UIBarButtonItem *Button1 = [[UIBarButtonItem alloc]initWithTitle:@"Button1" style:UIBarButtonItemStylePlain
                                                           target:self action:@selector(Button1Clicked:)] ;

UIBarButtonItem *Button2 = [[UIBarButtonItem alloc] initWithTitle:@"Button2" style:UIBarButtonItemStylePlain
                                                             target:self action:@selector(Button2Clicked:)] ;

UIBarButtonItem *Button3 = [[UIBarButtonItem alloc] initWithTitle:@"Button3" style:UIBarButtonItemStylePlain
                                                              target:self action:@selector(Button3Clicked::)] ;

self.navigationItem.rightBarButtonItems =
[NSArray arrayWithObjects:Button1,Button2,Button3, nil]; 
```

我有另一个视图控制器，这是一个模态视图控制器。我正在使用情节提要创建视图控制器并添加导航栏而不是导航控制器。然后使用相同的方法将按钮添加到导航栏，但未显示任何按钮。请任何人知道如何解决这个问题。？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T19:28:47.213

如果你的 viewController 在`UINavigationController`你可以简单地使用

```
self.navigationItem ... 
```

如我所见，效果很好。但是如果您的 viewController（在这种情况下是您的模态）**不在**，`UINavController`您必须以`UINavigationItem`这种方式访问​​：

```
someNavigationBar.topItem ... 
```

所以，如果你`IBOutlet`为你的导航栏设置一个，你的代码应该是这样的：

```
UIBarButtonItem *Button1 = ...
UIBarButtonItem *Button2 = ...
UIBarButtonItem *Button3 = ...

yourNavigationBar.topItem.rightBarButtonItems = [NSArray arrayWithObjects:Button1, Button2, Button3, nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:30:44.473

请添加`UINavigationBar`而不是`UINavigationItem`

# networking - 附加到进程的 Windows 网络嗅探器

> ID：10153609
> 
> 赞同：0
> 
> 时间：2012-04-14T12:27:38.590
> 
> 标签：networking, sniffer

我需要网络嗅探器，它可以将自身附加到 Windows 7 中的进程并通过它的网络进行嗅探，例如......它将数据包发送到数据包包含的数据包它接收的数据包基本上是所选之间的所有网络流量进程和它发送数据包的服务器。

我已经下载了 Rawcap 和 SmartSniff 之类的工具，但它们要么不能按预期工作，要么在尝试附加到进程时抛出一些错误。

我也尝试过wireshark，但它嗅探我的整个流量而不是每个进程库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T08:34:12.740

我知道一个免费软件 Capsa Free 可以满足您的需求。但他们要求您注册下载。[http://www.colaso​​ft.com/download/products/capsa_free.php](http://www.colasoft.com/download/products/capsa_free.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T12:33:19.343

所以你正在寻找类似 Unix 的 'strace' 命令 :) 请在此处找到 Microsoft Process Monitor ： [http](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx) : //technet.microsoft.com/en-us/sysinternals/bb896645.aspx，也可以试试 xperf：[http： //msdn.microsoft.com/en-us/library/ff190983%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ff190983%28VS.85%29.aspx)

祝你好运！:)

# android - Android - 缩放 ImageView 使其宽度始终为 100

> ID：10153611
> 
> 赞同：1
> 
> 时间：2012-04-14T12:28:01.093
> 
> 标签：android, android-imageview, android-ui

我试图让 ImageView 具有特定的宽度（比如说 100dips），但要缩放以使高度是保持比例的任何值，所以如果 4:3 则下降 75，如果 4:5 然后下降 120 等.

我已经尝试了一些东西，但没有任何效果。这是我目前的尝试：

```
<ImageView
      android:id="@+id/image"
      android:layout_height="wrap_content"
      android:layout_width="100dip"
      android:adjustViewBounds="true"
       android:src="@drawable/stub" 
       android:scaleType="fitCenter" /> 
```

高度的 wrap_content 并没有改善，它只是使整个图像变小（但确实保持了纵横比）。我怎样才能完成我想做的事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T16:48:35.157

将以下类添加到您的项目中并像这样更改您的布局

**看法**

```
<my.package.name.AspectRatioImageView
    android:layout_centerHorizontal="true"
    android:src="@drawable/my_image"
    android:id="@+id/my_image"
    android:layout_height="wrap_content"
    android:layout_width="100dp"
    android:adjustViewBounds="true" /> 
```

**班级**

```
package my.package.name;

import android.content.Context;
import android.util.AttributeSet;
import android.widget.ImageView;

/**
 * ImageView which scales an image while maintaining
 * the original image aspect ratio
 *
 */
public class AspectRatioImageView extends ImageView {

    /**
     * Constructor
     * 
     * @param Context context
     */
    public AspectRatioImageView(Context context) {

        super(context);
    }

    /**
     * Constructor
     * 
     * @param Context context
     * @param AttributeSet attrs
     */
    public AspectRatioImageView(Context context, AttributeSet attrs) {

        super(context, attrs);
    }

    /**
     * Constructor
     * 
     * @param Context context
     * @param AttributeSet attrs
     * @param int defStyle
     */
    public AspectRatioImageView(Context context, AttributeSet attrs, int defStyle) {

        super(context, attrs, defStyle);
    }

    /**
     * Called from the view renderer.
     * Scales the image according to its aspect ratio.
     */
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {

        int width = MeasureSpec.getSize(widthMeasureSpec);
        int height = width * getDrawable().getIntrinsicHeight() / getDrawable().getIntrinsicWidth();
        setMeasuredDimension(width, height);
    }
} 
```

# vim - Vim 中的 Cx 重映射

> ID：10153613
> 
> 赞同：1
> 
> 时间：2012-04-14T12:28:09.897
> 
> 标签：vim

我需要`C-x`在 Vim 中重新映射以在某些 Windows 编辑器中表现得像：

*   在可视模式下，它应该剪切选定的文本。
*   在正常模式下，它应该剪切当前行，前提是它不是空白的。
*   应该删除一个空白行并将其放入黑洞注册表中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:06:21.737

```
" Source distribution script in $VIMRUNTIME directory
:runtime mswin.vim

if has('clipboard')
    nmap <silent> <C-X> :call CutNonEmptyLineToClipboard()<CR>
    " If the current line is non-empty cut it to the clipboard.
    " Else do nothing.
    function! CutNonEmptyLineToClipboard()
        if strlen(getline('.')) != 0
            normal 0"*D
        endif
    endfunction
endif 
```

* * *

更新版本如下。不得不谷歌“黑洞寄存器”，我不知道。（谢谢！）我还放了一个不同的空行匹配器。选择最适合你的版本。

```
if has('clipboard')
    nmap <silent> <C-X> :call CutNonEmptyLineToClipboard()<CR>
    " If the current line is non-empty cut it out into the clipboard.
    " Else delete it into the black hole register (named _).
    function! CutNonEmptyLineToClipboard()
        " Test if the current line is non-empty
"       if strlen(getline('.')) != 0
        if match(getline('.'), '^\s*$') == -1
            normal 0"*D
        else
            normal "_dd
        endif
    endfunction
endif 
```

# android-image - 在android上的图像背景上放置图像按钮

> ID：10153618
> 
> 赞同：0
> 
> 时间：2012-04-14T12:28:49.933
> 
> 标签：android-image, android

在我的应用程序中，我有一个背景图像，需要在背景图像的指定位置放置一个图像按钮。我通过使用框架布局 `android:layout_gravity`和属性`layout_alignBottom`来做到这一点。`marginLeft and right`请参考图片编号：1

我为一个模拟器设置它并且它可以工作，但是在启动其他不同大小的模拟器时我出错了，所以如何在背景图像上设置图像视图，以便 imageview 不会改变它在任何大小的屏幕上的位置。

是否有可能通过触摸屏幕上的图像按钮来触发动作查找（背景图像和图像按钮组合为单个图像 - 请参阅图像 2） ![在此处输入图像描述](../Images/d2f32fd83e4ee683b0bda2d40305fb11.png) ![在此处输入图像描述](../Images/3fea2ebcfe2c3d117988ba7f94f7303a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T12:36:27.410

对于这类问题，我认为最好的解决方案是在播放阶段、停止等阶段使用不同的图像，以免屏幕尺寸/密度出现问题。

因此有： 带播放按钮的麦克风：1 个带停止按钮的图像麦克风：1 个带播放选定按钮的图像麦克风：1 个图像

等等并处理用户事件。

希望这可以帮助！

# xcode - 界面生成器不会打开

> ID：10153623
> 
> 赞同：4
> 
> 时间：2012-04-14T12:29:28.910
> 
> 标签：xcode, cocoa, interface-builder

在 Xcode (4.3.2) 中的 Interface Builder 中工作时，应用程序冻结了，我不得不再次重新打开它。

现在尝试打开 nib 文件时出现此错误。是什么赋予了？

![IB错误](../Images/d8062dc20d827df3772dd6f6f7a6f212.png)

昨天发生这种情况时，我已经从头开始了一个项目，因为我认为可能某些项目文件已损坏，但现在它再次发生在另一个项目上。

有什么解决办法吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:42:54.577

控制台指出：

显然这是一个 Xcode 问题，所以我想目前还不能解决这个问题：/

我认为目前唯一的解决方案是降级（尝试使用 Xcode 4.3.1 但仍然是同样的问题）。

真的看不到任何其他选择。

# python - 无法在 virtualenv 中安装下载的包

> ID：10153624
> 
> 赞同：0
> 
> 时间：2012-04-14T12:29:37.250
> 
> 标签：python, virtualenv

我已经下载了一个存储库[Django 类装置](https://github.com/jklaiho/django-class-fixtures)，我想在我的 virtualenv 中使用 python setup.py install 安装它：

```
(test)/tmp/django-class-fixtures $ which python
/home/kuba/.virtualenvs/test/bin/python
(test)/tmp/django-class-fixtures $ python setup.py install
...
Extracting django_class_fixtures-0.8-py2.7.egg to /home/kuba/.virtualenvs/test/lib/python2.7/site-packages
Adding django-class-fixtures 0.8 to easy-install.pth file

Installed /home/kuba/.virtualenvs/test/lib/python2.7/site-packages/django_class_fixtures-0.8-py2.7.egg
Processing dependencies for django-class-fixtures==0.8
Finished processing dependencies for django-class-fixtures==0.8
(test)/tmp/django-class-fixtures $ 
```

但是除了 egg 什么都没有安装：

```
(test)/tmp/django-class-fixtures $ cdvirtualenv
(test)/home/kuba/.virtualenvs/test $ cd lib/python2.7/site-packages
(test)/home/kuba/.virtualenvs/test/lib/python2.7/site-packages $ ls
django                               PIL
Django-1.4-py2.7.egg-info            PIL.pth
django_class_fixtures-0.8-py2.7.egg  pip-1.1-py2.7.egg
easy-install.pth                     setuptools-0.6c11-py2.7.egg
IPython                              setuptools.pth
ipython-0.12-py2.7.egg-info
(test)/home/kuba/.virtualenvs/test/lib/python2.7/site-packages $ 
```

你有什么想法吗？

编辑：我想从 shell 导入 class_fixtures 例如：

```
(test)/home/kuba/.virtualenvs/test/lib/python2.7/site-packages $ ipython
Python 2.7.2+ (default, Oct  4 2011, 20:06:09) 
Type "copyright", "credits" or "license" for more information.

IPython 0.11 -- An enhanced Interactive Python.
?         -> Introduction and overview of IPython's features.
%quickref -> Quick reference.
help      -> Python's own help system.
object?   -> Details about 'object', use 'object??' for extra details.

In [1]: import class_fixtures
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
/home/kuba/.virtualenvs/test/lib/python2.7/site-packages/<ipython-input-1-6a049da89661> in <module>()
----> 1 import class_fixtures

ImportError: No module named class_fixtures

In [2]: 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:11:07.120

问题不在于没有安装包，而是 IPython 忽略了您的 virtualenv 中的包，如此[处](https://stackoverflow.com/a/7391654/679254)所述。我想你会发现用 just 启动一个交互式 shell`python`可以让你很好地导入所有东西。

要让 IPython 识别站点包，请将类似这样的内容放在一个名为`~/.ipython/profile_default/startup/00-virtualenv.py`或类似的文件中：

```
from __future__ import print_function
import site
from os import environ
from os.path import join
from sys import version_info

if 'VIRTUAL_ENV' in environ:
    virtual_env = join(
        environ.get('VIRTUAL_ENV'),
        'lib',
        'python%d.%d' % version_info[:2],
        'site-packages'
    )
    site.addsitedir(virtual_env)
    print('VIRTUAL_ENV ->', virtual_env)
    del virtual_env
    del site, environ, join, version_info 
```

# c# - Quartz.Net Cron 表达式为每月、每周和每日

> ID：10153627
> 
> 赞同：3
> 
> 时间：2012-04-14T12:30:04.807
> 
> 标签：c#, quartz-scheduler, quartz.net, crontrigger, cronexpression

我对quartz.net 和cron 表达式很陌生，我必须在c# dotnet 应用程序中创建一个quartz.net 调度程序，它应该根据从数据库中获取的值在每月、每周和每天执行。

具有调度详细信息的表。

```
Id EffectiveDate  StartTime  Frequency  
 1  2012-04-22      20:55      Daily       
 2  2012-04-22      10:12      Weekly     
 3  2012-04-22      17:00      Daily   
 4  2012-04-23      02:15      Monthly   
 5  2012-04-26      18:30      Daily        
 6  2012-04-27      11:45      Weekly 
```

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T06:36:20.820

@ user1301587，希望你找到了前进的道路，但我注意到你的问题在谷歌上仍然很高，所以我会继续添加一些伪代码来说明我将如何做到这一点：

1.  从您的数据源中获取时间表（在您的情况下看起来像一个 RDBMS 数据库表）
2.  遍历计划列表并使用计划构建 CronScheduleBuilder 的实例：

    string cronExpression = string.Format("{0} {1} {2} {3} {4} {5}", secondPart, minutePart, hourPart, dayOfMonthPart, monthPart, dayOfWeekPart );

    ```
    IScheduleBuilder scheduleBuilder = CronScheduleBuilder
                    .CronSchedule(cronExpression)
                    .InTimeZone(TimeZoneInfo.Utc); 
    ```

例如 cron 表达式**0 26 6 * * ?** 每周每天早上 6:26 运行您的工作 我发现的一个问题是，如果您不指定时区，Quartz 将根据您当前的时区应用转换以将指定时间转换为 UTC 时间

现在您可以使用上面构建的时间表构建触发器：

```
ICronTrigger trigger = (ICronTrigger)TriggerBuilder.Create()
                .WithIdentity("TestTrigger")
                .WithSchedule(scheduleBuilder)
                .Build(); 
```

使用[THIS](http://www.cronmaker.com/)站点构建 Quart.Net 风格的表达式

# java - 如何从 HashMap 中检索 List 对象并在免费标记模板中迭代？

> ID：10153628
> 
> 赞同：4
> 
> 时间：2012-04-14T12:30:31.460
> 
> 标签：java, freemarker

`org.w3c.dom.Element`我有一个 Java Hashmap 对象，它以:的形式存储键值对`java.util.ArrayList`。填充后`HashMap`，我将它与 List of 一起放入 Freemarker 上下文中`org.w3c.dom.Element`。

当我尝试使用下面的代码片段获取 List 对象时

```
<#list ElementList as key>
<#assign fh =ElemmentListMap>
  ${fh[key]}
</#list> 
```

它说`${fh[key]}`是未定义的。请让我如何获得解决方案或随时提供其他解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T14:46:50.093

**更新：**从 2.3.22 开始，您应该只使用`?api`来解决这个问题。有关详细信息，请参阅[此答案](https://stackoverflow.com/a/28794648/606679)或[此常见问题解答条目](http://freemarker.org/docs/app_faq.html#faq_nonstring_keys)。

**旧答案：**

问题的根源在于 FreeMarker 模板语言没有`Map`Java 类型的等价物。相反，它有一种称为“hash”的类型，类似于 a `Map`，但它只支持字符串键（最初是变量名）。所以当它看到 时`fh[key]`，它会假设`key`有一个字符串值（在这种情况下，这将是`key.toString()`由于 POJO 的包装方式的结果），因此不会找到该项目。所以解决方案不是使用`[]`非字符串键的操作符，而是使用 Java API `Map.get(Object key)`，.

**其余的都过时了...**

但是，如果您尝试这样做，您将遇到另一个障碍：默认`ObjectWrapper`不公开`Map`-s 的方法，因为`Map`已经填充了相同的名称空间的字符串键。由于各种其他原因，我也讨厌默认`ObjectWrapper`设置，所以我总是这样设置 FreeMarker：

```
BeansWrapper wrapper = new BeansWrapper();
wrapper.setSimpleMapWrapper(true);
cfg.setObjectWrapper(wrapper); 
```

使用此包装器，您可以使用`Map`-s as`myMap[someStringKey]`或 as `myMap(whateverKey)`。所以在你的情况下它会是`${fh(key)}`。同样，这不适用于默认的`ObjectWrapper`.

更糟糕的是，我看到您在这里使用的是 W3C DOM。上面的包装器不会`Node`以某种方式自动包装 -s 以便您可以使用 FreeMarker XML 功能。因此，如果您需要，除非您总是手动包装 DOM 节点，否则您将不得不扩展`BeansWrapper`以识别 DOM 节点。幸运的是，这很简单：

```
public class MyObjectWrapper extends freemarker.ext.beans.BeansWrapper {

    public TemplateModel wrap(Object obj) throws TemplateModelException {
        if (obj instanceof org.w3c.dom.Node) {
           return freemarker.ext.dom.NodeModel.wrap((org.w3c.dom.Node) obj);
        } else {
           return super.wrap(obj);
        }
    }

} 
```

如果您使用 FreeMarker 的环境已经有一个自定义的`ObjectWrapper`. 在这种情况下，你最好尝试以某种方式扩展它......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-01T15:56:45.623

你的**java代码**应该是：

```
Map map = new HashMap();
List list = new ArrayList();
list.add("red");
list.add("green");
list.add("blue");
map.put("array_list", list); 
```

**freemarker 模板**应该是：

```
<#list array_list as i>
    ${i}
</#list> 
```

**输出**：

```
red
green
blue 
```

# php - Actionscript 从 php 加载外部声音文件并从 php 响应中找出实际文件名？

> ID：10153630
> 
> 赞同：0
> 
> 时间：2012-04-14T12:30:42.220
> 
> 标签：php, flash, audio, actionscript, filenames

我加载外部声音的 as3 代码：

```
var s:Sound = new Sound(); 
s.addEventListener(Event.COMPLETE, onSoundLoaded); 
var req:URLRequest = new URLRequest("getfile.php"); 
s.load(req); 

function onSoundLoaded(event:Event):void 
{ 
    var localSound:Sound = event.target as Sound; 
    localSound.play(); 
} 
```

然后我的php代码返回文件：

```
header('Content-Description: File Transfer');
header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment; filename='.basename($file));
header('Content-Transfer-Encoding: binary');
header('Expires: 0');
header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
header('Pragma: public');
header('Content-Length: ' . filesize($file));
ob_clean();
flush();
readfile($file);
exit; 
```

在 onSoundLoaded 事件中，我如何从 php 响应中获取实际的文件名返回？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T16:22:50.183

他们解决问题的方法是使用 URLLoader [http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLLoader.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLLoader.html)来加载数据，而不是使用 Sound 类。这是因为您可以收听包装响应标头的 HTTPStatusEvent.HTTP_RESPONSE_STATUS - [http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLLoader.html#event:httpResponseStatus](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLLoader.html#event:httpResponseStatus)事件（其中包括文件名）。事件完成的侦听器可以像在您的代码中一样不加修改地使用，因为它返回相同的数据。

```
 var loader : URLLoader = new URLLoader();
    loader.addEventListener(Event.COMPLETE, onSoundLoaded); 
    loader.addEventListener(HTTPStatusEvent.HTTP_RESPONSE_STATUS, onStatusResonse);
    var req:URLRequest = new URLRequest("getfile.php"); 
    s.load(req); 

    function onStatusResonse(event:HTTPStatusEvent):void 
    { 
       var headers:Array = event.responseHeaders;
       // iterate on headers to get the header with the filename
    }

   function onSoundLoaded(event:Event):void 
    { 
       var localSound:Sound = event.target as Sound; 
       localSound.play(); 
    } 
```

该解决方案并不完全是您想要的（在 onSoundLoaded 函数中查找文件名），但我认为这是最好的方法。希望能帮助到你

# php - 为什么相同的单个结果循环多次？

> ID：10153634
> 
> 赞同：0
> 
> 时间：2012-04-14T12:31:13.217
> 
> 标签：php, mysql, html

有多个博客条目，每个条目都应显示一次。有一个“评论”链接可以显示和隐藏每个博客条目的评论。我不明白为什么相同的第一个结果不断出现。每次我添加新评论时都会发生这种情况（目前有 5 条，博客部分显示 5 次，每次只显示第一条评论）。根据用户是否登录“评论”链接，显示登录链接或（如果已登录）表单字段以提交评论。

```
<?php
$conn = mysql_connect("...", "...", "...");
mysql_select_db("...");
$result  = mysql_query("select * from blog");
$result2 = mysql_query("select * from blogcomment where blog.ID = blogcomment.blogID");
$i       = 1;
while ($row = mysql_fetch_array($result))
{
    echo "<h1>$row[title]</h1>";
    echo "<p class ='second'>$row[blog_content]</p> ";
    echo "<p class='meta'>Posted by .... &nbsp;&bull;&nbsp; $row[date] &nbsp;&bull;&nbsp; <a href='#' onclick=\"toggle_visibility('something$i'); return false\">Comments</a><div id='something$i' style='display: none;'><p class='third' >";
    $i++;

    while ($row = mysql_fetch_array($result2))
    {
        echo "$row[commentdate] &nbsp;&bull;&nbsp; $row[username]</p><p>said:</p> <p>$row[comment]</p>";
        if (isset ($_SESSION["gatekeeper"])) {
            echo '<form method="post" action="postcomment.php"><input name="ID" type = "hidden" value = "' . $row[ID] . '" /><input name="comment" id="comment" type="text" style="margin-left:20px;"/><input type="submit" value="Add comment" /></form></div>';
        }
        else {
            echo '<p class="third"><a href="register.html">Signup </a>to post a comment</p></div>';
        }
    }
}
mysql_close($conn);
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T12:38:53.927

```
$i = 1; 
while($row = mysql_fetch_array($result))
{ 
```

# asp.net - ScriptManager.RegisterClientScriptBlock 找不到我的函数 ASP.NET

> ID：10153635
> 
> 赞同：1
> 
> 时间：2012-04-14T12:31:21.050
> 
> 标签：asp.net, scriptmanager

我有一个母版页，我使用 Baslik.aspx，并且在 Baslik.aspx 页面中有我的脚本。

我想从后面的代码中调用 Baslik.aspx 中的一个函数。我可以在 firebug 控制台上看到我的函数。如何修复它？

这是 cs 中的调用函数：

```
ScriptManager.RegisterClientScriptBlock(this, this.GetType(), "test", string.Format("SetPageWidth('{0}');", widthValue), true); 
```

这是我的 Baslik.aspx 代码：

```
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server
.
.
.
    <script type="text/javascript">   
   .
   .
   .
     function SetPageWidth(width) {
            console.log(width);
            $('.page').css("width", width);
            $('body').css("height", "auto");
        }
   </script>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T03:09:09.557

你试过这个：

```
ScriptManager.RegisterClientScriptBlock(this.Page, this.Page.GetType(), "test", string.Format("SetPageWidth('{0}');", widthValue), true); 
```

# android - Android ArrayAdapter getView 问题以避免多次调用

> ID：10153637
> 
> 赞同：0
> 
> 时间：2012-04-14T12:31:34.637
> 
> 标签：android, listview, android-arrayadapter

作为我的第一个 Android 项目，我正在创建一个应用程序，允许用户显示来自 Magic The Gathering 集换式卡牌游戏的卡片。

我在我的 ArrayAdapter 中遇到了一个问题，它在列表视图中显示了一组卡片（根据版本）。

我正在读取一个看起来像这样的字符串，例如：{2}{B}{B} 并为每个字符创建 ImageViews.. 我将这些 ImageViews 添加到列表中的 LinearLayout 显示中。

问题是每次调用 getView() 时都会调用该过程，因此只要我向下滚动列表，ImageView 的数量就会不断增加。我希望一劳永逸地调用该程序。

任何帮助都会非常友好。如果您需要更多信息，请不要犹豫。

谢谢！鲁兹

```
package rudy.jaumain.mtgdb;

import java.util.ArrayList;

import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.content.Context;
import android.widget.TextView;
import android.graphics.Color;

public class MTGSetListAdapter extends ArrayAdapter<MTGCard> {

    private ArrayList<MTGCard> set;

    public MTGSetListAdapter(Context c, int resource, int textViewResourceId, ArrayList<MTGCard> set){
        super(c, resource, textViewResourceId, set);
        this.set = set;
    }

    static class ViewHolder{
        TextView name;
        ImageView rarity;
        LinearLayout manacost;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        ViewHolder holder;
        if(convertView == null){
            convertView = super.getView(position, convertView, parent);
            System.out.println("CONVERTVIEW IS NULL");
            holder = new ViewHolder();

            holder.name = (TextView)convertView.findViewById(R.id.editionlist_item_name);
            holder.rarity = (ImageView)convertView.findViewById(R.id.editionlist_item_rarity);
            holder.manacost = (LinearLayout)convertView.findViewById(R.id.editionlist_item_manacost); 

            convertView.setTag(holder);
        }
        else{
            System.out.println("CONVERTVIEW IS NOT NULL");
            holder = (ViewHolder)convertView.getTag();
        }

        MTGCard currentCard = this.set.get(position);
        if(currentCard != null){
            holder.name.setText(currentCard.getName());
            holder.name.setTextColor(Color.BLACK);
            //Manacost example : {2}{B}{B}
            String manacostStr = currentCard.getManacost();     
            int i=0;
            String currentMana = null;
            while(i < manacostStr.length()){
                char currentChar = manacostStr.charAt(i);
                if(currentChar == '{'){
                    currentMana = null;
                }
                else
                {
                    if(currentChar == '}'){
                        ImageView iv = new ImageView(getContext());
                        int idMana = getContext().getResources().getIdentifier("mana_"+currentMana.toLowerCase(), "drawable", getContext().getPackageName());
                        iv.setImageResource(idMana);
                        iv.setAdjustViewBounds(true);
                        holder.manacost.addView(iv);
                        currentMana = null;
                    }
                    else{
                        if(currentMana == null){
                            currentMana = String.valueOf(currentChar);
                        }
                        else{
                            currentMana += String.valueOf(currentChar);
                        }
                    }
                }
                i++;
            }

            String rarityStr = currentCard.getRarity().toLowerCase();
            int id = this.getContext().getResources().getIdentifier("rarity_"+rarityStr, "drawable", this.getContext().getPackageName());
            holder.rarity.setImageResource(id);
            /* COLOR SYMBOLS TO HANDLE LISTVIEW_ITEM BACKGROUNDCOLOR
             * 
             * Colored artifacts are not handled for now as : AG --> O
             * 
             * L : Land
             * B : Black
             * R : Red
             * W : White
             * G : Green
             * U : Blue
             * A : Artifact
             * O : Gold (2 colors or more)
             * C : DoubleSided Cards Back
             */
            boolean posIsPair = (position %2 == 0);
            int c;
            char color = '\0';
            if(currentCard.getColor().length()>1){
                if(currentCard.getColor().charAt(0) == 'A'){
                    color = currentCard.getColor().charAt(1);
                }
                else color = 'O';
            }
            else{
                color = currentCard.getColor().charAt(0);
            }
            switch(color){
            case 'L' :
                if(posIsPair)c = R.color.L1;
                else c = R.color.L2;
                break;
            case 'B' :
                if(posIsPair)c = R.color.B1;
                else c = R.color.B2;
                break;
            case 'R' :
                if(posIsPair)c = R.color.R1;
                else c = R.color.R2;
                break;
            case 'W' :
                if(posIsPair)c = R.color.W1;
                else c = R.color.W2;
                break;
            case 'G' :
                if(posIsPair)c = R.color.G1;
                else c = R.color.G2;
                break;
            case 'U' :
                if(posIsPair)c = R.color.U1;
                else c = R.color.U2;
                break;
            case 'A' :
                if(posIsPair)c = R.color.A1;
                else c = R.color.A2;
                break;
            case 'O' :
                if(posIsPair)c = R.color.O1;
                else c = R.color.O2;
                break;  
            case 'C' :
                c = Color.TRANSPARENT;
                break;  
            default :
                c = Color.TRANSPARENT;
                break;
            }
            convertView.setBackgroundColor(this.getContext().getResources().getColor(c));
        }
        return convertView;

    }

    @Override
    public int getCount() {
        return set.size();
    }

    @Override
    public MTGCard getItem(int arg0) {
        return set.get(arg0);
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:59:29.463

ListView 及其适配器尝试创建足够多的视图来支持在屏幕上或滚动时可见的列表元素。您可能在 ListView 中有数百个对象，但并非所有对象都始终附加到视图。调用时`getView()`，如果已经创建了足够多的视图对象，则该`convertView`参数将为您提供其中一个以重新填充`position`参数指定的行。

这些视图对象不仅会填充您存储在 ViewHolder 类中的视图，还会填充附加到它们的任何子视图。

因此，在您的“convertview 不为空”的情况下，您可能希望删除所有属于`holder.manacost`. （只有在 convertView 中提供给您的预先存在的视图层次结构的状态与您在代码的 null convertView 分支中创建的视图相同时，您的代码才能正常工作。）

或者，虽然这会更复杂，但在重新填充 manacost 视图时重用这些 ImageView 对象可能是合适的。

# java - 使用 dropbox java api 上传二进制文件

> ID：10153640
> 
> 赞同：1
> 
> 时间：2012-04-14T12:31:59.953
> 
> 标签：java, file-upload, dropbox

您能否指出一个代码或 url，我可以在其中找到一些示例如何使用 dropbox java api 并上传二进制文件，如 .doc 文件、jpg 和视频文件。

当前网络中的示例仅指向上传文本文件。但是，当我尝试使用 java InputStream 读取文件并将它们转换为字节数组并传递到保管箱文件上传函数时，文件会损坏。下载文件也有同样的问题。提前致谢。

问候，瓦鲁纳。

编辑——代码示例

```
FileInputStream fis = new FileInputStream(file);
ByteArrayOutputStream bos = new ByteArrayOutputStream();
byte [] buf = new byte[1024];
for(int readNum; (readNum = fis.read(buf)) != -1;) {
    bos.write(buf, 0, readNum);
    System.out.println("read "+ readNum + "bytes,");
}

ByteArrayInputStream inputStream2 = new ByteArrayInputStream(bos.toByteArray());

Entry newEntry = mDBApi.putFile("/uploads/"+file.getName(), inputStream2, file.toString().length(), null, null);
System.out.println("Done. \nRevision of file: " + newEntry.rev + " " + newEntry.mimeType);
return newEntry.rev; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T00:01:59.167

的第三个参数`DropboxAPI.putFile()`应该是从输入流中读取的字节数 - 您正在传递文件名的长度。

代替

```
Entry newEntry = mDBApi.putFile("/uploads/"+file.getName(), inputStream2,
            file.toString().length(), null, null); 
```

采用

```
Entry newEntry = mDBApi.putFile("/uploads/"+file.getName(), inputStream2,
            bos.size(), null, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T17:35:53.447

我认为您不需要转换为字节数组，只需使用 FileInputStream 就足以处理文件、txt 和二进制文件。以下代码有效，我只是用 JPG 测试过。

```
 DropboxAPI<?> client = new DropboxAPI<WebAuthSession>(session);

    FileInputStream inputStream = null;
    try {
        File file = new File("some_pic.jpg");
        inputStream = new FileInputStream(file);
        DropboxAPI.Entry newEntry = client.putFile("/testing.jpg", inputStream,
                file.length(), null, null);
        System.out.println("The uploaded file's rev is: " + newEntry.rev);
    } catch (DropboxUnlinkedException e) {
        // User has unlinked, ask them to link again here.
        System.out.println("User has unlinked.");
    } catch (DropboxException e) {
        System.out.println("Something went wrong while uploading.");
    } catch (FileNotFoundException e) {
        System.out.println("File not found.");
    } finally {
        if (inputStream != null) {
            try {
                inputStream.close();
            } catch (IOException e) {}
        }
    } 
```

# android - 当我设置按钮的背景颜色时，它的边缘消失了

> ID：10153641
> 
> 赞同：1
> 
> 时间：2012-04-14T12:32:03.590
> 
> 标签：android, button, android-widget

我在我的应用程序中使用默认的 android 按钮。但是当我设置它的背景颜色时，它的边缘会消失

# javascript - 为什么在 JavaScript 中使用“const”构造是一种不好的做法？

> ID：10153642
> 
> 赞同：3
> 
> 时间：2012-04-14T12:32:08.777
> 
> 标签：javascript, google-style-guide

在 Google Style guide for JavaScript 编写（[证明链接](http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml?showone=Constants#Constants)）中，使用“const”构造是一种不好的做法，为什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-14T12:34:03.667

因为它不是标准的（还）。这是一个[JavaScript 1.5 关键字](https://developer.mozilla.org/en/JavaScript/Reference/Statements/const)，而不是 ECMAScript。来自 MDN 文档：

> 当前的实现`const`是 Mozilla 特定的扩展，不是 ECMAScript 5 的一部分。它在 Firefox 和 Chrome (V8) 中受支持，在 Opera 9+ 和 Safari 中得到部分支持。Internet Explorer 6-9 或 Internet Explorer 10 的预览版不支持它。`const`关键字当前在函数范围内声明常量（如用 var 声明的变量）。

此外，如果您仔细阅读链接到的部分，最后一句话是：

> 至于`const`关键字，Internet Explorer 不解析它，所以不要使用它。

# java - 工作/任务窃取 ThreadPoolExecutor

> ID：10153646
> 
> 赞同：8
> 
> 时间：2012-04-14T12:32:36.227
> 
> 标签：java, threadpool, executor, work-stealing

在我的项目中，我正在构建一个 Java 执行框架，用于接收来自客户端的工作请求。工作（不同大小）被分解为一组任务，然后排队等待处理。有单独的队列来处理每种类型的任务，并且每个队列都与一个 ThreadPool 相关联。ThreadPools 的配置方式使得引擎的整体性能是最佳的。

这种设计有助于我们有效地对请求进行负载平衡，并且大型请求最终不会占用系统资源。但是，有时当某些队列为空并且它们各自的线程池处于空闲状态时，该解决方案变得无效。

为了更好地做到这一点，我正在考虑实施一种工作/任务窃取技术，以便负载重的队列可以从其他线程池中获得帮助。但是，这可能需要实现我自己的 Executor，因为 Java 不允许多个队列与 ThreadPool 相关联，并且不支持工作窃取概念。

阅读有关 Fork/Join 的信息，但这似乎不适合我的需求。构建此解决方案的任何建议或替代方法都可能非常有帮助。

谢谢安迪

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-02-20T14:37:59.607

# `Executors.newWorkStealingPool`

Java 8 在类中有工厂和实用方法[`Executors`](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html)：[`Executors.newWorkStealingPool`](http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html#newWorkStealingPool--)

这是一个工作窃取线程池的实现，我相信，这正是你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T13:02:14.107

你考虑过[ForkJoinPool](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ForkJoinPool.html)吗？fork-join 框架以一种很好的模块化方式实现，因此您可以只使用工作窃取线程池。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T12:50:32.780

你可以实现一个自定义的 BlockingQueue 实现（我认为你主要需要实现`offer()`and`take()`方法），它由一个“主”队列和 0 个或多个辅助队列支持。如果非空，take 将始终从主后备队列中获取，否则它可以从辅助队列中拉取。

事实上，最好有 1 个池，所有工作人员都可以访问所有队列，但“更喜欢”特定队列。您可以通过为不同的工人分配不同的优先级来得出最佳的工作比例。在一个满载的系统中，您的工人应该以最佳比例工作。在负载不足的系统中，您的工作人员应该能够帮助处理其他队列。

# sql - SQL Server 中事务的正确使用

> ID：10153648
> 
> 赞同：268
> 
> 时间：2012-04-14T12:33:09.463
> 
> 标签：sql, sql-server, database, tsql, transactions

我有 2 个命令，需要它们都正确执行或都不执行。所以我想我需要一个事务，但我不知道如何正确使用它。

以下脚本有什么问题？

```
BEGIN TRANSACTION [Tran1]

INSERT INTO [Test].[dbo].[T1]
    ([Title], [AVG])
VALUES ('Tidd130', 130), ('Tidd230', 230)

UPDATE [Test].[dbo].[T1]
  SET [Title] = N'az2' ,[AVG] = 1
  WHERE [dbo].[T1].[Title] = N'az'

COMMIT TRANSACTION [Tran1]
GO 
```

命令执行了`INSERT`，但是`UPDATE`命令有问题。

如果它们中的任何一个在执行中出现错误，我该如何实现它来回滚这两个命令？

* * *

## 回答 #1

> 赞同：582
> 
> 时间：2012-04-14T12:41:31.243

添加一个 try/catch 块，如果事务成功则提交更改，如果事务失败则回滚事务：

```
BEGIN TRANSACTION [Tran1]

  BEGIN TRY

      INSERT INTO [Test].[dbo].[T1] ([Title], [AVG])
      VALUES ('Tidd130', 130), ('Tidd230', 230)

      UPDATE [Test].[dbo].[T1]
      SET [Title] = N'az2' ,[AVG] = 1
      WHERE [dbo].[T1].[Title] = N'az'

      COMMIT TRANSACTION [Tran1]

  END TRY

  BEGIN CATCH

      ROLLBACK TRANSACTION [Tran1]

  END CATCH 
```

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2012-04-14T12:43:09.760

在存储过程开始时，应[设置 SET XACT_ABORT ON](https://msdn.microsoft.com/en-us/library/ms188792.aspx)以指示 Sql Server 在出现错误时自动回滚事务。如果省略或设置为 OFF，则需要在每个语句之后测试[@@ERROR或使用](http://msdn.microsoft.com/en-us/library/aa933181%28v=sql.80%29.aspx)[TRY ... CATCH 回滚](http://msdn.microsoft.com/en-us/library/ms175976.aspx)块。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2015-10-17T02:07:08.303

简单的方法：

```
CREATE TABLE T
(
    C [nvarchar](100) NOT NULL UNIQUE,
);

SET XACT_ABORT ON -- Turns on rollback if T-SQL statement raises a run-time error.
SELECT * FROM T; -- Check before.
BEGIN TRAN
    INSERT INTO T VALUES ('A');
    INSERT INTO T VALUES ('B');
    INSERT INTO T VALUES ('B');
    INSERT INTO T VALUES ('C');
COMMIT TRAN
SELECT * FROM T; -- Check after.
DELETE T; 
```

# c++ - C++派生类数组重新分配

> ID：10153652
> 
> 赞同：1
> 
> 时间：2012-04-14T12:33:42.010
> 
> 标签：c++, realloc, derived

很抱歉混淆了这个话题，这是最初的问题：

> 如何重新分配指向基类的指针数组，实际上指向不同的派生类？

如果可能的话，我不应该在这里使用动态转换、typeid 或 RTTI ..

**编辑**我刚刚意识到我可以尝试保存数组元素并将新数组中的指针设置为旧元素.. 但是如何操作 operator= 或 Cctor？

或者：

> 如何通过实际复制元素来重新分配这个数组“不好的方式”？

一个例子：

```
class Base {...}
class Derived1 : public Base {...}
class Derived2 : public Base {...}

int main()
{
  int arrayLength=0, arrayMaxLength=3;

  Base **array=new Base*[arrayMaxlength];
  array[0]=new Derived1();
  array[1]=new Derived2();

  //Reallocation starts...
  Base **tmp=new Base*[arrayMaxLength*=2];

  for(int i=0;i<arrayLength;i++)
    tmp[i]=new Base(*array[i]);      //<------ What to put here instead of Base?

  //The unimportant rest of Reallocation..
  for(int i=0;i<arrayLength;i++)
    delete array[i];
  delete [] array;
  array=tmp;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:36:45.847

您不需要进行任何转换（动态或其他）：只需重用指针

```
Base **array=new Base*[arrayMaxlength]; 
array[0]=new Derived1(); 
array[1]=new Derived2(); 

//Reallocation starts... 
Base **tmp=new Base*[arrayMaxLength*=2]; 

for(int i=0;i<arrayLength;i++) 
  tmp[i]=array[i]; 

// ... 
```

对象已分配并具有正确的类型。您可以将指针本身复制到新数组。

**请注意**，您必须注意不要`delete`使用旧数组中的（指向的对象）指针，因为这会使新数组中的指针无效（存储的指针指向的对象不再存在）-只需删除原始数组本身。

如果指针的管理变得繁琐，您可以使用某种共享指针（例如，BOOST 库提供了多种）

# c++ - 基于范围的临时对象

> ID：10153658
> 
> 赞同：18
> 
> 时间：2012-04-14T12:34:22.940
> 
> 标签：c++, qt, c++11

我知道，一般来说，基于范围的`for`循环中临时对象的生命周期会扩展到整个循环（我读过[C++11：基于范围的 for 语句：“range-init”生命周期？](https://stackoverflow.com/questions/9657708/c11-the-range-based-for-statement-range-init-lifetime)）。因此，做这样的事情通常是可以的：

```
for (auto &thingy : func_that_returns_eg_a_vector())
  std::cout << thingy; 
```

现在，当我尝试做一些我认为与 Qt`QList`容器相似的事情时，我遇到了内存问题：

```
#include <iostream>
#include <QList>

int main() {
  for (auto i : QList<int>{} << 1 << 2 << 3)
    std::cout << i << std::endl;
  return 0;
} 
```

这里的问题是 valgrind 在`QList`类内的某处显示无效的内存访问。但是，修改示例以将列表存储在变量中会提供正确的结果：

```
#include <iostream>
#include <QList>

int main() {
  auto things = QList<int>{} << 1 << 2 << 3;
  for (auto i : things)
    std::cout << i << std::endl;
  return 0;
} 
```

现在我的问题是：我是否在第一种情况下做一些愚蠢的事情导致例如未定义的行为（我没有足够的经验阅读 C++ 标准来为自己回答这个问题）？或者这是我如何使用`QList`或如何`QList`实施的问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-14T12:56:53.827

由于您使用的是 C++11，[因此您可以改用初始化列表](http://doc-snapshot.qt-project.org/5.0/qlist.html#QList-3)。这将通过 valgrind：

```
int main() {
  for (auto i : QList<int>{1, 2, 3})
    std::cout << i << std::endl;
  return 0;
} 
```

* * *

该问题与基于范围的 for 甚至 C++11 并不完全相关。下面的代码演示了同样的问题：

```
QList<int>& things = QList<int>() << 1;
things.end(); 
```

或者：

```
#include <iostream>

struct S {
    int* x;

    S() { x = NULL; }
    ~S() { delete x; }

    S& foo(int y) {
        x = new int(y);
        return *this;
    }
};

int main() {
    S& things = S().foo(2);
    std::cout << *things.x << std::endl;
    return 0;
} 
```

无效读取是因为表达式`S()`(or `QList<int>{}`) 中的临时对象在声明后被破坏（遵循 C++03 和 C++11 §12.2/5），因为编译器不知道方法`foo()`(or `operator<<`) 将返回那个临时对象。所以你现在指的是释放内存的内容。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-14T13:10:58.173

编译器不可能知道作为三个调用结果的引用`operator <<`绑定到临时对象`QList<int>{}`，因此临时对象的生命周期不会延长。编译器不知道（也不能期望知道）函数的返回值，除了它的类型。如果它是一个引用，它不知道它可能绑定到什么。我很确定，为了适用延长生命的规则，绑定必须是直接的。

这应该有效，因为该列表不再是临时的：

```
#include <iostream>
#include <QList>

int main() {
  auto things = QList<int>{};
  for (auto i : things << 1 << 2 << 3)
    std::cout << i << std::endl;
  return 0;
} 
```

这应该有效，因为绑定是直接的，因此可以应用规则：

```
#include <iostream>
#include <QList>

int main() {
  for (auto i : QList<int>{1, 2, 3})
    std::cout << i << std::endl;
  return 0;
} 
```

# html - 添加这个插件......大脑果酱

> ID：10153659
> 
> 赞同：-1
> 
> 时间：2012-04-14T12:34:23.877
> 
> 标签：html, css, sharing, addthis

伙计们，我在这里要头疼了。首先，我在一个网站上工作，一切似乎都在运行。所以，我在制作链接等方面遇到了困难，所以我尝试添加 addthis.com 插件，它会自动完成所有这些。但是，当我补充说一切似乎都崩溃了，所以我做了一个快速的 jsFiddle 来向你展示我想要的东西。在这里： http: [//jsfiddle.net/cSP9Q/1/](http://jsfiddle.net/cSP9Q/1/)问题是我想将这些图标更改为我的，您可以在第一个链接上看到这些图标，我似乎无法更改图标之间的间距。此外，无论如何都可以用计数器删除气泡，因为这看起来很荒谬。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T17:21:35.273

**HTML**

```
<div id="social"><!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style ">
        <a class="addthis_button_preferred_1"><img src="your_image_url" /></a>
        <a class="addthis_button_preferred_2"><img src="your_image_url" /></a>
        <a class="addthis_button_preferred_4"><img src="your_image_url" /></a>
        <a class="addthis_button_google_plusone"><img src="your_image_url" /></a>
        <a class="addthis_button_compact"><img src="your_image_url" /></a>
    </div>
    <!--javascript goes here-->
</div> 
```

[**示例**](http://jsfiddle.net/heera/cSP9Q/2/)和[**参考**](http://support.addthis.com/customer/portal/articles/381236-custom-buttons#different-image)。

**注意：**无论如何，您的链接`http://www.aasingercom.ipage.com/php/`不起作用。

# java - 重新启动 TCP 服务器

> ID：10153661
> 
> 赞同：0
> 
> 时间：2012-04-14T12:34:33.010
> 
> 标签：java, android, networking, tcp

我的 android 应用程序中有一个 TCP 服务器。服务器立即开始运行。单击一个按钮，我想停止服务器，然后单击另一个按钮，再次重新启动服务器。

我的服务器是这样的：

```
serverSocket = new ServerSocket(1292);
while (true) {
 Socket client = serverSocket.accept();            
 ServersClient s = new ServersClient(client);
 Thread clientThread = new Thread(s);
 clientThread.run();
} 
```

我成功地用这段代码处理了关闭：

```
serverSocket.close(); 
```

在此代码之后，没有客户端可以连接。

我现在应该怎么做才能重新启动它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T13:25:54.540

`ServerSocket`监听新的连接。

`Socket`是`serverSocket.accept()`返回的连接实例。

您想关闭`Socket`实例以关闭与特定客户端的连接。关闭`ServerSocket`将解除应用程序与端口的绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:00:38.490

ServerSocket 关闭后无法再次打开。因此，您只需再次执行您的第一个代码片段，从创建一个新的 ServerSocket 实例开始。

# c# - 如何最好地在 C# 中的循环中删除列表项

> ID：10153664
> 
> 赞同：6
> 
> 时间：2012-04-14T12:34:48.447
> 
> 标签：c#, asp.net, list, loops

给定代码：

```
var AllItems = new List<CartItem>();

using(var db = new MainContext())
{
    foreach (var item in AllItems)
    {
        if (!db.tblStoreItems.Where(i => i.ID == item.ItemID).Any())
        {
            AllItems.Remove(item);
        }
    }
} 
```

这是在循环中从 List 对象中删除项目的最佳方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-14T12:39:34.180

我不这么认为。如果您从正在迭代的列表中删除一个项目，结果将是绝对错误的。

最好以相反的顺序使用老式的 for - 循环

```
using(var db = new MainContext()) 
{ 
    for(int x = AllItems.Count - 1; x >= 0; x--) 
    { 
        var item = AllItems[x];
        if (!db.tblStoreItems.Where(i => i.ID == item.ItemID).Any()) 
        { 
            AllItems.RemoveAt(x); 
        } 
    } 
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-14T12:46:13.163

循环方法有几个问题，主要是 - 您无法从当前正在迭代的集合中删除项目`foreach`- 您将遇到异常。

由于您的主要集合是 a `List<T>`，因此您应该使用[`RemoveAll`](http://msdn.microsoft.com/en-us/library/wdka673a.aspx)接受谓词的方法。您还应该像这样简化查询：

```
AllItems.RemoveAll(item => !db.tblStoreItems.Any(i => i.ID == item.ItemID)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T12:43:33.987

正如史蒂夫正确建议的那样（史蒂夫的方式可能是最好的），这是错误的（OP的方法），

我更喜欢将其存储`'those to be removed'`到一个单独的列表中，然后你可以这样做

```
AllItems = AllItems.Except(Items2Remove); 
```

从性能方面来看，这并不是最好的，但对我来说，这会让事情变得更干净——你也可以与 LINQ 枚举结合使用——例如，从记录列表中制作 IEnumerable 等。

希望这有帮助 编辑：只是根据史蒂夫的回应澄清

# visual-studio - 如何在 Visual Studio 或 Parallel Nsight 中调试 CUDA 内核

> ID：10153668
> 
> 赞同：2
> 
> 时间：2012-04-14T12:35:34.817
> 
> 标签：visual-studio, debugging, cuda, gpu, nsight

我在 Win7 x64 上安装了带有 Parallel Nsight 2.1 的 CUDA 4.1 SDK。我想调试我的 CUDA 内核，怎么做？这可以用一个 GPU 实现吗？有一个实用程序 Nsight Monitor。正如 Nsight 监视器告诉我的那样，我已经尝试过了，首先在 Windows 上禁用了超时检测和恢复，然后禁用了 WPF。我在VS中设置了一个断点，运行代码但没有任何反应。Nsight 监视器说我已连接。那么我可以在 VS 中调试还是在 Parallel Nsight 中调试？如何？太感谢了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T20:08:24.350

如果您只有一个 GPU，那么您将无法使用 Parallel Nsight 2.1 进行调试，因为停止 GPU 会停止显示（Nsight 会阻止您这样做）。借助 Parallel Nsight 2.2（[现已提供](http://developer.nvidia.com/content/nvidia-parallel-nsight-22-rc1-now-available-0)候选版本），您现在可以使用单个 GPU 进行本地调试。

所以你在正确的轨道上（禁用 TDR/WPF 等），但你需要更新到 Parallel Nsight 2.2 才能使用单个 GPU 进行调试。

# asp.net - Microsoft 重写模块 - 在 url 上强制 www 或从 url 中删除 www

> ID：10153670
> 
> 赞同：14
> 
> 时间：2012-04-14T12:35:36.817
> 
> 标签：asp.net, iis-7, url-rewriting, web-config, url-rewrite-module

我有一个与 Windows Server 2008 和 IIS7.5 共享的托管计划，并且安装并启用了 Microsoft 重写模块。

```
<rewrite>
    <rules>
        <rule name="myRule" patternSyntax="Wildcard">
            <!--Rewriting code-->
        </rule>
    </rules>
</rewrite> 
```

那么，如何使用 Microsoft 重写模块将 mydomain.com/everywhere-in-site/my-page.html 重定向到 www.mydomain.com/everywhere-in-site/my-page.html？

如果我想将 www.mydomain.com/everywhere-in-site/my-page.html 重定向到 mydomain.com/everywhere-in-site/my-page.html 怎么办？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-04-17T14:25:49.263

要从域中删除 www 并重定向到“裸域”，您可以像以下代码片段一样进行操作：

```
<rewrite>
  <rules>
    <rule name="Remove WWW prefix" stopProcessing="true">
      <match url="(.*)" ignoreCase="true" />
      <conditions>
        <add input="{HTTP_HOST}" pattern="^www\.yourdomain\.com$" />
      </conditions>
      <action type="Redirect" url="http://yourdomain.com/{R:1}" redirectType="Permanent" />
    </rule>
  </rules>
</rewrite> 
```

反过来（如果您愿意的话）将非 www 重定向到带有 www 的：

```
<rewrite>
  <rules>
    <rule name="Add WWW prefix" stopProcessing="true">
      <match url="(.*)" ignoreCase="true" />
      <conditions>
        <add input="{HTTP_HOST}" pattern="^yourdomain\.com$" />
      </conditions>
      <action type="Redirect" url="http://www.yourdomain.com/{R:0}" redirectType="Permanent" />
    </rule>
  </rules>
</rewrite> 
```

这`redirectType="Permanent"`当然是可选的，但对于 SEO 和大多数情况，我会推荐它。

另请参阅这些 SO 问题/答案：

*   [IIS7 URL 重写 - 添加“www”前缀](https://stackoverflow.com/questions/2207059/iis7-url-rewrite-add-www-prefix)
*   [转发 http://mydomain.com/ctrlr/act/val 到 http://WWW.mydomain.com/ctrlr/act/val](https://stackoverflow.com/questions/1476934/forwarding-http-mydomain-com-ctrlr-act-val-to-http-www-mydomain-com-ctrlr-ac/1476986#1476986)
*   [使用 IIS URL 重写从地址中删除 www 的正确方法](https://stackoverflow.com/questions/7368665/proper-method-to-remove-www-from-address-using-iis-url-rewrite)

# android - Android 的 res 目录中的目录禁止名称是什么？

> ID：10153672
> 
> 赞同：3
> 
> 时间：2012-04-14T12:35:48.283
> 
> 标签：android, naming

我最近添加`res/raw/dictionaries/en-GB/wordlist.txt`到我的 Android 项目中。它产生了一个错误。我最终发现目录名称`dictionaries`引起了问题，我将其更改为`dicts`，一切都很好。

为什么不允许使用此名称？其他人不允许吗？是否有不允许的目录名称列表？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T13:42:22.093

在[http://developer.android.com/guide/topics/resources/providing-resources.html](http://developer.android.com/guide/topics/resources/providing-resources.html) 你可以看到：

> 限定符名称规则
> 
> 替代资源目录不能嵌套。例如，你不能有 res/drawable/drawable-en/。

文件夹中不支持嵌套文件`res`夹，只支持文件的线性列表。但是在`assets`文件夹中，您可以在其中放置任意层次的文件夹和文件，因为 assets 文件夹的内容不被视为资源。

你不应该像这样`res/raw/dicts/en-GB/wordlist.txt`，但如果发生这种情况，你可能无法获得 wordlist.txt (R.raw.wordlist) 的资源 ID

assets 文件夹和 raw 文件夹是相似的。两者都可以包含原始文件，但 raw 中的文件被视为资源，而 assets 中的文件则不是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:07:23.857

据我所知，除了Android定义的文件外，您不能放置任何其他文件，我认为您只能将此处定义的文件放置：http: [//developer.android.com/guide/topics/resources/available-resources.html](http://developer.android.com/guide/topics/resources/available-resources.html) 所以令人惊讶的是你可以制作 /dicts ...

# ios5 - 在 phonegap 中使用 iframe 打开 facebook

> ID：10153674
> 
> 赞同：0
> 
> 时间：2012-04-14T12:36:02.010
> 
> 标签：ios5, cordova

我是开发电话间隙应用程序的新手，我在应用程序中有 Facebook 的链接按钮，当点击它时，它应该在 i 框架内打开，因为我使用了以下代码，它不会打开 Facebook

```
<iframe width="100%" height="100%" frameborder="0" scrolling="no" marginheight="0"
     marginwidth="0" src="http://www.facebook.com"></iframe> 
```

我也试过[http://m.facebook.com](http://m.facebook.com)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T07:58:35.353

如果您使用 xCode，您应该将 www.facebook.com 添加到您的外部主机白名单。它在 Cordova.plist/phonegap.plist 文件中。

# android - 缩放位图以适应 854 宽屏幕

> ID：10153683
> 
> 赞同：1
> 
> 时间：2012-04-14T12:36:47.067
> 
> 标签：android, scale, screen-resolution

我开始制作一款游戏，但对屏幕分辨率和密度有些困惑。

我有一个 800 像素宽的图像，并已添加到可绘制的 mdpi 文件夹中。它画得很好，但在 854 像素宽的屏幕上，有 54 像素的间隙。

使图像适合屏幕的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T16:44:58.130

将以下类添加到您的项目中并像这样更改您的布局

**看法**

```
<my.package.name.AspectRatioImageView
    android:layout_centerHorizontal="true"
    android:src="@drawable/my_image"
    android:id="@+id/my_image"
    android:layout_height="wrap_content"
    android:layout_width="fill_parent"
    android:adjustViewBounds="true" /> 
```

**班级**

```
package my.package.name;

import android.content.Context;
import android.util.AttributeSet;
import android.widget.ImageView;

/**
 * ImageView which scales an image while maintaining
 * the original image aspect ratio
 *
 */
public class AspectRatioImageView extends ImageView {

    /**
     * Constructor
     * 
     * @param Context context
     */
    public AspectRatioImageView(Context context) {

        super(context);
    }

    /**
     * Constructor
     * 
     * @param Context context
     * @param AttributeSet attrs
     */
    public AspectRatioImageView(Context context, AttributeSet attrs) {

        super(context, attrs);
    }

    /**
     * Constructor
     * 
     * @param Context context
     * @param AttributeSet attrs
     * @param int defStyle
     */
    public AspectRatioImageView(Context context, AttributeSet attrs, int defStyle) {

        super(context, attrs, defStyle);
    }

    /**
     * Called from the view renderer.
     * Scales the image according to its aspect ratio.
     */
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {

        int width = MeasureSpec.getSize(widthMeasureSpec);
        int height = width * getDrawable().getIntrinsicHeight() / getDrawable().getIntrinsicWidth();
        setMeasuredDimension(width, height);
    }
} 
```

# c# - 如何在 c# 4.0 服务类中使用 Invoke

> ID：10153686
> 
> 赞同：1
> 
> 时间：2012-04-14T12:37:20.687
> 
> 标签：c#, winforms, .net-4.0, windows-services, invoke

我有一个 winforms 应用程序，它正在使用套接字读取字符串，并且套接字位于 backgroundWorker 线程下。

一切正常，但根据新的公司标准，我的经理希望它作为服务运行，而不是将这个 winforms 应用程序始终放在启动文件夹中。

问题是我们在这个 winforms 应用程序中使用下面的代码行

```
Invoke(new MethodInvoker(
                  delegate { _logger.Error((String.Format("Error: {0}", _socketError))); }
                  )); 
```

有人可以指导我在windowserverice项目中使用上面的代码行吗

请建议

谢谢

**更新**：我需要使用调用，因为该语句在 backgroundWorker 组件的 DoWork 事件中运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T12:51:02.613

由于`_logger`只是写入日志文件，所以我不明白最初使用的初衷`Invoke`。我认为您可以安全地将该行替换为：

```
_logger.Error(String.Format("Error: {0}", _socketError)); 
```

# c# - 访问实体框架中未加载的导航属性时是否可以抛出异常？

> ID：10153689
> 
> 赞同：0
> 
> 时间：2012-04-14T12:38:43.913
> 
> 标签：c#, entity-framework

最近我在我的应用程序中关闭了 LazyLoading，因为我希望它能让我更加了解我正在发送的 sql 查询的数量。问题是，当我在尝试访问实体之前忘记在某个地方加载实体时，它只会返回 null（而不是异常）。这意味着我的逻辑错误地假设该值为空，从而导致流程后期出现各种问题。

我知道有 IsLoaded 标志，但首先您必须添加样板代码，其次您仍然可以忘记检查。

是否可以让实体框架在访问未加载的导航属性时自动抛出异常？对我来说这似乎是正确的方法，你为什么要忽略你的实体没有加载的事实，只是让程序继续？

还是我想错了方向？:|

（顺便说一句，EntityCollections 更糟糕，因为它们只是返回一个空列表，就像没有错一样）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:08:52.720

不，没有任何自动方法可以做到这一点。从理论上讲，您可以创建自定义 T4 模板来生成您的实体并签`IsLoaded`入每个属性获取器。如果您想使用 POCO 方法，这对您没有帮助，因为这样的检查会破坏 POCO 规则并使您的实体依赖于 EF。如果您使用`EntityObject`基于实体，您可以尝试这种方法。

# ruby-on-rails - 回形针上传到 Heroku 上的 S3 停止工作

> ID：10153692
> 
> 赞同：2
> 
> 时间：2012-04-14T12:39:00.910
> 
> 标签：ruby-on-rails, heroku, amazon-s3, paperclip

从 4 月 10 日到昨天，我们在 Heroku 上的 Rails 应用程序似乎无法使用 Paperclip 将图像上传到 Amazon S3。我收到以下消息：

```
A AWS::S3::Errors::RequestTimeout occurred in topics#update:
 Your socket connection to the server was not read from or written to within the timeout period. Idle connections will be closed.
 vendor/bundle/ruby/1.9.1/gems/aws-sdk-1.3.9/lib/aws/core/client.rb:277:in `return_or_raise' 
```

我查看了过去 10 天中的代码更改，看看我们是否更改了接近 Paperclip 代码或 Gemfile 的任何内容，但我没有发现任何内容。[Heroku 状态页面](https://status.heroku.com/)不报告任何损坏，[Amazon S3 状态页面](http://status.aws.amazon.com/)也不报告。

有谁知道 Heroku、S3 或它们之间的交互可能与此相关的任何变化？或者非常微妙、看似无关的事情可能会破坏我们的设置？

该应用程序在 Heroku 上的 Cedar 堆栈上运行，使用 Rails 3.2.1、Paperclip 3.0.1、aws-s3 0.6.2 和 aws-sdk 1.3.9。我们的 Gemfile.lock 在[这里](https://gist.github.com/2384124)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T13:08:48.073

`bundle update`成功了。Paperclip、Aws 和 Heroku gems 最近都进行了小更新。

# objective-c - NSThread 线程安全的初始化实现。？

> ID：10153696
> 
> 赞同：0
> 
> 时间：2012-04-14T12:40:04.460
> 
> 标签：objective-c, ios

以下代码按预期编译和执行。

```
#import <objc/objc.h>
#import <Foundation/Foundation.h>

BOOL loopValue = YES;
@interface myThread:NSObject
-(void) enterThread: (NSArray *) elemt count: (NSString *) x;
@end

@implementation myThread
-(void) enterThread : (NSArray *) elemt
{
  NSLog (@" Inside mythread ");
  NSAutoreleasePool *pool =  [[ NSAutoreleasePool alloc] init];
 int i;
int cnt =10;
  for(i=0; i<cnt; i++) {
  NSLog (@"Number of elemennts in array %i ", [elemt count]); 
  [NSThread sleepUntilDate:[NSDate dateWithTimeIntervalSinceNow:1]];
  }

  loopValue = NO; 
  [pool drain];  
}
@end

int main ( int argc, char ** argv)
{
  NSAutoreleasePool *pool = [[ NSAutoreleasePool alloc] init];
  // id tobj = [[myThread alloc] init];
  id tobj = [ myThread new ];
  NSLog (@"Starting New Thread ");
   [NSThread detachNewThreadSelector:@selector(enterThread:)  toTarget:tobj withObject:[NSArray arrayWithObjects:@"ram",@"20",nil]];
  while(1)
  if ( loopValue )
    [NSThread sleepUntilDate:[NSDate dateWithTimeIntervalSinceNow:2]];
   else
      break;

  NSLog (@".. Exiting.. \n");
  [pool drain];
  return 0; 

} 
```

我的问题：

**在编译时**，我确实收到以下警告..

```
mythread.m:24:1: warning: incomplete implementation of class ‘myThread’ [enabled by default] 
```

mythread.m:24:1：警告：'-enterThread:count:' 的方法定义未找到 [默认启用]

**执行时**

```
WARNING your program is becoming multi-threaded, but you are using an ObjectiveC runtime library .... Removed due to redability]hich does not have a thread-safe implementation of the +initialize method. ...... 
```

我错了什么？如何避免警告/运行时错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:58:36.307

你声明的方法是`enterThread:count:`，但你实现的方法是`enterThread:`。此外，您收到的警告，我敢肯定我只是从旧的 GNUstep 运行时中看到的……但我想没有。

# java - 如何将值从会话 bean 传递到 JSF inputText？

> ID：10153698
> 
> 赞同：0
> 
> 时间：2012-04-14T12:40:25.833
> 
> 标签：java, jsf

我在 JSF 中有一个 inputText 对象，比如说 inputText_A，它的值绑定到会话 Bean 对象的成员变量。它是双重类型。

```
<h:inputText value="#{theBean.theMemberVar}" /> 
```

并且这个 inputText_A 已经被初始化为 0.0。当 Bean 执行计算时，该值将更新回 Bean.theMemberVar。我已经在调试控制台中对其进行了跟踪，并且该值已更新为我的预期值。但是屏幕上的 inputText_A 仍然显示原始值，即 0.0。

我已经使用 outputText 进行了测试，我的预期输出显示在那里，但之后它在屏幕上变为只读。我希望在我的预期输出填充到 inputText_A 后它是可编辑的，因此我选择了 inputText 对象。

我知道当我们将一些值从 JSF 传递给 Bean 时，我们使用 inputText，而当一些值从 Bean 传递给 JSF 时，我们使用 outputText。但现在我想使用 inputText 将值从 Bean 传递给 JSF。我可以知道这可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T13:21:46.703

`h:inputText`通过（如果您需要此类功能）显示一些更新的值是完全可以的。你只需要有适当`getter`的`setter`bean 变量。

例如：

```
private String text;

// here you will update the input text - in your case method which does calculations
    public void changeText(){
        ...
        text = "updated"; 
    }

    public String getText() {
        return text;
    }

    public void setText(String text) {
        this.text = text;
    } 
```

还有你的 facelet (.xhtml)：

```
 <h:inputText value="#{dummyBean.text}" />
        <h:commandButton value="Change text" actionListener="#{dummyBean.changeText}" /> 
```

您`inputText`将在按钮单击时更新。

另一件事是，如果您通过 Ajax 更新您的内容。然后你需要重新渲染`parent component`of the`inputText`或`form`of the `inputText`：

```
 <h:commandButton immediate="true" value="Change text">
         <f:ajax event="click" render=":formID"  listener="#{dummyBean.changeText}"/>
    </h:commandButton> 
```

# java - 显示时的 JPanel ActionMethod

> ID：10153699
> 
> 赞同：2
> 
> 时间：2012-04-14T12:40:41.700
> 
> 标签：java, swing, methods, jpanel

我搜索了一个方法，如果 jpanel 显示在显示屏上，就会调用该方法，因为我必须获取面板的实际大小。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T12:43:25.960

您是否尝试将[ComponentListener](http://docs.oracle.com/javase/7/docs/api/java/awt/event/ComponentListener.html)添加到 JPanel？那将是我从`componentShown(...)`方法中的代码开始的地方。为此，我认为您必须`setVisible(true)`在将 JPanel 添加到显示器后调用它。

另一种选择是在调用`pack()`之后或`setVisible(true)`在您的 GUI 上简单地查询其大小。

**编辑**
你状态：

> 我将面板添加到 gui 设计器中。当窗口弹出时，我现在想要 jpanel 的实际大小，因为它可以改变它。

如果你想知道“当窗口弹出时”窗口所持有的组件的大小，那么在窗口中添加一个[WindowListener](http://docs.oracle.com/javase/7/docs/api/java/awt/event/WindowListener.html)并从`windowOpened(...)`方法中检查组件的大小。

**编辑 2**
然后你说：

> 在获得实际尺寸后，我添加了一些与此面板尺寸相关的子面板。因此，例如 size/6 和子面板现在的 size-height 为 size/6。

一种解决方案：最好不要设置任何东西的大小，而是使用布局管理器的正确组合，然后让他们根据自己的规则设置适当的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T12:50:02.170

使用函数 setVisible(true) 设置可见性；

# sql - 需要旋转帮助

> ID：10153703
> 
> 赞同：1
> 
> 时间：2012-04-14T12:41:14.380
> 
> 标签：sql, sql-server, sql-server-2008, pivot, pivot-without-aggregate

请帮我解决一下这个。我完全被困住了。我有编码器块或其他东西。

我有下表

```
ID     Name        Cost     Included
----   ----------  -------  ----------
1      Package1    10.00    Yes
2      Package2    20.00    No
3      Package3    20.00    Yes 
```

我想对这些信息进行交叉表，像下面的例子一样显示，表中会有更多的列。

```
Type        Package1     Package2       Package3
-----       ------------ -----------    ----------
Name        Package1     Package2       Package3
Cost        10.00        20.00          30.00
Included    Yes          No             Yes 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T15:45:23.173

在我看来，您正在尝试建立一个产品比较列表。如果这是真的，您可能会先[取消透视](http://msdn.microsoft.com/en-us/library/ms177410.aspx)表，然后将各个记录连接在一起。

'transponded' 部分取消旋转列。所有列必须是兼容类型或转换为一种。我选择 varchar(100)。transponded 返回三列的表，ID 来自 ProductInfo，Type 作为列名，Value 作为对应列的值。

选择部分通过添加另一个将尽可能多的产品信息连接在一起`left join transponded tn on t1.Type = tnType and tn.ID = @parametern`。这部分似乎很麻烦，但是当我尝试使用枢轴执行此部分时，我未能以正确的顺序获取列 - 类型中的枢轴排序名称。然而，它需要动态的 sql 生成。如果您为希望一次比较的最大产品添加足够的连接，则此解决方案是固定的。我相信它不会超过5。

=1、=2 和 =3 应由参数替换。查询应托管在存储过程中。

```
; with transponded as 
(
  select ID, Type, Value
    from 
    (
      select ID, 
             Name, 
             cast (Cost as varchar(100)) Cost, 
             cast (case when Included = 1 then 'Yes' else 'No' end as varchar(100)) Included
        from ProductInfo
    ) p
      unpivot (Value for Type in (Name, Cost, Included) ) a
)
select t1.Type, 
       t1.Value Product1, 
       t2.Value Product2, 
       t3.Value Product3
  from transponded t1
  left join transponded t2
         on t1.Type = t2.Type
        and t2.id = 2
   left join transponded t3
     on t1.Type = t3.Type
    and t3.id = 3
  where t1.id = 1 
```

In short, transpond one record at time and join to another transponded record by Type column.

Oh, and [here is a Sql Fiddle playground](http://sqlfiddle.com/#!3/b70db/5).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:11:44.580

没有简单的方法可以做到这一点，因为枢轴需要按列聚合。鉴于将列添加到输入表会导致维护问题，其中这些值不会出现在输出中，直到代码在任何使用的地方发生更改，我会说您最好使用存储过程执行一次，这将根据输入表的模式动态生成您正在寻找的输出。

我已经使用您提供的数据演示了如何做到这一点。此数据存储在临时表中（不是#temp，因为存储的过程不适用于临时表），填充如下：

```
CREATE TABLE temp (
    _key int,
    package_name varchar(50),
    cost float,
    included bit
)

INSERT INTO temp VALUES(1,'Package1',    10.00,    1)
INSERT INTO temp VALUES(2,'Package2',    20.00,    0)
INSERT INTO temp VALUES(3,'Package3',    20.00,    1) 
```

存储过程根据@pivot_field 参数检索值列表，并将这些值用作要插入“类型”字段之后的列列表。然后，它将透视字段和所有其他字段联合在一起以生成行，一次旋转一列。程序如下：

```
CREATE PROCEDURE usp_get_pivot (@table_name nvarchar(255), @pivot_field nvarchar(255)) AS
BEGIN
    CREATE TABLE #temp (val nvarchar(max))

    DECLARE @sql NVARCHAR(MAX), @cols NVARCHAR(MAX), @col NVARCHAR(255)

    SET @sql = 'SELECT DISTINCT ' + @pivot_field + ' FROM ' + @table_name
    INSERT INTO #temp EXEC sp_executesql @sql;
    SET @cols = (SELECT '[' + val + '],' FROM #temp FOR XML PATH(''))
    SET @cols = SUBSTRING(@cols, 1, LEN(@cols)-1)

    SET @SQL = N'SELECT ''' + @pivot_field + ''' as [type], *
    FROM (SELECT ' + @pivot_field + ', ' + @pivot_field + ' as ' + @pivot_field + '1 FROM ' + @table_name + ') AS source_table
    PIVOT (max(' + @pivot_field + '1) FOR ' + @pivot_field + ' IN (' + @cols + ')) AS pivot_table'

    DECLARE csr CURSOR FOR 
        SELECT c.name FROM sys.columns c, sys.objects o 
        WHERE c.object_id = o.object_id AND o.name = @table_name
        AND c.name <> @pivot_field
        ORDER BY column_id

    OPEN csr
    FETCH NEXT FROM csr INTO @col
    WHILE @@FETCH_STATUS = 0
    BEGIN
        SET @sql = @sql + ' UNION ALL
        SELECT ''' + @col + ''' as [type], *
        FROM (SELECT ' + @pivot_field + ', CAST(' + @col + ' AS VARCHAR) AS ' + @col + ' FROM ' + @table_name + ') AS source_table
        PIVOT (max(' + @col + ') FOR ' + @pivot_field + ' IN (' + @cols + ')) AS pivot_table'
        FETCH NEXT FROM csr INTO @col
    END

    CLOSE csr
    DEALLOCATE csr
    DROP TABLE #temp
    EXEC sp_executesql @sql
END 
```

您应该能够简单地将程序复制并粘贴到管理工作室，创建如上所示的数据并执行程序：

```
EXEC usp_get_pivot 'temp', 'package_name' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T13:13:37.470

如果包裹的数量不是静态的，我认为你没有选择。`PIVOT`子句只能产生静态/定义的列数。

您可以使用多个语句进行一些表到表的重写 - 但您仍然必须面对静态列数。

但是您可以将其设置为例如 10，然后最多显示 10 个包，如果包较少，则在其余列中使用 NULL-s。

您也可以使用动态 SQL 来获得动态列数——但这会让人头疼。

如果您要将此数据导出到 Excel - 不要在 SQL 中旋转它 - 在 Excel 中进行转置（它在“特殊粘贴”下）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T13:14:50.417

基本上我在这个阶段所拥有的如下。

```
 SELECT [Type],
            MAX(Beginner) AS [Beginner],
            MAX(Intermediate) AS [Intermediate],
            MAX(Advanced) AS [Advanced]
    FROM
    (
        SELECT 
            'Name' AS TYPE,
            CASE WHEN Name='Beginner' THEN Name END AS [Beginner],
            CASE WHEN Name='Intermediate' THEN Name END AS [Intermediate],
            CASE WHEN Name='Advanced' THEN Name END AS [Advanced]
        FROM Administration.Package
        UNION ALL
        SELECT 
            'Price' AS TYPE,
            CASE WHEN Name='Beginner' THEN CAST(Price AS VARCHAR) END AS [Beginner],
            CASE WHEN Name='Intermediate' THEN CAST(Price AS VARCHAR) END AS [Intermediate],
            CASE WHEN Name='Advanced' THEN CAST(Price AS VARCHAR) END AS [Advanced]
        FROM Administration.Package
    )A
    GROUP BY [Type] 
```

但是对每一列都使用联合是不对的。

# android - 输出 ListView 异常：来自 xml 类型布局资源 ID #0x102000a 的文件

> ID：10153704
> 
> 赞同：0
> 
> 时间：2012-04-14T12:41:20.077
> 
> 标签：android, listview, listactivity

我正在尝试从 SQLite 数据库中输出一个列表并收到此异常：

android.content.res.Resources$NotFoundException: 来自 xml 类型布局资源 ID #0x102000a 的文件

在检查了类似的问题之后，我确定我的 ListView 被定义为 @id/android:list 但仍然得到相同的异常。当 ListActivity 类中的 onCreate 方法完成时，就会出现问题。getAllDiaryEntries() 方法确实从数据库中获取数据，但同样，一旦它返回 ListActivity 类并且 onCreate 完成，我就会得到异常。这是代码的相关部分。

这是 ListActivity 类：

```
public class DiarySchedule extends ListActivity
{
private DiaryDataSource datasource;
private static final String TAG = "DiaryDbAdapter";

@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.diary_schedule);

    datasource = new DiaryDataSource(this);
    datasource.open();

    List<DiaryEntry> values = datasource.getAllDiaryEntries();

    ArrayAdapter<DiaryEntry> adapter = new ArrayAdapter<DiaryEntry>(this,
            android.R.id.list, values);
    setListAdapter(adapter);
} 
```

接下来我们有 getAllDiaryEntries() 方法：

```
public List<DiaryEntry> getAllDiaryEntries() 
{
    List<DiaryEntry> diaryEntries = new ArrayList<DiaryEntry>();

    Cursor cursor = database.query(DiaryDbAdapter.DIARY_TABLE,
            allColumns, null, null, null, null, null);

    cursor.moveToFirst();
    while (!cursor.isAfterLast()) 
    {
        DiaryEntry diaryEntry = cursorToDiaryEntry(cursor);
        diaryEntries.add(diaryEntry);
        cursor.moveToNext();
    }
    // Make sure to close the cursor
    cursor.close();
    return diaryEntries;
} 
```

和布局（还没有样式或任何东西）：

```
<ListView
    android:id="@id/android:list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    /> 
```

我对 Android 还是很陌生，所以可能错过了一些简单的东西，但在此先感谢您的帮助。

已编辑 - 这是 cursortoDiaryEntry 方法

private DiaryEntry cursorToDiaryEntry(Cursor cursor) { DiaryEntry diaryEntry = new DiaryEntry(); diaryEntry.setId(cursor.getLong(0)); diaryEntry.setTitle(cursor.getString(1)); diaryEntry.setDate(cursor.getString(2)); diaryEntry.setDescription(cursor.getString(3)); 返回日记条目；}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T12:51:19.837

ArrayAdapter 的构造函数（您正在使用的构造函数）定义如下：

```
public ArrayAdapter (Context context, int textViewResourceId, List<T> objects) 
```

在这里，textViewResourceId 是“包含 TextView 的布局文件的资源 ID，以在实例化视图时使用。”。见[这里](http://developer.android.com/reference/android/widget/ArrayAdapter.html#ArrayAdapter%28android.content.Context,%20int,%20java.util.List%3CT%3E%29)。

`<TextView/>`您应该使用 R.layout.layout_file传递包含元素的布局文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T13:26:26.390

dennisg 有正确的答案来解决您的问题。

我可以建议您通过将光标变成数组来做额外的工作吗？您可以通过直接使用光标来创建列表适配器来节省一些周期。

```
Cursor cursor = database.query(DiaryDbAdapter.DIARY_TABLE,
        allColumns, null, null, null, null, null);
getActivity().startManagingCursor(cursor);

String[] from = new String[] { DiaryDbAdapter.DIARY_ENTRY };
int[] to = new int[] {  R.id.ListItem1 };
SimpleCursorAdapter adapter = new SimpleCursorAdapter(getActivity(),
    R.layout.listlayoutdouble, cursor, from, to);
setListAdapter(adapter); 
```

您的 from string[] 包含您希望包含在显示中的列列表， to int[] 包含您希望将数据放入的资源 id（与 from 数组的顺序匹配）。然后适配器标注指定使用哪个行布局、哪个游标以及将数据映射到视图的两个数组。

# php - 将数组数据插入mysql表

> ID：10153707
> 
> 赞同：0
> 
> 时间：2012-04-14T12:41:34.677
> 
> 标签：php, mysql, checkbox

基本上我想把这个放在我的桌子上，

```
--------------------------------------------
|   products_id   |   related_products_ids |
| ------------------------------------------
|    1            |   2                    |
| ------------------------------------------
|    1            |   3                    |
| ------------------------------------------
|    1            |   4                    |
-------------------------------------------- 
```

我有复选框，

```
<input value="1" type="checkbox" name="rp_product[]" id="in-category1"> Microsoft IntelliMouse Pro 1
<input value="2" type="checkbox" name="rp_product[]" id="in-category2"> Microsoft IntelliMouse Pro 2
<input value="3" type="checkbox" name="rp_product[]" id="in-category3"> Microsoft IntelliMouse Pro 3
<input value="3" type="checkbox" name="rp_product[]" id="in-category3"> Microsoft IntelliMouse Pro 4 
```

我想要的是在表格中插入选中的复选框`products_id`。

我使用这个 php 代码，

```
for ($i=0; $i<count($_POST['rp_product']); $i++)
 {
  $check_val1 .= $_POST['rp_product'][$i] .",";
 }
$check_val = trim($check_val1, ','); 
unset($check_val1);

$insert_rp_ids1 = explode(',', $check_val);

 for($i=0;$i<count($insert_rp_ids1);$i++) {
   $usetag = mysql_real_escape_string(stripslashes(ltrim(rtrim($insert_rp_ids1[$i]))));
      if($usetag == "") continue;
        $array1 = array('products_id' => (int)$products_id,
                     'related_products_ids' => $usetag);
        $wpdb->insert(TABLE_RELATED_PRODUCTS, $array1);
      }
 } 
```

问题是，只插入了第一个选中的复选框。似乎是什么问题或您有其他解决方案？请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:20:38.930

trim 将删除字符串中的所有逗号 ',' 并且你正在使用 ',' 爆炸，它将如何返回任何内容？？？？？？$_POST['rp_product'] 将直接返回一个数组。您可以简单地使用 foreach 浏览数组并插入。

# java - 需要从 HTML 页面解析图像 src 然后显示它

> ID：10153709
> 
> 赞同：1
> 
> 时间：2012-04-14T12:41:58.873
> 
> 标签：java, android, html, image, parsing

我目前正在尝试开发一个应用程序，它可以访问以下站点（http://lulpix.com）并解析 HTML 并从以下部分获取 img src

```
<div class="pic rounded-8" style="overflow:hidden;"><div style="margin:0 0 36px 0;overflow:hidden;border:none;height:474px;"><img src="**http://lulpix.com/images/2012/April/13/4f883cdde3591.jpg**" alt="All clogged up" title="All clogged up" width="319"/></div></div> 
```

每次加载页面时它当然不同，所以我不能给一个异步图片库的直接 URL，这是我打算做的，例如

**加载页面 > 解析 img src > 将异步下载到 imageview > 重新加载 lulpix.com > 重新开始**

然后将这些中的每一个放置在一个图像视图中，用户可以从该视图中左右滑动来浏览。

所以 TL;DR 是，我如何解析 html 以检索 URL，并且有没有人有任何使用 libarys 来显示图像的经验。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:20:53.783

这是一个连接到 lulpix 的 AsyncTask，伪造了一个引用者和用户代理（lulpix 显然试图通过一些非常蹩脚的检查来阻止抓取）。在您的`Activity`:

```
new ForTheLulz().execute(); 
```

结果`Bitmap`以非常蹩脚的方式下载（没有缓存或检查图像是否已经是 DL:ed）& 错误处理总体上是不存在的 - 但基本概念应该没问题。

```
class ForTheLulz extends AsyncTask<Void, Void, Bitmap> {
        @Override
        protected Bitmap doInBackground(Void... args) {
            Bitmap result = null;
            try {
                Document doc = Jsoup.connect("http://lulpix.com")
                        .referrer("http://www.google.com")
                        .userAgent("Mozilla/5.0 (Windows; U; WindowsNT 5.1; en-US; rv1.8.1.6) Gecko/20070725 Firefox/2.0.0.6")
                        .get();
                        //parse("http://lulpix.com");
                if (doc != null) {
                    Elements elems = doc.getElementsByAttributeValue("class", "pic rounded-8");
                    if (elems != null && !elems.isEmpty()) {
                        Element elem = elems.first();
                        elems = elem.getElementsByTag("img");
                        if (elems != null && !elems.isEmpty()) {
                            elem = elems.first();
                            String src = elem.attr("src");
                            if (src != null) {
                                    URL url = new URL(src);
                                    // Just assuming that "src" isn't a relative URL is probably stupid.
                                    InputStream is = url.openStream();
                                    try {
                                        result = BitmapFactory.decodeStream(is);
                                    } finally {
                                        is.close();
                                    }
                            }
                        }
                    }
                }
            } catch (IOException e) {
                // Error handling goes here
            }
            return result;
        }
        @Override
        protected void onPostExecute(Bitmap result) {
            ImageView lulz = (ImageView) findViewById(R.id.lulpix);
            if (result != null) {
                lulz.setImageBitmap(result);
            } else {
                //Your fallback drawable resource goes here
                //lulz.setImageResource(R.drawable.nolulzwherehad);
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:24:26.230

最近用JSoup解析无效的HTML，效果很好！做类似...

```
 Document doc = Jsoup.parse(str);
    Element img = doc.body().select("div[class=pic rounded-8] img").first();
    String src = img.attr("src"); 
```

玩“选择器字符串”以使其正确，但我认为上述方法可行。`div`它首先根据其属性的值选择外部元素`class`，然后选择任何后代`img`元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-12T05:13:34.553

现在不需要使用 webview 检查这个示例项目

**[https://github.com/meetmehdi/HTMLImageParser.git](https://github.com/meetmehdi/HTMLImageParser.git)**

在这个示例项目中，我解析 html 和图像标签，而不是从图像 URL 中提取图像。图像已下载并显示。

# asp.net - 从占位符添加和删除用户控件

> ID：10153715
> 
> 赞同：2
> 
> 时间：2012-04-14T12:42:42.130
> 
> 标签：asp.net, user-controls

我想要实现的是，如果用户控件已经添加到占位符，那么它将被删除，否则将被添加到它，它将在 LinkBut​​ton 的 onclick 中完成。

编码：

```
public partial class SiteSettings : System.Web.UI.Page {
    private UserSettings UserSettingsControl;
    protected void Page_Load(object sender, EventArgs e) {
        System.Diagnostics.Debug.WriteLine("Pageload");
        UserSettingsControl = LoadControl("~/UserControls/UserSettings.ascx") as UserSettings;
    }

    protected void UserLink_Click(object sender, EventArgs e) {     
        if (SettingsPlaceholder.Controls.Contains(UserSettingsControl)) {
        System.Diagnostics.Debug.WriteLine("Contains");
        SettingsPlaceholder.Controls.Remove(UserSettingsControl);
        } else {
        System.Diagnostics.Debug.WriteLine("Does not Contains");
        SettingsPlaceholder.Controls.Add(UserSettingsControl);
        }
    }
} 
```

现在它不工作了。我得到：

```
Pageload // on first time load
Pageload // on first time click
Does not Contains // on first time click
Pageload // on second time click
Does not Contains // on second time click 
```

在输出窗口中。

我怎样才能做到这一点？我也尝试将它存储到 ViewState 中，但由于 UserControl 不可序列化，所以它不起作用。

aspx 页面是：

```
<telerik:RadAjaxManager ID="AjaxManager" runat="server">
    <AjaxSettings>
        <telerik:AjaxSetting AjaxControlID="UserLink">
            <UpdatedControls>
                <telerik:AjaxUpdatedControl ControlID="SettingsPanel" LoadingPanelID="LoadingPanel" UpdatePanelRenderMode="Block" />
                <telerik:AjaxUpdatedControl ControlID="PlaceHolderPanel" />
            </UpdatedControls>
        </telerik:AjaxSetting>            
    </AjaxSettings>
    <ClientEvents OnResponseEnd="respondEnd" />
</telerik:RadAjaxManager>
<asp:Panel ID="SettingsPanel" runat="server">
    <telerik:RadSplitter ID="MainSplitter" runat="server" MinHeight="200" Width="100%"
        OnClientLoaded="splitterLoaded" OnClientResized="splitterLoaded">
        <telerik:RadPane ID="LeftPane" runat="server" MaxWidth="250" Width="150" MinWidth="150" CssClass="left-rounded-corner settings-splitter-left">
            <asp:Panel runat="server">
                <asp:LinkButton ID="UserLink" runat="server" onclick="UserLink_Click" Text="User Settings" />                    
            </asp:Panel>
        </telerik:RadPane>
        <telerik:RadSplitBar ID="Splitbar" runat="server" CollapseMode="Forward" />
        <telerik:RadPane ID="RightPane" runat="server" CssClass="right-rounded-corner settings-splitter-right">
            <asp:Panel ID="PlaceHolderPanel" runat="server" Height="100%">
                <asp:PlaceHolder runat="server" ID="SettingsPlaceholder" />
            </asp:Panel>
        </telerik:RadPane>
    </telerik:RadSplitter>
</asp:Panel>
<telerik:RadAjaxLoadingPanel ID="LoadingPanel" runat="server" /> 
```

* * *

编辑：

修改后的代码：

```
public partial class SiteSettings : System.Web.UI.Page {

            protected void Page_Load(object sender, EventArgs e) {
                    if (!IsPostBack) {
                        AddUserSettings();
                    }
            }

            public UserControl UserSettingsControl {
                    get {
                            if (ViewState["UserSettings"] == null) {
                                    ViewState["UserSettings"] = LoadControl("~/UserControls/UserSettings.ascx") as UserSettings;
                            }
                            return (UserControl)ViewState["UserSettings"];
                    }
            }

        public UserControl SpaceSettingsControl {
                get {
                        if (ViewState["SpaceSettings"] == null) {
                                ViewState["SpaceSettings"] = LoadControl("~/UserControls/SpaceSettings.ascx") as SpaceSettings;
                        }
                        return (UserControl)ViewState["SpaceSettings"];
                }
        }

        protected void SettingsLink_OnCommand(object sender, CommandEventArgs commandEventArgs) {
                switch (commandEventArgs.CommandName) {
                    case "User":
                            AddUserSettings();
                            break;

                    case "Space":
                            AddSpaceSettings();
                            break;
                }
        }

        private void AddUserSettings() {
                AddSettings(UserSettingsControl);
        }

        private void AddSpaceSettings() {
                AddSettings(SpaceSettingsControl);
        }

        private void AddSettings(UserControl control) {
                SettingsPlaceholder.Controls.Add(control);
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T13:07:29.347

您不能只使用 PlaceHolder 并一直控制在那里。然后 linkBut​​ton 可以切换控件的可见性。

主要问题是您将控件添加到页面链接按钮单击。动态添加的控件在 Page_Init 和 Page_PreInit 中添加时效果最佳，这允许它们保持其 ViewState。此外，它们必须在每次回发时添加到占位符中。如果在您的示例中，在将 SettingsControl 添加到占位符后，另一个控件导致回发，则 SettingsControl 将消失，因为它没有在每次回发时添加。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T13:13:39.063

`Property`在你`WebForm`喜欢的下面创建一个。

```
public UserSettings UserSettingsControl 
{
    get
    {
        if (Session["MyControl"] == null)
            Session["MyControl"] = 
            LoadControl("~/UserControls/UserSettings.ascx") as UserSettings;
        return (UserSettings)Session["MyControl"];
    }
} 
```

现在您可以访问`UserSettingsControl`. 因为它将持续存在于`Postback`. 在原始代码中，`UserSettingsControl`被重置为 null `PostBack`。

* * *

> 到最后，`Page Life Cycle`在运行时创建的所有控件都将被释放。最后，您找不到在运行时创建的控件 after `Postback`。每个 . 只需要重新创建相同的控件`PostBack`。

# java - Google Guava 的 CacheLoader loadAll() vs reload() 语义

> ID：10153724
> 
> 赞同：8
> 
> 时间：2012-04-14T12:43:38.767
> 
> 标签：java, caching, guava

关于 Guava 11 的 CacheLoader（感谢 Google！），我真正喜欢的两件事是 loadAll()，它允许我一次加载多个密钥，以及 reload()，它允许我在密钥“陈旧”时异步重新加载密钥，但是旧值存在。我很好奇它们是如何一起玩的，因为 reload() 只在一个键上运行。

具体来说，从[CachesExplained](http://code.google.com/p/guava-libraries/wiki/CachesExplained)扩展示例：

```
LoadingCache<Key, Graph> graphs = CacheBuilder.newBuilder()
   .maximumSize(1000)
   .refreshAfterWrite(1, TimeUnit.MINUTES)
   .build(
       new CacheLoader<Key, Graph>() {
         public Graph load(Key key) { // no checked exception
           return getGraphFromDatabase(key);
         }

         public Map<Key, Graph> loadAll(Iterable<? extends K> keys) {
           return getAllGraphsFromDatabase(keys);
         }

         public ListenableFuture<Graph> reload(final Key key, Graph prevGraph) {
           if (neverNeedsRefresh(key)) {
             return Futures.immediateFuture(prevGraph);
           } else {
             // asynchronous!
             return ListenableFutureTask.create(new Callable<Graph>() {
               public Graph call() {
                 return getGraphFromDatabase(key);
               }
             });
           }
         }
       }); 
```

...其中“getAllGraphsFromDatabase()”执行聚合数据库查询，而不是长度（键）单个查询。

LoadingCache 的这两个组件如何协同工作？如果我对 getAll() 的请求中的某些键不存在于缓存中，它们将作为一个组与 loadAll() 一起加载，但如果有些需要刷新，它们是否会通过 load() 单独重新加载？如果是这样，是否有计划支持 reloadAll()？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-14T17:08:20.057

以下是令人耳目一新的工作原理。

刷新缓存条目可以通过两种方式触发：

1.  明确地，与`cache.refresh(key)`.
2.  隐式地，如果配置了缓存，并且在写入后指定的时间量后*查询*`refreshAfterWrite`条目。

 *如果查询了符合重新加载条件的条目，则返回旧值，并触发（可能是异步的）刷新。在刷新过程中，缓存将继续返回键的旧值。（因此，如果请求中的某些键`getAll`符合刷新条件，它们的旧值将被返回，但这些键的值将（可能异步）重新加载。）

仅返回的*默认*实现，它（同步）重新计算值。如果您希望进行缓存刷新，建议使用更复杂的异步实现。`CacheLoader.reload(key, oldValue)``Futures.immediateFuture(load(key))`

我认为我们目前不倾向于提供`reloadAll`。我怀疑这是可能的，但事情已经足够复杂了，我认为我们倾向于等到我们看到对这种东西的具体需求。*

# c# - RBF 神经网络 C#

> ID：10153728
> 
> 赞同：6
> 
> 时间：2012-04-14T12:44:34.847
> 
> 标签：c#, neural-network

我正在尝试为具有高斯函数作为径向基函数的神经网络找到代码。我想使用反向传播学习规则。

我有所有的数据，所以我只需要 RBF 神经网络。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T13:45:33.367

Encog 库（C# 和 Java）具有以下功能：

[http://www.heatonresearch.com/encog](http://www.heatonresearch.com/encog)

# c# - Parallel.ForEach 会阻塞吗？

> ID：10153729
> 
> 赞同：53
> 
> 时间：2012-04-14T12:44:34.993
> 
> 标签：c#, .net, multithreading, logging, parallel-processing

.net 函数[Parallel.ForEach](http://msdn.microsoft.com/en-us/library/dd992001.aspx)是否阻塞调用线程？我对行为的猜测是其中之一：

1.  是的，它会阻塞，直到执行最慢的项目返回。
2.  不，它不会阻止并立即返回控制权。并行运行的项目在后台线程上完成。

或者可能发生了其他事情，有人确定吗？

在日志类中实现这个问题时出现了这个问题：

```
public class MultipleLoggingService : LoggingServiceBase
{
    private readonly List<LoggingServiceBase> loggingServices;

    public MultipleLoggingService(List<LoggingServiceBase> loggingServices)
    {
        this.loggingServices = loggingServices;
        LogLevelChanged += OnLogLevelChanged;
    }

    private void OnLogLevelChanged(object sender, LogLevelChangedArgs args)
    {
        loggingServices.ForEach(l => l.LogLevel = LogLevel);
    }

    public override LogMessageResponse LogMessage(LogMessageRequest request)
    {
        if (request.LogMessage)
            Parallel.ForEach(loggingServices, l => l.LogMessage(request));

        return new LogMessageResponse{MessageLogged = request.LogMessage};
    }
} 
```

请注意，该`LogMessage`方法调用了其他一些日志服务。我需要该部分立即返回，因此它不会阻塞调用线程。

* * *

更新：根据其他人的评论（我们已经确认行为是#1）。所以我接受了使用[任务](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx)库的建议，并像这样重写了循环：

```
 if (request.LogMessage)
            foreach (var loggingService in loggingServices)
                Task.Factory.StartNew(() => loggingService.LogMessage(request)); 
```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-04-14T12:47:30.080

1号是正确的；`Parallel.ForEach`在循环完成之前不会返回。如果您不想要这种行为，您可以简单地将循环作为 a`Task`执行并在另一个线程上运行它。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-14T13:49:42.477

在正常的 foreach() 中重新更新 StartNew ：

对于大型集合，这可能不是最佳的，而且您没有处理错误的意义。

您的 loggingServices 可能不包含数千个项目，但错误处理仍然很重要。

考虑：

```
Task.Factory.StartNew(() => 
{
   try
   {
        Parallel.ForEach(loggingServices, l => l.LogMessage(request));
   }
   catch(SomeException ex)
   {
       // at least try to log it ...
   }
}); 
```

# macos - Mac OS X 默认值 如何传递当前日期？

> ID：10153735
> 
> 赞同：0
> 
> 时间：2012-04-14T12:45:26.767
> 
> 标签：macos, shell, plist

我试图运行以下脚本来修改 Growl plist 中的时间戳，但该脚本无法更新 plist。如果我从命令行执行相同的操作，那么它工作正常。

请帮忙。

```
#!/bin/sh
current=`date +"%Y-%m-%d %l:%M:%S +0000"`
cmd="defaults read com.Growl.GrowlHelperApp LastUpdateCheck -date '$current'"
echo $cmd
`$cmd`
echo `defaults read com.Growl.GrowlHelperApp LastUpdateCheck` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:32:08.380

不要将命令放入变量中，引用不会像您认为的那样工作（请参阅[BashFAQ #050：我正在尝试将命令放入变量中，但复杂的情况总是失败！](http://mywiki.wooledge.org/BashFAQ/050)）。（顺便说一句，`echo $cmd`并没有告诉您实际将执行什么命令）。直接运行命令即可。

另外，我认为您正在尝试运行`defaults write ...`，而不是`defaults read ...`. 最后，最后一行的回显和反引号有效地相互抵消——只需将两者都删除即可。这是我得到的：

```
#!/bin/sh
current=$(date +"%Y-%m-%d %l:%M:%S +0000")
defaults write com.Growl.GrowlHelperApp LastUpdateCheck -date "$current"
printf "New value of LastUpdateCheck: "
defaults read com.Growl.GrowlHelperApp LastUpdateCheck 
```

如果由于某种原因，您确实需要在执行命令之前将命令存储在变量中，请使用数组。但请注意，这是仅限 bash 的功能，因此请使用以下命令启动脚本`#!/bin/bash`：

```
#!/bin/bash
current=$(date +"%Y-%m-%d %l:%M:%S +0000")
cmd=(defaults write com.Growl.GrowlHelperApp LastUpdateCheck -date "$current")
printf "About to execute:"
printf " %q" "${cmd[@]}"  # Need to use printf trickery to get appropriate quoting
printf "\n"
"${cmd[@]}"
printf "New value of LastUpdateCheck: "
defaults read com.Growl.GrowlHelperApp LastUpdateCheck 
```

# mysql - 将 mySQL 查询转换为 Zend FrameWork 查询的工具

> ID：10153740
> 
> 赞同：5
> 
> 时间：2012-04-14T12:46:17.490
> 
> 标签：mysql, zend-framework, zend-db

是否有任何在线 Web 工具可以将 mySQL 查询转换为 Zend 框架查询。那就是我输入 mySql 查询和工具将其转换为 Zend FrameWork 等效查询

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T12:18:46.860

您不需要为此使用工具。在 Zend Framework 的 Zend_Db 组件中，您可以：

```
$stmt = $db->query($sql); 
```

如果`$sql`是一个选择，那么您可以使用以下方法检索数据：

```
$rows = $stmt->fetchAll(); 
```

或者，ZF 只是一个 PHP 框架，所以没有什么能阻止您继续使用[`PDO`](http://php.net/pdo)或[`mysqli`](http://php.net/mysqli)直接使用。

# asp.net-mvc-3 - ASP.NET MVC 在发送到视图之前更改模型数据类型

> ID：10153745
> 
> 赞同：0
> 
> 时间：2012-04-14T12:47:10.983
> 
> 标签：asp.net-mvc-3, linq-to-entities

我使用 Linq to Entity，从数据库中获取模型

```
 var works = db.Work.Where(a => a.StartDate == DateTime.Now).ToList(); 
```

此模型包含一个 DateTime，我想在将其发送到视图之前将其更改为字符串，因为需要将其显示为 persianDate Time，如下所示：

```
 foreach (var item in workslist)
                {
                    item.StartDate = "1391/01/01"; //Just For Exapmle as you know this won't work
                }
return View(workslist); 
```

那么有没有办法改变强类型模型中的数据类型呢？或其他方式来执行此操作，除了将 DateTime 保存为我的数据库中的字符串

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:08:10.217

您可以在控制器中有一个函数来将日期时间更改为字符串

```
public string changeDateTimeToPersianString ( DateTime time)
    {
// your code
} 
```

然后你可以从你的视图中调用这个函数。

在 Razor 中是这样的

```
@changeDateTimeToPersianString(workslistitem.StartDate) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T16:48:14.580

您可以将 [DisplayFormat] 属性与 EditorFor/DisplayFor 助手一起使用来格式化数据。

```
[DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = "{0:yyyy/mm/dd}")]
public DateTime StartDate { get; set; } 
```

然后在视图中：

```
@Html.EditorFor(m => m.StartDate) 
```

或者，您也可以考虑为您的“工作”域模型定义单独的 ViewModel。虽然这种方法会产生更多的代码，但它提供了更多的灵活性并被认为是良好的实践。这是示例代码：

```
public class Work
{
    public DateTime StartDate {get;set;}
}

public class WorkViewModel
{
    public WorkViewModel()
    {
    }

    public string StartDate { get; set; }

    public static WorkViewModel Map(Work domainModel)
    {
        return new WorkViewModel() { 
            //Apply your Date format logic
            StartDate = domainModel.StartDate.ToString("yyyy/MM/dd")
        };
    }
} 
```

在行动方法：

```
var works = db.Work.Where(a => a.StartDate == DateTime.Now).ToList();
var workViewModels = new List<WorkViewModel>(works.Count);
foreach (var work in works)
    workViewModels.Add(WorkViewModel.Map(work));

return View(workViewModels); 
```

# c# - 我应该如何在 Windows Phone 7 上使用 RestSharp 实现 ExecuteAsync？

> ID：10153749
> 
> 赞同：35
> 
> 时间：2012-04-14T12:48:36.163
> 
> 标签：c#, api, windows-phone-7, rest, restsharp

我正在尝试使用[RestSharp GitHub wiki](https://github.com/restsharp/RestSharp/wiki/Recommended-Usage)上的文档来实现对我的 REST API 服务的调用，但我遇到了特别是 ExecuteAsync 方法的问题。

目前，我的 API 类代码如下所示：

```
public class HarooApi
{
    const string BaseUrl = "https://domain.here";

    readonly string _accountSid;
    readonly string _secretKey;

    public HarooApi(string accountSid, string secretKey)
    {
        _accountSid = accountSid;
        _secretKey = secretKey;
    }

    public T Execute<T>(RestRequest request) where T : new()
    {
        var client = new RestClient();
        client.BaseUrl = BaseUrl;
        client.Authenticator = new HttpBasicAuthenticator(_accountSid, _secretKey);
        request.AddParameter("AccountSid", _accountSid, ParameterType.UrlSegment);
        client.ExecuteAsync<T>(request, (response) =>
        {
            return response.Data;
        });
    }
} 
```

我知道这与 GitHub 页面上的内容略有不同，但我将其与 WP7 一起使用，并相信该示例适用于 C#，因此使用了 ExecuteAsync 方法。

我的问题是 ExecuteAsync 命令应该包含什么。我不能使用`return response.Data`，因为我被警告：

```
'System.Action<RestSharp.RestResponse<T>,RestSharp.RestRequestAsyncHandle>' returns void, a return keyword must not be followed by an object expression 
```

有没有人对如何解决这个问题或可能有帮助的教程有任何见解？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2014-02-10T14:41:52.323

老问题，但如果您使用的是 C# 5，则可以通过创建返回 T 任务的 TaskCompleteSource 来获得通用执行类。您的代码可能如下所示：

```
public Task<T> ExecuteAsync<T>(RestRequest request) where T : new()
    {
        var client = new RestClient();
        var taskCompletionSource = new TaskCompletionSource<T>();
        client.BaseUrl = BaseUrl;
        client.Authenticator = new HttpBasicAuthenticator(_accountSid, _secretKey);
        request.AddParameter("AccountSid", _accountSid, ParameterType.UrlSegment);
        client.ExecuteAsync<T>(request, (response) => taskCompletionSource.SetResult(response.Data));
        return taskCompletionSource.Task;
    } 
```

并像这样使用它：

```
private async Task DoWork()
    {
        var api = new HarooApi("MyAcoountId", "MySecret");
        var request = new RestRequest();
        var myClass = await api.ExecuteAsync<MyClass>(request);

        // Do something with myClass
    } 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-04-14T17:22:07.353

您的代码应如下所示：

```
public class HarooApi
{
    const string BaseUrl = "https://domain.here";

    readonly string _accountSid;
    readonly string _secretKey;

    public HarooApi(string accountSid, string secretKey)
    {
        _accountSid = accountSid;
        _secretKey = secretKey;
    }

    public void ExecuteAndGetContent(RestRequest request, Action<string> callback)
    {
        var client = new RestClient();
        client.BaseUrl = BaseUrl;
        client.Authenticator = new HttpBasicAuthenticator(_accountSid, _secretKey);
        request.AddParameter("AccountSid", _accountSid, ParameterType.UrlSegment);
        client.ExecuteAsync(request, response =>
        {
            callback(response.Content);
        });
    }

    public void ExecuteAndGetMyClass(RestRequest request, Action<MyClass> callback)
    {
        var client = new RestClient();
        client.BaseUrl = BaseUrl;
        client.Authenticator = new HttpBasicAuthenticator(_accountSid, _secretKey);
        request.AddParameter("AccountSid", _accountSid, ParameterType.UrlSegment);
        client.ExecuteAsync<MyClass>(request, (response) =>
        {
            callback(response.Data);
        });
    }
} 
```

我添加了两个方法，所以你可以检查你想要的（来自响应正文的字符串内容，或者这里表示的反序列化类`MyClass`）

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2017-12-07T11:53:00.880

[作为Gusten](https://stackoverflow.com/users/1725082/gusten)[精美答案](https://stackoverflow.com/a/21680143/4949005)的替代（或补充）。您可以使用. 这样你就不必手动处理了。注意签名中的关键字。`ExecuteAsync``TaskCompletionSource``async`

**更新：** 截至[106.4.0](https://github.com/restsharp/RestSharp/blob/dev/releasenotes.md#10640) `ExecuteTaskAsync`已过时。从[104.2 开始](https://github.com/restsharp/RestSharp/blob/dev/releasenotes.md#1042)，您应该`ExecuteAsync`改用：

```
public async Task<T> ExecuteAsync<T>(RestRequest request) where T : new()
{
    var client = new RestClient();
    client.BaseUrl = BaseUrl;
    client.Authenticator = new HttpBasicAuthenticator(_accountSid, _secretKey);
    request.AddParameter("AccountSid", _accountSid, ParameterType.UrlSegment);
    IRestResponse<T> response = await client.ExecuteAsync<T>(request);
    return response.Data;
} 
```

**老答案：**

```
public async Task<T> ExecuteAsync<T>(RestRequest request) where T : new()
{
    var client = new RestClient();
    client.BaseUrl = BaseUrl;
    client.Authenticator = new HttpBasicAuthenticator(_accountSid, _secretKey);
    request.AddParameter("AccountSid", _accountSid, ParameterType.UrlSegment);
    IRestResponse<T> response = await client.ExecuteTaskAsync<T>(request); // Now obsolete
    return response.Data;
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-03-29T02:50:47.543

或者更准确地说是这样的：

```
 public async Task<IRestResponse<T>> ExecuteAsync<T>(IRestRequest request) where T : class, new()
    {
        var client = new RestClient(_settingsViewModel.BaseUrl);

        var taskCompletionSource = new TaskCompletionSource<IRestResponse<T>>();
        client.ExecuteAsync<T>(request, restResponse =>
        {
            if (restResponse.ErrorException != null)
            {
                const string message = "Error retrieving response.";
                throw new ApplicationException(message, restResponse.ErrorException);
            }
            taskCompletionSource.SetResult(restResponse);
        });

        return await taskCompletionSource.Task;
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-06-24T20:12:53.767

由于`public static RestRequestAsyncHandle ExecuteAsync(this IRestClient client, IRestRequest request, Action<IRestResponse> callback)`已被弃用，您应该考虑`public Task<IRestResponse> ExecuteAsync(IRestRequest request, CancellationToken token = default)`改用。

以下代码

```
client.ExecuteAsync(request, response => { callback(response.Content); }); 
```

应该改为

```
await client.ExecuteAsync(request).ContinueWith(task => callback(task.Result.Content)); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-03-06T16:54:02.177

以下完成了工作

```
public async Task<IRestResponse<T>> ExecuteAsync<T>(IRestRequest request) where T : class, new()
{
    var client = new RestClient
    {
        BaseUrl = _baseUrl,
        Authenticator = new HttpBasicAuthenticator(_useraname, _password),
        Timeout = 3000,
    };

    var tcs = new TaskCompletionSource<T>();
    client.ExecuteAsync<T>(request, restResponse =>
    {
        if (restResponse.ErrorException != null)
        {
            const string message = "Error retrieving response.";
            throw new ApplicationException(message, restResponse.ErrorException);
        }
        tcs.SetResult(restResponse.Data);
    });

    return await tcs.Task as IRestResponse<T>;

} 
```

# c - Printf 以某种方式改变了一些东西？

> ID：10153751
> 
> 赞同：0
> 
> 时间：2012-04-14T12:49:07.373
> 
> 标签：c, debugging, gcc, printf

好的，所以我有以下 C 代码

```
#include <cstdio>
#include <cstring>

// funkcija za mnozenje na dva 8-bitni broja (vo RC format) so Butov algoritam
// vlez:    a[] - mnozenik, b[] - mnozitel
// izlez:   proizvod[] - proizvodot (mnozenik * mnozitel)

void shiftRight(char niza[])
{
    char out[100];
    strncpy(out, niza, 1);
    strcat(out, niza);
    out[17]='\0';
    strcpy(niza, out);
}

void add(char opa[], char opb[])
{
    char rez[100];
    strcpy(rez, opa);
    char carry='0';
    int i=16;
    while(i>=0)
    {
        int car=carry-'0';
        int currbita=opa[i]-'0';
        int currbitb=opb[i]-'0';
        rez[i]=((car+currbita+currbitb)%2)+'0';
        if(car+currbita+currbitb>=2)
        {
            carry='1';
        }
        else
            carry='0';
        i--;
    }
    strcpy(opa, rez);
}

void vtorKomplement(char in[], char out[])
{
    strcpy(out, in);
    for(int i=0; i<8; i++)
    {
        if(out[i]=='0')
            out[i]='1';
        else
            out[i]='0';
    }
    int i=7;
    char carry='1';
    while(carry!='0')
    {
        int car=carry-'0';
        int currbit=out[i]-'0';
        if(car+currbit>=2)
        {
            carry='1';
        }
        else
            carry='0';
        out[i]=((car+currbit)%2)+'0';
        i--;
    }
}

void mnozenjeButov(char a[], char b[], char proizvod[]) {
    int i;
    char rez[100];
    char A[100];
    char S[100];
    char P[100];
    strcpy(A, a);
    strcat(A, "000000000");
    vtorKomplement(a, S);
    for(i=8; i<17; i++)
    {
        S[i]='0';
    }
    S[17]='\0';
    strcpy(P, "00000000");
    strcat(P, b);
    strcat(P, "0");
    for(int i=0; i<8; i++)
    {
        if(P[15]=='0'&& P[16]=='1')
        {
            add(P, A);
        }
        else if(P[15]=='1' && P[16]=='0')
        {
            printf("Before add P: %s\n", P);
            add(P, S);
        }
        shiftRight(P);
        printf("Shifted P: %s\n", P);
    }
    for(int i=8; i<17; i++)
    {
        proizvod[i-8]=P[i];
    }
    proizvod[8]='\0';
}

int main() {
    int success = 1;

    char a[100];
    char b[100];
    char proizvod[100];
    char w_proizvod[100];

    // TEST 1
    strcpy(a, "00010011");
    strcpy(b, "00000101");
    strcpy(w_proizvod, "01011111");
    mnozenjeButov(a, b, proizvod);
    printf("TEST 1: %s, %s\n", a, b);
    printf("  Tocen odgovor:    %s\n", w_proizvod);
    printf("  Vas odgovor:      %s\n", proizvod);

    if (strcmp(proizvod, w_proizvod) == 0) {
        printf("Vasata programa dava tocen rezultat :-)\n\n");
    } else {
        printf("Vasata programa dava netocen rezultat!\n\n");
        success = 0;
    }

    if (success == 1) {
        printf("Vasata programa gi pomina testovite uspesno!\n");
    } else {
        printf("Nekoi od testovite bea neuspesni.\n");
    }

    return 0;
} 
```

一切都很好，但是当我删除`printf("Before add P: %s\n", P);`和/或之后的 printf 时会发生一些奇怪的事情。然后输出以某种方式发生变化，并且出现了一些不应该存在的字符......我尝试调试，但随后我得到了正常输出。我还尝试在另一台机器上进行测试，我也在那里得到了奇怪的字符。过去一个小时我一直在敲我的头，有人能告诉我哪里出错了吗？我正在使用带有 mingw GCC 编译器的代码块。

更新： Jens Gustedt 的解决方案奏效了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T16:23:57.273

这两行存在概念错误：

```
strncpy(out, niza, 1);
strcat(out, niza); 
```

`strncpy`这里只复制一个字符。特别`out[0]`是等于`niza[0]`并且`out[1]`是以前存在的任何东西。然后，您`strcat`将写入`niza`找到 0 字符的下一个位置，这可能会产生灾难性的结果。（手册页`strncpy`说得很好。）

为了以后能够做到这一点`strcpy`，您可能必须在`'\0'`其中放置一个。但是有一个更简单的解决方案：

```
out[0] = niza[0];
strcpy(out + 1, niza); 
```

# php - 如果文件已存在，如何显示消息

> ID：10153754
> 
> 赞同：1
> 
> 时间：2012-04-14T12:49:24.800
> 
> 标签：php, javascript, jquery

我在一个页面中有一个javascript函数，在另一个页面中有一个专注于文件上传的php脚本。目前我的文件上传成功，这是个好消息。我的问题是，我想使用 php 检查文件夹中是否已经存在文件，但如果这是真的，我想使用 javascript 函数显示一条消息，说明文件已经存在。如何才能做到这一点？

下面是检查文件是否存在的 php 代码：

```
if (file_exists("upload/" . $_FILES["fileImage"]["name"]))
  {

  } 
```

以下是文件停止上传时的 Javascript 函数。如果文件没有上传，它会显示一条消息，说明上传文件时出错，如果文件成功上传，它会显示一条消息，但我想要一条额外的消息，如果文件没有上传，但这是因为文件已经存在，那么我希望它显示一条消息，说明文件已经存在。

```
 function stopImageUpload(success){
          var result = '';
          if (success == 1){
             result = '<span class="msg">The file was uploaded successfully!</span><br/><br/>';
          }
          else {
             result = '<span class="emsg">There was an error during file upload!</span><br/><br/>';
          }
} 
```

PS 请没有人回答为什么我不在 php 代码中添加一个回显，我不想那样做，因为用户实际上从未导航到 php 脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:04:02.717

你说。

> PS 请没有人回答为什么我不在 php 代码中添加一个回显，我不想那样做，因为用户实际上从未导航到 php 脚本。

无论如何，您都需要执行一些 php 代码。所以你将不得不以一种或另一种方式做到这一点。然后，使用您想要的任何方式向用户显示信息。

由于我们没有所有代码，我假设您在 html 代码中有一个 input[type=file]，因此您需要使用带有输入值的 ajax。将其发送到您的服务器，检查文​​件名是否已存在，然后使用 php 中的 ajax 以 true 或 false 响应，并在 javascript 中执行代码，该代码将告诉用户文件是否存在。你可以使用 jQuery 来做到这一点：

```
 $("#myInput").on("change",function(event){
             $.getJSON("checkFileService.php",{filename:$(event.currentTarget).val()},
        function(datas){
         if(datas.exists === true){
          doSomething();
         else{
          doSomethingElse();
         }
        }
       } 
```

查看 jQuery ajax api 了解更多信息

您必须编写一个 php 脚本来输出一些像 {"exists":true} 这样的 json 字符串，以便客户端脚本正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T14:50:41.753

*@safarov你能给我看一个函数的例子来看看文件是否已经存在，然后为新上传的文件写不同的名字吗？*

保存/上传一个名为“filenamecounter.txt”的简单文本文件，其中仅包含文本 1。

```
<?php
    //Get the original name of file
    $tmp_name = $_FILES["filename"]["tmp_name"];

    //Get/Read File Name Counter
    $filenamecounter = file_get_contents('filenamecounter.txt');

    //If it is less than 10, add a "0"/Zero to make it like 01,02,03
    if (strlen($filenamecounter) <= 1){
        $filenamecounter = str_pad($filenamecounter, 2, '0', STR_PAD_LEFT);
        }

    //Assign Filename + Variable
    $name = "filename".$filenamecounter.".txt";

    //Save file with new name
    move_uploaded_file($tmp_name, $name);

    //write quotecounter to file.
    $filenamecounter++;
    file_put_contents("filenamecounter.txt", $filenamecounter);
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T13:42:52.907

在您检查文件是否存在的PHP代码中

```
else{
echo 2;
} 
```

在你的 JS 代码中的 else 子句中做

```
if(success == 2){
result = '<span class="emsg">File already exist!</span><br/><br/>';
} 
```

这是一个快速的解决方案，但它为您提供了一种通过 JS/PHP 进行更复杂文件处理的方法。例如。当 PHP 返回数据 1 时，一切正常，当 2 时，文件存在，当 3 时，文件太大，当 4 时，文件扩展名错误，当 5 时，其他，依此类推。

我在学习C/C++时遇到过这种方法（在C中这种方式就像一个标准的东西）。通过这种方式，您可以提供信息某些部分的代码是如何运行的。

尽管如此，我还是会为文件生成一个随机名称，如果名称无关紧要，并且如果文件名很重要，那么将使用 AJAX 来检查它，并显示有关它的信息，或者可能在文件名后附加一个数字（文件（1 ).xyz、文件(2).xyz、文件(3).xyz)。这取决于您要达到的目标。

# jquery - Jquery 在 MVC Foreach 中制作选择器

> ID：10153757
> 
> 赞同：0
> 
> 时间：2012-04-14T12:49:54.853
> 
> 标签：jquery, css, asp.net-mvc, jquery-selectors

我正在尝试实现一个评级插件。我能够让评级插件正常工作。我正在尝试扩展它。因此，每次单击评级时，它都会将标签置于评级本身之下。目前它绑定到页面上其他地方的 css id。

该场景是一条推特消息，似乎无法获得选择器来更新消息本身。它将信息放在所有人身上，因为它不是唯一的。

我怎样才能使该项目独一无二。该插件的文档是[http://rateit.codeplex.com/documentation](http://rateit.codeplex.com/documentation)。

```
 $(document).ready(function () {

      //we bind only to the rateit controls within the products div

      $(".rateit").bind('over', function (event, value) { $(this).attr('title', value); });
      $(" .rateit").bind('rated reset', function (e) {

          var ri = $(this);

          //if the use pressed reset, it will get value: 0 (to be compatible with the HTML range control), we could check if e.type == 'reset', and then set the value to  null .
          var value = ri.rateit('value');
        var ratingid = ri.data('ratingid');           

          //maybe we want to disable voting?
          ri.rateit('readonly', true);

          $.ajax({
              url: '/Home/GetRating', //your server side script
              data: { id: ratingid, value: value }, //our data
              type: 'POST',
              success: function (data) {
                  $('#ratemsg').html(data);

              },
              error: function (jxhr, msg, err) {
                  $('#response').append('<li style="color:red">' + msg + '</li>');
              }
          });
      });

  });

</script>

 @foreach (var item in Model)
{ 
 <div id="TwitterMessageBox@(item.StatusId.ToString())" class="TwitterMessageBox">

    <ol>
        <li class="TweetLineBody">
            @Html.Hidden("Statusid", item.StatusId)
            <div class="TwitProfileImage">
                <img src=@Url.Content(item.ImageUrl) alt="@item.ScreenName" />
            </div>
            <div class="TwitRealName">
                @item.User
            </div>
            <div class="TwitNickName">
                @MvcHtmlString.Create(@Html.Namify(@item.ScreenName))
            </div>
            <div class="TweetText">
                @MvcHtmlString.Create(@item.Tweet)</div>
            <div class="TweetTime">
                @Html.RelativeDate(@item.Created)</div>

            <div id="TweetMessageRating@(item.StatusId.ToString())" name="TweetMessageRating@(item.StatusId.ToString())"  class="TweetRating">

               // This is where the rating widget goes and records and updates              
                <div data-ratingid="@item.StatusId"   class="rateit"></div>
         // this is where i want to go but i cant figure out a way
                 <span id ="ratemsg" name="TweetRating@(item.StatusId.ToString())"  class="ratemsg"> </span>
             </div>

        </li>
    </ol>

  </div>
 } 
```

正如您在上面看到的，我试图通过将作为状态 id 的消息 id 添加到选择器来设置唯一键，但我似乎无法使用通配符选择它。我在 jquery 网站上尝试了一些示例，但似乎无法理解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:37:37.130

不要使用 id，只需保存当前`.rateit`元素的兄弟姐妹。

```
var ri = $(this),
    msg = ri.next();

 ...

    success: function (data) {
        msg.html(data);
    }, 
```

# sql - 如何在时间戳字段中仅使用日期来选择记录？

> ID：10153758
> 
> 赞同：0
> 
> 时间：2012-04-14T12:50:00.040
> 
> 标签：sql, jpa, hsqldb

我正在使用 HSQL 创建一个应用程序。现在我需要使用某个特定的日期 - 获取所有记录`yyyy-MM-dd`，但该列是时间戳日期类型 - `yyyy-MM-dd-HH.mm.ss.ffffff`。

我将如何编写一个 HSQL / JPA 查询来使用时间戳字段从表中选择使用给定日期的所有记录？

我是 HSQL 和 JPA 的新手。我没有任何线索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T12:52:58.683

```
select * from your_table 
where cast(datetime_column as date) = '2012-04-14' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T14:07:24.420

对于 HSQLDB 2.2.8，`WHERE datetime_column >= the_date AND datetime_column < the_date + 1`在 JPQL 查询中使用，以便 datetime_column 上的索引用于查询。

# git - 在 Git 中编辑已推送的错误提交消息

> ID：10153760
> 
> 赞同：14
> 
> 时间：2012-04-14T12:50:04.773
> 
> 标签：git, git-push, git-commit

我做了一个 Git 提交和推送，但在评论中写了完全错误的东西。

如何更改评论？我已经将提交推送到远程。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-14T12:55:14.087

`git commit --amend`将允许您编辑提交消息。

如果您已经推送了该提交，则需要运行`git push --force`. **仅当您确定没有人拉它时才这样做！**

如果人们从您的存储库中撤消了提交，只需保持原样即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-23T18:16:50.850

如果你写错了，commit 还没有被推送，你可以通过下面的方式来改变 commit 信息：

```
$ git commit --amend 
```

这将打开您的默认文本编辑器，您可以在其中编辑消息。另一方面，您可以在一个命令中完成所有操作：

```
$ git commit --amend -m 'xxxxxxx' 
```

如果已经推送过消息，可以修改commit并强制推送，但不建议这样做。

强制推送：`git push --force`

# iphone - 带有 UIButton 和 UITapGestureRecognizer 的 UIScrollView

> ID：10153761
> 
> 赞同：1
> 
> 时间：2012-04-14T12:50:15.867
> 
> 标签：iphone, objective-c, ios, uibutton, uitapgesturerecognizer

我一直在玩这个代码，但不能正确。

当前行为：即使在点击按钮时，我也可以在 UIScrollView 上自由滚动。当我点击不是按钮的东西时，它会调用一个方法（就像我想要的那样），这是 UITapGestureRecognizer 的结果。但是，我必须按住按钮几秒钟，然后触摸它以触发按钮的 UIControlEventTouchUpInside。

我想要发生的事情：完全一样，但是能够轻松地触摸 UIButton，就像我在它所在的视图上关闭 UITapGestureRecognizer 一样。

这是我的代码：

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {

        //...

        [cell.xButton addTarget:self action:@selector(xButtonPressed:) forControlEvents:UIControlEventTouchUpInside];

        self.delaysContentTouches = YES;

        UITapGestureRecognizer *tapGestureRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTapFrom:)];
        [self addGestureRecognizer:tapGestureRecognizer];
        tapGestureRecognizer.delegate = self;
    }
}

- (void) handleTapFrom: (UITapGestureRecognizer *)recognizer
{
    [self.header removeKeyboard];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:39:41.783

正如**stavash**建议的那样，您可以执行以下操作：

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch
{
    UIView* touchedView = [touch view];
    if([touchedView isKindOfClass:[UIButton class]]) {

       return NO;
    }

    return YES;
} 
```

这在大多数情况下都有效。此外，您可能需要检查所触摸的视图是否是滚动视图的后代，使用`isDescendantOfView:`.

希望能帮助到你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T13:32:46.753

我认为你的答案是 UIGestureRecognizerDelegate 的方法：

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch 
```

检查触摸的 view 属性是否是您试图避免的任何 UIButtons：如果是，则返回 NO，否则返回 YES。不要忘记分配 UITapGestureRecognizer 的委托，以便它工作。希望这可以帮助。

# maven-2 - 构建传递依赖项的项目时出现 Maven 错误

> ID：10153766
> 
> 赞同：0
> 
> 时间：2012-04-14T12:50:48.993
> 
> 标签：maven-2

org.apache.cxf:cxf:jar:2.4.2 的 POM 无效，传递依赖项（如果有）将不可用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T12:54:26.290

似乎捕获依赖信息的 .pm 文件已损坏（在下载时或在中央存储库中已损坏）。尝试不同的版本

# asp.net - ASP.NET - 每次页面加载时用户控件字段值更改

> ID：10153771
> 
> 赞同：0
> 
> 时间：2012-04-14T12:51:16.600
> 
> 标签：asp.net, user-controls

我有一个包含三个下拉列表的用户控件：日、月和年。这是一种日期选择器。它有一个私有字段

```
private bool _isValidDate = false; 
```

在下拉列表中，第一项是“日”、“月”和“年”。在 SelectedIndexChanged 事件中，我检查是否所有选定的索引都大于 0，如果是，我尝试使用下拉列表的值创建一个新的 DateTime 对象，如下所示：

```
try
{ 
  DateTime date=new DateTime(int.Parse(ddlYear.SelectedItem),
                                ddlMonth.SelectedIndex,
                                ddlDay.SelectedIndex);
  _isValidDate=true;
}
catch {_isValidDate=false;} 
```

在提交之前使用此控件的表单上，我检查 IsValidDate 属性，如果它为假，我会警告用户。问题是我第一次设置正确的日期并按下按钮时我没有收到任何警告，因为 IsValidDate 属性为真，但如果我第二次单击它，IsValidDate 属性设置回假并且我收到警告虽然日期有效。我知道这是因为每次页面加载时，控件的 _isValiddate 字段都会设置回它的默认值 false。我该如何处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:03:11.610

你的财产应该是这样的。

```
public Boolean IsValidDate 
{
    get
    {
        String CompleteDate = "YourYear" + "/" + "YourMonth" + "/" + "YourDay";
        DateTime Dt ;
        if (DateTime.TryParse(CompleteDate, out Dt))
            return true;
        return false;
    }
} 
```

# java - 为 Objective-C 和 Java 编写通用代码的最佳方式？

> ID：10153777
> 
> 赞同：2
> 
> 时间：2012-04-14T12:52:35.780
> 
> 标签：java, objective-c

我同时为 Android 和 iOS 开发原生应用程序。我知道没有“好的”方法可以编写一次代码并让它在两个平台上运行——技术上是的，我可以使用 Phonegap，但从用户的角度来看，由于平台的差异，它们不会像原生应用程序.

但是有没有办法在两个平台之间共享控制器代码的子集？我说的是“隐形”代码，即与（直接）绘制 UI 无关且不使用 iOS 和 Android 框架的代码。例如，如果我正在开发愤怒的小鸟，实现控制小鸟飞行轨迹的物理方程的最佳方法是什么？我如何最好地在两个平台之间共享这种代码？“最佳”是指我如何 1) 最大限度地缩短开发时间，2) 简化维护，以及 3) 简化未来的升级。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T13:13:03.077

我看到的选项：

1.  **使用服务器端计算逻辑**，然后任何 UI 都可以在任何平台上显示它。但是，此选项将需要网络连接，或者可能由于 ping 导致响应缓慢。

2.  **用 C/C++ 编写通用代码。**这个选项更复杂，但它会在 100% 的情况下工作，因为 c/c++ 编译为本机代码，这意味着几乎所有操作系统都支持它。

3.  **用 Python、LUA 等脚本语言编写通用代码**……这将需要客户端的解释器。如果您在每一帧上执行脚本并在其中执行复杂的逻辑，也可能存在性能问题。

4.  **使用 phoneGap/mono/marmelade** ...... 这将限制本机功能，您将始终依赖第 3 方而不是本机 SDK。但是，如果您开发 openGL es 游戏，也许 marmelade 是要走的路。

在我看来，C/C++ 是可行的方法，特别是如果您正在开发游戏并且不想将自己限制在一个平台上。

PS：如果我正在开发像愤怒的小鸟这样的游戏，我会使用 BOX2d 而不是自己实现物理。

编辑：本机代码仅在 windows phone 8 上支持

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:10:27.253

用 C 语言编写可能是答案。

Objective C 只是 C 的超集，您可以将模型层编写为 c 函数的包装器。

根据[这篇文章](http://www.linux-mag.com/id/7697/)，您可以使用 JNI 在 Android 中做一些非常相似的事情。

正如您所说，这仅适用于模型层。您必须为 iOS 中的视图和控制器层编写 Objective C，并且您将在 Android 上处于相同的情况。

# java - 我无法将文件从资产复制到外部存储

> ID：10153778
> 
> 赞同：1
> 
> 时间：2012-04-14T12:52:47.403
> 
> 标签：java, android, android-assets

我正在制作一个 Android 应用程序，我想添加两个名为`fsx.xml`和的文件`xplane.xml`。这是我正在使用的代码，它运行完美，没有错误，但`/planesim`只是显示为空。请帮忙！

```
String planesimFolderName = "/planesim";
String fsxFile = "fsx.xml";
String xplaneFile = "xplane.xml";
String asset;
File assetDestination;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.splash);
    final File planesimFolder = new File(Environment.getExternalStorageDirectory() + planesimFolderName);
    final AssetManager assetManager = getAssets();
    for (int fileCount = 1; fileCount == 2; fileCount++) {
        if (fileCount == 1) {
            asset = fsxFile;
        } else if (fileCount == 2) {
            asset = xplaneFile;
        }
        assetDestination = new File(Environment.getExternalStorageDirectory() + planesimFolderName + "/" + asset);
        try {    
            InputStream in = assetManager.open(asset);
            FileOutputStream f = new FileOutputStream(assetDestination); 
            byte[] buffer = new byte[1024];
            int len1 = 0;
            while ((len1 = in.read(buffer)) > 0) {
            f.write(buffer, 0, len1);
            }
            f.close();
        } catch (Exception e) {
            Log.d("CopyFileFromAssetsToSD", e.getMessage());
        }
    }
} 
```

感谢您的时间和帮助，zeokila。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:04:51.903

这是你的错误：

```
for (int fileCount = 1; fileCount == 2; fileCount++) 
```

这就像：

```
int fileCount = 1;
while(fileCount == 2) // never true... 
```

for 循环从未执行（因为`1 != 2`），应该是：

```
for (int fileCount = 1; fileCount <= 2; fileCount++) 
```

# eclipse - 提供从 Eclipse 插件到工作区的库

> ID：10153784
> 
> 赞同：3
> 
> 时间：2012-04-14T12:54:20.413
> 
> 标签：eclipse, junit, eclipse-plugin

JUnit 做同样的事情，我只是不知道如何......

![Eclipse junit 快速修复](../Images/421020d3c686e2931ddc71be659ae18b.png)

我猜那是因为 Properties > Java Build Path > Libraries > Add Library 向导中的这个条目：

![Eclipse junit 添加库](../Images/9e8e008f0768194b42494301a5c9eaee.png)

我该如何做同样的事情并从我的插件中将我的库包含在此向导中，即使其对工作区中的用户可用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T19:40:14.423

好的，您需要查看三个不同的扩展点。最简单的方法是看JUnit插件本身（有四个）

```
org.eclipse.jdt.junit: git://dev.eclipse.org/org.eclipse.jdt/org.eclipse.jdt.junit.git
org.eclipse.jdt.junit.core: git://dev.eclipse.org/org.eclipse.jdt/org.eclipse.jdt.junit.core.git
org.eclipse.jdt.junit.runtime: git://dev.eclipse.org/org.eclipse.jdt/org.eclipse.jdt.junit.runtime.git
org.eclipse.jdt.junit4.runtime: git://dev.eclipse.org/org.eclipse.jdt/org.eclipse.jdt.junit4.runtime.git 
```

因此，您可以研究 JUnit 插件，但这些是您需要的扩展点：

对于添加库，请查看扩展点[`org.eclipse.jdt.ui.classpathContainerPage`](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.jdt.doc.isv/reference/extension-points/org_eclipse_jdt_ui_classpathContainerPage.html)。从 JUnit plugin.xml：

```
<extension point="org.eclipse.jdt.ui.classpathContainerPage">
  <classpathContainerPage
        name="%JUnitContainerName"
        class="org.eclipse.jdt.internal.junit.buildpath.JUnitContainerWizardPage"
        id="org.eclipse.jdt.junit.JUNIT_CONTAINER">
  </classpathContainerPage>
</extension> 
```

所以这被实现为`JUnitContainerWizardPage`. 这延伸`IClasspathContainerPage`和`IClasspathContainerPageExtension`。

对于 quickfix 和 classpathfix，请参见扩展点[org.eclipse.jdt.ui.quickFixProcessors](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.jdt.doc.isv/reference/extension-points/org_eclipse_jdt_ui_quickFixProcessors.html)和[org.eclipse.jdt.ui.classpathFixProcessors](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.jdt.doc.isv/reference/extension-points/org_eclipse_jdt_ui_classpathFixProcessors.html)。再次从 JUnit plugin.xml 中：

```
<extension point="org.eclipse.jdt.ui.quickFixProcessors">
  <quickFixProcessor
        name="%junitQuickFixProcessor"
        class="org.eclipse.jdt.internal.junit.ui.JUnitQuickFixProcessor"
        id="org.eclipse.jdt.junit.JUnitQuickFixProcessor">
  </quickFixProcessor>
</extension>

<extension point="org.eclipse.jdt.ui.classpathFixProcessors">
  <classpathFixProcessor
        name="%junitClasspathFixProcessor"
        class="org.eclipse.jdt.internal.junit.ui.JUnitClasspathFixProcessor"
        id="org.eclipse.jdt.junit.JUnitClasspathFixProcessor">
        <overrides id="org.eclipse.jdt.ui.text.correction.DefaultClasspathFixProcessor">
        </overrides>
  </classpathFixProcessor>
</extension> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T00:06:38.940

除了线程中已经提到的扩展点：

初始化容器的逻辑在 org.eclipse.jdt.junit.core 插件中。

```
 <extension
      point="org.eclipse.jdt.core.classpathContainerInitializer">
      <classpathContainerInitializer
            class="org.eclipse.jdt.internal.junit.buildpath.JUnitContainerInitializer"
            id="org.eclipse.jdt.junit.JUNIT_CONTAINER">
      </classpathContainerInitializer>
   </extension> 
```

# django - PyCharm 2.5 TestRunner 无法导入特定模块

> ID：10153789
> 
> 赞同：6
> 
> 时间：2012-04-14T12:54:55.217
> 
> 标签：django, pycharm

我已经升级到 PyCharm 2.5，同时升级`django-templated-email`到 0.4.3 版。

现在，Django 单元测试不再通过 PyCharm 工作，因为我`ImportError: cannot import name send_templated_mail`在测试控制台输出中遇到错误。

在控制台中运行相同的测试时，不会出现此错误。我觉得这与`send_templated_email`成为其中的一部分有关`templated_email\__init__.py`（我隐约记得有一次类似的问题，但我一生都记不起我是如何解决它的）。

测试对话框中的设置是：

```
Target: <django app name>
Custom settings: <path to dev settings>
Environment variables: PYTHONPATH: <path as set in virtualenv>
Python interpreter: <virtualenv Python interpreter>
Interpreter options: None
Working directory: <path to Django project (where manage.py resides)> 
```

奇怪的是，IDE内部的代码检查并没有报错，`templated_email`通过`from templated_email import send_templated_mail`.

我使用的是 Windows 7，我的 Django 应用程序在 virtualenv 中运行（PyCharm 可以正确识别它）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-03T15:39:51.310

如果您还没有升级到 4.5.x 版，我建议您升级。它修复了许多错误并进行了多项改进。

此外，如果您认为这是 PyCharm 中的错误，请查看他们的错误跟踪/归档站点：

[https://youtrack.jetbrains.com/issues](https://youtrack.jetbrains.com/issues)

# java - 访问 JAR 文件中的资源

> ID：10153790
> 
> 赞同：0
> 
> 时间：2012-04-14T12:55:12.947
> 
> 标签：java, file, resources, path

我正在尝试访问已嵌入 JAR 文件中的资源。需要访问文件的类是：

```
/worldEntities/factories/RoomFactory.class 
```

它试图访问：

```
/map-data/roomDescriptions.xml 
```

为此，我在 RoomFactory.class 中添加了以下代码：

```
Document doc = docBuilder.parse(this.getClass().getResourceAsStream("/map-data" + File.separator + "roomDescriptions.xml")); 
```

当我在 NetBeans 中执行项目时，它运行良好，没有错误。但是，当我尝试从命令行运行代码时，通过输入

```
java -jar Program.jar 
```

我得到一个 java.lang.IllegalArgumentException: InputStream cannot be null，它指向我上面描述的代码。

提前感谢您的帮助，

托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T12:59:14.777

您需要确保将资源与 .jar 捆绑在一起，否则将找不到

[这篇文章](http://capturevision.wordpress.com/2008/06/28/how-to-embed-resource-files-using-netbeans/)应该有助于如何从 NetBeans 做到这一点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:36:33.473

1.  带有`"-"`char 的名称不是有效的 Java 包名称。所以`"map-data"`不是一个有效的包名。

2.  那么`File.separator`在不同的平台上可能会有所不同。在您的代码中使用`"/"`以确保使用有效的包分隔符。

# java - 如何从不同的线程“捕获” System.exit(-1)？

> ID：10153793
> 
> 赞同：1
> 
> 时间：2012-04-14T12:55:21.020
> 
> 标签：java, multithreading, jvm, securitymanager, system.exit

我有以下

```
System.setSecurityManager(new SecurityManager() {
    @Override
    public void checkExit(int status) {
        super.checkExit(status);

        //custom exception extends SecurityException
        throw new SystemExitCalledException();
    }
});

Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler() {
    @Override
    public void uncaughtException(Thread t, Throwable e) {
        //never reaches here somehow... 
        //maybe some3rdPartyStaticMethod sets this, too?
    }

});

try {
    //this method spawns threads and some call System.exit().
    some3rdPartyStaticMethod.invoke(null, new Object[]{args});
} catch (SystemExitCalledException e) {
    //it never reaches here because 
    //SystemExitCalledException is thrown on different thread?? 
    //
} 
```

有没有办法防止 some3rdPartyStaticMethod 的衍生线程的 System.exit() 调用停止 jvm？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T13:01:28.053

您可以在单独的进程中启动代码并使用 RMI 与其通信。如果第三方代码调用`System.exit`并终止其进程，您的进程可以继续运行并在必要时重新创建子进程。

请注意，这种方法有一些注意事项：

*   这两个进程不共享相同的堆空间。
*   您将需要编组在两个进程之间传递的所有数据。这意味着数据必须是可序列化的。
*   每个方法调用都会有相当大的开销。如果您需要每秒进行多次调用，这可能会导致性能问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T13:09:06.420

编写自定义 SecurityManager 策略应该会有所帮助——我自己从来没有这样做过 :)

根据[这篇文章](http://www.experts-exchange.com/Programming/Languages/Java/Q_22847627.html)（向下滚动到底部）：

> 但是，当 VM 中的任何内容尝试调用 System.exit() 时，VM 就会退出。由于这包括对 mvn 的残酷击落，因此正常的 mvn 进程被中断。SecurityManager 可用于阻止代码调用 System.exit()，但没有人提及副作用。
> 
> 我的一位同事提到，您可以在启动 VM 时在系统范围内、每个用户和系统属性中设置策略，经过快速测试，这已证明可以解决我的问题。我已经设法弄清楚如何从我的代码中设置我自己的策略（在设置 SecurityManager 之前），这解决了我的问题。
> 
> 我使用了以下代码：

```
//Setup security to prevent System.exit()
SecurityManager sm = System.getSecurityManager();
URL policy = getClass().getClassLoader().getResource("jsdoc.policy");
System.setProperty("java.security.policy", policy.toString());
System.setSecurityManager(new JSDocSecurityManager(getLog())); 
```

> 使用一个简单的、完全开放的策略文件读取以下内容：

```
grant {
  permission java.security.AllPermission;
}; 
```

如果它有效，它应该捕获`System.exit()`请求并`SecurityException`改为抛出

# ios - 将 iPhone IOS 视频文件上传器转换为使用存储在文档目录中的文件

> ID：10153800
> 
> 赞同：1
> 
> 时间：2012-04-14T12:55:59.990
> 
> 标签：ios, video, upload, nsdata, nsurl

这是我的第一个真正的项目。我有一个应用程序，它使用 AVFoundation 捕获几秒钟的视频，将其输出到文档目录中的文件，并让用户在使用 HTTP 和我的网站上的 PHP 脚本上传视频之前预览视频。

所有的视频捕获和预览工作完美，但我一直在上传视频文件。

我从这个 simpleSDK 视频中学到了很多东西，它展示了如何使用存储在应用程序主包中的视频文件来实现所需的效果。

教程中设置 videoData 准备上传的代码最初如下所示：

```
NSData *videoData = [NSData dataWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"Movie" ofType:@"mov"]];
NSString *urlString = @"http://www.iphonedevnation.com/video-tutorial/upload.php"; 
```

我需要上传的视频文件的文件名始终是唯一的，并且使用 CFUUIDCreateString 生成。我将此字符串加入到文档目录的路径中，在其末尾添加“.mov”并将其保存到文本文件中以供稍后检索。

这一切都有效，因为我能够从文件中检索文件名并使用它在应用程序的其他地方预览影片剪辑。

我的路径在 NSString 中，我尝试将其转换为 NSURL 并删除文件后缀以使其与 NSData *videoData.........行一起使用，但它无法编译，我得到一个“选择器“dataWithContentsOfFile:ofType”没有已知的类方法。错误。我的目标是 iOS 5，并使用带有 ARC 和 Storyboards 的 Xcode 4.3。

我已经在这里呆了 5 个小时，所以希望有人能提供帮助。我的代码，其中包括来自其他地方的关于从 NSString 转换为 NSURL 的提示，如下所示：

```
NSString *content = [[NSString alloc] initWithContentsOfFile:lastSavedTalentFilenamePath 
              usedEncoding:nil
              error:nil];

NSLog(@"content=%@",content);

//Need to now remove the '.mov' file type identifier
NSString *shortContent= [content substringToIndex:[content length]-4];
NSLog(@"***************shortContent***************%@", shortContent);

NSURL *convertedContent = [NSURL fileURLWithPath:shortContent];
NSLog(@"***************convertedContent***********%@",convertedContent);

NSData *videoData = [NSData dataWithContentsOfFile:convertedContent ofType:@"mov"];]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:03:12.687

没有名为 dataWithContentsOfFile:ofType 的 NSData 方法：

可用的方法有：

```
+ dataWithContentsOfFile:
+ dataWithContentsOfFile:options:error: 
```

两者都将文件位置作为 NSString，因此无需转换为 NSURL

# ruby - 没有返回组的正则表达式拆分

> ID：10153801
> 
> 赞同：0
> 
> 时间：2012-04-14T12:56:11.760
> 
> 标签：ruby, regex, string, split

我需要通过`<br>`重复 2 次或更多次的分隔符拆分字符串。我正在做：

```
'a<br><br><br><br>b'.split(/(<br>){2,}/) 
```

[不幸的是，它根据String.split](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-split)规范将该组作为标记之一返回：

```
["a", "<br>", "b"] 
```

我如何使它**不**返回组，只获取令牌：

```
["a", "b"] 
```

?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T12:58:19.043

您可以通过添加到捕获组使其成为非捕获`?:`组。

```
'a<br><br><br><br>b'.split(/(?:<br>){2,}/) 
```

# android - Android开发——SQLite存储浮点数

> ID：10153809
> 
> 赞同：4
> 
> 时间：2012-04-14T12:57:25.677
> 
> 标签：android, sqlite, floating-point

当我存储浮点值 widt SQLiteDatabase.insert 时，存储的值将与原始值不同，见下文：

我有一个数据库宽度：

```
db.execSQL("CREATE TABLE IF NOT EXISTS info_values ("
    + BaseColumns._ID + " INTEGER PRIMARY KEY AUTOINCREMENT, "
    + "date DATE UNIQUE NOT NULL, "
    + "value REAL NOT NULL)"); 
```

当我插入例如 33.3 宽度时：

```
private class inputdlg_ok implements input_dlg.ReadyListener {
    public void ready(float newvalue) {
      Date d = new Date();
      SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
      ContentValues values = new ContentValues();
      values.put("date", sdf.format(d));
      values.put("value", newvalue);

      database.insert("info_values", null, values); 
```

我有这些：

```
sqlite> select * from info_values;
83|2012-04-04 09:06:22|33.2999992370605
84|2012-04-02 09:05:57|22.2000007629395 
```

我已经测试了宽度执行：

```
 String sql = "INSERT INTO info_values (date, value) " + 
              "VALUES ('" + sdf.format(d) + "'," + Float.toString(newvalue) + ")";
database.execSQL(sql); 
```

这种形式效果很好。

任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-14T13:11:51.530

[从来没有想过这个线程会](https://stackoverflow.com/q/9044728/1108032)帮助其他人，但唉，它就在这里。

基本上你的问题是你使用`float`java代码中的类型。浮点数的精度非常低。阅读我链接到的主题，以及所有评论和链接的聊天。如果您仍然有任何问题，请回信。

您可能知道双精度值在计算机中仅以特定精度存储。尽管数据库中的值看起来很奇怪，但这是您在使用 float 时可以获得的值的最佳近似值。使用 double 你可以提高精度，但你永远不会达到完美状态。也许如果您坚持获取限制数据库中实际大小的精确值可能是一种方法。

**编辑**因为我不能让你相信这是一个精度问题，所以我包括以下程序：

```
float f = 22.2;
printf("The number is: %.9f\n", f); 
```

输出是：

```
22.200000763 
```

我建议你试试看。如您所见，这正是您指出的数字。

# c++ - 如何使用成员函数指针作为模板 arg 实例化类

> ID：10153810
> 
> 赞同：2
> 
> 时间：2012-04-14T12:57:50.053
> 
> 标签：c++, templates

我有

```
template <void (*T)(Entity *), typename Caller>
class Updater 
{
public:
    Updater(Caller c):m_caller(c){}
    void process(Entity * e)
    {
        (m_caller->*T)(e);              //Is this right?
    }
private:
    Caller m_caller;
}; 
```

我知道我可以像这样实例化它

```
Foo f;
Updater<&Foo::Bar> updater(&f); 
```

假设`Foo`有

```
void Foo::Bar(Entity *e); 
```

但是如果它有所需的方法怎么办？像这样

```
template <typename T>
void Bar(T t); 
```

我应该如何实例化它？像这样：？

```
Foo f;
Updater<&Foo::Bar<Entity *>> updater(&f); 
```

当我在我的真实代码中这样做时，我得到

`invalid template argument for ..., expected compile-time constant expression`

所以2个问题：

1、`(m_caller->*T)(e);`正确吗？如果不是，我怎么叫它？

2、如何实例化它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:33:16.713

```
template <typename Caller, void (Caller::*Func)(Entity *)>
class Updater 
{
public:
    Updater(Caller *c):m_caller(c){}
    void process(Entity * e)
    {
        (m_caller->*Func)(e); // use pointer to member operator ->*
    }
private:
    Caller *m_caller;
};

// call like this
Foo f;
Updater<Foo, &Foo::Bar> updater(&f); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:40:56.087

**编辑：**

user2k5 编辑了他的答案，所以我接受了。

**我之前的消息：**

感谢 user2k5 我找到了正确的工作代码，

工作示例如下：（Foo2 可以替换为 Foo）

```
#include <iostream>

struct Entity { int i; };

template < typename Caller, void (Caller::*Func)(Entity *)>
class Updater 
{
public:
    Updater(Caller *c):m_caller(c){}
    void process(Entity * e)
    {
        (m_caller->*Func)(e);
    }
private:
    Caller *m_caller;
};

struct Foo
{
    void bar(Entity * e) 
    {
        std::cout << e->i << std::endl;
    }
};

struct Foo2
{
    template <typename T>
    void bar(T t)
    {
        std::cout << t->i << std::endl;
    }
};

int main ()
{
    Foo2 f;
    Updater<Foo2, &Foo2::template bar<Entity *>> updater(&f);
    Entity e;
    e.i = 5;
    updater.process(&e);

    return 0;
} 
```

# java - 在 netbeans 中运行 Web 应用程序

> ID：10153816
> 
> 赞同：4
> 
> 时间：2012-04-14T12:58:51.803
> 
> 标签：java, tomcat, maven, netbeans

我正在使用 netbeans 和 apache tomcat 来运行 Web 应用程序。我不断收到此错误：

```
In-place deployment at C:\WorkingDirectory\Projects\GreenWheelsProject\GreenWheels-Java\green-wheels-project\share-wheels\target\share-wheels
deploy?config=file%3A%2FC%3A%2FDOCUME%7E1%2F0DD4%7E1%2FLOCALS%7E1%2FTemp%2Fcontext600644043101946969.xml&path=/
FAIL - Deployed application at context path / but context failed to start
The module has not been deployed.
See the server log for details.
    at org.netbeans.modules.j2ee.deployment.devmodules.api.Deployment.deploy(Deployment.java:210)
    at org.netbeans.modules.maven.j2ee.ExecutionChecker.performDeploy(ExecutionChecker.java:179)
    at org.netbeans.modules.maven.j2ee.ExecutionChecker.executionResult(ExecutionChecker.java:131)
    at org.netbeans.modules.maven.execute.MavenCommandLineExecutor.run(MavenCommandLineExecutor.java:211)
    at org.netbeans.core.execution.RunClassThread.run(RunClassThread.java:153) 
```

服务器日志是：

```
אפר 14, 2012 3:55:00 PM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Error configuring application listener of class com.sun.faces.config.ConfigureListener
java.lang.ClassNotFoundException: com.sun.faces.config.ConfigureListener
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1678)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1523)
    at org.apache.catalina.core.DefaultInstanceManager.loadClass(DefaultInstanceManager.java:525)
    at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:507)
    at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:126)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4660)
    at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5226)
    at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5221)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)

אפר 14, 2012 3:55:00 PM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Skipped installing application listeners due to previous error(s) 
```

服务器的输出是：

```
אפר 14, 2012 3:54:59 PM org.apache.catalina.util.LifecycleBase stop
INFO: The stop() method was called on component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[]] after stop() had already been called. The second call will be ignored.
אפר 14, 2012 3:54:59 PM org.apache.catalina.startup.HostConfig checkResources
INFO: Undeploying context []
אפר 14, 2012 3:54:59 PM org.apache.catalina.startup.HostConfig deployDescriptor
INFO: Deploying configuration descriptor ROOT.xml from C:\Documents and Settings\נאור\.netbeans\7.1.1\apache-tomcat-7.0.22.0_base\conf\Catalina\localhost
אפר 14, 2012 3:54:59 PM org.apache.catalina.loader.WebappClassLoader validateJarFile
INFO: validateJarFile(C:\WorkingDirectory\Projects\GreenWheelsProject\GreenWheels-Java\green-wheels-project\share-wheels\target\share-wheels\WEB-INF\lib\javaee-api-6.0.jar) - jar not loaded. See Servlet Spec 2.3, section 9.7.2\. Offending class: javax/servlet/Servlet.class
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jstl/core_rt is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jstl/core is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jsp/jstl/core is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jstl/fmt_rt is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jstl/fmt is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jsp/jstl/fmt is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jsp/jstl/functions is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://jakarta.apache.org/taglibs/standard/permittedTaglibs is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://jakarta.apache.org/taglibs/standard/scriptfree is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jstl/sql_rt is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jstl/sql is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jsp/jstl/sql is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jstl/xml_rt is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jstl/xml is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jsp/jstl/xml is already defined
אפר 14, 2012 3:55:00 PM org.apache.catalina.core.StandardContext startInternal
SEVERE: Error listenerStart
אפר 14, 2012 3:55:00 PM org.apache.catalina.core.StandardContext startInternal
SEVERE: Context [] startup failed due to previous errors 
```

这是我的POM：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.success</groupId>
  <artifactId>share-wheels</artifactId>
  <packaging>war</packaging>
  <version>1.0-SNAPSHOT</version>
  <name>share-wheels Maven Webapp</name>
  <url>http://maven.apache.org</url>
  <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>3.8.1</version>
      <scope>test</scope>
    </dependency>
  </dependencies>
  <build>
    <finalName>share-wheels</finalName>
  </build>
</project> 
```

这里有什么问题？？？

***编辑：***
当我将以下内容添加到 thw pom 文件时，会出现此问题：

```
<dependency>
    <groupId>javax</groupId>
    <artifactId>javaee-api</artifactId>
    <version>6.0</version>
</dependency> 
```

为什么是这样？我需要 HttpServletRequest 的这种依赖关系。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-14T19:51:08.640

用于`<scope>provided</scope>`指示您需要编译该工件，但不要在您的战争中使用它。

```
<dependency>
    <groupId>javax</groupId>
    <artifactId>javaee-api</artifactId>
    <version>6.0</version>
    <scope>provided</scope>
</dependency> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-15T03:49:25.567

我遇到了与 Naor 相同的部署失败。我的 Tomcat webapps 文件夹没有默认 Tomcat dist 附带的管理器模块（我已删除！）。因此，当 NetBeans 尝试在 Web 容器 (Tomcat) 上进行部署时，它会失败，因为没有管理器模块。恢复管理器模块可解决错误消息。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-14T13:57:05.077

右键单击..进行清理并构建！！！我在 netbeans 中开发 Spring Web MVC 应用程序时遇到了这个问题。通常清理和构建工作

# smalltalk - 在 smalltalk 中重新定义 nil 以响应任何消息

> ID：10153818
> 
> 赞同：1
> 
> 时间：2012-04-14T12:59:09.100
> 
> 标签：smalltalk, null, pharo, method-missing

我想重新定义 smalltalk 的**nil**以像*objective-c*中的那样工作。因此，当**nil**收到无法处理的消息时，它会返回*nil*。现在我知道这`nil`只是一个快捷方式，但是在*Ruby*`UndefinedObject`中是否有类似的东西，所以我可以重新定义它以始终返回*nil*？`method_missing`*`UndefinedObject`*

 *** * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-14T15:10:37.007

您正在寻找的方法`doesNotUnderstand:`在 Smalltalk 中被调用。您确实可以实现：

```
UndefinedObject>>doesNotUnderstand: aMessage
    ^ nil 
```

但是，请记住，这会影响整个系统，并且可能会产生微妙的副作用或在系统的其他部分引入错误。

另请注意，`UndefinedObject`它不是原始类型，而是继承自`Object`. 因此`nil`，已经理解了大量的消息，并且可能不会像您期望的来自 Objective-C 的那样表现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T12:03:50.337

考虑创建您自己的实现#doesNotUnderstand: 的 Null 单例类，这样您就不会修改 nil。将超类设为 nil（如 Object）。

在需要的情况下回答类似“^Null instance”而不是“^nil”的内容。

```
Null instance badMethod  --> nil 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T17:06:06.680

如果你是唯一一个会处理这个代码的人，我说去吧。

另一方面，如果这是某个公司拥有的产品，它不是“您”的同义词，并且其他人可能在某些时候必须维护它，我强烈建议您不要这样做。在 Smalltalk 的核心修改类是让你大吃一惊的经典方法之一。（我曾经认识一个这样做的人。他*不*开心......之后总是一瘸一拐。有趣的老东西，生活......）。

分享和享受。**

# python - 无法写入文件

> ID：10153820
> 
> 赞同：1
> 
> 时间：2012-04-14T12:59:28.733
> 
> 标签：python, file-io, io, python-2.7

这有点奇怪。我的程序无法将输出写入文件。它甚至没有显示任何错误。我同时使用标准输出，发现它的显示..

这是我的代码：（Python 2.7）

```
#!/usr/bin/env python

import re

def isRecycled(n,m):
    n = str(n)
    m = str(m)

    try:
        ...........
        ...........
        My Code.

    except ValueError:
        return False

ip = open("C-small-attempt0.in", "r")
op = open("output.txt", "a")
for num, eachLine in enumerate( ip.readlines()[1:] ):
    ......
    ......
    My code

    ## This is WORKING
    print "Case #%d: %d" %(num+1, count)

    ## This is NOT Working
    op.write("Case #%d: %d" %(num+1, count)) 
```

谁能告诉我为什么这不写入文件。

我尝试使用`"w+"`,`"w"`模式和`writelines()`方法，但它们没有用。

**已编辑**

但是，当我使用关闭文件时它起作用了`op.close()`

1.  为什么会这样？（之前没遇到过）
2.  python一找到就立即写入文件`op.write()`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:04:29.520

您需要关闭文件才能将其写入磁盘。将 op.close() 添加到代码的末尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T13:03:37.057

确保在更改后刷新或关闭文件以确保将缓冲区写入磁盘。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-14T13:07:32.327

尝试做：

```
op = open("output.txt", "ab") 
```

代替：

```
op = open("output.txt", "a") 
```

# javascript - 将循环中的对象转换为元素并将其添加到现有结果中

> ID：10153825
> 
> 赞同：1
> 
> 时间：2012-04-14T13:00:01.033
> 
> 标签：javascript, jquery

```
$.each(data, function(i,item){
    var img = $('<img>');
    img.attr('src', item.thumb);
    img.attr('width', item.width);
    img.attr('height', item.height);
    o += '<li><a href="#">'+img+'<h3>'+item.title+'</h3><p>'+item.excerpt+'</p></a></li>';
}); 
```

以上输出

```
li>[object] <h3>title</h3><p>excerpt</p></li> 
```

我的问题是图像标签。我知道我只是附加一个图像对象而不是元素......并且使用 appendto 会起作用，但在上述场景中，在一个循环中，我该如何完成这个。而不是显示 [object] 如何显示图像标签。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T13:06:13.813

这是修改 DOM 的糟糕方法。你应该使用普通的 DOM 方法，这样你就不会陷入这种混乱。

但是，如果您**必须**这样做。

导致的问题是对象`toString()`被隐式调用，指定返回对象的内部类在`[object [[Class]]`哪里。`[[Class]]`这就是为什么你得到而不是元素`[object Object]`的 HTML 。`img`

您可以*像这样获得外部 HTML...*

```
var imgOuterHtml = img.prop('outerHTML')
                   || '<img ' + 
                      []
                       .reduce
                       .call(img.prop('attributes'),
                             function(attrSerialised, attr) {
                                 return attrSerialised + 
                                        ' ' + attr.nodeName + 
                                        '="' + attr.nodeValue + '"';
                             },
                        '')
                       + '/>'; 
```

[js小提琴](http://jsfiddle.net/CjKh5/)。

`new XMLSerializer().serializeToString(element)`如果`outerHTML`属性不存在，您也可以使用它，但它只会返回 XML，例如空元素始终为空。

您还可以创建一个临时元素，例如 a `div`，设置它`innerHTML`，然后获取外部`div`的`innerHTML`。

但是，**请**不要这样做。使用 jQuery 封装的 DOM 修改方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:08:24.197

您必须从对象中获取 html。有十几种或更多方法可以做到这一点。一种方法是`img[0].outerHTML`在 jQuery 选择器对象中为您提供原始 DOM 元素，然后是该元素的外部 html。

```
 $.each(data, function(i,item){
    var img = $('<img>');
    img.attr('src', item.thumb);
    img.attr('width', item.width);
    img.attr('height', item.height);
    o += '<li><a href="#">'+img[0].outerHTML+'<h3>'+item.title+'</h3><p>'+item.excerpt+'</p></a></li>';
}); 
```

# c# - 泛型方法参数的接口约束

> ID：10153826
> 
> 赞同：17
> 
> 时间：2012-04-14T13:00:03.280
> 
> 标签：c#, generics

为了正确理解 C#，我发现自己在问，在泛型方法参数上指定接口约束和简单地将接口指定为参数类型之间有什么实际区别？

```
public interface IFoo
{
    void Bar();
}

public static class Class1
{
    public static void Test1<T> (T arg1) where T : IFoo
    {
        arg1.Bar();
    }

    public static void Test2(IFoo arg1)
    {
        arg1.Bar();
    }
} 
```

**编辑**

我知道我的例子非常狭窄，因为它只是一个例子。我对超出其范围的差异非常感兴趣。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-14T13:04:58.273

在您的具体示例中没有区别。但采取以下方法：

```
public static class Class1
{
    public static T Test1<T>(T arg1) where T : IFoo
    {
        arg1.Bar();
        return arg1;
    }

    public static IFoo Test2(IFoo arg1)
    {
        arg1.Bar();
        return arg1;
    }
} 
```

`Test1`将返回 arg1 的特定类型，而`Test2`仅返回接口。这通常用于流畅的界面。

* * *

扩展示例：

```
public interface IFoo
{
    void Bar();
}

public class Foo : IFoo
{
    // implementation of interface method
    public void Bar()
    {
    }

    // not contained in interface
    public void FooBar()
    {
    }
}

var foo = new Foo();
Class1.Test1(foo).FooBar(); // <- valid
Class1.Test2(foo).FooBar(); // <- invalid 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-14T13:06:55.850

您给出的示例没有任何区别。另一方面，使用通用版本使您能够`where T : IFoo, IOther`在将来扩展约束列表 ( )，而无需更改方法签名。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-14T13:42:25.587

我只想强调其他人给出的答案。

`Test(IFoo foo)`和之间有区别`Test<T>(T foo) where T : IFoo`。有一个真正的区别，就像`List<object>`（或者，比如说`ArrayList`，它接收一个`object`）和`List<string>`.

`Test (IFoo foo)`, 为您提供多态性和类型继承的好处，就像`List<object>`. 它允许您构建一个处理所有`IFoo`类型的类。但有时我不只是想要多态性，我想要一个只能保存字符串的列表——并且`List<string>`不需要我在`ArrayList`.

你的代码也一样。假设我有一个`class Comparer<T> where T:IFoo`. 我希望能够使用这个类来`Foo1`相互比较对象，或者相互比较`Foo2`，但我不希望能够`Foo1`与`Foo2`. 强类型泛型方法将强制执行此操作，而多态方法则不会：

```
public class Comparer
{
    public bool Compare1<T>(T first, T second) where T : IFoo {...}
    public bool Compare2 (IFoo first, IFoo second) {...}
}

Foo1 first = new Foo1();
Foo2 second = new Foo2();
myComparer.Compare1(first, second); // won't compile!
myComparer.Compare2(first, second); // Compiles and runs. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T13:08:24.540

这完全是类型转换的问题。如果您的方法必须返回 T，那么 Test1 将不需要强制转换，并且由于 Test2 只返回一个接口，您将需要显式或隐式类型强制转换来获得最终类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-14T13:27:21.500

通常，界面约束与例如`IFoo, new()`

...它允许您`T`完全操纵对象，创建，初始化集合等 - 并按照建议返回 T 。虽然只有接口，但您不知道它到底是哪个类（T）。

# mysql - SQL 从数据库中提取随机图像

> ID：10153827
> 
> 赞同：1
> 
> 时间：2012-04-14T13:00:08.557
> 
> 标签：mysql, sql, database, image, random

当涉及到 SQL 时，我知道几乎为零。

我一直在查看我拥有的主题的代码，它正在按顺序提取图像

```
$get_imgs = mysql_query("SELECT file FROM uploaded_images ORDER BY id DESC LIMIT 0, $results"); 
```

如何将顺序更改为随机？

我可以将 ORDER 更改为 RANDOM 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T13:02:04.687

```
$get_imgs = mysql_query("SELECT file FROM uploaded_images ORDER BY RAND() LIMIT 0, $results"); 
```

# javascript - javascript中嵌套数组和引用的副本

> ID：10153831
> 
> 赞同：1
> 
> 时间：2012-04-14T13:01:21.830
> 
> 标签：javascript

以下 javascript 代码 [ [jsfiddle](http://jsfiddle.net/AlexZeitler/U4cpa/4/) ]：

```
Array.prototype.remove = function(from, to) {
    var rest = this.slice((to || from) + 1 || this.length);
    this.length = from < 0 ? this.length + from : from;
    return this.push.apply(this, rest);
};

var masterlist = [{
    name: "Master1"},
{
    name: "Master2"}];
var parentlist = [{
    name: "Parent1"},
{
    name: "Parent2"}];
var childlist = [{
    name: "Child1"},
{
    name: "Child2"}];

for (var i = 0; i < masterlist.length; i++) {
    var master = masterlist[i];
    master.parents = parentlist.slice();
    for (var j = 0; j < master.parents.length; j++) {
        var parent = master.parents[j];
        parent.children = childlist.slice();
    }
}

console.log("before removing")
console.log("master1 parents: " + masterlist[0].parents.length);
console.log("master2 parents: " + masterlist[1].parents.length);
console.log("master1 parent 1 childrens: " + masterlist[0].parents[0].children.length);
console.log("master2 parent 2 childrens: " + masterlist[1].parents[1].children.length);

masterlist[0].parents.remove(0);
masterlist[0].parents[0].children.remove(0);

console.log("after removing")
console.log("master1 parents: " + masterlist[0].parents.length);
console.log("master2 parents: " + masterlist[1].parents.length);
console.log("master1 parent 1 childrens: " + masterlist[0].parents[0].children.length);
console.log("master2 parent 2 childrens: " + masterlist[1].parents[1].children.length);? 
```

结果是：

> 移除
> master1 父母之前：2
> master2 父母：2
> master1 父母 1 孩子：2
> master2 父母 2 孩子：2
> 移除
> master1 父母：1
> master2 父母：2
> master1 父母 1 孩子：1
> master2 父母 2 孩子：1

我希望（并且需要）这个：

> 删除
> master1 父母之前：2
> master2 父母：2
> master1 父母 1 孩子：2
> master2 父母 2 孩子：2
> 移除
> master1 父母后：1
> master2 父母：2
> master1 父母 1 孩子：1
> master2 父母 2 孩子：2 <-- 差异

我究竟做错了什么？看起来孩子们指的是同一个数组，我也对初始子数组进行了切片（它确实与父数组按预期工作）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T22:48:22.243

看看[http://de.selfhtml.org/javascript/objekte/array.htm#slice](http://de.selfhtml.org/javascript/objekte/array.htm#slice)可以提供一个潜在的答案（由我翻译）：

"Please note: If there is an object contained within the array, the newly created array contains a reference to that object. That means: If the object is changed, so does the array that was created using slice(). If numbers and strings are contained, they are copied."

Should explain why both change, shouldn't it?

# iphone - NSString解析连续数据

> ID：10153834
> 
> 赞同：1
> 
> 时间：2012-04-14T13:02:01.813
> 
> 标签：iphone, objective-c, ipad, parsing, nsstring

早上好，

我正在从连接到 iPad 的串行设备中检索字节流。连接后，提供的 SDK 将使用已转发的字节调用委托方法。

串口设备通过 SDK 转发的读数格式如下：

```
!X1:000.0; 
```

一旦连接到串行设备，委托的方法将立即开始接收数据 - 这可能处于各种完成状态，即

```
:000.00; 
```

我需要做的是建立一种具体的方法来拆分从串行设备返回的读数，以便我可以操作数据。

一些尝试过的选项是：

只需将接收到的字符串连接一段固定的时间，然后在“;”上拆分 NSString 特点。虽然这有点低效，并且不允许我动态操作数据

```
-(void)receivingDelegateMethod:(NSString *)aString    {
      if(counter < 60){
          [self.PropertyString stringByAppendingString:aString];
      }else{
          NSArray *readings = [self.PropertyString componentsSeparatedByString: @";"];
      }    
} 
```

通过寻找“！”确定起点 字符，然后将生成的子字符串附加到 NSString 属性。之前对委托方法的所有调用都将附加到此属性，然后删除前 10 个字符。

我知道还有其他选项，例如 NSScanners 和 RegEx，但我想在浪费更多时间使用不同方法之前获得社区的意见。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:13:54.953

制作一个`BOOL`指示流已初始化的标志，并将其设置为 false。当您收到下一个数据块时，首先检查标志。如果未设置，请跳过所有字符，直到看到感叹号`'!'`。一旦你看到它，丢弃它前面的所有内容，并将字符串的其余部分复制到缓冲区中。如果设置了“已初始化”标志，则将整个字符串附加到缓冲区而不跳过字符。

完成追加后，扫描缓冲区以查找`!`和`;`分隔的部分。对于该模式的每次出现，使用该模式的完整部分调用指定的方法。您可以花哨，并定义自己的“辅助”委托来处理预先验证的字符串。

您可能需要检测断开连接，并将“已初始化”标志设置回`NO`.

# heroku - 不能将 PSQL 与 Heroku 共享数据库一起使用

> ID：10153840
> 
> 赞同：1
> 
> 时间：2012-04-14T13:03:14.933
> 
> 标签：heroku, postgresql

我正在开发一个应用程序并将其托管在 Heroku 上。现在，我想使用免费的共享数据库解决方案。

我的问题是我无法访问数据库。

```
$ heroku pg:psql
 !    Cannot ingress to a shared database 
```

我在其他地方读到我无法通过 psql 连接到共享数据库。

我似乎在 Heroku 的开发中心上找不到任何相关信息，所以这给我留下了一个问题——如何编辑、更改或对我的数据库做任何事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T17:38:46.653

如果您乐于使用 beta 插件，那么还有 Heroku Shared PostgreSQL 9.1 插件 (https://addons.heroku.com/heroku-shared-postgresql)，它允许您进入数据库。

但是，对数据库的任何更改通常最好通过脚本迁移（在 Ruby on Rails 世界中）完成，而不是连接到数据库进行更改。

如果您更熟悉 mySQL，那么有许多 mySQL 插件允许使用普通的 mySQL 工具直接访问。

# cakephp - 如何在 CakePHP 中正确覆盖模型的构造函数

> ID：10153841
> 
> 赞同：4
> 
> 时间：2012-04-14T13:03:28.520
> 
> 标签：cakephp, testing, constructor, overwrite

我在 CakePHP 2.0 中测试模型时遇到了麻烦，问题似乎出在模型的构造函数上。

```
public function __construct(){
    parent::__construct(); 
    $this->_pagi_cuantos = 2;
} 
```

即使我删除了它的所有内容，我仍然在尝试运行测试时遇到问题。

马克故事告诉我：

> 如果你有一个构造函数，请确保你正确地覆盖了构造函数。不这样做会导致这样的错误。

我错了什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-14T13:28:28.963

你为什么不看看它的开源核心代码： [https ://github.com/cakephp/cakephp/blob/2.1/lib/Cake/Model/Model.php#L653](https://github.com/cakephp/cakephp/blob/2.1/lib/Cake/Model/Model.php#L653)

所以对于你所有的模型：

```
public function __construct($id = false, $table = null, $ds = null) {
    parent::__construct($id, $table, $ds);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-05T22:16:03.983

与其重写构造函数，不如将 beforeFilter() 用于控制器或模型的 before 方法，例如 beforeFind()、beforeValidate() 等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-28T20:04:07.880

我发现的一种方法是做这样的事情：

```
function __construct() {
    call_user_func_array(array('parent', '__construct'), func_get_args());
} 
```

它使您不必担心父母会通过什么。尽管该代码非常可怕。

# javascript - 按两个属性对对象数组进行排序

> ID：10153846
> 
> 赞同：25
> 
> 时间：2012-04-14T13:03:48.900
> 
> 标签：javascript, sorting

我有一个对象数组，我想按两个属性排序：

1.  提醒时间戳
2.  修改时间戳

排序顺序：desc

按一个属性对这个对象进行排序不是问题，但在这种情况下，我不知道如何让它工作。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-14T13:45:16.303

假设时间戳本身排序正常（例如 ISO8601 和同一时区），请尝试：

```
myArray.sort(function(a,b) {
  var x = a.RemindingTimestamp - b.RemindingTimestamp;
  return x == 0? a.ModificationTimestamp - b.ModificationTimestamp : x;
} 
```

### 编辑 - 回复评论

通过更改减法的顺序或将结果乘以 -1 来实现降序排序。由于不减去而未排序的日期（例如 2012-04-12）可以通过首先转换为日期来处理，例如

```
// Convert ISO8601 date string to date object
// Assuming date is ISO8601 long format, ignores timezone
function toDate(s) {
  var bits = s.split(/[-T :]/);
  var d = new Date(bits[0], bits[1]-1, bits[2]);
  d.setHours(bits[3], bits[4], parseFloat(bits[5])); 
  return d;
}

// Source data, should end up sorted per n
var myArray = [ 
  {RemindingTimestamp: '2012-04-15T23:15:12Z', 
   ModificationTimestamp: '2012-04-15T23:15:12Z', n: 4},
  {RemindingTimestamp: '2012-04-12T23:15:12Z', 
   ModificationTimestamp: '2012-04-12T23:15:12Z', n: 1},
  {RemindingTimestamp: '2012-04-12T23:15:12Z', 
   ModificationTimestamp: '2012-04-13T23:15:12Z', n: 2},
  {RemindingTimestamp: '2012-04-12T23:15:12Z', 
   ModificationTimestamp: '2012-04-13T23:15:14Z', n: 3}
];

// Sort it
myArray.sort(function(a,b) {
  var x = toDate(a.RemindingTimestamp) - toDate(b.RemindingTimestamp);
  return x? x : toDate(a.ModificationTimestamp) - toDate(b.ModificationTimestamp);
});

// Just to show the result
function sa(o) {
  var result = [], t;
  for (var i=0; i<o.length; i++) {
    t = o[i]; 
      result.push(t.n);
  }
  alert(result);
}

sa(myArray); // 1,2,3,4 
```

如果需要，可以扩展日期字符串到日期对象的转换以处理时区（仅对于符合 ISO8601 的字符串，那些使用时区缩写而不是实际偏移量的字符串是不可靠的）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-14T13:11:14.767

```
function compareObject(obj1, obj2){
    if(obj1.RemindingTimestamp > obj2.RemindingTimestamp)
        return - 1;
    if(obj2.RemindingTimestamp > obj1.RemindingTimestamp)
        return 1;

    // obj1.RemindingTimestamp == obj2.RemindingTimestamp

    if(obj1.ModificationTimestamp > obj2.ModificationTimestamp)
        return -1;
    if(obj2.ModificationTimestamp > obj1.ModificationTimestamp)
        return 1;

    return 0;
}

myObjects.sort(compareObject); 
```

[**JSFiddle 演示**](http://jsfiddle.net/rem9F/)

资源：

*   [MDN：数组.sort()](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/sort)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-14T13:55:41.223

自定义比较器采用以下形式：

```
myArray.sort(function(a,b){
  var m1=a1.RemindingTimestamp,
      m2=a2.RemindingTimestamp,
      n1=a1.ModificationTimestamp,
      n2=a2.ModificationTimestamp;
  return m1<m2 ? -1 : m1>m2 ? 1 :
         n1<n2 ? -1 : n1>n2 ? 1 : 0;
}); 
```

对于降序排序，交换`<`和`>`（或交换`1`和`-1`）。

虽然您可以在每次需要时制作自己的自定义比较器，但我已经创建了一个明确设计的方法，可以使用[Schwartzian 变换](http://en.wikipedia.org/wiki/Schwartzian_transform)（在某些情况下可能更快但更占用内存）轻松按多个标准进行排序：[http:// phrogz.net/js/Array.prototype.sortBy.js](http://phrogz.net/js/Array.prototype.sortBy.js)

简而言之：

```
myArray.sortBy(function(obj){
  return [obj.RemindingTimestamp, obj.ModificationTimestamp];
}).reverse(); 
```

自从`reverse`你提到你想要一个降序排序之后就在那里。如果两者`RemindingTimestamp`都是`ModificationTimestamp`数字，您也可以这样做：

```
myArray.sortBy(function(obj){
  return [-obj.RemindingTimestamp, -obj.ModificationTimestamp];
}); 
```

这是添加`sortBy`到数组的代码：

```
(function(){
  // Extend Arrays in a safe, non-enumerable way
  if (typeof Object.defineProperty === 'function'){
    // Guard against IE8's broken defineProperty
    try{Object.defineProperty(Array.prototype,'sortBy',{value:sb}); }catch(e){}
  }
  // Fall back to an enumerable implementation
  if (!Array.prototype.sortBy) Array.prototype.sortBy = sb;

  function sb(f){
    for (var i=this.length;i;){
      var o = this[--i];
      this[i] = [].concat(f.call(o,o,i),o);
    }
    this.sort(function(a,b){
      for (var i=0,len=a.length;i<len;++i){
        if (a[i]!=b[i]) return a[i]<b[i]?-1:1;
      }
      return 0;
    });
    for (var i=this.length;i;){
      this[--i]=this[i][this[i].length-1];
    }
    return this;
  }
})(); 
```

以下是文档中的更多示例：

```
var a=[ {c:"GK",age:37}, {c:"ZK",age:13}, {c:"TK",age:14}, {c:"AK",age:13} ];

a.sortBy( function(){ return this.age } );                                  
  --> [ {c:"ZK",age:13}, {c:"AK",age:13}, {c:"TK",age:14}, {c:"GK",age:37} ]

a.sortBy( function(){ return [this.age,this.c] } );                         
  --> [ {c:"AK",age:13}, {c:"ZK",age:13}, {c:"TK",age:14}, {c:"GK",age:37} ]

a.sortBy( function(){ return -this.age } );                                 
  --> [ {c:"GK",age:37}, {c:"TK",age:14}, {c:"ZK",age:13}, {c:"AK",age:13} ]

var n=[ 1, 99, 15, "2", "100", 3, 34, "foo", "bar" ];

n.sort();
  --> [ 1, "100", 15, "2", 3, 34, 99, "bar", "foo" ]

n.sortBy( function(){ return this*1 } );
  --> [ "foo", "bar", 1, "2", 3, 15, 34, 99, "100" ]

n.sortBy( function(o){ return [typeof o,this] } );
  --> [1, 3, 15, 34, 99, "100", "2", "bar", "foo"]

n.sortBy(function(o){ return [typeof o, typeof o=="string" ? o.length : o] })
  --> [1, 3, 15, 34, 99, "2", "100", "bar", "foo"] 
```

*请注意，在最后一个示例中，`(typeof this)`恰好与 `(typeof o)`;不同。有关更多详细信息，请参阅[此帖子](https://stackoverflow.com/questions/4390658/why-does-typeof-this-return-object)。*

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-06-27T14:17:13.120

假设两个属性都采用相同的可排序格式，这是另一种深度排序方式`ES6`：

```
const comparingFunction = (a, b) => {
  if (a.property1 < b.property1) {
    return -1;
  }
  if (a.property1 > b.property1) {
    return 1;
  }

  if (a.property1 == b.property1) {
    if (a.property2 < b.property2) {
      return -1;
    }
    if (a.property2 > b.property2) {
      return 1;
    }
    return 0;
  }
};

myArrayOfObjects.sort(comparingFunction); 
```

希望它可以帮助某人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-05T17:17:40.737

另一种[方式](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/String/localeCompare)

```
function sortBy(ar) {
  return ar.sort((a, b) => a.RemindingTimestamp  === b.RemindingTimestamp  ?
      a.ModificationTimestamp.toString().localeCompare(b.ModificationTimestamp) :
      a.RemindingTimestamp.toString().localeCompare(b.RemindingTimestamp));
} 
```

# android - Android UDP套接字只发送一次数据？

> ID：10153848
> 
> 赞同：0
> 
> 时间：2012-04-14T13:04:04.603
> 
> 标签：android, multithreading, sockets, udp

我对编写 Android 应用程序很陌生，我想编写一段代码，以定期间隔（比如 1 秒）广播传感器数据。搜索开源代码，我设法编写了一个发送者类，如下所示：

```
public class Sender extends Thread {
    private static final String TAG = "Sending";
    private static final int PORT = 12346;
    private static final int TIMEOUT_MS = 500;
    private static final int BUF_SIZE = 1024;
    private WifiManager mWifi;

    Sender(WifiManager wifi) {
        mWifi = wifi;
    }

    public void run() {
        try {
            DatagramSocket socket = new DatagramSocket(PORT);
            socket.setBroadcast(true);
            socket.setSoTimeout(TIMEOUT_MS);
            sendData(socket);
            socket.close();
            Thread.sleep(1000);
        }
        catch (IOException ioe) {
            Log.e(TAG, "Couldn't send data", ioe);
        } 
        catch (InterruptedException ie) {
            Log.e(TAG,  "Can't sleep", ie);
        }
    }

    private void sendData(DatagramSocket socket) throws IOException {
        byte[] buf = new byte[BUF_SIZE];
        buf = object.toString().getBytes();
        InetAddress addr = InetAddress.getByName("192.168.0.255"); // TO FIX
        DatagramPacket packet = new DatagramPacket(buf, buf.length, addr, PORT);
        socket.send(packet);
    }

    public void main(String[] args) {
        new Sender(null).start();
        while (true) {
        }
    }
} 
```

下面是我从 onCreate 方法中启动它的方法：

```
public void onCreate(Bundle savedInstanceState) {
...

    new Sender((WifiManager) getSystemService(Context.WIFI_SERVICE)).start();
...
} 
```

现在，如果我在笔记本电脑上打开 Wireshark，我只会看到应用程序启动时发送的一个数据包，而不是每秒钟发送一次。

有人可以指出我做错了什么吗？老实说，我对线程和东西不太熟悉，所以我可能只是在这里遗漏了一些明显的东西......

# **编辑**

好的，所以必须循环运行方法。请参阅下面答案中的更正代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T08:14:56.063

这是更正后的运行方法代码：

```
public void run() {
            while (true) {
                try {
                    DatagramSocket socket = new DatagramSocket(PORT);
                    socket.setBroadcast(true);
                    socket.setSoTimeout(TIMEOUT_MS);
                    sendData(socket);
                    socket.close();
                    Thread.sleep(1000);
                }
                catch (IOException ioe) {
                    Log.e(TAG, "Couldn't send data", ioe);
                } 
                catch (InterruptedException ie) {
                    Log.e(TAG,  "Can't sleep", ie);
                }
            }
} 
```

# mysql - SQL查找和替换字符串的一部分

> ID：10153852
> 
> 赞同：2
> 
> 时间：2012-04-14T13:04:33.607
> 
> 标签：mysql, sql

我试图在一个字符串中找到某些文本“catid=18”，除了这个之外，每个字符串都是不同的。我以前在下面使用过这个查询，但它似乎只有在你知道整个字符串的情况下才有效。

```
update TABLE_NAME
set FIELD_NAME = replace(FIELD_NAME, 'findthis', 'replacewiththis'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:13:08.547

不确定这是否是您想要的。但`1`如果`catid=any_num`找到它会返回，`0`如果没有：

```
select 'some_text catid=18 some_text' REGEXP 'catid=[0-9]+' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T13:19:50.637

也许你需要：

```
update TABLE_NAME
set FIELD_NAME = 'goodvalue'
WHERE FIELD_NAME = 'badvalue'; 
```

# ruby-on-rails - 如何通过仅针对一种情况禁用 Ruby on Rails 缓存系统来检索数据库数据？

> ID：10153853
> 
> 赞同：3
> 
> 时间：2012-04-14T13:04:43.920
> 
> 标签：ruby-on-rails, ruby, database, ruby-on-rails-3, caching

我正在使用 Ruby on Rails v3.2.2，我想通过仅在某种情况下禁用系统缓存来检索数据库数据。也就是说，在我的视图文件中，我有以下内容：

```
<h1>Random articles 1</h1>
<%= Article.order('RAND()').limit(3).inspect %>
...
<h1>Random articles 2</h1>
<%= Article.order('RAND()').limit(3).inspect %> 
```

呈现视图文件时，它会在“随机文章 1”和“随机文章 2”下输出相同的数据。发生这种情况是因为 Ruby on Rails 缓存系统（“默认”/“约定”）出于性能原因尝试尽可能少地访问数据库。

**如何防止这种行为（仅针对上述情况）以便在我的视图文件中为查找器方法输出不同的数据？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T13:17:16.117

ActiveRecord 中有[`uncached`](http://apidock.com/rails/ActiveRecord/QueryCache/ClassMethods/uncached)方法。看起来你可以这样使用它：

```
articles = Article.uncached do
  Article.order('RAND()').limit(3)
end 
```

但是您最好将其提取到模型的类方法中。

有关更多信息，请参阅[本文](http://railspikes.com/2008/8/18/disabling-activerecord-query-caching-when-needed)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:17:52.733

我试图重现你的问题，但不能（Rails 3.2.2，使用 sqlite3 适配器，代码如下）。但无论如何都要试试这个：

```
Article.uncached do Article.order('RAND()').limit(3).inspect end 
```

以下是我如何尝试在一个空的 Rails 项目中重现您的问题，但对我来说，它始终以不同的顺序生成文章：

```
ActiveRecord::Migration.create_table :articles do |t| t.string :name end
class Article < ActiveRecord::Base; end
20.times do |i| Article.create :name => "Article#{i}" end
# sqlite doesn't have a RAND() function, emulate it
Article.connection.instance_variable_get(:@connection).define_function 'RAND' do rand end
p *Article.order('RAND()').limit(3) 
```

也许您在我尝试重现您的问题时发现了一个错误。

# postgresql - Postgres 9.1 SETOF 记录的类型

> ID：10153860
> 
> 赞同：3
> 
> 时间：2012-04-14T13:05:22.857
> 
> 标签：postgresql, types, record

我已经动态生成了 SELECT。我尝试将结果作为 SETOF RECORD 返回。像这样：

```
CREATE FUNCTION test(column_name text) RETURNS SETOF RECORD AS $$
DECLARE
   row  RECORD;
BEGIN
   FOR row IN EXECUTE 'SELECT ' || quote_ident(column_name) || ' FROM dates'
LOOP
   RETURN NEXT row;
END LOOP;
RETURN;
END;
$$ LANGUAGE 'plpgsql'; 
```

当我尝试：

```
SELECT * FROM test('column1'); 
```

我明白了：

```
ERROR:  a column definition list is required for functions returning "record" 
```

我知道 column1 是整数类型：

```
SELECT * FROM test('column1') f(a int); 
```

结果是正确的，因为我知道这将是整数类型。

当我尝试：

```
SELECT * FROM test('column1') f(a varchar); 
```

我得到错误：

```
ERROR:  wrong record type supplied in RETURN NEXT
DETAIL:  Returned type integer does not match expected type character varying in column 1. 
```

现在我的问题是：如何摆脱我定义类型'f（a int）'的部分查询。它应该是可行的，因为 Postgres 知道返回的类型。我尝试使用 IMMUTABLE 选项，但没有成功。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T13:56:59.693

您可以将值转换为函数内的文本，并声明函数`RETURNS SETOF text`. 您也可以一次返回整个结果集；无需显式迭代。

```
CREATE TABLE dates (column1 int, column2 date);
INSERT INTO dates VALUES (1, date '2012-12-22'), (2, date '2013-01-01');

CREATE FUNCTION test(column_name text) RETURNS SETOF text AS $$
BEGIN
   RETURN QUERY EXECUTE 'SELECT '
      || quote_ident(column_name) || '::text FROM dates';
END;
$$ LANGUAGE 'plpgsql'; 
```

现在`SELECT test('column1');`产生：

```
 test 
------
 1
 2
(2 rows) 
```

...并且（使用我的语言环境设置）`SELECT test('column2');`产生：

```
 test    
------------
 2012-12-22
 2013-01-01
(2 rows) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:15:58.927

您需要指定与要返回的列相对应的 OUT 参数。

# c++ - MFC：如何使用透明 PNG 作为背景（而不是窗口镶边）创建 Skinnied Dialog？

> ID：10153863
> 
> 赞同：0
> 
> 时间：2012-04-14T13:06:10.053
> 
> 标签：c++, windows, mfc, dialog, window

所以这里是一个[小而易读的 MFC 示例](http://www.codeproject.com/Articles/26887/A-user-draw-button-that-supports-PNG-files-with-tr)。但是它的背景是一个实心图像；我想知道如何创建一个透明的 PNG 作为应用程序背景？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:08:20.263

有两种基本方法可以更改窗口的非客户端（“chrome”）区域。

[分层窗口](http://msdn.microsoft.com/en-us/library/ms997507.aspx)，在 Windows XP 中引入 - 并允许不同级别的窗口效果。这里的技术是将`WS_EX_LAYERED`样式添加到窗口 - 这会阻止`WM_PAINT`（在 MFC 中`CWnd::OnPaint`）操作。相反，分层窗口由应用程序调用绘制`UpdateLayeredWindow`，提供一个填充了预乘 32bpp 数据的 DIBSection。

Windows Vista 引入了[桌面窗口管理器](http://msdn.microsoft.com/en-us/magazine/cc163435.aspx)，它在绘制窗口之前组合窗口以启用桌面 Alpha 效果。使用 DWM API 获得 alpha 效果不像 PNG 那样可定制，但仍然很有吸引力。

这两种技术都会遇到问题，因为子窗口绘制不是 alpha 感知的 - 分层窗口根本不绘制子窗口，因此您需要手动枚举所有子控件并将其绘制到屏幕外表面。DWM 窗口确实绘制子控件 - 但本机应用程序可用的标准窗口控件均未修改为可识别 Alpha。

具有讽刺意味的是，.NET WinForms 应用程序，表面上看起来只是简单地包装了标准的 windows 通用控件，但实际上所有的标准控件都针对 .NET 进行了重新开发，并且它们在放置在 windows 的“玻璃”区域时可以正确绘制。

# iphone - 用石英连续绘图？逐帧可能吗？

> ID：10153865
> 
> 赞同：1
> 
> 时间：2012-04-14T13:06:27.850
> 
> 标签：iphone, ipad, core-graphics, quartz-2d

我一直在使用`drawRect`UIView 子类处理自定义绘图。这很酷，但是您必须等到运行循环结束才能调用 drawRect，我想知道如何控制逐帧动画，随着时间的推移更改绘图，或者这是否可能？也许 Quartz 并不是真的为这种类型的动画图形设计的？我推测它可能是为不经常变化的静态图纸设计的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T13:31:52.570

Quartz 本身无法维持高帧率，因为它每次都需要重绘所有内容。但是你可以让 Quartz 和 CoreAnimation 一起工作来制作基于 Quartz 的动画。这背后的想法是，您可以将之前绘制的内容缓存在 CALayer 对象中，然后使用 CoreAnimation 来创建连续绘制效果。

这种技术的一个很好的例子可以在[Apple 提供的 AccelerometerGraph 示例代码](http://developer.apple.com/library/ios/#samplecode/AccelerometerGraph/Introduction/Intro.html#//apple_ref/doc/uid/DTS40007410-Intro-DontLinkElementID_2)中看到。在此示例中，使用此技术的 UIView 子类是“GraphView”对象。基本上，该对象仅将图形的一部分（新生成的段）绘制为全新的，将其支持在专用层中，然后为层设置动画以提供“滚动图形”动画。

显然，只有当您完全控制绘图元素并且可以管理在屏幕中添加对象的这种增量方式时，这种技术才有效。当然，当您必须重绘屏幕的许多不同部分并且需要修改先前生成的图层时，事情会变得更加复杂。

不管怎样，看看上面提到的代码：这很有趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T21:26:58.103

您的应用应在每一帧之前退出运行循环。在每帧之间进行所有自定义帧动画设置。所以 drawRect 中的逐帧绘图应该可以正常工作。这可以在 iOS 应用程序中以 60 Hz 的帧更新速率工作，而不仅仅是静态视图，只要您在帧时间之间的所有方法以及您的 drawRects 足够快。如果需要，将它们切碎。

# jquery - jquery ajax 调用

> ID：10153866
> 
> 赞同：0
> 
> 时间：2012-04-14T13:06:35.200
> 
> 标签：jquery

以下 ajax 调用在 Mozilla Firefox 中不起作用，警报正在成功功能中，但 ajax 页面未命中

```
 $.ajax({
                type: 'GET',
                url: '../common/AjaxPage.aspx',               
                data: { action: 'SaveSafepurchase', SafeName: el('<%=txtSafeName.ClientID %>').value, SafeDuration: el('<%=ddlTimeFrame.ClientID %>').value, SafeDurText: $('#<%=ddlTimeFrame.ClientID %> :selected').text() },
                success: function () { alert("df"); },
                error: function (e) { alert(e); return false; },
                 cache: false
            }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:17:40.610

```
$.ajax({
    type: 'GET',
    url: '../common/AjaxPage.aspx',
    data: {
        action: 'SaveSafepurchase',
        SafeName: el('<%=txtSafeName.ClientID %>').value,
        SafeDuration: el('<%=ddlTimeFrame.ClientID %>').value,
        SafeDurText: $('#<%=ddlTimeFrame.ClientID %> :selected').text()
    },
    success: function (alert("HI");)
        { },
    error: function (e)
        {
            alert(e);
            return false;
        },
    cache: false
}); 
```

代码格式化，使用它，喜欢它。

我认为这里的问题是您将一个函数传递给另一个函数的参数。

改变

```
success: function (alert("HI");){ }, 
```

至

```
success: function() { alert("Hi"); }, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T15:55:23.710

您是否使用 Firebug 和 Firefox 检查了 ajax 调用。如果没有，则使用 Firebug 的 Net Panel 查看请求期间发生的情况。

调用成功回调，即只要状态码为 2xx 或 304，请求就被视为成功。

# objective-c - Cocoa 以编程方式绑定 + 不更新值？

> ID：10153867
> 
> 赞同：2
> 
> 时间：2012-04-14T13:06:36.570
> 
> 标签：objective-c, cocoa, cocoa-bindings

我有一个自定义类（的子类`NSView`- 实际上可以说是修改后的编辑器，但不是 的子类`NSTextView`），我以`NSArrayController`编程方式绑定到一个*（我绝对不能通过 Interface Builder 做到这一点）*，如下所示：

```
[myEditor bind:@"string" 
     toObject:myController 
  withKeyPath:@"selection.content" 
      options:nil]; 
```

上述方法有效，但是当值更改时，它不会更新为我`NSArrayController`的 - 就好像它没有“粘住”一样。

我什`options`至尝试过，使用以下方法，但无济于事：

```
NSDictionary* options = [NSDictionary dictionaryWithObjectsAndKeys:
                         [NSNumber numberWithBool:YES],NSContinuouslyUpdatesValueBindingOption, 
                         [NSNumber numberWithBool:YES],NSAllowsEditingMultipleValuesSelectionBindingOption,
                         [NSNumber numberWithBool:YES],NSConditionallySetsEditableBindingOption,
                         [NSNumber numberWithBool:YES],NSRaisesForNotApplicableKeysBindingOption,
                         nil]; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-14T16:34:05.800

一个类必须实现对绑定的支持。Cocoa 附带的视图和单元类通常实现一组特定的绑定。自定义子类是否执行取决于实现者。

如果一个类没有实现对绑定的特定支持，那么一个`-bind:...`请求就会落入`NSObject`的实现。但是，这种实施非常有限。*它观察observableController*的键路径，并通过 KVC 更新与绑定同名的接收器的属性。但它并**没有**朝另一个方向发展。也就是说，接收器上属性的更改不会通过键路径转发到 observableController。

使用您的示例使其不那么抽象。如果 的类`myEditor`没有具体实现对“字符串”绑定的支持，那么`NSObject`的实现就可以了`[myController addObserver:<some private observer object> forKeyPath:@"selection.content" options:<...> context:<...>]`。

当私有观察者对象收到更改通知时，它将执行`[myEditor setValue:[myController valueForKeyPath:@"selection.content"] forKey:@"string"]`.

但是，`NSObject`不会尝试观察`myEditor`的“字符串”属性，也不会调用`[myController setValue:<...> forKeyPath:@"selection.content"]`.

要了解有关如何实现对绑定的支持的更多信息，请参阅[Apple 的文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CocoaBindings/Concepts/HowDoBindingsWork.html)。

# c# - 未在数据库中创建映射的表

> ID：10153872
> 
> 赞同：0
> 
> 时间：2012-04-14T13:07:08.083
> 
> 标签：c#, sql-server-2008, entity-framework, entity-framework-4.1, entity-framework-5

我一直在尝试使用 EntityFramework5 实现存储库模式。我已经掌握了工作的基础。仅在必要时才加载我的存储库，并且数据会按应有的方式在数据库中插入/更新/检索。问题是：我无法正确创建带有映射的表，甚至根本无法创建。我一直在网上阅读一些文章，甚至在这里，谈论使用映射表并在数据库中创建它们的方法，但我没有成功。在这里提出我的问题。

如何让它在我的场景中工作？

我将解释到目前为止我在做什么：

下面的这个方法被覆盖，据说是创建映射和表。

PS：`Generics.InvokeGenericMethod`是我创建的一种方法，它正在工作。它做它所说的:)

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        foreach (Type entityType in Repositories.Keys)
        {
            //Invokes the Entity method from DbModelBuilder injecting the class type.
            Generics.InvokeGenericMethod(modelBuilder, typeof(DbModelBuilder), entityType, "Entity", null);
        }

        foreach (GaiaEntityConfiguration config in EntityConfigurations)
        {
            //Defines each mapping existing in the context
            config.SetConfiguration(modelBuilder);
        }
    } 
```

不工作的部分是我使用 SetConfiguration 的地方。SetConfiguration 是我为每个添加到具有映射的上下文的类创建的方法，将该映射镜像到数据库。

这是一个示例（在这种情况下，收件人有很多消息，而消息有很多收件人/多对多关联）：

PS：我留下了注释代码，所以你可以看到我尝试过的另一种方法。

```
 public RecipientEntityConfiguration()
    {
        this.LeftKey = "RecipientId";
        this.RightKey = "MessageId";
        this.Schema = "Hermes";
        this.TableName = "RecipientMessage";
    }

    public override void SetConfiguration(DbModelBuilder modelBuilder)
    {
        //EntityTypeConfiguration<Recipient> entityTypeConfiguration = new EntityTypeConfiguration<Recipient>();

        //entityTypeConfiguration
        //    .HasMany<Message>(r => r.Messages)
        //    .WithMany(m => m.Recipients)
        //    .Map(mr =>
        //    {
        //        mr.MapLeftKey(this.LeftKey);
        //        mr.MapRightKey(this.RightKey);
        //        mr.ToTable(this.TableName, this.Schema);
        //    });
        modelBuilder.Entity<Recipient>()
            .HasMany<Message>(r => r.Messages)
            .WithMany(m => m.Recipients)
            .Map(mr =>
            {
                mr.MapLeftKey(this.LeftKey);
                mr.MapRightKey(this.RightKey);
                mr.ToTable(this.TableName, this.Schema);
            });
        //modelBuilder.Configurations.Add<Recipient>(entityTypeConfiguration);
    } 
```

当`this.Database.Initialize(false);`被调用时，我收到此错误：

```
Value cannot be null.
Parameter name: key 
```

堆栈跟踪：

```
 at System.Collections.Generic.Dictionary`2.FindEntry(TKey key)
   at System.Collections.Generic.Dictionary`2.TryGetValue(TKey key, TValue& value)
   at System.Data.Entity.ModelConfiguration.Configuration.Mapping.SortedEntityTypeIndex.Add(EdmEntitySet entitySet, EdmEntityType entityType)
   at System.Data.Entity.ModelConfiguration.Configuration.Mapping.EntityMappingService.Analyze()
   at System.Data.Entity.ModelConfiguration.Configuration.Mapping.EntityMappingService.Configure()
   at System.Data.Entity.ModelConfiguration.Configuration.ModelConfiguration.ConfigureEntityTypes(DbDatabaseMapping databaseMapping, DbProviderManifest providerManifest)
   at System.Data.Entity.ModelConfiguration.Configuration.ModelConfiguration.Configure(DbDatabaseMapping databaseMapping, DbProviderManifest providerManifest)
   at System.Data.Entity.DbModelBuilder.Build(DbProviderManifest providerManifest, DbProviderInfo providerInfo)
   at System.Data.Entity.DbModelBuilder.Build(DbConnection providerConnection)
   at System.Data.Entity.Internal.LazyInternalContext.CreateModel(LazyInternalContext internalContext)
   at System.Data.Entity.Internal.RetryLazy`2.GetValue(TInput input)
   at System.Data.Entity.Internal.LazyInternalContext.InitializeContext()
   at System.Data.Entity.Internal.InternalContext.Initialize()
   at System.Data.Entity.Database.Initialize(Boolean force)
   at Gaia.Repository.GaiaContext..ctor(GaiaContextConfiguration config) in E:\Gaia\Gaia.Repository\GaiaContext.cs:line 37
   at Hermes.HMail.SendMessage(Int64 sender, Int64[] toUsers, String subject, String content, FileStream attachment) in G:\Gaia\Hermes\HMail.cs:line 78
   at Gaia.Controllers.ApplicationController.Test() in G:\Gaia\Gaia\Controllers\ApplicationController.cs:line 18
   at lambda_method(Closure , ControllerBase , Object[] )
   at System.Web.Mvc.ActionMethodDispatcher.<>c__DisplayClass1.<WrapVoidAction>b__0(ControllerBase controller, Object[] parameters)
   at System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)
   at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass15.<InvokeActionMethodWithFilters>b__12()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) 
```

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T18:53:02.737

首先，我在[EF Book](https://rads.stackoverflow.com/amzn/click/com/1449312942) pg.57 中发现，任何内联配置都应该仅在将所有配置添加到模型构建器之后出现。检查您的代码。

接下来，尝试此版本的代码，以自动将映射添加到模型构建器。目标是从 EntityTypeConfigurations 中删除调用，并使用纯方法将配置添加到上下文。将您的代码从 SetConfiguration 移动到构造函数并尝试使用我的版本。它也对我有用。

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
     var entityMapTypes = assembly.GetTypes().Where(
         (t => t.BaseType != null && t.BaseType.IsGenericType && 
               t.BaseType.GetGenericTypeDefinition() == typeof(EntityTypeConfiguration<>)));

     foreach (var mapType in entityMapTypes)
     {
         dynamic configurationInstance = Activator.CreateInstance(mapType);
         modelBuilder.Configurations.Add(configurationInstance);
     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:38:29.507

这将是我在stackoverflow中的第一个答案，所以我希望它对某人有所帮助！事实证明 EF 是一个敏感的生物，**它不喜欢具有名为“Type”的属性的实体**，所以如果你有的话，只需将它们重命名为类似于“EntityType”的东西。

我还听说有人对具有抽象类型的属性有类似的问题，以防万一有人的问题不是我上面描述的问题，请查看您的属性的类型并检查它们是否是抽象的： [DbContext 无法初始化模型优先数据库](https://stackoverflow.com/questions/5127192/dbcontext-fails-to-initialize-model-first-database)

# c++ - 如何使用 _com_ptr_t？

> ID：10153873
> 
> 赞同：8
> 
> 时间：2012-04-14T13:07:12.190
> 
> 标签：c++, com

假设我有一个拥有 a 的类`D3DDevice`：

```
class Thing
{
public:
    Thing()
    {
        D3D11CreateDevice(..., &device, ...);
    }
    ~Thing()
    {
        device->Release();
    }
private:
    ID3D11Device* device;
}; 
```

据我了解，我可以`_com_ptr_t`用来确保对象被删除，而无需显式调用`Release()`析构函数。但问题是我无法找出模板的正确语法。

我几乎找不到任何关于的信息`_com_ptr_t`，而我能找到的最接近答案的是[这个（日语）](http://d.hatena.ne.jp/nagoya313/20110924/1316877523)。按照那里的语法，我得到了一堆编译器错误：

```
private:
    //ID3D11Device* device;
    _com_ptr_t <_com_IIID<ID3D11Device, &__uuidof(ID3D11Device)>> device;

error C2143: syntax error : missing ';' before '<'
error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
error C2238: unexpected token(s) preceding ';'
error C2065: 'device' : undeclared identifier 
```

顺便说一句，我可以使用它从函数返回 COM 指针，并确保它们在离开调用者范围时被删除，对吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-31T13:41:02.290

_com_ptr_t 用于定义智能指针类型。例如，让我们定义 IHTMLDocument3Ptr 类型：

```
typedef _com_ptr_t <_com_IIID<IHTMLDocument3, &__uuidof(IHTMLDocument3)>> IHTMLDocument3Ptr; 
```

有一个简单的宏：

```
_COM_SMARTPTR_TYPEDEF(IHTMLDocument3, IID_IHTMLDocument3); 
```

这将创建 IHTMLDocument3Ptr，一个智能指针：

```
IHTMLDocument3Ptr htmlDocument3; 
```

使用 CComQIPtr 这将被定义为：

```
CComQIPtr<IHTMLDocument3> htmlDocument3; 
```

有一个“comdefsp.h”文件，其中包含许多 COM 接口的预定义智能指针（[https://singularity.svn.codeplex.com/svn/base/Windows/Inc/comdefsp.h](https://singularity.svn.codeplex.com/svn/base/Windows/Inc/comdefsp.h)）。“comdef.h”文件自动包含它。例如，已经定义了 IDispatch 的智能指针：

```
IDispatchPtr dispatch; 
```

使用 CComPtr 这将被定义为：

```
CComPtr<IDispatch> dispatch; 
```

## _com_ptr_t = 无 ATL

使用`_com_ptr_t`over的优点`CComPtr/CComQIPtr`是**您不必链接到 ATL 库**。

其他不需要 ATL 库的智能 COM 指针是`_bstr_t`(equivalent of `CComBSTR`) 和`_variant_t`(equivalent of `CComVariant`)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-14T13:18:43.380

我建议通常有两种处理 COM 智能指针的方法：

1) 您可以#import 适当的类型库，它将根据_com_ptr_t 自动生成智能指针类型。

2) 您可以使用 CComPtr 模板将原始 COM 指针包装在一个智能指针中，该指针通过自动 AddRef/Release 调用处理资源管理，但不会给您提供太多其他信息。

因为我有点懒，通常我不介意由 自动生成的包装器的隐式开销，所以`#import`我通常使用 1)。使用这种方法的一大好处是，该`#import`机制还生成函数包装器，使 COM 函数看起来更像具有正确返回类型和异常对象转换的普通`HRESULT`函数`_com_error`。恕我直言，它倾向于改进 C++ COM 代码中的控制流。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-14T13:17:12.473

您问题中第二个代码的错误意味着编译器在`<`: 之前不知道其中一种（或两种）类型，您需要包含正确的标头以确保两者都是有效`_com_ptr_t`且`_com_IIID`已知的类型。此外，`>>`可能会被解析为“右移”运算符，在它们之间放置一个空格以允许正确、可移植的解析

`comdef.h`应该[解决这两个问题](https://connect.microsoft.com/VisualStudio/feedback/details/362782/use-of-com-ptr-t-fails-to-compile-when-put-in-a-std-map-as-a-key)（参见列出的代码）

# java - 谁为 URLencoding 解码？

> ID：10153874
> 
> 赞同：1
> 
> 时间：2012-04-14T13:07:13.003
> 
> 标签：java, decoding, url-encoding

**我已经使用URLEncoder**类对我的字符串（Say String a="123+gtyt"）进行了编码。编码的字符串是**String b**。然后我将“String b”作为附加到 URL 的参数发送。让我们说**http://example.com?request=b**。

当我使用 URLDecoder 在 example.com 上解码字符串时，我的字符串中**的符号 + 丢失，解码后我没有得到“字符串 a”**

现在，当我在未解码 example.com 上的“String b”的情况下打印时。**我得到了 String a**。

**所以我的疑问是在重定向时是否由浏览器本身完成解码？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:39:36.587

当您对“123+gtyt”进行编码时 - 它对加号进行编码。

当您处理 HTTP 请求时，servlet API 会自动将其解码为“123+gtyt”。如果您再次对其进行解码 - 它会将“+”更改为空格。

所以关键是 - 不要显式解码参数。

例如：

```
 final String encoded = URLEncoder.encode("123+gtyt");
    final String decoded = URLDecoder.decode(encoded);
    System.out.println("decoded = " + decoded); // 123+gtyt
    System.out.println("URLDecoder.decode(decoded) = " 
              + URLDecoder.decode(decoded)); // prints 123 gtyt 
```

# java - 如何在 MVC Java 中实现我的代码？

> ID：10153876
> 
> 赞同：1
> 
> 时间：2012-04-14T13:07:28.440
> 
> 标签：java, swing, model-view-controller, jframe, hierarchy

我正在制作一款游戏，其中将实现三款游戏。我从一个类中开始我的代码，现在我想将它移动到 MVC 格式中，但我遇到了错误。我开始在 GameView 类中编写所有代码，现在我想将一些代码从这个类移动到 SView 类。问题是我已经在 GameView 类中初始化了 JFrame，当我将代码移动到 SView 类时它找不到变量帧。因此，有人告诉我将其制成面板然后移动它，但这只会弄乱我的游戏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:10:19.100

你必须以不同的方式组织事情。需要考虑的一些事项：

*   是`GameView`你的主窗口吗？让它如此`GameView extends JFrame`。
*   是`SView`面板吗？让它如此`SView extends Panel`。

另一件要考虑的事情：`SView`是您想要添加到您的某个面板`GameView`，但`SView`添加*自身*不是您的责任。相反，只需在这两个类 fe 之外的某个地方实例化和组装这些组件：

```
GameView gameView = new GameView();
gameView.add(new SView()); 
```

您也可以在其构造函数代码中`GameView`添加 a 。`new SView()`

无论如何，这里的要点是组件不应该关心将自己添加到其父级，而只需创建自己的内容/子级。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T16:02:37.267

一些建议：

*   主 GUI 将使用 CardLayout，因此您可以轻松交换 JPanel。
*   选择游戏菜单的主要功能是交换 JPanel，因此选择的游戏被可视化，然后初始化选择的游戏。
*   单独处理每个游戏。为每个单独的游戏类设置一个 JPanel 来举办游戏。为每个游戏类提供一个用于测试的主要方法，该方法将创建一个 JFrame，创建一个游戏类实例，将实例的 JPanel 放入 JFrame，初始化游戏并显示它。
*   游戏自行运行后，尝试将其添加到更大的 GUI，即可以显示多个游戏的 GUI。
*   考虑让每个游戏类为通用功能实现一个通用接口。例如，您可以为接口提供每个游戏类将覆盖的 initialize() 方法。
*   每个游戏类都需要基于 MVC，以便它有一个模型、一个与模型交互的控制类和一个在 JPanel 上显示模型状态的视图类，如上所述。

# google-app-engine - 在我的应用程序上获取 404

> ID：10153880
> 
> 赞同：-1
> 
> 时间：2012-04-14T13:08:20.367
> 
> 标签：google-app-engine

我有一个正在开发的 GAE 应用程序。我已经离开了大约两个星期，还没有使用该应用程序。今天我得到一个404，没有找到。我的应用程序怎么会消失？我仍然可以以管理员身份登录，并且应用程序似乎设置正确，但即使使用来自管理员的链接，我也会得到 404。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T17:30:22.887

GAE 应用程序不会因 404 错误而消失...您应该有另一个设置问题。

看看[教程](https://developers.google.com/appengine/docs/java/gettingstarted/creating?)

# c# - DataAdapter 不需要打开数据库连接？

> ID：10153881
> 
> 赞同：7
> 
> 时间：2012-04-14T13:08:22.073
> 
> 标签：c#, asp.net, dataadapter, advantage-database-server

我尝试在 C#.net 中使用 DataAdapter。我仍然对 DataAdapter 不了解。

我阅读了很多关于 DataAdapter 和 DataReader 的文章和博客。

我知道 DataAdapter 会在需要时自动打开和关闭数据库。

但，

```
//conn.Open();
AdsDataAdapter da;
da = new AdsDataAdapter("Select * from Test", conn);
AdsCommandBuilder cb;
cb = new AdsCommandBuilder(da);

DataSet ds = new DataSet();
da.Fill(ds, "Test");

DataRow newrow = ds.Tables["Test"].NewRow();
newrow["Name"] = "How about";
ds.Tables["Test"].Rows.Add(newrow);
da.Update(ds, "Test"); 
```

当我运行上面的代码时，我收到一条错误消息，上面写着“必须打开连接”。

为什么适配器不能自动打开连接？

而且，我想使用 insertCommand 插入数据（对于这个测试，我打开了连接）。

```
da.InsertCommand = new AdsCommand("INSERT INTO test (NAME) values('Insert Test #1')", conn);
//da.InsertCommand.ExecuteNonQuery(); // it works
da.Update(ds,"Test"); //but it does not works. 
```

许多使用 Adapter.Update() 的示例，但对我来说，它不起作用:(

没有错误，也没有插入任何内容。

并使用 da.InsertCommand.ExecuteNonQuery(); 而不是 Update()，它可以工作。

我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-14T13:20:14.923

[MSDN](http://msdn.microsoft.com/en-us/library/bh8kx08z%28v=VS.71%29.aspx)说

> 如果发现连接尚未打开，Fill 方法会隐式打开 DataAdapter 正在使用的连接。如果 Fill 打开了连接，Fill 完成后它也会关闭连接。在处理诸如填充或更新之类的单个操作时，这可以简化您的代码。

这意味着在`da.Fill(ds, "Test");`您的连接被方法本身关闭之后。但是您需要为以下更新打开它（并且失败）

编辑：从您上面的代码派生的伪代码

```
using(AdsConnection com = new AdsConnection(connectionString));
{
    conn.Open();
    using(AdsDataAdapter da = new AdsDataAdapter("Select * from Test", conn))
    {
        AdsCommandBuilder cb = new AdsCommandBuilder(da); 
        DataSet ds = new DataSet(); 
        da.Fill(ds, "Test"); 

        // Now the connection is still open and you can issue other commands

       DataRow newrow = ds.Tables["Test"].NewRow(); 
       newrow["Name"] = "How about"; 
       ds.Tables["Test"].Rows.Add(newrow); 

       // da.Update should work here. No more connection closed.
       da.Update(ds, "Test"); 
    }
} // Exiting from the using block, the connection will be closed 
```

# javascript - 如何将字符串转换为 JSON 对象

> ID：10153884
> 
> 赞同：0
> 
> 时间：2012-04-14T13:08:37.153
> 
> 标签：javascript, jquery, json, asp.net-mvc-3

**时间线.js + MVC + Ajax + JSON**

你好，

将字符串转换为 Json 对象时出现问题

我必须在我的网页上显示时间线，我也使用了 Timeline.js，我可以使用如下静态数据运行时间线

# 静态数据

```
// Create a JSON data table
data = [
{
        'start': new Date(2010, 7, 23),
    'content': 'Conversation'
},
{
    'start': new Date(2010, 7, 23),
    'content': 'New Conversation'
},
{
    'start': new Date(2010, 7, 23),
    'content': 'Very New Conversation'
} 
```

现在当我做

```
alert(data); 
```

它给了我

```
[object Object],[object Object],[object Object] 
```

但现在我必须显示来自数据库的数据，所以我在控制器上调用以下函数

# 控制器上的 GetTimeLine 方法

```
public JsonResult GetTimeline()
{
      JsonResult jr = new JsonResult();
      var objtimeline = objEntities.Timelines.Where(tl => tl.StudentID == Sessions.StudentID).ToList().AsQueryable();
      String newstr = "[";
      foreach(var tml in objtimeline)
      {
            DateTime date1 = Convert.ToDateTime(tml.CalculatedDate);
            newstr += "{'start': new  Date("+date1.Year+","+date1.Month+","+date1.Day+","+date1.Hour+","+date1.Minute+","+date1.Second+"),'content':'"+tml.Description+"'},";
      }
      newstr = newstr.TrimEnd(',');
      newstr += "];";
      jr.Data = newstr;
      jr.JsonRequestBehavior = JsonRequestBehavior.AllowGet;
      return jr;
} 
```

# 调用控制器方法的函数

```
jQuery.ajax({
    type: "POST",
    url: "@Url.Content("~/Student/GetTimeline")",
    success: function (result) {
        data = result;
    },
});
alert(data); 
```

它给了我以下警报

```
[{'start': new Date(2012,2,11,0,0,0),'content':'Parents meeting'},{'start': new Date(2012,2,15,0,0,0),'content':'Exam Meeting'}]; 
```

所以问题在于将字符串转换为 Json 对象，

如何在我的视图中将从控制器返回的字符串转换为 Json 对象...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T13:25:18.713

你工作太辛苦了。让框架为你做这件事。

```
public JsonResult GetTimeline()
{
     var timeline = objEntities.TimeLines.Where( tl => tl.StudentID == Sessions.StudentID )
                                         .ToList() //required due to Convert call
                                         .Select( tl => new
                                          {
                                               start = Convert.ToDateTime(tl.CalculatedDate),
                                               content = tl.Description
                                          });
     return Json( timeline, JsonRequestBehavior.AllowGet );
} 
```

然后使用`getJSON`（因为您特别允许获取）或`dataType: 'json'`在您的请求中指定。

```
$.getJSON( '@Url.Action("gettimeline","student")', function(data) {
     alert(data);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T13:17:41.697

您让服务器返回的不是有效的[JSON](http://json.org)。或者给你的服务器端代码，它可能是有效的 JSON，它只定义了一个字符串而不是一个对象图。在 JSON 中：

*   所有对象键必须用**双**引号，而不是单引号。
*   所有字符串都必须用**双**引号，而不是单引号。
*   `new Date(...)`无效（JSON 没有任何日期概念）。

我相信您想构建一个数组（不是字符串）并将其分配给`jr.Data`，然后让[`JsonResult`对象](http://msdn.microsoft.com/en-us/library/dd470569.aspx)为您处理序列化（但我在 ASP.net MVC 中没有这样做）。

让服务器返回有效 JSON 后，确保它返回正确的`Content-Type`标头（值为`application/json`）。当您这样做时，jQuery 将看到它是 JSON 并将其反序列化为您的对象图。如果您不能或不想让您的服务器返回有效的 JSON，请添加`dataType: 'json'`到`ajax`调用以强制它。

# python - 适合初学者的 Python 框架

> ID：10153890
> 
> 赞同：3
> 
> 时间：2012-04-14T13:09:28.937
> 
> 标签：python, frameworks, web

我是 python 新手，只阅读了 Byte of Python 电子书，但想转向网络。我厌倦了成为 CMS 调整者，在尝试了 python、ruby 和 php 之后，python 语言变得更有意义（如果这对真正的程序员有任何“意义”的话）。我听说过很多关于 Django、Pyramid 等的好东西，但我不想选择最常用或最神奇的一个。相反，我正在考虑一个可以一路“教”我 python 的。我的计划是使用 python 和一个框架来重建我的投资组合，并在此过程中受益于我的 python 学习。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:15:01.463

如果您的重点是学习和避免“魔法”（我已经使用了所有三个），那么像[web.py](http://webpy.org/)或[flask](http://flask.pocoo.org/)之类的轻量级/最小化的东西是 IMO 比 Django 更好的起点。

您可能必须连接自己的 DB/persistence/ORM 层，甚至是模板系统 (web.py)，但这将帮助您了解幕后发生的事情 - 两个框架的文档都可以引导您完成此过程所以别担心。

[如果您不熟悉 WSGI](http://webpython.codepoint.net/wsgi_tutorial) /middleware 和[MVC](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)等概念，您还应该了解它们。

如果你真的想从核心中学习，你可以直接编写一个普通的 WSGI/CGI 应用程序并连接你的组件：

*   网址路由
*   数据库持久化/ORM
*   HTML 模板系统
*   任何其他中间件

如果这太难了，您可能想在使用更“自动”的框架（如 web.py 或 flask）之后再回来。类似地，如果你发现这些框架太难/太少了，那么就从 Django 开始（它有很好的文档/教程）；有很多自动的“魔法”，但您只需要熟悉 Web 开发领域；所有概念都很容易在不同框架之间转换

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T13:13:21.257

学习 Python 是个好主意。但是，这同时也是一项努力。

在深入了解众多 Web 框架之一之前，请先阅读[http://docs.python.org/tutorial/](http://docs.python.org/tutorial/)上的 Python 教程。

我个人可以推荐 Django (https://www.djangoproject.com/)，但在理解其设计/原理之前，您需要有扎实的 Python 基础。

# google-docs-api - 从 Google API 可恢复更新获取 401 Unauthorized

> ID：10153904
> 
> 赞同：2
> 
> 时间：2012-04-14T13:12:28.813
> 
> 标签：google-docs-api

我正在尝试将任意文件上传到 Google Docs 集成到现有应用程序中。在强制使用可恢复上传之前，这曾经有效。我正在使用 Java 客户端库。

应用程序分两步进行上传： - 获取文件的 resourceId - 上传数据

为了获取resourceId，我上传了一个0 大小的文件（即Content-Length=0）。我在可恢复的 URL 中传递 ?convert=false （即[https://docs.google.com/feeds/upload/create-session/default/private/full?convert=false](https://docs.google.com/feeds/upload/create-session/default/private/full?convert=false)）。

我将“应用程序/八位字节流”作为内容类型传递。这似乎可行，尽管我确实得到了不同的资源 ID——“文件：...”资源 ID 用于图像之类的东西，但“pdf：....”资源 ID 用于 PDF。

第二步根据之前获取的resourceId构造一个URL并进行搜索（getEntry）。URL 的格式为[https://docs.google.com/feeds/default/private/full/file%3A](https://docs.google.com/feeds/default/private/full/file%3A) .....

找到条目后，ResumableGDataFileUploader 用于使用正在上传的文件中的实际数据更新内容（0 字节文件）。构建 ResumableGDataFileUploader 实例时，此操作失败并出现 401 Unauthorized response。

我已经尝试过 ?convert=false 以及 ?new-revision=true 以及这两者同时进行。结果是一样的。

相关的代码：

```
MediaFileSource mediaFile = new MediaFileSource(
    tempFile, "application/octet-stream");

final ResumableGDataFileUploader.Builder builder = 
    new ResumableGDataFileUploader.Builder(client, mediaFile, documentListEntry);
builder.executor(MoreExecutors.sameThreadExecutor());
builder.requestType(ResumableGDataFileUploader.RequestType.UPDATE);

// This is where it fails
final ResumableGDataFileUploader resumableGDataFileUploader = builder.build();
resumableGDataFileUploader.start();

return tempFile.length(); 
```

“客户端”是 DocsService 的一个实例，配置为使用 OAuth。它用于在给定代码之前立即查找“documentListEntry”。

我必须明确指定请求类型，因为客户端库代码似乎包含一个错误，导致“更新现有条目”情况下的 NullPointerException。

我怀疑问题出在操作序列中（上传 0 字节文件以获取 resourceId，然后使用实际文件进行更新），但我不知道为什么它不起作用。

请帮忙？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:01:55.370

此代码片段适用于我使用 OAuth 1.0 和 OAuth 2.0：

```
static void uploadDocument(DocsService client) throws IOException, ServiceException,
    InterruptedException {
  ExecutorService executor = Executors.newFixedThreadPool(10);

  File file = new File("<PATH/TO/FILE>");
  String mimeType = DocumentListEntry.MediaType.fromFileName(file.getName()).getMimeType();

  DocumentListEntry documentEntry = new DocumentListEntry();
  documentEntry.setTitle(new PlainTextConstruct("<DOCUMENT TITLE>"));

  int DEFAULT_CHUNK_SIZE = 2 * 512 * 1024;
  ResumableGDataFileUploader.Builder builder =
      new ResumableGDataFileUploader.Builder(
          client,
          new URL(
              "https://docs.google.com/feeds/upload/create-session/default/private/full?convert=false"),
          new MediaFileSource(file, mimeType), documentEntry).title(file.getName())
          .requestType(RequestType.INSERT).chunkSize(DEFAULT_CHUNK_SIZE).executor(executor);

  ResumableGDataFileUploader uploader = builder.build();
  Future<ResponseMessage> msg = uploader.start();
  while (!uploader.isDone()) {
    try {
      Thread.sleep(100);
    } catch (InterruptedException ie) {
      throw ie; // rethrow
    }
  }

  DocumentListEntry uploadedEntry = uploader.getResponse(DocumentListEntry.class);
  // Print the document's ID.
  System.out.println(uploadedEntry.getId());
  System.out.println("Upload is done!");
} 
```

# jquery - 对文本字段使用模糊

> ID：10153912
> 
> 赞同：2
> 
> 时间：2012-04-14T13:13:31.887
> 
> 标签：jquery

我有两个输入文本字段。一个是输入文章的标题，一个是文章的永久链接。我想要做的是禁用永久链接字段，直到将文本插入标题字段并且当用户将焦点移出标题字段时，它会运行自定义正则表达式以用连字符替换空格并将任何大写字母小写。

```
<input type="text" id="title" name"title" />
<input type="text" id="permalink" name="permalink" /> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T13:17:02.640

**使用jQuery**真的很容易......

```
var permalinkInput = $('#permalink');

$('#title').change(function() {
    permalinkInput.prop('disabled', !$(this).val());
}).change().blur(function() {
    $(this).val(function(i, value) {
        return value.replace(/\s+/g, '-').toLowerCase();
    });
});​ 
```

[js小提琴](http://jsfiddle.net/AM5Gz/)。

如果您没有 jQuery 但只需要支持**符合标准的现代浏览器**，那将是...

```
var permalinkInput = document.querySelector('#permalink'),
    titleInput = document.querySelector('#title');

permalinkInput.disabled = true;

titleInput.addEventListener('change', function() {
    permalinkInput.disabled = !titleInput.value;
}, false);

titleInput.addEventListener('blur', function() {
    titleInput.value = titleInput.value.replace(/\s+/g, '-').toLowerCase();
});​ 
```

[js小提琴](http://jsfiddle.net/RsgPb/)。

如果你没有 jQuery 并且不得不支持我们的**老 IE**朋友，它看起来像......

```
var permalinkInput = document.getElementById('permalink'),
    titleInput = document.getElementById('title');

var addEvent = function(element, type, callback) {
    if (element.addEventListener) {
        element.addEventListener(type, callback, false);
    } else if (element.attachEvent) {
        element.attachEvent('on' + type, callback);
    } else {
        element['on' + type] = callback;
    }
}

permalinkInput.disabled = true;

addEvent(titleInput, 'change', function() {
    permalinkInput.disabled = !titleInput.value;
});

addEvent(titleInput, 'blur', function() {
    titleInput.value = titleInput.value.replace(/\s+/g, '-').toLowerCase();
});​ 
```

[js小提琴](http://jsfiddle.net/uDEf2/)。

请注意，事件注册的旧回退是分配`on*`属性。这将覆盖之前分配的任何属性。

如果您真的想为这些古老的浏览器注册多个事件，您可以修改属性分配以使用自定义处理程序，该处理程序注册然后在需要时触发多个事件。

# javascript - 如何通过单击“取消”按钮取消文件上传

> ID：10153916
> 
> 赞同：3
> 
> 时间：2012-04-14T13:13:48.657
> 
> 标签：javascript, jquery, button, file-upload

我有一个表单，其中包含表单中的文件输入，更重要的是一个取消按钮，它应该取消文件上传：

```
var $fileImage = $("<form action='imageupload.php' method='post' class='imageuploadform' ...><label>" + 

"Image File: <input name='fileImage' type='file' class='fileImage' /></label><br/><label>" +

"<input type='submit' name='submitImageBtn' class='sbtnimage' value='Upload' /></label>" + 

"</p><p class='imagef1_cancel' align='center'><label>" +

"<input type='button' name='cancelImageBtn' class='cancelimage' value='Cancel' /></label>" + 
"</p></form>"); 
```

现在我已经完成了将文件上传到服务器的所有工作。但我有一个问题。

我的问题是我不知道如何取消和上传。目前，如果用户单击“取消”按钮，则不会发生任何事情。我想要发生的是，如果用户单击“取消”按钮，那么它将导航到“stopImageUpload()”函数并停止文件上传。但是我该怎么做呢？

下面是我创建取消按钮功能的尝试，但是当单击“取消”按钮时，什么也没有发生。

```
 $(".cancelimage").on("click", function(event) {
    console.log("clicked");
    event.preventDefault();
    stopImageUpload(success);
     }); 
```

下面是完整的代码，显示了取消按钮功能的放置位置以及开始上传和停止文件上传的功能：

```
 function startImageUpload(imageuploadform){

$(imageuploadform).find('.imagef1_upload_process').css('visibility','visible');
sourceImageForm = imageuploadform;

                $(".cancelimage").on("click", function(event) {
                console.log("clicked");
                event.preventDefault();
                stopImageUpload(success);
             });

                  return true;
            }

            function stopImageUpload(success){

                  var result = '';
                  if (success == 1){
result = '<span class="msg">The file was uploaded successfully!</span><br/><br/>';
                  }

                  else {
result = '<span class="emsg">There was an error during file upload!</span><br/><br/>';
                  }

$(sourceImageForm).find('.imagef1_upload_process').css('visibility','hidden');          
$(sourceImageForm).find('.imagef1_upload_form').css('visibility','visible');

                  return true;   
            } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2019-02-05T22:50:43.917

对于可能在这里借钱的人来说，这是一个答案。（因为它已经太老了，所以不能完全回答这个问题）

我将回答您如何实现取消上传或更多取消 ajax 请求。在许多应用程序中都可能需要它。

# 使用 axios

您可以使用取消令牌取消请求。

> axios 取消令牌 API 基于撤销的可取消承诺提案。

您可以使用 CancelToken.source 工厂创建取消令牌，如下所示：

```
const CancelToken = axios.CancelToken;
const source = CancelToken.source();

axios.get('/user/12345', {
  cancelToken: source.token
}).catch(function (thrown) {
  if (axios.isCancel(thrown)) {
    console.log('Request canceled', thrown.message);
  } else {
    // handle error
  }
});

axios.post('/user/12345', {
  name: 'new name'
}, {
  cancelToken: source.token
}) 
```

并触发取消

```
// cancel the request (the message parameter is optional)
source.cancel('Operation canceled by the user.'); 
```

您还可以通过将执行器函数传递给 CancelToken 构造函数来创建取消令牌：

```
const CancelToken = axios.CancelToken;
let cancel;

axios.get('/user/12345', {
  cancelToken: new CancelToken(function executor(c) {
    // An executor function receives a cancel function as a parameter
    cancel = c;
  })
});

// cancel the request
cancel();

Note: you can cancel several requests with the same cancel token. 
```

文档[https://github.com/axios/axios#cancellation](https://github.com/axios/axios#cancellation)

# 使用 XMLHttpRequest：

我们使用xhr 对象的**abort()**方法。

```
var xhr = new XMLHttpRequest(),
    method = "GET",
    url = "https://developer.mozilla.org/";
xhr.open(method, url, true);

xhr.send();

if (OH_NOES_WE_NEED_TO_CANCEL_RIGHT_NOW_OR_ELSE) {
  xhr.abort();
} 
```

文档[https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/abort](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/abort)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-08-27T05:56:06.573

有一个可能的解决方案。你可以这样做：

```
$("#cancel").click(function(){
  $("#inputfile").remove();
  $("#containerof_inputfile").append("<input type=\"file\" id=\"inputfile\"/>");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T13:27:03.297

一旦表单开始提交，我不相信您可以在不导航到新页面的情况下停止它。

如果您将取消按钮重定向到同一页面，但在查询字符串中带有一个标志，您可以使用该标志来显示可能会起到作用的取消通知。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T13:27:43.210

jQuery 使这种事情变得更容易。您可以在返回的 jQuery 对象上调用 abort。我想如果你真的想自己动手，你可以查看 jQuery 代码来看看它是如何做到的。

编辑：我很好奇并[查了一下](https://developer.mozilla.org/en/XMLHttpRequest)。Abort 是 Javascript 中 XMLHttpRequest 函数的一种方法。

# java - tomcats的负载均衡完成了，但是应用还是很慢？

> ID：10153917
> 
> 赞同：-1
> 
> 时间：2012-04-14T13:13:49.990
> 
> 标签：java, sql-server-2005, tomcat, load-balancing

我有 2 个不同的*tomcat 服务器*并使用*apache*进行负载平衡。我使用*SQL Server 2005*作为数据库。数据库服务器的 RAM 为 28 GB。两个 tomcat 都在与同一个数据库进行通信。

作为没有。的用户在中午 12 点到下午 4 点期间增加，应用程序使用率上升，应用程序变慢，导致网站无法快速启动。在周六和周日，因为用户非常少。应用程序很快。

我无法想出，应用程序缓慢的原因可能是什么。什么是处理应用程序变慢的正确解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:17:39.700

而且，当然，您在进行负载平衡*之前*调查并发现是 Tomcat 上的负载导致了问题，是吗？

你需要找出瓶颈在哪里（我们不能告诉你，我们最多可以就去哪里提出建议）。如果问题实际上出在您的数据库中（例如），那么添加一千个 Tomcat 服务器对您没有帮助。

您可以检查许多事情以提供帮助。您的应用程序的日志是一个，希望能查明延迟在哪里。此外，Apache 本身维护的日志对于发现问题非常有用。

同样，当数据库处于负载状态时，从命令行尝试应用程序查询之一也可能会告诉您一些信息。

# spring - 在jsp中迭代PagedListHolder

> ID：10153919
> 
> 赞同：6
> 
> 时间：2012-04-14T13:13:58.250
> 
> 标签：spring, jsp, spring-mvc, jstl

如何在 JSP 中处理 PagedListHolder？

在我的控制器中，我有这个：

```
PagedListHolder<Logo> pagedListHolder = new PagedListHolder<Logo>(listLogo);
pagedListHolder.setPageSize(2); 
```

在我的jsp中：

```
<c:forEach items="${pagedListHolder}" var="listHolderItem"> 
```

但它不起作用。JSTL 不能遍历 pagedListHolder；

#

较新的想法，我明白了：

为了处理 PagedListHolder 列表，您需要从 PagedListHolder 中取回列表。这就是你的做法：

```
PagedListHolder<Logo> pagedListHolder = new PagedListHolder<Logo>(listLogo);
pagedListHolder.setPageSize(2);

List<Logo> pagedListLogo = pagedListHolder.getPageList();

model.addAttribute("pagedListLogo", pagedListLogo); 
```

在你的jsp中：

```
<c:forEach items="${pagedListLogo}" var="logo">
... 
```

瞧，它有效。:)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-14T21:01:16.570

正如您所指出的，您应该得到列表。有两种方法可以做到这一点：

*   在控制器中，与`model.addAttribute("list", pagedList.getPageList())`
*   在 JSP 中，使用`<c:forEach items="${list.pageList}">`

# c++ - 如何用箭头在 2D 中平移对象？

> ID：10153922
> 
> 赞同：0
> 
> 时间：2012-04-14T13:14:54.630
> 
> 标签：c++, opengl

我编写了围绕 Z 轴旋转 2D 对象的代码，还为该旋转添加了一些键盘控件，例如停止、启动和加速旋转。

我现在需要的是用键盘箭头在 2D 中翻译对象。我需要在 2D 中翻译的代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T13:50:16.040

[本教程](http://www.arcsynthesis.org/gltut/Positioning/Tutorial%2006.html)提供了有关如何在现代 OpenGL 中进行对象定位的出色概述。移动只是在按键回调中进行此定位。

# javascript - 强调

> ID：10153930
> 
> 赞同：2
> 
> 时间：2012-04-14T13:16:06.533
> 
> 标签：javascript, dom

`<area>`有时我想看看页面上图片上的标签到底在哪里。

Javascript中有没有办法改变颜色或隐藏与区域标签对应的图像的一部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T13:19:15.407

也许您正在寻找类似[mapper.js](http://www.netzgesta.de/mapper/)的东西。它允许您在鼠标悬停时突出显示图像地图内的区域。

# javascript - JavaScript 从 URL 中获取 OAuth 令牌？

> ID：10153931
> 
> 赞同：1
> 
> 时间：2012-04-14T13:16:52.977
> 
> 标签：javascript, jquery, html, css

我正在使用隐式使用 OAuth 的 API。它重定向到 URL [http://exmaple.com/#token=084758yhroufgbk48y](http://exmaple.com/#token=084758yhroufgbk48y)。

我如何通过 JavaScript 获取它？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T13:24:34.203

您可以使用获取 url 的哈希部分`window.location.hash`

要从 url 中获取令牌，请使用以下代码：

```
<script type="text/javascript">
    hash = window.location.hash.substr(1); //url of the current page
    arHash = hash.split('='); //this creates an array with key ([0] element) and value ([1] element)
    hash_value =  arHash[1]; //recieve value
</script> 
```

# c# - 分页绑定到数据集的 DataGridView？

> ID：10153934
> 
> 赞同：1
> 
> 时间：2012-04-14T13:17:13.207
> 
> 标签：c#, xml, winforms, datagridview, dataset

我有一个从包含 100 行或更多行的 XML 文件加载的数据集，但我一次只能将十五行（要求）显示到 DataGridView 中。没有用户交互；一个 10 秒的计时器移动到接下来的 15 行。

```
FileStream stream = new FileStream("file.xml", FileMode.Open); 
ds.readXml(stream); 
Stream.Close(); 
datagridview1.DataSource = ds.Tables[0]; 
ds.Tables[0].DefaultView.Sort = "start asc"; 
```

XML 文件

```
<?xml version="1.0" standalone="yes"?> 
<Table> 
  <hours> 
    <Start>10:00 AM</Start> 
    </hours> 
<hours> 
    <Start>11:00 AM</Start> 
    </hours> 
<hours> 
    <Start>1:00 PM</Start> 
    </hours> 
<hours> 
    <Start>2:00 PM</Start> 
    </hours> 
</Table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T02:08:19.053

我认为您的解决方案可以使用一个简单的 LINQ 查询来解决，每 10 秒显示一页 15 条记录：

```
private void BindPageToGrid()
{
    var dsPage = _ds.Tables[0].AsEnumerable()
        .Skip(_nPage * PAGE_SIZE)
        .Take(PAGE_SIZE)
        .Select(x => x);
    datagridview1.DataSource = dsPage.CopyToDataTable<DataRow>();
} 
```

这是使上述方法起作用的其余代码：

假设这些变量在您的 Form 类中：

```
const int PAGE_SIZE = 15; // the number of total items per page
private DataSet _ds;      // the XML data you read in
private  int _nPage;      // the current page to display
private int _maxPages;    // the max number of pages there are 
```

我会在您的 XML 中读取几乎相同的内容，但将不同的数据发送到您的 DataGridView：

```
FileStream stream = new FileStream("file.xml", FileMode.Open);
_ds.ReadXml(stream);
stream.Close();
_ds.Tables[0].DefaultView.Sort = "start asc";

// determine how many pages we need to show the data
_maxPages = Convert.ToInt32(Math.Ceiling(
               (double)_ds.Tables[0].Rows.Count / PAGE_SIZE));

// start on the first page
_nPage = 0;
// show a page of data in the grid
BindPageToGrid();
// increment to the next page, but rollover to first page when finished
_nPage = (_nPage + 1) % _maxPages;

// start the 10-second timer
timer1.Interval = (int)new TimeSpan(0, 0, 10).TotalMilliseconds;
timer1.Tick += timer1_Tick;
timer1.Start(); 
```

这是计时器滴答方法：

```
void timer1_Tick(object sender, EventArgs e)
{
    timer1.Stop();
    // show a page of data in the grid
    BindPageToGrid();
    // increment to the next page, but rollover to first page when finished
    _nPage = (_nPage + 1) % _maxPages;
    timer1.Start();
} 
```

# javascript - 复制对象后删除对象属性时的奇怪行为

> ID：10153945
> 
> 赞同：4
> 
> 时间：2012-04-14T13:18:11.820
> 
> 标签：javascript

```
 myObj = {
    prop1: 'alpha',
    prop2: 'beta',
    priceUpdatedOn: new Date()
  };

  myObjQuery = myObj;
  delete myObjQuery.priceUpdatedOn;

console.log(myObj);
console.log(myObjQuery); 
```

当我这样做时，由于某种原因，它们也会`priceUpdatedOn`被删除。`myObj`知道为什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T13:20:39.637

这是因为 myObjQuery 和 myObj 是同一个对象。当你这样做时`myObjQuery = myObj`，你不是在制作对象本身的副本，而是对它的引用的副本。你永远不会直接在 JavaScript 中操作对象，而是总是通过引用。

编辑：在 JavaScript 中克隆对象并不简单。大多数库，如 jQuery 或 Ext 都有办法做到这一点。要手动完成，类似这样的工作。

```
var clone = {};
for(var prop in myObj) {
   if(myObj.hasOwnProperty(prop)) {
       clone[prop] = myObj[prop];
   }
} 
```

请记住，这是一个浅拷贝。要进行深度复制，您需要检测属性本身是否是对象并递归地克隆它们。最好使用为您完成所有这些工作的库。还要记住，这会丢失很多边缘情况，以及对象的构造函数属性等奇怪的东西。JavaScript 在这里真的很乱。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T13:21:28.310

Javascript 适用于引用。myObjQuery 和 myObj 是对内存中相同数据的引用。改变一个的属性将改变内存中的副本，因此 - 所有对它的引用。您必须改为克隆[对象](https://stackoverflow.com/questions/122102/what-is-the-most-efficient-way-to-clone-a-javascript-object)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T13:22:07.230

用那个命令

```
myObjQuery = myObj; 
```

您*不会*创建对象的副本，而只是创建对象引用的副本。所以之后两者`myObjQuery`仍然`myObj`指向同一个对象。如果您删除该对象的属性，则两个引用都将反映该更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T13:22:34.733

因为 myObjQuery 只是 myObj 的另一个名称。修改一个将反映另一个。

参考：[http ://docstore.mik.ua/orelly/webprog/jscript/ch11_02.htm](http://docstore.mik.ua/orelly/webprog/jscript/ch11_02.htm)

# ruby-on-rails - 使用自定义规则设置

> ID：10153948
> 
> 赞同：5
> 
> 时间：2012-04-14T13:18:51.100
> 
> 标签：ruby-on-rails, ruby

根据[Set doc](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/set/rdoc/Set.html)，集合中的元素使用`eql?`.

我有一个像这样的课程：

```
class Foo
  attr_accessor :bar, :baz

  def initialize(bar = 1, baz = 2)
    @bar = bar
    @baz = baz
  end

  def eql?(foo)
    bar == foo.bar && baz == foo.baz
  end
end 
```

在控制台中：

```
f1 = Foo.new
f2 = Foo.new
f1.eql? f2 #=> true 
```

但...

```
 s = Set.new
 s << f1
 s << f2
 s.size #=> 2 
```

因为`f1`equals `f2`，**不**`s`应该同时包含它们。

 **如何`set`使用自定义规则制作拒绝元素？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-14T13:27:07.947

您链接到的文档明确说明（强调我的）：

> 每对元素的相等性根据`Object#eql?`
> **和`Object#hash`**确定，因为`Set`用作`Hash`存储。

如果您`hash`向类中添加一个为对象返回相同值的方法`eql?`，它会起作用：

```
# With your current class

f1, f2 = Foo.new, Foo.new
p f1.eql?(f2)
#=> true
p f1.hash==f2.hash
#=> false
p Set[f1,f2].length
#=> 2

# Fix the problem
class Foo
  def hash
    [bar,hash].hash
  end
end

f1, f2 = Foo.new, Foo.new
p f1.eql?(f2)
#=> true
p f1.hash==f2.hash
#=> true
p Set[f1,f2].length
#=> 1 
```

*老实说，当涉及多个值时，我对如何编写一个**好的**自定义方法从来没有很好的理解。`hash`*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-01T09:17:35.057

根据 The Ruby Programming Language 一书（由 Ruby 语言创建者 Yukihiro Matsumoto 合着），哈希方法的通用配方涉及一些数字 (17/37) 常量的使用。对于给定的示例，建议的解决方案如下：

```
def hash
  code = 17
  code = 37*code + @bar.hash
  code = 37*code + @baz.hash
  code
end 
```

所以一般来说，我们为每个重要的实例变量 (@x) 重复“code = 37*code + @x.hash”行。**

# c++ - 忽略 OS X 上框架头文件中的警告

> ID：10153956
> 
> 赞同：4
> 
> 时间：2012-04-14T13:20:10.743
> 
> 标签：c++, xcode, macos, gcc, clang

在我的 C++ 项目中包含外部库头文件时，我可以使用`-isystem`标志而不是`-I`（至少对于 GCC 或 Clang）将特定的包含目录标记为系统库目录。这样编译器就不会报告有关外部库代码的任何警告。

有没有办法使用 OS X 框架头文件来做到这一点，这些头文件没有使用`-I`标志传递给编译器，而是使用`-F`指向框架所在目录的标志？

**例子**

编译命令：

```
clang++ -F/Users/user/CustomFrameworks -o test.o -c test.cpp 
```

测试.cpp

```
#include <Framework/Header.h>
// .... 
```

框架结构：

```
$ ls /Users/user/CustomFrameworks
Framework.framework
$ ls /Users/user/CustomFrameworks/Framework.framework/Headers
Header.h 
```

如何忽略来自的警告`Header.h`？

**如果可能的话，我宁愿不在我的代码中放置任何特定于编译器的编译指示。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T11:34:59.767

使用`-iframework`旗帜。有时阅读[手册页](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/gcc.1.html)会帮助...

# java - Java - JTable 默认选择第一列

> ID：10153959
> 
> 赞同：0
> 
> 时间：2012-04-14T13:20:30.447
> 
> 标签：java, swing, jtable, selection, mouselistener

我有这段代码：

```
listTable.addMouseListener(new MouseAdapter() {
                 public void mouseClicked(MouseEvent e) {

                  if (e.getClickCount() == 1) {
                  JTable target = (JTable)e.getSource();

                  int row = target.getSelectedRow();
                  int column = target.getSelectedColumn();

                  String title = listTable.getValueAt(row, column).toString();
                  String duration = listTable.getValueAt(row, column+1).toString();
                  String genre = listTable.getValueAt(row, column+2).toString();
                  String actor = listTable.getValueAt(row, column+3).toString();
                  String director = listTable.getValueAt(row, column+4).toString();
                  //String rentable = listTable.getValueAt(row, column+5).toString();
                  //String synopsis = listTable.getValueAt(row, column+6).toString();

                  txtTitle.setText(title);
                  txtDuration.setText(duration);
                  txtGenre.setText(genre);

                  }
                }); 
```

这使我能够：

*   选择行时，它将列中的值传递给JTextBoxes。

但是，当我默认不单击第一列时，选择会出现乱码。比如我不先点击“Title”栏，再点击“Duration”栏，就会把duration放在txtTitle里面，其他的也混在一起了。

如何添加一段代码，即选择行时，它会默认 - 选择第一列？

这是发生的情况的屏幕截图：

![在此处输入图像描述](../Images/fc8ee62dce11fc956c16ce30023ab48e.png)

谢谢，布赖恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:28:28.213

改变这个

```
int column = target.getSelectedColumn(); 
```

到

```
int column = 0; 
```

您的版本从用户单击的位置获取列索引，您需要第一个（索引 0）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T13:30:12.227

一切都取决于如何设置 ListSelectionModel，但对我有用

```
myTable.changeSelection(row, column, false, false); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T13:30:24.403

为什么不总是根据已知列提取值，而不是强制选择列？

例如，您可以替换：

```
String title = listTable.getValueAt(row, column).toString(); 
```

和：

```
String title = listTable.getValueAt(row, 0).toString(); 
```

如果您提供重新排序列的功能，那么您可以尝试`table.getModel().getValueAt(convertRowIndextoModel(row), 0);`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T13:31:06.597

很明显，当您单击持续时间列时

`int column = target.getSelectedColumn();`

获取 Duration 的列值，因此

```
String title = listTable.getValueAt(row, column).toString(); 
```

从持续时间列中获取值。解决此问题的最佳方法是硬代码列号。假设您的表按以下顺序标题：第 0 列持续时间：第 1 列类型：第 2 列等等

简单的说`String title = listTable.getValueAt(row, 0).toString();`

```
String duration = listTable.getValueAt(row,1).toString(); 
```

等等..！！

希望能帮助到你

# php - 参数未与 Ajax 请求一起发布

> ID：10153962
> 
> 赞同：0
> 
> 时间：2012-04-14T13:20:45.603
> 
> 标签：php, ajax

此 Ajax 请求有效，但似乎参数未发布到 getHint.php （`$_POST['targetId']`为空）。任何想法我做错了什么？

非常感谢

```
postAjaxRequestFunktion(minFunktion, 'getHint.php', 'targetId = ' + playId)

         function postAjaxRequestFunktion(minFunk,minUrl, mittArg)
         {
            var contenttype = 'application/x-www-form-urlencoded'
            var minRequest        = new skapaAjaxObjekt(minFunk)
            if (!minRequest) return false
            minRequest.open('POST', minUrl, true)
            minRequest.setRequestHeader('Content-type',   contenttype)
            minRequest.setRequestHeader('Content-length', mittArg.length)
            minRequest.setRequestHeader('Connection',     'close')
            minRequest.send(mittArg)
            return true
         }

         function skapaAjaxObjekt(minFunk)
         {
            try       { var   minRequest = new XMLHttpRequest()                   }
            catch(e1) { try { minRequest = new ActiveXObject("Msxml2.XMLHTTP")    }
            catch(e2) { try { minRequest = new ActiveXObject("Microsoft.XMLHTTP") }
            catch(e3) { minRequest = false }}}
            if (minRequest) minRequest.onreadystatechange = function()
            {
               if (this.readyState == 4 && this.status == 200 &&
                   this.responseText != null)
                     minFunk.call(this.responseText)
            }

            return minRequest
         }  

         function minFunktion()
         {
             hintArray = eval('(' + this + ')');    
         } 
```

getHint.php：

```
$targetId = $_POST['targetId']; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:37:25.100

我建议您使用 js lib jQuery，其中 ajax 请求更简单.. 也在 php 文件中使用 var_dump($_POST); 会给你更多信息

# jquery - jquery mobile 仅替换内容 div

> ID：10153965
> 
> 赞同：6
> 
> 时间：2012-04-14T13:21:06.553
> 
> 标签：jquery, mobile, jquery-mobile

我正在使用 jquery mobile 并且我喜欢多页概念，您可以通过参考他们的 ID 将孔页替换为另一个页面。

现在我的应用程序有一个导航栏（当然），我讨厌当我点击导航栏中的链接时，整个页面都向左滑动（包括导航栏），而另一个页面来自右边。

我只是想替换内容div，导航栏应该固定在底部而不是一直刷新！你懂我的意思吗？如果我只是指内容 div id，它不像我指的是页面 id 那样工作。

我希望你知道我的意思。那么我该如何处理呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T02:32:37.573

一种方法是覆盖`click`链接事件，并用新内容替换 div （目标）的内容。在 jQuery 中这样做很简单，例如

```
 $('#replacement-target').html( $('#source-content').html() ); 
```

要与 jQuery 一起玩，您可能需要调用`refresh`内容以确保它被框架正确设置样式。

有关示例，请参[见此 jsFiddle](http://jsfiddle.net/TKQUS/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T06:20:34.213

```
$('#replacement-target-page-id div[data-role="content"]').replaceWith(
    function(return$('#source-content-page-id div[data-role="content"]').contents();) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T03:07:53.537

另一种解决方案是关闭过渡效果 $.mobile.defaultPageTransition = 'none';

并使用固定页脚。[http://jquerymobile.com/test/docs/toolbars/bars-fixed.html](http://jquerymobile.com/test/docs/toolbars/bars-fixed.html)

瑞安的建议也有效。请记住，如果您决定覆盖点击事件，并绕过 jqm 导航模型，您将无法访问非常方便的 jqm 页面事件。这实际上取决于您的应用程序的需求是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-13T00:34:25.977

对我有用的是通过使用外部标题使标题/导航栏远离页面。这样，我仍然可以使用 jquery 页面转换并保持导航栏静态。

此处记录了外部工具栏 - [http://demos.jquerymobile.com/1.4.4/toolbar-external/](http://demos.jquerymobile.com/1.4.4/toolbar-external/)

我必须初始化导航栏和任何其他我要远离页面 DOM 的组件。在这种情况下，菜单面板。根据 jqm 文档，代码如下所示：

```
<div data-role="header" data-position="fixed"></div>
<div data-role="footer" data-position="fixed"></div>
<div data-role="panel" data-position-fixed="true" data-display="overlay" id="menu-panel"></div>
<div data-role="page" id="home">
    <div role="main" class="ui-content"></div>
</div>

<script>
$(function(){
    $( "[data-role='header'], [data-role='footer']" ).toolbar();
    $( "[data-role='panel']" ).panel();
});
</script> 
```

# google-apps-script - deleteActiveSheet() 用于删除多张工作表，但结果仅在我重新加载浏览器窗口时显示

> ID：10153966
> 
> 赞同：0
> 
> 时间：2012-04-14T13:21:14.620
> 
> 标签：google-apps-script

我正在使用下面的脚本 deleteAllCreatedSheets() 删除当前电子表格中的 6 张工作表。这可以正常工作，但是，在运行脚本后，一些工作表仍然显示为存在，直到我重新加载浏览器页面 (F5)。这不是问题 - 但每次我重新加载浏览器页面时，脚本编辑器都会关闭，这使得在测试期间运行一些脚本成为一个相当大的过程！有任何想法吗？

```
function deleteBankStatement_(stname) {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sh = ss.getSheetByName(stname);
  if(!sh) {
    return;
  }
  ss.setActiveSheet(sh);
  ss.deleteActiveSheet();
  SpreadsheetApp.flush();
}

function deleteAllCreatedSheets() {
  deleteBankStatement_("p-071026363");
  deleteBankStatement_("p-076324478");
  deleteBankStatement_("p-275106284");
  deleteBankStatement_("p-653857497");
  deleteBankStatement_("PettyCash");
  deleteBankStatement_("LCPettyCash");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:52:39.113

在这种情况下，我要做的是两次打开电子表格，在两个浏览器选项卡中各打开一次。从其中一个电子表格中，您可以打开脚本编辑器来运行您的测试，而在另一个电子表格中，您可以进行刷新。

与此相关，如果您希望 Apps 脚本团队调查是否可以在电子表格 UI 中始终更新已删除的工作表而无需刷新，您可以在[问题跟踪器](http://code.google.com/p/google-apps-script-issues/issues/list)中输入功能请求。

# android - 布局设计理念

> ID：10153972
> 
> 赞同：-1
> 
> 时间：2012-04-14T13:22:17.467
> 
> 标签：android

我不确定问这个问题的最佳方式。我是 Android 开发的新手，想知道什么是完成我需要的最佳方式，例如 SurfaceViews 的组合，或者只是一个 View，它们应该是什么容器的子项……诸如此类。我正在 XOOM 平板电脑上开发它......但它需要在所有 Honeycomb Android 平板电脑上运行。

[我有一个示例屏幕原型，但我没有足够高的声誉来发布它。]

这就是我要找的东西。这个应用程序的主要活动需要在 4x4 网格中显示 16 个位图。这个网格需要占据屏幕左侧的一半或多一点。屏幕的其余部分将只有 TextViews、Buttons 和其他典型控件。

关键是我希望能够双击这 16 张图像中的一张，并让它动画化以占据 16 张的整个空间……当它到达前景时，有效地将其余部分隐藏在它后面。然后用户可以再次双击它以动画回到它在网格中的位置。

此外，我将通过 wifi 连接从服务器接收数据，这可能会告诉我我需要在位图上绘制一些东西。例如，我的位图是足球比赛的图片，我可能需要在比赛顶部绘制新的比分或图标或其他东西。所以我想我可以使用 16 个 SurfaceView，每个游戏一个，但是我尝试了 ScaleAnimation，虽然 SurfaceView 确实调整了大小，但在它上面绘制的位图没有，如果我问它的大小是什么，或者 scaleX 在 ScaleAnimation 之后是多少完成它告诉我原始大小，而不是缩放大小。所以这对我不起作用。

我愿意接受关于如何布局和视图组合的想法，或者任何可以帮助我让这个东西工作的想法。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:40:11.583

由于您的目标是蜂窝或更高版本，因此您可以采用最简单的路线，即使用标准视图。只需确保在清单中激活硬件加速即可。正如您已经发现的那样，使用标准的 android 动画框架无法轻松地为 SurfaceViews 设置动画。

因此，对于屏幕的左侧部分，使用 GridView / 嵌套的 LinearViews 或自定义布局来获取您的 4x4 矩阵。然后，每个 ChildView 都可以由一个 FrameLayout 组成，该 FrameLayout 包含一个 imageview 和一些位于 imageView 顶部的 textview。这将保证您充分利用该框架为您提供的减少开发时间和最大化灵活性的功能。请务必阅读[本文，](http://developer.android.com/guide/topics/graphics/hardware-accel.html)尤其是关于图层以加快动画速度的部分。还要确保使用酷炫的新[动画框架](http://android-developers.blogspot.de/2011/02/animation-in-honeycomb.html)

# asp.net - 更改 PlaceHolder 的内部 ASPX 代码？

> ID：10153973
> 
> 赞同：0
> 
> 时间：2012-04-14T13:22:22.367
> 
> 标签：asp.net, repeater, placeholder

我使用 a`Repeater`从不同的表中读取，因为表有不同的列，我将不得不使用动态模板。

```
 <asp:Repeater ID="tableData" runat="server" DataSourceID="SqlDataSource2">
           <ItemTemplate>
                     <asp:PlaceHolder ID="tableBody" runat="server">
                            </asp:PlaceHolder>
           </ItemTemplate>
 </asp:Repeater> 
```

但是 VS 2010 似乎无法识别嵌套在中继器中的占位符。

所以我试图让占位符生成中继器，但是如何手动更改内部代码？没有“innerHtml”选项。

**更新**

我注意到如果占位符是合适的，但我想要的是`<ItemTemplate>`动态生成内部的东西，就像`<%# DataBinder.Eval(Container.DataItem, "username") %>`

因为我正在从不同的表中读取不同的表列，所以需要根据用户想要的表进行选择。

所以我需要在处理之前修改 ASPX 代码，有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:42:07.567

Visual Studio 不会选择嵌套在 Repeater 中的控件。为此，您将需要使用 FindControl 来访问中继器中的控件。

下面是两个示例，您可以使用它来访问中继器中的控件。

1）循环通过中继器项目

```
foreach (RepeaterItem item in tableData.Items)
{
    if (item.ItemType == ListItemType.Item || item.ItemType == ListItemType.AlternatingItem)
    {
        var ph = (PlaceHolder)item.FindControl("tableBody");

        //Do something with your placeholder
        ph.Visible = true;
    }
} 
```

2)`ItemDataBound`在中继器上使用事件

```
void tableData_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
        var ph = (PlaceHolder) e.Item.FindControl("tableBody");

        //Do something with your placeholder
        ph.Visible = true;
    }
} 
```

如果您打算使用该`ItemDataBound`事件，则需要将以下属性添加到您的中继器：

```
OnItemDataBound="tableData_ItemDataBound" 
```

你能澄清一下你到底想用你的占位符做什么吗？占位符没有“innerHTML”属性。我认为您对 JavaScript 有误解。我想你想用一些 Html 填充你的转发器内的控件。您可以改用 Literal。

## 编辑

使用 Literal 根据数据库中的数据动态填充中继器。

```
void tableData_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
        //Get column from datasource
        DataRowView drv = (DataRowView)e.Item.DataItem;

        var lit = (Literal) e.Item.FindControl("MyLiteral");

        //Populate Literal with data
        StringBuilder htmlMarkup = new StringBuilder();

        htmlMarkup.AppendFormat("{0}<br />", drv["username"].ToString());
        htmlMarkup.AppendFormat("{0}<br />", drv["Name"].ToString());
        htmlMarkup.AppendFormat("{0}<br />", drv["lastname"].ToString());

        lit.Text = htmlMarkup.ToString();
    }
} 
```

如您所见，我正在检索数据并以我想要的格式输出我想要的内容。

# actionscript-3 - 评论代码 AS3 - 不是 API

> ID：10153976
> 
> 赞同：-2
> 
> 时间：2012-04-14T13:22:44.610
> 
> 标签：actionscript-3, comments

您是否认为需要注释代码，除非是 API？

我的意思是，一个很好的代码。具有自我解释的变量和方法。

有必要评论一个好的代码吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:45:42.273

这是一个很好的问题，但也非常主观。如果您编写了非常可靠的代码并拥有一个设计良好的应用程序，那么它的几乎每个部分都是不言自明的（自文档化）。但是，在你驳回评论之前，问问自己是否真的如此。

也就是说，好的注释通常会阐明代码、包、类的更大意图；它们对您正在做的事情提供更高层次的概述，而不是仅仅“解释”几行。当然，对难以理解的代码（复杂的算法）进行注释是很有用的。

无论如何，如果您的代码仅供私人使用并且您的项目范围有限，您不必在代码中乱扔注释，当您认为需要澄清时，只需直观地放置注释即可。当您稍后回到一段代码并不得不修改它时，您通常会很高兴。

# html - CSS多级下拉菜单位置下一级

> ID：10153984
> 
> 赞同：1
> 
> 时间：2012-04-14T13:23:55.117
> 
> 标签：html, css

我想知道如何定位 CSS 下拉菜单（x 轴）。目前它看起来像这样：

顶级（您悬停并显示）

*   第二级
*   第二级（悬停）
*   第二级

当您将鼠标悬停在第二层上时，第三层出现在它的下方，我如何定位它，所以每次它都在侧面？谢谢 ：）

jsFiddle：http: [//jsfiddle.net/YgYtL/](http://jsfiddle.net/YgYtL/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:36:32.410

定位您的第三级下拉菜单并将其定位在距第二级元素左侧 100% 的位置，这应该是第二级下拉菜单的整个宽度，如下所示：

```
#navMenu ul ul ul {
    left: 100%;
    top: 0;
} 
```

演示：http: [//jsfiddle.net/YgYtL/24/](http://jsfiddle.net/YgYtL/24/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T13:38:36.193

我已经用 css 中的这段代码更新了 jsFiddle

```
#navMenu ul li ul li:hover ul{
    top : 0;
    left : 100%;
} 
```

这是：http: [//jsfiddle.net/YgYtL/16/](http://jsfiddle.net/YgYtL/16/)

# backbone.js - Backbone.js 从服务器就地更新模型

> ID：10153987
> 
> 赞同：1
> 
> 时间：2012-04-14T13:24:35.050
> 
> 标签：backbone.js

这是场景 - 一个页面呈现一组小部件，这些小部件向用户显示一些聚合数据。此数据从 API 中检索，并定期重新计算。显示这些很好（感谢 stackoverflow 的优秀人员），但是当服务器上的数据发生更改时，我只是无法重新渲染视图。

值得注意的是，如果只有一个更新了数据，我更喜欢不重新渲染所有页面的小部件（可能是 10+）的更有效的方法。每隔一段时间获取一个集合很容易，但是关于渲染一个 chaned 模型的最佳实践是什么？我看过各种关于覆盖同步功能的帖子，但不确定该去哪里。

有什么方法可以就地重新渲染视图（而不是重新附加到页面）。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T14:59:09.533

我认为您需要的是在不刷新整个集合的情况下将现有模型更新到集合中。在这里检查[我的答案](https://stackoverflow.com/questions/9640095/backbone-js-collection-upsert/9663670#9663670)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:03:13.167

您可以绑定到模型/集合上的特定更改以触发小部件的渲染方法。例如，在模型上：

```
var Widget1=Backbone.View.extend({
    initialize: function() {
        // all changes on the model will render the widget
        this.model.on("change", this.render, this); 
    },

    render: function() {
        console.log("Render W1");
        this.$el.html("W1 :"+this.model.get("name")+" "+this.model.get("detail"));
        return this;
    }
});
var Widget2=Backbone.View.extend({
    initialize: function() {
        // only a change on `detail` will render the widget
        this.model.on("change:detail", this.render, this);  
    },

    render: function() {
        console.log("Render W2");
        this.$el.html("W2 :"+this.model.get("detail"));
        return this;       
    }
}); 
```

一个更完整的 Fiddle 可以使用[http://jsfiddle.net/GqnKC/](http://jsfiddle.net/GqnKC/)

# android - 如何使其仅适用于平板电脑和仅适用于手机的纵向？

> ID：10153992
> 
> 赞同：11
> 
> 时间：2012-04-14T13:25:51.163
> 
> 标签：android, android-layout

如何让平板电脑在运行应用程序时强制横向运行，而当手机运行应用程序时强制纵向运行？我已经设法强制它运行让我们说肖像，但它也为平板电脑运行肖像......平板电脑中的肖像模式很丑:(谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-14T13:35:16.680

这是我的建议：首先尝试使用屏幕尺寸确定设备类型。你可以参考[这篇文章](https://stackoverflow.com/questions/1016896/android-how-to-get-screen-dimensions)。在第二步中，您可以使用 更改屏幕方向`setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);`。[这里](https://stackoverflow.com/questions/6654675/programmatically-lock-into-portrait-mode-for-certain-operations)还有一个帖子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-23T12:57:38.750

只需为清单中的活动设置 nosensor 参数：

```
 <activity
        android:name=".activity.MyActivity"
        android:configChanges="keyboardHidden|orientation|screenSize" 
        android:screenOrientation="nosensor"> 
```

顺便说一句，某些平板电脑可能会被检测为手机，例如 Nexus 7。

# sublimetext - Sublime Text 2 - 查看空白字符

> ID：10153998
> 
> 赞同：451
> 
> 时间：2012-04-14T13:26:51.353
> 
> 标签：sublimetext, sublimetext2

Sublime Text 如何显示不可打印的字符（我对 SPACE 和 TAB 感兴趣）？

* * *

## 回答 #1

> 赞同：683
> 
> 时间：2012-04-14T13:29:10.317

要查看空白，设置为：

```
// Set to "none" to turn off drawing white space, "selection" to draw only the
// white space within the selection, and "all" to draw all white space
"draw_white_space": "selection", 
```

如果您进入首选项-> 设置默认值，您可以看到它。如果您编辑您的用户设置（首选项-> 设置 - 用户）并按照以下添加行，您应该得到您想要的：

```
{
    "color_scheme": "Packages/Color Scheme - Default/Slush & Poppies.tmTheme",
    "font_size": 10,
    "draw_white_space": "all"
} 
```

请记住，设置是 JSON，所以没有尾随逗号。

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2012-04-19T08:11:54.293

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-08-23T14:18:00.153

我使用`Unicode Character Highlighter`, 可以显示空格和其他一些特殊字符。

添加这个，包控制

安装包，unicode ...

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-10-03T07:38:23.990

如果你真的只想看到尾随空格，这个 ST2 插件可以解决问题：[https ://github.com/SublimeText/TrailingSpaces](https://github.com/SublimeText/TrailingSpaces)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-01-21T16:48:39.047

如果您希望能够打开和关闭空格的显示，您可以安装[HighlightWhitespaces 插件](https://github.com/disq/HighlightWhitespaces)

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2016-10-13T05:22:47.500

**这是如何做到这一点的官方教程！**
**[http://sublimetexttips.com/show-whitespace-sublime-text/](http://sublimetexttips.com/show-whitespace-sublime-text/)**

> 像这样！

[![在此处输入图像描述](../Images/b993a598bee4028bf31df8f916fe72b9.png)](https://i.stack.imgur.com/q2R8q.png)
[![在此处输入图像描述](../Images/076974df3996b365569abc2088c81d69.png)](https://i.stack.imgur.com/maIXK.png)

**希望对你有所帮助！**

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-03-08T20:09:45.123

我知道这是一个旧线程，但我喜欢我自己的插件，它可以通过一个快捷方式[在空白模式（无、选择和全部）之间循环。](https://github.com/kodybrown/SublimeCycleWhiteSpace)它还在 View | 下提供菜单项。空白菜单。

希望人们会发现这很有用——很多人都在使用它:)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-09-22T19:23:06.830

一种“快速而肮脏”的方法是使用 find 函数并激活正则表达式。

然后只需搜索 : \s 突出显示空格 \t 用于制表符 \n 用于换行符等。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-09-19T01:48:26.290

[http://sublimetexttips.com/show-whitespace-sublime-text/](http://sublimetexttips.com/show-whitespace-sublime-text/)

1.  打开

`Ctrl`+ `Shift`+`P`

2.  搜索

> 首选项：设置 -> 用户

3.  只需粘贴以下代码

```
{
    "draw_white_space": "all",
    "translate_tabs_to_spaces": true
}
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-07-18T06:14:50.983

# php - 整合Facebook sql表

> ID：10153999
> 
> 赞同：0
> 
> 时间：2012-04-14T13:26:59.110
> 
> 标签：php, facebook

我在我当前的网站上有一张桌子

```
users

id
username
password
email 
```

如果我要在我的网站上集成 Facebook 身份验证，我将在数据库中存储什么来识别数据库中的行拥有 Facebook 的哪个用户？是 Facebook 所有者的用户 ID 还是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:32:44.223

好朋友去[这里看看官方文档](https://developers.facebook.com/docs/authentication/)

[这是我前段时间使用的教程，它确实涵盖了所有角度](http://net.tutsplus.com/tutorials/php/how-to-authenticate-your-users-with-facebook-connect/)