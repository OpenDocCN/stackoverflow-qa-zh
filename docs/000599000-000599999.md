# StackOverflow 问答 000599000-000599999

# domain-driven-design - 具有 DbC 支持的业务实体/值对象框架

> ID：599000
> 
> 赞同：2
> 
> 时间：2009-03-01T00:41:20.553
> 
> 标签：domain-driven-design, design-by-contract

我认为我在构建业务模型时花费最多的时间是验证业务实体并确保实体对象及其关系保持良好的完整性。我对一个好的实体/值对象框架的梦想将帮助我创建可重用的实体/值对象，并像在数据库中一样轻松地为关系创建约束和规则，但是因为我觉得这确实是它们属于模型的业务规则，应该是完全独立于数据库。

应该很容易定义 Person 对象的 Name 属性应该是必需的，Email 属性应该是必需的并匹配某个正则表达式，并且这些规则应该易于重用 f.ex。在我的网络应用程序中验证输入。

我在使用 Linq to sql 方面绝对有最丰富的经验，尽管使用它确实很好，但由于不支持值对象和其他对象而受到限制。我的问题是实体框架或 NHibernate 会更适合，还是有其他技术更适合我的需求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T18:30:20.957

[去年我读了一本史蒂夫·桑德森（Steve Sanderson）自己写](https://rads.stackoverflow.com/amzn/click/com/1430216468)的小书，向我介绍了 DDD 的概念。尽管这本书是关于 ASP.NET MVC 的预览版，但他真正关注的是 MVC 中的“M”作为一个真正的纯领域模型——使用了这本书的近 1/2 的建模方法（我非常喜欢）。他接近的一件事是在聚合根的上下文中使用值对象（显然）。但是，他还展示了如何使用 Linq 来表示实体以及值对象。

关键是，他指出了 Linq 的局限性，即它必须在每个对象上都有一个标识，包括值对象。他承认它打破了纯领域模型方法。但是，这是让它与 Linq-to-SQL 一起工作的唯一方法。

他的解决方法是给你的价值对象一个身份；但是，将该身份设置为内部的，这样它就不会暴露在您的模型之外。这将允许您在存储库中使用 Linq 链接和共享您的对象；虽然不将其暴露给客户端层 - 所以，就好像它们是专门的值对象。

我相信实体框架也有同样的要求。

AC# 示例如下。

```
public class MyEntity
{
  [Column(IsPrimaryKey = true
    , IsDbGenerated = true
    , AutoSync = AutoSync.OnInsert)]
  public int EntityID { get; set; }

  [Column(CanBeNull = false)]
  public string EntityProperty
  {
    get
    {
      // insert business rules here, if need be
    }
    set;
  }
}

public class MyValueObjectForMyEntity
{
  // make your identity internal
  [Column(IsPrimaryKey = true
    , IsDbGenerated = true
    , AutoSync = AutoSync.OnInsert)]
  internal int ValueObjectID { get; set; }

  // everything else public
  [Column(CanBeNull = false)]
  public string MyProperty { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T04:47:32.100

尽管看起来您是在世界的 .Net 方面，但我强烈推荐 Eric Evans 的书“领域驱动设计”。（实际上 UML 比 Java 多，这些想法应该移植。）

这是一本模式书，但他提出了许多设计策略，主张将所有对象规则逻辑（“不变量”）粘贴到一个集中的域中；然后，他继续反复讨论一些普遍理解的模式，并使像你这样的问题看起来更容易处理。好吧，如果不易于处理，至少从长远来看更易于管理。

# linux - 计算shell中文件的大小

> ID：599027
> 
> 赞同：55
> 
> 时间：2009-03-01T00:57:51.560
> 
> 标签：linux, shell

我正在尝试仅使用 shell 计算与文件名模式匹配的所有文件（在目录树中）的总大小（以字节为单位）。这是我到目前为止所拥有的：

> 查找 -name *.undo -exec stat -c%s {} \; | awk '{总计 += $1} END {打印总计}'

有没有更简单的方法来做到这一点？我觉得应该有一个简单的 du 或 find 开关可以为我执行此操作，但我找不到。

需要明确的是，我想在目录树下的任何地方对匹配模式的文件进行总计，这意味着

> du -bs *.undo

不起作用，因为它只匹配当前目录中的文件。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-03-01T01:59:14.407

尝试：

```
find . -name "*.undo" -ls | awk '{total += $7} END {print total}' 
```

在我的系统上，文件的大小是输出中的第七个字段`find -ls`。如果您的`find … -ls`输出不同，请进行调整。

在这个版本中，使用现有的目录信息（文件大小）和 find 的内置 ls 功能应该是高效的，避免进程创建或文件 i/o。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-03-01T03:00:12.153

使用 zsh，您可以使用扩展通配符来执行以下操作：

du -c **/*.undo

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-05-18T00:43:58.397

```
find -name *.undo -print0 | du -hc --files0-from=- 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-03-01T01:10:35.320

```
du -c *pattern* 
```

这将在输出的最后一行打印总数。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-06-09T07:05:08.413

我也一直在研究这个问题（仅一年后......） - 才发现这个页面。

我发现的东西（对我来说）如下：

```
find /mnt/iso -name *.avi -printf "%s\n" | paste -sd+ - | bc 
```

这将返回 /mnt/iso 下所有子文件夹中所有 .avi 文件的总大小

我必须将粘贴命令归功于 radoulov - 请参阅此页面： [Shell command to sum integers, one per line?](https://stackoverflow.com/questions/450799/linux-command-to-sum-integers-one-per-line)

只是添加 - 以防文件夹与搜索词匹配 -`-type f`在 find 命令中使用也是一个好主意。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-01T01:16:46.973

```
find -name '*.undo' -exec wc -c {} + | tail -n 1 
```

如果您没有太多文件（其中“太多”将是一个非常大的数字，可能有数千个），应该给出文件中的实际总字节数。或者，如果您只想单独获取号码，

```
find -name '*.undo' -exec wc -c {} + | tail -n 1 | cut -d' ' -f 1 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-03-01T01:29:16.913

Python 是大多数 linux 发行版的一部分。

```
import os
import fnmatch
size= 0
for path, dirs, files in os.walk( '.' ):
    for f in files:
        if fnmatch.fnmatch(f,'*.py'):
            fileSize= os.path.getsize( os.path.join(path,f) ) 
            print f, fileSize
            size += fileSize
print size 
```

冗长，但非常清晰且高度可扩展。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-04-13T11:14:40.007

```
find -name '*.undo' -print0 | du -hc --files0-from=- | tail -n 1 
```

将[gerdemb](https://stackoverflow.com/users/27478/gerdemb "格登姆")和 strager 的贡献放在一起。使用`du -cb`应该显示字节。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-07-18T18:43:30.060

我使用这样的 du 命令来仅获取数字：

```
du file_list | awk '{s+=$1} END {print s}' 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-08T18:50:09.940

这个简单的怎么样。

```
find ./ -name *.undo | xargs wc 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-02-03T19:59:47.150

或者，您可以这样做：

```
dir=$1

for file in $dir/* ; do

 length_file=`stat -c %s $file`
 echo "File $file has length $length_file"
 length_total=`expr $length_total + $length_file`

done

echo "Total length: $length_total ." 
```

其中 stat 显示文件或文件系统状态。参数 -c 表示使用指定格式而不是默认格式，格式序列 $s 允许显示总字节大小。

```
expr 
```

只计算一个表达式。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-09-09T17:26:24.030

Perl 单行：

```
find . -name "*.undo" -ls | perl -lane '$t += $F[6]; END{print $t}' 
```

`@F`自动拆分数组从索引开始，而`$F[0]`awk 字段以 $1 开始，因此`$F[6]`使用它来代替 awk`$7`

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-06-14T20:52:59.540

杜-c | awk '/./{line=$0} END{打印 $1}'

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-05-11T16:07:40.410

我认为带有 xargs 的版本可以改进（简化） ls -1 *.undo | xargs 厕所

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2009-03-01T01:04:24.057

检查[du](http://linux.die.net/man/1/du)（磁盘使用情况）命令。

# c++ - 强制 Visual Studio 链接 lib 文件中的所有符号

> ID：599035
> 
> 赞同：25
> 
> 时间：2009-03-01T01:09:14.073
> 
> 标签：c++, visual-studio, linker

有没有办法强制 Visual Studio 将 lib 文件中的所有符号链接到 dll 中，因为 atm 它正在优化程序在运行时使用 dll 所需的“未使用”函数。

我尝试使用 /OPT:NOREF 和 /OPT:NOICF 但它们似乎不起作用。

我需要它们的原因是因为它们是全局类，它们向控制器注册它们自己，并且它们没有在 dll 中链接。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-01T01:54:10.580

我不知道在 Visual Studio 中是否有更优雅的方式，但我们使用它的跨平台解决方案有两个宏来强制链接有问题的目标文件。

一个放在要排除的函数的源文件中，另一个放在链接器知道将被调用的函数中。

就像是;

```
#define FORCE_LINK_THIS(x) int force_link_##x = 0;

#define FORCE_LINK_THAT(x) { extern int force_link_##x; force_link_##x = 1; } 
```

它并不完全优雅，但我们还没有找到一个更好的跨平台工作的解决方案。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-09-07T09:13:45.763

实际上有一个半官方的解决方案，[这里是](http://ofekshilon.com/2013/04/06/forcing-construction-of-global-objects-in-static-libraries/).

TL;博士：

**'使用库依赖输入'**。

在 VS 术语中，“库依赖输入”是构成库的 obj 文件的名称。您实际上可以在两个范围内控制此行为：

1.  每个引用：通过引用属性中的“使用库依赖项输入”组合。[这是我个人使用的解决方案，也是帖子](http://ofekshilon.com/2013/04/06/forcing-construction-of-global-objects-in-static-libraries/)中提到的解决方案。[![使用库依赖输入](https://i.stack.imgur.com/opWsX.png)](https://i.stack.imgur.com/opWsX.png)

2.  对于整个可执行文件：在 exe 项目属性 /C++/Linker/General/ 中使用库依赖项输入 -> 是

这些神秘设置的历史动机是[在以前不可用的地方启用增量链接](http://blogs.msdn.com/b/vcblog/archive/2010/05/03/flexible-project-to-project-references.aspx)，但它具有直接链接到打包在 lib 中的 obj 文件的有用副作用，从而也构造未引用的全局对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T07:31:38.293

我在插件系统中遇到了同样的问题，其中各种 DLL 中的工厂使用一个通用的主工厂，加载库时所有内容都在启动时注册，而无需硬编译要使用的插件列表。这在 Linux 下运行良好，但在 Windows 下有两个问题：

1.  DLL 之间的工厂并不常见。这不是你的问题，但它是相关的。我在这里得到了一个解决方案：[确保使用常见的fatories](https://stackoverflow.com/questions/398069/static-member-variable-in-template-with-multiple-dlls)。使用 set_the_global 函数查看 James 的答案。
2.  如果主中没有使用 DLL 的符号，则它们不会在启动时设置。我认为这是你的问题。我发现的唯一解决方案是使用配置文件（一个子项目）列出可用插件（DLL）的名称，并在我的例子中强制使用 QLibrary 进行链接。使用 cmake，每个子项目的配置文件的默认版本在构建时使用以下宏生成，而不是在每个插件目录中调用 add_library：

    ```
    file(WRITE ${CMAKE_BINARY_DIR}/${CMAKE_PROJECT_NAME}-plugins "")
    macro (DECLARE_AMOSE_PLUGIN _plugin)
      file (APPEND ${CMAKE_BINARY_DIR}/${CMAKE_PROJECT_NAME}-plugins "${_plugin}\n")
      add_library(${_plugin} SHARED ${${_plugin}_LIB_SRCS})
    endmacro (DECLARE_AMOSE_PLUGIN) 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-20T21:18:51.450

我使用了一个编译指示，它似乎有效，但如果你不包含这条线，它不会窒息。

```
#include "library1.h"
#include <QApplication>
#pragma comment(lib, "C:\\Qt\\5.5\\msvc2013_64\\lib\\Qt5Guid.lib")
PHI_STATUS PHI_EXP_CONV PHI_ShowGUI(size_t reserved)
{
    QApplication app(none, nullptr);
    ...
} 
```

您还可以通过选项卡`Additional Dependencies`中的字段链接它们`Librarian`。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-02T09:52:40.937

DLL 将如何在运行时从您的库中调用函数？这听起来有点难以置信。

现在，如果*DLL*的用户要调用您的库函数，那么您的问题是有道理的。Windows 编译器（与 Unix 编译器不同）仅在明确请求时才从 DLL 导出函数。最常见的方法是声明函数“dllexport”，但您也可以在 .DEF 文件中命名函数，并将其传递给链接器。请注意，您需要在 .DEF 文件中列出 C++ 错位名称。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-03-17T00:01:20.787

在 MSVC2k17 中测试...

```
__pragma(comment(linker,"/export:REGISTERfunc"));
void REGISTERfunc() { printf("I'm linked!\n" ); } 
```

完全有效。这甚至可以在静态链接的 .lib 中，并且会一直传递到输出可执行文件甚至更远！

编辑：您甚至可以将其放入宏中以获得超棒的积分！

编辑：另一个注意事项：您必须启用链接时代码生成。/LTCG ...某事

# http - 抓取机器人和页面大小

> ID：599041
> 
> 赞同：0
> 
> 时间：2009-03-01T01:12:04.833
> 
> 标签：http, web-crawler

想知道，一个网站是否会在搜索引擎排名或结果定位方面受到影响，如果它的大小没有优化，而是与相同类型的网站相比它具有平均加载时间。让我们说

```
No Cache:
289.0K  Total size
35      HTTP requests 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T01:29:56.583

搜索引擎排名由链接中使用的关键字决定（主要来自其他网站）。您的页面大小相对无关紧要。

# wpf - WPF 图像加载到显示延迟

> ID：599047
> 
> 赞同：3
> 
> 时间：2009-03-01T01:17:26.847
> 
> 标签：wpf

从设置图像控件的源到实际显示有一点延迟。

我需要一些方法来找出确切显示图像的时间，但我似乎找不到任何可以挂钩的事件。有没有人有办法检测到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T11:56:35.313

假设您的图像是某种位图，请创建一个 BitmapImage 对象并使用其 DownloadCompleted 事件。

示例，当图像准备好时调用 ReadyToDisplay：

来自代码：

```
BitmapImage bmp = new BitmapImage(imageUri);
bmp.DownloadCompleted += ReadyToDisplay;
image.Source = bmp; 
```

来自 XAML：

```
<Image>
   <Image.Source>
      <BitmapImage UriSource="/images/image.png" DownloadCompleted="ReadyToDisplay"/>
   </Image.Source>
</Image> 
```

我没有测试那些代码示例，所以它们可能有错别字

# ssl - HTTP 摘要式身份验证与 SSL

> ID：599048
> 
> 赞同：24
> 
> 时间：2009-03-01T01:18:55.113
> 
> 标签：ssl, http-authentication, digest

从性能、安全性和灵活性的角度来看，HTTP 摘要式身份验证和 SSL 有什么区别？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-01T06:28:04.870

HTTP Digest Authentication 的优缺点在[有关该主题的 Wikipedia 文章中](http://en.wikipedia.org/wiki/Digest_access_authentication)已进行了非常清楚的解释——您应该阅读！

坦率地说：HTTP Digest Auth 只会保护您免于将明文密码丢失给攻击者（并考虑到 MD5 安全状态，甚至可能不是这样）。

然而，它对中间人攻击是开放的，而且——取决于实现，因为大多数高级特性都是可选的——重放、字典和其他形式的攻击。

但是，HTTPS 连接和受 Digest Auth 保护的 HTTP 连接之间的最大区别在于，前者使用公钥加密对*所有内容进行加密，而后者则以明文形式发送内容。*

至于性能：从上面提到的几点来看，你应该很清楚你得到了你所付出的（使用 CPU 周期）。

对于“灵活性”，我会选择：嗯？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-01T02:10:05.177

摘要式身份验证仅加密身份验证凭据（即您在浏览器的身份验证对话框中键入的用户名和密码）... SSL 加密页面中的*所有内容*。因此 SSL 的效率会降低，而且设置起来通常也更复杂。但是 SSL 确实有一个优势，它可以让双方验证彼此的身份，如果他们有受信任的证书的话。HTTP 摘要身份验证不这样做，因此当使用不带 SSL 的 HTTP 摘要时，您真的不知道您将登录信息发送到的服务器是正确的服务器还是冒名顶替者。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-02T11:09:52.687

HTTP Digest Authentication 的一些服务器实现强制您将明文密码保存在服务器上更好的实现保存`username:realm:MD5(username:realm:password)`这具有对存储的密码进行加盐的效果，[如果](http://en.wikipedia.org/wiki/Salt_(cryptography))攻击者获得了密码文件，则可以提供一定的安全性。

# php - 用 PHP 解析日期

> ID：599052
> 
> 赞同：0
> 
> 时间：2009-03-01T01:27:46.230
> 
> 标签：php, parsing

我正在尝试编写一个程序，但我不知道如何将这种格式的日期解析为日期戳

2005 年 1 月 15 日上午 12:00

我不关心上午 12:00，因为所有记录都附加了上午 12:00。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-01T01:33:07.370

使用[strtotime()](http://php.net/strtotime)将日期转换为 unix 时间戳。您还可以将此时间戳与[date()](http://php.net/date)函数一起使用，以您想要的任何方式对其进行格式化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T01:32:58.557

使用 strtotime() 函数 ... 例如： $new_date = strtotime("Jan 15 2005 12:00AM");

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T03:28:59.407

从 PHP 5.2 开始，一种更新的方法是使用[DateTime 类](http://php.net/manual/en/class.datetime.php)：

```
$datetime = new DateTime("Jan 15 2005 12:00AM");
echo $datetime->format('Y-m-d'); 
```

[看到它在行动](http://codepad.viper-7.com/jnEZuD)

# sql-server-2005 - 我需要使用 Linq2SQL 存储过程吗？

> ID：599073
> 
> 赞同：0
> 
> 时间：2009-03-01T01:51:37.437
> 
> 标签：sql-server-2005, linq-to-sql, stored-procedures, .net-3.5

我刚开始使用 Linq to SQL，突然想到我真的不需要数据库中的任何存储过程，因为我可以通过 Linq to SQL 进行所有数据访问。

有什么理由用 Linq to SQL 编写存储过程吗？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T08:18:13.510

存储过程非常重要。LinkToSQL 需要直接访问以插入、更新、删除和选择表中的数据。这意味着如果您的站点或应用程序没有正确检查用户输入，您的数据库就会受到数据库注入攻击。

使用存储过程时，这不是问题，因为登录数据库的用户没有直接的表访问权限。访问权限被授予存储过程，这使 UI 可以访问表，但仅限于存储过程的上下文中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T02:02:00.640

少得多，IMO，但在某些情况下使用存储过程或表值函数仍然有用。当然，LinqToSQL 并不排除使用存储过程，因此如果需要，您仍然可以使用它们。例如，我使用表值函数对表连接进行参数化查询，以支持多变量过滤器。这可以大大简化您的代码，并使您能够优化查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T02:07:17.197

通常没有充分的理由在新应用程序中编写存储过程。

原因是有无数更好的技术可以在您的应用程序中执行数据访问。有许多对象关系映射技术可用于数十种语言和平台。

存储过程的一个论点是它们在数据库前面提供了一个抽象 API。问题在于，SQL 对于尝试编写高级业务程序来说是一种非常糟糕的语言。另一个问题是，您将使用 SQL 以外的语言在数据库前面使用 API。C#、Ruby 和 Haskell 等语言提供了更强大的在数据库前创建 API 的方法，在这些语言中使用时更加自然。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T01:58:47.030

可能与要求所有数据检索通过一组受控存储过程完成的现有数据库交互。

或者也许有一个很难（不可能？）在 Linq2SQL 中实现的构造。

[使用存储过程检索数据](http://weblogs.asp.net/scottgu/archive/2007/08/16/linq-to-sql-part-6-retrieving-data-using-stored-procedures.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-10T11:12:02.197

恐怕你刚刚踏上了宗教矿井！

存储过程与否是一个非常激烈争论的话题，并且（在我看来）通常归结为一方面是 DB/SQL 专家，另一方面是“普通”开发人员之间的斗争。每一方都试图尽可能多地得到羽绒被。

看看这个链接，[存储过程不好，好吗？](http://weblogs.asp.net/fbouma/archive/2003/11/18/38178.aspx)以及随后的 LOOOOONG 辩论。

# c# - 在 C# 中处理货币金额的最佳实践

> ID：599083
> 
> 赞同：9
> 
> 时间：2009-03-01T02:02:18.423
> 
> 标签：c#, types, currency

我已经阅读了几篇关于某些数据类型用于存储货币金额的危险的文章。不幸的是，有些概念不在我的舒适区。

阅读了这些文章后，在 C# 中使用金钱的最佳实践和建议是什么？我应该对少量使用某种数据类型，而对大量使用不同的数据类型吗？另外，我在英国，这意味着我们使用 ,（例如 4,000 英镑，而其他文化代表相同的金额不同）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-01T02:31:06.967

小数是货币金额最合理的类型。

Decimal 是一种以 10 为基数的浮点数类型，具有 28+ 个十进制数字的精度。使用 Decimal，您将比使用 base 2 Double 类型的惊喜更少。

Double 使用的内存是 Decimal 的一半，Double 会更快，因为 CPU 硬件用于许多常见的浮点运算，但它不能准确表示大多数以 10 为底的分数（例如 1.05），并且 15+ 十进制数字的准确度较低精确。Double 确实具有更大范围的优势（它可以表示更大和更小的数字），这对于某些计算，尤其是一些统计计算来说非常有用。

您的问题的一个答案指出，十进制是具有 4 位十进制数字的定点。不是这种情况。如果您对此表示怀疑，请注意以下代码行产生 0.0000000001：

```
Console.WriteLine("number={0}", 1m / 10000000000m); 
```

说了这么多，有趣的是，世界上使用最广泛的处理货币金额的软件 Microsoft Excel 使用双精度数。当然，他们必须跳很多圈才能使其正常工作，但仍然有一些不足之处。在 Excel 中尝试以下两个公式：

*   =1-0.9-0.1
*   =(1-0.9-0.1)

第一个产生 0，第二个产生 ~-2.77e-17。在某些情况下，Excel 实际上会在加减数字时对数字进行处理，但并非在所有情况下都如此。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-01T02:08:42.200

由于舍入错误，您不应使用浮点数。十进制类型应该适合您。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-01T02:45:11.363

Martin Fowler 建议使用[Money 类](http://www.martinfowler.com/ap2/quantity.html)。有关理由，请参阅链接。他的想法有很多实现，或者你可以自己编写。Fowler 自己的实现是用 Java 编写的，所以他使用了一个类。我见过的 C# 版本使用结构，这似乎是明智的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-01T02:08:44.930

我使用一个值对象来保存金额（作为 a `decimal`）和货币。这允许同时使用不同的货币。`decimal`是 .NET 中推荐的用于金钱的数据类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-01T03:22:53.490

如果需要除法，我的建议是使用 Decimal，正如其他人所推荐的那样。对于简单的计数应用程序，我建议使用整数类型。对于这两种类型，我总是使用最低的货币面额。（即加拿大/美国的美分）

我确实喜欢 @dangph 添加的 Fowler's Money call 理论。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-01T03:48:13.007

无论您做什么，请确保您了解在应用程序的每一层中如何处理货币金额。

我曾经花了一周时间追踪一个 1 美分的错误，因为 SQLServer 和 .Net 使用不同的货币舍入方式，并且应用程序在处理某些类型的计算方面并不一致——有时它们是在 SQL 中完成的，有时是在 .net 中完成的。如果您有兴趣，请查看“[银行家的四舍五入”。](http://en.wikipedia.org/wiki/Rounding#Round-to-even_method)

还有与格式化货币有关的问题——不确定您是否必须处理非英国金额、其他语言/文化等，但这会增加另一个层次的复杂性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-01T05:54:23.483

正如您在问题中指出的那样，除了使用适当的数据类型之外，您的程序处理货币转换的能力也很重要。这个问题当然不是货币独有的。[Jeff Atwood](https://stackoverflow.com/users/1/jeff-atwood)做了一篇很棒的文章，总结了执行[土耳其测试](http://www.codinghorror.com/blog/archives/001075.html)的优点。

# objective-c - 获取 NSTimer 的 Target 的返回值

> ID：599084
> 
> 赞同：1
> 
> 时间：2009-03-01T02:02:38.160
> 
> 标签：objective-c, cocoa, return, nstimer

我有一个 NSTimer，它的设置如下：

```
[NSTimer scheduledTimerWithTimeInterval:0.5 target:timerTarget selector:NSSelectorFromString(targetSelector) userInfo:nil repeats:YES]; 
```

如何获取`timerTarget`方法的返回值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-01T02:09:44.383

你对返回值做了什么？目标在 0.5 秒后异步运行。调用立即`scheduledTimerWithTimeInterval:target:selector:useInfo:repeats:`返回，此时目标尚未运行。如果您现在确实需要返回值*，*那么不要打扰计时器，只需正常调用选择器即可。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-01T03:02:01.230

你不能，因为没有返回值。

Quoth[方法的](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSTimer_Class/Reference/NSTimer.html#//apple_ref/occ/clm/NSTimer/scheduledTimerWithTimeInterval:target:selector:userInfo:repeats:)[文档`scheduledTimerWithTimeInterval:::::`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSTimer_Class/Reference/NSTimer.html#//apple_ref/occ/clm/NSTimer/scheduledTimerWithTimeInterval:target:selector:userInfo:repeats:)：

> 选择器必须具有以下签名：
> 
> ```
> - (void)timerFireMethod:(NSTimer*)theTimer 
> ```

现在，您*可以以*不同的方式声明您的方法，然后在其中返回一个值，但是您的方法具有与 NSTimer 期望的不同的签名。现在可以正常工作，但不能保证将来可以正常工作——它可能随时中断，尤其是运行时的更改。

更重要的是，由于 NSTimer 不期望返回值，因此它没有规定可以接收一个并将其传递到任何地方。

此外，正如我在对亚当的回答的评论中所说，您的电话`scheduledTimerWithTimeInterval:::::`只返回一次，并且（正如亚当所说）它会立即返回。你不会每 0.5 秒得到一个返回值，因为你不会每 0.5 秒得到一个返回值——你*只*得到一个返回值（每个计时器）。

Whatever information you're finding out in your timer method, you need to either act on it there or send a message with the information from there to another method.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T02:58:36.573

跟进亚当的好回答，如果您觉得在目标方法完成运行后需要它的返回值，那么您可能想要做的是让目标方法本身继续执行一些进一步的操作。

例如，您可以使用“userInfo”参数传递对感兴趣对象（self？）的引用。然后，目标方法可以使用预先安排的选择器将更新的值发送给自身，而不是返回值。例如，在您的目标方法中，您可以以以下方式结束：

```
[[theTimer userInfo] setWhatever:blah]; 
```

从概念上讲，您需要听取 Adam 的建议，并考虑计时器调用的方法将在未来发生的事实，如果您想连接回特定的类及其工作流，您需要自己以某种方式连接它。

# post-redirect-get - 在 Post/Redirect/Get 模式中如何处理服务器端错误？

> ID：599086
> 
> 赞同：32
> 
> 时间：2009-03-01T02:03:09.903
> 
> 标签：post-redirect-get

对于成功的用例，发布/重定向/获取 (PRG) 工作流程非常简单：只需将（客户端）重定向到所需页面。但是，如果在服务器端验证期间遇到错误并且我们希望在再次显示输入页面时保留输入，该怎么办？

据我所知，有两种方法：在错误期间简单地在表单 POST 提交（即没有重定向）之后重新呈现输入页面（因此忽略 PRG 模式）；或者，重定向到输入页面，并将先前的输入存储在稍后可以检索的地方（例如会话），在呈现期间。两者都有缺点：首先，我们遇到了 PRG 模式帮助我们避免的问题（例如可收藏、重复提交）；第二种方法会导致 GET 不一致（第一个 GET 会找到存储的输入，随后的 GET 可能不会）。除了这里提到的还有其他选择吗？我希望社区就如何最好地处理此案提供意见。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-01T02:17:47.560

我通常按​​照您描述的第一种方式进行 - 仅在成功提交的情况下重定向。很难看到为包含无效数据的表单添加书签的真实用例；另一方面，为确认页面添加书签通常是有意义的（在成功提交之后）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-01T02:11:14.363

如果用于填写表单的 URL 是表单发布到的 URL，我认为没有问题。如果输入有效，则重定向和 GET。如果无效，重新显示填写好的表格。这样，交互看起来像：

```
GET  /your-url => blank form
POST /your-url (success) => Redirect => GET /success-url
POST /your-url (failure) => filled-in form 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-05-17T06:05:27.427

提到的可书签性问题会影响这两种方法，您不能真正为依赖于服务器上保存的一些临时数据的东西添加书签。

如果您确保如果验证失败，您不保存任何数据（即每个数据失败的提交都是幂等请求），那么双重提交并不是真正的问题。

所以 PRG only on success 是一种非常干净的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-02-03T14:07:45.067

就像其他答案所说，仅在成功的服务器端验证上使用 Post/Redirect/Get 模式。当表单无效时，只需直接响应响应，并带有错误消息。

对于可用性，您应该确保**客户端验证非常好**，这无论如何都是一个好主意，因为用户喜欢即时反馈。使用 Javascript，或者[新的 HTML5 表单特性](http://www.html5rocks.com/en/tutorials/forms/html5forms/)，比如`required`属性或者`maxlength`属性或者`type="email"`属性等等。

当然，为了安全和优雅降级，**您仍然应该进行服务器端验证。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-18T18:50:27.040

如果您使用的是 ASP.NET MVC，那么还有另一种方法可用于 Post -> 失败情况。本文的第 13 部分对此进行了介绍：[ASP.NET MVC 最佳实践（第 1 部分）](http://web.archive.org/web/20121231024846/http://weblogs.asp.net/rashid/archive/2009/04/01/asp-net-mvc-best-practices-part-1.aspx)。

如果您实现该方法，那么您*始终*可以在发布后重定向，即使发布导致失败。

# c++ - Windows API“国际象棋计时器”信号量事件

> ID：599087
> 
> 赞同：0
> 
> 时间：2009-03-01T02:03:35.333
> 
> 标签：c++, events, semaphore

有没有像国际象棋计时器一样工作的信号机，意思是；

线程 A 完成其任务，循环回到顶部并调用 Semaphore

这会触发线程 2，线程 2 继续执行其代码，循环回到顶部并调用信号量

这会触发线程 A...

所以信号量既是阻塞的又是信令的。

我知道我可以只使用两个事件和 WaitForSingleObject，但我想知道是否有专门执行此操作的信号量？

在这个主题上，Event 有多“昂贵”，WaitForSingleObject() 在内存和 CPU 方面有多“昂贵”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-01T02:20:36.353

嗯......你确定你需要两个线程吗？听起来您的协同程序不能同时运行，至少如果我理解隐喻的话。如果是这种情况，请将它们放在同一个线程中。

```
while (true)
{
    task1();
    task2();
} 
```

# video - 多台显示器上的视频

> ID：599091
> 
> 赞同：-1
> 
> 时间：2009-03-01T02:08:08.067
> 
> 标签：video, fullscreen, multiple-monitors, touchscreen

我正在编写一个相对简单的程序，涉及 3 个独立的监视器。

每台显示器都有一个在该特定屏幕上移动的按钮。如果您单击该按钮，它将在该屏幕上播放视频。我需要能够让每个屏幕都像完全分开一样。

我已经构建了将运行它的计算机。2 个显卡（4 个 dvi 插槽）。3个触摸屏显示器。体面的电脑设置。

我的问题是：对此最好的方法是什么？我从来没有将视频编程到我写的任何东西中。我只需要一个快速开始去哪里。

我买不起任何真正的软件。开源一切都会很棒。我正在运行 Windows XP 主页（一直更新）这台机器只会这样做（它的展览）

任何帮助都会很棒。你建议什么语言？谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T18:19:14.270

我最近刚刚获得计算机科学学位。所以我对一切都很新鲜。

TFD：工具包全部由博物馆支付。我想我可以要求更多的钱，但我有一些时间限制（就像他们在这个周末之前想要一些东西一样）。有点烂

我将检查处理，看看我是否可以使用它。

我想我正在寻找正确方向的推动力。作为临时解决方案，我可能最终会拼凑一些东西。然后当我有机会回去修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T08:24:55.267

你没有说你的编程经验是什么，所以我不确定这是否有帮助，但你看过[Processing](http://processing.org/)吗？它是一个基于 Java 的开源编程环境（来自网站），适用于“学生、艺术家、设计师、研究人员和业余爱好者，用于学习、原型设计和生产”。

我认为它应该能够完成这个项目所需的一切。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T10:19:34.710

您可以使用 Visual Studio (Express) 在 .net 中创建应用程序，创建带有一些按钮和媒体播放器控件的表单，然后循环每个屏幕并将此表单的一个实例放置在确切的屏幕边界上，就是这样。

使用此代码片段作为参考：

```
public static void PutOn(this Form form, int width, int height)
{
    var screen_size = new Size(width, height);

    var screens = from s in Screen.AllScreens
                  where s.Bounds.Size == screen_size
                  select s;

    Screen app_screen = screens.FirstOr(Screen.PrimaryScreen);

    form.Location = new Point(
        app_screen.Bounds.X + (app_screen.Bounds.Width - form.Width) / 2,
        app_screen.Bounds.Y + (app_screen.Bounds.Height - form.Height) / 2);
} 
```

# sql - 实体框架绕过不受支持的方法

> ID：599103
> 
> 赞同：-2
> 
> 时间：2009-03-01T02:14:55.227
> 
> 标签：sql, entity-framework, linq-to-entities

ADO.NET EF 不支持 Math.Pow 和 Math.Log 之类的东西，所以我想知道如何解决这个问题。我需要能够对使用 ADO.NET EF 的计算值使用 ORDER BY。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T03:26:15.710

您可以使用 Entity SQL，但我不推荐它

```
using System.Data.EntityClient;

EntityConnection conn = new EntityConnection(myContext.Connection.ConnectionString);
conn.Open();
EntityCommand cmd = conn.CreateCommand();
cmd.CommandText = @"Select SqlServer.Power(t.MyValue, 2) From MyEntities.MyTable As t";
var result = cmd.ExecuteReader(System.Data.CommandBehavior.SequentialAccess);
result.Read();
var valuePower2 = result.GetValue(0);
conn.Close(); 
```

要执行动态排序依据和 where 子句，请使用[Dynamic Linq](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

# sharepoint - SharePoint - 如何在自定义功能中自定义 NewForm.aspx？

> ID：599108
> 
> 赞同：3
> 
> 时间：2009-03-01T02:22:48.687
> 
> 标签：sharepoint, sharepoint-2007, moss, wss, wss-3.0

我在 SharePoint 网站中创建了一个自定义列表，并使用 SharePoint 解决方案生成器生成了一个 Visual Studio 2008 项目。我可以将其打包为一个功能并安装它。它在我的服务器上运行良好。

在对此进行测试后，我已经能够将自定义母版页添加到部署到 _catalogs/masterpage 文件夹的功能中。这里是：

```
<Elements Id="2196306F-3F37-40b5-99CF-42E89B93888A" xmlns="http://schemas.microsoft.com/sharepoint/">
    <Module Name="DefaultMasterPage" Url="_catalogs/masterpage" RootWebOnly="FALSE">
      <File Url="gcbranding.master" Type="GhostableInLibrary" IgnoreIfAlreadyExists="TRUE" />
    </Module>
</Elements> 
```

现在我的站点中有一个自定义母版页，我希望将其用于创建新项目。但我不想从 SharePoint Designer 设置主控。

回到生成的解决方案，它具有带有列表架构的 NewForm.aspx 等。我如何...

1.  自定义为新项目显示的表单，*并将其重定向到thankyou.aspx 页面*，而不是显示所有列表项？
2.  正确设置母版页的网址？

我迷失在第 1 点上。我需要创建自定义 Web 部件并将其嵌入到 NewForm.aspx 中吗？

在第 2 点上，我取得了一些进展，但遇到了问题。如果我在我的 NewForm.aspx 中设置这样的主...

```
 MasterPageFile="~/masterurl/gcmaster.master" 
```

它会安装好，但是当我点击该站点时，我收到一个错误，因为 URL 中不允许使用 ~。如果我在指令中使用 _catalogs/masterpage，它将找不到主页面，因为 URL 是相对的。只有这段代码似乎有效：

```
MasterPageFile="../../_catalogs/masterpage/gcmaster.master" 
```

部署自定义功能/解决方案时，在 SharePoint 中设置母版页文件的最佳做法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T04:12:25.913

Re Masterpage：我想你想要' `~masterurl/gcmaster.master`'。“~”和“master”之间没有“/”。

Re NewForm：您可以为 NewForm.aspx 创建自己的代码隐藏页面，将`Inherits`属性更改为您自己的类。我想我会先让我的自定义代码继承自[SharePoint.SharePoint.WebPartPages.WebPartPage](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.webpartpages.webpartpage.aspx)，然后从那里开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-04T19:32:41.077

自定义为新项目显示的表单，并将其重定向到thankyou.aspx 页面，而不是显示所有列表项？

最简单的答案是，更改“添加新项目”链接，为您的感谢页面添加源 URL。例如，而不是（我不得不省略 http）：

```
www.yoursite.com/Lists/Links/NewForm.aspx

```

您将其更改为：

```
www.yoursite.com/Lists/Links/NewForm.aspx?Source=www.yoursite.com/ThankYou.aspx 

```

当用户从 NewForm 页面单击提交时，他们将被重定向到ThankYou.aspx。

但是，您可能必须使用 SharePoint Designer 来更改链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T10:46:49.100

最好的方法是在 SharePoint Designer 中打开 NewForm.aspx，更改：

MasterPageFile="~masterurl/default.master"

到

MasterPageFile="~masterurl/custom.master"

这显然会编辑当前实例，但如果您想使用站点定义或功能部署它，那么您需要在与列表实例文件夹中的 schema.xml 相同的文件夹中创建 NewForm.aspx 页面。

希望有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-20T19:45:32.673

覆盖网页上的 OnPreInit 事件，并在其中放入以下行：

```
this.MasterPageFile = SPContext.Current.Web.CustomMasterUrl; 
```

（如果您使用的是自定义母版页）

如果您使用的是默认母版页，请使用以下行：

```
this.MasterPageFile =  SPContext.Current.Web.MasterUrl; 
```

高温下，

詹姆士

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-24T14:24:07.297

如果要在各种 .aspx 页面中重复使用母版页，最好将其设置为自定义母版页。WSS 中没有可让您轻松执行此操作的页面，因此您最好在 SharePoint Designer 中右键单击您的 _catalogs/masterpage/gcmaster.master 文件并选择设置为自定义母版页，或者通过 PowerShell 在服务器上设置它（此处提供的 SharePoint 脚本标头：[http](http://sharepoint.microsoft.com/blogs/zach/Lists/Posts/Post.aspx?ID=7) ://sharepoint.microsoft.com/blogs/zach/Lists/Posts/Post.aspx?ID=7 ）

```
$web = Get-SPWeb("http://mysiteurl")
$web.CustomMasterUrl = "_catalogs/masterpage/gcmaster.master"
$web.Update() 
```

然后在 .aspx 页面的 @Page 指令中，您可以设置：

```
MasterPageFile="~/masterurl/custom.master" 
```

请记住，这会使您站点中所有引用“~/masterurl/custom.master”的 .aspx 页面都使用您的 gcmaster.master 页面。

或者，您可以跳过所有这些，并为您的 .aspx 页面简单地包含一个如下所示的 @Page 指令：

```
MasterPageFile="~/site/_catalogs/masterpage/gcmaster.master" 
```

# c++ - 您如何将此代码从处理转换为 C++？

> ID：599120
> 
> 赞同：0
> 
> 时间：2009-03-01T02:28:52.993
> 
> 标签：c++, drawing

[我在 Processing ( www.processing.org](http://www.processing.org/) )中编写了这段代码，想知道如何使用 C++ 实现它？

```
int i = 0;

void setup()
{
size(1000,1000);
}

void draw()
{
//  frameRate(120);
  PImage slice = get();
  set(0,20,slice);  

  if( i % 2 == 0 )  fill(128); else fill(0);
  i++;
  rect(0,0,width,20);
} 
```

正如你所看到的，这只是尽可能快地向下滚动交替颜色的矩形。C++ 实现可以这么短吗？OpenGL？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-01T02:45:40.503

我可能会为此使用[SDL 。](http://www.libsdl.org/)你的程序会长一点，因为你必须自己做一些设置和拆卸（尽管有很多很好的例子）。你可以用 OpenGL 做同样的事情，但它会做更多的工作。如果你走这条路，[NeHe Productions](http://nehe.gamedev.net/)实际上提供了 OpenGL 教程中的黄金标准。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-01T11:44:07.607

你也可以看看[OpenFrameworks](http://www.openframeworks.cc/)，但我怀疑任何 C++ 库都会给你这么短的实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T02:48:22.153

取决于您是否还计算所有设置/拆卸代码，如果您绝对没有，即使不计算它我仍然会怀疑。

# c# - 适当课程的提示

> ID：599124
> 
> 赞同：1
> 
> 时间：2009-03-01T02:33:03.873
> 
> 标签：c#, class

我正在使用 C#。我有一个产品类，其中包含 sku、名称、描述等字段......以及 setSku、setDescription、setImages 等方法（产品附有图像）。我将这些方法保留在 Product 类中，但由于客户端可以使用大量设置来设置 sku、描述和图像，因此该类变得非常非常大。类里面有很多代码。因此，我打算将大型 Product 类分解为 ProductSku 类、ProductDescription 类……等。这里的问题是所有类都需要访问一些相同的字段。我开始在这些单独的类上调用方法并一遍又一遍地传入相同的对象，但这似乎不正确。**我的问题是这听起来对吗？你会怎么做？**

我正在处理的程序只是在基本层面上从 database1 的一个表中获取产品并将产品保存到 database2 上的表中。但是，用户可以使用许多设置来设置他们希望来自 database1 的字段在进入 database2 时的外观。

澄清一下：上面提到的 set 和 get 方法不是 getter 和 setter 方法。我使用属性，但是我将它们称为设置，因为在更新之前有很多代码用于格式化某些字段。我理解混乱，我为没有澄清而道歉。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-01T02:46:19.147

当前产品的单例听起来确实很糟糕。您只是用不同的名称调用全局变量。

我不知道 Sku 是什么，但至于其余部分（描述和图像），如果它们是产品的属性（我认为它们是），它们属于 Product 类。

如果你经常一起传递你的“班级作品”，那就是他们属于一起的强烈迹象。

如果您愿意，可以使用`partial`关键字将代码（而不是类）分成几个文件。像这样：

```
// This file is Product.CodeAboutThingA.cs

public partial class Product
{
    // Some stuff related to A here...
} 
```

在另一个文件中：

```
// This file is Product.CodeAboutThingB.cs

public partial class Product
{
    // Some stuff related to B here...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T17:17:23.013

为了给我 0.5 美分，一个只能通过将其拆分为部分来管理的类具有相当多的代码气味。将整个事物分成几个类听起来不错，尤其是当您已经将 SKU 等东西确定为自己的类时。

你应该问自己的事情是......

*   如果我只能通过有效的 Product 实例访问 SKU，是否可以？即使它只是一个标识符，这样的标识符本身也可能相当复杂。
*   SKU 必须以何种方式使用 Product 类中的内容？如果产品是唯一实例化 SKU 的产品，则可以将产品传递到 SKU。这两个类现在耦合得相当紧密，但仍然比没有语义的单一产品混乱要好。
*   你能确定哪些是需要在整个过程中共享的共同部分吗？也许您缺少作为“公共部分”的实体或值对象？
*   也许您会更喜欢 Product Builder，而不是让客户在 Product 实例的内部翻找？

从我的角度来看，当您有一个包含 1k+ 行代码的类时，仍然有很多人无法理解您的“产品”到底是什么以及它在您的应用程序范围内的行为方式......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T02:46:10.847

也许您应该考虑将其合并回一个类，但是为了使其可读，请使用**部分**修饰符？

另一个答案是创建**抽象**类 Product 并从中继承专门的类。

# memory-management - 让你的程序使用更少内存的方法

> ID：599125
> 
> 赞同：2
> 
> 时间：2009-03-01T02:33:51.047
> 
> 标签：memory-management

软件将使用内存，这没什么大不了的，但是与您的程序有多大相比，您如何将这种使用保持在最低限度。

我认为最好的例子是 Firefox。有些用户体验过，有些用户没有体验过，但可以肯定地说，所有以前版本的 Firefox 使用的内存都比当前版本多得多。然而，功能扩展并添加了选项。我希望内存使用量随着额外选项的增加而增加，并且这些东西会被添加。

因此，换句话说，必须有一些方法来确保您的程序不会耗尽计算机的内存。

所以，我把它变成了一个“最佳实践”的问题，问你们所有人你的小技巧和调整是什么让你的程序做它做的事情，CPU 比你通常想象的要少。而且，什么是最肯定要避免的。

这里有一个小问题：我在一本关于 C# 的书中偶然发现了一些东西。显然，在编码 Enum 时，可以设置该 Enum 的索引大小。对于大型枚举，我猜你应该让编译器处理它，但是对于只包含 2 或 3 个项目的枚举，你可以这样做：

```
public enum HTMLTYPE : sbyte
{
    HTML401,XHTML10,XHTML11
} 
```

对于那些不知道为什么的人，显然为任何 Enum 的索引保留的内存量在 C# 中自动设置为整数。因此，换句话说，将保留该内存量。但是在你的枚举中定义这么少的东西时，整数是浪费空间。这本书声称这可以减少程序使用的内存量。我想知道这是不是真的。

编辑：确实，它应该是记忆，该死的我。更改了所有条目。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-01T02:42:07.080

首先，您可能混淆了 CPU 和 RAM（也称为内存）。CPU 是处理器，即根据数据*运行*代码的处理器。内存是*存储*代码和数据的地方。

实际上应该避免这种枚举技巧。首先，`sbyte`不符合 CLS。然后它可以限制未来的扩张。`int`CPU 总是使用整个字（在 32 位架构和`long`64 位架构中），这一事实总是存在的。你失去了这一切，为了什么收获？你的内存占用少了几个字节。

更重要的是，请遵循这些明智的话：*过早的优化是万恶之源。*

这意味着，仅在真正需要时进行优化。首先测量事物。您很可能会意识到需要削减的不是枚举中的那三个字节。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-01T15:54:46.257

一种技术是仅在需要时使用[延迟初始化](http://en.wikipedia.org/wiki/Lazy_initialization)来创建对象。

此外，请务必处理（或设置为 null）不再需要的对象，以便对它们进行垃圾收集。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-01T02:40:55.167

这是真的，也不是真的。使用 int 是有原因的 - 处理器自然地使用它（运行 x64 Windows 时除外，那么更自然的是 Int64）。这是因为在 CPU 中有 4 个 32 位长（或 x64 模式下为 64 位）的寄存器。

此外，让我们面对现实：.NET 并不完全注重效率，无论是在内存还是 CPU 方面。有一些做法可以避免犯大错误（例如循环中的字符串连接而不是使用 StringBuilder），但枚举从 4 个字节减少到 1 个字节是不值得的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-01T16:33:42.823

节省内存的最好方法是首先编写一个代码干净的方式，以便您可以在其中看到应用程序的设计。

然后制作一个针对内存进行调整的新版本代码。这样您就可以确保未来的版本不会使用混淆代码。

是的，有了更好的内存和更少的 CPU，你会考虑这样的优化。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-01T16:49:38.387

在优化方面，通常最好首先关注算法设计。如果你*仍然*没有得到你想要的性能，那么是时候进行微优化了。

但免责声明：优化内存使用可能并不总是一件好事。不幸的是，很多时候您必须决定是优化时间（CPU 使用率）还是空间（RAM 或磁盘空间）。虽然有时您也可以吃蛋糕并吃掉它，但这并不总是那么简单。

> 这里有一个小问题：我在一本关于 C# 的书中偶然发现了一些东西。显然，在编码 Enum 时，可以设置该 Enum 的索引大小。对于大型枚举，我猜你应该让编译器处理它，但是对于只包含 2 或 3 个项目的枚举，你可以这样做：
> 
> ...
> 
> 对于那些不知道为什么的人，显然为任何 Enum 的索引保留的内存量在 C# 中自动设置为整数。因此，换句话说，将保留该内存量。但是在你的枚举中定义这么少的东西时，整数是浪费空间。这本书声称这可以减少程序使用的内存量。我想知道这是不是真的。

我不是 100% 确定这一点，但这可能不一定是真的。事实上，如果您使用 Mono 并将此应用程序部署在其他系统上，则可能*并非如此。*原因是不同的操作系统和处理器有不同的内存对齐要求。因此，即使您将其声明为 sbyte，它也可能在它实际进入内存时被强制转换为 32 位或 64 位整数（OS X 对内存对齐特别挑剔）。

现在，我可能完全错过了这里的重点，而这本书在这种情况下可能是完全正确的。但我在这里的意思更多的是说“它比这更复杂一点”，并指出这种优化可能无法移植到其他平台（不同的操作系统、处理器和编程语言）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-01T16:54:29.153

所有这些都是解决内存问题的良好算法方法，但在实践中，您还希望通过分析器运行代码以查看内存和 cpu 资源被占用的位置。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-01T17:24:56.430

关于这方面有一本很好的在线书籍：

[http://www.cix.co.uk/~smallmemory/](http://www.cix.co.uk/~smallmemory/)

# sql - MySQL中是否有一个函数可以压缩从查询返回的结果？

> ID：599141
> 
> 赞同：1
> 
> 时间：2009-03-01T02:45:16.370
> 
> 标签：sql, mysql

如果结果达到一定数量，我想压缩结果。

然后客户端程序将解压缩结果并处理。

这是一个具有客户端/服务器架构的桌面，一些客户端通过 vpn 连接。

当客户端连接时，它将向服务器发送数据。服务器完成处理后，客户端将从服务器下载更新的数据。

客户分布在多个城镇，平均距离为 50-100 公里。离开。他们将使用 vpn 通过互联网连接。但这是最初的计划，尚未实施，使用 vpn 或其他方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-01T03:29:43.723

[COMPRESS](http://dev.mysql.com/doc/refman/5.1/en/encryption-functions.html#function_compress)函数可用于将字符串压缩为二进制字符串。但是，根据您的需求可能无法真正解决问题，特别是因为数据库记录本身通常已经非常紧凑，所以我不确定尝试进一步压缩结果集会获得多少好处。

您需要注意的一件事是过早优化。如果您尝试在正确识别实际瓶颈之前进行优化，而不是盲目地寻找可能的瓶颈，通常会引入不必要的复杂性并实际上会损害性能。

在这种情况下，我会问您是否真的发现了应用程序中的瓶颈？如果是这样，它到底在哪里，它的性质是什么？你在什么环境下工作？这是具有客户端/服务器架构的 Web 开发或桌面吗？

也许您可以在您的问题中添加一些附加信息，然后可以更好地为您提供帮助？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T03:32:42.200

大多数 MySQL 客户端支持压缩（--compress 选项）

但是您确定要在 MySQL 中执行此操作吗？这听起来更像是 Web 或应用程序服务器的任务？

大多数 Web 服务器支持使用 gzip 等压缩响应

您是否有更多详细信息可以分享问题所在以及您使用的平台和工具？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T06:16:02.300

MySQL 支持压缩协议，但根据您用于连接数据库的工具，您使用该协议的方式会有所不同。

> **压缩**
> 
> 如果客户端和服务器都支持 zlib 压缩，并且客户端请求压缩，则使用压缩。
> 
> 一个压缩包头是：包长度（3字节）、包号（1字节）和未压缩包长度（3字节）。未压缩数据包长度是原始未压缩数据包中的字节数。如果该值为零，则不压缩数据。
> 
> 当使用压缩协议时（即当客户端通过设置客户端认证包中的标志位请求它并且服务器已经接受它时），客户端或服务器都可以压缩包。但是，如果压缩后的长度大于原始长度，则不会发生压缩。因此，一些数据包将被压缩，而其他数据包不被压缩。

（[参考](http://forge.mysql.com/wiki/MySQL_Internals_ClientServer_Protocol#Compression)）

如果您提供有关您如何连接的更多信息，我们可能会为您提供更多信息。例如，在连接器/ODBC 连接参数中，有一个标志，即“使用压缩的客户端/服务器协议”。

# c++ - Windows 语音 C++

> ID：599147
> 
> 赞同：0
> 
> 时间：2009-03-01T02:48:26.490
> 
> 标签：c++, speech

我的名字是乔伊，我想知道是否有办法在 C++ 中使用语音，如果有的话，有人可以指出我深表感谢的参考资料和书籍......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T03:25:21.860

您应该查看[Windows Text-To-Speech API](http://www.microsoft.com/speech/speech2007/speechdevarticle.mspx) - 一个可以从 C++ 使用的基于 COM 的 API。您需要将 Speech API 5.3 SDK 作为[DVD ISO](http://www.microsoft.com/downloads/details.aspx?FamilyId=F26B1AA4-741A-433A-9BE5-FA919850BDBF)下载，或者仅通过[引导安装](http://www.microsoft.com/downloads/details.aspx?FamilyId=E6E1C3DF-A74F-4207-8586-711EBE331CDC)您需要的组件。

附带说明一下，.Net 3.0 中还有一个托管语音 API，位于 System.Speech 命名空间中。

# data-structures - Are some data structures more suitable for functional programming than others?

> ID：599153
> 
> 赞同：23
> 
> 时间：2009-03-01T02:51:35.810
> 
> 标签：data-structures, functional-programming, immutability

In [Real World Haskell](http://book.realworldhaskell.org/), there is a section titled "Life without arrays or hash tables" where the authors suggest that list and trees are preferred in functional programming, whereas an array or a hash table might be used instead in an imperative program.

This makes sense, since it's much easier to reuse part of an (immutable) list or tree when creating a new one than to do so with an array.

So my questions are:

*   Are there really significantly different usage patterns for data structures between functional and imperative programming?
*   If so, is this a problem?
*   What if you really do need a hash table for some application? Do you simply swallow the extra expense incurred for modifications?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-01T04:44:41.093

The book [Purely Functional Data Structures](https://rads.stackoverflow.com/amzn/click/com/0521663504) covers your questions in depth, and includes a great mix of theory and implementations primarily in ML - the appendix also contains Haskell implementations so you should be able to follow along with a bit of extra page turning. It is a pretty good (though difficult in parts) read if you are really interested in a thorough answer to your questions. Having said that I think ephemient gave a superb short answer.

edit: Steven Huwig provided a [link](http://www.cs.cmu.edu/~rwh/theses/okasaki.pdf) to the thesis that the book started as. While I haven't read through it the only big thing missing (judging from the table of contents) are the Haskell implementations.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-01T04:02:57.557

*   Yes. Typically tuples, lists, and partially-evaluated functions are very common data structures in functional programming languages. Mutable data structures, like arrays and (real) hash tables, are used much less because they don't fit in as well with Haskell. SML (which is also functional, but not lazy) can use arrays more naturally than Haskell, but lists are still more common because they map well to recursive algorithms.
*   I'm not sure how to answer this. A problem for who?
*   There exist implementations of associative arrays ("hash table" equivalent) which can continue to share most of their underlying structure even after different updates. I believe GHC's `Data.Map` does; also, [Edison](http://www.haskell.org/ghc/docs/edison/) has quite a few lazy/functional-friendly data structures.

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-16T08:24:26.783

Speaking as someone who's been doing OO for many years, and recently has been building a largeish project requiring a good deal of speed (a real-time automated options trading system) in Haskell:

*   Are there really significantly different usage patterns for data structures between functional and imperative programming?

If you're talking about Haskell, yes, very much so. A large part of this is due to purity, however; the differences are somewhat less in other functional languages where mutable data is more often used. That said, as others have pointed out, recursive code and structures are much more heavily used in all or nearly all functional languages.

*   If so, is this a problem?

It hasn't been one for me, aside from having to spend some time to learn the new way of working. In particular, performance has certainly not been an issue: the system I'm working on runs considerably faster than the previous Java implementation, for example.

*   What if you really do need a hash table for some application? Do you simply swallow the extra expense incurred for modifications?

Generally the problem is not that "you really do need a hash table," but that you need access to certain data within some given time constraints (which may well be, "as fast as possible on some given hardware."). For that, you look around and do what you need to do. If that includes introducing mutability, I don't see a big problem with that, and you can do it in Haskell, though it might not be as convenient as it is in other languages. But do keep in mind, if you have a problem of this nature, it's certainly not going to be as simple as, "use a generic hash table and you're done." Extremely high performance for particular functionality on a particular hardware platform invariably takes a lot of work, and usually more than a few tricks. Preferring one language implementation over another just because it has some particular thing that works better than it does in other languages is, in my opinion, a rather unsophisticated approach to software engineering that is not likely to consistently produce good results.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-01T04:52:06.050

Chris Okasaki's thesis, [Purely Functional Data Structures](http://www.cs.cmu.edu/~rwh/theses/okasaki.pdf), is available for free online. It covers many different strategies for immutable persistent data representation.

As far as really needing a hash table, consider that an O(lg n) lookup is only twenty times as slow as an O(1) lookup when you are searching a million elements.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-02T23:26:35.317

Yes, the usage patterns are dramatically different, but no it's not a problem. If you want a hash table, you usually mean you want a finite map with string keys and fast access. Bentley and Sedgewick's [ternary search trees](http://www.cs.princeton.edu/~rs/strings) are pureful functional, and at least in some cases, they outperform hash tables.

As mentioned above, Chris Okasaki's book on purely functional data structures is very good.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-01T03:49:33.767

Functional programs tend to put more emphasis on recursion. This, in turn, suggests the use of recursive algorithms and recursive data structures. Both lists and trees are recursive structures (the "next" link on a list is another list, and the children of a tree node are both trees).

You may want to reconsider if you're looking at extra expense on an algorithm. Why does the hash table (which is O(1) for a non-recursive algorithm) incur an extra expense? What advantage are you gaining by using it, as opposed to a tree or list?

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-01T03:49:51.647

Yes, the primary difference is immutability of the data, which can include code (see higher order functions). See the Wikipedia page on [Purely Functional](http://en.wikipedia.org/wiki/Purely_functional) for a list of the common data types and usages. Whether its a problem or not depends on how you look at it. There are many advantages to programming in a functional language if it fits the type of task you are working on. A hash table is a type of associative array, but isn't the one you want to use in a functional language because of the rehashing you'd have to do on insert and the poor performance without arrays. Instead, try the [Haskell implementation of Data.Map](http://en.wikibooks.org/wiki/Haskell/Hierarchical_libraries/Maps) for an associative array.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-01T15:40:07.320

> *   Are there really significantly different usage patterns for data structures between functional and imperative programming?

Big, gigantic, night and day — largely because side-effects are not tolerated in functional programming.

> *   If so, is this a problem?

The problem is for the imperative paradigms that will be unable to retain efficiency as parallelization becomes more necessary — the only way out for these languages will be to get rid of side-effects but then they will become broken functional languages - but then, why should I bother with them when there are some pretty good, working functional languages. Also, the semantics of functional languages is easier to control hence, functional programs can be proved correct whereas their C++ counterparts cannot (yet, anyway). Hence, many formal verification tools are based on functional languages — for example, ACL2 is based on common lisp and Cryptol is based on Haskell. Since Formal Verification is the wave of the future functional languages can better integrate with those tools. In short, say bye-bye to C,C++ and such — good ridence! Someone should have taken a 30 ought 6 to them a long time ago.

> *   What if you really do need a hash table for some application? Do you simply swallow the extra expense incurred for modifications?

The wave of the future is this: you write a functional programming with specifying a hash table - the language you use is cryptol. When you are done and have proven that your program works you press a button and out pops an efficient version that uses a hash table if it has been decided that is the best thing to use.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-08-19T21:43:12.253

As far as hash tables in functional languages go: Since ACL2 was mentioned above, I'll note that there is a "hash cons" library for ACL2 that provides the logical story that's basically association-list-semantics but has the performance of a hashtable (e.g., you can lookup a value in a table using hons-get). If you're interested, check out the topic "hons" in the ACL2 users Manuals.

# sql - 我应该使用外键吗？

> ID：599159
> 
> 赞同：23
> 
> 时间：2009-03-01T02:56:31.260
> 
> 标签：sql, sql-server, performance, database-design, foreign-keys

> **可能重复：**
> [外键有什么问题？](https://stackoverflow.com/questions/83147/whats-wrong-with-foreign-keys)

我使用带有大约 4 GB 数据的大型数据库的 MS Sql Server。

我在网上搜索为什么我应该使用外键。到目前为止，我只索引了用于连接表的键。性能很好，数据完整性没问题。

我应该使用外键吗？我会用外键获得更多的性能吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-01T03:02:56.500

外键实际上并没有提高性能，实际上它们会在所有写入操作上产生很小的性能损失，以确保遵循约束。

您要使用这些的原因是为了防止破坏性的写入操作。如果您没有它们，错误代码或错误的 sql 语句可能会删除预期存在的行。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-01T05:26:13.550

诚信今天可能不是问题，但正是这种态度使明天或两周后成为问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-01T03:01:15.897

外键主要是用于加强数据库完整性的工具，与执行速度无关。

如果您已经优化了索引设计，那么您可能已经安装了这些索引，至少作为非唯一索引。所以我不希望仅仅通过安装外键来改变性能（甚至不一定涉及索引。）

不过，如果您还没有确定这个概念，我会怀疑您对优化设计的自满。

阅读有关外键的文档，以了解它们为强制完整性所做的工作（无论如何都值得了解。）然后看看这是否不能更完整地回答您的问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-01T04:43:25.837

SquareCog 之前链接到的旧问题中没有提到的问题 - 是的，外键约束在进行数据清理、批量更新、测试数据生成或任何绕过正常顺序的操作时可能会很痛苦。但是 - 在你做这样的事情之前，你总是可以删除你的外键约束，然后再重新创建它们（如果你的数据库对象脚本正确，这几乎不是任何额外的工作）。

我曾经很懒惰，但已经开始依赖外键约束。在某些情况下您仍然无法拥有它们 - 例如在跨数据库关系中。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-01T05:18:21.840

外键为您的系统带来了一项功能/约束，目前尚未提及。那是提交/事务逻辑（这就是我所说的）。在启用外键的情况下，所有受影响的表中的所有更新行都需要在那里才能进行提交（不要抛出违反外键约束的 SQL 错误）。

如果你有一个代码体，它可以工作并且“玩得又快又松”，带有提交/事务。然后，您可以进行一些补救，以使架构中的 FK 能够正常工作。

此外，至少 Oracle 允许您禁用约束（不仅仅是删除/删除）。因此，您可以轻松地打开/关闭它们。方便，当您想在没有约束开销的情况下进行一些批量操作时，或者对具有中间状态的数据进行一些“手术”，这些状态会使约束失效。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-10-06T16:05:29.830

在 MySQL 中，您可以禁用外键`SET FOREIGN_KEY_CHECKS=0`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-01T05:20:54.423

外键还有助于保持数据库清洁，因为您可以让数据库进行级联删除。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-01T03:05:38.710

外键使数据完整性更好，性能更好，删除/插入/更新时稍慢。
在我上一家公司，我们决定在 BL 中保持完整性/连接，因为它使 BL 中的更改更简单（想想数亿条记录）。如果您有一个小型应用程序，我认为没有理由不在数据层 (db) 中执行此操作

# java - 将 ArrayList 转换为字符串的最佳方法

> ID：599161
> 
> 赞同：353
> 
> 时间：2009-03-01T02:58:11.053
> 
> 标签：java, string, arraylist

我有一个`ArrayList`我想完全输出为字符串。本质上，我想使用`toString`由制表符分隔的每个元素按顺序输出它。有什么快速的方法可以做到这一点吗？您可以遍历它（或删除每个元素）并将其连接到一个字符串，但我认为这会很慢。

* * *

## 回答 #1

> 赞同：1066
> 
> 时间：2014-04-20T15:08:17.267

在 Java 8 或更高版本中：

```
String listString = String.join(", ", list); 
```

如果`list`is 不是 String 类型，则可以使用连接收集器：

```
String listString = list.stream().map(Object::toString)
                        .collect(Collectors.joining(", ")); 
```

* * *

## 回答 #2

> 赞同：415
> 
> 时间：2011-10-15T17:29:53.940

如果您碰巧在 Android 上执行此操作，则有一个很好的实用程序，称为[TextUtils](http://developer.android.com/reference/android/text/TextUtils.html#join(java.lang.CharSequence,%20java.lang.Iterable))，它有一个`.join(String delimiter, Iterable)`方法。

```
List<String> list = new ArrayList<String>();
list.add("Item 1");
list.add("Item 2");
String joined = TextUtils.join(", ", list); 
```

显然在Android之外没有太多用处，但我想我会把它添加到这个线程中......

* * *

## 回答 #3

> 赞同：371
> 
> 时间：2009-03-01T03:12:25.667

Java 8 引入了一个`String.join(separator, list)`方法；请参阅[Vitalii Federenko 的回答](https://stackoverflow.com/a/23183963/5139284)。

在 Java 8 之前，使用循环迭代`ArrayList`是唯一的选择：

**不要使用此代码，请继续阅读此答案的底部以了解为什么不希望使用它，以及应该使用哪个代码：**

```
ArrayList<String> list = new ArrayList<String>();
list.add("one");
list.add("two");
list.add("three");

String listString = "";

for (String s : list)
{
    listString += s + "\t";
}

System.out.println(listString); 
```

事实上，字符串连接会很好，因为`javac`编译器会将字符串连接优化为对 a 的一系列`append`操作`StringBuilder`。`for`这是从上述程序的循环中反汇编字节码的一部分：

```
 61:  new #13; //class java/lang/StringBuilder
   64:  dup
   65:  invokespecial   #14; //Method java/lang/StringBuilder."<init>":()V
   68:  aload_2
   69:  invokevirtual   #15; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
   72:  aload   4
   74:  invokevirtual   #15; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
   77:  ldc #16; //String \t
   79:  invokevirtual   #15; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
   82:  invokevirtual   #17; //Method java/lang/StringBuilder.toString:()Ljava/lang/String; 
```

可以看出，编译器通过使用 a 优化了该循环`StringBuilder`，因此性能应该不是一个大问题。

（好吧，乍一看，`StringBuilder`循环的每次迭代都会实例化 ，因此它可能不是最有效的字节码。实例化和使用显式`StringBuilder`可能会产生更好的性能。）

事实上，我认为拥有任何类型的输出（无论是到磁盘还是到屏幕）都至少比担心字符串连接的性能慢一个数量级。

**编辑：**正如评论中所指出的，上述编译器优化确实是`StringBuilder`在每次迭代时创建一个新实例。（我之前已经注意到了。）

使用的最优化技术将是[Paul Tomblin](https://stackoverflow.com/questions/599161/best-way-to-convert-an-arraylist-to-a-string/599169#599169)的响应，因为它仅在循环`StringBuilder`外实例化单个对象。`for`

将上述代码重写为：

```
ArrayList<String> list = new ArrayList<String>();
list.add("one");
list.add("two");
list.add("three");

StringBuilder sb = new StringBuilder();
for (String s : list)
{
    sb.append(s);
    sb.append("\t");
}

System.out.println(sb.toString()); 
```

只会`StringBuilder`在循环外实例化一次，并且只会对循环内的方法进行两次调用`append`，如以下字节码所示（它显示了`StringBuilder`循环的实例化）：

```
 // Instantiation of the StringBuilder outside loop:
   33:  new #8; //class java/lang/StringBuilder
   36:  dup
   37:  invokespecial   #9; //Method java/lang/StringBuilder."<init>":()V
   40:  astore_2

   // [snip a few lines for initializing the loop]
   // Loading the StringBuilder inside the loop, then append:
   66:  aload_2
   67:  aload   4
   69:  invokevirtual   #14; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
   72:  pop
   73:  aload_2
   74:  ldc #15; //String \t
   76:  invokevirtual   #14; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
   79:  pop 
```

因此，确实手动优化应该表现得更好，因为`for`循环的内部更短，并且不需要`StringBuilder`在每次迭代时实例化 a。

* * *

## 回答 #4

> 赞同：251
> 
> 时间：2009-03-01T04:50:55.260

下载 Apache Commons Lang 并使用方法

```
 StringUtils.join(list)

 StringUtils.join(list, ", ") // 2nd param is the separator. 
```

当然，您可以自己实现它，但他们的代码已经过全面测试，可能是最好的实现。

我是 Apache Commons 库的忠实粉丝，我也认为它是对 Java 标准库的一个很好的补充。

* * *

## 回答 #5

> 赞同：140
> 
> 时间：2011-04-01T15:58:47.343

这是一个很老的问题，但我想我不妨添加一个更现代的答案 - 使用[Guava](https://google.github.io/guava/releases/18.0/api/docs/)[`Joiner`](https://google.github.io/guava/releases/16.0/api/docs/com/google/common/base/Joiner.html)中的类：

```
String joined = Joiner.on("\t").join(list); 
```

* * *

## 回答 #6

> 赞同：92
> 
> 时间：2015-09-23T03:54:50.247

**将List**更改为可读且有意义的**String**确实是每个人都可能遇到的常见问题。

**案例1**。如果您的类路径中有 apache 的 StringUtils（来自 rogerdpack 和 Ravi Wallau）：

```
import org.apache.commons.lang3.StringUtils;
String str = StringUtils.join(myList); 
```

**案例 2**。如果您只想使用 JDK(7) 中的方法：

```
import java.util.Arrays;
String str = Arrays.toString(myList.toArray()); 
```

永远不要自己造轮子，不要使用循环来完成这一单行任务。

* * *

## 回答 #7

> 赞同：65
> 
> 时间：2012-09-14T18:33:32.250

如果您正在寻找一种快速的单线，从 Java 5 开始，您可以这样做：

```
myList.toString().replaceAll("\\[|\\]", "").replaceAll(", ","\t") 
```

此外，如果您的目的只是打印内容并且不太关心“\t”，您可以简单地执行以下操作：

```
myList.toString() 
```

它返回一个字符串，如

> [str1，str2，str3]

如果你有一个数组（不是 ArrayList），那么你可以像这样完成同样的事情：

```
 Arrays.toString(myList).replaceAll("\\[|\\]", "").replaceAll(", ","\t") 
```

* * *

## 回答 #8

> 赞同：38
> 
> 时间：2009-03-01T03:02:16.190

循环遍历它并调用 toString。没有什么神奇的方法，如果有的话，你认为除了循环遍历它之外，它会在幕后做什么？唯一的微优化是使用 StringBuilder 而不是 String，即使这也不是一个巨大的胜利 - 连接字符串在幕后变成了 StringBuilder，但至少如果你这样写，你可以看到发生了什么。

```
StringBuilder out = new StringBuilder();
for (Object o : list)
{
  out.append(o.toString());
  out.append("\t");
}
return out.toString(); 
```

* * *

## 回答 #9

> 赞同：36
> 
> 时间：2009-03-01T04:37:57.973

大多数 Java 项目通常都有可用的 apache-commons lang。StringUtils.join() 方法非常好，并且有多种风格可以满足几乎所有需求。

```
public static java.lang.String join(java.util.Collection collection,
                                    char separator)

public static String join(Iterator iterator, String separator) {
    // handle null, zero and one elements before building a buffer 
    Object first = iterator.next();
    if (!iterator.hasNext()) {
        return ObjectUtils.toString(first);
    }
    // two or more elements 
    StringBuffer buf = 
        new StringBuffer(256); // Java default is 16, probably too small 
    if (first != null) {
        buf.append(first);
    }
    while (iterator.hasNext()) {
        if (separator != null) {
            buf.append(separator);
        }
        Object obj = iterator.next();
        if (obj != null) {
            buf.append(obj);
        }
    }
    return buf.toString();
} 
```

> 参数：
> 
> **collection** - 要连接在一起的值的集合，可能为 null
> 
> **separator** - 要使用的分隔符
> 
> **返回**：连接的字符串，如果为空迭代器输入则为空
> 
> 自：2.3

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2014-06-12T05:11:48.207

Android 有一个 TextUtil 类，您可以使用[http://developer.android.com/reference/android/text/TextUtils.html](http://developer.android.com/reference/android/text/TextUtils.html)

```
String implode = TextUtils.join("\t", list); 
```

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2018-03-29T02:49:36.513

对于这个简单的用例，您可以简单地用逗号连接字符串。如果您使用 Java 8：

```
String csv = String.join("\t", yourArray); 
```

否则 commons-lang 有一个 join() 方法：

```
String csv = org.apache.commons.lang3.StringUtils.join(yourArray, "\t"); 
```

* * *

## 回答 #12

> 赞同：13
> 
> 时间：2009-03-01T10:57:47.233

处理尾随分隔符的一种优雅方法是使用[Class Separator](http://www.iam.unibe.ch/~akuhn/blog/2008/class-once-class-separator)

```
StringBuilder buf = new StringBuilder();
Separator sep = new Separator("\t");
for (String each: list) buf.append(sep).append(each);
String s = buf.toString(); 
```

Class Separator 的 toString 方法返回分隔符，*但*第一次调用除外。因此，我们打印没有尾随（或在这种情况下）前导分隔符的列表。

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2015-04-16T12:09:05.610

在 Java 8 中，这很简单。有关整数列表，请参见示例：

```
String result = Arrays.asList(1,2,3).stream().map(Object::toString).reduce((t, u) -> t + "\t" + u).orElse(""); 
```

或多行版本（更易于阅读）：

```
String result = Arrays.asList(1,2,3).stream()
    .map(Object::toString)
    .reduce((t, u) -> t + "\t" + u)
    .orElse(""); 
```

# 更新 - 更短的版本

```
String result = Arrays.asList(1,2,3).stream()
                .map(Object::toString)
                .collect(Collectors.joining("\t")); 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2009-03-01T03:04:42.067

无论哪种方式，它都是一种`O(n)`算法（除非您做了一些多线程解决方案，将列表分成多个子列表，但我认为这不是您所要求的）。

只需使用`StringBuilder`如下：

```
StringBuilder sb = new StringBuilder();

for (Object obj : list) {
  sb.append(obj.toString());
  sb.append("\t");
}

String finalString = sb.toString(); 
```

这`StringBuilder`将比字符串连接快得多，因为您不会`String`在每个连接上重新实例化一个对象。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2016-09-26T17:11:24.340

如果您碰巧在 Android 上并且您还没有使用 Jack（例如，因为它仍然缺乏对 Instant Run 的支持），并且如果您想要更多地控制结果字符串的格式（例如，您想使用换行符作为元素的分隔符），并且碰巧使用/想要使用 StreamSupport 库（用于在 Java 7 或更早版本的编译器上使用流），你可以使用这样的东西（我把这个方法放在我的 ListUtils 类中）：

```
public static <T> String asString(List<T> list) {
    return StreamSupport.stream(list)
            .map(Object::toString)
            .collect(Collectors.joining("\n"));
} 
```

当然，请确保在列表对象的类上实现 toString()。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2018-04-13T13:24:34.597

在一行中：从 [12,0,1,78,12] 到 12 0 1 78 12

```
String srt= list.toString().replaceAll("\\[|\\]|,",""); 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2009-03-01T10:07:35.310

如果您不想在最后一个元素之后出现最后一个 \t，则必须使用索引来检查，但请记住，这仅在列表实现 RandomAccess 时“有效”（即 O(n)）。

```
List<String> list = new ArrayList<String>();
list.add("one");
list.add("two");
list.add("three");

StringBuilder sb = new StringBuilder(list.size() * apprAvg); // every apprAvg > 1 is better than none
for (int i = 0; i < list.size(); i++) {
    sb.append(list.get(i));
    if (i < list.size() - 1) {
        sb.append("\t");
    }
}
System.out.println(sb.toString()); 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2013-08-29T10:30:43.850

如果您使用的是[Eclipse Collections](https://github.com/eclipse/eclipse-collections)，则可以使用该`makeString()`方法。

```
ArrayList<String> list = new ArrayList<String>();
list.add("one");
list.add("two");
list.add("three");

Assert.assertEquals(
    "one\ttwo\tthree",
    ArrayListAdapter.adapt(list).makeString("\t")); 
```

如果您可以将您的转换`ArrayList`为 a `FastList`，则可以摆脱适配器。

```
Assert.assertEquals(
    "one\ttwo\tthree",
    FastList.newListWith("one", "two", "three").makeString("\t")); 
```

注意：我是 Eclipse Collections 的提交者。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2014-06-20T10:35:25.643

下面的代码可以帮助你，

```
List list = new ArrayList();
list.add("1");
list.add("2");
list.add("3");
String str = list.toString();
System.out.println("Step-1 : " + str);
str = str.replaceAll("[\\[\\]]", "");
System.out.println("Step-2 : " + str); 
```

输出：

```
Step-1 : [1, 2, 3]
Step-2 : 1, 2, 3 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2014-10-03T02:49:13.290

可能不是最好的方式，但优雅的方式。

Arrays.deepToString(Arrays.asList("Test", "Test2")

```
import java.util.Arrays;

    public class Test {
        public static void main(String[] args) {
            System.out.println(Arrays.deepToString(Arrays.asList("Test", "Test2").toArray()));
        }
    } 
```

输出

[测试，测试2]

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2015-12-10T16:55:14.117

以下内容会有什么好处：

```
List<String> streamValues = new ArrayList<>();
Arrays.deepToString(streamValues.toArray())); 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2016-11-08T11:16:45.740

```
List<String> stringList = getMyListOfStrings();
StringJoiner sj = new StringJoiner(" ");
stringList.stream().forEach(e -> sj.add(e));
String spaceSeparated = sj.toString() 
```

您传递给`new StringJoiner`要用作分隔符的字符序列。如果你想做一个 CSV：`new StringJoiner(", ");`

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2014-07-31T05:36:40.087

要使用制表符而不是使用**println**进行分隔，您可以使用**print**

```
ArrayList<String> mylist = new ArrayList<String>();

mylist.add("C Programming");
mylist.add("Java");
mylist.add("C++");
mylist.add("Perl");
mylist.add("Python");

for (String each : mylist)
{       
    System.out.print(each);
    System.out.print("\t");
} 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2015-09-24T20:27:49.990

我看到了很多依赖于额外资源的示例，但这似乎是最简单的解决方案：（这是我在自己的项目中使用的）基本上只是从 ArrayList 转换为 Array 然后再转换为 List .

```
 List<Account> accounts = new ArrayList<>();

   public String accountList() 
   {
      Account[] listingArray = accounts.toArray(new Account[accounts.size()]);
      String listingString = Arrays.toString(listingArray);
      return listingString;
   } 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2010-07-13T00:21:32.290

到目前为止，这是一个相当古老的对话，apache commons 现在在内部使用 StringBuilder： http: [//commons.apache.org/lang/api/src-html/org/apache/commons/lang/StringUtils.html#line。 3045](http://commons.apache.org/lang/api/src-html/org/apache/commons/lang/StringUtils.html#line.3045)

正如我们所知，这将提高性能，但如果性能很关键，那么使用的方法可能效率低下。虽然接口很灵活，并且允许在不同的 Collection 类型之间保持一致的行为，但对于 Lists 来说效率有点低，这是原始问题中的 Collection 类型。

我之所以这样做是因为我们会产生一些开销，我们可以通过简单地遍历传统 for 循环中的元素来避免这些开销。相反，在检查并发修改、方法调用等的幕后会发生一些额外的事情。另一方面，增强的 for 循环将导致相同的开销，因为迭代器用于 Iterable 对象（列表）。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2015-04-08T07:40:40.000

您可以为此使用正则表达式。这是最简洁的

```
System.out.println(yourArrayList.toString().replaceAll("\\[|\\]|[,][ ]","\t")); 
```

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2014-01-30T08:59:22.733

这个功能怎么样：

```
public static String toString(final Collection<?> collection) {
    final StringBuilder sb = new StringBuilder("{");
    boolean isFirst = true;
    for (final Object object : collection) {
        if (!isFirst)
            sb.append(',');
        else
            isFirst = false;
        sb.append(object);
    }
    sb.append('}');
    return sb.toString();
} 
```

它适用于任何类型的收藏...

# javascript - AJAX 函数填充表单中的字段？

> ID：599172
> 
> 赞同：0
> 
> 时间：2009-03-01T03:03:30.383
> 
> 标签：javascript, html, ajax, forms

嘿，我正在查看 W3 关于 AJAX 的教程，我决定制作一个 javascript 函数，该函数将根据页面的响应填充表单字段。我采用了它们的所有功能并尝试创建以下功能。

谁能明白为什么它不起作用？

```
function populateForm(myForm,formField,PageFrom,infoToSend)
{
var xmlHttp;
try
  {
  xmlHttp=new XMLHttpRequest();
  }
catch (e)
  {
  try
    {
    xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");
    }
  catch (e)
    {
    try
      {
      xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    catch (e)
      {
      //alert("Your browser does not support AJAX!");
      return false;
      }
    }
  }
  xmlHttp.onreadystatechange=function()
    {
    if(xmlHttp.readyState==4)
      {
      document.myForm.formField.value=xmlHttp.responseText;
      }
    }
 var url=PageFrom;
url=url+"?q="+infoToSend;

  xmlHttp.open("GET",url,true);
  xmlHttp.send(null);
  } 
```

这就是我所说的：

```
<form id="qwert" name="qwert">

<input id="qwer" name="qwer" type="text" onkeyup="populateForm('qwert','qwerty','echo.php',this.value);">
<input id="qwerty" name="qwerty" type="text">

</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T03:06:54.760

这是错误的：

```
document.myForm.formField.value=xmlHttp.responseText; 
```

您可能想尝试：

```
document.getElementById(formField).value = xmlHttp.responseText; 
```

有了它，您甚至不需要传递表单名称，只需传递要更新的字段的 id。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T03:27:11.443

这可能是一个迟到的答复，但肯定会对以后有这样问题的人有所帮助。

* * *

最好的选择是使用[http://www.prototypejs.org/api/ajax/updater](http://www.prototypejs.org/api/ajax/updater)上的prototype.js 。它会很简单

```
new Ajax.Updater('qwerty',url,{asynchronous:true}); 
```

这将照顾你想要做的事情。对于任何错误处理要求，请仔细阅读整个 API 文档，这很简单。

* * *

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T10:10:16.310

我做了这个，效果很好......希望它会有所帮助..

```
<script>
function CreateXmlHttpObject() { //function to return the xml http object
    var xmlhttp=false;  
    try{
        xmlhttp=new XMLHttpRequest();//creates a new ajax object
    }
    catch(e)    {       
        try{            
            xmlhttp= new ActiveXObject("Microsoft.XMLHTTP");//this is for IE browser
        }
        catch(e){
            try{
            req = new ActiveXObject("Msxml2.XMLHTTP");//this is for IE browser
            }
            catch(e1){
                xmlhttp=false;//error creating object
            }
        }
    }

    return xmlhttp;
} 
function getDataDB(brand_name)
{
    var http = CreateXmlHttpObject(); // function to get xmlhttp object
    var strURL = "ajax/get_brand_name_data.php?brand_name="+brand_name;
    if (http){
        http.onreadystatechange = function(){
            if (http.readyState == 4) { //data is retrieved from server
                if (http.status == 200) { // which reprents ok status                    
                    var results = http.responseText.split("|");
                    document.getElementById('brand_name').value = results[0];
                    document.getElementById('seq').value = results[1];
                    if(results[2]=="Y")
                        document.getElementById('cstatus').checked = true;
                    else
                        document.getElementById('cstatus').checked = false; 
                    document.getElementById('edate').value = results[3];
                    document.getElementById('user_name').value = results[4];
                    document.getElementById('details').value = results[5];      
                }
                else
                { 
                    alert("There was a problem while using XMLHTTP:\n");
                }
            }            
        }        
        http.open("GET", strURL, true); //open url using get method
        http.send(null);//send the results
    }
}</script>

<a href="#"  onClick="$('#tabs').tabs('select', 0); getDataDB('<?=$row['brand_name'];?>'); return false;" class="red">EDIT </a> 
```

php

```
<?php
$dbhost = 'localhost';
$dbuser = 'username';
$dbpass = 'password';
$dbname = 'database';

$conn = mysql_connect($dbhost, $dbuser, $dbpass);
mysql_select_db($dbname);   
$q = strtolower($_GET["brand_name"]);
if (!$q) return;

$sql = "SELECT * FROM setup_brand WHERE brand_name = '$q'";
$rw = mysql_fetch_array(mysql_query($sql));
$brand_name=($rw['brand_name']);
$seq=($rw['seq']);
$cstatus=($rw['cstatus']);
$edate=($rw['edate']);
$user_name=($rw['user_name']);
$details=($rw['details']);
echo "".$brand_name . "|" . $seq . "|" . $cstatus . "|" . $edate . "|" . $user_name . "|" . $details;?> 
```

# iis - IIS7 上的 Joomla 搜索引擎友好 URL 问题

> ID：599184
> 
> 赞同：3
> 
> 时间：2009-03-01T03:21:02.713
> 
> 标签：iis, iis-7, seo, joomla, friendly-url

我在 vista 64 开发盒上的 IIS7 上运行 Joomla 1.5.9 和 php 5.2.8、mySQL 5.1.31。我的 SEO 设置“搜索引擎友好 URL”和“使用 Apache mod_rewrite”都正常工作。

我还在建立一个托管站点（使用 www.mochahosting.com）。他们使用相同软件的稍旧版本：Joomla 1.5.5、php 5.2.6、mySQL 5.0.4x。他们也使用 IIS7，但在 Windows 32 上运行。

我无法让任何 SEO 设置**在托管站点上**工作（我已经让 SEO 设置在我的本地机器上工作，配置几乎相同）。让我们从“搜索引擎友好的 URL”开始，只是为了让事情变得简单。

另外，我还没有域名，所以我使用主机文件别名来访问该站点。我不希望任何人遇到麻烦来回答我的问题，所以我只会描述这个问题，并希望我做得足够好，让人们能够理解正在发生的事情。出于此问题的目的，我将使用[http://nodomainyet.com/joomla156_mx](http://nodomainyet.com/joomla156_mx)作为基本 URL（即 joomla 主页）。是的，这确实意味着 Joomla 安装在一个子目录中——我不确定这是否是一个问题（这在我的开发盒上不是问题）。

关于问题。

打开“搜索引擎友好 URL”会导致[http://nodomainyet.com/joomla156_mx](http://nodomainyet.com/joomla156_mx)生成 404（“找不到组件”）。在 404 错误页面中有一个指向 [http://nodomainyet.com/joomla156_mx/index.php](http://nodomainyet.com/joomla156_mx/index.php)的链接——该链接有效。如果我关闭“搜索引擎友好 URL”，那么[http://nodomainyet.com/joomla156_mx](http://nodomainyet.com/joomla156_mx)和[http://nodomainyet.com/joomla156_mx/index.php](http://nodomainyet.com/joomla156_mx/index.php)都可以工作。因此，似乎打开“搜索引擎友好 URL”会导致[http://nodomainyet.com/joomla156_mx](http://nodomainyet.com/joomla156_mx)到[http://nodomainyet.com/joomla156_mx/index.php](http://nodomainyet.com/joomla156_mx/index.php)的“自动重定向”停止工作......

现在，如果我访问[http://nodomainyet.com/joomla156_mx/index.php](http://nodomainyet.com/joomla156_mx/index.php)并从那里导航到各种主菜单链接（我只使用安装了新 Joomla 实例的默认 joomla 站点），然后一切正常。它只是去[http://nodomainyet.com/joomla156_mx](http://nodomainyet.com/joomla156_mx)不起作用。值得注意的是，主菜单中的“主页”链接默认指向[http://nodomainyet.com/joomla156_mx](http://nodomainyet.com/joomla156_mx)。

我已经将主机上 phpinfo 的输出与我的开发箱的输出进行了比较，并且看不到任何会导致此问题的差异...

打开第二个 SEO 设置——“使用 Apache mod_rewrite”——并不能解决问题（人们会认为它可能，因为该设置的目的是摆脱 URL 中的 index.php）。

“搜索引擎友好的 URL”通常看起来很简单——它不需要 web.config 和重写规则......我不确定是什么可能导致它出错。

* * *

**更新 - 2009-03-03**

我认为仅从（“使用 Apache mod_rewrite”）打开第一个 SEO 设置（“搜索引擎友好 URL”）可能是个坏主意（即使我可以自己打开“搜索引擎友好 URL”）本地机器，它工作正常）。所以我尝试了更多的实验

我认为问题可能是在主机上的 IIS7 中没有正确设置 URL 重写。我做了[http://learn.iis.net/page.aspx/461/creating-rewrite-rules-for-the-url-rewrite-module](http://learn.iis.net/page.aspx/461/creating-rewrite-rules-for-the-url-rewrite-module)中描述的（第一个）测试文件并且有效 - 这意味着 URL重写工作。

然后我想也许问题在于人们在 IIS7 上随处可见的 Joomla 的重写规则需要重写以考虑子目录。就像我上面说的，SEO 设置在我的本地机器上运行良好。Joomla 也安装在子目录中，一切正常。不过，我尝试从

```
<rewrite>
    <rules>
        <rule name="Imported Rule 1" enabled="true">
            <match url="(.*)" ignoreCase="false" />
            <conditions logicalGrouping="MatchAll">
                <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" pattern="" ignoreCase="false" />
                <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" pattern="" ignoreCase="false" />
                <add input="{SCRIPT_NAME}" negate="true" pattern="^/index.php" ignoreCase="false" />
                <add input="{SCRIPT_NAME}" pattern="(/|\.php|\.html|\.htm|\.feed|\.pdf|\.raw|/[^.]*)$" />
            </conditions>
            <action type="Rewrite" url="index.php" />
        </rule>
    </rules>
</rewrite> 
```

到

```
<rewrite>
    <rules>
        <rule name="Imported Rule 1" enabled="true">
            <match url="(.*)" ignoreCase="false" />
            <conditions logicalGrouping="MatchAll">
                <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" pattern="" ignoreCase="false" />
                <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" pattern="" ignoreCase="false" />
                <add input="{SCRIPT_NAME}" negate="true" pattern="^/joomla156mx/index.php" ignoreCase="false" />
                <add input="{SCRIPT_NAME}" pattern="(/|\.php|\.html|\.htm|\.feed|\.pdf|\.raw|/[^.]*)$" />
            </conditions>
            <action type="Rewrite" url="joomla156mx/index.php" />
        </rule>
    </rules>
</rewrite> 
```

（即，将目录名称添加到条件和操作）。这并没有什么不同。现在，我对重写规则完全陌生，所以我可能搞砸了一些东西。

我想我觉得没有重定向规则有点可疑；这意味着如果我复制并粘贴一个“重写”的 URL，是否必须告诉服务器这是一个虚构的 URL，它应该被重定向到一个真实的 URL？但是，再一次，这一切都在我的本地机器上运行良好，使用普通的旧重写规则，所以我可能在错误的树上吠叫。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T04:16:59.240

本页的最后一步是[启用搜索引擎友好 URL](http://learn.iis.net/page.aspx/527/joomla-on-iis/)。

> 默认情况下，Joomla 对它为您的网站生成的所有链接 URL 使用查询字符串参数。可以通过在 Joomla 中启用所谓的“搜索引擎友好 URL”来更改此行为。但是，此功能依赖于 Web 服务器上可用的 URL 重写功能。IIS 6.0 没有 URL 重写功能，因此您可以使用第三方 URL 重写产品之一，例如 ISAPI_Rewrite 或 Ionics ISAPI Rewrite Filter。IIS 7.0 支持 URL 重写，可以通过安装 Microsoft URL Rewrite Module for IIS 7.0 来启用。以下说明描述了如何使用 IIS 7.0 的 URL 重写模块在 Joomla 中启用清理 URL。
> 首先，您需要下载并安装 Microsoft URL Rewrite Module。安装后，创建并打开位于 C:\inetpub\wwwroot\Joomla 文件夹中的 web.config 文件。将以下 XML 代码粘贴到此文件中。

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <system.webServer>
    <rewrite>
      <rules>
        <rule name="Security Rule" stopProcessing="true">
          <match url="^(.*)$" ignoreCase="false" />
          <conditions logicalGrouping="MatchAny">
            <add input="{QUERY_STRING}" pattern="mosConfig_[a-zA-Z_]{1,21}(=|\%3D)" ignoreCase="false" />
            <add input="{QUERY_STRING}" pattern="base64_encode.*\(.*\)" ignoreCase="false" />
            <add input="{QUERY_STRING}" pattern="(\&lt;|%3C).*script.*(\>|%3E)" />
            <add input="{QUERY_STRING}" pattern="GLOBALS(=|\[|\%[0-9A-Z]{0,2})" ignoreCase="false" />
            <add input="{QUERY_STRING}" pattern="_REQUEST(=|\[|\%[0-9A-Z]{0,2})" ignoreCase="false" />
          </conditions>
          <action type="CustomResponse" url="index.php" statusCode="403" statusReason="Forbidden" statusDescription="Forbidden" />
        </rule>
        <rule name="SEO Rule">
          <match url="(.*)" ignoreCase="false" />
          <conditions logicalGrouping="MatchAll">
            <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" pattern="" ignoreCase="false" />
            <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" pattern="" ignoreCase="false" />
            <add input="{URL}" negate="true" pattern="^/index.php" ignoreCase="false" />
            <add input="{URL}" pattern="(/|\.php|\.html|\.htm|\.feed|\.pdf|\.raw|/[^.]*)$" />
          </conditions>
          <action type="Rewrite" url="index.php" />
        </rule>
      </rules>
    </rewrite>
 </system.webServer>
</configuration> 
```

保存 web.config 文件，然后打开 Web 浏览器并在[http://localhost/joomla/administrator/](http://localhost/joomla/administrator/)登录到 Joomla 管理员控制台。登录后，转到站点 --> 全局配置菜单配置 SEO 设置，如下所示：

*   搜索引擎友好的 URL - 是*   使用 Apache mod_rewrite - 是*   为 URL 添加后缀 - 否单击“应用”保存配置，然后浏览到[http://localhost/joomla/](http://localhost/joomla/)。您将看到现在 Joomla 页面中的所有链接都有没有查询字符串参数的 URL，如果您单击这些链接中的任何一个，服务器将返回正确的响应：

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-17T01:03:56.027

事实证明，问题在于托管公司没有使用 FastCGI 来运行 php。即使它在运行 phpinfo() 时显示“Server API = CGI/FastCGI”，也不足以保证正在使用 fastcgi。

使用 CGI 或 ISAPI 有什么问题？他们都存在 joomla SEO 使用的 php 变量 _SERVER["REQUEST_URI"] 的问题。

请参阅我的另一个问题，了解如何确定是否使用了 FastCGI：[如何确定是否使用 FastCGI 运行 php 脚本](https://stackoverflow.com/questions/609044/how-to-know-for-sure-if-fastcgi-is-being-used-to-run-php-scripts)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-24T22:50:47.673

我有一个网站 www.carooolglobal.com，所有功能都可以正常工作，所有 SEO 设置都设置为 No。

如果我将任何 SEO 设置设置为是，并从主页左侧的搜索表单执行搜索，它会在 index.php 上正确显示结果。但是当我单击搜索结果中的名称链接时，它应该在弹出窗口中打开此人的个人资料，但弹出窗口显示

您可能无法访问此页面，因为：

一个过期的书签/收藏夹 一个搜索引擎，其中包含该站点的过期列表 输入错误的地址 您无权访问此页面 未找到请求的资源。处理您的请求时发生错误。请尝试以下页面之一：

主页

如果问题仍然存在，请联系本网站的系统管理员。

我一无所知

问候基斯莱

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-01T20:37:10.313

我不确定这是否已经涵盖，我看了看，但我很高兴错过了一些东西。

如果您的搜索引擎友好链接有问题，请进入安装 joomla 的文件夹，并将您的 htaccess.txt 文件重命名为 .htaccess

这应该可以解决 404 问题。

# php - PHP 类不回显返回值

> ID：599185
> 
> 赞同：0
> 
> 时间：2009-03-01T03:21:53.337
> 
> 标签：php, oop

```
class hello {

  var $fname;
  var $lname;

  function attrib() {
    $this->fname = "sarmen";
    $this->lname = "dijango";
  }

  function say() {
    $name = $this->fname.", ".$this->lname;
    return $name;
  }
} 
```

这是我在页面上包含该类并键入类似内容时的示例类

```
$d = new hello();
$d->say() 
```

什么都没发生。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-01T03:27:45.817

您将该方法`attrib`视为[构造函数](http://us3.php.net/manual/en/language.oop5.decon.php)，但您需要为其命名`__construct`以使其行为如此。`*`否则，您需要这样做：

```
$myobject = new hello(); // create new object
$myobject->attrib(); // set the vars
print $myobject->say(); 
```

然而，更常见的是看到这样的东西：

```
$myobject = new hello('my first name', 'my last name');
print $myobject->say(); 
```

`attrib`然后，您将拥有如下所示的东西，而不是该方法：

```
function __construct($fname, $lname) {
   $this->fname = $fname;
   $this->lname = $lname;
} 
```

`*`除非您使用的是 PHP4，在这种情况下，您需要将构造函数命名为与类名相同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-01T03:27:44.787

"say" 返回一个字符串。你实际上并没有用它做任何事情。你不应该打印它还是什么？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-01T03:29:53.393

尝试这个：

```
$d = new hello();
$d->attrib();
print $d->say(); 
```

除此之外，您还可以进行一些改进，例如：

```
class hello {

   var $fname; 
   var $lname;

   public function __construct() {

      $this->fname = "sarmen"; 
      $this->lname = "dijango";

   }

  public function say() {

      $name = $this->fname.", ".$this->lname;

      return $name;

   }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-01T03:29:31.257

尝试去：

```
$var=$d->say();
echo $var; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-01T04:04:31.203

如果您致电，他们现在就拥有它：

```
$d = 新的你好（）；
$d->say();

```

什么都没有发生，因为 say() 只是简单地返回值......您需要回显或打印该值，如下所示：

```
$d = 新的你好（）；
回声 $d->say();

```

但这只会输出您分配给 $name 的逗号。$this->fname 和 $this->lname 的值尚未填充，因此它们中没有可返回的内容。

但是等等，你可能会说......我有那个方法 attrib() 在那里，不应该填充那些变量吗？答案是肯定的，但你必须打电话给它。因此，使用您的示例，以下内容将为您提供所需的内容：

```
$d = 新的你好（）；//实例化类
$d->属性（）；//调用 attrib() 从而分配这些值
回声 $d->say(); //回显say()返回的值

```

然而，最重要的是，事实上这并不是做这种事情的最佳方式。Paolo 和 jonstjohn 提供的答案向您展示了处理此问题的最佳方法，而 Paolo's 是最灵活的，因为您每次都可以更改名字和姓氏的值。

# java - JavaMail 问题或错误？

> ID：599188
> 
> 赞同：0
> 
> 时间：2009-03-01T03:25:33.920
> 
> 标签：java, mime, jakarta-mail, parsing

我有一个关于 Java Mail 以及它如何与流一起使用的问题。在 Java Mail 1.4.1 中有一个[接受流的 MimeMessage 构造函数](http://java.sun.com/products/javamail/javadocs/javax/mail/internet/MimeMessage.html#MimeMessage(javax.mail.Session,%20java.io.InputStream))。我的理解是我可以将一个流传递给这个构造函数，它会为我将它解析成一个 MimeMessage。我写了 2 个测试来证明这一点。第一个测试发送一个只包含部分多部分 MIME 消息的流。第二个测试发送包含 2 个完整的多部分 MIME 消息的流。两者都不像我预期的那样工作。第一个不抛出异常，第二个以某种方式将整个流读入单个消息。这是 Java Mail 中的错误还是我使用了错误类型的流？还是我错过了更大的东西？

它有点长，但这里是测试代码：

```
import java.io.BufferedInputStream;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.Properties;

import javax.activation.DataHandler;
import javax.activation.DataSource;
import javax.mail.BodyPart;
import javax.mail.MessagingException;
import javax.mail.Multipart;
import javax.mail.Session;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;
import javax.mail.util.ByteArrayDataSource;

import junit.framework.TestCase;

public class mimeTest extends TestCase {

    public void testPartialMulitpartMessage() throws MessagingException, IOException 
    {
        Properties props = new Properties();
        Session session = Session.getInstance(props, null);
        String testMsg1 = "test";
        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();

        // Step 1 - Create first MIME message
        MimeMessage mesg = new MimeMessage(session);
        Multipart mp = new MimeMultipart("mixed");
        //create a child part
        BodyPart bodyPart = new MimeBodyPart();
        bodyPart.setContent(testMsg1, "application/x-special");
        bodyPart.setHeader("Content-Length", String.valueOf(testMsg1.length()));
        DataSource ds = new ByteArrayDataSource(testMsg1, "application/x-special");
        bodyPart.setDataHandler(new DataHandler(ds));
        bodyPart.setHeader("Content-Transfer-Encoding", "8bit");
        // Add the child part to the multipart
        mp.addBodyPart(bodyPart);
        // Put the MultiPart into the Message
        mesg.setContent(mp);

        // Step 2 - write to a stream
        mesg.writeTo(byteArrayOutputStream);

        byte bytes[] = byteArrayOutputStream.toByteArray();
        ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(bytes, 0, 10);
        BufferedInputStream bufferedInputStream = new BufferedInputStream(byteArrayInputStream);
        boolean thrown = false;
        try
        {
            //Why does this not throw a messageexception.
            MimeMessage mesg2 = new MimeMessage(session, bufferedInputStream);
        }
        catch(MessagingException me){
            thrown = true;
        }

        if(!thrown) {
            assertTrue("Expected exception not thrown.", false);
        }
    }

    public void testMulitpleMulitpartMessages() throws MessagingException, IOException {
        Properties props = new Properties();
        Session session = Session.getInstance(props, null);
        String testMsg1 = "test";
        String testMsg2 = "test1";
        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();

        // Step 1 - Create first MIME message
        MimeMessage mesg = new MimeMessage(session);
        Multipart mp = new MimeMultipart("mixed");
        //create a child part
        BodyPart bodyPart = new MimeBodyPart();
        bodyPart.setContent(testMsg1, "application/x-special");
        bodyPart.setHeader("Content-Length", String.valueOf(testMsg1.length()));
        DataSource ds = new ByteArrayDataSource(testMsg1, "application/x-special");
        bodyPart.setDataHandler(new DataHandler(ds));
        bodyPart.setHeader("Content-Transfer-Encoding", "8bit");
        // Add the child part to the multipart
        mp.addBodyPart(bodyPart);
        // Put the MultiPart into the Message
        mesg.setContent(mp);

        // Step 2 - write to a stream
        mesg.writeTo(byteArrayOutputStream);

        // Step 3 - Create second MIME message
        MimeMessage mesg2 = new MimeMessage(session);
        mp = new MimeMultipart("mixed");
        //create a child part
        bodyPart = new MimeBodyPart();
        bodyPart.setContent(testMsg2, "application/x-special");
        bodyPart.setHeader("Content-Length", String.valueOf(testMsg2.length()));
        ds = new ByteArrayDataSource(testMsg2, "application/x-special");
        bodyPart.setDataHandler(new DataHandler(ds));
        bodyPart.setHeader("Content-Transfer-Encoding", "8bit");
        // Add the child part to the multipart 
        mp.addBodyPart(bodyPart);
        // Put the MultiPart into the Message
        mesg2.setContent(mp);

        // Step 4 - write to the same stream
        mesg2.writeTo(byteArrayOutputStream);

        // Step 6 - read the two messages back
        ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(byteArrayOutputStream.toByteArray());
        BufferedInputStream bufferedInputStream = new BufferedInputStream(byteArrayInputStream);
        List<MimeMessage> listMessages = new ArrayList<MimeMessage>();
        while (bufferedInputStream.available() > 0) {
            //http://java.sun.com/products/javamail/javadocs/javax/mail/internet/MimeMessage.html#MimeMessage(javax.mail.Session,%20java.io.InputStream)
            //The InputStream will be left positioned at the end of the data for the message.
            //WHY does this not work?  It reads the whole stream.
            mesg = new MimeMessage(session, bufferedInputStream);
            //output the message
            listMessages.add(mesg);
        }

        assertEquals(2, listMessages.size());

        assertTrue(listMessages.get(0).equals(mesg));
        assertTrue(listMessages.get(1).equals(mesg2));
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-01T18:48:25.790

JavaMail API 是一头猪，原始使用它是一项吃力不讨好的任务，主要是因为它的行为与您期望的不一样。

我建议在它周围使用 Spring 的 API 层，它的压力要小得多。它并没有完全隐藏 JavaMail，它只是使它更易于预测和测试友好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T18:08:13.220

JavaMail 将读取整个流，可能会缓冲它。我同意@skaffman，但我的观点是，它只是在没有说明原因的情况下进行了高度优化，这使得它难以使用。

[MimeMessage.parse(InputStream)](http://kenai.com/projects/javamail/sources/mercurial/content/mail/src/main/java/javax/mail/internet/MimeMessage.java?rev=141)方法就是您要处理的。它会读取整个流，而不关闭它，除非您使用的是 SharedInputStream。如您所见，它将使 InputStream 位于最后。

MimeMessage 对解释流中的数据没有多大作用，因此我认为你“错过了更大的东西”来使用你的话。你为什么期望它解释数据？您可以只发送用于创建流的多部分消息吗？

# c++ - wxWidgets 和 VC++

> ID：599195
> 
> 赞同：2
> 
> 时间：2009-03-01T03:29:36.547
> 
> 标签：c++, visual-c++, wxwidgets

我决定今天熟悉一下 wxWidgets。我下载了 2.8.9 版（当前版本），并以所有需要的模式编译了库。

我能够开箱即用地构建/运行 wxWidgets 附带的示例。**但是，当我使用/Za**进行编译（即禁用语言扩展）时，即使是最小的 wxWidgets 示例，我也会遇到 100 多个构建错误。

我找不到有关此问题的任何文档。我可以定义一些东西来将 wxWidget 的内部切换为符合标准（至少就 VC++ 的合规性而言）？

也许我在构建原始库时做错了什么......以前有没有人遇到过这个“问题”？

谢谢！

**编辑：**我忘了提到我正在使用 VC++ 9。

此外，这里是前几个错误：

> ------ 构建开始：项目：最小，配置：Unicode Debug Win32 ------
> 
> 正在编译...
> 
> 最小的.cpp
> 
> c:\wxWidgets-2.8.9\include\wx/dynarray.h(69)：错误 C2143：语法错误：在 '*' 之前缺少 ')'
> 
> c:\wxWidgets-2.8.9\include\wx/dynarray.h(69)：错误 C2143：语法错误：缺少“;” 前 '*'
> 
> c:\wxWidgets-2.8.9\include\wx/dynarray.h(69)：错误 C2059：语法错误：')'
> 
> c:\wxWidgets-2.8.9\include\wx/dynarray.h(69)：错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数
> 
> c:\wxWidgets-2.8.9\include\wx/dynarray.h(810)：错误 C2146：语法错误：缺少“;” 在标识符“SCMPFUNC”之前
> 
> c:\wxWidgets-2.8.9\include\wx/dynarray.h(810)：错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数
> 
> c:\wxWidgets-2.8.9\include\wx/dynarray.h(810)：错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数
> 
> c:\wxWidgets-2.8.9\include\wx/dynarray.h(811)：错误 C2146：语法错误：缺少“;” 在标识符“SCMPFUNC”之前
> 
> c:\wxWidgets-2.8.9\include\wx/dynarray.h(811)：错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数
> 
> c:\wxWidgets-2.8.9\include\wx/dynarray.h(811)：错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数

**编辑：**看起来第一个错误是由使用**_cdecl**的事实引起的。看起来**defs.h**只检查是否定义了**__VISUALC__**。看不到学究气...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-01T12:01:01.607

您可能会发现您甚至无法使用 构建基本的 Win32 应用程序，更不用说 wxWidgets 应用程序了`/Za`，因为 VS2008 包含的 Windows 平台 SDK 标头使用语言扩展。唯一的解决方案是禁用`/Za`.

The specific error you're seeing is because the `_cdecl` keyword is a Microsoft extension, and not part of standard C++. For more information, see the [documentation for `/Za`](http://msdn.microsoft.com/en-us/library/0k0w269d.aspx), and the [Microsoft Extensions to C and C++](http://msdn.microsoft.com/en-us/library/34h23df8.aspx) and [C++ Keywords](http://msdn.microsoft.com/en-us/library/2e6a4at9.aspx) pages in MSDN.

# iphone - 使用 TabBar 的基于导航的应用程序

> ID：599200
> 
> 赞同：3
> 
> 时间：2009-03-01T03:32:10.237
> 
> 标签：iphone, navigation, tabbar

我有一个基于导航的应用程序，它显示了一个 TableView，您可以在其中选择一个单元格，它会将您带到该单元格的“详细信息视图”。我希望这个视图有一个 TabBar，我可以在其中选择 3 个子视图。我在网上找到了几个解决方案，但没有一个很有帮助。是否有专门针对此的教程，或者他们的源代码是否说明了如何完成？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-01T07:06:30.567

基本上你需要做的就是将一个选项卡视图控制器推送到导航控制器的视图控制器堆栈上。

从一个全新的“基于导航的应用程序”模板开始。我在 RootViewController.m 中添加了以下方法：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
//Navigation logic may go here. Create and push another view controller.
UIViewController *viewOneViewController =   [[UIViewController alloc] init];
viewOneViewController.title = @"One";
viewOneViewController.view.backgroundColor = [UIColor redColor];

UIViewController *viewTwoViewController =   [[UIViewController alloc] init];
viewTwoViewController.title = @"Two";
viewTwoViewController.view.backgroundColor = [UIColor orangeColor];

UIViewController *viewThreeViewController = [[UIViewController alloc] init];
viewThreeViewController.title = @"Three";
viewThreeViewController.view.backgroundColor = [UIColor greenColor];

UITabBarController *anotherViewController = [[UITabBarController alloc] init];
anotherViewController.viewControllers = [NSArray arrayWithObjects:viewOneViewController, viewTwoViewController, viewThreeViewController, nil];
[self.navigationController pushViewController:anotherViewController animated:YES];
[anotherViewController release]; 
```

}

将此更改为 25 以进行测试：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return 25;
} 
```

现在，当我构建和运行时，我将以基本方式查看您正在寻找的内容。完成这项工作后，您要做的是将 UIViewControllers 更改为您创建的自定义子类，以保存每个视图的代码。（如果您也在使用 Interface Builder，请将 init 更改为 initWithNibNamed:)。

希望这可以帮助您继续前进。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T16:10:13.550

您应该知道，如果您这样做，Apple 可能会拒绝您的申请。

来自“结合标签栏和导航控制器”

组合标签栏和导航控制器是很常见的，如图 4 所示。为此，您只需将导航控制器添加到标签栏控制器**（但是，您永远不应该将标签栏控制器添加到导航控制器）。**

因此，它可能违反人机界面指南，因此您可能会被拒绝。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T06:30:22.967

我正在尝试做同样的事情。应用程序“Tweetie”正在做类似的事情。他们有一个帐户的 TableView，然后您选择一个帐户并出现 TabBar。

无论如何，直接来自 Apple 的文档：

> pushViewController:animated：将视图控制器推送到接收器的堆栈并更新显示。
> 
> *   (void)pushViewController:(UIViewController *)viewController 动画:(BOOL)动画
> 
> 参数 viewController 被压入堆栈的视图控制器。**它不能是标签栏控制器的实例。**如果视图控制器已经在堆栈中，则此方法不执行任何操作。
> 
> 动画 将此值设置为 YES 以动画过渡。如果您在显示其视图之前设置导航控制器，则传递 NO。

所以也许我们只是卡住了使用 TabBar 而不是 TabBarController？

-J.P

# powershell - 为什么我不能从函数内部访问 $args？

> ID：599203
> 
> 赞同：2
> 
> 时间：2009-03-01T03:36:06.950
> 
> 标签：powershell

这是我的代码：

```
# hi.ps1

function fun
{
    Write-Host $args
}

Write-Host '---------------'
Write-Host $args
Write-Host '---------------'
fun
Write-Host '---------------' 
```

这是输出：

```
PS C:\scratch> .\hi there jim
---------------
there jim
---------------

--------------- 
```

我的问题是，为什么 $args 在 fun 中不可见？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-01T08:36:20.443

把脚本文件想象成一个函数。函数体是脚本内容，函数名是脚本文件名。当您向脚本发送参数时，它们将在脚本内容中可用。当您向函数发送参数时，$args 将在函数内部访问。

以以下为例：

# .\test-args.ps1

函数 foo{ 写入主机“打印函数 `$args $args”}

# 打印脚本参数

write-host "打印脚本`$args $args"

# 打印函数参数

富你好世界...

# 脚本结束

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T03:42:36.327

根据我对 powershell 的理解， $args 是指当前函数的参数。第一次调用 Write-Host 时，$args 指的是顶级参数。在 fun 内部，您指的是 fun 的参数，这些参数没有给出。

有关变量的详细信息，请参阅[PowerShell](http://computerperformance.co.uk/powershell/powershell_variables.htm)变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-01T04:39:14.320

似乎 $args 具有“脚本”范围。存在三个范围：本地、全局和脚本。

如果函数更改如下：

```
function fun
{
    Write-Host $script:args
} 
```

然后它将起作用。“script:”是范围解析运算符（“local:”是默认值）。我发现这个结果有点实验性，我不能说我知道脚本范围的确切意义是什么，但似乎脚本范围中的变量在某种程度上属于脚本本身。

**编辑：**我接受我自己的答案作为最好的答案，因为它解决了我的问题，但也请参阅其他答案及其评论以获取一些有用的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-22T17:14:41.933

```
$MyInvocation.UnboundArguments 
```

# python - 如何使用 pkg_resources 手动注册分发？

> ID：599205
> 
> 赞同：1
> 
> 时间：2009-03-01T03:40:26.020
> 
> 标签：python, google-app-engine, setuptools, pkg-resources

我正在尝试在 Google App Engine 上安装一个包。该软件包相当广泛地依赖于`pkg_resources`，但无法`setup.py`在 App Engine 上运行。

但是，源代码中没有特定于平台的代码，因此只需压缩源代码并将其包含在系统路径中是没有问题的。而且我已经`pkg_resources`安装了一个版本并且可以正常工作。

唯一的问题是让包实际*注册*，`pkg_resources`所以当它调用时，`iter_entry_points`它可以找到合适的插件。

我需要调用哪些方法来`sys.path`使用所有适当的元数据注册模块，以及如何确定元数据需要是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T08:19:40.413

是的，对于基于 setuptools 的库，您需要同时部署库的“Egg”元数据。我发现最简单的方法是部署一个包含您的项目和所需库的整个[virtualenv环境。](http://pypi.python.org/pypi/virtualenv/1.3.3)

我手动完成了这个过程，并将这段代码添加到 main.py 中，以一种可行的方式初始化 site-packages 文件夹`pkg_resources`：

```
import site
site.addsitedir('lib/python2.5/site-packages') 
```

但是，您可以尝试[appengine-monkey](http://code.google.com/p/appengine-monkey/wiki/Pylons)为您自动完成大部分操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T18:24:17.457

在您的本地开发系统上，运行`python setup.py bdist_egg`，这将创建一个包含必要元数据的 Zip 存档。将其添加到您的`sys.path`中，它应该可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-29T18:15:48.983

像往常一样为包创建 setup.py，然后使用“setup.py sdist --formats=zip”构建源 zip。构建的源 zip 将包含一个 .egg-info 元数据目录，然后 pkg_resources 可以找到该目录。或者，您可以对所有软件包使用 bdist_egg。

# nhibernate - 在 NHibernate 中映射兄弟姐妹

> ID：599209
> 
> 赞同：0
> 
> 时间：2009-03-01T03:47:15.507
> 
> 标签：nhibernate, hibernate, nhibernate-mapping

我一直在尝试使用 NHibernate 映射构建一个 SiteMapNode 样式的对象。目标是模仿 ASP.NET SiteMapNode 对象，以便可以使用 NHibernate 为动态后端构建自定义提供程序。

我遇到的问题是站点地图的树性质。ASP.NET 对象有一个下一个和上一个兄弟对象。这很好。我不想在我的 SiteMapNode 表中有 NextSiblingId 和 PreviousSiblingId。我决定，当我显示这些对象时，最好有一个 OrdinalPosition 属性。经过研究，似乎我无法在 NHibernate 中进行 NextSibling 和 PreviousSibling 属性映射。我想解决这个问题是制作一个兄弟姐妹系列。此集合将具有与所有者对象相同的 ParentNodeId。

这可能吗？

这是我到目前为止提出的映射文件：

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="AthletesCafe.Core.Domain.System.SiteMap" assembly="AthletesCafe.Core">

  <class name="SiteMapNode" table="SiteMapNode" lazy="true" >

    <id name="ID" type="Int32" unsaved-value="0">
      <column name="ID" not-null="true" unique="true" index="PK_SiteMapNode"/>
      <generator class="identity" />
    </id>

    <property name="Title" column="Title" type="String" length="255" not-null="true" />
    <property name="Description" column="Description" type="String" not-null="false" />

    <property name="Url" column="Description" type="String" not-null="true" length="1000"  />

    <property name="Key" column="NodeKey" type="String" not-null="true" length="255"  />

    <property name="OrdinalPosition" column="OrdinalPosition" type="Int32" not-null="true" />

    <property name="ReadOnly" column="ReadOnly" not-null="true" type="System.Boolean" />

    <property name="IsExternal" column="IsExternal" not-null="true" type="System.Boolean" />

    <many-to-one name="ParentNode" column="ParentNodeId" class="AthletesCafe.Core.Domain.System.SiteMap.SiteMapNode, AthletesCafe.Core" 
                 access="field.pascalcase-underscore" not-null="false" />

    <bag name="Siblings" access="field.pascalcase-underscore" inverse="true" lazy="true">
      <key column="ParentNodeId" />
      <many-to-many foreign-key="ParentNodeId" class="AthletesCafe.Core.Domain.System.SiteMap.SiteMapNode, AthletesCafe.Core" />
    </bag>

    <bag name="ChildNodes" generic="true" inverse="true" lazy="true" access="field.pascalcase-underscore">
      <key column="ParentNodeId" />
      <one-to-many  class="AthletesCafe.Core.Domain.System.SiteMap.SiteMapNode, AthletesCafe.Core"/>
    </bag>

  </class>
</hibernate-mapping> 
```

Siblings 包返回与 ChildNodes 集合相同的内容。我只是不了解整个键和外键属性是如何工作的。我认为 key 元素上的 column 属性告诉 nHibernate 使用所有者对象上的该列来映射到外部对象的列。我只需要找出如何让 nHibernate 查看集合节点上的 ParentNodeId。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-01T03:49:10.103

查看这篇博文：[如何在 NHibernate 中映射树](http://web.archive.org/web/20090806071731/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/05/14/how-to-map-a-tree-in-nhibernate.aspx)

# python - 需要身份验证 - 使用 Python 建立 AIM OSCAR 会话的问题

> ID：599218
> 
> 赞同：1
> 
> 时间：2009-03-01T03:52:58.363
> 
> 标签：python, json, aim

[我正在编写一个简单的 python 脚本，它将使用OSCAR 协议](http://dev.aol.com/aim/oscar/)与 AIM 服务器交互。它包括一个有点复杂的握手协议。您基本上必须向特定 URL 发送 GET 请求，接收 XML 或 JSON 编码回复，提取特殊会话令牌和密钥，然后使用令牌和密钥生成响应。

我尝试按照[这些步骤](http://dev.aol.com/aim/oscar/#AUTH)进行操作，但最后一个过程失败了。这是我的代码：

```
class simpleOSCAR:
  def __init__(self, username, password):
    self.username = username
    self.password = password

    self.open_aim_key = 'whatever'
    self.client_name = 'blah blah blah'
    self.client_version = 'yadda yadda yadda'

  def authenticate(self):

    # STEP 1
    url = 'https://api.screenname.aol.com/auth/clientLogin?f=json'
        data = urllib.urlencode( [
                 ('k', self.open_aim_key), 
                 ('s', self.username),
                 ('pwd', self.password), 
                 ('clientVersion', self.client_version),
                 ('clientName', self.client_name)]
                )

    response = urllib2.urlopen(url, data)
    json_response = simplejson.loads(urllib.unquote(response.read()))

    session_secret = json_response['response']['data']['sessionSecret']
    host_time = json_response['response']['data']['hostTime']
    self.token = json_response['response']['data']['token']['a']

    # STEP 2
    self.session_key = base64.b64encode(hmac.new(self.password, session_secret, sha256).digest())

    #STEP 3
    uri = "http://api.oscar.aol.com/aim/startOSCARSession?"

    data = urllib.urlencode([   
                    ('a', self.token),  
                    ('clientName', self.client_name),
                    ('clientVersion', self.client_version),
                    ('f', 'json'),
                    ('k', self.open_aim_key), 
                    ('ts', host_time), 
                                    ]
                )
    urldata = uri+data
    hashdata = "GET&" + urllib.quote("http://api.oscar.aol.com/aim/startOSCARSession?") + data

    digest = base64.b64encode(hmac.new(self.session_key, hashdata, sha256).digest())

    urldata =  urldata + "&sig_sha256=" + digest

    print urldata + "\n"

    response = urllib2.urlopen(urldata)
    json_response = urllib.unquote(response.read())

    print json_response

if __name__ == '__main__':
so = simpleOSCAR("aimscreenname", "somepassword")
so.authenticate() 
```

我从服务器收到以下响应：

```
{ "response" : {
                 "statusCode":401, 
                 "statusText":"Authentication Required. statusDetailCode 1014",
                 "statusDetailCode":1014, 
                 "data":{
                           "ts":1235878395
                         }
               }
} 
```

[我尝试以各种方式对其进行故障排除，但我生成的 URL 看起来与登录流示例](http://dev.aol.com/aim/oscar/#SIGNON)中显示的 URL 相同。然而，它失败了。

知道我在这里做错了什么吗？我是否对值进行了错误的散列？我是否对某些内容进行了不正确的编码？我的会话超时了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T04:03:55.803

尝试使用[Twisted 的 OSCAR 支持](http://twistedmatrix.com/trac/browser/trunk/twisted/words/protocols/oscar.py)而不是自己编写？它没有看到很多维护，但我相信它有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T23:00:37.383

URI 编码您的摘要？

-莫克斯福德

# c++ - 注册 XPCOM 组件时出现问题

> ID：599219
> 
> 赞同：2
> 
> 时间：2009-03-01T03:52:58.907
> 
> 标签：c++, firefox, xpcom

我正在开发我的第一个 XPCOM 组件。不幸的是，我无法成功注册。

建筑没问题。这是生成文件

```
CXX   = g++
CPPFLAGS +=     -fno-rtti \
      -fexceptions \
      -shared \
                -fshort-wchar

# Change this to point at your Gecko SDK directory.
GECKO_SDK_PATH = /path/to/gecko/sdk

# GCC only define which allows us to not have to #include mozilla-config
# in every .cpp file.  If your not using GCC remove this line and add
# #include "mozilla-config.h" to each of your .cpp files.
GECKO_CONFIG_INCLUDE = -include ${GECKO_SDK_PATH}/include/xpcom/xpcom-config.h

GECKO_DEFINES  = -DXPCOM_GLUE -DXPCOM_GLUE_USE_NSPR

GECKO_INCLUDES = -I ${GECKO_SDK_PATH}/sdk/include \
                 -I ${GECKO_SDK_PATH}/include/necko \
                 -I ${GECKO_SDK_PATH}/include/nss \
                 -I ${GECKO_SDK_PATH}/include/nspr

GECKO_LDFLAGS =  -L${GECKO_SDK_PATH}/lib -L${GECKO_SDK_PATH}/bin -Wl,-rpath-link,${GECKO_SDK_PATH}/bin -lxpcomglue_s -lxpcom -lnspr4     

FILES = Component.cpp ComponentModule.cpp

TARGET = Component.so

build:
   $(CXX) -Wall -Os -o $(TARGET) $(GECKO_CONFIG_INCLUDE) $(GECKO_DEFINES) $(GECKO_INCLUDES) $(GECKO_LDFLAGS) $(CPPFLAGS) $(CXXFLAGS) $(FILES)
   chmod +x $(TARGET)
   strip $(TARGET)

clean:
   rm $(TARGET) 
```

我在开发 firefox 配置文件的扩展目录下创建了一个新的扩展文件夹。IComponent.xpt 和 Component.so 文件放置在组件目录下。

然后我从我的开发 Firefox 配置文件中删除了 compreg.dat 和 xpti.dat。我重新启动它，它应该会自动注册组件。但是 XPCOM 查看器没有显示我的组件。

我运行了这个命令来检查错误

```
./run-mozilla.sh `which ldd` -r /path/to/component/Component.so 
```

它向我展示了几个未定义的符号

```
...
undefined symbol: _ZNK9nsAString12BeginReadingEv   (/path/to/component/Component.so)
undefined symbol: _ZNK10nsACString12BeginReadingEv   (/path/to/component/Component.so)
undefined symbol: _ZN9nsAString17DefaultComparatorEPKtS1_j   (/path/to/component/Component.so)
undefined symbol: _ZNK9nsAString6EqualsEPKtPFiS1_S1_jE   (/path/to/component/Component.so)
undefined symbol: _ZN9nsAString13AssignLiteralEPKc   (/path/to/component/Component.so)
undefined symbol: _ZN13nsCOMPtr_base16begin_assignmentEv   (/path/to/component/Component.so)
undefined symbol: _ZN13nsCOMPtr_baseD2Ev   (/path/to/component/Component.so)
undefined symbol: _Z16NS_TableDrivenQIPvPK12QITableEntryRK4nsIDPS_   (/path/to/component/Component.so)
undefined symbol: _Z20NS_NewGenericModule2PK12nsModuleInfoPP9nsIModule   (/path/to/component/Component.so) 
```

我一直在我的代码中使用 nsAString 和 COMPtr。

我的步骤有什么问题吗？谁能解释为什么有未定义的符号？未定义的符号是什么意思？你如何让他们得到认可？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-29T21:03:33.537

您显然已经看到了这一点，但仅供参考：[https ://developer.mozilla.org/en/Troubleshooting_XPCOM_components_registration](https://developer.mozilla.org/en/Troubleshooting_XPCOM_components_registration)

至于你的问题，我不是专家，但你似乎没有正确使用[XPCOM Glue](https://developer.mozilla.org/en/XPCOM_Glue)。文档说您在构建组件时不需要定义 XPCOM_GLUE。（如果这没有帮助，您应该发布到 mozilla 论坛（例如 mozilla.dev.extensions 或 xpcom），真正的专家可能会看到您的问题，因为您可以看到很少有人精通构建/注册机制。）

顺便说一下，关于使用 JS 组件的 +1 ！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-13T10:01:54.740

就我而言，它有助于将 $(GECKO_LDFLAGS) 变量移到末尾，即替换：

```
$(CXX) -Wall -Os -o $(TARGET) $(GECKO_CONFIG_INCLUDE) $(GECKO_DEFINES) $(GECKO_INCLUDES) $(GECKO_LDFLAGS) $(CPPFLAGS) $(CXXFLAGS) $(FILES) 
```

和

```
$(CXX) -Wall -Os -o $(TARGET) $(GECKO_CONFIG_INCLUDE) $(GECKO_DEFINES) $(GECKO_INCLUDES)  $(CPPFLAGS) $(CXXFLAGS) $(FILES) $(GECKO_LDFLAGS) 
```

看完之后：

> Linux 和 Mac：确保 Gecko 库列在链接行上的对象 (.o) 文件之后。

在[此页面上提供有关 XPCOM 链接的说明：](https://developer.mozilla.org/en/XPCOM_Glue)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T23:17:51.800

您是否尝试删除*-fshort-wchar*编译器选项？

# sharepoint - 通过功能将 webpart 添加到默认 WSS 页面

> ID：599228
> 
> 赞同：3
> 
> 时间：2009-03-01T03:58:42.170
> 
> 标签：sharepoint, web-parts

我开发了一个自定义 Web 部件。我想创建一个功能，当通过 STSADM 激活时，它会将 Web 部件添加到 WSS 站点的默认页面。希望这可以在不编写代码的情况下完成。

此 webpart 旨在部署到 Web 应用程序的 bin 目录，并且必须将 featurereceiver 安装到 GAC。[AllUsersWebPart](http://msdn.microsoft.com/en-us/library/ms997833.aspx)元素看起来很有希望，但我不知道如何让它工作。

TIA,

jt

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T13:12:48.797

AllUsersWebPart 标签允许我们使用 WebPartOrder 和 WebPartZone 属性插入一个 webpart 并将其放置在我们想要的位置。标记的内容是您的 webpart 的 dwp（或 webpart）。例如，对于 dwp：

```
<AllUsersWebPart WebPartZoneID="MiddleLeftZone" WebPartOrder="0">
    <![CDATA[                                              
      <WebPart xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://schemas.microsoft.com/WebPart/v2">
        <FrameType>None</FrameType>
        <AllowMinimize>true</AllowMinimize>
        <IsVisible>true</IsVisible>
        <Assembly>Microsoft.SharePoint, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c</Assembly>
        <TypeName>Microsoft.SharePoint.WebPartPages.ContentEditorWebPart</TypeName>
        <ContentLink xmlns="http://schemas.microsoft.com/WebPart/v2/ContentEditor" />
        <Content xmlns="http://schemas.microsoft.com/WebPart/v2/ContentEditor">
          <Value>&lt;iframe src="$Resources:Summary_Url;" frameborder="0" scrolling="no" width="100%" height="100%"&gt;&lt;/iframe&gt;</Value>
        </Content>
        <PartStorage xmlns="http://schemas.microsoft.com/WebPart/v2/ContentEditor" />
    </WebPart>
    ]]>
  </AllUsersWebPart> 
```

对于 Web 部件：

```
<AllUsersWebPart WebPartZoneID="MiddleLeftZone" WebPartOrder="1">
    <![CDATA[                                              
      <webParts>
        <webPart xmlns="http://schemas.microsoft.com/WebPart/v3">
          <metaData>
            <type name="MyClass, MyAssembly, Version=1.0.0.0, Culture=neutral, PublicKeyToken=f3b9d1137704f880" />
            <importErrorMessage>No se puede importar este elemento Web.</importErrorMessage>
          </metaData>
          <data>
            <properties>
              <property name="AllowClose" type="bool">False</property>
              <property name="AllowMinimize" type="bool">False</property>
              <property name="AllowConnect" type="bool">True</property>
              <property name="ChromeType" type="chrometype">None</property>
              <property name="Hidden" type="bool">False</property>
              <property name="AllowEdit" type="bool">False</property>
              <property name="AllowZoneChange" type="bool">False</property>
              <property name="MissingAssembly" type="string">No se puede importar este elemento Web.</property>
              <property name="ChromeState" type="chromestate">Normal</property>
            </properties>
          </data>
        </webPart>
      </webParts>
    ]]>
  </AllUsersWebPart> 
```

我以前没有尝试过，但我认为一旦创建了网络就可以完成。试试看并告诉我们。

# hardware - 双处理器机器如何处理中断？

> ID：599238
> 
> 赞同：18
> 
> 时间：2009-03-01T04:05:15.383
> 
> 标签：hardware, cpu, multicore, interrupt, cpu-architecture

我对双核 CPU 如何处理中断有所了解。我想知道如何在具有多个物理处理器的板上实现中断处理。

任何中断责任是否由物理板的配置决定？每个处理器都必须能够处理某些类型的中断，例如磁盘 I/O。除非有一些电路来管理和分配中断到适当的处理器？我的猜测是该方案必须是处理器中立的，以便任何处理器和内核都可以运行中断处理程序。

如果一个内核正在等待磁盘读取，那么当磁盘准备好时，该内核会是运行中断处理程序的内核吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-01T04:25:18.190

在 x86 系统上，每个 CPU 都有自己的本地 APIC（高级可编程中断控制器），它们也相互连接，并连接到处理路由设备中断到本地 APIC 的 I/O APIC。

操作系统可以对 APIC 进行编程，以确定哪些中断被路由到哪些 CPU（或让 APIC 做出决定）。

我想多核 CPU 的每个核心都会有一个本地 APIC，但老实说，我对此并不确定。

有关更多详细信息，请参阅这些链接：

*   [http://osdev.berlios.de/pic.html](http://osdev.berlios.de/pic.html)
*   [http://www.microsoft.com/whdc/archive/io-apic.mspx](http://www.microsoft.com/whdc/archive/io-apic.mspx)
*   [http://en.wikipedia.org/wiki/Intel_APIC_Architecture](http://en.wikipedia.org/wiki/Intel_APIC_Architecture)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-01T04:28:00.510

您感兴趣的是 SMP Processor Affinity。[这](http://www.alexandersandler.net/smp-affinity-and-proper-interrupt-handling-in-linux)是一篇关于如何在 Linux 中处理它的优秀文章。[高级可编程中断控制器 (APIC)](http://en.wikipedia.org/wiki/Advanced_Programmable_Interrupt_Controller)是您在现代系统中管理它的方式。基本上，除非您有一个使用此接口正确设置的操作系统，否则默认值将全部转到处理器 0。此外，您不一定希望发出命令的内核等待特定的中断。您希望负载较少的核心接收它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T04:30:27.867

不久前我已经问过这个问题了。也许它可以为您提供一些见解:)

[多核/多 CPU 机器中的中断如何工作](https://stackoverflow.com/questions/301018/how-do-interrupts-in-multicore-multicpu-machines-work)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T04:17:31.190

我会说这将取决于硬件制造商......

然而[，这个链接](http://h30434.www3.hp.com/psg/board/message?board.id=HardwareDPC&thread.id=741)让我相信大多数可能是由主处理器和/或第一个核心处理的。

[另一个链接](http://www.eggheadcafe.com/conversation.aspx?messageid=29725264&threadid=29649207)

# perl - 如何在共享 RHEL 服务器上托管 mod_perl 应用程序？

> ID：599245
> 
> 赞同：2
> 
> 时间：2009-03-01T04:15:05.330
> 
> 标签：perl, mod-perl, cpanel

我想在无法访问 root 帐户的共享 RHEL 服务器上托管 mod_perl 应用程序。mod_perl 在服务器上可用，所有需要的 Perl 模块也可用（我的应用程序在 CGI 下运行良好）。

以下是我预计的两个问题：每当我第一次更新我的代码以及随后定期更新时，都需要重新启动 Apache。其次，我必须在.htaccess 中使用一些<Perl> 指令。我很高兴听到其他可能成功完成此任务的人的经验、陷阱和提示。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T10:12:08.083

这在您的情况下可能没有用，但您始终可以在主目录中运行 Apache 实例，并让前端代理传入该实例的请求。这样，您就可以完全控制配置、Apache 模块、Perl 模块和 Perl 本身。它还可以更好地使用系统资源（慢客户端不占用繁重的 perl 应用程序，只占用精简的前端实例），实际上是部署 mod_perl 应用程序的普遍推荐方式。

另一种选择，也就是减少麻烦的一种选择是获得每月 20 美元的 VPS 并使用它。然后你可以做任何你想做的事情，因为你将拥有完全的 root 访问权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T01:40:12.947

如果没有重新启动 Apache httpd 的能力，您将无法做到这一点。

也许管理员会给你`sudo`权力，所以你至少可以这样做。

改用 FCGI 下的 Perl。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T21:20:22.797

如果没有 root 用户，您将无法在共享主机帐户上使用 mod_perl。“运行我自己的实例”听起来不错，但是如果服务器重新启动，您将需要一种方法来启动 apache。

FCGI 是您最好的选择。或者获得一些东西，您可以在其中获得对您自己的 apache 进程的 root 访问权限。这样一个帐户的额外好处是您可以安装 CPAN 模块，而无需经历设置非根库和弄乱 $PERL5LIB 的额外麻烦。

# deployment - powershell 或 msdeploy

> ID：599254
> 
> 赞同：5
> 
> 时间：2009-03-01T04:27:54.033
> 
> 标签：deployment, powershell, iis-6

我遇到了一种情况，我需要找到一种更好的方法来部署 Web 应用程序（asp.net 到 iis6..对不起 ruby​​ 爱好者 :( 我很好奇你们中的一些人做了什么？我已经看到了那里的产品（Anthill ?) 但我真的在寻找一种方法，让我的运营团队可以编写一种方法来获取 zip 文件（打包的代码和程序集）、解压缩、部署到农场。任何人有任何想法或解决方案，他们可能正在使用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-02T08:00:51.660

据说，MSDeploy 附带一个 PowerShell 管理单元和 cmdlet……所以您不必选择。

*   [IIS 团队博客：Web 部署工具和 PowerShell](http://blogs.iis.net/msdeploy/archive/2009/10/07/web-deployment-tool-and-powershell-blog.aspx)
*   [MSDeploy + PowerShell 博客](http://blogs.iis.net/jamescoo/)

坏消息是，我在我的系统上找不到该管理单元；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T07:32:06.533

你提到了微软在 Beta 中拥有的一个工具，[**`msdeploy.exe`**](http://blogs.iis.net/msdeploy/archive/2008/10/29/the-web-deployment-tool-beta-2-is-now-available.aspx). 这对你来说不是一个好选择吗？

在 IIS6上`adsutil.vbs`，最先进的技术是学习IIS的神秘脚本编程模型。 `iisweb.vbs``iisback.vbs``iiscnfg.vbs``iisext.vbs`

我认为`msdeploy`从使用 powershell 和其他脚本或批处理文件包装这些原始实用程序以及其“同步”方法将迈出一大步。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-30T08:00:16.680

同样从 VS 2010 的角度来看，MSdeploy 将被集成到 IDE 中，因此这肯定是前进的方向……查看[VS 2010 中 Web 部署的概述文章](http://vishaljoshi.blogspot.com/2009/09/overview-post-for-web-deployment-in-vs.html)。

# c# - 当我们设置掩码时，有什么办法可以删除 MASKEDTEXTBOX 字段中显示的行？

> ID：599260
> 
> 赞同：2
> 
> 时间：2009-03-01T04:39:06.440
> 
> 标签：c#, .net, winforms

当我们在 c# 的 winforms 中设置蒙版文本框的蒙版时出现的行对我来说似乎一点也不吸引人。我想知道是否有任何方法可以设置蒙版文本框的蒙版，那行是没显示？？？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-01T04:51:14.447

在 VB.NET 中，MaskedTextBox 有一个名为 PromptChar 的属性（我确信它在 C# 中是一样的）。它默认为您看到的下划线。改变那个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-31T03:28:01.457

我能够转到设计器代码并将字符设置为空白。

```
this.mtxtPanel.Mask = "0000";
this.mtxtPanel.PromptChar = ' '; 
```

# .net - 如何访问参考应用程序

> ID：599263
> 
> 赞同：0
> 
> 时间：2009-03-01T04:41:07.047
> 
> 标签：.net, reference

I have installed an application that uses .net framework 3.5 after setup I can't find the exe file, when select properties it says it's a reference How can I find it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T04:53:59.730

如果您使用 ClickOnce 部署应用程序，它会安装在临时文件夹中。也许你会在这样的地方找到它：

> c:\Documents and Settings\user-name\Local Settings\Apps\2.0\temp\temp\temp\app.exe

其中“temp”是一些随机文件夹名称。

所以，试着在你的

> c:\Documents and Settings\用户名\Local Settings\Apps\2.0

文件夹。祝你好运！

# c++ - 有没有办法在 C++ 中使用 SOIL 将一个纹理拆分为一组纹理？

> ID：599264
> 
> 赞同：0
> 
> 时间：2009-03-01T04:43:23.747
> 
> 标签：c++, sdl, textures, soil

我在我的项目中使用 SOIL，我需要获取单个纹理，然后使用第一个纹理的不同部分将其转换为纹理数组。（使用精灵表）。

顺便说一句，我正在使用 SDL 和 OpenGL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T04:59:51.307

将 sprite sheet 与现代 3D api（如 OpenGL）一起使用的典型方法是使用纹理坐标来处理单个纹理的不同部分。虽然您可以将其拆分，但使用纹理坐标对资源更加友好。

例如，如果您有一个简单的 sprite 表，水平方向有 3 帧，每帧 32 像素 x 32 像素（总大小为 96x32），您将使用以下代码绘制第 3 帧：

```
// I assume you have bound your source texture
// This is the U coordinate's origin in texture space
float xStart = 64.0f / 96.0f;

// This is one frame width in texture space
float xIncrement = 32.0f / 96.0f;

glBegin(GL_QUADS);
  glTexCoord2f(xStart, 0);
  glVertex2f(-16.0f, 16.0f);

  glTexCoord2f(xStart, 1.0f);
  glVertex2f(-16.0f, -16.0f);

  glTexCoord2f(xStart + xIncrement, 0);
  glVertex2f(16.0f, 16.0f);

  glTexCoord2f(xStart + xIncrement, 1.0f);
  glVertex2f(16.0f, -16.0f);
glEnd(); 
```

# .net - WPF - 如何在属性为动态时实现 INotifyPropertyChanged

> ID：599267
> 
> 赞同：0
> 
> 时间：2009-03-01T04:48:03.097
> 
> 标签：.net, wpf

我有一个实现 PropertyObjects 集合的业务对象。

BusinessObject SomeCollection Property1Object（名称=高度） Property2Object（名称=宽度）

目前，我将 UserControl 的 DataContext 设置为 BusinessObject。我发现我可以使用类似这样的方式引用绑定中的集合，例如在文本框中..

UserControl.DataContext = BusinessObject UserControl.TextBlock **Text="{Binding Collection[Height].Value}"**

现在，我可以在什么级别正确实现 INotifyPropertyChanged，即使在更高级别它根本不是属性。

很容易看到并提升最低级别的 PropertyObject，但这足以让绑定起作用吗？

谢谢，杰夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T05:03:59.470

如果我对您的理解正确，则`Collection`数组中的每个对象都有一个名为 的属性`Value`，这就是`TextBlock`您的`UserControl`. 只要数组中的每个对象都实现`INotifyPropertyChanged`，并在值`Value`更改时触发事件，则应该更新中的文本`TextBlock`（您可能还需要更改`BindingMode`to `TwoWay`，不过我不确定）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T06:16:55.660

如果你是假的实现你自己的集合，你需要实现 INotifyCollectionChanged ( [http://msdn.microsoft.com/en-us/library/system.collections.specialized.inotifycollectionchanged.aspx](http://msdn.microsoft.com/en-us/library/system.collections.specialized.inotifycollectionchanged.aspx) )

# c# - 如何在 C# 中下载 HTML 源代码

> ID：599275
> 
> 赞同：115
> 
> 时间：2009-03-01T05:00:02.337
> 
> 标签：c#

如何在 C# 中获取给定网址的 HTML 源代码？

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-03-01T05:03:35.383

[`WebClient`您可以使用类](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)下载文件：

```
using System.Net;

using (WebClient client = new WebClient ()) // WebClient class inherits IDisposable
{
    client.DownloadFile("http://yoursite.com/page.html", @"C:\localfile.html");

    // Or you can get the file content without saving it
    string htmlCode = client.DownloadString("http://yoursite.com/page.html");
} 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-03-01T05:08:42.597

基本上：

```
using System.Net;
using System.Net.Http;  // in LINQPad, also add a reference to System.Net.Http.dll

WebRequest req = HttpWebRequest.Create("http://google.com");
req.Method = "GET";

string source;
using (StreamReader reader = new StreamReader(req.GetResponse().GetResponseStream()))
{
    source = reader.ReadToEnd();
}

Console.WriteLine(source); 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2017-01-21T10:45:31.680

**The newest, most recent, up to date answer**
*This post is really old (it's 7 years old when I answered it), so no one of the other answers used the new and recommended way, which is `HttpClient` class.*

* * *

`HttpClient` is considered the new API and it should replace the old ones (`WebClient` and `WebRequest`)

```
string url = "page url";
HttpClient client = new HttpClient();
using (HttpResponseMessage response = client.GetAsync(url).Result)
{
   using (HttpContent content = response.Content)
   {
      string result = content.ReadAsStringAsync().Result;
   }
} 
```

for more information about how to use the `HttpClient` class (especially in async cases), you can refer [this question](https://stackoverflow.com/a/33031778/4390133)

* * *

**NOTE 1: If you want to use async/await**

```
string url = "page url";
HttpClient client = new HttpClient();   // actually only one object should be created by Application
using (HttpResponseMessage response = await client.GetAsync(url))
{
   using (HttpContent content = response.Content)
   {
      string result = await content.ReadAsStringAsync();
   }
} 
```

* * *

**NOTE 2: If use C# 8 features**

```
string url = "page url";
HttpClient client = new HttpClient();
using HttpResponseMessage response = await client.GetAsync(url);
using HttpContent content = response.Content;
string result = await content.ReadAsStringAsync(); 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-01-15T14:40:22.790

您可以通过以下方式获取 HTML 源代码：

```
var html = new System.Net.WebClient().DownloadString(siteUrl) 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2011-01-20T18:11:03.690

@cms 方法是最新的，在 MS 网站上建议，但是我有一个很难解决的问题，两种方法都在这里发布，现在我为所有人发布解决方案！

**问题：** 如果您使用这样的网址：`www.somesite.it/?p=1500`在某些情况下，您会收到内部服务器错误（500），尽管在 Web 浏览器中这`www.somesite.it/?p=1500`完全可以工作。

**解决方案：** 您必须移出参数，工作代码是：

```
using System.Net;
//...
using (WebClient client = new WebClient ()) 
{
    client.QueryString.Add("p", "1500"); //add parameters
    string htmlCode = client.DownloadString("www.somesite.it");
    //...
} 
```

[这里官方文档](http://msdn.microsoft.com/en-us/library/system.net.webclient.querystring.aspx)

# wpf - 数据更改时获取机场显示类型转换

> ID：599279
> 
> 赞同：0
> 
> 时间：2009-03-01T05:02:04.140
> 
> 标签：wpf

客户要求显示器像机场显示屏一样闪烁，即当信息​​更改时，每一行都会闪烁。

我不确定哪个是最好的控件，或者让每一行一个接一个地转换的方法。

任何建议都会欣然接受

约翰

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-01T05:13:08.560

这是我在一般概念上会做的事情..

1.  制作一个常规面板，例如 50px 高。（这是任意的，但此面板仅将大小保持在适当位置，因此控件不会随其内容而缩小。）
2.  在该面板内创建一个面板，该面板将成为“动画”面板。
3.  当信息需要动画时，创建一个故事板，使用转换将高度“拉伸”到 0，将内容更改为更新的信息，然后将高度转换回 50px。这将产生面板正在翻转的错觉。

如果您将此控件设为用户控件，那么您只需将此控件所需的任何“行”添加到 StackPanel 以制作您的屏幕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T02:39:02.587

轻松表示这种效果的最佳方法是在更改期间随机化文本。

[Patrick Long在这里](https://blogs.charteris.com/blogs/patl-closed/archive/2006/08/14/Custom-Animation-Classes.aspx)将这个效果实现为自定义动画

# python - 如何使用 HTTP 重定向传递信息（在 Django 中）

> ID：599280
> 
> 赞同：20
> 
> 时间：2009-03-01T05:02:13.390
> 
> 标签：python, django, http

我有一个接受表单提交并更新模型的视图。

更新模型后，我想重定向到另一个页面，我希望在这个页面上出现“字段 X 更新成功”之类的消息。

我怎样才能将此消息“传递”到其他页面？HttpResponseRedirect 只接受一个[URL](http://en.wikipedia.org/wiki/Uniform_Resource_Locator)。我以前在其他网站上看到过这样做。这是如何实现的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-01T11:56:07.670

这是 Django 的一个内置功能，称为“消息”

请参阅[http://docs.djangoproject.com/en/dev/topics/auth/#messages](http://docs.djangoproject.com/en/dev/topics/auth/#messages)

从文档中：

> 消息与用户相关联。没有过期或时间戳的概念。
> 
> 成功操作后，Django 管理员会使用消息。例如，“投票 Foo 已成功创建。” 是一条消息。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-01T21:41:14.627

您可以使用 django-flashcookie 应用程序 [http://bitbucket.org/offline/django-flashcookie/wiki/Home](http://bitbucket.org/offline/django-flashcookie/wiki/Home)

它可以发送多条消息，并且有无限类型的消息。假设您想要一种用于警告的消息类型和一种用于错误消息的消息类型，您可以编写

```
def simple_action(request):
    ...
    request.flash['notice'] = 'Hello World'
    return HttpResponseRedirect("/") 
```

或者

```
def simple_action(request):
    ...
    request.flash['error'] = 'something wrong'
    return HttpResponseRedirect("/") 
```

或者

```
def simple_action(request):
    ...
    request.flash['notice'] = 'Hello World'
    request.flash['error'] = 'something wrong'
    return HttpResponseRedirect("/") 
```

甚至

```
def simple_action(request):
    ...
    request.flash['notice'] = 'Hello World'
    request.flash['notice'] = 'Hello World 2'
    request.flash['error'] = 'something wrong'
    request.flash['error'] = 'something wrong 2'
    return HttpResponseRedirect("/") 
```

然后在你的模板中显示它

```
{% for message in flash.notice %}
    {{ message }}
{% endfor }} 
```

或者

```
{% for message in flash.notice %}
    {{ message }}
{% endfor }}
{% for message in flash.error %}
    {{ message }}
{% endfor }} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-01-09T23:46:57.037

我喜欢使用消息框架的想法，但是 django 文档中的示例在上述问题的上下文中对我不起作用。

真正让我烦恼的是 django 文档中的一行：

`If you're using the context processor, your template should be rendered with a RequestContext. Otherwise, ensure messages is available to the template context.`

这对于新手（像我一样）来说是无法理解的，需要扩展，最好是使用这两个选项的样子。

我只能找到需要使用 RequestContext 进行渲染的解决方案......这不能回答上面的问题。

我相信我已经为下面的第二个选项创建了一个解决方案：

希望这会对其他人有所帮助。

== urls.py ==

```
from django.conf.urls.defaults import *
from views import *

urlpatterns = patterns('',
    (r'^$', main_page, { 'template_name': 'main_page.html', }, 'main_page'),
    (r'^test/$', test ), 
```

== viewtest.py ==

```
from django.contrib import messages
from django.http import HttpResponseRedirect
from django.core.urlresolvers import reverse

def test(request):
    messages.success( request, 'Test successful' )
    return HttpResponseRedirect( reverse('main_page') ) 
```

== viewmain.py ==

```
from django.contrib.messages import get_messages
from django.shortcuts import render_to_response

def main_page(request, template_name ):
    # create dictionary of items to be passed to the template
    c = { messages': get_messages( request ) }

    # render page
    return render_to_response( template_name, c, ) 
```

== main_page.html ==

```
{% block content %}
    {% if messages %}
    <div>
        {% for message in messages %}
            <h2 class="{{message.tag}}">{{ message.message }}</h2>
        {% endfor %}
    </div>
    {% endif %}
{% endblock %} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-01-02T19:26:34.933

我已阅读并检查了所有答案，在我看来，现在要走的路是使用[消息传递框架](https://docs.djangoproject.com/en/1.3/ref/contrib/messages/)。一些回复相当陈旧，并且在发布时可能是正确的方式。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-12-16T07:11:51.207

有很多解决方案

1 使用 Django-trunk 版本 - 它支持向匿名用户发送消息

2 节

```
def view1(request):
    request.session['message'] = 'Hello view2!'
    return HttpResponseRedirect('/view2/')

def view2(request):
    return HttpResponse(request.session['message']) 
```

3 使用参数重定向

```
return HttpResponseRedirect('/view2/?message=Hello+view2') 
```

4 饼干

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-01T05:40:29.773

您可以将消息作为查询参数传递给您要重定向到的 URL 吗？它不是非常 RESTy，但它应该可以工作：

```
return HttpResponseRedirect('/polls/%s/results/?message=Updated" % p.id) 
```

并让该视图检查消息参数，将其擦洗以防讨厌，并将其显示在顶部。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-03-23T07:37:42.023

我认为这段代码应该适合你

```
request.user.message_set.create(message="This is some message")
return http.HttpResponseRedirect('/url') 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T18:34:01.287

虽然到目前为止所有建议都有效，但我建议使用 Ry4an（在请求 URL 中传递它） - 只需将实际文本更改为预定义文本消息集中的编码文本。

这里有两个优点：

1.  通过清理不良内容进行黑客攻击的可能性较小
2.  如果需要，您可以稍后本地化您的消息。

其他与 cookie 相关的方法.. 好吧，如果浏览器不支持 cookie，它们就不起作用，而且稍微贵一些.. 但只是稍微贵一点。它们确实更干净。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-12-16T06:49:38.177

看看 Django 的消息框架。[http://docs.djangoproject.com/en/dev/ref/contrib/messages/#ref-contrib-messages](http://docs.djangoproject.com/en/dev/ref/contrib/messages/#ref-contrib-messages)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-20T22:30:21.437

您还可以将重定向 url 设置为已参数化视图的路径。

网址.py：

```
(r'^some/path/(?P<field_name>\w+)/$', direct_to_template,
    {'template': 'field_updated_message.html',
    },
    'url-name'
), 
```

视图.py：

```
HttpResponseRedirect( reverse('url-name', args=(myfieldname,)) ) 
```

注意 args= 需要一个元组。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-02-27T05:42:47.170

Pydev UA 使用的解决方案侵入性较小，无需修改代码中的任何内容即可使用。当您传递消息时，您可以在处理消息的视图中更新您的上下文，并在您的模板中显示它。

我使用了相同的方法，但是传递了一个简单的文本，而是传递了一个字典，其中包含对我有用的字段中的信息。然后在视图中，也更新了上下文，然后返回了带有更新后的上下文的渲染模板。

简单，有效且非常不引人注目。

# javascript - 跨浏览器窗口大小调整事件 - JavaScript / jQuery

> ID：599288
> 
> 赞同：240
> 
> 时间：2009-03-01T05:12:09.700
> 
> 标签：javascript, jquery, cross-browser, resize

[在 Firefox、 WebKit](http://en.wikipedia.org/wiki/WebKit)和 Internet Explorer中点击窗口调整大小事件的正确（现代）方法是什么？

你能打开/关闭两个滚动条吗？

* * *

## 回答 #1

> 赞同：369
> 
> 时间：2010-06-03T19:24:22.483

jQuery为此提供了一个[内置方法](http://api.jquery.com/resize/)：

```
$(window).resize(function () { /* do something */ }); 
```

为了 UI 响应，您可以考虑使用 setTimeout 仅在几毫秒后调用您的代码，如以下示例所示，受此[启发](http://snipplr.com/view/6284/jquery--window-on-resize-event/)：

```
function doSomething() {
    alert("I'm done resizing for the moment");
};

var resizeTimer;
$(window).resize(function() {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(doSomething, 100);
}); 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-07-28T14:34:11.420

```
$(window).bind('resize', function () { 

    alert('resize');

}); 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2013-09-11T15:27:51.333

这是利用 resize 事件的非 jQuery 方式：

```
window.addEventListener('resize', function(event){
  // do stuff here
}); 
```

它适用于所有现代浏览器。它不会**为**您节流任何东西。[这是它的一个例子](http://codepen.io/jondlm/pen/doijJ)。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-06-17T15:07:35.080

很抱歉提出一个旧线程，但如果有人不想使用 jQuery，你可以使用这个：

```
function foo(){....};
window.onresize=foo; 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-01T05:15:01.753

由于您对 jQuery 持开放态度，[因此这个插件](http://andowebsit.es/blog/noteslog.com/post/how-to-fix-the-resize-event-in-ie/)似乎可以解决问题。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-06-25T11:44:15.757

使用 jQuery 1.9.1 我刚刚发现，虽然技术上相同）*，但这在 IE10 中不起作用（但在 Firefox 中）：

```
// did not work in IE10
$(function() {
    $(window).resize(CmsContent.adjustSize);
}); 
```

虽然这在两种浏览器中都有效：

```
// did work in IE10
$(function() {
    $(window).bind('resize', function() {
        CmsContent.adjustSize();
    };
}); 
```

*编辑：*
)* 实际上在技术上**并不**相同，正如[WraithKenny](https://stackoverflow.com/users/387233/wraithkenny)和[Henry Blyth](https://stackoverflow.com/users/3150057/henry-blyth)的评论中所指出和解释的那样。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-09-02T08:22:40.910

`jQuery`默认提供`$(window).resize()`功能：

```
<script type="text/javascript">
// function for resize of div/span elements
var $window = $( window ),
    $rightPanelData = $( '.rightPanelData' )
    $leftPanelData = $( '.leftPanelData' );

//jQuery window resize call/event
$window.resize(function resizeScreen() {
    // console.log('window is resizing');

    // here I am resizing my div class height
    $rightPanelData.css( 'height', $window.height() - 166 );
    $leftPanelData.css ( 'height', $window.height() - 236 );
});
</script> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-03-07T16:00:30.367

我认为 jQuery 插件“jQuery resize event”是最好的解决方案，因为它负责限制事件，使其在所有浏览器中都能正常工作。它类似于 Andrews 的回答，但更好，因为您可以将调整大小事件挂钩到特定元素/选择器以及整个窗口。它为编写干净的代码开辟了新的可能性。

该插件可[在此处获得](http://benalman.com/code/projects/jquery-resize/docs/files/jquery-ba-resize-js.html)

如果添加大量侦听器会出现性能问题，但对于大多数用例来说它是完美的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-29T19:19:45.297

我认为您应该对此添加进一步的控制：

```
 var disableRes = false;
    var refreshWindow = function() {
        disableRes = false;
        location.reload();
    }
    var resizeTimer;
    if (disableRes == false) {
        jQuery(window).resize(function() {
            disableRes = true;
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(refreshWindow, 1000);
        });
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-11-13T09:41:54.157

**希望它对 jQuery 有帮助**

首先定义一个函数，如果有一个现有的函数跳到下一步。

```
 function someFun() {
 //use your code
 } 
```

浏览器调整大小使用这些。

```
 $(window).on('resize', function () {
    someFun();  //call your function.
 }); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-04-18T13:15:00.583

除了提到的窗口调整大小功能之外，重要的是要了解调整大小事件如果在没有消除事件的情况下使用会触发很多。

Paul Irish 有一个出色的功能，可以很好地消除 resize 调用。非常推荐使用。跨浏览器工作。前几天在IE8中测试过，一切都很好。

[http://www.paulirish.com/2009/throttled-smartresize-jquery-event-handler/](http://www.paulirish.com/2009/throttled-smartresize-jquery-event-handler/)

请务必[查看演示](http://www.paulirish.com/demo/resize)以查看差异。

这是完整性的功能。

```
(function($,sr){

  // debouncing function from John Hann
  // http://unscriptable.com/index.php/2009/03/20/debouncing-javascript-methods/
  var debounce = function (func, threshold, execAsap) {
      var timeout;

      return function debounced () {
          var obj = this, args = arguments;
          function delayed () {
              if (!execAsap)
                  func.apply(obj, args);
              timeout = null;
          };

          if (timeout)
              clearTimeout(timeout);
          else if (execAsap)
              func.apply(obj, args);

          timeout = setTimeout(delayed, threshold || 100);
      };
  }
  // smartresize 
  jQuery.fn[sr] = function(fn){  return fn ? this.bind('resize', debounce(fn)) : this.trigger(sr); };

})(jQuery,'smartresize');

// usage:
$(window).smartresize(function(){
  // code that takes it easy...
}); 
```

# java - 编写一个 firefox 插件并从 java 应用程序中访问它

> ID：599291
> 
> 赞同：1
> 
> 时间：2009-03-01T05:15:11.613
> 
> 标签：java, firefox, plugins

我想编写一个与 java 应用程序通信的 firefox 插件。该插件必须通知 Java 应用程序正在加载的网页/ url。Java 应用程序将负责其余的工作。

任何帮助或指示将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T06:32:56.013

我已经编写了几个 Firefox 插件来满足这个要求。

一种策略是在 Firefox 中使用 JavaScript 到 Java 的桥接，它允许使用 Java RMI。我发现这种方法缓慢且不稳定，而且多线程很痛苦。

我目前的解决方案是打开一个`localhost`套接字并使用文本协议进行通信。有关如何在 Firefox JavaScript 中使用套接字打开和读/写的信息，请参阅[XULPlanet 开发人员指南，](http://xulplanet.com/tutorials/mozsdk/sockets.php)了解如何使用 Firefox JavaScript 中的套接字打开和读/写，还有[关于 Java 中套接字的 Sun 教程](http://java.sun.com/docs/books/tutorial/networking/sockets/)。

我编写的一个插件（用于 Firefox 和 Eclipse）的源代码可在 X11 又名 MIT 许可下获得：[Firedoclipse source](http://people.csail.mit.edu/maxg/uid/firedoclipse/src/)。该`lib`目录下是一个名为 的组件`jsjr`，其中包含几个 Java 类和一个 JavaScript XPCOM 对象，用于实现 Java 和 JavaScript 之间的远程方法调用。该`test`目录包含一些单元测试。这种远程方法调用对于只向一个方向发送一种消息来说是多余的，但您可能会发现代码很有帮助。

# artificial-intelligence - 基于瓦片的博弈论

> ID：599295
> 
> 赞同：11
> 
> 时间：2009-03-01T05:18:26.037
> 
> 标签：artificial-intelligence, theory

我正在寻找有关基于瓷砖的游戏的文章，例如旧的 ultima 6 和 7，甚至是拼图海盗。具体来说：

1.  他们如何跟踪地图上的对象。其他角色、树木或角色可以移动的物体等物体。
2.  人物背后的人工智能。游戏如何处理地图上不在屏幕上的角色的角色行为。尤其是非常大的地图和众多的角色。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-01T06:26:18.337

我记得在我写一些游戏的时候查看了[Amit 的游戏开发页面。](http://www-cs-students.stanford.edu/~amitp/gameprog.html)他有一个很棒的关于瓷砖的小节，里面有你想要的大部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-01T06:08:12.157

您可以翻阅 Game Developer 杂志的过往刊物，看看是否有内容详细解决了您的问题。

对于 (1) 处理基于图块的地图（其中每个图块可以包含多个对象）的最简单方法是只拥有一个表示每个图块的大型多维结构数组。该结构包含一个指向链表头部的指针，该链表表示该图块中的所有对象。这非常节省内存，让您可以快速找到某个图块中的所有内容，同时还可以沿其他轴（例如，所有者、分配区域等）枚举它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-01T16:26:21.810

RogueBasin 致力于类似 Rogue 的游戏（例如 Rogue、NetHack、）。所有这些游戏都基于一个简单的方形网格。该网站有大量关于开发此类游戏的部分：[http ://roguebasin.roguelikedevelopment.org/index.php?title=Articles](http://roguebasin.roguelikedevelopment.org/index.php?title=Articles)

您将在那里找到可用于构建您所描述的游戏的建议和代码。毕竟，Rogue/Larn/NetHack/等之间唯一真正的区别。而暗黑破坏神或创世纪系列正在使用简单的文字字符来描绘地图和游戏玩法与等距精灵。

特别是，您会找到有关计算用户携带的手电筒或灯笼照明面积的信息、用于存储地图的数据结构、用于自动生成地图的算法，以及许多关于已编写的不同游戏如何选择解决的注释这些问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-01T07:38:44.420

查看[Gamasutra](http://www.gamasutra.com/)。他们有大量关于各种游戏开发的文章。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-01T05:23:51.200

该地图将是一个值数组。它可以分为离散的部分。只会加载播放器范围内的部分，并且这些部分中的对象和 npc 处于活动状态。

由于旧硬件的内存和 CPU 非常有限，这些游戏只能加载和处理部分地图。

# c# - 有没有什么方法可以用所有国家名称填充winforms中的组合框，以及用所选国家的城市填充另一个组合框？

> ID：599302
> 
> 赞同：3
> 
> 时间：2009-03-01T05:26:02.647
> 
> 标签：c#, winforms

Is there a build procedure in C# for making a combobox or list box that has names of all countries and when a country is selected another combobox is filled with the cities of that country?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-01T15:15:58.547

当然有程序。你可以从一个简单的数据结构开始：

```
public class Country
{
  public string Name { get; set; }
  public IList<City> Cities { get; set; }

  public Country()
  {
    Cities = new List<City>();
  }
}

public class City { public string Name { get; set; } } 
```

然后，实例化这个结构，例如到你的表单的一个属性中......

```
Countries =
  new List<Country>
    {
      new Country
        {
          Name = "Germany",
          Cities =
            {
              new City {Name = "Berlin"},
              new City {Name = "Hamburg"}
            }
        },
      new Country
        {
          Name = "England",
          Cities =
            {
              new City {Name = "London"},
              new City {Name = "Birmingham"}
            }
        }
    }; 
```

在您的表单中，实例化两个绑定源 (BS)：

*   第一个 BS 绑定到 Country 属性。
*   第二个 BS 绑定到第一个 (DataSource = firstBS) 并且它的 DataMember 应该是“Cities”。

现在你需要两个下拉菜单：

*   第一个：DataSource = 第一个 BS，DisplayMember = "Name"
*   第二：DataSource = 第二个 BS，DisplayMember = "名称"

你应该已经完成​​了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T05:47:52.250

没有这样的程序。我建议你制作一个组合框并与各国填充它，另一个在一个国家被选中。这样，您就可以完全控制组合框中出现的国家和城市。

# visual-studio - VS 2008 和 SQL Server 最少需要多少空间

> ID：599304
> 
> 赞同：0
> 
> 时间：2009-03-01T05:28:11.473
> 
> 标签：visual-studio

我正在准备笔记本电脑的新分区，所以我想知道完整安装这个开发环境需要多少空间。

自从我上次安装完整的 Visual Studio 环境以来已经过去很久了，所以我猜测这些天所需的最小空间约为 15 GB。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T05:32:44.177

答案取决于分区是否也需要保存数据。您打算创建的数据库有多大，Visual Studio 项目的数量和大小是多少？您要安装哪些语言，您将安装哪些 SDK？您需要完整的 MSDN 库吗？

如果你打算做真正的工作，至少分配 50GB，最好是 100GB。有很多东西可以积累。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T10:01:22.050

我用一个小的可引导分区运行我的主服务器，它有 XP、VS2008、SQL 2005 以及一些其他工具，它的容量为 11G。

# c++ - 在 C++ 中正确使用堆栈和堆？

> ID：599308
> 
> 赞同：126
> 
> 时间：2009-03-01T05:32:24.393
> 
> 标签：c++, memory-management, stack, heap-memory, c++-faq

我已经编程了一段时间，但主要是 Java 和 C#。我从来没有真正需要自己管理内存。我最近开始使用 C++ 进行编程，对于何时应该将内容存储在堆栈中以及何时将它们存储在堆中感到有些困惑。

我的理解是，经常访问的变量应该存放在栈和对象上，很少使用的变量，大数据结构都应该存放在堆上。这是正确的还是我不正确？

* * *

## 回答 #1

> 赞同：245
> 
> 时间：2009-03-01T05:47:50.583

不，堆栈和堆之间的区别不是性能。它的生命周期：函数内的任何局部变量（任何你不使用 malloc() 或 new 的变量）都存在于堆栈中。当您从函数返回时，它会消失。如果您希望某些东西比声明它的函数寿命更长，则必须在堆上分配它。

```
class Thingy;

Thingy* foo( ) 
{
  int a; // this int lives on the stack
  Thingy B; // this thingy lives on the stack and will be deleted when we return from foo
  Thingy *pointerToB = &B; // this points to an address on the stack
  Thingy *pointerToC = new Thingy(); // this makes a Thingy on the heap.
                                     // pointerToC contains its address.

  // this is safe: C lives on the heap and outlives foo().
  // Whoever you pass this to must remember to delete it!
  return pointerToC;

  // this is NOT SAFE: B lives on the stack and will be deleted when foo() returns. 
  // whoever uses this returned pointer will probably cause a crash!
  return pointerToB;
} 
```

为了更清楚地了解堆栈是什么，请从另一端开始——不要试图理解堆栈在高级语言方面的作用，而是查找“调用堆栈”和“调用约定”，看看是什么当你调用一个函数时，机器真的会这样做。计算机内存只是一系列地址；“堆”和“栈”是编译器的发明。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-03-01T08:11:57.710

我会说：

如果可以，将其存储在堆栈中。

如果需要，将其存储在堆上。

因此，更喜欢堆栈而不是堆。您无法在堆栈上存储某些内容的一些可能原因是：

*   它太大了——在 32 位操作系统上的多线程程序上，堆栈具有很小且固定的（至少在线程创建时）大小（通常只有几兆。这样您就可以创建大量线程而不会耗尽地址空间。对于 64 位程序或单线程（无论如何是 Linux）程序，这不是主要问题。在 32 位 Linux 下，单线程程序通常使用动态堆栈，该堆栈可以不断增长，直到达到堆顶。
*   您需要在原始堆栈框架的范围之外访问它——这确实是主要原因。

使用合理的编译器，可以在堆上分配非固定大小的对象（通常是在编译时大小未知的数组）。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-03-01T09:56:44.820

它比其他答案建议的更微妙。根据您声明的方式，堆栈上的数据和堆上的数据之间没有绝对的区别。例如：

```
std::vector<int> v(10); 
```

在函数体中，它`vector`在堆栈上声明了一个由十个整数组成的（动态数组）。但是由 管理的存储`vector`不在堆栈上。

啊，但是（其他答案表明）该存储的生命周期受`vector`自身生命周期的限制，这里是基于堆栈的，因此它的实现方式没有区别 - 我们只能将其视为基于堆栈的对象具有价值语义。

不是这样。假设函数是：

```
void GetSomeNumbers(std::vector<int> &result)
{
    std::vector<int> v(10);

    // fill v with numbers

    result.swap(v);
} 
```

因此，任何具有`swap`函数（以及任何复杂值类型都应该具有函数）的东西都可以作为对某些堆数据的一种可重新绑定的引用，在保证该数据的单一所有者的系统下。

因此，现代 C++ 方法*永远不会*将堆数据的地址存储在裸本地指针变量中。所有堆分配都必须隐藏在类中。

如果这样做，您可以将程序中的所有变量都视为简单的值类型，而完全忘记堆（除非为某些堆数据编写新的类似值的包装类，这应该是不寻常的） .

你只需要保留一点特殊的知识来帮助你优化：在可能的情况下，而不是像这样将一个变量分配给另一个变量：

```
a = b; 
```

像这样交换它们：

```
a.swap(b); 
```

因为它更快并且不会抛出异常。唯一的要求是您不需要`b`继续保持相同的值（它将获得`a`' 的值，这将被丢弃在 中`a = b`）。

缺点是这种方法迫使您通过输出参数而不是实际的返回值从函数返回值。但是他们在 C++0x 中使用[rvalue references](http://www.open-std.org/JTC1/sc22/wg21/docs/papers/2004/n1690.html)修复了这个问题。

在最复杂的情​​况下，您会将这个想法发挥到极致，并使用智能指针类，例如`shared_ptr`已经在 tr1 中的类。（尽管我认为如果您似乎需要它，那么您可能已经超出了标准 C++ 的适用范围。）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-01T05:49:30.140

如果项目需要在创建它的函数范围之外使用，您也可以将项目存储在堆上。与堆栈对象一起使用的一个习惯用法称为 RAII - 这涉及使用基于堆栈的对象作为资源的包装器，当对象被销毁时，资源将被清理。基于堆栈的对象更容易跟踪您何时可能引发异常 - 您无需担心在异常处理程序中删除基于堆的对象。这就是为什么现代 C++ 通常不使用原始指针的原因，您可以使用智能指针，它可以是基于堆栈的包装器，用于指向基于堆的对象的原始指针。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-01T07:46:25.897

为了增加其他答案，它也可能与性能有关，至少是一点点。除非它与您相关，否则您不应该担心这一点，但是：

在堆中分配需要找到一个跟踪内存块，这不是一个恒定时间的操作（并且需要一些周期和开销）。随着内存碎片化和/或您接近使用 100% 的地址空间，这可能会变慢。另一方面，堆栈分配是恒定时间的，基本上是“免费”操作。

要考虑的另一件事（同样，只有当它成为问题时才真正重要）是通常堆栈大小是固定的，并且可以远低于堆大小。因此，如果您要分配大对象或许多小对象，您可能希望使用堆；如果您用完堆栈空间，运行时将抛出站点名义异常。通常没什么大不了的，但要考虑另一件事。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-12-27T23:16:56.293

堆栈更高效，更易于管理范围数据。

**但是堆应该用于大于*几*KB**的任何东西（这在 C++ 中很容易，只需`boost::scoped_ptr`在堆栈上创建一个来保存指向已分配内存的指针）。

考虑一个不断调用自身的递归算法。很难限制或猜测总堆栈使用量！而在堆上，分配器 ( `malloc()`or `new`) 可以通过返回`NULL`or来指示内存不足`throw`。

**来源**: 堆栈不大于 8KB 的 Linux 内核！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-01-25T09:22:22.493

**为了完整起见，您可以阅读 Miro Samek 关于在嵌入式软件**上下文中使用堆的问题的文章。

[一堆问题](http://embeddedgurus.com/state-space/2010/01/heap-of-problems/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-01T05:48:01.940

是在堆上分配还是在堆栈上分配是为您做出的选择，具体取决于变量的分配方式。如果您使用“新”调用动态分配某些内容，则您是从堆中分配的。如果您将某些东西分配为全局变量，或者作为函数中的参数，则它会在堆栈上分配。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-01T09:15:55.683

在我看来，有两个决定因素

```
1) Scope of variable
2) Performance. 
```

在大多数情况下，我更喜欢使用堆栈，但如果您需要访问范围外的变量，您可以使用堆。

为了在使用堆时提高性能，您还可以使用创建堆块的功能来帮助获得性能，而不是将每个变量分配到不同的内存位置。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-21T10:41:21.790

可能这已经得到了很好的回答。我想向您指出以下系列文章，以更深入地了解底层细节。Alex Darby 有一系列文章，他将通过调试器引导您完成。这是关于堆栈的第 3 部分。 [http://www.altdevblogaday.com/2011/12/14/cc-low-level-curriculum-part-3-the-stack/](http://www.altdevblogaday.com/2011/12/14/c-c-low-level-curriculum-part-3-the-stack/)

# java - 使用 Web 浏览器收集系统属性

> ID：599310
> 
> 赞同：0
> 
> 时间：2009-03-01T05:32:43.880
> 
> 标签：java, ajax, ajaxcontroltoolkit, ajax.net

您好我正在做分布式计算环境。对于需要分发到网络中连接到服务器的不同客户端的应用程序，我更喜欢收集客户端的系统属性，例如客户端系统中可用的可用内存，以便我可以有效地分发应用程序。请给我一些好主意。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-01T06:14:10.830

由于您已使用 Java 标记此内容，因此我假设您使用的是基于 Java 的客户端服务器模型。这里的客户端和服务器之间的通信模型是什么？RMI？一些专有协议？或者它是在浏览器中运行的基于 Java 小程序的应用程序？

基于澄清更新：在这种情况下，您可以随时收集小程序代码中的系统属性并将它们发送回服务器（也许通过使用 servlet？）

# pdf - 用于收集数据并填充到可填写 PDF 的基于 Web 的表单

> ID：599315
> 
> 赞同：0
> 
> 时间：2009-03-01T05:36:06.460
> 
> 标签：pdf

是否有任何人可以建议的脚本允许我创建基于 HTML 或 PHP Web 的表单来收集数据并保存该数据。调用要填充到可填写 pdf 中的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T22:08:32.730

如果您有一个想要填充的现有 PDF，并且该 PDF 只有文本字段（没有复选框或单选按钮），那么[CAM::PDF](http://search.cpan.org/dist/CAM-PDF)可能会为您提供帮助。您可以直接将其用作 Perl 库，或使用其[命令行界面](http://search.cpan.org/perldoc?fillpdffields.pl)。但是，CAM::PDF 对于从头开始生成 PDF 没有用处。此外，如果您有嵌入字体，那么您需要确保您计划插入的所有字符都以嵌入字体表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T09:01:26.873

Use a normal web page to get the data. If not sure how to do it, look for "php forms" on google, there are plenty of tutorials.

Then use a php pdf generator, like [this one](http://www.fpdf.org/), to create the PDF file. If you look hard enough, you will probably find a pdf generator that will let you use a template with placeholders where the entered data should be.

# c++ - 如何在 C++ 中获取系统时间？

> ID：599321
> 
> 赞同：6
> 
> 时间：2009-03-01T05:42:43.730
> 
> 标签：c++

事实上，我正在尝试计算一个函数在我的程序中完成所需的时间。所以我使用逻辑来获取我调用函数时的系统时间和函数返回值的时间，然后通过减去我得到的完成时间的值。因此，如果有人能告诉我一些更好的方法，或者只是如何在某个实例上获取系统时间，那将是非常有帮助的

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-01T05:56:22.357

我在为我的代码计时时使用的方法是 time() 函数。[它返回一个代表时代](http://en.wikipedia.org/wiki/Unix_time)的数值给你，这使得减法部分更容易计算。

相关代码：

```
#include <time.h>
#include <iostream>

int main (int argc, char *argv[]) {

int startTime, endTime, totalTime;

startTime = time(NULL);

/* relevant code to benchmark in here */

endTime = time(NULL);

totalTime = endTime - startTime;

std::cout << "Runtime: " << totalTime << " seconds.";

return 0;
} 
```

请记住，这是用户时间。对于 CPU，时间见 Ben 的回复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-01T06:10:37.907

您的问题完全取决于您使用的是哪个系统。每个系统都有自己的获取当前时间的功能。要了解系统运行了多长时间，您需要访问“高分辨率性能计数器”之一。如果您不使用性能计数器，您通常会被限制在微秒精度（或更差），这在分析函数的速度时几乎没有用处。

在 Windows 中，您可以通过“QueryPerformanceCounter()”函数访问计数器。这将返回一个在每个处理器上都不同的任意数字。要找出计数器中有多少滴答声 == 1 秒，请调用“QueryPerformanceFrequency()”。

如果您在 Windows 以外的平台下编码，只需 google 性能计数器和您正在编码的系统，它应该会告诉您如何访问该计数器。

***编辑（澄清）***
这是 c++，只包含 windows.h 并导入“Kernel32.lib”（似乎已删除我的超链接，请查看以下文档：http: [//msdn.microsoft.com/en-us/library /ms644904.aspx](http://msdn.microsoft.com/en-us/library/ms644904.aspx)）。对于 C#，您可以使用“System.Diagnostics.PerformanceCounter”类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T05:48:46.383

您可以使用[time_t](http://en.wikipedia.org/wiki/Time_t)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T10:06:02.130

在 Linux 下，尝试`gettimeofday()`微秒分辨率或`clock_gettime()`纳秒分辨率。

（当然，实际时钟的分辨率可能更粗糙。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-05T21:07:44.837

在某些系统中，您无权访问 time.h 标头。因此，您可以使用以下代码片段来了解您的程序运行需要多长时间，精确到秒。

```
void function()
{
time_t currentTime;
time(&currentTime);
int startTime = currentTime;

   /* Your program starts from here */

  time(&currentTime);
  int timeElapsed = currentTime - startTime;

  cout<<"It took "<<timeElapsed<<" seconds to run the program"<<endl;

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-29T18:42:16.470

您可以使用此处描述的 std::chrono 解决方案：[在 C++ 中获得准确的执行时间（微秒）](https://stackoverflow.com/questions/21856025/getting-an-accurate-execution-time-in-c-micro-seconds)，您的测量精度将更高。通常我们以毫秒 (ms) 甚至微秒 (us) 为单位测量代码执行情况。

```
#include <chrono>
#include <iostream>

...
[YOUR METHOD/FUNCTION STARTING HERE]

auto start = std::chrono::high_resolution_clock::now();

[YOUR TEST CODE HERE]

auto elapsed = std::chrono::high_resolution_clock::now() - start;

long long microseconds = std::chrono::duration_cast<std::chrono::microseconds>(elapsed).count();

std::cout << "Elapsed time: " << microseconds << " ms; 
```

# android - 如何在 Android EditText 中进行提示包装？

> ID：599324
> 
> 赞同：9
> 
> 时间：2009-03-01T05:46:30.210
> 
> 标签：android, android-edittext

我的`EditText`提示没有包装。如果最后一部分被切断，提示不是很有用。我对限制/强制我的`EditText`盒子尺寸非常谨慎，以确保无论屏幕尺寸如何，它看起来都不错。

以下是相关 XML 的样子：

```
 <EditText android:id="@+id/ET1" 
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content"
        android:gravity="left"
        android:hint="@string/Hint1" 
        android:lines="3">
    </EditText> 
```

我已经着手`android:lines="3"`解决这个问题，但这还不够。为了最大化与各种屏幕尺寸的兼容性，我更喜欢 OS 包裹我，在字符串中放入换行符和硬返回。视图中还发生了其他事情，这也迫使我不要手动设置框的宽度以促进良好的休息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-23T00:15:40.720

也许您使用的是旧版本的 SDK？

我已经验证了以下提示在 Android 1.5 纸杯蛋糕中包含 3 行没有任何问题：

```
 <EditText
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="18px"
        android:gravity="left"
        android:hint="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse egestas ullamcorper facilisis." /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-03-27T11:44:44.320

将此添加到 EditText

```
android:inputType="textMultiLine" 
```

# eclipse - PDT 2.0 和 Eclipse 3.4.2 有任何问题吗？

> ID：599325
> 
> 赞同：1
> 
> 时间：2009-03-01T05:47:34.873
> 
> 标签：eclipse, eclipse-pdt, ganymede

我刚刚安装了带有 PDT 2.0 的 Eclipse 3.4.2，从 PHP 的角度来看，我似乎看不到项目中的任何文件。当我切换到 J2EE 视图时，我可以很好地看到项目中的所有文件。

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T10:44:27.983

您的“错误日志”视图报告了什么？( `Help > About > Configuration Details > View Error Log`)

（或者你在`<workspace>/.metadata/.log`文件中看到了什么）

PDT2.0[报告了许多问题](http://dev.eclipse.org/newslists/news.eclipse.tools.pdt/msg03464.html)。
y 是 PDT2.0.1 或一个早期的[2.1 版本](http://dev.eclipse.org/newslists/news.eclipse.tools.pdt/msg03474.html)可能已经解决了一些问题，但这应该使用[Galileo (3.5Mx) 的早期版本](http://dev.eclipse.org/newslists/news.eclipse.tools.pdt/msg03480.html)而不是 GanyMalede 进行测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-06T17:08:20.157

PDT 就像 eclipse Galileo 的魅力一样。我强烈建议您切换

# facebook - Facebook Connect 无法验证

> ID：599334
> 
> 赞同：3
> 
> 时间：2009-03-01T05:52:51.037
> 
> 标签：facebook, validation, xml-namespaces

我正在尝试让我的 Facebook Connect 代码进行验证，但它不会。我认为问题在于他们的 xmlns 页面没有加载。我有代码：

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml" xml:lang="en" lang="en"> 
```

但是没有找到[http://www.facebook.com/2008/fbml 。](http://www.facebook.com/2008/fbml)有人有它应该是什么的副本吗？我应该使用不同的 URL 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-01T06:02:41.997

XML 命名空间不需要实际存在，它们只是限定元素和属性的一种方式。如果您有兴趣（这与您的问题无关），这里有更多关于 XML 命名空间[的信息](http://www.w3.org/TR/REC-xml-names/)

Facebook 似乎在这里有一个非常简单的页面设置：[FB Connect](http://wiki.developers.facebook.com/index.php/Trying_Out_Facebook_Connect)，它是一步一步布局的。你检查过这个吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T13:32:09.477

如前所述，命名空间 URL 是一个红鲱鱼。验证的是 DTD（在 DOCTYPE 中指定）。

如果您真的想验证使用 XFBML 的页面，则需要针对自定义 DTD 进行验证。而且，据我所知，Facebook 自己不会为 XFBML 发布 DTD，因此您必须自己编写一个（可能仅针对您实际使用的元素/属性）。

它实际上并不像听起来那么棘手。[这是一篇关于如何针对自定义 DTD 进行验证的**A List Apart**](http://www.alistapart.com/articles/customdtd/)文章。

另请注意，弄乱您的 DOCTYPE 声明可能会在将（旧）浏览器敲入怪癖模式方面做一些有趣的事情。

所以你可以让它验证；是否值得麻烦取决于您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-21T15:01:31.403

XFBML - 为什么它们必须不同？直到几年后，没有人愿意就此向他们请愿，然后 W3C 将重新编写他们的标准以包含 XFBML，否则 Facebook 将被迫以更兼容的格式重新编写。为什么不使用 ID 或 rel 属性来使他们的脚本工作？这将允许 100% 有效的格式与所有浏览器和 CMS 配合使用。也许他们担心没有 root 访问权限的博客页面会制造基于 FB 的骗局？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T09:23:05.170

Facebook XHTML 不验证。

# c++ - 头文件中类的私有成员的链接器错误

> ID：599335
> 
> 赞同：1
> 
> 时间：2009-03-01T05:54:12.143
> 
> 标签：c++, include, header, linker

我正在尝试在 Visual Studio 2008 中构建一个项目。我遇到了一堆真正困扰我的链接器错误。我的应用程序是仅使用本机 ANSI C++ 的 Win32 控制台应用程序。

它们都是相同模式的链接器错误。链接器错误与我在自己的头文件中定义的类的每个私有静态数据成员有关。

我猜这可能是我还不知道的 c++ 的一个简单事实？

示例：我在文件Delays.cpp 中的SingleDelay 成员类的函数定义中引用SingleDelay 的成员。IE：

```
SingleDelay::tick(void *output, void *input, int nbufferFrames)<br>{
   //.. code here<br>
   x = dry * castInput + wet * castInput;<br>
} 
```

错误 38 错误 LNK2001：无法解析的外部符号“私有：静态双 SingleDelay::dry”（？dry@SingleDelay@@0NA）Delays.obj testall

Delays.h中SingleDelay的定义：

```
class SingleDelay{

    private:  
        static double dry; //% of dry signal<br>
        static double wet; //% of wet signal<br>
        static unsigned int delay; //Delay in milliseconds<br>
        static int delayCell; //Index in the delayBuffer of the delay to add<br>
        static double *delayBuffer; //Delay buffer is 1 second long at sample rate SAMPLE_RATE<br>
        static unsigned int bufferCell; //Pointer to the current delay buffer cell<br>

    public:

        //Tick function
        static void tick(void *output, void *input,int nBufferFrames);

        //Set and Get functions
        static void setSingleDelay(double tDry, double tWet, unsigned int tDelay);
        static void setSingleDelay(void);

        static void setDry(double tDry);
        static void setWet(double tWet);
        static void setDelay(unsigned int tDelay);

        static double getDry(){ return dry;}
        static double getWet(){ return wet;}
        static unsigned int getDelay(){ return delay;}

        static void initializeDelayBuffer(){
            destroyDelayBuffer();

            delayBuffer = new double[bufferLength];
        }
        static void destroyDelayBuffer(){
            delete[ ] delayBuffer;
        }
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-01T09:15:47.167

> 它们都是相同模式的链接器错误。链接器错误与我在自己的头文件中定义的类的每个私有静态数据成员有关。

**所有**静态数据成员都**必须**在 .cpp 文件中的*某处*有定义。

> 错误 38 错误 LNK2001：无法解析的外部符号“私有：静态双 SingleDelay::dry”（？dry@SingleDelay@@0NA）Delays.obj testall

链接器告诉您该变量没有定义的存储。此行**必须**恰好出现在一个 .cpp 文件中的某处：

```
double SingleDelay::dry = 0.0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T06:49:53.663

1.  也许您还没有添加库并将您使用的库的路径包含到项目定义中？
2.  C++ 错误总是很有趣。或不。无论如何，您是否在任何地方初始化静态变量？您需要在某处的 .cpp 文件中执行此操作。记住要小心使用静态变量。它们实际上是变相的全局变量，并且可以使将来的更改（例如多线程）更加困难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T06:00:07.777

您需要将 .cpp 和 .h 文件添加到 .vcproj 文件中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-30T07:34:27.423

也许错误存在于您的静态字段可见范围内，因为它们是私有的。尝试编写在类定义中使用您的私有静态字段的代码，而不是超出您的类。仅在您的类定义中编写此方法：

```
class SingleDelay{
 ...
int tick(void *output, void *input, int nbufferFrames)
{ //.. code here
x = dry * castInput + wet * castInput;
}
 ...
} 
```

# git - 程序化 git 状态

> ID：599341
> 
> 赞同：12
> 
> 时间：2009-03-01T06:00:23.970
> 
> 标签：git

有谁知道 git 管道（绝对不是瓷器）确定是否：

*   自上次提交以来，回购中有编辑，并且
*   本地 HEAD 是否超前 origin/HEAD

我希望以编程方式确定这一点，因此不想用瓷器和各种 sed-fu 来解决这个问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-01T09:51:40.980

更新：正如[以下](https://stackoverflow.com/a/17517443/6309)toupeira[所述](https://stackoverflow.com/users/132312/toupeira)，您可以使用[git status](http://git-scm.com/docs/git-status)`--porcelain`选项（自提交 6f15787，2009 年 9 月，git 1.7.0 起）。

我在回答“[瓷器一词在 Git 中是什么意思？](https://stackoverflow.com/a/6978402/6309) ”中提到：

> 或许`--porcelain`这里的意思是“出品适合瓷文消费”

**但是，这不会显示前面/后面的信息**：请参阅“[添加什么到“git status --porcelain”以使其表现得像“git status”？](https://stackoverflow.com/q/19206816/6309) ”：为此，您仍然需要使用其他命令：参见《[如何知道git仓库有没有与服务器同步的变化？](https://stackoverflow.com/a/6133968/6309)》

* * *

初步答案 2009 年 3 月

在瓷器命令中，a：

```
$ git diff HEAD 
```

为您提供自上次提交以来的更改（如果您运行“git commit -a”，您将提交什么）。

管道命令中可能的等价物是：

```
$ git ls-files -m 
```

用于列出所有修改的（工作目录或索引）文件

* * *

如果您通过克隆其他人的存储库来创建存储库，则远程“master”分支将被复制到名为“origin”的本地分支。您将获得自己的“主”分支，该分支未绑定到远程存储库。

总是有一个当前的头，称为 HEAD。（这实际上是一个符号链接，.git/HEAD，指向像 refs/heads/master 这样的文件。）

运行“git status”并分析输出：

```
# On branch master
# Your branch is ahead of 'origin/master' by 11 commits.
# 
```

SO 问题中的更多详细信息“[为什么 Git 告诉我“您的分支比 'origin/master' 领先 11 次提交。” 以及如何让它停止？](https://stackoverflow.com/questions/277077/why-is-git-telling-me-your-branch-is-ahead-of-origin-master-by-11-commits-and) ”

管道命令中可能的等效项：

```
* git-for-each-ref 
```

用于列出所有提交，但也需要分析输出......

同样，[git ls-files 可用于产生与 git status 相同的结果](http://www.jukie.net/~bart/blog/20070831142646)。

```
git ls-files --exclude-per-directory=.gitignore --exclude-from=.git/info/exclude \
                    --others \
                    --modified \
                    -t 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-07T23:37:48.687

`git status`现在有一个`--porcelain`用于脚本目的的参数（以及`-z`用于机器解析的替代方法），这是首选`git ls-files`不显示添加到索引的文件。

# cocoa - 在核心数据模型中存储 NSImage

> ID：599344
> 
> 赞同：7
> 
> 时间：2009-03-01T06:04:37.187
> 
> 标签：cocoa, core-data, cocoa-bindings, nstableview, nsimage

在核心数据模型中存储 NSImage 的正确方法是什么？我假设向实体添加属性并为其指定“二进制”类型应该可以工作，但它不起作用。我有一个包含 NSImageCells 列的表，它没有显示任何内容。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-02T04:24:48.760

如果您可以在 10.5+ 中工作，最简单的方法是将`NSImageRep`图像的 s 存储在“Transformable”属性中。默认情况下，可转换属性使用 NSCoding 在设置时存档其值并在访问时取消存档。这使您不必编写自定义 getter/setter。如果你想变得花哨，你可以编写一个自定义`NSValueTransformer`，将图像转换为其表示的 acrhived 版本，反之亦然。如果您使用的是 10.4，那么您必须编写自定义 getter/setter（请参阅 Apple 的有关创建[非标准持久属性](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CoreData/Articles/cdNSAttributes.html#//apple%5Fref/doc/uid/TP40001919-SW1)`NSImage`的文档。您可以通过发送`-representations`消息来获取图像的图像代表。

如果您想通过绑定在 UI 中显示图像，您还应该阅读Cocoa 绑定编程主题的[使用绑定显示图像](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaBindings/Tasks/images.html)部分。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-01T12:46:03.167

这不能回答您提出的确切问题，但根据您存储的图像数量，仅存储图像的路径或 URL、保存在您自己的位置并根据需要加载它们会更有效。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-01T06:40:25.853

您需要为其创建一个 NSData 表示。

看看[Non-Standard Persistent Attributes](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CoreData/Articles/cdNSAttributes.html#//apple_ref/doc/uid/TP40001919-SW1)。尤其是可转换属性和自定义代码下的部分，如果这不能解决您的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-20T19:26:39.090

这是一个非常简单的实现

[http://objectivesheep.com/blog/nsimage_coredata/](http://objectivesheep.com/blog/nsimage_coredata/)

# .net - NHibernate 一对多与加入子类

> ID：599348
> 
> 赞同：0
> 
> 时间：2009-03-01T06:07:15.480
> 
> 标签：.net, nhibernate

以前从来没有在这里问过问题，我会尽量简洁地提出这个问题。

我有一个食谱类，其中包含三种不同类型的成分使用列表。这些类都继承自基类 IngredientUse。所以映射看起来像这样：

```
 <class name="IngredientUse" table="IngredientUses">
    <id name="Id" type="Int64" column="Id">
      <generator class="native"/>
    </id>
    <!--some other properties-->
    <property name="RecipeId" column="RecipeId"/>
    <joined-subclass name="AdditionUse" table="AdditionUses">
      <key column="Id" foreign-key="FK_AdditionUses_IngredientUses"/>
      <many-to-one name="AdditionUsed" column="AdditionUsed" class="Addition" foreign-key="FK_AdditionUses_Additions"/>
    </joined-subclass>
  </class> 
```

这里引起问题的是RecipeId。从配方中，我有三个不同成分类型的单独用途列表，定义如下：

```
<bag name="AdditionsUsed" cascade="all" lazy="false">
  <key column="RecipeId"/>
  <one-to-many class="AdditionUse"/>
</bag> 
```

现在，我在尝试加载这些列表时遇到了问题。它与继承有关。当我查看生成的 SQL 时，我看到：

```
SELECT additionsused0_.RecipeId as RecipeId1_
--other columns not really important
FROM AdditionUses additionsused0_ 
inner join IngredientUses additionsused0_1_ 
on additionsused0_.Id=additionsused0_1_.Id 
WHERE additionsused0_.RecipeId=@p0; @p0 = '11' 
```

请注意，它“在子类”表中查找 RecipeId，而不是实际包含该列的基表。我知道我可以为每种成分类型定义一个单独的表，但这会给我带来问题，因为在某些情况下（即定价）我不需要子类表中的其他列，并且希望能够一次将所有成分加载到同一个列表中。

我确定我一定在这里遗漏了一些东西，认为这个网站上更熟悉 NHibernate 的人可能会马上认出它。

提前致谢。

**编辑：**如果我不清楚我想要做什么，这张图可能会有所帮助（请原谅我的劣质UML，希望它不会弄乱水域）。还有一个成分基类，以及与之相同的子类型。

![图表](https://farm4.static.flickr.com/3565/3319584915_ac1a3ce005.jpg?v=0)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T06:24:35.737

这是预期的行为，关键标签是“多”侧引用“一”的列的名称......

在纸上创建表格，您会看到如果您希望您的成分有很多添加，您需要在添加表中添加一列。

顺便说一句，永远不要直接映射您的 id，而是使用多对一映射实体

# c - 将数据提供给需要文件名的 C API

> ID：599358
> 
> 赞同：3
> 
> 时间：2009-03-01T06:12:57.200
> 
> 标签：c, api, posix, named-pipes, mkfifo

我正在 Linux 上编写一个简单的 C 程序，并希望使用现有库的 API，该 API 需要来自文件的数据。我必须将文件名作为 const char* 提供给它。但是我有数据，就像文件的内容一样，已经位于堆上分配的缓冲区中。有大量的 RAM，我们想要高性能。想要避免将临时文件写入磁盘，以看起来像文件的方式将数据提供给此 API 的好方法是什么？

这是我的代码的廉价假装版本：

奇妙图书馆.h：

```
int marvelousfunction(const char *filename); 
```

normal-persons-usage.cpp，最初为其设计的库：

```
#include "marvelouslibrary.h"
int somefunction(char *somefilename)
{
    return marvelousfunction(somefilename);
} 
```

我的程序.cpp：

```
#include "marvelouslibrary.h"
int one_of_my_routines() 
{
    byte* stuff = new byte[1000000];
    // fill stuff[] with...stuff!
    // stuff[] holds same bytes as might be found in a file

    /* magic goes here: make filename referring to stuff[] */

   return marvelousfunction( ??? );
} 
```

需要明确的是，marvelouslibrary 不提供任何通过指针接受数据的 API 函数。它只能读取一个文件。

我想到了管道和 mkfifo()，但似乎是为了在进程之间进行通信。我不是这些事情的专家。命名管道是否可以在同一进程中读取和写入？这是明智的做法吗？

或者跳过聪明，使用计划“B”，即shddup并只写一个临时文件。但是，除了获得高性能之外，我想学习一些新东西并找出在这种情况下可能发生的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-01T18:46:12.333

鉴于您可能具有以下功能：

```
char *read_data(const char *fileName) 
```

我认为您将需要“跳过聪明，采用计划“B”，即关闭并编写一个临时文件。”

如果您可以挖掘并找出您正在进行的调用是否正在调用另一个函数，该函数采用 File * 或 int 作为文件描述符，那么您可以做得更好。

一个想法确实浮现在脑海中，您可以将代码写入内存映射文件而不是堆吗？这样你就可以在磁盘上已经有一个文件了，你可以避免复制（尽管它仍然在磁盘上），你仍然可以给函数调用文件名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T06:41:28.160

我不确定库函数想要什么样的输入……它需要路径/文件名，还是打开文件指针，还是打开文件描述符？

如果您不想破解库并且函数需要字符串（文件路径），请尝试在 /dev/shm 中创建临时文件。

否则，mmap 可能是最好的选择，请务必在使用 mmap() 时研究 posix_madvise() （或者如果使用临时文件，则研究其对应的 posix_fadvise() ）。

看起来您一开始就在谈论很少的数据，所以我认为无论您采取什么方式，您都不会看到性能影响。

**编辑**

抱歉，我刚刚重新阅读了您的问题..也许我读得太快了。您无法提供以下功能：

```
char * foo(const char *filepath) 
```

... 使用 mmap()。

如果您不能修改库以接受文件描述符（或作为路径的替代）.. 只需使用 /dev/shm 和临时文件，它会非常便宜。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T20:06:06.183

**编辑：**对不起。只需阅读问题。根据我在下面的建议，您分叉了一个备用进程，并且“不会出现在单个进程中工作”的问题。我也看不出你没有理由不能产生一个单独的线程来进行推送......

* * *

一点也不优雅，但你可以：

1.  打开命名管道。
2.  分叉一个除了尝试写入管道之外什么都不做的流媒体
3.  传递管道的名称

这应该是相当强大的......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T20:08:30.000

你在 Linux 上，你不能直接获取库的源代码并破解你需要的功能吗？如果对其他人有用，您甚至可以将补丁发送给原作者，以便在以后的版本中为大家提供。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-01T06:27:48.787

mmap()，也许？

# build-process - 您使用什么开发和构建生命周期工具？

> ID：599361
> 
> 赞同：10
> 
> 时间：2009-03-01T06:16:04.213
> 
> 标签：build-process, build-automation

我正在努力将我当前的大约 20 名开发人员的项目转换为现代开发和构建环境。我们目前使用基于 RCS 的源代码控制系统和相关的问题跟踪系统，两者都带有 Motif UI。没有正式的生产构建过程，它只是任何工作。

我感兴趣的是：

*   开发工具
*   版本控制
*   问题跟踪
*   依赖管理
*   配置管理
*   自动化建筑
*   自动化测试
*   持续集成
*   工件管理
*   发布管理
*   部署管理
*   需求追踪
*   还有什么？

我感兴趣的不仅是您使用了哪些工具，还包括它们之间的集成程度、设置和使用的容易程度以及开发人员和管理人员对它们的喜爱程度。我们的项目是 Java、C++ 和 VHDL 的组合，但我仍然想听听其他语言的人的意见。我目前正在走 eclipse、subversion、trac、maven、hudson 和 nexus 的道路。

此外，有没有比“构建生命周期”更好的术语，它不仅包括构建，还包括从开发人员创建到构建、测试和生产系统中的代码流？“构建生命周期”似乎有限，但“项目生命周期”已经被占用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-01T06:27:41.330

我讨厌 Maven 不如讨厌 Ant，而对于 Java，您需要选择其中一种邪恶。如果您刚刚开始，请选择 Maven，尤其是因为您已经认识到您的“构建生命周期”包含 12 个不同且复杂的学科！您将不得不为所有这些选择约定。省去自己的麻烦，并遵循 Maven 已经建立的约定。

对于持续集成和通用构建自动化，我喜欢 Hudson。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-01T08:08:11.883

在过去的两年中，我们逐渐从“每个项目都有自己的工具集”策略转变为 Trac+SVN+SCons 解决方案，并且对此非常满意。

切换到 SCons 需要一些工作，但确实得到了回报。我们有一个异构的环境，主要是 C/C++ 用于不同的嵌入式平台、内核模块、一些桌面应用程序和各种 Python 模块作为胶水代码。当您想要添加对自己的编译器和利基工具的支持并且需要使构建系统适应您的要求时，SCons 真的很出色。以前，我们必须为几乎每个嵌入式平台使用不同的 GUI——现在 SCons 直接调用编译器，工作周期略有改善。

我们的开发人员要么使用 Emacs 要么使用 Vim，没有人愿意切换到其他任何东西，所以我们（幸运的是）坚持了这一点。我对部署不是很熟悉，所以我不能谈论这个。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-01T17:06:21.620

如果您使用 .NET，则很难击败 Team Foundation Server 与 Visual Studio 的集成。它包含开发工具、版本控制、问题跟踪、配置管理、自动化测试、单元测试、自动化构建、工件管理以及您描述的所有其他内容。

当然，与我使用过的其他工具相比，TFS 很昂贵，通常不直观，并且缺少一些功能。不过，如果您有 MSDN 许可证，则可以免费使用 TFS for Workgroups（最多 5 个用户 IIRC）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T15:15:44.220

*   开发工具*JetBrains IntelliJ IDEA*
*   版本控制*颠覆*
*   问题跟踪*Atlassian Jira*
*   依赖管理*Maven*
*   配置管理*TeamCity*
*   自动化建筑*TeamCity*
*   自动化测试*JUnit(?)*
*   持续集成*TeamCity*
*   工件管理*Maven*
*   发布管理*智人*
*   部署管理*Maven/智人*
*   需求追踪*一厢情愿*
*   一次性自动化*Bash*
*   开发者对开发者文档*[MediaWiki](http://www.mediawiki.org/wiki/MediaWiki "媒体维基")*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-01T10:05:22.197

我们是一家使用 VS2008 的 MS 商店。我们使用带有 Tortoise 的 Subversion 进行 SCC 和版本控制，我们的存储库是在线托管的，因此我们的分布式团队可以使用它。对于构建，我们使用 Hudson 和 CI，比 Nant 或 MSBuild 好得多。问题跟踪是 Bugzilla。自动化测试是 NUnit

避免使用的工具包括 Team Foundation Server 和 Sharepoint，它们对于现实世界的使用来说过于笨重。

顺便说一句，有谁知道一个好的 Scrum 工具，它可以生成燃尽图，理想情况下可以链接到 Basecamp？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T20:35:30.330

我们还使用了许多工具，但我们越来越多地转向 Zed Builds & Bugs。我们的主要开发环境是 Eclipse + Java，但我们也使用 Visual Studio（全部），以及至少 5 个不同的 unix 平台构建。

这是完整列表：

*   开发工具 - [Eclipse](http://eclipse.org/)
*   版本控制 -[颠覆](http://subversion.tigris.org/)
*   问题跟踪 - [Zed 构建和错误](http://www.hericus.com/)
*   依赖管理 - [Ant](http://ant.apache.org/)
*   配置管理 - [Zed 构建和错误](http://www.hericus.com/)
*   自动化构建 - [Zed 构建和错误](http://www.hericus.com/)
*   自动化测试 - [JUnit](http://www.junit.org/)
*   持续集成 - [Zed 构建和错误](http://www.hericus.com/)
*   工件管理 - [Zed 构建和错误](http://www.hericus.com/)
*   发布管理 - [Zed 构建和错误](http://www.hericus.com/)
*   部署管理 - [Zed 构建和错误](http://www.hericus.com/)
*   需求跟踪 - [Zed 构建和错误](http://www.hericus.com/)
*   一次性自动化 - [Zed 构建和错误](http://www.hericus.com/)
*   开发人员对开发人员 - [Zed 构建和错误](http://www.hericus.com/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T20:39:48.183

我在我的一些项目中使用 svn 和 tac，在其他项目中使用 svn 和fogbugz。它们融合得非常好。

我仍在使用命令行脚本进行构建，因为它们可以完成我需要的一切 - 包括查找错误和通过电子邮件发送结果，但该设置的日子已经屈指可数了。我正在研究跨平台构建工具。

我将 Inno 用于 win32 版本。其他平台还没有发货产品——不确定我们将如何部署这些产品。

除了一些辅助文档、代码和问题跟踪之外，我们没有解决您提到的许多其他项目。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-30T14:01:04.603

Team Foundation Server 和 Visual Studio。

我记得当我的 ide 是 Sun 的可视 C 调试器时，源代码控制将所有源文件复制到一个新的命名目录，并将其放在应该备份的服务器上。

只是它不是

# c - 你最喜欢的 C 编程技巧是什么？

> ID：599365
> 
> 赞同：134
> 
> 时间：2009-03-01T06:21:09.363
> 
> 标签：c

例如，我最近在 linux 内核中遇到了这个：

```
/* 如果条件为真，则强制编译错误 */
#define BUILD_BUG_ON(condition) ((void)sizeof(char[1 - 2*!!(condition)]))

```

所以，在你的代码中，如果你有一些结构必须是 8 字节的倍数，可能是因为一些硬件限制，你可以这样做：

```
BUILD_BUG_ON((sizeof(struct mystruct) % 8) != 0);

```

除非 struct mystruct 的大小是 8 的倍数，否则它不会编译，如果它是 8 的倍数，则根本不会生成运行时代码。

我知道的另一个技巧来自“Graphics Gems”一书，它允许单个头文件在一个模块中声明和初始化变量，而在使用该模块的其他模块中，只需将它们声明为外部。

```
#ifdef DEFINE_MYHEADER_GLOBALS
#define 全球
#define INIT(x, y) (x) = (y)
＃别的
#define 全球外部
#define INIT(x, y)
＃万一

全局 int INIT(x, 0);
全球 int somefunc(int a, int b);

```

这样，定义 x 和 somefunc 的代码会：

```
#define DEFINE_MYHEADER_GLOBALS
#include "the_above_header_file.h"

```

而仅使用 x 和 somefunc() 的代码会：

```
#include "the_above_header_file.h"

```

因此，您将获得一个头文件，该文件在需要时声明了全局变量和函数原型的实例，以及相应的外部声明。

那么，您最喜欢这些方面的 C 编程技巧是什么？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-03-03T18:06:44.847

C99 使用匿名数组提供了一些非常酷的东西：

**删除无意义的变量**

```
{
    int yes=1;
    setsockopt(yourSocket, SOL_SOCKET, SO_REUSEADDR, &yes, sizeof(int));
} 
```

变成

```
setsockopt(yourSocket, SOL_SOCKET, SO_REUSEADDR, (int[]){1}, sizeof(int)); 
```

**传递可变数量的参数**

```
void func(type* values) {
    while(*values) {
        x = *values++;
        /* do whatever with x */
    }
}

func((type[]){val1,val2,val3,val4,0}); 
```

**静态链表**

```
int main() {
    struct llist { int a; struct llist* next;};
    #define cons(x,y) (struct llist[]){{x,y}}
    struct llist *list=cons(1, cons(2, cons(3, cons(4, NULL))));
    struct llist *p = list;
    while(p != 0) {
        printf("%d\n", p->a);
        p = p->next;
    }
} 
```

任何我敢肯定，我还没有想到许多其他很酷的技术。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2009-11-02T16:12:48.993

在阅读 Quake 2 源代码时，我想出了这样的东西：

```
double normals[][] = {
  #include "normals.txt"
}; 
```

（或多或少，我现在没有方便的代码来检查它）。

从此，一个创造性地使用预处理器的新世界在我眼前打开了。我不再只包含标题，而是不时包含整个代码块（它大大提高了可重用性）:-p

谢谢约翰卡马克！xD

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2009-03-01T11:03:50.213

我喜欢用它`= {0};`来初始化结构而不需要调用 memset。

```
struct something X = {0}; 
```

这会将结构（或数组）的所有成员初始化为零（但不是任何填充字节 - 如果您也需要将它们归零，请使用 memset）。

但是您应该知道，[对于大型动态分配的结构，这存在一些问题](https://stackoverflow.com/questions/177393/initializing-a-large-structure-in-c)。

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2009-03-01T07:23:41.383

如果我们谈论 c 技巧，我最喜欢的必须是[Duff 的](http://www.lysator.liu.se/c/duffs-device.html)循环展开设备！我只是在等待合适的机会出现，让我真正在愤怒中使用它......

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2009-03-01T20:34:45.897

使用 `__FILE__`和`__LINE__`调试

```
#define WHERE fprintf(stderr,"[LOG]%s:%d\n",__FILE__,__LINE__); 
```

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2009-03-01T21:55:27.073

在 C99 中

```
typedef struct{
    int value;
    int otherValue;
} s;

s test = {.value = 15, .otherValue = 16};

/* or */
int a[100] = {1,2,[50]=3,4,5,[23]=6,7}; 
```

* * *

## 回答 #7

> 赞同：28
> 
> 时间：2009-03-01T09:29:42.233

曾经我的一个伙伴和我重新定义了 return 以发现一个棘手的堆栈损坏错误。

就像是：

```
#define return DoSomeStackCheckStuff, return 
```

* * *

## 回答 #8

> 赞同：22
> 
> 时间：2009-03-01T07:34:27.470

我喜欢动态大小的对象的“struct hack”。[该站点](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=288)也很好地解释了它（尽管它们引用了 C99 版本，您可以在其中将“str []”写为结构的最后一个成员）。你可以像这样创建一个字符串“对象”：

```
struct X {
    int len;
    char str[1];
};

int n = strlen("hello world");
struct X *string = malloc(sizeof(struct X) + n);
strcpy(string->str, "hello world");
string->len = n; 
```

在这里，我们在堆上分配了一个 X 类型的结构，它的大小是 int（对于 len），加上“hello world”的长度，再加上 1（因为 str [1](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=288)包含在 sizeof(X) 中。

当您希望在同一块中的一些可变长度数据之前有一个“标题”时，它通常很有用。

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2009-03-01T12:38:59.313

通过模拟类，使用 C 语言编写面向对象的代码。

只需创建一个结构和一组将指向该结构的指针作为第一个参数的函数。

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2011-09-13T10:02:31.440

代替

```
printf("counter=%d\n",counter); 
```

利用

```
#define print_dec(var)  printf("%s=%d\n",#var,var);
print_dec(counter); 
```

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2009-03-01T20:43:26.403

使用愚蠢的宏技巧使记录定义更易于维护。

```
#define COLUMNS(S,E) [(E) - (S) + 1]

typedef struct
{
    char studentNumber COLUMNS( 1,  9);
    char firstName     COLUMNS(10, 30);
    char lastName      COLUMNS(31, 51);

} StudentRecord; 
```

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2009-03-01T22:41:10.553

用于创建一个在所有模块中都是只读的变量，除了它在其中声明的那个：

```
// Header1.h:

#ifndef SOURCE1_C
   extern const int MyVar;
#endif 
```

* * *

```
// Source1.c:

#define SOURCE1_C
#include Header1.h // MyVar isn't seen in the header

int MyVar; // Declared in this file, and is writeable 
```

* * *

```
// Source2.c

#include Header1.h // MyVar is seen as a constant, declared elsewhere 
```

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2009-03-01T14:41:01.923

位移位最多只能定义为 31 的位移量（在 32 位整数上）。

如果您想要计算的班次也需要使用更高的班次值，您会怎么做？以下是 Theora 视频编解码器的工作方式：

```
unsigned int shiftmystuff (unsigned int a, unsigned int v)
{
  return (a>>(v>>1))>>((v+1)>>1);
} 
```

或者更具可读性：

```
unsigned int shiftmystuff (unsigned int a, unsigned int v)
{
  unsigned int halfshift = v>>1;
  unsigned int otherhalf = (v+1)>>1;

  return (a >> halfshift) >> otherhalf; 
} 
```

以上面显示的方式执行任务比使用这样的分支要快得多：

```
unsigned int shiftmystuff (unsigned int a, unsigned int v)
{
  if (v<=31)
    return a>>v;
  else
    return 0;
} 
```

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2009-03-02T14:28:59.900

声明用于实现有限状态机的函数的指针数组。

```
int (* fsm[])(void) = { ... } 
```

最令人愉悦的优点是强制每个刺激/状态检查所有代码路径很简单。

在嵌入式系统中，我经常将 ISR 映射为指向这样的表，并根据需要（在 ISR 之外）对其进行重新向量化。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2009-03-01T06:40:13.560

另一个不错的预处理器“技巧”是使用“#”字符打印调试表达式。例如：

```
#define MY_ASSERT(cond) \
  do { \
    if( !(cond) ) { \
      printf("MY_ASSERT(%s) failed\n", #cond); \
      exit(-1); \
    } \
  } while( 0 ) 
```

**编辑：**下面的代码仅适用于 C++。感谢 smcameron 和 Evan Teran。

是的，编译时断言总是很棒。也可以写成：

```
#define COMPILE_ASSERT(cond)\
     typedef char __compile_time_assert[ (cond) ? 0 : -1] 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2009-03-01T10:16:37.067

```
#if TESTMODE == 1    
    debug=1;
    while(0);     // Get attention
#endif 
```

while(0); 对程序没有影响，但是编译器会发出“这什么都不做”的警告，这足以让我去看看有问题的行，然后看看我想引起注意的真正原因。

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2009-03-01T08:13:25.770

I wouldn't really call it a favorite trick, since I've never used it, but the mention of Duff's Device reminded me of [this article](http://www.chiark.greenend.org.uk/~sgtatham/coroutines.html) about implementing Coroutines in C. It always gives me a chuckle, but I'm sure it could be useful some time.

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2011-10-14T15:12:31.733

我是 xor hacks 的粉丝：

交换没有第三个临时指针的 2 个指针：

```
int * a;
int * b;
a ^= b;
b ^= a;
a ^= b; 
```

或者我真的很喜欢只有一个指针的异或链表。(http://en.wikipedia.org/wiki/XOR_linked_list)

链表中的每个节点都是前一个节点和下一个节点的异或。为了向前遍历，通过以下方式找到节点的地址：

```
LLNode * first = head;
LLNode * second = first.linked_nodes;
LLNode * third = second.linked_nodes ^ first;
LLNode * fourth = third.linked_nodes ^ second; 
```

等等

或向后遍历：

```
LLNode * last = tail;
LLNode * second_to_last = last.linked_nodes;
LLNode * third_to_last = second_to_last.linked_nodes ^ last;
LLNode * fourth_to_last = third_to_last.linked_nodes ^ second_to_last; 
```

等等

虽然不是非常有用（您不能从任意节点开始遍历），但我觉得它非常酷。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2009-03-01T10:46:04.390

这一个来自《足够的绳索，让你在脚上射中自己》一书：

在标题中声明

```
#ifndef RELEASE
#  define D(x) do { x; } while (0)
#else
#  define D(x)
#endif 
```

在您的代码中放置测试语句，例如：

```
D(printf("Test statement\n")); 
```

do/while 有助于防止宏的内容扩展到多个语句。

仅当不使用编译器的“-D RELEASE”标志时才会打印该语句。

然后你可以例如。将标志传递给您的 makefile 等。

不确定这在 Windows 中是如何工作的，但在 *nix 中效果很好

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2009-03-01T06:32:32.393

[Rusty 实际上在ccan](http://ccan.ozlabs.org/list.html)中生成了一整套构建条件，查看构建断言模块：

```
#include <stddef.h>
#include <ccan/build_assert/build_assert.h>

struct foo {
        char string[5];
        int x;
};

char *foo_string(struct foo *foo)
{
        // This trick requires that the string be first in the structure
        BUILD_ASSERT(offsetof(struct foo, string) == 0);
        return (char *)foo;
} 
```

实际标题中还有许多其他有用的宏，它们很容易就位。

我尝试通过主要坚持内联函数来抵抗黑暗面（和预处理器滥用）的拉动，但我确实喜欢像你描述的那样聪明、有用的宏。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2009-03-01T07:09:26.953

这类东西的两本很好的源书是[The Practice of Programming](http://cm.bell-labs.com/cm/cs/tpop/)和[Writing Solid Code](https://rads.stackoverflow.com/amzn/click/com/1556155514)。其中一个（我不记得是哪个）说：在可能的情况下，更喜欢枚举而不是#define，因为编译器会检查枚举。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2011-10-14T16:01:10.137

不特定于 C，但我一直喜欢 XOR 运算符。它可以做的一件很酷的事情是“没有临时值的交换”：

```
int a = 1;
int b = 2;

printf("a = %d, b = %d\n", a, b);

a ^= b;
b ^= a;
a ^= b;

printf("a = %d, b = %d\n", a, b); 
```

结果：

> a = 1, b = 2
> 
> a = 2, b = 1

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2009-03-01T09:12:03.773

See ["Hidden features of C"](https://stackoverflow.com/questions/132241/hidden-features-of-c) question.

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2009-11-02T16:14:15.137

我喜欢**`container_of`**在列表中使用的概念。基本上，您不需要为列表中的每个结构指定`next`和`last`字段。相反，您将列表结构标题附加到实际链接的项目。

看看`include/linux/list.h`现实生活中的例子。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-03-09T20:20:35.003

我们的代码库有一个类似于

```
#ifdef DEBUG

#define my_malloc(amt) my_malloc_debug(amt, __FILE__, __LINE__)
void * my_malloc_debug(int amt, char* file, int line)
#else
void * my_malloc(int amt)
#endif
{
    //remember file and line no. for this malloc in debug mode
} 
```

它允许在调试模式下跟踪内存泄漏。我一直认为这很酷。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-03-03T18:01:04.920

我使用[X-Macros](https://stackoverflow.com/questions/264269/what-is-a-good-reference-documenting-patterns-of-use-of-x-macros-in-c-or-possibl)让预编译器生成代码。它们对于在一个地方定义错误值和相关的错误字符串特别有用，但它们可以远不止于此。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-03-01T21:09:25.890

我认为用户数据指针的使用非常简洁*。*当今时尚正在失势。它不是 C 的特性，但在 C 中很容易使用。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2011-10-14T19:33:42.697

宏的乐趣：

```
#define SOME_ENUMS(F) \
    F(ZERO, zero) \
    F(ONE, one) \
    F(TWO, two)

/* Now define the constant values.  See how succinct this is. */

enum Constants {
#define DEFINE_ENUM(A, B) A,
    SOME_ENUMS(DEFINE_ENUMS)
#undef DEFINE_ENUM
};

/* Now a function to return the name of an enum: */

const char *ToString(int c) {
    switch (c) {
    default: return NULL; /* Or whatever. */
#define CASE_MACRO(A, B) case A: return #b;
     SOME_ENUMS(CASE_MACRO)
#undef CASE_MACRO
     }
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2011-10-14T15:17:13.813

使用其他毫无意义的**？:**用于初始化 const 变量的运算符

`const int bytesPerPixel = isAlpha() ? 4 : 3;`

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-03-07T22:54:14.887

这是一个示例，如何使 C 代码完全不了解硬件实际用于运行应用程序的内容。main.c 进行设置，然后可以在任何编译器/架构上实现自由层。我认为将 C 代码抽象一点是相当巧妙的，所以它并不特别。

在此处添加一个完整的可编译示例。

```
/* free.h */
#ifndef _FREE_H_
#define _FREE_H_
#include <stdio.h>
#include <string.h>
typedef unsigned char ubyte;

typedef void (*F_ParameterlessFunction)() ;
typedef void (*F_CommandFunction)(ubyte byte) ;

void F_SetupLowerLayer (
F_ParameterlessFunction initRequest,
F_CommandFunction sending_command,
F_CommandFunction *receiving_command);
#endif

/* free.c */
static F_ParameterlessFunction Init_Lower_Layer = NULL;
static F_CommandFunction Send_Command = NULL;
static ubyte init = 0;
void recieve_value(ubyte my_input)
{
    if(init == 0)
    {
        Init_Lower_Layer();
        init = 1;
    }
    printf("Receiving 0x%02x\n",my_input);
    Send_Command(++my_input);
}

void F_SetupLowerLayer (
    F_ParameterlessFunction initRequest,
    F_CommandFunction sending_command,
    F_CommandFunction *receiving_command)
{
    Init_Lower_Layer = initRequest;
    Send_Command = sending_command;
    *receiving_command = &recieve_value;
}

/* main.c */
int my_hw_do_init()
{
    printf("Doing HW init\n");
    return 0;
}
int my_hw_do_sending(ubyte send_this)
{
    printf("doing HW sending 0x%02x\n",send_this);
    return 0;
}
F_CommandFunction my_hw_send_to_read = NULL;

int main (void)
{
    ubyte rx = 0x40;
    F_SetupLowerLayer(my_hw_do_init,my_hw_do_sending,&my_hw_send_to_read);

    my_hw_send_to_read(rx);
    getchar();
    return 0;
} 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2011-10-14T16:00:54.697

我一直喜欢愚蠢的预处理器技巧来制作通用容器类型：

```
/* list.h */
#ifndef CONTAINER_TYPE
#define CONTAINER_TYPE VALUE_TYPE ## List
#endif
typedef struct CONTAINER_TYPE {
    CONTAINER_TYPE *next;
    VALUE_TYPE v;
} CONTAINER_TYPE;
/* Possibly Lots of functions for manipulating Lists
*/
#undef VALUE_TYPE
#undef CONTAINER_TYPE 
```

然后你可以做例如：

```
#define VALUE_TYPE int
#include "list.h"
typedef struct myFancyStructure *myFancyStructureP;
#define VALUE_TYPE myFancyStructureP
#define CONTAINER_TYPE mfs
#include "list.h" 
```

并且永远不要再写一个链表。如果 VALUE_TYPE 始终是一个指针，那么这是一个矫枉过正的做法，因为 void * 也可以工作。但是通常有非常小的结构，间接的开销通常没有意义。此外，您还可以进行类型检查（即，您可能不希望将字符串的链接列表与双精度的链接列表连接起来，即使两者都可以在 void * 链接列表中工作）。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2011-02-11T08:07:38.733

```
if(---------)  
printf("hello");  
else   
printf("hi"); 
```

填写空白，这样 hello 和 hi 都不会出现在输出中。
答：`fclose(stdout)`

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2011-10-17T05:57:29.337

我喜欢空的 if-else 和 while(0) 运算符。

例如：

```
#define CMD1(X) do { foo(x); bar(x); } while (0)
#define CMD2(X) if (1) { foo(x); bar(x); } else 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2011-10-15T11:28:51.933

在 C99 中，您可以直接将 URL 嵌入到函数内部的源代码中。例子：

```
#include <stdio.h>

int main(int argc, char** argv) {
    http://stackoverflow.com/
    printf("Hello World");
} 
```

* * *

## 回答 #35

> 赞同：-1
> 
> 时间：2009-03-01T09:04:06.290

I don't know if it's a trick. But when I was a junior in university a friend of mine and I were completing a lab in our intro C++ course. We had to take a person's name and capitalize it, display it back, and then give them the option of displaying their name "last, first". For this lab we were prohibited from using array notation.

He showed me this code, I thought it was the coolest thing I'd seen at the time.

```
char * ptr = "first name";

//flies to the end of the array, regardless of length
while( *ptr++ ); 
```

* * *

## 回答 #36

> 赞同：-1
> 
> 时间：2011-02-11T10:49:27.033

在不使用任何运算符的情况下添加两个数字（a 和 b）：

```
printf("%d", printf("%*s%*s",a,"\r",b,"\r") ); 
```

它打印 a+b。

* * *

## 回答 #37

> 赞同：-4
> 
> 时间：2011-02-11T15:53:04.917

填空以打印下面的“正确”和“错误”：

```
if(--------)
printf("correct");
else
printf("wrong"); 
```

答案是`!printf("correct")`

# c# - 为什么'='不能在C#中重载？

> ID：599367
> 
> 赞同：22
> 
> 时间：2009-03-01T06:23:43.647
> 
> 标签：c#, operator-overloading

我想知道，为什么我不能在 C# 中重载“=”？我能得到更好的解释吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-01T10:05:36.577

内存管理语言通常使用引用而不是对象。当您定义一个类及其成员时，您正在定义对象行为，但是当您创建一个变量时，您正在使用对这些对象的引用。

现在，运算符 = 应用于引用，而不是对象。当您将引用分配给另一个引用时，您实际上是在使接收引用指向与另一个引用相同的对象。

```
Type var1 = new Type();
Type var2 = new Type();

var2 = var1; 
```

在上面的代码中，在堆上创建了两个对象，一个由 var1 引用，另一个由 var2 引用。现在最后一条语句使 var2 引用指向 var1 所引用的同一对象。在那一行之后，垃圾收集器可以释放第二个对象，并且内存中只有一个对象。在整个过程中，没有对对象本身进行任何操作。

回到为什么 = 不能被重载，系统实现是你可以对引用做的唯一明智的事情。您可以重载应用于对象但不能应用于引用的操作。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-01T06:34:19.143

如果你重载了'='，你将永远无法在创建对象引用后更改它。...考虑一下-重载运算符中对 theObjectWithOverloadedOperator=something 的任何调用都会导致对重载运算符的另一个调用...那么重载运算符到底在做什么？也许设置一些其他属性 - 或将值设置为新对象（不变性）？通常不是'='所暗示的..

但是，您可以覆盖隐式和显式转换运算符：http: [//www.blackwasp.co.uk/CSharpConversionOverload.aspx](http://www.blackwasp.co.uk/CSharpConversionOverload.aspx)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-01T12:57:35.150

**因为这样做真的没有意义。**

在 C# 中 = 将对象引用分配给变量。所以它对变量和对象引用进行操作，而不是对象本身。根据对象类型重载它是没有意义的。

在 C++ 中，定义 operator= 对于可以在堆栈上创建实例的类是有意义的，因为对象本身存储在变量中，而不是对它们的引用。因此，定义如何执行此类分配是有意义的。但即使在 C++ 中，如果您有一组通常通过指针或引用使用的多态类，您通常通过将 operator= 和复制构造函数声明为私有（或从 boost::noncopyable 继承）来明确禁止像这样复制它们，因为与您不在 C# 中重新定义 = 的原因完全相同。简单地说，如果你有 A 类的引用或指针，你真的不知道它是指向 A 类的实例还是 A 的子类 B 类。那么你真的知道在这种情况下如何执行 = 吗？

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-01T12:18:04.123

实际上，如果您可以定义具有值语义~~的类并在堆栈中分配这些类的对象，~~`operator =`那么重载将是有意义的。但是，在 C# 中，你不能。

 ~~* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-01T09:05:53.197

一种可能的解释是，如果重载赋值运算符，则无法进行正确的引用更新。它实际上会搞砸语义，因为当人们期望引用更新时，您的 = 运算符也可能完全在做其他事情。对程序员不太友好。

您可以使用隐式和显式 to/from 转换运算符来减轻无法重载赋值的一些看似缺点。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-01T06:32:34.203

我不认为有任何真正特别的单一理由可以指出。一般来说，我认为这个想法是这样的：

*   如果你的对象是一个大而复杂的对象，那么做一些不是用`=`运算符赋值的事情可能会产生误导。

*   如果您的对象是一个小对象，您最好将其设置为不可变并在对其执行操作时返回新副本，以便赋值运算符按照您期望的开箱即用方式工作（就像`System.String`这样做一样。）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-01T10:09:49.750

您可以在 C# 中重载赋值。不是在整个对象上，而是在它的成员上。您使用 setter 声明一个属性：

```
class Complex
{
    public double Real
    {
        get { ... }
        set { /* do something with value */ }
    }

    // more members
} 
```

现在，当您分配给 时`Real`，您自己的代码就会运行。

分配给一个对象的原因是不可替换的，因为它已经被语言定义为意味着非常重要的东西。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-01T09:15:34.513

它在 C++ 中是允许的，如果不小心，可能会导致很多混乱和错误搜索。

这篇文章非常详细地解释了这一点。

[http://www.relisoft.com/book/lang/project/14value.html](http://www.relisoft.com/book/lang/project/14value.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-01T11:44:51.770

因为在脚上射击自己是不受欢迎的。

更严肃地说，人们只能希望你的意思是比较而不是分配。该框架为干扰相等/等价评估做出了详尽的规定，请在帮助中或在线与 msdn 中查找“比较”。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-06-07T22:33:35.127

能够为赋值操作定义特殊语义将是有用的，但前提是这种语义可以应用于将给定类型的一个存储位置复制到另一个存储位置的所有情况。尽管标准 C++ 实现了这样的分配规则，但它要求在编译时定义所有类型。当反射和泛型添加到列表中时，事情变得更加复杂。

目前，.net 中的规则指定存储位置可以设置为其类型的默认值——无论该类型是什么——通过将所有字节清零。他们进一步指定可以通过复制所有字节将任何存储位置复制到另一个相同类型的位置。这些规则适用于所有类型，包括泛型。给定两个 type 变量`KeyValuePair<t1,t2>`，系统可以将一个变量复制到另一个变量，而无需知道该类型的大小和对齐要求。如果`t1`,`t2`或其中任何一个类型中的*任何字段的类型都*可以实现复制构造函数，那么将一个结构实例复制到另一个的代码将变得更加复杂。

这并不是说这种能力提供了一些显着的好处——如果设计一个新的框架，自定义值赋值运算符和默认构造函数的好处可能会超过成本。然而，实施成本在新框架中将是巨大的，并且对于现有框架而言可能无法克服。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-11-22T14:36:10.823

这段代码对我有用：

```
public class Class1
{

    ...

    public static implicit operator Class1(Class2 value)
    {
        Class1 result = new Class1();

        result.property = value.prop;

        return result;

    }

} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-12-26T08:07:33.633

## 覆盖分配的类型

覆盖分配有两种类型：

1.  当您觉得用户可能会遗漏某些东西，并且您希望强制用户使用 *浮点数到整数等“强制转换”时，当您丢失浮点值时*

`int a = (int)5.4f;`

2.  当您希望用户执行此操作时甚至没有注意到他/她更改了对象类型

`float f = 5;`

## 如何覆盖分配

1、`explicit`关键字的使用：

```
public static explicit override ToType(FromType from){
    ToType to = new ToType();
    to.FillFrom(from);
    return to;
} 
```

2、`implicit`关键字的使用：

```
public static implicit override ToType(FromType from){
    ToType to = new ToType();
    to.FillFrom(from);
    return to;
} 
```

## 更新：

注意：此实现可以在`FromType`or`ToType`类中进行，具体取决于您的需要，没有限制，您的一个类可以保存所有转换，而另一个实现没有代码。

# c# - C#中长度未知的数组

> ID：599369
> 
> 赞同：87
> 
> 时间：2009-03-01T06:24:02.727
> 
> 标签：c#, arrays

我刚刚开始学习 C#，在数组的介绍中，他们展示了如何将变量建立为数组，但似乎必须在赋值时指定数组的长度，所以如果我不知道数组的长度怎么办大批？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2009-03-01T06:27:03.217

数组必须指定一个长度。要允许任意数量的元素，请使用[`List`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)该类。

例如：

```
List<int> myInts = new List<int>();
myInts.Add(5);
myInts.Add(10);
myInts.Add(11);
myInts.Count // = 3 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-03-01T07:01:26.333

用于`List<>`构建未知长度的“数组”。

用于`List<>.ToArray()`返回一个真正的数组，而不是一个`List`.

```
var list = new List<int>();
list.Add(1);
list.Add(2);
list.Add(3);
var array = list.ToArray(); 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-03-01T19:37:30.540

一点背景资料：

如前所述，如果您想要动态收集事物，请使用`List<T>`. 在内部，List 也使用数组进行存储。该数组与任何其他数组一样具有固定大小。一旦数组被声明为具有大小，它就不会改变。当您将项目添加到 a`List`时，它会添加到数组中。最初，`List`从我认为长度为 16 的数组开始。当您尝试将第 17 项添加到 时`List`，会发生一个新数组被分配，（我认为）是旧数组大小的两倍，所以 32 项。然后将旧数组的内容复制到新数组中。因此，虽然`List`在外部观察者看来可能是动态的，但在内部它也必须遵守规则。

正如您可能已经猜到的那样，数组的复制和分配不是免费的，因此应该以尽可能少的数量为目标，并且可以指定（在构造函数中`List`）数组的初始大小，在一个完美的场景中，它足够大，可以容纳你想要的一切。然而，这是微优化，它对你来说不太重要，但知道你*实际*在做什么总是很高兴的。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-03-01T06:28:34.947

您可以创建一个大小设置为变量的数组，即

```
int size = 50;
string[] words = new string[size]; // contains 50 strings 
```

但是，如果您决定需要 100 个字，则该大小以后不能更改。如果您需要真正动态的大小，则需要使用不同类型的数据结构。试试[`List`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-01T06:29:14.553

`ArrayList`在 .NET 1.x 中使用if，或者`List<yourtype>`在 .NET 2.0 或 3.x 中使用 if。

`System.Collections`在和中搜索它们`System.Collections.Generics`。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-01T16:37:20.367

如果您的数据是唯一的，您可能还想查看字典，这将为您提供两列可供使用。

用户名，总账单

它为您提供了许多内置工具来搜索和更新值。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-01T06:27:10.143

```
var yummy = new List<string>();
while(person.FeelsHappy()) {
    yummy.Add(person.GetNewFavoriteFood());
}
Console.WriteLine("Sweet! I have a list of size {0}.", list.Count);
Console.WriteLine("I didn't even need to know how big to make it " +
    "until I finished making it!"); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-01T12:26:57.627

尝试通用列表而不是数组

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-01T16:59:17.207

简而言之，请使用集合和泛型。

对于任何 C# 开发人员来说，这都是必须的，值得花时间学习 :)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-01-11T16:25:14.743

如上所述，通用 List<> 是最好的方法。

如果您被困在 .NET 1.* 中，那么您将不得不改用 ArrayList 类。这没有编译时类型检查，您还必须添加强制转换 - 混乱。

后续版本还实现了各种变体——包括线程安全变体。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-09-07T11:07:28.827

如果您确实需要使用数组而不是列表，那么您可以创建一个数组，其大小在运行时计算，如下所示......

例如，我想要一个大小为 n x n 的二维数组。n 将在运行时从用户那里获得

```
int n = 0;
bool isInteger = int.TryPase(Console.ReadLine(), out n);
var x = new int[n,n]; 
```

# .net - 未找到请求类型“POST”的 http 处理程序

> ID：599382
> 
> 赞同：9
> 
> 时间：2009-03-01T06:29:37.080
> 
> 标签：.net, http, post, handler

当我提交页面以加载 .net 图表控件时出现此错误。我在下面的 web.config 中有 http 处理程序。无论出于何种原因，它似乎都不起作用。

```
<httpHandlers>
  <remove verb="*" path="*.asmx"/>
  <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
  <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
  <add verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
  <add verb="GET" path="FtbWebResource.axd" type="FreeTextBoxControls.AssemblyResourceHandler, FreeTextBox" />
  <add path="ChartImg.axd" verb="GET,HEAD,POST" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" validate="false" />
</httpHandlers> 
```

任何想法为什么会出现这个错误？我难倒这个。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-09-09T08:23:28.243

只是为了帮助把事情弄清楚，因为我并不清楚；

Chopps 的回答：“我需要在 IIS 7 的 web.config 部分添加处理程序”

表示处理程序也需要`system.webServer`在`web.config`.

每托德：

```
<add path="ChartImg.axd" verb="GET,HEAD,POST" 
type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, 
System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, 
PublicKeyToken=31bf3856ad364e35" validate="false" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-01T07:23:28.807

我通过在`<system.webServer>`IIS 7 的 web.config 部分添加处理程序来解决此问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T12:53:49.420

在 IIS 中切换到 Classic .NET AppPool 对我有用 - 正如 Chopps 评论中所建议的那样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-20T20:05:25.023

只是为了帮助把事情弄清楚，因为我并不清楚；

Chopps 的回答：“我需要在 IIS 7 的 web.config 部分中添加处理程序”

表示处理程序也需要位于 web.config 的 system.webServer 部分中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-02T07:39:52.657

在 IIS 中切换到 Classic .NET AppPool 对我有用！我在将网站从 IIS 6 迁移到 IIS 10 时遇到了这个问题。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-01T06:43:04.880

嗯...也许`<remove verb="*" path="*.asmx"/>`让您的服务器不再响应 POST 请求？尝试将其注释掉，看看它是否覆盖了这些`add`行。

# ruby-on-rails - Vanishing Ruby Gems

> ID：599393
> 
> 赞同：3
> 
> 时间：2009-03-01T06:39:37.917
> 
> 标签：ruby-on-rails, ruby, ubuntu, rubygems

I'm using Ubuntu 8.10 and I installed Ruby and Ruby on Rails following the directions on [this](http://wiki.rubyonrails.org/getting-started/installation/linux) site. The exact directions I followed are no longer there as it appears the rubyonrails.org wiki has changed recently. But I installed it the long way. Installed Ruby, then Gems, then installed Rails using "gem install rails". I haven't really messed with Rails for a while, and I tried to use the Gem command today and...

```
 The program 'gem' can be found in the following packages:
    * rubygems1.8
    * rubygems1.9
   Try: sudo apt-get install <selected package>
   bash: gem: command not found 
```

That's just weird to me because I installed rails using the gem command. I have been seaching my computer for the gems binary so I could create a link to it in the bin directory but I can't find it. I know it's installed becaues when I run 'script/server' and go to localhost:3000 in a browser I get the following version information:

```
Ruby version    1.8.7 (i486-linux)
RubyGems version    1.3.1
Rails version   2.2.2
Active Record version   2.2.2
Action Pack version 2.2.2
Active Resource version 2.2.2
Action Mailer version   2.2.2
Active Support version  2.2.2 
```

Anyone know how I can get my gem command working again? Thanks for any help.

Note: I am new to Rails and fairly new to Ubuntu and Linux in general.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-01T06:57:18.043

You could look to see if it's in:

/usr/bin/gem1.8

if it is, then symlink /usr/bin/gem to it:

sudo ln -s /usr/bin/gem1.8 /usr/bin/gem

BTW, here's another tutorial on how to install rails on Ubuntu 8.10:

[http://articles.slicehost.com/2009/1/6/ubuntu-intrepid-ruby-on-rails](http://articles.slicehost.com/2009/1/6/ubuntu-intrepid-ruby-on-rails)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T05:33:18.613

Did you install rubygems from apt-get? If yes, maybe you should try to remove it and install it from source.

Here is another article on installing Rails on Ubuntu:

[http://www.rubyinside.com/how-to-install-a-ruby-18-stack-on-ubuntu-810-from-scratch-1566.html](http://www.rubyinside.com/how-to-install-a-ruby-18-stack-on-ubuntu-810-from-scratch-1566.html)

Essentially, you can install Ruby from apt-get or source, but it's recommended to install rubygems from source.

# ios - iPhone 导航栏标题文本颜色

> ID：599405
> 
> 赞同：288
> 
> 时间：2009-03-01T06:51:01.820
> 
> 标签：ios, uinavigationbar, navigationitem

默认情况下，iOS 导航栏标题颜色似乎为白色。有没有办法把它改成不同的颜色？

我知道`navigationItem.titleView`使用图像的方法。由于我的设计能力有限，未能获得标准的光泽，我更喜欢更改文本颜色。

任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：424
> 
> 时间：2009-03-07T02:30:29.587

## 现代方法

现代方式，对于整个导航控制器……在加载导航控制器的根视图时执行一次。

```
[self.navigationController.navigationBar setTitleTextAttributes:
   @{NSForegroundColorAttributeName:[UIColor yellowColor]}]; 
```

但是，这在后续视图中似乎没有影响。

## 经典方法

旧方法，每个视图控制器（这些常量适用于 iOS 6，但如果想在 iOS 7 外观上按视图控制器执行此操作，您将需要相同的方法但具有不同的常量）：

您需要使用 a`UILabel`作为`titleView`的`navigationItem`。

标签应：

*   具有清晰的背景颜色 ( `label.backgroundColor = [UIColor clearColor]`)。
*   使用粗体 20pt 系统字体 ( `label.font = [UIFont boldSystemFontOfSize: 20.0f]`)。
*   具有 50% alpha ( `label.shadowColor = [UIColor colorWithWhite:0.0 alpha:0.5]`) 的黑色阴影。
*   您还需要将文本对齐设置为居中（`label.textAlignment = NSTextAlignmentCenter`（`UITextAlignmentCenter`对于较旧的 SDK）。

将标签文本颜色设置为您想要的任何自定义颜色。您确实需要一种不会导致文本混入阴影的颜色，这将难以阅读。

我通过反复试验解决了这个问题，但我提出的价值观最终太简单了，以至于它们不是 Apple 选择的。:)

如果您想验证这一点，请将此代码放入`initWithNibName:bundle:`Apple[的 NavBar 示例](http://developer.apple.com/library/ios/#samplecode/NavBar/Introduction/Intro.html)`PageThreeViewController.m`中。这将用黄色标签替换文本。这应该和苹果的代码产生的原件没有什么区别，除了颜色。

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self)
    {
        // this will appear as the title in the navigation bar
        UILabel *label = [[[UILabel alloc] initWithFrame:CGRectZero] autorelease];
        label.backgroundColor = [UIColor clearColor];
        label.font = [UIFont boldSystemFontOfSize:20.0];
        label.shadowColor = [UIColor colorWithWhite:0.0 alpha:0.5];
        label.textAlignment = NSTextAlignmentCenter;
                           // ^-Use UITextAlignmentCenter for older SDKs.
        label.textColor = [UIColor yellowColor]; // change this color
        self.navigationItem.titleView = label;
        label.text = NSLocalizedString(@"PageThreeTitle", @"");
        [label sizeToFit];
    }

    return self;
} 
```

编辑：另外，请阅读下面的 Erik B 的回答。我的代码显示了效果，但他的代码提供了一种更简单的方法来将其放到现有视图控制器上。

* * *

## 回答 #2

> 赞同：226
> 
> 时间：2011-10-26T22:16:52.243

我知道这是一个相当古老的线程，但我认为了解 iOS 5 为新用户带来了用于建立标题属性的新属性会很有用。

您可以使用 UINavigationBar`setTitleTextAttributes`设置字体、颜色、偏移量和阴影颜色。

此外，您可以为`UINavigationBars`整个应用程序设置相同的默认 UINavigationBar 标题文本属性。

例如像这样：

```
NSDictionary *navbarTitleTextAttributes = [NSDictionary dictionaryWithObjectsAndKeys:
                                            [UIColor whiteColor],UITextAttributeTextColor, 
                                            [UIColor blackColor], UITextAttributeTextShadowColor, 
                                            [NSValue valueWithUIOffset:UIOffsetMake(-1, 0)], UITextAttributeTextShadowOffset, nil];

[[UINavigationBar appearance] setTitleTextAttributes:navbarTitleTextAttributes]; 
```

* * *

## 回答 #3

> 赞同：180
> 
> 时间：2012-02-26T16:31:30.363

在 iOS 5 中，您可以通过以下方式更改导航栏标题颜色：

```
navigationController.navigationBar.titleTextAttributes = @{NSForegroundColorAttributeName: [UIColor yellowColor]}; 
```

* * *

## 回答 #4

> 赞同：128
> 
> 时间：2011-05-05T13:52:50.207

根据 Steven Fisher 的回答，我编写了这段代码：

```
- (void)setTitle:(NSString *)title
{
    [super setTitle:title];
    UILabel *titleView = (UILabel *)self.navigationItem.titleView;
    if (!titleView) {
        titleView = [[UILabel alloc] initWithFrame:CGRectZero];
        titleView.backgroundColor = [UIColor clearColor];
        titleView.font = [UIFont boldSystemFontOfSize:20.0];
        titleView.shadowColor = [UIColor colorWithWhite:0.0 alpha:0.5];

        titleView.textColor = [UIColor yellowColor]; // Change to desired color

        self.navigationItem.titleView = titleView;
        [titleView release];
    }
    titleView.text = title;
    [titleView sizeToFit];
} 
```

除了正确处理框架之外，此代码的优点是，如果您更改控制器的标题，自定义标题视图也将得到更新。无需手动更新。

另一个很大的优势是它使启用自定义标题颜色变得非常简单。您需要做的就是将此方法添加到控制器中。

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2013-10-03T12:01:27.363

大多数上述建议现在已弃用，适用于 iOS 7 -

```
NSDictionary *textAttributes = [NSDictionary dictionaryWithObjectsAndKeys: 
                               [UIColor whiteColor],NSForegroundColorAttributeName, 
                               [UIColor whiteColor],NSBackgroundColorAttributeName,nil];

self.navigationController.navigationBar.titleTextAttributes = textAttributes;
self.title = @"Title of the Page"; 
```

此外，检查 NSAttributedString.h 以了解可以设置的各种文本属性。

* * *

## 回答 #6

> 赞同：39
> 
> 时间：2013-12-19T16:14:33.900

在 IOS 7 和 8 中，您可以将标题的颜色更改为绿色

```
self.navigationController.navigationBar.titleTextAttributes = [NSDictionary dictionaryWithObject:[UIColor greenColor] forKey:NSForegroundColorAttributeName]; 
```

* * *

## 回答 #7

> 赞同：24
> 
> 时间：2015-08-14T13:48:44.387

为了使问题保持​​最新，我将添加**Alex RR**解决方案，但在*Swift*中：

```
self.navigationController.navigationBar.barTintColor = .blueColor()
self.navigationController.navigationBar.tintColor = .whiteColor()
self.navigationController.navigationBar.titleTextAttributes = [
    NSForegroundColorAttributeName : UIColor.whiteColor()
] 
```

结果：

[![在此处输入图像描述](https://i.stack.imgur.com/43djx.png)](https://i.stack.imgur.com/43djx.png)

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2016-04-08T13:45:43.890

**方法一**，在IB中设置：

[![在此处输入图像描述](https://i.stack.imgur.com/sRcUR.png)](https://i.stack.imgur.com/sRcUR.png)

**方法二**，一行代码：

```
navigationController?.navigationBar.barTintColor = UIColor.blackColor() 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2015-10-09T10:05:29.143

***斯威夫特***版本

我发现你们中的大多数人都给出了Objective_C版本的答案

我想为任何需要它的人使用 Swift 来实现这个功能。

**在 ViewDidload**

1.使NavigationBar背景变为彩色（例如：BLUE）

```
self.navigationController?.navigationBar.barTintColor = UIColor.blueColor() 
```

2.使NavigationBar背景变成Image（例如：ABC.png）

```
let barMetrix = UIBarMetrics(rawValue: 0)!

self.navigationController?.navigationBar
      .setBackgroundImage(UIImage(named: "ABC"), forBarMetrics: barMetrix) 
```

3.更改 NavigationBar 标题（例如：[Font:Futura,10] [Color:Red]）

```
navigationController?.navigationBar.titleTextAttributes = [
            NSForegroundColorAttributeName : UIColor.redColor(),
            NSFontAttributeName : UIFont(name: "Futura", size: 10)!
        ] 
```

> （提示 1：不要忘记 UIFont 后面的“！”标记）
> 
> （提示2：标题文本有很多属性，命令点击“NSFontAttributeName”可以进入类查看keyNames和需要的Objects类型）

**希望能帮到你！:D**

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2012-09-11T07:21:50.117

从 iOS 5 开始，我们必须使用 titleTextAttribute Dictionary（UInavigation 控制器类参考中的预定义字典）设置导航栏的标题文本颜色和字体。

```
 [[UINavigationBar appearance] setTitleTextAttributes:
 [NSDictionary dictionaryWithObjectsAndKeys:
  [UIColor blackColor],UITextAttributeTextColor, 
[UIFont fontWithName:@"ArialMT" size:16.0], UITextAttributeFont,nil]]; 
```

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2010-09-24T02:56:51.243

如果您尝试更改页面上的颜色，tewha 的解决方案效果很好，但我希望能够更改每个页面上的颜色。我做了一些小的修改，以便它**适用**于`UINavigationController`

导航委托.h

```
//This will change the color of the navigation bar
#import <Foundation/Foundation.h>
@interface NavigationDelegate : NSObject<UINavigationControllerDelegate> {
}
@end 
```

导航委托.m

```
#import "NavigationDelegate.h"
@implementation NavigationDelegate

- (void)navigationController:(UINavigationController *)navigationController 
      willShowViewController:(UIViewController *)viewController animated:(BOOL)animated{
    CGRect frame = CGRectMake(0, 0, 200, 44);//TODO: Can we get the size of the text?
    UILabel* label = [[[UILabel alloc] initWithFrame:frame] autorelease];
    label.backgroundColor = [UIColor clearColor];
    label.font = [UIFont boldSystemFontOfSize:20.0];
    label.shadowColor = [UIColor colorWithWhite:0.0 alpha:0.5];
    label.textAlignment = UITextAlignmentCenter;
    label.textColor = [UIColor yellowColor];
    //The two lines below are the only ones that have changed
    label.text=viewController.title;
    viewController.navigationItem.titleView = label;
}
@end 
```

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2014-05-19T06:43:09.547

在任何视图控制器 viewDidLoad 或 viewWillAppear 方法中使用下面的代码。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    //I am using UIColor yellowColor for an example but you can use whatever color you like   
    self.navigationController.navigationBar.titleTextAttributes = @{NSForegroundColorAttributeName: [UIColor yellowColor]};

    //change the title here to whatever you like
    self.title = @"Home";
    // Do any additional setup after loading the view.
} 
```

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2013-12-08T02:50:18.700

短而甜。

```
[[[self navigationController] navigationBar] setTitleTextAttributes:@{NSForegroundColorAttributeName: [UIColor redColor]}]; 
```

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2010-10-22T14:28:07.290

这是我基于史蒂文斯的解决方案

唯一真正的区别是如果根据文本长度调整位置，我会进行一些处理，这似乎类似于苹果的做法

```
UILabel *titleLabel = [[UILabel alloc] initWithFrame:CGRectMake(([self.title length] < 10 ? UITextAlignmentCenter : UITextAlignmentLeft), 0, 480,44)];
titleLabel.backgroundColor = [UIColor clearColor];
titleLabel.font = [UIFont boldSystemFontOfSize: 20.0f];
titleLabel.shadowColor = [UIColor colorWithWhite:0.0 alpha:0.5];
titleLabel.textAlignment = ([self.title length] < 10 ? UITextAlignmentCenter : UITextAlignmentLeft);
titleLabel.textColor = [UIColor redColor];
titleLabel.text = self.title;
self.navigationItem.titleView = titleLabel;
[titleLabel release]; 
```

您可能需要根据您的字体大小调整 10 值

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2018-06-23T08:41:16.750

斯威夫特 4 & 4.2 版本：

```
 self.navigationController.navigationBar.titleTextAttributes = [NSAttributedString.Key.foregroundColor: UIColor.green] 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2011-05-27T05:37:00.390

我自定义了navigationBar的背景图片和左键项，灰色标题不适合背景。然后我使用：

```
[self.navigationBar setTintColor:[UIColor darkGrayColor]]; 
```

将色调颜色更改为灰色。现在标题是白色的！这就是我想要的。

希望也有帮助:)

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2011-01-21T16:07:19.540

我遇到了导航按钮将文本从中心抛出的问题（当您只有一个按钮时）。为了解决这个问题，我刚刚改变了我的帧大小，如下所示：

```
CGRect frame = CGRectMake(0, 0, [self.title sizeWithFont:[UIFont boldSystemFontOfSize:20.0]].width, 44); 
```

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2012-05-24T18:50:31.047

建议设置 self.title，因为这是在推送子导航栏或在标签栏上显示标题时使用。

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // create and customize title view
        self.title = NSLocalizedString(@"My Custom Title", @"");
        UILabel *titleLabel = [[UILabel alloc] initWithFrame:CGRectZero];
        titleLabel.text = self.title;
        titleLabel.font = [UIFont boldSystemFontOfSize:16];
        titleLabel.backgroundColor = [UIColor clearColor];
        titleLabel.textColor = [UIColor whiteColor];
        [titleLabel sizeToFit];
        self.navigationItem.titleView = titleLabel;
        [titleLabel release];
    }
} 
```

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2015-06-04T15:05:12.567

这是一个非常古老的线程，但我想为 iOS 7 及更高版本的导航栏标题的颜色、大小和垂直位置提供答案

**颜色和尺寸**

```
 NSDictionary *titleAttributes =@{
                                NSFontAttributeName :[UIFont fontWithName:@"Helvetica-Bold" size:14.0],
                                NSForegroundColorAttributeName : [UIColor whiteColor]
                                }; 
```

**对于垂直位置**

```
[[UINavigationBar appearance] setTitleVerticalPositionAdjustment:-10.0 forBarMetrics:UIBarMetricsDefault]; 
```

**设置标题并分配属性字典**

```
[[self navigationItem] setTitle:@"CLUBHOUSE"];
self.navigationController.navigationBar.titleTextAttributes = titleAttributes; 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2017-04-13T02:44:07.160

这在 Swift 中对我有用：

```
navigationController?.navigationBar.titleTextAttributes = [NSForegroundColorAttributeName:UIColor.white] 
```

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2011-01-17T05:28:43.070

Use like this for Orientation support

```
UIView *view = [[UIView alloc] initWithFrame:CGRectMake(0,0,320,40)];
[view setBackgroundColor:[UIColor clearColor]];
[view setAutoresizingMask:UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight ];

UILabel *nameLabel = [[UILabel alloc] init];
[nameLabel setFrame:CGRectMake(0, 0, 320, 40)];
[nameLabel setBackgroundColor:[UIColor clearColor]];
[nameLabel setAutoresizingMask:UIViewAutoresizingFlexibleTopMargin | UIViewAutoresizingFlexibleBottomMargin |UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleLeftMargin];
[nameLabel setTextColor:[UIColor whiteColor]];
[nameLabel setFont:[UIFont boldSystemFontOfSize:17]];
[nameLabel setText:titleString];
[nameLabel setTextAlignment:UITextAlignmentCenter];
[view addSubview:nameLabel];
[nameLabel release];
self.navigationItem.titleView = view;
[view release]; 
```

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2014-10-30T05:39:06.867

```
self.navigationItem.title=@"Extras";
[self.navigationController.navigationBar setTitleTextAttributes: [NSDictionary dictionaryWithObjectsAndKeys:[UIFont fontWithName:@"HelveticaNeue" size:21], NSFontAttributeName,[UIColor whiteColor],UITextAttributeTextColor,nil]]; 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2012-07-09T22:04:27.510

我确实相信设置颜色的正确方法`UINavigationBar`是：

```
NSDictionary *attributes=[NSDictionary dictionaryWithObjectsAndKeys:[UIColor redColor],UITextAttributeTextColor, nil];
self.titleTextAttributes = attributes; 
```

上面的代码是在子类上编写的`UINavigationBar`，显然也可以在没有子类的情况下工作。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2013-11-29T22:35:00.477

使用新的 iOS 7 文本属性和现代目标 c 对 Alex RR 的帖子进行了更新，以减少噪音：

```
NSShadow *titleShadow = [[NSShadow alloc] init];
titleShadow.shadowColor = [UIColor blackColor];
titleShadow.shadowOffset = CGSizeMake(-1, 0);
NSDictionary *navbarTitleTextAttributes = @{NSForegroundColorAttributeName:[UIColor whiteColor],
                                            NSShadowAttributeName:titleShadow};

[[UINavigationBar appearance] setTitleTextAttributes:navbarTitleTextAttributes]; 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2011-09-15T11:18:05.800

设置标题的字体大小我使用了以下条件..可能对任何人都有帮助

```
if ([currentTitle length]>24) msize = 10.0f;
    else if ([currentTitle length]>16) msize = 14.0f;
    else if ([currentTitle length]>12) msize = 18.0f; 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2011-04-14T21:23:40.237

当我们在导航栏中插入按钮时遇到与标签相同的问题（与其他问题一样）之后（在我的情况下，我有一个微调器，我在加载日期时用按钮替换），上述解决方案不起作用对我来说，这就是一直有效并始终将标签保持在同一个地方的方法：

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil

self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self)
{
    // this will appear as the title in the navigation bar
    //CGRect frame = CGRectMake(0, 0, [self.title sizeWithFont:[UIFont boldSystemFontOfSize:20.0]].width, 44);
   CGRect frame = CGRectMake(0, 0, 180, 44);
    UILabel *label = [[[UILabel alloc] initWithFrame:frame] autorelease];

    label.backgroundColor = [UIColor clearColor];
    label.font = [UIFont boldSystemFontOfSize:20.0];
    label.shadowColor = [UIColor colorWithWhite:0.0 alpha:0.5];
    label.textAlignment = UITextAlignmentCenter;
    label.textColor = [UIColor yellowColor];
    self.navigationItem.titleView = label;
    label.text = NSLocalizedString(@"Latest Questions", @"");
    [label sizeToFit];
}

return self; 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2009-03-01T07:11:35.763

这是缺少的东西之一。您最好的选择是创建您自己的自定义导航栏，添加一个文本框，并以这种方式操作颜色。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2012-08-20T10:47:36.710

可以在 appdelegate 文件中使用此方法，并且可以在每个视图中使用

```
+(UILabel *) navigationTitleLable:(NSString *)title
{
CGRect frame = CGRectMake(0, 0, 165, 44);
UILabel *label = [[[UILabel alloc] initWithFrame:frame] autorelease];
label.backgroundColor = [UIColor clearColor];
label.font = NAVIGATION_TITLE_LABLE_SIZE;
label.shadowColor = [UIColor whiteColor];
label.numberOfLines = 2;
label.lineBreakMode = UILineBreakModeTailTruncation;    
label.textAlignment = UITextAlignmentCenter;
[label setShadowOffset:CGSizeMake(0,1)]; 
label.textColor = [UIColor colorWithRed:51/255.0 green:51/255.0 blue:51/255.0 alpha:1.0];

//label.text = NSLocalizedString(title, @"");

return label;
} 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2011-03-16T05:11:30.473

你应该调用 [label sizeToFit]; 在设置文本以防止在其他按钮占据导航栏时标签在标题视图中自动重新定位时出现奇怪的偏移。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2012-10-07T05:51:19.243

titleTextAttributes 显示栏标题文本的属性。

@property(nonatomic, copy) NSDictionary *titleTextAttributes 讨论 您可以使用 NSString UIKit Additions Reference 中描述的文本属性键指定文本属性字典中标题的字体、文本颜色、文本阴影颜色和文本阴影偏移量。

可用性 适用于 iOS 5.0 及更高版本。在 UINavigationBar.h 中声明

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2012-12-31T10:48:40.550

为了使 Erik B 的出色解决方案在您应用程序的不同 UIVIewCOntrollers 中更有用，我建议为 UIViewController 添加一个类别并在其中声明他的 setTitle:title 方法。像这样，您将在所有视图控制器上更改标题颜色，而无需重复。

不过要注意的一件事是您不需要 [super setTItle:tilte]; 在 Erik 的代码中，您需要在视图控制器中显式调用 self.title = @"my new title" 才能调用此方法

```
@implementation UIViewController (CustomeTitleColor)

- (void)setTitle:(NSString *)title
{
    UILabel *titleView = (UILabel *)self.navigationItem.titleView;
    if (!titleView) {
        titleView = [[UILabel alloc] initWithFrame:CGRectZero];
        titleView.backgroundColor = [UIColor clearColor];
        titleView.font = [UIFont boldSystemFontOfSize:20.0];
        titleView.shadowColor = [UIColor colorWithWhite:0.0 alpha:0.5];

        titleView.textColor = [UIColor blueColor]; // Change to desired color

        self.navigationItem.titleView = titleView;
        [titleView release];
    }
    titleView.text = title;
    [titleView sizeToFit];
} 
```

@结尾

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2016-07-12T06:40:45.350

我正在为 iOS 9 使用下面的代码，它对我来说工作正常。我还为标题使用了阴影颜色。

```
self.navigationItem.title = @"MY NAV TITLE";
self.navigationController.navigationBar.barTintColor = [UIColor redColor];
self.navigationController.navigationBar.translucent = NO;
NSShadow *shadow = [[NSShadow alloc] init];
shadow.shadowColor = [UIColor colorWithRed:0.0 green:0.0 blue:0.0 alpha:0.8];
shadow.shadowOffset = CGSizeMake(0, 1);
[self.navigationController.navigationBar setTitleTextAttributes: [NSDictionary dictionaryWithObjectsAndKeys:
                                                       [UIColor colorWithRed:245.0/255.0 green:245.0/255.0 blue:245.0/255.0 alpha:1.0], NSForegroundColorAttributeName,
                                                       shadow, NSShadowAttributeName,
                                                       [UIFont fontWithName:@"HelveticaNeue-Light" size:21.0], NSFontAttributeName, nil]]; 
```

愿这对你有所帮助。

谢谢

# gold-parser - BNF 语法 + Gold LALR 解析器，无法区分特殊情况 NewLine 和 Whitespace

> ID：599409
> 
> 赞同：2
> 
> 时间：2009-03-01T06:57:04.270
> 
> 标签：gold-parser

*   我想将空格和换行符视为普通空格。
*   我想将换行符与其他空格区分开来，以允许特殊情况。

第一次尝试编写合规语法失败。

这是语法：

```
! ------------------------------------------------- Sets

{WS}           = {Whitespace} - {CR} - {LF}
{ID Head}      = {Letter} + [_]
{ID Tail}      = {Alphanumeric} + [_]
{String Chars} = {Printable} + {HT} - ["\]

! ------------------------------------------------- Terminals

! The following defines the Whitespace terminal using the {WS}
! set - which excludes the carriage return and line feed 
! characters

Whitespace    = {WS}+ | {CR}{LF} | {CR} | {LF}
!NewLine       = {CR}{LF} | {CR} | {LF}
MyNewLine      = {CR}{LF} | {CR} | {LF} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-01T07:49:41.443

它们是模棱两可的，因为它们都包含相同的子集`{CR}{LF} | {CR} | {LF}`。

给定输入`{CR}{LF}`，解析器无法判断它应该匹配哪个终端。

表驱动的解析器并不是真正设计用来直接处理“特殊情况”的。如果您想在某些情况下忽略换行符，但在其他情况下将含义赋予它们，那么您必须在您的归约中处理它（即分别标记换行符，并在您的归约中丢弃它们），但这会变得丑陋.

一个（可能）更好的解决方案是使用标记器状态（可能由解析器控制）来更改换行符输入的标记方式。不完全理解你的语法很难说。另外，我已经有几年没有搞砸这些东西了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-01T07:21:31.137

我认为语法是模棱两可的，因为 Whitespace 和 MyNewLine 都匹配换行符。由于它会按照您的方式进行操作，因此我建议分别检测空格和换行符，并根据具体情况决定如何处理换行符。

我在该领域没有太多经验，但这就是我在计算理论课和编译器设计课上所记得的。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-07T06:21:08.270

一个迟到的答案。

令我沮丧的是，我只是一个大器晚成的 ;-) 成员。

继续使用通常的基于行的语法声明

```
! ====================================================================
{Whitespace Ch} = {Whitespace} - {CR} - {LF}

Whitespace = {Whitespace Ch}+
Newline    = {CR}{LF} | {CR} | {LF}
! ==================================================================== 
```

空格和换行的区别已经被考虑在内了！

在编写生产规则时考虑解决您的特殊情况。

对于复杂的情况，您甚至可能需要定义一些虚拟终端（高级技术）。

您可以详细说明您的语法并通过再次发布来询问。

**最后编辑**：如果您已经解决了这个问题，请分享。谢谢。

# asp.net - 动态 UI 与静态 UI

> ID：599412
> 
> 赞同：1
> 
> 时间：2009-03-01T06:58:29.163
> 
> 标签：asp.net, wpf, user-interface, code-duplication

我一直在想，我应该在什么时候放弃静态数据输入表单的便利性以及对动态 UI 的设计器支持，从而消除大量代码重复？

在编程世界中似乎存在冲突，人们不断地尝试删除代码重复以提高可维护性，但是当涉及到表单时，一切都消失了，一切都被明确地添加到表单中。

我应该寻找什么迹象才能知道什么时候该让设计师尘埃落定并创建动态 UI？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-01T07:17:20.460

动态 UI 适用于某些类型的数据和某些业务流程

大多数情况下，一旦出现任何级别的复杂性，它们就会看起来很丑

我使用一个模型来定义由以下组成的动态表单：组框架、标签、文本框、数字框、选项按钮和 WPF 中的复选框

它适用于填写基本数据以控制模板化文档和目录的创建

但我认为它不适用于具有复杂层次结构等的典型业务数据

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-23T07:46:39.517

我可以谦虚地建议[Metawidget](http://metawidget.org)吗？

正如您所说，它不会尝试“生成整个 UI”。它只是一个“在具有大量共同点的复杂表单系统中生成重复代码”的系统。

如果您有机会看一看，我很乐意在我们的论坛上听到您的反馈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T11:17:20.103

UI 必须针对用户工作流程进行优化，必须使数据输入方便并且必须看起来不错，如果不是不可能的话，为具有现实世界复杂性的任何事物自动生成这样的 UI 是很困难的。

# java - 我可以更改连接的最大池大小吗？什么决定了我应该将其设置为什么？

> ID：599422
> 
> 赞同：3
> 
> 时间：2009-03-01T07:15:44.287
> 
> 标签：java

我们的 J2EE 应用程序遇到以下错误：

> java.sql.SQLException：分配连接时出错。原因：使用中的连接等于 max-pool-size 和过期的 max-wait-time。无法分配更多连接。

我如何知道应用程序当前正在使用多少个连接，以及对于流量很大的应用程序来说，最佳连接池设置应该是什么？我可以更改它吗？如何确定我应该将其设置为什么（是内存问题、带宽等）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-01T07:22:44.380

> 如何知道应用程序当前使用了多少连接

你没有提供足够的信息来回答这个问题。大多数应用服务器都会有一些关于此类事情的 JMX 报告。或者，根据数据库，您可以找到当前打开的连接数。

> 对于高流量应用程序，最佳连接池设置应该是什么

比你所拥有的还高？

当然，上面假设您没有错误处理连接。我的意思是如果你直接在代码中使用它们，你应该总是使用这个成语：

```
Connection conn = null;
try {
  conn = ... ; // get connection
  // do stuff
} finally {
  if (conn != null) try { conn.close(); } catch (Exception e) { }
} 
```

如果您没有将连接释放回池并等待垃圾收集器清理它们并释放它们，那么您将使用更多实际需要的连接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T10:53:09.570

首先要检查的是您是否有资源泄漏。尝试使用 jconsole 或 jvisualvm 进行监视，以查看您的应用程序的行为方式以及是否有什么让您眼前一亮的东西。

那么实际的 jdbc 池连接本质上是特定于 Java EE 容器的，因此您需要提供更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-01T07:31:55.857

你确定你正在关闭你需要的一切吗？看看[这里](http://www.java2s.com/Code/JavaAPI/javax.sql/ConnectionPoolDataSourcegetPooledConnection.htm)。

确保关闭进入 finally 块。您将在链接中看到此代码：

```
finally 
{
   closeAll(resultSet, statement, connection);
} 
```

我帮助其他人找到了一个类似的问题（他们的问题是内存问题......但如果这个过程持续的时间更长，它会得到这个结果）他们没有关闭结果集或连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T09:12:25.833

I think you may need to inspect ask yourself some questions, here are some to think about:

A. Are you using youre connections correctly, are you closing them and returning them to the pool after usage?

B. Are you using long running transactions, e.g. "conversations" with users? Can they be left hanging if the user terminates his usage of the application?

C. Have you designed your data access to fit your application? E.g. are you using caching techniques in areas where you expect repeated reads frequently?

D. Are your connection pool big enough? 5 years ago I had a application with 250 simultaneous connections towards a Oracle database, a lot more than what you typically find out of the box. running the application on say 50 didn't work.

To give more detailed answer, you need to provide more info on the app.

Good luck!

# php - 从当前页面打印另一页并传递一个值

> ID：599427
> 
> 赞同：0
> 
> 时间：2009-03-01T07:21:28.580
> 
> 标签：php, javascript, ajax

嗨，我需要在打印下一页之前对其进行验证...我所做的是我在第一页中使用了 i 框架并调用了我需要打印的页面，但它在第一页中触发了应该在提交后的第二页或单击按钮...

所以我需要在单击调用javascript中的函数的按钮后触发php函数我应该怎么做？

任何人都可以帮助我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T08:18:07.743

> *所以我需要在单击调用javascript中的函数的按钮后触发php函数我应该怎么做？*

我不太清楚你为什么需要这样做，但它就在这里......

在按钮单击处理程序中，您要进行 AJAX 调用。我使用 jQuery，但你可以使用任何你想要的框架或 XMLHttpRequest 函数。

```
<html>
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript">
    function ButtonClickHanlder( e ) {
        // Prevent the button from doing something it's normal functions(ie submit form if it is a submit)
        e.preventDefault();
        // Make AJAX Call
        $.post("test.php", { call: "callMe" },
            function(data){
                alert("Data Loaded: " + data);
            }
        );
    }

    $(function(){

        $('#clicker').click(ButtonClickHanlder);
    });
    </script>
</head>

<body>
<a id="clicker" href="#">test</a>

</body>
</html> 
```

参考：[http ://docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)

test.php 页面

```
<?php

if(isset($_POST['call']) && $_POST['call'] == 'callMe') {
    callMe();
}

function callMe() {
   echo "I am a php function. You rang?";
}

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T22:18:17.503

好吧，我不熟悉你的PHP知识水平，所以我从一些基础开始：

PHP 是一种服务器端脚本语言。它在请求页面时实时编译。服务器处理 HTML 和 PHP，并向浏览器提供仅 HTML 页面。您不能在客户端执行 PHP 代码。如果不使用 AJAX，就无法在按下按钮时运行 PHP 代码。您可以使用 AJAZ 在按下按钮时向服务器发出请求，并用输出填充 iFrame。

希望有帮助。

# python - 为什么weakref 不适用于这种绑定方法？

> ID：599430
> 
> 赞同：11
> 
> 时间：2009-03-01T07:23:20.820
> 
> 标签：python, weak-references

我有一个项目，我试图在回调中使用弱引用，但我不明白我做错了什么。我创建了简化的测试，显示了我感到困惑的确切行为。

为什么在这个测试中 test_a 按预期工作，但是 self.MyCallbackB 的弱引用在类初始化和调用 test_b 之间消失了？我想只要实例 (a) 存在，对 self.MyCallbackB 的引用就应该存在，但它不存在。

```
import weakref

class A(object):
    def __init__(self):

        def MyCallbackA():
            print 'MyCallbackA'
        self.MyCallbackA = MyCallbackA

        self._testA = weakref.proxy(self.MyCallbackA)
        self._testB = weakref.proxy(self.MyCallbackB)

    def MyCallbackB(self):
        print 'MyCallbackB'

    def test_a(self):
        self._testA()

    def test_b(self):
        self._testB()

if __name__ == '__main__':
    a = A()    
    a.test_a()
    a.test_b() 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-01T08:16:06.513

你想要一个[WeakMethod](http://code.activestate.com/recipes/81253/)。

可以在配方的讨论中找到您的解决方案不起作用的解释：

> 绑定方法的普通weakref.refs 并不像人们期望的那样工作，因为绑定方法是一等对象；除非存在对同一绑定方法的其他强引用，否则**对绑定方法的弱引用是死的。**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-01T08:27:33.647

根据 Weakref 模块的文档：

> 在下文中，术语所指对象是指被弱引用引用的对象。
> 
> 对对象的弱引用不足以使对象保持活动状态：当对所指对象的唯一剩余引用是弱引用时，垃圾收集可以自由地销毁所指对象并将其内存用于其他用途。

MyCallbackA 发生的事情是您在 A 的实例中持有对它的引用，这要归功于 -

```
self.MyCallbackA = MyCallbackA 
```

现在，您的代码中没有对绑定方法 MyCallbackB 的引用。它仅作为未绑定方法保存在 a.__class__.__dict__ 中。基本上，当您执行 self.methodName 时，会创建一个绑定方法（并返回给您）。（AFAIK，绑定方法的工作方式类似于使用描述符（只读）的属性：至少对于新样式类。我敢肯定，旧样式类会发生类似的事情，即没有描述符。我将其留给更有经验的人来验证有关旧样式类的声明。）因此， self.MyCallbackB 在创建弱引用后立即死亡，因为没有对它的强引用！

我的结论基于：-

```
import weakref

#Trace is called when the object is deleted! - see weakref docs.
def trace(x):
    print "Del MycallbackB"

class A(object):
    def __init__(self):

        def MyCallbackA():
            print 'MyCallbackA'
        self.MyCallbackA = MyCallbackA
        self._testA = weakref.proxy(self.MyCallbackA)
        print "Create MyCallbackB"
        # To fix it, do -
        # self.MyCallbackB = self.MyCallBackB
        # The name on the LHS could be anything, even foo!
        self._testB = weakref.proxy(self.MyCallbackB, trace)
        print "Done playing with MyCallbackB"

    def MyCallbackB(self):
        print 'MyCallbackB'

    def test_a(self):
        self._testA()

    def test_b(self):
        self._testB()

if __name__ == '__main__':
    a = A()  
    #print a.__class__.__dict__["MyCallbackB"] 
    a.test_a() 
```

**输出**

> Create MyCallbackB
> Del MycallbackB
> Done play with MyCallbackB
> MyCallbackA

**注意：**
我尝试为旧样式类验证这一点。原来“print a.test_a.__get__”输出——

`<method-wrapper '__get__' of instancemethod object at 0xb7d7ffcc>`

适用于新旧风格的课程。所以它可能不是真正的描述符，只是类似描述符的东西。无论如何，重点是当你通过 self 访问一个实例方法时会创建一个绑定方法对象，除非你保持对它的强引用，否则它将被删除。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-18T01:05:09.763

其他答案解决了原始问题中的*原因*，但要么不提供解决方法，要么参考外部站点。

在阅读了 StackExchange 上有关此主题的其他几篇文章（其中许多被标记为该问题的重复）之后，我终于找到了一个简洁的解决方法。当我知道我正在处理的对象的性质时，我使用了 weakref 模块；当我可能正在处理绑定方法时（就像在使用事件回调时在我的代码中发生的那样），我现在使用以下 WeakRef 类作为weakref.ref() 的直接替代品。我已经在 Python 2.4 到 Python 2.7 （包括 Python 2.7）上对此进行了测试，但在 Python 3.x 上没有。

```
class WeakRef:

    def __init__ (self, item):

        try:
            self.method   = weakref.ref (item.im_func)
            self.instance = weakref.ref (item.im_self)

        except AttributeError:
            self.reference = weakref.ref (item)

        else:
            self.reference = None

    def __call__ (self):

        if self.reference != None:
            return self.reference ()

        instance = self.instance ()

        if instance == None:
            return None

        method = self.method ()

        return getattr (instance, method.__name__) 
```

# c# - 自定义控件以显示图像：将图像移动到内部

> ID：599436
> 
> 赞同：0
> 
> 时间：2009-03-01T07:30:35.453
> 
> 标签：c#, compact-framework, custom-controls, onpaint

我正在为**Windows Mobile开发****C#**应用程序。我有一个自定义控件，**重写了 OnPaint**以绘制用户使用指针移动的图像。我自己的 OnPaint 方法是这样的：

 ****```
 protected override void OnPaint(PaintEventArgs e)
{
    Graphics gxOff; //Offscreen graphics
    Brush backBrush;

    if (m_bmpOffscreen == null) //Bitmap for doublebuffering
    {
        m_bmpOffscreen = new Bitmap(ClientSize.Width, ClientSize.Height);
    }

    gxOff = Graphics.FromImage(m_bmpOffscreen);

    gxOff.Clear(Color.White);

    backBrush = new SolidBrush(Color.White);
    gxOff.FillRectangle(backBrush, this.ClientRectangle);

    //Draw some bitmap
    gxOff.DrawImage(imageToShow, 0, 0, rectImageToShow, GraphicsUnit.Pixel);

    //Draw from the memory bitmap
    e.Graphics.DrawImage(m_bmpOffscreen,  this.Left, this.Top);

    base.OnPaint(e);
} 

```

imageToShow它**是**图像。

rectImageToShow**以**这种方式在事件 OnResize 上初始化：

```
rectImageToShow = 
   new Rectangle(0, 0, this.ClientSize.Width, this.ClientSize.Height); 

```

**this.Top**和**this.Left**是在自定义控件内绘制图像的左上角。

我认为它可以正常工作，但是当我移动图像时，它永远不会清除所有控件。我总是看到上一张图的一部分。

我做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T08:59:00.670

我认为您还没有清除控件的图像缓冲区。您只清除了后台缓冲区。在 2 个 DrawImage 调用之间试试这个：

```
e.Graphics.Clear(Color.White); 
```

这应该首先清除任何剩余的图像。

* * *

或者，您可以重写它，以便将所有内容绘制到后台缓冲区，然后将后台缓冲区准确绘制到屏幕上 (0, 0)，因此任何问题都将是由于后台缓冲区绘制逻辑而不是介于两者之间的某个位置。

像这样的东西：

```
Graphics gxOff; //Offscreen graphics
Brush backBrush;

if (m_bmpOffscreen == null) //Bitmap for doublebuffering
{
    m_bmpOffscreen = new Bitmap(ClientSize.Width, ClientSize.Height);
}

// draw back buffer
gxOff = Graphics.FromImage(m_bmpOffscreen);

gxOff.Clear(Color.White);

backBrush = new SolidBrush(Color.White);

gxOff.FillRectangle(backBrush, this.Left, this.Top,
    this.ClientRectangle.Width,
    this.ClientRectangle.Height);

//Draw some bitmap
gxOff.DrawImage(imageToShow, this.Left, this.Top, rectImageToShow, GraphicsUnit.Pixel);

//Draw from the memory bitmap
e.Graphics.DrawImage(m_bmpOffscreen,  0, 0);

base.OnPaint(e); 
```

不确定这是否正确，但你应该明白。

# design-patterns - 开源软件中状态模式的示例？

> ID：599439
> 
> 赞同：2
> 
> 时间：2009-03-01T07:33:28.580
> 
> 标签：design-patterns, oop

这个问题说明了一切。最好在 c# 或 java 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T07:59:48.160

这是一个使用状态模式的[演示项目](http://www.codeproject.com/KB/architecture/statepattern3.aspx)

# android - 如何挂断Android中的拨出电话？

> ID：599443
> 
> 赞同：48
> 
> 时间：2009-03-01T07:37:55.310
> 
> 标签：android, telephony, telephonymanager

我正在开发一个应用程序，其中我们需要的一件事是控制传出呼叫，至少能够从我们的应用程序中阻止它。

我尝试使用`Intent.ACTION_CALL`现有活动：

```
Intent callIntent = new Intent(Intent.ACTION_CALL, Uri.parse("tel:" + phoneNumber)); 
startActivity(callIntent); 
```

但是似乎不允许通过 API 停止调用。

你能建议一些解决方法吗？

例如：通话期间开启飞行模式？只是一个例子；这个黑客对我不起作用。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2011-03-15T15:54:51.503

已经提到捕获拨出电话，`BroadcastReceiver`如果您想在拨号前结束通话，这绝对是最好的方法。

但是，一旦拨号或通话，该技术就不再有效。到目前为止，我遇到的唯一挂断方法是通过 Java [Reflection](http://en.wikipedia.org/wiki/Reflection_%28computer_science%29)来挂断。由于它不是公共 API 的一部分，因此您应该*小心使用它，而不是依赖它*。对 Android 内部构成的任何更改都会有效地破坏您的应用程序。

[Prasanta Paul 的博客展示](http://prasanta-paul.blogspot.com/2010/09/call-control-in-android.html)了它是如何实现的，我在下面进行了总结。

获取`ITelephony`对象：

```
TelephonyManager tm = (TelephonyManager) context
        .getSystemService(Context.TELEPHONY_SERVICE);
try {
    // Java reflection to gain access to TelephonyManager's
    // ITelephony getter
    Log.v(TAG, "Get getTeleService...");
    Class c = Class.forName(tm.getClass().getName());
    Method m = c.getDeclaredMethod("getITelephony");
    m.setAccessible(true);
    com.android.internal.telephony.ITelephony telephonyService =
            (ITelephony) m.invoke(tm);
} catch (Exception e) {
    e.printStackTrace();
    Log.e(TAG,
            "FATAL ERROR: could not connect to telephony subsystem");
    Log.e(TAG, "Exception object: " + e);
} 
```

结束通话：

```
telephonyService.endCall(); 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2011-12-05T02:33:14.323

**编辑：**对于 Android P 或更新版本，请参阅：[https ://stackoverflow.com/a/51121175/450148](https://stackoverflow.com/a/51121175/450148)

尝试这个：

（我使用[反射来访问高级电话功能](https://stackoverflow.com/questions/2001146/reflection-to-access-advanced-telephony-features)并修改一些东西）

```
// required permission <uses-permission android:name="android.permission.CALL_PHONE"/>

try {
    //String serviceManagerName = "android.os.IServiceManager";
    String serviceManagerName = "android.os.ServiceManager";
    String serviceManagerNativeName = "android.os.ServiceManagerNative";
    String telephonyName = "com.android.internal.telephony.ITelephony";

    Class telephonyClass;
    Class telephonyStubClass;
    Class serviceManagerClass;
    Class serviceManagerStubClass;
    Class serviceManagerNativeClass;
    Class serviceManagerNativeStubClass;

    Method telephonyCall;
    Method telephonyEndCall;
    Method telephonyAnswerCall;
    Method getDefault;

    Method[] temps;
    Constructor[] serviceManagerConstructor;

    // Method getService;
    Object telephonyObject;
    Object serviceManagerObject;

    telephonyClass = Class.forName(telephonyName);
    telephonyStubClass = telephonyClass.getClasses()[0];
    serviceManagerClass = Class.forName(serviceManagerName);
    serviceManagerNativeClass = Class.forName(serviceManagerNativeName);

    Method getService = // getDefaults[29];
    serviceManagerClass.getMethod("getService", String.class);

    Method tempInterfaceMethod = serviceManagerNativeClass.getMethod(
                "asInterface", IBinder.class);

    Binder tmpBinder = new Binder();
    tmpBinder.attachInterface(null, "fake");

    serviceManagerObject = tempInterfaceMethod.invoke(null, tmpBinder);
    IBinder retbinder = (IBinder) getService.invoke(serviceManagerObject, "phone");
    Method serviceMethod = telephonyStubClass.getMethod("asInterface", IBinder.class);

    telephonyObject = serviceMethod.invoke(null, retbinder);
    //telephonyCall = telephonyClass.getMethod("call", String.class);
    telephonyEndCall = telephonyClass.getMethod("endCall");
    //telephonyAnswerCall = telephonyClass.getMethod("answerRingingCall");

    telephonyEndCall.invoke(telephonyObject);

} catch (Exception e) {
    e.printStackTrace();
    Log.error(DialerActivity.this,
                "FATAL ERROR: could not connect to telephony subsystem");
    Log.error(DialerActivity.this, "Exception object: " + e);
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-03-12T03:44:13.313

1.  创建一个`BroadcastReceiver`优先级为 0 的。
2.  在 BC 中拦截其方法中的`ACTION_NEW_OUTGOING_CALL`意图`onReceive`
3.  `setResultData(null)`用同样的方法调用

这将阻止呼叫启动（只要您的接收者是最后一个处理我认为的意图的人）

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-07-01T07:12:02.457

这是最新的代码，它也适用于 Android P，因为它有一个官方 API（[**这里**](https://developer.android.com/reference/android/telecom/TelecomManager.html#endCall())）：

在清单中，添加以下内容：

```
<uses-permission android:name="android.permission.ANSWER_PHONE_CALLS"/> 
```

在代码中，使用这个：

爪哇：

```
@SuppressLint("PrivateApi")
public static boolean endCall(Context context) {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.P) {
        final TelecomManager telecomManager = (TelecomManager) context.getSystemService(Context.TELECOM_SERVICE);
        if (telecomManager != null && ContextCompat.checkSelfPermission(context, Manifest.permission.ANSWER_PHONE_CALLS) == PackageManager.PERMISSION_GRANTED) {
            telecomManager.endCall();
            return true;
        }
        return false;
    }
    //use unofficial API for older Android versions, as written here: https://stackoverflow.com/a/8380418/878126
    try {
        final Class<?> telephonyClass = Class.forName("com.android.internal.telephony.ITelephony");
        final Class<?> telephonyStubClass = telephonyClass.getClasses()[0];
        final Class<?> serviceManagerClass = Class.forName("android.os.ServiceManager");
        final Class<?> serviceManagerNativeClass = Class.forName("android.os.ServiceManagerNative");
        final Method getService = serviceManagerClass.getMethod("getService", String.class);
        final Method tempInterfaceMethod = serviceManagerNativeClass.getMethod("asInterface", IBinder.class);
        final Binder tmpBinder = new Binder();
        tmpBinder.attachInterface(null, "fake");
        final Object serviceManagerObject = tempInterfaceMethod.invoke(null, tmpBinder);
        final IBinder retbinder = (IBinder) getService.invoke(serviceManagerObject, "phone");
        final Method serviceMethod = telephonyStubClass.getMethod("asInterface", IBinder.class);
        final Object telephonyObject = serviceMethod.invoke(null, retbinder);
        final Method telephonyEndCall = telephonyClass.getMethod("endCall");
        telephonyEndCall.invoke(telephonyObject);
        return true;
    } catch (Exception e) {
        e.printStackTrace();
        LogManager.e(e);
    }
    return false;
} 
```

或在 Kotlin 中：

```
@SuppressLint("PrivateApi")
fun endCall(context: Context): Boolean {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.P) {
        val telecomManager = context.getSystemService(Context.TELECOM_SERVICE) as TelecomManager
        if (ContextCompat.checkSelfPermission(context, Manifest.permission.ANSWER_PHONE_CALLS) == PackageManager.PERMISSION_GRANTED) {
            telecomManager.endCall()
            return true
        }
        return false
    }
    //use unofficial API for older Android versions, as written here: https://stackoverflow.com/a/8380418/878126
    try {
        val telephonyClass = Class.forName("com.android.internal.telephony.ITelephony")
        val telephonyStubClass = telephonyClass.classes[0]
        val serviceManagerClass = Class.forName("android.os.ServiceManager")
        val serviceManagerNativeClass = Class.forName("android.os.ServiceManagerNative")
        val getService = serviceManagerClass.getMethod("getService", String::class.java)
        val tempInterfaceMethod = serviceManagerNativeClass.getMethod("asInterface", IBinder::class.java)
        val tmpBinder = Binder()
        tmpBinder.attachInterface(null, "fake")
        val serviceManagerObject = tempInterfaceMethod.invoke(null, tmpBinder)
        val retbinder = getService.invoke(serviceManagerObject, "phone") as IBinder
        val serviceMethod = telephonyStubClass.getMethod("asInterface", IBinder::class.java)
        val telephonyObject = serviceMethod.invoke(null, retbinder)
        val telephonyEndCall = telephonyClass.getMethod("endCall")
        telephonyEndCall.invoke(telephonyObject)
        return true
    } catch (e: Exception) {
        e.printStackTrace()
        return false
    }
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-06-18T08:44:27.993

您可以尝试启用然后禁用飞行模式：

```
android.provider.Settings.System.putInt(getContentResolver(),
        android.provider.Settings.System.AIRPLANE_MODE_ON, 1);

Intent intent = new Intent(Intent.ACTION_AIRPLANE_MODE_CHANGED);
intent.putExtra("state", 1);
sendBroadcast(new Intent("android.intent.action.AIRPLANE_MODE"));
sendBroadcast(intent);
android.provider.Settings.System.putInt(getContentResolver(),
        android.provider.Settings.System.AIRPLANE_MODE_ON, 0);

intent.putExtra("state", 0);
sendBroadcast(new Intent("android.intent.action.AIRPLANE_MODE"));
sendBroadcast(intent); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-08-31T20:16:57.260

对于伊拉娜：

```
public class ilanasReceiver extends BroadcastReceiver {
    public void onReceive(Context context, Intent intent) {
        if (intent.getAction().equals(Intent.ACTION_NEW_OUTGOING_CALL)) {
            if (getResultData()!=null) {
                String number = "123456";
                setResultData(number);
            }
        }
    }
} 
```

此外在 Manifest put in package 部分：

```
<uses-permission android:name="android.permission.PROCESS_OUTGOING_CALLS" /> 
```

就这些。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-01T20:08:48.530

考虑到潜在的恶作剧，如果允许的话，我会感到惊讶。

这个线程直截了当地说[API 不能结束一个调用](http://groups.google.com/group/android-beginners/browse_thread/thread/8c1a674c83908efa)。其他人[已经尝试过了](http://groups.google.com/group/android-developers/browse_thread/thread/8b5771764f14c085)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-31T02:48:14.557

根据 ACTION_NEW_OUTGOING_CALL 上的文档

> Intent 将具有以下额外价值：
> 
> EXTRA_PHONE_NUMBER - 最初打算拨打的电话号码。
> 
> 广播结束后，resultData 将用作实际调用的号码。如果为 null，则不会发出任何呼叫。

# weather - 如何在php中自动显示天气脚本更新？

> ID：599446
> 
> 赞同：0
> 
> 时间：2009-03-01T07:43:58.417
> 
> 标签：weather

我想在我的网站上获取天气信息，这些信息应该每天自动更新，你能帮我编写天气信息的脚本吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T11:59:21.437

我在 mashape 上提供了一个[Weather API ，他们有一个可以使用的简单 PHP SDK。](http://metwit.com/developers/)这个 api 使用起来非常简单，因为我们使用了当今可用的很酷的标准，比如 JSON 和 REST。

如果您喜欢它，请在[mashape上尝试一下](http://www.mashape.com/metwit/weather-and-forecast)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T07:52:45.510

前往 Weather.com 并注册一个[Weather Widget](http://www.weather.com/services/weather-gadgets/?from=hp_tools)。这是您将放置在页面上的 javascript 脚本，它独立于所使用的服务器端语言。另请注意，您根本不必每天更新天气：脚本将始终只提取当前天气预报。您必须提供有关您想要了解天气的区域的信息（例如邮政编码）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T07:54:00.747

如果您希望按计划自动更新数据，请查看`cron`（在 Unix 系统上）或其等效项。如果您使用的是商业网络主机，他们应该有办法安排节目；否则，请查看您自己系统的文档以获取调度脚本。

接下来，您要编写一个脚本来下载当时的天气*信息*。允许此脚本从“源”格式转换为您自己的格式。

让调度程序每天运行一次您的脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T18:21:25.037

Weather.com 的替代方案是[Weather Underground](http://www.wunderground.com/)。这是一个成功的天气预报网站，覆盖了世界大部分地区（你不会说你需要预报的地方）。他们有一些免费的东西，叫做[天气贴纸](http://wiki.wunderground.com/index.php/Weather_Stickers)，提供当前观察到的天气情况的实时信息。您只需在页面中嵌入图像。像这样：

[![点击查看英国伦敦预报](https://i.stack.imgur.com/Bao1P.gif)](https://i.stack.imgur.com/Bao1P.gif)
[（来源：[wunderground.com](http://weathersticker.wunderground.com/weathersticker/big2_cond/language/www/global/stations/03772.gif)）]

他们还提供天气预报[XML 提要和 API](http://wiki.wunderground.com/index.php/API_-_XML)。

# sql-server - 在 SQL Server 中查找锁定的表

> ID：599453
> 
> 赞同：32
> 
> 时间：2009-03-01T07:51:35.870
> 
> 标签：sql-server, sql-server-2008, sql-server-2005, sql-server-2012, sql-server-2008-r2

我们如何才能找到数据库中被锁定的表？请，建议。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-03-01T09:21:54.077

您可以使用[`sp_lock`](http://msdn.microsoft.com/en-us/library/ms187749.aspx)(and `sp_lock2`)，但在 SQL Server 2005 及以后的版本中，不推荐使用此方法，而支持查询[`sys.dm_tran_locks`](http://technet.microsoft.com/en-us/library/ms190345.aspx)：

```
select  
    object_name(p.object_id) as TableName, 
    resource_type, resource_description
from
    sys.dm_tran_locks l
    join sys.partitions p on l.resource_associated_entity_id = p.hobt_id 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-01T08:56:55.387

[sp_lock](http://msdn.microsoft.com/en-us/library/aa238824(SQL.80).aspx)

When reading sp_lock information, use the OBJECT_NAME( ) function to get the name of a table from its ID number, for example:

SELECT object_name(16003073)

EDIT :

There is another proc provided by microsoft which reports objects without the ID translation : [http://support.microsoft.com/kb/q255596/](http://support.microsoft.com/kb/q255596/)

# javascript - 流媒体视频如何工作？

> ID：599457
> 
> 赞同：7
> 
> 时间：2009-03-01T07:56:24.690
> 
> 标签：javascript, video, streaming, flv, progressive-download

所以我有一些 .flv 格式的视频，我希望人们能够从我的网站上观看，而无需下载它们。到目前为止，[Flowplayer](http://flowplayer.org/)似乎是实际 Flash 播放器的最佳选择。

但是，我一直在研究这个视频流的东西，因为它应该使视频观看速度非常快，并允许寻找视频的中间等。我需要什么才能让它工作，我需要有吗？一些特殊的服务器软件呢？以及如何使用我将用于显示视频的 javascript/PHP 代码与该软件集成？

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-01T08:11:16.417

好消息！您不需要特殊的软件，大多数合理的 Web 服务器可以开箱即用地完成所有这些工作。你所描述的，以及 Youtube 和其他人所做的，实际上并不是流媒体。它被称为渐进式下载。

基本上 SWF 播放器（在您的情况下为 flowplayer）正在下载 FLV 视频，并播放它到目前为止下载的内容。要跳到它已经下载的一些视频，它会在下载的文件中寻找。为了跳过已经下载的内容，它会丢弃下载的文件并开始新的下载，但它会要求 HTTP 服务器开始以某个偏移量向它提供文件。值得庆幸的是，大多数 HTTP 服务器可以开箱即用地做到这一点。

因此，您只需将 FLV 文件放在可通过 HTTP 公开下载的位置（只需使用浏览器测试即可）。假设您将 flowplayer 放在您网站上的 /flowplayer.swf 中，并且视频是 /2girls1cup.flv，您可以将其插入到您的页面中：

```
<script src="http://static.flowplayer.org/js/flowplayer-3.0.6.min.js"></script>

<!-- Edit this with the width and height to display the video -->
<a  
    href="/2girls1cup.flv"  
    style="display:block;width:425px;height:300px;"  
    id="player"> 
</a> 

<!-- this script block will install Flowplayer inside previous anchor tag --> 
<script language="JavaScript"> 
    flowplayer("player", "/flowplayer.swf"); 
</script> 
```

我从[flowplayer 演示页面](http://flowplayer.org/demos/index.html)中获取了这个示例，其中有很多自定义 flowplayer 的方法的更多示例，它的行为和显示方式。

实际的流媒体服务器有两种更好的方式。一种是对流进行多播，其中所有客户端都在视频中的同一位置，这在服务器上更容易。另一个是能够为同一流提供多种不同的编码，例如，客户端可以以最匹配其播放能力的比特率播放视频。

[许多](http://www.google.com/search?client=safari&rls=en-us&q=microsoft+streaming+server&ie=UTF-8&oe=UTF-8) [公司投入大量资金](http://www.apple.com/quicktime/streamingserver/)[，](http://www.adobe.com/products/flashmediaserver/) 认为这对于视频在网络上的起飞非常重要。看起来他们都错了。流媒体服务器主要用于企业世界，这可能解释了它们的企业价格。

# ruby-on-rails - 从 RoR 模型中获取两个随机元素

> ID：599459
> 
> 赞同：4
> 
> 时间：2009-03-01T07:57:01.957
> 
> 标签：ruby-on-rails

我正在尝试将 RoR 用于一些简单的事情，但在学习基础知识时遇到了一些麻烦。我最接近的背景是 ASP.NET MVC，但我发现所有的 RoR 教程都专注于 rails 真正擅长的东西（脚手架的东西），而不是如何制作自己的动作并让它们用参数等做一些事情。在 ASP.NET MVC 中微不足道）。

目前我正试图从模型中取出两个随机元素。

我想我正在处理某种 ActiveRecord 集合？

我读过在集合/数组的某个地方有一个 .rand 方法，尽管其他地方表明 rand 只是一种将随机数提高到一定数量的方法。我什至无法让以下代码工作：

```
def index
    @items = Array.new(Item[0], Item[0])

    respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @domain }
    end
end 
```

任何可以对此有所帮助的东西，以及理想情况下有助于从 ASP.NET MVC 到 RoR 的进一步修补，将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-01T10:10:29.297

从 ActiveRecord 模型中检索两个随机项目：

```
@things = Thing.all(:order => 'RANDOM()', :limit => 2) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-01T10:35:50.670

如果您想要数据库中的 2 个随机项目，则向数据库询问 2 个随机项目：

```
@items = Item.find(:all, :limit => 2, :order => "RANDOM()") 
```

`Item`如果您只使用 2，那么从系统中加载所有 s 是没有意义的，这是一种浪费。

如果您*已经*从其他地方获得了一个需要从中获取随机值的数组，那么 Rails 会[`rand`](http://api.rubyonrails.org/classes/ActiveSupport/CoreExtensions/Array/RandomAccess.html#M001171)向 Array 类添加一个方法：

```
@items = [my_arr.rand, my_arr.rand] 
```

我不知道您要做什么，`Item[0]`但这在 Rails 中没有任何意义。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-01T08:14:59.963

你的模型是什么样的？我不确定你想在那里用 Item[0] 做什么。为了随机化您的数组，您可以执行以下操作：

```
@items = ["item1", "item2", "item3"].sort_by {rand} 
```

那么你可以只做 @items[0] 和 @items[1] 来获得随机数组的 2 个项目。

至于参数，您可以使用参数哈希从查询字符串中获取任何表单变量或请求参数：

```
params[:user] 
```

符号名称只是查询字符串中表单字段或参数的名称。

Rails 控制器通常包含一个或多个 restful 操作（索引、显示、新建、创建、删除、编辑、更新），如果您已将其路由为资源，但添加自己的操作只需向控制器添加新方法，在 routes.rb 中路由该操作，并使用该操作的名称创建一个视图。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-01T08:47:51.647

有关您的模型和您要完成的工作的更多信息会有所帮助，但是如果您尝试从 sqlite 之类的数据库中提取随机记录，您可以执行以下操作：

```
@item = Items.find(:first, :order => 'RANDOM()') 
```

`Items`你的模型课在哪里。这`'RANDOM()'`只是一个传递给数据库的字符串，告诉它如何排序，因此您必须进行调整以匹配您正在使用的任何数据库。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-14T16:16:07.777

使用 Mysql 数据库使用 RAND() 而不是 RANDOM()

```
@items = Item.find(:all, :limit => 2, :order => "RAND()") 
```

# sql - 您如何使用连接执行 AND？

> ID：599461
> 
> 赞同：1
> 
> 时间：2009-03-01T07:57:37.183
> 
> 标签：sql, mysql, join, left-join

我有以下数据结构和数据：

```
CREATE TABLE `parent` (
  `id` int(11) NOT NULL auto_increment,
  `name` varchar(10) NOT NULL,
  PRIMARY KEY  (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

INSERT INTO `parent` VALUES(1, 'parent 1');
INSERT INTO `parent` VALUES(2, 'parent 2');

CREATE TABLE `other` (
  `id` int(11) NOT NULL auto_increment,
  `name` varchar(10) NOT NULL,
  PRIMARY KEY  (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

INSERT INTO `other` VALUES(1, 'other 1');
INSERT INTO `other` VALUES(2, 'other 2');

CREATE TABLE `relationship` (
  `id` int(11) NOT NULL auto_increment,
  `parent_id` int(11) NOT NULL,
  `other_id` int(11) NOT NULL,
  PRIMARY KEY  (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

INSERT INTO `relationship` VALUES(1, 1, 1);
INSERT INTO `relationship` VALUES(2, 1, 2);
INSERT INTO `relationship` VALUES(3, 2, 1); 
```

我想找到其他 1 和 2 的父记录。

这是我想出来的，但我想知道是否有更好的方法：

```
SELECT p.id, p.name
FROM parent AS p
    LEFT JOIN relationship AS r1 ON (r1.parent_id = p.id)
    LEFT JOIN relationship AS r2 ON (r2.parent_id = p.id)
WHERE r1.other_id = 1 AND r2.other_id = 2; 
```

结果是 1，“父 1”是正确的。问题是，一旦你得到一个超过 5 个连接的列表，它就会变得混乱，并且随着关系表的增长，它会变得很慢。

有没有更好的办法？

我正在使用 MySQL 和 PHP，但这可能非常通用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-01T08:08:27.360

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T08:16:02.893

鉴于父表在 (parent_id, other_id) 上包含唯一键，您可以这样做：

```
select p.id, p.name 
  from parent as p 
 where (select count(*) 
        from relationship as r 
       where r.parent_id = p.id 
         and r.other_id in (1,2)
        ) >= 2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T08:28:21.617

稍微简化一下，这应该有效且有效。

> SELECT DISTINCT p.id, p.name
> FROM parent p
> INNER JOIN 关系 r1 ON p.id = r1.parent_id AND r1.other_id = 1
> INNER JOIN 关系 r2 ON p.id = r2.parent_id AND r2.other_id = 2

对于每个“其他”值，将需要至少一个连接记录。优化器应该知道它只需要找到一个匹配项，它只需要读取索引，而不是任何一个子表，其中一个甚至根本没有被引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T08:12:52.527

我还没有实际测试过它，但大致如下：

```
SELECT id, name FROM (
  SELECT p1.id, p1.name
  FROM parent AS p1 LEFT JOIN relationship as r1 ON(r1.parent_id=p1.id)
  WHERE r1.other_id = 1
  UNION ALL
  SELECT p2.id, p2.name
  FROM parent AS p2 LEFT JOIN relationship as r2 ON(r2.parent_id=p2.id)
  WHERE r2.other_id = 2
   -- etc
) GROUP BY id, name
HAVING count(*) = 2 
```

这个想法是您不必进行多路连接；只需连接常规连接的结果，按您的 id 分组，然后选择出现在每个段中的行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-01T08:17:39.693

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-01T08:27:39.293

您可以使用嵌套 select 来完成，我在 MSSQL 2005 中对其进行了测试，但正如您所说，它应该非常通用

```
SELECT * FROM parent p
WHERE p.id in(
    SELECT r.parent_Id 
    FROM relationship r 
    WHERE r.parent_id in(1,2) 
    GROUP BY r.parent_id
    HAVING COUNT(r.parent_Id)=2
) 
```

并且数字 2`COUNT(r.parent_Id)=2`是根据您需要的连接数）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-01T16:18:43.950

如果您可以将您的 other_id 值列表放入一个理想的表中。下面的代码查找至少具有给定 ID 的父母。如果您希望它具有完全相同的 id（即没有额外内容），则必须稍微更改查询。

```
SELECT
     p.id,
     p.name
FROM
     My_Other_IDs MOI
INNER JOIN Relationships R ON
     R.other_id = MOI.other_id
INNER JOIN Parents P ON
     P.parent_id = R.parent_id
GROUP BY
     p.parent_id,
     p.name
HAVING
     COUNT(*) = (SELECT COUNT(*) FROM My_Other_IDs) 
```

# javascript - 使用 AJAX 的后退按钮和刷新

> ID：599473
> 
> 赞同：4
> 
> 时间：2009-03-01T08:09:42.830
> 
> 标签：javascript, ajax, history

使用 AJAX 时，我需要一个页面刷新和后退按钮的解决方案。

我正在使用简单的 javascript 来实现 AJAX。

如果有人可以发送代码片段，我将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-01T08:12:48.627

如果您使用的是 jQuery，则可以使用[历史插件](http://www.mikage.to/jquery/jquery_history.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-03-23T21:40:08.083

这是我在某些页面中使用的解决方案。将此添加到进行更改的页面。

```
window.onbeforeunload = function() {
     window.name = "reloader"; 
} 
```

这会在您离开这些页面时触发。如果进行了更改，您也可以触发它。这样它就不会不必要地重新加载需要重新加载的页面。然后在浏览器“返回”使用后要重新加载的页面上。

```
if (window.name == "reloader") {
    window.name = "no";
    location.reload();
} 
```

这将触发您需要重新加载到的页面上的重新加载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T08:14:07.033

本质上，您需要使用和监视 url 的哈希部分...

```
http://.../path?parms#hashpart 
```

当您更改哈希 iirc window.location.hash 时，它不会重新加载页面，但您的 ajax 可以监控并响应它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T09:37:31.777

onbeforeunload 事件可用于防止刷新，但如果您离开或刷新它会触发。如果您要求用户登录到应用程序，您始终可以显示一条通用消息，建议不要导航和刷新。如果用户单击您的应用程序注销按钮，请设置一个 var 以禁用警告。也可以制作一个“关闭”按钮来做同样的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T18:10:53.790

试试[PathJS](https://github.com/mtrpcic/pathjs)，它不需要 jQuery 或任何其他额外的库。

# python - 如何在 Python 中从目录中区分文件？

> ID：599474
> 
> 赞同：11
> 
> 时间：2009-03-01T08:11:13.390
> 
> 标签：python, file, directory

使用 os.listdir 方法时，我需要告诉结果列表中的哪个项目是目录还是文件。

当我必须遍历此列表中的所有目录，然后在每个目录中添加一个文件时，我遇到了一个问题。

有没有办法通过这个列表并从中删除所有文件？如果无法使用 os.listdir，我应该改用什么方法？

谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-01T08:14:03.990

用于`os.path.isdir`过滤掉目录。可能像

```
dirs = filter(os.path.isdir, os.listdir('/path'))
for dir in dirs:
    # add your file 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-01T11:18:53.750

这可能会更快：

```
current, dirs, files = os.walk('/path').next() 
```

目录列表将在`dirs`变量中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-01T09:50:02.187

> dirs = filter(os.path.isdir, os.listdir('/path'))

请注意，除非 '/path' 是当前工作目录，否则这将不起作用。os.listdir() 返回叶子名称，所以你会问“os.path.isdir('file.txt')”，如果当前目录在别处，你会看到错误的“file.txt”。

os.path.join() 应该用于 os.listdir() 的输出以获得完整的文件名。

```
children= [os.path.join('/path', child) for child in os.listdir('/path')]
directories= filter(os.path.isdir, children) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-14T22:47:06.067

要评估您当前的目录子项：

```
import os

# Creates a list with all children items
cd_children = os.listdir()

# Iterate through the list
for item in cd_children:

    # If item is a directory (folder) do...
    if os.path.isdir(item):
        print('{:<13}{:<21}'.format('folder', item))

    # If item is a file do ...
    elif os.path.isfile(item):
        print('{:<13}{:<21}'.format('file', item)) 
```

示例**输出**：

```
 folder          untitled folder      
 file            7972-orders.csv           
 file            8235-users.csv
 file            teads.py             
 file            table.csv 
```

使用[os](https://docs.python.org/3/library/os.html#os-file-dir)和[os.path](https://docs.python.org/3/library/os.path.html)。

# mod-rewrite - How do I write a custom mod_rewrite .htaccess file for CakePHP routing?

> ID：599489
> 
> 赞同：1
> 
> 时间：2009-03-01T08:20:26.957
> 
> 标签：mod-rewrite, cakephp

I've rewritten my web app using CakePHP, but now I need to have my old formatted urls redirect to my new url format. I can't seem to add my own custom mod rewrite rule. I've added it above the main cakephp rewrite rule, but I'm getting an infinite redirect loop. I just want [http://mysite.com/index.php?action=showstream&nickname=user](http://mysite.com/index.php?action=showstream&nickname=user) to redirect to [http://mysite.com/user](http://mysite.com/user) before the cakephp rewrite happens.

EDIT: Ok, so now when the condition is met it's redirecting but it's appending the original query string to the end. I'm assuming that's due to the QSA flag in CakePHP rewrite rules, but I was under the impression the "L" in my rule would stop that from executing...

```
RewriteEngine On

RewriteCond %{QUERY_STRING} ^action\=showstream&nickname\=(.*)$
RewriteRule ^.*$ http://mysite.com/%1 [R=301,L]

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php?url=$1 [QSA,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T08:41:26.187

When you do a capture inside the RewriteCond line instead of the RewriteRule, you have to reference the capture with %N instead of $N. That is, your RewriteRule line should be:

```
RewriteRule ^index.php$ /%1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T09:07:38.963

Try to test the request line (`THE_REQUEST`) to see what URI originally has been requested:

```
RewriteCond %{THE_REQUEST} ^[A-Z]+\ /index\.php
RewriteCond %{QUERY_STRING} ^action=showstream&nickname=([^&]*)$
RewriteRule ^index\.php$ /%1? [R=301,L]

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule .* index.php?url=$0 [QSA,L] 
```

But maybe it would be easier to do this with PHP.

# asp.net-mvc - 角色/视图属于存储库模式内部还是外部？

> ID：599499
> 
> 赞同：2
> 
> 时间：2009-03-01T08:30:23.797
> 
> 标签：asp.net-mvc, design-patterns, business-objects

**角色/视图逻辑属于存储库模式内部还是外部？**

例如，我有一张产品表，每个产品有 5 个价格字段 - 一种用于每种类型的客户（批发、零售等）。

我只想向合适的用户显示合适的价格。

如果我有这些产品的存储库，是否应该返回 Product 业务对象，包含所有 5 个价格，并且以某种方式只显示相关价格？

如果是这样，什么是使用的好模式？

我是否应该创建一个视图对象，它接受一个业务对象和一个角色并确定要显示的正确价格？或者我应该把这个逻辑放在业务对象中吗？

（仅供参考：如果您认为它有助于构建响应，我将在 ASP MVC 中构建解决方案）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-01T10:56:53.443

是的，您的存储库应该返回所有五个价格，并且您的对象应该包含决定哪个客户收到哪个价格的业务逻辑。无论数据来自何处，对象都应该能够做出此决定。

这种方法还允许您独立于数据访问问题来测试定价逻辑 - 例如，通过使用“虚拟”存储库，通过手动创建已填充五个价格字段的产品，或通过使用模拟框架来模拟您的存储库调用。将这种逻辑移到您的业务对象之外——例如，把它放在你的数据访问层中——可能会导致一种被称为[贫血域模型](http://en.wikipedia.org/wiki/Anemic_Domain_Model)的反模式。

编辑：回应您的评论：

术语“存储库”专门指一种数据访问模式，它返回业务对象的完全填充的集合（聚合）。如果您发现返回 DTO 是解决您的问题的更好解决方案，那么请继续这样做，但如果您使用术语“存储库”来指代其他数据访问模式，您可能会混淆人们。就个人而言，我会坚持使用存储库方法并返回完全填充的业务对象，因为我更喜欢以这种方式工作，但与很多情况一样，这取决于您正在构建的系统的规模和复杂性。

要公开您的定价逻辑，您可能只想使用如下方法：

```
public class Product {
    public decimal GetPriceFor(User user) {
        // logic to determine per-user pricing goes here:
    } 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T14:13:28.650

一种方法是创建一个包含业务逻辑的服务层。服务层与存储库交互，应用您需要的任何规则或过滤器。这意味着从服务层返回的任何东西都只是一个普通的 c# 对象 (POCO)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T16:16:23.363

在设计了一些带有额外数据访问层的产品之后，我想说：在设计时要考虑到功能依赖！

假设您有以下非常常见的数据字典结构：productName、productDetail、productPrice、customerName、customerDetail。

可以很容易地识别关系：客户和产品。

客户类：customerName、customerDetail

产品类：productName、productDetail

但是还有第三种关系要绘制，它是

类 CustomerProduct：customerName、productName、productPrize

因为你可以认为只有customerName X productName |-> productPrize。对于用例客户 C 想知道产品 P 的价格：

客户('C').prize('P')

必须委派方法奖品才能知道确切的奖品，并且您可以清楚地分离关注点。明确一点：BO 不会向客户展示*任何*奖品。只是该方法可以访问敏感数据。您可以限制此访问权限。

# php - 如何使用 PHP 提供 .flv 文件？

> ID：599509
> 
> 赞同：6
> 
> 时间：2009-03-01T08:48:41.803
> 
> 标签：php, security, video, streaming, http-headers

我正在建立一个流媒体视频网站。这个想法是客户应该支付会员费，登录系统，并能够观看视频。我将使用[FlowPlayer](http://flowplayer.org)来显示实际视频。

现在的问题是，视频需要公开存储在某个地方，并且需要将 .flv 文件的 url 传递给 flowplayer 才能显示它们。这会产生一个问题，因为任何人都可以查看源代码、下载视频并在整个互联网上分发。

我知道有些人使用 php 通过制作图像来提供图像`header()`，然后他们可以执行以下操作：

```
<img src="image.php?userId=1828&img=test.gif" /> 
```

php 脚本验证用户 ID 并提供 .gif 并且永远不会显示 gif 的实际 url。

无论如何也可以使用 .flv 或任何其他视频格式来做到这一点？例如，传递给 PHP 脚本的文件和用户 ID，它会验证它们并返回视频？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-01T09:07:21.447

您可以在您的网络服务器上设置一个目录，其中包含只能由 PHP 访问的 FLV 文件，然后在您的 PHP 脚本中，您可以像往常一样对用户进行身份验证，只需向浏览器发送一个标头，告诉它期待 FLV，然后回显原始 FLV 数据：

```
<?php
// here is where
// you want your
// user authentication

if ($isAuthenticated)
{
  header("Content-type: video/flv");
  echo file_get_contents($pathToFLV);
}
?> 
```

正如 Chad Birch 所讨论的，这只会阻止人们直接链接到视频 - 您无法以这种方式阻止盗版。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-01T08:55:08.307

简短的回答是，不，如果人们愿意，您将永远无法阻止人们下载您的视频。有多种方法可以让他们更棘手，但没有万无一失的方法。您遇到了 DRM 的基本问题——您无法向他人展示您的内容，而不会将其提供给他们在某些时候未加密，如果他们可以查看它，他们就可以撕掉它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T08:59:03.900

由于您的 flv 播放器是一个 flash 应用程序，因此始终可以下载和反编译它。反编译后，flv 的实际 url 将可见。因此，如果您使用直接 url 到 flv 电影或您在问题中描述的类似内容，它不会有任何区别

```
<img src="image.php?userId=1828&img=test.gif" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T11:02:25.820

请谷歌这个词**Pseudostreaming**你会得到答案 有一些像**lighttpd**这样的服务器具有对 flv 流的固有支持....

希望你能得到答案…………

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-04T07:16:59.597

带有 mod_flvx 模块的 Apache 也有类似 lighttpd 的效果。

# javascript - 脚本和编程

> ID：599527
> 
> 赞同：5
> 
> 时间：2009-03-01T09:09:56.073
> 
> 标签：javascript, actionscript, scripting

脚本在哪里结束，编程从哪里开始？ActionScript 3 和 JavaScript/JScript 是如此不同......

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-01T10:10:03.057

这种区别曾经是有意义的，但界限越来越模糊，以至于我认为它在今天没有用处。

*   从历史上看，脚本语言被解释，编程语言被编译。但随着 VM 和 JIT 的出现，界限越来越模糊。

*   脚本是指以编程方式操作现有应用程序或工具（例如 office 宏），而不是从头开始构建应用程序。这条线再次变得模糊，因为库和框架意味着每个人都在构建现有工具。此外，API 允许您使用传统的编译语言来操作应用程序，例如。在 Office 中，您现在可以使用 .net 实现自动化，我认为这意味着您可以在托管 C++ 中编写 Excel 宏。

*   语言往往超出其利基市场。Perl 被认为是一种用于文本操作的脚本语言，但后来发展成为一种成熟的编程语言。

*   脚本语言传统上具有更高级别的功能，例如垃圾收集和隐式类型，允许开发人员专注于任务而不是金属。像 C 这样的真正编程语言迫使您更加关注内存管理和机器架构。同样，新语言正在模糊这条线。例如，C# 具有垃圾收集和动态类型等高级功能，以及指针等低级功能。

由于这些原因，*脚本*被视为更易于访问，而*编程*被视为要求更高且更核心。因此，*脚本*这个术语可以被贬低地使用，例如“JavaScript 只是一种脚本语言，而不是真正的编程语言”或“他只是一个脚本编写者，而不是真正的程序员”。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-01T09:15:02.613

有区别吗？您只是在为不同的运行环境编写不同语言的软件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-01T09:16:29.893

[德国维基百科说](http://de.wikipedia.org/wiki/Skriptsprache)：

> Aus architektonischer Sicht werden Skriptsprachen verwendet, um aus bestehenden Komponenten ein Anwendungsprogramm zu bauen。Die Komponenten selbst werden in einer Programmierspra​​che entwickelt。

翻译：

> 从架构的角度来看，脚本语言用于从现有组件构建应用程序。组件本身是使用编程语言开发的。

脚本语言使用已经存在的组件来制作程序。这些组件是用编程语言编写的。:)

想想shell脚本......在那里你使用“主要”用C编写的小程序。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-01T09:35:39.020

它让我想起了散文和诗歌之间区别的旧定义，类似于：

> *曾经有一位来自格拉斯的女士*
> *，她的膝盖下水。*
> 
> *那是散文。如果她更深入，那将是诗歌。*

让我印象深刻的是，脚本和编程之间的区别只是程度问题，而不是您使用的语言。我见过人们使用 bash shell 编写一些非常复杂的程序，而其他人则使用 C 编写琐碎的东西。哪个是程序员，哪个是脚本编写者？

当您能够编写一些不仅仅是快速破解或拼凑在一起以完成直接工作的东西时，当您编写的东西着眼于工艺和可维护性时，您就已经编写了一个程序。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-01T09:17:32.217

编程就是编程。

人们经常区分[脚本语言](http://en.wikipedia.org/wiki/Scripting_language)和[编译语言](http://en.wikipedia.org/wiki/Compiled_language)，但这种区别在 IMO 中并没有那么有用。

即可以编译许多脚本语言并解释许多编译语言。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-01T09:17:49.907

这个问题类似于这些过去的问题：

*   [编程 vs 脚本——你的定义是什么？](https://stackoverflow.com/questions/100905/programming-vs-scripting-whats-your-definition)
*   [“脚本”和“应用程序”有什么区别？](https://stackoverflow.com/questions/98268/whats-the-difference-between-a-script-and-an-application)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-01T11:00:17.290

脚本通常是一系列动作（“进入左侧”），就像食谱一样。

例如，测试脚本是要执行的简单操作序列。它具有零[循环复杂度](http://en.wikipedia.org/wiki/Cyclomatic_complexity)。

程序更通用，可以做任何事情。它们应该是模块化的，并且设计为可重用。

随着软件的扩展，脚本变得更加复杂，但从本质上讲，它们是为单一目的而设计的命令式食谱。

在我参与的一个兵棋推演模拟中，最大的卖点之一是它没有编写脚本，但模拟中的每个实体都是对事件做出反应的自主演员。

运行时是否被解释、编译、jited 或其他无关紧要的。编译了 awk 脚本。Lisp 程序经常被解释。通常，程序的单元测试脚本是用与程序相同的语言编写的。

如果我必须指出语言差异，那就是模块系统的存在。除了 C，所有“适当的”编程语言都有一个模块系统。JavaScript 作为[ServerJS](https://wiki.mozilla.org/ServerJS)工作组的一部分正在获得一个模块系统，并且对于应用程序编程显然已经足够成熟，因此现在既与 Java 无关，也不是专门的脚本语言。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-01T09:56:57.380

脚本（解释）和编译代码之间应该真正有所区别。我认为，编程只是向计算机或机器发出指令的总称。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-01T11:02:25.647

**编程语言**：在部署之前编译的语言。

**脚本语言**：部署时为代码并在请求时即时解释的语言。

最后都一样，都是编程语言

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-01T12:01:48.267

我觉得特别无用的两个定义是：

*   编程取决于在部署之前编译的代码
*   脚本意味着代码“仅”用于连接组件

我最初很想围绕编写代码的意图划清界限。我会在有限的生命周期和范围内调用一次性脚本，而其他所有内容都是程序。但是，我已经用 C 编写了很多这样的程序……而且我不会将 C 中的任何东西称为脚本。

我目前的工作定义是这样的：脚本代码往往在范围内受到限制，很小，并且（希望）易于理解和替换。其他一切都是程序化的。:-)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-01T14:26:37.027

请记住，大多数现代脚本语言都有框架或后端，其中包含一些内置编译来预构建和缓存脚本。（请参阅带有 Zend 或 eAccelerator 等优化器、模板引擎的 PHP...）

现代脚本语言，如 Actionscript3、PHP、Javascript，允许大多数现代设计模式（如 MVC）和一些 OOP 范式 - 以及一些高级设计，如“闭包”。因此，您拥有“编程”的一切。Rich Internet Applications (RIA) 需要大量的编程技能，RIA 作为桌面应用程序运行（Flash/Flex with Adob​​e Air）也是如此。这与嵌入网站的一些简单脚本无关。这是需要大量**编程**技能的复杂应用程序。

由于大多数脚本语言使用一些“后端”从数据库中获取/检索数据，因此由于副作用很多，这种应用程序通常不容易开发。人们必须具备服务器知识才能设置他们的开发环境，其他脚本语言，如后端的 PHP 等等。用 C++ 和像 Qt 这样的好框架来实现一些相同的东西，wxWidgets 有时更容易并且不需要更多的编程技能。

脚本和编程对我来说是一样的。是的，您可以说“为网站上的按钮编写 onclick 处理程序是在编写脚本……使用 Flex/Flash 和 Actionscript3 编写视频播放器或游戏是在编写程序”？

脚本语言和编译语言（主机访问、沙箱、性能......）之间存在差异。但它的所有编程。

# php - 生成私有、唯一、安全的 URL

> ID：599535
> 
> 赞同：13
> 
> 时间：2009-03-01T09:15:31.317
> 
> 标签：php, security, url

我想生成一个安全的一键访问类型的 url，类似于下面的示例。我将使用 PHP，但这无关紧要，因为我只是想了解基本概念。一些答案建议使用 GUID，但我认为这不会给我一个绝对独特、安全的 URL，如下所示。

```
#    Google Calendar
3qq6jlu04ptlhmb9fencsu5t2k
#    Private
3qq6jlu04ptlhmb9fencsu5t2k
#    Private 'token'
163a0afe7fkb1ba2acd04c11ef0eefe8
#    LogMeIn
#    1024 bit - 128 Character URL
72oxuj0fzefqo3fu04xjtvmd0adj2948rfh7g5by4forkwcy7t651z7hcb6kjjgqkxmvmfqpyrcfy15z1fto8ewcxstjc6avicag7d5qnoimsm19kb9kgi9i7v6z01d5 
```

我倾向于使用 128 个字符、1024 位的样式，因为它看起来非常安全。我想我可以制作四个 MD5 哈希并将它们合并，但这真的有效吗？

对于这样的网址，我有两个特定的意图，但我敢肯定还有其他人可能会觉得这很有用。

1) 用户即时登录快捷方式/图标

2）一次性网址（密码恢复链接）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-01T09:22:59.147

更新：

对于像单次使用 URL 这样的东西，我会使用建议的 GUID 式方法。确保链接的生命周期较短。

对于即时登录，没有真正安全的方式来拥有单个 URL。

是的，您可以生成一个几乎无法猜测的 URL，但这并不能为您提供超级安全性。如果您想记住用户，为什么不使用加密的身份验证 cookie？

您给出的示例，Google 日历不会仅通过 URL 登录，您必须先进行身份验证，然后 URL 才有意义。

例如，从我的 gmail 中点击谷歌日历会给我：

[https://www.google.com/calendar/render?tab=mc&gsessionid=-LTeHrnKoeAbDcVaN68NHA](https://www.google.com/calendar/render?tab=mc&gsessionid=-LTeHrnKoeAbDcVaN68NHA)

除非您首先以我身份进行身份验证，否则这无助于您访问我的帐户。

旧帖：

[您可以使用com_create _guid](http://uk.php.net/com_create_guid)在 PHP 中生成 GUID并使用它。

在 linux 上，我认为您可以使用[uuid_create](http://manpages.unixforum.co.uk/man-pages/unix/freebsd-6.2/3/uuid_create-man-page.html)或[此处](http://algorytmy.pl/doc/php/function.com-create-guid.php)的代码：

```
<?php
 function guid(){
 if (function_exists('com_create_guid')){
       return com_create_guid();
   }else{
       mt_srand((double)microtime()*10000);//optional for php 4.2.0 and up.
       $charid = strtoupper(md5(uniqid(rand(), true)));
       $hyphen = chr(45);// "-"
       $uuid = chr(123)// "{"
               .substr($charid, 0, 8).$hyphen
               .substr($charid, 8, 4).$hyphen
               .substr($charid,12, 4).$hyphen
               .substr($charid,16, 4).$hyphen
               .substr($charid,20,12)
               .chr(125);// "}"
       return $uuid;
   }
}
echo guid();
?> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-01T09:35:11.410

尝试[uniqid](http://uk.php.net/uniqid) - 并可能与 md5 哈希结合，如示例中所示：

```
// no prefix
// works only in PHP 5 and later versions
$token = md5(uniqid());

// better, difficult to guess
$better_token = md5(uniqid(rand(), true)); 
```

但是我必须注意，以这种方式生成的任何 url（无论是什么哈希算法）都不会是“安全的”，很难猜到。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-01T09:22:01.533

只需生成一个 GUID。尽管这不是旧式的顺序 GUID，但这很重要。

但是，似乎 php 没有自己的 GUID 生成函数。另一个答案中建议的 com_create_guid 函数在 Windows 上运行时似乎仅在 php 中可用。

[com_create_guid](http://uk.php.net/com_create_guid)的手册页上有用户建议的非 Windows替代方案：

```
function guid(){
    if (function_exists('com_create_guid')){
        return com_create_guid();
    }else{
        mt_srand((double)microtime()*10000);//optional for php 4.2.0 and up.
        $charid = strtoupper(md5(uniqid(rand(), true)));
        $hyphen = chr(45);// "-"
        $uuid = chr(123)// "{"
                .substr($charid, 0, 8).$hyphen
                .substr($charid, 8, 4).$hyphen
                .substr($charid,12, 4).$hyphen
                .substr($charid,16, 4).$hyphen
                .substr($charid,20,12)
                .chr(125);// "}"
        return $uuid;
    }
} 
```

但我不得不承认，我不愿意将它用于任何重要的事情，以防其中潜藏着一个我未经密码训练的头脑没有发现的不明显的问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-01T11:38:26.667

id 必须是无法猜测的，GUID 是唯一的，但并不难猜测。

你需要一个好的随机数生成器，每个密码学/加密库至少有一个，我不懂 PHP，所以我不能给你函数名。

然后你必须决定你的随机数有多长，你应该选择一个足够大的长度，以至于任何猜测数字的人都会得到一个未分配的数字 - 要么：

1.  估计你必须生成的唯一 URL 的数量，计算你需要多少位来表示它们，然后将位数加倍（至少）。

2.  或者，采用您的用户将接受的最大数量

现在您有了一个“安全”数字，您可以将其转换为十进制、十六进制或 base64 并使用该字符串。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-03T08:04:45.400

如果要确保 URL 既是唯一的，又只能使用有限的次数：

*   保留一个包含以下字段的小型数据库：`RandomKey`, `InternalURL`, `Counter`,`TimeStamp`

*   从足够大的池中创建一个随机数。
    非顺序 GUID 应该足够了

*   将其保存在您的数据库中`RandomKey`，以及系统处理该 URL 所需的实际内部 URL 或资源代码和时间戳。

*   当用户单击或输入 URL 时，对照该数据库检查它：如果`TimeStamp`太旧或`Counter`太高，请采取适当的措施（例如，如果您希望此 URL 在有限的时间内或一定次数内可访问）。
    否则，只需使用 处理请求`InternalURL`并将其结果发送回用户。

*   当 URL 已被使用或已达到其最大使用计数器时，只需将其从数据库中删除，使其无法进一步使用。

为您提供几乎无法猜测的一次性 URL 非常棒。

当然，您还必须实施一些安全检查来限制人们尝试访问无效 URL 的速度。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T08:09:17.760

我会避免这种情况：

> 1) 用户即时登录快捷方式/图标

因为这些 URL 可以缓存/记录在代理、博客、浏览器缓存、书签、电子邮件等上。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T07:35:32.717

修剪额外的花括号

$guid = strtolower(trim(com_create_guid(), "{}")); （PHP 5 或更高版本）

# asp.net - 如何阅读外部页面的标题？

> ID：599539
> 
> 赞同：3
> 
> 时间：2009-03-01T09:16:25.293
> 
> 标签：asp.net, jquery, external, title

我认为使用 jQuery 是可能的，但是任何 ASP.NET 服务器端代码也适合我的情况。

使用 jQuery，我可以将页面加载到例如 div，并过滤 div 以获取`<title>`标签，但我认为对于重页，首先阅读所有内容然后阅读标题标签是不好的......或者它可能有一个非常简单的解决方案？无论如何，我无法从互联网上找到任何相关信息。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T10:32:23.457

[cjjer](https://stackoverflow.com/questions/599539/how-to-read-an-external-pages-title/599565#599565) almost got it right.

First, change the regex to: `<title>(?<Content>.*?)?</title>`

Second, you need to create a match object first (just in case your URI does not have a title).

```
Match tMatch = new RegEx(@"<title>(?<Content>.*?)?</title>").Match(new System.Net.WebClient().DownloadString(url));

if ((null != tMatch) && (tMatch.IsSuccess)) {
    //  yay.
    title = tMatch.Groups("Content").value;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T12:18:15.363

okay thanks to cjjer and Boo, I've just read more about regex and finally the code below is working for me.

```
Dim qq As New System.Net.WebClient
    Dim theuri As New Uri(TextBox1.Text)
    Dim res As String = qq.DownloadString(theuri)
    Dim re As Regex = New Regex("<title\b[^>]*>(.*?)</title>", RegexOptions.Singleline)
    Dim ma As Match = re.Match(res)

    If Not ma Is Nothing And ma.Success Then
        Response.Write(ma.Groups(1).Value.ToString())
    Else
        Response.Write("error")
    End If 
```

but anyways, the problem remains, this code is downloading the whole page and seeking through it, which one heavy websites it took more than 2 or 3 secconds to complete, but seems it is the only way as far as I know :| Is there any suggestions to refine this code?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T10:11:12.570

标题通常出现在前几百个字节内，因此您可以尝试对前 1KiB 左右的范围请求，尝试解析它（使用纠错解析器，因为会丢失一些结束标签），如果失败则回退到加载整个页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T09:23:40.937

将任何其他网页加载到您的网页中会带来安全风险，只是为了读取标题...您应该使用服务器端脚本（asp.net，php，...）执行此操作，然后将标题输出到您的网络页。某种缓存的东西，因为它可以无缝地在每个请求上获取标题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-01T09:33:21.867

没有简单干净的方法来检索外部页面的标题。您可以在服务器端使用 a`WebClient`并解析响应。

但是，可能值得审查要求，是否真的有必要，它将产生多少额外的流量和延迟。还要考虑到您可能会在不知道您想要的只是标题的外部站点上生成负载，页面创建可能会非常昂贵。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-01T09:46:11.150

```
string title=Regex.Match(new System.Net.WebClient().DownloadString(url),(@"<title>(.*?)</title>"))[0].Groups[1].ToString(); 
```

试试。我不确定。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-01T10:15:55.197

我不确定是否所有服务器都支持这个。
看看，如果这有帮助

```
 char[] data = new char[299];
System.Net.HttpWebRequest wr =(HttpWebRequest)WebRequest.Create("http://www.yahoo.com");
wr.AddRange("bytes", 0, 299);
HttpWebResponse wre = (HttpWebResponse)wr.GetResponse();
StreamReader sr = new StreamReader(wre.GetResponseStream());
sr.Read(data, 0, 299);
Console.WriteLine((data));
sr.Close(); 

```

EDIT: Try checking with some network monitoring tool to find out what is the text that servers send out. I used fiddler to see the output & wrote it to console.

EDIT2: I am assuming the title to be in the beginning of the page.

# mysql - 在 SQL 生成 MySQL WorkBench 中禁止注释

> ID：599553
> 
> 赞同：1
> 
> 时间：2009-03-01T09:28:14.437
> 
> 标签：mysql, mysql-workbench

MySQL 工作台可以将 MYSQL 数据模型导出到 SQL 创建表脚本。但是我可以在导出时选择隐藏评论吗？如果是，如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-07T23:21:12.847

我不能为您提供任何集成工具。您可以通过***sed***运行它。以下命令可以解决问题：

```
sed '/^COMMENT/ d' original.sql > cleaned.sql 
```

*（嗯......显然你需要 sed 为此......）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-07T14:54:49.950

1.  去`Server->Data export->Advanced options->SQL`
2.  滚动到底部
3.  取消选中“评论”

# mysql - 将 MySQL Workbench 数据模型直接导出到 Propel/ Symfony 中的 Schema YML

> ID：599566
> 
> 赞同：9
> 
> 时间：2009-03-01T09:47:29.773
> 
> 标签：mysql, yaml, propel, mysql-workbench

有没有插件可以直接将MYSQL Workbench 数据模型直接导出到YML 进行Propel 消费？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-01T21:38:42.637

是的，MySQL Workbench 插件可用于为 Propel、Doctrine、Symfony 等生成模式

[http://forums.mysql.com/read.php?153,208229](http://forums.mysql.com/read.php?153,208229)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-22T18:15:15.147

只是关于这个问题的更新。如果您正在寻找一种快速便捷的方法来将数据库表导出到实体并映射 .yml 文件，那么曾经有一个 Workbench 插件可以做到这一点，但不幸的是，这个 LUA 不再受支持。它工作得很好——太糟糕了，因为如果你使用 MySQL Workbench，一个插件理想地是将你的数据库作为实体导出到你的 Symfony 项目中的最方便和最快的方法。

因此，我发现的下一个最佳解决方案是安装一个可以从 Symfony 的应用程序/控制台执行的实用程序，称为“ `mysqlworkbenchschemaexporter`”。使用此实用程序，您必须保存 Workbench 文件 (*.wmb)，然后将它们上传到文件夹，然后可以使用以下应用程序/控制台命令：

```
app/console mysqlworkbenchschemaexporter:dump
app/console mysqlworkbenchschemaexporter:withRepository 
```

在没有购买像 Skipper 这样的价格超过 300 美元的 ORM 工具的情况下，我确实找到了这个最近更新的解决方案，该解决方案受以下**支持**：

[https://github.com/turnaev/mysql-workbench-schema-exporter-symfony2-bundle](https://github.com/turnaev/mysql-workbench-schema-exporter-symfony2-bundle)

我希望这可以帮助其他 Symfony 开发人员节省一些时间来创建实体和 ORM 映射！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-27T09:07:59.870

如果从 MySQL 工作台导出还不够，您可以尝试我们的工具 Skipper - 以前的 ORM Designer（我是首席开发人员）。使用 Skipper，您还可以定义和导出行为、推进特定的列/表/...属性等等。

[http://www.skipper18.com](http://www.skipper18.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-02T14:20:17.043

在使用 symfony 1.x 时，我个人更喜欢以下流程：

1.  使用工作台设计模型
2.  使用“同步模型”选项将更改应用到数据库
3.  运行 propel:build-schema 任务来更新 schema.yml
4.  运行 propel:build --all-classes 任务（它意味着模型、表单和过滤器）

请注意：第 3 步将覆盖整个 schema.yml 文件。如果您需要对其添加特殊调整，只需将 schema.custom.yml 添加到您的项目中即可。

# .net - 如何使用 Google Contact .NET 客户端库为联系人上传照片

> ID：599571
> 
> 赞同：0
> 
> 时间：2009-03-01T09:53:20.803
> 
> 标签：.net, contacts, gdata

因此，在搜索了互联网之后，我拼凑了以下代码来为 Google 联系人上传照片：

```
System.Drawing.Bitmap Image = new Bitmap( @"C:\test.jpg" );
System.IO.MemoryStream Memory = new MemoryStream();
Image.Save( Memory, System.Drawing.Imaging.ImageFormat.Jpeg );

Service.Update
    (
        Contact.PhotoEditUri, 
        Memory, 
        "image/jpeg", 
        null
    ); 
```

该服务正在使用 ClientLogin 身份验证。在此代码运行之前，我已成功检索到联系人。

然而，在这段代码运行之后，我得到了一个 GDataRequestException。返回的错误消息是“发生了临时内部问题。请稍后再试”。InnerException 中的错误消息包含以下内容，“远程服务器返回错误：(500) 内部服务器错误。”

经过进一步的研究，我发现来自 Google 服务的错​​误代码可能不是所有的描述性 - 并且可能只是返回错误 500。虽然我不知道这是多么真实。

所以也许问题出在我的代码上？或者更好的是，有人有示例代码来演示应该如何完成吗？

谢谢，

骆驼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-05T23:45:41.270

我找到了两种解决此问题的方法（成绩单在[此 Google Contacts API 帖子](http://groups.google.com/group/google-contacts-api/browse_thread/thread/5a2f2fec5bd99c83/5f6d1444b506155f#5f6d1444b506155f)中）。首先，您可以创建一个直接访问文件的流，如下所示：

```
System.IO.FileStream File = new FileStream( @"C:\test.jpg" );

Service.Update
    (
        Contact.PhotoEditUri, 
        File, 
        "image/jpeg", 
        null
    ); 
```

其次，我的原始代码失败的原因是因为我必须重置 MemoryStream 中的位置。这就是我在流媒体上如此菜鸟所得到的。一旦 Image.Save 函数完成，位置就在末尾。因此，您所要做的就是将位置重置为开头：

```
System.Drawing.Bitmap Image = new Bitmap( @"C:\test.jpg" );
System.IO.MemoryStream Memory = new MemoryStream();
Image.Save( Memory, System.Drawing.Imaging.ImageFormat.Jpeg );
Memory.Seek( 0, SeekOrigin.Begin );

Service.Update
    (
        Contact.PhotoEditUri, 
        Memory, 
        "image/jpeg", 
        null
    ); 
```

# timeout - 如何增加 cronjob/crontab 的超时时间？

> ID：599588
> 
> 赞同：12
> 
> 时间：2009-03-01T10:10:44.523
> 
> 标签：timeout, cron

我编写了一个脚本，该脚本从[solr](http://lucene.apache.org/solr/)获取日期在指定时间段内的数据，并将该脚本用作每日 cron 运行。

问题是 cronjob 没有完成任务。如果我手动运行脚本（在同一时间段内），它运行良好。如果我减少指定的时间段，脚本也会从 cron 运行。所以我的猜测是 cronjob 在运行脚本时超时，因为有很多数据要处理。

如何增加 cronjob 的超时时间？

PS - 1\. 我在 cronjob 中运行的脚本是一个运行 python 脚本的 bash 脚本。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-10-15T18:43:56.213

请注意，`ulimit -t`建议的解决方案将限制使用的 CPU 时间量，而不是已经过去的实际时间量。

从`bash`手册页：

```
ulimit [-HSTabcdefilmnpqrstuvx [limit]]
...
-t     The maximum amount of cpu time in seconds 
```

更重要的是，cron 一开始并没有强加任何超时。它只是启动任何过程并继续前进。

* * *

顺便说一句：很抱歉将其发布为答案，但我还没有足够的积分来添加评论。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-01T10:17:49.763

在运行脚本之前，您可以尝试在 cronjob 中使用[ulimit](http://www.ss64.com/bash/ulimit.html) -t [秒数]。

# vb.net - VS2008中修改VB属性模板

> ID：599600
> 
> 赞同：0
> 
> 时间：2009-03-01T10:18:44.503
> 
> 标签：vb.net, templates, visual-studio-2008, visual-studio-2005

在 VS2008 (VB.NET) 中，当您键入 Public Property X As SomeType 并按 Enter 键时，VS 会自动为您生成该属性定义的其余部分。

我希望能够自定义 VS 生成的内容。

关于如何去做的任何想法？VS 必须在某个地方有一个模板，是吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T10:33:40.973

我认为属性生成使用内置宏。我没有在 VS 提供的示例宏列表中找到它。但是，您可以编辑`DefineAProperty.snippet`* 文件以根据您的要求对其进行修改。不过，就个人而言，我建议您创建自己的代码段，而不是修改预安装的代码段。

一些指向更多信息/片段编辑器的链接：

1.  [创建和使用代码段 - MSDN](http://msdn.microsoft.com/en-us/library/ms165392.aspx)
2.  [VB 2008 的代码片段编辑器](http://msdn.microsoft.com/en-us/vbasic/bb973770.aspx)
3.  [片段设计器 - CodePlex](http://www.codeplex.com/SnippetDesigner)

# asp.net - gridview 方法调用的问题

> ID：599601
> 
> 赞同：0
> 
> 时间：2009-03-01T10:19:30.227
> 
> 标签：asp.net, events, gridview

虽然我在网格视图中设置

```
OnRowDeleting="GridView1_RowDeleting" 
```

并在gridview上点击我得到了

```
protected void GridView1_SelectedIndexChanged(object sender, EventArgs e) 
```

当我单击删除链接时，它应该打开删除事件

```
protected void GridView1_RowDeleting(object sender,GridViewDeletedEventArgs e) 
```

但它没有打开，

请指出我的错误在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T11:06:51.783

问题在于您的事件参数，您应该使用**GridViewDeleteEventArgs**来表示**OnRowDeleting**。**GridViewDeletedEventArgs**用于**OnRowDeleted**事件。

```
protected void GridView1_RowDeleting(object sender,GridViewDeleteEventArgs e) 
```

[OnRowDeleting 参考](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdeleting.aspx)

[OnRowDeleted 参考](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewdeletedeventargs.aspx)

希望这可以帮助 ！

# java - 渴望Java类加载

> ID：599602
> 
> 赞同：9
> 
> 时间：2009-03-01T10:19:31.647
> 
> 标签：java

我正在尝试对在各种硬件和操作系统平台上运行的 JVM 进行一些基准测试。我创建了一个算法来运行我感兴趣的 JVM 部分，并打算多次运行该算法以找到一个不错的平均值。

当我运行基准测试时，我发现第一次运行明显长于后续运行：

```
132ms
86ms
77ms
89ms
72ms 
```

我怀疑类是延迟加载的，在第一次运行时会产生很大的开销。虽然我认为这确实是每个 JVM 独有的特性，但我目前对此并不感兴趣。

是否有标准的命令行选项或属性来急切地加载类？或者有人有其他理论吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-01T10:26:59.070

最简单的做法是忽略第一次运行。（如果这样做是有效的）注意：如果您运行相同的代码 10,000 次，它将进一步编译代码并获得更好的结果，因此您可能希望忽略某些微基准测试的前 10K 结果。

一些 JVM 支持预加载，但我认为 Sun 的 JVM 不支持。

JWrapper 支持 AOT [https://www.jwrapper.com/features](https://www.jwrapper.com/features)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-01T16:33:00.173

如果要强制加载类，请执行以下操作：

```
public class Main
{
    static
    {
        loadClasses();
    }

    public static void main(final String[] argv)
    {
        // whatever
    }

    private static void loadClasses()
    {
        final String[] classesToLoad;

        // even better, read them from a file and pass the filename to this method
        classesToLoad = new String[]
        {
            "foo.bar.X",
            "foo.bar.Y",
        }

        for(final String className : classesToLoad)
        {
            try
            {
                // load the class
                Class.forName(className);
            }
            catch(final ClassNotFoundException ex)
            {
                // do something that makes sense here
                ex.printStackTrace();
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-01T13:23:20.300

Java 基准测试的规则 #1：方法运行的前 15000 次（左右）并不有趣。

该线程包含一些可靠的建议：[如何在 Java 中编写正确的微基准测试？](https://stackoverflow.com/questions/504103/how-do-i-write-a-correct-micro-benchmark-in-java)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-01T10:31:02.883

用于`java -XX:+TraceClassLoading`跟踪类的加载。

用于`java -XX:+PrintCompilation`跟踪方法何时被 JITed。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T13:04:32.303

一旦你加载了类，为了避免运行解释器，使用`-Xcomp`（在 Sun 实现上）只运行编译的代码。以这种方式运行普通应用程序可能会非常缓慢，因为所有代码都必须编译，而不仅仅是几部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-01T11:16:35.923

没有标准的命令行选项，因为这不是 JVM 规范的一部分。延迟类加载是（明确允许的）JVM 规范的一部分。可以`Class.forName()`在运行之前使用来加载您知道的类，但它不会自动传递。

HotSpot 编译也会影响前几次运行——一个方法在编译之前会被解释几次，编译过程需要一些时间。

# physics - 如何与量子谐振子波函数进行数值积分？

> ID：599619
> 
> 赞同：7
> 
> 时间：2009-03-01T10:39:21.410
> 
> 标签：physics, numerical, numerical-methods, numerical-analysis, numerical-integration

如何对无限范围内的一维积分进行**数值积分（使用什么数值方法，以及使用什么技巧），其中被积函数中的一个或多个函数是一维**[量子谐振子](http://en.wikipedia.org/wiki/Quantum_harmonic_oscillator#One-dimensional_harmonic_oscillator)波函数。除其他外，我想在谐振子基础上计算某些函数的矩阵元素：

> phi [n] (x) = N [n] H [n] (x) exp(-x ² /2)
> *其中 H [n] (x) 是[Hermite 多项式](http://en.wikipedia.org/wiki/Hermite_polynomials)*
> 
> V [m,n] = \int_{-infinity}^{infinity} phi [m] (x) V(x) phi [n] (x) dx

在存在宽度不同的量子谐波波函数的情况下也是如此。

问题是波函数 phi [n] (x) 具有振荡行为，这对于较大的*n*来说是个问题，并且来自 GSL（GNU 科学图书馆）的自适应 Gauss-Kronrod 正交等算法需要很长时间来计算，并且误差很大。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-01T10:59:57.430

一个不完整的答案，因为我现在的时间有点短；如果其他人无法完成图片，我可以稍后提供更多详细信息。

1.  随时随地应用波函数的正交性。这应该会显着减少计算量。

2.  尽你所能进行分析。提升常数，按部分拆分积分，等等。隔离感兴趣的区域；大多数波函数是带限的，减少感兴趣的区域将大大节省工作。

3.  对于正交本身，您可能希望将波函数分成三部分并分别积分：中心的振荡位加上两侧的指数衰减尾部。如果波函数是奇数，你会很幸运，尾巴会相互抵消，这意味着你只需要担心中心。对于偶数波函数，您只需要积分一个并将其加倍（万岁对称！）。否则，使用高阶 Gauss-Laguerre 求积法则对尾部进行积分。您可能必须自己计算规则；我不知道表格是否列出了好的 Gauss-Laguerre 规则，因为它们不经常使用。随着规则中节点数量的增加，您可能还想检查错误行为；很久没有使用 Gauss-Laguerre 规则了 不记得他们是否表现出龙格现象。使用您喜欢的任何方法整合中心部分；当然，Gauss-Kronrod 是一个可靠的选择，但也有 Fejer 正交（有时可以更好地缩放到大量节点，这可能在振荡被积函数上工作得更好）甚至梯形规则（它在某些振荡函数上表现出惊人的精度）。挑一个试试看；如果结果很差，请尝试另一种方法。挑一个试试看；如果结果很差，请尝试另一种方法。挑一个试试看；如果结果很差，请尝试另一种方法。

有史以来最难的问题？几乎不 ：）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-23T15:51:12.490

我推荐一些其他的东西：

1.  尝试将函数转换为有限域以使集成更易于管理。
2.  尽可能使用对称性 - 将其分解为从负无穷到零和从零到无穷的两个积分之和，看看函数是对称的还是反对称的。它可以使您的计算更容易。
3.  查看[Gauss-Laguerre 求积](http://mathworld.wolfram.com/Laguerre-GaussQuadrature.html)，看看它是否可以帮助您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T10:47:20.707

[WKB](http://mysite.du.edu/~jcalvert/phys/wkb.htm)近似值？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-14T21:35:21.457

我现在不打算解释或限定其中的任何内容。此代码按原样编写，可能不正确。我什至不确定它是否是我正在寻找的代码，我只记得几年前我遇到了这个问题，在搜索我的档案时我发现了这个。您需要自己绘制输出，提供了一些说明。我会说无限范围内的积分是我解决的一个问题，并且在执行代码时，它会在“无穷大”处指出舍入误差（这在数字上只是意味着大）。

```
// compile g++ base.cc -lm
#include <iostream>
#include <cstdlib>
#include <fstream>
#include <math.h>

using namespace std;

int main ()
        {
        double xmax,dfx,dx,x,hbar,k,dE,E,E_0,m,psi_0,psi_1,psi_2;
        double w,num;
        int n,temp,parity,order;
        double last;
        double propogator(double E,int parity);
        double eigen(double E,int parity);
         double f(double x, double psi, double dpsi);
        double g(double x, double psi, double dpsi);
        double rk4(double x, double psi, double dpsi, double E);

        ofstream datas ("test.dat");

        E_0= 1.602189*pow(10.0,-19.0);// ev joules conversion
        dE=E_0*.001;
//w^2=k/m                 v=1/2 k x^2             V=??? = E_0/xmax   x^2      k-->
//w=sqrt( (2*E_0)/(m*xmax) );
//E=(0+.5)*hbar*w;

        cout << "Enter what energy level your looking for, as an (0,1,2...) INTEGER: ";
        cin >> order;

        E=0;
        for (n=0; n<=order; n++)
                {
                parity=0;
//if its even parity is 1 (true)
                temp=n;
                if ( (n%2)==0 ) {parity=1; }
                cout << "Energy " << n << " has these parameters: ";
                E=eigen(E,parity);
                if (n==order)
                        {
                        propogator(E,parity);
                        cout <<" The postive values of the wave function were written to sho.dat \n";
                        cout <<" In order to plot the data should be reflected about the y-axis \n";
                        cout <<"  evenly for even energy levels and oddly for odd energy levels\n";
                        }
                E=E+dE;
                }
        }

double propogator(double E,int parity)
        {
        ofstream datas ("sho.dat") ;

        double hbar =1.054*pow(10.0,-34.0);
        double m =9.109534*pow(10.0,-31.0);
        double E_0= 1.602189*pow(10.0,-19.0);
        double dx =pow(10.0,-10);
        double xmax= 100*pow(10.0,-10.0)+dx;
        double dE=E_0*.001;
        double last=1;
        double x=dx;
        double psi_2=0.0;
        double psi_0=0.0;
        double psi_1=1.0;
//      cout <<parity << " parity passsed \n";
        psi_0=0.0;
        psi_1=1.0;
        if (parity==1)
                {
                psi_0=1.0;
                psi_1=m*(1.0/(hbar*hbar))* dx*dx*(0-E)+1 ;
                }

        do
                {
                datas << x << "\t" << psi_0 << "\n";
                psi_2=(2.0*m*(dx/hbar)*(dx/hbar)*(E_0*(x/xmax)*(x/xmax)-E)+2.0)*psi_1-psi_0;
//cout << psi_1 << "=psi_1\n";
                psi_0=psi_1;
                psi_1=psi_2;
                x=x+dx;
                } while ( x<= xmax);
//I return 666 as a dummy value sometimes to check the function has run
        return 666;
        }

   double eigen(double E,int parity)
        {
        double hbar =1.054*pow(10.0,-34.0);
        double m =9.109534*pow(10.0,-31.0);
        double E_0= 1.602189*pow(10.0,-19.0);
        double dx =pow(10.0,-10);
        double xmax= 100*pow(10.0,-10.0)+dx;
        double dE=E_0*.001;
        double last=1;
        double x=dx;
        double psi_2=0.0;
        double psi_0=0.0;
        double psi_1=1.0;
        do
                {
                psi_0=0.0;
                psi_1=1.0;

                if (parity==1)
                        {double psi_0=1.0; double psi_1=m*(1.0/(hbar*hbar))* dx*dx*(0-E)+1 ;}
                x=dx;
                do
                        {
                        psi_2=(2.0*m*(dx/hbar)*(dx/hbar)*(E_0*(x/xmax)*(x/xmax)-E)+2.0)*psi_1-psi_0;
                        psi_0=psi_1;
                        psi_1=psi_2;
                        x=x+dx;
                        } while ( x<= xmax);

                if ( sqrt(psi_2*psi_2)<=1.0*pow(10.0,-3.0))
                        {
                        cout << E << " is an eigen energy and " << psi_2 << " is psi of 'infinity'  \n";
                        return E;
                        }
                else
                        {
                        if ( (last >0.0 && psi_2<0.0) ||( psi_2>0.0 && last<0.0) )
                                {
                                E=E-dE;
                                dE=dE/10.0;
                                }
                        }
                last=psi_2;
                E=E+dE;
                } while (E<=E_0);
        } 
```

如果此代码看起来正确、错误、有趣，或者您确实有具体问题，我会回答。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-08T15:09:12.513

我是物理专业的学生，​​我也遇到过这个问题。这些天我一直在思考这个问题并得到自己的答案。我认为它可以帮助您解决这个问题。

1.在gsl中，有一些函数可以帮助你整合振荡函数--qawo & qawf。也许您可以设置一个值*a*。并且集成可以分为两个部分，[0, *a* ] 和 [ *a* ,pos_infinity]。在第一个区间，你可以使用任何你想要的gsl积分函数，在第二个区间，你可以使用qawo或qawf。

2.或者你可以把函数积分到一个上限*b*，也就是积分在[0, *b* ]中。因此可以使用高斯传奇方法计算积分，这在 gsl 中提供。虽然实际值和计算值之间可能存在一些差异，但如果*b*设置得当，差异可以忽略不计。只要差异小于您想要的精度。而这个使用gsl函数的方法只调用一次，可以多次使用，因为返回值是point及其对应的权重，积分只是f(xi)*wi之和，更多细节可以搜索gauss legendre维基百科上的正交。乘法和加法运算比积分快得多。

3.还有一个计算无穷大面积积分的函数——qagi，你可以在gsl-user's guide中搜索。但是每次你需要计算积分时都会调用它，这可能会导致一些耗时，但我不确定它会在你的程序中使用多长时间。

我建议我提供的 NO.2 选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-11T05:51:43.627

如果您要使用小于 n = 100 的谐波振荡器函数，您可能想尝试：

[http://www.mymathlib.com/quadrature/gauss_hermite.html](http://www.mymathlib.com/quadrature/gauss_hermite.html)

该程序通过具有 100 个零和权重（H_100 的零）的 gauss-hermite 求积计算积分。一旦你超过 Hermite_100，积分就不那么准确了。

使用这种集成方法，我编写了一个程序来精确计算您想要计算的内容，并且效果很好。此外，可能有一种方法可以通过使用 Hermite 多项式零点的渐近形式来超越 n=100，但我还没有研究过。

# executable - PSExec：如何在远程计算机上显示 JPG 文件？

> ID：599620
> 
> 赞同：0
> 
> 时间：2009-03-01T10:40:21.550
> 
> 标签：executable, psexec

我需要使用 PSExec 在远程计算机上启动文档而不是可执行文件。

我试图将 jpg 文件的文件名提供给与 -c 命令相关联的 psexec 以复制文件，但为文档（而非可执行文件）返回的消息始终是“系统找不到指定的文件”。

有人知道 psexec 的命令行应该是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T11:38:25.060

Try to use the command:

```
cmd.exe /c START c:\path\to\document.jpg 
```

Document must be on the remote computer, so you have to copy it there by other command before calling psexec.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T11:14:01.967

在另一台机器上选择一个可以显示 JPEG 的程序并执行该程序，将路径和名称传递给您要显示的文件。

正如您所注意到的，文件关联不适用于这样的远程执行，因此您需要调用正确的程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-24T12:51:30.720

为了打开一个远程程序并且不仅激活它的进程，你必须使用带有 -i（交互模式）的 PSEXEC 并且必须定义会话号。

例如：

通常在 Win7 主机上：

```
 Console = Session 0
 System = Session 1
 User = Session 2 
```

要在此远程 Win 7 主机上激活和打开 notepad.exe，请使用以下语法：

```
psexec -i 2 \\ComputerName -u User -p Pass notepad.exe 
```

问候， Shai Ziv shaix.ziv@intel.com

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-21T15:31:32.907

这是对我有用的方式：

*   我已经通过 RDP 登录：
    *   我已将图片复制到“C:\Users<MyUserName>\Pictures\smiley.png”
    *   我打开了一个新的 powershell 窗口，输入了“tasklist”并找到了我的 windows 会话 id（我简单地取了我找到的最高会话 id）
*   回到我自己的电脑上：
    *   我已经从[https://download.sysinternals.com/files/PSTools.zip下载了 PSTOOLS](https://download.sysinternals.com/files/PSTools.zip)
    *   我已经解压 PSTOOLS 并将其放在“C:\Program Files\PSTools”中
    *   我打开了一个新的 powershell 窗口并输入： cd "C:\Program Files\PSTools"
    *   最后我用以下方式启动了远程 PAINT：

* * *

```
"C:\Program Files\PSTools\psexec" -s -i 4 "\\[RemoteComputerName]" "C:\Windows\system32\mspaint.exe" "C:\Users\[MyUserName]\Pictures\smiley.png" 
```

* * *

PS：不要忘记替换 [RemoteComputerName] 和 [MyUserName]

# python - Python 字符串打印为 [u'String']

> ID：599625
> 
> 赞同：161
> 
> 时间：2009-03-01T10:48:45.540
> 
> 标签：python, unicode, ascii

这肯定会很容易，但它真的让我很烦。

我有一个在网页中读取并使用[Beautiful Soup](https://www.crummy.com/software/BeautifulSoup/)解析它的脚本。我从*汤*中提取所有链接，因为我的最终目标是打印出链接内容。

我正在解析的所有文本都是 ASCII。我知道 Python 将字符串视为 unicode，我相信这非常方便，只是在我的小脚本中没有用。

每次我打印出一个包含“字符串”的变量时，我都会`[u'String']`打印到屏幕上。有没有一种简单的方法可以将其恢复为 ascii 或者我应该编写一个正则表达式来剥离它？

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2009-03-01T11:22:11.323

`[u'ABC']`将是 unicode 字符串的单元素列表。[Beautiful Soup 总是产生 Unicode](http://www.crummy.com/software/BeautifulSoup/documentation.html#Beautiful%20Soup%20Gives%20You%20Unicode,%20Dammit)。因此，您需要将列表转换为单个 unicode 字符串，然后将其转换为 ASCII。

我不知道您是如何获得单元素列表的；内容成员将是字符串和标签的列表，这显然不是您所拥有的。假设你真的总是得到一个包含单个元素的列表，并且你的测试真的*只是*ASCII 你会使用这个：

```
 soup[0].encode("ascii") 
```

但是，请仔细检查您的数据是否真的是 ASCII。这是相当罕见的。更有可能是 latin-1 或 utf-8。

```
 soup[0].encode("latin-1")

 soup[0].encode("utf-8") 
```

或者你问 Beautiful Soup 原来的编码是什么，然后用这个编码取回它：

```
 soup[0].encode(soup.originalEncoding) 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-01T11:40:24.043

您可能有一个包含一个 unicode 字符串的列表。这`repr`是`[u'String']`.

您可以使用以下任何变体将其转换为字节字符串列表：

```
# Functional style.
print map(lambda x: x.encode('ascii'), my_list)

# List comprehension.
print [x.encode('ascii') for x in my_list]

# Interesting if my_list may be a tuple or a string.
print type(my_list)(x.encode('ascii') for x in my_list)

# What do I care about the brackets anyway?
print ', '.join(repr(x.encode('ascii')) for x in my_list)

# That's actually not a good way of doing it.
print ' '.join(repr(x).lstrip('u')[1:-1] for x in my_list) 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-10-17T15:30:50.903

```
import json, ast
r = {u'name': u'A', u'primary_key': 1}
ast.literal_eval(json.dumps(r)) 
```

将打印

```
{'name': 'A', 'primary_key': 1} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-02-09T06:21:39.763

如果访问/打印单个元素列表（例如，顺序或过滤）：

```
my_list = [u'String'] # sample element
my_list = [str(my_list[0])] 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-04-28T11:14:18.847

将输出传递给 str() 函数，它将删除 unicode 输出 u''。同样通过打印输出，它会从中删除 u'' 标签。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-04-27T13:45:09.187

`[u'String']`是包含 Python 2 上的 Unicode 字符串的列表的文本表示形式。

如果你运行，`print(some_list)`那么它相当于
`print'[%s]' % ', '.join(map(repr, some_list))`ie，创建一个 Python 对象的文本表示，它的类型为`list`,`repr()`为每个项目调用函数。

**不要混淆 Python 对象及其文本表示**—<code>repr('a') != 'a' 甚至文本表示的文本表示也不同：`repr(repr('a')) != repr('a')`.

`repr(obj)`返回一个字符串，其中包含对象的可打印表示。它的目的是在 REPL 中明确表示可用于调试的对象。经常`eval(repr(obj)) == obj`。

为避免调用`repr()`，您可以直接打印列表项（如果它们都是 Unicode 字符串），例如：`print ",".join(some_list)`— 它打印逗号分隔的字符串列表：`String`

不要使用硬编码字符编码将 Unicode 字符串编码为字节，而是**直接打印 Unicode 。**否则，代码可能会失败，因为编码不能代表所有字符，例如，如果您尝试对`'ascii'`非 ascii 字符使用编码。或者，如果环境使用与硬编码不兼容的编码，则代码会静默生成 mojibake（损坏的数据在管道中进一步传递）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-01T11:01:20.453

你真的是这个意思`u'String'`吗？

无论如何，您不能只`str(string)`获取字符串而不是 unicode 字符串吗？（这对于 Python 3 应该是不同的，所有字符串都是 unicode。）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-01T11:14:19.253

在“字符串”上使用`dir`或`type`找出它是什么。我怀疑它是 BeautifulSoup 的标记对象之一，它像字符串一样打印，但实际上不是。否则，它在一个列表中，您需要分别转换每个字符串。

无论如何，您为什么反对使用 Unicode？有什么具体原因吗？

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2015-04-11T23:30:43.927

`encode("latin-1")`在我的情况下帮助了我：

```
facultyname[0].encode("latin-1") 
```

# macos - 有谁知道适用于 mac 的免费自然声音文本阅读器？

> ID：599626
> 
> 赞同：2
> 
> 时间：2009-03-01T10:51:26.937
> 
> 标签：macos

有谁知道适用于 mac 的免费自然声音文本阅读器？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-01T10:54:08.397

它没有内置一个吗？我怀疑它和你免费获得的一样自然。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-01T17:00:44.023

OS X 具有适用于任何 Cocoa 应用程序的内置语音服务。只需选择文本并单击 AppName->Services->Speech->Start Speech Text

此外，Preview 可以很好地阅读 PDF。只需打开 PDF 并选择编辑->语音->开始说话。

默认的 Alex 声音（至少在 Leopard 中）非常好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-01T10:54:20.830

您是否尝试过更改语音应用程序上的声音（在系统偏好设置中？）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T17:57:29.250

一些内置的声音听起来比其他声音好得多。特别是，我相信其中一个新声音“Alex”听起来比其他声音更自然。

# java - 使用 Java 标准库将 HTML 字符转换回文本

> ID：599634
> 
> 赞同：42
> 
> 时间：2009-03-01T11:00:44.043
> 
> 标签：java, html, html-entities

我想使用 Java 标准库将一些 HTML 字符转换回文本。我想知道是否有任何图书馆可以实现我的目的？

```
/**
 * @param args the command line arguments
 */
public static void main(String[] args) {
    // TODO code application logic here

    // "Happy & Sad" in HTML form.
    String s = "Happy &amp; Sad";
    System.out.println(s);

    try {
        // Change to "Happy & Sad". DOESN'T WORK!
        s = java.net.URLDecoder.decode(s, "UTF-8");
        System.out.println(s);
    } catch (UnsupportedEncodingException ex) {

    }
} 
```

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-03-01T11:46:21.500

我认为 Apache Commons Lang 库`StringEscapeUtils.unescapeHtml3()`和`unescapeHtml4()`方法是您正在寻找的。请参阅[https://commons.apache.org/proper/commons-text/javadocs/api-release/org/apache/commons/text/StringEscapeUtils.html](https://commons.apache.org/proper/commons-text/javadocs/api-release/org/apache/commons/text/StringEscapeUtils.html)。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-09-27T04:52:43.003

在这里，您只需在应用程序的 lib jsoup 中添加 jar 文件，然后使用此代码。

```
import org.jsoup.Jsoup;

public class Encoder {
    public static void main(String args[]) {
        String s = Jsoup.parse("&lt;Fran&ccedil;ais&gt;").text();
        System.out.print(s);
    }
} 
```

jsoup下载链接：http: [//jsoup.org/download](http://jsoup.org/download)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-01T11:29:17.080

[`java.net.URLDecoder`](http://java.sun.com/javase/6/docs/api/java/net/URLDecoder.html)仅处理`application/x-www-form-urlencoded`MIME 格式（例如“%20”表示空格），而不处理[HTML 字符实体](http://www.w3.org/TR/html401/sgml/entities.html)。我认为Java平台上没有任何东西。您可以编写自己的实用程序类来进行转换，例如[这个](http://gmailassistant.sourceforge.net/src/org/freeshell/zs/common/HtmlManipulator.java.html)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-01T11:37:12.787

URL 解码器只能用于解码来自“application/x-www-form-urlencoded”mime 类型的 html 表单生成的 url 中的字符串。这不支持 html 字符。

经过[搜索](http://www.google.com/search?&q=html+entities+decoding+java)，我在[HTML Parser](http://htmlparser.sourceforge.net/)库中找到了一个[Translate](http://htmlparser.sourceforge.net/javadoc/org/htmlparser/util/Translate.html)类。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-12-12T11:37:16.593

您可以使用 org.apache.commons.lang.StringEscapeUtils 类：

```
String s = StringEscapeUtils.unescapeHtml("Happy &amp; Sad") 
```

这是工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-01T11:15:37.987

我不知道使用标准库有什么方法可以做到这一点。但我确实知道并使用这个处理 html 实体的类。

> *“HTMLEntities 是一个开源 Java 类，它包含一组静态方法（htmlentities、unhtmlentities...），用于将特殊字符和扩展字符转换为 HTML 实体，反之亦然。”*

[http://www.tecnick.com/public/code/cp_dpage.php?aiocp_dp=htmlentities](http://www.tecnick.com/public/code/cp_dpage.php?aiocp_dp=htmlentities)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-04-07T00:02:10.553

或者你可以使用 unescapeHtml4：

```
 String miCadena="GU&#205;A TELEF&#211;NICA";
    System.out.println(StringEscapeUtils.unescapeHtml4(miCadena)); 
```

此代码打印行：GUÍA TELEFÓNICA

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-25T14:27:50.493

正如@jem 建议的那样，可以使用 jsoup。

使用 jSoup 1.8.3 可以使用保留原始 html的*Parser.unescapeEntities方法。*

```
import org.jsoup.parser.Parser;
...
String html = Parser.unescapeEntities(original_html, false); 
```

似乎在以前的某些版本中不存在此方法。

# c++ - 子类的静态成员变量

> ID：599640
> 
> 赞同：1
> 
> 时间：2009-03-01T11:05:36.653
> 
> 标签：c++, inheritance, static

是否可以在基类中定义一个静态成员变量，并有几个派生类，每个派生类都使用它自己的这个成员变量的实例？

以下代码编译成功，并打印了正确的输出，但我仍然不确定这样做是否是一个好习惯。**在下面的例子中，如果我只明确定义了一个 s 实例（通过调用：string A::s;）但我实际上使用了 2 个实例，它如何工作？**

```
class A 
{
   protected:
    void SetS(string new_s){s = new_s;}
    void PrintS(){cout << s << endl;};
   private:
    static string s;

};

class B : public A
{
   public:
    void foo(){ SetS("bbb"); PrintS();};
};

class C : public A
{
   public:
    void foo(){ SetS("ccc"); PrintS();};
};

string A::s;

int main()
{
    B b;
    b.foo(); // results in output: bbb
    C c;
    c.foo(); // results in output: ccc
    b.foo(); // results in output: bbb
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-01T11:18:01.240

确实是一种非常奇怪的继承用法。基类应该理想地定义接口，并且根据良好的 OO 设计原则，如果可能的话，包含尽可能少的状态或根本不包含状态。

这是有效的，因为您`foo()`会重置`A::s`每次调用它的值。尝试打印的地址`A::s`。只有一个对象。如果您不每次都设置值并且您有多个对象使用另一个成员函数`bar()`来读取 A::s 的值，这将不起作用。

如果对象也是在单独的线程中创建的，`B`您可能会遇到同步问题。`C`你最终会得到UB。

# c# - 使用 C# 检索完整的进程列表

> ID：599663
> 
> 赞同：1
> 
> 时间：2009-03-01T11:33:24.620
> 
> 标签：c#, windows, process

我正在尝试编写一个 C# 程序来检索完整的进程列表。但是我发现一个应用程序打开了一个窗口，但我在 Windows 任务管理器的进程选项卡中看不到它，我在任务选项卡中看到它。此外，我也无法使用我的 C# 代码获取它的信息。

```
static void showProcesses()
{
    Process[] procs = Process.GetProcesses();

    foreach (Process proc in procs)
    {
        Console.WriteLine(proc.ProcessName);
    }
} 
```

我浏览了很多论坛，但我只能找到隐藏进程的方法，我没有找到任何显示隐藏进程的方法。有谁知道如何检索隐藏的进程信息？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-01T11:38:32.173

There are no hidden processes on Windows. Only processes you do not have (security) rights to see.

A process running as an administrator (in Vista/Win7/Win2k8 would need to be elevated) will always be able to see all processes.

However, a console application that lists the processes may well exit before Task Manager's display refreshes, and thus won't be seen. This is likely with a simple program even with update speed set to "high".

You need to keep your process around until Task manager has updated its display. The simplest way would be do add the following statements to the end of your Main method:

```
Console.Write("Press ENTER to exit");
Console.ReadLine(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T11:40:48.393

I'm not sure what you mean. The code above lists the same number of processes as `pslist`. When you talk about methods to hide a process are you talking about root kits? If so they usually work by changing how the list commands work. I.e. the processes are in fact being enumerated, but the info is not displayed to the user.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T12:11:10.427

它工作得很好，你只需要添加：

```
Console.Write("Press ENTER to exit");
Console.ReadLine(); 
```

最后或使用 ctrl + F5 开始项目

# c++ - 使用不同长度的数组静态初始化结构

> ID：599664
> 
> 赞同：0
> 
> 时间：2009-03-01T11:33:29.020
> 
> 标签：c++

我有一个标识符<=>结构对的静态映射，每个结构都应该包含一些数组。在编译时一切都是已知的。也就是说，我想在这里有这样的东西：

```
ID1 => name: someString
       flagCount: 3
       flags: [1, 5, 10] 
```

静态创建（如果可能）。当然，像这样的声明：

```
struct Info
{
    const char* name;
    int flagCount;
    int flags[];
}; 
```

将是理想的，只要我可以像...一样初始化它

```
Info infos [] = { ... }; 
```

这是不可能的，因为数组的长度不同（除了我遗漏了一些东西）。或者，我想（ab）`boost::assign`为此使用，但我想知道是否有推荐的解决方案。如果我只能将信息结构存储到一个数组中，并存储到其他地方的映射中，那我很好。

编辑：关于当前解决方案的注释。目前，我有：

```
struct Info
{
    Info (const std::vector<int>& flags) : flags {}
    std::vector<int> flags;
}; 
```

我使用：

```
const std::map<ID, Info> map = boost::assign::map_list_of
    ("ID1", Info (boost::assign::list_of (1)(2)(3)); 
```

哪个有效，我只是好奇是否有更简单的解决方案（基于模板？）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T12:04:26.747

数组中的元素必须彼此大小相同，否则无法`infos[i]`访问它们 - 编译器必须逐步遍历数组并查看每个元素的大小，直到`i`找到下一个元素的开始位置. 您可以为每个元素连续分配足够的内存，然后创建一个指向元素的指针数组（指针是固定大小的）。如果您只需要映射而不是索引信息，那么您的地图将是指针的标识符。

或者，正如您在编译时知道的大小，如果只有几个标志，则使`Info::flags`数组足够大以容纳最大标志，或者使其成为指向标志数组的指针，以便 Info 是一个固定大小的结构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T14:45:14.300

使用指向可变长度数组的指针：

```
struct Info
{
    const char* name;
    int flagCount;
    int *flags;
}; 
```

或足够大以容纳所有标志的固定大小数组：

```
struct Info
{
    const char* name;
    int flagCount;
    int flags[MAX_FLAGS];
}; 
```

两种解决方案都会浪费一些内存；但对于解决方案 1，每个结构只有一个指针；请注意，您已经隐含地将此解决方案用于名称字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T15:52:49.067

像你所做的那样使用向量几乎可以肯定是最好的解决方案。oefe 为您提供了一个解决方案，您可以在 Info 本身中包含一些间接，另一种选择是在地图中间接，即`map<ID, Info*>`（或者因为您使用 boost `map<ID, shared_ptr<Info> >`）并定义 Info 之类的。其实不要这样做。使用向量。这是最好的解决方案。

```
 struct Info {
    const char *name;
    int flagCount;
    int flags[1]; // this is cheating...
 };   

 Info* make_info(int count) {
        char *buf = new char[sizeof(Info) + (sizeof(int) * (count - 1))];
        Info *rv = static_cast<Info*>(static_cast<void*>(buf));
        rv->flagCount = count;
 } 
```

# php - problem accessing an iframe that was called using ajax

> ID：599668
> 
> 赞同：0
> 
> 时间：2009-03-01T11:34:16.757
> 
> 标签：php, javascript, html, ajax

i called an iframe using ajax onto the current page and tried to print the page but is printing blank page can somebody help me with this

what i did was: current page:

```
<input type="button" onclick=verifyControl('1001') >
<div id='pa_print'></div> 
```

js file function:

```
function verifyControl(rNo) {
    xmlHttp=GetXmlHttpObject();
    if (xmlHttp==null) {
        alert ("Your browser does not support AJAX!");
        return;
    } 
    var url="js/p_Print.php";
    url=url+"?control_no="+rNo;
    xmlHttp.onreadystatechange=paymentPrintVerify;
    xmlHttp.open("GET",url,true);
    xmlHttp.setRequestHeader("If-Modified-Since", "Sat, 1 Jan 2000 00:00:00 GMT");
    xmlHttp.send(null);
    remitCont_no=document.getElementById("remitContNo").value;
    if(rNo!=remitCont_no) {
        alert("invalid remit control no");
        return;
    }   
}

function PrintVerify() { 
    if(xmlHttp.readyState==1) {   
        //document.getElementById("pa_print").innerHTML="";
        //document.getElementById("pa_print").innerHTML="<div align='center'><img src='./images/loader-1.gif'/><br><label >Verifying...  </label></div>"; 
    }
    if(xmlHttp.readyState==4) { 
        document.getElementById("pa_print").innerHTML="";
        document.getElementById("pa_print").innerHTML=xmlHttp.responseText;
        frames['frame1'].print();
    }//end of else
} 
```

server page: p_Print.php:

```
<iframe src="pa_print.php?cono=<?=$contno ?>" name='frame1'></frame> 
```

can somebody help me with this , i am not able to get the contents of the iframe to be printed

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T11:47:07.740

尝试导航 iframe (frm.src='new_script.php')，而不是 ajax + 设置 innerhtml。然后在 iframe 中加载的页面上，钩住 onload 事件并打印页面。

# c# - 最有效（读取时间）的字符串搜索方法是什么？（C＃）

> ID：599669
> 
> 赞同：4
> 
> 时间：2009-03-01T11:34:29.237
> 
> 标签：c#, algorithm, string, search

我发现我的程序正在搜索大量冗长的字符串（20,000+），试图找到一个特定的独特短语。

在 C# 中执行此操作的最有效方法是什么？

以下是当前代码，其工作方式如下：

1.  搜索从 startPos 开始，因为目标区域从一开始就被移除了
2.  它遍历字符串，在每一步都检查从该点开始的子字符串是否以 startMatchString 开头，这是已找到目标字符串开头的指示符。（目标字符串的长度不同）。
3.  从这里它创建一个新的子字符串（切断标记目标字符串开始的 11 个字符）并搜索 endMatchString

我已经知道这是一个非常复杂且可能非常低效的算法。实现相同结果的更好方法是什么？

```
string result = string.Empty;    
for (int i = startPos; i <= response.Length - 1; i++)
{
   if (response.Substring(i).StartsWith(startMatchString))
   {
       string result = response.Substring(i).Substring(11);
       for (int j = 0; j <= result.Length - 1; j++)
       {
           if (result.Substring(j).StartsWith(endMatchString))
           {
               return result.Remove(j)
           }
       }
   }
}
return result; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-01T13:59:41.117

您可以使用 String.IndexOf，但请确保使用 StringComparison.Ordinal，否则它可能会慢一个数量级。

```
private string Search2(int startPos, string startMatchString, string endMatchString, string response) {
    int startMarch = response.IndexOf(startMatchString, startPos, StringComparison.Ordinal);
    if (startMarch != -1) {
        startMarch += startMatchString.Length;
        int endMatch = response.IndexOf(endMatchString, startMarch, StringComparison.Ordinal);
        if (endMatch != -1) { return response.Substring(startMarch, endMatch - startMarch); }
    }
    return string.Empty;
} 
```

在 183 KB 文件的大约 40% 处搜索 1000 次字符串大约需要 270 毫秒。没有 StringComparison.Ordinal 大约需要 2000 毫秒。
使用您的方法搜索 1 次花费了 60 多秒，因为它每次迭代都会创建一个新字符串 (O(n))，从而使您的方法成为 O(n^2)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-01T12:28:56.407

有一大堆算法，

*   博耶和摩尔
*   星期日
*   克努特-莫里斯-普拉特
*   拉宾-卡普

我建议使用简化的 Boyer-Moore，称为 Boyer-Moore-Horspool。

C 代码出现在维基百科上。对于java代码看

[http://www.fmi.uni-sofia.bg/fmi/logic/vboutchkova/sources/BoyerMoore_java.html](http://www.fmi.uni-sofia.bg/fmi/logic/vboutchkova/sources/BoyerMoore_java.html)

[在http://www.ibm.com/developerworks/java/library/j-text-searching.html](http://www.ibm.com/developerworks/java/library/j-text-searching.html)下有一篇关于这些的好文章

如果你想使用内置的东西去正则表达式。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-01T11:43:13.707

这取决于您要在字符串中查找的内容。如果您正在寻找特定的序列`IndexOf/Contains`，则速度很快，但如果您正在寻找通配符模式`Regex`，则针对这种搜索进行了优化。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-01T11:39:31.297

我会尝试使用正则表达式而不是滚动我自己的字符串搜索算法。您可以预编译正则表达式以使其运行得更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-01T11:40:02.250

你可以使用正则表达式；它针对这种搜索和操作进行了优化。

您也可以尝试 IndexOf ...

```
string result = string.Empty;

if (startPos >= response.Length) 
    return result;

int startingIndex = response.IndexOf(startMatchString, startPos);
int rightOfStartIndex = startingIndex + startMatchString.Length;

if (startingIndex > -1 && rightOfStartIndex < response.Length)
{
    int endingIndex = response.IndexOf(endMatchString, rightOfStartIndex);
    if (endingIndex > -1)
        result = response.Substring(rightOfStartIndex, endingIndex - rightOfStartIndex);
}

return result; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-01T11:58:48.693

对于很长的字符串，您无法击败 boyer-moore 搜索算法。它比我在这里解释的要复杂，但是 CodeProject 网站上有一篇非常好的文章。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-01T12:00:16.740

如前所述，正则表达式是您的朋友。您可能想查看 RegularExpressions.Group。这样您就可以命名匹配结果集的一部分。

[这是一个例子](http://www.java2s.com/Tutorial/CSharp/0360__Regular-Expression/NameaRegexgroup.htm)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-01T14:10:58.813

这是一个使用`IndexOf`（**当心**：从我的头顶写的，没有测试它）的例子：

```
int skip = 11;
int start = response.IndexOf(startMatchString, startPos);
if (start >= 0)
{
   int end = response.IndexOf(startMatchString, start + skip);
   if (end >= 0)
       return response.Substring(start + skip, end - start - skip);
   else
       return response.Substring(start + skip);
}
return string.Empty; 
```

# php - 如何包含（）目录中的所有 PHP 文件？

> ID：599670
> 
> 赞同：248
> 
> 时间：2009-03-01T11:36:28.293
> 
> 标签：php, include

在 PHP 中我可以包含一个脚本目录吗？

即代替：

```
include('classes/Class1.php');
include('classes/Class2.php'); 
```

有没有类似的东西：

```
include('classes/*'); 
```

似乎找不到为特定类包含大约 10 个子类的集合的好方法。

* * *

## 回答 #1

> 赞同：467
> 
> 时间：2009-03-01T11:44:39.040

```
foreach (glob("classes/*.php") as $filename)
{
    include $filename;
} 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-03-01T11:47:34.493

这是我在 PHP 5 中包含多个文件夹中的大量类的方式。这只有在你有类的情况下才有效。

```
/*Directories that contain classes*/
$classesDir = array (
    ROOT_DIR.'classes/',
    ROOT_DIR.'firephp/',
    ROOT_DIR.'includes/'
);
function __autoload($class_name) {
    global $classesDir;
    foreach ($classesDir as $directory) {
        if (file_exists($directory . $class_name . '.php')) {
            require_once ($directory . $class_name . '.php');
            return;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2013-04-19T13:53:34.297

我意识到这是一篇较旧的帖子，但是...不要包括您的课程...而是使用 __autoload

```
function __autoload($class_name) {
    require_once('classes/'.$class_name.'.class.php');
}

$user = new User(); 
```

然后，每当您调用尚未包含的新类时，php 将自动触发 __autoload 并为您包含它

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2012-03-13T21:43:26.053

这只是对 Karsten 代码的修改

```
function include_all_php($folder){
    foreach (glob("{$folder}/*.php") as $filename)
    {
        include $filename;
    }
}

include_all_php("my_classes"); 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2017-02-08T15:21:49.363

**如何在 2017 年做到这一点：**

```
spl_autoload_register( function ($class_name) {
    $CLASSES_DIR = __DIR__ . DIRECTORY_SEPARATOR . 'classes' . DIRECTORY_SEPARATOR;  // or whatever your directory is
    $file = $CLASSES_DIR . $class_name . '.php';
    if( file_exists( $file ) ) include $file;  // only include if file exists, otherwise we might enter some conflicts with other pieces of code which are also using the spl_autoload_register function
} ); 
```

此处的 PHP 文档推荐：[自动加载类](http://php.net/manual/en/language.oop5.autoload.php)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-03-27T10:13:29.427

您可以使用**set_include_path**：

```
set_include_path('classes/'); 
```

[http://php.net/manual/en/function.set-include-path.php](http://php.net/manual/en/function.set-include-path.php)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-02-19T12:58:11.503

如果文件之间**没有依赖**关系......这是一个递归函数，用于在所有子目录中包含所有 php 文件：

```
$paths = array();

function include_recursive( $path, $debug=false){
  foreach( glob( "$path/*") as $filename){        
    if( strpos( $filename, '.php') !== FALSE){ 
       # php files:
       include_once $filename;
       if( $debug) echo "<!-- included: $filename -->\n";
    } else { # dirs
       $paths[] = $filename; 
    }
  }
  # Time to process the dirs:
  for( $i=count($paths)-1; $i>0; $i--){
    $path = $paths[$i];
    unset( $paths[$i]);
    include_recursive( $path);
  }
}

include_recursive( "tree_to_include");
# or... to view debug in page source:
include_recursive( "tree_to_include", 'debug'); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-05-23T10:41:48.947

```
<?php
//Loading all php files into of functions/ folder 

$folder =   "./functions/"; 
$files = glob($folder."*.php"); // return array files

 foreach($files as $phpFile){   
     require_once("$phpFile"); 
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-12-30T20:04:25.503

如果您希望包含一堆类而不必一次定义每个类，您可以使用：

```
$directories = array(
            'system/',
            'system/db/',
            'system/common/'
);
foreach ($directories as $directory) {
    foreach(glob($directory . "*.php") as $class) {
        include_once $class;
    }
} 
```

这样，您可以只在包含该类的 php 文件上定义该类，而不是整个列表`$thisclass = new thisclass();`

至于它处理所有文件的能力如何？我不确定这可能会稍微降低速度。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-10-22T08:43:12.850

如果要将所有内容包含在目录及其子目录中：

```
$dir = "classes/";
$dh  = opendir($dir);
$dir_list = array($dir);
while (false !== ($filename = readdir($dh))) {
    if($filename!="."&&$filename!=".."&&is_dir($dir.$filename))
        array_push($dir_list, $dir.$filename."/");
}
foreach ($dir_list as $dir) {
    foreach (glob($dir."*.php") as $filename)
        require_once $filename;
} 
```

不要忘记它将使用字母顺序来包含您的文件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-01T11:42:55.003

我建议您使用[readdir()](http://php.net/manual/en/function.readdir.php)函数，然后循环并包含文件（请参阅该页面上的第一个示例）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-07-17T13:24:57.870

尝试为此目的使用库。

这是我构建的相同想法的简单实现。它包括指定的目录和子目录文件。

***包括所有***

通过终端 [cmd] 安装它

```
composer install php_modules/include-all 
```

或者将其设置为 package.json 文件中的依赖项

```
{
  "require": {
    "php_modules/include-all": "^1.0.5"
  }
} 
```

使用

```
$includeAll = requires ('include-all');

$includeAll->includeAll ('./path/to/directory'); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-07-27T00:51:52.230

这是一个较晚的答案，指的是 PHP > 7.2 到 PHP 8。

OP 没有在标题中询问课程，但从他的措辞中我们可以读到他想要包括课程。（顺便说一句。此方法也适用于命名空间）。

通过使用**require_once**，您可以用一条毛巾杀死三只蚊子。

*   首先，如果文件不存在，您会在日志文件中以错误消息的形式获得有意义的打击。这在调试时非常有用。（包含只会生成一个可能不那么详细的警告）
*   您仅包含包含类的文件
*   你避免加载一个类两次

```
spl_autoload_register( function ($class_name) {
    require_once  '/var/www/homepage/classes/' . $class_name . '.class.php';
} ); 
```

这将适用于类

```
new class_name; 
```

或命名空间。例如...

```
use homepage\classes\class_name; 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2012-09-04T08:05:17.513

不要编写 function() 来包含目录中的文件。您可能会丢失变量范围，并且可能必须使用“全局”。只需循环文件即可。

此外，当包含的文件的类名将扩展到另一个文件中定义的另一个类时，您可能会遇到困难——该文件尚未包含在内。所以，要小心。

# asp.net - how to navigate pages in asp.net

> ID：599682
> 
> 赞同：5
> 
> 时间：2009-03-01T11:40:38.783
> 
> 标签：asp.net

I have to navigate to another page in asp.net suppose I have two pages i.e. Default.aspx and Default2.aspx how do I navigate between them ?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-01T11:49:57.170

您可以在您的 aspx 页面中使用[锚点：](http://www.w3.org/TR/html401/struct/links.html#h-12.2)

```
<a href="Default2.aspx">Click to navigate to Default2.aspx</a> 
```

或在您的代码中进行重定向：

```
Response.Redirect("~/Default2.aspx"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-01T11:48:39.967

有很多方法，这里有一些可以帮助您入门

```
<a href="default2.aspx">go there</a>

<asp:HyperLink runat="server" ID="lnk" Text="go there" NavigateURL="default2.aspx" />

<asp:LinkButton runat="server" ID="btn" Text="go there" OnClick="server_method_that_redirects" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T13:53:01.290

在您的服务器端代码隐藏中，您还可以考虑使用 Server.Transfer(..) 而不是 Response.Redirect(..)。Response.Redirect 向浏览器发送指令以更改页面，而 Server.Transfer 则直接在服务器端进行。浏览网页以获取有关差异的更多信息。

# ajax - Ajax / Json 如何在 mysql 中运行 INSERT/UPDATE

> ID：599692
> 
> 赞同：0
> 
> 时间：2009-03-01T11:44:23.113
> 
> 标签：ajax, json, jquery

再次与[我的周末项目](http://www.my-clock.net)有关，我正在尝试更多地学习网络开发。所以我将我想要实现的功能列表放入其中，有些东西我完全不知道该怎么做。

我一直在阅读有关如何使用 ajax 的教程，但我找不到一个简单的教程，我可以复制粘贴（进行一两次更改）**以查看它的工作原理**，然后再**了解它的工作原理**。

我一直在搜索的只是一个关于 ajax 函数的简单示例，它触发了 mysql 插入或更新。任何人作为一个简单的例子来说明如何做到这一点？我认为这将是一个很好的开始学习它。（Ajax 或 Json 都可以）。

**如果我被骗了，请纠正我**：我以[本教程](http://www.xul.fr/en-xml-ajax.html)为基础。因此，显然客户端无法访问数据库调用，我应该做的就是创建一个代码片段来向数据库添加内容，对吗？例如创建一个可以用*xhr.open(GE​​T, "addcomment.php?comment=mycomment", true); 调用的“addcomment.php”。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T11:48:08.423

听起来你做对了。使用 Ajax 调用服务器端脚本，然后该脚本会为您工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T11:57:55.280

一个好的设置是在客户端使用像 jQuery 这样的框架。该框架将自动编码和解码 JSON。在服务器端，您可以创建一个类来处理所有 ajax（或者更确切地说，ajaj，因为我们使用的是 JSON）请求。这是一个简短的 PHP 文件，显示了总体思路。向 functionMap 数组添加更多元素，并将相应的函数添加到类中。

```
class Ajaj{
    private $callback = "";
    private $functionMap = array(   "select" => 'getIt');
    function Ajaj(){
        if(array_key_exists('jsoncallback',$_GET)){
            $this->callback=$_GET['jsoncallback'];
        }
    }
    function parse(){
        echo "$this->callback(";
        if(array_key_exists('action', $_POST)){
            $action = $_POST['action'];

            if(array_key_exists($action, $this->functionMap)){
                echo $this->functionMap[$action];
            }
        }else{
            echo "{}";
        }
        echo ")";
    }

    function getIt(){
            return json_encode(//get the database stuff here);
    }
}
$ajaj = new Ajaj();
$ajaj->parse(); 
```

# .net-3.5 - 每个客户端连接都需要一个 SocketAsyncEventArgs 吗？

> ID：599700
> 
> 赞同：0
> 
> 时间：2009-03-01T11:48:20.280
> 
> 标签：.net-3.5, sockets

请为我建立的每个客户端连接创建一个新的 SocketAsyncEventArgs。

我在一个循环中建立了几个客户端连接，从数据库中为每个客户端状态填充 UserToken。

有没有办法重用 SocketAsyncEventArgs 并且仍然为每个连接维护单独的 UserToken 状态。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-15T23:07:21.623

这个问题有点老了，但在我看来它仍然相关。我建议以下链接供参考：

*   [如何使用 SocketAsyncEventArgs 类](http://www.codeproject.com/KB/IP/socketasynceventargssampl.aspx)
*   [SocketAsyncEventArgs 类](http://msdn.microsoft.com/en-us/library/system.net.sockets.socketasynceventargs.aspx)

我确实推荐 codeproject 链接，因为服务器实现了一个 SocketAsyncEventArgs 池（它回答了你的问题）。但是请注意，该代码存在需要解决的问题。

# ruby - 如何使用 Ruby 生成 WSDL？

> ID：599703
> 
> 赞同：4
> 
> 时间：2009-03-01T11:55:14.630
> 
> 标签：ruby, wsdl

我开始使用 Ruby 和 Soap 并有一些问题：

如何为我创建的服务生成 WSDL 文件？它会与 .NET 客户端兼容吗？

* * *

```
begin
   class MyServer < SOAP::RPC::StandaloneServer
         # Handler methods
      def add(a, b)
         return a + b
      end
      def div(a, b)
         return a / b
      end

      # Expose our services
      def initialize(*args)
         add_method(self, 'add', 'a', 'b')
         add_method(self, 'div', 'a', 'b')
      end

  end
  server = MyServer.new("MyServer",
            'urn:ruby:calculation', 'localhost', 8080)
  trap('INT'){
     server.shutdown
  }
  server.start
rescue => err
  puts err.message
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-01T22:34:54.903

ActionWebService（以前在 Rails 核心中，现在是 gem）具有生成 WSDL 文件的工具。即使您没有在 Rails 中运行服务，您也可以使用这些工具。

[http://www.datanoise.com/articles/2008/7/2/actionwebservice-is-back](http://www.datanoise.com/articles/2008/7/2/actionwebservice-is-back)

至于它是否适用于 .NET 客户端，答案是可能的。许多 .NET 客户端似乎期望 Microsoft 的“扩展”SOAP 信息，这是 .NET Web 服务默认提供的。如果客户端也能够在没有额外内容的情况下使用服务，那么当然可以。

### 更新#1

上面的链接似乎不再起作用。然而，在 github 上出现了一些 ActionWebService 的分支。[你可以在这里](https://github.com/search?q=actionwebservice&ref=commandbar)看到一个很好的列表。以下是一些关键版本的链接：

*   [原始数据噪声版本](https://github.com/datanoise/actionwebservice)
*   [clevertechru 的端口，适用于 Rails 3.1.* 和 Ruby 1.9](https://github.com/clevertechru/actionwebservice)

# iphone - iPhone 上是否存在 Core Data？或者您将如何在 iPhone 上保存数据？

> ID：599712
> 
> 赞同：3
> 
> 时间：2009-03-01T12:00:19.487
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, core-data

假设我制作了一个应用程序，使用户能够做简短的笔记并写下来。iPhone OS 上也有 Core Data 吗？或者你会如何在 iPhone 中保存这些数据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-01T12:28:12.740

不。Core Data、Cocoa Bindings 以及 Objective-C Garbage Collection 都从 iPhone 中消失了。

更新：如下所述，Core Data 适用于 iPhone OS 3.0。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-26T16:36:36.307

如果你可以等待 iPhone OS 3.0，Apple 的预告片将 Core Data 列为 3.0 中的新功能之一。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-01T15:44:07.030

如果您有大量数据，SQLite 通常是首选的存储方法。您可以手动编写 SQL 类，或者有许多不错的第三方解决方案。

对于少量信息，您可以使用 NSCoding 和 NSArchiver 轻松地将数据存储在文件中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-01T12:48:39.353

我将重申上述内容，但您可以查看[OmniDataObjects](http://www.omnigroup.com/developer/)，它提供核心数据式功能并在 iPhone 上运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-26T15:33:29.983

根据复杂程度，您可以将数据保存在 sqlite 数据库、plist 文件中，甚至可以创建自己的 xml 文件并将它们保存在 iphone 文件系统中（通常在文档目录中）

如果您预计不会有太多读取/写入/复杂查找，请坚持使用 plist 文件或 xml 文件

但是，如果有更复杂的事情，请继续使用 sqlite。

如果您确实继续使用 sqlite，那么我建议您使用[FMDB](http://gusmueller.com/blog/archives/2008/03/fmdb_for_iphone.html) - sqlite 的可可包装器，这可以为您节省大量重复代码

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T20:27:21.740

如果您必须对保存的数据进行排序或查询，最好的解决方案是 SQLite。否则，您可以使用序列化数据。NSDictionary 和 NSArray 提供 -writeToFile 方法将序列化（以 xml 格式）数据写入文件。

马可

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-01T12:06:09.673

在 iPhone 上保存数据并没有太大区别——将数据写入文件（如 plist）。据我所知，没有 iPhone Core Data。

# linux - 如何清理 Linux 内核使用的缓存

> ID：599719
> 
> 赞同：28
> 
> 时间：2009-03-01T12:01:54.020
> 
> 标签：linux, linux-kernel, kernel, memory-management

我想在缓存开始占用过多内存后强制 Linux 内核为应用程序分配更多内存（从“free”的输出可以看出）。

我跑了

```
sudo sync; sudo sysctl -w vm.drop_caches=3; free 
```

（释放磁盘目录/索引节点缓存和页面缓存），我看到只有大约一半的已用缓存被释放 - 其余的仍然存在。我怎样才能知道是什么占用了缓存的其余部分并强制释放它？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-28T02:17:25.637

您可能想要增加`vfs_cache_pressure`并设置`swappiness`为`0`。

这样做将使内核更快地回收缓存，同时在决定要分页的内容时给予进程同等或更多的支持。

如果您关心的进程很少进行磁盘 I/O，您可能*只想这样做。*

如果一个受网络 I/O 限制的进程必须交换来服务请求，那就是个问题，真正的解决方案是把它放在竞争不那么激烈的服务器上。

在默认`swappiness`设置下，内核几乎总是倾向于将与 FS 相关的缓存保留在实际内存中。

As such, if you increase the cache pressure, be sure to equally adjust `swappiness`.

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-01T12:44:18.710

**/proc/meminfo**的内容告诉你内核使用 RAM 的目的。

您可以使用**/proc/sys/vm/vfs_cache_pressure**来强制内核更懒惰或急切地回收用于文件系统相关缓存的内存。

请注意，您的应用程序只有在很少或没有磁盘 I/O 的情况下才能从调整此参数中受益。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-25T10:00:38.387

您可能会发现[John Nilsson 对我的问题的回答](https://stackoverflow.com/questions/478340/clear-file-cache-to-repeat-performance-testing/478367#478367)对清除缓存很有用，以便测试这是否与您的问题有关：

> `sync && echo 1 > /proc/sys/vm/drop_caches`

虽然我猜唯一真正的区别是 1 对 3

# xml - TransformMiiX (XML/XSLT)

> ID：599720
> 
> 赞同：0
> 
> 时间：2009-03-01T12:02:28.670
> 
> 标签：xml, xslt

如果您查看[www.PollDaddy.com](http://www.polldaddy.com)，您会发现对于每个问题，您都需要添加一个生成的 xml 和 xslt 文件，并在收到它们时进行转换。

然后，当您保存页面时，您会看到调整后的 xml 文件（您填写的问题数据）被发送回服务器以保存到数据库中。

我想制作类似这种技术的东西，但我无法将转换后的 xml 转换为 html 并使用调整后的数据恢复其原始 xml 格式。有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-27T09:08:27.477

我没有用过 PollDaddy，但我猜他们实际上并没有在数据库中存储 XML。最有可能的是，它是为每个请求在服务器端生成的。这个过程看起来像这样：

1.  浏览器请求特定问题
2.  服务器从数据库中检索问题详细信息
3.  服务器根据问题数据生成 XML
4.  服务器使用 XML 和 XSLT 响应
5.  用户回答问题
6.  浏览器将原始答案数据发布到服务器
7.  服务器使用答案数据更新数据库
8.  服务器根据问答数据生成 XML
9.  服务器使用 XML 和 XSLT 响应

将 HTML 转换为 XML 并通过请求将其推送是非常低效的。

# c# - 使用 MarshalByRefObject 的 [Serializable] 属性或子类？

> ID：599731
> 
> 赞同：17
> 
> 时间：2009-03-01T12:14:30.013
> 
> 标签：c#, remoting, appdomain

我想跨 AppDomains 使用一个对象。

为此，我可以使用 [Serializeable] 属性：

```
[Serializable]
class MyClass
{
    public string GetSomeString() { return "someString" }
} 
```

或 MarshalByRefObject 的子类：

```
class MyClass: MarshalByRefObject
{
    public string GetSomeString() { return "someString" }
} 
```

在这两种情况下，我都可以像这样使用该类：

```
AppDomain appDomain = AppDomain.CreateDomain("AppDomain");
MyClass myObject = (MyClass)appDomain.CreateInstanceAndUnwrap(
                   typeof(MyClass).Assembly.FullName,
                   typeof(MyClass).FullName);
Console.WriteLine(myObject.GetSomeString()); 
```

**为什么这两种方法似乎具有相同的效果？两种方法有什么区别？我什么时候应该偏爱一种方法而不是另一种方法？**

编辑：表面上我知道两种机制之间存在差异，但是如果有人从灌木丛中跳出来问我这个问题，我无法给他正确的答案。这些问题是相当开放的问题。我希望有人能比我做得更好。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-01T12:54:18.530

使用 MarshallByRef 将在远程 AppDomain 中执行您的方法。当您将 CreateInstanceAndUnwrap 与 Serializable 对象一起使用时，会将该对象的副本复制到本地 AppDomain，因此任何方法调用都将在本地 AppDomain 中执行。

如果您想要在 AppDomain 之间进行通信，请使用 MarshallByRef 方法。

一个例子：

```
using System;
using System.Reflection;

[Serializable]
public class SerializableClass
{
    public string WhatIsMyAppDomain()
    {
        return AppDomain.CurrentDomain.FriendlyName;
    }
}

public class MarshallByRefClass : MarshalByRefObject
{
    public string WhatIsMyAppDomain()
    {
        return AppDomain.CurrentDomain.FriendlyName;
    }
}    

class Test
{

    static void Main(string[] args)
    {
        AppDomain ad = AppDomain.CreateDomain("OtherAppDomain");

        MarshallByRefClass marshall = (MarshallByRefClass)ad.CreateInstanceAndUnwrap(Assembly.GetExecutingAssembly().FullName, "MarshallByRefClass");
        SerializableClass serializable = (SerializableClass)ad.CreateInstanceAndUnwrap(Assembly.GetExecutingAssembly().FullName, "SerializableClass");

        Console.WriteLine(marshall.WhatIsMyAppDomain());
        Console.WriteLine(serializable.WhatIsMyAppDomain());

    }
} 
```

当您从 MarshallByRef 对象调用 WhatIsMyAppDomain 时，此代码将显示“OtherAppDomain”，当您从 Serializable 对象调用时，将显示您的默认 AppDomain 名称。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-01T18:26:19.603

这些方法具有截然不同的效果。

使用 MarshalByRef 版本，您正在创建对象的 1 个实例。它将位于新创建的 AppDomain 中。对对象的所有访问都是通过[TransparentProxy](http://blogs.msdn.com/cbrumme/archive/2003/07/14/51495.aspx)完成的。

使用 Serializable 版本，您将创建对象的 2 个实例。一个是在新创建的 AppDomain 中创建的。CreateInstanceAndUnwrap 调用将序列化这个对象并在原始应用程序域中反序列化它。这将创建完全独立于第一个版本的对象的第二个版本。事实上，下一次 GC 几乎肯定会消除原始对象，而您将只剩下一个实例。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-01T12:22:03.660

> 为什么这两种方法具有相同的效果？

它们*没有*相同的效果。

随着`MarshalByRefObject`您跨 AppDomain 边界引用一个对象。`[Serializable]`正在制作对象的副本。如果对象的状态在子域中被修改然后再次检查（或`Console.WriteLine`在子 AppDomain 内部执行），这将显示出来。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-01T14:32:28.607

`MarshalByRefValue`并`Serializable`为远程处理/跨 AppDomain 通信实现不同的语义。`MarshalByRefValue`本质上通过代理对象为您提供引用语义，同时`Serializable`为您提供值语义（即复制对象的状态）。

换句话说`MarshalByRefValue`，将允许您跨不同的 AppDomains 修改实例，而`Serializable`不会。当您只需要从一个 AppDomain 到另一个 AppDomain 获取信息时，后者很有用，例如从一个 AppDomain 到另一个 AppDomain 获取异常的内容。

# iphone - 禁用 UITextField 的简单方法？

> ID：599733
> 
> 赞同：46
> 
> 时间：2009-03-01T12:16:20.117
> 
> 标签：iphone, ios, uitextfield

有没有一种简单的方法来禁用`UITextField`代码？

我的应用程序有 12 个`UITextField`默认情况下都打开，但是当在我的 Segment Control 中检测到更改时，我想`UITextField`根据用户选择的 Segment 禁用一些。

只需要知道如何禁用它或使其不可编辑？

谢谢

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-03-01T12:31:06.573

在 Objective-C 中：

```
textField.enabled = NO; 
```

在斯威夫特：

```
textField.isEnabled = false 
```

参考：[UIControl.isEnabled](https://developer.apple.com/documentation/uikit/uicontrol/1618217-isenabled)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-05-01T08:56:51.447

如果您还想指示文本字段已禁用，则应添加更多代码：

如果使用 UITextBorderStyleRoundedRect，则只能将文本变灰：

```
textField.enabled = NO;
textField.textColor = [UIColor lightGrayColor]; 
```

如果使用任何其他样式，您也可以将背景变灰：

```
textField.enabled = NO;
textField.backgroundColor = [UIColor lightGrayColor]; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-07-08T17:40:41.803

当您也有多个文本字段时，这将是最简单的：

在 viewDidLoad:( 仅为不应编辑的文本字段设置委托。

```
self.textfield.delegate=self; 
```

并插入这个委托函数：

```
- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField{
return NO;
} 
```

就是这样！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-09-02T06:51:43.637

在 UIView 上创建类别。

在该类别中添加以下方法。

```
-(void)disable {
    self.alpha = 0.5;
    self.userInteractionEnabled = FALSE;
}

-(void)enable {
    self.alpha = 1.0;
    self.userInteractionEnabled = TRUE;
} 
```

然后打电话

```
yourTextField.disable(); 
```

实际上，您可以在任何您想要的视图上使用它。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-05-18T12:40:18.337

您应该遵守`UITextFieldDelegate`并返回`false`此方法。这样文本字段仍然可以选择，但不可编辑和剪切

代码在 Swift 4 中

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
  return false
} 
```

# python - PyS60：蓝牙插座

> ID：599737
> 
> 赞同：0
> 
> 时间：2009-03-01T12:22:41.833
> 
> 标签：python, bluetooth, nokia, pys60

从网站[http://www.mobilepythonbook.org/](http://www.mobilepythonbook.org/)我找到了以下蓝牙套接字示例：[BT 聊天示例](http://www.mobilenin.com/mobilepythonbook/examples/057-btchat.html)

在函数 chat_server() 中，bind 方法接受一个包含两个元素的元组。第一个已用作空字符串。它意味着什么？

哪个节点将充当蓝牙中的主节点，启动 chat_client 的节点还是启动 chat_server 的节点？我觉得应该是运行chat_client的节点。因此蓝牙从站将是其他节点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T23:24:33.953

对于 IPv4 地址，接受两种特殊形式而不是主机地址：空字符串表示 INADDR_ANY，字符串 '' 表示 INADDR_BROADCAST -- [http://docs.python.org/library/socket.html](http://docs.python.org/library/socket.html)

在那里你会找到足够多的信息。基本上什么 INADDR_ANY 意味着它将绑定到主机拥有的任何地址。

服务器是蓝牙主设备，客户端是从设备，这是因为主设备**必须**先存在，然后才能生成客户端。作为可发现设备，服务器是决定如何配置通道的设备。

我希望这可以澄清事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T11:39:32.737

我找到了答案，开始监听传入连接的设备是从设备，而发现并请求连接的设备是主设备。

抱歉，米歇尔彼得森您的回答完全错误。

# c++ - 关于函数定义的问题（参数中的三个点..）

> ID：599744
> 
> 赞同：63
> 
> 时间：2009-03-01T12:34:03.430
> 
> 标签：c++, c

我遇到了一个函数定义：

```
char* abc(char *f, ...)
{
} 
```

三个点是什么意思？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-03-01T12:37:57.367

这些类型的函数称为***可变参数函数***（[维基百科链接](https://en.wikipedia.org/wiki/Variadic_function)）。他们使用省略号（即三个点）来表示函数可以处理的参数数量不定。您可能使用过此类功能的一个地方（可能没有意识到）是各种`printf`功能，例如（来自 ISO 标准）：

```
int printf(const char * restrict format, ...); 
```

省略号允许您创建事先不知道参数数量的函数，并且您可以使用`stdargs.h`函数（`va_start`和`va_arg`）`va_end`来获取特定参数。

你必须知道你提取的参数的*类型*，并且有一些方法来决定你什么时候完成。这些`printf`函数使用格式字符串（对于类型和计数）执行此操作，而我下面的示例代码始终假定`const char *`为具有标记值的类型`NULL`来决定完成。

[这里](http://www.eskimo.com/%7Escs/cclass/int/sx11b.html)的这个链接有一篇关于在`printf`.

* * *

例如，以下程序包含一个函数`outStrings()`，它允许您打印任意数量的字符串：

```
#include <stdio.h>
#include <stdarg.h>

void outStrings(const char *strFirst, ...) {
    // First argument handled specially.

    printf("%s", strFirst);
    va_list pArg;
    va_start(pArg, strFirst);

    // Just get and process each string until NULL given.

    const char *strNext = va_arg(pArg, const char *);
    while (strNext != NULL) {
        printf("%s", strNext);
        strNext = va_arg(pArg, const char *);
    }

    // Finalise processing.

    va_end(pArg);
}

int main(void) {
    char *name = "paxdiablo";
    outStrings("Hello, ", name, ", I hope you're feeling well today.\n", NULL);
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-01T12:38:18.223

[关于C++](http://en.wikipedia.org/wiki/Varargs#Variadic_functions_in_C.2C_Objective-C.2C_C.2B.2B.2C_and_D)中可变参数函数的维基百科。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-01T12:37:54.327

它们被称为省略号，它们意味着该函数可以采用不确定数量的参数。您的函数可能可以这样调用：

```
abc( "foo", 0 );
abc( "foo", "bar", 0 ); 
```

需要有一种方法来指示列表的结尾。这可以通过使用第一个参数来完成，作为 ion 一个 printf(0 格式字符串，或者通过一个特殊的终止符，在上面的示例中为零。

具有可变数量参数的函数在 C++ 中被认为是错误的形式，因为不能对参数执行类型检查或用户定义的转换。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-01T12:38:16.727

这就是 C 中所谓的可变参数函数或可变参数函数。

您可能会认出一个是 printf。

# javascript - 使用 javascript 按名称获取参考文档元素

> ID：599754
> 
> 赞同：0
> 
> 时间：2009-03-01T12:41:20.197
> 
> 标签：javascript

我假设每天都在做 JS 的人的一个基本问题。我正在帮助一个不使用最近的糖果（JQuery、prototype 和 co.）的朋友。

我应该如何通过名称获得对文档元素的引用？

我想允许选择用户在`<SELECT />`元素中修改元素的值`<INPUT />`。

这两个元素都没有定义 ID 字段，只有名称。

这显然应该是可移植的（Mozilla、IE、Opera）。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T12:45:00.423

您可以使用[getElementsByName](http://www.w3schools.com/htmldom/met_doc_getelementsbyname.asp)函数，该函数将返回具有给定名称的所有元素的数组：

```
var elements = document.getElementsByName('some_name'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T12:48:28.107

如果`<input>`和`<select>`是同一`<form>`元素的成员，则可以直接引用字段，它们是表单对象的成员：

```
<form>
  <select name="bar" onchange="this.form.foo.value = this.value;">
    <option value="1">Option 1</option>
    <option value="2">Option 2</option>
    <option value="3">Option 3</option>
  </select>
  <input type="text" name="foo">
</form> 
```

当然，您可以将其包装在一个函数中。

# asp.net-mvc - 与 ASP.NET MVC 中的 HttpContext.Current 等效的控制器

> ID：599759
> 
> 赞同：3
> 
> 时间：2009-03-01T12:45:09.410
> 
> 标签：asp.net-mvc, controller, controllercontext

我想访问当前正在执行的控制器，这样我就可以将适当的 ActionResult 的返回卸载到辅助方法上。为此，我正在寻找与我认为是 ControllerContext.Current 的等价物，但不是。谢谢！

**编辑澄清：**我有一个基于 JavaScript 的通用表单控件，但我想添加一个选项，以便它与 noscript 一起使用。目前，我的控制器将 ViewData.Model 设置为 JSON 化的 Models.FormResponse<T>。

这个 FormReponse 设置了帖子的状态和生成的任何错误消息，所以我想要一个 GetActionResult() 方法来执行脚本/noscript 检查（隐藏的表单输入），或者：

1.  将模型设置为 JSONed FormResponse 并返回一个 View()，或者
2.  将 FormResponse 序列化到 Session 并返回 Redirect()。

由于这显然会更改返回值并且我不想每次都自己进行检查，因此我需要从 FormResponse 的 GetActionResult 方法调用 View 或 Redirect 以便将其调用为：

```
return formResponse.GetActionResult(); 
```

我知道，如果采用更符合航天风格的设计，这可能会变得更加健壮，但由于 noscript 选项目前不是主要功能，我只需要获得一个不会破坏其他东西的快速解决方案。

**更新#2**

以下在 ActionResult 类中实现，为我完成了这项工作。感谢 CVertex！

```
public override void ExecuteResult(ControllerContext context)
    {
        if (CMSEnvironment.NoScript)
        {
            Oracle.Response.Redirect(Oracle.Request.UrlReferrer.ToString(), true);
        }

        context.Controller.ViewData.Model = _model.ToJSON();

        new ViewResult()
        {
            ViewName = Areas.Site.Helpers.SharedView.Service,
            ViewData = context.Controller.ViewData
        }.ExecuteResult(context);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-01T12:50:06.947

静态不利于可测试性，并且在 MVC 中非常不鼓励使用。

为什么要访问当前的控制器和操作方法？

最好的方法是[实现你自己的 ActionFilter](http://haacked.com/archive/2008/08/14/aspnetmvc-filters.aspx)。这为您提供了一种在操作方法执行之前或之后拦截请求的方法。

编辑：通过在过滤器的 OnActionExecuted 中截取结果，您可以进行 noscript/script 检查并相应地修改 ViewData 以供 View 使用。在 OnActionExecuted 中，您还可以执行 noscript 检查并根据需要完全控制最终的 ActionResult 或 ViewData。

或者，您可以编写自己的 ActionResult 来做出所有这些决定。所以，你的控制器动作最终会

```
return new MyActionResult(format_and_view_agnostic_model_object); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T13:09:07.697

似乎没有办法从线程导航到当前控制器。也就是说，您可以获取 ControllerBuilder 并且可以获取 MvcHttpHandler 但两者都不允许您访问处理程序正在使用的控制器实例。

# debugging - 在反汇编中查找函数

> ID：599762
> 
> 赞同：4
> 
> 时间：2009-03-01T12:48:27.780
> 
> 标签：debugging, assembly, reverse-engineering, portable-executable

我正忙于学习一个教程，作者使用 DUMPBIN 列出导出，并使用 OllyDbg 获取导出函数的汇编代码。鉴于导出表 RVA 与反汇编中的实际地址不对应，我将如何在完整的反汇编中找到函数代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-01T13:06:31.073

函数的一个很好的指标，至少对于用高级语言编写的程序来说是设置堆栈帧的代码。

如果您知道用于生成相关代码的编译器，您应该能够找出要查找的内容。

例子

```
$ cat main.c
int main(int argc, char **argv) {
        return 1;
}
$ gcc -m32 -S main.c
$ cat main.s 
        .file     "main.c"
        .text
.globl main
        .type    main, @function
main:
        leal     4(%esp), %ecx
        andl     $-16, %esp
        pushl    -4(%ecx)
        pushl    %ebp
        movl     %esp, %ebp
        pushl    %ecx
        movl     $1, %eax
        popl     %ecx
        popl     %ebp
        leal     -4(%ecx), %esp
        ret
        .size    main, .-main
        .ident   "GCC: (Debian 4.3.3-4) 4.3.3"
        .section    .note.GNU-stack,"",@progbits 
```

在我的示例中，**movl %esp, %ebp**指令是该设置代码的最后一条指令。

[可免费下载啤酒版本](http://www.hex-rays.com/idapro/idadownfreeware.htm)的商业反汇编程序 IDA Pro在自动查找功能方面做得很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T06:49:57.047

RVA 是可重定位的虚拟地址。要在进程空间中找到真正的地址，您需要知道在进程中加载​​模块的基地址。将该基地址添加到 RVA，您就有了真实地址。我没有使用过 ollydbg，但如果它没有为它所连接的进程中加载​​的模块提供基地址，我会感到震惊。如果由于某种原因它不提供该信息，您可以使用 sysinternal 工具中的 procexp.exe 来获取它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-28T04:38:17.293

如果使用[radare2](https://radare.org)，您可以使用`-AA`flag 以二进制形式（也许）分析函数，然后使用`afl`命令列出所有函数。例如 ：

```
% r2 -AA hello
[Cannot analyze at 0x00400420g with sym. and entry0 (aa)
[x] Analyze all flags starting with sym. and entry0 (aa)
[Cannot analyze at 0x00400420ac)
[x] Analyze function calls (aac)
[x] Analyze len bytes of instructions for references (aar)
[x] Check for objc references
[x] Check for vtables
[x] Type matching analysis for all functions (aaft)
[x] Propagate noreturn information
[x] Use -AA or aaaa to perform additional experimental analysis.
[x] Finding function preludes
[x] Enable constraint types analysis for variables
-- Greetings, human.
[0x00400430]> afl
0x00400430    1 41           entry0
0x00400410    1 6            sym.imp.__libc_start_main
0x00400460    4 50   -> 41   sym.deregister_tm_clones
0x004004a0    4 58   -> 55   sym.register_tm_clones
0x004004e0    3 28           entry.fini0
0x00400500    4 38   -> 35   entry.init0
0x004005b0    1 2            sym.__libc_csu_fini
0x004005b4    1 9            sym._fini
0x00400540    4 101          sym.__libc_csu_init
0x00400526    1 21           main
0x00400400    1 6            sym.imp.puts
0x004003c8    3 26           sym._init
[0x00400430]> 
```

[用于radare2](https://radare.org) [Cutter](https://cutter.re)的Windows版本`->`

# c++ - 如何查找给定 CLSID 支持的对象

> ID：599769
> 
> 赞同：1
> 
> 时间：2009-03-01T12:53:33.523
> 
> 标签：c++, windows, visual-studio-2008, com, clsidfromprogid

**问题：**

*   基于[**CLSID**](http://msdn.microsoft.com/en-us/library/ms691424.aspx)，我如何找出它**支持**的**对象**（或接口）**`IClassFactory::CreateInstance`**

 ****笔记：**

*   目前**使用** [**CLSIDFromProgID**](http://msdn.microsoft.com/en-us/library/ms688386(VS.85).aspx)获取 CLSID

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-01T16:57:03.157

您可以使用 OleView。

但是，如果您想以编程方式执行此操作，则可以使用 OleView 使用的方法。

OleView 通过遍历 HKEY_CLASSES_ROOT\Interface 中声明的所有接口然后为每个接口调用 QueryInterface 来实现这一点。

# c - C中的跨平台单元测试

> ID：599773
> 
> 赞同：4
> 
> 时间：2009-03-01T12:56:14.093
> 
> 标签：c, unit-testing, cross-platform

我正在开始一个新项目，并决定我应该尝试这个每个人都在谈论的单元测试。

该项目是一组 C 库（因此不需要 UI 或用户交互测试），旨在成为跨平台，Linux、FreeBSD 和 Windows 是我的首要任务，OS X 计划在第一个版本发布后（假设我可以拿到一台运行 OS X 的机器进行测试）。

是否有人对可以轻松跨多个平台工作的良好 C 单元测试框架有任何经验或建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T13:01:06.343

回到我写 C 代码的时候，我所有的单元测试都是临时的，不涉及框架，所以我不能推荐任何这些，但你可能想看看[http 上的 C/C++ 单元测试工具列表： //www.opensourcetesting.org/unit_c.php](http://www.opensourcetesting.org/unit_c.php)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T13:03:37.057

我曾经使用我喜欢的[CUnit 。](http://cunit.sourceforge.net/)谷歌也开源了他们的[C++ 单元测试框架](http://code.google.com/p/googletest/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-01T13:12:42.417

我从[minunit](http://www.jera.com/techinfo/jtns/jtn002.html)开始，然后对其进行了改进以满足我的要求。我没有从测试框架中获得对测试套件的支持，而是使用 make 来构建和运行不同的可执行文件，每个可执行文件都包含十几个相关的测试。所以现在我有大约 250 行宏，主要用于打印不同的类型或进行字符串或内存比较，现在就足够了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-01T13:09:43.593

我已经非常喜欢[点击](http://ccan.ozlabs.org/list.html)（在底部附近向下滚动），因为它很容易就位。它代表“测试任何协议”。如果使用过去 5 年发布的编译器，我认为您不会遇到很多可移植性问题，但我只使用 gcc / glibc 尝试过。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T01:51:51.547

我将自己的单元测试框架[CUnitWin32](http://code.google.com/p/cunitwin32/)用于嵌入式 C 内容。我的主机开发环境是 Win32，所以在线可用的框架仅适用于 Windows。但是，我也确实将它移植到了 Linux，所以如果该框架适合您，请在此处给我留言，我们将找到一种方法来获取您的 Linux 版本。

D

# parsing - 什么时候可以使用模棱两可的语法或产生式规则？（野牛移位/减少警告）

> ID：599774
> 
> 赞同：2
> 
> 时间：2009-03-01T12:56:51.893
> 
> 标签：parsing, bison, shift-reduce-conflict

当然有很多关于解决移位/减少错误的文档和方法。野牛文档建议正确的解决方案通常只是 %expect 他们并处理它。

当你有这样的事情：

```
S: S 'b' S | 't' 
```

您可以像这样轻松解决它们：

```
S: S 'b' T | T
T: 't' 
```

我的问题是：最好是让语法有点模棱两可并期望转移/减少问题，还是尝试调整语法以避免它们更好？我怀疑有一个平衡，它是基于作者的需要，但我真的不知道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T13:06:04.990

您可以使用运算符优先级指导冲突解决。声明`'b'`为左或右关联运算符，您至少已经涵盖了这种情况。

对于更复杂的模式，只要最终解析器在所有情况下都能产生正确的结果，警告就不用担心了。虽然如果你不能让它使用声明给出正确的结果，你将不得不重写语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T01:15:30.073

当我读到它时，您的问题是“什么时候可以使用模棱两可的语法或生产规则？”

首先考虑您所描述的语言。允许在语言中使用模棱两可的生产规则意味着什么。

您的示例描述了一种可能包含如下表达式的语言：`t b t b t b t`

如您的第二个示例中那样解析的表达式将是`(((( t ) b t) b t ) b t )`，但在一个模棱两可的语法中，它也可能成为`( t b ( t b ( t b ( t))))`or 甚至`( t b t ) b ( t b t )`。哪个可能有效可能取决于语言。如果`b`算子模拟减法，确实不应该模棱两可，但如果是加法，它可能没问题。这真的取决于语言。

The second question to consider is what the resulting grammar source file ends up looking like, after the conflicts are resolved. As with other source code, a grammar is meant to be read by humans, and secondarily also by computers. Prefer a notation that gives a clearer explanation of what the parser is trying to do from the grammar. That is, if the parser is executing some possibly undefined behavior, for example, order of evaluation of a function's arguments in an eager language, make the grammar *look* ambiguous.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T06:57:12.570

在我上学期的编译器课程中，我们使用了 bison，并为 pascal 的一个子集构建了一个编译器。

如果语言足够复杂，就会出现一些错误。只要您了解它们为何存在，以及您必须如何移除它们，我们就觉得没问题。如果有什么东西在那里，但由于行为会按照我们的意愿工作，并且需要大量的思考和工作才能让它变得有价值（并且也会使语法复杂化），我们就不理会它了。只需确保您完全理解错误，并将其记录在某个地方（甚至为您自己），以便您始终知道它发生了什么。

一旦事情真正涉及，这是一个成本/收益分析，但恕我直言，修复它应该被认为是第一个，然后实际弄清楚工作将是什么（如果这项工作破坏了其他事情，或者使其他事情变得更难），然后从那里。永远不要把它们当作家常便饭。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T00:52:51.003

当我需要证明语法是明确的时，我倾向于先将其编写为[Parsing Expression Grammar](http://en.wikipedia.org/wiki/Parsing_expression_grammar)，然后手动将其转换为我用于项目所需的工具集的任何语法类型。以我的经验，这种级别的证明需要非常罕见，因为我遇到的大多数移位/减少冲突都是相当微不足道的，以显示（按照你的例子的顺序）的正确性。

# editor - 您如何处理无法使用首选文本编辑器的情况？

> ID：599776
> 
> 赞同：3
> 
> 时间：2009-03-01T12:59:38.547
> 
> 标签：editor, text-editor

我最初打算围绕 TextMate 提出这个问题，众所周知，它是一个了不起的编辑器，但仅在 OSX 上可用。我很好奇那些花时间学习使用 TextMate 的人如何有效地处理他们必须在非 OSX 平台上进行编辑的情况。但这确实是一个更普遍的问题。人们如何处理您无法使用首选文本编辑器的情况？

我主要使用 gvim 和 vim，而且我知道这些编辑器有一组相当深奥的键绑定，所以当我在另一个编辑器中编辑时，我经常会错误地输入我不想在尝试导航时输入的内容。这可能非常低效。

那么人们如何应对这些情况呢？只是吞下低效率？尝试避免这种情况或竭尽全力将需要编辑的文件放入您喜欢的编辑器中？您是否有一两个您精通的编辑器可以毫无问题地在它们之间切换？您是否更改了其他编辑器的键绑定以更接近您的首选编辑器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T13:09:54.297

The advantage of using either vim or emacs as an editor is precisely that it's available on virtually any decently configured Unix platform (and this includes more esoteric systems as well, e.g. Darwin/OS X). Combined with the fact that you can store your configuration online (e.g. [Dotfiles](http://www.dotfiles.com/)) this makes for a very strong argument, because the problem you described simply doesn't exist.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T13:23:20.083

I work as a support technician, which means I'm frequently working on customer systems remotely. The unfortunate side effect is that I rarely have any choice over what editor I get to use in those situations. Generally speaking there's not a whole lot you can do about it unless the situation is one where it's feasible for you to install a new editor or bring a USB thumb drive or something similar with your editor pre-installed on it. In such a situation, by all means, if you plan to be working for an extended time period, take advantage of the opportunity. You'll work faster and more efficiently and it will be less frustrating.

In an environment (e.g. webex/RDC) where you cannot install software or use temporary media, you have two choices: live with whatever editor they have, or copy files back and forth from your system. Typically if I'm doing very minor editing I just suck it up and use whatever editor is available. If I know I'm going to be doing an extensive amount of editing, I find a way to transfer the file I'm working on back and forth. This still stinks, forcing you to interrupt your editing flow with file transfers, but I find my sanity makes it worth not struggling with something like notepad to do real editing or programming.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-01T13:28:50.473

Since I work primarily in a windows environment, I keep [Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm) installed on a flash drive. That way I can just pop the usb drive into a machine and have a quality editor, without having to install anything.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-01T13:06:46.800

在我使用较长时间的机器上，我使用 SciTE。我也使用德沃夏克键盘。当在机器上来宾时，一切都不同了，因为钥匙在不合逻辑的地方。我只是用那里的东西进行编辑，或者将文件传递给源代码管理并在我的机器上进行编辑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-01T13:09:20.927

我求助于在客户站点的 win 机器上使用记事本。特别是因为我知道安装任何东西都不是一种选择，而且我*知道*记事本将永远存在。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-01T13:09:57.337

For me the only time this happens is when I'm using someone else's system since I typically install a text editor that I am reasonably familiar with on each system that I own/use regularly. In that case, if I'm struggling too much, I move over and let the other person take the wheel (keyboard). FWIW, I use TextMate (sometimes vim) on OSX, TextPad (sometimes Notepad or even Edit on servers not under my direct control) on Windows, and vim on Linux.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-01T13:02:55.683

我对几个不同的编辑器感到满意——vi、eclipse 和 PFE。如果我短期使用其他编辑器，我会处理它。如果是长期的话，谷歌是我的朋友，我会去下载一个我喜欢的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-01T13:03:23.577

在 Windows 上，我说服大家安装**notepad++**

在 mac **TextMate**规则

在 linux **vim上**

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-01T13:04:04.730

我在 linux 下使用 vi，在 Windows 下使用 Ultraedit。如果您正在执行一些 linux 管理或直接在 shell 中工作，Vi 是必须的。

如果您在窗口系统下工作，则面向鼠标的编辑器很有用。

无论如何，我认为您需要了解两者的基础知识。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-01T13:09:47.650

I work regularly on Linux and Windows, and occasionally on OS X. Having to switch editors between them is a pain, so the obvious solution would be using some cross-platform editor. Right now I'm experimenting with Komodo Edit, which looks pretty promising.

If there's no decent editor in the machine, it doesn't take long to download and install one.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-18T00:54:07.717

If you are programming under windows you might want to take a look at [e text editor](http://www.e-texteditor.com/) its basically TextMate for windows and supports the bundles and everything.

# html - css背景颜色随doctype消失

> ID：599777
> 
> 赞同：1
> 
> 时间：2009-03-01T13:00:49.497
> 
> 标签：html, css, doctype, strict

我正在尝试在 html 页面中的几个不同元素上设置背景颜色，但是每当我应用 doctype 声明时，颜色都会被忽略。其他风格似乎不受影响。我确定我是个白痴。

它发生在 IE7、FF3 和 Chrome 上。使用严格和过渡的 html 4 Doctype。Body 和 Div 背景会受到影响。下面是一个最小的示例。如果您删除 Doctype 声明，它会呈现出它所有的花哨荣耀，只有 doctype - 单调乏味的黑白。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <style>
        body{background-color:FF00FF;}
        .class1{background-color:00FFFF;}
    </style>
</head>
<body>
    <div class="class1">Some Text</div>
</body>
</html> 
```

顺便说一句 - 我没有使用 XHTML，因为我想我曾经在酒吧里听到比我聪明得多的人之间的对话，他们说你不应该声明 XML，除非你的服务器上正确设置了 mime 类型。在我的便宜主机帐户上，我不能轻易地做那种事情。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-01T13:04:26.477

您忘记了`#`颜色值。

```
body {
    background-color: #FF00FF;
}
.class1 {
    background-color: #00FFFF;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-01T13:06:10.793

忽略颜色的原因是声明不正确。在 quirks 模式下，解释更加宽松，即使颜色不正确，也可以接受，但在标准兼容模式下，声明必须正确。

将 FF00FF 更改为 #FF00FF，将 00FFFF 更改为 #00FFFF。

#FF00FF 也可以写成#F0F 的缩写，#00FFFF 写成#0FF。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T13:06:14.287

在 CSS 中，您可以在 RGB 或 Hex 中定义颜色。这就是你所做的。但是 Hex-Colors 写成`#rrggbb`. 你错过了**#**。似乎在进行验证时，因为设置了文档类型，因此无法正确解释这种“几乎正确”的颜色定义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-11T05:30:21.013

删除以下行

DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 过渡//EN" " [http://www.w3.org](http://www.w3.org)

然后就好了，但我不知道为什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-01T14:03:02.997

你应该使用 <style type="text/css"> 或者更好，不要使用内联样式！

[始终在此处](http://validator.w3.org/)验证您的 html 代码。

# php - CakePHP 大师：控制台 cake 命令未正确找到 -app 路径？

> ID：599799
> 
> 赞同：3
> 
> 时间：2009-03-01T13:10:20.130
> 
> 标签：php, cakephp, console, cakephp-1.2

我已经在这个文件夹中安装了 CakePHP 核心文件：

/home/iopener/webapps/cake_1.2.1.8004

我在这里安装了我的应用程序：

/home/iopener/webapps/myapp.com/app

cake 控制台命令在我的路径中，并且运行良好，但它似乎忽略了任何将其指向正确的 -app 文件夹的尝试。如果我从应用程序文件夹中运行“蛋糕”，我会收到以下错误：

```
欢迎使用 CakePHP v1.2.1.8004 控制台
-------------------------------------------------- -------------
当前路径：
 -应用程序：应用程序
 -工作：/home/ioopener/webapps/myapp.com/app
 -root：/home/iopener/webapps/myapp.com
 -核心：/home/ioopener/webapps/cake_1.2.1.8004

改变路径：
您的工作路径应与您的应用程序路径相同
要更改路径，请使用“-app”参数。
示例：-app relative/path/to/myapp 或 -app /absolute/path/to/myapp

```

请注意，工作路径和应用程序路径是相同的，但 -app 选项只是缺少绝对路径。所以我尝试了这个命令：

```
蛋糕-app /home/iopener/webapps/myapp.com/app

```

并得到与以前完全相同的错误消息。我尝试从根文件夹（应用程序的上一级）运行 cake，我尝试使用相对路径，但似乎没有任何效果。

我在谷歌上花了大约 2 个小时试图找到有类似问题的人，但没有任何乐趣。

我已经在其他机器上安装了 CakePHP 并且没有问题地让它工作，但我不记得它是否使用集中式核心文件夹（就像我现在一样）。

有任何想法吗？TIA,

-乔什

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-01T14:13:01.507

我不应该这么晚/这么早编程。

运行“蛋糕”是一种诊断，但如果你只是运行

```
蛋糕烤

```

从应用程序文件夹中，它工作正常。

我该睡觉了。感谢任何耐心的眼球。

-乔什

# c# - 我是否需要安装 MS Word 才能从 asp.net 创建 Word 文档？

> ID：599807
> 
> 赞同：3
> 
> 时间：2009-03-01T13:19:01.480
> 
> 标签：c#, asp.net

见标题...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-01T13:27:04.723

不。

您可以使用[WordML](http://msdn.microsoft.com/en-us/library/aa212812.aspx)（Word XML）

[字2007版](http://msdn.microsoft.com/en-us/library/bb266220.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T13:28:25.890

您可以使用其 XML 格式创建 Word 2007 文档，而无需在服务器中安装 Word。

[这](http://www.codeproject.com/KB/office/DocumentMaker.aspx)可以作为一个起点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-01T13:35:52.487

我已经 +1 了[Mitch 的回复](https://stackoverflow.com/questions/599807/do-i-need-to-have-ms-word-installed-for-creating-word-documents-from-asp-net/599816#599816)，但顺便说一句：Word[甚至不*支持*在服务应用程序中使用](http://support.microsoft.com/kb/257757)；它被设计为用户交互的。因此，即使安装 Word，它也不会让你处于一个好地方。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-01T14:07:26.420

如果您只是从头开始生成文档，那么到目前为止提出的解决方案效果很好。我的情况是我有一个现有的模板，我需要在几个地方使用和替换我自己的文本（如果你愿意的话，邮件合并）。这是几年前的事了——在 Office 2007 之前——但我们最终为此使用了[Aspose](http://www.aspose.com/)组件库。我使用 Words and Cells (Excel) 组件从模板和电子表格中动态生成文档，以便从网站下载。界面有点笨拙，并且在各种产品之间可能不一致。坦率地说，安装程序很糟糕，但产品运行良好，并且可以更轻松地完成需要完成的工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-01T13:54:35.250

Word 将 rtf 识别为内在文件，并且如果您的预期文档可以构建为whatever.rtf（其所有花哨的格式都是纯 ASCII 标记），那么您可以在没有安装 Word 的情况下编写文档。

要获取图片，请创建一个示例文档并将其保存为 rtf 文件。然后使用 ascii 文本编辑器（如记事本）查看该文件。您必须学习 rtf 语法，但至少有一本关于这方面的手册。

作为

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-02T15:06:39.567

只是为您添加另一个潜在的解决方案，OfficeWriter 是一个 Word/Excel API，它允许您在 ASP.NET 中创建文档和电子表格，而无需使用 Office：

[http://www.officewriter.com](http://www.officewriter.com)

# php - 结合递归迭代器结果：children with parents

> ID：599809
> 
> 赞同：5
> 
> 时间：2009-03-01T13:19:30.667
> 
> 标签：php, recursion, iterator, code-reuse

我正在尝试遍历包含大量 PHP 文件的目录，并检测每个文件中定义了哪些类。

考虑以下：

```
$php_files_and_content = new PhpFileAndContentIterator($dir);
foreach($php_files_and_content as $filepath => $sourceCode) {
    // echo $filepath, $sourceCode
} 
```

上面的`$php_files_and_content`变量表示一个迭代器，其中键是文件路径，内容是文件的源代码（好像这在示例中并不明显）。

然后将其提供给另一个迭代器，它将匹配源代码中所有定义的类，ala：

```
class DefinedClassDetector extends FilterIterator implements RecursiveIterator {
    public function accept() {
        return $this->hasChildren();
    }

    public function hasChildren() {
        $classes = getDefinedClasses($this->current());
        return !empty($classes);
    }

    public function getChildren() {
        return new RecursiveArrayIterator(getDefinedClasses($this->current()));
    }
}

$defined_classes = new RecursiveIteratorIterator(new DefinedClassDetector($php_files_and_content));

foreach($defined_classes as $index => $class) {
    // print "$index => $class"; outputs:
    // 0 => Class A
    // 1 => Class B
    // 0 => Class C
} 
```

不是按数字顺序排列的原因`$index`是因为在第二个源代码文件中定义了“C 类”，因此返回的数组再次从索引 0 开始。这保留在 RecursiveIteratorIterator 中，因为每组结果代表一个单独的 Iterator（因此是键/值对）。

无论如何，我现在要做的是找到组合这些的最佳方法，这样当我迭代新的迭代器时，我可以获得键是类名（来自`$defined_classes`迭代器），值是原始文件路径，阿拉：

```
foreach($classes_and_paths as $filepath => $class) {
    // print "$class => $filepath"; outputs
    // Class A => file1.php
    // Class B => file1.php
    // Class C => file2.php
} 
```

这就是我到目前为止所困的地方。

目前，唯一想到的解决方案是创建一个新的 RecursiveIterator，它覆盖 current() 方法以返回外部迭代器 key() （这将是原始文件路径），并返回 key() 方法当前的迭代器（）值。但我不赞成这种解决方案，因为：

*   听起来很复杂（这意味着代码看起来很可怕，而且不直观
*   业务规则在类中是硬编码的，而我想定义一些通用的迭代器，并能够以这样的方式组合它们以产生所需的结果。

任何想法或建议都非常感激。

我也意识到有更快，更有效的方法来做到这一点，但这也是我自己使用迭代器的练习，也是促进代码重用的练习，因此必须编写的任何新迭代器都应该尽可能少并尝试利用现有功能。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-08T09:26:10.170

好的，我想我终于明白了这一点。这大致是我在伪代码中所做的：

**步骤 1** 我们需要列出目录内容，因此我们可以执行以下操作：

```
// Reads through the $dir directory
// traversing children, and returns all contents
$dirIterator = new RecursiveDirectoryIterator($dir);

// Flattens the recursive iterator into a single
// dimension, so it doesn't need recursive loops
$dirContents = new RecursiveIteratorIterator($dirIterator); 
```

**第 2 步** 我们只需要考虑 PHP 文件

```
class PhpFileIteratorFilter {
    public function accept() {
        $current = $this->current();
        return    $current instanceof SplFileInfo
               && $current->isFile()
               && end(explode('.', $current->getBasename())) == 'php';
    }
}

// Extends FilterIterator, and accepts only .php files
$php_files = new PhpFileIteratorFilter($dirContents); 
```

*PhpFileIteratorFilter 不能很好地使用可重用代码。更好的方法是能够提供文件扩展名作为构造的一部分，并让过滤器与之匹配。尽管如此，我还是试图摆脱不需要它们的构造参数，而更多地依赖组合，因为这样可以更好地利用策略模式。PhpFileIteratorFilter 可以简单地使用通用 FileExtensionIteratorFilter 并在内部进行设置。*

**第 3 步** 我们现在必须读入文件内容

```
class SplFileInfoReader extends FilterIterator {

    public function accept() {
        // make sure we use parent, this one returns the contents
        $current = parent::current();
        return    $current instanceof SplFileInfo
               && $current->isFile()
               && $current->isReadable();
    }

    public function key() {
        return parent::current()->getRealpath();
    }

    public function current() {
        return file_get_contents($this->key());
    }    
}

// Reads the file contents of the .php files
// the key is the file path, the value is the file contents
$files_and_content = new SplFileInfoReader($php_files); 
```

**第 4 步** 现在我们要将回调应用到每个项目（文件内容）并以某种方式保留结果。再次，尝试利用策略模式，我已经消除了不必要的构造函数参数，例如`$preserveKeys`或类似的

```
/**
 * Applies $callback to each element, and only accepts values that have children
 */
class ArrayCallbackFilterIterator extends FilterIterator implements RecursiveIterator {

    public function __construct(Iterator $it, $callback) {
        if (!is_callable($callback)) {
            throw new InvalidArgumentException('$callback is not callable');
        }

        $this->callback = $callback;
        parent::__construct($it);
    }

    public function accept() {
        return $this->hasChildren();
    }

    public function hasChildren() {
        $this->results = call_user_func($this->callback, $this->current());
        return is_array($this->results) && !empty($this->results);
    }

    public function getChildren() {
        return new RecursiveArrayIterator($this->results);
    }
}

/**
 * Overrides ArrayCallbackFilterIterator to allow a fixed $key to be returned
 */
class FixedKeyArrayCallbackFilterIterator extends ArrayCallbackFilterIterator {
    public function getChildren() {
        return new RecursiveFixedKeyArrayIterator($this->key(), $this->results);
    }
}

/**
 * Extends RecursiveArrayIterator to allow a fixed $key to be set
 */
class RecursiveFixedKeyArrayIterator extends RecursiveArrayIterator {

    public function __construct($key, $array) {
        $this->key = $key;
        parent::__construct($array);
    }

    public function key() {
        return $this->key;
    }
} 
```

所以，这里我有我的基本迭代器，它将返回`$callback`我提供的结果，但我还扩展了它以创建一个也将保留键的版本，而不是为其使用构造函数参数。

因此我们有这个：

```
// Returns a RecursiveIterator
// key: file path
// value: class name
$class_filter = new FixedKeyArrayCallbackFilterIterator($files_and_content, 'getDefinedClasses'); 
```

**第5步** 现在我们需要将其格式化为合适的方式。我希望文件路径是值，键是类名（即为一个类提供一个直接映射到自动加载器可以在其中找到它的文件）

```
// Reduce the multi-dimensional iterator into a single dimension
$files_and_classes = new RecursiveIteratorIterator($class_filter);

// Flip it around, so the class names are keys
$classes_and_files = new FlipIterator($files_and_classes); 
```

瞧，我现在可以遍历`$classes_and_files`并获取 $dir 下所有已定义类的列表，以及它们在其中定义的文件。几乎所有用于执行此操作的代码也可以在其他上下文中重用. 我没有在定义的迭代器中硬编码任何东西来完成这个任务，我也没有在迭代器之外做任何额外的处理

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T08:06:29.763

我认为您想要做的或多或少是反转从`PhpFileAndContent`. 所说的类返回一个列表`filepath => source`，你想首先反转映射`source => filepath`，然后`source`为每个定义的类展开`source`，所以它会是`class1 => filepath, class2 => filepath`。

它应该很容易，因为`getChildren()`您可以简单地访问`$this->key()`以获取您正在运行的源的当前文件路径`getDefinedClasses()`。您可以编写`getDefinedClasses`为`getDefinedClasses($path, $source)`而不是返回所有类的索引数组，它将返回一个字典，其中当前索引数组中的每个值都是字典中的键，值是定义该类的文件路径。

然后它会如你所愿地出现。

另一种选择是放弃使用，`RecursiveArrayIterator`而是编写自己的迭代器，该迭代器被初始化（in `getChildren`）为

```
return new FilePathMapperIterator($this->key,getDefinedClasses($this->current())); 
```

然后`FilePathMapperIterator`将类数组从转换为我描述`getDefinedClasses`的`class => filepath`映射，方法是简单地遍历数组并返回当前类`key()`并始终返回指定的文件路径`current()`。

`getDefinedClasses()`我认为后者更酷，但肯定有更多的代码，所以如果我能适应我的需求，我不太可能这样做。

# xml - 使用 Schema.xml 推进

> ID：599817
> 
> 赞同：0
> 
> 时间：2009-03-01T13:27:44.377
> 
> 标签：xml, yaml, propel, mysql-workbench

是否可以使用 Schema.xml 而不是[Schema.yml](http://www.symfony-project.org/book/1_2/05-Configuring-Symfony)在 Propel 中生成模型？

曾几何时，在 Propel 中使用 xml 生成数据库，但它已被 yml 所取代。如果我手动编码我的数据库模式，我应该选择 yml，但现在因为我使用[插件](http://www.diloc.de/blog/2008/08/05/mysql-workbench-propel-export-plugin-v04/)直接从 MySQL 工作台导出我的数据库模式，结果是 xml 格式，我别无选择，只能使用 xml。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T15:10:58.807

我根本没有使用 yml 文件，因为我不使用 Symfony。在包含我的 build.properties 文件的文件夹中，我运行：

```
propel-gen ./ creole 
```

这连接到我的数据库，对其进行逆向工程，并生成我的 schema.xml 然后我运行：

```
propel-gen ./ 
```

它使用 schema.xml 文件来生成我的模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T14:11:37.003

我找到了答案：[只需将您的 schema.xml 放在 schema.yml 所在的文件夹中](http://www.librosweb.es/symfony_1_1_en/capitulo8/extended_schema_syntax.html)并运行命令行

```
php symfony propel:build-model 
```

你会没事的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-29T14:57:02.087

只是为了澄清@lo_fye 的回答，Propel 一直使用 XML。Symfony 提供了 YAML 选项，即便如此，如果您愿意，您也可以使用 XML。假设您使用的是 Symfony，这只是弹出 schema.xml 文件而不是 schema.yml 文件的问题。

FWIW，虽然 XML 模式的可读性稍差，但我更喜欢它们。感觉有点扎实，也许是因为我发现 YAML 中的空间东西很繁琐。

编辑：啊，最后一个答案来自 OP - apols。很高兴你修好了。

# iphone - componentsSeparatedByCharactersInSet 的任何示例代码？（在 iPhone 上）

> ID：599823
> 
> 赞同：15
> 
> 时间：2009-03-01T13:29:45.777
> 
> 标签：iphone, string, substring

我想将从服务器接收到的长字符串拆分为几个子字符串。单独的字符是不同的。

是否有方法的示例代码：componentsSeparatedByCharactersInSet？或者我可以问一个简单的代码将“A~B^C”拆分为“A”、“B”和“C”吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-03-01T14:01:39.913

试试这个

```
NSString *str = @"A~B^C";

NSArray *arr = [str componentsSeparatedByCharactersInSet:
          [NSCharacterSet characterSetWithCharactersInString:@"^~"]];

NSLog(@"%@", arr); 
```

# actionscript-3 - 不可变集合 Actionscript 3

> ID：599825
> 
> 赞同：10
> 
> 时间：2009-03-01T13:33:21.150
> 
> 标签：actionscript-3, collections, language-design, coding-style

我最近一直在尝试在 AS3 中实现一些干净的编码实践。其中之一是不放弃对包含对象的数组的引用。关键是我控制一个类的添加和删除，而数组的所有其他用户都接收只读版本。

目前只读版本是我写的一个*ArrayIterator*类，它实现了一个典型的*Iterator*接口（hasNext，getNext）。它还扩展了*Proxy*，因此它可以像 Array 一样*用于每个*循环。

所以我的问题是这不应该是许多语言的基本特征吗？将引用传递给集合的只读视图的能力？

同样，现在 AS3 中的集合的类型安全性得到了改进，以*Vector*类的形式，当我将 aa Vector 包装在*VectorIterator*中时，为了不变性，我失去了输入。有没有办法在 AS3 中实现这两个愿望，不变性和打字？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-05T11:29:35.440

似乎使用[*迭代器*](http://en.wikipedia.org/wiki/Iterator#Java)模式是目前 AS3 中在系统中传递集合的最佳方式，同时保证它不会被修改。

我使用的*IIterator*接口是基于 Java [Iterator](http://java.sun.com/javase/6/docs/api/java/util/Iterator.html)建模的，但我没有实现*remove()*方法，因为这被 Java 社区中的许多人认为是设计错误，因为它允许用户删除数组元素。下面是我的*IIterator*实现：

```
 public interface IIterator
 {
     function get hasNext():Boolean
     function next():*
 } 
```

然后由 ArrayIterator、VectorIterator 等类实现。

为方便起见，我还在具体的 Iterator 类上扩展了*Proxy ，并通过覆盖**nextNameIndex()*和*nextValue()*方法为 AS3 中的*for-each*循环提供支持。*这意味着通常使用数组的代码在使用我的IIterator*时不需要更改。

 ***```
var array:Array = ["one", "two", "three"]

for each (var eachNumber:String in array)
{
    trace(eachNumber)
}

var iterator:IIterator = new ArrayIterator(array)

for each (var eachNumber:String in iterator)
{
    trace(eachNumber)
} 
```

唯一的问题是......用户无法查看*IIterator*接口并知道他们可以使用*for-each*循环来迭代集合。他们必须查看 ArrayIterator 的实现才能看到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T13:52:22.977

有些人会争辩说，您可以将此类模式实现为库的事实是反对向语言本身添加功能的论据（例如，C++ 语言设计者通常会这么说）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T14:22:51.343

您是否具有通过代理对象想要的不变性？请注意，您可以让 VectorIterator 构造函数采用强制的 Class 参数。诚然，目前这对设计师来说并不友好，但希望将来事情会有所改善。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-23T14:54:42.173

我为 AS3 创建了一个不可变集合类的小型库，其中包括一个类型化的有序列表，听起来它可以满足您的需求。有关详细信息，请参阅[此博客文章](http://www.davidarno.org/2010/04/23/collections.immutable-immutable-collections-for-as3/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-18T03:14:08.640

我为实现这一目标所做的事情是让维护列表的类仅在 getter via 中返回该列表的副本[`slice()`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Vector.html#slice%28%29)。举个例子，我的游戏引擎有一个类`Scene`，它维护着所有`Beings`已添加到其中的列表。然后将该列表作为副本公开，如下所示：

```
public function get beings():Vector.<Being>
{
    return _beings.slice();
} 
```

（很抱歉恢复一个旧线程，我在寻找方法来实现布莱恩的答案所涵盖的内容时遇到了这个问题，并认为我会在这件事上投入 2 美分）。

# concurrency - 关于在 OS 中运行的程序的并发问题

> ID：599826
> 
> 赞同：5
> 
> 时间：2009-03-01T13:35:03.813
> 
> 标签：concurrency

这是我对操作系统中的并发性的了解。

为了在操作系统中运行多任务，CPU 会为每个任务分配一个时隙。在执行任务 A 时，其他任务会“休眠”，依此类推。

这是我的问题：

我有一个计时器程序，用于计算键盘/鼠标的不活动。如果在 15 分钟内继续不活动，则会弹出屏幕保护程序。

如果并发理论如我上面所说，那么定时器会不准确吗？因为OS中运行的每个程序都会有一段时间“休眠”，那么定时器程序也有机会“休眠”，但在现实世界中时间并没有停止。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T14:04:46.050

在大多数操作系统中，您的任务不仅会在其时间片已使用时进入睡眠状态，而且在等待 I/O 时也会进入睡眠状态（这对于大多数程序来说更为常见）。

就像AnthonyWJones 所说，使用操作系统的当前时间概念。

操作系统内核的时间片太短，无法为屏幕保护程序引入任何明显的不准确性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T14:28:23.810

我认为你的等待过程可以很简单：

1.  activityTime = 最后一次按键或鼠标移动的时间 [来自操作系统]
2.  现在 = 当前时间 [来自操作系统]
3.  如果现在 >= 活动时间后 15 分钟，则启动屏幕保护程序
4.  睡眠几秒钟，然后返回步骤 1

因为第 1 步和第 2 步使用的是操作系统，而不是某种运行计数器，所以您不必关心在此活动期间是否随时被打断。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T13:38:56.037

您将使用操作系统中的服务来提供一个您不会尝试自己实现的计时器。如果代码必须简单地运行以计算时间，就计算而言，我们仍然处于黑暗时代。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T15:11:15.953

您指定的时间`sleep()`是实时的，而不是您的进程使用的 cpu 时间。（因为当您的程序休眠时，CPU 时间大约为 0。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-01T13:40:07.903

这可能与语言有关。在 Java 中，这不是问题。我怀疑所有语言都会在这里“做正确的事”。需要注意的是，此类计时器无论如何都不是非常准确，并且通常您只能期望您的计时器至少会在您指定的时间内休眠，但可能会休眠更长时间。也就是说，当时间用完时，它可能不是活动线程，因此稍后会恢复处理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-01T13:41:34.220

参见例如[http://www.opengroup.org/onlinepubs/000095399/functions/sleep.html](http://www.opengroup.org/onlinepubs/000095399/functions/sleep.html)

> 由于系统对其他活动的调度，暂停时间可能比请求的时间长。

# iphone - 如何在编辑模式下启动 UITextView (iPhone)？

> ID：599828
> 
> 赞同：1
> 
> 时间：2009-03-01T13:36:41.593
> 
> 标签：iphone, uitextview

我正在开发一个只有一个视图 UITextView 的 iPhone 应用程序，我希望它能够启动所有准备好输入（激活键盘），但默认情况下，它要求用户在键盘出现之前先点击视图。我已经在其他应用程序中看到了这一点，但无法弄清楚。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-01T14:43:27.207

您需要在您的字段上使用 -becomeFirstResponder 方法：

```
[myTextField becomeFirstResponder]; 
```

这将弹出键盘。要隐藏键盘，请使用 -resignFirstResponder。

# php - 在一个查询中执行更新并设置用户变量

> ID：599832
> 
> 赞同：2
> 
> 时间：2009-03-01T13:38:32.277
> 
> 标签：php, mysql, user-variables

熟悉 php 的 mysql_query 命令的人都知道，它不允许我们在一次调用中执行多个查询（由 ; 分隔符分隔）...

我的问题是我不能在我的 UPDATE 查询中定义一个用户变量，以便我为每一行递增它（有点像自动递增）。它应该看起来像这样：

```
SET @t1=0;
UPDATE `mytable` SET `order` = (@t1:=(@t1+1)) ORDER BY `order` ASC; 
```

我的问题是，因为我无法定义我的变量然后进行更新，所以我找不到在查询中设置变量的方法。如果它是NULL，我试图定义它：

```
... `order` = (IFNULL( @t1 := ( @t1 + 1 ) , @t1 := 0 )) ... 
```

但它没有工作，因为变量在它工作的每一行都会重置。

任何熟悉mysql的人都知道这是一个解决方案吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-07-01T14:04:00.757

老问题，但无论如何这是一个答案：

```
UPDATE `mytable` SET `order` = (@t1 := IFNULL(@t1, 0) + 1) ORDER BY `order` ASC; 
```

`IFNULL(@t1, 0)``@t1`如果没有值则返回 0，如果有值则返回 的`@t1`值。

因此，第一行`@t1`没有设置，它会随着`order = (@t1 := 0 + 1)`后续行的更新而更新，并在`@t1`每行添加 +1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T13:50:58.503

您可以使用 mysqli 库，它允许在一个查询中使用多个查询

```
mysqli->multiple_query( string $querys); 
```

[http://us.php.net/mysqli_multi_query](http://us.php.net/mysqli_multi_query)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T13:56:43.887

出门在外，怎么样...

```
... `order` = (SELECT `order`+1 FROM `mytable` ORDER BY `order` DESC LIMIT 1)

```

或类似的东西作为子查询？...我不确定子查询是否在每次更新后重新运行，但如果确实如此，它应该选择以前的最高`order`值并增加它？

# c# - 如何生成和验证软件许可证密钥？

> ID：599837
> 
> 赞同：272
> 
> 时间：2009-03-01T13:41:30.413
> 
> 标签：c#, license-key

我目前正在开发一个产品（用 C# 开发），可以免费下载和安装，但版本非常有限。要访问所有功能，用户必须支付许可费并获得密钥。然后将该密钥输入应用程序以“解锁”完整版本。

由于使用这样的许可证密钥很常见，我想知道：

1.  一般是怎么解决的？
2.  如何生成密钥以及如何通过应用程序对其进行验证？
3.  我怎样才能避免密钥在 Internet 上发布并被未支付许可证的其他人使用（密钥基本上不是“他们的”）。

我想我也应该以某种方式将密钥与应用程序的版本联系起来，这样就可以对功能版本中的新密钥收费。

在这种情况下我还应该考虑什么？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-03-01T13:53:08.153

警告：你不能阻止用户盗版，只能让诚实的用户更容易做正确的事。

假设您不想为每个用户进行特殊构建，那么：

*   为自己生成产品的密钥
*   取用户名
*   使用（例如）SHA1 连接用户名和密钥和散列
*   将 SHA1 哈希解压缩为字母数字字符串。这是个人用户的“产品密钥”
*   在程序中，执行相同的哈希，并与产品密钥进行比较。如果相等，OK。

但是，我再说一遍：**这不会阻止盗版**

* * *

我最近读到这种方法在密码学上不是很可靠。但是这个解决方案已经很弱（**因为软件本身必须在某处包含密钥**），所以我认为这个发现不会使解决方案失效。

不过，我只是觉得我真的应该提到这一点；如果您打算从中获得其他东西，请小心。

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2011-11-16T10:23:06.223

生成许可证密钥的方法有很多，但真正安全的方法很少。很遗憾，因为对于公司而言，许可证密钥的价值几乎与真实现金相同。

理想情况下，您希望您的许可证密钥具有以下属性：

1.  只有您的公司应该能够为您的产品生成许可证密钥，即使有人完全对您的产品进行逆向工程（这将发生，我从经验中说）。如果您认真控制许可，那么在您的软件中混淆算法或隐藏加密密钥确实是不可能的。如果您的产品成功，有人会在发布后的几天内制作密钥生成器。

2.  许可证密钥应该只能在一台计算机上使用（或者至少您应该能够非常严格地控制它）

3.  许可证密钥应该简短且易于通过电话键入或口述。您不希望每个客户都致电技术支持，因为他们不知道密钥是包含“l”还是“1”。您的支持部门会为此感谢您，并且您在这方面的成本会更低。

那么您如何解决这些挑战呢？

1.  答案很简单，但在技术上具有挑战性：使用公钥加密的数字签名。您的许可证密钥实际上应该是签名的“文档”，包含一些有用的数据，并使用您公司的私钥签名。签名应该是许可证密钥的一部分。产品应使用相应的公钥验证许可证密钥。这样，即使有人可以完全访问您的产品逻辑，他们也无法生成许可证密钥，因为他们没有私钥。许可证密钥如下所示： BASE32(CONCAT(DATA, PRIVATE_KEY_ENCRYPTED(HASH(DATA)))) 这里最大的挑战是经典的公钥算法具有较大的签名大小。RSA512 具有 1024 位签名。您不希望您的许可证密钥包含数百个字符。最强大的方法之一是使用椭圆曲线密码学（仔细实施以避免现有专利）。对于相同的强度，ECC 密钥比 RSA 密钥短 6 倍。您可以使用 Schnorr 数字签名算法（专利于 2008 年到期 - 好 :) 等算法进一步减小签名大小

2.  这可以通过产品激活来实现（Windows 就是一个很好的例子）。基本上，对于拥有有效许可证密钥的客户，您需要生成一些“激活数据”，这是一条将计算机的硬件 ID 作为签名数据嵌入的签名消息。这通常在 Internet 上完成，但只有一次：产品将许可证密钥和计算机硬件 ID 发送到激活服务器，激活服务器将签名消息发回（也可以简短易懂）电话）。从那一刻起，产品在启动时不再检查许可证密钥，而是检查激活数据，这需要计算机相同才能进行验证（否则，数据将不同，数字签名将无法验证）。

3.  好吧，只需从您的键中消除冗余字符，如“1”、“l”、“0”、“o”。将许可证密钥字符串拆分为字符组。

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2009-03-01T13:45:51.743

简单的答案 - 无论您使用什么方案，它都可以被破解。

不要使用旨在防止黑客的系统来惩罚诚实的客户，因为黑客无论如何都会破解它。

与他们的电子邮件或类似内容相关联的简单散列代码可能就足够了。当人们需要重新安装或更新硬件时，基于硬件的 ID 总是成为一个问题。

关于这个问题的好帖子： [http ://discuss.joelonsoftware.com/default.asp?biz.5.82298.34](https://web.archive.org/web/20181006064951/http://discuss.joelonsoftware.com/default.asp?biz.5.82298.34)

* * *

## 回答 #4

> 赞同：61
> 
> 时间：2009-03-01T14:06:30.273

生成密钥时，不要忘记将版本和内部版本号连接到您计算哈希值的字符串。这样一来，就没有一把钥匙可以解锁你曾经发布的所有东西。

[当你在astalavista.box.sk](http://astalavista.box.sk)中找到一些密钥或补丁后，你就会知道你成功地制作了一些流行到有人费心破解的东西。麾！

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2009-03-01T17:56:06.680

除了已经说过的......

由于中间语言问题，任何对 .NET 应用程序的使用本质上都是可破坏的。.NET 代码的简单反汇编将向任何人开放您的产品。那时他们可以轻松绕过您的许可代码。

您甚至不能再使用硬件值来创建密钥。虚拟机现在允许某人创建“许可”机器的映像并在他们选择的任何平台上运行它。

如果它是昂贵的软件，还有其他解决方案。如果不是这样，就让普通黑客很难做到。并接受最终会有未经许可的副本的事实。

如果您的产品很复杂，那么固有的支持问题将为您创造一些保护。

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2018-08-25T16:50:47.377

我是[Cryptolens](https://cryptolens.io)软件许可平台背后的开发人员之一，自 14 岁以来一直致力于许可系统。在这个答案中，我根据多年来获得的经验提供了一些技巧。

解决此问题的最佳方法是设置一个许可证密钥服务器，应用程序的每个实例都将调用该服务器以验证许可证密钥。

## 许可证密钥服务器的好处

许可证密钥服务器的优点是：

1.  您始终可以立即更新或阻止许可证密钥。
2.  每个许可证密钥都可以锁定到一定数量的机器上（这有助于防止用户在线发布许可证密钥供其他人使用）。

## 注意事项

虽然在线验证许可证可以让您更好地控制应用程序的每个实例，但互联网连接并不总是存在（尤其是如果您针对大型企业），因此我们需要另一种执行许可证密钥验证的方法。

解决方案是始终使用 RSA 或 ECC 等公钥密码系统对来自服务器的许可证密钥响应进行签名（如果您计划在嵌入式系统上运行，可能会更好）。您的应用程序应该只有**公钥**来验证许可证密钥响应。

因此，如果没有 Internet 连接，您可以改用之前的许可证密钥响应。确保在响应中存储**日期**和**机器标识符**，并检查它不是太旧（例如，您允许用户最多离线 30 天等）并且许可证密钥响应属于正确的设备。

> **请注意**，您应该始终检查许可证密钥响应的证书，即使您已连接到 Internet），以确保它在离开服务器后没有被更改（即使您的 API 到许可证密钥服务器使用 https)

## 保护秘密算法

大多数 .NET 应用程序都可以很容易地进行逆向工程（微软提供了一个反汇编程序来获取 IL 代码，一些商业产品甚至可以检索源代码，例如 C#）。当然，你总是可以混淆代码，但它永远不是 100% 安全的。

在大多数情况下，任何软件许可解决方案的目的都是帮助诚实的人诚实（即愿意付费的诚实用户不要忘记在试用期结束后付费等）。

但是，您可能仍然有一些您绝对不想泄露给公众的代码（例如，预测股票价格的算法等）。在这种情况下，唯一的方法是创建一个**API 端点**，您的应用程序将在每次执行该方法时调用该端点。它需要互联网连接，但它确保您的密码永远不会被客户端计算机执行。

## 执行

如果您不想自己实现所有内容，我建议您查看[本教程](https://help.cryptolens.io/examples/key-verification)（[Cryptolens](https://cryptolens.io)的一部分）

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2013-05-09T21:21:57.107

我们用于生成许可证密钥的 C# / .NET 引擎现在作为开源维护：

[https://github.com/appsoftware/.NET-Licence-Key-Generator](https://github.com/appsoftware/.NET-Licence-Key-Generator)。

它基于“部分密钥验证”系统，这意味着只有您用来生成密钥的密钥子集必须编译到您的可分发文件中。您自己创建密钥，因此许可证实施对于您的软件是唯一的。

如上所述，如果您的代码可以反编译，那么绕过大多数许可系统相对容易。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-03-01T13:43:57.490

我过去使用过[Crypkey](http://www.crypkey.com/)。它是众多可用的之一。

您只能使用任何许可方案在一定程度上保护软件。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-03-01T17:11:39.567

不知道你想多详细

但我相信.net 可以访问硬盘序列号。

你可以让程序向你发送那个和一些 eles（比如 nic 的用户名和 mac 地址）

您根据该代码计算代码并将密钥通过电子邮件发送给他们。

他们将阻止他们在获得钥匙后更换机器。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-03-01T13:46:59.447

完成您要求的所有事情的唯一方法是要求访问互联网并使用服务器进行验证。应用程序需要使用密钥登录服务器，然后您需要存储会话详细信息，例如 IP 地址。这将防止密钥在几台不同的机器上使用。这通常不太受应用程序用户的欢迎，除非这是一个非常昂贵和复杂的应用程序，否则不值得。

您可以只拥有应用程序的许可证密钥，然后检查客户端是否正确，但是很容易将此密钥分发给其他用户，并且可以使用反编译器生成新密钥。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2013-05-12T01:43:16.733

我已经在我公司的软件 (C# .net) 上实现了基于 Internet 的一次性激活，该软件需要一个许可证密钥，该许可证密钥是指存储在服务器数据库中的许可证。该软件使用密钥访问服务器并获得许可信息，然后使用客户端计算机上的某些变量（CPUID 和其他不会经常更改的内容的组合）生成的 RSA 密钥在本地加密，然后将其存储在注册表。

它需要一些服务器端编码，但它对我们来说非常有效，当我们扩展到基于浏览器的软件时，我能够使用相同的系统。它还为您的销售人员提供有关软件使用人员、使用地点和时间的重要信息。任何仅在本地处理的许可系统都完全容易受到利用，**尤其是在 .NET 中的反射**。但是，就像其他人所说的那样，没有一个系统是完全安全的。

在我看来，如果您不使用基于 Web 的许可，那么保护软件根本没有任何意义。由于 DRM 可能引起的头痛，这对实际为此付出代价的用户是不公平的。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2015-01-08T07:01:24.257

我坚信，只有基于公钥加密的许可系统才是正确的方法，因为您不必在源代码中包含生成许可所需的基本信息。

过去，我多次使用**[Treek 的许可库](http://www.treekslicensinglibrary.com)**，因为它满足了这个要求并且提供了非常好的价格。它对最终用户和自身使用相同的许可证保护，直到现在还没有人破解它。您还可以在网站上找到避免盗版和破解的好技巧。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2018-04-10T20:20:11.453

您可以使用免费的第三方解决方案为您处理此问题，例如 Quantum-Key.Net 它是免费的，通过它为您创建的网络销售页面通过贝宝处理付款，通过电子邮件发放密钥并将密钥使用锁定到特定计算机以防止盗版。

您还应该注意混淆/加密您的代码，否则可以使用 De4dot 和 .NetReflector 等软件轻松对其进行逆向工程。一个好的免费代码混淆器是 ConfuserEx，它使用起来快速、简单，并且比昂贵的替代品更有效。

您应该通过 De4Dot 和 .NetReflector 运行您完成的软件，对其进行逆向工程，看看如果他们做了同样的事情，破解者会看到什么，并确保您没有留下任何重要的代码暴露或不加掩饰。

您的软件仍然是可破解的，但对于临时破解者来说，推迟它们可能就足够了，这些简单的步骤也将防止您的代码被提取和重用。

[https://quantum-key.net](https://quantum-key.net)

[如何使用ConfuserEx？](https://stackoverflow.com/questions/24154502/how-to-use-confuserex)

[https://github.com/0xd4d/de4dot](https://github.com/0xd4d/de4dot)

[https://www.red-gate.com/dynamic/products/dotnet-development/reflector/download](https://www.red-gate.com/dynamic/products/dotnet-development/reflector/download)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-01-31T19:04:50.940

完全防止软件盗版是不可能的。您可以防止随意盗版，这就是他们所有的许可解决方案所做的。

如果您想防止重复使用许可证密钥，最好使用节点（机器）锁定许可。我已经为我的软件使用[Cryptlex](https://cryptlex.com)大约一年了。它也有一个**免费计划**，所以如果您不希望有太多客户，您可以免费使用它。

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2021-02-18T19:06:10.010

I solved it by interfacing my program with a discord server, where it checks in a specific chat if the product key entered by the user exists and is still valid. In this way to receive a product key the user would be forced to hack discord and it is very difficult.

# javascript - JSLint (CLI)：选项？

> ID：599842
> 
> 赞同：15
> 
> 时间：2009-03-01T13:46:52.600
> 
> 标签：javascript, jslint, lint

我正在从 Ubuntu 命令行运行[JSLint](http://www.jslint.com)的[Rhino 版本，如下所示：](http://www.jslint.com/rhino/index.html)

```
$ rhino jslint.js myScript.js 
```

虽然 Web 界面提供了各种选项，但我不知道如何通过命令行调用这些选项。我是否忽略了文档中的任何内容？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-01T14:39:07.637

是的！你确实错过了。您可以在 .js 文件的顶部指定 jslint 的选项。请参阅[文档页面](http://www.jslint.com/lint.html)并阅读选项部分以获取示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T10:58:33.467

我的[jslint4java](https://github.com/happygiraffe/jslint4java)项目包括一个命令行工具，允许您添加诸如`--undef`. 这可能比手动运行更有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T08:29:44.430

我受到上述讨论的启发，并相应地扩展了我的[JSLint 包装](http://github.com/FND/misc/blob/ddcd0495d40f0c0203bfb063e30d4a110ef45666/JSLint/wrapper.py)脚本。它相当原始，但似乎可以完成这项工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-23T17:54:03.350

[Cory Bennet](http://www.corybennett.org/projects/)为 jslint 提供了一个 perl+js 包装器（基于 Ian Bicking 的[现有技术](http://blog.ianbicking.org/jslint-command-line.html)）。它有命令行选项等。他甚至详细介绍了通过编译模式挂钩的一些 Emacs 集成。

我遇到了一些麻烦，并记下了[让它在 Cygwin 和 Emacs32 中工作的](http://www.xradiograph.com/JavaScript/JSLint)一些说明。

在类似的问题中还有其他一些选项：[Is there an offline version of jslint for windows?](https://stackoverflow.com/questions/227022/is-there-offline-version-of-jslint-for-windows)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-21T22:47:29.427

I came up with a command line jslint solution based on jQuery's [jslint-check.js](http://github.com/jquery/jquery/blob/master/build/jslint-check.js) script, which is executed within Rhino via their [Makefile](http://github.com/jquery/jquery/blob/master/Makefile).

# lotus-notes - 在 Lotus Notes 中关联文档

> ID：599845
> 
> 赞同：2
> 
> 时间：2009-03-01T13:47:38.027
> 
> 标签：lotus-notes

当一个文档与另一个文档关联时（例如，作为与客户相关的地址），notes 如何存储信息？它是创建一个新文档来表示关联，还是将链接的文档标记为响应文档？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T01:16:20.897

我猜你问是因为你正在查看别人的数据库，但如果你是从头开始并且想知道最好的方法，我也会回答这个问题。

简短的回答：笔记不是相关的。我敢打赌，地址与客户存储在同一个文档中。

长答案：如果有单独的客户和地址文档，则文档之间通常存在一些松散的联系，可能基于 UniqueID 字段或可能只是一个名称。例如，客户表单可能会查找地址视图并根据客户姓名选择该地址，这意味着地址文档中存储了客户姓名。

有时可以通过文档和响应的父/子关系创建链接，但这更常用于讨论线程数据库或非常特殊的情况。

最终由 Notes 应用程序的开发人员决定如何链接数据。我的建议，特别是如果您来自关系数据库背景，是在 compose 上计算的隐藏文本字段中使用 @UniqueID 公式。这将在您的文档上标记一个 GUID，您可以使用它来引用文档，就像您使用表的外键一样。这有助于使数据保持一定程度的标准化。

除了响应文档之外，Notes 没有自动将一个文档与另一个文档关联的方式，响应文档在创建时设置为包含父文档的 GUID 的 $REF 项。同样，这不是关联客户和地址等文档的理想方式，因为无法利用这种关系来简化开发。文档/响应层次结构主要用于在视图中组织文档。

# c# - 如何向 Mono.ZeroConf 注册服务？

> ID：599846
> 
> 赞同：6
> 
> 时间：2009-03-01T13:47:54.483
> 
> 标签：c#, mono, zeroconf

我正在尝试在[http://www.mono-project.com/Mono.Zeroconf](http://www.mono-project.com/Mono.Zeroconf)测试 ZeroConf 示例。

我正在运行 OpenSuse 11 和 Mono 2.2。

我的服务器代码是：

```
using System;
using Mono.Zeroconf;

namespace zeroconftestserver
{
    class MainClass
    {
        public static void Main(string[] args)
        {
            RegisterService service = new RegisterService ();
            service.Name = "test server";
            service.RegType = "_daap._tcp";
            service.ReplyDomain = "local.";
            service.Port = 6060;

            // TxtRecords are optional
            TxtRecord txt_record = new TxtRecord ();
            txt_record.Add ("Password", "false");
            service.TxtRecord = txt_record;

            service.Register();
            Console.WriteLine("Service registered!");
            Console.ReadLine();
        }
    }
} 
```

但是我无法使用示例客户端浏览器代码或 mzclient 找到我的注册服务。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-11-29T21:54:29.670

我还尝试使用[Mono.Zeroconf](http://www.mono-project.com/Mono.Zeroconf)项目页面提供的二进制文件并从源代码构建库以在 Windows 上使用，但无法发布其他客户端可找到的服务。我尝试了网站上的示例代码和提供的 MZClient。

经过一番挖掘，我发现了一个使用 Mono.Zeroconf 库的项目。通过使用在 Google Code 中签入[Growl for Windows](http://code.google.com/p/growl-for-windows/)项目的二进制文件（这似乎是最新版本 0.9.0），我能够成功地发布带有示例代码和 MZClient 的可查找服务。

因此，一个明显的解决方法是从该项目中获取二进制文件（Mono.Zeroconf 和 Mono.Zeroconf.Providers.Bonjour）并使用它们而不是项目提供的那些。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T16:58:33.517

mono-project.com/Mono.Zeroconf 上的二进制文件已过期，但仍包含导致此问题的代码。最新代码（包含所有修复程序）位于[此链接](https://github.com/mono/Mono.Zeroconf) ，但需要您自己编译代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-14T04:31:58.003

从以下链接更新源后重新编译解决了该问题

[https://github.com/mono/Mono.Zeroconf/tree/master/src](https://github.com/mono/Mono.Zeroconf/tree/master/src)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-10T22:34:32.797

我也无法发布服务。我查看了代码，发现 UPort 设置器 Service.cs 中有一个错误：

```
this.port = (ushort) IPAddress.HostToNetworkOrder((int) value);  //overflow, port is always 0 
```

它应该是

```
this.port = (ushort) IPAddress.HostToNetworkOrder((short) value); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T18:33:34.383

他正在使用 mzclient 来测试上面的 Mono.Zeroconf 代码。Mono.Zeroconf 的全部意义在于提供跨平台、多个 mDNS 提供商支持（Avahi 和 Bonjour）。

EntryGroup DBus Avahi API 似乎存在问题，我正在 Mono.Zeroconf 中对其进行调查。我将在此处发布解决方案，并在我发现问题后发布新的 Mono.Zeroconf 版本（我是该项目的维护者）。

# exception-handling - 使用异常的情况，用户应该能够触发异常吗？

> ID：599852
> 
> 赞同：0
> 
> 时间：2009-03-01T13:53:07.780
> 
> 标签：exception-handling

使用异常来处理用户生成的错误是否可以接受或明智？如 ...

```
 try
    {
        $job->authorise($user);
    }
    catch (InsufficentCreditException $e)
    {
        return E_INSUFFICIENT_CREDIT;
    }
    catch (PermissionDeniedException $e)
    {
        return E_PERMISSION_DENIED;
    } 
```

还是只为更严重的错误保留异常（例如找不到文件，除以零）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-01T13:55:35.793

错误的用户输入绝不是例外。这是常态！

不过说真的。例外是针对特殊情况，来自外部来源的错误/不正确数据通常也不例外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T15:19:27.727

如果我理解上面的用例，我认为“InsufficentCreditException”是抛出的一个很好的理由。程序的所有正流都可以自上而下地处理，正流的任何“异常”都是失败，因此是异常。

米奇说，“错误的用户输入绝不是例外”，“来自外部来源的错误/不正确的数据通常也不例外”，但如果您处于“合同计划”下，情况就是如此。有什么比从外部来源接收到的无效数据更好的理由抛出异常呢？

最后一点，您的问题和您的用例不匹配。信用不足通常不是由用户生成的错误引起的。一个明确的因果关系将使这个问题更容易回答。

# sql-server - SQL Server 2005 中的分区函数

> ID：599856
> 
> 赞同：1
> 
> 时间：2009-03-01T13:56:18.630
> 
> 标签：sql-server, sql-server-2005, partitioning

在 MSDN 中关于分区功能的信息来自这里，[$PARTITION(Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms188071.aspx)。

我对下面的示例在做什么感到困惑。我的理解是，这条 SQL 语句将迭代表 Production.TransactionHistory 中的所有行，因为对于将映射到同一分区的所有行，$PARTITION.TransactionRangePF1(TransactionDate) 将返回相同的值，即所有的分区号这样的行。因此，例如，分区 1 中的所有行将导致返回结果为一行，因为它们都具有相同的 $PARTITION.TransactionRangePF1(TransactionDate) 值。我的理解正确吗？

```
USE AdventureWorks ;
GO
SELECT $PARTITION.TransactionRangePF1(TransactionDate) AS Partition, 
COUNT(*) AS [COUNT] FROM Production.TransactionHistory 
GROUP BY $PARTITION.TransactionRangePF1(TransactionDate)
ORDER BY Partition ;
GO 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T15:21:45.077

If your parition function is defined like

```
CREATE PARTITION FUNCTION TransactionRangePF1(DATETIME)
AS RANGE RIGHT FOR VALUES ('2007-01-01', '2008-01-01', '2009-01-01') 
```

, then this clause:

```
$PARTITION.TransactionRangePF1(TransactionDate) 
```

is equivalent to:

```
CASE
  WHEN TransactionDate < '2007-01-01' THEN 1
  WHEN TransactionDate < '2008-01-01' THEN 2
  WHEN TransactionDate < '2009-01-01' THEN 3
  ELSE 4
END 
```

If all your dates fall before `'2007-01-01'`, then the first `WHEN` clause will always fire and it will always return `1`.

The query you posted will return at most `1` row for each partition, as it will group all the rows from the partition (if any) into one group.

If there are no rows for any partition, no rows for it will be returned in the resultset.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T14:01:16.777

它返回分区表中每个非空分区中的记录数`Production.TransactionHistory`，所以是的，您的推理是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T15:06:53.943

您是否尝试过为语句生成执行计划？这可能会让您对它在封面下的实际操作有所了解。

如果您想要一些解释，请按“Control-L”生成执行计划并将其发布在此处。

# javascript - JSLint：控制注释（选择性忽略）

> ID：599859
> 
> 赞同：44
> 
> 时间：2009-03-01T13:57:16.083
> 
> 标签：javascript, jslint, lint

[JSLint](http://www.jslint.com)是否有类似 JavaScript Lint 的[控制注释](http://www.javascriptlint.com/docs/index.htm)（例如`/*jsl:fallthru*/`）以使其忽略某些段落？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-11-01T10:51:37.277

放

```
/*ignore jslint start*/ 
```

之前和

```
/*ignore jslint end*/ 
```

在要忽略的代码之后。前任：

```
function ignore(){
    /*ignore jslint start*/
    var x; var y;
    /*ignore jslint end*/
} 
```

或导出 JsLint 设置，定义您的 IgnoreErrorStart/ IgnoreErrorEnd 符号并导入。

* * *

**编辑**
有些人可能会将这个答案与 JSHint 混淆。在这种情况下，请使用这些：

```
/*jshint ignore:start*/
  <!-- code in here -->
/*jshint ignore:end*/ 
```

取自[https://stackoverflow.com/a/26012357/313501](https://stackoverflow.com/a/26012357/313501)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-01T19:17:17.063

是的。从文档 [请注意，这是来自旧版本的文档，但它仍然适用]：

> JSLint 的实现接受一个选项对象，该对象允许您确定您可以接受的 JavaScript 子集。也可以在脚本的源代码中设置这些选项。
> 
> 选项规范可能如下所示：

```
/*jslint nomen: true, debug: true,
  evil: false, vars: true */ 
```

> 选项规范以 /*jslint 开头。请注意，在 j 之前没有空格。规范包含一系列名称值对，其中名称是 JSLint 选项，值是真或假。选项规范优先于选项对象。

文档没有特别提到它，但是您可以使用多个 jslint 注释在整个代码中启用和禁用不同的检查（感谢 Dominic Mitchell）。

文档中有[完整的选项列表](http://www.jslint.com/help.html)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-12-29T21:36:13.187

这是补充 Matthew Crumley 出色答案的代码示例：

```
(function ($) {
  $.isValidEmail = function(email){
    /*jslint maxlen: 1000*/
    var EMAIL_REGEXP = /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i;
    /*jslint maxlen: 200*/
    return EMAIL_REGEXP.test(email);
  };
}(jQuery)); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-11-24T20:25:07.733

据我所知，这里没有任何东西可以回答这个问题。下面的代码仍然给我验证错误，我不能让 JSLint 接受我现在没有时间更正一个工作正则表达式给定 ACTUAL PRIORITIES。

我收到的错误与未转义的“{”有关，可能会导致我的新专业团队拒绝将 JSLint 作为可行的工具。对于我们为更有效地发展所做的努力，似乎没有办法闭嘴，这似乎是有问题的。

```
/*jslint browser: true, devel: true, todo: true, regexp: true */
/*global $ */
/*
    Abstract:
        + This module constitutes a layer of abstraction surrounding our bootstrap dependencies.
        + This module also contains some utility functions (so find a better place for them already!).
    Validation:
        + This module has been validated using JSLint (www.jslint.com).
*/
var shoelaceModule = (function () {
    'use strict';
    return {
        showModal: function ($target) {
            $target.modal('show');
        },

        hideModal: function ($target) {
            $target.modal('hide');
        },

        /*jsl:ignore */
        /*ignore jslint start */
        stringFormat: function (format) {
            var args = Array.prototype.slice.call(arguments, 1);
            return format.replace(/{([^{}]*)}/g, function (match, number) {
                return args[number] !== 'undefined' ? args[number] : match;
            });
        },
        /*ignore jslint end */
        /*jsl:end */

        init: function () {
            return this;
        }
    };
}()); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-01T15:03:06.113

似乎并非如此。一些谷歌搜索发现了其他人的几篇帖子，以及 JSLint 人员的回复，内容是“修复你的代码而不是故意标记它有缺陷”。看起来并不完全友好。当然，也许在这种情况下你应该只修复代码，但我留给你回答。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-04-17T01:52:41.167

你也可以： ......

`ignoreThis(); // jslint ignore:line`

[有没有办法抑制给定行的 JSHint 警告？](https://stackoverflow.com/questions/12977661/is-there-a-way-to-suppress-jshint-warning-for-one-given-line)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-06T22:12:45.217

我要说，不。JSLint 似乎没有一种简单的方式来说“忽略这段代码”，这让我很烦恼。单独禁用不同的选项，然后像马特建议的那样重新打开它们应该可以工作，但它不会像 JSHint 的`/* jshint ignore:start */`,那样优雅`/* jshint ignore:end */`。

我之所以研究这个是因为我使用的是[Brackets](http://brackets.io/)，它是 JSLint 附带的，因为它是默认的 linter。我有一些缩小的 3rd 方代码，我暂时复制到我的 .js 中，只要它在那里，JSLint 就会抱怨。令人讨厌的是我经常想在早期粘贴一个缩小的块，这也是我希望 linter 查看*我的*代码以帮助我排除模糊错误的时候。稍后我将使用 Grunt 缩小并连接所有内容，但无法在早期禁用它是非常非常烦人的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-23T09:46:06.270

这似乎对我有用。（使用 zedapp 中嵌入的 jslint - zedapp.org）

```
/*jslint ignore:start*/
require([],function(require, exports, module) {
  /*jslint ignore:end*/

  var api = {
    life: {
      universe: {
        everything: function() {
          this.everything = {answer : 42};
        }
      }
    }
  };
 api.life.universe.everything.bind(api.life.universe)();
 console.log(JSON.stringify(api));

  /*jslint ignore:start*/
  return api;
});
/*jslint ignore:end*/
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.5/require.js"></script>
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2010-03-01T14:44:20.297

把代码放在`/*jsl:ignore*/` 周围 `/*jsl:end*/` 。

# asp.net-mvc - 如何在 ASP.NET MVC 中创建 1 个具有 2 个不同用户访问权限的路由？

> ID：599863
> 
> 赞同：1
> 
> 时间：2009-03-01T14:01:12.813
> 
> 标签：asp.net-mvc, routing

我该怎么做：我在名为“Schedule”的页面上有，可以通过 2 种不同的方式访问它：

```
URL 1- www.bla.com/Admin/Schedule
URL 2- www.bla.com/Schedule 
```

具有管理员权限的用户将访问“URL 1”，此视图将显示一些管理员内容，并且用户必须登录。

另一方面，“URL 2”将由未登录的用户访问，并且不会显示管理员内容。

但是，它们是同一个页面，只是根据用户的访问权限而有所不同。

我已经有 AdminController，我打算把这个“计划”视图作为这个控制器的一部分。结果，我知道如果我输入“URL 1”它会起作用。但是，如果我输入“URL 2”？我是否必须创建一个“ScheduleController”来处理这个？

我想知道是否有办法通过 Global.asax 解决这个问题，配置路由......我不知道......

谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T14:14:19.507

使视图共享并从两个控制器操作中呈现它。通过模型（或 ViewData）传递适当的数据，以便 View 在从非管理控制器操作呈现时知道不呈现管理内容。

而且，是的，创建调度控制器。简化路由并在后端处理共享生成代码。

管理员控制器

```
public ActionResult Schedule( ... )
{
    Schedule sched = ... get model ...

    return View("Schedule", new SchedViewModel {
                                                 Schedule = sched,
                                                 Admin = true 
                                               } );
} 
```

调度控制器

```
public ActionResult Index( ... )
{
    Schedule sched = ... get model ...

    return View("Schedule", new SchedViewModel {
                                                 Schedule = sched,
                                                 Admin = false 
                                               } );    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T14:30:41.573

您可以将 /Schedule 路由映射到 Global.asax.cs 中的 /Admin/Schedule 操作，如下所示：

```
 routes.MapRoute(
            "Schedule",
            "schedule",
            new { controller = "Admin", action = "Schedule" }
        ); 
```

这将解决您想要两条单独的路线导致相同的操作/视图的直接问题。

但是，这不会正确解决您的情况。主要问题是登录用户的身份与请求所采用的路由正交。换句话说，您不能强迫管理员用户总是点击 /Admin/Schedule 路由，他们也可以点击 /Schedule 路由并且仍然期望相同的最终结果。不仅如此，这样做会阻止您使用 Admin 控制器上的 [Authorize] 属性或强制用户登录的操作，并且必须实现自定义逻辑检查操作通过哪个路由并决定是否您想强制登录或让用户通过。

因此，您必须做出决定：

*   您共享控制器、操作和视图，并根据登录用户的身份和角色成员身份（如果有）确定是否在视图中显示附加信息。然后您必须更改控制器的名称，因为 /Admin 不会反映此类具有的新角色；
*   您只共享视图并拥有两个独立的控制器和操作 - Admin.Schedule 和 User.Schedule。您必须将视图放在 /views/shared 文件夹中，并从两个操作返回相同的视图，可能会传递不同的模型。您最终会得到两条路线 - /Admin/Schedule 和 /User/Schedule；
*   你有两个独立的控制器，动作和视图。

在所有三种情况下，如果您还想拥有最短的 /Schedule 路由，您仍然可以让上述规则指向适当的控制器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T14:10:51.467

如果它是同一个页面，听起来你真的不需要不同的 URL。但是，如果由于某种原因您仍想使用 2 个不同的 URL...

网址 1：

```
routes.MapRoute("ScheduleAdmin", "Admin/Schedule",
                new
                {
                    controller = "AdminController",
                    action = "Schedule"
                }); 
```

网址 2：

```
routes.MapRoute("Schedule", "Schedule",
                new
                {
                    controller = "ScheduleController",
                    action = "Index"
                }); 
```

您没有明确说明您对调度控制器使用了什么操作，因此请随意更改。

# c# - 大数的类型

> ID：599873
> 
> 赞同：7
> 
> 时间：2009-03-01T14:06:33.160
> 
> 标签：c#, math, largenumber

我正在开发一个需要处理大量数字的应用程序。

我检查了一些可用的 LargeNumber 类，并找到了一些我很满意的。我有一个用于大整数和大浮点数的类。

由于一些数字会很小，一些很大，问题是是否值得检查数字的长度，如果它很小，使用常规的 C# int 或 double，如果很大，使用我拥有的其他类，或者如果我我已经在使用 Large Integer 和 Large Float 类，即使是较小的数字，我也应该坚持使用它们。

我的考虑纯粹是性能。我是否会为较小的数字节省足够的数学时间，以便在输入后检查每个数字是值得的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T14:10:14.510

真的很难说 - 取决于你的 3rd 方库:)

最好的办法是使用 System.Diagnostics.StopWatch 类，进行大量不同的计算，对它们进行计时并比较结果，我猜..

[编辑] - 关于基准，我会对您的 largeInt 类型进行一系列基准测试，以对常规 32/64 位数字进行计算，并检查该数字是否适合常规 Int32/Int64 类型（其中他们应该），将它们“向下转换”为这些类型，然后使用这些类型运行相同的计算。从您的问题来看，如果内置类型更快，这听起来像是您将要做的事情。

如果您的应用程序的目标用户比您自己多，请尝试在不同的机器上运行它们（单核、多核、32 位、64 位平台），如果平台似乎对计算时间有很大影响，请使用某种类型策略模式在不同的机器上进行不同的计算。

祝你好运 ：）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T14:17:10.217

我希望一个体面的大数字库能够自己进行这种优化......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-01T14:17:46.877

我会说是的，只要您在常规范围内有足够的价值，支票就会物有所值。

逻辑很简单：整数加法是一条汇编指令。结合对比，就是三四条指令。这种操作的任何软件实现很可能会慢得多。

最佳情况下，应该在 LargeNumber 库本身中完成此检查。如果他们不这样做，您可能需要一个包装器以避免到处检查。但是，您还需要考虑包装器的额外成本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T14:53:27.183

在一个项目中工作，其中相同的字段需要处理非常大的数字，同时处理非常小的数字的精度。
最终将每种此类数字的存储到字段（尾数和指数）中。
我们为尾数/指数计算做了一个类，它表现良好。

# php - 动态包含

> ID：599894
> 
> 赞同：2
> 
> 时间：2009-03-01T14:20:23.003
> 
> 标签：php

```
<?php
// Default page
if (!$_SERVER['QUERY_STRING']) $Page = "news";

// View
elseif (isset($_GET['newsID'])) $Page = "newsView";
elseif (isset($_GET['userID'])) $Page = "profile";
elseif (isset($_GET['messageID'])) $Page = "message";
elseif (isset($_GET['threadID'])) $Page = "thread";
elseif (isset($_GET['forumID'])) $Page = "forum";
elseif (isset($_GET['imgID'])) $Page = "imageView";

// Pages
elseif ($_GET['content'] == "search") $Page = "search";
elseif ($_GET['content'] == "gallery") $Page = "gallery";
elseif ($_GET['content'] == "forums") $Page = "forums";
elseif ($_GET['content'] == "messages") $Page = "messages";
many more...

// If page don't exist
else $Page = "error";

// Output page
include($config['PAGE_PATH'].$Page.'.php');
include($config['TEMPLATE_PATH'].$Page.'.html');
?> 
```

这是我朋友几年前写的一些代码......
我想知道这是多么安全，如果我可以让它更干净一点？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T14:31:59.247

因为是您定义了允许包含哪些页面（*白名单*），所以我看不到任何毒害`$Page`变量的方法。所以这看起来很安全。

但是您可以使用以下数组对其进行清理：

```
$argToPage = array(
    'newsID'    => 'newsView',
    'userID'    => 'profile',
    'messageID' => 'message',
    'threadID'  => 'thread',
    'forumID'   => 'forum',
    'imgID'     => 'imageView'
);
$contents = array(
    'search',
    'gallery',
    'forums',
    'messages'
);

$Page = null;
if (trim($_SERVER['QUERY_STRING']) == '') {
    $Page = 'news';
} else {
    foreach ($_GET as $key => $val) {
        if (isset($argToPage[$key])) {
            $Page = $argToPage[$key];
            break;
        }
    }
}
if (is_null($Page) && isset($_GET['content']) && in_array($_GET['content'], $contents)) {
    $Page = $contents[$_GET['content']];
} else {
    $Page = 'error';
} 
```

但这并没有更清洁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T14:23:51.043

好吧，从代码清理参数的意义上说，它是安全的。人们经常这样做（通常会导致灾难性的结果）。

然而，我不是这种模式的忠实粉丝。我的意思是一个包含通过参数传递的文件的单个控制器。我更喜欢每页有一个脚本，只包含需要的内容。从结构上来说，我认为它更好。

话虽如此，上述方法没有根本性的错误。

只要确保您以极端偏执的态度对待来自用户的任何数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T14:25:43.240

我会非常谨慎地清理它。在 an 中使用用户输入提供的变量`include`是一个主要的安全漏洞。我会保持原样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T14:27:57.570

您可以使用 GET 选项作为键和页面作为值创建一个数组。然后使用 switch() 语句。这应该使代码更干净。但正如 Cletus 所说，这不是制作控制器的最佳方式。

# javascript - 你用什么来最小化和压缩 JavaScript 库？

> ID：599911
> 
> 赞同：54
> 
> 时间：2009-03-01T14:37:02.057
> 
> 标签：javascript, compression, minimize, jscompress

你用什么来最小化和压缩 JavaScript 库？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2010-09-21T13:46:10.390

我已经使用[YUI Compressor](https://github.com/yui/yuicompressor)很长时间了，并且没有遇到任何问题，但最近开始使用[Google Closure Compiler](http://code.google.com/closure/compiler/)并取得了一些成功。到目前为止我对它的印象：

*   在减少文件大小方面，它通常优于 YUI Compressor。简单模式下少量，高级模式下大量。
*   迄今为止，简单模式与 YUI Compressor 一样可靠。我喂它的任何东西都没有显示出任何问题。
*   高级“编译”模式非常适合某些脚本，但脚本的显着减小是以大量干预代码为代价的，而代码的破坏机会很大。有一些[方法可以处理其中一些问题](http://code.google.com/closure/compiler/docs/api-tutorial3.html)，了解它在做什么可以大大避免问题，但我通常避免使用这种模式。

我已经转而在简单的“编译”模式下使用 Google Closure Compiler，因为它总体上略胜于 YUI Compressor。我使用它的次数比我使用的 YUI Compressor 少得多，但从我目前看到的情况来看，我会推荐它。

我尚未尝试但听起来很有希望的另一个是[Mihai Bazon 的 UglifyJS](http://github.com/mishoo/UglifyJS)。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-03-01T14:40:02.800

我使用[YUI 压缩机](https://github.com/yui/yuicompressor)。看来工作做得很好！

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2010-09-25T14:23:36.933

您在这里有很多可能性：

*   其他答案提到的[YUI Compressor ，](https://github.com/yui/yuicompressor)
*   谷[歌闭包编译器](http://code.google.com/closure/compiler/)，
*   [他们的构建](http://docs.dojocampus.org/build/index)[系统](http://docs.dojocampus.org/quickstart/custom-builds)使用的[Dojo ToolKit](http://www.dojotoolkit.org/)的 ShrinkSafe 编译器，
*   [Douglas Crockford](http://www.crockford.com/)仍然是真正的[JSMin](http://www.crockford.com/javascript/jsmin.html)，
*   别人提到的[UglifyJS ，](http://github.com/mishoo/UglifyJS)
*   还有一个商业解决方案，[javaScript Obfuscator](http://java-applets.org/jsmin-vs-yui-compressor.html)（个人从未使用过）

根据我的个人经验，我建议您使用 Dojo SDK 构建自定义构建，然后您可以将其配置为使用他们常用的 ShrinkSafe 编译器或 Google Closure，[它们现在也支持](http://docs.dojocampus.org/build/index#using-google-s-closure-compiler)。

在压缩方面，我认为 Google Closure 是迄今为止对我来说效果最好的一个，但我通常对 ShrinkSafe 感到满意，而且它更老、更健壮，而 Closure Compiler 看起来有点像新手（例如，您的利益相关者可能不太喜欢）。

不过，有些人只对 YUI Compressor 发誓。我个人不能真正保证它。

现在，如果您的问题是压缩*库*而不仅仅是您自己的 JavaScript 代码，那么它显然会涉及更多，因为您将需要大多数这些工具来导出不应重命名或剥离的符号。大多数体面的压缩器会删除他们认为未使用的功能 - 通常是库中的情况，如果没有绑定到项目，显然 - 并更改名称以使其更短并使用更少的字符 - 这也是一个问题，因为你显然想要一个公共API 不可篡改。

您也可以找到有关此主题的其他主题，并在工具的支持文档中找到信息。您可能还想看看[JSBuilder2](http://www.sencha.com/products/jsbuilder/)，它是 Dojo 的 Build 工具（使用 ShrinkSafe 或 Closure Compiler）的某种附属品，用于 ExtJS（使用 YUI 压缩器）。

（对不起，作为一个新的 SO 用户，我不能添加多个链接，所以我不能直接链接到工具。）

编辑：关于一些答案中表达的担忧，即压缩可能会引入错误，并且由于代码没有被破坏，它使调试更容易：是的，这是一个有效的担忧。然而：

*   如果您使用压缩器，即使激活了 gzip 压缩，您也会在带宽方面获得非常显着的改进（并且您可以通过使压缩器的工作更轻松来学习利用 gzip 压缩
*   您应该在调试和生产模式下品尝您的代码，以确保行为相同。我的意思是，这也是你工作的一部分……
*   其中一些压缩器已经存在了一段时间，并且不会真正将错误引入您的代码。他们实际上只是重新组织事物并替换字符串，真的。
*   一些压缩器（例如 dojo 构建系统）带有允许您生成压缩和未压缩输出的选项，这样您就可以启用不同的调试和生产模式，例如使用查询参数。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-01T16:19:36.303

我根本没有最小化 JavaScript：gzip 压缩对我来说已经足够好了，并且还有一个额外的好处是错误消息仍然有用。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-03-01T16:19:23.903

我也使用 YUI Compressor。我在我的项目中使用了这样的 ant 任务：

```
<!--
YUI Compressor tasks 
http://www.julienlecomte.net/yuicompressor/README
-->
<property name="yuicompressor.jar"
           value="C:/devlibs/yuicompressor-2.2.4/build/yuicompressor-2.2.4.jar"/>

<target name="js.compress">
    <!-- Create min directory under js direcrtory if it doesnt exist -->
    <mkdir dir="${js-directory}/min" />

    <apply verbose="true" executable="java" parallel="false" failonerror="true">
        <fileset dir="${js-directory}" includes="*.js"/>
        <arg line="-jar"/>
        <arg path="${yuicompressor.jar}"/>
        <srcfile/>
        <arg line="-o"/>
        <mapper type="glob" from="*.js" to="${js-directory}/min/*-min.js"/>
        <targetfile/>
    </apply>
</target> 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-01T14:51:25.987

[Dean Edward 的封隔器](http://dean.edwards.name/packer/)实现了一些相当不错的压缩比。它具有命令行实现，可以在持续集成过程中使用。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-09-22T00:20:16.980

**UglifyJS**是一个新的。

> UglifyJS 比 YUI Compressor 压缩得更好，与 Google Closure Compiler 差不多。例如，来自 Google Closure Compiler 的 jQuery 压缩版本仅比 UglifyJS 生成的版本小 403 个字节——令人印象深刻！UglifyJS 也是跑得最快的远投，以超过 6 秒的优势击败了 Closure！
> 
> 此外，UglifyJS 生成的代码比 Closure 生成的代码更安全。例如，Closure 不知道如何处理 eval 或 {} - 它只是记录一个错误并继续重命名变量。显然，这会导致代码损坏。UglifyJS 没有这个问题。

更多信息可以在这里找到：http: [//badassjs.com/post/971960912/uglifyjs-a-fast-new-javascript-compressor-for-node-js](http://badassjs.com/post/971960912/uglifyjs-a-fast-new-javascript-compressor-for-node-js)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-09-23T20:18:36.947

谷歌的[关闭](http://googlecode.blogspot.com/2009/11/introducing-closure-tools.html)工具

您可以将缩小版本映射到常规源代码，以便在 Firebug 中使用其附加组件进行调试。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-01T16:19:01.033

我以前尝试过 YUI 压缩器，但它给了我错误消息。

我建议使用 JSMIN 来缩小你的 javascript：

[http://www.crockford.com/javascript/jsmin.html](http://www.crockford.com/javascript/jsmin.html)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-09-27T13:36:42.080

这是 Microsoft 的一个解决方案，您可以将其集成到 Visual Studio 中，以便在构建项目时自动缩小文件。

**安装：**

从以下位置下载 msi：[http ://aspnet.codeplex.com/releases/view/40584](http://aspnet.codeplex.com/releases/view/40584)

完成后您可能需要重新启动计算机。

**使用：**

编辑您的 .csproj 文件并在文件末尾（但在`</Project>`标记之前）包含以下内容：

```
<Import Project="$(MSBuildExtensionsPath)\Microsoft\MicrosoftAjax\ajaxmin.tasks" />

<Target Name="AfterBuild">
    <ItemGroup>
        <JS Include="**\*.js" Exclude="**\*.min.js;Scripts\*.js" />
        <CSS Include="**\*.css" Exclude="**\*.min.css" />
    </ItemGroup>
    <AjaxMin 
    JsSourceFiles="@(JS)"
    JsSourceExtensionPattern="\.js$"
    JsTargetExtension=".min.js"
    CssSourceFiles="@(CSS)"
    CssSourceExtensionPattern="\.css$"
    CssTargetExtension=".min.css"/>
</Target> 
```

现在，当您构建项目时，所有不以 .min.js、.min.css 结尾的 CSS 和 js 文件都将被缩小（请参阅“排除”属性以排除其他文件被缩小）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-09-21T13:49:29.287

[http://code.google.com/p/jsmin-php/](http://code.google.com/p/jsmin-php/)

好老道格·克罗克福德 :-) 这样做的美妙之处在于，通过缓存控制，您可以仅在需要时获得一些可爱的自动压缩。或者在我的一个项目中，我只是输出压缩/gzip 压缩的文件，并在我进行更改时删除它们。对于开发环境，我只是不调用缩小脚本。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-01T15:39:07.680

[我在JavaScript::Minifier::XS](http://search.cpan.org/~gtermars/JavaScript-Minifier-XS-0.05/lib/JavaScript/Minifier/XS.pm)周围使用了一个简单的（3-4 行）包装脚本。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-09-21T10:43:42.827

这是一篇描述如何在构建过程中使用 YUI Compressor 来最小化文件的文章：[Compressing JS files as part of your build process](http://codebetter.com/blogs/karlseguin/archive/2008/12/29/compressing-js-files-as-part-of-your-build-process.aspx)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-09-21T13:50:18.197

我使用 perl 的 JavaScript::Minifier。它工作得很好，您可以使用 perl 替换一些短语。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-09-25T01:17:22.557

[http://caja.appspot.com/tools/index](http://caja.appspot.com/tools/index)完成所有三个 HTML/CSS/JS。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-09-27T14:34:16.410

[https://jawr.dev.java.net/](https://jawr.dev.java.net/)非常适合缩小和版本控制

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-09-28T07:45:46.343

有一个非常好的在线压缩器：

[http://javascriptcompressor.com/](http://javascriptcompressor.com/)

如果你想要更多的压缩，你也可以缩小变量。

希望能帮助到你

# javascript - 您在哪个阶段压缩/最小化 javascript？

> ID：599912
> 
> 赞同：2
> 
> 时间：2009-03-01T14:38:11.417
> 
> 标签：javascript, jscompress

当用户请求页面时，或“即时”（可能使用缓存）构建时。

以及每个的缺点/优点是什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-01T14:41:27.350

当站点从开发移动到实时服务器时。

我总是在开发服务器上有一个未压缩的 JS 版本，在实时服务器上有一个最小化的版本。

这样做的好处是在开发时我可能会遇到 JS 问题并非常简单地修复它，但我需要通过最小化程序运行每个更改的脚本，但对我来说并没有那么多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T14:41:39.800

在构建或部署到舞台环境时，是压缩 javascript 的好时机。这样，您将有机会在舞台环境中对其进行测试并捕获可能发生的任何错误。

有时，压缩时确实会出现错误。您可能希望包含在压缩之前运行的 jslint 命令行版本，以确保 js 通过。这将最小化但不会消除所有压缩错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-01T14:42:14.433

我想除非您将动态数据添加到 JavaScript（在这种情况下有更好的方法），否则即时运行将是不必要的。IT 只是一项不必要的支出，只会减慢页面加载速度。

就个人而言，我会在部署/构建应用程序时这样做，这真的是一次性的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-01T14:48:04.450

我会说你有 js 文件，因为你在源代码控制中对它们进行编码，当你启动自动构建时，作为构建脚本的一部分，它通过压缩器运行所有 javascript 文件。这样，当您将其部署到测试/暂存环境时，您将获得最新的脚本，但也为性能测试进行了压缩，一旦它们投入生产，它们就会如此。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-01T14:49:41.560

我同意，如果 JS 没有改变，那么动态可能不是真的必要（并且会占用一些 cpu 周期）。

可能会涉及一些中间件，但它们可以检查 JS 是否已更改并仅在请求时对其进行压缩（甚至可能将各种 JS 文件组合成一个结果文件）。

部署时的一件好事也可能是添加一些时间戳或随机字符串作为参数到 JS 链接（例如`.../scripts.js?t=cdkjnsccsds7sc8cshcsjhbcs`）。这样，当 JS 更改时，您将使用不同的字符串，并且不会出现缓存问题，因为它是一个新 URL。CSS 也一样。

# .net - Microsoft Expression Web 2 编程 VS studio 2005/2008 体验

> ID：599915
> 
> 赞同：1
> 
> 时间：2009-03-01T14:40:39.303
> 
> 标签：.net, asp.net, user-interface, microsoft-expression-web

一段时间以来一直在使用 VS studio 2005/2008 编写 ASP.NET 应用程序。
我对[Microsoft Expression Web 2](http://www.microsoft.com/expression/products/Overview.aspx?key=web#page-top)的体验感兴趣（优点和缺点）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T14:52:33.440

我有一些设计师朋友是 Expression 套件的忠实粉丝。作为一个代码猴子，它不是我自己的*常规*工具包的一部分。

然而; 请注意，大多数网页设计工具（可能包括 Expression Web）*往往*很难与常规 ASP.NET 配对，这仅仅是因为您无法完全控制 HTML。如果您要查看诸如 Expression Web 之类的内容以获取设计器输入，我是否建议您查看[ASP.NET MVC](http://www.asp.net/mvc/)，因为这使您可以更直接地控制最终的 HTML - 几乎可以让您将设计器的 html 放入您的“视图”，然后开始添加数据元素。

*看起来*该工具试图与（常规）ASP.NET 很好地配合，但是一旦您开始添加*真正的*ASP.NET 代码，它的表现可能会有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-26T02:40:50.457

我对 Expression Web 3 非常失望。

我尝试用它来快速制作 HTML+CSS 原型，希望它在任务上会比 VS 好很多，但体验非常相似（差）。

很遗憾，您在编辑 CSS 时无法预览任何页面。

# java - Java Authenticator 基于每个连接？

> ID：599929
> 
> 赞同：16
> 
> 时间：2009-03-01T14:52:29.570
> 
> 标签：java, httpurlconnection, authenticator

我正在构建一个与使用基本身份验证的 REST 接口通信的 Eclipse 插件。当身份验证失败时，我想弹出插件的设置对话框并重试。通常我可以使用 static`Authenticator.setDefault()`为此设置 all 的身份验证器`HttpURLConnection`，但是由于我正在编写插件，因此我不想覆盖 Eclipse 的默认值`Authenticator`（`org.eclipse.ui.internal.net.auth`）；

我想`Authenticator`在加载之前设置我的自定义并在之后将 Eclipse 的默认设置放回原处，但我想这会导致多线程的各种竞争问题，所以我很快就失去了这个想法。

谷歌搜索产生各种结果，基本上告诉我这是不可能的：

> Java URLConnection API 应该有一个 setAuthenticator(Authenticator) 方法，以便在需要身份验证的多线程上下文中更轻松地使用此类。

[来源](http://blog.taragana.com/index.php/archive/java-tip-basic-authentication-with-httpurlconnection/)

> 如果应用程序包含很少的第三方插件，并且每个插件都使用自己的 Authenticator，我们应该怎么做？每次调用“Authenticator.setDefault()”方法都会重写之前定义的 Authenticator...

[来源](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4941958)

是否有任何不同的方法可以帮助我克服这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-01T16:19:01.937

如果 HttpURLConnection 不可能，我建议使用 Apache 的[httpclient](http://hc.apache.org/httpclient-3.x/)库。

一个简单的例子：

```
HttpClient client = new HttpClient();
client.getState().setCredentials(AuthScope.ANY, new UsernamePasswordCredentials("test","test"));
GetMethod getMethod = new GetMethod("http://www.example.com/mylogin");
client.executeMethod(getMethod);
System.out.println(getMethod.getResponseBodyAsString()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T14:51:23.920

另一种方法是自己在连接上执行基本身份验证。

```
 final byte[] encodedBytes = Base64.encodeData((username + ':' + new String(password)).getBytes("iso-8859-1"));
    final String encoded = new String(encodedBytes, "iso-8859-1");

    connection.setRequestProperty("Authorization", "Basic " + encoded); 
```

This would also have the advantage of not requiring an unauthenticated request to receive a 401 before providing the credential on a subsequent request. Similar behavior can be leveraged in the apache http-client by requesting preemptive authentication.

# windows - 如何运行多个 SVN 服务

> ID：599936
> 
> 赞同：1
> 
> 时间：2009-03-01T14:59:46.310
> 
> 标签：windows, svn, windows-services, administration

在阅读[了在 Windows 上设置 Subversion 之后，](https://blog.codinghorror.com/setting-up-subversion-on-windows/)我试图弄清楚如何在一台机器上运行多个 SVN 服务。当我使用创建多个服务时

```
sc create svnP1 ... binpath= "svnserve.exe --service -r c:\svn\repositories\project1" 
sc create svnP2 ... binpath= "svnserve.exe --service -r c:\svn\repositories\project2" 
```

作为模板（实际命令被截断），两个服务都在同一个端口上侦听并使用 svn://servername/project2 转到 project1

那么我该怎么做呢，还是我走错了路？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-01T15:16:14.773

我不确定您为什么需要单独的服务。一项服务可以处理多个存储库。

我想你想要的是：

```
sc create svn ... binpath= "svnserve.exe --service -r c:\svn\repositories" 
```

然后将 project1 和 project2 创建为单独的存储库：

```
 svnadmin create c:\svn\repositories\project1
svnadmin create c:\svn\repositories\project2 
```

这将创建两个独立的存储库，可以分别为用户和挂钩脚本进行配置。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-01T15:03:40.043

有点切线，但我只使用[VisualSVN Server](http://www.visualsvn.com/server/)。它是免费的，*非常*容易设置（“下一个”、“下一个”...），并带有一个 MMC 管理单元来完成所有的管理工作。这使得在多个存储库上工作变得轻而易举，而不必每次都添加额外的服务。

（注意；他们向客户端收费，但您可以使用**任何**SVN 客户端与之交谈；我喜欢[TortoiseSVN](http://tortoisesvn.tigris.org/)，但无论您喜欢什么...）

此外，在底层，它使用 Apache 公开数据，提供 HTTPS 以确保安全，并允许通过防火墙友好端口使用互联网。

最后，它甚至允许选择“常规”用户名/密码对，或与您的网络（域等）凭据集成。很光滑。

# c# - 将数据表的单行绑定到 C# asp.net 中的详细信息视图的最简单方法是什么？

> ID：599937
> 
> 赞同：4
> 
> 时间：2009-03-01T15:00:00.707
> 
> 标签：c#, asp.net

我目前将该行复制到一个空数据表并绑定那个，但肯定有更好的方法......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-01T15:25:06.607

您不需要绑定数据表 - 您只需要类似列表/可枚举的东西。例如，如果您知道行号：

```
DataRowView row = dt.DefaultView[1]; // second row
detailsView1.DataSource = new DataRowView[] {row};
detailsView1.DataBind(); 
```

请注意，我们必须使用`DataRowView`( 而不是`DataRow`) 来获取仅限运行时的属性（即列中的数据）。如果你有`DataRow`，这种方法可以很容易地被包装在一个实用方法中，例如一个扩展方法：

```
public static DataRowView[] ForBinding(this DataRow row)
{
    foreach (DataRowView rowView in row.Table.DefaultView)
    {
        if (ReferenceEquals(rowView.Row, row))
        {
            return new DataRowView[] { rowView };
        }
    }
    throw new ArgumentException("Row not found in the default view", "row");
} 
```

和：

```
detailsView1.DataSource = row.ForBinding();
detailsView1.DataBind(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T15:03:39.780

是的，这是最简单的方法:)

恕我直言，如果您只想显示 1 个字段，则可以使用输出参数，但如果您在详细信息视图中显示多个字段，这是最简单的方法。

# java - 对国际 SMS 的 Java 库的建议

> ID：599941
> 
> 赞同：0
> 
> 时间：2009-03-01T15:07:16.587
> 
> 标签：java, sms, sms-gateway, netbeans-plugins

我想做一个可以向另一个国家的人发送短信的应用程序。

我听说使用国际短信网关是最好的方法，而且很便宜（甚至可能免费）。

实现这一目标的最佳库是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T15:22:44.727

有几个选项：

1) 使用 java 库，例如[smslib](http://smslib.org/)，它允许与手机调制解调器直接通信以发送或接收消息。

[2) 向Clickatell](http://www.clickatell.com/)或[csoft](http://www.csoft.co.uk/)等 SMS 网关提供商之一注册并使用他们提供的 API。我将从查看 HTTP api [here](http://www.clickatell.com/developers/api_http.php)和[here 开始](http://www.csoft.co.uk/sms/api/http_to_sms.htm)。

许多类似的先前问题已涵盖此主题：

[程序化 SMS](https://stackoverflow.com/questions/4269/programmatic-sms)
[如何实施 SMS 服务？](https://stackoverflow.com/questions/414047/how-do-i-implement-an-sms-service)
[发送短信](https://stackoverflow.com/questions/548911/sending-sms)

# xaml - Expression Blend 是否有修剪/裁剪的概念？

> ID：599951
> 
> 赞同：3
> 
> 时间：2009-03-01T15:17:31.460
> 
> 标签：xaml, expression-blend

我正在将左侧的图形重建为 Expression Blend 中的右侧图形。

渐变画笔非常适合创建反射效果，但我现在如何修剪右侧的按钮，以便它切断反射圈的其余部分？

我可以**旋转、缩放、倾斜、重新定位和翻转，**但找不到修剪或裁剪。

当我同时选择顶部和底部进行“**组合/相交**”时，当我选择“组合”时，所有选项都显示为灰色。

是否可以在 Expression Blend 中修整我想要的方式，或者我达到了底层 XAML 可以表示的限制？

或者有没有更简单的方法来实现左边的图形？

[替代文字 http://tanguay.info/web/external/trimInBlend.png](http://tanguay.info/web/external/trimInBlend.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T16:42:50.280

您是否尝试过使用剪切路径？

[http://blogs.msdn.com/expression/archive/2008/01/21/clip-path-editing-and-animating-in-blend-2.aspx](http://blogs.msdn.com/expression/archive/2008/01/21/clip-path-editing-and-animating-in-blend-2.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T22:07:16.617

我会在右侧的图形上应用渐变并使其淡化为透明。这样，就不需要裁剪任何东西。

# python - 如何删除字符串的左侧部分？

> ID：599953
> 
> 赞同：162
> 
> 时间：2009-03-01T15:19:38.337
> 
> 标签：python, string

我有一些简单的 python 代码可以搜索文件中的字符串，例如`path=c:\path`，其中`c:\path`部分可能会有所不同。当前代码是：

```
def find_path(i_file):
    lines = open(i_file).readlines()
    for line in lines:
        if line.startswith("Path="):
            return # what to do here in order to get line content after "Path=" ? 
```

获取文本的简单方法是什么`Path=`？

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2009-03-01T15:26:56.820

如果字符串是固定的，您可以简单地使用：

```
if line.startswith("Path="):
    return line[5:] 
```

它为您提供了字符串中从位置 5 开始的所有内容（字符串也是一个序列，因此这些序列运算符也可以在这里工作）。

或者您可以在第一行拆分行`=`：

```
if "=" in line:
    param, value = line.split("=",1) 
```

然后参数是“路径”，值是第一个 = 之后的其余部分。

* * *

## 回答 #2

> 赞同：130
> 
> 时间：2009-03-01T18:03:24.403

### 从字符串中删除前缀

```
# ...
if line.startswith(prefix):
   return line[len(prefix):] 
```

### 在第一次出现分隔符时通过`str.partition()`

```
def findvar(filename, varname="Path", sep="=") :
    for line in open(filename):
        if line.startswith(varname + sep):
           head, sep_, tail = line.partition(sep) # instead of `str.split()`
           assert head == varname
           assert sep_ == sep
           return tail 
```

### [使用ConfigParser](http://docs.python.org/library/configparser.html)解析类似 INI 的文件

```
from ConfigParser import SafeConfigParser
config = SafeConfigParser()
config.read(filename) # requires section headers to be present

path = config.get(section, 'path', raw=1) # case-insensitive, no interpolation 
```

### 其他选项

*   [`str.split()`](https://stackoverflow.com/questions/599953/how-to-remove-left-part-of-a-string-in-python/599962#599962)
*   [`re.match()`](https://stackoverflow.com/questions/599953/how-to-remove-left-part-of-a-string-in-python/600002#600002)

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2020-04-25T21:01:56.963

从 开始`Python 3.9`，您可以使用[`removeprefix`](https://docs.python.org/3/library/stdtypes.html#str.removeprefix)：

```
'Path=helloworld'.removeprefix('Path=')
# 'helloworld' 
```

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2011-09-16T04:59:30.863

任何 Python 版本：

```
def remove_prefix(text, prefix):
    return text[len(prefix):] if text.startswith(prefix) else text 
```

Python 3.9+

```
text.removeprefix(prefix) 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2009-03-01T15:43:50.633

一般来说，对于切片（条件或非条件），我更喜欢同事最近提出的建议；使用空字符串替换。更容易阅读代码，更少的代码（有时）和更少的指定错误字符数的风险。行; 我不使用 Python，但在其他语言中我更喜欢这种方法：

```
rightmost = full_path.replace('Path=', '', 1) 
```

或 - 跟进这篇文章的第一条评论 - 如果只有在*该行以以下开头*时才应该这样做`Path`：

```
rightmost = re.compile('^Path=').sub('', full_path) 
```

与上面一些建议的主要区别在于没有“幻数”（5），也不需要同时指定' `5`'*和*字符串' `Path=`'，换句话说，我更喜欢代码维护的这种方法观点看法。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2011-03-13T23:58:33.847

我更喜欢`pop`索引`[-1]`：

```
value = line.split("Path=", 1).pop() 
```

到

```
value = line.split("Path=", 1)[1]
param, value = line.split("Path=", 1) 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2013-09-29T22:03:51.017

或者为什么不

```
if line.startswith(prefix):
    return line.replace(prefix, '', 1) 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-03-01T15:25:16.530

我能想到的最简单的方法是切片：

```
def find_path(i_file): 
    lines = open(i_file).readlines() 
    for line in lines: 
        if line.startswith("Path=") : 
            return line[5:] 
```

关于切片符号的快速说明，它使用两个索引而不是通常的索引。第一个索引表示要包含在*切片*中的序列的第一个元素，最后一个索引是紧接在要包含在切片中的最后一个元素之后的索引。
**例如：**

```
sequence_obj[first_index:last_index] 
```

切片由`first_index`and之间的所有元素组成`last_index`，包括`first_index`and not `last_index`。如果省略第一个索引，则默认为序列的开头。如果省略最后一个索引，则它包括序列中最后一个元素之前的所有元素。也允许使用负索引。使用 Google 了解有关该主题的更多信息。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-03-01T15:57:15.890

```
>>> import re

>>> p = re.compile(r'path=(.*)', re.IGNORECASE)

>>> path = "path=c:\path"

>>> re.match(p, path).group(1)
'c:\\path' 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-11-12T12:45:27.957

怎么样..

```
>>> line = r'path=c:\path'
>>> line.partition('path=')
('', 'path=', 'c:\\path') 
```

这个三元组是[head、separator 和 tail](https://docs.python.org/3.7/library/stdtypes.html#str.partition)。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-02-01T16:51:40.443

此处未提及的另一个简单的单线：

```
value = line.split("Path=", 1)[-1] 
```

这也适用于各种边缘情况：

```
>>> print("prefixfoobar".split("foo", 1)[-1])
"bar"

>>> print("foofoobar".split("foo", 1)[-1])
"foobar"

>>> print("foobar".split("foo", 1)[-1])
"bar"

>>> print("bar".split("foo", 1)[-1])
"bar"

>>> print("".split("foo", 1)[-1])
"" 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-03-01T15:25:58.413

```
line[5:] 
```

在前五个之后给你字符。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-10-17T08:45:26.660

`removeprefix()`由于与传递给它们的参数相关的问题和解释，**Python 3.9**`removesuffix()` 中添加了字符串方法。阅读[PEP 616](https://www.python.org/dev/peps/pep-0616/)了解更多详情。**`lstrip``rstrip`**

 **```
# in python 3.9
>>> s = 'python_390a6'

# apply removeprefix()
>>> s.removeprefix('python_')
'390a6'

# apply removesuffix()
>>> s = 'python.exe'
>>> s.removesuffix('.exe')
'python'

# in python 3.8 or before
>>> s = 'python_390a6'
>>> s.lstrip('python_')
'390a6'

>>> s = 'python.exe'
>>> s.rstrip('.exe')
'python' 
```

`removesuffix`带有列表的示例：

```
plurals = ['cars', 'phones', 'stars', 'books']
suffix = 's'

for plural in plurals:
    print(plural.removesuffix(suffix)) 
```

输出：

```
car
phone
star
book 
```

`removeprefix`带有列表的示例：

```
places = ['New York', 'New Zealand', 'New Delhi', 'New Now']

shortened = [place.removeprefix('New ') for place in places]
print(shortened) 
```

输出：

```
['York', 'Zealand', 'Delhi', 'Now'] 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-03-01T15:26:31.813

`line[5:]`将给出你想要的子字符串。搜索[介绍](http://docs.python.org/tutorial/introduction.html)并查找“切片符号”

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-03-01T22:11:56.067

如果你知道列表推导：

```
lines = [line[5:] for line in file.readlines() if line[:5] == "Path="] 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-03-12T21:58:19.997

为什么不使用带有转义的正则表达式？ `^`匹配一行的开头部分并`re.MULTILINE`匹配每一行。`re.escape`确保匹配准确。

```
>>> print(re.sub('^' + re.escape('path='), repl='', string='path=c:\path\nd:\path2', flags=re.MULTILINE))
c:\path
d:\path2 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-06-12T14:59:08.497

尝试以下代码

```
if line.startswith("Path="): return line[5:] 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2013-12-03T10:27:15.097

我想这就是你正在寻找的

```
 def findPath(i_file) :
        lines = open( i_file ).readlines()
        for line in lines :
            if line.startswith( "Path=" ):
                output_line=line[(line.find("Path=")+len("Path=")):]
                return output_line 
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2015-01-09T06:50:12.850

流行版本不太对劲。我想你想要：

```
>>> print('foofoobar'.split('foo', 1).pop())
foobar 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2021-01-08T15:50:47.930

可以试试下面的方法。

```
def remove_suffix(string1, suffix):
    length = len(suffix)

    if string1[0:length] == suffix:
        return string1[length:]
    else:
        return string1

suffix = "hello"
string1 = "hello world"

final_string = remove_suffix(string1, suffix)
print (final_string) 
```

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2017-10-20T23:25:44.843

无需编写函数，这将根据列表进行拆分，在本例中为“先生|博士|夫人”，使用 [1] 选择拆分后的所有内容，然后再次拆分并获取任何元素。在下面的例子中，'Morris' 被返回。

```
re.split('Mr.|Dr.|Mrs.', 'Mr. Morgan Morris')[1].split()[1] 
```

* * *

## 回答 #22

> 赞同：-2
> 
> 时间：2019-06-12T13:13:06.503

这在技术上与其他答案非常相似，但没有重复的字符串操作，能够判断前缀是否存在，并且仍然非常可读：

```
parts = the_string.split(prefix_to_remove, 1):
    if len(parts) == 2:
        #  do things with parts[1]
        pass 
```

# c# - 索引器的扩展方法，它们会好吗？

> ID：599965
> 
> 赞同：24
> 
> 时间：2009-03-01T15:36:56.733
> 
> 标签：c#, methods, data-access-layer, indexer

索引器的扩展方法，它们会好吗？

我正在玩一些重新水合 POCO 的代码。

代码围绕从 SqlDataReader 返回的行进行迭代，并使用反射从列值中分配属性。在我的调用堆栈中，我有一个这样的代码：-

```
poco.Set("Surname", "Smith"); // uses extension method ... 
```

Set 方法被编写为扩展方法。

能写出这样的代码就好了

```
poco["Surname"] = "Smith";  // extension methods for indexers ? 
```

即我想为索引器写一个扩展方法

.Net 没有索引器的扩展方法有充分的理由吗？其他人对扩展方法索引器有其他好的用途吗？

顺便说一句……如果我们可以为索引器编写扩展方法，那么我们可以编写这样的代码……</p>

```
var poco = PocoFactory();  
    poco.Surname = “Smith”; // is this JavaScript ...
    poco[Surname] = “Smith” ; // … or is this c# or both 
```

我的代码中的一些片段

```
/////////////////////////////////////////////
// Client calling code
IDab dab = DabFactory.Create( "Northwind" );
string sql = @"select * from Customers ";
var persons = dab.ExecuteReader<NorthwindCustomer>(sql);
if (dab != null{
   Assert.That(persons[0].CustomerID , Is.EqualTo("ALFKI"));}
/////////////////////////////////////////////
List<T> IDab.ExecuteReader<T>(string commandText) 
{
    List<T> pocos = new List<T>();
    // setup connection
    SqlDataReader reader = command.ExecuteReader(CommandBehavior.CloseConnection);
    while (reader.Read())
    {
            Dictionary<string, int> colMappings = null ;
            if (colMappings == null){
                colMappings = reader.GetSqlDataReaderColumnMappings();}
            T poco = new T();
            poco.DbToMem<T>(reader, colMappings);
            pocos.Add(poco);
        }
    }
    // connection cleanup ...
    return pocos ;
}

// the set extension method signature
public static void Set<T>(this T thisClientObject, string thisPropertyName, object newValue) where T : class 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-01T15:50:44.610

索引器与属性有很多共同点（实际上，索引器*是*具有索引的属性），并且不存在扩展属性。同意，在某些情况下它们很方便。

重新呈现的场景 - 在某些方面，这很像`dynamic`。当然，如果你声明一个带有字符串索引器的接口*，*那么你的阅读器代码可以直接使用它——但是重复实现这个接口将是*很多不必要的工作！*

重新扩展方法；这使用常规反射吗？你可能想看看像这样的技巧[`HyperDescriptor`](http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx)，如果你做很多这样的事情，它可能会节省大量的 CPU 时间。典型的用法是：

```
PropertyDescriptorCollection props = TypeDescriptor.GetProperties(typeof(T));
while (reader.Read())
{
     T poco = new T();
     // abbreviated...
     (per prop)
        props[propName].SetValue(poco, cellValue);
} 
```

您可以通过首先查看返回的列（每个网格一次，而不是每行一次）来进一步优化这一点，并且只访问匹配的列......

或者，查看 ORM 工具；`Expression`也可用于读取数据（我在 usenet 的某处有一个完整的示例，用于 DbLinq）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-12-20T14:05:19.797

为了给 Pocos 补水，我建议看一下 AutoMapper Nuget 包。它使得非常简单并且大大减少了代码量。

# assembly - 直接读取程序计数器

> ID：599968
> 
> 赞同：33
> 
> 时间：2009-03-01T15:38:54.280
> 
> 标签：assembly, x86, program-counter

可以在内核模式或其他模式下直接读取 Intel CPU 上的程序计数器（即没有“技巧”）吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-03-01T15:45:01.800

不，EIP / IP 不能直接访问，但在依赖位置的代码中，它是一个链接时间常数，因此您可以使用附近（或远处）符号作为立即数。

```
 mov eax, nearby_label    ; in position-dependent code
nearby_label: 
```

* * *

获取与位置无关的 32 位代码的 EIP 或 IP：

```
 call _here
_here:  pop eax
; eax now holds the PC. 
```

在比 Pentium Pro（或 PIII 可能）更新的 CPU 上，[`call rel32`rel32=0 是特殊情况，不会影响返回地址预测器堆栈](http://blog.stuffedcow.net/2018/04/ras-microbenchmarks/#call0)。因此，这在现代 x86 上既高效又紧凑，并且是 clang 用于 32 位位置无关代码的方法。

在旧的 32 位 Pentium Pro CPU 上，这会使调用/返回预测器堆栈失衡，因此更喜欢调用一个确实返回的函数，以避免对`ret`父函数中多达 15 条左右的未来指令进行分支错误预测。（除非您不打算返回，或者很少返回无关紧要。）但是，返回地址预测器堆栈将恢复。

```
get_retaddr_ppro:
    mov  eax, [esp]
    ret                ; keeps the return-address predictor stack balanced
                       ; even on CPUs where  call +0 isn't a no-op. 
```

* * *

**在 x86-64 模式下，可以使用 RIP-relative 直接读取 RIP`lea`**。

```
default rel           ; NASM directive: use RIP-relative by default

lea  rax, [_here]     ; RIP + 0
_here: 
```

MASM 或 GNU `.intel_syntax`：`lea rax, [rip]`

AT&T 语法： `lea 0(%rip), %rax`

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-01T16:18:42.157

如果您需要特定指令的地址，通常这样的方法可以解决问题：

```
thisone: 
   mov (e)ax,thisone 
```

（注意：在某些汇编器上，这可能会做错事并从 [thisone] 读取一个单词，但通常有一些语法可以让汇编器做正确的事情。）

如果您的代码静态加载到特定地址，则汇编器已经知道（如果您告诉它正确的起始地址）所有指令的绝对地址。动态加载的代码，比如作为任何现代操作系统上的应用程序的一部分，将获得正确的地址，这要归功于动态链接器完成的地址重定位（假设汇编器足够聪明，可以生成重定位表，它们通常是这样）。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-06-26T08:25:38.397

在 x86-64 上，您可以执行以下操作：

```
lea rax,[rip] (48 8d 05 00 00 00 00) 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-01T17:04:56.103

x86 上没有直接读取指令指针（EIP）的指令。您可以使用一点内联汇编获得正在汇编的当前指令的地址：

```
// GCC inline assembler; for MSVC, syntax is different
uint32_t eip;
__asm__ __volatile__("movl $., %0", : "=r"(eip)); 
```

汇编器指令被`.`汇编器替换为当前指令的地址。请注意，如果您将上述代码段包装在函数调用中，则每次都会获得相同的地址（在该函数内）。如果你想要一个更有用的 C 函数，你可以改用一些非内联汇编：

```
// In a C header file:
uint32_t get_eip(void);

// In a separate assembly (.S) file:
.globl _get_eip
_get_eip:
    mov 0(%esp), %eax
    ret 
```

这意味着每次您想要获取指令指针时，它的效率都会稍低一些，因为您需要一个额外的函数调用。请注意，这样做不会破坏返回地址堆栈 (RAS)。返回地址堆栈是处理器内部使用的一个单独的返回地址堆栈，用于帮助[预测](http://en.wikipedia.org/wiki/Branch_target_predictor)RET 指令的分支目标。

每次有 CALL 指令时，当前的 EIP 都会被推送到 RAS 上，每次有 RET 指令时，都会弹出 RAS，并将最高值用作该指令的分支目标预测。如果您弄乱了 RAS（例如没有将每个 CALL 与 RET 匹配，如[Cody 的解决方案中](https://stackoverflow.com/questions/599968/reading-program-counter-directly/599982#599982)那样），您将得到一大堆不必要的分支错误预测，从而减慢您的程序速度。这种方法不会破坏 RAS，因为它有一对匹配的 CALL 和 RET 指令。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-13T23:35:35.807

有一种独立于架构（但依赖于 gcc）的方式来访问通过使用标签作为值来执行的地址：

[http://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html](http://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html)

```
void foo()
{
  void *current_address = $$current_address_label;
  current_address_label:
      ....
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-24T12:49:16.527

您也可以从 /proc/stat 中阅读此内容。检查 proc 联机帮助页。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2020-02-04T20:42:22.653

有一种简单的方法可以更改程序计数器（eip）

当你用'call'调用一个函数时，eip被推入堆栈，然后当你ret时，eip只是从堆栈中弹出。所以，你所要做的就是推动你想要的价值，然后收回。例如：

```
mov eax, 0x100
push eax`
ret 
```

它完成了。

# floating-point - 将浮点范围转换/量化为整数范围

> ID：599976
> 
> 赞同：11
> 
> 时间：2009-03-01T15:42:53.117
> 
> 标签：floating-point, integer, rounding, quantization

假设我有一个 [0, 1] 范围内的浮点数，我想量化它并将其存储在一个无符号字节中。听起来很简单，但实际上它相当复杂：

显而易见的解决方案如下所示：

```
unsigned char QuantizeFloat(float a)
{
  return (unsigned char)(a * 255.0f);
} 
```

到目前为止，这有效，我得到了从 0 到 255 的所有数字，但整数的分布并不均匀。该函数仅`255`在 a 恰好为时返回`1.0f`。不是一个好的解决方案。

如果我进行适当的舍入，我只是转移问题：

```
unsigned char QuantizeFloat(float a)
{
  return (unsigned char)(a * 255.0f + 0.5f);
} 
```

这里的结果`0`只覆盖了浮动范围的一半，而不是任何其他数字。

如何进行浮点范围均匀分布的量化？理想情况下，如果我量化均匀分布的随机浮点数，我希望得到整数的均匀分布。

有任何想法吗？

* * *

顺便说一句：我的代码也在 C 中，问题与语言无关。对于非 C 语言的人：假设`float`转换会`int`截断浮点数。

**编辑：**因为我们在这里有些困惑：我需要一个映射，将最小的输入浮点数（0）映射到最小的无符号字符，并将我范围的最高浮点数（1.0f）映射到最高的无符号字节（255）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-01T16:05:57.243

`a * 256f`用支票将 256 减少到 255 怎么样？所以像：

```
return (unsigned char) (min(255, (int) (a * 256f))); 
```

（对于您平台上合适的 min 函数 - 我不记得它的 C 函数了。）

基本上你想将范围分成 256 个相等的部分，这就是应该做的。1.0 到 256 并需要向下舍入的边缘情况只是因为域在两端都包含在内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T16:45:10.127

我认为您正在寻找的是：

```
unsigned char QuantizeFloat (float a)
{
  return (unsigned char) (a * 256.0f);
} 
```

这会将 [0, 1] 中的统一浮点值映射到 [0, 255] 中的统一字节值。[i/256, (i+1)/256[ (不包括 (i+1)/256) 中的所有值，对于 0..255 中的 i，都映射到 i。可能不希望的是 1.0f 映射到 256.0f ，它环绕到 0。

# design-patterns - UI状态的处理

> ID：599977
> 
> 赞同：4
> 
> 时间：2009-03-01T15:43:09.293
> 
> 标签：design-patterns, state

我有使用 MFC 编写的在 Windows 上运行的应用程序。菜单项的启用/禁用状态取决于很多条件。例如，如果满足条件 A 或满足条件 B，我必须启用菜单项，但如果 A 和 B 同时为 TRUE，则应禁用该菜单项。我们如何在代码中对此进行建模？我想我应该使用某种状态机，但我的状态机似乎包含太多状态。处理此类问题的一般方法是什么？请注意，以上只是一个例子，这样的条件还有很多。此外，始终启用菜单并在用户按下它时显示错误消息的选项不存在，因为我必须禁用菜单。

澄清一下，我不是在寻找如何禁用 MFC 中的菜单项，而是在寻找在涉及许多相互依赖的状态时决定是否启用/禁用菜单项的最佳方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-01T15:59:41.640

尝试编写一个`updateUIStatus()`在每个 UI 操作后调用的方法。该方法将根据您的条件设置菜单项（以及任何其他 UI 组件）的启用或禁用状态。

使用单一方法进行所有 UI 状态更新的好处在于，您可以将所有这些逻辑集中在一个地方，而不是多次调用，例如，`if (condition A && condition B) menu.setEnabled(true);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T16:57:30.643

MFC 具有用于启用和禁用菜单项的内置机制，以命令路由和`ON_UPDATE_COMMAND_UI`宏的形式。有关更多详细信息，请参阅[如何：更新用户界面对象](http://msdn.microsoft.com/en-us/library/72t5ykb7.aspx)和 MSDN 中的[CCmdUI](http://msdn.microsoft.com/en-us/library/6kc4d8fh.aspx)类文档。

您不一定需要状态机。对于每个菜单命令，决定应该在哪里处理命令，例如，在您的文档、视图或主框架类中，然后实现一个`OnUpdate`处理程序并为适当的类添加一个`ON_UPDATE_COMMAND_UI`消息映射条目。

例如，看看我给[这个问题](https://stackoverflow.com/questions/502640/disable-enable-ribbon-buttons-for-mfc-feature-pack)的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-26T05:39:07.353

看一下[中介模式](https://en.wikipedia.org/wiki/Mediator_pattern)。它旨在跟踪此类内容。

来自 gof：

在以下情况下使用中介者模式

一组对象以定义明确但复杂的方式进行通信。由此产生的相互依赖是非结构化的并且难以理解。

重用一个对象很困难，因为它引用了许多其他对象并与之通信。

分布在多个类之间的行为应该是可定制的，无需大量子类化。

# types - 什么是“头等舱”类型？

> ID：599978
> 
> 赞同：27
> 
> 时间：2009-03-01T15:43:30.633
> 
> 标签：types

类型 T 成为“头等舱”类型意味着什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-01T15:47:20.297

通常这意味着 T 的实例可以是

*   从函数返回
*   传递给函数
*   在运行时构建

例如，C 中的函数不是第一类类型，因为它们不能在运行时构造，但它们是在 JavaScript 中的。

在某些特殊情况下，例如定理证明，这意味着类型本身是一等对象。更多的现代文献使用“具体类型”来表示这一点，以避免这种歧义。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2011-04-30T05:19:59.790

“T”的使用听起来像是有人在谈论 Java 中泛型的状态（它们被删除了，这意味着虽然您可以在运行时检查某物是否是 List，但您无法检查它是否是整数）。

然而，也有“第一类类型”，这意味着类型本身（不仅仅是它们的实例）可以出现在任何地方，比如作为表达式的值。例如，代码片段如

```
someType s = new someType();
new typeOf(s); // makes a new instance of someType 
```

但是你并没有看到很多，因为如果你的类型依赖于一个值，类型检查需要更多的计算，如果你允许类型依赖于*任何*值，那么检查就变得不可判定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T15:47:30.390

我认为一流的类型与[一流的对象](http://en.wikipedia.org/wiki/First-class_object)大致相同。它基本上是提供一流对象属性的类型。

# sql - 与 LINQ2SQL 和 POCO 对象的父子关系

> ID：599984
> 
> 赞同：0
> 
> 时间：2009-03-01T15:46:41.750
> 
> 标签：sql, linq-to-sql, tags, parent-child, hierarchy

我刚开始学习 LINQ2SQL，我想尝试的第一件事是简单的父子层次结构，但我似乎找不到一个好的方法。我在 SO 上看到了一些示例，我已经用谷歌搜索了，但我无法直接应用它们，所以我将准确解释我想要完成的工作。

让我们使用带有标签的常见示例。

数据库表：Post-- Post_Tags -- 标签

我创建了一个简单的 Post 类，因此我避免传递 Linq2Sql 类：

```
public class Post
{
    public int Id {get; set;}
    public int Title {get; set;}
    public IEnumerable<string> Tags {get; set;}
} 
```

我想从 Posts 表中选择 5 条最新记录，获取它们的相关标签并返回 IList，其中每个 Post 都填充了 Tags 属性。

你能给我看一个具体的 Linq2Sql 代码吗？

我试过了：

```
 IList<Post> GetLatest()
      {
            return (from p in _db.Posts
                   orderby p.DateCreated descending
                   select new Post
                   {
                       Id = p.Id,
                       Title = p.Title,
                       Tags = p.Post_Tags.Select(pt => pt.Tag.Name)
                   }).Take(5).ToList();
       } 
```

这可行，但会复制每个 Tag 记录的 Post 记录，并且我必须在我使用的每个方法中复制属性映射 (Id=p.Id, ...)。然后我尝试了这种方法，但在这种情况下，我对每个标签都有一个到 DB 的往返：

```
 IQueryable<Post> GetList()
      {
            return (from p in _db.Posts
                   select new Post
                   {
                       Id = p.Id,
                       Title = p.Title,
                       Tags = p.Post_Tags.Select(pt => pt.Tag.Name)
                   });
       }

      IList<Post> GetLatest()
      {
            return (from p in GetList()
                   orderby p.DateCreated descending
                   select p).Take(5).ToList();
       } 
```

如果我在经典 ADO.NET 中执行此操作，我将创建一个返回两个结果集的存储过程。一个带有 Post 记录，第二个带有相关的 Tag 记录。然后我会将它们映射到代码中（手动、DataRelation、ORM 等）。我可以对 LINQ2SQL 做同样的事情吗？

我真的很想看到一些关于你们如何处理如此简单的层次结构的代码示例。

是的，我真的很想返回 IList<> 对象和我的自定义类，而不是可查询的 Linq 到 Sql 对象，因为如果我决定放弃 Linq2Sql，我希望对数据访问代码保持灵活。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T16:00:33.730

如果您创建 DataContext，则会自动为您维护父子关系。

即，如果您在 Linq2Sql DataContext 中对 Posts 和 Tags 及其关系进行建模，则可以像这样获取帖子：

```
var allPosts = from p in _db.Posts
               orderby p.DateCreated descending
               select p; 
```

那么您根本不必担心任何标签，因为它们可以作为变量 p 的成员访问，如下所示：

```
var allPostsList = allPosts.ToList();

var someTags = allPostsList[0].Post_Tags;
var moreTags = allPostsList[1].Post_Tags; 
```

然后任何重复的实例都会在整个 DataContext 中自动更新，直到您将其请求 SubmitChanges();

**IMO，这就是 ORM 的意义所在，您无需重新创建模型类并维护跨许多地方的映射，因为您希望 ORM 为您管理所有这些关系。**

至于往返，如果您避免使用任何显式请求访问数据库的代码，则所有查询都将存储在中间查询表示中，并且只有*当*实际需要数据继续时，才会将查询转换为 sql并分派到数据库以获取结果。

即以下代码只访问数据库*一次*

```
 // these 3 variables are all in query form until otherwise needed
 var allPosts = Posts.All();
 var somePosts = allPosts.Where(p => p.Name.Contains("hello"));
 var lesserPosts = somePosts.Where(p => p.Name.Contains("World"));

 // calling "ToList" will force the query to be sent to the db
 var result = lesserPosts.ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T20:05:33.260

```
List<Post> latestPosts = db.Posts
  .OrderByDescending( p => p.DateCreated )
  .Take(5)
  .ToList();

  // project the Posts to a List of IDs to send back in
List<int> postIDs = latestPosts
  .Select(p => p.Id)
  .ToList();

// fetch the strings and the ints used to connect 
ILookup<int, string> tagNameLookup = db.Posts
  .Where(p => postIDs.Contains(p.Id))
  .SelectMany(p => p.Post_Tags)
  .Select(pt => new {PostID = pt.PostID, TagName = pt.Tag.Name } )
  .ToLookup(x => x.PostID, x => x.TagName);
//now form results
List<Post> results = latestPosts
  .Select(p => new Post()
  {
    Id = p.Id,
    Title = p.Title,
    Tags = tagNameLookup[p.Id]
  })
  .ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T16:37:54.950

如果您首先设置[DataLoadOptions](http://msdn.microsoft.com/en-us/library/bb386917.aspx)以显式加载带有帖子的标签，怎么样？就像是：

```
IList<Post> GetLatest()
{
     DataLoadOptions options = new DataLoadOptions();
     options.LoadWith<Post>(post => post.Tags);
     _db.LoadOptions = options;

     return (from p in _db.Posts
             orderby p.DateCreated descending)
             Take(5).ToList();
   } 
```

# firefox - 为什么 Firefox 应该显示 example2.foo 却显示 example1.foo？

> ID：599987
> 
> 赞同：0
> 
> 时间：2009-03-01T15:47:43.057
> 
> 标签：firefox

我已经设置了 Apache 并创建了一些虚拟主机。具体来说，我在 httpd.conf 中添加了以下内容：

`NameVirtualHost *:80`

 ````
<VirtualHost *:80>
    ServerName example1.foo
    DocumentRoot /www/example1
</VirtualHost>

<VirtualHost *:80>
    ServerName example2.foo
    DocumentRoot /www/example2
</VirtualHost> 
````  `这在 Firefox 中运行良好，但前几天我搞砸了添加第三个虚拟主机，现在 example2.foo 出于某种原因让我获得了 example1.foo 的内容。如果我转到 example2.foo/includes/main.js，我确实得到了正确的文件，所以 example2.foo/index.html 有一些特别错误。如果我尝试在 Safari 中点击我从未真正使用过的 example2.foo，那么它可以正常工作。

从这种实验来看，Firefox 似乎正在缓存一些东西，但我不确定它在缓存什么或如何刷​​新它。有人对此有任何想法吗？我试图清除 Firefox 中的私人数据，清除除 cookie 和保存的密码之外的所有内容。

更新：我重新启动了我的计算机，再次清除了 Firefox 的缓存，并稍微修改了 hosts 文件。做所有这些事情解决了问题，现在我们可以开始了。如果有人知道为什么会发生这种情况，我很想听听解释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-01T16:08:17.813

它几乎可以是任何东西，因为 1）我们不知道你做了什么实验（你有没有通过 IP 对主机进行 trty ？） 2）我们不知道你 httpd.conf 上的编辑历史（你还记得吗？每次都重新启动apache？和3）我们不知道您如何将事物路由到服务器（现实世界的DNS，您的个人主机文件或......）？

在这种情况下，一般规则是假设所有内容都缓存了东西，缓存中的所有内容都是错误的，并在任何此类更改后用干净的工作台重试。

——马库斯

# php - 在 CodeIgniter 中是否可以根据需要经常使用`$this->load->model()`？

> ID：599988
> 
> 赞同：2
> 
> 时间：2009-03-01T15:47:46.333
> 
> 标签：php, codeigniter

`$this->load->model()`我在模型中有很多代码，虽然模型可能会在其他地方加载，但我想通过在几乎所有使用它的地方做来确保。可以吗，还是会耗尽任何资源？即使模型已经加载？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-01T15:58:27.183

每次调用 $this->load->model() 时都会执行构造函数，但文件本身只会加载一次。将您经常使用的模型放入 application/config/autoload.php 可能是有意义的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T12:01:53.987

最好在构造函数中加载模型。所以不需要一次又一次地重复代码..

# c++ - 有没有内置的方法在 C++ 中拆分字符串？

> ID：599989
> 
> 赞同：19
> 
> 时间：2009-03-01T15:50:04.457
> 
> 标签：c++, string, split

有吗？通过字符串，我的意思是 std::string

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-01T16:21:48.763

这是我使用的 perl 风格的拆分函数：

```
void split(const string& str, const string& delimiters , vector<string>& tokens)
{
    // Skip delimiters at beginning.
    string::size_type lastPos = str.find_first_not_of(delimiters, 0);
    // Find first "non-delimiter".
    string::size_type pos     = str.find_first_of(delimiters, lastPos);

    while (string::npos != pos || string::npos != lastPos)
    {
        // Found a token, add it to the vector.
        tokens.push_back(str.substr(lastPos, pos - lastPos));
        // Skip delimiters.  Note the "not_of"
        lastPos = str.find_first_not_of(delimiters, pos);
        // Find next "non-delimiter"
        pos = str.find_first_of(delimiters, lastPos);
    }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-01T16:08:37.937

在 C++ 中没有内置的分割字符串的方法，但是[boost](http://www.boost.org)提供了[字符串算法](http://www.boost.org/doc/libs/1_38_0/doc/html/string_algo.html)库来进行各种字符串操作，包括字符串[分割](http://www.boost.org/doc/libs/1_38_0/doc/html/string_algo/usage.html#id4002194)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-02T09:44:46.823

是的，字符串流。

```
std::istringstream oss(std::string("This is a test string"));
std::string word;
while(oss >> word) {
    std::cout << "[" << word << "] ";
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-01T15:57:03.537

**STL 字符串**

你可以使用字符串迭代器来做你的脏活。

```
std::string str = "hello world";

std::string::const_iterator pos = std::find(string.begin(), string.end(), ' '); // Split at ' '.

std::string left(str.begin(), pos);
std::string right(pos + 1, str.end());

// Echoes "hello|world".
std::cout << left << "|" << right << std::endl; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-01T16:04:54.123

```
void split(string StringToSplit, string Separators)
{
    size_t EndPart1 = StringToSplit.find_first_of(Separators)
    string Part1 = StringToSplit.substr(0, EndPart1);
    string Part2 = StringToSplit.substr(EndPart1 + 1);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-01T15:55:04.367

答案是不。您必须使用其中一个库函数将它们分解。

我用的东西：

```
std::vector<std::string> parse(std::string l, char delim) 
{
    std::replace(l.begin(), l.end(), delim, ' ');
    std::istringstream stm(l);
    std::vector<std::string> tokens;
    for (;;) {
        std::string word;
        if (!(stm >> word)) break;
        tokens.push_back(word);
    }
    return tokens;
} 
```

你也可以看看`basic_streambuf<T>::underflow()`方法，写一个过滤器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-01T21:49:13.937

什么鬼……这是我的版本……

注意：拆分 ("XZaaaXZ", "XZ") 将为您提供 3 个字符串。其中 2 个字符串将为空，如果 theIncludeEmptyStrings 为 false ，**则不会添加到 theStringVector。**

Delimiter**不是**集合中的任何元素，而是与该确切字符串匹配。

```
 inline void
StringSplit( vector<string> * theStringVector,  /* Altered/returned value */
             const  string  & theString,
             const  string  & theDelimiter,
             bool             theIncludeEmptyStrings = false )
{
  UASSERT( theStringVector, !=, (vector<string> *) NULL );
  UASSERT( theDelimiter.size(), >, 0 );

  size_t  start = 0, end = 0, length = 0;

  while ( end != string::npos )
  {
    end = theString.find( theDelimiter, start );

      // If at end, use length=maxLength.  Else use length=end-start.
    length = (end == string::npos) ? string::npos : end - start;

    if (    theIncludeEmptyStrings
         || (   ( length > 0 ) /* At end, end == length == string::npos */
             && ( start  < theString.size() ) ) )
      theStringVector -> push_back( theString.substr( start, length ) );

      // If at end, use start=maxSize.  Else use start=end+delimiter.
    start = (   ( end > (string::npos - theDelimiter.size()) )
              ?  string::npos  :  end + theDelimiter.size()     );
  }
}

inline vector<string>
StringSplit( const  string  & theString,
             const  string  & theDelimiter,
             bool             theIncludeEmptyStrings = false )
{
  vector<string> v;
  StringSplit( & v, theString, theDelimiter, theIncludeEmptyStrings );
  return v;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-20T08:58:07.077

没有常见的方法来做到这一点。

我更喜欢[boost::tokenizer](http://www.boost.org/doc/libs/1_44_0/libs/tokenizer/index.html)，它只有标题并且易于使用。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-03-02T00:37:40.273

一个相当简单的方法是使用 std::string 的 c_str() 方法获取 C 风格的字符数组，然后使用 strtok() 对字符串进行标记。不像这里列出的其他一些解决方案那样雄辩，但它很容易并且有效。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-03-01T15:54:36.880

**C 字符串**

`\0`只需在要拆分的位置插入一个。这与标准 C 函数一样内置。

此函数在第一次出现分隔符时拆分`char`，返回第二个字符串。

```
char *split_string(char *str, char separator) {
    char *second = strchr(str, separator);
    if(second == NULL)
        return NULL;

    *second = '\0';
    ++second;
    return second;
} 
```

# c++ - C++ FILE readInt 函数？（来自二进制文件）

> ID：599996
> 
> 赞同：2
> 
> 时间：2009-03-01T15:52:50.863
> 
> 标签：c++, file, binary

FILE (fopen?) 是否有一个函数允许我从二进制文件中读取一个 int？

到目前为止，我正在尝试这个，但是我遇到了一些我看不到的错误，因为程序在没有告诉我的情况下就崩溃了。

```
void opentest()
{
    FILE *fp = fopen("dqmapt.mp", "r");
    int i = 0;
    int j = 0;
    int k = 0;
    int * buffer;
    if (fp)
    {
        buffer = (int *) (sizeof(int));

        i = (int) fread(buffer,1, (sizeof(int)), fp);
        fscanf(fp, "%d", &j);
        fclose(fp);
    }

    printf("%d\n", i);
    printf("%d\n", j);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-01T16:02:42.413

既然你已经改变了你的问题，让我问一个。您尝试读取的文件格式是什么？

对于二进制文件，打开文件的方式需要进行一些更改：

```
/* C way */
FILE *fp = fopen("text.bin", "rb"); /* note the b; this is a compound mode */

/* C++ way */
std::ifstream ifs("test.txt", ios::in | ios::binary); 
```

阅读内容很容易。但请记住，您的文件在开头有 2 个整数 - 宽度、高度确定要读取多少个整数，即另一个宽度 * 高度整数。所以，最好的办法是先读取前两个整数。您将需要使用两个缓冲区——一个用于宽度和高度，然后根据它们的值，另一个用于读取文件的其余部分。所以，让我们读入前两个整数：

```
char buf[ 2 * sizeof(int) ]; /* will store width and height */ 
```

读入两个整数：

```
/* C way */
fread(buf, sizeof(int), 2, fp); /* the syntax changes, FILE pointer is last */

/* C++ way*/ 
ifs.read(buf, sizeof buf); 
```

现在，棘手的部分。您必须将这些东西转换为双倍。这又取决于您的系统字节序——简单的分配是否有效，或者是否需要进行字节交换。正如另一位海报指出的那样`WriteInt()`，以大端格式写入整数。弄清楚你在哪个系统上。然后您可以继续进行。

`FILE`是一个 C 数据结构。它包含在 C++ 中以实现 C 兼容性。你可以这样做：

```
/* The C way */
#include <stdio.h>
#include <stdlib.h>

int main(void) {
   FILE *fp = fopen("test.txt", "r");
   int i = 0;
   if (fp) {
      fscanf(fp, "%d", &i);
      fclose(fp);
   }
   printf("%d\n", i);
} 
```

您可以使用该`std::ifstream`事物打开文件进行阅读。您必须使用其他一些咒语来读取内容，以读取文件内容并自己从中提取所需的信息。

```
/* The C++ way */
#include <fstream>
#include <iostream>

int main() {
   std::ifstream ifs("test.txt");
   int i = 0;
   if (ifs.good()) {
      ifs >> i;
   }
   std::cout << i << std::endl;
} 
```

请注意，您也可以在 C++ 中使用 C 风格的函数，尽管这是最不推荐的方式：

```
/* The C way in C++ */
#include <cstdio>
#include <cstdlib>

int main() {
   using namespace std;
   FILE *fp = fopen("test.txt", "r");
   int i = 0;
   if (fp) {
      fscanf(fp, "%d", &i);
      fclose(fp);
   }
   printf("%d\n", i);
} 
```

[**注意：**这两个示例都假设您有一个要读取的文本文件]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T15:57:32.987

你想阅读一个 int 的文本表示吗？然后你可以使用 fscanf，它与 printf 正好相反

```
int n;
if( fscanf(filePointer, "%d", &n) == 1 )
  // do stuff with n 
```

如果您想读取一些二进制数据并将其视为 int，那将首先取决于它是如何编写的。

* * *

我不是 Java 程序员，所以这只是基于我在 [docs]( [http://java.sun.com/j2se/1.4.2/docs/api/java/io/DataOutputStream. html#writeInt(int))](http://java.sun.com/j2se/1.4.2/docs/api/java/io/DataOutputStream.html#writeInt(int)))。

也就是说，它说

> 将一个 int 作为四个字节写入底层输出流，先是高字节。如果没有抛出异常，则写入的计数器增加 4。

所以它是一个大端的四字节整数。我不知道它是否是二进制补码，但这可能是一个安全的假设（并且可能可以在 java 文档/规范中的某处找到）。Big endian 与网络字节顺序相同，因此您可以使用`ntohl`它来将其转换为您的 C++ 平台的字节序。除此之外，您只需要读取四个字节，就可以使用`fread`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T15:59:57.303

Int 表示为文本还是二进制？

对于文本，使用`fscanf`; 对于二进制，使用`fread`.`***********~~