# StackOverflow 问答 000727000-000727999

# javascript - 为什么 JS hash/dict 中的“key”部分应该是字符串？

> ID：727002
> 
> 赞同：6
> 
> 时间：2009-04-07T18:24:59.263
> 
> 标签：javascript, dictionary, coding-style

在大多数 JSON 序列化器/反序列化器中，javascript 字典/哈希数组中的“键”部分被写为字符串。

使用字符串作为键而不是只输入预期的名称有什么好处？

例如，假设我定义了两个对象`k1`，`k2`如下所示：

```
var k1 = { a: 1, b: 2, c: 3 };          // define name normally
var k2 = { "a": 1, "b": 2, "c": 3 };    // define name with a string 
```

然后我进行了以下测试：

```
alert(k1 == k2);                   // false (of course)

alert(k1.a == k2.a);               // true
alert(k1["b"] == k2["b"]);         // true

alert(uneval(k1));                 // returns the k1 object literal notation.
alert(uneval(k2));                 // returns the same string as above line.

alert(uneval(k1) == uneval(k2));   // true 
```

那么，按照定义的方式将键放在双引号（字符串）中，`k2`而不是按照定义的方式输入键名，有什么意义`k1`呢？

* * *

我刚刚在[Ajaxian](http://ajaxian.com/archives/chrome-extension-api-how-we-wish-we-have-named-parameters)看到这个，指向[Aaron Boodman 的博客条目](http://www.aaronboodman.com/2009/04/yo-dawg.html)：

```
chromium.tabs.createTab({
 "url": "http://www.google.com/",
 "selected": true,
 "tabIndex": 3
}); 
```

由于他还对 tabIndex 使用驼峰式大小写，所以我根本看不出使用字符串有任何意义。

为什么不：

```
chromium.tabs.createTab({
 url: "http://www.google.com/",
 selected: true,
 tabIndex: 3
}); 
```

为什么 JS ninja 会遵循将`url`,转换为字符串`selected`的约定？`tabIndex`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-07T18:42:39.470

因为[JSON](http://www.json.org/)是实际 JavaScript 文字语法的子集。为了简化 JSON 解析器的实现，字符串始终需要双引号，并且由于 JSON 中的键是字符串，因此它们是必需的。

并非所有合法的 JavaScript 都是合法的 JSON。虽然您可以在 JavaScript 中定义不带引号的对象文字，但如果您想要可互操作的 JSON，则需要将它们放入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T18:32:54.157

因为这样做，您可以避免错误地使用 javascript 保留关键字，例如“do”。使用字符串表示法使您保持安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T18:36:27.050

如果相信 json.org 上的语法图，那么裸词属性名称是非标准的。您在多少个浏览器上运行了测试？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T18:36:54.180

除了摆脱保留关键字之外，您实际上可以在属性名称中使用任何字符 - 包括空格、冒号......

不太确定你为什么要这样做。我更喜欢使用普通的“对象”表示法。

# c# - 在 C# 中，如何指定派生结构的默认状态？

> ID：727005
> 
> 赞同：5
> 
> 时间：2009-04-07T18:25:39.260
> 
> 标签：c#, .net, struct

我在 SO 上看到了关于无法使用无参数构造函数或不设置字段初始值设定项的不同问题，但我认为我的问题比这更进一步。

我想知道的是，我将如何设置我需要定义的结构的“默认”值？假设我正在制作一个 TaxID 结构，无论出于何种原因，默认值都需要为 999-99-9999。这已经通过 .NET 中的其他结构完成，即 DateTime。每当您声明 DateTime 时，该值都会立即设置为 Jan 1 0001 12:00 AM。为什么它被设置为这个值而不是 0/0/0000 00:00:0000 AM？即使考虑到 c# 在结构方面对我们施加的限制，幕后肯定发生了一些事情，使得该值实际上在它的“默认”下“有意义”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-07T18:33:20.180

一般来说，应该避免这种情况。如果您需要一个需要构造的良好默认案例，您应该考虑更改为一个类。

结构的核心设计准则之一是：确保所有实例数据设置为零、假或空（视情况而定）的状态是有效的。

有关详细信息，请参阅[设计指南](http://msdn.microsoft.com/en-us/library/ms229031.aspx)。

* * *

我刚刚在设计指南第 2 版中查看了这部分，他们在那里有一个详细的示例，使用属性和非常规覆盖来解决这个问题。基本概念是以 0 是“良好的默认值”的方式私下保存值，并在每个属性和方法覆盖（包括 ToString）中进行某种形式的转换。在他们的案例中，他们使用正整数作为示例，并且始终将 curVal-1 保存在私有成员中，因此默认值 (0) 被视为值 1。他们添加了一个带有 int val 的构造函数，并保存value-1 内部，等等。

不过，这似乎有很多隐藏的、意想不到的开销——所以在这种情况下，我个人仍然会推荐（并使用）一个类。

---根据评论进行编辑---

作为您的示例，日期时间就是这样，因为 0 == 1/1/0001 在午夜。DateTime 使用单个 ulong 表示从 1/1/0001 开始的刻度。这就是为什么（[从这里](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)）：

“DateTime 值类型表示日期和时间，其值范围从 0001 年 1 月 1 日午夜 12:00:00 到公元 9999 年 12 月 31 日（CE）晚上 11:59:59”

这是完整的 ulong 刻度范围。当您转换为字符串时，DateTime 结构中的“0”被视为 1/1/0001 - 值不是 1 + 1 + .... - 它是单个 0。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-07T18:32:48.510

> 每当您声明 DateTime 时，该值都会立即设置为 Jan 1 0001 12:00 AM。为什么它被设置为这个值而不是 0/0/0000 00:00:0000 AM？即使考虑到 c# 在结构方面对我们施加的限制，幕后肯定发生了一些事情，使得该值实际上在它的“默认”下“有意义”。

更有可能的是，它隐式地将刻度字段初始化为`default(int)`= 0，而 0 刻度意味着`DateTime.MinValue`您何时去获取该值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T18:49:39.610

没有什么险恶的事情发生。DateTime 的内部表示是自 0001 年 1 月 1 日午夜 12:00:00 以来的 100 纳秒“滴答”数。创建 DateTime 时，滴答计数为零。如果你用 Ildasm 查看 DateTime，你会发现它比这更复杂一些，但你明白了。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T18:28:21.860

您不能在 C# 结构中声明默认构造函数。您可以通过创建一个私有字段并编写一个属性来模拟此行为以返回默认值（如果它是 1/1/1）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T19:29:47.703

只是为了完整性：

C# 中的值类型（包括数组、结构、枚举）始终初始化为全零。引用类型最初也为零，更好地称为`null`.

在枚举的情况下，零是默认值，并且始终是可能的值，即使它没有在枚举中定义。就个人而言，我通常将 0 定义为 None、Empty、Unknown 或类似的东西：

```
enum MyEnum { A = 1, B = 2, C = 3 };
// ...
MyEnum value = new MyEnum(); // value has a nameless 0 
```

在数组的情况下，如果它是引用类型的数组，它们都是最初的`null`（您可以将其视为指向地址 0 的指针）。如果它是一个值类型的数组，它们最初都是零或等价的（请参阅其他答案`DateTime.Ticks`以及为什么“归零”日期时间等于 1/1/0001 12:00am）。

回到结构：同样适用。**它们将始终具有默认的无参数构造函数**，您无法避免这种情况。所有值类型成员最初都是零（或等效），所有引用类型成员都是`null`. 想想 int、short、decimal、char、DateTime (ahem)、TimeSpan、Size、Point、Rectangle、Color、Guid ......它们都被初始化为全零。

# css - 帮助 div - 使 div 适合剩余的宽度

> ID：727012
> 
> 赞同：2
> 
> 时间：2009-04-07T18:28:02.423
> 
> 标签：css

我有以下html代码：

```
<div class="a">
    <div class="b">
        <a href="#">text</a>
    </div>
    <div class="c">
        text
    </div>
</div>

div.a
{
    margin-top: 10px;
    clear: left;
    float: left;
    width: 100%;
    text-align: center;
}

div.b
{
    padding: 27px 10px 7px 10px;
    background-color: #fff;
    overflow: hidden;
    float: left;
}

div.c
{
    float: left;
} 
```

我应该为 div.c 设置什么样式以使其位于 div.b 旁边并适合剩余宽度？

这是一个适合 100% 屏幕的模板。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-07T18:39:32.020

```
<div class="a">
	<div class="b">
		<a href="#">click here to be amazed!</a>
	</div>
	<div class="c">
		this is some awesome text
	</div>	
</div>

<STYLE>
	.b,.c {
		padding:15px;
	}

	div.a {		
		border: 1px solid red;
	}

	div.b {
		float: left;
		border: 1px solid blue;
	}

	div.c {
		border: 1px solid green;
	}
</STYLE>
```

# c# - 将 RangeValidator 与字节一起使用

> ID：727017
> 
> 赞同：0
> 
> 时间：2009-04-07T18:28:41.640
> 
> 标签：c#, .net, enterprise-library, rangevalidator

这是有问题的财产声明：

```
 [RangeValidator(1,RangeBoundaryType.Inclusive,255,RangeBoundaryType.Inclusive,MessageTemplate = "StartFlexibility is out of range")]
    public byte StartFlexibility { get; set; } 
```

当调用 validate 方法时，会抛出一个 FormatException，告诉我值类型需要是 Int32。

请问怎么修？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T18:36:09.673

好吧...快速明显的解决方法是将类型更改为short或int，

但我想做的另一个观察是范围。您告诉 RangeValidator 取 1 到 256 之间的包含范围，但您只能分配一个字节值直到 255，也许这就是编译器大喊大叫的原因。

RangeValidator 还从参数推断 Range 的类型，因此，请尝试强制转换

```
[RangeValidator((byte) 1, ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-07T22:16:27.707

正如 Jhonny 所说，转换为字节......但更像这样

```
[RangeValidator(typeof(Byte), "1", RangeBoundaryType.Inclusive, "255", RangeBoundaryType.Inclusive, MessageTemplate = "Some message")] 
```

另一种选择是在 SelfValidation 消息中调用范围验证器并在那里转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T18:36:02.857

我从来没有使用过 RangeValidator 类/属性，但是当一个字节只能达到 255 时，你有 256 作为上限是一个问题吗？

# solr - Debian Lenny Solr Jetty 安装 + 运行

> ID：727018
> 
> 赞同：0
> 
> 时间：2009-04-07T18:28:52.357
> 
> 标签：solr, debian, jetty, lenny

我想为我的网站设置搜索。我找不到太多信息来在我的 linode 上安装 Jetty + Solr。

我可以简单地使用 apt-get 在 ubuntu 上安装 solr-jetty。有没有人对debian有更好的体验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T21:26:07.583

您不需要通过包管理器安装它。Jetty 通过 Solr 主页上的 Solr 进行部署。只要您在服务器上安装了 java，您就可以简单地解压 Solr 分发包，阅读 example/README.txt

# excel - 强制 excel 停止对 csv 导入数据应用“自动更正”

> ID：727019
> 
> 赞同：1
> 
> 时间：2009-04-07T18:28:52.357
> 
> 标签：excel, csv, import

**注意：**这个问题*几乎*是一个骗局：

[停止 Ms Excel 将数字字符串自动格式化为数字](https://stackoverflow.com/questions/284092/stop-ms-excel-auto-formatting-numeric-strings-as-numbers)

我说“几乎”是因为没有问到这个具体问题......

**问题：** 有没有办法在 Excel 导入之前**将“模式”附加到 CSV 文件**，使 Excel 能够理解 CSV 文件的正确格式，而无需对 CSV 文件*进行*后处理，也无需最终用户干预为了手动正确格式化字段？

模式是指任何生成基于文本的定义的方法，该定义可以保存在客户 X 的机器上的某个位置，然后在必须进行通常的 CSV 导入时引用，包括但不限于 XSD、VBMacro 或任何约定 Excel有这种操作（如果有的话）。

**背景：** Excel 习惯于在从 CSV 文件等纯文本文件打开时修改输入数据来“提供帮助”。

有关此含义的示例，请参阅以下各种链接中的任何一个：

```
 http://ask.metafilter.com/28449/Preventing-Excel-applying-time-formatting-to-imported-data
    http://excel.tips.net/Pages/T002588_Handling_Leading_Zeros_in_CSV_Files.html
    http://social.msdn.microsoft.com/Forums/en-US/isvvba/thread/aae07b39-865f-4c68-a07f-7cad2dfd6733
    http://social.msdn.microsoft.com/forums/en-US/vsto/thread/80285088-b476-418f-9613-a2c499c8da7b/ 
```

我们经常需要将 CSV 文件发送给客户 X，而且我们无法直接修改 CSV 文件以将它们“变形”为 Excel 将完全按照预期呈现的格式。

此外，客户 X 并不总是拥有受过 Excel 培训以正确执行导入的人员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T18:34:55.340

面对这个问题时，我所做的是创建一个宏以在“取消修复”Excel 修复的导入后运行。这不是一个很好的解决方案，但它是一种可行的解决方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T05:40:25.787

恐怕我没有完全遵循。你说你发送 CSV 文件，但你不能修改 CSV 文件？所以你没有生成它们？而且您无法在将它们发送给客户之前对其进行处理？

虽然我很难想象这样的情况，但我会假设是这样的。您是否有机会让客户运行脚本而不是直接启动 Excel？例如，是否可以训练他们双击 VBScript 而不是双击 CSV 或使用从 Excel 中打开？

鉴于您所描述的限制，这是我能想到的最接近的，但我不禁认为，在它离开您的手并进入客户的手中之前，您必须在上游进一步做一些事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-07T19:06:35.783

这是另一个答案，用引号重新格式化数据，如下所示：

邮编、=“00123”等。

这将在 Excel 中呈现为：

邮编 | 00123 | 等等

# android - Android上的短信自动回复

> ID：727021
> 
> 赞同：2
> 
> 时间：2009-04-07T18:29:11.687
> 
> 标签：android, sms, voice, auto-responder

首先，一个非编程问题：我的手机会自动回复未接来电并发送一条短信：“对不起。我现在不在我的手机附近。” 我的手机是从哪里得到这个想法的，我该如何让它停下来？

还有一个编程问题：我怎样才能让我的 Android 做任何事情来响应未接来电，例如通过电子邮件将电话号码发送给我，或者只是自定义 SMS 自动回复，也许回复我的位置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T20:10:02.170

您的编程问题的答案：

为来电设置 IntentListener。如果没有回答，请让您的申请相应地处理它！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T19:28:44.103

我发现我已经安装了一个名为 dgAway 的 Android Market 应用程序，它可以自动回复短信。我从未运行过该应用程序，也从未检查过“自动回复未接来电”框，但似乎这可能是自动回复的原因。我尝试卸载它，自动响应似乎已经停止。

补充：我发现了一个非常不错的 Android 应用程序 DroidTracker，当联系人向您发送您选择的短语（例如，“你在哪里？”或“ping”）时，它会（对于已批准的联系人）自动回复您的位置。您还可以设置一个不太容易猜到的短语（默认为“我想要我的手机回来”），这将使您的手机自动回复*任何人*，无论是否批准。这样，如果您的手机丢失或被盗，您可以询问您的手机它在哪里。

# php - Codeigniter：MySQL Where 子句和引号

> ID：727022
> 
> 赞同：1
> 
> 时间：2009-04-07T18:29:12.030
> 
> 标签：php, mysql, activerecord, codeigniter

**在 CodeIgniter 中查询**：

```
$this->db->select('comments.created_at, comments.section_id, comments.submittedby_id, users.username, comments.text, sections.name');
$this->db->order_by('comments.created_at', 'desc');
$this->db->where('comments.submittedby_id',  'users.user_id'); 
$this->db->where('comments.section_id', 'sections.id'); 

$query = $this->db->get(array('comments', 'users', 'sections'),10); 
```

**产生 SQL 请求**：

> 选择`pdb_comments`。`created_at`, `pdb_comments`. `section_id`, `pdb_comments`. `submittedby_id`, `pdb_users`. `username`, `pdb_comments`. `text`, `pdb_sections`. `name`从 ( `pdb_comments`, `pdb_users`, `pdb_sections`) 哪里 `pdb_comments`。`submittedby_id`= 'users.user_id' 和 `pdb_comments`. `section_id`= 'sections.id' ORDER BY `pdb_comments`。`created_at`描述限制 10

问题是`pdb_`没有在`WHERE`子句中添加数据库前缀 ( )。我可以通过附加手动插入前缀`$this->db->dbprefix`，但这并不能解决主要问题。

**行情**：

```
`pdb_comments`.`submittedby_id` = 'pdb_users.user_id' 
```

右侧的报价不准确，为我生成 0 个结果。有什么方法可以让 CodeIgniter 将 where 子句的后半部分识别为我的表的一部分；从而添加数据库前缀，并通过避免两个连接正确放置引号？还有另一种方法可以做到这一点吗？提前致谢。

--

乔恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T19:15:22.463

采用：

```
$this->db->select('comments.created_at, comments.section_id, comments.submittedby_id, users.username, comments.text, sections.name');
$this->db->from('comments');
$this->db->join('users', 'comments.submittedby_id=users.user_id'); 
$this->db->join('sections', 'comments.section_id=sections.id'); 
$this->db->order_by('comments.created_at', 'desc');
$query = $this->db->get(); 
```

反而。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T18:37:01.027

可能是个愚蠢的问题，但你为什么不直接写 SQL 呢？界面看起来除了杂乱之外没有给你任何东西。

# wcf - 连接 WCF 客户端缓存？

> ID：727030
> 
> 赞同：8
> 
> 时间：2009-04-07T18:32:29.917
> 
> 标签：wcf, caching

我的应用程序使用客户端企业缓存；我想避免为每个可缓存的调用编写代码，并想知道是否有一种解决方案可以缓存 WCF 客户端调用，即使是异步调用也是如此。

这可以通过 WCF“行为”或其他方式来完成吗？代码示例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T21:01:42.637

前几天我在 WCF 服务客户端 (DataServiceClient) 上使用通用扩展方法进行了此操作。它使用 Actions 和 Funcs 来传递实际的 ServiceClient 调用。最终的客户端使用语法有点古怪（如果您不喜欢 lambdas），但此方法执行 FaultException/Abort 包装和缓存：

```
public static class ProxyWrapper
{
    // start with a void wrapper, no parameters
    public static void Wrap(this DataServiceClient _svc, Action operation)
    {
        bool success = false;

        try
        {
            _svc.Open();
            operation.Invoke();
            _svc.Close();

            success = true;
        }
        finally
        {
            if (!success)
                _svc.Abort();
        }
    }

    // next, a void wrapper with one generic parameter
    public static void Wrap<T>(this DataServiceClient _svc, Action<T> operation, T p1)
    {
        bool success = false;

        try
        {
            _svc.Open();
            operation.Invoke(p1);
            _svc.Close();

            success = true;
        }
        finally
        {
            if (!success)
                _svc.Abort();
        }
    }

    // non-void wrappers also work, but take Func instead of Action
    public static TResult Wrap<T, TResult>(this DataServiceClient _svc, Func<T, TResult> operation, T p1)
    {
        TResult result = default(TResult);

        bool success = false;

        try
        {
            _svc.Open();
            result = operation.Invoke(p1);
            _svc.Close();

            success = true;
        }
        finally
        {
            if (!success)
                _svc.Abort();
        }

        return result;
    }
} 
```

在客户端，我们必须这样称呼它们：

```
 internal static DBUser GetUserData(User u)
    {
        DataServiceClient _svc = new DataServiceClient();

        Func<int, DBUser> fun = (x) => _svc.GetUserById(x);

        return _svc.Wrap<int, DBUser>(fun, u.UserId);
    } 
```

看到这里的计划了吗？现在我们有了一组用于 WCF 调用的通用包装器，我们可以使用相同的想法来注入一些缓存。我在这里使用了“低技术”，并开始为缓存键名称抛出字符串......毫无疑问，您可以通过反射做一些更优雅的事情。

```
 public static TResult Cache<TResult>(this DataServiceClient _svc, string key, Func<TResult> operation)
    {
        TResult result = (TResult)HttpRuntime.Cache.Get(key);

        if (result != null)
            return result;

        bool success = false;

        try
        {
            _svc.Open();
            result = operation.Invoke();
            _svc.Close();

            success = true;
        }
        finally
        {
            if (!success)
                _svc.Abort();
        }

        HttpRuntime.Cache.Insert(key, result);

        return result;
    }

    // uncaching is just as easy
    public static void Uncache<T>(this DataServiceClient _svc, string key, Action<T> operation, T p1)
    {
        bool success = false;

        try
        {
            _svc.Open();
            operation.Invoke(p1);
            _svc.Close();

            success = true;
        }
        finally
        {
            if (!success)
                _svc.Abort();
        }

        HttpRuntime.Cache.Remove(key);
    } 
```

现在只需在您的读取和创建/更新/删除上调用缓存和取消缓存：

```
 // note the parameterless lambda? this was the only tricky part.
    public static IEnumerable<DBUser> GetAllDBUsers()
    {
        DataServiceClient _svc = new DataServiceClient();

        Func<DBUser[]> fun = () => _svc.GetAllUsers();

        return _svc.Cache<DBUser[]>("AllUsers", fun);
    } 
```

我喜欢这种方法，因为我不必在服务器端重新编码任何东西，只需要我的 WCF 代理调用（诚然，这些调用有点脆弱/难闻，到处都是）。

替换为您自己的 WCF 代理约定和标准缓存过程，一切顺利。一开始创建所有通用包装器模板也需要做很多工作，但我只设置了两个参数，它有助于我所有的缓存操作共享一个函数签名（目前）。让我知道这是否适合您，或者您是否有任何改进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T18:47:38.007

不幸的是，我认为你必须自己动手。我不相信 WCF 有内置的客户端缓存机制。

[这个问题](https://stackoverflow.com/questions/90889/wcf-rest-caching-client-side-server-side)的答案也可能有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-15T05:20:43.637

与上述解决方案类似，请查看[http://www.acorns.com.au/blog/?p=85](http://www.acorns.com.au/blog/?p=85) (PolicyInjection on WCF Services)。您可以指定策略以匹配您的服务名称。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-08T03:14:46.383

如果您想要缓存而不必在每个服务调用上显式实现它，请考虑策略注入应用程序块中的缓存处理程序。您可以使用属性标记您的调用，策略注入块将为您处理缓存。

[http://msdn.microsoft.com/en-us/library/cc511757.aspx](http://msdn.microsoft.com/en-us/library/cc511757.aspx)

# tomcat - 小型 Linode 的 Jetty 或 Tomcat

> ID：727032
> 
> 赞同：6
> 
> 时间：2009-04-07T18:32:52.333
> 
> 标签：tomcat, jetty

我的[网站在](http://www.dealmer.com)[linode](http://linode.com)上运行。我有 380+ MB RAM。我需要在同一个空间上运行 Web 服务器 + Solr + Postgres + memcached。

哪个是最好的 Jetty 或 Tomcat？它是简单、普通的搜索服务器。我们使用[Pylons](http://www.pylonshq.com/)进行开发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T19:31:19.773

Jetty 可以设置为仅加载您需要的功能。例如，您可以关闭会话支持。

我认为 Jetty 在一般情况下也更好，请参阅[Jetty vs Tomcat](http://www.webtide.com/choose/jetty.jsp)比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-14T18:15:47.247

我都用过，发现 Jetty 在 CentOS 上设置起来要容易得多。但是，我有一台运行 Tomcat 的服务器，它非常稳定（在 512MB Linode 上）。

对于大容量搜索服务器，我已经看到 Jetty 的性能有一点点改进，但​​仅仅出于性能原因，我不会选择它而不是 Tomcat...

# find - 使用 find 命令搜索具有某些文本模式的所有文件

> ID：727035
> 
> 赞同：5
> 
> 时间：2009-04-07T18:33:31.223
> 
> 标签：find, command

我使用以下 find 命令来查找并显示所有具有输入文本模式的文件。

寻找 。-type f -print|xargs grep -n "模式"

我有很多项目文件夹，每个文件夹都有自己的名为“Makefile”的makefile。（没有文件扩展名，只有“Makefile”）

如何使用上述命令仅在我所有项目文件夹中名为 Makefile 的文件中搜索特定模式？

-广告。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-07T18:35:35.743

`-print`不是必需的（至少由 GNU`find`实现）。`-name`参数允许指定文件名模式。因此命令将是：

`find . -name Makefile | xargs grep pattern`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T18:37:55.190

如果目录路径中有空格或奇数字符，则需要使用以空字符结尾的方法：

```
 find . -name Makefile -print0 | xargs -0 grep pattern 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T18:36:05.257

```
find . -type f -name 'Makefile' | xargs egrep -n "pattern" 
```

如果路径很长，请使用 egrep

重复：[这个](https://stackoverflow.com/questions/637467/xargs-and-find)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T18:45:18.683

您可以通过使用来避免`xargs`使用`-exec`：

```
find . -type f -name 'Makefile' -exec egrep -Hn "pattern" {} \; 
```

`-H`on`egrep`输出匹配文件的完整路径。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-17T12:25:04.853

grep -R "字符串" /路径

请找到此链接 [http://rulariteducation.blogspot.in/2016/03/how-to-check-particluar-string-in-linux.html](http://rulariteducation.blogspot.in/2016/03/how-to-check-particluar-string-in-linux.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-08T16:02:22.603

您可以使用 ff 命令，即 ff -p .format。例如 ff -p *.txt

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-23T13:50:21.560

查找占用大磁盘空间的大文件

我们需要组合多个命令。

```
find . -type f | xargs du -sk | sort -n | tail; 
```

# vb.net - 实体框架异常：索引超出了数组的范围。”

> ID：727037
> 
> 赞同：3
> 
> 时间：2009-04-07T18:34:04.157
> 
> 标签：vb.net, entity-framework, ado.net

好的，我遇到了实体框架问题。我已经让它工作了，但是现在已经向模型中添加了几个实体，现在我得到了上述错误。出于调试目的，我创建了一个带有网格控件的测试表单，以从我的 Projects 实体集合中填充。仅供参考，我正在为我的主键使用 GUID。我只有一点代码：

```
Public Class TestForm
Private Sub TestForm_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Me.ProjectBindingSource.DataSource = My.Application.Context.Projects
End Sub
End Class 
```

这是异常详细信息：

内部异常：{“索引超出了数组的范围。”} 来源：“System.Data.Entity”

> " System.Data.EntityCommandCompilationException 未处理 Message="准备命令定义时发生错误。有关详细信息，请参阅内部异常。" Source="System.Data.Entity" StackTrace: 在 System.Data.EntityClient.EntityProviderServices.CreateCommandDefinition(DbProviderFactory storeProviderFactory, DbCommandTree commandTree) 在 System.Data 的 System.Data.EntityClient.EntityCommandDefinition..ctor(DbProviderFactory storeProviderFactory, DbCommandTree commandTree) .EntityClient.EntityProviderServices.CreateDbCommandDefinition(DbProviderManifest providerManifest, DbCommandTree commandTree) 在 System.Data.Common.DbProviderServices.CreateCommandDefinition(DbCommandTree commandTree) 在 System.Data.Objects.Internal.ObjectQueryExecutionPlan。`1 forMergeOption) at System.Data.Objects.ObjectQuery`1.GetResults（可以为空`1 forMergeOption) at System.Data.Objects.ObjectQuery`Run(String[] commandLine) at TestApp.My.MyApplication.Main(String[] Args) in 17d14f5c-a337-4978-8281-53493378c1071.vb:line 81 at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args ) 在 System.Threading.ThreadHelper.ThreadStart_Context(Object state) 在 System.Threading.ExecutionContext 的 Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly() 的 System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)。在 System.Threading.ThreadHelper.ThreadStart() InnerException 处运行（ExecutionContext executionContext，ContextCallback 回调，对象状态）：System.IndexOutOfRangeException Message="索引超出了数组的范围。" Source="System.Data.Entity" 堆栈跟踪：`1 cells, MemberPathMapBase projectedSlotMap, ViewTarget viewTarget) at System.Data.Mapping.ViewGeneration.CellNormalizer.CreateLeftCellWrappers(IEnumerable`1 extentCells, ViewTarget viewTarget) at System.Data.Mapping.ViewGeneration.CellNormalizer..ctor(EntitySetBase extent, IEnumerable `1 extentCells, SchemaContext schemaContext, CqlIdentifiers identifiers, ConfigViewGenerator config, MemberDomainMap queryDomainMap, MemberDomainMap updateDomainMap, StorageEntityContainerMapping entityContainerMapping, MetadataWorkspace workspace) at System.Data.Mapping.ViewGeneration.ViewGenerator.GetCellNormalizer(EntitySetBase extent, SchemaContext schemaContext, CqlIdentifiers identifiers) at System.Data.Mapping.ViewGeneration.ViewGenerator.GenerateViewsForExtent(SchemaContext schemaContext, EntitySetBase extent, CqlIdentifiers identifiers, KeyToListMap`2 views) at System.Data.Mapping.ViewGeneration.ViewGenerator.GenerateViewsForSchemaContext(SchemaContext schemaContext, CqlIdentifiers identifiers, KeyToListMap `2 views) at System.Data.Mapping.ViewGeneration.ViewGenerator.GenerateAllViews(KeyToListMap`2 views, CqlIdentifiers 标识符）在 System.Data.Mapping.ViewGeneration.ViewGenerator.GenerateViewsForSchemaCells（List `1 cells, MetadataWorkspace workSpace, ConfigViewGenerator config, CqlIdentifiers identifiers, StorageEntityContainerMapping containerMapping) at System.Data.Mapping.ViewGeneration.ViewGenerator.GenerateViewsForSchema(StorageEntityContainerMapping containerMapping, MetadataWorkspace workSpace, ConfigViewGenerator config) at System.Data.Mapping.StorageMappingItemCollection.ViewDictionary.SerializedGenerateViews(EntityContainer container, Dictionary`2 resultDictionary）在 System.Data.Mapping.StorageMappingItemCollection.ViewDictionary.SerializedGetGeneratedViews（EntityContainer 容器）在 System.Data.Common.Utils.Memoizer `2.<>c__DisplayClass2.<Evaluate>b__0() at System.Data.Common.Utils.Memoizer`2.Result。 System.Data.Common.Utils.Memoizer 中的 GetValue()`2.Evaluate(TArg arg) at System.Data.Mapping.StorageMappingItemCollection.ViewDictionary.GetGeneratedView(EntitySetBase extent, MetadataWorkspace workspace, StorageMappingItemCollection storageMappingItemCollection) at System.Data.Metadata.Edm.MetadataWorkspace.GetGeneratedView(EntitySetBase extent) at System.Data.Query.PlanCompiler.PreProcessor.ExpandView(Node node, ScanTableOp scanTableOp, IsOfOp& typeFilter) at System.Data.Query.PlanCompiler.PreProcessor.ProcessScanTable(Node scanTableNode, ScanTableOp scanTableOp, IsOfOp& typeFilter) at System.Data.Query.PlanCompiler.PreProcessor.Visit(ScanTableOp op, Node n) at System.Data.Query.InternalTrees.ScanTableOp.Accept[TResultType](BasicOpVisitorOfT`1 v，节点 n) 在 System.Data.Query.InternalTrees.BasicOpVisitorOfT `1.VisitNode(Node n) at System.Data.Query.PlanCompiler.PreProcessor.VisitChildren(Node n) at System.Data.Query.PlanCompiler.PreProcessor.VisitRelOpDefault(RelOp op, Node n) at System.Data.Query.PlanCompiler.PreProcessor.Visit(ProjectOp op, Node n) at System.Data.Query.InternalTrees.ProjectOp.Accept[TResultType](BasicOpVisitorOfT`1 v，节点 n) 在 System.Data.Query.InternalTrees.BasicOpVisitorOfT `1.VisitNode(Node n) at System.Data.Query.PlanCompiler.PreProcessor.VisitChildren(Node n) at System.Data.Query.InternalTrees.BasicOpVisitorOfNode.VisitDefault(Node n) at System.Data.Query.InternalTrees.BasicOpVisitorOfNode.VisitPhysicalOpDefault(PhysicalOp op, Node n) at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.Visit(PhysicalProjectOp op，节点 n) 在 System.Data.Query.InternalTrees .PhysicalProjectOp.Accept[TResultType](BasicOpVisitorOfT `1 v, Node n) at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n) at System.Data.Query.PlanCompiler.PreProcessor.Process() at System.Data.Query.PlanCompiler.PreProcessor.Process(PlanCompiler planCompilerState, StructuredTypeInfo& typeInfo) at System.Data.Query.PlanCompiler.PlanCompiler.Compile(List `1& providerCommands, ColumnMap& resultColumnMap, Int32& columnCount, Set`1& entitySets) at System.Data.Query.PlanCompiler.PlanCompiler.Compile(DbCommandTree ctree, List`1& providerCommands, ColumnMap& resultColumnMap, Int32& columnCount, Set`1& entitySets) 在 System.Data.EntityClient.EntityCommandDefinition..ctor(DbProviderFactory storeProviderFactory, DbCommandTree commandTree) InnerException:

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-24T10:36:27.810

他们在 msdn 论坛上遇到了同样的问题（[http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/fa618214-ad3d-42fc-8506-21d539aa2cb3](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/fa618214-ad3d-42fc-8506-21d539aa2cb3)）

在那里查看答案，可能是您的模型中不应该存在的一些额外内容。你可以发布edmx文件吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-29T19:17:37.857

我也遇到过这种情况。

问题原来是与 end-keys 的关联，这些 end-keys 并不是该实体主键的全部！

例如，在我的 .edmx 深处，我有这样的关联：

```
<AssociationSetMapping Name="Table1Table2" TypeName="MyModel.Table1Table2" StoreEntitySet="Table2">
    <EndProperty Name="Table1">
        <ScalarProperty Name="Table1Key" ColumnName="Table1Key" /></EndProperty>
    <EndProperty Name="Table2">
        <ScalarProperty Name="Table2Key" ColumnName="Table2Key" />
        <ScalarProperty Name="Table2OtherColumn" ColumnName="Table2OtherColumn" />
</EndProperty></AssociationSetMapping> 
```

Table2 的定义如下所示：

```
<EntityType Name="Table2">
    <Key>
        <PropertyRef Name="Table2Key" />
    </Key>
    <Property Name="Table2Key" Type="int" Nullable="false" />
    <Property Name="Table2OtherColumn" Type="int" Nullable="false" />
    ...other properties...
</EntityType> 
```

**请注意，`Table2OtherColumn`它在 EndProperty 中，但不是实际 key 的一部分**。从 EndProperty 中删除它可以解决问题。

请注意，**Entity Framework 4** (Visual Studio 2010)**可以在 compile-time 检测到这个问题**。因此，如果您在追踪导致此问题的表/属性时遇到严重问题，只需将您的项目加载到 VS 2010 Express 中（在备份它之后！）并尝试编译。

# css - 如何创建（基本控制器）打印机友好版本？

> ID：727048
> 
> 赞同：1
> 
> 时间：2009-04-07T18:36:08.207
> 
> 标签：css, asp.net-mvc

我正在做一个项目，我想要一个我拥有的 Views 的打印机友好版本。有没有人已经这样做了并且有一些提示如何做到这一点？（使用什么样的路由等）

我正在考虑制作一个 PrintController。在 PrintController 中的一个方法的 ActionResult 中返回一个带有特定母版页的 View。

```
public ActionResult Index(string printView)
{
  return View(@"~/Views/Product/Index", "PrinterFriendly_MasterPage"); 
} 
```

Stephan Walter 不建议使用这种重定向（[tip #24](http://www.stadskanaal.nl/wonen_en_leven "普通视图")），因为它不是 MVC 的本意。

在视图上会有一个打印页面的链接，例如：
- 普通链接：www.example.com/product；**-打印**
链接：www.example.com/print/product ；

 **我不想使用 javascript 或 AJAX。只显示用户正在观看的同一个视图，只是使用不同的母版页（它将具有特定的打印样式表）。

* * *

感谢您的快速回复，但我不完全是我想要的方式。我已经有用于打印的特定 css 文件。

看看下面的荷兰网站，例如[Normal View](http://www.stadskanaal.nl/wonen_en_leven "普通视图")和[Print View](http://www.stadskanaal.nl/print/wonen_en_leven/ "打印视图")。

我想要一个显示相同视图但带有另一个母版页的链接。在另一个母版页中，我包含了用于打印的 css 文件。

因此，用户从浏览器菜单中获得了与“打印预览”几乎相同的视图。

这样做的好处是，它将符合 WCAG 标准。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T18:45:09.447

仅仅创建一个打印 css 来隐藏导航以及您不想在打印件上显示的任何其他内容怎么样。

有关更多信息，请参阅[http://meyerweb.com/eric/articles/webrev/200001.html](http://meyerweb.com/eric/articles/webrev/200001.html)和[http://www.alistapart.com/articles/goingtoprint/](http://www.alistapart.com/articles/goingtoprint/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T18:46:38.057

不要创建单独的视图。只需在链接中使用 media=print 创建一个打印特定的 CSS 文件，浏览器应该在打印时自动使用这个 CSS。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T15:58:30.420

为什么不在您的 CSS 链接中指定“媒体”属性？

```
<link href="normal.css" rel="stylesheet" media="screen" type="text/css" />
<link href="print.css" rel="stylesheet" media="print" type="text/css" /> 
```

这样，您可以使用 1 个母版页，但屏幕视图和打印视图都不同。

# .net - MagickNet C++ 源代码编译失败

> ID：727050
> 
> 赞同：0
> 
> 时间：2009-04-07T18:36:09.890
> 
> 标签：.net, c++, imagemagick

我正在尝试使用 ImageMagick 和 MagickNet 库中的源代码编译[MagickNet](http://midimick.com/magicknet/)类库 (DLL) 的工作副本。

我无法从创建者的主页获取 MagickNet 源文件的副本，因为它目前已关闭，因此我被迫从[此处](ftp://133.37.44.6/pub/graphics/ImageMagick/dot-net/)获取文件和 C++ 项目文件，这是通过 Google 搜索提供的。

[按照此处](http://www.imagemagick.org/script/install-source.php#windows)和[此处](http://72.14.235.132/search?q=cache%3Ahttp%3A%2F%2Fmidimick.com%2Fmagicknet%2Fstart.html)所述的说明，我使用“静态多线程 DLL”选项创建了一个项目并对其进行了编译，然后在确保所有路径都指向正确的文件夹之后，移至 MagickNet 项目文件并对其进行编译.

即便如此，我在编译时仍然收到此错误：

```
CORE_RL_magick_.lib(nt-base.obj) : error LNK2005: _DllMain@12 already defined in MSVCRT.lib(dllmain.obj) 
```

我还收到 371 个其他错误，所有这些都与“未解决的外部符号 xxxxxxxx”有关，最后一个错误描述了我有“195 个未解决的外部”。

我通过在 ImageMagick 解决方案中的 CORE_magick 项目中注释掉 nt-base.c 源文件中的 DllMain 声明，设法解决了上面的 DllMain 错误，但是仍然存在 372 个其他“未解决的外部”错误。

我对有类似问题的人进行了（谷歌）搜索，[有人](http://www.imagemagick.org/discourse-server/viewtopic.php?f=8&t=12585)说作者提供了一个预编译的 MagickNet DLL 下载，它可以 100% 工作，但是（正如我之前提到的）他的主页似乎无法访问现在。

我目前正在寻找以下解决方案之一：

1.  我的编译问题的解决方案，因为我根本不熟悉 C++，所以我可能会犯错误，
2.  另一个 MagickNet 源文件/项目 zip 的链接 100% 确认可以使用最新版本的 ImageMagick 正确编译，
3.  如果有人保留作者主页上的副本，则指向 MagickNet DLL 的 100% 工作预编译副本的链接。它应该是大约 3MB，因为它还包含 ImageMagick 库。

我真的很感激这些解决方案中的任何一种，因为我迫切需要 ImageMagick 操作和转换图像的能力，以及 MagickNet 的易用性。如果您需要更多信息，我可以提供更多详细信息。

此外，我正在使用 Visual Studio 2008 编译源文件，并且提供的项目可以毫无问题地进行转换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-04T23:40:57.677

我刚刚克服了这个问题，并成功地针对最新版本的 ImageMagick 编译了 MagickNET。我不得不做几件事。

1.  将 ImageMagick 配置为使用 StaticMTDll。
2.  编辑了 magick-config.h 以取消定义 X11 支持。
3.  从 ImageMagick 解决方案中删除了 CORE_xlib 项目。
4.  ImageMagick 的清理/重建
5.  将以下 lib 文件添加到 MagickNet 的链接器设置中

    CORE_DB_bzlib_.lib
    CORE_DB_coders_.lib
    CORE_DB_jbig_.lib
    CORE_DB_jpeg_.lib
    CORE_DB_magick_.lib
    CORE_DB_png_.lib
    CORE_DB_tiff_.lib
    CORE_DB_ttf_.lib
    CORE_DB_wand_.lib
    CORE_DB_wmf_.lib
    CORE_DB_zlib_.lib
    CORE_DB_libxml_.lib
    CORE_DB_jp2_.lib
    CORE_DB_lcms_.lib
    WS2_32.LIB

6.  建立MagickNet

我确实必须对 MagickNet 进行更新，因为自 MagickNet 网站上的源代码发布以来，方法已被弃用。我将尝试将存储库放在网上以共享整个解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-06T04:54:21.480

我遇到了完全相同的问题，Bromanko 的回答解决了它……加上一个小补充：

在 imagemagick 的 magick-config.h 中，除了注释掉这一行：

```
define MAGICKCORE_X11_DELEGATE 
```

...还需要注释掉该行：

```
define ProvideDllMain 
```

然后你会用煤气做饭。

谢谢布罗曼科...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T19:07:21.080

您看到链接器问题是由于（我猜，根据谷歌搜索似乎是真的）msvcrt 和 MFC 库的链接顺序。[MSDN上的这篇文章](http://support.microsoft.com/default.aspx?scid=http://support.microsoft.com:80/support/kb/articles/q148/6/52.asp&NoWebContent=1)似乎有一个解决方案 - 过时了，但基本问题是相同的，因此选项应该相似。

# c# - 如何在我的 C# 应用程序中嵌入字体？（使用 Visual Studio 2005）

> ID：727053
> 
> 赞同：16
> 
> 时间：2009-04-07T18:36:25.553
> 
> 标签：c#, fonts

在我正在开发的应用程序中嵌入 truetype 字体的最佳方法是什么？基本上我想确保在另一台机器上安装时我的应用程序可以使用特定的字体。我有 *.ttf 字体文件，只需要一种嵌入它或在应用程序运行时自动安装它的方法。

我是否需要在安装过程中设置安装程序来安装字体，或者我可以在应用程序运行时动态加载字体？事实上，两者都会很高兴知道。

该应用程序正在使用 .NET 2.0 在 C# 中开发。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-07T18:44:53.257

这篇[博文](http://www.siao2.com/2005/11/20/494829.aspx)应该对你有所帮助。

基本上，您将字体添加为嵌入式资源，然后将其加载到[PrivateFontCollection](http://msdn.microsoft.com/en-us/library/system.drawing.text.privatefontcollection.aspx)对象中。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-07T18:52:20.320

这是 Will 的答案，翻译成 C#（未经测试）：

```
PrivateFontCollection pfc = new PrivateFontCollection();

using (Stream fontStream = GetType().Assembly.GetManifestResourceStream("Alphd___.ttf"))
{
    if (null == fontStream)
    {
        return;
    }

    int fontStreamLength = (int) fontStream.Length;

    IntPtr data = Marshal.AllocCoTaskMem(fontStreamLength);

    byte[] fontData = new byte[fontStreamLength];
    fontStream.Read(fontData, 0, fontStreamLength);

    Marshal.Copy(fontData, 0, data, fontStreamLength);

    pfc.AddMemoryFont(data, fontStreamLength);

    Marshal.FreeCoTaskMem(data);
} 
```

连同他们的 Paint() 方法：

```
protected void Form1_Paint(object sender, PaintEventArgs e)
{
    bool bold = false;
    bool italic = false;

    e.Graphics.PageUnit = GraphicsUnit.Point;

    using (SolidBrush b = new SolidBrush(Color.Black))
    {
        int y = 5;

        foreach (FontFamily fontFamily in pfc.Families)
        {
            if (fontFamily.IsStyleAvailable(FontStyle.Regular))
            {
                using (Font font = new Font(fontFamily, 32, FontStyle.Regular))
                {
                    e.Graphics.DrawString(font.Name, font, b, 5, y, StringFormat.GenericTypographic);
                }
                y += 40;
            }
            if (fontFamily.IsStyleAvailable(FontStyle.Bold))
            {
                bold = true;
                using (Font font = new Font(fontFamily, 32, FontStyle.Bold))
                {
                    e.Graphics.DrawString(font.Name, font, b, 5, y, StringFormat.GenericTypographic);
                }
                y += 40;
            }
            if (fontFamily.IsStyleAvailable(FontStyle.Italic))
            {
                italic = true;
                using (Font font = new Font(fontFamily, 32, FontStyle.Italic))
                {
                    e.Graphics.DrawString(font.Name, font, b, 5, y, StringFormat.GenericTypographic);
                }
                y += 40;
            }

            if(bold && italic)
            {
                using(Font font = new Font(fontFamily, 32, FontStyle.Bold | FontStyle.Italic))
                {
                    e.Graphics.DrawString(font.Name, font, b, 5, y, StringFormat.GenericTypographic);
                }
                y += 40;
            }

            using (Font font = new Font(fontFamily, 32, FontStyle.Underline))
            {
                e.Graphics.DrawString(font.Name, font, b, 5, y, StringFormat.GenericTypographic);
                y += 40;
            }

            using (Font font = new Font(fontFamily, 32, FontStyle.Strikeout))
            {
                e.Graphics.DrawString(font.Name, font, b, 5, y, StringFormat.GenericTypographic);
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-07T18:39:52.987

它比这看起来容易；您可以将字体作为资源嵌入到您的应用中，并在应用的 Properties 命名空间中将其作为强类型属性进行访问。但是给定的链接应该是一个很好的起点。

* * *

对于禁用 VB 的用户：

[将字体添加为应用程序中的资源。](http://www.c-sharpcorner.com/UploadFile/yougerthen/Handleresourcefile05132008013024AM/Handleresourcefile.aspx) 调用资源 MyFontLol。您可以从 Properties.Resources.MyFontLol 访问此资源（作为字节数组）。

我没有测试以下，但它似乎是可行的：

```
public void LoadMyFontLolKThx()
{
    // get our font and wrap it in a memory stream
    byte[] myFont = Properties.Resources.MyFontLol;
    using (var ms = new MemoryStream(myFont))
    {
        // used to store our font and make it available in our app
        PrivateFontCollection pfc = new PrivateFontCollection();
        // The next call requires a pointer to our memory font
        // I'm doing it this way; not sure what best practice is
        GCHandle handle = GCHandle.Alloc(ms, GCHandleType.Pinned);
        // If Length > int.MaxValue this will throw
        checked
        {
            pfc.AddMemoryFont(
                handle.AddrOfPinnedObject(), (int)ms.Length); 
        }
        var font = new Font(pfc.Families[0],12);

        // use your font here
    }
} 
```

最后一点。PFC 将字体存储为 GDI+ 字体。这些与某些表单控件不兼容。从文档：

> 要使用内存字体，控件上的文本必须使用 GDI+ 呈现。使用 [SetCompatibleTextRenderingDefault](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.setcompatibletextrenderingdefault.aspx) 方法（传递 true）在应用程序或单个控件上设置 GDI+ 呈现，方法是将控件的[UseCompatibleTextRendering](http://msdn.microsoft.com/en-us/library/system.windows.forms.groupbox.usecompatibletextrendering.aspx) 属性设置为 true。某些控件无法使用 GDI+ 呈现。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-07T20:58:14.277

这可能不是最好的方法，但您不能只将字体包含在您的资源中，然后将其复制到 windows 目录上的字体文件夹吗？

# apache-flex - Flex 如何组织嵌入式资源

> ID：727056
> 
> 赞同：0
> 
> 时间：2009-04-07T18:36:46.737
> 
> 标签：apache-flex, resources

如何避免在源代码（.as 或 .mxml）中到处嵌入元数据？我找到了两种方法： 1\. 将所有内容嵌入到 CSS 中。但是从那里提取有点困难：

```
 var soundCSSClassDec:CSSStyleDeclaration = StyleManager.getStyleDeclaration("MySound");
    var MySoundClass:Class = (soundCSSClassDec.getStyle("url")) as Class;
    var myEmbeddedSound:Sound = new MySoundClass() as Sound;            
    myEmbeddedSound.play() 
```

2.  嵌入资源文件。很容易提取 - resourceManager.getResource("sounds","mySound")。但我觉得这种方法有问题。据我了解，resourceManager 是为本地化而设计的。

还有其他想法吗？

谢谢，阿列克谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T18:39:58.807

使用没有错`ResourceManager`：在您的情况下（非本地化应用程序），您只支持一种语言（N 种语言的本地化特殊情况 :)。

另一种方法是通过网络从某个服务器加载这些资源。当然，根据您的应用程序的捆绑/使用方式，这种方法可能效率低下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T01:43:21.003

另一种选择是定义一个“AssetLibrary”类，其中有很多类型为“Class”的公共静态常量；然后通过 MXML 中的绑定或通过 ActionScript 中的简单分配来引用它们。

```
public class AssetLibrary {
    [Embed(source='/assets/image_link.png')]
    public static const IMAGE_LINK : Class;
} 
```

使用 ResourceManager 也是一种完全有效的方法。从您的应用程序中将其外部化实际上是一种很好的做法，因为这将使以后对其进行本地化变得更加容易。

# sql - 在不借助 PL/SQL 的情况下从第二个表中查找相关值

> ID：727065
> 
> 赞同：1
> 
> 时间：2009-04-07T18:38:35.610
> 
> 标签：sql, oracle

我的数据库中有以下两个表：

a) 包含在特定日期获取的值的表格（您可以将这些视为温度读数）：

 `````
 sensor_id |       acquired      | value
 ----------+---------------------+--------
 1         | 2009-04-01 10:00:00 | 20
 1         | 2009-04-01 10:01:00 | 21
 1         | 2009-04 01 10:02:00 | 20
 1         | 2009-04 01 10:09:00 | 20
 1         | 2009-04 01 10:11:00 | 25
 1         | 2009-04 01 10:15:00 | 30
 ...

```` 

`读数之间的间隔可能不同，但 ( `sensor_id`, `acquired`) 的组合是唯一的。`

 `b) 第二个表格包含时间段和描述（您可以将这些视为，例如，有人打开散热器的时间段）：

 `````
 sensor_id |      start_date     |       end_date      | description
 ----------+---------------------+---------------------+------------------
 1         | 2009-04-01 10:00:00 | 2009-04-01 10:02:00 | some description
 1         | 2009-04-01 10:10:00 | 2009-04-01 10:14:00 | something else

```` 

`同样，时间段的长度可能不同，但对于任何给定的传感器，时间段都不会重叠。`

 `对于任何传感器和任何日期范围，我都希望得到这样的结果：

 `````
sensor id |     start date      | v1 |       end date      | v2 | description
----------+---------------------+----+---------------------+----+------------------
1         | 2009-04-01 10:00:00 | 20 | 2009-04-01 10:02:00 | 20 | some description
1         | 2009-04-01 10:10:00 | 25 | 2009-04-01 10:14:00 | 30 | some description

```` 

`或在文本中：给定 a`sensor_id`和日期范围`range_start`and `range_end`，找到与日期范围重叠的所有时间段（即`start_date < range_end`and `end_date > range_start`），对于这些行中的每一行，从时间值表中找到相应的值句点的`start_date`and （用and`end_date`找到第一行）。`acquired > start_date``acquired > end_date``

 `如果不是`start_value`and`end_value`列，这将是如何连接两个表的教科书简单示例。

我能否以某种方式在一条 SQL 语句中获得所需的输出，而无需编写 PL/SQL 函数来查找这些值？

除非我忽略了一些明显的东西，否则这不能用简单的子选择来完成。

数据库是 Oracle 11g，因此任何特定于 Oracle 的特性都是可以接受的。

编辑：是的，循环是可能的，但我想知道这是否可以通过单个 SQL 选择来完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T19:05:51.037

你可以试试这个。请注意最后的警告。

```
SELECT
    RNG.sensor_id,
    RNG.start_date,
    RDG1.value AS v1,
    RNG.end_date,
    RDG2.value AS v2,
    RNG.description
FROM
    Ranges RNG
INNER JOIN Readings RDG1 ON
    RDG1.sensor_id = RNG.sensor_id AND
    RDG1.acquired => RNG.start_date
LEFT OUTER JOIN Readings RDG1_NE ON
    RDG1_NE.sensor_id = RDG1.sensor_id AND
    RDG1_NE.acquired >= RNG.start_date AND
    RDG1_NE.acquired < RDG1.acquired
INNER JOIN Readings RDG2 ON
    RDG2.sensor_id = RNG.sensor_id AND
    RDG2.acquired => RNG.end_date
LEFT OUTER JOIN Readings RDG1_NE ON
    RDG2_NE.sensor_id = RDG2.sensor_id AND
    RDG2_NE.acquired >= RNG.end_date AND
    RDG2_NE.acquired < RDG2.acquired
WHERE
    RDG1_NE.sensor_id IS NULL AND
    RDG2_NE.sensor_id IS NULL 
```

这使用范围开始日期之后的第一个读数和结束日期之后的第一个读数（我个人认为使用开始和结束之前的最后一个日期会更有意义或最接近的值，但我不了解您的应用程序）。如果没有这样的阅读，那么您将一无所获。您可以将 INNER JOIN 更改为 OUTER，并根据您自己的业务规则添加额外的逻辑来处理这些情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T18:53:00.817

这似乎很简单。

1.  查找每个范围的传感器值。找到一行 - 我将调用该行的获取只是 X - 其中`X > start_date`不存在任何其他行`acquired > start_date`和`acquired < X`。对结束日期执行相同操作。

2.  仅选择满足查询的范围 - 查询提供的日期之前的 start_date 和之后的 end_date。

在 SQL 中，这将是这样的。

```
SELECT R1.*, SV1.aquired, SV2.aquired
FROM ranges R1
INNER JOIN sensor_values SV1 ON SV1.sensor_id = R1.sensor_id
INNER JOIN sensor_values SV2 ON SV2.sensor_id = R1.sensor_id  
WHERE SV1.aquired > R1.start_date
AND NOT EXISTS (
    SELECT *
    FROM sensor_values SV3
    WHERE SV3.aquired > R1.start_date
    AND SV3.aquired < SV1.aquired)
AND SV2.aquired > R1.end_date
AND NOT EXISTS (
    SELECT *
    FROM sensor_values SV4
    WHERE SV4.aquired > R1.end_date
    AND SV4.aquired < SV2.aquired)
AND R1.start_date < @range_start
AND R1.end_date > @range_end 
```

# c++ - 在 boost::vector 和 boost::matrix 中动态改变分配策略

> ID：727066
> 
> 赞同：0
> 
> 时间：2009-04-07T18:38:47.590
> 
> 标签：c++, templates, boost, interprocess, allocator

在我的新项目中，我正在构建一个数据管理模块。我想为上层提供一个简单的模板存储类型，例如

```
template<typename T>
class Data
{
 public:
  T getValue();
 private:

 boost::numeric::ublas::matrix<T> data;
} 
```

我的目标是，用一些不同的分配器更改数据分配器，例如 Boost.inter 进程分配器或 Boost.pool 分配器（Boost Ublas 矩阵和向量类将分配器作为模板参数）。并且只提供一个类和工厂方法来创建适当的分配器。虚拟基类可能很甜蜜，但我无法处理如何将它与模板一起使用。你们提供什么样的设计模式或解决方案？

编辑：

我将使用 boost.pool 和 boost.shared_memory_allocator。简而言之，我想拥有具有不同分配策略的不同类。但我的观点是程序的上层部分应该对此一无所知。对我来说真正的挑战是收集不同的模板类相同的基类。

编辑：对于想要将矩阵类与自定义分配器一起使用的人。

是这样的：

```
 using boost::numeric::ublas;

    template<typename T, class Allocator = boost::pool_allocator<T>>
    class
    {      
      public:
      matrix<T, row_major, std::vector<T,Allocator>> mData;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-07T18:43:41.090

您是否尝试在编译时根据类型交换分配器？您需要一个`if-else`模板和一些分配器类（模板）定义。

如果您想要运行时分配器，那就更容易了：您可以将基类（接口定义类）放在模板中，并根据您需要满足的任何条件传递适当的子类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T19:23:40.197

目前尚不清楚您想要什么，但作为在黑暗中的镜头，以下内容是否有帮助？

```
template<typename T>
class IData
{
 public:
  virtual T getValue() = 0;
  virtual ~IData() {}
};

template<typename T, typename Allocator=std::allocator<T> >
class Data : public IData<T>
{
 public:
  virtual T getValue();
 private:

 boost::numeric::ublas::matrix<T, Allocator> data;
} 
```

# c# - TCP 异步套接字抛出 10057

> ID：727074
> 
> 赞同：2
> 
> 时间：2009-04-07T18:40:41.533
> 
> 标签：c#, .net, sockets

我编写了以下代码：

```
 public static void BeginListen( int port )
    {
        IPAddress address = IPAddress.Any;
        IPEndPoint endPoint = new IPEndPoint( address, port );

        m_Socket = new Socket( AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp );

        m_Socket.Bind( endPoint );
        m_Socket.Listen( 8 );

        m_Socket.BeginAccept( new AsyncCallback( Accept ), null );
    }

    private static void Accept( IAsyncResult result )
    {
        Socket client = m_Socket.EndAccept( result );

        SocketData state = new SocketData( client, 32767 );

        m_Socket.BeginReceive( state.Buffer, 0, state.Buffer.Length, SocketFlags.None,
            new AsyncCallback( Receive ), state );

        m_Socket.BeginAccept( new AsyncCallback( Accept ), null );
    } 
```

当客户端尝试连接时，Accept() 中的 BeginReceive 调用会引发错误：

> 不允许发送或接收数据的请求，因为未连接套接字并且（当使用 sendto 调用在数据报套接字上发送时）未提供地址

这是什么原因造成的？我似乎无法放置它。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T18:48:51.343

您需要调用返回的`BeginReceive`（在您的情况下），而不是服务器（在您的情况下）：`Socket``EndAccept``client``Socket``m_Socket`

```
Socket client = m_Socket.EndAccept( result );
// ...
client.BeginAccept( new AsyncCallback( Accept ), null ); 
```

有一个示例显示了[MSDN](http://msdn.microsoft.com/en-us/library/6y709t3b.aspx)上的正确用法。

# regex - unix下隐藏文件的正则表达式

> ID：727075
> 
> 赞同：2
> 
> 时间：2009-04-07T18:40:53.513
> 
> 标签：regex, cmake

我正在寻找一个正则表达式来匹配以“。”开头的每个文件。在一个目录中。

我正在使用 CMake（来自 CMake doc：“CMake 需要正则表达式，而不是 glob”）并且想要忽略每个以点开头的文件（隐藏文件）但是`"\..*"`或者`"^\..*"`不起作用:(

奇怪的是：这有效（感谢rq的[回答](https://stackoverflow.com/questions/727075/regular-expression-for-hidden-files-under-unix/729082#729082)）并删除所有隐藏文件和临时文件（“〜”终止文件）

```
file(GLOB DOT ".*")
file(GLOB TILD "*~")

set (CPACK_SOURCE_IGNORE_FILES "${DOT};${TILD}") 
```

但是我找不到正确的东西直接写入`CPACK_SOURCE_IGNORE_FILES`以获得相同的结果！

这是这个变量的“ [doc](http://www.cmake.org/Wiki/CMake:CPackConfiguration) ”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T08:43:36.953

听起来 GLOB 可能是你想要的。

试试这个。打开文件“test.cmake”并添加以下内容：

```
file(GLOB ALL "*")
file(GLOB DOT ".*")
file(GLOB NOTDOT "[^.]*")

message("All Files ${ALL}")
message("Dot files ${DOT}")
message("Not dot files ${NOTDOT}") 
```

然后创建几个测试文件：

```
touch .dotfile
touch notdot 
```

然后运行“cmake -P test.cmake”。输出是：

```
All Files /tmp/cmake_test/.dotfile;/tmp/cmake_test/notdot;/tmp/cmake_test/test.cmake
Dot files /tmp/cmake_test/.dotfile
Not dot files /tmp/cmake_test/notdot;/tmp/cmake_test/test.cmake 
```

这是用 cmake 2.6.0 测试的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T18:42:44.510

使用标准正则表达式语法：

```
^\..* 
```

由于 CMake 显然不喜欢这样，它可能会使用类似的东西：

```
^\\..* 
```

不过，这只是一个猜测，因为我没有/使用 CMake。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-05T23:39:13.747

以下单行将完成工作（隐藏隐藏和波浪号（“~”）终止的文件）：

```
set(CPACK_SOURCE_IGNORE_FILES "/\\\\..*$;~$;${CPACK_SOURCE_IGNORE_FILES}") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T18:42:44.680

你需要逃避它。

```
^\..* 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T20:14:07.283

试试这个：

```
^[.].* 
```

# iphone - 为什么 Xcode 的 codeSense 功能有时只能工作？

> ID：727077
> 
> 赞同：3
> 
> 时间：2009-04-07T18:41:07.757
> 
> 标签：iphone, xcode

例如，当我输入

```
[UIView commitAni 
```

那么我希望它会像这样完成它：

```
[UIView commitAnimations 
```

所以我有：

```
[UIView commitAnimations]; 
```

但在这里，它没有。虽然我已经包含了 CoreGraphics.framework 奇怪：当我尝试使用其他与动画相关的东西时，它可以工作：

```
[UIView setAnimationDura 
```

将完成到：

```
[UIView setAnimationDuration:<#(NSTimeInterval)#> 
```

但是这个不会被codeSense识别：

```
[UIView setAnimationTr 
```

...在这里，我希望完成

```
[UIView setAnimationTransition 
```

但它不会发生。这里可能是什么问题？我不认为我错过了一个包含的框架，因为一切都可以很好地编译并且可以在 iPhone 模拟器中运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-10T07:51:26.757

这似乎是静态代码分析工具 (Clang) 和 CodeSense 之间的冲突。见 [http://www.openradar.appspot.com/7338181](http://www.openradar.appspot.com/7338181)

我关闭了“运行静态分析器”构建设置并单击了一般下的“重建代码感知索引”，它为我解决了这个问题。但是，我也想要静态代码分析。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T18:49:25.583

那是（为了简单起见，我假设您没有更改键绑定）Cmd-。“给我下一个完成”或 Cmd-，“给我完成菜单”，还是“等到有东西出现并点击返回”？我经常看到最后一个未能给我想要的完成，其中 Cmd- 将显示正确的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T18:49:21.497

通常，当 codeSense 没有给我正确的完成时，我键入 ESC 以显示所有可能性，然后选择我想要的。

当 codeSense 回答：*No completion found*时，大多数情况下对象声明中存在拼写错误，或者在完成请求附近缺少`;`或`)`或某处。`]`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-14T21:01:56.087

刚刚使用 iphone 3.0 sdk 升级到 xcode3.1.3。Codesense 不会自动完成 UIScreen mainScreen 等简单的事情。它只能找到 UIScreen main()。我已经尝试过多次重建索引，但没有运气。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T19:44:18.877

听起来您可能已经尝试过了，但是每当我收到无响应的代码感知时，我都会保存我最近添加导入的所有文件。似乎保存文件会更新新引用项目的代码感知范围。

# programming-languages - Scala 有什么了不起的？

> ID：727078
> 
> 赞同：31
> 
> 时间：2009-04-07T18:41:27.100
> 
> 标签：programming-languages, scala, language-features

除了类型系统之外*，*是什么让 Scala 成为如此出色的语言？我读到的几乎所有关于该语言的内容都将“强类型”作为使用 Scala 的一个重要原因，但必须不止于此。还有哪些其他引人注目和/或很酷的语言特性使 Scala 成为真正有用的工具？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-07T18:49:15.180

以下是一些让我更喜欢 Scala 的东西（比方说，通常的 Java）：

a) 类型推断。Java的做法：

```
Map<Something, List<SomethingElse>> list = new HashMap<Something, List<SomethingElse>>() 
```

..与Scala相比相当冗长。如果您提供这些列表之一，编译器应该能够弄清楚。

b) 一阶函数。同样，这个功能可以用类来模拟，但它很丑。

`map`c) 具有和的集合`fold`。这两个与 (b) 相关联，而且这两个也是我每次必须编写 Java 时都希望得到的东西。

d) 模式匹配和案例类。

e) 方差，这意味着如果`S extends T`，那么`List[S] extends List[T]`也是如此。

再加上一些静态类型的好处，我很快就被这门语言卖掉了。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-19T11:21:11.600

这是一堆语言中最好的部分的混搭，有什么不值得喜欢的：

*   Ruby 的简洁语法
*   Java的性能
*   Erlang 的演员支持
*   闭包/块
*   地图和数组的便捷简写

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2010-09-14T22:31:38.557

Scala 经常因具有闭包和隐式而广为人知。这并不奇怪，因为缺少闭包和显式类型可能是 Java 样板的两个最大来源！

但是，一旦您对其进行更深入的研究，它就会远远超出 Java-without-the-annoying bits，也许 Scala 的最大优势不是一个特定的命名功能，而是它在统一其他答案中提到的所有功能方面有多成功.

## 后功能

比如面向对象和函数式编程的结合：因为函数是对象，Scala能够让Maps实现Function接口，所以当你使用map来查找一个值时，它在语法上与使用函数计算一个没有区别价值。如此完美地统一了这些范式，Scala 确实是一种后函数式语言。

或运算符重载，这是通过实际上没有运算符来实现的，它们只是中缀表示法中使用的方法。所以`1 + 2`只是`+`在一个整数上调用该方法。如果该方法被命名`plus`，那么您将使用它，因为`1 plus 2`它与`1.plus(2)`. 由于另一种功能组合，这成为可能；Scala 中的一切都是对象，没有原语，所以整数可以有方法。

## 其他功能融合

还提到了类型类，它是通过更高种类的类型、单例对象和隐式的组合来实现的。

其他可以很好地协同工作的特性是案例类和模式匹配，允许您轻松构建和解构代数数据类型，而无需手动编写 Java 所需的所有繁琐的相等、哈希码、构造函数和 getter/setter 逻辑。

默认情况下指定不变性、提供惰性值和提供一流的函数都结合在一起，为您提供了一种非常适合构建高效函数式数据结构的语言。

清单还在继续，但我已经使用 Scala 超过 3 年了，我几乎每天都对一切都可以很好地协同工作感到惊讶。

## 高效和多功能

Scala 也是一种小型语言，其规范（令人惊讶！）只需要大约是 Java 的 1/3 大小。这部分是因为 Java 在 Scala 简化的规范中有很多特殊情况，部分是因为删除了原语和运算符等特性，部分是因为许多功能已从语言转移到库中。

这样做的好处是，Scala 库作者可用的所有技术也可供任何 Scala 用户使用，这使其成为定义您自己的控制流结构和构建 DSL 的绝佳语言。这已经在像 Akka 这样的项目中发挥了很大的作用 - 一个 3rd-party Actor 框架。

## 深的

最后，它扩展了所有的编程风格。

运行时解释器（称为 REPL）允许您在交互式会话中非常快速地探索想法，并且 Scala 文件也可以作为脚本运行而无需显式编译。当与类型推断相结合时，这给 Scala 一种动态语言的感觉，例如 Ruby、Perl 或 bash 脚本。

另一方面，特征、类、对象和自类型允许您构建基于不同组件并使用依赖注入的完整企业系统，而无需第三方工具。Scala 还与 Java 库的集成水平几乎与本机 Java 相当，并且通过在 JVM 上运行可以利用该平台提供的所有速度优势，并且可以完美地用于诸如 tomcat 之类的容器中，或者操作系统吉。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-04-07T23:15:33.730

我是 Scala 新手，但我的印象是：

真正好的 JVM 集成将是驱动因素。JRuby 可以调用 java，java 可以调用 JRuby 代码，但它是显式调用另一种语言，而不是 Scala-Java 的干净集成。因此，您可以使用 Java 库，甚至可以在同一个项目中混合搭配。

当我意识到驱动下一个伟大语言的东西是简单的并发时，我开始关注 scala。从性能的角度来看，JVM 具有良好的并发性。我敢肯定有人会说 Erlang 更好，但 Scala 实际上是普通程序员可以使用的。

Java 失败的地方在于它非常冗长。创建和传递 Functor 需要太多的字符。Scala 允许将函数作为参数传递。

在 Java 中无法创建联合类型，或将接口应用于现有类。这些在 Scala 中都很容易。

静态类型通常会带来冗长的巨大损失。Scala 消除了这个缺点，同时仍然提供了静态类型的优点，即编译时类型检查，它使编辑器中的代码辅助更容易。

扩展语言的能力。这是让 Lisp 持续数十年的原因，也让 Ruby on Rails 成为可能。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-05-13T06:00:16.143

类型系统确实是 Scala 最显着的特征。它也有很多语法上的便利，比如 Java。

但对我来说，Scala 最引人注目的特性是：

*   [一流的模块](http://okmij.org/ftp/ML/first-class-modules/)。
*   [更高种类的类型](http://lambda-the-ultimate.org/node/2579)（类型构造函数多态性）。
*   [隐含](http://www.scala-lang.org/node/114)的。

实际上，这些特性让你近似（并且在某些方面超越）Haskell 的[类型类](http://en.wikipedia.org/wiki/Type_class)。结合起来，它们可以让你编写非常模块化的代码。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-16T21:08:14.943

不久：

*   您可以获得 Java 库的强大功能和平台独立性，但没有样板和冗长。
*   您将获得 Ruby 的简单性和生产力，但具有静态类型和编译的字节码。
*   您可以获得 Haskell 的功能优势和并发支持，但没有完全的范式转换和面向对象的好处。

我发现它的所有宏伟功能特别有吸引力，其中包括：

*   大多数需要加载 Java 中的样板代码的面向对象设计模式都得到原生支持，例如 Singleton（通过对象）、Adapter、Decorator（通过特征和隐式）、Visitor（通过模式匹配）、策略（通过闭包）等.
*   您可以非常简洁地定义您的领域模型和 DSL，然后您可以使用必要的功能（通知、关联处理；解析、序列化）来扩展它们，而无需代码生成或框架。
*   最后，与支持良好的 Java 平台具有完全的互操作性。您可以在两个方向上混合使用 Java 和 Scala。在经历了 Java 使代码难以维护的烦恼之后，切换到 Scala 并没有太多的惩罚和兼容性问题。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-04-07T18:46:33.097

[函数式编程引入 JVM](http://blog.objectmentor.com/articles/2008/08/05/the-seductions-of-scala-part-ii-functional-programming)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-07-15T20:32:56.770

The great features of Scala has already been mentioned. One thing that shines through past all features though, is how tastefully everything is integrated.

Scala manages to be one of the most powerful language around without having a feeling of having bolted on features in haste. Neither are the language an academic exercise in proving a point. Innovation and really advanced concepts are brought in to the language with uncanny practicality and elegance.

In short: Martin Odersky is a pure design genius. That is what's so great about Scala!

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-04-07T18:45:15.143

据说让 Scala 代码在多个处理器上[并发运行是非常容易的。](http://www.infoq.com/news/2008/06/scala-vs-erlang)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-04-16T11:37:01.007

控制流的表现力。例如，拥有需要以某种方式处理的数据集合是很常见的。这可能是一个交易列表，其中的处理涉及按某些属性（投资工具的货币）分组，然后进行求和（可能获得每种货币的总数）。

在 Java 中，这涉及分离出一段代码来进行分组（几行 for 循环），然后是另一段代码来进行求和（另一个 for 循环）。在 Scala 中，这种类型的事情通常可以在一行代码中使用函数式编程然后折叠来实现，这非常富有表现力地读取 l-to-r。

当然，这只是 Java 上的函数式语言的一个论据。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-04-30T21:49:06.043

我想添加多范式（OO 和 FP）性质，让 Scala 比其他语言更具优势

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2011-05-20T20:19:24.597

每天编写 Java 代码你会变得越来越痛苦，每天编写 Scala 代码你会变得更快乐。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-07T18:58:07.310

这里有一些关于函数式语言吸引力的相当深入的解释。

[函数式语言（特别是 Erlang）如何/为什么能够很好地扩展？](https://stackoverflow.com/questions/474497/how-why-do-functional-languages-specifically-erlang-scale-well/474594)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-01-16T14:59:04.777

如果我们放弃功能讨论并谈论风格，我会说这是编码的管道风格。您从某个对象或集合开始，键入点和属性或点和转换，然后执行此操作，直到形成所需的结果。通过这种方式，很容易编写一个易于阅读的转换链。一定程度上的特征也将允许您应用相同的方法来构造类型。

# c# - 分层树视图实现

> ID：727079
> 
> 赞同：1
> 
> 时间：2009-04-07T18:41:48.583
> 
> 标签：c#, asp.net

从填充了公司所有员工的 SQL 数据库表在 asp.net（C#）中生成分层树视图的最佳方法是什么？我永远不会知道我将从哪个级别或员工开始。任何链接或方向将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T18:45:37.280

**选项一**：从数据库中以 xml 形式获取分层数据（使用 SQL Server 2005 及更高版本的 FOR XML 语句）然后将其反序列化为业务实体对象或直接在 UI 中用作数据源（treeview 控件支持 XML 数据源）。使用 SQL Server 2008，您还可以使用 HIERARCHYID 字段而不是 ParentID，这简化了与分层数据存储和检索相关的事情，使用它从指定节点检索数据的 SELECT 语句将更加简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T19:04:03.880

在以下位置查看修改的预序树遍历技术：

[http://www.sitepoint.com/article/hierarchical-data-database/](http://www.sitepoint.com/article/hierarchical-data-database/) [http://en.wikipedia.org/wiki/Tree_traversal](http://en.wikipedia.org/wiki/Tree_traversal) [http://www.intelligententerprise.com/001020/celko.jhtml?_requestid=1266295](http://www.intelligententerprise.com/001020/celko.jhtml?_requestid=1266295) [http://iamcam.wordpress.com/2006/03/17/storing-hierarchical-data-in-a-database-part-1/](http://iamcam.wordpress.com/2006/03/17/storing-hierarchical-data-in-a-database-part-1/)

# c# - 解析覆盖数据的原始 NCover XML 文件

> ID：727092
> 
> 赞同：0
> 
> 时间：2009-04-07T18:45:05.813
> 
> 标签：c#, xml, ncover

我正在尝试从 NCover 使用 C# 生成的 XML 文件中提取覆盖数据。XML 文件如下所示：

```
<namespace n="namespace" t="11" fp="11" u="0" c="100">
<class n="foo" t="11" fp="11" u="0" c="100">
      <method n="foo1" t="1" fp="1" u="0" c="100" l="16" />
      <method n="foo2" t="1" fp="1" u="0" c="100" l="13" />
</class> 
```

现在，我正在使用模式匹配来判断 c 的值 > 0 时，然后在后面查找方法名称，但这确实很麻烦。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-07T18:55:18.627

您的意思是您没有使用标准的 XML API（SAX、DOM 或其他）来处理文件吗？那是勇敢的……嗯，危险的，真的。

使用 XPath，很容易找到 c>0 的元素。这是一个（未经测试的）表达式，应该可以解决问题：

```
/class/method[@c>0] 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-02T11:08:43.310

What version of NCover are you trying to parse?

NCover 3 has a report format that has the numbers rolled up for you.

Joe Feser

NCover

# sql-server - 在 SSRS 的误差条形图中使用常量

> ID：727098
> 
> 赞同：1
> 
> 时间：2009-04-07T18:45:40.163
> 
> 标签：sql-server, reporting-services, charts, ssrs-2008

我有一个带有错误条形图的 SSRS 2008 报告。它绘制日期（x 轴）与分数（y 轴），上下误差范围为 +10/-10。但在数据集中，我也有两组平均值（美国和公司的）。

我想将这些平均值显示为常数。它应该是一条贯穿图表的水平线。

在图表中，我有一个类别字段：日期。作为数据字段：分数、美国平均分和公司平均分。到目前为止，我可以绘制所有这些点，但似乎平均值的点被简单地绘制为点，并被视为应该具有上/下误差范围的点。

我的问题是，我怎样才能让这些平均值不显示为具有范围的点，而是显示为连接为直线的线性常数？似乎使用错误条形图，它只想绘制带范围的点。

（我有我所拥有的和我想要的的截图，但我的工作是阻止任何图像托管站点。如果这仍然不清楚，我会尝试稍后上传图像。）

先感谢您。

（更新）为了清楚起见，两个平均值没有计算出来，它们作为检索数据集的一部分作为列存在。所以对于每一行，这些值总是相同的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T21:23:15.567

事实证明，SSRS 图表中的每个系列，都可以更改图表类型。就我而言，我必须将其更改为折线图以使常数显示为水平线。

因此，虽然图表本身是一个误差条形图，但每个系列都可以更改为所需的任何条形图。

（是我的同事发现了这个属性——所以对他来说是道具）

# visual-studio-2008 - 哪些 Visual Studio 插件让您更加痛苦？杀死你的IDE？

> ID：727113
> 
> 赞同：2
> 
> 时间：2009-04-07T18:49:19.517
> 
> 标签：visual-studio-2008, add-in

我最近不得不重新安装 VS 2008，因为它一直在崩溃（我怀疑是由于某些插件）。我只是想知道是否有任何“使用风险自负”的视觉工作室插件。有没有人在使用 Visual Studio 时看到一个对话框弹出询问名为 JIRA 的错误详细信息？一旦我开始获得这些对话框，我的 IDE 就开始崩溃。

这不是要创建一个仇恨列表，而是一个预防性的插件列表，这些插件可能会破坏您未保存的工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T18:54:47.477

当我加载 XAML 文件时，Powercommands 导致 VS2008 崩溃。我在[这里](http://irwinj.blogspot.com)写了博客。有一个修复，它是一个方便的小插件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T18:50:35.207

我已经看到JetBrains的**Resharper发生了这种情况。**通常重新启动 IDE 会解决这个问题。它在以后的版本中发生的较少。

# visual-studio-2008 - PerfConsole 和 Visual Studio 2008 Team System Profiler

> ID：727117
> 
> 赞同：0
> 
> 时间：2009-04-07T18:49:47.317
> 
> 标签：visual-studio-2008, profiler

[PerfConsole](http://blogs.msdn.com/joshwil/archive/2006/08/04/688599.aspx)是否适用于 VS 2008 Team System Profiler 输出的输出？（.vsp 文件）

当我尝试在输出文件上运行“加载”时，我收到一条错误消息：

```
"Couldn't match to either expected sampled or instrumented profile schema,  defaulting to sampled" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-10T00:27:09.300

尽管 PerfConsole 输出了此错误消息，但它仍然应该可以正常工作，您是否会在加载配置文件的其余部分时遇到故障？

# logging - Log4J - 解析类/方法/行引用的速度

> ID：727119
> 
> 赞同：1
> 
> 时间：2009-04-07T18:50:34.473
> 
> 标签：logging, performance, log4j

log4J 是否仍然通过生成异常和检查堆栈跟踪来收集类、方法和行号？

或者，自从 Sun 包含他们自己的日志框架后，Java 已经被优化了。

如果没有，为什么从那以后没有进行任何优化。快速有效地获取类、方法和行号的主要挑战是什么？

虽然我讨厌注释并尽量避免使用它们，但 log4J 没有使用它，例如：

@log4j-class MyClass

@log4j-方法 currentMethodOne

至少这可以避免一些公司重复写入/复制方法名称作为其日志消息的第一部分的坏习惯（这非常烦人）。

谢谢，

杰奇！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-04-07T21:06:45.973

根据[这个](http://logging.apache.org/log4j/1.2/changes-report.html)页面，Log4j 的最后一次更新是在 2007 年 8 月。我从未听说过注释支持，也不明白它有什么用途。

至于方法名称是日志消息，您可以随时编辑`log4j.properties`或`log4j.xml`配置文件，并更改所需附加程序的[布局模式](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/PatternLayout.html)。该模式将适用于您自己的类和使用 log4j 的任何 3rd 方库 - 这是使用记录器的目的之一。

只需省略`M`布局模式中的 ，Log4j 就不会收集调用者信息。

# c# - 从 Windows 服务更新 ASP.Net 成员资格

> ID：727123
> 
> 赞同：1
> 
> 时间：2009-04-07T18:51:04.240
> 
> 标签：c#, .net, authentication, windows-services, asp.net-membership

我正在为一家物业管理公司做一个项目。后端系统存储所有租户和物业组合，前端网站允许用户查看他们的包裹、服务请求等。

我需要编写一个 Windows 服务，从后端提取他们的信息并将其放入成员数据库中。

我不知道如何配置服务以连接到会员提供商。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T18:57:56.423

您基本上可以像使用 Web 应用程序一样使用它，关键是您的应用程序和 Web 应用程序必须具有相同的 machinekey 值。否则密码将不会以正确的方式加密或解密。

这是一个教程，可以帮助您[从 Windows 应用程序](http://www.theproblemsolver.nl/usingthemembershipproviderinwinforms.htm)中使用它。对于您的 Windows 服务，该过程应该是相同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T18:56:53.850

在解决方案资源管理器中打开我的项目文件，然后选择服务选项卡。勾选“启用客户端应用服务”选项，基本填空。

替代方案是创建一个 Web 服务，它将为您处理到会员提供程序中，或者让您的 Windows 服务手动操作会员数据结构（假设它们在数据库或类似选项中）。

# php - 如何使用比根更深的 PHP DOM 向 XML 添加新元素？

> ID：727132
> 
> 赞同：3
> 
> 时间：2009-04-07T18:54:21.190
> 
> 标签：php, xml, dom, xpath

我可以在网上找到的所有关于此的示例都涉及简单地将内容添加到文档根目录的 XML 文件中，但我确实需要做的比这更深入。

我的 XML 文件很简单，我有：

```
<?xml v1 etc>
<channel>
<screenshots>
<item>
  <title>Image Title</title>
  <link>www.link.com/image.jpg</link>
</item>
</screenshots>
</channel> 
```

我想要做的就是添加新的“项目”元素，每个元素都有一个标题和链接。我知道我需要使用 PHP DOM，但是对于如何对其进行编码以便它在“屏幕截图”中添加数据而不是覆盖整个文档，我感到很困惑。我怀疑我可能也需要使用 XPath，但我不知道怎么做！

我从在线示例中拼凑的代码看起来像这样（但我确定它是错误的）

```
$newshottitle = "My new screenshot";
$newshotlink = "http://www.image.com/image.jpg";

$dom = newDomDocument;
$dom->formatOutput = true;
$dom->load("../xml/screenshots.xml");

$dom->getElementsByTagName("screenshots");
$t = $dom->createElement("item");
$t = $dom->createElement("title");
$t->appendChild($dom->createTextNode("$newshottitle"));

$l = $dom->createElement("link");
$l->appendChild($dom->createTextNode("$newshotlink"));

$dom->save("../xml/screenshots.xml"); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-07T19:43:08.513

> 在文档根目录向 XML 文件添加内容，但我确实需要做的更深入。

您目前没有在任何地方添加内容！您创建带有文本的 <title> 和 <link> 元素节点，然后对它们不做任何事情。您应该将它们传递到 <item> 元素节点上的 'appendChild' 中（您当前正在创建它并通过不将其分配给变量而立即将其丢弃）。

这是一个起点：

```
$screenshots= $dom->getElementsByTagName("screenshots")[0];

$title= $dom->createElement("title");
$title->appendChild($dom->createTextNode($newshottitle));
$item= $dom->createElement("item");
$item->appendChild($title);
$screenshots->appendChild($item); 
```

# memory - .NET 应用程序中的内存映射文件

> ID：727139
> 
> 赞同：0
> 
> 时间：2009-04-07T18:56:24.477
> 
> 标签：memory, file-io

我正在使用内存映射文件为 ASP.NET 应用程序缓存大量数据。目前我正在使用 global.asax 事件打开文件并获取我缓存在应用程序对象中的内存映射文件句柄。如果我将该句柄取消引用到一个指针并尝试在我的 httphandler 中缓存该指针，当我引用该指针时我会得到一个保护异常，因此我将缓存到内存映射文件的句柄并将其取消引用到我的 httphandler 中的指针。这似乎工作正常并且非常快，所以我假设它只是一次将文件加载到真实内存中。问题是，当负载增加时，我会同时运行多个 httphandler 实例，并且每个实例似乎都将句柄取消引用到不同的地址。这会导致很快耗尽地址空间。没有达到 64 位，有没有办法强制托管代码在线程之间共享一块公共内存？有没有更好的方法来完成我在这里尝试做的事情？

提前致谢，

布赖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-07T19:14:45.447

我想您可以从单例中提供指向内存映射文件的指针，对吗？

# wpf - 动态应用程序级资源在 ElementHost 中托管时不是动态的

> ID：727141
> 
> 赞同：5
> 
> 时间：2009-04-07T18:56:29.513
> 
> 标签：wpf, winforms-interop, elementhost

我在 WinForms 容器中托管 WPF UserControl。现在，我希望能够为 UserControl 设置主题/皮肤。为此，我有几个定义“皮肤”的资源字典。当我的应用程序启动时，我创建了一个“新 System.Windows.Application()”，以便 Application.Current 存在。为了改变主题，旧皮肤被删除，新皮肤在运行时被合并到应用程序级资源字典中。但是，这不会更改 UserControl 中任何动态引用的资源。我在一个直接的 WPF 应用程序中尝试了这个，它工作得很好。我错过了什么，或者根本不可能做到这一点？顺便说一句，如果我在初始化 UserControl 之前将皮肤添加到应用程序资源中，它将起作用，但之后我无法更改皮肤。

以最基本的方式回购这个：

创建一个新的 WinForms 应用程序。将 WPF UserControl 添加到应用程序。这很简单：

```
<UserControl ...>
   <Grid>
      <Button
         Background="{DynamicResource ButtonBG}"/>
   </Grid>
</UserControl> 
```

创建两个 ResourceDictionaries，White.xaml 和 Black.xaml（或其他），它们具有 SolidColorBrush，键为 ButtonBG，具有各自的颜色。在 Form1.cs 中，添加两个 Button 和一个 ElementHost。将 ElementHost 的子级设置为我们刚刚创建的 UserControl 的一个实例。将按钮连接到交换皮肤的事件：

```
private void White_Click(object sender, EventArgs e)
{
   Application.Current.Resources.MergedDictionaries[0] = 
      (ResourceDictionary)Application.LoadComponent(
         new Uri(@"\WpfThemes;component\White.xaml", UriKind.Relative)));
}

private void Black_Click(object sender, EventArgs e)
{
   Application.Current.Resources.MergedDictionaries[0] = 
      (ResourceDictionary)Application.LoadComponent(
         new Uri(@"\WpfThemes;component\Black.xaml", UriKind.Relative)));
} 
```

在 Program.cs 中，确保 Application.Current 存在并设置初始皮肤：

```
[STAThread]
static void Main()
{
   new System.Windows.Application();

   Application.Current.Resources.MergedDictionaries[0] =
      (ResourceDictionary)Application.LoadComponent(
         new Uri(@"\WpfThemes;component\White.xaml", UriKind.Relative)));

   ...
} 
```

现在，当单击白色按钮时，我希望用户控件中的按钮变为白色，当单击黑色按钮时，我希望按钮变为黑色。然而，这不会发生。

有谁知道为什么？有解决办法吗？

**编辑：**想法：也许，如果有一种方法可以在主题更改时强制重新评估 DynamicResources，那将起作用。

谢谢，尘土飞扬

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T18:40:24.537

我认为这可能是 WPF 框架中一个被忽视的问题。

从我可以通过 Reflector 得知，似乎当`Application`资源字典发生灾难性更改时（这种更改可能会产生广泛的影响，例如添加、删除或替换皮肤），有代码会遍历`Windows`所有申请并迫使他们重新评估他们的`DynamicResources`. 但是，我认为WPF 中的*顶级*`ElementHost`元素（如s）并没有得到相同的处理。这导致了我正在经历的行为。

我对这个问题的解决方法是手动逐个检查我的所有`ElementHost`s 并添加、删除或替换皮肤`ResourceDictionary`文件。它并不完美，但它可以完成工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-25T15:56:56.437

当我试图做类似的事情时，WPF 博士来救我。他展示了如何在 WinForms 中创建 Application 对象。现在，您可以像在 WPF 应用程序中一样将所有内容都引用为 StaticResource。

[http://drwpf.com/blog/2007/10/05/managing-application-resources-when-wpf-is-hosted/](http://drwpf.com/blog/2007/10/05/managing-application-resources-when-wpf-is-hosted/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-07-24T07:44:23.147

另一种解决方法是创建一个虚拟窗口并将元素主机的内容指定为内容。如果您查看应用程序并检查它如何处理资源字典的更改，您会发现它只通知窗口..

您应该提醒的唯一一件事是永远不要显示窗口（-> 异常），并在处理 elementhost 时将其关闭，以便应用程序可以正常关闭。

# c# - 这些单元测试好吗？

> ID：727142
> 
> 赞同：4
> 
> 时间：2009-04-07T18:56:44.570
> 
> 标签：c#, .net, unit-testing, tdd, mocking

我正在尝试掌握测试驱动的开发，我想知道这些单元测试是否可以。我有一个如下所示的界面：

```
public interface IEntryRepository
{
    IEnumerable<Entry> FetchAll();
    Entry Fetch(int id);
    void Add(Entry entry);
    void Delete(Entry entry);
} 
```

然后实现该接口的这个类：

```
public class EntryRepository : IEntryRepository
{
    public List<Entry> Entries {get; set; }

    public EntryRepository()
    {
        Entries = new List<Entry>();
    }

    public IEnumerable<Entry> FetchAll()
    {
        throw new NotImplementedException();
    }

    public Entry Fetch(int id)
    {
        return Entries.SingleOrDefault(e => e.ID == id);
    }

    public void Add(Entry entry)
    {
        Entries.Add(entry);
    }

    public void Delete(Entry entry)
    {
        Entries.Remove(entry);
    }
} 
```

这些是我到目前为止编写的单元测试，它们很好还是我应该做一些不同的事情？我应该嘲笑 EntryRepository 吗？

```
[TestClass]
public class EntryRepositoryTests
{
    private EntryRepository rep;

    public EntryRepositoryTests()
    {
        rep = new EntryRepository();
    }

    [TestMethod]
    public void TestAddEntry()
    {
        Entry e = new Entry { ID = 1, Date = DateTime.Now, Task = "Testing" };
        rep.Add(e);

        Assert.AreEqual(1, rep.Entries.Count, "Add entry failed");
    }

    [TestMethod]
    public void TestRemoveEntry()
    {
        Entry e = new Entry { ID = 1, Date = DateTime.Now, Task = "Testing" };
        rep.Add(e);

        rep.Delete(e);
        Assert.AreEqual(null, rep.Entries.SingleOrDefault(i => i.ID == 1), "Delete entry failed");
    }

    [TestMethod]
    public void TestFetchEntry()
    {
        Entry e = new Entry { ID = 2, Date = DateTime.Now, Task = "Testing" };
        rep.Add(e);

        Assert.AreEqual(2, rep.Fetch(2).ID, "Fetch entry failed");
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-07T19:23:36.627

就在我的头顶...

尽管您对 add 的测试实际上只测试了框架：

*   您已添加 1 项，这很好
*   添加很多项目怎么样（我的意思是，荒谬的数量 - 容器添加失败的 n 个条目的值是多少？）
*   不添加项目怎么办？（空条目）
*   如果您将项目添加到列表中，它们是否按特定顺序排列？他们应该是吗？

同样与您的提取：

*   如果 x > rep.Count 在您的 fetch(x) 中会发生什么？
*   如果 x < 0 会发生什么？
*   如果代表是空的会发生什么？
*   x 是否符合性能要求（它的算法复杂性是多少？当只有一个条目并且有大量条目时是否在范围内？

[实用单元测试](https://rads.stackoverflow.com/amzn/click/com/0974514020)一书中有一个很好的清单（好书，强烈推荐）

*   结果对吗？
*   所有的边界条件都正确吗
    *   符合预期格式
    *   正确订购
    *   在合理范围内
    *   它是否引用任何外部依赖项
    *   基数是否正确？（正确的值数）
    *   它是否在正确的时间内完成（真实的或相对的）
*   你能检查反向关系吗
*   你能用另一种经过验证的方法交叉检查结果吗
*   你能强制错误条件吗
*   性能特征是否在界限内

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-07T19:25:26.653

这里有一些想法：

**积极的**

*   你是单元测试！
*   您正在遵循约定 Arrange, Act, Assert

**消极的**

*   没有条目时删除条目的测试在哪里？
*   没有条目时在哪里获取条目的测试？
*   当您添加两个条目并删除一个条目时应该发生什么？应该留下哪一个？
*   应该`Entries`公开。您的一个断言调用这一事实`rep.Entries.SingleOrDefault`向我表明您没有正确构建该类。
*   您的测试命名有点模糊；通常遵循的一个好的模式是：`{MethodName}_{Context}_{Expected Behavior}`去除冗余“测试”冗余。

作为 TDD 的初学者，我发现[通过示例进行测试驱动开发](https://rads.stackoverflow.com/amzn/click/com/0321146530)这本书对我有很大帮助。其次，Roy Osherove 有一些很好的[测试回顾](http://weblogs.asp.net/rosherove/archive/2009/03/23/test-review-3-unity.aspx)视频教程，看看这些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T19:05:11.693

在我回答之前，让我声明我对单元测试相当陌生，而且绝不是专家，所以对我所说的一切持保留态度。

但我觉得你的单元测试在很大程度上是多余的。您的许多方法都是简单的传递，例如您的 AddEntry 方法只是对基础 List 方法 Add 的调用。你不是在测试你的代码，而是在测试 Java 库。

我只推荐包含您编写的逻辑的单元测试方法。避免测试像 getter 和 setter 这样明显的方法，因为它们在最基本的级别上运行。这是我的理念，但我知道有些人确实相信测试显而易见的方法，我只是碰巧认为这是毫无意义的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T19:05:41.397

像这样看起来很好。我个人喜欢给我的测试起一个更具描述性的名称，但这更多是个人喜好。

您可以对正在测试的类的依赖项使用模拟，EntryRepository 是被测类，因此无需模拟它，否则您最终将测试模拟实现而不是类。

只是举一个简单的例子。如果您的 EntryRepository 将使用后端数据库来存储条目而不是列表，则您可以为数据访问内容注入模拟实现，而不是调用真实的数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T19:06:13.143

这看起来是一个好的开始，但您应该尽可能多地测试“边界”案例。考虑一下可能导致您的方法失败的原因 - 将 null 条目传递给 Add 或 Delete 是否有效？尝试编写测试所有可能的代码路径。如果您对代码进行任何更改，以这种方式编写测试将使您的测试套件在未来更加有用。

此外，每个测试方法都可以使测试对象保持与调用时相同的状态。我注意到您的 TestFetchEntry 方法向 EntryRepository 添加了一个元素，但从未将其删除。让每种方法都不会影响测试对象的状态可以更轻松地运行一系列测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T19:10:52.897

你不应该嘲笑 IEntryRepository 因为实现类是被测试的类。您**可能**想要模拟`List<Entry>`并注入它，然后只需测试您通过公共接口调用的方法是否被正确调用。这只是您实现它的方式的替代方案，并且不一定更好——除非您希望该类注入它的支持类，在这种情况下，以这种方式编写测试会强制执行该行为。

您可能需要更多测试以确保在插入条目时插入正确的条目。与删除类似——插入几个条目，然后删除一个并确保正确的一个已被删除。一旦你想出测试来让代码做你想做的事，继续思考你可能会在编写代码时搞砸的方法，并编写测试以确保这些不会发生。当然，这门课非常简单，您也许可以说服自己，您对驱动器行为所做的测试就足够了。不过，它并不需要太多复杂性，就值得测试边缘情况和意外行为。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-07T19:16:43.460

对于 TDD 初学者和这个特定的课程，您的测试很好。+1努力。

一旦您遇到涉及依赖注入和模拟的更复杂的场景，请发布另一个问题。这就是事情变得非常有趣的地方；）。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-07T19:02:01.450

整体看起来不错。您应该使用事务（或在 TestInitialize 中创建存储库的新实例）来确保测试是真正隔离的。

还可以使用更具描述性的测试方法，例如 When_a_new_entity_is_added_to_a_EntryRepository_the_total_count_of_objects_should_get_incremented

# javascript - 使用 JavaScript 的浏览器下载文件提示

> ID：727144
> 
> 赞同：12
> 
> 时间：2009-04-07T18:57:26.470
> 
> 标签：javascript, file-browser

我想知道是否有任何方法可以使用 JavaScript 实现浏览器的下载文件提示。

我的理由 - 用户会将文件上传到无法从网络服务器访问的本地文件服务器。换句话说，两者都将在不同的域上！

例如，假设网站托管在 上`www.xyz.com`，但文件将驻留在本地文件服务器上，地址为`\\10.10.10.01\Files\file.txt`. 我如何上传/传输文件到本地文件服务器...使用 ActiveX 和 VBscript！（不要问:-)

所以我将本地文件路径存储在我的数据库中并将该数据绑定到网格。当用户单击该链接时，文件会在一个窗口中打开（使用 JavaScript）。

问题是某些文件类型，如文本、jpg、pdf 等。在浏览器窗口中打开。我将如何实现`content-type`或`content-disposition`使用客户端脚本？这甚至可能吗？

编辑：本地文件服务器有一个保存文件的窗口共享文件夹。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-07T19:05:37.900

“content-disposition: attachment” 几乎是强制执行此操作的唯一方法，并且必须在响应标头中进行设置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-09-07T16:05:06.927

如果文件托管在您的示例中的 Web 服务器上，您可以执行以下操作：

```
window.location.replace(fileUrl); 
```

..浏览器会弄清楚如何处理该文件。这适用于大多数文件，例如 .xls、.csv 等，但请记住，这不是完全证明，因为用户的 MIME 处理程序设置将确定如何处理文件......即如果它是一个 .txt 文件，它很可能只是显示在浏览器中，不会出现“文件下载”对话框。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-08-03T16:24:46.147

自 2015 年 8 月起，将“下载”属性添加到您的标签中，可以实现您正在寻找的行为，至少在 Chrome 中是这样。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-07T19:12:03.970

您可以尝试使用带有`type="application/octet-stream"`. 似乎在 FF 中工作，但 IE 和 Opera 忽略该属性。

# java - 如何清理 Java 中打开的进程？

> ID：727151
> 
> 赞同：1
> 
> 时间：2009-04-07T19:00:13.267
> 
> 标签：java, destructor

我正在从 Java 程序启动一个进程。我抓住它，在程序的稍后点，我可能会向它发送一些信号（与 UNIX 信号不同——一种不同的机制），告诉它自己清理并关闭，这是终止这个进程的正确方法。我稍后可能会重新启动并保持该进程并再次停止它任意次数。

我希望我的程序在存在时发出信号终止进程并确保它存在。否则，由于 Java 异步启动进程，它会在我的程序终止后持续存在并继续运行。

我以为我会在包含 Process 变量的对象的析构函数中执行此操作，但似乎 Java 没有析构函数。它有一个用于释放通过 JNI 分配的内存的 finalize() 方法，但情况并非如此，显然你不能保证 finalize() 会被调用：它仅在对象被垃圾回收时调用，并且程序可能会在没有调用垃圾回收的情况下运行到终止，在这种情况下，所有东西都会立即释放，不会发生垃圾回收，也不会发生 finalize()。

确保在我的程序退出时首先调用此清理代码的最佳方法是什么？

我看到 Java 1.6 引入了 Runtime.addShutdownHook() 方法，但我目前停留在 Java 1.5 上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T19:04:59.680

Try/finally 是最接近 C++ 析构函数的方法。

```
Process process;

process = ....;

try
{
    // do work
}
finally
{
    // send info to process to shut it down
} 
```

此外，[在 1.3 中添加了 addShutdownHook](http://java.sun.com/j2se/1.3/docs/api/java/lang/Runtime.html) ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T19:37:04.270

为什么不在调用 System.exit 之前调用它？您的代码可能应该是结构化的，因此您只需要从一个地方（或从 main 返回）调用 System.exit，无论哪种方式都是一个好方法。

# c# - 无法捕获睡眠/挂起消息 (winXP)

> ID：727154
> 
> 赞同：6
> 
> 时间：2009-04-07T19:00:49.207
> 
> 标签：c#, sleep-mode, hibernate-mode

我的应用需要阻止睡眠/休眠模式。我有代码，但在成功捕获**WM_POWERBROADCAST**消息后，**PBT_APMQUERYSUSPEND**和**PBT_APMQUERYSTANDBY**都没有被成功捕获。有趣的是，我的应用程序*正在*捕获**PBT_APMRESUMECRITICAL**和**PBT_APMRESUMEAUTOMATIC**消息。

 *底线问题：我的应用程序是否有任何原因无法捕获待机/挂起消息，但成功捕获了恢复消息？

顺便说一句，这个[问答](https://stackoverflow.com/questions/629240/prevent-windows-from-going-into-sleep-when-my-program-is-running)[stackoverflow.com] 有所帮助，但同样，这些消息似乎并没有进入我的应用程序。

我的代码（为简洁起见，删除了事件记录代码）：

```
 protected override void WndProc(ref System.Windows.Forms.Message m)
    {
        // Power status event triggered
        if (m.Msg == (int)NativeMethods.WindowMessage.WM_POWERBROADCAST)
        {
            // Machine is trying to enter suspended state
            if (m.WParam.ToInt32() == (int)NativeMethods.WindowMessage.PBT_APMQUERYSUSPEND ||
                m.WParam.ToInt32() == (int)NativeMethods.WindowMessage.PBT_APMQUERYSTANDBY)
            {
                // Have perms to deny this message?
                if((m.LParam.ToInt32() & 0x1) != 0)
                {
                    // If so, deny broadcast message
                    m.Result = new IntPtr((int)NativeMethods.WindowMessage.BROADCAST_QUERY_DENY);
                }
            }
            return; // ?!
        }

        base.WndProc(ref m);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T21:59:11.440

它现在适用于 XP 和 Vista。我用相关代码创建了一个存根 winform 应用程序（显然可以清理，但它传达了这一点）。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Runtime.InteropServices;

namespace standbyTest
{
    public partial class Form1 : Form
    {

        [DllImport("Kernel32.DLL", CharSet = CharSet.Auto, SetLastError = true)]
        protected static extern EXECUTION_STATE SetThreadExecutionState(EXECUTION_STATE state);

        [Flags]
        public enum EXECUTION_STATE : uint
        {
            ES_CONTINUOUS = 0x80000000,
            ES_DISPLAY_REQUIRED = 2,
            ES_SYSTEM_REQUIRED = 1,
            ES_AWAYMODE_REQUIRED = 0x00000040
        }

        public Form1()
        {
            if(Environment.OSVersion.Version.Major > 5)
            {
                // vista and above: block suspend mode
                SetThreadExecutionState(EXECUTION_STATE.ES_AWAYMODE_REQUIRED | EXECUTION_STATE.ES_SYSTEM_REQUIRED | EXECUTION_STATE.ES_CONTINUOUS);
            }

            InitializeComponent();

            //MessageBox.Show(string.Format("version: {0}", Environment.OSVersion.Version.Major.ToString() ));

        }

        protected override void OnClosed(EventArgs e)
        {
            base.OnClosed(e);

            if(Environment.OSVersion.Version.Major > 5)
            {
                // Re-allow suspend mode
                SetThreadExecutionState(EXECUTION_STATE.ES_CONTINUOUS);
            }
        }

        protected override void WndProc(ref System.Windows.Forms.Message m)
        {
            // Power status event triggered
            if(m.Msg == (int)WindowMessage.WM_POWERBROADCAST)
            {
                // Machine is trying to enter suspended state
                if(m.WParam.ToInt32() == (int)WindowMessage.PBT_APMQUERYSUSPEND ||
                        m.WParam.ToInt32() == (int)WindowMessage.PBT_APMQUERYSTANDBY)
                {
                    // Have perms to deny this message?
                    if((m.LParam.ToInt32() & 0x1) != 0)
                    {
                        // If so, deny broadcast message
                        m.Result = new IntPtr((int)WindowMessage.BROADCAST_QUERY_DENY);
                    }
                }
                return;
            }

            base.WndProc(ref m);
        }
    }

    internal enum WindowMessage
    {

        /// <summary>
        /// Notify that machine power state is changing
        /// </summary>
        WM_POWERBROADCAST = 0x218,
        /// <summary>
        /// Message indicating that machine is trying to enter suspended state
        /// </summary>
        PBT_APMQUERYSUSPEND = 0x0,
        PBT_APMQUERYSTANDBY = 0x0001,

        /// <summary>
        /// Message to deny broadcast query
        /// </summary>
        BROADCAST_QUERY_DENY = 0x424D5144

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-11T19:31:11.840

尝试订阅 PowerModeChanged 事件：

[如何检查计算机何时进入睡眠或唤醒状态？](https://stackoverflow.com/questions/1562474/how-do-i-check-when-the-computer-is-being-put-to-sleep-or-wakes-up)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T19:59:12.203

您是在 Vista 还是 Windows Server 2008 上运行？[这个页面](http://msdn.microsoft.com/en-us/library/bb540661(VS.85).aspx)说

> 由于 Windows Vista 和 Windows Server 2008 的电源管理模型发生变化，PBT-APMQUERYSUSPEND 事件不再传递给应用程序。而是传递了 BT_APMSUSPEND 事件...

这就是你看不到它的原因吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T15:20:09.993

我在我的（开发）机器和不同的（测试）机器（也是winXP）上的测试应用程序中尝试了相同的代码。在我的机器上，它继续失败，这意味着机器进入睡眠状态。但在另一台机器上，它可以工作！起初我认为这是一个调试与发布模式的问题，但事实并非如此。

我的开发机器似乎有些不同，尽管我不知道它可能是什么。

谜团解开了……有点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T16:00:03.800

在 Vista 中调用 SetThreadExecutionState 来通知 WPM 系统不是空闲的。

在 Windows XP/2000 中：
应用程序可以返回 BROADCAST_QUERY_DENY 以拒绝 PBT_APMQUERYSUSPEND 或 PBT_APMQUERYSUSPENDFAILED 请求。

MSDN：Windows XP 及更早版本：系统广播 PBT_APMQUERYSUSPEND 事件以请求暂停系统操作的权限。系统期望每个应用程序和驱动程序确定所请求的事件是否应该发生，如果发生则返回 TRUE，否则返回 BROADCAST_QUERY_DENY。应用程序不应拒绝此请求。如果应用程序拒绝此请求，系统会广播 PBT_APMQUERYSUSPENDFAILED 事件。此事件通知应用程序和驱动程序继续照常运行。

此外，我认为 Win2K 不支持 PBT_APMQUERYSTANDBY 或 PBT_APMSTANDBY。您是否尝试过在 Windows 关闭时全局记录广播以查看它们是否正在发送？

# linq - TransactionScope、linq 和奇怪的事务管理器问题 (HRESULT: 0x8004D024)

> ID：727155
> 
> 赞同：2
> 
> 时间：2009-04-07T19:00:54.903
> 
> 标签：linq, linq-to-sql, transactionscope

我有一个服务级别的方法，它对数据库进行很少的更改，我希望它们使用事务控制。此类方法可以执行以下操作： - LINQ SubmitChanges() 功能 - 调用 StoredProcedures

组件用户可以将一组这样的基本操作组合成更大的东西。

我看到有一个不错的类 TransactinScope 并尝试使用它：

```
using (TransactionScope transaction = new TransactionScope())
{
     content = repository.CreateBaseContent(content);
     result = repository.CreateTreeRelation(content, parent.Id, name);
     transaction.Complete();
}

public baseContent CreateBaseContent(baseContent content)
{
       EntityContext.baseContents.InsertOnSubmit(content);
       EntityContext.SubmitChanges();

       return content;
}

public CreateTreeRelation (params)
{
// do StoredProcedure call here via LINQ
} 
```

我的假设是在外层可以添加另一个级别的事务范围。相反，我遇到以下错误：

事务管理器已禁用对远程/网络事务的支持。（来自 HRESULT 的异常：0x8004D024）

我正在为 MS SQL 2005 和微软开发服务器使用相同的（Vista Ultimate）机器。从单元测试一切正常。TransactionScope 评论时相同。

我试图使用 DTC ( [http://support.microsoft.com/kb/899191](http://support.microsoft.com/kb/899191) ) 的安全性，当我设置接受所有入站和出站事务时，我收到以下错误消息：

对 COM 组件的调用已返回错误 HRESULT E_FAIL。

在调试过程中，我发现在 SubmitChanges 中，Linq Entity Context 有 Property Transaction IS NULL(!!)，而 System.Transactions.Transaction.Current 有打开事务

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T13:37:00.993

我认为您也可以使用 TransactionScope，只要您将数据上下文传递给您.Open 的相同连接。

TransactionScope 遇到的另一个问题是它不关心连接字符串是否相同，执行第二个 .Open 会将事务提升为分布式事务。然后你必须处理相关的配置，以及它没有使用这种情况所需的轻交易这一事实。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T13:00:24.277

发生问题是因为 Linq Datacontext 是在 transactionscope 之前创建的。

解决方案是将自己的事务控制添加到 LINQ 数据上下文。

```
Connection.Open()
Transaction = Connection.BeginTransaction(); 
```

和计数器来维护嵌套调用。

# jquery-ui - 具有 autoHeight=true 的 jQuery UI 手风琴在非默认窗格上有不必要的滚动条

> ID：727158
> 
> 赞同：22
> 
> 时间：2009-04-07T19:02:10.547
> 
> 标签：jquery-ui, accordion

我在使用 jQuery 手风琴时遇到问题。当我创建一个内容窗格时，其中非默认窗格的内容比默认窗格多，并且 autoHeight 为 true，这在切换窗格时提供了不错的动画，但非默认窗格获得了我不想要的滚动条。

您可以通过访问[http://jqueryui.com/themeroller/](http://jqueryui.com/themeroller/)来查看此操作，切换到“Blitzer”或“Humanity”等主题，然后打开示例手风琴的第 3 部分。Safari 3.2.1 和 Firefox 3.0.8 发生在我身上。

如果切换到 autoHeight=false，则不会发生这种情况，并且所有内容窗格都有正确的高度，但内容窗格仅在动画结束时渲染并且看起来很奇怪，所以我不得不关闭动画以避免这种奇怪.

要么我误读了某些东西，要么这是 jQuery UI 手风琴中的一个错误。请帮我弄清楚它是两者中的哪一个（或者两者都可能）。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-03-14T15:38:15.977

我尝试了几种不同的方法。autoHeight: false 本身不起作用。这最终对我有用：

```
$( "#accordion" ).accordion({
            heightStyle: "content",
            autoHeight: false,
        clearStyle: true,   
        }); 
```

我在具有固定宽度的 SharePoint 内容编辑器 Web 部件中使用它，在将内容添加到手风琴小部件时，它增加了高度问题。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-17T17:28:50.873

使用这个组合选项对我有用，1.当前版本的 jquery/ui

```
$( '#x' ).accordion({
    autoHeight: false,
    clearStyle: true
}); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-01-27T23:35:06.493

我遇到了类似的问题，对我来说，CSS 的以下更改有效。

```
.ui-accordion .ui-accordion-content{
overflow:visible !important;
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-09-01T01:30:45.677

如今（使用 jQuery UI - v1.8），只需 autoHeight 就足够了，不再出现滚动条。

```
jQuery("#accordion").accordion(
  {
    autoHeight:false
  }
); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-02-18T16:39:17.110

帮助`heightStyle: "content"`解决了我的问题。参考：[手风琴](http://jqueryui.com/accordion/#no-auto-height)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-06-19T15:16:47.613

我知道这是旧的，但我遇到了这个问题并降落在这里。可以在此处找到不会破坏动画并摆脱动画的解决方案：

[http://webdevscrapbook.wordpress.com/2012/02/24/jquery-ui-unnecessary-scrollbar-in-accordion/](http://webdevscrapbook.wordpress.com/2012/02/24/jquery-ui-unnecessary-scrollbar-in-accordion/)

对于那些不想点击的懒人来说，简短的回答是：

```
.ui-accordion .ui-accordion-content { overflow:hidden !important; } 
```

在手风琴的 CSS 中

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-12-12T04:00:37.007

尝试这个

[http://helpdesk.objects.com.au/javascript/how-to-avoid-scrollbars-when-using-jquery-accordion](http://helpdesk.objects.com.au/javascript/how-to-avoid-scrollbars-when-using-jquery-accordion)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-03-01T11:44:42.490

我从上面提到的[http://helpdesk.objects.com.au/javascript/how-to-avoid-scrollbars-when-using-jquery-accordion](http://helpdesk.objects.com.au/javascript/how-to-avoid-scrollbars-when-using-jquery-accordion)链接得到这个。这是文章下的评论之一。它摆脱了滚动条，但也保留了其余的 div 格式。上面的答案可能会导致内容像我一样越过边界。

```
.ui-accordion .ui-accordion-content{
height:auto!important;
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-12-28T00:36:53.003

这对我有用：

```
.ui-accordion-content-active, .ui-accordion-header-active{
    display: block;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-12-12T19:12:11.913

我试过了

```
.ui-accordion .ui-accordion-content{ overflow:visible !important; } 
```

但我在第一个选项卡上看到了一些视觉伪影。所以我用这种方式解决了这个问题：

```
<script type="text/javascript">
    (function() {
        var fixScroll = function(event, ui) {
            $(event.target).find('.ui-accordion-content-active').css('overflow', 'visible');
         }
        $('#tabs').accordion({ 
            header: "h2",
            create: fixScroll,
            change: fixScroll
        });
    })();
</script> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-09T22:20:13.893

检查 ui-accordion-content 的填充是否被覆盖。

当我在我的 css 中添加以下内容时，我遇到了同样的问题：

```
.container .ui-widget-content {
    padding-right: 3%;
} 
```

我如下所示进行了更改，滚动条消失了！

```
.container .ui-widget-content:not(.ui-accordion-content) {
    padding-right: 3%;
} 
```

我也没有打开自动高度。

# asp.net-mvc - ModelState.AddModelError 对 HTML 进行编码

> ID：727160
> 
> 赞同：15
> 
> 时间：2009-04-07T19:03:50.650
> 
> 标签：asp.net-mvc, validation

使用 ModelState.AddModelError 验证表单上的输入时，我注意到一个奇怪的问题。Html.ValidationMessage 的输出不是真正的 HTML 值，而是编码值，因此 CSS 样式不会应用于错误消息。

例子：

```
private string errorMessage = "<span class=\"negative\">{0}</span><br class=\"hid\" />";
ModelState.AddModelError("title", String.Format(errorMessage, "Tab title is required")); 
```

输出显示为：

```
<span class="field-validation-error">&lt;span class=&quot;negative&quot;&gt;URL is Required&lt;/span&gt;&lt;br class=&quot;hid&quot; /&gt;</span> 
```

他们早期的测试版并非如此，我不确定在这里采取什么方法。

谢谢尼克

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-10-28T19:45:57.497

还有另一种方法可以做到这一点，而无需创建自己的扩展。

例如，我们在其中一个控制器中有以下内容：

```
ModelState.AddModelError("Name", "<b>Please Use a Valid Person Name</b>"); 
```

然后我们可以在我们的视图中执行以下操作：

```
@if(Html.ValidationMessageFor(x => x.Name) != null){
    @Html.Raw(Html.ValidationMessageFor(x => x.Name).ToString())
} 
```

这将防止错误消息`'<b>Please Use a Valid Person Name</b>'`被编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T01:36:07.713

创建您自己的模拟 Html.ValidationMessage 的扩展方法...？

我不得不做一些类似的事情，因为内置的 MVC 验证内容（ModelState、ValidationMessage 等）不能满足页面上有多个表单的页面。

# html - CSS：UL's/OL's vs. Div 在 IE 中向左浮动

> ID：727163
> 
> 赞同：1
> 
> 时间：2009-04-07T19:04:22.927
> 
> 标签：html, css, html-lists, css-float

场景是客户想要一个浮动的 div（灰色框），其中包含环绕它的文本。然而，其中一些文本包括 ul 和 ol，它们隐藏在 IE6 中的浮动 div 后面。

我尝试将 ul's/ol's 包装在一个 div 中，看看是否有帮助，但没有成功。有没有人遇到过这个问题并找到了合适的解决方案？

（注意：这是一个旧站点，无法修改布局中的许多其他内容）

![在此处输入图像描述](https://i.stack.imgur.com/DuNJ6.jpg)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T19:34:03.060

我认为您可以修改 li 以在内部而不是外部显示他们的子弹，这应该对您有所帮助...

```
ul {
   list-style-position: inside;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T19:28:26.723

> 然而，其中一些文本包括 ul 和 ol，它们隐藏在 IE6 中的浮动 div 后面。

如果我们说的是这样简单的事情：

```
<div style="border: dotted red 1px; float: left; width: 100px; height: 100px">foo</div>
<p>bar</p>
<ol style="border: dotted blue 1px;">
    <li>potato</li>
    <li>yoghurt</li>
</ol> 
```

然后这里发生的事情发生在所有浏览器上，而不仅仅是 IE。您可以从本示例的边框中看到：列表的左侧填充发生在浮动后面，而不是将列表内容进一步向右推。这是因为浮动只排斥行框中的项目，而不排斥块元素。

如果您想要快速破解解决方法，请将 <ul> 包装在具有样式“显示：内联块”的 <div> 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T20:04:56.853

Floating + IE6 总是会导致一些无心的痛苦和煎熬。一些简单的修复：

1.  为浮动框添加更多边距
2.  为您的 ul/ol 添加一些左边距

# visual-c++ - 如何使用符号在发布模式下构建 OpenSSL？

> ID：727164
> 
> 赞同：2
> 
> 时间：2009-04-07T19:04:28.543
> 
> 标签：visual-c++, debugging, openssl, pdb-files

我通常通过这样做来构建我的 openssl 库：

```
perl Configure VC-WIN32
ms\do_masm 
nmake -f ms\ntdll.mak 
nmake -f ms\ntdll.mak test 
```

对于调试小型转储，我想为 2 个 dll 获取一个 pdb 文件（同时仍以“发布”模式构建它们）。我已将 /Zi 添加到 ms\ntdll.mak 的 CFLAGS 部分，但是当我查看 Visual Studio 调试器中的内存模块时，我仍然得到“二进制文件不是使用调试信息构建的”。我错过了一步吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T21:47:18.090

链接需要/DEBUG。

# http - HTTP Cache-Control：不存在时可接受的默认行为是什么？

> ID：727167
> 
> 赞同：4
> 
> 时间：2009-04-07T19:05:30.820
> 
> 标签：http, rest, cache-control

我遇到了一些 HTTP 缓存问题，这是由于一些下游应用程序没有将 Cache-Control 标头放在时间敏感数据上。我需要证明这是一个破碎的情况。

当 HTTP 1.1 不存在 Cache-Control 标头时，是否有任何关于缓存和代理的允许或常见响应处理行为的简洁声明？我看到了 RFC2616，但它似乎没有包含任何关于没有 Cache-Control 标头的响应的规范或应该声明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T21:24:42.217

我认为当这个指令丢失时，由浏览器决定它想要做什么。（在这种情况下，您的服务器可能是浏览器）

这是对各种浏览器处理问题的方式的一个很好的描述：

[http://www.f5.com/pdf/white-papers/browser-behavior-wp.pdf](http://www.f5.com/pdf/white-papers/browser-behavior-wp.pdf)

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-07T21:38:34.837

无法知道代理正在做什么，甚至您的客户正在点击哪些代理，但如果没有 Cache-Control 标头，他们很可能会发送缓存的结果。您可以做的是从客户端添加标头（如果这是一个选项），因此客户端将使用如下标头发送资源请求：`Cache-Control:no-cache`

有关缓存的更多信息：

[https://developers.google.com/speed/docs/best-practices/caching#LeverageBrowserCaching](https://developers.google.com/speed/docs/best-practices/caching#LeverageBrowserCaching)

这是一个相关的堆栈溢出问题：

[为什么在请求标头（客户端到服务器）中发送 Cache-Control 属性？](https://stackoverflow.com/questions/14541077/why-is-cache-control-attribute-sent-in-request-header-client-to-server)

希望能帮助到你！

# c# - C# 3.0 - 如何从星期一开始按周名称排序列表？

> ID：727173
> 
> 赞同：1
> 
> 时间：2009-04-07T19:06:51.643
> 
> 标签：c#, linq-to-sql, lambda

我有一个事件列表，每个事件都注册了一个工作日。

现在我试图显示所有这些事件，但按工作日名称排序（星期一、星期二、星期三......）。

我怎样才能做到这一点？我正在使用 LinqToSQL 和 Lambda 表达式。

谢谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-07T19:13:36.773

```
public class Event
{
  public string Day; 
}

[Test]
public void Te()
{
  var dayIndex = new List<string> {"MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY", "SUNDAY"};
  var list = new List<Event> {new Event(){Day = "saturday"}, new Event() {Day = "Monday"}, new Event() {Day = "Tuesday"}};
  var sorted = list.OrderBy(e => dayIndex.IndexOf(e.Day.ToUpper()));
  foreach (var e in sorted)
  {
    Console.WriteLine(e.Day);
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T19:15:53.260

我知道可以使用实现 IComparer(Of DateTime) 的自定义类对列表进行排序。所以你会创建一个这样的类：

```
Public Class WeekDayComparer
  Implements IComparer(Of MyEvent)

  Public Function Compare(ByVal x As MyEvent, ByVal y As MyEvent) As Integer Implements System.Collections.Generic.IComparer(Of MyEvent).Compare

    Return GetDayOfWeekNumber(x.DayOfWeek).CompareTo(GetDayOfWeekNumber(y.DayOfWeek))

  End Function

  Private Function GetDayOfWeekNumber(ByVal dayOfWeek As String) As Integer

     Select Case dayOfWeek.ToLower()
       Case "monday"
         Return 0
       Case "tuesday"
         Return 1
       Case "wednesday"
         Return 2
       Case "thursday"
         Return 3
       Case "friday"
         Return 4
       Case "saturday"
         Return 5
       Case "sunday"
         Return 6
       Case Else
         Return 7
     End Select

  End Function

End Class 
```

然后，您将获取对象列表并使用您的 WeekDayComparer 类对它们进行排序。

```
events.Sort(New WeekDayComparer()) 
```

这是 VB，但很容易转换为 C#。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T19:11:12.507

您希望您的排序字段是对应于星期几的整数：

```
1 = Monday
2 = Tuesday
3 = Wednesday
... 
```

没有更多细节，很难给你一个代码示例。如果您的工作日存储为 varchar，我建议您创建一个数据库标量函数，将星期几作为字符串参数并返回适当的整数。

这是 T-SQL 中的示例：

```
create function dbo.GetDayNumber (
    @dayOfWeek varchar(9)
) returns tinyint
as begin

declare @dayNum tinyint
set @dayNum = 0

select @dayNum = 
    case 
        when @dayOfWeek = 'Monday' then 1
        when @dayOfWeek = 'Tuesday' then 2
        when @dayOfWeek = 'Wednesday' then 3
        when @dayOfWeek = 'Thursday' then 4
        when @dayOfWeek = 'Friday' then 5
        when @dayOfWeek = 'Saturday' then 6
        when @dayOfWeek = 'Sunday' then 7
    end

return @dayNum

end 
```

小心 - 上面的代码为无效的日期名称返回 0，如果您的数据不完美，这可能会影响您的结果。

```
select
    MyEvent,
    DayOfWeek
from MyEventTable
order by dbo.GetDayNumber(DayOfWeek) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T19:56:51.740

假设您的 Event 对象包含一个 DateTime“日期”，您可以按 DateTime.DayOfWeek 枚举排序，如下所示：

```
List<Event> events = new List<Event>(); // filled elsewhere
events.Sort((x,y) => x.Date.DayOfWeek.CompareTo(y.Date.DayOfWeek)); 
```

这将对周日至周六的事件进行排序，并且由于您只在工作日进行，因此周日和周六应该无关紧要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-17T06:59:06.763

使用以下代码：

```
var originalCollection = new List<string>{ "Wednesday","Friday" "Thursday",  "Sunday", "Monday","Saturday","Tuesday"};        
var weekDayList = new List<string>{ "Monday", "Tuesday",  "Wednesday","Thursday", "Friday",  "Saturday", "Sunday"}; 
var sortedWeekDays = originalCollection (i => weekDayList.IndexOf(i.ToString())); 
```

有了它，`originalCollection`将根据顺序进行排序`weekDayList`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T19:11:20.057

澄清：“他们每个人都有一个工作日”，如何表示工作日？日期对象？枚举？细绳？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-07-01T12:13:07.790

这对我有用：

```
from e in events
orderby e.dateFildName.Value.DayOfWeek 
```

# sql-server - 在 sql server 2005 / 2008 的模式中使用变量扩展

> ID：727176
> 
> 赞同：0
> 
> 时间：2009-04-07T19:07:27.880
> 
> 标签：sql-server, sql-server-2005, tsql

我正在尝试创建存储过程，它将根据传递的参数决定使用哪种语言？
我怎么能做这样的事情？

```
declare @en varchar(50) = 'en'
declare @fi varchar(50) = 'fi'

select * from [@en].[TestingLanguagesInNameSpacesDelMe]
select * from [@fi].[TestingLanguagesInNameSpacesDelMe] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T19:11:09.947

您可以使用动态 SQL：

```
DECLARE @SQL varchar(MAX)
SELECT @SQL = 'select * from ['
              + @LANG
              + '].[TestingLanguagesInNameSpacesDelMe]'
sp_executesql @SQL 
```

但我会考虑使用带有索引 COLUMN 的 SINGLE 表和语言：

```
select * from [dbo].[TestingLanguagesInNameSpacesDelMe] where [lang] = @LANG 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T03:10:34.023

我还提倡单表/语言分段设计，其中所有语言都存储在带有语言列的单个表中。

动态 SQL 可能容易受到 SQL 注入的攻击。如果不能信任 @LANG 变量（或者如果模式和表需要验证为有效组合），您可以使用以下技术针对 sys.schemas 检查它：

```
DECLARE @template AS varchar(max)
SET @template = 'SELECT * FROM {object_name}'

DECLARE @object_name AS sysname

SELECT @object_name = QUOTENAME(s.name) + '.' + QUOTENAME(o.name)
FROM sys.objects o
INNER JOIN sys.schemas s
    ON s.schema_id = o.schema_id
WHERE o.object_id = OBJECT_ID(QUOTENAME(@LANG) + '.[TestingLanguagesInNameSpacesDelMe]')

IF @object_name IS NOT NULL
BEGIN
    DECLARE @sql AS varchar(max)
    SET @sql = REPLACE(@template, '{object_name}', @object_name)
    EXEC (@sql)
END 
```

现在您拥有动态 sql 的强大功能和灵活性，但它不易被注入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T19:11:57.323

这个怎么样？

声明@sqlCall varchar(200)

设置 @sqlCall = '选择 * 从 [' + @language + '].[TestingLanguagesInNameSpacesDelMe]'

执行@sqlCall

我必须同意其他发布的答案，制作一个指示语言的列，然后只过滤语言..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T19:25:35.327

```
-- Yep I also concluded that it is the dynamic sql ..
declare @tableName varchar(50) 
set @tableName ='TestingLanguagesInNameSpacesDelMe'

declare @sql nvarchar(200)= 'select * from ' 
declare @fi varchar(40) = 'fi'
declare @en varchar(50) = 'en'

set @sql = @sql + '[' + @fi + '].[' + @tableName + ']'
print @sql
exec sp_executesql @sql 
```

# java - 为特定的 JTable 单元设置鼠标光标

> ID：727177
> 
> 赞同：6
> 
> 时间：2009-04-07T19:07:39.177
> 
> 标签：java, swing, jtable, mouse-cursor, tablecellrenderer

我有一个带有一组不可编辑单元格的 JTable，我希望特定列中的所有单元格在鼠标悬停在它们上方时显示不同的鼠标光标。我已经在使用自定义渲染器并且在渲染器组件上设置光标似乎不起作用（就像它对工具提示所做的那样）。

它似乎对编辑有用。

当您的单元格未被编辑或我遗漏了什么时，这在 JTable 中是不可能的吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-07T19:47:05.213

将 MouseMotionListener 添加到 JTable，然后在 mouseMoved() 上确定它正在使用 JTable 的 columnAtPoint() 的列，如果它是您所追求的特定列，则在 JTable 上设置Cursor()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:29:27.843

这是更改 JTable 中特定列的光标的一种方法：

```
if(tblExamHistoryAll.columnAtPoint(evt.getPoint())==5)
{
    setCursor(Cursor.HAND_CURSOR); 
}
else
{
    setCursor(0);
} 
```

# iphone - iPhone UIImageView 动画问题

> ID：727180
> 
> 赞同：3
> 
> 时间：2009-04-07T19:08:16.537
> 
> 标签：iphone, uiimageview

我在使用 UIImageView 动画时遇到了一些问题。我创建了三个包含图像的 NSArray 对象，并创建了三个方法，它们采用 UIImageView 并将新动画分配给它。第一次调用这三种方法中的一种效果很好，但再次调用会使模拟器和设备崩溃。有任何想法吗？

```
// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad {

// set the anims
slowAnimation = [NSArray arrayWithObjects:
                    [UIImage imageNamed:@"image1.jpg"],
                    [UIImage imageNamed:@"image2.jpg"],
                                nil];
defaultAnimation = [NSArray arrayWithObjects:
                    [UIImage imageNamed:@"image3.jpg"],
                    [UIImage imageNamed:@"image4.jpg"],
                        nil];
fastAnimation = [NSArray arrayWithObjects:
                    [UIImage imageNamed:@"image5.jpg"],
                    [UIImage imageNamed:@"image6.jpg"],
                    nil];

// load the default speed - this works once, but when applied a second time it crashes the simulator and device
[self setDefaultAnim:myUIImageViewObject];

[super viewDidLoad];
}

// animation switcher
-(void)setSlowAnim:(UIImageView *)imageView
{
    [imageView stopAnimating];
    imageView.animationImages = slowAnimation;
    imageView.animationDuration = 0.4;
    [imageView startAnimating];
}
-(void)setDefaultAnim:(UIImageView *)imageView
{
    [imageView stopAnimating];
    imageView.animationImages = defaultAnimation;
    imageView.animationDuration = 0.4;
        [imageView startAnimating];
}
-(void)setFastAnim:(UIImageView *)imageView
{
    [imageView stopAnimating];
    imageView.animationImages = fastAnimation;
    imageView.animationDuration = 0.4;
   [imageView startAnimating];
} 
```

日志中的错误：

```
[Session started at 2009-04-06 22:46:54 +0100.]
Loading program into debugger…
GNU gdb 6.3.50-20050815 (Apple version gdb-962) (Sat Jul 26 08:14:40 UTC 2008)
Copyright 2004 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB. Type "show warranty" for details.
This GDB was configured as "i386-apple-darwin".warning: Unable to read symbols for "/System/Library/Frameworks/UIKit.framework/UIKit" (file not found).
warning: Unable to read symbols from "UIKit" (not yet mapped into memory).
warning: Unable to read symbols for "/System/Library/Frameworks/CoreGraphics.framework/CoreGraphics" (file not found).
warning: Unable to read symbols from "CoreGraphics" (not yet mapped into memory).
Program loaded.
sharedlibrary apply-load-rules all
Attaching to program: `/Users/hello/Library/Application Support/iPhone Simulator/User/Applications/6DB7C45D-1A26-4775-9AE3-C30F3EBC9F83/PlateSpinner.app/PlateSpinner', process 345.
kill
quit

The Debugger has exited with status 0. 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-07T19:15:05.727

我认为你需要`retain`你创建的三个数组`viewDidLoad`——你从不调用`alloc`它们，所以在你调用`retain`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T00:20:46.007

而不是只调用保留使用 initWithObjects 消息：

```
slowAnimation = [[NSArray alloc] initWithObjects:
                                  [UIImage imageNamed:@"image1.jpg"],
                                  [UIImage imageNamed:@"image2.jpg"],
                                  nil]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-17T02:47:32.493

但是，如果您按照 Lounges 的建议进行操作，请注意您需要稍后释放 slowAnimation 对象。由于您分配了它，它的保留计数将为 1，直到有人告诉运行时否则。

# c# - ASP.NET Mvc - System.Web.Compilation.CompilationLock

> ID：727181
> 
> 赞同：7
> 
> 时间：2009-04-07T19:08:31.810
> 
> 标签：c#, asp.net-mvc

我正在尝试使用 NUnit 对一些代码进行单元测试。我有一个方法：

```
 public static string RenderRoute(HttpContextBase context, RouteValueDictionary values)
    {
        var routeData = new RouteData();
        foreach (var kvp in values)
        {
            routeData.Values.Add(kvp.Key, kvp.Value);
        }

        string controllerName = routeData.GetRequiredString("controller");
        var requestContext = new RequestContext(context, routeData);
        IControllerFactory factory = ControllerBuilder.Current.GetControllerFactory();
        IController controller = factory.CreateController(requestContext, controllerName);

        var ActionInvoker = new ControllerActionInvoker();
        var controllerContext = new ControllerContext(requestContext, (ControllerBase)controller);
        ((ControllerBase)controller).ControllerContext = controllerContext;

        string actionName = routeData.GetRequiredString("action");

        Action action = delegate { ActionInvoker.InvokeAction(controllerContext, actionName); };

        return new BlockRenderer(context).Capture(action);
    } 
```

我的默认控制器工厂是 MvcContrib 的 StructureMap 控制器工厂。我还使用 MvcContrib 的 MvcMockHelpers 来帮助我模拟 HttpContextBase。

我试图测试的控制器调用上述 RenderRoute 方法并在以下位置爆炸：

```
IController controller = factory.CreateController(requestContext, controllerName); 
```

出现错误：

Controllers.WidgetControllerTests.CanCreateWidgetOnPage: System.Web.HttpException : 'System.Web.Compilation.CompilationLock' 的类型初始化程序引发了异常。----> System.TypeInitializationException : 'System.Web.Compilation.CompilationLock' 的类型初始化程序引发了异常。----> System.NullReferenceException : 对象引用未设置为对象的实例。

我对单元测试/模拟相当陌生，我可能看不到简单的东西。

这是我目前正在运行的测试：

```
 [Test]
    public void Test()
    {
        HttpContextBase context = MvcMockHelpers.DynamicHttpContextBase();
        string s = RenderExtensions.RenderAction<HomeController>(context, a => a.About());

        Console.WriteLine(s);
        Assert.IsNotNullOrEmpty(s);
    } 
```

任何帮助，将不胜感激。

我已将问题简化为这个简单的单元测试：

```
 [Test]
    public void Test2()
    {
        HttpContextBase context = MvcMockHelpers.DynamicHttpContextBase();
        var routeData = new RouteData();
        routeData.Values.Add("Controller", "Home");
        routeData.Values.Add("Action", "About");

        string controllerName = routeData.GetRequiredString("controller");
        var requestContext = new RequestContext(context, routeData);
        IControllerFactory factory = ControllerBuilder.Current.GetControllerFactory();
        IController controller = factory.CreateController(requestContext, controllerName);

        Assert.IsNotNull(controller);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-12T16:59:16.463

在尝试对我编写的控制器工厂进行单元测试时，我遇到了同样的问题。

该问题似乎来自 ControllerTypeCache 尝试在第一次调用时遍历所有关联的程序集并使用 BuildManager 执行此操作。通过使用 BuildManager 属性与实例交互而不是直接耦合，DefaultControllerFactory 看起来非常可扩展，但不幸的是，该属性被标记为内部的。与我们其他人不同，MVC 框架单元测试能够访问 MVC 程序集的内部。

在查看了 MVCContrib 如何对他们的控制器工厂进行单元测试后，我发现他们正在使用一个扩展方法助手，该助手使用反射来覆盖控制器缓存以访问私有属性。

```
using System;
using System.Linq;
using System.Reflection;
using System.Web.Mvc;

public static class ControllerFactoryTestExtension
{
    private static readonly PropertyInfo _typeCacheProperty;
    private static readonly FieldInfo _cacheField;

    static ControllerFactoryTestExtension()
    {
        _typeCacheProperty = typeof(DefaultControllerFactory).GetProperty("ControllerTypeCache", BindingFlags.Instance | BindingFlags.NonPublic);
        _cacheField = _typeCacheProperty.PropertyType.GetField("_cache", BindingFlags.NonPublic | BindingFlags.Instance);
    }

    /// <summary>
    /// Replaces the cache field of a the DefaultControllerFactory's ControllerTypeCache.
    /// This ensures that only the specified controller types will be searched when instantiating a controller.
    /// As the ControllerTypeCache is internal, this uses some reflection hackery.
    /// </summary>
    public static void InitializeWithControllerTypes(this IControllerFactory factory, params Type[] controllerTypes)
    {
        var cache = controllerTypes
            .GroupBy(t => t.Name.Substring(0, t.Name.Length - "Controller".Length), StringComparer.OrdinalIgnoreCase)
            .ToDictionary(g => g.Key, g => g.ToLookup(t => t.Namespace ?? string.Empty, StringComparer.OrdinalIgnoreCase), StringComparer.OrdinalIgnoreCase);

        var buildManager = _typeCacheProperty.GetValue(factory, null);
        _cacheField.SetValue(buildManager, cache);
    }
} 
```

将其添加到我的单元测试项目后，我能够使用将我自己的 MockController 类型添加到控制器类型缓存中`controllerFactory.InitializeWithControllerTypes(new[] {typeof(MockController)});`

# asp.net - jquery ajax 可以调用外部网络服务吗？

> ID：727183
> 
> 赞同：3
> 
> 时间：2009-04-07T19:09:30.140
> 
> 标签：asp.net, javascript, jquery, web-services

jquery ajax代码可以从另一个域名或另一个网站调用**webservice吗？**
像这样：

```
$.ajax({
    type: "POST",
    url: "http://AnotherWebSite.com/WebService.asmx/HelloWorld",
    data: "{'name':'" + $('#price').val() + "'}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function (msg) { alert(msg); }
}); 
```

我应该如何配置这个**网络服务**？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-07T19:17:32.227

您可以使用 JSONP 进行跨域请求。使用 jquery，您可以使用 $.json 函数发出 jsonp 请求，并在 url 中指定回调，如下所示：

```
&callback=? 
```

实际上，您只需要问号作为参数值，参数名称可以是任何东西。

唯一要注意的是，您发出请求的服务器必须支持 jsonp

有关更深入的信息，请参阅有关使 jsonp 与纽约时报 json api 一起使用的博客文章：

[http://notetodogself.blogspot.com/2009/02/using-jquery-with-nyt-json-api.html](http://notetodogself.blogspot.com/2009/02/using-jquery-with-nyt-json-api.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T19:20:06.587

您需要使用 JSONP 调用。[本页](http://docs.jquery.com/Ajax/jQuery.ajax)最后两段。回顾一下基础知识。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T19:13:39.100

由于[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，大多数浏览器都禁止向其他域发出请求。

一些例外是

*   用户端扩展，例如[GreaseMonkey](https://addons.mozilla.org/ja/firefox/addon/748?lang=ru)
*   javascript包含来自脚本标签
*   具有正确配置的服务器的 adobe flash 应用程序

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T19:14:28.037

不，从您的代码来源之外的 Web 服务器请求某些内容是所谓的[跨站点脚本 (XSS)](http://en.wikipedia.org/wiki/Cross-site_scripting)攻击的基础。因此，这种能力是被禁止的。有一些方法可以解决它，但它们充其量只是hacky。

我听得最多的一个是编写一个闪存应用程序，该应用程序与相关服务器建立 TCP 连接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T19:17:59.837

通常的做法是让您的 jQuery 调用服务器上的 Web 服务，并让该 Web 服务与外部 Web 服务进行通信。不是最首选的方法，但它有效。

# search - 可以按标点符号过滤的文本索引器搜索工具？

> ID：727185
> 
> 赞同：2
> 
> 时间：2009-04-07T19:10:25.690
> 
> 标签：search, code-search-engine

这本身不是一个编程问题，而是一个关于搜索源代码文件的问题，这有助于我编程。

我使用搜索工具 X1，它可以快速告诉我哪些源代码文件包含我正在寻找的一些关键字。但是，它不适用于带有标点符号的关键字。例如，如果我搜索“show()”，X1 会显示其中包含“show”的所有内容，包括来自“MessageBox.Show(.....)”的太多我不想看到的结果。

另一个例子：我需要过滤以显示“.parent”（注意点），而不是显示其中包含“父”（无点）的所有内容。

任何人都知道可以通过标点符号的关键字过滤的文本搜索工具吗？我真的更喜欢桌面应用程序而不是像谷歌这样的基于网络的工具（我觉得它很笨重）。

我正在寻找一个索引单词的工具，而不是像 Windows 文件资源管理器这样的通用文件搜索器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-04T22:30:36.370

如果您想有效地在代码文件中搜索关键字和标点符号，请考虑使用 SD 源代码搜索引擎。它根据特定于语言的规则对每种源语言进行索引，因此它准确地知道该语言中的标识符、关键字、字符串、注释、运算符，并根据这些元素对其进行索引。它将同时处理多种语言：C、C++、Java、VB6、C#、COBOL。

您的第一个查询将被提出为：

我=显示-我=消息框...'('

（找到名为“show”的标识符，但消除那些与 MessageBox leftparen 重叠的标识符）。您的第二个查询将被简单地提出

'。' 我=父母

请参阅[http://www.semanticdesigns.com/Products/SearchEngine/index.html](http://www.semanticdesigns.com/Products/SearchEngine/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-04T22:38:15.933

这似乎是 ctags 和 cscope 等工具的工作。

[Ctags](http://ctags.sourceforge.net/)用于索引源文件的声明（支持多种语言）和[Cscope](http://cscope.sourceforge.net/)用于深入的 c 文件分析。

在我看来，这些工具更适合每个项目的使用。此外，您可能需要使用其他工具来使用这些索引，我自己为此使用 vim，但许多文本编辑器使用 ctags。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-02T18:23:51.217

来自[DTSearch.com](http://DTSearch.com)的工具。

# postgresql - 使用 PostgreSQL 强制客户端断开连接

> ID：727194
> 
> 赞同：32
> 
> 时间：2009-04-07T19:12:06.997
> 
> 标签：postgresql

有没有办法强制客户端断开与 PostgreSQL 的连接？我正在寻找 DB2 的[`force application all`](http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.doc/core/r0001951.htm).

我想在我的开发机器上执行此操作，因为当我打开数据库控制台时，我无法加载数据库转储。我必须先戒掉他们。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2011-05-13T11:05:43.837

杀死 PostgreSQL 8.4 中的空闲进程：

```
SELECT procpid, (SELECT pg_terminate_backend(procpid)) as killed from pg_stat_activity
   WHERE current_query LIKE '<IDLE>'; 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-04-07T19:21:46.757

结合[`pg_terminate_backend`](http://www.postgresql.org/docs/current/static/functions-admin.html#FUNCTIONS-ADMIN-SIGNAL-TABLE)功能和[`pg_stat_activity`](http://www.postgresql.org/docs/current/static/monitoring-stats.html#MONITORING-STATS-VIEWS)系统视图。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-07-31T15:00:42.453

[这个 SO 答案很好地解释了（水平规则之间](https://stackoverflow.com/a/3185413/2171120)[araqnid](https://stackoverflow.com/users/85134/araqnid)的完整引用，然后是我）：

* * *

将数据库“applogs”标记为不接受新连接：

```
update pg_database set datallowconn = false where datname = 'applogs'; 
```

另一种可能性是撤销客户端角色对数据库的“连接”访问权限。

断开用户与数据库的连接 = 杀死后端。因此，要断开所有其他用户与“applogs”数据库的连接，例如：

```
select pg_terminate_backend(procpid)
from pg_stat_activity
where datname = 'applogs' and procpid <> pg_backend_pid(); 
```

一旦你完成了这两个，你是唯一连接到“applogs”的用户。尽管在后端真正完成断开连接之前实际上可能会有延迟？

* * *

来自[MarkJL](https://stackoverflow.com/users/1010873/markjl)的更新：在后端完成断开连接之前确实存在延迟。

现在我再说一遍：话虽如此，请注意该`procpid`列`pid`在 PostgreSQL 9.2 及更高版本中已重命名为。

我认为这比 Milen A. Radev 的回答更有帮助，虽然技术上相同，但没有使用示例和现实生活中的建议。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-01-15T12:14:28.027

我发布我的答案是因为我无法在我的脚本服务器 9.3 中使用它们中的任何一个：

```
psql -U postgres -c "SELECT pid, (SELECT pg_terminate_backend(pid)) as killed from pg_stat_activity WHERE datname = 'my_database_to_alter';" 
```

在下一行中，您可以使用“my_database_to_alter”做任何您想做的事情。如您所见，您从“postgres”数据库执行查询，该数据库几乎存在于每个 postgresql 安装中。

由超级用户和问题数据库本身之外的工作对我来说是完美的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-26T20:29:50.307

可能应该使用更严厉的方法，但是：

```
for x in `ps -eF | grep -E "postgres.*idle"| awk '{print $2}'`;do kill $x; done 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T19:13:41.267

我在邮件列表中找到[了这个线程。](http://archives.postgresql.org//pgsql-admin/2008-09/msg00224.php)它建议使用 SIGTERM 使客户端断开连接。

不如干净`db2 force application all`。

# asp.net-mvc - 何时在 ASp.Net MVC 中使用 UserControls

> ID：727195
> 
> 赞同：0
> 
> 时间：2009-04-07T19:12:45.920
> 
> 标签：asp.net-mvc

除了重复使用多个网页的目的之外，此模型中的用户控件是否提供任何其他优势？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T19:20:09.363

它们提供了一种隐藏复杂性的方法。您可以将复杂的控件放入用户控件中，而在页面上工作时不必担心细节。

我认为这是一般用户控件的巨大好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T19:25:29.007

如果您明智地使用它们，它们可能会提供更好的可理解性。用户控件是标记的一部分。您向它提供模型的一部分。

因此，例如，如果您的模型是类型 A 的列表，其中 A 具有需要复杂标记的复杂属性 B，则使用使用 AB 作为其模型的用户控件 U 是有意义的。您的代码现在更简单了，如果您只想更改或替换 B 的 ui，您只需替换或修改 U 而不是在 V 中查找它的标记。

# boolean - 布尔真 - 正 1 或负 1？

> ID：727196
> 
> 赞同：13
> 
> 时间：2009-04-07T19:13:00.130
> 
> 标签：boolean, language-design, internal-representation

我正在设计一种语言，并试图决定`true`应该是 0x01 还是 0xFF。显然，所有非零值都将转换为 true，但我正在尝试确定确切的内部表示。

每种选择的优缺点是什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-07T19:17:03.227

没关系，只要满足对外表示的规则即可。

我会从 C 那里得到一个提示，其中 false 被绝对定义为 0，而 true 被定义为非 false。与 true 的绝对值相比，这是一个重要的区别。除非您的类型只有两种状态，否则您必须考虑该值类型中的所有值，即什么是真，什么是假。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-07T20:23:55.310

0 为假，因为处理器具有在寄存器设置为零时设置的标志。

没有在任何其他值（0x01、0xff 等）上设置其他标志 - 但当寄存器中有非零值时，零标志设置为 false。

因此，这里主张将 0 定义为 false 并将其他任何内容定义为 true 的答案都是正确的。

如果你想为 true “定义”一个默认值，那么 0x01 比大多数都好：

*   它在每个位长度和符号中表示相同的数字
*   如果您想知道它是否正确、零标志是否不可用或使用成本高，它只需要测试一位
*   转换为其他类型时无需担心符号扩展
*   逻辑和算术表达式对它的作用相同

-亚当

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-07T19:23:19.980

你为什么选择非零值是真的？在 Ada 中，真为真，假为假。与 BOOLEAN 之间没有隐式类型转换。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-07T19:33:04.060

在弱类型语言中使用 -1 有一个优势——如果你搞砸了并使用按位运算`and`符而不是逻辑`and`运算符，只要其中一个操作数已转换为规范的布尔表示，你的条件仍然会正确计算。如果规范表示为 1，则不是这样。

```
 0xffffffff & 0x00000010 == 0x00000010 (true)
  0xffffffff && 0x00000010 == 0xffffffff (true) 
```

但

```
 0x00000001 & 0x00000010 == 0x00000000 (false)
  0x00000001 && 0x00000010 == 0xffffffff (true) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-07T19:18:45.920

IMO，如果你想坚持**false** =0x00，你应该使用 0x01。0xFF 通常是：

*   某些操作溢出的迹象

或者

*   错误标记

在这两种情况下，它可能意味着**false**。因此，来自可执行文件的 *nix 返回值约定，即**true** = 0x00，并且任何非零值都是 false。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-07T19:19:24.763

-1 比 1 长...

最后没关系，因为 0 是假的，其他任何东西都是真的，你永远不会与真的确切表示进行比较。

编辑，对于那些不赞成投票的人，请解释原因。这个答案与当前评分为 +19 的​​答案基本相同。因此，对于相同的基本答案，这是 21 票的差异。

如果是因为 -1 注释，那是真的，实际定义“真”的人（例如：编译器编写者）将不得不使用 -1 而不是 1，假设他们选择使用精确表示。-1 将比 1 花费更长的时间来输入，最终结果将是相同的。该声明很愚蠢，它本来就是愚蠢的，因为两者（1或-1）之间没有真正的区别。

如果你要标记一些东西，至少要提供一个理由。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-07T19:21:51.683

0xff 是一个奇怪的选择，因为它隐含假设 8 位是您的最小存储单元。但是，想要更紧凑地存储布尔值并不少见。

也许您想通过考虑布尔运算符是否产生仅是一个 0 或 1 位（无论符号扩展如何工作）或全零或全一（并且取决于有符号二进制补码的符号扩展）来重新表述量以保持任何长度的全1）。

我认为 0 和 1 会让你的生活更简单。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-07T20:29:15.377

优点是没有，缺点也没有。只要您提供从整数到布尔值的自动转换，它将是任意的，因此您选择哪个数字并不重要。

另一方面，如果您不允许这种自动转换，您将有一个专业人士：您的语言中不会有一些完全任意的规则。你不会有`(7 - 4 - 3) == false`, 或`3 * 4 + 17 == "Hello"`, 或`"Hi mom!" == Complex(7, -2)`.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-07T19:27:23.480

我认为C方法是要走的路。0 表示假，任何其他都表示真。如果您使用另一个映射为真，那么您将面临不确定值的问题 - 既不是真也不是假。

如果这是您将为特定指令集编译的语言，该指令集对特定表示具有特殊支持，那么我会让它指导您。但是没有任何附加信息，对于“标准”内部表示，我会选择 -1（二进制中的所有 1）。该值可以很好地扩展到您想要的任何大小的布尔值（单个位、8 位、16 位等），如果您将“TRUE”或“FALSE”分解为更小的“TRUE”或“FALSE”，它仍然相同。（如果您破坏了 16 位 TRUE=0x0001，您将得到 FALSE=0x00 和 TRUE=0x01）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-07T19:47:15.167

设计语言，使 0 为假，非零为真。无需“转换”任何东西，考虑“非零”而不是某些特定值将帮助您正确编写代码。

如果您有像“True”这样的内置符号，那么继续选择一个值，但始终认为“非零为真”而不是“0x01 为真”。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-07T20:33:27.287

无论你做什么，一旦你选择了你的价值观，就不要改变它们。在 FORTH-77 中，true 和 false 被定义为 1 和 0。然后，FORTH-83 将它们重新定义为 -1 和 0。有不少（好吧，只有几个，这就是我们正在谈论的 FORTH）问题由此造成的。

# .net - .NET 的 List(Of T).Reverse 方法的范围

> ID：727205
> 
> 赞同：2
> 
> 时间：2009-04-07T19:14:52.280
> 
> 标签：.net, vb.net, oop, collections, scope

我有一个带有 List 参数的简单函数。在使用它时，它会复制它并使用 .NET 的[List(Of T).Reverse](http://msdn.microsoft.com/en-us/library/5c6526tb.aspx)方法反转副本。

```
Private Function FindThing(ByVal Things As List(Of Thing)) As Thing
    Dim ReverseOrderThings As List(Of Thing) = Things
    ReverseOrderThings.Reverse()
    For Each t As Thing In ReverseOrderThings
        ...
    Next
    Return Nothing
End Function 
```

我的参数定义为[ByVal](http://msdn.microsoft.com/en-us/library/h2b185t2.aspx)。但是，似乎 ByVal 并没有阻止过程中的代码更改列表的顺序。

```
Dim Things As List(Of Thing) = GetSortedListFromSomewhere()
Dim FoundThing As Thing = FindThing(Things)
For Each t As Thing In Things
    ...
    'OMG! My Things are in reverse order!!1! WTF?'
Next 
```

如何在这样的函数中保护我的列表参数？

* * *

## 更新：

这是制作列表副本的正确方法。

```
Dim ReverseOrderThings As List(Of Thing) = New List(Of Thing)(Things) 
```

现在作为参数传递的列表不受 Reverse() 方法的影响。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-07T19:17:38.077

制作一份清单。

该函数不能改变列表的值，事实上并非如此。它正在改变列表包含的内容，这是允许的。唯一不允许的是分配变量以引用新列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-07T19:18:07.280

为了保护列表，您需要在排序之前对其进行复制。

```
Things = New List(Of Thing)(Things) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-07T19:19:40.270

即使传递了列表，`ByVal`它也是传递的引用本身，`ByVal` 因此您正在复制列表的位置，当使用时，它是同一个列表对象。我同意 rossfabricant 的观点，即您应该自己创建一份该列表的副本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T19:19:00.023

你不能直接保护它。

由于 List(Of Thing) 是一个引用类型（一个类），它传递引用 ByVal，但列表的内容仍然可以在您的例程中更改（不是 List 引用本身，而是列表包含的内容）。

要保护原始列表，您需要将其复制到新集合中，然后对该集合进行排序。如果列表包含引用类型（事物），这将相对便宜。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-07T19:21:27.053

> 但是，如果参数是引用类型，则过程可以修改基础对象的内容或成员。

来自[MSDN](http://msdn.microsoft.com/en-us/library/sect4ck6(VS.71).aspx)

因此`ByVal`防止仅修改值类型

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T19:20:13.420

您的参数按值传递对列表的引用，而不是列表本身。正如其他人所指出的，您需要制作一个副本，LINQ 的`ToList()`扩展方法会很容易地做到这一点。

# asp.net - 使用远程 sql server 登录的 ASP.NET 配置向导

> ID：727219
> 
> 赞同：2
> 
> 时间：2009-04-07T19:18:10.023
> 
> 标签：asp.net, visual-studio, createuserwizard

我一直在通过试验、观看 ASP.NET 上的视频和阅读论坛来学习 ASP.NET。不过，我还没有找到快速的解决方案。

每当我从工具箱中添加“登录”或“创建用户向导”时，它总是将新用户添加到名为“ASPNETDB.MDF”的数据库中，即使我使用新的 SqlDataSource 指定远程数据库也是如此。

有没有简单的方法来保存登录信息？有没有对你有帮助的教程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T20:53:16.567

默认情况下，ASP.NET 将使用基于本地文件的数据库来存储登录信息。

如果你想使用不同的数据库，你需要做几件事：

1.  [使用aspnet_regsql.exe](http://msdn.microsoft.com/en-us/library/x28wfk74.aspx) （通常位于 C:\Windows\Microsoft.NET\Framework\v2.0.50727 中）设置远程数据库- 运行它将以 GUI 模式启动它，允许您选择服务器和数据库来添加表和存储过程到。
2.  配置您的网站以使用此数据库。有几个地方你需要这样做：

在 web.config 的 ConnectionStrings 部分添加新的 ConnectionString：

```
<add 
  name="zhpCoreContentConnectionString"
  connectionString="Data Source=Hobbiton\SqlExpress;Initial Catalog=zhpCoreContent;Integrated Security=True" 
  providerName="System.Data.SqlClient"/> 
```

在 web.config 的[MembershipProvider](http://msdn.microsoft.com/en-us/library/1b9hw62f.aspx)部分中，确保 ConnectionString 属性设置为与您的连接字符串相同的名称（其他设置省略了）：

```
<membership>
  <providers>
    <add 
      connectionStringName="zhpCoreContentConnectionString"
      applicationName="/doodle"
      name="AspNetSqlMembershipProvider"
      type="System.Web.Security.SqlMembershipProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
  </providers>
</membership> 
```

If you are using [Roles](http://msdn.microsoft.com/en-us/library/ms164660.aspx) or [Profiles](http://msdn.microsoft.com/en-us/library/ms164644.aspx) you'll want to ensure that they are also using your connectionstring to store everything together, and ensure that the applicationName attribute is common between them.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T20:23:19.477

这听起来像您需要[实现自定义会员用户](http://msdn.microsoft.com/en-us/library/ms366730(VS.80).aspx)

# c# - 代码认为 Datagrid 页脚文本框为空

> ID：727225
> 
> 赞同：1
> 
> 时间：2009-04-07T19:19:54.497
> 
> 标签：c#, asp.net, datagrid

我正在开发一个 .net (C#) Web 应用程序。

最近我遇到了一个缺陷，即当两个用户同时登录到应用程序时，如果不刷新页面，他们都无法更新值。当我查看这个问题时，我发现代码的作者使用了静态数据集。我将数据集更改为不是静态的，并且一切正常。

但是，此问题跨越应用程序中的许多页面，我必须在任何地方修复它。在其中一些页面上，应用程序使用数据集将数据绑定到数据网格。数据网格填充了数据集中的信息，页脚包含一些文本框和一个添加按钮以添加额外的行。这是问题开始的地方：

当页面使用静态数据集并且用户尝试通过界面添加一行时，一切正常。但是，当我将其更改为使用非静态的数据集（每次加载页面时都会加载它们）并且用户尝试添加一行时，代码认为文本框是空的（即使我可以看到在调试时发现我输入的文本）和空字段验证失败并显示一条消息。

有人可以告诉我为什么会发生这种情况吗？为什么当数据集是静态的（数据集从不填充脚行）时它会看到文本，而当它不是静态时却看不到文本？一些见解会很棒！

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T20:14:39.203

事实证明，网格的绑定方式存在问题。

实例化数据集时发生绑定。这意味着每次页面加载时都会再次发生绑定并导致文本为空白。考虑到 item 命令看起来像是在页面加载之前执行的，这很奇怪，但数据网格无论如何都不喜欢它。我移动了绑定发生的位置，以便它仅在页面加载时发生一次（当然，它在将某些内容添加到网格时发生）。

这似乎成功了！

# css - 用 div+css 切片 psd

> ID：727246
> 
> 赞同：0
> 
> 时间：2009-04-07T19:25:43.390
> 
> 标签：css, html

我正在切片一个 psd，屏幕的一部分会根据需要重复显示尽可能多的项目，类似于 stackoverflow 的问题列表。

它需要有这样的结构：

[![替代文字](https://i.stack.imgur.com/k4r6U.gif)](https://i.stack.imgur.com/k4r6U.gif)

可能吗？css应该是怎样的？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T20:16:01.647

您可以尝试以下方法：

```
<style type="text/css">
    #container {
        width:60%;
    }

    #content {
        width:100%;
    }

    #user-content {
        float:left;
    }
</style>

<div id="container">
    <div id="content">
        <div id="user-content">
            <p>This can change depending on what is in here.</p>
        </div>
        <!-- The rest of the page's content goes here. -->
    </div>
</div> 
```

这使得“内容” div 填充了“用户内容”未填充的其余空间。只有当您的内容高于用户内容时才会出现问题......但这是一个不同的问题:)

这是另一种可能：

```
<style type="text/css">
    #container {
        width:60%;
    }

    #content {
        width:100%;
        float:left;
    }

    #user-content {
        float:left;
    }

    #page-content {
        float:left;
    }
</style>

<div id="container">
    <div id="content">
        <div id="user-content">
            <p>This can change depending on what is in here.</p>
        </div>
        <div id="page-content">
            <p>This should take up the rest of the space.</p>
        </div>
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T22:29:21.860

据我所知，给你的可变宽度容器一个可变宽度并将它浮动到左边的唯一方法是给它 {width:auto;float:left;}

但是我不知道您是否可以对此做任何有用的事情，因为如果您有文本或许多固定宽度的小项目要放入此容器中，它们将继续沿第一行扩展，直到它们填满在进入第二行之前的外部 div。它们不会填满整个高度，然后随着文本内容过多而逐渐向外推。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T22:33:28.353

只是一个想法 - 你也许可以做一些漂亮的 JavaScript（可能使用 jQuery？）来调整那些 div 的大小，就像你需要它们一样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T19:49:58.997

问题出在您的左侧 div 中，您在其中声明“宽度可以根据内容增加”。这个宽度是怎么定义的？右侧的 div 可以扩展到剩余空间的 100%，但您必须通过为左侧 div 提供固定宽度或为两者提供等于 100% 的百分比来定义左右 div 之间的关系。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T20:13:29.313

好吧，正如您可能已经看到的，so.com 使用固定宽度的 div 来实现您的布局目标。

显然我第一次尝试设置宽度自动失败，但也许我有一个有用的解决方法：使用两个框的左右浮动。

```
<div style="border: 1px solid #000000; width: 60%">
  <div style="border: 1px solid #444444; float: left;">
    some text
  </div>
  <div style="border: 1px solid #999999; float: right;">
    foo
  </div>
</div> 
```

当然，这只有在我正确理解您的问题时才会有所帮助；）

# wpf - 在 TextBlock (WPF) 中显示图像

> ID：727248
> 
> 赞同：13
> 
> 时间：2009-04-07T19:26:18.990
> 
> 标签：wpf, chat, textblock

我正在开发一个简单的聊天应用程序。目前，消息绑定到这样的自定义样式列表框（简化的 XAML）：

```
<ListBox ItemsSource="{Binding MessageCollection}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding Text}"/>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

现在我希望能够将图像（如图形笑脸）放入显示的消息文本中。有没有办法使用 TextBlock （或任何其他标准组件）来实现这一点，还是我需要为此使用一些特殊的控件？

提前致谢

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2011-04-07T23:42:23.323

只需使用 InlineUIContainer。

```
<TextBlock TextWrapping="Wrap">
    <Run>Some text.</Run>
    <InlineUIContainer>
        <Image Source="http://sstatic.net/stackoverflow/img/apple-touch-icon.png" Height="20"></Image>
    </InlineUIContainer>
    <Run>Some more text.</Run>
</TextBlock> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T13:13:54.523

TextBlock 的内容始终只是一系列内联，因此您应该使用 InlineUIContainer。您可以将此容器作为 TextBlock 中的内联之一插入您希望图像出现的任何位置，与文本运行交替。您可以解析一条消息，同时继续将您找到的标记（文本或图像）添加到 TextBlock 的 Inlines 集合中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T19:34:23.697

您可以使用值转换器将文本转换为另一种类型，该类型具有由文本或笑脸组成的段列表（按它们出现的顺序）。

然后，您可以使用数据模板绑定到该新类型并适当地显示文本和笑脸。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T19:54:34.367

如果您希望图像实际上*包含在*文本中（如表情符号），那么您将不得不做一些工作。这听起来像是我真正想要一个用户控件的少数几次之一，其要点是扫描文本以查找表情符号值并动态构建数据模板。

请记住，您可以在 XAML 中执行的任何操作都可以在代码中执行，因此我正在考虑的代码将遵循以下一般思想：

1.  扫描文本以获取表情符号值并为数据元素创建值列表。
2.  创建一个 DockPanel。
3.  对于 List 中的每个元素，添加一个 TextBlock 或一个 Image（基于值）。
4.  将 this.Content 设置为 DockPanel。

我认为这样的东西实际上是您正在寻找的东西，但是如果您只想要一个图像，那么 ValueConverter 建议就可以了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-12T15:49:44.207

我最近也遇到了这个问题，我通过

创建一个包含 ItemsControl 的 ListBox ItemTemplate，在 ItemsPanelTemplate 中有一个 WrapPanel，然后使用包含所有逻辑的 IValueConverter 将我的字符串绑定到 ItemsControl 的 ItemsSource。

拆分您的单词并查询/搜索您的表情符号字符串、超链接等，并创建您的文本块、图像、超链接、按钮元素并设置您的值和事件句柄。

在函数中创建一个 List<UIElement> 并使用您生成的控件填充 List 并将 List 作为 IValueConverter 的 Convert 函数中的对象返回。

因为你有 WrapPanel 在那里你完成了你的包装。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-07T19:38:13.597

使用 Image 元素而不是 TextBlock 并使用 Converter 将文本值映射到微笑图像。

```
<ListBox ItemsSource="{Binding MessageCollection}">
<ListBox.ItemTemplate>
    <DataTemplate>
        <Image Source="{Binding Text, Converter={StaticResource MyImageConverter}}"/>
    </DataTemplate>
</ListBox.ItemTemplate> 
```

# text-services-framework - 开始使用文本服务框架 (TSF)？

> ID：727257
> 
> 赞同：4
> 
> 时间：2009-04-07T19:29:11.370
> 
> 标签：text-services-framework

我在询问 TSF 的良好资源和示例代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-19T19:09:59.907

[http://blogs.msdn.com/tsfaware/default.aspx](http://blogs.msdn.com/tsfaware/default.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-04T20:21:20.177

[http://archive.msdn.microsoft.com/tsf](http://archive.msdn.microsoft.com/tsf)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-16T18:42:03.183

Windows SDK 在 samples/input 目录中有许多 TSF 示例。

# c# - 更新动态控件

> ID：727258
> 
> 赞同：2
> 
> 时间：2009-04-07T19:29:32.320
> 
> 标签：c#, asp.net

我有一个自定义 Web 部件，其中包含来自 AJAX 控件工具包的 Accordion 窗格作为子级，用于呈现站点地图层次结构。每个窗格都包含一个带有文本输入的 div 和 3 个用于编辑站点地图数据的链接按钮：“添加子项”、“更新”和“删除”。

目前，所有这些控件都是在重写的 CreateChildControls 方法中创建的。

单击“添加子”链接按钮时，将触发事件处理程序，并将新节点添加到站点地图。回发完成后，控件应使用层次结构中的新空节点重新呈现，但事实并非如此。在一个新的 GET 请求之后，新节点出现。在阅读了一段时间后，我认为我的问题是我在过程中过早地创建了我的子控件，因为在触发 Control 事件之前调用了 CreateChildControls，所以我将那个位移到了 OnPreRender 方法中。但是现在控制事件不会触发，因为我在页面生命周期中连接它们太晚了（请参阅此处：[自定义控件事件未触发](https://stackoverflow.com/questions/471260/custom-control-events-not-firing)）。

我的问题是：如何确保自定义控件呈现其子控件事件处理程序的结果？

顺便说一句，我在 Web 部件而不是自定义服务器控件中执行此操作是否重要（例如，生命周期是否不同）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-03T06:24:13.273

您可以在页面的 OnInit 中调用 EnsureChildControls。这将确保在处理任何事件之前重新创建子控件。

# mbunit - MbUnit：比较双打最优雅的方式？

> ID：727260
> 
> 赞同：4
> 
> 时间：2009-04-07T19:30:11.260
> 
> 标签：mbunit, gallio

编码

```
Assert.AreEqual (9.97320998018748d, observerPosition.CenterLongitude); 
```

生产

```
Expected Value & Actual Value : 9.97320998018748
Remark : Both values look the same when formatted but they 
are distinct instances. 
```

在 MbUnit 3.0 中比较两个双精度的最优雅的方法是什么？我知道我可以自己将它们四舍五入，但是是否有一些 MbUnit 构造呢？

更新：我认为我目前的“解决方法”是不优雅的：

```
Assert.LessThan(
   Math.Abs(9.97320998018748d - observerPosition.CenterLongitude),
   0.0000001); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-07T19:37:26.703

[`AreApproximatelyEqual`](http://www.gallio.org/api/html/Overload_MbUnit_Framework_Assert_AreApproximatelyEqual.htm)似乎是“为此的 MbUnit 构造”：

> 验证实际值是否大约等于指定增量内的某个预期值。

这似乎类似于[`Assert.AreEqual(double expected, double actual, double delta)`](http://msdn.microsoft.com/en-us/library/ms243458.aspx)

# jquery - 使用 jQuery 包装文本

> ID：727261
> 
> 赞同：1
> 
> 时间：2009-04-07T19:30:25.407
> 
> 标签：jquery

我想知道如何搜索文档中的任何文本并使用 jQuery 将其包装在链接结构中。

例如 - 在整个文档中搜索文本“目标心率”并将其转换为

```
<a href="jvscrt:popup('heartrate.cfm')">target heart rate</a> 
```

有任何想法吗？

谢谢！克里斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T20:33:23.900

这很接近：

```
var findIt = 'Javascript';

$.expr[":"].containsNoCase = function(el, i, m) {  
    var search = m[3];
    if (!search) return false;
    // we'll use text to find what we want...
    return eval("/" + search + "/ig").test($(el).text());
};  

$("p:containsNoCase('"+ findIt +"')").each(function() {
  // and then html when we are ready to replace
  var ht = $(this).html();  
  var pos= ht.indexOf(findIt);
  var start = ht.substring(0, pos);  
  var end = ht.substring(pos+findIt.length);

  $(this).html(
      start
      +'<a href="javascript:alert(\'heartrate.cfm\')">'+findIt+'</a>'+end);

}); 
```

但是你正在寻找的是一件很难提供的东西。您只想搜索元素的文本，但需要更新找到它的元素的 HTML 内容（以添加链接）。当您返回并使用 html() 更新元素时​​，您最终可能会替换您不想要的东西。

例如这很好：

```
<p>Hey, Javascript is fun.</p> 
```

这有问题：

```
<p><img src="something/Javascript.png">Whee, yaa Javascript</p> 
```

图像 src 中的文本被错误地替换。如果有一种方法可以在未被包围的元素内或在标签内找到匹配文本的位置，则可以干净地替换它。当然你可以使用 text()，但是你不能在你添加回来的内容中使用任何 HTML :(。也许我会回来看看是否有人可以提供其他任何东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T12:09:54.710

我是这样一个gomer：

[jQuery 的文本高亮插件](http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html)。

您可能可以使用它来完成工作。只需使用您的锚（您的链接）元素更改包装。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T19:39:46.227

jQuery [wrap](http://docs.jquery.com/Manipulation/wrap)函数可能吗？

还要考虑突出关键字的[文本突出显示插件。](http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html)您可以使用它们创建链接，而不是突出显示。更具体地说，以下几行：

```
var spannode = document.createElement('span');
spannode.className = 'highlight';
// change the above to create an anchor and add href etc 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-28T16:52:44.843

刚刚发现了一个有趣的方法，可以非常干净地解决这个问题：

[range.surroundContents](https://developer.mozilla.org/en/DOM/range.surroundContents)

[我在阅读有关Selection 对象](https://developer.mozilla.org/en/DOM/Selection)时遇到了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T19:34:40.733

您需要：

*   有一个转换规则——即“要转换的文本”——url——>“convert.cfm”。您可以使用简单的哈希数组来实现这一点。

*   现在，您需要搜索所有匹配的 DOM 元素中包含的 text() 。如果你找到它，你需要将内容分成 3 个部分：文本前后 + 文本本身。

*   现在创建锚点并将三个部分连接在一起并替换旧内容。

例如，在大多数客户端脚本中，这就是文本高亮显示的方式。

既然您只要求一个想法，我将把有趣的编码留给自己；）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T19:39:29.910

将 find 方法与 contains 一起使用。可能像

```
$("p").find(":contains('target heart rate')")
      .wrapInner($("<a href="jvscrt:popup('heartrate.cfm')"></a>")); 
```

或类似的东西。

我可能完全错了。检查[http://docs.jquery.com](http://docs.jquery.com)

# soap - Web 服务响应为空，但 SOAP 消息响应有效

> ID：727269
> 
> 赞同：1
> 
> 时间：2009-04-07T19:33:49.190
> 
> 标签：soap, service, wsdl, jax-ws

我正在编写一个从编写 WSDL 开始的 Web 服务。我一直在使用 wsimport 生成服务器端骨架代码，然后编写自己的实现类。我在 Axis2 服务器上运行 Web 服务。使用soapUI 时，进出服务的SOAP 消息看起来不错，但使用Web 服务客户端时，客户端存根中的值是空的。我听说这可能是命名空间问题，但我发现有任何问题。这是我的 WSDL 副本。任何帮助，将不胜感激。

```
<?xml version="1.0" encoding="UTF-8"?>
<wsdl:definitions xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:ns1="http://org.apache.axis2/xsd" xmlns:ns="http://test.sa.lmco.com" xmlns:wsaw="http://www.w3.org/2006/05/addressing/wsdl" xmlns:http="http://schemas.xmlsoap.org/wsdl/http/" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:mime="http://schemas.xmlsoap.org/wsdl/mime/" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" targetNamespace="http://test.sa.lmco.com">

<!-- **************** -->
<!-- **   Types    ** -->
<!-- **************** -->
<wsdl:types>
    <xs:schema attributeFormDefault="qualified" elementFormDefault="qualified" targetNamespace="http://test.sa.lmco.com">
        <xs:element name="sayHello">
            <xs:complexType>
                <xs:sequence>
                    <xs:element minOccurs="0" name="s" nillable="true" type="xs:string"/>
                </xs:sequence>
            </xs:complexType>
        </xs:element>
        <xs:element name="sayHelloResponse">
            <xs:complexType>
                <xs:sequence>
                    <xs:element minOccurs="0" name="return" nillable="true" type="xs:string"/>
                </xs:sequence>
            </xs:complexType>
        </xs:element>

        <xs:element name="getTaxonomyNode">
            <xs:complexType>
                <xs:sequence>
                    <xs:element name="taxonomyId" minOccurs="1" maxOccurs="1"   type="xs:int" />
                    <xs:element name="nodeId"   type="xs:int" />
                </xs:sequence>
            </xs:complexType>
        </xs:element>

        <xs:element name="getTaxonomyNodeResponse">
            <xs:complexType>
                <xs:sequence>
                    <xs:element name="resultNode"   type="ns:TaxonomyNode" />
                </xs:sequence>
            </xs:complexType>
        </xs:element>

        <xs:element name="getChildren">
            <xs:complexType>
                <xs:sequence>
                    <xs:element name="taxonomyId"   minOccurs="1" maxOccurs="1" type="xs:int" />
                    <xs:element name="parentNodeId" minOccurs="1" maxOccurs="1" type="xs:int" />
                </xs:sequence>
            </xs:complexType>
        </xs:element>

        <xs:element name="getChildrenResponse">
            <xs:complexType>
                <xs:sequence>
                    <xs:element name="childNodes"   minOccurs="0"   maxOccurs="unbounded"   type="ns:TaxonomyNode" />
                </xs:sequence>
            </xs:complexType>
        </xs:element>

        <xs:complexType name="TaxonomyNode">
            <xs:sequence>
                <xs:element name="taxonomyId" type="xs:int" />
                <xs:element name="nodeId"     type="xs:int" />
            </xs:sequence>
        </xs:complexType>

        <xs:complexType name="LCD">
            <xs:sequence>
                <xs:element name="language" type="xs:string" />
                <xs:element name="content"  type="xs:string" />
                <xs:element name="description"  type="xs:string" />
            </xs:sequence>
        </xs:complexType>   

    </xs:schema>
</wsdl:types>

<!-- ***************** -->
<!-- **  Messages   ** -->
<!-- ***************** -->
<wsdl:message name="sayHelloRequest">
    <wsdl:part name="parameters" element="ns:sayHello"/>
</wsdl:message>
<wsdl:message name="sayHelloResponse">
    <wsdl:part name="parameters" element="ns:sayHelloResponse"/>
</wsdl:message>

<wsdl:message name="getTaxonomyNodeRequest">
    <wsdl:part name="parameters" element="ns:getTaxonomyNode" />
</wsdl:message>
<wsdl:message name="getTaxonomyNodeResponse">
    <wsdl:part name="parameters" element="ns:getTaxonomyNodeResponse" />
</wsdl:message>

<wsdl:message name="getChildrenRequest">
    <wsdl:part name="parameters" element="ns:getChildren" />
</wsdl:message>
<wsdl:message name="getChildrenResponse">
    <wsdl:part name="parameters" element="ns:getChildrenResponse" />
</wsdl:message>

<!-- ******************* -->
<!-- **   PortTypes   ** -->
<!-- ******************* -->
<wsdl:portType name="HelloWSPortType">
    <wsdl:operation name="sayHello">
        <wsdl:input message="ns:sayHelloRequest" wsaw:Action="urn:sayHello"/>
        <wsdl:output message="ns:sayHelloResponse" wsaw:Action="urn:sayHelloResponse"/>
    </wsdl:operation>

    <wsdl:operation name="getTaxonomyNode">
        <wsdl:input  message="ns:getTaxonomyNodeRequest"  wsaw:Action="urn:getTaxonomyNode" />
        <wsdl:output message="ns:getTaxonomyNodeResponse" wsaw:Action="urn:getTaxonomyNodeResponse" />
    </wsdl:operation>

    <wsdl:operation name="getChildren">
        <wsdl:input  message="ns:getChildrenRequest"  wsaw:Action="urn:getChildren" />
        <wsdl:output message="ns:getChildrenResponse" wsaw:Action="urn:getChildrenResponse" />
    </wsdl:operation>

</wsdl:portType>

<!-- ****************** -->
<!-- ** Bindings     ** -->
<!-- ****************** -->
<wsdl:binding name="HelloWSServiceSoap11Binding" type="ns:HelloWSPortType">
    <soap:binding transport="http://schemas.xmlsoap.org/soap/http" style="document"/>
    <wsdl:operation name="sayHello">
        <soap:operation soapAction="urn:sayHello" style="document"/>
        <wsdl:input>
            <soap:body use="literal"/>
        </wsdl:input>
        <wsdl:output>
            <soap:body use="literal"/>
        </wsdl:output>
    </wsdl:operation>

    <wsdl:operation name="getTaxonomyNode">
        <soap:operation soapAction="urn:getTaxonomyNode" style="document" />
        <wsdl:input>
            <soap:body use="literal" />
        </wsdl:input>
        <wsdl:output>
            <soap:body use="literal" />
        </wsdl:output>
    </wsdl:operation>

    <wsdl:operation name="getChildren">
        <soap:operation soapAction="urn:getChildren" style="document" />
        <wsdl:input>
        <soap:body use="literal" />
    </wsdl:input>
    <wsdl:output>
        <soap:body use="literal" />
        </wsdl:output>
    </wsdl:operation>

</wsdl:binding>

<!-- **************** -->
<!-- ** Service    ** -->
<!-- **************** -->
<wsdl:service name="HelloWS">
    <wsdl:port name="HelloWSServiceHttpSoap11Endpoint" binding="ns:HelloWSServiceSoap11Binding">
        <soap:address location="http://162.16.129.25:9090/axis2/services/HelloWS"/>
    </wsdl:port>

</wsdl:service> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-18T03:49:05.043

这可能是因为单独的 WSDL 文件。

如果您在 META-INF 中单独指定 WSDL，则 AXIS2 将 Web 服务的参数作为 OMElement 传递。

即，如果您在服务 API 中使用了其他数据类型作为参数并且您在 META-INF 中有一个 WSDL，那么在调用服务时，参数是 OMElement 而不是 String / int 等...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:49:39.960

我在使用 Soap Web 服务时遇到了同样的问题，即我得到了空响应。我发现原因是我需要在请求中添加适当的 Header 字段：例如 - 内容类型、内容编码等，具体取决于编写的服务。您最好与编写 Web 服务的人核实一下

# sharepoint - 在 SharePoint 中部署布局

> ID：727271
> 
> 赞同：2
> 
> 时间：2009-04-07T19:34:04.230
> 
> 标签：sharepoint, moss

我正在开发发布网站。我有一些**预先填充了 Web 部件的布局，**当我需要对布局进行一些更改时会出现问题。部署成功，但我仍然看到旧版本。如果让我在 SP Designer 中进行更改，则反映正常，但如果更改是由正在部署的功能完成的，则不会。看起来在我部署特定布局后，该 Web 应用程序中的任何网站集都将具有第一个版本。

我尝试删除整个站点、所有页面、布局，但没有任何反应，部署后我仍然看到旧布局。

此问题的当前解决方案是我采用新的虚拟映像并从干净的机器开始。

真正的问题是如何在不恢复到干净机器的情况下在客户端安装时解决这个问题。将会有一些错误修复，我将不得不发送新的 WSP 文件，其中包含一些布局更改。

**有什么方法可以强制 SharePoint 使用新部署的布局，而不是一些旧的 Unghosted 版本？**

如果布局没有 Web 部件，我就没有这个问题。

**更新**
我正在使用默认的“发布门户”并使用功能部署布局。对于开发，我使用的是 VSeWSS 1.3。

尝试在 SharePoint 设计器中将页面与布局分离并再次附加，但仍然没有结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T09:41:45.813

如果它是您正在部署的功能，您必须停用该功能并在再次部署后激活它。并且不要忘记执行 IISRESET 或 AppPool 回收。如果您的新网站集具有布局的第一个版本，请确保它确实是您正在激活的新功能版本。尝试先拒绝您的解决方案，然后再添加新的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T20:06:32.103

您使用的是站点定义还是站点模板？如果您使用其中任何一个，它可能不会在初始配置后更新。

尝试从中央管理员完全收回和删除解决方案，重置 AppPools，然后重新部署解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T17:03:29.257

由于您使用的是 VSeWSS，因此您可以在功能激活时执行您自己的代码。因此，请尝试编写一个 SPFeatureReceiver，它会在相关 Web 上的功能激活后直接调用 SPWeb.RevertAllDocumentContentStreams() 进行重新托管。

如果这不起作用，那么问题不在于重影，也许是关于孤儿。但是先试试这个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T16:13:27.817

确保您的功能的元素清单指定应覆盖现有文件。

看起来有些人也遇到了布局问题......

请参阅[http://msdn.microsoft.com/en-us/library/ms459213.aspx](http://msdn.microsoft.com/en-us/library/ms459213.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T00:47:43.540

如果您正在开发新的站点定义，您可以使用属性将新布局附加到 onet.xml 文件中，希望对您有所帮助

-->

# c# - 如果控件始终按照声明的顺序绑定到数据源控件，则

> ID：727274
> 
> 赞同：3
> 
> 时间：2009-04-07T19:34:54.913
> 
> 标签：c#, asp.net, data-binding, objectdatasource

A) 下面的问题是基于这样的假设：控件总是按照声明的顺序绑定到数据源控件？因此，在我们的示例中，SqlDataSource1 将在 SqlDataSource2 之前连接到数据源，因此*lstCities将在**GridView1*之前填充值，原因是*lstcities*在*GridView1*之前声明？！

B）如果是这样，那么*ControlParameter究竟何时从**DropDownList*检索值？我假设它在*SqlDataSource1_Selected()*事件处理程序之后和*SqlDataSource2_Selecting()*事件处理程序之前，但准确的时间是什么时候？

在 .aspx 页面中：

```
 <asp:SqlDataSource ID="SqlDataSource1" ... >
    </asp:SqlDataSource>

    <asp:DropDownList ID="lstCities" DataSourceID="SqlDataSource1"
         DataTextField="City" runat="server"></asp:DropDownList>

    <asp:SqlDataSource ID="SqlDataSource2" ... >
        <SelectParameters>
            <asp:ControlParameter ControlID="lstCities" Name="City"
                 PropertyName="SelectedValue" />
        </SelectParameters>
    </asp:SqlDataSource>

    <asp:GridView DataSourceID="SqlDataSource2" runat="server" …&gt;
    </asp:GridView> 
```

谢谢

编辑：

> 但是，如果它是回发，那么这些参数将从页面的 OnLoadComplete 上的视图状态加载，再次按照声明它们的顺序。

Q1 - 假设 ControlParameter 绑定到控件 C 的属性 C1。我想在回发时 ControlProperty 总是能够从 ViewState 获取 C.C1 的值，无论 C 是什么类型，即使 C 禁用了 ViewState ？！

Q2 - 但是我可以问为什么，如果第一次创建页面，ControlParameter 的值也不能从视图状态中检索？毕竟，在 lstCities 从数据源检索数据的那一刻， lstCities.SelectedValue 是否设置了它的值？

谢谢队友

第二次编辑：

我很抱歉没有尽快回复，但我没有意识到你已经回复了。当我这样做时，我花了 20 分钟试图让我的 3 个脑细胞正常工作，但我不确定我是否成功了

A）所以 ControlParameter 评估 C.C1 并因此在 C 绑定后检索 C.C1 的值？！

> Q1 - ControlParameter 只读取它自己的状态并且只确定它是否改变了

A) 因此，ControlParameter 在绑定发生之前检查其 ViewState 是否已更改（以触发 OnParameterChanged 事件）-> 因此它会在 Page.OnLoadComplete 期间检查其 ViewState。但是 ControlParameter 怎么知道它的 ViewState 已经改变了（它会在第一次回发时知道）？毕竟，从第一次创建页面开始，ControlParameter 的 ViewState 将始终被标记为脏，那么从一个回发到另一个回发，ControlParameter 怎么知道它的值在回发之间是否发生了变化？

B）我假设 ControlParameter 检查其 Viewstate 是否仅更改，以便它可以触发 OnParameterChanged 事件。但为什么处理该事件如此重要？

> 第一次发生属性评估是在 Page.OnLoadComplete

通过属性评估，您的意思是 ControlParameter 检查自己的 ViewState？因此，您并不是说 ControlParameter 评估 C.C1 （我假设在 C 被绑定之后发生）

我真的很感谢你的帮助

第三次编辑：

真的很抱歉再次占用您的时间。我会尽我最大的努力使这成为我的最后一次编辑。

Update() 在 OnLoadComplete 和数据绑定发生时都被调用。在 Update() 内部还执行了以下语句：

```
this.ViewState["ParameterValue"] = actualValue; 
```

因此，如果在数据绑定发生时调用 Update()，那么这意味着当在 OnLoadComplete 中调用下一次回发 UpDate() 时，C.C1 和 ControlParameter 将已经具有相同的值，因此

```
 if ((actualValue == null && storedValue != null)
             || (actualValue != null && actualValue != storedValue)) 
```

将始终返回 false （当在 OnLoadComplete 中调用 Update() 时），因此 OnParameterChanged 事件永远不会被触发？1 如果是这样，我看不到在 OnLoadComplete 中调用 Update() 的必要性！

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T18:34:53.800

你的第一个假设是正确的。

对于您的第二个问题，这取决于它是否是回发和/或您是否明确绑定。如果不是回发并且绑定自动发生，那么粗略地说，当 DataSourceView 在 DataBind 上调用 Select 时，就在 OnSelecting 事件之前检索 ControlParameter 的值。网格视图（以及任何给定的控件）的顺序如下：

```
Page.ProcessRequest
Page.PreRenderRecursiveInternal
...
GridView.EnsureChildControls
GridView.CreateChildControls
GridView.DataBind
GridView.PerformSelect
DataSourceView.Select //comes from either SQLDataSource or LinqDataSource
DataSourceView.ExecuteSelect
//for Linq:
    LinqDataSourceView.GetParameterValues(WhereParameters)
//for SQL:
    SqlDataSourceView.InitializeParameters(SelectParameters)
Parameters.GetValues
Parameters.UpdateValues //this is where values get retrieved using reflection
DataSourceView.OnSelecting //follows almost immediately
...get data...
DataSourceView.OnSelected 
```

因此，对于控件层次结构中的每个控件，框架会递归调用 DataBind，然后触发参数检索、OnSelecting、数据检索和 OnSelected。

但是，如果它是回发，那么这些参数将从页面的 OnLoadComplete 上的视图状态加载，再次按照声明它们的顺序。

这是你要找的吗？

**编辑**

> Q1 - 假设 ControlParameter 绑定到控件 C 的属性 C1。我想在回发时 ControlProperty 总是能够从 ViewState 获取 C.C1 的值，无论 C 是什么类型，即使 C 禁用了 ViewState ？！

这并不完全是如何发生的......在回发（以及针对该问题的初始请求）时，仅评估 ControlParemeter 的视图状态以查看它是否已更改，以便可以触发 OnParameterChanged 事件。ControlParameter 的实际值根据它指向的控件（通过反射）进行评估。在您的情况下，它将是“C.C1”。现在，当它读取 C.C1 时，它的值很可能是从视图状态中读取的。但是 ControlParameter 决不会直接读取 C 的视图状态。

> Q2 - 但是我可以问为什么，如果第一次创建页面，ControlParameter 的值也不能从视图状态中检索？毕竟，在 lstCities 从数据源检索数据的那一刻， lstCities.SelectedValue 是否设置了它的值？

就是这样，那时（第一次加载页面） lstCities 还没有检索到任何数据。第一次发生属性评估是在 Page.OnLoadComplete 上，但在任何 DataBind 之前（发生在 Page.PreRenderRecursiveInternal 被触发后不久）。

以粗略的形式，尝试将其置于页面的生命周期中：

```
...request...
PerformPreInit
InitRecursive //SqlDataSource subscribes to Page.LoadComplete
OnInitComplete
if PostBack
    LoadAllState //the view state gets loaded
    ProcessPostData
OnPreLoad
LoadRecursive
if PostBack
    ProcessPostData
    RaiseChangedEvents
    RaisePostBackEvents //you handle your events
//notice that following sections assume that you did not do any data 
//binding inside your events
OnLoadComplete //This is where parameters (SelectParemeters/WhereParemeters)
    //get updated. At this point none of them are data bound yet.
    //And if it the first time, there are no values
    //as the ViewState is empty for them.
PreRenderRecursiveInternal //calls the DataBind (if you haven't already), 
    //then DataSourceView.Select; parameters evaluate their controls.
    //The control C would be bound at this point.
PerformPreRenderComplete
SaveAllState
OnSaveStateComplete
RenderControl 
```

**第二次编辑**

> 所以 ControlParameter 评估 C.C1 并因此在 C 绑定后检索 C.C1 的值？！

每当询问时，ControlParameter 都会检索值，在这种情况下（间接）在两个地方发生：OnLoadComplete 和 DataBind（由 PreRenderRecursiveInternal 触发）。OnLoadComplete 时，C 未绑定。在 PreRenderRecursiveInternal 上，在 DataBind 之后，C 被绑定。两次 ControlParameter 都被要求读取 C.C1。也许以下会有所帮助......

简而言之，这里是感兴趣的类和方法。将它们放在页面周期的角度，希望它会很清楚。

```
public class ControlParameter : Parameter
{
    public string ControlID { get; set; } //stored in ViewState
    public string PropertyName { get; set; } //stored in ViewState

    protected override object Evaluate(HttpContext context, Control owner)
    {
        Control sourceControl = DataBoundControlHelper.FindControl(owner, this.ControlID);
        //evaluate C.C1 using reflection
        return DataBinder.Eval(sourceControl, this.PropertyName);
    }

    internal void UpdateValue(HttpContext context, Control owner)
    {
        //PostBack or not, read stored value (on initial load it is empty)
        object storedValue = this.ViewState["ParameterValue"];
        //Get the actual value for this parameter from C.C1
        object actualValue = this.Evaluate(context, owner);
        //Store received value
        this.ViewState["ParameterValue"] = actualValue;
        //Fire a change event if necessary
        if ((actualValue == null && storedValue != null)
         || (actualValue != null && actualValue != storedValue))
            this.OnParameterChanged();
    }
}

public class SqlDataSource : DataSourceControl
{
    //fired by OnLoadComplete
    private void LoadCompleteEventHandler(object sender, EventArgs e)
    {
        //UpdateValues simply calls the UpdateValue for each parameter
        this.SelectParameters.UpdateValues(this.Context, this);
        this.FilterParameters.UpdateValues(this.Context, this);
    }
}

public class SqlDataSourceView : DataSourceView, IStateManager
{
    private SqlDataSource _owner;

    //this method gets called by DataBind (including on PreRenderRecursiveInternal)
    protected internal override IEnumerable ExecuteSelect(DataSourceSelectArguments arguments)
    {
        DbConnection connection = this._owner.CreateConnection(this._owner.ConnectionString);
        DbCommand command = this._owner.CreateCommand(this.SelectCommand, connection);
        //This is where ControlParameter will read C.C1 values again.
        //Except this time, C.C1 will be already populated by its own DataBind
        this.InitializeParameters(command, this.SelectParameters, null);

        command.CommandType = GetCommandType(this.SelectCommandType);
        SqlDataSourceSelectingEventArgs e = new SqlDataSourceSelectingEventArgs(command, arguments);

        this.OnSelecting(e);

        if (e.Cancel)
            return null;

        //...get data from DB

        this.OnSelected(new SqlDataSourceStatusEventArgs(command, affectedRows, null));

        //return data (IEnumerable or DataView)
    }

    private void InitializeParameters(DbCommand command, ParameterCollection parameters, IDictionary exclusionList)
    {
        //build exlusions list
        //...
        //Retrieve parameter values (i.e. from C.C1 for the ControlParameter)
        IOrderedDictionary values = parameters.GetValues(this._context, this._owner);

        //build command's Parameters collection using commandParameters and retrieved values
        //...
    }
} 
```

> A) 所以 ControlParameter 检查它的 ViewState 是否改变了......

请参阅上面的 UpdateValue 方法，了解它如何使用 ViewState。

> > B）我假设 ControlParameter 检查其 Viewstate 是否仅更改，以便它可以触发 OnParameterChanged 事件。但为什么处理该事件如此重要？

我不知道这很重要。我想，就像任何其他事件一样，它允许您跟踪参数属性的变化并根据您的需要采取行动。它在很多地方都被解雇了，但我看不到有人在哪里订阅它。所以...

> 通过属性评估，您的意思是 ControlParameter 检查自己的 ViewState？因此，您并不是说 ControlParameter 评估 C.C1 （我假设在 C 被绑定之后发生）

这意味着 ControlParameter.UpdateValue 被调用，它检查 ViewState 以说明原因，然后调用 ControlParameter.Evalue，然后找到一个控件并使用反射 (Eval) 检索数据。往上看。

**第三次编辑**

我认为更新是指 UpdateValue。

> 因此，如果在发生数据绑定时调用 Update()，那么这意味着当在 OnLoadComplete 中调用下一次回发 UpDate() 时，C.C1 和 ControlParameter 将已经具有相同的值......

没有必要。您忘记了视图状态是在 LoadAllState 上加载的，并且在它和 OnLoadComplete 之间还有六个步骤（参见上面的页面生命周期）。其中每一个都可以修改源代码管理的 (C.C1) 值。

假设您有 C.C1 = "x" 并回帖。现在，所有控件的视图状态都已加载 (LoadAllState)。如果 C.C1 将其值存储在视图状态中，它将加载“x”。在 Page_Load (LoadRecursive) 上，您决定设置 C.C1 = "y"。在这里，C.C1 可能决定是否在其视图状态中存储“y”——这无关紧要。然后其他事件随之而来。接下来是 OnLoadComplete。由于 SqlDataSource 订阅此事件，它将评估所有关联参数 (LoadCompleteEventHandler)，并且由于您确实更改了 C.C1 但 ControlParameter 的视图状态没有，所以

```
if ((actualValue == null && storedValue != null)
 || (actualValue != null && actualValue != storedValue))
    this.OnParameterChanged(); 
```

将返回 true 并且 OnParameterChanged 将被触发。顺便说一句，至少还有十个其他地方会触发此事件。它在数据绑定和属性检索过程中没有发挥重要作用（如果有的话）。

# xml - XML 架构：空的 targetNamespace

> ID：727275
> 
> 赞同：6
> 
> 时间：2009-04-07T19:35:04.210
> 
> 标签：xml, xsd

在 Xml 模式中不使用 targetNamespace 属性或空属性是否合法？

如果是这样，那是什么意思，我们是在“空命名空间”（始终存在）中“添加”一些东西，还是创建一个与其他模式无关的“匿名命名空间”？

实例 xml 文档会是什么样子，元素是否需要显式绑定到某个命名空间？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-07T20:32:47.537

请参阅[XML Schema Part 0: Primer](http://www.w3.org/TR/xmlschema-0/#UndeclaredTNS)以获得关于未声明的 targetNamespaces 如何工作的非常简洁的描述。

至于空的 targetNamespace，那是无效的。从[规格](http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/structures.html#element-schema)：

> 由于空字符串不是合法的命名空间名称，因此为 targetNamespace 提供空字符串是不连贯的，并且与根本不指定它不同。对应于其组件没有{target namespace} 的·schema· 的适当形式的架构文档是完全没有指定targetNamespace 属性的架构文档。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-07T20:22:47.687

当然是。XML 名称空间是可选的——如果您愿意，可以将它们排除在外，并且如果您不会在“XML 世界”中遇到歧义 XML 元素的任何问题。

# c# - FunctionA(Exception ex) 是否与 FunctionB 相同 (T ex) 其中 T : 例外？

> ID：727278
> 
> 赞同：1
> 
> 时间：2009-04-07T19:36:15.410
> 
> 标签：c#, generics

关于泛型的两个简单问题。

以下两个函数定义是否相同？

```
FunctionA(Exception ex);

FunctionB<T>(T ex) where T : Exception; 
```

通用实现 (FunctionB) 与普通实现 (FunctionA) 相比是否有优势？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T19:41:58.827

请参阅此问题：
[约束到接口的泛型参数与仅使用接口之间的区别](https://stackoverflow.com/questions/595260/difference-between-generic-argument-constrained-to-an-interface-and-just-using-th)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T19:38:24.547

以下内容实际上是相同的（结果）：

```
catch (Exception e)
{
    FunctionA(e);
    FunctionB(e);
} 
```

但是如果你这样做就不一样了：

```
catch (ApplicationException e)
{
    FunctionB(e);
}
catch (Exception e)
{
    FunctionA(e);
} 
```

这是因为 FunctionB 在编译时被输入到 ApplicationException，而对 FunctionA 的调用总是将参数向下转换为 Exception。根据您对 FunctionB 的实现，这可能无关紧要，但在某些情况下它可以有所作为。我会说，根据经验，如果您的方法实现不需要通用实现，请不要使用它。

以下是一些何时重要的示例：

```
public T AddSomeContextToThisException<T>(T ex) where T : Exception
{
    ex.Data.Add("Some key", "Some context message");
    return ex;
}

public T ThisIsABadIdeaForExceptionsButMaybeAGoodIdeaForOtherTypes<T>(T ex) where T : Exception, new()
{
    // do something with ex

    return new T();
} 
```

下面的例子需要一些额外的上下文代码，所以请看下面的代码：

```
private readonly Bar bar = new Bar();

public void HandExceptionOffToSomethingThatNeedsToBeStronglyTyped<T>(T ex) where T : Exception
{
    ICollection<T> exceptions = bar.GetCollectionOfExceptions<T>();
    exceptions.Add(ex);

    // do other stuff
}

public class Bar
{
    // value is object, because .net doesn't have covariance yet
    private Dictionary<Type, object> listsOfExceptions = new Dictionary<Type, object>();

    public ICollection<T> GetCollectionOfExceptions<T>()
    {
        if (!listsOfExceptions.ContainsKey(typeof(T)))
        {
            listsOfExceptions.Add(typeof(T), new List<T>());
        }
        return listsOfExceptions[typeof(T)] as List<T>;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T19:40:49.190

在函数内部，没有区别。差异来自外部。如果使用泛型函数，则可以将相同类型的异常返回给调用代码而不是 base `Exception`。大多数情况下，这是一个有争议的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T19:42:04.773

FunctionB 与 FunctionA 相比没有太多优势。但是，两者之间有明显的区别。

使用 FunctionA，您可以将派生自（或者是）异常的任何类型传递给函数。

使用 FunctionB，您可以将派生自 T 的任何类型（必须派生自或是异常）传递给函数。

这意味着根据 T 的类型，您将拥有一个更专业的参数，它将限制您可以传递给它的类型，因为参数将被键入为 T，而不是异常。

现在如果 T 是一个异常，那么没关系，功能是一样的。但是，如果 T 是 InvalidOperationException，则只允许 InvalidOperationException 的实例（以及从它派生的类）。

当您想要确保类型的专业化而不必求助于不提供您需要的专业化级别的基类时，这通常是您想要的。

# c# - 如何获取可用的网络驱动器进行映射？

> ID：727280
> 
> 赞同：0
> 
> 时间：2009-04-07T19:36:57.920
> 
> 标签：c#

C# 中是否有可用的类或 API 来获取可用的网络驱动器或用于映射的最后可用驱动器？例如“Z：”。像这样的东西：

```
string mappeddrive = MappDriveUtil.GetLastAvailableMappedDrive(); // utility class 
```

我可以扫描本地驱动器和映射驱动器来找出答案吗？如果这是找出方法，如何扫描所有已在使用的本地和映射驱动器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T19:43:50.807

这是没有很好答案的问题之一。您当然可以使用 DriveInfo.GetDrives 枚举所有当前可用的驱动器。从中您可以推断出哪些驱动器未映射。

但问题是您只能分辨哪些驱动器未映射**而**不是未映射。在调用 GetDrives() 和实际映射驱动器之间，完全有可能其他程序出现并映射您选择的驱动器。您的解决方案**必须**考虑到这种可能性，否则它将在该领域出现可靠性问题。

# url - URL 中 slug 的位置是否重要？

> ID：727281
> 
> 赞同：12
> 
> 时间：2009-04-07T19:37:03.257
> 
> 标签：url, seo, search-engine, slug, url-mapping

**对于搜索引擎优化目的**，URL 中 slug 的位置是否重要？

毫无疑问，您可以对 URL slug 进行编码以按任何顺序正常工作。我更想知道搜索引擎是否对右侧和左侧的 URL 部分赋予不同的权重

例如，这里的 slug 出现在 URL 的末尾： [为什么有些网站会在 URL 的末尾添加“Slugs”？](https://stackoverflow.com/questions/47427/why-do-some-websites-add-slugs-to-the-end-of-urls)

而这里的 slug 出现在 URL 的中间： [https://stackoverflow.com/questions/why-do-some-websites-add-slugs-to-the-end-of-urls/47427](https://stackoverflow.com/questions/why-do-some-websites-add-slugs-to-the-end-of-urls/47427)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-07T19:44:34.580

最好将语义内容较少的内容推到右侧，因为它更有可能被认为相关的内容的长度限制所截断。因此，您发布的第二种形式对于 SEO 而言会比 SO 的方式更好。（更好的是使用 slug 作为真正的标识符，并将无语义内容的 ID 排除在外。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-07T20:02:48.030

我总是遵循这样的规则，即在为用户（实际用户或谷歌）确定 URL 中最重要的信息时，从右到左移动很重要。因此，您必须问自己的问题是，您是否希望您的用户将 ID 或标题视为页面中最重要的内容。

另外，如果他们放弃号码，只留下标题，会发生什么。该页面正确地爆炸了，但是如果您放下蛞蝓并留下号码会发生什么。页面正常运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T15:11:01.167

不幸的是，考虑到谷歌（和大多数其他搜索引擎）通过默默无闻（如果描述/解释了任何明确的方法，害怕系统游戏）的安全性，就不会有一个明确的、可证明的答案。

总的来说，你可以假设如果它看起来很粘，谷歌会惩罚它，如果它看起来语义/有用，谷歌会推广它。对于上面的 url，我猜测 Google 会同时对待这两者，但这完全是一个猜测，除了在这里停下来的 Google 算法工程师之外，我怀疑你会找到更确定的东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-07T19:41:55.537

如果 slug 在末尾，解析 URL 可能会容易得多。您可以从路径的开头提取所需的值，然后忽略它之后的所有内容。（所以蛞蝓可能比你拥有的更复杂，有多个“目录”等）。如果您将 slug 放在开头或中间，您必须能够解析它才能找到重要的内容。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-07T19:58:46.853

```
https://stackoverflow.com/questions/727281/blahblablah-lets-assume-that-this-continues-on-and-on-and-on 
```

现在，如果你截断它`https://stackoverflow.com/questions/727281/blahbla`仍然有效。

在另一种情况下：[https://stackoverflow.com/questions/why-do-some-websites-add-slugs-to-the-end-of-urls/47427](https://stackoverflow.com/questions/why-do-some-websites-add-slugs-to-the-end-of-urls/47427)截断[https://stackoverflow.com/questions/why -do-so](https://stackoverflow.com/questions/why-do-so)将没有机会工作。

# javascript - 是否有用于渲染使用 JavaScript 的网页的命令行或库工具？

> ID：727283
> 
> 赞同：18
> 
> 时间：2009-04-07T19:37:07.607
> 
> 标签：javascript, html, command-line

对我来说，互联网上的页面抓取似乎有些困难，因为越来越多的网站依赖于 JavaScript 来呈现部分屏幕。

在我看来，随着这么多开源布局和 JavaScript 渲染器的发布（如[WebKit](http://webkit.org/)、[Gecko](https://developer.mozilla.org/en/Gecko)和[Chromium](http://code.google.com/chromium/) + [V8](http://code.google.com/p/v8/)），一定有人制作了一个无需运行实际浏览器即可下载页面并渲染其 JavaScript 的工具。但是，我并没有通过搜索找到我正在寻找的东西——我找到了像[Selenium-rc](http://seleniumhq.org/projects/remote-control/)这样的工具，但它们依赖于正在运行的浏览器。我对可以执行以下一项（或两项）操作的任何工具或库感兴趣：

1.  一个可以从命令行 (*nix) 运行的程序，给定页面的源，返回由某些 JS 引擎呈现的页面源。

2.  特定语言的集成支持，允许（轻松）将页面源传递给它并返回由某些 JS 引擎呈现的页面源。

我认为＃1在一般意义上更可取，但如果该工具存在于我想要使用的语言中，＃2会更有用。另外，我不关心特定的JS引擎 - 任何相对现代的引擎都可以. 外面有什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-03-30T04:38:00.970

web kit html to pdf 完美，甚至可以生成jpg

[http://wkhtmltopdf.googlecode.com](http://wkhtmltopdf.googlecode.com)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T22:03:32.000

由于 JavaScript 可以对网页的文档对象模型 (DOM) 进行大量操作，因此似乎可以准确地抓取任意页面的内容，您不仅需要运行 JavaScript 引擎，还需要页面的完整和准确的 DOM 表示。只有当您实例化了一个真正的浏览器引擎时，您才能获得这种效果。可以为此使用嵌入式的、不显示的 WebKit 或 Gecko 引擎，然后在适当的加载延迟后允许脚本执行，只需以 HTML 形式转储 DOM 内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T19:48:14.320

您可以查看[HTMLUnit](http://htmlunit.sourceforge.net/faq.html)。它的主要目的是自动 web 测试，但我认为它可以让你得到渲染的页面。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-07T19:53:20.157

嗯，有[DumpRenderTree](http://trac.webkit.org/browser/trunk/WebKitTools/DumpRenderTree)工具，它被用作 WebKit 测试套件的一部分。我不确定它是否适合变成一个独立的工具，但它可以满足您的要求（渲染 HTML、运行 JavaScript 并将其渲染树转储到磁盘）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-07T19:48:18.937

我们前段时间使用[Rhino](http://www.mozilla.org/rhino/)从 Java 做一些自动化测试。看来它会为你完成这项工作:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-07T20:13:38.113

我认为 Qt 有一个示例代码，它使用包含的 WebKit 将页面呈现到像素图。从那里到完整的 CLI 实用程序只是定义您的需求。

当然，对于大多数屏幕抓取需要，您需要文本，而不是像素图......如果这是您想要的，最好检查 Rhino

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-07T20:25:33.107

让 WebView 呈现页面而不显示任何内容的代码非常少，但它必须是 GUI 应用程序。他们也可以接受命令行参数，并隐藏窗口。在工具中直接使用 WebKit 可能是可能的。

除了 Objective-C 中复杂的 DOM 访问之外，WebKit 还可以注入 JavaScript，并与 jQuery 一起构成一个很好的抓取解决方案。不过，我不知道有任何通用应用程序这样做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-07T19:44:19.227

有 Cobra Engine for Java ( [http://lobobrowser.org/cobra.jsp](http://lobobrowser.org/cobra.jsp) )，它处理 Javascript（它也有一个渲染器，但这是可选的）。我从未使用过它，但听说过关于它的好话。

# asp.net-mvc - 真的不可能在 mvc 母版页中编写代码吗？

> ID：727285
> 
> 赞同：0
> 
> 时间：2009-04-07T19:37:59.150
> 
> 标签：asp.net-mvc

我想做的就是写一些类似的东西

```
<%=Html.ScriptInclude("~/Scripts/jquery.1.2.6.js")%> 
```

当我这样做时，我得到一个错误：

> 无法修改 Controls 集合，因为该控件包含代码块（即 <% ... %>）

我正在使用 ASP.NET MVC Release Candidate 1。

这是不可能实现的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T19:45:09.710

不，不是不可能。我正是这样做的。下面是最近一个项目的代码片段。似乎是什么问题？

请注意，`StyleSheet`and`Javascript`是我自己的扩展方法，`DatedContent`UrlHelper 上的扩展也是如此。要使您自己的扩展方法正常工作，您需要在页面顶部导入包含它们的命名空间。

```
<%@ Import Namespace="MvcExtensions" %>

<%= Html.StyleSheet( Url.DatedContent( "~/Content/styles/themes/jquery-ui-theme.css" ) )%> 
<%= Html.StyleSheet( Url.DatedContent( "~/Content/styles/Site.css" ), "all" ) %>
<%= Html.Javascript( Url.Content( "~/Scripts/jquery-1.3.2.min.js" ) ) %>
<%= Html.Javascript( Url.Content( "~/Scripts/ui/ui-all-1.7.1.min.js" ) ) %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T19:40:59.207

你为什么不这样做：

```
<script src="../../Script/jquery.1.2.6.js" type="text/javascript"></script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T22:56:27.130

将您的代码放入`<asp:PlaceHolder runat="server">`标签中。RC1 中存在导致此问题的已知错误。查看[发行说明](http://go.microsoft.com/fwlink/?LinkID=137661&clcid=0x409)的第 23 页。

我还没有升级到 1.0，所以我不知道这是否已修复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T20:34:42.290

换个试试...

```
<%= Html.ScriptInclude("~/Scripts/jquery.1.2.6.js")%> 
```

...到...

```
<%# Html.ScriptInclude("~/Scripts/jquery.1.2.6.js")%> 
```

（将**=**更改为**#**）

# ruby-on-rails - 带有复选框的嵌套对象-即使使用accepts_nested_attributes_for也可以批量分配？

> ID：727300
> 
> 赞同：7
> 
> 时间：2009-04-07T19:42:20.777
> 
> 标签：ruby-on-rails, activerecord, associations, actionview

我认为应该有一个简单的解决方案，因为 Rails 2.3 具有这种新奇的嵌套表单功能。基本上我想创建或更新一个用户并同时为他们分配角色。

似乎我做的一切都是正确的，但我收到错误**警告：无法批量分配这些受保护的属性：roles_attributes**。

我什至尝试将视图更改为 user[permissions_attributes][role_id] 因为我认为可能连接表让 Rails 感到困惑。

无论如何，关于这应该如何实际工作的任何建议？

模型

```
class User < ActiveRecord::Base

  has_many :permissions
  has_many :roles, :through => :permissions

  accepts_nested_attributes_for :roles
  accepts_nested_attributes_for :permissions
end 
```

视图摘录（注意我尝试并未能让 fields_for 在这里生成我想要的东西，也许这是我的问题？）

```
<% for role in Role.all %>
 <%= check_box_tag( "user[roles_attrributes][id]",role.id) %>
 <%= role.rolename %>
 <br/>
<% end %> 
```

遇到的参数似乎是正确的：

```
 {"user"=>{"password_confirmation"=>"[FILTERED]", 
"roles_attrributes"=>{"id"=>"2"}, ... 
```

**解决方案**我拼写错误的组合，没有使用attr_accessible，需要访问permissions_attributes，并且表单略有偏差。

模型：

```
has_many :permissions, :dependent => :destroy
has_many :roles, :through => :permissions
accepts_nested_attributes_for :permissions
attr_accessible :permissions_attributes 
```

看法：

```
 <%  Role.all(:order => "rolename ASC").each_with_index do |role,idx| %>
    <%= check_box_tag( "user[permissions_attributes][#{idx}][role_id]",role.id) %>
    <%= role.rolename %>
    <br/>
    <% end %> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-07T21:02:08.013

如果您更正 中的属性拼写`check_box_tag`，它看起来应该可以工作。

```
<% for role in Role.all %>
 <%= check_box_tag( "user[roles_attributes][id]",role.id) %>
 <%= role.rolename %>
 <br/>
<% end %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-07T20:00:59.797

听起来这个属性没有被标记为可以安全更新。您应该能够通过将以下内容添加到模型类来修复它：

```
attr_accessible :roles 
```

或者可能：

```
attr_accessible :roles_attributes 
```

如果你看，你可能已经有一个 attr_accessible 调用，你可以添加它。有关详细信息，请在此处记录：

[http://api.rubyonrails.org/classes/ActiveRecord/Base.html#M002226](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#M002226)

# c# - 包含子类型的 Linq 查询

> ID：727308
> 
> 赞同：2
> 
> 时间：2009-04-07T19:46:04.513
> 
> 标签：c#, linq, entity-framework

在我的模型中，我将`Address`,`MailingAddress`和`Email`作为`Phone`Address 的子类。A`Person`有一个地址，因此查询拥有奥克兰邮寄地址的人的查询如下所示：

```
var peopleInOakland = from p in entities.DbObjectSet.OfType<Person>()
                             from a in p.Addresses.OfType<MailingAddress>()
                             where a.City == "Oakland"
                             select p; 
```

如何在我的查询结果中也包含此人的邮寄地址？我知道我应该使用 Include，但我不确定如何`MailingAddress`在`.Include`参数中命名。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T19:51:30.880

您将必须创建一个具有您正在寻找的特定类型的新类型，如下所示：

```
var peopleInOakland = 
    from p in entities.DbObjectSet.OfType<Person>()
    from a in p.Addresses.OfType<MailingAddress>()
    where a.City == "Oakland"
    select 
        new { Person = p, Addresses = p.Addresses.OfType<MailingAddress>() }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T19:49:53.753

只需使用理解表达式的本地名称选择匿名类型：

```
...
select new {
  Persion = p,
  Address = a
}; 
```

# c++ - WcfSvcHost 和 IIS WCF 主机遇到 BadImageFormatException

> ID：727313
> 
> 赞同：5
> 
> 时间：2009-04-07T19:47:15.180
> 
> 标签：c++, wcf, interop, iis-6, was

引用 x86 DLL 时，在 Vista x64 上的 Visual Studio 2008 中创建 WCF 服务库很麻烦。调用 32 位 DLL 的服务需要具有 x86 平台目标才能在 64 位操作系统上运行。执行此操作时，当您尝试调试服务时，WcfSvcHost 会引发 BadImageFormatException。有一个关于 MS 连接的[错误报告。](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=349510)我使用的解决方法是将[WcfSvcHost 核心标记为 32-bit](https://connect.microsoft.com/VisualStudio/feedback/Workaround.aspx?FeedbackID=349510)。

**明显问题**

我遇到的主要问题是这个第三方本机 32 位 DLL 无法使用某些 WCF 主机加载。调用使用第三方 DLL**的服务操作**时，我收到以下错误：

> System.TypeInitializationException：“”的类型初始化程序引发了异常。
> 
> .ModuleLoadExceptionHandlerException：在导致 C++ 模块加载失败的主要异常之后发生了嵌套异常。
> 
> System.BadImageFormatException：该模块应包含程序集清单。（来自 HRESULT 的异常：0x80131018）

嵌套异常：

> 句柄无效。（来自 HRESULT 的异常：0x80070006 (E_HANDLE)）

当 WcfSvcHost 启动时不会引发此异常，它会在调用引用 32 位 DLL 的服务操作时引发。非常有趣的是，在控制台应用程序上使用相同的 app.config 托管相同的服务没有例外，并且运行良好：

```
using (ServiceHost host = new ServiceHost (typeof (MsgBrokerService))) {
    host.Open ();
    Console.WriteLine ("running");
    Console.ReadLine (); 
```

此异常发生在以下情况之后：

> “WcfSvcHost.exe”（托管）：已加载“C:\Windows\WinSxS\x86_microsoft.vc80.crt_1fc8b3b9a1e18e3b_8.0.50727.3053_none_d08d7bba442a9b36\msvcm80.dll”

同样，控制台应用程序没有异常并加载相同的 DLL：

> “ConsoleApp.vshost.exe”（托管）：已加载“C:\Windows\WinSxS\x86_microsoft.vc80.crt_1fc8b3b9a1e18e3b_8.0.50727.3053_none_d08d7bba442a9b36\msvcm80.dll”

**[请参阅Microsoft 产品支持的](https://stackoverflow.com/questions/727313/wcf-problems-with-hosting-on-wcfsvchost-and-iis/942578#942578)**回答**。**

 **更新 #1：控制台应用程序和 WcfSvcHost.exe 主机进程都在同一会话和登录用户（我）下运行。我已将 WcfSvcHost.exe 复制到服务目录，手动启动并遇到相同的结果。我还检查了 Windows 事件日志以获取更多信息并使用*sxstrace*，但没​​有记录任何内容。

运行 Process Explorer，我已经验证了两个进程之间的以下内容相同：

*   图像：32 位
*   当前目录
*   用户/SID
*   会议
*   安全性（组被拒绝，特权被禁用）

运行 Process Monitor 并[配置符号](http://blogs.msdn.com/vijaysk/archive/2009/04/02/getting-better-stack-traces-in-process-monitor-process-explorer.aspx)，我看到 WcfSvcHost 查找以下注册表和文件，而控制台主机没有。*Process Monitor 记录了很多数据，我不确定我在寻找什么:(*。

> HKLM \ Software \ Microsoft \ Fusion \ PublisherPolicy \ Default \ Policy.8.0.MSVCM80_B03F5F7F11D50A3A C：\ Windows \ assembly \ Gac_32 \ MSVCM80 \ 8.0.50727.3053_CM：\ Windows \ alifting \ Gac_MSIL \ MSVCM80 \ 8.0.50727.3053_B03F5F7.3053_B03F5F7F11D50A3A C：\ Windows\程序集\GAC\msvcm80\8.0.50727.3053__b03f5f7f11d50a3a

更新 #2：当服务**托管在**IIS 6/Windows Server 2003 上的生产环境中时，也会发生同样的异常。

更新 #3：第 3 方 32 位 .NET 程序集是[StreamBase API](http://streambase.com/developers/docs/latest/apiguide/creatingdotnetclients.html)：

*   sbclient.dll（托管）
*   monitor.netmodule（托管）
*   dotnetapi.dll（非托管）
*   pthreads-vc8.dll（非托管）

更新 #4：添加清单但未成功：

1.  验证 dotnetapi.dll 和 pthreads-vc8.dll 有 RT_MANIFEST。sbclient.dll .NET 程序集没有清单
2.  从 GAC 中删除 sbclient.dll
3.  注册 sbclient.dll 以跳过验证
4.  通过[mt.exe](http://blogs.msdn.com/cheller/archive/2006/08/24/718757.aspx)将清单添加到 sbclient.dll 和 monitor.netmodule
5.  添加了经过验证的清单，并且在测试期间加载了预期的文件（通过 Visual Studio - 调试模块窗口）
6.  在 BackgroundWorker.OnDoWork() 下会抛出相同的 BadImageFormatException，调用堆栈显示对 dotnetapi.dll...DefaultDomain.Initalize() 的调用。

我已经验证 msvcm80.dll 没有清单，我相信这是加载的唯一没有清单的文件:)

有趣的发现

[当我在Reflector](http://www.red-gate.com/products/reflector/)加载 monitor.netmodule 时，它​​说：

> “monitor.netmodule”不包含程序集清单。

即使它显示错误，Reflector 仍然能够反汇编托管代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-12-01T18:06:38.183

有点晚了，但您也可以在高级设置中将应用程序池设置“启用 32 位应用程序”更改为 true。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T00:34:09.110

Microsoft 产品支持解决了这个问题：这是设计使然。使用 WcfSvcHost 或 IIS WCF 主机时，未在默认 AppDomain 中加载非托管代码。

> 纯映像将使用 C 运行时库的 CLR 版本。但是，CRT 是不可验证的，因此在使用 /clr:safe 进行编译时不能使用 CRT。有关详细信息，请参阅 C 运行时库。

[http://msdn.microsoft.com/en-us/library/k8d11d4s.aspx](http://msdn.microsoft.com/en-us/library/k8d11d4s.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T13:39:49.790

我无法为该错误提供解释，只是我最初怀疑代码作为服务运行的上下文与将其放置在控制台应用程序中时运行的上下文之间存在权限差异。E_HANDLE HRESULT 是我的线索。假设您以登录用户身份运行控制台应用程序，您可以尝试将服务配置为也以该用户身份启动。如果它在该配置中有效，那么您可以尝试缩小在失败时不可用的所需资源。

我可以建议一个解决方法。如果有问题的 DLL 存在异常，使其无法在托管服务中工作，则可以采用牺牲进程方法，之所以如此命名，是因为它通常用于隔离经常崩溃的 DLL。简而言之，您创建了一个代理程序，其唯一目的是代表您的主进程加载和调用 DLL，使用命名管道或其他一些 IPC 方法来传递请求和结果。如果 DLL 崩溃，您将启动代理程序的新实例。在您的情况下，它还有一个额外的好处，即只有包装程序需要是 32 位的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T20:00:28.613

您在事件查看器中看到什么特别的东西吗？
在 Vista 中，如果存在明显问题，您将在事件查看器中看到它的痕迹，它会告诉您使用[SxsTrace](http://blogs.msdn.com/junfeng/archive/2006/04/14/576314.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-18T23:49:38.753

您能否使用 mt.exe 文件自己手动将清单添加到此 DLL 中？

[关于使用 mt.exe 的 MSDN 文章](http://blogs.msdn.com/cheller/archive/2006/08/24/718757.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-18T15:22:39.687

这可能看起来有点愚蠢。但请确保您的服务在正确的应用程序池中运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-04-20T14:13:09.567

我自己遇到了这个问题。我找到了一个[有用的帖子](https://coding.abel.nu/2012/04/debugging-a-wcf-service-using-a-32-bit-dll/)。正如其他帖子中所述，微软表示这是设计使然。基本上你需要：

1.  找到您的 WcfSvcHost.exe 版本。（对于我和 Visual Studio 2017：C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional\Common7\IDE）

2.  启动开发人员命令提示符

3.  执行cmd：（`copy C:\SourcePath\WcfSvcHost.exe C:\DestinationPath\WcfSvcHost32.exe` 目的地无所谓）

4.  cmd: `corflags /32BIT+ /Force WcfSvcHost32.exe`(可能需要 cd 到 DestinationPath

5.  在 Visual Studio 中打开 WCF 项目属性 > 调试选项卡 > 启动外部程序：`C:\DestinationPath\WcfSvcHost32.exe`

6.  还要添加你的命令行参数：

    /service:MyWCFProjectName.dll /config:MyWCFProjectName.dll.config

    *`($ProjectDir)`注意：这里不需要使用*

7.  启动应用程序。您现在可以自由地单独启动 WcfServiceHost.exe。

8.  （可选）转到解决方案 > 设置启动项目 > 多个启动项目 > 选择 Wcf 项目和客户端项目。

# php - 通过调用一个返回该类实例的函数来启动一个类 - PHP？

> ID：727314
> 
> 赞同：0
> 
> 时间：2009-04-07T19:48:13.227
> 
> 标签：php, class, initialization

```
class foo(){

   function bar()
   {
     $classInstance = $this->createClassInstance($params);
     $result = $classInstance->getSomething();
   }

   function createClassInstance($params)
   {
     require 'path/to/class.php';
     $myClass = new Class;
     $myClass->acceptParams($params['1']);
     $myClass->acceptMoreParams($params['2']);
     .... lots more params
     return $myClass;
   }

} 
```

我可以通过调用返回类对象的方法来启动一个新类吗？有问题的类有很多参数，我需要在 bar() 中多次调用它，所以我认为这样做会更整洁，但我无法让它工作并想检查它是否可能 + 好实践？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T19:50:32.567

这就是所谓的工厂类（[Factory OO Design Pattern](http://en.wikipedia.org/wiki/Factory_design_pattern)）。

应该如何在 PHP 中完成：[http ://www.php.net/manual/en/language.oop5.patterns.php](http://www.php.net/manual/en/language.oop5.patterns.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T19:51:26.153

我认为您所描述的是工厂模式，但是您使用参数来设置类变量，就像在构造函数中一样，那么为什么不直接使用呢？

**编辑：**

啊，如果您在大多数情况下使用相同的参数，那么您肯定需要工厂模式。只需使用静态函数返回类的实例，并将其放入您要返回的类的类型中：

```
class MyClass
{
    public static function factory($params)
    {
        $myClass = new MyClass;
        $myClass->acceptParams($params['1']);
        $myClass->acceptMoreParams($params['2']);
        //.... lots more params
        return $myClass;
    }
}

class foo(){

   function bar()
   {
     $classInstance = MyClass::factory(param1, param2);
   }
} 
```

# rhino-mocks - 使用 Rhino Mocks，为什么在测试初始化 期间对属性调用模拟返回预期调用 #1，实际调用 #0？

> ID：727319
> 
> 赞同：1
> 
> 时间：2009-04-07T19:49:07.687
> 
> 标签：rhino-mocks, rhino

我目前有一个测试来测试我在 MVP 模型中的演示者。在我的演示者上，我有一个属性将调用我的视图，在我的测试中它被模拟了。在我的测试的初始化中，在我将 Presenter 上的 View 设置为模拟 View 后，我在 Presenter 上设置我的属性，它将调用此方法。

在我的测试中，我调用的方法没有 Expect.Call，但是当我运行时，我得到了这个 Rhino 模拟异常：

Rhino.Mocks.Exceptions.ExpectationViolationException: IView.MethodToInvoke(); 预期 #1，实际 #0..

根据我对 Rhino 模拟的理解，只要我在期望块之外的模拟上调用它不应该记录这个。我会想象测试通过。有没有通过的原因？

下面是一些代码来显示我的设置。

```
public class Presenter
{
    public IView View;

    public Presenter(IView view)
    {
        View = view
    }
    private int _property;
    public int Property
    get { return _property;}
    set
    {
       _property = value;

       View.MethodToInvoke();
    }
} 
```

...下面的测试代码...

```
[TestInitialize]
        public void Initilize()
        {
            _mocks = new MockRepository();
            _view = _mocks.StrictMock<IView>();
            _presenter = new Presenter(_view);
            _presenter.Property = 1;            
        }
[TestMethod]
        public void Test()
        {
            Rhino.Mocks.With.Mocks(_mocks).Expecting(delegate
            {                
            }).Verify(delegate
            {
                _presenter.SomeOtherMethod();
});
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T13:17:19.250

为什么你要在每次运行测试时都测试相同的东西？

如果你想测试某个特定的事情发生了，你应该在一个测试中检查它。

您现在使用的模式意味着您需要 - 设置测试的先决条件 - 执行行为 - 检查行为是否正确，然后在一次测试中重复几次

您需要为每个测试开始测试一件事，这有助于使测试更清晰，并更容易使用 AAA 语法。

这里有几件事要讨论，但如果你这样做肯定会更清楚：

```
[TestMethod]
ShouldCallInvokedMethodWhenSettingProperty()
{
   var viewMock = MockRepository.GenerateMock<IView>()

   var presenter = new Presenter(viewMock);

   presenter.Property = 1;

   viewMock.AssertWasCalled(view => view.InvokedMethod());

} 
```

在此处阅读有关 Rhino Mocks 3.5 语法的更多信息：http: [//ayende.com/Wiki/Rhino+Mocks+3.5.ashx](http://ayende.com/Wiki/Rhino+Mocks+3.5.ashx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T19:58:10.677

1.  您到底想在 Test 方法中测试什么？
2.  您应该尽量避免使用严格的模拟。
3.  我建议使用[Rhino 的 AAA 语法 (Arrange, Act, Assert)](http://ayende.com/Wiki/(S(lxlrwqf20t0e1x4500w3pp45))/Rhino+Mocks+3.5.ashx#Arrange,Act,Assert)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T20:35:05.207

问题在于我不了解 Strict 模拟正在进行的记录/验证。为了解决我遇到的问题，我改变了我的 TestInitilize 函数。这基本上对我为所有测试设置的初始状态进行了快速测试。

```
[TestInitialize]
    public void Initilize()
    {
        _mocks = new MockRepository();
        _view = _mocks.StrictMock<IView>();
        _presenter = new Presenter(_view);

        Expect.Call(delegate { _presenter.View.InvokedMethod(); });
        _mocks.ReplayAll();
        _mocks.VerifyAll();
        _mocks.BackToRecordAll();
        _presenter.Property = 1;
    } 
```

# c# - 通过 C# 修改本地用户组

> ID：727323
> 
> 赞同：0
> 
> 时间：2009-04-07T19:50:42.130
> 
> 标签：c#, windows

好吧，所以问。

我正在处理以前托管在 Windows 2000 机器上的应用程序，现在我必须将它移至 Windows XP。应用程序需要能够将其用户帐户从管理员切换到受限帐户，反之亦然（中间需要重新启动）。

使用 netapi32.dll 包装器，这在 Windows 2000 中运行良好。当我尝试使用 Windows XP 时，当我尝试从受限帐户中删除该帐户并将其添加到管理员帐户时，我收到拒绝访问错误。它反过来工作。

有谁知道需要在哪里修改权限才能允许受限制的帐户从用户帐户中添加/删除组？Windows 2000 和 Windows XP 之间的处理方式似乎不同。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-07T19:53:43.620

我无法谈论那里的差异，但我认为您需要查看其他解决方案，例如模仿。这将允许您在不同用户的上下文中执行代码和 Windows 操作，而无需对帐户本身进行修改。

如果您必须出于其他目的对帐户进行修改，则您的服务需要在管理帐户的上下文中运行并在不同的帐户上执行修改。

# asp.net-mvc - 在asp.net mvc中结合文件上传DropDownList

> ID：727326
> 
> 赞同：0
> 
> 时间：2009-04-07T19:51:31.537
> 
> 标签：asp.net-mvc, drop-down-menu

我在我的 asp.net mvc 应用程序中有一个文件上传功能，它允许用户上传一个 xslx 文件，其中包含应该保存到数据库的数据。该数据可以与许多类别之一相关。我需要能够辨别传入的数据应该与哪个类别相关，所以我认为下拉列表非常适合这项工作。但是，当用户发布数据时，我不知道如何获取列表选择值。表单的代码如下所示：

```
 <form action="/Import/UploadFiles/" method="post" enctype="multipart/form-data">
    <fieldset id="fileImport">
        <legend>Importinställningar</legend>
        <label for="file">Importfil:</label>
        <input type="file" id="file" name="file" />
        <%= Html.DropDownList("Name", (IEnumerable<SelectListItem>)ViewData["assignments"]) %>
        <p>
            <input type="submit" value="Spara"/>
            <input type="button" value="Avbryt" onclick="window.location.href='/'" />
        </p>
    </fieldset>
</form> 
```

由于我正在处理文件上传场景，因此我没有可用于将数据传递给控制器​​的操作链接，而是具有提交类型的输入。

我应该如何阅读下拉列表的选择值，以便将其选择的值传递给控制器​​？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-07T20:00:08.333

有几种不同的方法可以完成这项工作。`Name`首先，在 UploadFiles 方法中添加一个名为的字符串参数。默认的活页夹将从同名的表单值中填写。或者，您可以使用控制器内部的 ValueProvider（例如，如果您使用相同的操作来呈现视图和响应帖子）来提取名为`Name`.

```
public ActionResult UploadFiles( string Name )
{
    ...
} 
```

或者

```
public ActionResult UploadFiles()
{
     string name = this.ValueProvider.ContainsKey("Name")
                         ? this.ValueProvider[key].AttemptedValue
                         : null;

     ...
 } 
```

# wpf - 如何调用对话框手动设置打印机选项？

> ID：727328
> 
> 赞同：6
> 
> 时间：2009-04-07T19:52:20.363
> 
> 标签：wpf, printing, printer-properties

我正在使用 WPF，需要让用户设置一些与打印相关的选项，例如打印机和打印机属性（例如纸盘、横向/纵向、双面打印等）。我知道 PrintDialog 类可以获取 PrintQueue 和 PrintTicket 对象。但是我需要创建自定义解决方案并且无法显示 PrintDialog。我设法获取可用的 PrintQueue 对象并让用户选择打印机。我正在为打印机属性而苦苦挣扎。我的问题是：如何显示用户可以在其中为选定的 PrintQueue 设置打印机属性的对话框（当用户单击 WPF PrintDialog 中的“属性”按钮时显示的对话框）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-13T02:25:15.370

**[在这里](http://social.msdn.microsoft.com/forums/en-US/netfxbcl/thread/8c65f924-68b9-4e45-a416-2f20e30faa1f/)**找到了以下代码（减去`Window_Loaded`事件）。我对它进行了测试，它似乎很有魅力。显然，您必须`PrinterSettings`在显示对话框之前在对象中设置打印机名称。

希望这对你有用：

```
[DllImport("kernel32.dll")]
static extern IntPtr GlobalLock(IntPtr hMem);

[DllImport("kernel32.dll")]
static extern bool GlobalUnlock(IntPtr hMem);

[DllImport("kernel32.dll")]
static extern bool GlobalFree(IntPtr hMem);

[DllImport("winspool.Drv", EntryPoint = "DocumentPropertiesW", SetLastError = true, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
static extern int DocumentProperties(IntPtr hwnd, IntPtr hPrinter, [MarshalAs(UnmanagedType.LPWStr)] string pDeviceName, IntPtr pDevModeOutput, IntPtr pDevModeInput, int fMode);

private const Int32 DM_OUT_BUFFER = 14;

public void OpenPrinterPropertiesDialog(PrinterSettings printerSettings, System.IntPtr pHandle) {
    IntPtr hDevMode = printerSettings.GetHdevmode();
    IntPtr pDevMode = GlobalLock(hDevMode);
    Int32 fMode = 0;
    int sizeNeeded = DocumentProperties(pHandle, IntPtr.Zero, printerSettings.PrinterName, pDevMode, pDevMode, fMode);
    IntPtr devModeData = Marshal.AllocHGlobal(sizeNeeded);

    fMode = DM_OUT_BUFFER;

    DocumentProperties(pHandle, IntPtr.Zero, printerSettings.PrinterName, devModeData, pDevMode, fMode);
    GlobalUnlock(hDevMode);
    printerSettings.SetHdevmode(devModeData);
    printerSettings.DefaultPageSettings.SetHdevmode(devModeData);
    GlobalFree(hDevMode);
    Marshal.FreeHGlobal(devModeData);
}

private void Window_Loaded(object sender, RoutedEventArgs e) {
    OpenPrinterPropertiesDialog(new PrinterSettings(), new WindowInteropHelper(this).Handle);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-10T03:40:54.460

如果您以 x86 编译为目标并从 x64 机器运行，则来自 Pwninstein 的代码将不起作用：分配时`devModeData`，`DocumentPropreties`总是会失败并返回`sizeNeeded`-1 的 a，`LastError`代码为 13。

要解决此问题，请确保以*AnyCPU*为目标，或者只需将调用更改`DocumentPropreties`为以下内容：

```
int sizeNeeded = DocumentProperties(pHandle, 
                                    IntPtr.Zero, 
                                    printerSettings.PrinterName, 
                                    IntPtr.Zero, // This solves it
                                    pDevMode, 
                                    fMode); 
```

使用`IntPtr.Zero`而不是正确的指向 DevMode 结构的指针看起来是错误的，但是第一次调用 DocumentProperties 不会尝试修改该位置的内存。调用返回的唯一数据是存储表示打印驱动程序内部参数的设备模式数据所需的内存大小。

参考：

*   [DocumentProperties 上的 PInvoke.Net 页面](http://www.pinvoke.net/default.aspx/winspool.DocumentProperties)

# c# - GDI+ 离屏缓冲滚动

> ID：727329
> 
> 赞同：2
> 
> 时间：2009-04-07T19:52:45.650
> 
> 标签：c#, gdi+, drawing, scroll, buffer

我正在使用 C# GDI+ 创建一个自定义控件。

快速解释...该控件将在屏幕上显示 500 像素，但可能包含 500000 像素的信息。因此，虽然我一次只显示 500 像素，但我显然需要在水平面（左右）滚动。棘手的部分是每个 500 像素的位图块需要一段时间（在 100 毫秒 - 1000 毫秒之间）来渲染。

所以我的计划是在内存中维护一个 1500px 的位图。即 500px 可见部分和 500px 可见区域的任一侧，并在用户滚动时异步绘制屏幕外部分。

我想要一些反馈、建议、批评或代码示例来帮助我实现这一目标。这看起来相当简单，但经过几次初步测试尝试后，它被证明比人们想象的要困难得多。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T20:01:53.757

这种方法的有效性取决于，除其他外，用户将做的移动量。如果用户正在做小动作，然后停下来考虑新信息，这可能会起作用。但是，如果用户来回呼啸而过，您仍然会遇到问题。

您的应用程序是否有助于逐渐提高图像的质量——即提供一个快速可用的图像，然后在用户停止考虑时对其进行改进？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T20:10:27.950

几年前我也遇到过类似的问题。正如 dommer 所提到的，如果您在显示它们之前处理图像的块，那么您最好显示一些东西并稍后改进它。如果您在对原始图像进行 blitting 时遇到问题，则说明您的方法有问题。GDI+ 对像素深度非常特别（你想要 32bpp 和 alpha）。

在我们的例子中，我们处理了 500px 的图块，并在可见视图 Ff 周围填充了一个图块，当用户滚动到我们处理的区域之外时，我们用叠加在它们上面的黑色半透明矩形对原始图像的位进行了 blitted。这些块已排队等待处理。当我们处理图像的大块（居中）时，它们半透明的矩形会消失。

它工作得相当好，反应灵敏且速度非常快。将原始位图 blit 到屏幕上非常快，在我们的例子中，处理通常非常紧随其后。瓷砖变亮的效果其实还是蛮漂亮的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-20T16:29:07.523

仅绘制可见区域。构建方法

```
Bitmap DrawGraph(leftMargin, rightMargin) {...} 
```

然后在`OnPaint()`做

```
Bitmap bmp = new Bitmap(e.ClipRectangle.Width, e.ClipRectangle.Height);
bmp = DrawGraph(e.ClipRectangle.Left, e.ClipRectangle.Right);

e.Graphics.DrawImageUnscaled(bmp, e.ClipRectangle.Location); 
```

# windows - 如何从 Windows 接收 MPEG-TS 多播

> ID：727330
> 
> 赞同：1
> 
> 时间：2009-04-07T19:52:48.210
> 
> 标签：windows, multicast, wmp, mpeg

我们目前有一个系统，将实时视频编码为 MPEG-TS 多播流，由带有 STB 的电视接收。除了电视之外，我们还希望将视频嵌入到我们的 Windows 应用程序中。

我知道 VLC 将接收流，但更喜欢我可以嵌入现有应用程序而不玩窗口移动游戏的解决方案，以及没有许可问题的解决方案。我意识到这可能意味着我不是在寻找免费的解决方案，这很好，在合理范围内。

有人知道这方面的好产品吗？无论是易于使用的东西，还是 WMP 的插件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T21:10:58.770

您需要开发一个简单的`DirectShow`过滤器来侦听给定的端口并传递它收到的每个数据包。

我手边没有示例，但它真的很简单，几百行代码。

然后，您只需将此过滤器连接到`MPEG2 Demultiplexer`能够解码的`transport stream`.

`NVidia``Elecard`首先想到的是，尽管前者在调试器下没有连接。

然后将 连接`demultiplexer`到`decoder`，最后连接到`renderer`。

解复用器和解码器可以很好地处理实时流问题，您只需捕获`UDP`数据包并将其发送给它们。

由于许可问题，`MPEG2`解码器不能免费（`ffmpeg`并且`VLC`违反许可），因此您必须购买解码器。

访问[**http://elecard.com**](http://elecard.com/)，他们的`MPEG2`产品范围很广。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T21:32:00.407

扩展Quassnoi的答案......

您可以查看[Haali Media Splitter](http://haali.cs.msu.ru/mkv/)以充当“MPEG2 解复用器”。这是一个过滤器，它只是将压缩的视频和声音从传输流中提取出来，所以我猜它没有任何许可问题。大多数带有 DVD 播放器的 PC 已经有一个获得许可的 DirectShow MPEG2 解码器，因此您可能只使用已经安装的一个（或者如果您真的想安全的话，可以从 elecard 之类的地方购买许可证）。

在开发 DirectShow 应用程序时，您可能会发现[Monogram GraphStudio](http://blog.monogram.sk/janos/tools/monogram-graphstudio/)是设计过滤器链的有用工具。

# c++ - 如何从 Windows 交叉编译 PS3 上的 Cell Linux？

> ID：727336
> 
> 赞同：6
> 
> 时间：2009-04-07T19:56:55.733
> 
> 标签：c++, linux, g++, cell, ps3

如何实现交叉编译设置以允许使用 cygwin 工具链在 Windows PC 上编译 Cell Linux 程序？cygwin 工具提供了一个用于构建交叉编译器的 GNU 编译器，以及用于构建过程的相关工具，例如 rpm、cpio、make、flex、bison 等。

我有一定的信心这是可能的，但不知道有谁真正做到了这一点。它已经为[x86 Linux](http://www.cellperformance.com/articles/2006/11/crosscompiling_for_ps3_linux.html)完成了，但我希望使用 Windows，而不需要使用运行整个第二个操作系统的虚拟机和开销。

Cell Linux 工具链是一个修补过的 GNU 工具链，带有用于 PPU 和 SPU 处理器的 C 和 C++ 编译器，以及相关的 binutils。可以在[此处](http://www.bsc.es/projects/deepcomputing/linuxoncell/cellsimulator/sdk3.1/sources/toolchain/)找到用于 Cell Linux 的 Cell Linux SDK 的源代码。[此处](http://www.bsc.es/projects/deepcomputing/linuxoncell/cellsimulator/sdk3.1/SRPMS/)的源 RPMS具有构建脚本，可与 Linux 上的 rpmbuild 工具一起使用。

具体问题是：如何使用 Cygwin 在 Windows 上构建一组用于 PPU 和 SPU 处理器的 Cell Linux GNU 编译器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T02:31:05.147

我从来没有做过，所以我不能给你一步一步的指导，但我可以给你一个大概的想法。

您链接的说明将作为一个很好的大纲，但会有明确的变化。

对于主机 PC，您可以从[MinGW](http://www.mingw.org/)或[cygwin](http://www.cygwin.com)安装 gcc 和其他构建工具。这将为您提供工具链的 Windows 本机部分。

然后，您需要下载工具链的单元部分的源代码，并使用您刚刚安装的构建环境编译它们（使用适当的选项、--target 等）。

然后下载并编译 libspe2 的源代码，就完成了。

但我会警告你 - 这听起来比它更容易。准备好花很多时间在上面。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-16T14:42:15.617

既然您已经可以在 Linux x86 上执行此操作，为什么不直接在 Linux 上安装一个虚拟机呢？此外，可能更容易的是安装[适用于 Windows 的 Portable Ubuntu。](http://portableubuntu.demonccc.com.ar/)[它使用coLinux](http://www.colinux.org/)与 Windows 一起运行 Linux 。尽管这可能不是最佳的，但它可能比尝试在 Windows 上编译所有内容要容易得多*。*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T07:16:19.830

ps2dev 工具链可以在 cygwin 下轻松设置

[http://ps2dev.org/ps3/Tools/Toolchain](http://ps2dev.org/ps3/Tools/Toolchain)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T02:21:47.373

您应该能够在 Linux 上构建一个在 Windows 上运行并为 PS3 创建代码的[加拿大交叉编译器。](http://www.airs.com/ian/configure/configure_6.html)看看Dan Kegel[的优秀交叉工具。](http://www.kegel.com/crosstool/)

您是否检查过[用于 windows/cygwin 的 Cell/PS3 开发](http://sourceforge.net/projects/cellbe-cygwin)工具是否适合您？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-04T10:45:56.273

现在可以在[Sourceforge](http://sourceforge.net/projects/cellwindowssdk/)上找到一组编译为通过 Cygwin 在 Windows 上运行的工具。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-06T04:37:01.223

[Mike Acton 在他的Cell Performance](http://cellperformance.beyond3d.com/articles/2006/11/cross-compiling-for-ps3-linux-1.html)博客上有一篇关于 PS3 Linux 交叉编译的长篇详细文章。

它可能有点过时，但设置工具链和各种 SDK 的部分可能会很方便。

# regex - 如何在 mod_rewrite 中创建递归替换？

> ID：727338
> 
> 赞同：1
> 
> 时间：2009-04-07T19:57:18.683
> 
> 标签：regex, apache, mod-rewrite, url-rewriting

我对 mod_rewrite 还很陌生，我正在尝试从

```
http://example.com/foo/bar/blah/etc.html 
```

进入

```
http://example.com/stuff/foo_bar_blah_etc.html 
```

假设是域和文件名之间没有固定数量的目录，因此我不能只写一个带有 3 个占位符的重写规则。可以想象，我可以创建 5 或 6 个规则，其中包含零到 5 个占位符，但我觉得有更好的方法。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T20:35:34.737

我认为您可以这样做以一次用下划线替换一个斜杠：

```
RewriteRule ^/(.+)/(.*?)$ /$1_$2 [N]
RewriteRule ^.*$ /stuff$0 
```

该`[N]`标志使 Apache 从第一条规则重新开始 URL 重写过程。如果您在这两个之前有其他适用于 URL 的规则，请记住，它们也将在每次迭代时被调用。

另一种可能会或可能不会更有效的替代方法是使用外部程序来处理重写。你可以把它放在你的 Apache 配置文件中（而不是上面的）

```
RewriteMap slashtouscore prg:/usr/local/bin/slashtouscore.pl
RewriteRule ^/(.*)$ /stuff${slashtouscore:$1} 
```

然后您需要`/usr/local/bin/slashtouscore.pl`使用内容创建可执行脚本

```
#!/usr/bin/perl
$| = 1;
while (<>) {
    s|/|_|g;
    print;
} 
```

（它不一定是 Perl 脚本，当然，任何具有相同功能的程序都可以 - 当然文件名可以是任何你想要的，只要它可以被 Apache 访问）

请注意，这些都没有经过测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T20:08:00.777

试试这个：

```
RewriteRule (.*)/(.+) $1_$2 [NS]
RewriteRule (.*) stuff/$1 [NS] 
```

# user-interface - JSF中“优先级表”的组件？

> ID：727342
> 
> 赞同：0
> 
> 时间：2009-04-07T19:58:37.463
> 
> 标签：user-interface, jsf

在我们 JSF 应用程序的某个页面中，用户会看到一个表格，其中列出了许多对象，我们将其称为“作业”。假设每个作业都有一个优先级，它只是一个数字，在这个屏幕中，用户可以编辑作业的优先级。

但是，两个作业不能具有相同的优先级编号。出于这个原因，我发现很难构建一个合适的 UI 来处理设置优先级。

我们一开始尝试了一个简单的编辑框，但很快就发现它很糟糕：如果用户想将作业的优先级从 100 降低到 50，他必须手动“为该作业腾出空间”，方法是在工作 50 至 99。

现在我正在考虑一个表格，用户可以在其中拖放行以直观地调整优先级，而不必摆弄优先级数字（实际上从未见过它们），但我找不到这样的组件。有人知道这样的组件或有更好的 UI 建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T20:06:16.290

把你目前的想法，让电脑来做腾出空间的工作怎么样？

如果用户输入 50，则显示该作业存在的警告，询问他们是否要在当前数字 50 之前或之后插入新作业，或者是否要完全取消操作。如果他们的选择是插入条目，您可以重新排序代码中的其他项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T21:27:29.583

我认为您不会找到可以为您更改优先级编号的组件。相反，您应该调用一个重新排序例程，该例程将在更改优先级后相应地更新优先级编号。

关于拖放，我建议您查看 RichFaces 或 ICEFaces。RichFaces 有一些非常简洁的功能来实现你所说的那种事情。我建议您查看[RichFaces 演示页面](http://livedemo.exadel.com/richfaces-demo/index.jsp)并尝试拖放支持组件。RichFaces 组件集也有一个排序列表（在 Rich Selects 下），但它似乎不允许通过输入数字来更改排序，而是使用向上和向下按钮完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T11:18:55.713

查看 jQuery[表格拖放插件](http://www.isocra.com/2008/02/table-drag-and-drop-jquery-plugin/)。然后只需使用 Ajax 将生成的 javascript 调用绑定到您的后端（例如 Richfaces 的 a4j:jsFunction）。获取后端 Bean 来处理后续作业的 shuffle。

这肯定会比您当前在 JSF 库中找到的任何开箱即用的组件看起来和表现得更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T18:09:53.590

我想我会去看看你是否可以使用开箱即用的组件和[script.aculo.us](http://script.aculo.us/)来做到这一点。这是可能的，尽管要让它看起来不错并提供一个流畅的 UI 需要做一些工作。

演示视图：

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="2.0"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core">
    <jsp:directive.page language="java"
        contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1" />
    <jsp:text>
        <![CDATA[ <?xml version="1.0" encoding="ISO-8859-1" ?> ]]>
    </jsp:text>
    <jsp:text>
        <![CDATA[ <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> ]]>
    </jsp:text>
    <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <title>Sortable</title>
    <script src="javascripts/prototype.js" type="text/javascript">/**/</script>
    <script src="javascripts/scriptaculous.js" type="text/javascript">/**/</script>
    </head>
    <body>

    <f:view>
        <h:form>
            <h:dataTable id="table1" binding="#{jobPageBean.table}"
                value="#{jobBean.jobs}" var="row" border="1">
                <h:column>
                    <f:facet name="header">
                        <h:outputText value="jobs" />
                    </f:facet>
                    <h:outputText value="#{row.text}" />
                    <h:inputHidden value="#{row.priority}">
                        <f:convertNumber integerOnly="true" />
                    </h:inputHidden>
                </h:column>
            </h:dataTable>
            <h:commandButton id="ucb1" binding="#{jobPageBean.updateCommandButton}"
                action="#{jobBean.updatePriorities}" value="Save New Priority Order"
                disabled="true" />
        </h:form>

        <h:form>
            <h:inputTextarea value="#{jobBean.newJob}" />
            <h:commandButton action="#{jobBean.addNewJob}" value="Add Job" />
        </h:form>
    </f:view>
    <script type="text/javascript"> /* <![CDATA[ */
    Sortable.create('${jobPageBean.tableClientId}:tbody_element', {tag: 'tr', onChange: sortElements});
    function sortElements() {
        var table = document.getElementById('${jobPageBean.tableClientId}');
        var inputs = table.getElementsByTagName('input');
        for(var i=0; i<inputs.length; i++) {
            inputs[i].value = i;
        }
        var updateCommandButton = document.getElementById('${jobPageBean.updateCommandButtonClientId}');
        updateCommandButton.disabled = false;
    }
    /* ]]> */
    </script>
    </body>
    </html>
</jsp:root> 
```

豆子：

```
public class JobPageBean {

  // Declaration:
  // <managed-bean>
  // <managed-bean-name>jobPageBean</managed-bean-name>
  // <managed-bean-class>job.JobPageBean</managed-bean-class>
  // <managed-bean-scope>request</managed-bean-scope>
  // </managed-bean>

  private UIComponent dataTable;
  private UIComponent updateCommandButton;

  public void setTable(UIComponent dataTable) {
    this.dataTable = dataTable;
  }

  public UIComponent getTable() {
    return dataTable;
  }

  public String getTableClientId() {
    FacesContext context = FacesContext
        .getCurrentInstance();
    return dataTable.getClientId(context);
  }

  public void setUpdateCommandButton(
      UIComponent updateCommandButton) {
    this.updateCommandButton = updateCommandButton;
  }

  public UIComponent getUpdateCommandButton() {
    return updateCommandButton;
  }

  public String getUpdateCommandButtonClientId() {
    FacesContext context = FacesContext
        .getCurrentInstance();
    return updateCommandButton.getClientId(context);
  }

}

public class JobBean {

  // Declaration:
  // <managed-bean>
  // <managed-bean-name>jobBean</managed-bean-name>
  // <managed-bean-class>job.JobBean</managed-bean-class>
  // <managed-bean-scope>session</managed-bean-scope>
  // </managed-bean>

  private List<Job> jobs;
  private DataModel model;

  private String newJob;

  public DataModel getJobs() {
    if (jobs == null) {
      jobs = new ArrayList<Job>();
      model = new ListDataModel(jobs);
    }
    return model;
  }

  public String updatePriorities() {
    if (jobs != null) {
      Collections.sort(jobs);
    }

    return null;
  }

  public String getNewJob() {
    return newJob;
  }

  public void setNewJob(String newJob) {
    this.newJob = newJob;
  }

  public String addNewJob() {
    if (newJob == null || newJob.trim().length() == 0) {
      return null;
    }

    Job job = new Job();
    job.setText(newJob);
    job.setPriority(jobs.size());
    jobs.add(job);

    newJob = null;

    return null;
  }

}

public class Job implements Comparable<Job> {

  private String text;

  private int priority;

  public String getText() {
    return text;
  }

  public void setText(String text) {
    this.text = text;
  }

  public int getPriority() {
    return priority;
  }

  public void setPriority(int priority) {
    this.priority = priority;
  }

  public int compareTo(Job other) {
    if (other.priority == priority) {
      return 0;
    }
    return other.priority < priority ? 1 : -1;
  }

} 
```

*   您可以通过拖动它们来重新排序行，但是您需要提交表单以保存更改 - 如果没有添加它的 3rd 方框架，您将无法获得良好的 AJAX 支持（至少，直到 JSF 2.0）
*   我使用了[MyFaces](http://myfaces.apache.org/) 1.2.3，其中的*dataTable使用以**:tbody_element*结尾的 id 属性呈现其*tbody*元素- 我不知道是否所有实现都这样做
**   我没有过多地在输入验证的方式上烦恼，也没有考虑使用键盘来支持可访问性，或者专业 UI 所需的所有其他事情......*

 *# delphi - 如何使用 ICS 通过 GMail 发送电子邮件？

> ID：727343
> 
> 赞同：0
> 
> 时间：2009-04-07T19:58:45.230
> 
> 标签：delphi, gmail, icalendar

如何使用[ICS](http://www.overbyte.be/eng/products/ics.html)组件通过 gmail smtp 帐户发送电子邮件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T14:35:44.890

查看[ICS](http://www.overbyte.be/eng/products/ics.html)组件文件中的 MailSnd 演示应用程序。

显示了通过 SMTP 发送的完整解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T06:29:37.290

我不知道 ICS，但如果你愿意，你可以使用[Synapse](http://synapse.ararat.cz/doku.php)库。

[http://synapse.ararat.cz/doku.php/public:howto:smtpsend](http://synapse.ararat.cz/doku.php/public:howto:smtpsend)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T08:57:06.500

首先尝试让自己熟悉使用 Outlook 或 Thunderbird 设置 SMTP 邮件，一旦你对它感到满意，让组件工作应该相当简单。您可能遇到的一个问题是 Google 需要 SSL over SMTP，根据我的经验，在 Windows PC 上使用 openssl 设置它可能非常困难。

# sql - 复制一组具有约束的记录，具有共同的祖先

> ID：727346
> 
> 赞同：0
> 
> 时间：2009-04-07T20:00:03.027
> 
> 标签：sql, sql-server, tsql

我有一组表，实际上是一棵粗短的树。在顶部，有一个客户，下面是发票和发票详细信息记录。（实际上，大约有两打这些表都指的是客户，但原则应该只适用于三个表。）

我想做的是复制客户和属于该客户的所有记录，而不必枚举每条记录中的每个字段。一切都是外键约束到它上面的东西，并且大多数表都有自动增量标识字段。

下面是一个用于设置数据库的 T-SQL 脚本。是的，它很乱，但它是完整的。

```
CREATE TABLE [dbo].[Customer](
    [custID] [int] IDENTITY(1,1) NOT NULL,
    [name] [varchar](50) NOT NULL,
 CONSTRAINT [PK_Customer] PRIMARY KEY CLUSTERED ( [custID] ASC)
 WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF,
 ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY] ) ON [PRIMARY]
GO
CREATE TABLE [dbo].[Invoice](
    [invoiceNum] [int] IDENTITY(1,1) NOT NULL,
    [custID] [int] NOT NULL,
    [Description] [varchar](50) NOT NULL,
 CONSTRAINT [PK_Invoice] PRIMARY KEY CLUSTERED ( [invoiceNum] ASC )
 WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, 
 ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY] ) ON [PRIMARY]
GO
CREATE TABLE [dbo].[InvoiceDetail](
    [invoiceNum] [int] NOT NULL,
    [sequence] [smallint] NOT NULL,
    [description] [varchar](50) NOT NULL,
    [price] [decimal](10, 2) NOT NULL CONSTRAINT [DF_InvoiceDetail_price]  DEFAULT ((0.0)),
 CONSTRAINT [PK_InvoiceDetail] PRIMARY KEY CLUSTERED ( [invoiceNum] ASC, [sequence] ASC )
 WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, 
 ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY] ) ON [PRIMARY]
GO
ALTER TABLE [dbo].[Invoice]  WITH CHECK ADD  CONSTRAINT [FK_Invoice_Customer] 
    FOREIGN KEY([custID])
    REFERENCES [dbo].[Customer] ([custID])
GO
ALTER TABLE [dbo].[Invoice] CHECK CONSTRAINT [FK_Invoice_Customer]
GO
ALTER TABLE [dbo].[InvoiceDetail]  WITH CHECK ADD  CONSTRAINT [FK_InvoiceDetail_Invoice] 
    FOREIGN KEY([invoiceNum])
    REFERENCES [dbo].[Invoice] ([invoiceNum])
GO
ALTER TABLE [dbo].[InvoiceDetail] CHECK CONSTRAINT [FK_InvoiceDetail_Invoice]

declare @id int;
declare @custid int;
insert into Customer values ('Bob');
set @custid = @@IDENTITY;
insert into Invoice values ( @custid, 'Little Purchase');
set @id = @@IDENTITY;
insert into InvoiceDetail values (@id, 1, 'Small Stuff', 1.98);
insert into InvoiceDetail values (@id, 2, 'More Small Stuff', 0.25);
insert into Invoice values ( @custid, 'Medium Purchase');
set @id = @@IDENTITY;
insert into InvoiceDetail values (@id, 1, 'Stuff', 11.95);
insert into InvoiceDetail values (@id, 2, 'More Stuff', 10.66);
insert into Customer values ('Sally');
set @custid = @@IDENTITY;
insert into Invoice values ( @custid, 'Big Purchase');
set @id = @@IDENTITY;
insert into InvoiceDetail values (@id, 1, 'BIG Stuff', 100.00);
insert into InvoiceDetail values (@id, 2, 'Larger Stuff', 99.95); 
```

所以我想做的是在这个数据库中复制“Bob”，并将其称为“Bob2”，而无需为每个表指定每一列。我可以，但在现实世界中有很多专栏。

另一个问题是我必须编写一个显式循环来获取每张发票。我需要上一个 Invoice 插入的标识才能编写 Invoice Detail。

我有一个可用的 C#“复制”程序，但我想在数据库中完成这一切。天真的实现是一个到处都有循环和游标的事务处理 sql 存储过程。

有没有一种*巧妙*的方法可以避免这些问题中的一个（如果不是两个）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T16:23:39.373

我有类似的问题，涉及更多的表。我们确实可以避免为要复制的每一行制作游标。唯一的游标是用于循环涉及的表名列表。为此，我们还需要动态 SQL。与传统的游标循环解决方案相比，整个操作速度极快。

诀窍是将相关行插入到同一个表中；然后将其 FK 列更新为其父级。我们如何收集大量@@identity 是在插入过程中使用'output' 关键字，并将它们保存到临时表#refTrack 中。稍后，我们将#refTrack 与涉及更新其 FK 的表一起加入。

我们知道：

```
 create table #refTrack 
(
    tbl sysname,
    id int, 
    refId int
)

insert InvoiceDetail (refId, invoiceNum, sequence, description, price)
output 'InvoiceDetail', inserted.id, inserted.refId into #refTrack 
select invoiceNum, invoiceNum, sequence, description, price from InvoiceDetail 
where custID = 808 -- denormalized original Bob^s custID 
```

将使用新创建的自动运行号码列表填充临时 #refTrack 表。我们的工作只是使这个插入查询成为动态的。

这种方法的唯一缺点是我们需要一致性，在每个表上我们必须有：

1.  它自己的主键，名称为“id”。在这种情况下，我们需要重命名：Customer.custID 成为 Customer.id；Invoice.invoiceNum 变成 Invoice.id；以及 InvoiceDetail 中的新列“id int identity(1, 1) primary key”。
2.  非规范化的“custID”列。对于“深度”> 1 列出的表，该表将需要当前的前端应用程序来填充这个新的帮助列。“插入触发器”将使我们的工作变得更加复杂。
3.  名为“refId”的列，定义为：int null。此列用于使行的关系属于 'Bob2' 作为 'Bob' 的副本。

采取的步骤：

A. 将所有表名列出到@tList 表变量中

```
 declare @tList table
(
     tbl sysname primary key,
     fkTbl sysname,
     fkCol sysname,
     depth int
)
insert @tList select 'Customer', null, null, 0
insert @tList select 'Invoice', 'Customer', 'custID', 1
insert @tList select 'InvoiceDetail', 'Invoice', 'invoiceNum', 2 
```

我很想抽象一下在上面插入期间仅填充“tbl”列；并通过使用 information_schema 视图的递归 CTE 的结果更新它们来动态填充其余列。然而，这可能是题外话。假设我们有一个表，其中包含所涉及的表名列表，按照应该填充的方式排序。

B. 在游标中循环@tList 表。

```
 declare 
    @depth int,
    @tbl sysname,
    @fkTbl sysname,
    @fkCol sysname,
    @exec nvarchar(max),
    @insCols nvarchar(max),
    @selCols nvarchar(max),
    @where nvarchar(max),
    @newId int,
    @mainTbl sysname,
    @custId int 

select @custId = 808 -- original Bob^s custID to copy from

select @mainTbl = tbl from @tList where fkTbl is null

declare dbCursor cursor local forward_only read_only for  
    select tbl, fkTbl, fkCol, depth from @tlist order by depth
open dbCursor   
fetch next from dbCursor into @tbl, @fkTbl, @fkCol, @depth 
while @@fetch_status = 0   
begin   
    set @where = case when @depth = 0 then 'Id' else 'custId' end + ' = ' + 
        cast(@custId as nvarchar(20))
    set @insCols = dbo.FnGetColumns(@tbl) 
    set @selCols = replace
    (
        @insCols, 
        'refId', 
        'Id'
    )
    set @exec = 'insert ' + @tbl + ' (' + @insCols + ') ' + 
        'output ''' + @tbl + ''', inserted.id, inserted.refId into #refTrack ' +
        'select ' + @selCols + ' from ' + @tbl + ' where ' + @where

    print @exec
    exec(@exec)

    -- remap parent
    if isnull(@fkTbl, @mainTbl) != @mainTbl -- third level onwards
    begin
        set @exec = 'update ' + @tbl + ' set ' + @tbl + '.' + @fkCol + ' = rf.Id from ' + 
            @tbl + ' join #refTrack as rf on ' + @tbl + '.' + @fkCol + ' = rf.refId and rf.tbl = ''' + 
            @fkTbl + ''' where ' + @tbl + '.custId = ' + cast(@newId as nvarchar(20))

        print @exec
        exec(@exec)
    end

    if @depth = 0 select @newId = Id from #refTrack
    fetch next from dbCursor into @tbl, @fkTbl, @fkCol, @depth 
end   

close dbCursor
deallocate dbCursor

select * from @tList order by depth
select * from #refTrack

drop table #refTrack 
```

C. FnGetColumns()的内容：

```
 create function FnGetColumns(@tableName sysname) 
returns nvarchar(max)
as
begin
    declare @cols nvarchar(max)
    set @cols = ''
    select @cols = @cols + ', ' + column_name 
        from information_schema.columns 
        where table_name = @tableName
            and column_name <> 'id' -- non PK
    return substring(@cols, 3, len(@cols))
end 
```

我相信我们可以进一步改进这些脚本，使其更具动态性。但是为了解决问题，这将是最低要求。

干杯，

阿里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T20:11:22.503

“大多数表都有自动增量标识字段”

有一部分的问题。使用 IDENTITY 作为 PK 使得这类操作既困难又昂贵（从计算的角度来看）。即使您没有使用 IDENTITY，您仍然需要为“新”客户生成新的发票编号，这意味着您需要一次循环浏览一个或提出一种基于集合的分配新发票编号的方法，然后可以使用该方法创建发票详细信息行。

我将假设您从业务角度了解您正在从事的工作，但我仍然必须指出，您现在也在创建不完全“真实”的数据。如果您复制其中一个客户，包括他们的所有发票，然后报告您当年的销售额，那么您将重复计算销售额。

有了有关您尝试解决的业务问题的更多信息，也许可以找到另一个解决方案。

# java - 您对 GWT 的体验如何？

> ID：727351
> 
> 赞同：4
> 
> 时间：2009-04-07T20:01:08.110
> 
> 标签：java, gwt

您认为 Google Web Toolkit 是一个有用的项目吗？是否存在许可问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-08T02:12:36.330

GWT 很棒，因为它可以处理不同浏览器的许多问题，如果您不熟悉这些问题可能会很麻烦。它还有助于以更加程序化的方式创建 GUI，这也是非网页设计师 POV 的一大优势。查看 GWT 的[Showcase](http://gwt.google.com/samples/Showcase/Showcase.html?locale=en)（其中包含带有代码的实时示例）以了解您可以轻松使用（和扩展）的 GUI。另一个不错的功能是，您可以轻松地国际化您的应用程序（阅读[本文](http://code.google.com/docreader/#p=google-web-toolkit-doc-1-5&s=google-web-toolkit-doc-1-5&t=DevGuideStaticStringInternationalization)了解一种方法）。此外，当谷歌编译它时，他们优化了代码，这是一个加号。许多其他库也可以轻松添加功能。

你基本上可以做任何你可以用 HTML+JavaScript 做的事情（Steve Reed 的例子向你展示了如何在 Java 中使用 JavaScript）。您甚至可以将 JavaScript 库移植到 Java 中，并像使用任何 Java 类一样使用它们。

总的来说，谷歌在这方面做得很好（它在 Eclipse 中运行得非常好，并且有文档记录）。然而，它是我认真研究的第一个 Web 框架（？），所以我认为它非常好，并且可能有偏见。不过需要注意的是：托管模式浏览器本质上是 Internet Explorer，因此您确实需要在不同的浏览器中编译和查看它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-12T16:45:53.347

我们在 Google 使用它，尽管我对这个过程的艰巨性（计算代码使用的所有 Java 类的传递闭包，然后翻译成 JavaScript）保持警惕，但它确实是无缝过渡到使用它进行 UI 编程。您只需学习一些特定于 GWT 的配置（序列化策略可能很粗略，您必须注意依赖关系等），然后您就可以开始运行，而无需考虑 GWT 及其架构。

当我们开始这个项目时，我没有 JavaScript 经验，而且我仍然没有 JavaScript 经验——这是一件好事。我从来不需要检查 JavaScript 来调试我的程序，部分原因是可用的出色调试工具。您可以使用托管模式，该模式将跳过 Java --> JavaScript 翻译，并允许您在 Java 中（例如 eclipse）中停留，并像浏览器中的 JavaScript 一样单步执行它。

最后，由于测试绝对是决定大型 Web 应用成败的关键，[Selenium](http://seleniumhq.org/)与 GWT 配合得非常好。Selenium 是一个功能性的 GUI 测试框架，不会取代单元测试，而是一个非常好的端到端测试来补充您的 GwtTestCases。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T23:20:16.183

If you want a feel for the GWT community, I suggest you check out the [Google Group for GWT](http://groups.google.com/group/Google-Web-Toolkit). There's posts there pointing at pages that try to show who's using the toolkit, issues that people have run into (and solutions!).

I'm using GWT at my company, and we're having fantastic success. We've a hard requirement to produce a web based app, and there's no way we could produce what we've done without it (and still have the same over-all productivity (thanks to IDEs), feature velocity, etc...)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T20:55:53.487

我真的非常不喜欢使用 Javascript。（真的！）另外，我的背景包括使用 Java AWT 和 Swing 进行 UI 编程。所以我发现布局模型非常直观。另外，我很享受在 Eclipse 中使用自动完成和调试器的假期。它生成的代码可以跨浏览器工作。

我在 Rails 应用程序中使用它，所以我只是将生成的`.js`文件放入 中`public/javascripts`，在我的布局中需要它，然后像往常一样部署。

真正的 Javascript 程序员通常讨厌它。Java 布局模型非常灵活，但在您第一次（第二次、第三次……）看到它时很难理解。他们也对编译步骤感到恼火。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T01:59:15.303

我在我目前的工作中使用 GWT 并且喜欢它，因为我现在可以用 Java 做最好的 Javascript 忍者可以做的事情。

例如，延迟绑定、它们的引导和缓存优化以及图像包显示了它们对于通过很少的额外开发工作获得大量性能是多么认真。

不过，需要注意的一点是，在将这项技术引入您正在开发的任何产品中时要小心谨慎。我们正在处理一个旧的单体代码库，它生成大量 HTML 文档，其中包含嵌入式 javascript、css 等的大杂烩。我选择通过将 GWT 函数“发布”到窗口中来引入一些 GWT UI：

```
public native void publishStuff() /*-{
   $wnd.createGwtUI = @com.acme.foo.MyGwtUI::create();
}-*/; 
```

这些函数从父 HTML 文档中读取配置。

该解决方案的稳定性受到底层文档结构的怪癖和缺陷的严重破坏，因此有些人对“跨浏览器”GWT 的真正第一印象是不好的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-07T20:04:55.327

我曾在研究中使用它，并发现它是一项很有前途的技术。至于许可，它是 Apache 2.0，所以这不应该给您带来问题：

[http://code.google.com/webtoolkit/terms.html](http://code.google.com/webtoolkit/terms.html)

# apache-flex - Flex Builder：如何运行多个“Export Release Build...”

> ID：727354
> 
> 赞同：1
> 
> 时间：2009-04-07T20:01:57.250
> 
> 标签：apache-flex, flash, actionscript-3, flexbuilder

所以，我拥有的是一个 Flex 应用程序，它由大约 20 个在运行时加载的模块组成。每个模块在 Flex Builder 中都是它自己的项目，我想做的是有一些方法可以创建所有这些模块的发布版本，而无需转到每个项目并选择 Project->Export Release Build...

我怎么能做这样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T00:01:14.697

如果您有一个复杂的项目，则可能值得创建一个 ant 构建任务。这使您可以非常具体地控制构建过程和参数。

您可以从[网站下载 ant（](http://ant.apache.org/)[此处](http://ant.apache.org/manual/)为手册）。Eclipse 包含一个版本，但我更喜欢通过命令行运行它。

Flex builder 带有一个 ant 库，它定义了构建 actionscript 和 mxml 文件的任务。[这里](http://livedocs.adobe.com/flex/3/html/help.html?content=anttasks_1.html)有一些文档

例如，这是一个示例 mxmlc 任务，您可以通过运行 'ant production-compile' 来完成：

```
<target name="production-compile">
        <mxmlc file="myApp.mxml"
            show-actionscript-warnings="false"
            output="myApp.swf"
            debug="false"
            optimize="true"
            >

            <default-size width="800" height="600"/>
            <default-frame-rate>60</default-frame-rate>
        </mxmlc>
</target> 
```

您可以为每个模块添加 mxmlc 任务，这样您就可以使用一个命令构建整个应用程序。

# sql-server - SQL Server 2008 网络版

> ID：727361
> 
> 赞同：21
> 
> 时间：2009-04-07T20:04:14.750
> 
> 标签：sql-server, sql-server-2008

有人可以给我一些关于 SQL Server 2008 Web 版的信息吗？这是2008年的新版本吗？它有什么样的限制？有人使用成功吗？它提供了什么是 Express Edition 不会提供的？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-07T20:17:48.913

SQL Server 2008 Web Edition 是一个很棒的 SKU。它专为 Web 应用程序而设计，不受 Express Edition 的限制。它也比标准版便宜得多。

网络版只能通过 SPLA 许可获得，但通常每月花费约 25 美元，而标准版则为 250 美元/月。

Web 版没有数据库大小限制，而 Express Edition 有 4GB 的数据库大小限制。Express 版也只使用最多 1GB 的 RAM，而 Web 版可以使用任何操作系统限制。

虽然 Web 版必须按 CPU 获得许可，但降低成本可以让您轻松使用 2 或 4 CPU 机箱，而无需花费大量成本。如果安装在多 CPU 盒上，Express Edition 将仅使用单个 CPU。

有关完整的功能分解，请查看[http://www.microsoft.com/sqlserver/2008/en/us/editions-compare.aspx——](http://www.microsoft.com/sqlserver/2008/en/us/editions-compare.aspx)在我工作的网络托管公司，我们发现大约 90%我们使用\许可标准版的非 HA 客户能够迁移到 Web 版。

微软通过这个新的 SKU 为网络社区带来了好处。

**更新：**在 2008 R2 中，Microsoft 已将数据库大小限制增加到 10GB。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-07T20:08:09.297

来自[微软的网站](http://www.microsoft.com/sqlserver/2008/en/us/editions.aspx)：

### 中央处理器

*   Web：4（但按 CPU 许可）
*   快递：1

### 记忆

*   网页：OS Max
*   快递：1GB

### 数据库大小

*   网络：无限制
*   快递：4GB

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-07T20:07:01.357

你可以在这里找到完整的比较：

[http://www.microsoft.com/sqlserver/2008/en/us/editions.aspx](http://www.microsoft.com/sqlserver/2008/en/us/editions.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-17T14:20:50.750

SQL Server 2008 R2 增加了 WEB 版的内存，为 64GB。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-19T05:09:27.917

在 youtube.com 上查看有关基于 Web 的 sql 服务器的 youtube 演示

[https://www.youtube.com/channel/UCVxoYNS9J_4_A0Hy93xcBKQ](https://www.youtube.com/channel/UCVxoYNS9J_4_A0Hy93xcBKQ)

# c# - Windows 窗体 ListView 缺少水平滚动条

> ID：727366
> 
> 赞同：2
> 
> 时间：2009-04-07T20:04:57.040
> 
> 标签：c#, .net, winforms, listview, scrollbar

我在一个窗体（C#，VS 2005）中有一个 Windows 窗体 ListView，并将它锚定到窗体的所有边缘，以便它完全填充除状态栏之外的窗体。ListView 处于详细模式，并且列非常宽 - 肯定比显示区域宽。我有一个垂直滚动条，但没有水平滚动条。

当控件获得焦点时，我可以使用键盘向左和向右滚动，但无法显示滚动条。

可滚动设置为真。

我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-07T20:12:16.587

看起来状态栏隐藏了水平滚动条，除了将Dock属性更改为Fill之外，您可以检查是否：

*   添加一个 SplitContainer 并在其中排列控件
*   将状态栏的 Dock 修改为底部
*   添加一个 FlowLayoutPanel 并将您的控件放入其中。

希望这些提示有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T20:06:59.237

与其将其锚定到所有四个边以填充该区域，不如尝试将`Dock`属性设置为`Fill`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T20:16:13.520

如果`Scrollable`设置为`false`，您将无法使用键盘滚动，因此状态栏必须对您隐藏滚动条。

您可以做什么将列表视图的停靠栏设置为`Fill`或缩小列表视图以不进入状态栏下方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T07:55:21.417

隐藏 ImageBox (emgu) 的水平滚动条的状态栏有同样的问题，似乎放置 GUI 元素的顺序在这里很重要。放置状态栏后放置 ListView / ImageBox，它将像魅力一样工作。

# c# - .NET Web 服务 - SOAP 错误

> ID：727372
> 
> 赞同：0
> 
> 时间：2009-04-07T20:06:47.943
> 
> 标签：c#, .net, asp.net, web-services

如何在我的 C# Web 服务中将任何未捕获的异常作为 SOAP 错误返回？似乎 IIS 正在“捕获”异常并将其显示在默认错误上。下面是经过消毒的 web.config。

```
<?xml version="1.0"?>
<configuration>
  <configSections>
    <section name="hibernate-configuration" type="NHibernate.Cfg.ConfigurationSectionHandler, NHibernate" />
  </configSections>
  <system.web>
    <httpRuntime enableVersionHeader="false" />
    <sessionState mode="Off" />
    <compilation defaultLanguage="c#" debug="true" />
    <authentication mode="None" />
        <customErrors mode="RemoteOnly" defaultRedirect="GenericErrorPage.htm">
            <error statusCode="403" redirect="NoAccess.htm" />
            <error statusCode="404" redirect="FileNotFound.htm" />
        </customErrors>
    <webServices>
      <protocols>
        <remove name="HttpPost"/>
        <remove name="HttpGet"/>
        <remove name="Documentation"/>
        <remove name="HttpSoap12" />
      </protocols>
    </webServices>
  </system.web>
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-07T20:30:11.130

尝试从配置中删除 customErrors 部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T03:00:54.017

事实证明，导致问题的 HttpModule 的 Application_EndRequest 方法中存在代码问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T01:11:15.287

事实证明，HttpModule 中的一些错误逻辑导致应用程序出错。解决此问题后，应用程序将按预期运行。

# c# - C# 以编程方式填写 InfoPath 表单？

> ID：727373
> 
> 赞同：3
> 
> 时间：2009-04-07T20:06:52.373
> 
> 标签：c#, automation, infopath

是否可以填写信息路径表单并通过 C# 控制台应用程序提交？

如果是，那么如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T07:24:43.687

是的，您可以在 C# 应用程序中创建一个 XML 文件并将其推送到您的 Sharepoint 表单库。Sharepoint 不会意识到任何区别。

只要确保两件事：

*   您的 XML 必须根据 Infopath**模式**进行验证。
*   记得添加 XML**处理指令**，让 Sharepoint 和 Infopath 知道如何处理 XML 文件。（只需从 Infopath 生成的 XML 中“窃取”它。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-25T20:35:40.370

MrFox 是对的，Infopath 表单只是一个符合某些规则的 Xml 文档，因此只要您使用正确的 Xml 标记创建文本文件，那么您就创建了一个 Infopath 文档。但是，有一些编程方式可以使用 Infopath 空间来操作文档。特别是，您可以从 Infopath 模板创建新的 Infopath 文档。查找更多信息`XDocuments2.NewFromSolution()`以查看一些示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-23T15:32:25.963

*   识别字段名称及其 XML 表示
*   从 InfoPath 文档库中读取 InfoPath 表单项
*   将附加的 InfoPath 表单的 XML 表示加载到 XmlTextReader
*   使用 XmlTextReader 读取每个节点并根据我们的要求提取用户输入

# c# - 在 asp .net 中处理通过浏览器历史记录加载的页面的最佳方法是什么？

> ID：727382
> 
> 赞同：0
> 
> 时间：2009-04-07T20:09:03.770
> 
> 标签：c#, asp.net

我有一个非常数据库和用户密集型的应用程序。用户非常热衷于浏览器历史按钮进行导航。

如果用户从浏览器历史记录中选择某些内容，有没有一种方法可以绝对保证页面会重新加载？

我经常看到的是页面的副本将从浏览器缓存中显示，而不是重新加载。

我试过了：

```
this.Response.Cache.SetNoStore()
this.Response.Cache.SetNoServerCaching()
this.Response.Cache.SetCacheability(System.Web.HttpCacheability.NoCache) 
```

和

```
this.Response.Cache.SetExpires(DateTime.Now.AddSeconds ( -1 ) ); 
```

这些似乎都没有帮助，有时浏览器无论如何都会加载旧的缓存版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T20:54:57.797

如果您使用的是 3.5 框架，您可以使用 History 服务器控件来管理浏览器历史记录中的内容。

这是一个视频和一些博客文章，其中包含使用它的提示：

[视频：如何使用 ASP.NET 历史记录控件？](http://www.asp.net/learn/ajax-videos/video-149.aspx)
[ASP.NET 更新面板的后退按钮支持](http://www.nikhilk.net/BackButtonSupport.aspx)
[ASP.NET：使用 AJAX 和 UpdatePanels 管理浏览器历史](http://blogs.interakting.co.uk/steve/archive/2008/01/25/ASP.NET-Managing-Browser-History-with-AJAX-and-UpdatePanels.aspx)
[提示/技巧：为 ASP.NET AJAX UpdatePanel 启用后退/前进按钮支持](http://weblogs.asp.net/scottgu/archive/2006/09/14/Tip_2F00_Trick_3A00_-Enabling-Back_2F00_Forward_2D00_Button-Support-for-ASP.NET-AJAX-UpdatePanel.aspx)

更新：正如他评论中所指出的，您使用的是 2.0 版本的框架。这是一个解释如何在 .NET 2.0 上使用此控件的链接： [Using ASP.NET 3.5 History Control with ASP.NET 2.0](http://weblogs.asp.net/brijmohan/archive/2008/09/11/using-asp-net-3-5-history-control-with-asp-net-2-0.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T23:05:45.890

您需要两条语句来防止缓存：

`Response.Cache.SetCacheability(System.Web.HttpCacheability.NoCache); // For IE Response.Cache.SetNoStore(); // For Firefox`

更多详情请参见：

[http://blog.httpwatch.com/2008/10/15/two-important-differences-between-firefox-and-ie-caching/](http://blog.httpwatch.com/2008/10/15/two-important-differences-between-firefox-and-ie-caching/)

此外，请确保您始终遵循带有重定向的 POST，以便后退按钮正常工作：

[http://blog.httpwatch.com/2007/10/03/60-of-web-users-can%E2%80%99t-be-wrong-%E2%80%93-don%E2%80%99t -打破后退按钮/](http://blog.httpwatch.com/2007/10/03/60-of-web-users-can%E2%80%99t-be-wrong-%E2%80%93-don%E2%80%99t-break-the-back-button/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T20:13:16.227

看到旧数据有什么危险？如果担心用户会与“旧”数据交互或尝试更改“旧”数据，那么当用户提交时，服务器端代码不应该能够处理对“旧数据”或数据采取行动的请求吗？不再有效？

与阻止任何客户端将页面副本存储在浏览器历史记录中相比，阻止用户在服务器端无法与之交互的数据的“意外”更新可能要容易得多或缓存。你永远不可能完美地呈现后者。

换句话说，您最好确保这些类型的错误不会进入您可以控制的应用程序（服务器端代码），而不是希望与您的网站交互的每个浏览器都尊重您的缓存标题，每个浏览器都遵循 HTTP/HTML 标准等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T20:42:13.083

您确定浏览器缓存是问题吗？

```
Response.Cache.SetCacheability(HttpCacheability.NoCache) 
```

应该管用。您是否尝试过不同的浏览器或所有浏览器都受到影响？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T20:17:03.503

我不会太担心缓存。

ASP.Net 中的问题是回发事件和 ViewState 意味着服务器可能不会以相同的方式两次呈现相同的 url。相反，它会考虑应用程序的当前“状态”。所以当用户点击后退按钮时，因为视图状态和其他回发数据在这个方向上不可用，他们可能不会以他们期望的方式看到页面。

要保持后退按钮正常工作，您需要关闭 ViewState 并使用 Response.Redirect 处理所有服务器事件到新 URL。

# c# - 为 vb6 应用程序制作 C# 终止事件？

> ID：727386
> 
> 赞同：0
> 
> 时间：2009-04-07T20:10:16.013
> 
> 标签：c#, vb6, interop

我有一个 VB6 应用程序可以处理很长时间。直接杀死它是不可行的，所以我想在 VB6 应用程序中设置某种标志。如果在我的 C# 应用程序中我决定将其关闭，我想切换此标志以让 VB6 应用程序知道已请求关闭。现在，我还需要一些被命名的东西，因为将有几个 VB6 应用程序作为 activex exe 启动。有谁知道如何实现这样的东西？工作流程如下

C# 应用程序 - 在单独的线程中启动多个 VB6 activex.exes，用我可以在 C# 中更改的东西（以下称为标志）初始化应用程序，然后调用 DoStuff 命令，这需要很长时间才能返回。

VB6 - 获取带有标志的初始化命令。DoStuff 被调用。在 DoStuff 循环中，它检查标志是否仍然设置。

C# - 通过将标志设置为另一个状态来终止项目

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T17:28:58.523

这是使用 VB6 客户端和 VB6 服务器进行异步后台处理的非常标准的方案。（例如，它在 Dan Appleman 的[书中](http://www.amazon.co.uk/Applemans-Developing-ActiveX-Components-Visual/dp/1562765760)和 Microsoft 的[VB6 示例中](http://msdn.microsoft.com/en-us/library/aa445814(VS.60).aspx)。）我认为它也应该适用于 C# 客户端。

*   VB6 ActiveX EXE 对象应该公开一个事件 CheckQuitDoStuff()。这需要一个名为 Quit 的 ByRef 布尔值。
*   客户端在 ActiveX EXE 对象中调用 StartDoStuff。此例程在隐藏窗体上启动 Timer 并**立即返回**。这会解除阻塞调用线程。Timer 间隔非常短，因此 Timer 事件会快速触发。
*   Timer 事件处理程序禁用 Timer，然后回调到 ActiveX 对象的 DoStuff 方法。这开始了冗长的处理。
*   DoStuff 方法会定期引发 CheckQuitDoStuff 事件。客户端的事件处理程序检查特殊标志并在需要中止时设置 Quit True。然后 DoStuff 中止计算并在 Quit 为 True 时提前返回。

这种方案意味着客户端实际上不需要是多线程的，因为调用线程在“DoStuff”发生时不会阻塞。棘手的部分是确保 DoStuff 以适当的间隔引发事件 - 太长，并且您无法在您想要的时候退出：太短，并且您不必要地减慢了 DoStuff。此外，当 DoStuff 退出时，它必须卸载隐藏的表单。

如果 DoStuff 确实设法在中止之前完成所有工作，您可以引发不同的事件来告诉客户端工作已完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T20:16:51.630

创建 ActiveX 对象时，请保留存储在应用程序或线程中的引用。COM 将处理跨线程的封送处理。有了参考资料，您可以调用它的方法并杀死它。如果您将引用保留在线程中，那么您将需要使用 .NET 的进程间消息传递机制来传递给要在 ActiveX EXE 上设置终止标志的 .NET 线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T14:50:41.257

我不会跨进程边界保持引用打开，但您可以肯定地缓存进程的 Long hWnd 并从 .Net 中对其调用 kill 。

# asp.net - 为什么从 IFrame 打印页面时会看到不同的字体大小？

> ID：727388
> 
> 赞同：4
> 
> 时间：2009-04-07T20:11:01.597
> 
> 标签：asp.net, javascript, html, css, printing

我有一个简单的基于表格的 HTML 页面，带有一个非常简单的样式表。我可以在 IE7 和 FireFox 3 中打开页面，它看起来完全一样。我可以从两个浏览器打印页面，它看起来完全一样。我们将页面命名为“ProblemPage.htm”

现在，在 ASP.Net 页面中，我创建了一个 IFrame 并将该 HTML 加载到 IFrame 中，如下所示：

```
window.frames[iframeId].location.href = "../ProblemPage.htm"; 
```

当用户单击 ASP.Net 页面上的按钮时，它会调用执行此操作的函数：

```
window.frames[iframeId].focus();
window.frames[iframeId].print(); 
```

当我这样做并打印它时，Firefox 版本看起来与我单独加载页面并打印它时完全相同。IE7 版本将所有字体大小减少到一半左右。

请注意，页面设置设置几乎设置为默认值。我使用了不同的打印机并直接打印为 PDF。我已经反复清除缓存以确保我使用的是相同的 CSS。然而，在同一个 IE7 会话中，页面本身以一种方式打印，通过上述 IFrame 打印的页面使用较小的字体打印。在单个 Firefox 会话中，页面本身的打印与通过 IFrame 打印的页面完全相同。

有任何想法吗？看来，当我在 IE 上打印时，我的某些样式可能会“泄漏”到页面中，或者 IE 正在解释 IFrame 中不同的样式。

**更新**

好吧，我想这不是“泄漏风格”。如果我将 Yahoo CSS Reset 放在 ProblemPage.css 文件中，在所有四种情况下，这两个浏览器肯定都会选择它，但问题仍然存在：当 IE 从 IFrame 打印页面时，字体大小被搞砸了。

**更新 2**

一直没发现问题。更简单的测试项目没有显示同样的问题，我怀疑母版页、主题或类似的东西可能有问题。有趣的是，问题并没有出现在 IE6 上，只是在 IE7 上出现。

我最终解决了这个问题，仅针对 IE7 有条件地注释了 CSS。这是整个应用程序中我必须使用条件 CSS 的唯一部分。

仍然希望有一个答案（甚至是一些关于下一步要寻找什么的 WAG）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T20:49:16.390

当您描述“较小的字体大小”时，它让我想起了在我的 CSS 中有堆叠的“字体大小：0.8em”规范的情况。通过堆叠，我的意思是显示超小的文本位于其上具有 EM 字体大小的父元素内部，并且它本身也有一个。

我不希望 iframe 会发生这种情况，但我想我会把它扔在那里以防万一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T20:55:45.033

听起来很奇怪。没有在线测试很难诊断，但是：

*   如果您在父页面中使用 JavaScript 的 window.print() 会发生同样的事情吗？

*   如果没有，如何让子框架调用函数或在父框架的脚本中设置变量，然后（当通过超时或轮询将控件返回到父页面时）在自己的窗口上调用 print()？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T20:13:56.350

确保您尝试打印的页面引用了正确的样式表。如果不是，一些浏览器可能会拉入父级，而其他浏览器可能不会。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-11T16:00:59.070

你可以试试这个：

```
function pr(frameId){
    var printed;
    var iframe = document.getElementById(frameId);
    var ifWindow = iframe.contentWindow || iframe;
    ifWindow.focus();

    try {
        var printed =ifWindow.execCommand('print', false, null);
    } catch (e) {

    }

    if (! printed) {
        ifWindow.print();
    }
} 
```

# sql-server - 如何在SQL中的组内按顺序查找缺失值？

> ID：727392
> 
> 赞同：3
> 
> 时间：2009-04-07T20:11:47.400
> 
> 标签：sql-server, sequence, numeric

我有一个 ID 和职位表

```
CREATE TABLE #MissingSequence (ID INT NOT NULL, Position INT NOT NULL)
INSERT INTO #MissingSequence (ID,Position)
SELECT 36,1
UNION ALL SELECT 36,2
UNION ALL SELECT 36,3
UNION ALL SELECT 36,4
UNION ALL SELECT 36,5
UNION ALL SELECT 36,6
UNION ALL SELECT 44,1
UNION ALL SELECT 44,3
UNION ALL SELECT 44,4
UNION ALL SELECT 44,5
UNION ALL SELECT 44,6 
```

我要查找的是，在这种情况下，ID 的位置序列中是否有任何中断，即 44,1 和 44,3 之间的中断

我设法一起解析：

```
SELECT  l.ID
    ,Start_Position = MIN(l.Position) + 1
    ,Stop_Position = MIN(fr.Position) - 1
FROM #MissingSequence l
LEFT JOIN #MissingSequence r 
    ON l.Position = r.Position - 1
LEFT JOIN #MissingSequence fr 
    ON l.Position < fr.Position
WHERE r.Position IS NULL
    AND fr.Position IS NOT NULL
GROUP BY l.ID 
```

但如果有多个 ID 值，它就不起作用。如果只有一个 ID，44 存在，它确实有效。

想法、意见、建议？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-07T20:31:46.760

左自联接是一种很好的直觉，但我认为聚合不会削减它，当然您需要在自联接中包含匹配 ID 子句。

这是一个使用空左连接思想的（符合 ANSI 标准的）版本，选择顶行和底行并检查它们之间没有任何内容：

```
SELECT
    above.ID AS ID, below.Position+1 AS Start_Position, above.Position-1 AS End_Position
FROM MissingSequence AS above
JOIN MissingSequence AS below
    ON below.ID=above.ID AND below.Position<above.Position-1
LEFT JOIN MissingSequence AS inbetween
    ON inbetween.ID=below.ID AND inbetween.Position BETWEEN below.Position+1 AND above.Position-1
WHERE inbetween.ID IS NULL;

+----+----------------+--------------+
| ID | Start_Position | End_Position |
+----+----------------+--------------+
| 44 |              2 |            2 | 
+----+----------------+--------------+ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T20:19:00.113

此查询发现单据，希望有用；如果您使用的是 SQL 2005，则可以使用 CTE

```
SELECT ID, Position + 1
FROM #MissingSequence t1
WHERE (Position + 1) NOT IN (SELECT Position FROM #MissingSequence t2 WHERE t1.ID = t2.ID)
AND Position <> (SELECT MAX(Position) FROM #MissingSequence t2 WHERE t1.ID = t2.ID) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-20T08:43:49.060

```
create database testing
use testing;
create table sequence (
    id int not null primary key
);

insert into sequence(id) values
    (1), (2), (3), (4), (6), (7), (8), (9),
    (10), (15), (16), (17), (18), (19), (20);

select * from sequence

Create PROCEDURE test_proce(@mode varchar(50))   
AS
BEGIN
    declare @se int;
    set @se=0;
    set @se=(
        select top 1 t.id + 1 
        from sequence t 
        left join sequence x on x.id = t.id + 1 
        where x.id is null 
        order by t.id
    );
    select * from sequence where id<@se;
END

exec test_proce 'mode' 
```

# tomcat - 长文件上传是否可以由（Tomcat）服务器集群处理，如果一个服务器在上传过程中出现故障/崩溃，另一台服务器会接收它

> ID：727394
> 
> 赞同：2
> 
> 时间：2009-04-07T20:12:18.130
> 
> 标签：tomcat, upload, file-upload, multipartform-data, multipart

当 Tomcat 在上传过程中失败时会发生什么。它会简单地抛出 50X 错误吗？是否可以优雅地处理服务器故障并将请求的其余部分转发到不同的服务器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T20:18:06.167

我不具体了解tomcat，但这是一个TCP连接。如果上传失败，则 TCP 连接将断开。客户端将停止上传。

如果客户端具有允许它在文件中的给定位置重新启动上传的重试功能，则可以使用新服务器重新启动它。一般来说，这不是 web 客户端的常用功能，许多大文件上传的网站都有集成上传恢复的 flash 客户端。

如果您想以更高的透明度执行此操作，那么您可以拥有一个 Web 前端来监视 TCP 流并维护 TCP 状态。如果它观察到故障，它可以将该状态传输到新服务器，并将流传递给它以继续上传，就好像 TCP 流从一开始就没有中断一样。

不过，这并非微不足道，并且确实引入了新的故障点。主要优点是它可以与任何客户端一起使用，只要客户端不断开连接（它只能解决您这边的服务器故障，不能恢复客户端中断的下载）

-亚当

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T20:39:23.603

听起来您需要某种[负载平衡器](http://en.wikipedia.org/wiki/Load_balancer)/[故障转移](http://en.wikipedia.org/wiki/Failover)。基本上，一台机器充当多台计算机的前端 - 它侦听来自外部的流量，并将其转发到集群内的节点（计算）。如果一个节点发生故障，它知道如何将流量重新路由到另一台计算机。然后，这将要求所有节点彼此同步，以便可以继续诸如 TCP 传输之类的事务而不会跳过一个节拍。

这通常在硬件而不是软件中实现。无论如何，实施起来都不是很简单。

# testing - Soap Webservice 测试应用程序的建议

> ID：727395
> 
> 赞同：6
> 
> 时间：2009-04-07T20:12:19.300
> 
> 标签：testing, soap, wsdl

我正在寻找一些测试 SOAP Web 服务的建议。我希望能够从 WSDL 创建请求、查看这些请求并检查响应。我还希望它与 WS* 兼容的服务一起使用（例如在使用 WCF wsHttpBinding 时）。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-07T20:18:27.557

我使用 SoapUI ( [http://www.soapui.org/](http://www.soapui.org/) ) 进行所有 SOAP 测试。这是一个不同的客户端，所以如果客户端发出错误的请求，它并没有真正的帮助。在这种情况下，我只使用普通调试器或 Firebug 来检查请求/响应。

# multithreading - 是否使用 Windows 句柄从 bgnd 线程安全地进行 DirectX 调用？

> ID：727405
> 
> 赞同：0
> 
> 时间：2009-04-07T20:14:30.747
> 
> 标签：multithreading, directx, background

我正在调试一个（主要是）非托管代​​码之上的 Winforms UI 应用程序。有一点 UI 代码不是 WinForms：它使用 DirectX 直接绘制到某些 Panel 组件的表面上。为此，组件的窗口句柄在创建后被记录，任何后续调用需要执行此 DirectX 显示的模块所需的句柄（例如 GetWindowRect()），都使用此句柄。这种机制已经存在了一段时间，没有看到我要描述的问题，尽管也许我们只是幸运。我不再可以使用执行此操作的程序员。

我要解决的问题是，该区域的显示会间歇性地损坏。从后台线程调用此例程。我在我的应用程序日志中看到，例如，对 GetWindowRect() 的调用会突然并伴随绘图问题返回垃圾坐标。Window 句柄本身没有损坏，我有理由确定我们没有覆盖 Windows 数据结构；我可以停止并重新启动我们的显示流，GetWindowsRect() 将使用相同的 Windows 句柄再次开始返回良好的坐标。

如果这是在 .NET 级别，我会使用 Invoke 将绘图推迟到主线程。我的问题是，我们应该对这个 DirectX 调用做同样的事情吗？我试图找到微软关于不要在后台线程中绘制的警告，以提醒自己它是否扩展到使用 Windows 句柄；谁能指出我这一点？

个人电脑

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-07T21:10:57.007

[窗口句柄具有线程亲和性](http://blogs.msdn.com/oldnewthing/archive/2005/10/10/479124.aspx)。

> 最重要的用户界面元素当然是窗口。窗口对象具有线程亲和性。创建窗口的线程是与窗口密不可分的线程。非正式地，有人说线程“拥有”窗口。消息仅在拥有它的线程上发送到窗口过程，一般来说，对窗口的修改只能从拥有它的线程进行。尽管窗口管理器允许任何线程访问诸如窗口属性、样式和其他属性（如窗口过程）之类的东西，并且从窗口管理器的角度来看，此类访问是线程安全的，但通常应该限制加载-修改-写入序列到所有者线程。

# javascript - JavaScript 对表单的帮助？

> ID：727409
> 
> 赞同：0
> 
> 时间：2009-04-07T20:14:51.027
> 
> 标签：javascript, forms

所以，我有一个包含 4 个输入的表单，用户名、密码、电子邮件和姓名。

我厌倦了必须为每个人制作一个 javascript 函数，因为每个输入都是文本输入，当用户单击输入框时，我让它将输入的背景更改为不同的颜色。

所以这是我编码的方式：

表单输入：

```
<input type="text" name="username" id="usernameInput" onclick="changeUsername(); return false;" onblur="changeUsernameback(); return false;">

<input type="text" name="password" id="passwordInput" onclick="changePassword(); return false;" onblur="changePasswordback(); return false;"> 
```

其他两种形式相同，只是名称不同，id和javascript函数不同。

我的Javascript：

```
function changeUsername() {
 document.getElementById('usernameInput').style.background='#FFFF00';
}

function changeUsernameBack() {
 document.getElementById('passwordInput').style.background='#FFFF00';
} 
```

而其他三个只是为自己的特定ID设置。

并且在创建 CSS 时，我必须为所有 4 个输入创建不同的 ID。

我想知道的是：有没有办法我只能制作一个 CSS id 和一个 javascript 函数来更改所有输入？因为我知道当您只使用一个功能时，javascript 会尝试一次更改所有功能..

我在想类似的东西

```
document.getElementById('inputText'+[i]).style.background='#FFFF00'; 
```

然后当我给每个输入一个 id 时，我可以在页面上自动增加它们，例如 input1、input2、input3 等。

但这似乎不起作用？也许我编码错了？请帮忙..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-07T20:19:47.317

你可以这样做：

```
<input type="text" name="username" id="usernameInput" onfocus="change(this);" onblur="changeBack(this);">
<input type="text" name="password" id="passwordInput" onfocus="change(this);" onblur="changeBack(this);"> 
```

使用这个 javascript：

```
function change(el) {
    el.style.background='#FFFF00';
}

function changeBack(el) {
    el.style.background='#FFFF00';
} 
```

几点注意事项：

*   您正在使用 onclick - 虽然这可能有效，但我认为您想要的是[`onfocus`](http://www.w3schools.com/jsref/jsref_onfocus.asp).
*   据我所知，这`return false;`两个事件都没有必要。

* * *

虽然上述内容适用于纯 Javascript，但我不得不建议使用[jQuery](http://www.jquery.com)方式：

```
<input type="text" name="username" id="usernameInput">
<input type="text" name="password" id="passwordInput"> 
```

然后使用 jQuery 执行此操作：

```
$(function() {
    $('input').focus(function() {
        $(this).css('background-color', '#FFFF00');
    }).blur(function() {
        $(this).css('background-color', '#FFFF00');
    });
}); 
```

我个人觉得这更干净，因为内联 javascript 事件很难看，但第一个应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T20:19:55.587

```
<input type="text" name="whatever" id="uniqueVal" onclick="return gotFocus(this);" onblur="return lostFocus(this);">

function gotFocus(el) {
    el.style.background = 'Red';
    return false;
}

function lostFocus(el) {
    el.style.background = 'Blue';
    return false;
} 
```

我个人喜欢从这些类型的函数中返回 false 以减少我必须在 HTML 元素属性中编写的代码量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T20:21:51.510

您应该尝试使用 jQuery - 这就是我们使用的。使用 jQuery 会非常简单。

```
<script>
$(document).ready(function(){
  $(".PrettyInput")
    .focus(function() { $(this).css("background-color", "#FFFF00"); })
    .blur(function() { $(this).css("background-color", "#FFFF00"); });
});
</script>

<html>
<body>
  Username: <input type="text" class="PrettyInput" />
  Password: <input type="text" class="PrettyInput" />
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T22:01:31.677

> 有没有办法我只能制作一个 CSS id 和一个 javascript 函数来更改所有输入？

是的，您可以将一个事件处理程序附加到许多元素，只需将其分配为函数即可；主题元素以“this”形式出现。你甚至不需要身份证。

为了完整起见，由于似乎没有其他人说过，因此很有可能在不拖入整个 jQuery 的情况下拥有非内联、不显眼的事件处理程序的优势（如果你想要的只是几个，这可能有点过分突出显示输入）：

```
<input type="text" name="username" />
<input type="text" name="password" />

<script type="text/javascript">
    function inputFocussed() {
        this.style.backgroundColor= 'yellow';
    };
    function inputBlurred() {
        this.style.backgroundColor= 'white';
    };

    // Bind to input[type=text]
    //
    var inputs= document.getElementsByTagName('input');
    for (var i= inputs.length; i-->0;) {
        if (inputs[i].type=='text') {
            inputs[i].onfocus= inputFocused;
            inputs[i].onblurred= inputBlurred;
    }   }
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T20:33:08.567

[这是一个使用jQuery](http://jquery.com)的完整示例。

```
<html>   

  <head>

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
    <script>
      $(document).ready(function(){
      $("input:text")
        .focus(function() { $(this).css("background-color", "#FFFF00"); })
        .blur(function() { $(this).css("background-color", "#FFFFFF"); });
      });
    </script>

  </head>         

  <body>

    <form>
      Username: <input type="text" /> 
      Password: <input type="text" />   
    </form>

  </body>

</html> 
```

# python - 如何在 Google App Engine 中写入控制台？

> ID：727410
> 
> 赞同：50
> 
> 时间：2009-04-07T20:14:52.133
> 
> 标签：python, google-app-engine, logging

通常，当我编码时，我只想将一些小东西（主要是变量的当前值）打印到控制台。尽管我注意到 Google App Engine 启动器确实有一个日志终端，但我没有看到类似的 Google App Engine 内容。有没有办法使用 Google App Engine 向所述终端或其他终端写信？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-03-12T00:23:48.003

你会想要使用 Python 的标准`logging`模块。

```
import logging

logging.info("hello")
logging.debug("hi") # this won't show up by default 
```

要`logging.debug()`在 GoogleAppEngineLauncher 日志控制台中查看调用，您必须首先将标志添加`--dev_appserver_log_level=debug`到您的应用程序。但是，请注意，您将看到来自 App Engine SDK 本身的大量调试噪音。完整的[级别](https://cloud.google.com/appengine/docs/python/refdocs/modules/google/appengine/tools/devappserver2/devappserver2)是：

*   `debug`
*   `info`
*   `warning`
*   `error`
*   `critical`

您可以通过双击应用程序然后将其放入“**额外标志**”字段来添加标志。

[![在 GoogleAppEngineLauncher 中将 --dev_appserver_log_level 标志添加到您的应用](https://i.stack.imgur.com/2LZW5.png)](https://i.stack.imgur.com/2LZW5.png)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-04-07T20:23:22.537

请参阅[https://cloud.google.com/appengine/docs/python/requests#Python_Logging](https://cloud.google.com/appengine/docs/python/requests#Python_Logging)
和[http://docs.python.org/library/logging.html](http://docs.python.org/library/logging.html)

你可能想使用类似的东西：

```
logging.debug("value of my var is %s", str(var)) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-12-07T18:54:45.337

@Manjoor

你可以在java中做同样的事情。

```
import java.util.logging.Logger;
// ...

public class MyServlet extends HttpServlet {
    private static final Logger log = Logger.getLogger(MyServlet.class.getName());

    public void doGet(HttpServletRequest req, HttpServletResponse resp)
            throws IOException {

        log.info("An informational message.");

        log.warning("A warning message.");

        log.severe("An error message.");
    }
} 
```

[请参阅http://code.google.com/appengine/docs/java/runtime.html](http://code.google.com/appengine/docs/java/runtime.html)中的“日志记录”

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-03-17T23:53:34.753

如果您使用的是更新版本的 Python 开发服务器（版本 > 1.7.6，或 2013 年 3 月及更高版本），这些似乎是正确的使用步骤：

1.  在脚本中包含以下内容，

    `import logging logging.debug("something I want to log")`

2.  根据[此文档页面](https://developers.google.com/appengine/docs/python/tools/old_devserver#New_Development_Server)，通过转到 Edit > Application Settings > Launch Settings > Extra Command Line Flags 来设置一个标志，然后添加，

    `--log_level=debug`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-07T23:49:16.660

您还应该看看 FirePython。它允许您在 firebug 中获取服务器日志消息。

[http://appengine-cookbook.appspot.com/recipe/firepython-logger-console-inside-firebug/](http://appengine-cookbook.appspot.com/recipe/firepython-logger-console-inside-firebug/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-30T05:46:09.990

[在我的网站Learn Python](http://www.learnpython.org)上查看我在 Google App Engine 上运行的在线 Python 解释器。这可能是您正在寻找的东西。只需在要查看的内容上使用 print repr(variable)，然后执行任意多次即可。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-22T18:37:23.347

您好，我使用的是 1.8.6 版的 GoogleAppEngineLauncher，您可以使用标志来设置您想要查看的消息日志级别，例如调试消息：

`--dev_appserver_log_level debug`

使用它代替`--debug`（请参阅@Christopher 答案）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-24T19:10:40.757

GAE 将捕获标准错误并将其打印到控制台或日志中。

```
print >> sys.stderr, "Something to log." 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-24T16:30:44.210

**使用 log.setLevel(Level.ALL) 查看消息**

默认消息过滤级别似乎是“错误”。在我使用 setLevel() 方法使 .info 和 .warning 消息可见之前，我没有看到任何有用的日志消息。

打印到 System.out 的文本也没有出现。它似乎被解释为 log.info() 级别的消息。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-06T10:36:49.037

我希望我正在回答这个问题。日志消息打印到 AppEngine 日志而不是终端。

您可以 [通过单击 AppEngine Launcher 的日志按钮来启动它](http://i.stack.imgur.com/I9wXa.png)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-07-30T19:05:06.470

[使用该`logging`模块是一种很好的做法，](https://stackoverflow.com/questions/6918493/in-python-why-use-logging-instead-of-print)但这不是必需的。

您可以只做普通的`print()`s 来写入 Google App Engine 日志控制台。

# asp.net-mvc - TinyURL 像使用 ASP.NET MVC 路由？

> ID：727418
> 
> 赞同：7
> 
> 时间：2009-04-07T20:17:47.633
> 
> 标签：asp.net-mvc, url-routing

我正在尝试在 ASP.NET MVC 中编写一个类似于克隆的 TinyURL，作为第一个项目来习惯该框架。

URL 路由对我来说仍然有点混乱，尤其是当我偏离控制器/动作/id 时。

你们中的任何一个 ASP.NET MVC 忍者可以帮助我设置一个简单的 URL 路由，类似于 TinyURL.com 处理其路由的方式吗？

例如：

> www.tinyurl.com/

重定向到索引页。因此，如果没有传递参数，则只需调用 Index() 视图。

但是，如果您传入您的 tinyurl 哈希，我需要调用 redirect() 操作。

> www.tinyurl.com/fbc13

那么，我将如何设置此自定义路线？

```
 routes.MapRoute(  
                "Default",                              // Route name  
                "{tinyhash}",                           // URL with parameters  
                new { controller = "Link", action = "ReDirect", tinyhash = "" }  // Parameter defaults  
            ); 
```

这不太正确，因为如果您只是访问 url 中没有散列的页面，当我想要它时，我会将其默认为 ReDirect() 操作，而是调用 Index() 方法。

有关如何模仿基本 TinyURL 等路由的建议？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-07T20:23:48.587

你在正确的轨道上。创建一个空路由，您将不会被重定向。

```
routes.MapRoute(  
    "Default",
    "",
    new { controller = "Home", action = "Index" }
); 
```

并将您的默认设置更改为

```
routes.MapRoute(  
    "Redirect",
    "{tinyhash}", 
    new { controller = "Link", action = "ReDirect", tinyhash = "" } 
); 
```

或者，您可以让控制器检查 tinyhash 值并在它为空时显示不同的视图。（那是hacky）

# asmx - 模拟和 CredentialCache.DefaultCredentials 给 HTTP 401 Unauthorized

> ID：727421
> 
> 赞同：4
> 
> 时间：2009-04-07T20:18:01.863
> 
> 标签：asmx, impersonation, credentials

我有一个从 Web 客户端调用的 ASMX Web 服务（在我的本地主机上 - WinXP IIS 5.1）。我的 web 服务必须使用另一个 ASMX web 服务（在 Win 2003 服务器 IIS 6.0 上）。

当我以“硬编码”方式在我的网络服务代码中提供凭据时：

```
engineWSE.Credentials = new System.Net.NetworkCredential("myUser", "myPass", "myDomain"); 
```

...远程 Web 服务的后续调用***工作正常***。

现在我试图在一些初步测试中冒充自己。我对此的初步阅读告诉我这可能是一个大主题，但这是我为初学者所做的：

1.  在我的本地主机上的 WebClient 站点的虚拟目录中未选中“匿名访问”

2.  在我的 webclient 站点的 web.config 中，我建立了： authentication mode="Windows" 和 identity impersonate="true"

3.  在必须调用远程服务的 web 服务的 web 方法中，我更改为：

    ```
    engineWSE.Credentials = System.Net.CredentialCache.DefaultCredentials; 
    ```

4.  当使用这些 DefaultCredentials 调用远程 Web 服务时，我收到以下错误：

    System.Web.Services System.Web.Services.Protocols.SoapException：服务器无法处理请求。--->

    System.Net.WebException：请求失败，HTTP 状态为 401：未经授权。

    在 System.Web.Services.Protocols.SoapHttpClientProtocol.ReadResponse（SoapClientMessage 消息、WebResponse 响应、流 responseStream、布尔 asyncCall）

    在 System.Web.Services.Protocols.SoapHttpClientProtocol.Invoke（字符串方法名，对象 [] 参数）

我不确定我是否误解并试图过度简化“模拟”，或者远程 Web 服务是否以某种方式连接为仅接受带有 3 个参数（即用户名、密码、域）的凭据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-05T15:10:32.873

正如@Michael Levy 所说，这是一个双跳问题。这意味着除非您配置 Kerberos (Negotiate)，否则 NTLM 可能在运行 IIS 的 Windows 环境中使用，在机器 A 上有一个带有浏览器的客户端试图访问机器 B 上的网站时，将可以访问该站点但是，当这个站点将尝试联系机器 C 上的服务，应使用池凭据。

网站 A 调用服务 B 反过来调用服务 C 也是如此。

在为网站配置 Kerberos 时，应考虑多种因素。首先是要知道它是否是农场。如果是，您必须为场中所有机器部分的池定义一个通用用户。这是必需的，因为 Kerberos 使用域名来标识用于加密安全令牌的主体。如果您在同一个场的不同机器上有不同的用户，因为他们都将通过相同的域名访问，所有请求都将搜索相同的条目。可以在此处找到有关[Kerberos 和负载平衡](http://blogs.technet.com/b/askds/archive/2011/08/09/kerberos-and-load-balancing.aspx)的更多详细信息。

例如，假设您有一个以 myApp.intranet 作为 URL 的站点。在 AD 中，您可以将 SPN 设置为域 MyDomain 中的 myUser (setspn -S MyDomain\myUser HTTP/myapp.intranet)。当请求发送到 KDN 时（有关 KDN 的更多信息，请参阅末尾的 kerberos 链接），它将始终返回使用 myUser 加密的令牌，但 IIS 将尝试使用不同的用户对其进行解密。为同一个服务（HTTP/myapp.intranet）创建多个 SPN 可能很诱人，但这会导致 KRB 错误。

此外，如果您使用的是 IIS 7+，如果您想保持启用内核模式身份验证（强烈推荐），则必须在 ApplicationHost.config 中设置一些细节：[useAppPoolCredentials](http://technet.microsoft.com/en-us/library/dd573004%28office.13%29.aspx) =true。此值必须在 configuration\system.webServer\security\authentication\windowsAuthentication 上设置。这是因为默认情况下，[内核模式身份验证将使用计算机帐户](http://blogs.msdn.com/b/sudeepg/archive/2009/02/08/iis-7-kernel-mode-authentication.aspx)，而不是池帐户，这将使我们回到多用户场景。

在所有情况下，必须启用 AD 主体[委派选项卡的信任此用户...才能使委派工作。](http://blogs.msdn.com/b/autz_auth_stuff/archive/2011/05/03/kerberos-delegation.aspx)然后，您必须决定是要使用一般委派还是受约束委派。

正如我之前所说，您还必须为正确的用户和正确的服务设置 SPN。用户很容易识别，因为它将是您在池中定义的用户，但根据您的配置，服务可能会有点棘手。DNS、浏览器和可能的其他变量可能会改变应该使用的内容。我们的试验和错误表明：

*   如果你的 DNS 条目是 A 条目，则直接使用它
*   如果您的条目是 CName，在我们的测试中，它使用了与之关联的 A 条目
*   我们遇到过使用 CName 的情况，它似乎与浏览器的版本有关。

请注意，如果没有专门设置 SPN，并且您通过 NetBIOS 名称访问您的网站，则将请求 HTTP/机器服务，并且默认情况下，可以使用[HOST 服务（搜索额外）](http://blogs.technet.com/b/askds/archive/2012/07/27/kerberos-errors-in-network-captures.aspx)代替 HTTP，因此 HOST/机器会被使用。这对于在小型网络上轻松配置很有用。

还要记住，如果您想在从 NTLM 到 Kerberos 时限制停机时间，您应该首先修改 ApplicationHost，然后使用 SetSPN。您还可以在任何操作之前禁用协商并仅保留 NTLM，直到一切都设置好，然后，如果可能，仅启用协商（不启用 NTLM）。这应该会迫使客户修改他们访问您网站的方式。如果您不这样做，缓存机制似乎倾向于在 NTLM 上保留一段时间。

希望这能有所帮助。如果您在配置 Kerberos 时仍有问题，[WireShark](http://www.wireshark.org/)是您最忠实的朋友。您可以在以下页面中找到有关如何调试 Kerberos 的信息： -[为网站调试 Kerberos](http://blogs.technet.com/b/askds/archive/2008/05/29/kerberos-authentication-problems-service-principal-name-spn-issues-part-1.aspx) -[使用 Kerberos 调试 AD 问题](http://blogs.technet.com/b/surama/archive/2009/04/06/kerberos-authentication-problem-with-active-directory.aspx)（最大令牌大小就是其中之一） - [Kerberos 工具和其他链接](http://stevenhollidge.blogspot.ca/2012/05/troubleshooting-kerberos-with-tools.html) -[常规网络捕获 Kerberos 调试](http://blogs.technet.com/b/askds/archive/2012/07/27/kerberos-errors-in-network-captures.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T22:47:09.850

您是否使用过 netmon 或 wireshark 来确保凭据通过？服务提供商的日志告诉你什么？此外，请确保 web.config（或其他 .config）中没有配置模拟标签。

编辑：

可能是 HostingEnvironment.Impersonate() 块——默认情况下使用应用程序池的身份，或者您传递给它的任何用户令牌的身份。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-19T12:47:19.760

这是典型的双跳问题 - 除非在您的域中正确配置了 Kerberos 委派，否则您不能使用通过模拟获得的用户凭据来访问另一台服务器。[这个](https://stackoverflow.com/questions/517846/impersonation-and-delegation-in-asp-net)问题的重复

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T17:29:14.683

@ Michael Kniskern - HTTP 肯定是可能的。模拟功能会将凭据从 ASP.Net 应用程序传递到 IIS。使用集成 Windows 身份验证，最终用户的凭据将被使用，而不是默认的 ASPNET 帐户（或附加到应用程序池的帐户）。我相信，那篇 MSDN 文章提到的 HTTP 和 FTP 是针对 DefaultNetworkCredentials 的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T00:38:01.300

根据以下 MSDN[文章](http://msdn.microsoft.com/en-us/library/system.net.credentialcache.defaultcredentials.aspx)，它不适用于 HTTP 和 FTP 协议。当您连接到远程服务器时，您必须明确提供凭据。

# c# - 在类和表单之间发送数据？

> ID：727424
> 
> 赞同：0
> 
> 时间：2009-04-07T20:18:48.380
> 
> 标签：c#, forms, class

前几天，我问[如何在您的班级中创建一个消息框](https://stackoverflow.com/questions/715206/show-a-message-box-from-a-class-in-c)，但其中一个答案表明这不是正确的方法。我知道这是因为它确实违背了课堂的意义。

我的程序从字符串文件中逐字读取，并检查每个单词是否在数据库中。我想把每一个没有找到的单词放到表单上的 ListBox 中，它可以有多个选择。

每次找到新单词时，如何将这些数据发送回表单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T20:24:16.403

我建议你做一个这样的方法：

```
/* ... */

public IEnumerable<string> FindMissingWords(
                               string fileName, IEnumerable<string> toSearch)
{
    List<string> missingWords = new List<string>();

    // todo: the appropriate code for looking up strings in the file, using 
    // the filename and the strings that we passed into the function.

    // if you find one, add it to missingWords

    return missingWords;
} 
```

然后从您的表单中调用该方法，并将它返回的每个字符串添加到您的框中。

（如果您不熟悉`IEnumerable`，请不要担心 - 它只是一个定义一系列事物的接口，例如数组或列表。您可以传递一个字符串数组，但它会不太精确.)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T20:26:32.310

如果类有对表单的引用，它可以直接更新表单。

```
someForm.SomeListBox.Items.Add(someWord); 
```

如果表单引用了类，您可以让类引发类似的事件

```
public delegate string WordNotFoundHandler(string word);
public WordNotFoundHandler event WordNotFound ; 
```

并让表单处理该事件

```
theClass.WordNotFound += AddItemToListBox

void AddItemToListBox(string word)
{
someListBox.Items.Add(word);
} 
```

这样做而不是一个返回所有单词的巨大调用的优点是它提供了更快的 ui 响应时间，尤其是在由单独的线程完成时

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T20:35:19.480

这就是我要做的（或类似的）：

```
 bool done = false;
    while(true)
    {
        string foundstring;
        done = searchforstring(out foundstring);
        if(done)
            break;
        // Not done, so take what we found and add it to the listbox
        this.BeginInvoke(new Action<string>(delegate(string input)
            { this.listBox.BeginUpdate(); this.listBox.Items.Add(input); this.listBox.EndUpdate(); }),
            new object[] { foundstring });

        } 
```

替换您的列表框控件的名称，我认为这会起作用。或者您可以将匿名方法分解为它自己的对象。这个想法是，每次你找到一个新字符串时，你都会派遣一个工作人员在“主应用程序线程”中执行更新（因此调用 BeginInvoke()）。如果 begin/endUpdate() 调用是绝对必要的，我不会完全起诉，但它们可能是。

显然，您如何获取字符串取决于您，但如果您的应用程序是多线程的，这应该是即时将其放入列表框的方式。如果它不是多线程的，直接的 Invoke()（而不是 BeginInvoke）应该可以立即更新列表框，但这可能会降低搜索性能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T20:40:59.297

您不想**将**表单与从文件中搜索和查找单词的类结合起来。这是一个**基于事件的**解决方案

基本上，您要做的是在类中公开一个事件，该事件从文件中读取和查找单词（我将其命名为`WordFinder`示例。）

`WordFinder`公开一个`WordFound`在找到新单词时引发的事件。

```
public class WordFinder
{
    public event EventHandler<WordFoundEventHandler> WordFound = delegate { };
    public event EventHandler NoWordsFound = delegate { };

    protected virtual void OnWordFound(WordFoundEventHandler e)
    {
        var wordFoundHandler = WordFound;
        wordFoundHandler(this, e);
    }

    private void OnNoWordsFound(EventArgs e)
    {
        var noWordsFoundHandler = NoWordsFound;
        noWordsFoundHandler(this, e);
    }

    public void FindWords(string fileName)
    {
        //.. read file and find word
        //.. When a word is found,
        OnWordFound(new WordFoundEventHandler(foundWord));

        // Keep a counter somewhere and check if any words has been found, 
        // if no words are found, then raise "NoWordsFoundEvent"
        OnNoWordsFound(EventArgs.Empty);
    }
}

public class WordFoundEventHandler : EventArgs
{
    public string FoundWord { get; private set; }

    public WordFoundEventHandler(string foundWord)
    {
        FoundWord = foundWord;
    }
} 
```

现在，您的表单将简单地注册到事件`WordFinder`并在找到新单词时添加一个新项目。

```
public partial class Form1 : Form
{
    private readonly WordFinder _WordFinder;

    public Form1()
    {
        InitializeComponent();

        _WordFinder = new WordFinder();
        _WordFinder.WordFound += WordFinder_WordFound;
        _WordFinder.NoWordsFound += WordFinder_NoWordsFound;
    }

    private void WordFinder_WordFound(object sender, WordFoundEventHandler e)
    {
        // Add item to the list here.
        foundWordsListBox.Items.Add(e.FoundWord);
    }

    private void WordFinder_NoWordsFound(object sender, EventArgs e)
    {
        MessageBox.Show("No words found!");
    }

    private void findWordsButton_Click(object sender, EventArgs e)
    {
        _WordFinder.FindWords(/* pass file name here */);
    }
} 
```

# c++ - 如何将 Visual Studio 项目从使用宽字符串转换为普通字符串

> ID：727439
> 
> 赞同：9
> 
> 时间：2009-04-07T20:23:35.763
> 
> 标签：c++, c, winapi, visual-c++, unicode

当我创建我的 Visual Studio 项目时，它默认强制我对所有采用字符串的函数使用宽字符串。例如，MessageBox() 采用 LPCWSTR 而不是 const char*。虽然我知道它非常适合多语言和便携式应用程序，但对于我的简单小应用程序来说完全没有必要。坦率地说，在我的所有字符串周围不断键入 TEXT() 更加痛苦。

是否有编译器选项、定义或项目设置可以更改以在我的 Visual Studio 项目中解决此问题？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-07T20:24:57.103

右键单击您的项目 -> 属性，然后转到以下树项：

> 配置属性 -> 常规

**对于 Unicode 选择：**
使用 Unicode 字符串

**对于普通的多字节选择：**
使用多字节字符集

当您放置`TEXT()`或`_T()`环绕您的字符串时，您正在使其与两个字符串选项兼容。如果您选择`Use multi-byte character set`，那么您的字符串周围不需要任何东西。如果选择`Use unicode character set`，则字符串前面至少需要 L。

通过选择`Use Unicode Character Strings`您也默认使用所有以 W 结尾的 Win32 API。示例：`MessageBox`映射到`MessageBoxW`.

当您选择时，`Use multi-byte character set`您还默认使用所有以 A 结尾的 Win32 API。示例：`MessageBox`映射到`MessageBoxA`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T15:27:56.300

值得注意的是，您可以显式声明以下形式的宽字符串文字：

```
WCHAR *s = L"Hello Wide World."; 
```

which requires fewer keystrokes than the macros TEXT() or _T(), but which will make a wide character string even if UNICODE is not defined.

# php - 子域上的 SOAP

> ID：727440
> 
> 赞同：0
> 
> 时间：2009-04-07T20:23:47.497
> 
> 标签：php, soap

我正在使用一个由多个客户端使用的应用程序。每个客户端都有自己的数据库，但多个客户端使用相同的 php 代码库。本质上，我们使用 apache 上的命名虚拟服务器将 url 指向服务器上正确的代码库。当浏览器点击 php 代码时，代码会检查主数据库以查看 url 与哪个客户数据库配对。

我们正在添加一个 SOAP 模块，我很困惑如何为我们的肥皂服务处理 wsdl 文件。本质上，每个代码库都有一个 wsdl 文件。我只需要能够配置 wsdl 文件来处理我们用来指向相同代码的所有各种子域。一旦我们点击了我们的 SOAP 模块，它就知道要使用什么数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T08:33:30.813

我不确定，但您可以拥有一个动态 WSDL 文件，它本身就是一个 PHP 脚本。根据请求参数（将指示哪个客户正在请求），将生成特定的 XML 数据并将其发送给用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T17:48:53.523

这就是我们最终所做的——我们放弃了对 WSDL 的需求。从客户端，我们只需将适当的子域设置为端点。因为我们使用 Mirth 将我们的通信定向到每个子域，所以它对我们很有效。

我确实尝试过使用动态 wsdl 文件，但在我不得不花在项目上的有限时间里，始终无法让它工作。

# javascript - 将 Javascript 注入页面

> ID：727445
> 
> 赞同：1
> 
> 时间：2009-04-07T20:24:14.420
> 
> 标签：javascript, asp.net-mvc

我正在编写一个基于网络的游戏，其中涉及单击 Internet 上各个站点上的链接。我知道这听起来很奇怪，但基本前提是您从我的页面开始，然后单击指向另一个站点上某个页面的链接。您继续关注链接，直到到达您尝试访问的页面。想想 WikipediaGame.org。不同之处在于我无法控制带有链接的实际页面。

我需要做的是跟踪他们点击的所有链接，当他们到达最后一页时，我想将它们发送回我的网站（或类似的东西）。

我在想，也许我可以以某种方式拦截页面请求并注入一些 Javascript 来跟踪他们点击了哪些链接。这可能吗？有没有人做过这样的事情？显然，这可能会带来安全风险。我还有其他选择吗？我想避免让用户收集所有链接的列表，然后将它们发布到我网站上的文本框中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T20:41:04.490

也许是一个将当前页面发送到您的网站的书签？这样，用户就可以通过最少的工作完全控制共享的链接列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T20:42:45.687

为了使这个跨浏览器兼容——我不确定是否有办法不为每个浏览器编写插件。但是，我也可能是错的:-)

您可以尝试制作一个书签（当用户单击某个书签时运行的 Javascript），但这不会在用户加载的每个页面上自动运行；用户必须单击它才能运行它。

如果您只想支持 Firefox，您可以编写一个在每个页面/站点上运行的 Greasmonkey 脚本。但是，这会限制您的用户范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T20:44:40.830

你不能单独使用 javascript 来做到这一点。您需要编写一个 firefox 插件或一个 GM 脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T21:05:21.967

我不确定您是否可以按照您设想的方式完成此操作。如果不编写浏览器插件，我会看看 KeepVid 之类的网站在做什么。他们让您在工具栏上创建一个书签，书签网址是这样的：

javascript:document.location=' [http://keepvid.com/?url=](http://keepvid.com/?url=) '+escape(window.location);

这基本上将用户当前所在的 url 传递给 keepvid。如果您使用此概念，您可以让您的用户单击书签按钮以向您注册该 url，您可以收集它并将用户传回他们所在的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T13:41:15.607

所以我想出了该怎么做。我正在使用这样的 iframe：

`<iframe src="Puzzle/ContinuePuzzle" />`

它将源指向我的 Mvc 控制器。在我的控制器中，我为我想要的实际 url 执行 WebRequest，然后解析 Html 并将我自己的 javascript 粘贴在页面中。该页面的行为和看起来像另一个站点，但它实际上来自我的站点。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-07T20:49:27.887

我不知道您如何将 JavaScript 注入到其他人的页面中，然后这些页面会向您发送消息。这实际上听起来像是病毒会做的事情。

我认为您可以使用 iframe 完成类似您想要的事情。
一个简单的方法是包含一个 iframe 预设来加载您网站上的“开始”位置，然后在外部页面上包含一个按钮，供用户回发他们当前的位置（在 iframe 中）。

当按下页面上的按钮时，您可以查询 iframe 的当前状态...<br/> 对 iframe 生成的窗口和加载到 iframe 中的文档的引用可以通过使用 name 属性的 frames 数组获得。

```
 window.frames[iframeName]  <br/>
 window.frames[iframeName].document  <br/> 
```

引用的框架数组方法具有广泛的支持，即使在相当老的浏览器中，只要您将名称属性附加到 iframe。为获得最佳效果，请同时使用名称和 ID。

对于更新的浏览器，iframe 内的文档也可以通过 iframe 元素的 contentWindow (IE win) 和 contentDocument (DOM) 属性来引用：

```
// IE5.5+ windows
document.getElementById(iframeId).contentWindow
document.getElementById(iframeId).contentWindow.document
or,
// DOM 
document.getElementById(iframeId).contentDocument 
```

编辑：正如下面的评论所暗示的，看起来大多数浏览器都阻止你以这种方式使用 iframe。您可以在您想要的任何地方启动一个窗口，但如果它不在您的同一个域中，则不允许您与它通信。我想您可以构建一个“中间人”场景，让所有流量首先通过您的服务器，但这不是很实用。

这是 jQuery 控制 iframe 的一个很好的例子

[http://wwwendt.de/tech/dynatree/doc/sample-iframe.html](http://wwwendt.de/tech/dynatree/doc/sample-iframe.html)

希望有帮助。

# flash - Actionscript 3：从解析的 XML 文件创建变量对象和分配类

> ID：727447
> 
> 赞同：1
> 
> 时间：2009-04-07T20:24:43.920
> 
> 标签：flash, actionscript-3, variables

我已经设置了一个 XML 文件，其中包含将包含在 fla/swf 库中的对象名称。我希望使用可以快速修改的 XML 文件将对象定位在舞台上，而无需重新编译 fla/swf 文件。当然，定位只能在对象被实例化并添加到舞台时才能完成。问题是以编程方式将解析的 XML 文件名/类配对数据传递到 var 创建中。

XML 文件包含对象名称和类：示例如下：

```
<objects>
   <object name="myBall" class="Ball"/>
</objects> 
```

XML 文件解析正确，我设置了一个 ...for...each 循环来为每个对象分配名称/类。问题在于输入名称/类配对的正确语法，类似于以下内容：

```
var object.@name:object.@class = new object.@class(); 
```

我是因为这个而摇摆不定还是只是暂时无知？？？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T23:43:23.193

只是快速跟进，有一个非常直接的方法来保持它的灵活性：

```
var xml:XML = <object name="myBall" class="Ball">;

// Looks up for a defined symbl/definition with the name 'Ball'    
var Def:Class = getDefinitionByName(xml.@class);

// Creates the instance of the Ball
var instance:* = new Def();

// in case you want to assign a name to the node as a reference on the display list :
addChild(instance).name = @xml.name; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T20:44:37.057

我不确定你想做什么。

您想创建一个名称为 myBall 且类型为 Ball 的对象吗？

```
var object:Object = new Object();
object[objects.name] = createNewClass(objects.class);

...

function createNewClass(var name:String):Object
{
    if(name == "Ball")
        return new Ball();
    ...
} 
```

不确定这是否是你想要做的。我不知道是否有一种方法可以仅从文本中创建一个新球，如果有人知道这样做的方法，我也想知道如何。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T21:19:26.630

根据您的要求，听起来您正在尝试一种工厂模式（工厂方法），其中一个类负责根据外部来源提供的信息动态生成对象。

我建议研究 Flex 和 ActionScript 的设计模式。我还没有在 Flex 中编写过工厂方法，但它不会比 Java 难多少，这还不错。

一般来说，我希望您的程序如下所示：

1.  您的 XML 描述了将要生成的对象（类类型、参数等）。您的示例似乎表明了这一点。
2.  您有一个 XSD 可以验证 XML 文件是否符合您的程序的期望——如果不符合，则会输出适当的错误。我*强烈*推荐这些方面的东西进行验证：您需要有一种机制来保证 XML 是正确的。
3.  您已经抽象出您期望在 XML 中出现的值。我建议在单独的实用程序类中使用枚举或静态/常量字符串值。
4.  您有一个 Factory 类，其唯一职责是接收 XML 数据，根据内容生成对象，并将其返回给需要它的人。

显然，第四点是您正在寻找的或（我认为）。CookieOfFortune 的示例显示了此工厂方法可能会看到的内容。但是，我建议您还将字符串值抽象为变量或枚举：

```
...
var BALL_CLASS_TYPE:String = "Ball";
...
function createNewClass(var name:String):Object {
    if (name == BALL_CLASS_TYPE)
        return new Ball();
} 
```

但是，您的第一个参数让我感到困惑。听起来您正在尝试创建一个动态对象，并对其具有动态命名的*引用*（例如`var <x>:Object`，`<x>`在 XML 中定义为数据的位置）。我不知道这是否可能。我当然认为没有必要。

# java - 将 Jena OntModel 与 bnode 同步

> ID：727449
> 
> 赞同：1
> 
> 时间：2009-04-07T20:25:01.253
> 
> 标签：java, serialization, jena, ontology

这个问题与[rcreswick](https://stackoverflow.com/users/3446/rcreswick)关于[Serializing Jena OntModel Changes](https://stackoverflow.com/questions/375605/serializing-jena-ontmodel-changes)的问题有关。我在需要通过套接字保持同步的两台（或更多）机器上有 Jena 模型。我需要解决的主要问题是模型可能包含匿名节点（bnodes），它可以源自任何模型。

**问题**：我是在正确的轨道上，还是有更好、更强大的方法我没有考虑？

我可以想到 3 种方法来解决这个问题：

1.  **序列化完整模型**：这对于同步小更新来说非常昂贵。此外，由于任何一台机器都可能发生变化，我不能只用机器 A 的序列化模型替换机器 B 的模型。我需要合并它们。
2.  **序列化部分模型**：使用专用模型进行序列化，该模型仅包含需要通过套接字发送的更改。这种方法需要特殊的词汇表来表示从模型中*删除的语句。*据推测，当我将模型从机器 A 序列化到机器 B 时，匿名节点 ID 对于机器 A 将是唯一的，但可能与在机器 B 上创建的匿名节点的 ID 重叠。因此，我必须重命名匿名节点并保留映射从机器 A 的匿名 ID 到机器 B 的 ID，以便正确处理未来的更改。
3.  **序列化单个语句**：这种方法不需要特殊的词汇，但可能不那么健壮。除了匿名节点之外，还有其他我还没有遇到的问题吗？
4.  **Generate global unique bnode ids (NEW)**：我们可以通过在 ID 前加上唯一的机器 ID 来为匿名节点生成全局唯一的 ID。不幸的是，我还没有弄清楚[如何告诉 Jena 使用我的 ID 生成器](https://stackoverflow.com/questions/728025/generating-jena-bnode-ids)而不是它自己的。这将允许我们在不重新映射 bnode ID 的情况下序列化单个语句。

这里有一个例子可以让这个讨论更深入一点。假设我在机器 A 上有一个列表，表示为：

```
 _:a rdf:first myns:tom
    _:a rdf:rest rdf:nil 
```

我将这个模型从机器 A 序列化到机器 B。现在，因为机器 B 可能已经有一个（不相关的）匿名节点，id 为“a”，我将 id 'a' 重新映射到新的 id 'b'：

```
 _:b rdf:first myns:tom
    _:b rdf:rest rdf:nil 
```

现在机器 A 上的列表发生了变化：

```
 _:a rdf:first myns:tom
    _:a rdf:rest _:b
    _:b rdf:first myns:dick
    _:b rdf:rest rdf:nil 
```

由于机器 B 之前从未遇到过机器 A 的 id 'b'，它添加了一个从机器 A 的 id 'b' 到新的 id 'c' 的新映射：

```
 _:b rdf:first myns:tom
    _:b rdf:rest _:c
    _:c rdf:first myns:dick
    _:c rdf:rest rdf:nil 
```

如果有两台以上的机器，问题会更加复杂。例如，如果有第三台机器 C，它可能有自己的匿名节点“a”，它不同于机器 A 的匿名节点“a”。因此，机器 B 确实需要保存从其他机器的每个匿名节点 ID 到其本地 ID 的映射，而不仅仅是从一般的远程 ID 到本地 ID。在处理传入的更改时，必须考虑更改的来源以正确映射 ID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T07:44:45.403

您是否可以将自己的三元组添加到模型中？如果是这样，我将为每个 bnode 引入一个语句，以 URN 的形式为每个 bnode 提供一个备用公共 id。您现在可以开始在两个模型之间匹配 bnode。

但是，无论是否为空白节点，双向同步只会让您到目前为止。如果您试图在两个模型上检测等效的并发更改，那么像这样的策略只会让您到目前为止。

这是一个例子。假设您正在创办一家新的草坪护理公司。为了招揽生意，你和你的搭档去参加当地的户外活动，并尝试预订一些打折的试用预约。你们两个，每个人都带着一台笔记本电脑，把任何有兴趣的人打成一片并记录下来。记录有：

```
address and zip
phone number
appointment dateTime 
```

假设每条记录都作为资源存储在您的模型中。你有可能见到丈夫，你的伴侣有可能见到同一家庭的妻子。无论您是否巧合地预订了相同的约会日期时间，系统都很难对条目进行重复数据删除。无论您对每条记录使用 bnode 还是使用基于 UUID 的 URI，它都不会重复数据删除。唯一的希望是，如果您使用某种规范形式的电话号码来合成一个确定的 URI 以供记录。

# flash - 使用 Red5 通过 RTMP 流式传输高质量 FLV 时出错

> ID：727451
> 
> 赞同：0
> 
> 时间：2009-04-07T20:26:11.810
> 
> 标签：flash, video, flv, red5, rtmp

我对 FLV 流/Red5 场景相当陌生，并且发现由于某种原因，我无法使用 oflaDemo 播放编码高于特定质量的 FLV 文件。我已经使用 ffmpeg 将 FLV 文件从 h264 编码为 Sorenson Spark。它可以使用`-qscale 31`，但任何更高的（数字似乎在不同电影之间发生变化）都拒绝播放。Sorenson Spark FLV 的比特率是否有上限，还是 Red5 问题（或者实际上是 Flash 问题）？

我的最终目标是将高质量视频流式传输到 Wii，因此使用“旧”Flash 7 格式！也许还有另一种方式...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-07T23:02:37.597

我认为这不会有帮助，但您可以尝试在编码 (-ps) 时设置数据包大小，以防您的服务器在该级别受到限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-03T16:45:47.123

我不知道这个特殊问题（作为 red5 开发人员），但我知道服务器不关心视频的质量，它会尽可能快速有效地发送它。在大多数情况下，Flash Player 似乎会在服务器出现故障或锁定之前发生故障或锁定，尤其是对于大型 F4V 或 MP3 文件。

# infrared - 红外代码列表？

> ID：727459
> 
> 赞同：18
> 
> 时间：2009-04-07T20:28:57.123
> 
> 标签：infrared

我有一个控制 IR 发射器的应用程序，并希望访问 IR 代码的世界。这是免费提供的东西，还是订阅？

（和谐和罗技之类的公司有它们——只是不知道我是如何获得它的）

（到目前为止，谷歌没有给我任何有用的东西）

注意-要清楚-我想要电视，DVD播放器等设备的列表-例如使用通用遥控器打印的设备或下载的设备。但是，我想要实际的规格，这样我就可以控制 IR 二极管。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-07T21:02:12.613

[LIRC](http://www.lirc.org/)有一个[遥控器代码库](http://lirc.sourceforge.net/remotes/)，您可以在其中找到各种红外遥控器制造商的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T20:51:19.833

像[这样](http://users.telenet.be/davshomepage/home.htm)的东西？如果页面未加载，请查看其他链接的来源。例如，[这里](http://users.telenet.be/davshomepage/sony.htm)是 Sony 协议。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-11T17:14:57.380

可以使用以下链接中的 Megalist：

[http://www.commandfusion.com/wiki2/software/ir-learner/megalist-ir-database](http://www.commandfusion.com/wiki2/software/ir-learner/megalist-ir-database)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-18T22:05:29.097

[irdb.tk](http://irdb.tk)包含我正在寻找的设备的 IR 代码。我使用了[Pronto IR 格式](https://www.remotecentral.com/features/irdisp2.htm)中给出的值。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-11-20T20:06:50.107

对于使用原始 LED，我会将光电二极管或光电晶体管连接到示波器，这样您就可以看到正在发送的内容。我的印象是脉冲是串行 ascii 数据，不知道波特率之类的东西。然后在带有 LED 和电池的小盒子中使用 PIC [https://en.wikipedia.org/wiki/PIC_microcontrollers或 Atmel。](https://en.wikipedia.org/wiki/PIC_microcontrollers)或者把它做成你最喜欢的扶手椅。

# .net - 在哪里为 Windows 应用程序编写日志

> ID：727462
> 
> 赞同：2
> 
> 时间：2009-04-07T20:29:27.107
> 
> 标签：.net, windows, logging

我有一个通过 ClickOnce 部署到 Web 服务器的 .NET Windows 应用程序。在任何给定时间大约有 100 个用户，全部位于中心位置。我正在使用 log4net 在应用程序中登录，但我无法到达放置日志的最佳位置。

我尝试让他们写入共享网络位置，但有些用户在使用这种方法时遇到了糟糕的 I/O。我已经尝试登录到用户的临时文件夹，但这使得检索日志变得更加困难。我没有尝试过事件日志，因为我可能不得不跳过一些圈子才能让它工作，而且我不确定它是否值得。我从未尝试过数据库日志记录，但我一直认为它会相对较慢。

有人有登录部署在企业环境中的 Windows 应用程序的经验吗？关于我可以将日志放在哪里以便 (1) 快速、(2) 可靠和 (3) 可访问的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T20:32:23.277

数据库日志记录的问题不在于速度，而在于可靠性。您在出现问题时记录下来，如果出现问题，那么无法访问数据库的可能性对您不利。

通常，您希望写入本地文本文件*以及*网络共享或数据库等其他地方。如果您遇到 IO/速度问题，您可以将文本文件用作缓冲区并将日志批量写入竞争资源。然后定期刷新本地“备份”日志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T20:35:03.037

log4net 支持一些主要数据库的[数据库附加程序。](http://logging.apache.org/log4net/release/config-examples.html)如果您有合适的可用数据库，这可能是一个更好的选择。但是，请谨慎使用，因为如果管理不当，可能会降低应用程序的可靠性。

您可以将它与本地文件日志记录结合使用，方法是使用 BufferingForwardingAppender 批处理网络日志记录并仅在收到超过特定阈值的消息时发送。这样，您可以有足够的上下文来跟踪错误，但仅限于发生错误时。

```
<appender name="BufferingForwardingAppender" type="log4net.Appender.BufferingForwardingAppender">
<bufferSize value="1024" />
<lossy value="true" />
<evaluator type="log4net.Core.LevelEvaluator">
  <threshold value="ERROR"/>
</evaluator>
<appender-ref ref="DatabaseAppender" /> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T20:35:24.207

我已经将 log4net 与 ms sql 数据库一起使用。如果可能的话，我通常将它们放在不同的服务器上的专用数据库。这样，如果应用程序服务器或数据库出现问题，我就不会丢失我的日志记录。

速度从来都不是问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T20:32:25.820

ApplicationData 文件夹呢？在 Vista 上会是这样的：

C:\Users\Ray\AppData\Local\MyCompanyName

如果您想要一个中心位置，我会使用数据库日志记录。但正如 Joel 所说，您既需要一个始终有效（或尽可能靠近它）的本地位置，又需要一个中央位置来收集日志，以备一切正常工作时使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-07T20:36:50.367

您可以使用本地日志记录的组合，并且可以在成功注销时将日志同步到中央数据库。

这取决于您想要执行什么样的日志记录以及您的应用程序是如何运行的。如果执行日志记录的应用程序是客户端应用程序，那么如果您写入事件日志，它可能没有帮助。

如果您确实想写入事件日志，这很简单：

[http://support.microsoft.com/kb/307024](http://support.microsoft.com/kb/307024)

还有一件事，如果您正在寻找一个您知道用户肯定可以访问的位置，您可以使用隔离存储，但是您试图写入共享文件夹这一事实让我觉得您想要一个中央位置对于您的日志，在这种情况下，数据库可能是您最好的选择，而我的最佳建议可能最适合您。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T20:34:15.817

如果应用程序是一个典型的两层作业，那么登录到数据库`AdoNetAppender`可能是合适的。AdoNetAppender 将日志消息以最多 100 条为单位进行批量处理，但您可能希望将其配置为至少写入`WARN`严重性事件。

您可能还需要考虑将日志记录到所有用户应用程序数据目录，尽管这可能会使检索日志同样难以处理。也许考虑在某处添加快捷方式？

最后，如果日志可访问性问题是您组织中的常见主题，您可能需要考虑使用日志收集应用程序，例如[Splunk](http://splunk.com/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-07T20:35:03.443

您可以尝试 CommonAppData 文件夹下的某个位置 - 即 CommonAppData\YourAppName\Logs - 只要您确保大小限制和/或定期清理。人们习惯于定期清理临时文件夹，但对开始挖掘 CommonAppData、AppData 或 LocalAppData 持谨慎态度。

在除此处或在 Temp 之外的任何其他地方写入内容迟早会让您在 Vista 和更高版本上遇到麻烦。

如果日志不重要，即如果有人删除日志不会丢失不可替代的数据，我肯定会在 Temp 中找到一个子文件夹，并让一个单独的任务计划程序作业上传它们。这是最不痛苦的地方。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-07T20:43:19.180

在我们的应用程序中，我们 log4net 并为所有用户使用通用日志文件，位于 CommonAppData 目录 (C:\Documents and Settings\All Users\Application Data\Company\Product)。在这种情况下，我们的安装程序必须手动设置目录和日志文件的文件权限，以便所有用户都可以访问它，默认权限仅适用于安装应用程序的用户。

我们还使用顶级异常处理程序（使用类似于：[http ://www.wintellect.com/cs/blogs/jclark/archive/2005/03/ 的实现）将未处理的异常（如果可以）记录到事件日志中30/simple-main.aspx](http://www.wintellect.com/cs/blogs/jclark/archive/2005/03/30/simple-main.aspx)）。我们使用事件日志，因为所有关于打开的文件流状态的赌注都没有。同样，我们的安装程序必须在应用程序事件日志中设置事件日志源。

如果您确实使用事件日志，请确保您的日志记录非常少。如果您记录大量事件，因为事件日志很快就会被填满，并且 XP 上的默认策略是事件日志在日志已满时开始丢弃事件，并且默认大小相对较小（512 KB，并且仅覆盖超过 7 天的事件）。

# jquery - jquery modal打开到整页

> ID：727464
> 
> 赞同：3
> 
> 时间：2009-04-07T20:30:49.630
> 
> 标签：jquery, modal-dialog

我有一个嵌套的 jquery modals Modal1 和 modal2 都包含 updatePanels。要更新我正在使用 javascript 的面板：

```
var prm = Sys.WebForms.PageRequestManager.getInstance();
prm._doPostBack('UpDateLookUp',''); 
```

UpDateLookUp 是 modal1 的 updatePanel 的 id。模式 1 包含模式 2 的链接，该链接位于更新面板中。Modal1 updatePanel 是面板外部的搜索条件（查找），当我在 modal1 上时效果很好，但是当我打开 modal2（有 wpdatePaneltoo）并返回 modal1 时，选择 Find modal2 opens to full page 并显示之前的信息它已关闭并返回到 modal1。如果我点击打开 modal2 的链接，一切都很好，只有当我选择不同的按钮时才会出现。

我是 jquery 的新手，所以请帮忙。这就是我们商店的发展方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-12-19T21:20:00.637

这里有两三件你想要的东西。首先，如果您要挂接的任何控件在您的 ajax 回发中消失了，您将需要在页面重新加载时使用以下内容重新挂接您的事件处理程序：

```
function pageLoad(sender, args) 
{
    if (args.get_isPartialLoad()) 
    {
        //Re-hook code here
    }
} 
```

或使用 $(document).ready() 函数中的 .live() 函数来添加事件挂钩。这个函数在[JQuery UI 的 API 站点](http://api.jquery.com/live/)上有很好的记录。

此外，如果您希望动画效果在执行回发之前隐藏某些内容（这将防止它在动画完成之前更改），请使用 .Promise().Done() 函数，如下所示：

```
$("#Detail").fadeOut().promise().done(function () 
{
    __doPostBack('<%= UpdatePanel1.ClientID %>', '');
}); 
```

最后，当您希望在回发完成时发生动画以显示其结果，您可以将所有这些与一个布尔变量结合使用，该变量在 pageLoad 函数中启用一个操作，如下所示：

```
var ShowDetailsOnLoad = false;

function pageLoad(sender, args) 
{
    if (args.get_isPartialLoad()) 
    {
        if (ShowDetailsOnLoad)
        {
            $("#Detail").fadeIn();
            ShowDetailsOnLoad = false;
        }

        $('DetailVisMaker').click(function() 
        {
            $("#Detail").fadeOut().promise().done(function () 
            {
                __doPostBack('<%= UpdatePanel1.ClientID %>', '');
                ShowDetailsOnLoad = true;
            });
        });
    }
} 
```

如果 div、HTML 和 UpdatePanel 设置正确，此代码将显示一个详细 div，当用户单击其中的链接时，它将淡出详细信息部分，运行回发，然后在何时淡入回传完成。

# .net - 如何将 Excel 序列日期编号转换为 .NET DateTime？

> ID：727466
> 
> 赞同：88
> 
> 时间：2009-04-07T20:31:46.807
> 
> 标签：.net, excel, datetime

如何从 excel 序列日期转换为 .NET 日期时间？

例如 39938 是 05/05/2009。

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2010-04-12T14:56:28.353

我发现使用[FromOADate 方法](http://msdn.microsoft.com/en-us/library/system.datetime.fromoadate.aspx)更简单，例如：

```
DateTime dt = DateTime.FromOADate(39938); 
```

使用此代码*dt*为“05/05/2009”。

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2009-04-07T20:37:34.093

39938 是自 1900 年 1 月 1 日以来的天数？

**在这种情况下，请使用框架库函数[`DateTime.FromOADate()`](http://msdn.microsoft.com/en-us/library/system.datetime.fromoadate.aspx)。**
该函数[封装](https://referencesource.microsoft.com/#mscorlib/system/datetime.cs,548)了所有细节，并进行边界检查。

对于它的历史价值，这里是一个可能的实现：

（C＃）

```
public static DateTime FromExcelSerialDate(int SerialDate)
{
    if (SerialDate > 59) SerialDate -= 1; //Excel/Lotus 2/29/1900 bug   
    return new DateTime(1899, 12, 31).AddDays(SerialDate);
} 
```

VB

```
Public Shared Function FromExcelSerialDate(ByVal SerialDate As Integer) As DateTime
    If SerialDate > 59 Then SerialDate -= 1 ' Excel/Lotus 2/29/1900 bug
    Return New DateTime(1899, 12, 31).AddDays(SerialDate)
End Function 
```

* * *

**[更新]：**
嗯...快速测试表明它实际上是两天假。不知道区别在哪里。

好的：问题现在解决了。有关详细信息，请参阅评论。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-13T09:15:39.190

对于 39938，请执行以下操作：39938 * 864000000000 + 599264352000000000

864000000000 表示一天中的滴答数 599264352000000000 表示从 0001 年到 1900 年的滴答数

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-12T13:15:07.080

```
void ExcelSerialDateToDMY(int nSerialDate, int &nDay, 
                          int &nMonth, int &nYear)
{
    // Excel/Lotus 123 have a bug with 29-02-1900\. 1900 is not a
    // leap year, but Excel/Lotus 123 think it is...
    if (nSerialDate == 60)
    {
        nDay    = 29;
        nMonth    = 2;
        nYear    = 1900;

        return;
    }
    else if (nSerialDate < 60)
    {
        // Because of the 29-02-1900 bug, any serial date 
        // under 60 is one off... Compensate.
        nSerialDate++;
    }

    // Modified Julian to DMY calculation with an addition of 2415019
    int l = nSerialDate + 68569 + 2415019;
    int n = int(( 4 * l ) / 146097);
            l = l - int(( 146097 * n + 3 ) / 4);
    int i = int(( 4000 * ( l + 1 ) ) / 1461001);
        l = l - int(( 1461 * i ) / 4) + 31;
    int j = int(( 80 * l ) / 2447);
     nDay = l - int(( 2447 * j ) / 80);
        l = int(j / 11);
        nMonth = j + 2 - ( 12 * l );
    nYear = 100 * ( n - 49 ) + i + l;
} 
```

剪切和粘贴别人的才能...

[伊恩·布朗](http://www.ianbrownphotography.co.uk)

# c# - C#中的代码好奇心

> ID：727469
> 
> 赞同：1
> 
> 时间：2009-04-07T20:32:32.810
> 
> 标签：c#, label, goto

我正在查看[YUI Compressor](http://yuicompressor.codeplex.com/SourceControl/ListDownloadableCommits.aspx)并在 ECMA.NET 项目中遇到了这段代码（如果您有兴趣，请继续阅读文件）。

```
protected internal override int FindPrototypeId (string s)
    {
        int id;
        #region Generated PrototypeId Switch
    L0: {
            id = 0;
            string X = null;
            if (s.Length == 11) { X = "constructor"; id = Id_constructor; }
            if (X != null && X != s && !X.Equals (s))
                id = 0;
        }
    EL0:
        #endregion
        return id;
    } 
```

我不知道 L0: 和 EL0: 在这里做什么，以前从未见过。这个词对谷歌来说似乎也太初级了。

有人知道这是什么一回事吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-07T20:35:31.587

它们看起来像用作 goto 目标的标签。有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/13940fs2.aspx](http://msdn.microsoft.com/en-us/library/13940fs2.aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-07T20:36:21.910

它们对我来说就像标签。这个例子中没有使用标签（因为它是生成的代码？），但可以用来跳转另一个地方。您可以使用`goto L0;`跳转第一个标签。例如，下面的代码只写了“Hello, World”，因为它跳过了中间`Write()`：

```
Console.Write("Hello, ");
goto Last;
Console.Write("Cruel ");
Last:
Console.WriteLine("World"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T20:36:28.260

这些是标签，就像在 GOTO 中一样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T20:42:44.750

它们显然是标签，但我不认为它们被用作 goto 目标。我想它们被设计为被某种代码生成工具识别。代码生成工具“拥有”L0 和 EL0 之间的代码，这可能只是意味着“结束 L0”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T20:38:45.573

L0 和 EL0 看起来像[goto 语句的标签](http://msdn.microsoft.com/en-us/library/13940fs2(VS.71).aspx)

# php - 如何获得当前语言环境的一周的第一天？(PHP / L8N)

> ID：727471
> 
> 赞同：6
> 
> 时间：2009-04-07T20:33:02.857
> 
> 标签：php, localization, internationalization

在大多数地区，一周的第一天是星期一。在美国（可能还有其他地方），这一周从星期日开始。

对于任意语言环境，如何在 PHP 中找出一周第一天（星期日或星期一）的当前设置？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-07T20:51:04.810

来自 CLDR 的[补充数据](https://github.com/unicode-org/cldr/blob/release-36/common/supplemental/supplementalData.xml#L4676-L4726)（2019 年 10 月第 36 版）：

```
<firstDay day="mon" territories="001 AD AI AL AM AN AR AT AX AZ BA BE BG BM BN BY CH CL CM CR CY CZ DE DK EC EE ES FI FJ FO FR GB GE GF GP GR HR HU IE IS IT KG KZ LB LI LK LT LU LV MC MD ME MK MN MQ MY NL NO NZ PL RE RO RS RU SE SI SK SM TJ TM TR UA UY UZ VA VN XK"/>
<firstDay day="fri" territories="MV"/>
<firstDay day="sat" territories="AE AF BH DJ DZ EG IQ IR JO KW LY OM QA SD SY"/>
<firstDay day="sun" territories="AG AS AU BD BR BS BT BW BZ CA CN CO DM DO ET GT GU HK HN ID IL IN JM JP KE KH KR LA MH MM MO MT MX MZ NI NP PA PE PH PK PR PT PY SA SG SV TH TT TW UM US VE VI WS YE ZA ZW"/>

<firstDay day="sun" territories="GB" alt="variant" references="Shorter Oxford Dictionary (5th edition, 2002)"/> 
```

（领土`001`是“世界”的[联合国 M49 区号）](https://en.wikipedia.org/wiki/UN_M49)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-17T03:38:51.777

在 shell（bash 或 sh 等）中运行此命令：

```
locale first_weekday 
```

在 PHP 中，调用一个进程在 sh 中运行此命令，并获取它的输出。在 Python 中，我做了这样的事情：

```
def getLocaleFirstWeekDay():
  return int(os.popen('locale first_weekday').read())-1 
```

# reporting-services - Reporting Services：使用链接报表中的表达式覆盖默认参数

> ID：727476
> 
> 赞同：3
> 
> 时间：2009-04-07T20:33:44.867
> 
> 标签：reporting-services, linked-list, parameter-passing, default, reportingservices-2005

所以我在SSRS 2005 中有一个“每日仪表板”报告。它有一个参数@pDate，默认为“=Now”。

我想在链接报告中使用相同的报告来显示昨天的最终仪表板（然后将通过订阅邮寄出去），并用另一个表达式“=dateadd(d,-1,Now) 覆盖参数默认值。 " 但是当我更改默认参数时，我得到一个数据不匹配错误（natch）。

我假设这是该行的结尾，我只需要使用昨天的默认@pDate 部署每日仪表板报告的副本，但我想我会在这里发布，看看是否有人有一些漂亮的捷径来完成这个无需维护两个 RDL。

更新：我在[MSDN](http://msdn.microsoft.com/en-us/library/ms189700.aspx)上找到了这个：

> 如果默认值接受一个值，您可以键入对报表使用的数据处理扩展有效的常量或语法。

“数据处理扩展”显然转换为 SQL 服务器，所以我尝试了不是常量的有效单例选择（GETDATE()、“04/27/”+YEAR(GETDATE()) 等），但仍然没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T20:39:02.310

所以我发现了我的问题：如果您的主报表中有子报表正在使用主报表中的传递参数，请**确保子报表中的所有参数都使用相同的数据类型**。我的两个子报表对@pDate 字段使用String 数据类型而不是DateTime，因此订阅失败（尽管由于某种原因，报表的实时版本可以容忍这种不一致。）

我现在正在使用数据驱动的订阅来动态设置@pDate，一切似乎都运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T08:03:06.603

我没有对此进行测试，但是您可以尝试在报告中添加第二个参数（没有默认值 -`pDateOverride`为了参数而调用它），然后将默认值更改为`pDate`使用新值（如果存在）的表达式，否则现在（）。就像是：

```
=Iif(IsEmpty(Parameters!pDateOverride.Value),Now(),Parameters!pDateOverride.Value) 
```

然后您可以`pDateOverride`在调用报表时设置生成昨天的最终仪表板。

# iphone - 你如何为数组设置@synthesize？

> ID：727477
> 
> 赞同：1
> 
> 时间：2009-04-07T20:33:46.333
> 
> 标签：iphone, objective-c, macos

如何为数组设置@synthesize，例如：float rgb[3]。另外，@property 行是：@property(nonatomic, assign) float rgb?? 谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T21:02:55.687

如果您希望将其用作属性，我不相信您可以在界面中定义数组大小。你需要做类似的事情：（请原谅任何语法错误，这是记忆中的）

```
@interface MyClass : NSObject {
    float *rgb;
}

@propery (nonatomic, assign) float *rgb; 
```

然后在您的实现中：

```
@implementation MyClass

@synthesize rgb;

@end 
```

然后您必须使用一些 C 函数来初始化指针，例如：

```
rgb = (float *)malloc(sizeof(float) * 3); 
```

# .net - LINQ - VB.net 中的编译查询

> ID：727496
> 
> 赞同：0
> 
> 时间：2009-04-07T20:37:58.617
> 
> 标签：.net, vb.net, linq, linq-to-sql

有人对 VB 的编译查询语法有经验吗？我在 C# 中使用过几次，但似乎无法进行翻译。我的代码如下：

```
#Region "Locals"
    'Data context objects '
    Private _dbOrderInfo As New OrderInfoDataContext
#End Region

#Region "Delegates"
    Public Shared ReadOnly Func(_dbOrderInfo, Boolean, IQueryable(Of SalesRep))
#End Region

#Region "Compiled Queries"
    Public Shared Function(Of _dbOrderInfo, boolean, IQueryable(Of SalesRep)) _      
                        SalesRepsByStatus = CompiledQuery.Compile( _
                            Function(db As _dbOrderInfo, active As Boolean) _
                            From sr In db.tblSU4SalesRep Where sr.Active = active)
    End Function
#End Region 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T14:38:20.773

在您的代码中，您似乎`_dbOrderInfo`在方法参数中引用实例而不是 type `(OrderInfoDataContext)`。通过引用类型来查看它是否有效。另外，你可能想看看[这个](http://www.thinqlinq.com/Default/LINQ-to-SQL-Compiled-Queries.aspx)

# asp.net - 如何让 jqGrid 在后端使用 ASP.NET + JSON 工作？

> ID：727502
> 
> 赞同：7
> 
> 时间：2009-04-07T20:39:49.593
> 
> 标签：asp.net, javascript, jquery, json, jqgrid

好的，我回来了。我将问题完全简化为三个简单的字段，但使用 addJSONData 方法仍然停留在同一行。我已经坚持了好几天了，无论我如何修改 ajax 调用、json 字符串、等等等等，我都无法让它工作！手动添加一行数据时，我什至无法让它作为一个函数工作。任何人都可以发布一个适用于 ASP.NET 和 JSON 的 jqGrid 工作示例吗？请包含 2-3 个字段（最好是字符串、整数和日期？）我很高兴看到 jqGrid 的工作示例以及使用 addJSONData 方法手动添加 JSON 对象。非常感谢！！如果我得到这个工作，我将发布一个完整的代码示例，以获取 ASP.NET 的帮助，JSON 用户也坚持这一点。再次。谢谢！！

tbl.addJSONData(objGridData); //err: tbl.addJSONData 不是函数！！

这是我收到此消息时 Firebug 显示的内容：

• objGridData 对象总计=1 页=1 记录=5 行=[5]
○ 页“1”
记录“5”
共“1”
行[对象 ID=1 PartnerID=BCN，对象 ID=2 PartnerID=BCN，对象 ID =3 PartnerID=BCN, 2 more... 0=Object 1=Object 2=Object 3=Object 4=Object]
(index) 0
(prop) ID (value) 1 (prop) PartnerID (value) "BCN" ( prop) DateTimeInserted (value) Thu May 29 2008 12:08:45 GMT-0700 (Pacific Daylight Time)
* 还有三行

这是变量 tbl (value) 'Table.scroll' 的值

```
<TABLE cellspacing="0" cellpadding="0" border="0" style="width: 245px;" class="scroll grid_htable"><THEAD><TR><TH class="grid_sort grid_resize" style="width: 55px;"><SPAN> </SPAN><DIV id="jqgh_ID" style="cursor: pointer;">ID <IMG src="http://localhost/DNN5/js/jQuery/jqGrid-3.4.3/themes/sand/images/sort_desc.gif"/></DIV></TH><TH class="grid_resize" style="width: 90px;"><SPAN> </SPAN><DIV id="jqgh_PartnerID" style="cursor: pointer;">PartnerID </DIV></TH><TH class="grid_resize" style="width: 100px;"><SPAN> </SPAN><DIV id="jqgh_DateTimeInserted" style="cursor: pointer;">DateTimeInserted </DIV></TH></TR></THEAD></TABLE> 
```

这是完整的功能：

```
 $('table.scroll').jqGrid({  
    datatype: function(postdata) {    
        mtype: "POST",    
    $.ajax({  
        url: 'EDI.asmx/GetTestJSONString',  
        type: "POST",  
        contentType: "application/json; charset=utf-8",  
        data: "{}",  
        dataType: "text", //not json . let me try to parse  
        success: function(msg, st) {  
            if (st == "success") {                    
                 var gridData;  

                //strip of "d:" notation  
                var result = JSON.parse(msg);   
                for (var property in result) {  
                    gridData = result[property];  
                    break;  
                }  

                var objGridData = eval("(" + gridData + ")"); //creates an object with visible data and structure  
                var tbl = jQuery('table.scroll')[0];  

                alert(objGridData.rows[0].PartnerID); //displays the correct data  

                //tbl.addJSONData(objGridData); //error received: addJSONData not a function  

                //error received: addJSONData not a function (This uses eval as shown in the documentation)  
                //tbl.addJSONData(eval("(" + objGridData + ")"));   

                //the line below evaluates fine, creating an object and visible data and structure  
                //var objGridData = eval("(" + gridData + ")");  
                //BUT, the same thing will not work here  
                //tbl.addJSONData(eval("(" + gridData + ")"));  
                //FIREBUG SHOWS THIS AS THE VALUE OF gridData:  
               // "{"total":"1","page":"1","records":"5","rows":[{"ID":1,"PartnerID":"BCN","DateTimeInserted":new Date(1214412777787)},{"ID":2,"PartnerID":"BCN","DateTimeInserted":new Date(1212088125000)},{"ID":3,"PartnerID":"BCN","DateTimeInserted":new Date(1212088125547)},{"ID":4,"PartnerID":"EHG","DateTimeInserted":new Date(1235603192033)},{"ID":5,"PartnerID":"EMDEON","DateTimeInserted":new Date(1235603192000)}]}"         

            }  
        }  
    });  
    },  
    jsonReader: {  
        root: "rows", //arry containing actual data  
        page: "page", //current page  
        total: "total", //total pages for the query  
        records: "records", //total number of records  
        repeatitems: false,  
        id: "ID" //index of the column with the PK in it   
    },  
    colNames: [  
        'ID', 'PartnerID', 'DateTimeInserted'  
          ],    
    colModel: [    
    { name: 'ID', index: 'ID', width: 55 },    
    { name: 'PartnerID', index: 'PartnerID', width: 90 },  
    { name: 'DateTimeInserted', index: 'DateTimeInserted', width: 100}],  
    rowNum: 10,  
    rowList: [10, 20, 30],  
    imgpath: 'http://localhost/DNN5/js/jQuery/jqGrid-3.4.3/themes/sand/images',  
    pager: jQuery('#pager'),  
    sortname: 'ID',  
    viewrecords: true,  
    sortorder: "desc",  
   caption: "TEST Example")}; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-08-10T14:36:59.310

这是一个简单的例子......

您将需要[https://github.com/douglascrockford/JSON-js/blob/master/json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js) 才能使其工作...

当然还有通常的 jquery 文件。

将此粘贴到网络服务

```
// The lower case properties here are required to be lower case
// I cant find a way to rename them when they are serialized to JSON
// XmlElement("yournamehere") does not work for JSON :(
public class JQGrid
{
    public class Row
    {
        public int id { get; set; }
        public List<string> cell { get; set; }

        public Row()
        {
            cell = new List<string>();
        }
    }

    public int page { get; set; }
    public int total { get; set; }
    public int records { get; set; }
    public List<Row> rows { get; set; }

    public JQGrid()
    {
        rows = new List<Row>();
    }
}

[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[ScriptService]
public class MyWebService : System.Web.Services.WebService
{

    [WebMethod(EnableSession = true)]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]    
    public JQGrid GetJQGrid(int page, int pageSize, string sortIndex, string sortDirection)
    {
        DataSet ds = SqlHelper.ExecuteDataset(SqlHelper.CONN_STRING, "udsp_GetMyData",pageIndex, pageSize);

        if (ds == null || ds.Tables.Count < 1)
            throw new Exception("Unable to retrieve data.");

        JQGrid jqGrid = new JQGrid();

        int i = 1;
        foreach (DataRow dataRow in ds.Tables[0].Rows)
        {
            JQGrid.Row row = new JQGrid.Row();

            row.id = Convert.ToInt32(dataRow["MyIdColumn"]);

            row.cell.Add(dataRow["MyIdColumn"].ToString());

            row.cell.Add(dataRow["MyColumn"].ToString());

            projectGrid.rows.Add(row);
        }

        jqGrid.page = 1; // Set this when you are actually doing paging... this is just a sample
        jqGrid.records = jqGrid.rows.Count;
        jqGrid.total = jqGrid.rows.Count;  // Set this to total pages in your result...

        return jqGrid;
    }
} 
```

将此粘贴到您的 aspx 页面

```
<script type="text/javascript">
function getData(pdata) {
    var params = new Object();
    params.page = pdata.page;
    params.pageSize = pdata.rows;
    params.sortIndex = pdata.sidx;
    params.sortDirection = pdata.sord;

    $.ajax({
        type: "POST",
        contentType: "application/json; charset=utf-8",
        url: "/CLM/CLM.asmx/GetProjectGrid2",
        data: JSON.stringify(params),
        dataType: "json",
        success: function(data, textStatus) {
            if (textStatus == "success") {
                var thegrid = $("#testGrid")[0];
                thegrid.addJSONData(data.d);
            }
        },
        error: function(data, textStatus) {
            alert('An error has occured retrieving data!');
        }
    });
}

var gridimgpath = '/clm/css/ui-lightness/images';
$(document).ready(function() {
    $("#testGrid").jqGrid({
        datatype: function(pdata) {
            getData(pdata);
        },
        colNames: ['My Id Column', 'My Column'],
        colModel: [
            { name: 'MyIdColumn', index: 'MyIdColumn', width: 150 },
            { name: 'My Column', index: 'MyColumn', width: 250 }
        ],
        rowNum: 10,
        rowList: [10, 20, 30],
        imgpath: gridimgpath,
        pager: jQuery('#pagerdt'),
        sortname: 'id',
        viewrecords: false,
        sortorder: "desc",
        caption: "Projects",
        cellEdit: false
    });
});
</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-28T20:27:06.940

通常，当您使用 jqGrid 收到“blah not a function”错误时，这是​​因为尚未加载正确的模块。addJSONData 函数在 grid.base.js 文件中定义。您可以检查 jquery.jqGrid.js 文件中的 jqGridInclude() 函数并确保 grid.base.js 被包含在模块变量的初始化中吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T20:52:23.853

好吧，我在这里看到一件事不对：

```
var tbl = jQuery('table.scroll')[0];  
 //tbl.addJSONData(objGridData); //error received: addJSONData not a function 
```

如果您确实想知道为什么会收到此错误，那是因为 tbl 没有该功能。

编辑：我很好奇，并检查了 jqGrid 是否将这些方法添加到 DOM 引用对象中。他们做到了。（我在这里使用萤火虫检查：http: [//trirand.com/jqgrid/jqgrid.html](http://trirand.com/jqgrid/jqgrid.html)）。

这里可能发生的一件事是您有多个“滚动”类表，并且您的 jquery 返回了错误的表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T20:57:00.957

您是否验证过 tbl 变量正在引用您的 jqgrid 实例？

尝试向您的表格元素添加一个 id 并获取对 jqgrid 的引用，例如：

```
var thegrid = jQuery("#mytableid")[0]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-09T22:36:03.080

也许在堆栈溢出上发布的这段代码中有一些帮助？ [jqgrid 与 asp.net webmethod 和 json 一起使用排序、分页、搜索和 LINQ——但需要动态运算符](https://stackoverflow.com/questions/2413032/jqgrid-asp-net-json-webmethod-working-example-with-sorting-and-paging-and-linq)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-01T05:18:13.507

由于我们有很多关于 ASP.NET WebForms 和 jqGrid 的问题，我们决定采用“组件”方式并实现与 asp:GridView 非常相似的东西。这样，您可以使用熟悉的 ASP.NET 页面生命周期、事件、数据源等来控制 jqGrid。

您可以在此处在线查看 Beta 版 - 目前提供 30 多个示例：

[http://www.trirand.net/demo.aspx](http://www.trirand.net/demo.aspx)

如果对此感兴趣，它很可能也将发展为商业产品（将提供开源许可证）。同时，您可以使用 Reflector 来查看源代码以供参考（直到我们想办法让源代码在线可用）。我们在 ASP.NET 上使用 SVN，而不是在 js Core 上使用 gitHub，所以我们在这个方向上做了一些工作。

我们希望这对社区有所帮助。

Rumen Stankov Trirand

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-03T16:38:31.023

这是一个非常古老的问题，但是，我最近遇到了同样的问题。我在尝试开始的新博客上发布了我是如何实现这一目标的。

可能有更清洁的方法可以做到这一点，但这对我有用。到目前为止，我已经能够相当容易地从这个示例进行扩展。我的下一个障碍是让负载开始工作。

你可以在这里找到我的例子：

[http://programming.webdad3.com/?p=3](http://programming.webdad3.com/?p=3)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-14T05:45:27.277

WebForm 正在消亡，因此我们需要关注最新的技术，例如 asp.net MVC。我在这里找到了一个新的 asp.net jQGrid 集成[http://www.techdoubts.net/2017/05/full-integration-dynamic-jqgrid-asp-net-mvc.html](http://www.techdoubts.net/2017/05/full-integration-dynamic-jqgrid-asp-net-mvc.html)

# python - 如何将 Unicode 转换为大写进行打印？

> ID：727507
> 
> 赞同：38
> 
> 时间：2009-04-07T20:41:46.517
> 
> 标签：python, unicode, python-2.x, case-sensitive, uppercase

我有这个：

```
>>> print 'example'
example
>>> print 'exámple'
exámple
>>> print 'exámple'.upper()
EXáMPLE 
```

我需要做的打印：

```
EXÁMPLE 
```

*（“a”的重音是大写的。）*

我正在使用 Python 2.6。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-04-07T20:45:53.403

我认为这就像**不**先转换为 ASCII 一样简单。

```
 >>> print u'exámple'.upper()
 EXÁMPLE 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-07T21:00:48.157

在 python 2.x 中，只需在调用 upper() 之前将字符串转换为 unicode。使用您在此网页上采用 utf-8 格式的代码：

```
>>> s = 'exámple'
>>> s
'ex\xc3\xa1mple'  # my terminal is not utf8\. c3a1 is the UTF-8 hex for á
>>> s.decode('utf-8').upper()
u'EX\xc1MPLE'  # c1 is the utf-16 aka unicode for á 
```

调用`decode`将其从当前格式转换为 unicode。然后，您可以使用 encode 将其转换为其他格式，例如 utf-8。如果字符在 iso-8859-2 中（在这种情况下是捷克语等），您将改为使用`s.decode('iso-8859-2').upper()`.

就我而言，如果您的终端不符合 unicode/utf-8 标准，那么您最好的希望是字符的十六进制表示（如我的）或使用 进行有损转换`s.decode('utf-8').upper().encode('ascii', 'replace')`，这会导致 'EX?MPLE' . 如果您无法让终端显示 unicode，请将输出写入 utf-8 格式的文件，然后在您喜欢的编辑器中打开它。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-09-11T16:52:59.607

首先，这些天我只使用 python 3.1；它的核心优点是从 unicode 对象中消除歧义的字节字符串。这使得绝大多数文本操作比以前更安全。考虑到关于 python 2.x 编码问题的数万亿用户问题，`u'äbc`python 2.1 的约定只是一个错误；有了明确的`bytes`and `bytearray`，生活变得容易多了。

其次，如果 py3k 不是你的口味，那么尝试使用`from __future__ import unicode_literals`，因为这将模仿 py3k 在 python 2.6 和 2.7 上的行为。这件事可以避免你在说`print 'exámple'.upper()`. 本质上，这与 py3k: 中的相同`print( 'exámple'.encode( 'utf-8' ).upper() )`。比较这些版本（对于 py3k）：

```
print( 'exámple'.encode( 'utf-8' ).upper() )
print( 'exámple'.encode( 'utf-8' ).upper().decode( 'utf-8' ) )
print( 'exámple'.upper() ) 
```

第一个基本上是你在使用裸字符串时所做的`'exámple'`，前提是你将默认编码设置为`utf-8`（根据 BDFL 声明，在运行时设置默认编码是一个坏主意，所以在 py2 中你必须通过说来欺骗它`import sys; reload( sys ); sys.setdefaultencoding( 'utf-8' )`；我在下面为 py3k 提出了一个更好的解决方案）。当您查看这三行的输出时：

```
b'EX\xc3\xa1MPLE'
EXáMPLE
EXÁMPLE 
```

您可以看到，当`upper()`应用于第一个文本时，它作用于字节，而不是字符。python 允许`upper()`在字节上使用该方法，但它仅在字节的 US-ASCII 解释上定义。由于 utf-8 使用8 位*以内但在 US-ASCII**之外*的值（128 到 255，US-ASCII 不使用），因此不会受到 影响`upper()`，所以当我们在第二行解码时，我们得到那个小写字母`á`。最后，第三行做对了，是的，令人惊讶的是，python 似乎知道这`Á`是对应于 . 的大写字母`á`。我进行了快速测试以查看 python 3 不会在大小写之间转换的字符：

```
for cid in range( 3000 ):
  my_chr = chr( cid )
  if my_chr == my_chr.upper() and my_chr == my_chr.lower():
    say( my_chr ) 
```

仔细阅读该列表会发现很少出现拉丁文、西里尔文或希腊文字母；大部分输出是非欧洲字符和标点符号。我能发现 python 出错的唯一字符是 Ԥ /看看那些，他们可能会产生惊喜），你可能真的会使用那个方法。当然，我没有检查映射的正确性。

最后，这是我放入 py3k 应用程序启动部分的内容：一种重新定义编码的方法`sys.stdout`，使用数字字符引用 (NCR) 作为后备；这意味着打印到标准输出将永远不会引发 unicode 编码错误。当我在 ubuntu 上工作时，`_sys.stdout.encoding`是`utf-8`；当同一个程序在 Windows 上运行时，它可能会像`cp850`. 输出可能看起来很奇怪，但应用程序运行时不会在那些愚蠢的终端上引发异常。

```
#===========================================================================================================
# MAKE STDOUT BEHAVE IN A FAILSAFE MANNER
#-----------------------------------------------------------------------------------------------------------
def _harden_stdout():
  """Ensure that unprintable output to STDOUT does not cause encoding errors; use XML character references
  so any kind of output gets a chance to render in a decipherable way."""
  global _sys_TRM
  _sys.stdout       = _sys_TRM = _sys_io.TextIOWrapper(
    _sys.stdout.buffer,
    encoding        = _sys.stdout.encoding,
    errors          = 'xmlcharrefreplace',
    line_buffering  = true )
#...........................................................................................................
_harden_stdout() 
```

还有一条建议：在测试时，总是尝试`print repr( x )`或类似的事情来揭示`x`. `print x`如果您只是在 py2 中并且`x`是八位字节字符串或 unicode 对象，则可能会出现各种误解。这是非常令人费解的，容易引起很多头疼。正如我所说，尝试至少从未来的导入 unicode 文字咒语中转移到 py26。

[最后引用一句名言：“Glyph Lefkowitz 在他的文章Encoding](http://glyf.livejournal.com/39250.html)中说得最好：

> 我相信在这个讨论的上下文中，术语“字符串”是没有意义的。有文本，还有面向字节的数据（可能很好地表示文本，但尚未转换为文本）。在 Python 类型中，Text 是 unicode。数据是str。“非 Unicode 文本”的想法只是一个等待发生的编程错误。”

更新：刚刚发现 python 3 在大写时正确地将 ſ LATIN SMALL LETTER LONG S 转换为 S。整洁的！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-07T23:09:10.127

我认为我们在这里缺少一些背景知识：

```
>>> type('hello')
<type 'str'>

>>> type(u'hello')
<type 'unicode'> 
```

只要您使用“unicode”字符串而不是“native”字符串，像 upper() 这样的运算符就会在使用 unicode 的情况下进行操作。FWIW，Python 3 默认使用 unicode，使得区别在很大程度上无关紧要。

从`unicode`to 获取字符串`str`然后再返回 to`unicode`在许多方面都不是最理想的，如果您需要，许多库会生成 unicode 输出；因此，请尽可能在`unicode`内部仅使用对象作为字符串。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-03-31T08:09:03.563

尝试一下：

```
s = 'exámple'
print unicode(s).upper() 
```

# c# - 一元加号运算符有什么作用？

> ID：727516
> 
> 赞同：91
> 
> 时间：2009-04-07T20:44:43.857
> 
> 标签：c#, c++, c, unary-operator

一元加号运算符有什么作用？我找到了几个定义（[here](https://web.archive.org/web/20130511040723/http://msdn.microsoft.com/en-us/library/aa691365(VS.71).aspx)和[here](https://web.archive.org/web/20160222192353/http://www.csharp-station.com/Tutorials/Lesson02.aspx)），但我仍然不知道它的用途。看起来它什么也没做，但这是有原因的，对吧？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2010-10-11T02:07:07.233

实际上，一元加号*确实*做了一些事情——即使在 C 中也是如此。它对操作数执行*[通常的算术转换](http://msdn.microsoft.com/en-us/library/3t4w2bkb%28VS.80%29.aspx)*并返回一个新值，该值可以是更大宽度的整数。如果原始值是一个宽度小于 的无符号整数`int`，它也会被更改为一个`signed`值。

通常这不是那么重要，但它*会*产生影响，因此使用一元加号作为一种表示整数为正的“注释”*并不是一个好主意。*考虑以下 C++ 程序：

```
void foo(unsigned short x)
{
 std::cout << "x is an unsigned short" << std::endl;
}

void foo(int x)
{
 std::cout << "x is an int" << std::endl;
}

int main()
{
 unsigned short x = 5;
 foo(+x);
} 
```

这将显示“x is an int”。

所以在这个例子中，一元加号创建了一个具有不同类型*和*符号的新值。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2009-04-07T20:45:58.160

如果您觉得需要，它就会超载；对于所有预定义类型，它本质上是无操作的。

无操作一元算术运算符的实际用途非常有限，并且往往与在算术表达式中使用值的结果有关，而不是与运算符本身有关。例如，它可用于强制从较小的整数类型扩展为`int`，或确保表达式的结果被视为右值，因此与非`const`引用参数不兼容。然而，我认为这些用途比可读性更适合编码高尔夫。:-)

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2011-09-30T14:07:20.420

来自 K&R 第二版：

> 一元 + 是 ANSI 标准的新符号。添加它是为了与一元 - 对称。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2009-04-07T20:56:28.447

我已经看到它用于清晰，强调正值与负值不同：

```
shift(+1);
shift(-1); 
```

但这是一个相当弱的用途。答案肯定是超载。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2010-10-11T03:58:39.190

内置一元`+`所做的一件事是将左值转换为右值。例如，您可以这样做

```
int x;
&x; 
```

但你不能这样做

```
&+x; 
```

:)

PS“重载”绝对不是正确的答案。一元`+`是从 C 继承的，C 中没有用户级运算符重载。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2010-10-11T03:42:20.827

一元 + 完成的主要事情是将小于 int 数据类型的类型提升为 int。如果您尝试使用`std::cout`数字数据打印 char 数据，这将非常有用。

```
char x = 5;
std::cout << +x << "\n"; 
```

与

```
char x=5;
std::cout << x << "\n"; 
```

它也可用于重载，但实际上您的重载*应该*几乎是 NOP。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2012-08-05T00:59:44.637

如果您出于调试或任何原因需要打印原始字节的数值（例如，存储为 char 的小数），一元 + 可以简化打印代码。考虑

```
char c = 42;
cout << c << endl;           // prints "*\n", not what you want in this case
cout << (int)c << endl;      // prints "42\n", ok
cout << +c << endl;          // prints "42\n", much easier to type 
```

这只是一个简单的例子。我确信在其他时候一元 + 可以帮助您将字节更像数字而不是文本。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-07-16T02:39:54.947

一个历史花絮。C99 标准化委员会还认为一元加法的现有用途相当少见，他们考虑重用它以实现语言中的另一个特性就证明了这一点：抑制浮点常量表达式的翻译时求值。请参阅 C 基本原理，第 F.7.4 节中的以下引用：

> 该规范的早期版本允许翻译时常量算术，但授权一元 + 运算符，当应用于操作数时，禁止常量表达式的翻译时求值。

最后，语义被颠倒了，在大多数上下文中强制执行运行时评估（至少达到“好像”规则），并且能够通过使用静态初始化器来强制执行翻译时评估。请注意，主要区别在于浮点异常的发生以及其他浮点舍入或精度设置（如果存在）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-10T17:05:23.257

不多。允许重载的一般论点`operator+()`是，重载肯定有现实世界的用途，如果你允许重载但不允许重载`operator-()`，那将是*非常*奇怪的（或不对称的） 。`operator-()``operator+()`

*我相信我首先从 Stroustrop 那里读到了这个论点，但我没有我的书来验证它。我可能错了。*

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-10T17:53:41.173

一元加号出现在 C 中，它完全没有做任何事情（很像`auto`关键字）。为了不拥有它，Stroustrup 将不得不引入与 C 的无缘无故的不兼容。

一旦它出现在 C++ 中，就很自然地允许重载函数，就像一元减法一样，如果它还没有的话，Stroustrup 可能会因为这个原因引入它。

所以，没什么意思。它可以用作一种装饰，使事物看起来更对称，例如使用 +1.5 与 -1.5 相反。在 C++ 中，它可以被重载，但如果`operator+()`做任何事情会令人困惑。记住标准规则：当重载算术运算符时，像`int`s 那样做。

如果您正在寻找它存在的原因，请查找有关 C 早期历史的一些信息。我怀疑没有充分的理由，因为 C 并不是真正设计的。考虑无用`auto`关键字（可能与`static`，现在在 C++0x 中被回收）和`entry`关键字，它从来没有做任何事情（后来在 C90 中被省略）。有一封著名的电子邮件，Ritchie 或 Kernighan 说，当他们意识到运算符优先级存在问题时，已经有 3 个安装有数千行代码，他们不想破坏。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-10T18:04:51.333

我不能为此引用任何来源，但我已经明白它是用于显式类型提升，这意味着无损类型转换。这使它位于转换层次结构的顶部，

*   **晋升：** `new_type operator+(old_type)`
*   **转换：** `new_type(old_type)`
*   **投掷：** `operator(new_type)(old_type)`
*   **强迫：** `new_type operator=(old_type)`

当然，这是我对大约 15 年前阅读的一本微软（非常老的）c/c++ 手册中的注释的解释，因此请谨慎对待。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-03-29T23:20:29.670

```
#include <stdio.h>
int main()
{
    unsigned short x = 5;
    printf ("%d\n",sizeof(+x)); 
    printf ("%d\n",sizeof(x)); 
    return 0;
} 
```

如上例所示，一元 + 确实改变了类型，大小分别为 4 和 2。奇怪的是表达式 +x 确实是在 sizeof 中计算的，我认为这不应该。也许是因为 sizeof 与一元 + 具有相同的优先级。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-04-07T20:49:23.097

**编辑**完全重写，因为我在我原来的答案中很糟糕。

这应该允许您将类型的显式声明处理为正值（我认为主要是非数学运算）。似乎否定会更有用，但我想这是一个可能会产生影响的例子：

```
public struct Acceleration
{
    private readonly decimal rate;
    private readonly Vector vector;

    public Acceleration(decimal rate, Vector vector)
    {
        this.vector = vector;
        this.rate = rate;
    }

    public static Acceleration operator +(Acceleration other)
    {
        if (other.Vector.Z >= 0)
        {
            return other;
        }
        return new Acceleration(other.Rate, new Vector(other.vector.X, other.Vector.Y, -other.vector.Z));
    }

    public static Acceleration operator -(Acceleration other)
    {
        if (other.Vector.Z <= 0)
        {
            return other;
        }
        return new Acceleration(other.Rate, new Vector(other.vector.X, other.Vector.Y, -other.vector.Z));
    }

    public decimal Rate
    {
        get { return rate; }
    }

    public Vector Vector
    {
        get { return vector; }
    }
} 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-04-07T20:52:18.037

我想您可以使用它来始终使数字为正数。只需将一元 + 运算符重载为 abs。真的不值得混淆你的开发者伙伴，除非你真的只是想混淆你的代码。然后它会很好地工作。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2019-11-08T04:39:29.020

只是用来说服哪些数字是正数的

例如;

```
int a=10;
System.out.println(+x);// prints 10(that means,that number 10 multiply by +1,{10*+1})

//if we use unary minus

int a=10;
System.out.println(-x);//prints -10(that means,that number 10 multiply by +1,{10*-1}) 
```

# mysql - MySQL 集合存储

> ID：727520
> 
> 赞同：1
> 
> 时间：2009-04-07T20:46:13.870
> 
> 标签：mysql, recursion, set, normalization

我在用 PHP 编码的 Web 应用程序中有几个表，我想知道这是否是一个好的做法。

```
CREATE TABLE `products`(
  `product_id` int NOT NULL auto_increment,
  `name` varchar(255) NOT NULL,
  `variations` varchar(255) default NULL,
  PRIMARY KEY  (`product_id`)
)

CREATE TABLE `variations`(
  `variation_id` int NOT NULL auto_increment,
  `name` varchar(255) NOT NULL,
  `kind` varchar(255) default NULL,
  PRIMARY KEY  (`variation_id`)
) 
```

例如，产品将是：

```
1,'Cup','1,2,3' 
```

虽然变化是：

```
1,'Green','Color'
2,'Glass','Texture'
3,'Blue','Color' 
```

这样许多产品可以具有相同的颜色/纹理。我发现的问题是我无法将其放入将数据返回为的单个查询中：

```
1,'Cup','1,Green,Color-2,Glass,Texture-3,Blue,Color' 
```

然后相应地解析它以显示每个变化的图像。

返回该格式的存储函数是最好的主意吗？或者我应该进一步规范化，如果是这样，如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-07T20:49:26.887

我相信明智的做法是添加另一个表：

```
CREATE TABLE `products_variations`(
  `product_id` int NOT NULL,
  `variation_id` int NOT NULL,
  PRIMARY KEY  (`product_id`, `variation_id`)
); 
```

从那里，连接三个表的简单查询将为您提供所需的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T20:51:03.890

```
SELECT  GROUP_CONCAT(variation_id, ', ', name, ', ', kind SEPARATOR '-')
FROM    products
INNER JOIN
        variations
ON      FIND_IN_SET(variation_id, variations)
GROUP BY
        product_id 
```

由于是多对多关系，最好有第三张表：

```
CREATE TABLE product_variations
(
   product_id INT NOT NULL,
   variation_id INT NOT NULL,
   PRIMARY KEY (product_id, variation_id)
); 
```

# javascript - 如何获取空的href查询参数？

> ID：727522
> 
> 赞同：3
> 
> 时间：2009-04-07T20:47:46.767
> 
> 标签：javascript, regex

我需要一个函数来仅获取空的 href 查询参数名称，以便稍后用另一个数组中的值替换它们。经过数小时的正则表达式失败后，我采取了以下措施：

```
/**
* getEmptyQueryParams(URL)
* Input: URL with href params
* Returns an array containing all empty href query parameters.
*/
function getEmptyQueryParams(URL)
{

    var params = new Array( );
    var non_empty_params = new Array( );
    var regex = /[\?&]([^=]+)=/g; // gets all query params
    var regex2 = /[\?&]([a-zA-Z_]+)=[\w]/g; // gets non empty query params 

    while( ( results = regex.exec( URL ) ) != null )
    {
        params.push( results[1] );
    }
    while( ( results = regex2.exec( URL ) ) != null )
    {
        non_empty_params.push( results[1] );
    }
    while(non_empty_params.length > 0)
    {
        for(y=0;y < params.length;y++)
        {
            if(params[y] == non_empty_params[0])
            {
                params.splice(y,1);
            }
        }
        non_empty_params.shift();
    }
    return params;
} 
```

它有效，但看起来很难看......有没有更好的方法来做到这一点？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T21:08:08.717

我刚刚测试了这在我现在打开的两个浏览器 Opera 和 Chrom 中是否有效：

```
function getEmptyQueryParams(URL)
{
    var params = new Array();
    var regex = /[\?&]([^=]+)=(?=$|&)/g; // gets non empty query params
    while( ( results = regex.exec( URL ) ) != null )
    {
        params.push( results[1] );
    }

    return params;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T21:00:00.590

我想你可以用一个匹配空和填充参数的正则表达式来做到这一点。

```
var regex = /[\?&]([a-zA-Z_]+)=([\w]*)/g;

while( ( results = regex.exec( URL ) ) != null )
{
    if (results[2] == '')
        params.push( results[1] );
} 
```

当然要测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T21:02:53.487

```
$parsedUrl = parse_url($url);
$query = $parsedUrl['query'];
$params = 数组（）；
parse_str($query, $params);

$emptyParamNames = 数组（）；
foreach ($params as $k=>$v) {
    如果 ($v === "")
        $emptyParamNames[] = $k;
}

```

编辑：

呵呵...认为这是出于某种原因标记为 PHP。

好吧，也许有一天它会使某人受益:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T21:04:07.290

```
function get_url_params($url) {
    $out = array();
    $parse = parse_url($url, PHP_URL_QUERY);
    if($parse) {
        foreach(explode('&', $parse) as $param) {
            $elems = explode('=', $param, 2);
            $out[$elems[0]] = $elems[1];
        }
    }
    return $out;
}

function get_empty_url_params($url) {
    $out = array();
    foreach(get_url_params($url) as $key => $value)
        if(empty($value))
            $out[] = $key;
    return $out;
} 
```

# java - 用于编码约定和分析 HTML、CSS、Javascript 客户端代码的工具

> ID：727528
> 
> 赞同：1
> 
> 时间：2009-04-07T20:49:28.293
> 
> 标签：java, javascript, html, css, conventions

我使用各种代码检查器进行 Java 开发，但我没有使用过一种用于 HTML。CSS，Javascript。

是否存在。该标记不良做法或类似工具。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-07T20:59:48.267

W3C 有一个用于验证 (X)HTML的[标记验证服务。](http://validator.w3.org/)

此外，W3C 有工具：

*   对于[CSS](http://jigsaw.w3.org/css-validator/)
*   对于[Atom 和 RSS](http://validator.w3.org/feed/)提要

JSLint是一个检查 JavaScript 的工具[。](http://www.jslint.com/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-07T20:54:37.687

带有 Yahoo 的 YSlow 插件的 Firebug 在指出您的低效率方面非常有效。

还可以尝试使用 web 开发者插件并点击 ctrl+shift+a - 它会将您的*本地*代码直接加载到 w3c 验证器中。

阅读 508C 合规性 - 您无法对其进行测试，但很高兴知道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T21:05:28.037

你是说类似 lint 的工具吗？

### JavaScript

*   [JavaScript Lint](http://javascriptlint.com/index.htm)看起来可能很有用。

    > 使用 JavaScript Lint，您可以检查所有 JavaScript 源代码中的常见错误，而无需实际运行脚本或打开网页。
    > 
    > JavaScript Lint 比竞争对手的 lint 具有优势，因为它基于 Firefox 浏览器的 JavaScript 引擎。这提供了一个强大的框架，它不仅可以检查 JavaScript 语法，还可以检查脚本中使用的编码技术并警告有问题的做法。

*   [JSLint](http://www.jslint.com/)是同一种东西。

    > JSLint 获取一个 JavaScript 源并对其进行扫描。如果它发现问题，它会返回一条描述问题的消息以及源中的大致位置。问题不一定是语法错误，尽管它经常是。
    > JSLint 着眼于一些样式约定以及结构问题。它并不能证明你的程序是正确的。它只是提供了另一组眼睛来帮助发现问题。

### HTML

*   [HTML::Lint](http://search.cpan.org/dist/HTML-Lint/)，一个 Perl 模块（[perldocs](http://search.cpan.org/%7Epetdance/HTML-Lint-2.06/lib/HTML/Lint.pm)和[example](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5267767.html)）
*   [W3 验证器](http://validator.w3.org/)

### CSS

*   [CSSCheck](http://htmlhelp.com/tools/csscheck/)（尽管它自 2005 年以来就没有更新过）
*   [CSS 的 W3 验证器](http://jigsaw.w3.org/css-validator/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T21:40:50.650

[Emacs 的 js2-mode](http://code.google.com/p/js2-mode/)将在您编辑代码时捕获并突出显示一些常见的 Javascript 错误。它不像外部 lint 工具那样彻底，但它的反馈更直接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T22:04:22.637

[Firebug](http://www.getfirebug.com) with [CodeBurner](http://tools.sitepoint.com/codeburner/)为您的 HTML 和 CSS 提供参考资料。您无需离开页面即可快速查找 HTML 元素、属性和 CSS 属性。

# uml - 如何自动化 RSM 图中的“最后修改”文本字段？

> ID：727537
> 
> 赞同：0
> 
> 时间：2009-04-07T20:51:19.550
> 
> 标签：uml

我的团队正在使用 Rational Software Modeler 来构建一些 UML 图。每个图表都有一个小文本框，说明人类可读的标题、最后修改日期和有关图表的一些其他信息。

有没有办法自动保持上次修改日期为最新？也许是一个宏？还是Eclipse的某种插件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-18T04:42:43.717

您当然可以在保存图表时随时更新此信息。插件将执行此操作。该解决方案将是 GMF 和 EMF（UML 生态模型）解决方案。我编写了一个类似的插件来监听模型或对象的变化，然后更新一个 UML 对象。

高级方法。

1.  创建一个eclipse插件，可能要包含com.ibm.xtools.modeler...
2.  在 GMF 图中添加一个监听器（Notification Listener）或创建一个（在 GMF 中，EditPolicy/EditPart）。这样，每次更改时，您都会更新时间戳，您还可以考虑等待/侦听保存命令，以便节省额外的 ecore 事务。
3.  通过扩展像 RecordingCommand 这样的类来编写事务。然后在图表上找到与您要查找的内容相匹配的所有子节点，我个人会使用 UML 配置文件并锁定注释的内容和/或自动化它，但它可以保持自由形式。
4.  让侦听器或 EditPolicy 在保存或编辑完成之前执行事务，无论您选择哪个。

那里有 GMF 和 EMF 教程和书籍，并不广泛，但很难。如果你真的很难直接给我发消息问更详细的问题或在这里添加并 ping 我，如果你仍然需要这个 7 个月的延迟，你的问题是非常具体的。

# c++ - C++/Java 继承与委托与等

> ID：727541
> 
> 赞同：1
> 
> 时间：2009-04-07T20:52:02.107
> 
> 标签：c++, inheritance, delegation

我正在创建一个具有许多不同选项的类库以进行可能的自定义。例如，您可以设计您的类以便它可以执行 FeatureX()，或者您可以设计您的类以便它可以执行 FeatureY()。

在正常情况下，您只需创建一个接口 IFeatureX 和一个名为 FeatureX 的纯虚方法，以及另一个接口 IFeatureY 和一个称为 FeatureY 的纯虚方法。如果一个类同时具有 FeatureX 和 FeatureY，它可以从两者继承，没问题。

我的问题是，如果一个函数/方法需要一个可以同时执行 FeatureX() 和 FeatureY() 的对象怎么办？我如何表达一个类型，最好用 C++，但 Java 的答案也可以帮助确保 FeatureX 和 FeatureY 都可用？

我是否要创建另一个从 IFeatureX 和 IFeatureY 继承的接口 IFeatureXY？好的...如果只有两个功能，我可以摆脱这个。但是如果有说... 10 个功能，可能的接口数量就会变得庞大。

有没有一种简单的方法可以做到这一点？我尝试使用 C++ 模板和委托来解决问题，但并没有走得太远。我希望有一个简单的解决方案，并且可能有一个我只是忽略了。

我感谢你们的任何帮助和建议。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T21:01:17.797

首先要做的是问问你是否想做一些不能简单表达的事情，如果是的话，问问自己这是否真的值得做？

鉴于您无法找到所需的更简单模型，您将需要考虑选项之间的依赖关系。如果您可以独立于 Feature Y 使用 Feature X，那么让它们成为独立的接口或纯虚拟类（视语言而定）。

如果您不能独立使用它们，请创建一个包含两者的类；问问自己为什么要将 FeatureX 和 FeatureY 作为单独的接口，因为这种使用模式表明它们毕竟不是独立的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T21:32:06.333

如果您不怕使用模板，可以将您的函数设为模板并使用 SFINAE 检查两个接口：

```
template <class T>
void my_function(const T& data, typename enable_if_c<
    is_convertible<T*, IFeatureX*>::value && 
    is_convertible<T*, IFeatureY*>::value>::type*=0) {
  ...
} 
```

这将为扩展两个功能接口的每种类型创建一个方法（请注意，它不需要 SFINAE 技巧即可工作；不受约束的模板可以工作，但是当您传递不符合要求的类型时会编译失败）。

另一种可能性是创建一个接口 IFeatureXY 扩展两者，并在函数参数中使用它；这有一个缺点，即**确实**实现了两个接口的类型，但不是这个联合接口的类型不能用于此方法。

此外，您可以将两个参数传递给函数，每个接口一个，并要求它们是指向同一对象的指针；这是脆弱的，但可以通过制作一些模板类来保存两个指针来加强 - 例如。`product_type<IFeatureX*, IFeatureY*>`，它将由所讨论的单个对象初始化，并且将包含两种类型。

在 Java 中，您可能可以对有界类型变量做同样的事情（如果它们允许多个边界；我现在不确定）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T21:44:37.643

尽管有一些方法可以添加完全不同的功能，但您可能需要考虑这些添加的功能的范围。它们会与您的主类库相关吗？（有人可能会争辩说，如果他们不是，他们不应该成为其中的一部分）

如果它们有足够的共同点来保证添加功能，您可以寻找装饰器模式（[http://en.wikipedia.org/wiki/Decorator_pattern](http://en.wikipedia.org/wiki/Decorator_pattern)）之类的东西。它可以让你绕过一些做这样的事情的不稳定问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T21:04:38.817

如果你想在 C++ 中做，那么多重继承呢？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T21:05:52.730

可能你的粒度太细了。考虑一个数字类 - 您可以执行乘法、除法、加法、减法等。但是，您不会为这些操作中的每一个创建单独的接口 - 您将创建一个名为 SupportsArithmetic （或其他）的接口，涵盖所有这些操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T21:38:39.080

WCF 有一个非常好的模式，如何使用`IExtensionCollection<T>.Find<E>()`. [IExtensionCollection](http://msdn.microsoft.com/en-us/library/ms586700.aspx)。

```
IFeatureX feature = argument.Find<IFeatureX>();

if (feature != null)
{
    // Find() returned an instance so there is an implementation
    // of IFeatureX available

   feature.FeatureX();
} 
```

通过这种方式，您可以查询您的对象以获取某些接口。[在 COM+ 中的IUnknown::QueryInterface()](http://msdn.microsoft.com/en-us/library/ms682521(VS.85).aspx)中使用了类似的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-07T21:44:17.817

为什么需要接口？使用模板：

```
template< typename T >
void some_function( const T& t )
{
    // use featureX functions
    t.fetatureX();

    // use featureY functions
    t.featureY();
} 
```

用法：

```
SomeClass x; // object with only X feature
some_function( x ); // compile time error, because featureY() doesn't exists 
```

# java - Swing 组件打印文本与显示文本不同

> ID：727544
> 
> 赞同：1
> 
> 时间：2009-04-07T20:52:25.197
> 
> 标签：java, swing, text, printing

我正在打印一个包含文本的 Swing 组件。Swing 组件在屏幕上很好地呈现文本，但是，当我打印它（到 .tif 文件）时，字符都被打碎了。为什么是这样？

运行此代码以了解我的意思：

```
import javax.swing.*;
import javax.swing.text.MutableAttributeSet;
import javax.swing.text.SimpleAttributeSet;
import javax.swing.text.StyleConstants;
import javax.swing.text.StyledDocument;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.print.PageFormat;
import java.awt.print.Printable;
import java.awt.print.PrinterException;
import java.awt.print.PrinterJob;

public final class PrintingDemo2 implements Printable {

    private final JTextPane textPane;
    private static final String WORDS = "GOOD MORNING\u00AE AMERICA";
    private static final String TEXT = WORDS + '\n' + WORDS + '\n' + WORDS + '\n' + WORDS + '\n' + WORDS + '\n' + WORDS;

    public static void main(String[] args) {
        new PrintingDemo2();
    }

    public PrintingDemo2() {
        textPane = new JTextPane();
        textPane.setText(TEXT);
        final StyledDocument document = textPane.getStyledDocument();

        String[] fontFamilies = new String[]{"Tahoma", "SimSum", "MS Mincho", "Batang", "Arial", "Times New Roman"};
        for (int i = 0; i < fontFamilies.length; i++) {
            final MutableAttributeSet attributeSet = new SimpleAttributeSet();
            StyleConstants.setFontFamily(attributeSet, fontFamilies[i]);
            StyleConstants.setFontSize(attributeSet, 14);
            document.setParagraphAttributes(i * 22, 21, attributeSet, true);
        }

        final AbstractButton printContextButton = new JButton("Print Context");
        printContextButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                final PrinterJob job = PrinterJob.getPrinterJob();
                job.setPrintable(PrintingDemo2.this);
                try {
                    job.print();
                } catch (PrinterException ex) {
                    throw new RuntimeException("Printing Failed.", ex);
                }
            }
        });

        final JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        final Container contentPane = frame.getContentPane();
        contentPane.setLayout(new BoxLayout(contentPane, BoxLayout.Y_AXIS));
        contentPane.add(printContextButton);
        contentPane.add(new JScrollPane(textPane));
        frame.setSize(400, 200);

        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                frame.setVisible(true);
            }
        });
    }

    public int print(Graphics graphics, PageFormat pageFormat, int pageIndex) throws PrinterException {
        if (pageIndex >= 1) return Printable.NO_SUCH_PAGE;

        RepaintManager mgr = RepaintManager.currentManager(textPane);
        mgr.setDoubleBufferingEnabled(false);
        final Graphics2D graphics2D = (Graphics2D) graphics;
        graphics2D.translate(pageFormat.getImageableX(), pageFormat.getImageableY());
        textPane.paint(graphics);
        mgr.setDoubleBufferingEnabled(true);

        return Printable.PAGE_EXISTS;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T16:28:35.947

您可以尝试对其进行光栅化（将其绘制为 300dpi 的 BufferedImage），然后打印该图像。哈克，并且对性能不利（将巨大的光栅化文件发送到打印机而不是矢量数据），但至少您不会遇到字体问题。

要对其进行光栅化，请创建一个 4.17x (300/72) 屏幕面板大小的 BufferedImage，并将其图形对象缩放到相同的程度，然后将面板绘制到缓冲图像的 Graphics2D 对象上。

免责声明：这并不优雅，我知道。如果有人知道如何说服每个品牌和型号的打印机从 Java 打印过程中接收字体，请加入！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T04:29:15.863

检查打印的字体是否与您在屏幕表单中看到的字体相同。如果打印机正在替换一种字体，它的字距和提示可能与屏幕字体不同。

首先，尝试将其修剪为仅一种字体。那里有很多活动部件。

### 更新

好的，我刚刚试了一下，它似乎工作正常，从 Mac OS/X 10.5.6 打印到 LaserJet 1300。

我会尝试不同的打印设备；我打赌它发生在 Java 处理完数据之后。

# java - 在 Eclipse 中搜索非最终静态变量

> ID：727547
> 
> 赞同：2
> 
> 时间：2009-04-07T20:53:28.047
> 
> 标签：java, eclipse, refactoring

我在 Eclipse 中用 Java 编程。我想知道是否有办法在我的代码库中搜索所有非最终静态变量。

例如：

```
private static int MY_VAR = 0; 
```

但不是：

```
public static final int MY_CONSTANT = 1; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-07T20:56:39.757

正如在[这个问题](https://stackoverflow.com/questions/240648/regex-to-find-static-non-final-variables)中提到的，正则表达式可以完成这项工作。

但是，我更喜欢[findbugs](http://findbugs.sourceforge.net)进行更完整的检测
（或者至少在[checkstyle 配置](http://checkstyle.sourceforge.net/index.html)中使用正则表达式）

这些静态分析工具可以生成比仅列出非最终静态变量更有用的信息，因为它们可以检测何时并描述给定实践不合适的原因。

# vb.net - vb.net (pre vb9) 中的匿名代表？

> ID：727550
> 
> 赞同：4
> 
> 时间：2009-04-07T20:54:50.620
> 
> 标签：vb.net, lambda

是否可以在 vb.net 版本 8 或更早版本中创建匿名委托？如果是这样，有人可以提供语法示例吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T20:56:40.397

在 VB 9.0 中，您可以创建单行 lambda 表达式

```
Dim del = Function (x) x + 42 
```

在 VB 10.0（尚未发布）中。您将能够创建多行函数和子例程（以及单行子例程）。例如

```
Dim del = Function (x)
            Return x + 42
          End Function 
```

**EDIT** OP 澄清它适用于 VB 9.0 之前的版本

不，在 VB 9.0 之前无法在 VB 中创建 lambda 表达式/匿名委托。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T20:57:32.563

可以，但仅限于 Visual Studio 2008/.Net 3.0 及更高版本。

使用函数关键字。

# c# - 提供高频数据的设计思路

> ID：727551
> 
> 赞同：0
> 
> 时间：2009-04-07T20:54:52.647
> 
> 标签：c#, caching, bigtable

我想构建一些东西来存储和提供时间序列数据，这些数据来自不同时间间隔的各种来源。这包括原始数据和计算数据。例如，假设我想记录每 30 秒的温度读数，以及每 5 分钟单独计算的温度预测。

我需要能够快速查询数据，并且我发现关系数据库一旦变得太大就无法正常工作。所以我正在考虑创建某种内存中的东西，但我确信它会在某个时候崩溃，所以我需要将数据保存到磁盘。所以我想知道，为什么不让整个事情都基于磁盘，对常用数据进行某种缓存呢？

但我对如何去做这件事有点不知所措。我正在想象数据源定期将更新数据集推送到服务器，使用某种字符串键/符号来识别数据是什么。服务器获取数据，然后呢？将其写入某种二进制文件？我可以每个符号写入一个文件吗？（假设超过 100k 个符号）

我认为我想要的是类似于 google 的 BigTable，但规模要小得多。基本上，一个分布式哈希表，将字符串键映射到相关数据的时间序列，具有非常快速的检索和按时间检索范围查询的能力。和多维数据的加分。

哦，这将（理想情况下）由 C#/windows 项目 - 它不需要那么*高性能*。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T21:34:46.717

遗憾的是，NDA 协议禁止我告诉您如何执行此操作。我在创建一个非关系数据库的团队工作，该数据库完全符合您的要求。它被称为城堡。但是，我可以向您指出公开可用的链接，它应该会给您一些关于它是如何工作的想法。

[http://zone.ni.com/devzone/cda/tut/p/id/6579](http://zone.ni.com/devzone/cda/tut/p/id/6579)

您可以直接购买该产品，但价格相当昂贵。

同样正如[Karl](https://stackoverflow.com/users/51881/karl)指出的，这通常用于 SCADA 产品，如[Wonderware](http://global.wonderware.com/EN/Pages/WonderwareHMISCADA.aspx)、[Lookout](http://sine.ni.com/nips/cds/view/p/lang/en/nid/12511)和[LabVIEW DSC](http://www.ni.com/labview/labviewdsc/)。

搜索[SCADA 数据存储](http://www.google.com/search?q=SCADA+data+storage&start=0&start=0&ie=utf-8&oe=utf-8&client=mozilla&rls=org.mozilla:en-US:unofficial)也会发现一些有趣的读物。

* * *

顺便说一句，如果数据量很小，关系数据库可以解决这个问题。随着时间的推移，往往会发生数据无限增长的情况，并且关系数据库的容量会超出其容量。一个好的 SCADA 数据存储系统可以轻松处理每秒轮询 50000 个点。尽管在某些时候，它们甚至开始变得太大而无法轻松处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T21:02:22.847

我必须告诉你，没有任何“文件系统”方法（我知道）会比关系数据库更快。而且情况可能会更糟。

关系数据库的问题不在于它们本质上很慢，而是将数据放入其中可以非常容易地完成，而无需考虑数据的保存方式。一个好的索引，即使是数百万条记录，也应该产生亚秒级的结果。这更多的是设计问题而不是访问问题。如果你设计得好，访问就会到来。

编辑：另外，如果“关系数据库”是指 Microsoft Access，那么你是对的；记录很多，速度很慢。我不会走那条路。如果钱是问题，请查看 MySql，如果钱不是问题，请查看 Oracle/Sql Server。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T11:30:33.677

“ [RRDTool](http://oss.oetiker.ch/rrdtool/)是开源行业标准、高性能数据记录和时间序列数据绘图系统。”

它分为两部分，第一部分用于记录、存储和检索时间序列数据，第二部分用于绘图。有很多使用它的例子。

即使你不使用它，它的设计也绝对是相关的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T21:08:51.287

我同意其他人的观点，即数据库将是您最好的选择。

如果您确实要生成如此大量的数据以至于会导致性能问题，您可能需要创建两个表 - 一个作为“实时”源，另一个作为“存档”。

您的系统会将新数据插入实时表中，并且批处理作业会定期将数据从那里移动到存档表中。当性能受到关注时，您将只查询较小的实时表。如果您确实需要查询所有数据，您将查询 UNION 实时表和存档表的视图。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-07T21:20:04.520

听起来像是 SCADA（系统控制和数据采集）类型的应用程序，利用了系统的数据采集部分。您是否查看过现成的解决方案。Wonderware/IndustrialSQL 或其他竞争产品？

话虽如此，我现在的雇主（The MetService，新西兰）每 30 秒、1 分钟或 1 小时记录一次来自自动气象站（温度、降雨量、风等）的读数，并预测到 Oracle DB。最小索引；索引减慢了 4 个 DML 操作中的 3 个并加快了 Selects 当然，您需要 3 个操作快速，尤其是插入。快速 IO 系统。用于重做日志的非常快的 IO。我们正在转向分区表，以便删除速度更快并生成更少的重做（删除包括内容的表空间而不是发出删除）虽然给予轻量级快速插入的事务很严重。尽管对执行插入和网络的机器和数据库的性能很重视。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T21:00:31.573

如果您使用数据库并取出索引和关系部分，您几乎可以得到您所描述的内容。但是，我不确定它会有多大用处。你能给我们一个更好的想法，为什么数据库不适合你吗？你试过什么没用？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-07T21:03:33.873

我不确定你为什么要为此使用数据库。我已经对具有数千万行的表进行了实时统计。此外，您可以定期对读数进行批处理，以将数十万行转换为数百行编译数据——显然取决于您的需要。

至于内存持久性和键值对访问，您可能需要查看[memcachedb](http://groups.google.com/group/memcachedb/browse_thread/thread/f5456f51f3df3d8d)。它基于 memcached 并提供出色的性能。

此外，在考虑更多之后，您可以轻松地将事物作为内存中的哈希表运行，然后定期将其序列化到文件系统以保持持久性。

# javascript - Javascript 将哪种正则表达式算法用于正则表达式？

> ID：727565
> 
> 赞同：15
> 
> 时间：2009-04-07T20:58:50.657
> 
> 标签：javascript, regex, algorithm, language-agnostic, unix

我今天正在阅读[这篇](http://swtch.com/~rsc/regexp/regexp1.html)关于两种不同正则表达式算法的文章。

根据[文章](http://swtch.com/~rsc/regexp/regexp1.html)旧的 Unix 工具，如 ed、sed、grep、egrep、awk 和 lex，都在其正则表达式中使用所谓的 Thompson NFA 算法......

然而，Java、Perl、PHP 和 Python 等较新的工具都对它们的正则表达式使用不同的算法，这些算法要慢得多。

[这篇文章](http://swtch.com/~rsc/regexp/regexp1.html)完全没有提到 Javascript 的正则表达式算法，（是的，我知道那里有各种 JS 引擎）但我想知道是否有人知道他们使用哪些算法，是否应该将这些算法换成 Thompson NFA。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-07T21:05:57.817

Javascript ECMA 语言描述对正则表达式的特定实现没有强加要求，因此部分问题的格式不正确。您真的很想知道特定浏览器中的特定实现。

然而，Perl/Python 等使用较慢算法的原因是定义的正则表达式语言并不是*真正*的正则表达式。真正的正则表达式可以表示为有限状态机，但正则表达式的语言是上下文无关的。这就是为什么时尚只是将其称为“正则表达式”而不是谈论正则表达式。

### 更新

是的，事实上 javascript 正则表达式不是~~内容免费~~的常规。考虑使用“{n,m}”的语法，即匹配从*n*到*m*个接受的正则表达式。设*d*差*d* =| *纳米*|。语法意味着存在一个可接受的字符串*ux ^d w*，但不存在可接受的字符串*ux ^(k>d) w*。通过常规语言的抽引引理可以得出这不是常规语言。

（啊。Thinko 更正了。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-08T09:38:17.057

尽管 ECMA 标准没有指定 ECMAScript 实现应该使用的算法，但标准要求 ECMAScript 正则表达式必须支持反向引用（\1、\2 等）这一事实排除了 DFA 和“Thompson NFA”实现。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-07T21:04:21.440

Perl 使用记忆递归回溯搜索，并且从 5.10 的一些改进开始，不再对`perl -e '("a" x 100000) =~ /^(ab?)*$/;'`. 在我最近在 OS X 机器上进行的测试中，Perl 5.10 的表现优于`awk`，即使在`awk`'s 算法应该更好的情况下。

# c# - .NET 类图，不使用设计器

> ID：727567
> 
> 赞同：2
> 
> 时间：2009-04-07T20:59:56.567
> 
> 标签：c#, .net, visual-studio, class-diagram

在 .NET 中是否可以以编程方式 (C#) 生成类图 (.cd)？如果有怎么办？

PD：显然我不是在询问如何使用 IDE 生成它的说明。我知道我可以将类拖放到 ClassDiagram 项目中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T21:13:17.407

我刚刚使用记事本打开了一个 .cd 文件，它是[纯 XML](http://blogs.msdn.com/classdesigner/archive/2005/07/29/444501.aspx) ......我不应该那么难以编程方式生成它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T21:05:22.200

选择需要类图的 .cs 文件，然后选择查看类图，将生成并显示一个 .cd 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T21:06:02.417

是的，您只需打开 Visual Studio 并右键单击您的 .cs 文件或您的项目，然后选择查看类图。.cd 是自动创建的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T23:50:32.913

我为一半的答案道歉，但看看这是否真的可能需要相当多的时间。

如果您查看 XML 格式，它是相当神秘的，特别是 Hash 条目，如果您删除它，那么 IDE 将删除该条目（我试过很多次）。

要真正实现自动化，您需要使用 VS 自动化 API、EnvDTE。API 非常神秘，而且也很笼统。在查看文档时，我找不到特定的类或任何处理类图的东西。

如果它对您来说很重要，您需要花费几个小时，您可以先手动创建一个，以便您可以使用自动化 API 检查它。使用 EnvDTE COM 对象（CoCreated 或在 VS 宏中提供）使用 DTE.Solution.Open 打开您的解决方案。然后使用 DTE.Solution.Projects 使用类图查找您的项目，并使用 Project.ProjectItems 查找类图文件。

从那里，我会首先查看 ProjectItem 上的 Kind 属性是否表示特殊的东西，然后调整其他属性并反映 ProjectItem 的 Object 属性以查看是否有特殊的东西。

如果您只需要生成一次，请查看 DTE.Commands 属性以获取可用命令的列表。右键单击菜单调用的命令应该在某处。然后，您可以使用 DTE.Windows.Items(Constants.vsWindowKindSolutionExplorer).Object 作为 UIHeirarchy 来获取解决方案资源管理器窗口并使用 UIHeirarchy 和 UIHeirarchyItem 来选择文件，然后调用命令。

抱歉，我无法提供完整的示例，但由于我手边没有树行走代码，因此需要几个小时。

# object - 超越对象实例的比较

> ID：727580
> 
> 赞同：2
> 
> 时间：2009-04-07T21:03:05.170
> 
> 标签：object, comparison

有没有人知道.net 中的工具或库可以用来比较对象属性和子对象，比如超越文本文件的比较？我正在寻找的是一种显示相同类型的两个实例并显示它们之间的彩色编码差异并允许用户在对象之间复制值的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T07:37:24.000

使用[OzCode](http://www.oz-code.com/ "帮助")，您可以将对象与其他对象或保存的快照进行比较。

![比较样本](https://i.stack.imgur.com/GEiWE.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T21:22:30.677

只是一个想法：将您的对象序列化为 XML 并运行[WinDiff](http://en.wikipedia.org/wiki/WinDiff)或 TortoiseSVN 内置差异查看器。

1.  可以使用*XmlSerializer*或[DataContractSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.aspx)完成导出（使用 [Serializalbe] 对象） ：

    ```
    Person p1 = new Person("Zighetti", "Barbara", 101);
    FileStream writer = new FileStream(fileName, FileMode.Create);
    DataContractSerializer ser = new DataContractSerializer(typeof(Person));
    ser.WriteObject(writer, p1);
    writer.Close(); 
    ```

2.  对 p2（Person 的实例）重复此步骤。

3.  将您的 xmls 放入 WinDiff 或您最喜欢的差异查看器。

**特殊的 XML 差异工具**

*   [在线 XML 差异](http://tools.decisionsoft.com/xmldiff.html)
*   [在您的应用程序中使用 XML 差异和补丁工具](http://msdn.microsoft.com/en-us/library/aa302294.aspx)
*   [XMLDiff](http://freshmeat.net/projects/xmldiff/)

# ms-access - 导出 MS Access 备忘录字段并转换 Unicode

> ID：727583
> 
> 赞同：0
> 
> 时间：2009-04-07T21:04:00.753
> 
> 标签：ms-access, unicode, encoding, memo

我有一个 Access 2003 数据库。一个表有一个备注字段，我在获取该数据时遇到问题。

*   将该字段导出到 txt 或 csv 会删除该字段（255 个字符）
*   导出为 Excel 给了我奇怪的换行符字符
*   通过 myODBC 附加到 mysql 数据库会出现关于“不正确的字符串”的错误
*   除非您告诉它将文件创建为 Unicode，否则将 VBA 与 Scripting.FileSystemObject 一起使用是行不通的，这没关系，但是我无法将文件转换为可以导入的文件

我的一些数据中有 Unicode 字符。它不是一个多语言数据库，所以我唯一能找到的是斜引号，可能是从 Word 中复制过来的。丢弃它们很好；字段中的信息仍然可以理解。

我可以将这些 Unicode 字符转换为它们的（ANSI？ASCII？）等价物吗？我没有太多地处理编码。

我尝试使用 iconv，但对编码一无所知，它并没有真正帮助。

现在，我需要以下帮助： - 转换我的数据库中的字符，以便它们导出非 unicode-ish-ly - 或者，在文件导出后转换 unicode 字符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T03:18:27.343

Access/VBA 创建的文件是 UTF-16。出于某种原因，文件开头有一个字符导致 Ruby YAML 库解析错误。

**iconv**来救援！

```
iconv -f UTF-16 -t ASCII -c utf_file.yml > ascii_file.yml 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T03:31:16.000

How are you exporting? Have defined an export spec? In Access 2003, this gives you a dropdown list with all the usual encodings (code pages), including Unicode UTF8\. This is also how you define your memo field as having a length greater than 255 characters.

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-08T01:54:45.640

导出为 .xml

# entity-framework - EntitySetReference 上的 EntityFramework 业务逻辑

> ID：727595
> 
> 赞同：0
> 
> 时间：2009-04-07T21:05:46.443
> 
> 标签：entity-framework, business-logic

我正在尝试做一些事情，如果有两个类（我关心），一个叫做 Inquiries，另一个是 InquiryStatus 的外键表

我的业务逻辑是什么我试图检查 Inquiry 是否与具有 InquiryStatus.bln_requiresValue 的新 InquiryStatus 相关联，那么我需要有一个 Inquiry.Money

现在我有

> ```
> public partial class Inquiry
> {
>     partial void OnInquiryIdChanging(int value)
>     {
>         if (EntityState == System.Data.EntityState.Added)
>         {
>               var Ekey = InquiryStatusReference.Value;
>         }
>     }
> } 
> ```

但是 Ekey 总是为空的，所以 InquiryStatusReference.EntityKey

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T22:00:23.507

您在分配 Ekey 之前尝试**过 InquiryStatusReference.Load()吗？**

# cocoa - NSURLConnection 委托在服务器状态 401 上没有得到它的 didReceiveAuthenticationChallenge 方法

> ID：727600
> 
> 赞同：1
> 
> 时间：2009-04-07T21:07:54.347
> 
> 标签：cocoa, macos, nsurlconnection, core-foundation

我设置了一个简单的 NSURLConnection 来查询 http-server。

```
GET /path HTTP/1.1
Host: 192.168.1.161:8282
User-Agent: NetTest1.0 CFNetwork/441.0.2 Darwin/9.6.0
Accept: */*
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Pragma: no-cache
Connection: keep-alive 
```

服务器响应代码 401 和 WWW-Authenticate 标头集

```
HTTP/1.1 401
Connection: close
Pragma: no-cache
Expires: Thu, 01 Dec 1994 16:00:00 GMT
Cache-control: no-cache
Cache-last-checked: Thu, 01 Dec 1994 16:00:00 GMT
Last-modified: Tue, 07 Apr 02009 22:55:48 CEST
Content-type: text/html; charset=iso-8859-1
WWW-Authenticate: Basic realm: 
```

我想这会向我的委托人的连接发送一条消息：didReceiveAuthenticationChallenge: 方法，但事实并非如此。

我也实施了

```
- (BOOL)connectionShouldUseCredentialStorage:(NSURLConnection *)connection {
  return FALSE;
} 
```

只是为了确保它不会尝试从我的钥匙串中发送缓存的凭据，而事实并非如此。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-07T21:44:57.550

WWW-Authenticate 标头看起来格式不正确，请尝试：

```
WWW-Authenticate: Basic realm="My Realm" 
```

# video - 具有最少客户端安装问题的低延迟广播视频

> ID：727601
> 
> 赞同：2
> 
> 时间：2009-04-07T21:08:00.867
> 
> 标签：video, video-streaming

我正在创建一个远程拍卖现场拍卖的应用程序。该应用程序的关键是实际销售和最终观众之间的延迟最小。我知道延迟有很多因素 - 但缓冲不需要是其中之一。客户端根本不需要缓冲。以下是我们需要的优先事项：

1.  从录制点到最终观看者的低延迟（少于 2 秒）
2.  需要尽可能少的安装的基于 Web 的客户端。这意味着如果它在大多数人已经安装的解决方案（flash、java）上运行，那就太好了。自定义 active-x (ie) 和插件 (firefox) 不太理想。我知道，在流式客户端中，quicktime 和 wmp 都不能很好地适应低延迟或零缓冲的想法。
3.  用于接收单个流并将其广播出去的服务器解决方案。服务器最重要的是它可以与项目 2 一起使用。

以下是我们尝试或研究过的一些事情。

1.  带有 Flash 客户端的 Adob​​e Flash 媒体服务器 - Adob​​e 媒体服务器似乎对低延迟流的支持很少。UDP上的东西会很棒。
2.  带有 Flash 客户端的 Wowza 媒体服务器——我们实际测试了这个，发现延迟非常低。但是，我们确实看到延迟随着带宽不足而增长，等等。与其看到延迟增长，我更希望客户端丢帧以保持最新状态。

有没有人有任何其他建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T13:20:21.473

我们已经做了类似的事情，并且正在使用 Unreal Media 流媒体软件。到目前为止，我们已经将视频和音频的延迟降低到半秒左右，具体取决于质量。我们发现的一件事是，音频和视频的单独流可以改善延迟并防止缓冲。

我们确实看过 flash 和 wozwa，但我们遇到的主要问题是编码而不是分发，而且 WMS 对低延迟毫无希望。在我们的局域网中，我们只能将其缩短到 5 秒左右。可惜我们的客户是 Silverlight，所以为了简单起见，我们更愿意使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-24T15:08:48.333

我们发现，在亚马逊 EC2 实例上使用最新版本的 Wowza，我们可以在西海岸使用流媒体和客户端获得亚秒级延迟（亚马逊 EC2 在东海岸）。相当令人印象深刻。我们发现延迟问题与我们使用 Flex 作为视频客户端有关。当我们使用闪光灯时，效果很好！！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T18:52:29.870

您为什么不查看 Window Media Server（随 Window Server 2003 及更高版本提供）？
大多数浏览器（IE、Firefox、Chrome）和流式直播视频源都支持它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-10T00:48:10.070

你应该看看的好产品是 Vidyo。( [http://www.vidyo.com](http://www.vidyo.com) ) 不是免费的——但是由于 H.264SVC 编码，效果很好。

# jquery - jQuery 交叉渐变插件

> ID：727604
> 
> 赞同：2
> 
> 时间：2009-04-07T21:09:18.370
> 
> 标签：jquery

我正在尝试构建或实现标题/图像旋转器。用户将单击数字（1、2、3），图像将淡出/淡入，并根据所选数字更改标题（跨度元素中的某些文本）。

是否存在可以执行此操作的插件？如果不是，那么使用 jQuery 完成此任务的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-07T21:22:19.803

这是你要找的吗？

[http://malsup.com/jquery/cycle/](http://malsup.com/jquery/cycle/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T21:20:41.570

试试看这个：

[jQuery for Designers：图像交叉淡入淡出](http://jqueryfordesigners.com/image-cross-fade-transition/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T21:19:36.457

最简单的方法是将所有图像附加到文档中，隐藏它们，然后 $().fadeIn() 将它们一一隐藏。

实际上，可能已经有一个插件可以做到这一点。

# objective-c - 以编程方式更改导航栏标题

> ID：727606
> 
> 赞同：4
> 
> 时间：2009-04-07T21:10:00.443
> 
> 标签：objective-c, iphone, cocoa-touch

我正在使用 Xcode Utility 模板。在 rootViewController.m 中有一个部分为所谓的 FlipSideView 设置导航栏：

（剪断）

```
UINavigationItem *navigationItem = [[UINavigationItem alloc] initWithTitle:@"Title"]; 
```

（剪断）

如何在 FlipsideViewController 类中以编程方式更改导航栏标题？我试过了：

```
self.navigationItem.title = @"XXXXXX"; 
```

没有成功。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-05-06T01:03:49.363

好的，我在这方面花了一些时间，因为我想为实用程序模板应用程序使用 NIB 布局的便利性，但我希望能够在不维护大量 nib 的情况下进行国际化。

所以，第一件事是添加到 FlipViewController 类中：

`IBOutlet UINavigationBar *navBarItself;`

然后，在 IB 中，从导航栏控制拖动到文件所有者，并连接到文件所有者中的 navBarItself。

然后，代码：

```
- (void) viewWillAppear:(BOOL) animated {

    [super viewWillAppear:animated];

    navBarItself.topItem.title = @"Peace!!";
}
```

这似乎很有魅力

（添加到 ViewDidLoad 时也可以使用）

（ps这里显示的其他答案对我不起作用）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-07T21:27:22.677

你什么时候打那条线？我在方法中调用了同一行，`ViewDidLoad`它工作正常。

```
- (void)viewDidLoad {   
    self.navigationItem.title = @"Test";
    [super viewDidLoad];
} 
```

你是如何展示你的观点的？这是我的一个 ViewControllers(tableView) 如何呈现另一个(detailView)

```
[self.navigationController pushViewController:detailController animated:YES]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-19T17:31:20.380

IIRC，UIViewController 的每个子类都有一个“标题”属性，该属性保存在导航栏标题中显示的文本。因此，`self.title = @"Foobar";`在 -viewDidLoad 或 -viewWillAppear:animated: 中设置应该可以解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T08:57:26.773

如果您的参考是零，请检查您在 IB 中的连接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T23:01:13.547

Jesse 的回答应该有效，但是由于您仍然遇到问题，因此首先要检查的地方之一是对 navigationItem 的引用。

尝试使用该行上的断点调试您的应用程序，并检查参考。最有可能的是，调用没有发生，因为引用为零。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-04T17:48:01.463

您可以设置 FlipSideViewController 的标题以在导航控制器中设置标题，而 FlipSideViewController 是 topViewController。在 FlipSideViewController 中：

```
self.title = "Flip Side"; 
```

我不确定这个项目的具体布局，但我认为这就是你所说的。

# asp.net - 基于下拉列表中所选项目的动态验证

> ID：727611
> 
> 赞同：0
> 
> 时间：2009-04-07T21:11:40.330
> 
> 标签：asp.net, validation, drop-down-menu

在我的 .aspx 页面中，我有一个下拉列表和一个文本框。

必须根据下拉列表中的选择来验证文本框。

我只在 .aspx 页面本身（不是代码隐藏）上使用了验证控件。

如何动态更改文本框上的验证类型？以编程方式？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-04-07T22:55:49.597

虽然这不是最有效的方式（因为它需要额外的回发），但您可以在下拉列表中设置 AutoPostBack='true'，然后当您响应下拉列表的 SelectedIndexChanged 事件时，您可以修改（启用/禁用等.) 您对文本框的验证。

# asp.net - 使用 .NET 中的公式创建 Excel 工作簿 (*.xls)

> ID：727612
> 
> 赞同：1
> 
> 时间：2009-04-07T21:11:56.817
> 
> 标签：asp.net, excel, excel-formula

我正在使用 ASP.NET Webforms，我需要将报告创建为 Excel 文件。

这应该很容易，通过更改 ContentType，但我需要将公式动态添加到某些单元格。

有任何想法吗？

PS：excel文件的格式应该是XLS而不是XLSX。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T21:13:10.077

你试过这个[ExcelXmlWriter 库](http://www.carlosag.net/Tools/ExcelXmlWriter/)吗？

此外，该库还有一个[帮助器/生成器工具。](http://www.carlosag.net/Tools/ExcelXmlWriter/Generator.aspx)

它将生成 .XLS 文件。该网站的样本显示：

```
using CarlosAg.ExcelXmlWriter;

class TestApp {
    static void Main(string[] args) {
       Workbook book = new Workbook();
       Worksheet sheet = book.Worksheets.Add("Sample");
       WorksheetRow row =  sheet.Table.Rows.Add();
       row.Cells.Add("Hello World");
       book.Save(@"c:\test.xls");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T21:15:09.650

我为此推荐[SpreadsheetML 。](http://msdn.microsoft.com/en-us/library/bb226687.aspx)它只是一个 xml 架构，您可以使用它来创建 Excel 将像本机一样打开的文档。您可以设置公式、格式、多个工作表和大多数其他 Excel 功能。

在谷歌上搜索有关 SpreadSheetML 的其他信息时要小心：有很多错误信息将 SpreadSheetML 与 Office 2007 中用于 Excel 的新 Xml 格式混淆。事实并非如此。SpreadSheetML 早在 OfficeXP 中就可以使用，甚至在 Office 2000 中也是有限的。

如果没有别的，这篇文章开头的 SpreadSheetML 链接还包括对创建 Excel 文件的其他选项的简短概述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T09:52:58.440

我为此使用了[Infragistics Excel 导出/导入组件](http://www.infragistics.com/dotnet/netadvantage/aspnet/infragisticsexcel.aspx#Overview)，它运行良好。

它支持公式和样式，并且非常可靠。唯一的缺点是它非常昂贵，必须作为包裹的一部分购买。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T14:43:58.677

[SpreadsheetGear for .NET](http://www.spreadsheetgear.com/)将创建 XLS 或 XLSX 工作簿并包括完整的公式支持。

[您可以在此处](http://www.spreadsheetgear.com/support/samples/excel.aspx)查看一些实时 ASP.NET Excel 报告示例。

免责声明：我拥有 SpreadsheetGear LLC。

# c# - 错误处理灵活性

> ID：727613
> 
> 赞同：1
> 
> 时间：2009-04-07T21:12:00.267
> 
> 标签：c#, error-handling

我们都知道我们可以使用异常包装（并在以后需要时捕获它）。但是，我想要（并且优雅地）实现的是在调用存储过程之后区分错误的类型。

我有`p_error`存储过程转储其错误的字段。可能是验证错误（无法避免对 DB 的验证），或授权错误（我们在 2 个地方执行此操作，其中一个是 DB），或 SQL 错误。
简而言之，我需要一个漂亮而优雅的机制来在抛出异常之前区分错误类型。

我想到的两种方法：

1.  在数据库级别有 3 个错误字段：1 个用于授权，1 个用于 SQL 错误，1 个用于任何其他错误。这可能会变得多毛。

2.  创建一个错误结构（枚举？），其中存储错误消息，以后可以与之进行比较。再次，太罗嗦了。如果 db 中的错误消息更改...难以维护怎么办。

还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T21:29:57.057

我不明白为什么人们一直在做这种 p_error 废话。至少对于 oracle（我也很确定使用 sql server），调用引发异常的存储过程的结果是一个引发的异常，它包含的信息比这个愚蠢的 p_error 字段可能要多得多。

同样，我最近的经验只是使用 oracle，但我会为所有存储过程调用（无论如何都是标准做法）编写一个包装器，并在其中执行类似这样的操作

```
try {
  RunMyStoredProcedure();
}
catch(OracleException e) {
  new OracleExceptionProcessor().HandleException(e);
}
//...
//...
class OracleExceptionProcessor {
  static List<int> _validationErrorCodes = new List<int> { 123, 456};
  static List<int> _authenticationErrorCodes = new List<int> { 789};

  public void HandleException(OracleException ex) {
    if(_validationErrorCodes.Any(c==ex.ErrorCode))
      throw new DatabaseValidationError(ex);
    if(_authenticationErrorCodes.Any(c==ex.ErrorCode))
      throw new DatabaseAuthenticationError(ex);
    throw new DatabaseSQLError(ex);
  }
} 
```

因为我无法想象数据库有那么多验证或身份验证错误代码，所以这应该非常简单易行。

# iphone - 如何在 iPhone 中找到性能瓶颈

> ID：727619
> 
> 赞同：0
> 
> 时间：2009-04-07T21:13:24.023
> 
> 标签：iphone, objective-c, performance

我是 Obj-c 编程的新手，想知道如何找到性能bottenecj。

我有一个 UITable 从 sqlite 数据库加载 50 个对象的块。

然后，当用户滚动时，我会加载接下来的 50 个对象，直到完成。

但是，我发现滚动停止了几秒钟。我想知道为什么。

我认为 50 个对象对于 iphone 来说并没有那么多，并且当我的缓存（一个 NSDictionary）中的所有对象都移动得很快（我一开始无法加载所有对象，因为我的测试列表有 3000 个项目）。

我按照建议做所有事情：加载惰性，使用缓存，使用不透明，自己绘制单元格等。所以，我需要知道如何解决问题

从性能工具中，我看到了很多分配，但可以将其与失败的地方联系起来。我怀疑在我的代码的某些领域，但我想在采取这个之前有强大的数据......

是否有可能在单一方法中累积时间？例如：

方法 样品运行 100 次，平均 6.2 秒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T21:17:56.803

试试[鲨鱼](http://developer.apple.com/tools/sharkoptimize.html)。

由于我无法访问 iPhone 开发人员 SDK，我无法告诉您如何在 iPhone 上使用 Shark，但我在[一个论坛](http://www.iphonedevsdk.com/forum/iphone-sdk-development/6369-using-shark.html)中找到了这个：

> 我自己还没有读过，但你可能想看看 iPhone 文档中的 Shark 用户指南。为了澄清，*您必须查看 3.0 beta 文档。*

# iphone - iphone有什么好的统计可视化库吗？

> ID：727622
> 
> 赞同：2
> 
> 时间：2009-04-07T21:14:33.427
> 
> 标签：iphone, statistics

我想知道是否每个开发人员都必须自己编写统计可视化代码，或者是否已经有一个可用于绘制图表、曲线、统计数据等的库（例如在股票应用程序中）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T21:35:37.837

您可能会使用 Google Charts API，并仅使用从中返回的图像：

[http://code.google.com/apis/chart/](http://code.google.com/apis/chart/)

例如，您可以从此 URL 检索字节

[http://chart.apis.google.com/chart?cht=p3&chd=t:60,40&chs=250x100&chl=Hello|World](http://chart.apis.google.com/chart?cht=p3&chd=t:60,40&chs=250x100&chl=Hello|World)

并将它们插入到 NSImage 中，或者只是让 Web 视图为您进行渲染。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T21:17:49.613

看看这个绘图包，它也可以在 iPhone 上编译：

[http://www.mpkju.fr/~graphview/page1/page1.html](http://www.mpkju.fr/~graphview/page1/page1.html)

请注意，我还没有使用过它，我之前遇到过它并记下了它的潜在用途。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T04:14:52.013

[Core Plot](http://code.google.com/p/core-plot/)是由一群具有科学头脑的 Cocoa 开发人员开发的跨平台 (Mac / iPhone) 绘图框架。它基于 Core Animation，并且在我上次签到时进展非常迅速。您可能需要阅读[邮件列表档案](http://groups.google.com/group/coreplot-discuss?hl=en)以了解框架的设计目标和当前状态。

# iphone - UILabel - 如何更改文本位置

> ID：727625
> 
> 赞同：7
> 
> 时间：2009-04-07T21:15:46.577
> 
> 标签：iphone, cocoa-touch

我正在尝试将子视图添加到我的 UITableView 单元格。

它对我来说非常完美，但文本出现在单元格的最左边。我怎样才能把它移到右边一点？我想从左侧单元格边框留出一点边距。

先感谢您。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-07T21:36:16.103

```
CGRect frame = theLabel.frame;
frame.origin.x += LEFT_MARGIN;
theLabel.frame = frame; 
```

# java - 将什么传递给 Arrays 实例方法 toArray(T[] a) 方法？

> ID：727627
> 
> 赞同：7
> 
> 时间：2009-04-07T21:17:10.347
> 
> 标签：java, arrays, collections, casting

如果你有一个 Collection 的实例，可以这样说：

```
Collection<String> addresses = new ArrayList<String>(); 
```

然后用一堆值填充哪个值，这是使用 toArray() 方法而不需要类型转换的“最佳”方式（如果有的话）？

```
String[] addressesArray = addresses.toArray(new String[] {});
String[] addressesArray = addresses.toArray(new String[0]);
String[] addressesArray = addresses.toArray(new String[addresses.size()]);
String[] addressesArray = addresses.toArray(new String[addresses.size() + 5]); 
```

前两者之间有语义上的区别吗？第三个最有效吗？第四个效率低于第三个吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-08T00:06:46.430

为了我的钱

```
String[] addressesArray = addresses.toArray(new String[0]); 
```

最简单，最不容易出错，因此是“最好的”。它还具有相同的代码适用于并发/同步集合的优点。您必须使用一些非常低级、大量使用的代码才能产生可​​忽略不计的性能差异。

通常您会看到分配给 a 的空数组`static final`以避免每次执行时分配。显然，事实证明，由于“优化”（分配确实非常快），性能可能会下降。

**更新：**事实证明这比使用大小数组更快。[http://shipilev.net/blog/2016/arrays-wisdom-ancients/](http://shipilev.net/blog/2016/arrays-wisdom-ancients/) **tl;dr：**反射属于微不足道的类型，不涉及慢速方法查找，如果可以确定所有的元素将被写入（或数组变得无法访问）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-07T21:26:28.983

根据[findbugs 报告](http://findbugs.sourceforge.net/bugDescriptions.html#ITA_INEFFICIENT_TO_ARRAY)，这是最有效的：

```
String[] addressesArray = addresses.toArray(new String[addresses.size()]); 
```

我相信他们；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T21:47:50.990

如果您选择不相信其他人，或者只是想自己检查一下，您可以查看[java.util.ArrayList](http://www.docjar.com/html/api/java/util/ArrayList.java.html)的源代码（发布源代码可能违反了某些许可，我很高兴我只是链接到它）。[当您下载Sun 的 JDK](http://java.sun.com/javase/downloads/index.jsp)时，您还将获得所有源代码的副本）。

在查看源代码后，`<T> T[] toArray(T[] a);`很明显：

```
String[] addressesArray = addresses.toArray(new String[addresses.size()]); 
```

是最快的方法。

显然，您不能总是花时间阅读和理解源代码，有时性能最佳的选项并不总是显而易见的，但对于更简单的方法，阅读源代码可能会提供非常丰富的信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T14:22:06.310

这主要是理论上的兴趣，但如果列表经常为空，您可以重用零长度数组：

```
private static final String[] EMPTY_STRING_ARRAY = {};
...
String[] addressesArray = addresses.toArray(EMPTY_STRING_ARRAY); 
```

由于零长度数组是不可变的（与非零长度数组不同），它们可以存储和重用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T21:20:31.617

这记录在[List](http://java.sun.com/javase/6/docs/api/java/util/List.html)接口的 javadoc 中：

> 如果列表适合指定的数组并有剩余空间（即，数组的元素多于列表），则数组中紧随列表末尾的元素设置为空。（仅当调用者知道列表不包含任何空元素时，这对确定列表的长度很有用。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T21:27:39.637

前两个语句实际上是在做同样的事情。

第三个是最有效的，因为如果您的元素不适合数组，则会为您创建一个新数组。

# java - 如何从调用者的范围内抛出异常？

> ID：727628
> 
> 赞同：5
> 
> 时间：2009-04-07T21:17:30.173
> 
> 标签：java, exception, stack-trace

我想创建一个例程来执行一些日志记录，执行一些其他操作，然后引发异常。我希望从许多不同的位置调用此例程。但是，在此例程中创建异常意味着他们将在其堆栈跟踪中包含此例程。我宁愿堆栈跟踪不报告这个实用程序。有没有办法做到这一点，而无需在调用者中创建异常并将其传递给实用程序例程？

```
public static void die(String message) throws MyException {
  log(message);
  ...
  throw new MyException();
} 
```

对于 Perl/Java 双语的程序员：我如何**在**Java 中钓鱼？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-07T22:42:55.680

您可以设置要抛出的任何异常的堆栈跟踪：

```
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class CarpTest {
    public static void main(String[] args) {
        new CarpTest().run();
    }

    public void run() {
        methodThatCarps();
    }

    private void methodThatCarps() {
        carp("Message");
    }

    private void carp(String message) {
        RuntimeException e = new RuntimeException(message);
        e.fillInStackTrace();
        List<StackTraceElement> stack = new ArrayList<StackTraceElement>(Arrays.asList(e.getStackTrace()));
        stack.remove(0);
        e.setStackTrace(stack.toArray(new StackTraceElement[stack.size()]));
        throw e;
    }
} 
```

这将在运行时打印以下堆栈跟踪：

```
Exception in thread "main" java.lang.RuntimeException: Message
    at CarpTest.methodThatCarps(CarpTest.java:18)
    at CarpTest.run(CarpTest.java:14)
    at CarpTest.main(CarpTest.java:10) 
```

请注意，您希望方法“carp”不会出现在堆栈跟踪中。然而，堆栈跟踪的操作应该非常小心。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-07T22:02:48.333

如果您想使用 Exception 来控制流程以及之后会发生什么，一个很好的建议是重写 fillInStackTrace() 方法：

```
public Throwable fillInStackTrace() {
   return this;
} 
```

结果，您将获得一个没有堆栈跟踪的异常，并且开销减少（填充堆栈跟踪需要时间）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T21:20:39.263

无法从堆栈跟踪中删除 throwing 函数。堆栈跟踪的全部目的是记录异常路径，因此允许函数选择退出会破坏目的。

你可以改变这一点的唯一方法是如果你返回异常而不是抛出它。但这迫使您依赖调用者知道抛出异常。

```
throw die("someReason).fillInStackTrace(); 
```

修改功能

```
public static Exception die(String message) {  
  log(message);  
  ...  
  return new MyException();
} 
```

**编辑**

添加了 fillInStackTrace() 调用以确保堆栈重置到抛出点。

[http://java.sun.com/j2se/1.3/docs/api/java/lang/Throwable.html#Throwable()](http://java.sun.com/j2se/1.3/docs/api/java/lang/Throwable.html#Throwable())

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T21:49:44.793

嗯..你可以继承异常并覆盖其中的所有方法，并包装原始异常。在内部，使用包装异常的 getStackTrace() 方法生成新的堆栈跟踪。我没有查看异常的来源，但您甚至可能不必重写那么多方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-07T22:52:19.713

也许您应该考虑从不同的方向解决问题。与其修改堆栈跟踪，为什么不让您的异常生成器方法（`die`在您的示例中）*返回*异常而不是抛出它？那么你的电话是`throw die();`.

例如：

```
// revised die() method:
public static MyException die(String message){
  log(message);
  //...
  return new MyException();
}

// calling code:
throw die("a-whoopsie daisy!"); 
```

现在，授予，`throw die()`可能看起来有点不美观，所以你可以重命名`die()`或`newException()`其他东西。但是满足异常处理方法不在堆栈跟踪中显示的要求—— `die()`（或`newException()`）在抛出异常之前返回，因此不是要跟踪的堆栈的一部分。

**编辑：**我的坏。我花了很多时间使用 C#，以至于我忘记了在 Java 中异常堆栈跟踪是在实例化时生成的，而在 C#/.NET 中，异常堆栈跟踪是在抛出时生成的。

所以这个技巧*适用*于 C#，但不适用于 Java。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-08T14:27:34.770

根据 ordnungswidrig 关于设置堆栈跟踪的说法，以及未知（谷歌）关于覆盖 fillInStackTrace() 的说法，我创建了一个 CarpException，它完全符合我的要求。请注意，我发现我必须删除四个堆栈跟踪帧而不是一个，因为我从 Throwable 和 Exception 中获取帧。

```
public class CarpException extends Exception {
  @Override
  public Throwable fillInStackTrace() {
    super.fillInStackTrace();
    StackTraceElement[] origStackTrace = getStackTrace();
    StackTraceElement[] newStackTrace = new StackTraceElement[origStackTrace.length - 4];
    System.arraycopy(origStackTrace, 4, newStackTrace, 0, origStackTrace.length - 4);
    setStackTrace(newStackTrace);
    return this;
  }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-07T21:44:38.567

不可以...我不久前尝试过这样做（我试图在 AOP 存在之前捕获堆栈跟踪以记录方法调用）。

堆栈跟踪是在创建异常时填充的，这是本机完成的。对于我正在处理的事情，我最终阅读了堆栈跟踪并查看了第二个元素，但这对你没有帮助......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-07T21:45:40.747

您可能会考虑让您的方法接收一个 Logger 作为该方法的参数。这将允许您根据调用类控制日志记录输出。

我建议不要让您的异常排除堆栈跟踪的这一部分。当您离开并且一些新人开始维护您的代码时，他们不会欣赏这种非标准的错误处理。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-07T21:46:54.300

你抛出堆栈跟踪只是为了能够分析它吗？在这种情况下，您可以在返回 StackTraceElement[] 的异常上调用 getStackTrace() 方法。在那里你可以过滤你不想要的元素（例如“die”方法）。

# string - 函数试图在 n 个字符后放置点

> ID：727629
> 
> 赞同：-4
> 
> 时间：2009-04-07T21:17:43.823
> 
> 标签：string, language-agnostic

我正在尝试编写一个函数，它有 2 个参数，一个是字符串，另一个是数字数据类型，我的函数必须在每 N 个字符后放置一个点，其中 N 在运行时提供（通过数字数据类型提供的一些数字） . 有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T21:25:24.790

这闻起来像家庭作业，所以让我建议如何开始，然后你可以回来看看你已经走了多远。

首先，您需要能够遍历字符串，或者至少可以沿其长度向前跳转*N 个字符。*你能想到一个结构，它允许你迭代每个字符直到你迭代*N*个字符，或者允许你将字符串拆分为*N*个字符长的子字符串？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T21:25:21.623

什么语言？

在 C# 中：

```
public string PutDots(string input, int n)
{
    char[] c = input.ToCharArray();
    StringBuilder output = new StringBuilder();
    for (int i = 0; i < c.Length; i++)
    {
        output.Append(c[i]);
        if (i % n == 0 && i > 0) 
        {
            output.Append(".");
        }
    }
    return output.ToString();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T21:27:05.940

可能是这样的：

```
public string foo(string input, int count)
{
  string result = "";
  for(int i=0; i < input.length; i++)
  {
    result += input[i];
    if(i % count == 0)
      result += '.';
  }
  return result;
} 
```

（根据您可能想要使用其他东西的语言，然后使用字符串连接来构建结果字符串）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T21:37:47.693

在 C# 中：

```
static string InsertDots(string s, int n)
{
    if(string.IsNullOrEmpty(s)) return s;

    if(n <= 0 || n > s.Length) return s;

    Regex re = new Regex(string.Format("(.{{{0}}})", n));

    return re.Replace(s, "$1.");
} 
```

# php - OOP 方式中的蛋鸡问题

> ID：727647
> 
> 赞同：2
> 
> 时间：2009-04-07T21:22:21.443
> 
> 标签：php, design-patterns, oop

我有一个鸡蛋问题。我也想以 OOP 方式在 PHP 中实现一个系统，其中两个类将发挥重要作用：数据库和日志。我的想法是通过 Database 类建立连接，该类将具有公共方法，例如。runQuery(sUpdateQuery)、doInsert(sInsert) 等。 Log 类将通过常用方法将日志写入数据库，如 logMessage(message)、logDatabaseQuery(sQuery) 到数据库。现在问题来了。

1：在数据库类的方法中，我希望能够使用 Log 类的 logDatabaseQuery(sQuery)

2：如果我不想在 logDatabaseQuery 方法中使用 Database 类的 doInsert(sInsert) 方法，这仍然不是一个大挑战。

我想保持简单 - 如果可能的话，只使用数据库连接对象的一个​​实例，以及来自记录器的实例。

对于许多人来说，单例模型是第一个选择的想法，但我绝对想使用不同的解决方案。

所以会有两个类使用彼此的方法：

数据库 doInsert logDatabaseQuery

记录 logDatabaseQuery doInsert

我想单独保留 Log 方法（在 Log 类中），因为以后它会有其他方法不仅可以记录到数据库，还可以记录到文件或电子邮件。

有什么想法，应该/可以如何以最好的、OOP 友好的方式完成？

我正在考虑一个公共的父抽象类，或者也考虑使用接口，但最终无法弄清楚正确的方法:(

我想知道的是关于正确的类层次结构的建议

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T21:35:32.330

听起来您有两种不同的数据库访问 - 已记录（正常情况）和未记录（用于日志记录功能）。将数据库类分为两个，一个用于记录请求的更高级别版本，一个用于未记录请求的较低级别版本。使用对日志记录和较低级别数据库类的引用来实现较高级别的数据库类。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-07T21:36:14.747

你把太多的东西结合在一起了。

数据库不能真正依赖于依赖于数据库的记录器。这不是好的设计。

你真正拥有的是两种数据库访问。

低级访问执行“原始”SQL。

记录器可以依赖于这个较低级别的类。它本身没有原始 SQL。这取决于较低级别的类。

高级访问执行应用程序查询，它使用低级访问**和**记录器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-07T21:43:29.973

如果要授予数据库对象访问记录器的权限，则将记录器传递给它。如果您想让您的记录器访问数据库对象，那么您将数据库对象传递给它。

在使用它们提供的函数之前，请检查这些对象是否存在于类中。

由于 PHP 默认通过引用传递这些对象，因此您可以对多个对象使用单个记录器和数据库类来执行此操作。

我还建议您在记录器中的一个点上完成所有数据库写入。只需将所有内容存储在一个临时数组中，并在解构时运行您的数据库代码。否则，如果您在整个代码中写入数据库，将会产生大量开销。

```
class Database {
    private $_logger = 0; //contains your logger
    /* The rest of your class goes here */

    //Add the logger to your class so it may access it.
    public function setLogger($logger) {
        $this->_logger = $logger;
    }

    //To check if we have a logger, we don't want to use one if we lack one.
    public function hasLogger() { 
        if($this->_logger) return true; 
        else return false;
    }
}
```

```
class Logger {
    private $_database = 0; //variable to hold your database object
    /* The rest of your class goes here */

    public function setDatabase($database) { //Same crap basically
        $this->_database = $database;
    }

    public function hasDatabase() {
        if($this->_database) return true;
        else return false;
    }

    public function doSomething { //This is new though
        if($this->hasDatabase()) { //Shows how you use hasDatabase()
            $this->_database->someDatabaseFunction();
        }
        else {
            //Whatever you'd do without a database connection
        }
    }
}
```

```
$database = new Database;
$logger = new Logger;

$database->setLogger($logger);
$logger->setDatabase($database);
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-07T22:10:10.657

将数据库与记录器解耦。我会将应用程序设计为从中间层记录，并决定在运行时而不是编译时使用哪种记录器类型。即使用工厂方法来确定是否记录到 db/xml/whatever。

如果数据层确实需要记录（即报告问题），让它抛出一个异常，在中间层捕获它，然后决定如何在那里处理它或将它交给诊断类并做出决定。无论哪种方式，我都会尽可能让 DAL 保持“盲目/愚蠢”，而不是让它决定什么是可记录事件，什么不是可记录事件。

一个共同的父类不是一个好主意。记录器不是数据库[r]。数据库也不是记录器。它不是鸡和蛋的问题，而是牛和猪的问题。它们是两种不同的动物。数据库没有理由知道记录器。我认为你在强迫抽象。我所看到的是一个记录器有一个数据库....如果它是一个数据库记录器。

无论如何，您从中间层驱动数据层，因此当包括异常和事件时，我看不出您在记录数据库相关事件时会失去保真度。

```
 public interface ILoggingProvider
    {
       void Log(String message)
    }

    public static class Logger
    {
       public static ILoggingProvider GetLoggingProvider()
       {
          //factory to return your logger type
       }

       public void Log(String message)
       {
          Logger.GetLoggingProvider().Log(message);
       }
    }

    public class DBLogger : ILoggingProvider {

      void Log(string message) {
       Database db = new Database();
       db.doInsert(someLoggingProc);
     }
    }

    public class Database
    {
        runQuery(sUpdateQuery) 
        doInsert(sInsert)
    }

...

 public class Customer{

 public void SaveCustomer(Customer c)
 {
   try {
    // Build your query
    Database db = new Database();
    db.runQuery(theQuery);
   } catch (SqlException ex) {
    Logger.Log(ex.message);
   }
 }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-07T21:33:52.617

创建一个实现接口 ILogger 的 Logger 类。Logger 类的新实例接收一个对象，该对象实现了用于输出日志消息的接口 ILoggingProvider。

创建一个实现 ILoggingProvider 接口的数据库类。一个新的数据库实例接收一个实现用于记录消息的 ILogger 接口的对象。

```
public interface ILogger
{
   void Debug(String message)
}

public interface ILoggingProvider
{
   void Log(String message)
}

public class Logger : ILogger
{
   private ILoggingProvider LoggingProvider { get; set; }

   public Logger(ILoggingProvider loggingProvider)
   {
      this.LoggingProvider = loggingProvider;
   }

   public void Debug(String message)
   {
      this.LoggingProvider.Log(message);
   }
}

public class Database : ILoggingProvider
{
   private ILogger Logger { get; set; }

   public Database(ILogger logger)
   {
      this.Logger = logger;
   }

   public void DoStuffWithTheDatabase()
   {
      // Do stuff with the database
      this.Logger.Debug("Did stuff with the database.");
   }

   public void Log(String message)
   {
      // Store message to database - be carefull not to generate new
      // log messages here; you can only use the subset of the Database
      // methods that do not themselve generate log messages
   }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T21:28:49.897

创建一个允许插入而不记录的插入方法重载，并让您的日志记录类使用它。否则，根据定义，您的设计是递归的：通过执行数据库插入记录所有数据库插入。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-07T21:29:17.277

在 $callerIsLogger=false 中添加一个可选参数`doInsert`，然后每次需要从记录器中执行 doInsert() 时，提供第二个参数`true`，您的 doInsert 可以检查这种情况，并且在记录器调用时不会调用记录器。什么层次结构？KISS 方法论摇滚 :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-07T21:32:38.330

这是[中介者模式](http://en.wikipedia.org/wiki/Mediator_pattern)的一个很好的候选者。您将拥有一个对象，记录器和数据库都将调用各种方法，并且该中介对象将保留对记录器和数据库的引用并为您处理通信。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-07T21:35:54.747

您可以添加数据库和记录器都使用的另一个类，以避免进入无限日志记录循环（并避免循环依赖）。

```
// Used only by Logger and DatabaseProxy
class Database {
   function doInsert( $sql ) {
      // Do the actual insert.
   }
}

class Logger {
   function log($sql) {
     $msg_sql = ...
     Database.doInsert($msg_sql);
}

// Used by all classes
class DatabaseProxy {
   function doInsert( $sql ) {
      Logger.log($sql);
      Database.doInsert($sql);
   }
} 
```

您可以通过让 Database 和 DatabaseProxy 都实现一个公共接口来稍微修饰一下，并使用工厂来提供适当的实例。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-07T21:43:46.960

恕我直言，数据库类不应该与记录器交互。我倾向于从调用数据库类的代码的同一部分调用记录器。然后记录器可以使用数据库类进行插入。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-07T22:18:53.897

听起来你纯粹为了使它面向对象而为一个简单的问题添加了很多复杂性......

问问自己，通过这种方法，你真正获得了什么？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-07T22:54:32.720

您可以为您的`Database::insert()`函数创建第二个参数：

```
function insert($sql, $logThis = true) { ... } 
```

然后很明显，当记录器调用它时，使第二个参数为假。

或者，只需检查函数堆栈以查看是否从 Logging 类调用了插入函数。

```
function insert($sql) {
    $callStack = debug_backtrace();
    if (!isset($callStack[1]) || $callStack[1]['class'] !== "Logger") {
        Logger::logSQL($sql);
    }
    // ...
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-08T00:45:38.537

我会怎么做：

```
public interface ILogger
{
    void LogWarning(string message);
    void LogMessage(string message);
}

public interface ILoggingProvider
{
    void LogEntry(string type, string message);
}

public interface IDbProvider
{
    void DoInsert(string insertQuery, params object[] parameters);
}

public class Logger: ILogger
{
    private ILoggingProvider _provider = ProviderFactory.GetLogProvider();

    public void LogWarning(string message)
    {
        _provider.LogEntry("warn", message);
    }

    public void LogMessage(string message)
    {
        _provider.LogEntry("message", message);
    }

    public void LogEntry(string type, string message)
    {
        _provider.LogEntry(type, message);
    }
}

public class Database : IDbProvider
{
    private Logger _logger = new Logger();
    public void DoInsert(string insertQuery, params object [] parameters)
    {
        _logger.LogEntry("query", insertQuery);
    }
}

public class DbLogProvider : ILoggingProvider
{
    private IDbProvider _dbProvider = ProviderFactory.GetDbProvider();

    public void LogEntry(string type, string message)
    {
        _dbProvider.DoInsert("insert into log(type,message) select @type,@message",type,message);
    }

}

public static class ProviderFactory
{
    public static IDbProvider GetDbProvider()
    {
        return new Database();
    }

    internal static ILoggingProvider GetLogProvider()
    {
        return new DbLogProvider();
    }
} 
```

尽管我可能还会让它从配置文件中查找类型，而不是在 ProviderFactory 类中硬编码它们。这里的假设是您的代码不关心它是如何记录的，这取决于管理员，并且所有记录都将在执行期间以一种方式完成（无论如何这都是我的偏好）。显然，您可以扩展它以在创建记录器时选择日志目标并创建适当的提供程序。

# c# - 在 .Net 中使用基于 REST 的 Web 服务

> ID：727649
> 
> 赞同：4
> 
> 时间：2009-04-07T21:23:32.797
> 
> 标签：c#, .net, rest

问候，

在使用 .Net 使用基于 REST 的 Web 服务时，我对最佳方法感到困惑。目前我正在使用 System.net.webclient 类。我应该在 System.Net 中使用 Webresponse、webrequest 类吗？

如果我要使用另一种方法（除了 webclient），我会获得什么缺点/优点？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T21:27:43.880

如果您使用[WCF REST 入门工具包](http://msdn.microsoft.com/en-us/netframework/cc950529.aspx)，则几乎没有技术上的缺点。然而，有一个学习曲线，它只有在你有 .Net 3.5 SP1 时才有效（所以我猜这是不利的一面）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-10T06:54:40.447

如果您想在没有 WCF 的情况下执行此操作，也可以查看[此链接。](http://aspguy.wordpress.com/2008/10/10/dealing-with-rest-web-services/)

# sql - plsql自定义数字格式

> ID：727655
> 
> 赞同：4
> 
> 时间：2009-04-07T21:26:12.353
> 
> 标签：sql, oracle, plsql

我正在尝试始终以“9 999,99”格式（注意空格）格式化数值。

问题是 oracle 没有为我提供用于获取此格式的数字掩码。

我得到的最接近的是 to_char(value,'99990,99')，但是没有办法把那个空格放在第三个数字之后。

我想得到的一些例子 1345.67 -> 1 345,67 12356.00 -> 12 356,00 0.56 -> 0,56

我怎么能这样做，也许使用正则表达式？任何的想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-07T22:11:55.630

```
SQL> alter session set nls_numeric_characters = ', '
  2  ;

Session altered.

SQL> select to_char(999999/100, '9G999D99')
  2    from dual;

TO_CHAR(9
---------
 9 999,99 
```

您还可以在 TO_CHAR 语句中指定 NLS_NUMERIC_CHARACTERS 设置，而不是在会话级别进行设置

```
 1  select to_char(999999/100, '9G999D99', 'nls_numeric_characters='', '' ')
  2*   from dual
SQL> /

TO_CHAR(9
---------
 9 999,99 
```

# c - 为什么这个可变参数函数在 Windows x64 上的第 4 个参数上失败？

> ID：727663
> 
> 赞同：3
> 
> 时间：2009-04-07T21:28:05.843
> 
> 标签：c, windows

下面是包含可变参数函数和对可变参数函数的调用的代码。我希望它会适当地输出每个数字序列。它在编译为 32 位可执行文件时会这样做，但在编译为 64 位可执行文件时不会。

```
#include <stdarg.h>
#include <stdio.h>

#ifdef _WIN32
#define SIZE_T_FMT "%Iu"
#else
#define SIZE_T_FMT "%zu"
#endif

static void dumpargs(size_t count, ...) {

    size_t i;
    va_list args;

    printf("dumpargs: argument count: " SIZE_T_FMT "\n", count);

    va_start(args, count);

    for (i = 0; i < count; i++) {

        size_t val = va_arg(args, size_t);
        printf("Value=" SIZE_T_FMT "\n", val);
    }
    va_end(args);
}

int main(int argc, char** argv) {

    (void)argc;
    (void)argv;

    dumpargs(1, 10);
    dumpargs(2, 10, 20);
    dumpargs(3, 10, 20, 30);
    dumpargs(4, 10, 20, 30, 40);
    dumpargs(5, 10, 20, 30, 40, 50);

    return 0;
} 
```

这是编译为 64 位时的输出：

```
dumpargs: argument count: 1
Value=10
dumpargs: argument count: 2
Value=10
Value=20
dumpargs: argument count: 3
Value=10
Value=20
Value=30
dumpargs: argument count: 4
Value=10
Value=20
Value=30
Value=14757395255531667496
dumpargs: argument count: 5
Value=10
Value=20
Value=30
Value=14757395255531667496
Value=14757395255531667506 
```

编辑：

请注意，可变参数函数`size_t`退出的原因是因为它的实际用途是用于接受指针和长度列表的可变参数函数。自然地，长度参数应该是 a `size_t`。在某些情况下，调用者可能会传入一个众所周知的长度：

```
void myfunc(size_t pairs, ...) {
    va_list args;
    va_start(args, count);

    for (i = 0; i < pairs; i++) {
        const void* ptr = va_arg(args, const void*);
        size_t len = va_arg(args, size_t);
        process(ptr, len);
    }
    va_end(args);
}

void user(void) {
    myfunc(2, ptr1, ptr1_len, ptr2, 4);
} 
```

请注意，`4`传入的`myfunc`可能会遇到上述问题。是的，呼叫者真的应该使用`sizeof`或者`strlen`只是将数字`4`放入`size_t`某个地方的结果。但关键是编译器没有捕捉到这一点（可变参数函数的常见危险）。

这里要做的正确的事情是消除可变参数函数并用提供类型安全的更好的机制代替它。但是，我想记录这个问题，并收集更详细的信息来说明这个问题在这个平台上存在的确切原因以及它的表现。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T20:07:08.827

所以基本上，如果一个函数是可变参数的，它必须符合某个调用约定（最重要的是，调用者必须清理 args，而不是 callie，因为 callie 不知道会有多少个 args）。

它在 4 日开始发生的原因是因为[x86-64 上使用的调用约定](http://en.wikipedia.org/wiki/X86_calling_conventions)。据我所知，Visual C++ 和 gcc 都对前几个参数使用寄存器，然后使用堆栈。

我猜测即使对于可变参数函数也是如此（这让我觉得很奇怪，因为它会使 va_* 宏更复杂）。

在 x86 上，标准 C 调用约定是始终使用堆栈。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-07T21:30:55.820

问题是您使用 size_t 来表示值的类型。这是不正确的，这些值实际上是 Win64 上的正常 32 位值。

Size_t 只能用于根据平台的 32 位或 64 位更改大小的值（例如指针）。更改代码以使用 int 或 __int32 这应该可以解决您的问题。

这在 Win32 上运行良好的原因是 size_t 是不同大小的类型，具体取决于平台。对于 32 位窗口，它将是 32 位，而在 64 位窗口上，它将是 64 位。因此，在 32 位窗口上，它恰好与您使用的数据类型的大小相匹配。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T21:33:23.333

这是因为`size_t`在 32 位 Windows 上定义为 32 位值，在 64 位 Windows 上定义为 64 位值。当第 4 个参数传递给可变参数函数时，高位似乎未初始化。抽出来的第4个和第5个值其实是：

```
Value=0xcccccccc00000028
Value=0xcccccccc00000032 
```

我可以通过对所有参数进行简单转换来解决这个问题，例如：

```
dumpargs(5, (size_t)10, (size_t)20, (size_t)30, (size_t)40, (size_t)50); 
```

然而，这并不能回答我所有的问题；如：

*   为什么是第四个参数？可能是因为前 3 个在寄存器中？
*   如何以一种类型安全的可移植方式避免这种情况？
*   这是否发生在其他 64 位平台上，使用 64 位值（忽略 size_t 在某些 64 位平台上可能是 32 位）？
*   无论目标平台如何，我是否应该将这些值作为 32 位值提取，如果将 64 位值推入可变参数函数会导致问题吗？
*   标准对这种行为有什么看法？

**编辑：**

我真的很想从[The Standard](http://www.iso-9899.info/wiki/The_Standard)那里得到一个报价，但它不能超链接，并且需要花钱[购买和下载](http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=29237)。因此，我认为引用它会侵犯版权。

参考[comp.lang.c FAQ](http://c-faq.com/)可以清楚地看出，当编写一个接受[可变数量参数的函数](http://c-faq.com/varargs/varargs1.html)时，您无法为类型安全做任何事情。由调用者[确保每个参数完全匹配或显式](http://c-faq.com/varargs/proto2.html)转换。没有隐式转换。

这对于那些了解 C 和`printf`（请注意 gcc 具有[检查 printf 样式格式字符串](http://gcc.gnu.org/onlinedocs/gcc-4.3.2/gcc/Function-Attributes.html#index-Wformat-2133)的功能）的人来说应该是显而易见的，但不那么明显的是，不仅类型不是隐式转换，而且如果类型的大小与提取的内容不匹配，您可以有未初始化的数据，或一般未定义的行为。放置参数的“槽”可能未初始化为 0，并且可能没有“槽”——在某些平台上，您可以传递 64 位值，并在可变参数函数中提取两个 32 位值. 这是未定义的行为。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T01:18:33.950

可变参数函数仅经过弱类型检查。特别是，函数签名没有为编译器提供足够的信息来了解函数假定的每个参数的类型。

在这种情况下，size_t 在 Win32 上为 32 位，在 Win64 上为 64 位。它必须像这样改变大小才能执行其定义的角色。因此，对于要正确提取 size_t 类型的参数的可变参数函数，调用者必须确保编译器可以在调用模块的编译时判断参数是该类型的。

不幸`10`的是一个常量类型`int`。没有定义的后缀字母将常量标记为 size_t 类型。您可以将该事实隐藏在特定于平台的宏中，但这并不比`(size_z)10`在调用站点上写更清楚。

由于 Win64 中使用的实际调用约定，它似乎部分工作。从给出的示例中，我们可以看出函数的前四个整数参数是在寄存器中传递的，其余的则在堆栈中。这允许正确读取计数和前三个可变参数。

然而，它**似乎**只工作。您实际上正处于未定义行为领域，而“未定义”确实意味着“未定义”：任何事情都可能发生。在其他平台上，任何事情都可能发生。

因为可变参数函数是隐式不安全的，所以编码器有一个特殊的负担，以确保编译时已知的每个参数的类型与运行时假定的参数类型匹配。

在某些接口众所周知的情况下，可能会警告类型不匹配。例如，gcc 通常可以识别出参数的类型`printf()`与格式字符串不匹配，并发出警告。但是在所有可变参数函数的一般情况下这样做是*困难*的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T00:14:45.677

如果您是编写此函数的人，那么您的工作就是正确编写可变参数函数和/或正确记录函数的调用约定。

您已经发现 C 对类型的处理既快又松（另请参阅签名和提升），因此显式转换是最明显的解决方案。这在使用 UL 或 ULL 之类的东西显式定义的整数常量中很常见。

大多数对传递值的完整性检查将是特定于应用程序的或不可移植的（例如指针有效性）。您可以使用诸如强制发送预定义的哨兵值之类的技巧，但这并非在所有情况下都是绝对可靠的。

最佳实践是大量记录、执行代码审查和/或编写单元测试时牢记这个错误。

# java - 关于 Terracotta 和 Servlet/共享线程

> ID：727670
> 
> 赞同：1
> 
> 时间：2009-04-07T21:31:22.280
> 
> 标签：java, multithreading, terracotta

我有一个需要分发的系统，其工作方式如下。由 tomcat 服务的 Servlet 启动并产生具有大量共享（分布式）字段的线程。因此，我将线程设置为根，并尝试从我的 servlet 构造函数中正常生成线程。但是，日志记录表明我尝试共享的 Runnable 的构造函数永远不会完成。什么可能导致这种情况？

在我的 servlet 中，我有一个线程实例，我尝试将其作为根共享，并且日志记录表明一切都很好，直到实现可运行的类 (UpdaterThread) 的构造函数结束。

我有以下内容：

小服务程序：

打印“创建新线程”；updaterThread = new UpdaterThread(args); 打印“启动线程。”；新线程（更新线程）.start（）；

现在，我从未在我的 tomcat 控制台输出中看到“启动线程”，尽管我可以看到直到 UpdaterThread 构造函数末尾的所有打印语句。UpdaterThread 维护一个对映射（由 servlet 共享）、一个字符串、一个 SQL 连接、一个语句、一个 ReentrantReadWriteLock、一个 Long 以及一个临时布尔值和 Long 不共享的引用。

在 UpdaterThread 的构造函数中，我传递了对共享映射的引用和字符串的值。如果没有启用兵马俑，我可以超越这一点。什么会导致 tomcat 和 terracotta 挂起而没有任何错误消息？在调用以后的方法之前，不会使用 rrwl 锁，但是我在程序执行中从来没有走那么远。帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T21:41:49.943

解决了。我不得不重新启动 Terracotta 服务器，然后让我看到错误，表明 Statement 和 Connection 是不可移植的类，需要将其设置为瞬态。

# html - 无法在 IE 6 中将图像浮动到文本的右侧

> ID：727675
> 
> 赞同：0
> 
> 时间：2009-04-07T21:32:24.413
> 
> 标签：html, css

我正在尝试为网站创建一个类似于 div 的小咆哮。它在 Firefox 中效果很好，但在 IE6 中效果不佳（没有尝试过 IE7，但我仍然需要支持 IE6）。

在 Firefox 中：居中的文本和图像浮动到 div 的右侧 在 IE6 中：居中的文本和图像在文本的左侧。

我已经尝试切换 img 和 span 标签顺序，但这会导致两者之间的 FF 换行，并且 IE 将图像呈现在文本的右侧，但没有停靠在 div 的右侧。

HTML

```
<div id="growl">
   <img src="close.gif" class="action" title="hide" />
   <span class="text">Grrrrrr.......</span>
</div> 
```

在 CSS 中：

```
#growl {
    background-color:yellow;
    text-align:center;
    position:absolute;
    top:0; left:0;
    width:98%;
    padding:10px 0;
    margin-left:1%;
    z-index:10;
    border:1px solid #CCCCCC;
}

#growl > .text {
    font-size:120%;
    font-weight:bold;
}

#growl > .action {
    float:right;
    cursor:pointer;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T21:34:42.537

> 选择器不适用于 IE 6。

摆脱它：

```
#growl .text {
    font-size:120%;
    font-weight:bold;
}

#growl .action {
    float:right;
    cursor:pointer;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T21:35:00.867

IE6 不支持 > css 选择器，请尝试删除它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T21:42:31.550

当您只有一个 img 和 span 时，为 div 中的每个元素添加一个类是没有意义的。这样做是为了更简洁的代码。

```
<div id="growl">
   <img src="close.gif" title="hide" />
   <span>Grrrrrr.......</span>
</div> 
```

-

```
#growl {
    background-color:yellow;
    text-align:center;
    position:absolute;
    top:0; left:0;
    width:98%;
    padding:10px 0;
    margin-left:1%;
    z-index:10;
    border:1px solid #CCCCCC;
}

#growl span {
    font-size:120%;
    font-weight:bold;
}

#growl img {
    float:right;
    cursor:pointer;
} 
```

# asp.net - 如何防止静态成员变量在 IIS 中一次被多个请求访问？

> ID：727679
> 
> 赞同：2
> 
> 时间：2009-04-07T21:33:52.227
> 
> 标签：asp.net, multithreading, iis, static-members, worker-process

我在理解 IIS 如何处理其线程上的静态变量时遇到了一些麻烦。我的理解一直是，如果 IIS 有 4 个工作进程，它可以同时处理 4 个请求，并且它与有 4 个单独的线程运行网站相同。任何静态变量都将保留在每个单独的线程中。我有点困惑的原因是我已经创建了一个范围来管理连接和缓存事务。当我测试应用程序时，我没有注意到任何问题，但是在我编译它并从两个不同的位置同时点击它之后，我似乎遇到了一种冲突。现在，如果这些工作进程是分开的，为什么会这样呢？可以在单个工作线程上同时处理多个请求吗？这一点非常重要，因为在这些静态成员中保存了唯一的 ID，以处理管理这些功能的对象的升级，并且看起来它们正试图访问同一个对象。

我在 x64 机器上的 Vista 的 IIS 服务器上运行它。

**编辑**

对于需要在单个请求上通过线程持续存在的值，我将这些值放入`Web.HttpContext.Current.Items`其中似乎可以解决问题。

`<ThreadStatic()>`可以使用，但在整个请求过程中可能不可用。在我拥有的一个模块中，仅在变量上使用以指示该线程是否已经加载了 cahcing 服务器的设置。如果为真，则tread（不是asp.net）准备好从缓存服务器获取数据。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-07T21:38:18.127

要更改的第一个概念：如果您使用的是 ASP.NET，它们是 ASP.NET 线程，而不是 IIS 线程。

其次，这是一个 .NET 问题。**静态**变量在整个`AppDomain`.NET 中共享。由于`AppDomain`每个 IIS 应用程序（或多或少）都有一个，这意味着您的静态变量将在应用程序中的所有工作线程之间共享。

将有超过四个线程，并且它们都将共享相同的变量，这意味着您要么需要进行锁定，要么不需要使用静态变量。

不管你一直以来的理解是什么，我建议你回过头来弄清楚你是从哪里得到这种理解的；然后更新它，因为它与 ASP.NET 没有太大关系。

* * *

**编辑：**主题已经改变，所以我会稍微改变一下答案。

您必须互锁对这些变量的访问。或者，您应该考虑重新评估您的设计。您的设计显然假设了一些不同的模型来访问静态。这个假设被证明是不正确的。这种假设可能已经在您的设计中级联。你应该根据现实重新评估你的设计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-07T02:44:50.137

每个工作进程都在自己的 AppDomain 中运行，因此每个 WP 都会有自己的静态变量实例。

在这里的答案中，它表明 AppDomain 是跨 WP 共享的，这是不正确的。

不过，您应该使用 .NET 连接池，并且您应该研究 using(IDisposable){} 方法来确定连接范围。

# java - 使用 Java 和 Ruby 实现 JSON 中的多态性或继承

> ID：727681
> 
> 赞同：3
> 
> 时间：2009-04-07T21:34:30.867
> 
> 标签：java, ruby, json, inheritance, single-table-inheritance

对于上下文，我们将大部分数据存储为 JSON 字符串。这与后端的 Hadoop 配合得非常好，并且在前端的 Ruby 中很容易处理。我的数据类型符合继承的自然模式。

为简单起见，假设我有一个 Pet 类和一个喂宠物的进程 FeedPet。我还有一个进程WalkDog，它只适用于Dog，它是一种宠物。我的数据是经过组织的，因此我永远不必担心试图遛一只不是狗的宠物。

我想做的是让 Pet 和 Dog 扩展 Pet，Dog 有一个额外的方法“getLeash()”，但我不知道如何将它映射到 JSON。

相反，我有一个带有物种数据哈希图的 Pet 类，因此 WalkDog 进程将调用 pet.getSpeciesData("leash") 而不是 dog.getLeash()。

我可以创建一个 Dog extends Pet，并且可以使用 Jackson 库将其序列化为 JSON。JSON 对象将有一个 leash 字段。但假设我想喂饱所有的宠物。所有宠物都有一个 getFood() 方法。因此 FeedPet 进程将对象反序列化为 Pet。但这失去了皮带领域。

WalkDog 进程可以做到这一点，因为它知道它的所有输入都将是 Dog，因此它可以将其作为 Dog 读取并将其作为 Dog 写回。

有什么方法可以将 java 对象序列化为 JSON，以便我可以保留它们的类型？我在想像 Rails 单表继承这样的东西，但它必须是 JSON 库可以理解的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T20:26:23.080

要使其工作，您必须在数据中嵌入一些对象类型信息（它仅对反序列化有用），并且通常使用否则不需要的外部模式定义（如 XML Schema for xml；因为这基本上是一个通用类型系统） . 这与 ORM 有相同的问题：Hibernate 必须使用丑陋的解决方法（n+1 - 方式连接、“超级表”或鉴别器字段）。

或者换一种说法：数据映射/绑定与对象序列化/反序列化并不完全相同（后者试图保留更多的对象标识）。

在这里，我假设您想要的基本上是：

```
Pet pet = mapper.readValue(jsonString, Pet.class);
// (and possibly get an exception if Pet is an abstract class...)
Leash l = ((Dog) pet).getLeash(); 
```

如果不是这种情况，您可以简单地绑定到 Dog

```
Dog dog = mapper.readValue(jsonString, Dog.class); 
```

所以无论如何：杰克逊项目有[做这个的功能请求](http://jira.codehaus.org/browse/JACKSON-91)，它允许你做你想做的（我认为）。

然而，这个解决方案主要适用于 Java，因为在 JSON 中没有标准的传递对象类型信息的方法。对于 XML，这可以通过 XML Schema 定义的“xsi:type”属性来完成；它标识 Schema 类型，然后将其映射到类（是的，相当复杂的方式，但它确实有效）。

**更新**：[Jackson 1.5](http://wiki.fasterxml.com/JacksonRelease15)添加了对此的支持（即实现了 JACKSON-91 功能请求），因此它可以用于生成类型标识符，以允许正确处理多态类型。它也应该适用于非 Java 系统，因为您可以完全配置如何包含类型信息的详细信息；并且不限于使用 Java 类名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T00:24:27.200

除了 django 中的固定装置之外，我没有太多使用 JSON 的经验，但在那种情况下，我只有一个“模型”键，以及相关的值。

然后由解释对象的程序来确定它们的类型和继承层次结构。

我想说的是，可用的方法无关紧要，因为这不需要序列化。只有对象的名称和属性。

- 更新

再次阅读您的问题后，您的进程似乎正在反序列化为父类，而不是实际的类。由于您的 dog 类继承自 pet，您只想确保您的反序列化器正在创建最专业的类的对象。

我不了解 Jackson 库，但如果您可以将其设置为具有一种模型字段，那么可能就是这样。

# asp.net - 分页列表视图 - 设置活动页面

> ID：727685
> 
> 赞同：0
> 
> 时间：2009-04-07T21:35:10.820
> 
> 标签：asp.net, pagination

我有一个显示产品的列表视图。我有一个与列表视图关联的数据分页器。我通过查询字符串值“prodID”控制产品详细信息的可见性/数量。我需要确保在加载页面时正确的页面处于活动状态。因此，如果 prodID 10 存在于列表视图的第 2 页上，则在导航到 URL 时第 2 页将是活动页面（在查询字符串中带有 prodID）。prodID 是列表视图中的数据键。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T16:31:06.327

pgProducts.SetPageProperties(itemIndex, pgProducts.PageSize, false);

# version-control - Perforce 开发分支 - 稀疏分支与私有分支

> ID：727690
> 
> 赞同：11
> 
> 时间：2009-04-07T21:36:14.047
> 
> 标签：version-control, perforce

我正在寻找一些关于可用于在 Perforce 库中创建单个开发分支的方法的优缺点的反馈。如果我理解正确，有两种处理方法。首先是创建一个私有分支，它是您正在处理的分支的完整副本。该分支将完全独立，并将您的更改与目标分支完全隔离。

我听说过的另一种推荐方法是稀疏分支。它在[Practical Perforce](http://oreilly.com/catalog/9780596101855/)（第 9 章，第 242 页）中有描述。这将创建一个分支，但仅包含您需要编辑的文件。然后，您将目标分支客户端视图与此稀疏开发分支客户端视图重叠。

这两种方法都需要程序员执行一些集成工作才能在目标分支中进行更改。Private Branch 方法似乎需要更多的额外内存才能创建整个分支的副本。但是，Perforce 文档声明它在这种情况下执行“惰性复制”。

> 集成还使 Perforce 能够执行文件的“惰性复制”。当您分支文件时，服务器实际上并没有保存文件的两个副本——它只保存源文件，并且数据库中的指针记录了到目标文件的分支已经发生的事实。惰性副本使分支成为低开销的操作；服务器不必跟踪文件的重复副本。

这使得 Sparse 分支方法看起来只是在流程中增加了人为错误的可能性，例如，开发人员可能开始处理他们没有添加到 Sparse 分支的文件，然后不小心将更改更新为破坏构建的目标分支。但是，稀疏分支功能的存在是有原因的。任何关于它存在的原因以及为什么我应该在完整的私有分支上使用它（反之亦然）的反馈将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T22:00:46.903

正如您从文档空间中指出的那样，这并不是真正的问题。速度虽然。同步整个开发树可能需要很长时间。整合回来也需要一段时间。如果您只需要树的一个分支，那么这两个操作都会快得多。

正如您已经说过的那样，可能会发生人为错误，但是如果您制作一个分支规范，它可以帮助减轻一些潜在的错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T08:23:03.663

同步速度和客户端磁盘空间是创建完整分支的问题（延迟复制对服务器有帮助，但对网络或客户端没有帮助）。但是我发现设置和理解比尝试创建稀疏分支更容易，所以我们最终使用的是完整的分支。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T10:43:19.013

稀疏分支适合的一个好情况是当您有一个可能由许多模块组成的复杂产品时。假设整个系统的构建需要很长时间，也许同步也需要一段时间——大量的数据文件。但是您的开发只需要修改整个源代码库的一小部分 - 可能是一两个模块，可能还有一些“更高”的链接代码。

在这种情况下，做一个稀疏分支会很有意义。这意味着您已经同步了大部分内容，并且可能已经构建了。但是您必须小心，您修改的任何文件都首先分支 - 否则您可能会破坏主线。当然，这需要程序员多加注意。

另一种稀疏分支可能是进行分支开发的唯一实用方法的情况是，如果很难在开发机器上拥有多个版本的应用程序。在这种情况下，让主线构建和开发构建同时构建和运行会很棘手。显然不理想，但有些产品是出于必要或历史原因。

# xml - WCF XML 序列化

> ID：727693
> 
> 赞同：0
> 
> 时间：2009-04-07T21:36:34.497
> 
> 标签：xml, wcf, serialization

回到 2.0 序列化时代，我可以创建一个对象的序列化版本，这将导致以下示例：

```
<transactionMessage messageDate="1/1/2001 11:00PM" messageId="abc123">
    <transaction property1="Value" property2="value2" />
</transactionMessage> 
```

我将使用 Serializable() 属性执行此操作，然后将 XmlElement 属性附加到我的项目。但是，当我使用 DataContract/DataMember 属性时，我得到如下所示的内容：

```
<transactionMessage>
  <messageDate>1/1/2001 11:00PM</messageDate>
  <messageId>abc123</mesageId>
  <transaction>
    <property1>Value</property1>
    <property2>Valu2</property2>
  </transaction>
</transactionMessage> 
```

通常我不会真正关心幕后生成的 XML，但这个系统将与多个外部客户端进行交互，这些客户端已经与不同的系统（基于 2.0 的序列化风格）进行通信，并且我希望保持结构相似但引入了 WCF 的附加增强功能。

我怎样才能告诉 DataMember 属性本质上使格式更像是第一个带有属性而不是所有元素的示例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T12:34:17.537

DataContract 序列化程序针对速度进行了优化，似乎设计者认为 XML 节点上的支持属性不适合他们的速度要求。

DataContract 序列化程序不支持属性 - 如果您需要这些属性，请改用古老的 XmlSerializer。

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T21:54:05.593

我没有使用 WCF，但尝试添加

```
[XmlAttribute] 
```

在你的 messageDate 和 messageID 属性之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T12:17:00.293

好吧，经过多一点搜索，根据这个似乎是不可能的：

[XMLSerializer 与 DataContractSerializer](http://www.danrigsby.com/blog/index.php/2008/03/07/xmlserializer-vs-datacontractserializer-serialization-in-wcf/)

不幸的是，MS 不会让您选择更改它。

# iphone - UIDatePicker 和 NSDate

> ID：727696
> 
> 赞同：3
> 
> 时间：2009-04-07T21:37:49.393
> 
> 标签：iphone, objective-c, nsdate

我有一个从 UIDatepicker 获得的 NSDate。

```
IBOutlet UIDatePicker *dueDate;
NSDate *selectedDate = [dueDate date]; 
```

如何`dueDate`以 的形式检索月份`int`？（1 月 1 日，2 月 2 日等）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-07T21:52:57.983

```
NSCalendar *calendar = [NSCalendar currentCalendar];
NSDateComponents *components = [calendar components:NSMonthCalendarUnit fromDate:[dueDate date]];
NSInteger month = [components month]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-07T21:47:35.983

使用`-[NSCalendar components:fromDate:]`例如这里的例子：

[http://developer.apple.com/iphone/library/documentation/Cocoa/Reference/Foundation/Classes/NSCalendar_Class/Reference/NSCalendar.html](http://developer.apple.com/iphone/library/documentation/Cocoa/Reference/Foundation/Classes/NSCalendar_Class/Reference/NSCalendar.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T21:50:58.613

```
NSDateFormatter *dateFormat = [[[NSDateFormatter alloc] initWithDateFormat:@"%m" allowNaturalLanguage:NO] autorelease];
int month = [[dateFormat stringFromDate:dueDate] intValue]; 
```

# c# - 查找格式正确的括号的所有组合

> ID：727707
> 
> 赞同：35
> 
> 时间：2009-04-07T21:43:20.330
> 
> 标签：c#, algorithm, f#, catalan

这是在与朋友交谈时出现的，我想我会在这里问，因为这是一个有趣的问题，并且希望看到其他人的解决方案。

任务是编写一个函数 Brackets(int n) 打印从 1...n 开始的所有**格式正确的括号组合。**对于括号（3），输出将是

```
()
(())  ()()   
((()))  (()())  (())()  ()(())  ()()() 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-04-08T00:03:50.260

对它进行了破解.. C# 也是。

```
public void Brackets(int n) {
    for (int i = 1; i <= n; i++) {
        Brackets("", 0, 0, i);
    }
}

private void Brackets(string output, int open, int close, int pairs) {
    if((open==pairs)&&(close==pairs)) {
        Console.WriteLine(output);
    } else {
        if(open<pairs)
            Brackets(output + "(", open+1, close, pairs);
        if(close<open)
            Brackets(output + ")", open, close+1, pairs);
    }
} 
```

递归利用了这样一个事实，即您永远不能添加比所需对数更多的左括号，并且您永远不能添加比左括号更多的右括号。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-21T13:22:57.870

Python 版本的第一个投票答案。

```
def foo(output, open, close, pairs):
    if open == pairs and close == pairs:
        print output
    else:
        if open<pairs:
            foo(output+'(', open+1, close, pairs)
        if close<open:
            foo(output+')', open, close+1, pairs)

foo('', 0, 0, 3) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-07T22:52:21.070

[**F#**](http://fsharp.net/)：

这是一个解决方案，与我之前的解决方案不同，我相信它可能是正确的。此外，它更有效。

```
#light

let brackets2 n =
    let result = new System.Collections.Generic.List<_>()
    let a = Array.create (n*2) '_'
    let rec helper l r diff i =
        if l=0 && r=0 then
            result.Add(new string(a))
        else
            if l > 0 then
                a.[i] <- '('
                helper (l-1) r (diff+1) (i+1)
            if diff > 0 then
                a.[i] <- ')'
                helper l (r-1) (diff-1) (i+1)
    helper n n 0 0
    result 
```

例子：

```
(brackets2 4) |> Seq.iter (printfn "%s")

(*
(((())))
((()()))
((())())
((()))()
(()(()))
(()()())
(()())()
(())(())
(())()()
()((()))
()(()())
()(())()
()()(())
()()()()
*) 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-07T23:14:15.073

可能组合的数量是 N 对 C(n)的[加泰罗尼亚数。](http://en.wikipedia.org/wiki/Catalan_number)

这个问题[在 joelonsoftware.com 论坛上进行了](http://discuss.joelonsoftware.com/default.asp?interview.11.437754.20)相当广泛的讨论，包括迭代、递归和迭代/位移解决方案。那里有一些很酷的东西。

这是 C# 论坛上建议的快速递归解决方案：

## C＃

```
public void Brackets(int pairs) {
    if (pairs > 1) Brackets(pairs - 1);
    char[] output = new char[2 * pairs];

    output[0] = '(';
    output[1] = ')';

    foo(output, 1, pairs - 1, pairs, pairs);
    Console.writeLine();
}

public void foo(char[] output, int index, int open, int close,
        int pairs) {
    int i;

    if (index == 2 * pairs) {
        for (i = 0; i < 2 * pairs; i++)
            Console.write(output[i]);
        Console.write('\n');
        return;
    }

    if (open != 0) {
        output[index] = '(';
        foo(output, index + 1, open - 1, close, pairs);
    }

    if ((close != 0) && (pairs - close + 1 <= pairs - open)) {
        output[index] = ')';
        foo(output, index + 1, open, close - 1, pairs);
    }

    return;
} 
```

括号（3）；

> 输出：
> ()
> (()) ()()
> ((())) (()()) (())() ()(()) ()()()

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-08T03:26:35.607

这是另一个 F# 解决方案，它更注重优雅而不是效率，尽管记忆化可能会导致性能相对较好的变体。

```
let rec parens = function
| 0 -> [""]
| n -> [for k in 0 .. n-1 do
        for p1 in parens k do
        for p2 in parens (n-k-1) ->
          sprintf "(%s)%s" p1 p2] 
```

同样，这只会产生一个包含**恰好**n 对括号（而不是最多 n）的字符串列表，但很容易包装它。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-07T21:55:26.667

[**F#**](http://fsharp.net)：

**更新**：这个答案是错误的。我的 N=4 未命中，例如“(())(())”。（你明白为什么吗？）我很快就会发布一个正确的（更有效的）算法。

（对所有支持投票的人感到羞耻，因为没有抓住我！:)）

* * *

效率低下，但简短而简单。（请注意，它只打印“第 n”行；从 1..n 循环调用以获取问题所要求的输出。）

```
#light
let rec brackets n =
    if n = 1 then
        ["()"]
    else
        [for s in brackets (n-1) do
            yield "()" ^ s
            yield "(" ^ s ^ ")"
            yield s ^ "()"] 
```

例子：

```
Set.of_list (brackets 4) |> Set.iter (printfn "%s")
(*
(((())))
((()()))
((())())
((()))()
(()(()))
(()()())
(()())()
(())()()
()((()))
()(()())
()(())()
()()(())
()()()()
*) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-08-05T21:31:52.087

**C++ 中的简单解决方案：**

```
#include <iostream>
#include <string>

void brackets(string output, int open, int close, int pairs)
{
    if(open == pairs && close == pairs)
            cout << output << endl;
    else
    {
            if(open<pairs)
                    brackets(output+"(",open+1,close,pairs);
            if(close<open)
                    brackets(output+")",open,close+1,pairs);
    }
}

int main()
{
    for(int i=1;i<=3;i++)
    {
            cout << "Combination for i = " << i << endl;
            brackets("",0,0,i);
    }
} 
```

**输出：**

```
Combination for i = 1
()
Combination for i = 2
(())
()()
Combination for i = 3
((()))
(()())
(())()
()(())
()()() 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-07T23:44:26.577

该死-每个人都击败了我，但我有一个很好的工作示例:)

[http://www.fiveminuteargument.com/so-727707](http://www.fiveminuteargument.com/so-727707)

关键是确定规则，这实际上非常简单：

*   逐个字符地构建字符串
*   在字符串中的给定点
    *   如果到目前为止字符串中的括号平衡（包括空str），则添加一个左括号并递归
    *   如果已使用所有开括号，则添加右括号并递归
    *   否则，递归两次，每种类型的括号一次
*   当你到达终点时停止:-)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-13T21:17:49.257

# 普通 Lisp：

这不会打印它们，但会生成所有可能结构的列表。我的方法和其他人有点不同。它将解决方案重组`brackets(n - 1)`为`brackets(n)`. 我的解决方案不是尾递归的，但可以通过一些工作来实现。

### 代码

```
(defun brackets (n)
  (if (= 1 n)
      '((()))
      (loop for el in (brackets (1- n))
            when (cdr el)
            collect (cons (list (car el)) (cdr el))
            collect (list el)
            collect (cons '() el)))) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-07T23:48:33.463

这是 C++ 中的解决方案。我使用的主要思想是从前一个*i*获取输出（其中*i*是括号对的数量），并将其作为输入提供给下一个*i*。然后，对于输入中的每个字符串，我们在字符串中的每个位置放置一个括号对。将新字符串添加到集合中以消除重复。

```
#include <iostream>
#include <set>
using namespace std;
void brackets( int n );
void brackets_aux( int x, const set<string>& input_set, set<string>& output_set );

int main() {
    int n;
    cout << "Enter n: ";
    cin >> n;
    brackets(n);
    return 0;
}

void brackets( int n ) {
    set<string>* set1 = new set<string>;
    set<string>* set2;

    for( int i = 1; i <= n; i++ ) {
        set2 = new set<string>;
        brackets_aux( i, *set1, *set2 );
        delete set1;
        set1 = set2;
    }
}

void brackets_aux( int x, const set<string>& input_set, set<string>& output_set ) {
    // Build set of bracket strings to print
    if( x == 1 ) {
        output_set.insert( "()" );
    }
    else {
        // For each input string, generate the output strings when inserting a bracket pair
        for( set<string>::iterator s = input_set.begin(); s != input_set.end(); s++ ) {
            // For each location in the string, insert bracket pair before location if valid
            for( unsigned int i = 0; i < s->size(); i++ ) {
                string s2 = *s;
                s2.insert( i, "()" );
                output_set.insert( s2 );
            }
            output_set.insert( *s + "()" );
        }
    }

    // Print them
    for( set<string>::iterator i = output_set.begin(); i != output_set.end(); i++ ) {
        cout << *i << "  ";
    }
    cout << endl;
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-09T22:52:55.190

一个简单的 F#/OCaml 解决方案：

```
`let total_bracket n =
    let rec aux acc = function
        | 0, 0 -> print_string (acc ^ "\n")
        | 0, n -> aux (acc ^ ")") (0, n-1)
        | n, 0 -> aux (acc ^ "(") (n-1, 1)
        | n, c ->
                aux (acc ^ "(") (n-1, c+1);
                aux (acc ^ ")") (n,   c-1)
    in
    aux "" (n, 0)` 
```

* * *

 `## 回答 #12

> 赞同：2
> 
> 时间：2018-02-11T17:34:29.767

基于递归回溯算法的Provider C#版本，希望对您有所帮助。

```
public List<String> generateParenthesis(int n) {
   List<String> result = new LinkedList<String>();
   Generate("", 0, 0, n, result);
   return result;
}

private void Generate(String s, int l, int r, int n, List<String> result){
   if(l == n && r == n){
       result.add(s);
       return;
   }

   if(l<n){
       Generate(s+"(", l+1, r, n, result);    
   }

   if(r < l)
       Generate(s+")", l , r+1, n, result);
 }} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-08T12:56:01.260

```
def @memo brackets ( n )
    => [] if n == 0 else around( n ) ++ pre( n ) ++ post( n ) ++ [ "()" * n) ]

def @memo pre ( n )
    => map ( ( s ) => "()" ++ s, pre ( n - 1 ) ++ around ( n - 1 ) ) if n > 2 else []

def @memo post ( n )
    => map ( ( s ) => s ++ "()", post ( n - 1 ) ++ around ( n - 1 ) ) if n > 2 else []

def @memo around ( n )
    => map ( ( s ) => "(" ++ s ++ ")", brackets( n - 1 ) ) 
```

（[kin](http://purl.oclc.org/net/kin)，这有点像基于actor模型的具有特征的线性python。我还没有开始实现@memo，但上面的工作没有优化）

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-08-06T17:48:40.347

## 哈斯克尔：

我试图想出一个优雅的 list monad-y 方法：

```
import Control.Applicative

brackets :: Int -> [String]
brackets n = f 0 0 where
    f pos depth =
        if pos < 2*n
            then open <|> close
            else stop where
                -- Add an open bracket if we can
                open =
                    if depth < 2*n - pos
                        then ('(' :) <$> f (pos+1) (depth+1)
                        else empty

                -- Add a closing bracket if we can
                close = 
                    if depth > 0
                        then (')' :) <$> f (pos+1) (depth-1)
                        else empty

                -- Stop adding text.  We have 2*n characters now.
                stop = pure ""

main = readLn >>= putStr . unlines . brackets 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2010-08-24T20:58:14.690

为什么不能这么简单，这个想法很简单

括号（n）->'（）'+括号（n-1）0'（'+括号（n-1）+'）'0括号（n-1）+'（）'

其中 0 是上面的串联操作

```
public static Set<String> brackets(int n) {
    if(n == 1){
        Set<String> s = new HashSet<String>();
        s.add("()");
        return s;
    }else{
        Set<String> s1 = new HashSet<String>();
        Set<String> s2 = brackets(n - 1);
        for(Iterator<String> it = s2.iterator(); it.hasNext();){
            String s = it.next();
            s1.add("()" + s);
            s1.add("(" + s + ")");
            s1.add(s + "()");
        }
        s2.clear();
        s2 = null;
        return s1;
    }
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-12-11T21:04:56.777

Groovy 版本基于上面 markt 优雅的 c# 解决方案。动态检查打开和关闭（信息在输出和参数中重复）以及删除一些无关的逻辑检查。

```
3.times{ 
    println bracks(it + 1)
}

def bracks(pairs, output=""){
    def open = output.count('(')
    def close = output.count(')')

    if (close == pairs) {
        print "$output "
    }
    else {
        if (open < pairs) bracks(pairs, "$output(")
        if (close < open) bracks(pairs, "$output)")
    }
    ""
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-06-05T11:10:39.133

不是最优雅的解决方案，但这就是我在 C++ (Visual Studio 2008) 中的做法。利用 STL 集消除重复，我只是天真地将新 () 对插入到上一代的每个字符串的每个字符串索引中，然后递归。

```
#include "stdafx.h"
#include <iostream>
#include <string>
#include <set>

using namespace System;
using namespace std;

typedef set<string> StrSet;

void ExpandSet( StrSet &Results, int Curr, int Max )
{
    if (Curr < Max)
    {
        StrSet NewResults;

        for (StrSet::iterator it = Results.begin(); it != Results.end(); ++it)
        {
            for (unsigned int stri=0; stri < (*it).length(); stri++)
            {
                string NewStr( *it );
                NewResults.insert( NewStr.insert( stri, string("()") ) );
            }
        }
        ExpandSet( NewResults, Curr+1, Max );

        Results = NewResults;
    }
}    

int main(array<System::String ^> ^args)
{
    int ParenCount = 0;

    cout << "Enter the parens to balance:" << endl;
    cin  >> ParenCount;

    StrSet Results;
    Results.insert( string("()") );

    ExpandSet(Results, 1, ParenCount);

    cout << Results.size() << ": Total # of results for " << ParenCount << " parens:" << endl;

    for (StrSet::iterator it = Results.begin(); it != Results.end(); ++it)
    {
        cout << *it << endl;
    }

    return 0;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-09-05T17:41:23.913

```
//C program to print all possible n pairs of balanced parentheses  

#include<stdio.h>

void fn(int p,int n,int o,int c);

void main()
{
    int n;
    printf("\nEnter n:");
    scanf("%d",&n);
    if(n>0)  
        fn(0,n,0,0);
}

void fn(int p,int n,into,int c)
{  
    static char str[100];
    if(c==n)
    {
        printf("%s\n",str);
        return;
    }
    else
    {
        if(o>c)
        {
            str[p]='}';
            fn(p+1,n,o,c+1);
        }
        if(o<n)
        {
            str[p]='{';
            fn(p+1,n;o+1,c);
        }
    }
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-11-06T05:52:46.930

红宝石版本：

```
def foo output, open, close, pairs
  if open == pairs and close == pairs
      p output
  else
    foo(output + '(', open+1, close, pairs) if open < pairs
    foo(output + ')', open, close+1, pairs) if close < open
  end
end
foo('', 0, 0, 3) 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-08-25T09:50:46.027

```
 validParentheses: function validParentheses(n) {
    if(n === 1) {
      return ['()'];
    }
    var prevParentheses = validParentheses(n-1);
    var list = {};
    prevParentheses.forEach(function(item) {
      list['(' + item + ')'] = null;
      list['()' + item] = null;
      list[item + '()'] = null;
    });
    return Object.keys(list);
  } 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-11-29T18:54:22.763

```
public static void printAllValidBracePermutations(int size) {
    printAllValidBracePermutations_internal("", 0, 2 * size);
}

private static void printAllValidBracePermutations_internal(String str, int bal, int len) {
    if (len == 0) System.out.println(str);
    else if (len > 0) {
        if (bal <= len / 2) printAllValidBracePermutations_internal(str + "{", bal + 1, len - 1);
        if (bal > 0) printAllValidBracePermutations_internal(str + "}", bal - 1, len - 1);
    }
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-02-27T18:44:44.833

另一个低效但优雅的答案=>

```
public static Set<String> permuteParenthesis1(int num)
{   
    Set<String> result=new HashSet<String>();
    if(num==0)//base case
        {
            result.add("");
            return result;
        }
    else
        {
            Set<String> temp=permuteParenthesis1(num-1); // storing result from previous result.
            for(String str : temp)
            {
                for(int i=0;i<str.length();i++)
                {
                    if(str.charAt(i)=='(')
                    {
                        result.add(insertParen(str, i)); // addinng `()` after every left parenthesis.
                    }
                }
                result.add("()"+str); // adding "()" to the beginning.
            }

        }
    return result;

}
public static String insertParen(String str,int leftindex)
{
    String left=str.substring(0, leftindex+1);
    String right=str.substring(leftindex+1);
    return left+"()"+right;
}

public static void main(String[] args) {
    // TODO Auto-generated method stub
    System.out.println(permuteParenthesis1(3));

} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-03-16T10:46:57.967

记忆的尝试：

```
void push_strings(int i, int j ,vector<vector <string>> &T){
    for (int k=0; k< T[j].size(); ++k){
        for (int l=0; l< T[i - 1 - j].size(); ++l){
            string s = "(" + T[j][k] + ")" + T[i-1 - j][l];
            T[i].push_back(s);
        }
    }
}

vector<string> generateParenthesis(int n) {
    vector<vector <string>> T(n+10);
    T[0] = {""};

    for (int i =1; i <=n; ++i){
        for(int j=0; j<i; ++j){
            push_strings(i,j, T);
        }
    }

    return T[n];
} 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-10-09T22:50:49.640

```
def form_brackets(n: int) -> set:
    combinations = set()
    if n == 1:
        combinations.add('()')
    else:
        previous_sets = form_brackets(n - 1)
        for previous_set in previous_sets:
            for i, c in enumerate(previous_set):
                temp_string = "{}(){}".format(previous_set[:i+1], previous_set[i+1:])
                combinations.add(temp_string)

    return combinations 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2016-10-24T10:58:02.730

```
void function(int n, string str, int open, int close)
{
    if(open>n/2 || close>open)
        return;
    if(open==close && open+close == n)
    {
        cout<<" "<<str<<endl;
        return;
    }
    function(n, str+"(", open+1, close);
    function(n, str+")", open, close+1);
} 
```

来电者 - `function(2*brackets, str, 0, 0);`

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-11-25T05:20:21.560

我今天接受采访时被问到这个问题。

我在破解编码中总是跳过这个问题，因为我认为这是一个面试的愚蠢问题。不过面试官并没有同意我的看法。

以下是我在面试中可以提出的解决方案。面试官正在研究上面已经给出的更高效的方法。他通过了我这个解决方案。

```
//This method is recursive. It simply returns all the possible arrangements by going down
//and building all possible combinations of parenthesis arrangements by starting from "()"
//Using only "()" for n == 1, it puts one "()" before, one "()" after and one "()" around
//each paren string returned from the call stack below. Since, we are adding to a set, the
//set ensure that any combination is not repeated.
private HashSet<string> GetParens(int num)
{
    //If num < 1, return null.
    if (num < 1) return null;

    //If num == 1, there is only valid combination. Return that.
    if (num == 1) return new HashSet<string> {"()"};

    //Calling myself, by subtracting 1 from the input to get valid combinations for 1 less
    //pair.
    var parensNumMinusOne = GetParens(num - 1);

    //Initializing a set which will hold all the valid paren combinations.
    var returnSet = new HashSet<string>();

    //Now generating combinations by using all n - 1 valid paren combinations one by one.
    foreach (var paren in parensNumMinusOne)
    {
        //Putting "()" before the valid paren string...
        returnSet.Add("()" + paren);

        //Putting "()" after the valid paren string...
        returnSet.Add(paren + "()");

        //Putting paren pair around the valid paren string...
        returnSet.Add("(" + paren + ")");
    }
    return returnSet;
} 
```

* * *

其他性能更高的解决方案的空间复杂度是 O(1)，但对于这个是 O( *C [n]* )，其中*C [n]*是[Catalan Number](https://en.wikipedia.org/wiki/Catalan_number)。

此代码的时间复杂度与其他高性能解决方案相同，与 O( *C [n]* ) 相同。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2020-10-21T20:45:48.870

在 javascript/nodejs 中。

该程序最初旨在回答终极问题，但枚举有效括号组合非常完美。

```
function* life(universe){
    if( !universe ) yield '';
    for( let everything = 1 ; everything <= universe ; ++everything )
        for( let meaning of life(everything - 1) )
            for( let question of life(universe - everything) )    
                yield question + '(' + meaning + ')';
}
let love = 5;
let answer = [...life(love)].length;
console.log(answer);

function brackets(n){
    for( k = 1 ; k <= n ; k++ ){
        console.log(...life(k));
    }
}

brackets(5); 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2022-01-07T12:10:51.850

```
public class Solution {
    public IList<string> GenerateParenthesis(int n) {

        List<string> combinations = new List<string>();
        generateAll(new char[2 * n], 0, combinations);
        return combinations;
    }

     public void generateAll(char[] current, int pos, List<string> result) {
        if (pos == current.Length) {
            if (valid(current))
                result.Add(new string(current));
        } else {
            current[pos] = '(';
            generateAll(current, pos+1, result);
            current[pos] = ')';
            generateAll(current, pos+1, result);
        }
    }

    public bool valid(char[] current) {
        int balance = 0;
        foreach (char c in current) {
            if (c == '(')
                balance++;

            else balance--;
            if (balance < 0)
                 return false;

        }
        return (balance == 0);
    }
} 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2017-03-13T05:49:58.117

在 C# 中

```
 public static void CombiParentheses(int open, int close, StringBuilder str)
    {
        if (open == 0 && close == 0)
        {
            Console.WriteLine(str.ToString());
        }
        if (open > 0) //when you open a new parentheses, then you have to close one parentheses to balance it out.
        {                
            CombiParentheses(open - 1, close + 1, str.Append("{"));
        }
        if (close > 0)
        {                
            CombiParentheses(open , close - 1, str.Append("}"));
        }
    } 
```

# sql - 数据库查询时间复杂度

> ID：727719
> 
> 赞同：31
> 
> 时间：2009-04-07T21:46:22.803
> 
> 标签：sql, database, language-agnostic, big-o

我对数据库很陌生，所以如果这是一个愚蠢的问题，请原谅我。

在现代数据库中，如果我使用索引来访问一行，我相信这将是 O(1) 复杂度。但是，如果我进行查询以选择另一列，它将是 O(1) 还是 O(n)？数据库是否必须遍历所有行，还是为每一列构建一个排序列表？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-07T21:53:04.567

实际上，我认为基于索引的访问将是 O(log(n))，因为您仍将通过 B-Tree-esque 组织向下搜索以获取您的记录。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-07T21:54:11.333

要回答您的字面问题，是的，如果列上没有索引，数据库引擎将不得不查看所有行。

在通过多列选择的更有趣的情况下，无论有无索引，情况变得更加复杂：如果查询优化器选择使用索引，那么它将首先根据索引选择行，然后应用过滤器剩余的约束。从而将第二次过滤操作从 O（行数）减少到 O（按索引选择的行数）。这两个数字之间的比率称为**选择性**，是选择使用哪个指标时的重要统计数据。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-07T21:53:18.437

索引是每列的，因此如果您在未索引的列上使用 where 子句，它将执行所谓的表扫描，即 O(n)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-08T10:45:42.917

我不知道答案，但请记住，大 O 表示法只为您提供任意大的数据集大小的性能指示。

例如，数据库性能的瓶颈通常是**磁盘寻道**。因此，如果可以将工作数据集保存在内存中，性能会大大提高。Big-O 符号不会告诉您有关此类优化的任何信息，因为它们仅与有限数据集相关。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-08-07T01:08:59.193

B-trees 不会产生 O(logN)，这是二叉树的复杂度。

B-Tree 的组织方式是每个节点都有一个完整的块，因此一旦找到一个节点，单个 I/O 操作就可以读取整个块。

每个节点的项目数 = 阻塞因子 (#records/block){bfr}，B-Tree 优化搜索将产生 O(log [bfr÷2 +1] N) I/O 操作而不是 O(N) I/ O 按键查找记录的操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T21:51:18.610

你有索引。聚集索引在磁盘上进行物理排序，每个表只能有一个。非聚集索引是按逻辑排序的，你可以有很多（小心不要滥用它，它可能会减慢写入操作）。如果您的列上没有索引，那么我相信这是好的旧的逐行方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-07T22:13:46.357

不同的数据库有不同类型的索引、不同的执行计划和不同的实现。关系数据库的大部分代码都在搜索优化算法中。你的问题没有一个单一的答案。当您想知道查询将如何执行时，可以使用工具来可视化执行计划。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-09-17T10:26:14.327

**没有索引的表**，数据保存在无序结构上。当您要搜索某些数据时，它会使用“扫描”来检查表格上从头到尾的所有数据。

案例1：无索引查询表，查询1条记录，SQL查询计划步骤：“表扫描”所有数据，O(N)

案例2：无索引查询表，查询多条记录，SQL查询计划步骤：“表扫描”所有数据，O(N)

**带索引的表，**数据会保存在 B-tree 结构中，当你要搜索 1 个数据（在索引列上）时，它会利用 B-tree 结构来查找数据。

案例 3：在索引列上查询表，查询 1 条记录，SQL 查询计划步骤：“index seek”，O(LogN)

案例4：查询带有索引列的表，查询多条记录，

2 可能的情况下，SQL 查询优化器将利用“索引统计”来计算并确定使用哪个操作步骤更快。

*   (a) SQL查询计划步骤：“index Scan”，O(N)
*   (b) SQL查询计划步骤："index seek", O(R LogN) [R for number of records]

# windows-mobile - CeRapiInit 还是 CeRapiInitEx？

> ID：727723
> 
> 赞同：1
> 
> 时间：2009-04-07T21:47:37.357
> 
> 标签：windows-mobile, activesync, rapi

CeRapiInit() 在设备连接并且初始化完成（同步）之前不会返回。CeRapiInitEx() 可以，但需要回调事件处理程序（异步）。我想要的只是一个带有取消按钮的“连接到设备”对话框。哪种方法更好？有任何代码示例吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-07T22:11:51.743

找到了 ：-）

[http://support.microsoft.com/kb/831883](http://support.microsoft.com/kb/831883)

# c# - String.Format() 拆分整数值

> ID：727727
> 
> 赞同：2
> 
> 时间：2009-04-07T21:49:02.737
> 
> 标签：c#, .net, string, formatting

我想知道.Net 的 String.Format() 是否可以将一个整数拆分为两个子字符串。例如，我有一个数字 3234，我想将其格式化为 32X34。我的整数总是有 4 位或 6 位数字。这可以使用 String.Format() 吗？如果是这样，什么格式的字符串会起作用？

PS 我知道还有其他方法可以做到这一点，但我特别想知道 String.Format() 是否可以处理这个问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-07T21:51:33.510

调用时可以指定自己的格式`String.Format`

```
String.Format("{0:00x00}", 2398) // = "23x93" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-07T22:16:34.870

詹姆斯，我不确定你是否已经完全指出了问题所在。

如果您的目标是将“x”放在字符串的*中心，则*[塞缪尔的答案](https://stackoverflow.com/questions/727727/string-format-split-integer-value/727741#727741)不适用于 6 位数字。`String.Format("{0:00x00}", 239851)`返回“2398x51”而不是“239x851”

相反，请尝试：

```
String.Format(val<10000 ? "{0:00x00}" : "{0:000x000}", val) 
```

在任何一种情况下，该方法都称为[Composite Formatting](http://msdn.microsoft.com/en-us/library/txafckwd.aspx)。

（我假设这些数字将介于 1000 和 999999 之间。即便如此，介于 1000 和 1009 之间的数字也会报告“x”之后的数字，并带有不必要的前导“0”。所以这种方法可能对介于1010 和 999999 包括在内。）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-07T21:51:29.937

不，它不能。

实际上，您的整数似乎不是整数。也许它们应该存储在一个类中，并使用它自己的 ToString() 方法以这种方式格式化它们。

# ms-access - 从日期字段按月查询

> ID：727729
> 
> 赞同：1
> 
> 时间：2009-04-07T21:49:17.213
> 
> 标签：ms-access, date

我有一组已经按年份分组的 Access d/b。在给定的一年内，我有一个名为 REPORTDATE 的字段，它是一个标准的 mm/dd/yyyy 字段。但是，我需要生成按月返回数据的查询。例如，我只想查看一月的记录、二月的记录、三月的记录等，以便我可以对它们求和并使用它们。

我是否在查询设计视图 Criteria 字段中使用表达式？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-07T22:12:48.187

> 我只想查看一月的记录、二月的记录、三月的记录等，以便我可以总结它们并与它们一起工作。

您可以在*一个*sql 语句中完成*所有这些操作：*

 *```
select month(reportdate), sum( the column you wish to sum )
from tablename
group by month(reportdate); 
```

*但等等还有更多！*

进一步说有几个销售人员在卖东西，您希望按月显示每个销售人员的销售额

```
select month(reportdate), salesperson, sum( the column you wish to sum )
from tablename
group by month(reportdate), salesperson; 
```

这显示了每个销售人员每月的总和。

*你知道德国人总是制造好东西！*

您希望看到相同的总和，但不是比较每个月的销售人员，而是想比较每个销售人员一个月到另一个月的表现？

只需通过以下方式反转组的顺序：

```
select month(reportdate), saleperson, sum( the column you wish to sum )
from tablename
group by salesperson, month(reportdate); 
```

*炸玉米饼、Fettuccini、Linguini、Martini、比基尼，你会爱上我的坚果的！*

SQL的力量！正如电视上所见！现在下单！

> “按月（报告日期）从表名组中选择月份（报告日期），求和（您要求和的列）；” 这很有帮助，谢谢。你很搞笑。但是，您能帮我澄清一下这段代码的去向吗？！在表达式生成器还是什么？太感谢了。– 里克（19 分钟前）

在 Access 中，我认为从图形查询生成器的菜单中选择编辑|SQL，然后键入。永远不要回到图形！

你是一个积极进取、有远见、有创业精神的人！这不是你父亲的奥兹莫比尔！您不会使用屏幕键盘键入文档、在页面上拖放字母，对吗？！那么为什么要构建一个 SQL 查询呢？进入 SQL！如电视上所见！所有很酷的孩子和 hep 猫都在做这件事！立即订购*！*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T21:51:32.277

您可以使用格式，例如：

```
Format([REPORTDATE],"mmm yy") 
```

或月份：

```
SELECT * FROM Table WHERE Month([REPORTDATE]) = 10 
```

可能适合的查询大纲，将其粘贴到查询设计窗口的 SQL 视图中，将表更改为表的名称：

```
SELECT Format([REPORTDATE],"yyyy mm"), Count([ReportDate])
FROM Table
GROUP BY Format([REPORTDATE],"yyyy mm") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T03:28:00.707

我不会在报告的记录源中这样做。我会让记录源成为常规的 SELECT 语句并使用报告的排序/分组。如果您对日期字段（真正的日期类型）进行分组，您可以选择 GROUP ON：

每个值（默认） 年 Qtr 月 周 日 时 分

我认为这比函数上的 GROUP BY 更快，但有兴趣的人应该实际尝试一下。

当然，如果您的 SELECT with GROUP BY 没有 WHERE 子句，那么如果您使用过滤值运行报告，效率会高得多。

# php - PHP - 最大总上传大小？

> ID：727736
> 
> 赞同：6
> 
> 时间：2009-04-07T21:51:02.717
> 
> 标签：php, upload, limit

我有一个包含 15 个字段的 php 网页。用户将使用它来上传图像。我通过上传 15 张 jpg 图像进行了测试，每张大约 2 M，没有任何问题。在我发布的那天，我将把这个网页移动到另一个 Linux 共享主机环境（仍然不确定是哪个）。是否有一些网络托管环境会限制一个 http 请求中的总上传大小？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-07T21:57:37.643

是的。有（据我所知）三个左右的配置设置会影响上传大小限制：

*   [`upload_max_filesize`](http://www.php.net/manual/en/ini.core.php#ini.upload-max-filesize), 设置上传文件大小的上限
*   [`post_max_size`](http://www.php.net/manual/en/ini.core.php#ini.post-max-size)，这限制了发布数据的总大小，包括文件数据
*   [`max_input_time`](http://www.php.net/manual/en/info.configuration.php#ini.max-input-time)，它限制允许脚本处理输入数据（包括发布的值）的时间长度

`upload_max_filesize`是对每个单独文件的限制；但是，`post_max_size`是整个请求的上限，包括所有上传的文件。

不同的托管环境会以不同的方式设置这些值，这可能会影响您在部署时的能力。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-07T22:00:09.340

上传限制是通过 php ini 设置的。您可以尝试像这样获取它们：

```
$post_max_size = ini_get('post_max_size');
$upload_max_filesize = ini_get('upload_max_filesize'); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-07T21:57:27.957

这是 php.ini 中的设置。您可以在 php 信息的输出中查看标记为“upload_max_filesize”的字段。要获取 php 信息页面，请使用以下代码创建一个 php 文件：

```
<?php phpinfo(); ?> 
```

[php.net 上的这篇文章](http://us3.php.net/manual/en/ini.core.php#79564)为您提供了获取该信息的示例代码，页面的其余部分是 php 配置选项的宝库。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-07T21:57:56.473

有一堆 PHP 设置限制了上传过程：

*   文件上传
*   上传最大文件大小
*   最大输入时间
*   内存限制
*   max_execution_time
*   post_max_size

我建议阅读此页面：[http ://www.radinks.com/upload/config.php](http://www.radinks.com/upload/config.php)

虽然其中许多确实不限制上传大小，但它们确实限制了上传过程 - 例如，如果内存限制太低，那么您将无法上传需要在内存中保留一段时间的大文件的时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T21:54:06.903

这将是不寻常的，但当然，请与您选择的任何托管公司联系。如果有限制，它肯定会高于 30 MB。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T21:57:19.907

php.ini 指令“post_max_size”应该限制您可以在单个 POST 中发送多少数据。如果您在一篇文章中发布 15 张图片，我很确定这仍然被视为一篇文章。所以在上线之前检查这个值可能会很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-04T05:48:16.617

如果您使用的是 nginx，请确保您具有以下内容：

```
server {
...
     client_max_body_size 100M;
....
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-16T18:42:56.627

这里：

```
max_execution_time
max_input_time
memory_limit
post_max_size
upload_max_filesize
max_file_uploads 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-04-25T17:10:25.433

到目前为止，我在[这里看到了最好的解决方案，这是代码：](http://www.kavoir.com/2010/02/php-get-the-file-uploading-limit-max-file-size-allowed-to-upload.html)

```
/**
 * Returns the maximally uploadable file size in megabytes
 *
 * @return  string
 */
function getMaxUploadSize()
{
   $max_upload    = (int)(ini_get('upload_max_filesize'));
   $max_post      = (int)(ini_get('post_max_size'));
   $memory_limit  = (int)(ini_get('memory_limit'));
   return min($max_upload, $max_post, $memory_limit);      
} 
```

# c++ - 为什么 stringstreams rdbuf() 和 str() 给我不同的输出？

> ID：727737
> 
> 赞同：6
> 
> 时间：2009-04-07T21:51:12.247
> 
> 标签：c++, std, stringstream, getline, sstream

我有这个代码，

```
int main()
{
    std::string st;
    std::stringstream ss;
    ss<<"hej hej med dig"<<std::endl;

    std::getline(ss,st,' ');
    std::cout <<"ss.rdbuf()->str() : " << ss.rdbuf()->str();
    std::cout <<"ss.rdbuf() : " << ss.rdbuf();
    return 0;
} 
```

给我这个输出

> ss.rdbuf()->str() : hej hej med dig
> 
> ss.rdbuf() : hej med dig

但这是为什么呢？是不是因为 ostreams 对 operator<str() 的定义给了我不同的输出。在我看来，即使我使用了 getline，输出也应该是相同的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-07T22:54:56.617

```
ss.rdbuf()->str(); 
```

返回所有缓冲区内容的副本。

在做什么`std::cout << ss.rdbuf();`？

见说明

```
basic_ostream<charT,traits>& operator<<(basic_streambuf<charT,traits>* sb); 
```

它从缓冲区中逐个字符地读取并将它们写入 ostream，直到出现 eof/写入失败/异常。

你已经读过buff的一个字。现在它读到了剩下的部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T22:16:17.897

引用关于 C++ 流 I/O、[Langer 和 Kreft](http://www.angelikalanger.com/iostreams.html)的圣经，在流缓冲区（即 rdbuf() 返回的东西）上调用 str()“行为非常违反直觉”（我的版本中的第 72 页）。对于完整的故事，你将不得不阅读这本书。

如果您在这里没有得到满意的答案，请尝试 usenet 组：

[http://groups.google.com/group/comp.lang.c++.moderated](http://groups.google.com/group/comp.lang.c++.moderated)

# content-management-system - 什么是最灵活的开源内容管理系统？

> ID：727748
> 
> 赞同：-1
> 
> 时间：2009-04-07T21:53:49.213
> 
> 标签：content-management-system, content-management

哪个 CMS 最灵活和/或可通过以下方式轻松修改：

*   让多个客户端访问 CMS，每个客户端有多个用户。每个客户端可以控制多个站点。

*   根据特定标准控制创建页面的布局。标准，例如用户希望将页面放入哪个部分/子部分。例如 - 如果所选页面的部分是 Clothing->Womens->Shorts，则仅允许选择某些布局。

它会是这样的： - 用户在 CMS 中创建一个新页面 - 他们选择页面的部分或子部分 - 基于该选择，我们控制是否允许他们使用所选的布局/模板。

这样做的原因是我们想要控制顶级页面的 UI（用户从那里进入网站）。并且，对较低嵌套页面的控制较少。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T05:35:49.243

2 个非常灵活的基于 PHP 的 CMS 框架是[Drupal](http://drupal.org/)和[Joomla](http://www.joomla.org/)。两者都建立在插件架构之上，您可以通过下载、安装和配置适当的插件来自定义您的应用程序，例如博客、论坛、搜索索引、RSS、存储和播放视频等...

Drupal 将他们的插件称为[Modules](http://drupal.org/project/modules)。有数千个模块可用（仅在实用程序类别中就有 700 多个）。 **警告**- 模块依赖于版本，并非所有模块都已升级为在 Drupal 的当前生产版本中运行，因此请注意版本支持。

Joomla 将他们的插件称为[Extensions](http://extensions.joomla.org/)。在发布时，他们有超过 4500 个扩展可用。我自己没有使用过 Joomla，所以我无法谈论它的质量或易用性，但它似乎确实是另一种非常受欢迎、灵活的产品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-18T10:19:45.137

我认为 Wordpress 是最好的内容管理系统之一。与其他 CMS 相比，它提供了更好的灵活性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T22:08:49.223

我刚刚发现这篇文章比较了[10 个基于 Java 的开源 cms 产品](http://blog.taragana.com/index.php/archive/top-10-java-content-management-software/)。我不知道您是否有特定的技术，但如果 Java 是您的事，其中之一可能会帮助您。

[http://blog.taragana.com/index.php/archive/top-10-java-content-management-software/](http://blog.taragana.com/index.php/archive/top-10-java-content-management-software/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-03T12:22:15.617

我正在使用带有 Alfresco 的 Jahia 作为使用 Communitiy 版本的文档存储库（没有 Alfresco 连接器，不太容易，但可以使用 REST）。

这确实是一个很好的解决方案，因为使用 Jahia 您可以添加一些 Java Spring 动态模块。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T22:28:41.693

看看 Jahia (www.jahia.com) - 基于 java 开源的 cms。您所描述的功能确实是典型的“站点工厂”，这是该 CMS 的主要业务案例。

阅读[http://www.jahia.com/jahia/webdav/site/jahiacom/shared/products/Jahia%20Sitefactory_WhitePaper.pdf](http://www.jahia.com/jahia/webdav/site/jahiacom/shared/products/Jahia%20Sitefactory_WhitePaper.pdf)并通过在线演示测试自己的功能。

# .net - 在 .NET 中导出圈复杂度

> ID：727756
> 
> 赞同：5
> 
> 时间：2009-04-07T21:56:59.550
> 
> 标签：.net, visual-studio, cyclomatic-complexity

我知道我可以通过右键单击并选择“计算代码度量”来访问我在 Visual Studio 2008 团队资源管理器中的代码的圈复杂度。我想公开这些数据以供 Web 应用程序显示。有人知道通过 API 访问这些数据的任何方式吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T22:02:44.123

我使用[NDepend](http://www.ndepend.com/)来处理类似的事情。您可以在 NDepend 中创建 CQL 查询并执行它们。
例子：

```
SELECT METHODS  WHERE CC > 8 
```

返回圈复杂度大于 8 的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-27T19:55:34.597

如this **[answer](https://stackoverflow.com/questions/1052269/free-c-metrics-calculation-library-dll/4005106#4005106)**中所述，可以利用**Gendarme**开源工具的 API 来计算方法的圈复杂度

```
ModuleDefinition module = ModuleDefinition.ReadModule(fullPathToTheAssembly);

foreach (var type in module.Types)
{
    foreach (var me in type.Methods)
    {
        if (!me.HasBody || me.IsGeneratedCode() || me.IsCompilerControlled)
            continue;
        var r = AvoidComplexMethodsRule.GetCyclomaticComplexity(me);

        Console.WriteLine("{0}: {1}", me.ToString(), r);
    }
}
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-20T15:36:31.297

没有 API。但是您可以阅读[Code Metrics Power Tool](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=edd1dfb0-b9fe-4e90-b6a6-5ed6f6f6e615)生成的 XML 文件。因此，您将通过命令行生成代码度量 XML 文件，例如：

```
metrics /f:MyAssembly.dll /o:MetricsResults.xml 
```

然后从 MetricsResults.xml 中获取您想要的数据。

更多关于电动工具的信息在[这里](http://blogs.msdn.com/b/camerons/archive/2011/01/28/code-metrics-from-the-command-line.aspx)。

如果您想在 TFS 构建中运行代码指标，请参阅[此处](http://blogs.msdn.com/b/slange/archive/2011/04/14/running-code-metrics-as-part-of-a-tfs-2010-build-the-poor-man-s-way.aspx)和[此处](http://geekswithblogs.net/jakob/archive/2011/01/30/integrating-code-metrics-in-tfs-2010-build.aspx)了解选项。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-07T22:04:39.657

我没有——Visual Studio 是否有*任何*此类 API？- 但计算圈复杂度相当容易。 [宪兵](http://mono-project.com/Gendarme)可能是你的答案。

# python - Python __str__ 和列表

> ID：727761
> 
> 赞同：124
> 
> 时间：2009-04-07T21:57:59.733
> 
> 标签：python

在 Java 中，如果我调用`List.toString()`，它会自动调用`toString()`List 中每个对象的方法。例如，如果我的列表包含 objects `o1`、`o2`和`o3`,`list.toString()`看起来像这样：

```
"[" + o1.toString() + ", " + o2.toString() + ", " + o3.toString() + "]" 
```

有没有办法在 Python 中获得类似的行为？我在我的类中实现了一个`__str__()`方法，但是当我打印出一个对象列表时，使用：

```
print 'my list is %s'%(list) 
```

它看起来像这样：

```
[<__main__.cell instance at 0x2a955e95f0>, <__main__.cell instance at 0x2a955e9638>, <__main__.cell instance at 0x2a955e9680>] 
```

我怎样才能让 python 为`__str__()`列表中的每个元素（或 dict ）自动调用我的？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2009-04-07T22:03:00.440

在 python 列表上调用 string 调用`__repr__`内部每个元素的方法。对于某些项目，`__str__`和`__repr__`是相同的。如果您想要这种行为，请执行以下操作：

```
def __str__(self):
    ...
def __repr__(self):
    return self.__str__() 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-04-07T22:03:09.487

您可以使用[列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)生成一个新列表，其中每个项目 str() 自动生成：

```
print([str(item) for item in mylist]) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-07T22:03:47.677

您可以做两件简单的事情，使用`map`函数或使用推导式。

但这会给你一个字符串列表，而不是字符串。因此，您还必须将字符串连接在一起。

```
s= ",".join( map( str, myList ) ) 
```

或者

```
s= ",".join( [ str(element) for element in myList ] ) 
```

然后你可以打印这个复合字符串对象。

```
print 'my list is %s'%( s ) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-07T22:06:53.800

根据您要使用该输出的目的，`__repr__`可能更合适：

```
import unittest

class A(object):
    def __init__(self, val):
        self.val = val

    def __repr__(self):
        return repr(self.val)

class Test(unittest.TestCase):
    def testMain(self):
        l = [A('a'), A('b')]
        self.assertEqual(repr(l), "['a', 'b']")

if __name__ == '__main__':
    unittest.main() 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-07T23:11:57.793

我同意先前关于使用列表推导来执行此操作的答案，但您当然可以将其隐藏在函数后面，如果那是您的船。

```
def is_list(value):
    if type(value) in (list, tuple): return True
    return False

def list_str(value):
    if not is_list(value): return str(value)
    return [list_str(v) for v in value] 
```

只是为了好玩，我递归地创建了 list_str() str() 列表中包含的所有内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-07T22:04:09.267

像这样的东西？

```
a = [1, 2 ,3]
[str(x) for x in a]
# ['1', '2', '3'] 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-06-06T17:12:07.477

这应该足够了。

打印列表以及其他容器类时，将使用 打印包含的元素`__repr__`，因为`__repr__`它旨在用于内部对象表示。如果我们调用：`help(object.__repr__)`它会告诉我们：

```
Help on wrapper_descriptor:

__repr__(self, /)
    Return repr(self). 
```

如果我们调用`help(repr)`它将输出：

```
Help on built-in function repr in module builtins:

repr(obj, /)
    Return the canonical string representation of the object.

    For many object types, including most builtins, eval(repr(obj)) == obj. 
```

如果`__str__`为对象实现而`__repr__`不是`repr(obj)`将输出默认输出，就像`print(obj)`未实现这些时一样。

所以唯一的方法是`__repr__`为你的班级实施。一种可能的方法是：

```
class C:           
    def __str__(self):
        return str(f"{self.__class__.__name__} class str ")

C.__repr__=C.__str__       
ci = C()    

print(ci)       #C class str 
print(str(ci))  #C class str 
print(repr(ci)) #C class str 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2019-01-25T22:12:47.340

你得到的输出只是对象的模块名、类名，然后是十六进制的内存地址，因为`__repr__`函数没有被覆盖。

`__str__`用于在使用 print 时对象的字符串表示。但是由于您正在打印对象列表，而不是遍历列表以调用`str`每个项目的方法，因此它会打印出对象表示。

要`__str__`调用该函数，您需要执行以下操作：

```
'my list is %s' % [str(x) for x in myList] 
```

如果您覆盖该`__repr__`功能，您可以像以前一样使用 print 方法：

```
class cell:
    def __init__(self, id):
        self.id = id
    def __str__(self):
        return str(self.id) # Or whatever
    def __repr__(self):
        return str(self) # function invoked when you try and print the whole list.

myList = [cell(1), cell(2), cell(3)]
'my list is %s' % myList 
```

然后你会得到 " `my list is [1, 2, 3]`" 作为你的输出。

# c++ - 我应该如何更改此声明？

> ID：727762
> 
> 赞同：3
> 
> 时间：2009-04-07T21:59:07.190
> 
> 标签：c++, arrays, resize

我得到了一个带有以下声明的标题：

```
//The index of 1 is used to make sure this is an array.
MyObject objs[1]; 
```

但是，我需要使这个数组在程序启动时动态调整大小。我认为我应该将它声明为 MyObject *objs;，但我认为如果原来的程序员这样声明，那是有原因的。

无论如何我可以动态调整它的大小吗？还是我应该将其更改为指针然后 malloc() ？

我可以以某种方式使用一些新的关键字来做到这一点吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-07T22:02:00.660

使用[STL 向量](http://www.sgi.com/tech/stl/Vector.html)：

```
#include <vector>

std::vector<MyObject> objs(size); 
```

向量是一个[动态数组](http://en.wikipedia.org/wiki/Array_list)，是[标准模板库](http://www.sgi.com/tech/stl/)的一部分。当您将对象[推回](http://www.cplusplus.com/reference/stl/vector/push_back/)数组时，它会自动调整大小，并且可以像使用[`[]`operator](http://www.cplusplus.com/reference/stl/vector/push_back/)的普通 C 数组一样访问。此外，如果容器不为空，`&objs[0]`则保证指向内存中的连续序列（与[列表不同）。](http://www.sgi.com/tech/stl/List.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-07T22:03:12.827

你是对的。如果要动态实例化其大小，则需要使用指针。

（既然您使用的是 C++，为什么不使用**new**运算符而不是*malloc*？）

```
MyObject* objs = new MyObject[size]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-07T22:40:50.660

> 还是我应该将其更改为指针然后 malloc() ？

如果这样做，将如何为 malloc 内存中的对象调用构造函数？我会给你一个提示 - 他们不会 - 你需要使用 std::vector。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T10:58:14.820

我只看到一个数组用作结构或联合中的指针。这是很久以前的事，用于将字符串的 len 和 first char 视为哈希，以提高脚本语言的字符串比较速度。

代码与此类似：

```
union small_string {
   struct {
      char len;
      char buff[1];
   };
   short hash;
}; 
```

然后使用 malloc 初始化 small_string，注意 c 转换实际上是 reinterpret_cast

```
small_string str = (small_string) malloc(len + 1);
strcpy(str.buff, val); 
```

并测试平等

```
int fast_str_equal(small_string str1, small_string str2)
{
   if (str1.hash == str2.hash)
      return strcmp(str1.buff, str2.buff) == 0;
   return 0;
} 
```

如您所见，这不是一种非常便携或安全的 c++ 风格。但是为由短字符串索引的关联数组提供了极大的速度改进，这是大多数脚本语言的基础。

我今天可能会避免这种风格的 c++。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T19:30:30.640

这是在某个结构的末尾吗？

我见过的一个技巧是声明一个结构

```
struct foo {
/* optional stuff here */
int arr[1];
} 
```

并且 malloc 比`sizeof (struct foo)`这样更多的内存`arr`成为一个可变大小的数组。

当我在破解 C 时，这在 C 程序中相当普遍，因为可变大小的数组不可用，并且进行额外的分配被认为太容易出错。

在几乎所有情况下，正确的做法是将数组更改为 STL 向量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T22:02:08.103

如果您想要一个动态调整大小的数组，最好使用 STL，有几个选项，一个是[std::vector](http://msdn.microsoft.com/en-us/library/9xd04bzs.aspx)。如果您不介意插入，也可以使用 std::list。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-07T22:27:20.443

它似乎 - 是的，你可以做这个改变。
但是在 sizeof( objs ); 上检查你的代码；

```
MyObj *arr1 = new MyObj[1];
MyObj arr2[1];

sizeof(arr1) != sizeof(arr2) 
```

也许这个事实在您的代码中的某个地方使用过。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-08T00:19:19.253

那个评论非常糟糕。即使注释另有说明，单元素数组也是数组。

我从未见过有人试图以这种方式强制执行“是一个数组”。数组语法很大程度上是语法糖（`a[2]`给出的结果与`2[a]`: 中的第三个元素相同`a`（**注意** [这是一种有趣且有效的语法，但通常使用起来非常糟糕，](http://www.fredosaurus.com/notes-cpp/arrayptr/arraysaspointers2.html)因为你会无缘无故地混淆程序员）） .

因为数组语法在很大程度上是语法糖，所以切换到指针也很有意义。但是，如果您要这样做，那么使用 with`new[]`更有意义（因为您可以免费调用构造函数），并且使用 with`std::vector`更有意义（因为您不必记住调用`delete[]`数组所在的每个位置由于返回、中断、语句结束、抛出异常等而超出范围）。

# c# - Asp.Net 将 SQL 数据绑定到中继器？

> ID：727766
> 
> 赞同：1
> 
> 时间：2009-04-07T22:01:02.660
> 
> 标签：c#, asp.net, sql, repeater

我正在尝试将数据从 SQL 绑定到转发器控件。我已经尝试过我通常为 Gridview 做的事情，但它不起作用。我想看一个例子，它是使用 SQLAdapter 还是从命令中使用 ExecuteReader。谢谢！

```
string sql = "SELECT [WallPost], [DatePosted] FROM [WallTable] WHERE [UserId] = '"
 + Request["friend"] + "'";

string strCon =      
System.Web.Configuration.WebConfigurationManager.ConnectionStrings["SocialSiteConnectionString"].ConnectionString;

SqlConnection conn = new SqlConnection(strCon);

SqlDataAdapter daUserProfile = new SqlDataAdapter(sql, conn);

dsSocialSite.UserProfileDataTable tbUserProfile = 
    new dsSocialSite.UserProfileDataTable();

daUserProfile.Fill(tbUserProfile);

rpWall2.DataSource = tbUserProfile; //rpWall2 = repeater control

rpWall2.DataBind(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T22:07:10.803

举一个我前几天敲过的例子

```
<%@ Page Language="C#" MasterPageFile="~/MasterPage.master" 
AutoEventWireup="true"CodeFile="Default.aspx.cs" Inherits="Default2"
Title="Untitled      Page" %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1"
Runat="Server">
<div id="Questions" align="center" style="background-color: #C0C0C0">
    <asp:Repeater ID="QuestionsRepeater" runat="server" 
         DataSourceID="SqlDataSourceQuestions">
    <ItemTemplate>
    <div align="left" style="text-indent: 15px">
        <asp:Label ID="Label1" 
         runat="server" Text= '<%# Eval("QCategory") %>' 
         Font-Bold="True" Font-Size="Medium"></asp:Label>
    </div>

        <br />
        <asp:RadioButtonList ID="RadioButtonList1" runat="server" 
         DataSourceID="SqlDataSourceRatings" DataTextField="RatingsCategory" 
         DataValueField="RatingsCategory"  RepeatDirection="Horizontal" >
        </asp:RadioButtonList>

    </ItemTemplate>
</asp:Repeater>

<asp:SqlDataSource ID="SqlDataSourceQuestions" runat="server" 
    ConnectionString="<%$ ConnectionStrings:sandboxConnectionString %>" 
    SelectCommand="SELECT [QCategory] FROM [QuestionsCategory]">
</asp:SqlDataSource>
<asp:SqlDataSource ID="SqlDataSourceRatings" runat="server" 
ConnectionString="<%$ ConnectionStrings:sandboxConnectionString %>" 
SelectCommand="SELECT [RatingsCategory], [RatingsId] FROM [Ratings]"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T22:21:12.830

使用转发器在 html（如 John Nolans 的回答）方面执行此操作更容易，因为它使用模板。

如果您想在后面的代码中执行此操作，请创建一个实现 ITemplate 的类，然后像这样放置它：

```
myRepeater.ItemTemplate = new MyTemplateClass(); 
```

# sql-server - 如何在 T-SQL 中使用变量作为数据库名称？

> ID：727788
> 
> 赞同：129
> 
> 时间：2009-04-07T22:04:19.983
> 
> 标签：sql-server

我在脚本中的几个地方使用了数据库名称，我希望能够快速更改它，所以我正在寻找这样的东西：

```
DECLARE @DBNAME VARCHAR(50)
SET @DBNAME = 'TEST'

CREATE DATABASE @DBNAME
GO
ALTER DATABASE @DBNAME SET COMPATIBILITY_LEVEL = 90
GO
ALTER DATABASE @DBNAME SET RECOVERY SIMPLE 
GO 
```

但它不起作用。那么编写此代码的正确方法是什么？

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2009-04-07T22:13:00.167

将整个脚本放入带有 {SERVERNAME} 占位符的模板字符串中。然后使用以下命令编辑字符串：

```
SET @SQL_SCRIPT = REPLACE(@TEMPLATE, '{SERVERNAME}', @DBNAME) 
```

然后运行它

```
EXECUTE (@SQL_SCRIPT) 
```

* * *

很难相信，在三年的时间里，没有人注意到我的代码**不起作用**！

你不能`EXEC`多批次。`GO`是批处理分隔符，而不是 T-SQL 语句。有必要构建三个单独的字符串，然后`EXEC`在替换后对每个字符串进行替换。

我想人们可以通过拆分将单个模板字符串分成多行来做一些“聪明”的事情`GO`；我已经在 ADO.NET 代码中做到了。

我从哪里得到“SERVERNAME”这个词？

这是我刚刚测试过的一些代码（并且有效）：

```
DECLARE @DBNAME VARCHAR(255)
SET @DBNAME = 'TestDB'

DECLARE @CREATE_TEMPLATE VARCHAR(MAX)
DECLARE @COMPAT_TEMPLATE VARCHAR(MAX)
DECLARE @RECOVERY_TEMPLATE VARCHAR(MAX)

SET @CREATE_TEMPLATE = 'CREATE DATABASE {DBNAME}'
SET @COMPAT_TEMPLATE='ALTER DATABASE {DBNAME} SET COMPATIBILITY_LEVEL = 90'
SET @RECOVERY_TEMPLATE='ALTER DATABASE {DBNAME} SET RECOVERY SIMPLE'

DECLARE @SQL_SCRIPT VARCHAR(MAX)

SET @SQL_SCRIPT = REPLACE(@CREATE_TEMPLATE, '{DBNAME}', @DBNAME)
EXECUTE (@SQL_SCRIPT)

SET @SQL_SCRIPT = REPLACE(@COMPAT_TEMPLATE, '{DBNAME}', @DBNAME)
EXECUTE (@SQL_SCRIPT)

SET @SQL_SCRIPT = REPLACE(@RECOVERY_TEMPLATE, '{DBNAME}', @DBNAME)
EXECUTE (@SQL_SCRIPT) 
```

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2012-02-11T15:46:41.607

您也可以[`sqlcmd`](http://www.simple-talk.com/sql/sql-tools/the-sqlcmd-workbench/)为此使用模式（在 Management Studio 的“查询”菜单上启用此功能）。

```
:setvar dbname "TEST" 

CREATE DATABASE $(dbname)
GO
ALTER DATABASE $(dbname) SET COMPATIBILITY_LEVEL = 90
GO
ALTER DATABASE $(dbname) SET RECOVERY SIMPLE 
GO 
```

**编辑：**

查看此[MSDN](https://msdn.microsoft.com/en-us/library/ms188714.aspx)文章以通过 SQLCMD 工具设置参数。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-04-07T22:10:28.707

不幸的是，您不能使用该格式的变量声明数据库名称。

对于您要完成的工作，您需要将语句包装在 EXEC() 语句中。所以你会有类似的东西：

```
DECLARE @Sql varchar(max) ='CREATE DATABASE ' + @DBNAME 
```

然后打电话

```
EXECUTE(@Sql) or sp_executesql(@Sql) 
```

执行 sql 字符串。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-07T22:10:23.793

您不能在 create table 语句中使用变量。我能建议的最好的事情是将整个查询写成一个字符串并执行它。

尝试这样的事情：

```
declare @query varchar(max);
set @query = 'create database TEST...';

exec (@query); 
```

# python - 传输 Python 模块

> ID：727791
> 
> 赞同：0
> 
> 时间：2009-04-07T22:05:47.673
> 
> 标签：python

基本上对于这种情况，我在 Python v2.6 中使用 _winreg 模块，但我必须使用的 python 包是 v2.5。当我尝试使用时：

```
_winreg.ExpandEnvironmentStrings 
```

它抱怨在这个模块中没有这个属性。我已经成功地从 site-packages 文件夹中转移了其他模块，例如 comtypes。

但问题是我不知道要复制/替换哪些文件。有没有办法做到这一点？站点包也是第 3 方模块的主要位置吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T22:11:50.730

它是一个编译的 C 扩展，而不是纯 Python，因此您通常不能简单地将 DLL/so 文件从一个安装复制到另一个安装：Python 二进制接口在 0.1 版本号更新（但不是 0.0.1 更新）时发生变化。在任何情况下，_winreg 似乎都是静态构建到当前官方 Windows 版本上的 Python.exe 中，而不是被放入“DLLs”文件夹中。

`_winreg.ExpandEnvironmentStrings`在 2.6 之前不可用，但~~您可以有用地回退到[`os.path.expandvars`](http://docs.python.org/library/os.path.html#os.path.expandvars)，它或多或少做同样的事情。（它还支持 $VAR 变量，在 Windows 下您可能不需要，但这可能不是一个实际问题。）~~您是对的：Windows 下的 expandvars 的 %-syntax 仅在 2.6 中引入，多么没用。看起来您需要以下内容。

如果最坏的情况发生在最坏的情况下，手写相当简单：

```
import re, os

def expandEnvironmentStrings(s):
    r= re.compile('%([^%]+)%')
    return r.sub(lambda m: os.environ.get(m.group(1), m.group(0)), s) 
```

尽管无论哪种方式，总有 Python 2.x 无法读取 Unicode 环境变量的担心。

# iphone - 为什么选择器需要数据源？

> ID：727792
> 
> 赞同：1
> 
> 时间：2009-04-07T22:06:39.057
> 
> 标签：iphone, picker

据我了解，Pickers 有一个 Delegate 类。为什么需要额外的数据源？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-07T23:26:15.730

委托和数据源之间存在差异。

数据源通常用于配置控件显示的内容。“你有多少行？”，“我应该在这一行显示什么”等。

委托通常用于让控制代码知道发生了什么事。“嘿，有人选择了这一行。”，“嘿，有人开始编辑这一行。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T23:25:09.977

因为选择器视图需要有关如何在每个段内填充表格的信息。

有时，让一个类处理数据的来源和另一个类处理如何处理数据可能很有用（MVC 模式）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T23:34:28.347

像大多数主管一样，拣货员很愚蠢。它不知道要做什么，所以它不断地被提供数据和任务（由提供者）；但它需要有人知道如何处理它。那是代表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T23:45:51.037

该 API 用于将数据源和委托方法组合到一个协议中（至少对于 UITableViews 而言），但它不灵活 - 现在您可以让一个完全不同的对象从负责处理的代码中提供要显示的数据使用选择器的机制。

通常，尽管您最终将两者都连接到同一个对象。

# ruby-on-rails - Rails：Active Record 销毁时出现未初始化的常量错误

> ID：727801
> 
> 赞同：13
> 
> 时间：2009-04-07T22:09:29.003
> 
> 标签：ruby-on-rails, activerecord, constants

尝试销毁活动记录实例时遇到问题。

它涉及以下AR

```
class Client < ActiveRecord::Base
    has_many :phone_numbers, :dependent => :destroy
    has_many :email_addresses, :dependent => :destroy
    has_many :user_clients , :dependent => :destroy
    has_many :users, :through => :user_clients 
end

class UserClient  < ActiveRecord::Base
belongs_to :user
belongs_to :client , :dependent => :destroy
has_many :instructions, :dependent => :destroy
end 
```

在客户端实例上执行销毁时，出现以下错误

```
@dead_man = Client.find(params[:id])
@dead_man.destroy => uninitialized constant UserClient::Instruction 
```

我真的不确定这个错误来自哪里。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-07T22:17:41.607

它没有找到你的指令模型。确保它在模型目录中，适当命名，extends`ActiveRecord::Base`等。

此外，您应该`:dependent => :destroy`从`belongs_to :client`UserClient 模型中的行中删除 ，除非您确实希望删除 user_client 以导致删除客户端。听起来应该是相反的，并且已经在 Client 模型中设置了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-06T10:35:11.187

还要检查文件名是否与类名相对应。就我而言，我有

```
Class NameSpace::MyStats 
```

在

```
namespace/old_stats.rb 
```

并且 Rails 一直抛出“未初始化的常量错误”，直到我将其更改为

```
namespace/my_stats.rb 
```

# java - 使用 Java 在 Mac 上存储用户名/密码

> ID：727812
> 
> 赞同：11
> 
> 时间：2009-04-07T22:12:27.390
> 
> 标签：java, security, macos, keychain

我正在用 Java 编写一个针对 Mac OS X 的小程序（推特客户端）。作为其功能的一部分，它需要有一个地方来存储推特用户名/​​密码。自然的地方是mac钥匙串，但我找不到任何访问它的方法。

有什么方法可以从 Java 访问 mac 钥匙串，或者如果没有，您建议在哪里存储用户名/密码？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-07T22:27:34.857

有 Java keychain API，因为在 OS X 上有一个[KeyStore的实现，](http://java.sun.com/j2se/1.5.0/docs/api/java/security/KeyStore.html)[由 keychain 支持](http://developer.apple.com/DOCUMENTATION/Java/Conceptual/Java14Development/04-JavaUIToolkits/JavaUIToolkits.html#//apple_ref/doc/uid/TP40001901-210260)。

我认为钥匙串是存储密码的最佳位置（如果不是*这个位置）。*它使用良好的算法进行加密，用户可以随意对应用程序的钥匙串的可用性随意或偏执，然后密码将与用户存储的所有其他密码一样存储和配置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-07T22:26:26.560

我还没有尝试过，但看起来您可以使用 Apple 加密提供程序 ( ) 访问密钥链，`com.apple.crypto.provider.Apple`创建一个`KeyStore`.`KeychainStore`

* * *

好的，经过一些实验，我能够访问`KeychainStore`. 但是，我的钥匙串中的密码没有显示（没有列出别名），当我尝试添加一个`KeyStore.SecretKeyEntry`（这是您需要保存密码的）时，它失败并显示消息“Key is not a PrivateKey” . 显然，Apple 不支持`SecretKeyEntry`.

如果您仍然想通过密钥链保护您的 Twitter 密码，我认为您可以得到的最接近的方法是生成一个 RSA 密钥对，自签名证书，并将 a 添加`PrivateKeyEntry`到密钥链中。然后您可以使用密钥对来保护 Twitter 密码。

自己签署证书并不难，但如果你走这条路，你可能想查看 BouncyCastle 库寻求帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-08T05:27:05.880

您应该查看有关 OAuth 支持的 twitters API 页面。通过使用 OAuth，您无需知道用户的 Twitter 密码。

[http://apiwiki.twitter.com/OAuth-FAQ](http://apiwiki.twitter.com/OAuth-FAQ)

# linker - 有没有办法知道哪个编译器生成了静态库？

> ID：727813
> 
> 赞同：10
> 
> 时间：2009-04-07T22:12:31.290
> 
> 标签：linker, build-process, solaris

第三方为我提供了一个静态库 (.a) 以在 solaris 站上链接。我尝试使用 sunpro 进行编译，但在链接步骤中失败了。

我想问题来自我使用的编译器（而不是 gcc？）或只是它的版本（因为编译器提供的 std lib 可能会从库 AFAIK 预期的版本发生变化，它可能会导致链接步骤出错）。

我怎么知道使用哪个编译器生成这个库？有没有一些工具可以做到这一点？sunpro/gcc 中的一些选项或其他什么？

***作为提示：****我前段时间读到编译器在生成目标文件时使用不同的修饰约定（真的吗？）。尽管如此，**“nm --demangle”**命令行仍然可以很好地打印出这个静态库中调试符号的所有函数名称。它是如何工作的 ？如果我的假设没问题，**nm**确实有办法解决静态库中使用的约定，不是吗？还是仅仅意味着 lib 是由 GNU gcc 生成的，因为 nm 是 GNU binutils 的一部分？*

我离我的工作站不近，所以我不能从链接器复制和粘贴错误输出（暂时不能，但我可以在进一步编辑中复制它们）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-07T23:51:00.337

从存档中提取目标文件，然后`strings`在其中一些文件上运行命令（首先在较小的文件上，因为筛选的噪音较小）。许多编译器在目标文件中插入 ASCII 签名。

例如，以下无意义的源文件`foo.c`：

```
extern void blah(); 
```

当在我的 Fedora 10 机器上编译成 foo.o 时，`gcc -c -o foo.o foo.c`结果是一个 647 字节的`foo.o`目标文件。运行结果`strings`_`foo.o`

```
GCC：（GNU）4.3.2 20081105（红帽 4.3.2-7）
.symtab
.strtab
.shstrtab
。文本
。数据
.bss
。评论
.note.GNU 堆栈
foo.c
```

这清楚地表明编译器是 GCC。即使我用`-fno-ident`.GNU-stack 注释 ELF 部分编译它，它仍然存在。

`ar`您可以使用实用程序或使用 Midnight Commander（集成 ar）提取目标文件，或者您可以简单地`strings`在存档上运行（这可能会给您带来更多噪音并且相关性较低，但仍然会有所帮助。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T04:31:36.543

我倾向于使用该`strings`程序（带有 ' `-a`' 选项，或者我自己的变体，其中 ' `-a`' 行为是标准的）并寻找迹象。例如，在我自己的一个库中，我发现：

```
/work1/gcc/v4.2.3/bin/../lib/gcc/sparc-sun-solaris2.10/4.2.3/include
/work1/gcc/v4.3.0/bin/../lib/gcc/sparc-sun-solaris2.10/4.3.0/include
/work1/gcc/v4.3.1/bin/../lib/gcc/sparc-sun-solaris2.10/4.3.1/include
/work1/gcc/v4.3.3/bin/../lib/gcc/sparc-sun-solaris2.10/4.3.3/include 
```

这表明库中的代码已经用各种版本的 GCC 编译了多年（实际上，在一个库中找到这么多版本，我很吃惊）。

另一个库包含：

```
cg: Sun Compiler Common 11 Patch 120760-06 2006/05/26
acomp: Sun C 5.8 Patch 121015-02 2006/03/29
iropt: Sun Compiler Common 11 Patch 120760-06 2006/05/26
/compilers/v11/SUNWspro/prod/bin/cc -O -v -Xa -xarch=v9 ... 
```

因此，目标文件中通常有指纹指示使用了哪个编译器。但你必须知道如何寻找它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T23:27:54.790

该库应该是 C 或 C++ 库吗？

如果它是一个 C 库，那么名称修饰就不是问题，因为 C 中没有。但是它可能是错误的格式。Unices 曾经有[a.out](http://en.wikipedia.org/wiki/A.out)格式的库，但几乎所有较新的版本都切换到更强大的格式，如[ELF](http://en.wikipedia.org/wiki/Executable_and_Linkable_Format)。

如果它是一个 C++ 库，那么名称修改可能是一个问题。大多数编译器在代码中嵌入了一些特定于编译器的符号，所以如果你有一个像 nm 这样的工具来列出符号，你可以希望从它来自的编译器中推断出来。

例如 g++ 创建一个符号

> __gxx_personality_v0

在它的图书馆里

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-07T22:22:25.307

您可以尝试使用 unix 实用程序*文件*：

```
file foo.a 
```

# c# - C# tab gui，隐藏正文？

> ID：727820
> 
> 赞同：0
> 
> 时间：2009-04-07T22:16:49.330
> 
> 标签：c#, user-interface, tabcontrol

我如何摆脱我的 tabControl 中的身体？以及如何添加和删除标签页？我需要在代码中添加/删除标签页，但在代码或编辑器中隐藏正文。我尝试使 tabControl 高度 <20 但无论它有一条线显示它有多宽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T22:25:53.817

“隐藏身体”是什么意思？如果您指的是标签的“页面”部分，那么如果您只能看到标签，它就不再是真正的标签页。你想达到什么目的？选项卡控件很可能不是最好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T22:26:41.023

您可以在代码中创建新的标签页并将它们添加到 TabControl 的 Controls 集合中：

```
private System.Windows.Forms.TabPage tabPage1;        
this.tabPage1 = new System.Windows.Forms.TabPage();           
this.tabControl1.Controls.Add(this.tabPage1); 
```

您可以使用以下代码隐藏选项卡控件：

```
tabControl1.Hide(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T22:37:30.623

据我所知，对于没有每个选项卡的页面的一行选项卡没有内置控件。

你可以用面板覆盖身体。如果您仔细调整面板的大小，它应该看起来没问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-22T16:10:12.140

要对用户隐藏标签页，只需将其从 tabControl.TabPages 集合中删除，如下所示：

```
tabControl1.TabPages.Remove(tabPage1); 
```

# crystal-reports - Crystal Reports 图像在 Web 查看器中不可见

> ID：727825
> 
> 赞同：4
> 
> 时间：2009-04-07T22:18:49.433
> 
> 标签：crystal-reports

我继承的应用程序 (.NET 1.1) 中有一些 Crystal Reports (V10)，部署在四个“相同”的环境中。在其中三个环境中，它们运行良好。第四，图表图形在 Web 查看器中不可见。如果您导出报告，它们是可见的。

IT 人员发誓所有四种环境中的一切都完全相同，并将问题转回给我解决。我不知道该怎么做，因为我无法亲自到服务器检查任何东西。但我不明白这怎么可能不是环境问题。

在我看来，Crystal 具有写入文件和检索它以呈现报表的导出版本的必要权限，但 ASP WP 在呈现页面时无法访问图形文件。

感谢您可能需要帮助我的任何建议！

**来自 IT 人员的解决方案** ：“我们必须将 IIS 中 CrystalReportsViewer10 文件夹上的“执行权限”从“仅脚本”更改为“脚本和可执行文件”。所有其他站点都只有“仅脚本”，它们很好。”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-02-02T02:00:59.447

我可以在开发环境中解决这个问题，将下一个键（处理程序）添加到 web.config：

```
<system.webServer>
  <handlers>
    <add name="CrystalImageHandler.aspx_GET" verb="GET" path="CrystalImageHandler.aspx" type="CrystalDecisions.Web.CrystalImageHandler, CrystalDecisions.Web, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304" preCondition="integratedMode"/>
  </handlers>
</system.webServer>

<system.web>
  <httpHandlers>
    <add verb="GET" path="CrystalImageHandler.aspx" type="CrystalDecisions.Web.CrystalImageHandler, CrystalDecisions.Web, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304"/>
  </httpHandlers>
</system.web> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T04:02:23.290

需要有一个名为“CrystalReportViewers115”之类的 IIS 虚拟目录。我认为版本之间的确切名称会发生​​变化。这需要对您的 ASP.NET 用户可见。开始查看可以工作的环境，看看它们是否安装了这个虚拟目录，并将其与失败环境中的目录进行比较。作为另一项检查，您应该能够将图像的 URL 输入到浏览器中并查看它们。要查找 URL，请右键单击图片并选择“属性”。例如：
[http://localhost/crystalreportviewers/images/toolbar/export.gif](http://localhost/crystalreportviewers/images/toolbar/export.gif)
当您直接浏览到 URL 时应该会看到图片。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-23T14:22:24.870

转到开始->程序->Microsoft Visualstudio 2008->Visual Studio 工具->Visual Studio 2008 命令提示符

并输入

aspnet_regiis -c

* * *

这将自动复制相应的文件...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T18:15:15.000

`aspnet_client`在站点的源文件夹中添加文件夹。例子：

```
C:\inetpub\wwwroot\myapplication\aspnet_client\system_web\4_0_30319\CrystalReportWebFormViewer4 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-24T12:55:03.263

我最近遇到了这个问题：虽然我的解决方案有点不同：

*   我尝试在 web.config 中设置处理程序，但这并没有解决它。
*   我尝试在 IIS 中设置脚本和可执行文件，但这并没有解决它。

一旦我进入 C:\Program Files\Common Files\Crystal Decisions\2.5\crystalreportviewers10 文件夹并关闭自定义错误，我可以看到错误来自 C:\Windows\Temp\ 上的访问被拒绝问题

解决方案是不使用处理程序或更改 IIS 来运行脚本和可执行文件，它是允许网络服务读取 C:\Windows\Temp\ 上的权限

**编辑：** 认为我找到了另一个不需要更改权限的解决方案......只需为 aspnet_client 设置一个虚拟目录；您选择的级别很大程度上取决于您的 IIS 布局。

# asp.net - 部署服务器上的验证器停止工作

> ID：727828
> 
> 赞同：0
> 
> 时间：2009-04-07T22:21:08.040
> 
> 标签：asp.net, asp.net-2.0, validation

这很奇怪而且令人费解。在我的 ASP.NET 2.0 应用程序中，我有一个使用多个客户端验证器的表单。自定义、正则表达式和必填字段。我的应用程序要求我根据下拉选择启用或禁用某些验证器。我在我的代码隐藏事件中这样做。所有这些在我的开发环境中都很好用，但是当我部署到服务器时它就不行了。主要是当我从服务器运行应用程序时，它不允许我启用或禁用代码中的验证器。当我在 aspx 文件中设置 enabled 属性时，无论我在服务器事件中做什么，它都会保持该状态。再次 - 这在开发中完美运行。有什么建议么？会不会是我的开发机器和服务器上的 .NET 2.0 版本不同？我很茫然，我们很快就要投入生产了。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T13:27:23.027

这原来是一个 .NET 版本的问题。一旦我在服务器上应用了 2.0 Service Pack 2，我的问题就消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T22:31:17.830

验证器是否在生产机器上工作？也就是说，它们是否会阻止您输入无效数据？

我对发生在我身上的类似事情有模糊的回忆。这可能是验证器所需的 JavaScript 文件没有从服务器发送的问题。查看源代码，或打开调试（FireBug 或 IE8 的 F12 命令）。看看你是否遇到了你不知道的 JavaScript 错误。

# .net - DotNetOpenId --“此消息已被处理”错误

> ID：727838
> 
> 赞同：1
> 
> 时间：2009-04-07T22:25:34.253
> 
> 标签：.net, openid, dotnetopenauth

我从使用 dotnetopenid 库的 OpenId 开始，到目前为止，一切都很好，但是当我尝试登录时，它向我显示以下消息：

> **此消息已被** **处理。这可能表明** **正在进行重放攻击。**

我第一次使用我的应用程序失败了，之后总是返回上面的消息。

如何“注销”用于测试的用户，或者如何清除请求以便登录/注销？

提前致谢！=)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T18:10:47.853

我发现了问题，一个像往常一样的问题......

我不止一次调用**GetResponse ，这让我收到了错误消息。**

很抱歉给您带来不便，感谢您的回答=）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T01:45:04.853

重放攻击消息通常是因为您在浏览器上单击了刷新，而您的浏览器中的 URL 中仍有一堆 OpenID 参数。尝试清除之后的所有内容？标记，或者只是重新输入 URL 并按 Enter。如果这不起作用，请尝试在 URL 中添加一个问号并按 Enter。

如何注销？DotNetOpenId 默认使用表单身份验证，因此您可以通过调用 FormsAuthentication.SignOut() 注销用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-04T12:56:05.437

在某些版本的 dotnetopenauth 中，您还可以获得：

> 此消息已被处理。这可能表明正在进行重放攻击。

如果您的 maxAuthenticationTime 值太低（这显然与错误无关 - 但这是一个不同的问题）。我今天刚刚经历过。

要增加此值，请编辑配置条目，如[http://www.dotnetopenauth.net/developers/help/configuration-options/](http://www.dotnetopenauth.net/developers/help/configuration-options/)所示（我建议设置为 0:10）。

# java - javax 与 java 包

> ID：727844
> 
> 赞同：437
> 
> 时间：2009-04-07T22:28:40.567
> 
> 标签：java

javax 包背后的基本原理是什么？什么进入java，什么进入javax？

我知道很多企业级包都在 javax 中，但 Swing、新的日期和时间 api (JSR-310) 和其他 J2SE 包也是如此。

* * *

## 回答 #1

> 赞同：259
> 
> 时间：2009-04-08T00:26:58.020

最初`javax`的目的是为了扩展，有时事情会被提升`javax`到java中。

一个问题是 Netscape（可能还有 IE）限制了可能在 java 包中的类。

当 Swing 被设置为“毕业”到`java`from`javax`时，出现了一种小型爆炸，因为人们意识到他们将不得不修改所有的导入。鉴于向后兼容性是 Java 的主要目标之一，他们改变了主意。

在那个时候，至少对于社区（也许不是对于 Sun）来说，这一切`javax`都失去了意义。所以现在我们在 javax 中有一些东西可能应该在`java`......但除了选择包名称的人之外，我不知道是否有人可以根据具体情况弄清楚基本原理是什么。

* * *

## 回答 #2

> 赞同：231
> 
> 时间：2009-04-07T22:32:01.557

我认为这是一件历史性的事情——如果一个包是作为现有 JRE 的补充而引入的，它会以`javax`. 如果它最初是作为JRE 的*一部分*引入的（我相信就像 NIO 一样），那么它会以`java`. 不知道为什么新的日期和时间 API 最终会`javax`遵循这个逻辑......除非它也可以作为一个库单独提供以与早期版本一起使用（这将很有用）。**多年后的注意事项：它（日期和时间 API）实际上最终还是在`java`其中。**

我相信对包有限制`java`- 我认为类加载器设置为*只*允许`java.*`从中加载类`rt.jar`或类似的东西。（肯定有签到`ClassLoader.preDefineClass`。）

编辑：虽然官方解释（搜索 orbfish 建议在第一页左右没有产生一个）毫无疑问是关于“核心”与“扩展”，但我仍然怀疑在许多情况下，任何特定包的决定都有一个其背后的历史原因也是如此。例如，这`java.beans`真的是 Java 的“核心”吗？

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2009-04-07T22:32:47.093

`java`包是**基础**，`javax`包是扩展。

Swing 是一个扩展，因为 AWT 是最初的 UI API。Swing 紧随其后，在 1.1 版中。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2009-04-08T00:18:22.690

javax 命名空间*通常*（这是一个加载的词）用于标准扩展，目前称为[可选包](http://java.sun.com/j2se/1.5.0/docs/guide/extensions/index.html)。标准扩展是非核心 API 的子集；非核心 API 的另一部分显然称为非标准扩展，占用了 com.sun.* 或 com.ibm 等命名空间。*. 核心 API 占用了 java.lang.* 命名空间。

并非 Java API 世界中的所有内容都从核心开始，这就是为什么扩展通常源于 JSR 请求的原因。他们最终被提升为基于“明智的建议”的核心。

对这种命名法的兴趣源于 Sun 的失礼——扩展本可以提升为核心，即从 javax.* 移动到 java.*，这违反了向后兼容的承诺。程序员声音嘶哑，更好的理智占了上风。这就是为什么 Swing API 虽然是核心的一部分，但仍然保留在 javax.* 命名空间中。这也是软件包从扩展升级到核心的方式——它们只是作为 JDK 和 JRE 的一部分提供下载。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-09-04T23:42:04.800

Javax 过去只用于扩展。然而后来 sun 将它添加到 java 库中忘记删除 x。开发人员开始使用 javax 编写代码。然而后来，suns 决定将其更改为 java。开发人员不喜欢这个想法，因为他们的代码会被破坏......所以保留了 javax。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-08-30T09:48:42.063

java.* 包是核心 Java 语言包，这意味着使用 Java 语言的程序员必须使用它们才能对 Java 语言进行任何有价值的使用。

javax.* 包是可选包，它提供了一种标准的、可扩展的方式，使自定义 API 可用于在 Java 平台上运行的所有应用程序。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-03-28T06:03:06.120

一些包，比如`javax.swing`最初没有包含在 java 标准库中。Sun 公司决定将它们视为官方的，并将它们作为标准库或标准扩展包含在 Java 的早期版本中。

按照惯例，所有标准扩展都以一段时间开始，`X`随着时间的推移它们可以提升为一流，就像`javax.swing`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-08T19:25:35.847

所有的**javax**包都旨在成为实验包。当 Swing 足够稳定并准备好转移到**java**包时，那里有太多代码，他们决定保留它，以保持他们对向后兼容性的承诺。这在由 Laura Lemay 和 Rogers Candedhead 撰写的 Sams 社论中的 21 天学习 Java 一书中对此进行了解释。

# estimation - 在不花费大量时间的情况下进行估算的最佳方法是什么？

> ID：727855
> 
> 赞同：5
> 
> 时间：2009-04-07T22:32:58.060
> 
> 标签：estimation

## 背景

我的团队目前正处于发布重大重写的“错误修复和抛光”阶段。我们仍然有大量的错误需要修复，计划针对几个里程碑。我们被要求估计需要多少工程工作来修复每个里程碑的错误。

对于之前的里程碑，我们遵循以下流程：

*   将错误分配给最了解该代码区域的人，并且很可能是修复错误的人。
*   让每个人检查分配给他们的错误，并估计他们认为修复错误需要多长时间，以小时为单位。如果一个 bug 看起来可能需要一两天以上的时间来修复，他们会将 bug 分解为可能的子任务，并对其进行估计。
*   总计每个里程碑分配给每个人的工作量，如果人们的工作量大不相同，请尝试平衡事情。
*   将每个里程碑的每个人的总数乘以“填充因子”，以解释过于乐观的估计（我们一直使用 1.5）。
*   取给定版本的团队成员的最大总数，并确定团队关闭现有错误所需的时间。
*   估计我们在达到特定里程碑所需的时间内预计会创建的错误数量，并估计我们认为关闭这些错误中的每一个平均需要多长时间。将此添加到关闭每个版本的现有错误的时间。这是我们所需工作量的最终数量，作为我们确定交付该里程碑的日期交付。

这是相当准确的（我们在之前的三个里程碑中几乎处于同一位置），但它相当耗时。

## 当前问题

我们被要求为即将到来的里程碑估计工程时间，但要求不要使用上述过程，因为它太耗时。相反，作为团队的技术负责人，我被要求提供不太确定的估计值，以及确定的时间间隔（即 1 个月，正负一周）。

我的主要估算经验是我上面描述的方法的一些变化（来自多年的自由职业背景）。我发现当我在大型任务中“从臀部射击”时，我往往会走得很远。我怀疑在估计修复我不太了解的代码区域中的错误需要多长时间时，情况会更糟。

**您发现哪些技巧、窍门或技术可以成功地进行快速估算，而无需将事情分解成细粒度的任务并进行估算？**

不能选择的事情：

*   没有给出估计 - 我试过这个，它没有飞:)
*   选择一个非常宽的数字和置信区间 - 我已经考虑过这一点，但我认为它也不会飞。
*   基于证据的调度 - 我们使用的是 JIRA，它没有任何为其编写的基于证据的调度工具，我们目前无法迁移到 FogBugz（顺便说一句，如果有人去编写一个基于证据的调度插件JIRA，我们很乐意为此付费）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-07T22:50:01.233

估算的最佳技巧：将大量数据四舍五入。

听起来您已经是估算主题的专家，并且您知道可能发生的事情的局限性。如果不评估完成任务需要做什么，就不可能估计任务！

评估的时间量与估计的准确性成正比。这些事情会在时间评估如此准确的时候收敛，你已经解决了任务，在那一刻，你确切地知道需要多长时间。

嗯，对不起，这可能不是你想听到的答案……不过这只是我的想法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-07T22:54:41.393

1.  随时准备创建版本
2.  让利益相关者优先考虑完成的工作
3.  处理优先级最高的项目

第 1 步意味着您永远不会错过最后期限。

第 2 步是一种将问题转回到那些要求您进行估算而无需花费时间估算的人的方法。

编辑...

以上并没有真正回答你的问题，对不起。

利益相关者将希望根据每项任务的时间和成本来确定工作的优先级，并且您可能会被问到您希望在下一个截止日期之前能够完成哪些优先级最高的更改。

我花费最少时间的技巧是使用三倍于我认为需要多长时间的印象。

您正在寻找比这更长的时间，但不像您之前的出色估计那样长。

您仍然需要查看每个错误，即使只是猜测它是容易、平均还是棘手，或者工作 1、2、4、8、16 或 32 小时。

如果您在代码库上生成一些代码复杂度指标（例如圈复杂度），并且对于每个任务，请尝试在该代码库中最需要更改的两个或三个部分，然后根据以下假设进行估计较不复杂的代码部分将比更复杂的部分更改得更快。您可以根据之前的一些估计提出一些启发式方法，用于每个错误修复，估计所需的时间和可变性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-08T01:05:04.137

怎么样：

```
estimate=(bugs/devs)xdays (xK) 
```

就这么简单，它实际上是相当准确的。并且可以在1分钟内估算。它的置信水平低于您的详细方法，但我建议您检查最后三个里程碑的数据，并检查此快速估算与您的详细估算之间的差异，这将为您提供代表团队常数的**“K”值。**

惊奇。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T01:56:28.537

用最简单的话来说：

**您最绝对自由的估计 * 3 = 您的估计**

以上可能看起来像个笑话，但事实并非如此。我已经用过很多次了。任何类型的软件项目的时间估算都是一场游戏，就像与汽车经销商做交易一样。该公式将为您提供一些东西，以在紧要关头为您的管理提供帮助，并为您提供一些玩耍的空间。

但是，如果您能够以某种方式了解更精细的细节（这实际上是您能够更准确的唯一方法），Google on [Function Point Analysis](http://en.wikipedia.org/wiki/Function_point_analysis)，有时称为“快速功能点分析”或“快速功能点估计”。

许多人有无数的电子表格、PDF 等可以帮助您尽快估算。首先查看电子表格，因为它们会为您内置公式。

希望这可以帮助！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-07T22:53:55.637

您一直在问如何产生估计和不确定区间。考虑这一点的更好方法是进行最坏情况估计和最佳情况估计。将两者结合起来就有一个估计范围。很好理解的问题自然会比对不太了解的问题的估计更具体。例如，一个看起来像 1.5-2 天的估计可能是一个很好理解的问题，一个看起来像 2-14 天的估计对于一个根本不理解的问题来说是典型的。通过允许估计值之间的更大差距来限制调查量和生成估计值所花费的时间。这是有效的，因为它相对容易想象现实的最佳情况和最坏情况。当不确定性范围超出您在日程安排中的承受能力时，然后花一些时间来了解不太了解的问题。分解它们可能会有所帮助。

如果整个工作预计需要一周以上的时间，我通常会在我的估计中选择半天粒度而不是小时粒度。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-07T22:59:39.477

使用 Planning Poker，查看[如何估计编程任务长度的答案](https://stackoverflow.com/questions/14279/how-to-estimate-the-length-of-a-programming-task)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-07T22:51:51.960

```
public static class Time
    {
        /// <summary>
        /// Estimates the hours.
        /// </summary>
        /// <param name="NumberPulledFromAss">The number pulled from ass.</param>
        /// <param name="Priority">The priority.</param>
        /// <param name="Complexity">The complexity.</param>
        /// <returns>
        ///  a number in hours to estimate the time to complete a task.
        /// Hey,  you will be wrong anyway why waste more time than you need?
        /// </returns>
        public static int EstimateHours(int NumberPulledFromAss, int Priority, int Complexity)
        {
            var rand = new Random(NumberPulledFromAss);
            var baseGuess = rand.Next(1, NumberPulledFromAss);
            return (baseGuess + (Priority * Complexity)) * 2;
        }
    } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-07T22:55:16.697

您的估计与您投入的时间一样准确。这个时间可以是分解问题的实际时间，也可以是在你熟悉的领域借鉴过去的经验。如果这不是一个选项，请尝试将错误/抛光分成几组。

1.  几个小时的微不足道的修复。
2.  最多一天的努力。
3.  非常复杂 - 一周的努力。

一旦你对这些进行了分类，你就可以做出一个粗略的猜测。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-07T22:58:10.667

敏捷博客上的这篇文章中的许多提示可能很有用：[Agile Estimating](https://web.archive.org/web/20090409140942/http://www.agile-software-development.com/2009/04/agile-estimating.html)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-07T22:40:39.787

计算估计值的可变性将比计算估计值花费更长的时间。

# c# - MSDTC 的 WCF Windows 服务问题

> ID：727857
> 
> 赞同：2
> 
> 时间：2009-04-07T22:33:41.723
> 
> 标签：c#, wcf, windows-services, msdtc

我有一个 .net 3.5 windows 服务，它使用在 2008 应用程序服务器上运行的 msmq。该服务与数据库服务器上的 sql 2005 数据库通信。

在 2008 Web 服务器上从我的 aspx 页面调用此服务时，我收到下面提到的错误：

“分布式事务管理器 (MSDTC) 的网络访问已被禁用。请使用组件服务管理工具在 MSDTC 的安全配置中启用 DTC 进行网络访问。事务管理器已禁用其对远程/网络事务的支持。（来自 HRESULT 的异常: 0x8004D024)"

我遵循了这个指示，但没有运气。

当我调试代码时，在我的 Windows 服务代码中的一行尝试使用 ExecuteNonQuery 方法执行存储过程时会抛出上述错误。

我在这里想念什么？

仅供参考，我在网络服务器上的 web.config 看起来像：

```
<netMsmqBinding>
    <binding name="NetMsmqBinding_IWcfEmailService" closeTimeout="00:01:00"
        openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
        deadLetterQueue="System" durable="true" exactlyOnce="true"
        maxReceivedMessageSize="5000000" maxRetryCycles="2"
        receiveErrorHandling="Fault"
        receiveRetryCount="5" retryCycleDelay="00:30:00" timeToLive="1.00:00:00"
        useSourceJournal="false" useMsmqTracing="false" queueTransferProtocol="Native"
        maxBufferPoolSize="524288" useActiveDirectory="false">
      <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
          maxBytesPerRead="4096" maxNameTableCharCount="16384" />
      <security mode="None">
        <transport msmqAuthenticationMode="WindowsDomain"
            msmqEncryptionAlgorithm="RC4Stream"
            msmqProtectionLevel="Sign" msmqSecureHashAlgorithm="Sha1" />
        <message clientCredentialType="Windows" />
      </security>
    </binding>
</netMsmqBinding> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-26T19:21:15.270

您需要启用 msdtc。看：

[如何在 SQL Server 上启用 MSDTC？](https://stackoverflow.com/questions/7694/how-do-i-enable-mstdc-on-sqlserver)

您还必须对 SQL Server 说它应该允许连接（远程 TCP？）。这可以通过 SQL Server 外围应用配置来完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-26T19:31:14.703

我假设您已启用 DTC 进行远程访问...

```
Administrative Tools –&gt; 
Component Services –&gt; 
My Computer properties –&gt;
MSDTC tab –&gt; 
Security Configuration tab –&gt;
Network DTC Access (checked) 
```

如果是这样，这里有一个方便的[DTC 故障排除指南](http://msdn.microsoft.com/en-us/library/aa561924.aspx)。它以 BizTalk 为中心，但概念是相同的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-08T00:47:47.080

您是否也尝试过在数据库服务器上启用网络访问？您可以指定连接上的几个选项来控制驱动程序如何参与事务。

# asp.net-ajax - UpdatePanel 让我发疯 - 动态创建的 UpdatePanel 问题

> ID：727859
> 
> 赞同：1
> 
> 时间：2009-04-07T22:36:07.473
> 
> 标签：asp.net-ajax, updatepanel

所以，我在 Page_Load 中有以下代码：

```
updDesignations = new UpdatePanel();
updDesignations.ContentTemplateContainer.Controls.Add(toutLineDesignation);            
updDesignations.ChildrenAsTriggers = true;
updDesignations.UpdateMode = UpdatePanelUpdateMode.Always;            
divDesignations.Controls.AddAt(0,updDesignations); 
```

当我单击这个动态创建的更新面板中的链接按钮时，会在服务器上调用相应的事件处理程序。但是，所做的任何更改都不会保留回客户端，并且来自更新面板 AJAX 调用的 HTTP 响应始终为空：

请求格式正确，并包含正确的表单提交信息，响应很简单：

```
Server  Microsoft-IIS/5.1
Date    Tue, 07 Apr 2009 22:30:57 GMT
X-Powered-By    ASP.NET
X-AspNet-Version    2.0.50727
Cache-Control   no-cache, no-store
Pragma  no-cache
Expires  -1
Content-Length  0 
```

这让我抓狂，因为这必须是一个动态创建的更新面板。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T22:47:12.673

尝试在此 UpdatePanel 上设置一个 ID。UpdatePanel 在没有 ID 时会生气。我已经解决了他们许多奇怪的问题，只是确保他们有一个 ID。

# .net - .NET 服务的 LiveUpdate

> ID：727873
> 
> 赞同：0
> 
> 时间：2009-04-07T22:41:48.130
> 
> 标签：.net, windows

我正在构建一个基于 .NET 的 Windows 服务。它的部分功能应该是检查网站上是否有更新版本的自身。然后它应该下载新的“包”并以某种方式升级自身。任何人都知道可以提供帮助的任何图书馆吗？我假设我会遇到覆盖当前正在运行的可执行文件的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-13T18:12:52.570

如果您想绕过 Vista UAC 提示，您可以在本地系统帐户上运行管理服务并使用此服务更新应用程序。

1.  应用程序检查更新并在需要时下载。
2.  如果需要更新运行助手应用程序（保持应用程序启动的权限，如果这不是问题（例如，不介意应用程序以管理员身份重新启动）跳过此步骤）。
3.  助手应用程序调用管理服务。
4.  管理服务停止应用程序并更新它。
5.  管理员服务调用帮助应用程序说更新完成。
6.  帮助应用程序重新启动应用程序。

我们目前在 2000、XP 和 Vista 上使用这个系统，用户不必是管理员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-31T20:42:25.920

将大部分功能放在类程序集中，并使用通用接口程序集动态加载它以共享类型。当服务首次启动时，检查新版本并在动态加载之前覆盖现有版本。

# dll - 在fitnesse夹具中动态加载dll

> ID：727878
> 
> 赞同：1
> 
> 时间：2009-04-07T22:42:58.130
> 
> 标签：dll, load, fixtures, fitnesse

我正在尝试针对接口（在 c# 中）编写 FitNesse 夹具。我希望能够让夹具从 dll 动态加载实现（这样我就可以对同一接口的不同实现使用相同的测试......即模拟数据、实时数据等）。我的夹具中有一个 init 方法，它接受 2 个字符串、一个类名和一个 dll 名。我在方法中调用了 Assembly.LoadFrom(dllname)。该调用出现以下错误：“URL 上的目录无效”。

有任何想法吗？听起来 dll 名称在翻译中以某种方式被破坏了......

该表如下所示：|Init Provider From Dll|SlmLicenseDataErrorProvider|TestModelProvider.dll|

提前致谢...

-罗伯特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T19:48:51.973

您可能希望在某处添加一个 !path 以指向程序集的位置。默认情况下，Fitnesse.Net（或 FitSharp，或现在的任何东西）通常会将其工作目录默认为 FitServer.exe 可执行文件（或 SlimServer.exe 或现在的任何东西）的位置。如果您的程序集不在该目录中，或者在默认程序集搜索路径或 GAC 中，那么 fitmente 可能根本找不到它？

# .net - 异常：无法检索此帧异常的安全描述符

> ID：727888
> 
> 赞同：1
> 
> 时间：2009-04-07T22:48:13.903
> 
> 标签：.net

当我尝试加载 XSL 电子表格时，会引发主题行的异常。调用堆栈附在下面。这个程序在各种样式表上工作了一段时间，现在它在一些通勤者上工作，但在其他一些人身上抛出这个异常。我在互联网上查找了它，但这[是](http://social.msdn.microsoft.com/forums/en-US/xmlandnetfx/thread/c5ba915d-d35b-4170-96b1-fb2b107f8779)我能找到的全部，除了对某些安全更新的一些模糊怀疑之外，它没有给出任何答案。我不知所措。有任何想法吗？

```
at System.Security.SecurityRuntime.RevertAssert(StackCrawlMark& stackMark)
at System.Security.CodeAccessPermission.RevertAssert()
at System.Xml.Xsl.XmlILGenerator.Generate(QilExpression query, TypeBuilder typeBldr)
at System.Xml.Xsl.XslCompiledTransform.CompileQilToMsil(XsltSettings settings)
at System.Xml.Xsl.XslCompiledTransform.LoadInternal(Object stylesheet, XsltSettings settings, XmlResolver stylesheetResolver)
at System.Xml.Xsl.XslCompiledTransform.Load(XmlReader stylesheet)
at AIM.Letters.Documents.Layout.get_WordXsl() in c:\AIM\LettersSolutionII\LetterDocuments\Documents\Layout.cs:line 29
at AIM.Letters.ProcessingService.Activities.TiffGenerator.BuildWordML(LetterJob jobDocument, Layout layout) in C:\AIM\LettersSolutionII\LetterService\Activities\TiffGenerator.cs:line 253 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T19:23:50.377

看起来我的问题与 .NET dll 版本的差异有关，特别是 System.XML.dll。安装了 .NET Framework 2.0 Service Pack 2 的计算机工作正常。没有此服务包的那些行为不端。我的旧代码如何使用“坏” System.XML.dll 对我来说仍然是个谜

# c++ - C/C++ 的偏最小二乘实现？

> ID：727891
> 
> 赞同：4
> 
> 时间：2009-04-07T22:50:42.447
> 
> 标签：c++, c, statistics

有谁知道C 或 C++ 中[偏最小二乘](http://en.wikipedia.org/wiki/Partial_least_squares_regression)算法的开源实现？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T23:01:46.307

你检查过[R-Project](http://www.r-project.org/)吗？必须爱[谷歌](http://www.google.com/search?q=open+source+statistics):)

# java - 通过 https 获取网页

> ID：727893
> 
> 赞同：1
> 
> 时间：2009-04-07T22:50:58.077
> 
> 标签：java, https

有人知道通过 https 获取网页的 Java 库吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-07T23:40:00.957

从 1.4 开始，您可以使用无聊的旧 URL.openConnection()...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-07T23:04:35.860

看看[HttpClient](http://hc.apache.org/httpcomponents-client-ga/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-07T22:53:52.533

Sun 的 Java 教程中有一个很好的示例说明如何获取网站内容。

[http://java.sun.com/docs/books/tutorial/networking/urls/readingURL.html](http://java.sun.com/docs/books/tutorial/networking/urls/readingURL.html)

但是，如果您想获取它的全部内容，包括脚本、图像和其他好东西，您将不得不自己解析链接并下载它们。

# opengl - OpenGL中的高效纹理访问

> ID：727894
> 
> 赞同：0
> 
> 时间：2009-04-07T22:51:22.617
> 
> 标签：opengl, textures

我正在使用 OpenGL 开发游戏，这就是我想做的事情：

1.  在游戏逻辑的迭代过程中，访问纹理的纹素进行计算。
2.  仍然在相同的逻辑交互过程中，可能会修改纹理的纹素。
3.  使用当前版本的纹理渲染游戏场景。
4.  以类似的方式访问纹素数据开始另一个迭代。

我在使用 glGetTexImage() 时遇到问题，因为调用会使我的程序崩溃，而且我不完全确定这是我想要使用的。

我能看到的唯一直接方法是在系统内存中有一个缓冲区，其中包含我可以处理的纹素信息，并在每次迭代时从中生成一个新的 OpenGL 纹理。这似乎是一个糟糕的举动。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T07:17:51.870

有几种可能的方法可以做到这一点。

1.  如果您不需要任何非纹理数据来修改纹理，则可以使用片段着色器。（[乒乓球技术](http://www.m3xbox.com/GPU_blog/?tag=ping-pong)可能对此很有趣）
2.  如果只替换了一小部分纹理并且您不需要担心性能或者它应该适用于旧显卡，则使用 glTexSubImage2D。
3.  使用[像素缓冲区对象](http://www.opengl.org/registry/specs/ARB/pixel_buffer_object.txt)。那应该比 glTexSubImage2D 更快。可以在[此处](http://developer.nvidia.com/object/fast_texture_transfers.html)找到有关此的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T23:04:42.960

我相信[glTexSubImage2d](http://www.cs.rutgers.edu/~decarlo/428/gl_man/texsubimage2d.html)是您正在寻找的。

# visual-studio - 在 Visual Studio (2008) 中，有没有办法在另一个自定义文件上拥有一个自定义依赖文件？

> ID：727898
> 
> 赞同：13
> 
> 时间：2009-04-07T22:52:25.877
> 
> 标签：visual-studio, visual-studio-2008, csproj

我想要一个 *.js 文件，而不是后面或旁边的 *.cs 代码。我正在开发一个 MVC 应用程序，因为我有控制器，所以不需要代码，但在某些情况下，最好有一个 JavaScript 代码或者以某种方式将文件与正在使用的页面相关联。我想我可以类似地命名它们，但如果可能的话，我想显示关联，因此毫无疑问该文件的用途。

通常我所说的是在 Visual Studio 中，现在在 Global.asax 文件下，左边会有一个加号：

```
+ Global.asax 
```

一旦你扩展它，你会得到

```
- Global.asax
    Global.asax.cs 
```

我希望同样的事情发生：

```
+ Home.spark

- Home.spark
    Home.spark.js 
```

**更新：**

我现有的 csproj 文件有一个实际文件的路径，不确定这是否搞砸了。我目前有：

```
<ItemGroup>
    <Content Include="Views\User\Profile.spark.js">
      <DependentUpon>Views\User\Profile.spark</DependentUpon>
    </Content>
  </ItemGroup>
  <ItemGroup>
    <Content Include="Views\User\Profile.spark" />
  </ItemGroup> 
```

它只是显示彼此并排的文件。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-06T08:04:09.727

有[VSCommands](http://vscommands.com/)插件，允许您直接从 IDE 配置依赖文件

链接已更新，以前是[http://mokosh.co.uk/vscommands](http://mokosh.co.uk/vscommands)

仅供参考：安装 VSCommands 后，只需选择所有要依赖的文件和根文件，然后右键单击 -> 组项目... VSCommands 会询问您希望哪个文件成为根文件。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-07T22:57:57.873

绝对 - 但您必须手动编辑项目文件。找到您的“子”文件的条目，并将其更改为非自关闭元素，并添加一个子元素来说明它所依赖的内容。这是正在编译的 .cs 文件的示例：

```
<Compile Include="AssertCount.cs">
  <DependentUpon>MoreEnumerable.cs</DependentUpon>
</Compile> 
```

这是我刚刚为您指定的文件模拟的一个版本 - 尽管我希望`Home.spark`会有一个与之相关的操作而不是“无”：

```
<ItemGroup>
  <Content Include="Home.spark.js">
    <DependentUpon>Home.spark</DependentUpon>
  </Content>
</ItemGroup>
<ItemGroup>
  <None Include="Home.spark" />
</ItemGroup> 
```

Visual Studio 会按照您的预期显示它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T23:01:39.457

我不知道如何通过 Visual Studio UI 本身来完成，但如果你在文本编辑器中打开 csproj 文件，你可以看到他们是如何为 Global.asax 做的。

它通常看起来像这样：

```
<Compile Include="Global.asax" />
<Compile Include="Global.asax.cs">
    <DependentUpon>Global.asax</DependentUpon>
</Compile> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-28T06:38:01.933

虽然这里的其他解决方案（编辑项目文件）适用于单个文件，但我们做了同样的事情，但希望它自动适用于所有 *.conv 和 *.conv.js 文件，而不是编辑项目文件每一个人。

当我们将一个新的 .conv 文件添加到我们的应用程序时，如果我们有一个 *.conv.js 文件，它会自动嵌套在它下面，正如您对 .aspx 和 *.aspx.cs 所期望的那样。

我找不到我用来设置它的原始教程（它确实涉及注册表黑客），但这是我刚刚从谷歌搜索中找到的一个描述相同内容的教程：

[http://blog.dotnetwise.com/2009/09/visual-studio-2008-custom-nested-files.html](http://blog.dotnetwise.com/2009/09/visual-studio-2008-custom-nested-files.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-03T11:41:35.650

如果您需要为某些文件添加代码隐藏，则有一种解决方法。例如，您想让**Test.xaml.cs成为****Test.xaml**的子级。完成以下步骤：

1.  从项目中排除**Test.xaml**和**Test.xaml.cs**，保存项目。

2.  卸载项目。

3.  重新加载项目。

4.  在文件资源管理器窗格中单击“显示隐藏文件”。

5.  文件**Test.xaml.cs**将显示为**Test.xaml**的子级。

6.  将文件添加回项目，保存项目。

就是这样。现在**Test.xaml.cs**依赖于**Test.xaml**。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-30T13:32:26.387

您可以手动编辑项目文件，John Skeed 建议，或者您也可以[查看 Visual Studio 的文件嵌套扩展](https://visualstudiogallery.msdn.microsoft.com/3ebde8fb-26d8-4374-a0eb-1e4e2665070c)，它将为您完成这项工作。

# javascript - jquery选择文本

> ID：727902
> 
> 赞同：3
> 
> 时间：2009-04-07T22:54:24.140
> 
> 标签：javascript, jquery

```
<div>select this<strong>dfdfdf</strong></div>
<div><span>something</span>select this<strong>dfdfdf</strong></div> 
```

我如何使用 jquery 或仅使用 javascript 来选择 div 标签的值但不包含任何子元素

```
//output
select this 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-07T23:12:56.887

```
$("div").contents().each(function(i) {
    //the function is applied on the node. 
    //therefore, the `this` keyword is the current node.
    //check if the current element is a text node, if so do something with it
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T10:10:10.660

纯 JS 版本：

```
function getDirectTextContent(element) {
    var text= [];
    for (var i= 0; i<element.childNodes.length; i++) {
        var child= element.childNodes[i];
        if (child.nodeType==3)                           // Node.TEXT_NODE
            text.push(child.data);
    }
    return text.join('');
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T00:44:06.217

使用 XPath，您只能选择 div 的文本节点子节点。下面的原始 javascript。

```
var xpr = document.evaluate("//div/text()",document,null,
    XPathResult.STRING_TYPE,
    null);
console.log(xpr.stringValue);

> select this 
```

如果您有穿插标签的文本：

```
<div>select this<strong>dfdfdf</strong>and this</div> 
```

...您可以遍历它们（助手将 XPathResult 转换为数组）

```
function $x(path, context, type) {
    if (!context) context = document;
    type = type || XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE;
    var i,item,arr=[], xpr = document.evaluate(path, context, null, type, null);
    for (i=0; item=xpr.snapshotItem(i); i++) 
      arr.push(item);
    return arr;
}

var nodes = $x("//div/text()");
nodes.forEach(function(item) {
    console.log(item.textContent);
});

> select this
> and this 
```

[（在 FF 中测试，带萤火虫日志记录​​）]

# asp.net - asp.net mvc 是否处理所有请求？- iis 7 集成模式

> ID：727908
> 
> 赞同：2
> 
> 时间：2009-04-07T22:55:15.120
> 
> 标签：asp.net, asp.net-mvc, iis-7

我有一个使用集成模式在 IIS 7 上运行的 asp.net mvc 构建的站点。我注意到当我输入 mysite.com/test.html 时我回来了 IControllerFactory 没有为名为“test.html”的控制器返回控制器。

我应该得到的是 404 错误，这应该由 IIS7 静态处理程序提供。

现在我想知道的是，asp.net mvc 处理程序是否提供所有服务？（css、图像、zip 档案）而不是静态文件处理程序。

如果确实如此，那么有一种方法可以解决这个问题，以便静态处理程序将为带有扩展名的文件提供服务。否则，这似乎是一个很大的性能问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-02-28T19:27:51.190

默认情况下，ASP.NET MVC 将处理所有请求，因为路由旨在处理任何路径。您可以使用该[`IgnoreRoute`](http://msdn.microsoft.com/en-us/library/dd505203.aspx)方法专门排除某些路径，如下所示（在 Global.asax 中）：

```
public static void RegisterRoutes(RouteCollection routes)
{
    // This is already added by MVC
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    // Ignore any htm files
    routes.IgnoreRoute("{filename}.htm");

    // Other routes
    // ...
} 
```

我怀疑这仍然会导致请求通过 ASP.NET（尽管我怀疑它们会很快“失败”）。如果这是一个问题，您可以尝试更改 web.config 设置以根本不将请求传递给 ASP.NET：

```
<modules runAllManagedModulesForAllRequests="false" /> 
```

但是，您需要准确设置要通过 ASP.NET 的请求。

# function - 我怎么知道省略了 PowerShell 函数参数

> ID：727912
> 
> 赞同：3
> 
> 时间：2009-04-07T22:57:13.773
> 
> 标签：function, powershell, arguments

考虑这样的功能：

```
function Test($foo, $bar)
{
  ...
} 
```

我们可以称之为：

```
Test -foo $null
Test 
```

我怎么知道什么时候 -foo 被省略了，什么时候是 $null？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T23:28:15.727

如果您使用的是 Powershell V2 或更高版本，则可以使用 $PSBoundParameters 变量，它是一个字典，列出了当前范围内的所有绑定参数。

请参阅讨论它的[这篇](http://blogs.msdn.com/powershell/archive/2009/04/06/checking-for-bound-parameters.aspx)博客文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T23:05:04.817

除非可以捕获从 param 语句抛出的异常（并且由于 param 必须是第一个，我看不出这会起作用）：

```
function {
  trap { "Something failed" }
  param($foo = $(throw "Foo not specified"))
  ... 
```

然后我看不到方法（使用 [switch] 参数得到相同的结果：默认或显式`-mySwitch:$false`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T23:26:52.750

基于理查德想法的解决方案：

```
$missed = "{716C1AD7-0DA6-45e6-854E-4B466508EB96}"

function Test($foo = $missed, $bar)
{
    if($foo -eq $missed) {
        Write-Host 'Missed'
    }
    else
    {
        Write-Host "Foo: $foo"
    }
}

Test -foo $null
Test 
```

# python - 在 Django 表单字段之间显示一些自由文本

> ID：727917
> 
> 赞同：13
> 
> 时间：2009-04-07T22:59:06.857
> 
> 标签：python, django, django-forms

我有如下表格：

```
class MyForm(Form):

  #personal data
  firstname = CharField()
  lastname = CharField()

  #education data
  university = CharField()
  major = CharField()

  #foobar data
  foobar = ChoiceField() 
```

由于某些字段（如 foobar）是从数据库中填充的，我不能使用其他方法，只能让 Django 使用 form.as_ul 为我呈现它

我也希望我不必为了便于维护而将表格拆分为多种形式

有没有办法告诉 Django 在这些表单部分之间显示帮助文本，以便我可以输入一些关于如何填写表单的说明？

我希望表单呈现如下内容：

```
<form>

  <p>Here you enter your personal data...</p>
  <input name='firstname'>
  <input name='lastname'>

  <p>Here you enter your education data...</p>
  <input name='university'>
  <input name='major'>

</form> 
```

我需要创建自己的小部件才能显示这些`<P>`标签，还是有更简单的方法？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-11-10T02:07:41.813

不使用 form.as_ul 在模板中显示表单的一种方法是使用 django-uni-form。首先，您必须在[此处](http://github.com/pydanny/django-uni-form)下载并安装它。然后设置表单的代码可能如下所示：

```
from uni_form.helpers import FormHelper, Submit, Layout, Fieldset

class MyForm(Form):

    #personal data
    firstname = CharField()
    lastname = CharField()

    #education data
    university = CharField()
    major = CharField()

    #foobar data
    foobar = ChoiceField()

    # now attach a uni_form helper to display the form
    helper = FormHelper()

    # create the layout
    layout = Layout(
         # first fieldset
         Fieldset("Here you enter your personal data...",
             'firstname', 'lastname'),
         Fieldset("Here you enter your education data...",
             'university', 'major'),
         Fieldset('foobar')

    # and add a submit button
    sumbit = Submit('add', 'Submit information')
    helper.add_input(submit) 
```

现在，要在模板中显示它，您可以这样做：

```
{% load uni_form %}
{% with form.helper as helper %}
    {% uni_form form helper %}
{% endwith %} 
```

这将输出 HTML（大致）如下：

```
<form>
<fieldset><legend>Here you enter your personal data...</legend>
<input name='firstname'>
<input name='lastname'>
</fieldset>

<fieldset><legend>Here you enter your education data...</legend>
<input name='university'>
<input name='major'>
</fieldset>

<fieldset>
<input name='foobar'>
</fieldset>

</form> 
```

有关 uni_form 的更多信息，请阅读他们的文档（请参阅上面的链接）。

PS：我意识到这个回复很晚，我相信你已经解决了这个问题，但我认为这对现在刚刚遇到这个问题的任何人都有帮助。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-14T12:15:26.697

如果你想自定义表单，你不必渲染它`form.as_ul`。如果您正确设置了表单模型，Django 知道如何呈现 foobar ......试试吧......不用担心。

看看服务器上的 python 发送了你的页面。例如，如果它发送了一个这样的 django 表单：

`return respond(request, user, 'templateName', { 'myform':myform })`

那么*templateName.html*将有：

```
<blockquote>
<form>

    <p>Here you enter your personal data...</p>
    {{myform.firstname }}

    <p>Here you enter your education data...</p>
    {{myform.university }}

    <p> a choice field </p>
    {{myform.foobar}}

</form>
</blockquote> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-07T23:19:00.773

Since each section is a collection of multiple, independent form fields, I recommend using a custom form template. This gives you absolute full control over the layout with minimal extra work. Django's [Customizing the Form Template](http://docs.djangoproject.com/en/dev/topics/forms/#customizing-the-form-template) docs have the details.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T10:29:34.357

还要记住，Django Form 对象只是字段的集合；HTML 表单标签和 Django 表单对象之间不需要 1:1 的对应关系。如果表单的各个部分实际上在逻辑上是分开的，您可以考虑将其拆分为三个表单，然后您可以在模板中呈现您想要的任何 HTML（但仍然在单个 HTML 表单标签内）。

当然，这是否是一个明智的解决方案在很大程度上取决于您的应用程序的设计和视图。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-11T17:55:35.403

您知道的表单中有一个`help_text`字段。

在*forms.py*中：

*   `myField = forms.myFieldType(help_text="Helping friendly text to put in your form", otherStuff=otherStuff)`

在*forms.html*中：

*   `{{form.myField.help_text}}`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T23:19:03.627

Even though your form is populated from a database, you should still be able to manually write out the form, or use a template. Check out the [Django form documentation](http://docs.djangoproject.com/en/dev/topics/forms/#customizing-the-form-template) for more details.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-27T12:41:15.117

对于那些与作者类似情况的人，我建议在表单的元素上使用 CSS`:before`和/或`:after`伪选择器。它们同样有效，并且可以让您的生活更轻松，因为您仍然可以使用.`input``label``{{ form.as_p }}`

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-05-24T13:59:26.997

同意@mipadi，似乎这是最简单的方法。

所以像

```
$('.selector').append('<html></html>') 
```

# c++ - GetTickCount() 换行时会发生什么？

> ID：727918
> 
> 赞同：14
> 
> 时间：2009-04-07T22:59:07.823
> 
> 标签：c++, c, windows, winapi

如果一个线程正在做这样的事情：

```
const DWORD interval = 20000;
DWORD ticks = GetTickCount();
while(true)
{
    DoTasksThatTakeVariableTime();

    if( GetTickCount() - ticks > interval )
    {
        DoIntervalTasks();
        ticks = GetTickCount();
    }
} 
```

最终，当值不适合 DWORD 时，刻度将换行。

我一直在和同事讨论这个问题。我们中的一个人认为，当换行发生时，代码仍然会表现得“很好”，因为减法运算也会换行。我们中的另一个人认为它并不总是有效，尤其是在间隔很大的情况下。

谁是对的，为什么？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-07T23:05:45.827

从[文档](http://msdn.microsoft.com/en-us/library/ms724408.aspx)：

> 经过的时间存储为 DWORD 值。因此，如果系统连续运行 49.7 天，时间将归零。要避免此问题，请使用 GetTickCount64。否则，在比较时间时检查溢出情况。

但是，DWORD 是无符号的 - 所以你应该没问题。0 - “非常大的数字” = “小数字”（当然，假设您没有任何溢出检查活动）。我之前的编辑建议你得到一个负数，但那是在我考虑到 DWORD 是无符号的之前。

*如果手术需要不到*49.7 天，您仍然会遇到问题。这对你来说可能不是问题；）

一种测试方法是将`GetTickCount()`方法存根，这样您就可以编写单元测试，明确地将其包装起来。再说一次，如果你真的只是怀疑算术部分，你可以很容易地为此编写单元测试:) 真的，只要你知道它的行为，这个数字来自系统时钟的事实几乎是无关紧要的wraps - 这是在文档中指定的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-02-10T17:46:19.627

没有什么不好的事情发生，只要：

*   您减去`DWORD`s，而不是先转换为其他类型。

*   您尝试计时的时间不会超过 49.7 天。

这是因为无符号算术溢出在 C 中是明确定义的，并且包装行为正是我们想要的。

```
DWORD t1, t2;
DWORD difference;

t1 = GetTickCount();
DoSomethingTimeConsuming();
t2 = GetTickCount(); 
```

`t2 - t1`将产生正确的值，即使`GetTickCount`环绕。只是在做减法之前不要将`t2`and转换`t1`为其他类型（例如`int`or ）。`double`

如果编程语言将溢出视为错误，这将不起作用。`DoSomethingTimeConsuming()`如果需要超过 49.7 天，它也将不起作用。不幸的是，您无法仅通过查看`t2`以及缠绕`t1`了多少次来判断。`GetTickCount`

* * *

让我们从通常的情况开始，其中没有环绕发挥作用：

```
t1 = 13487231
t2 = 13492843 
```

在这里，`t2 - t1 = 5612`，这意味着该操作大约需要五秒钟。

现在考虑一个需要很短时间的操作，但是在哪里`GetTickCount`环绕：

```
t1 = 4294967173
t2 = 1111 
```

该操作花费了 1234 毫秒，但计时器环绕，并且`1111 - 4294967173`是`-4294966062`. 我们会做什么？

嗯，模 2 ^(32)，减法的结果也环绕：

```
(DWORD)-4294966062 == (DWORD)1234 
```

*最后，考虑一个操作需要将近*2 ^(32)毫秒但不完全是这样的边缘情况：

```
t1 = 2339189280
t2 = 2339167207 
```

在这里，`GetTickCount`绕了一圈，又回到了原来的位置。

现在`t2 - t1`产生 的假值`4294945223`。那是因为这是手术实际花费的时间！

一般来说：

```
(base + offset) - base ≡ offset mod 2^32 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-09T07:01:19.670

如果您想测试`GetTickCount()`包装时会发生什么，您可以启用 Application Verifier 的 TimeRollOver 测试。

从[在您的软件开发生命周期中使用应用程序验证程序](http://msdn.microsoft.com/en-us/library/aa480483.aspx)：

> **TimeRollOver**强制 GetTickCount 和 TimeGetTime API 以比通常更快的速度翻转。这允许应用程序更轻松地测试它们对时间翻转的处理。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-04T02:13:58.450

我建议计算两个刻度之间的实际经过时间，而不是依赖编译器为您处理它：

```
const DWORD interval = 20000;

#define TICKS_DIFF(prev, cur) ((cur) >= (prev)) ? ((cur)-(prev)) : ((0xFFFFFFFF-(prev))+1+(cur))

DWORD ticks = GetTickCount();
while(true)
{
    DoTasksThatTakeVariableTime();

    DWORD curticks = GetTickCount();
    if( TICKS_DIFF(ticks, curticks) > interval )
    {
        DoIntervalTasks();
        ticks = GetTickCount();
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-08T00:47:33.913

我最近遇到了这个问题。我正在处理的代码在很多地方使用 GetTickCount() 来确定程序是否在特定任务上花费了太多时间，如果是，它将使该任务超时并重新安排它以供以后执行。会发生的情况是，如果 GetTickCount() 在测量周期之一中进行包装，则会导致代码过早超时。这是一项持续运行的服务，因此每隔 49 天，它就会出现轻微的故障。

我通过编写一个在内部使用 GetTickCount() 的计时器类来修复它，但在值包装和补偿时检测到它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-08T02:13:20.400

当然，您需要处理这个刻度线问题。

Linux 内核通过以下技巧处理此类刻度线问题：

> #define time_after(a,b) ((long)(b) - (long)(a) < 0))

这个想法是将无符号转换为有符号并比较它们的值，然后只有|ab|<2^30，然后换行不会影响结果。

你可以试试这个技巧并了解它为什么有效。

因为 DWORD 也是 unsigned int，所以这个技巧也应该适用于 windows。

所以你的代码可能是这样的：

> 常量 DWORD 间隔 = 20000；
> 
> DWORD 滴答数 = GetTickCount() + 间隔；
> 
> 而（真）{
> 
> ```
> DoTasksThatTakeVariableTime();
> 
> if(time_after(ticks, GetTickCount())
> {
>     DoIntervalTasks();
>     ticks = GetTickCount() + interval;
> } 
> ```
> 
> }

仅当间隔小于 0x2^30 时，它才有效。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-08T09:12:23.997

你可以测试它;) - 我在这里有一个简单的测试应用程序，它将启动一个应用程序并挂接`GetTickCount()`到它，这样你就可以从测试应用程序的 GUI 控制它。我写它是因为`GetTickCount()`在某些应用程序中删除调用并不那么容易。

TickShifter 是免费的，可在此处获得：http: [//www.lenholgate.com/blog/2006/04/tickshifter-v02.html](http://www.lenholgate.com/blog/2006/04/tickshifter-v02.html)

我在写一系列关于测试驱动开发的文章时写了它，其中使用了一些`GetTickCount()`以错误方式使用的代码。

如果您有兴趣，可以在这里找到文章：http: [//www.lenholgate.com/blog/2004/05/practical-testing.html](http://www.lenholgate.com/blog/2004/05/practical-testing.html)

但是，总而言之，您的代码将工作......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-10-19T16:28:30.547

这篇文章帮助了我，但我认为有一个错误：

```
#define TICKS_DIFF(prev, cur) ((cur) >= (prev)) ? ((cur)-(prev)) : ((0xFFFFFFFF-(prev))+(cur)) 
```

当我在环绕点进行测试时，我发现它偏离了 1。

对我有用的是：

```
define TICKS_DIFF(prev, cur) ((cur) >= (prev)) ? ((cur)-(prev)) : ((0xFFFFFFFF-(prev))+(cur)+1) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-01-19T02:21:27.533

我知道这在近 11 年后完全无关紧要，并且从 Vista 开始包含 GetTickCount64()，但这里有一些帮助代码，我从永远以来就在我的 takeit 中使用，当这是一个问题。

```
inline DWORD GetElapsed(DWORD from, DWORD to = ::GetTickCount())
{
  if (from < to)        //check for wrap around condition
      return (to - from);
  else
      return ((0xFFFFFFFFL - from) + 1 + to);
} 
```

用法

```
DWORD start = ::GetTickCount();

// Some time later

DWORD elapsed = GetElapsed(start); 
```

担心的不是您的操作可能需要更长的 49.7 天，而是滴答计数器可能会在您的操作期间翻转，从而使您的经过时间计算不可靠。

当然，由于 GetTickCount64() 现在一切都无关紧要了

# c# - ObservableCollection 引发“Item []”的 PropertyChange 的目的是什么？

> ID：727921
> 
> 赞同：5
> 
> 时间：2009-04-07T23:01:04.013
> 
> 标签：c#, wpf

ObservableCollection 引发“Item []”的 PropertyChange 的目的是什么？

如果我有一个实现 INotifyCollectionChanged 的​​类，我应该这样做吗？

WPF 控件是否以某种方式使用“Item[]”的这个 PropertyChange？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T00:44:14.437

`ObservableCollection`实现`INotifyCollectionChanged`和`INotifyPropertyChanged`。

`INotifyPropertyChanged`用于指示 的属性`ObservableCollection`已更改，例如其元素的数量 ( `"Count"`) 或可通过集合的索引器 ( `"Item[]"`) 访问的元素。此外，`ObservableCollection`实现`INotifyCollectionChanged`指示哪个元素已准确更改以及如何更改。

看看[Mono 的实现，`ObservableCollection`](http://anonsvn.mono-project.com/viewvc/trunk/olive/class/WindowsBase/System.Collections.ObjectModel/ObservableCollection.cs?content-type=text%2Fplain&view=co)看看它到底做了`ObservableCollection`什么。例如，这里是`InsertItem`方法：

```
protected override void InsertItem (int index, T item)
{
    CheckReentrancy ();

    base.InsertItem (index, item);

    OnCollectionChanged (new NotifyCollectionChangedEventArgs (
        NotifyCollectionChangedAction.Add, item, index));
    OnPropertyChanged (new PropertyChangedEventArgs ("Count"));
    OnPropertyChanged (new PropertyChangedEventArgs ("Item[]"));
} 
```

如果你想实现你自己`ObservableCollection`的集合类，这似乎是实现`INotifyCollectionChanged`和的正确方法`INotifyPropertyChanged`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T23:23:22.650

是的 WPF 和 Silverlight 控件使用 PropertyChange 事件来更新 UI 控件。这允许诸如 ListView 或 DataGrid 之类的东西自动更新以响应其绑定的 ObservableCollection - 或其他实现 INotifyCollectionChanged 的​​集合 - 更改。

编辑：就实现而言，您通常不需要实现自己的集合，因此不需要为 INotifyCollectionChanged 工作。对于将在 ObservableCollection 中使用的类，您需要实现 INotifyPropertyChanged。这允许您的对象在更新时触发 PropertyChanged 事件，这将允许您的 UI 控件自动显示更改。

# asp.net - 设计一个用户可以创建主题的网站？(ASP.NET/C#)

> ID：727927
> 
> 赞同：2
> 
> 时间：2009-04-07T23:02:52.183
> 
> 标签：asp.net, css, themes

什么是构建 ASP.NET 网站的优雅方法，最终用户可以通过用户界面为其网站创建自定义主题？

ASP.NET 主题会在这里帮助我吗？UI 是否应该允许用户将引导的 CSS 文件写入光盘并应用这些文件？欢迎任何建议。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T23:38:37.480

I would go with a CSS-only solution where users can specify their own CSS and only that to modify the theme and layout appearance.

You also need to be careful not to use tables as they are rigid and CSS can hit a wall with them.

Also have a look at [CSSZenGarden](http://www.csszengarden.com/) to see how support user theming.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T02:59:56.073

首先，使用强大的语义方法构建干净的 html 模板，定义一个默认的 css 基础，无论选择什么主题（基本元素位置、基本图像、字体定义等）都能很好地工作，并在一个单独的文件

现在有两种方法：

让他们配置一些元素的外观并将他们的偏好存储在数据库中

[http://acko.net/dev/farbtastic](http://acko.net/dev/farbtastic)是一个不错的小部件，用于选择元素的颜色如果你想更进一步，f.ex。在布局上拖放元素位置，使用 f.ex [http://jqueryui.com/](http://jqueryui.com/)（或 scriptcaluous 或其他）并通过 httprequest on drop 将它们的位置保存到 db

让他们写他们的css文件

如果您希望用户编写 css 文件的方法，我会考虑让他们只覆盖特定类的元素，但我不知道您真正想要实现什么以及您想在主题方面走多远，提供更多细节。我不明白他们为什么要将 css 上传到磁盘上，只需将它们放在 textarea 中并保存到数据库中。

[无论您选择哪种方式，您都应该在http://tumblr.com](http://tumblr.com)或[http://storytlr.com](http://storytlr.com)上查看它的工作原理，以了解有关该主题的想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T20:52:28.067

伙计，ASP.Net 主题适用于小型网站，但对于大型网站来说，这是地狱，你无法控制你的 CSS 包含和许多其他东西，在我的工作中，我只使用主题来定义控件的属性，比如为文本框设置 CSSClass到“Tb”，这真的很棒，因为它适用于所有文本框，你可以为自己节省很多时间，我停在那里，不会在主题中定义任何 CSS 文件。

然后按照 JZ 的建议创建一个干净的模板，可以很好地更改颜色、字体大小等......然后创建多个 css 文件来反映您的模板，然后在您的母版页中放置一个下拉框并用模板名称填充它，然后使用jquery或添加动态链接，它的值将根据下拉框选择的值而改变。

希望这可以帮助。

# django - Django Admin：对于 list_display 方法，如何访问 admin.py 中的请求对象？

> ID：727928
> 
> 赞同：31
> 
> 时间：2009-04-07T23:02:57.753
> 
> 标签：django, django-admin, request

我在`highlight_link`模型的 admin.py 类中添加了一个方法：

```
class RadioGridAdmin(admin.ModelAdmin):

    list_display = ('start_time', highlight_link)

    def highlight_link(self):
        return ('some custom link')

admin.site.register(RadioGrid, RadioGridAdmin) 
```

`highlight_link.short_description`它为更改列表中返回的每条记录返回一个自定义链接（为简洁起见，我省略了）。这是伟大的。但我想检查当前的查询字符串并根据它更改自定义链接。有没有办法在里面访问请求对象`highlight_link`？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-05-09T21:54:20.943

我这样解决我的问题。

```
class MyClassAdmin(admin.ModelAdmin):

    def queryset(self, request):
        qs = super(MyClassAdmin, self).queryset(request)
        self.request = request
        return qs 
```

现在我可以`self.request`在任何地方使用

**更新**

> [在 Django 1.6 中更改：get_queryset 方法以前被命名为 queryset。](https://docs.djangoproject.com/en/1.7/ref/contrib/admin/#django.contrib.admin.ModelAdmin.get_queryset)

```
class MyClassAdmin(admin.ModelAdmin):

    def get_queryset(self, request):
        qs = super(MyClassAdmin, self).get_queryset(request)
        self.request = request
        return qs 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-08T13:01:29.500

```
class RadioGridAdmin(admin.ModelAdmin):

    def highlight_link(self, obj):
        return (self.param)

   def changelist_view(self, request, extra_context=None):
        self.param = request.GET['param']
        return super(RadioGridAdmin,self).changelist_view(request, extra_context=extra_context) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-05-16T21:54:33.957

描述了如何将其[重构为 mixin](http://marcelchastain.com/2018/05/getting-access-to-request-in-django-modeladmin/)，并根据@taha-jahangir 的回答添加了线程安全位。这是混合：

```
import threading

class ModelAdminRequestMixin(object):
    def __init__(self, *args, **kwargs):
        # let's define this so there's no chance of AttributeErrors
        self._request_local = threading.local()
        self._request_local.request = None
        super(ModelAdminRequestMixin, self).__init__(*args, **kwargs)

    def get_request(self):
        return self._request_local.request

    def set_request(self, request):
        self._request_local.request = request

    def changeform_view(self, request, *args, **kwargs):
        # stash the request
        self.set_request(request)

        # call the parent view method with all the original args
        return super(ModelAdminRequestMixin, self).changeform_view(request, *args, **kwargs)

    def add_view(self, request, *args, **kwargs):
        self.set_request(request)
        return super(ModelAdminRequestMixin, self).add_view(request, *args, **kwargs)

    def change_view(self, request, *args, **kwargs):
        self.set_request(request)
        return super(ModelAdminRequestMixin, self).change_view(request, *args, **kwargs)

    def changelist_view(self, request, *args, **kwargs):
        self.set_request(request)
        return super(ModelAdminRequestMixin, self).changelist_view(request, *args, **kwargs)

    def delete_view(self, request, *args, **kwargs):
        self.set_request(request)
        return super(ModelAdminRequestMixin, self).delete_view(request, *args, **kwargs)

    def history_view(self, request, *args, **kwargs):
        self.set_request(request)
        return super(ModelAdminRequestMixin, self).history_view(request, *args, **kwargs) 
```

使用 mixin 子类化 ModelAdmin：

```
class PollAdmin(ModelAdminRequestMixin, admin.ModelAdmin):
    pass 
```

...您可以`self.get_request()`从任何方法调用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-08T04:48:11.870

没有直接的方法可以做到这一点。我看到了两种可能的解决方案。

*   使用线程本地存储到相同的请求对象

    ```
    from django.utils._threading_local import locals

    globals = locals()

    class RadioGridAdmin(admin.ModelAdmin):
      def __call__(self, request, *args, **kwargs):
          globals['radio_grid_admin_request'] = request
          return super(RadioGridAdmin, self).__call__(request, *args, **kwargs)

      def highlight_link(self):
          request = globals['radio_grid_admin_request']
          # request.GET processing
          return ('some custom link') 
    ```

*   如果您使用简单的非线程 Django 安装，则可以将请求对象保存为属性：

    ```
    class RadioGridAdmin(admin.ModelAdmin):
      def __call__(self, request, *args, **kwargs):
          self.request = request
          return super(RadioGridAdmin, self).__call__(request, *args, **kwargs)

      def highlight_link(self):
          # self.request.GET processing
          return ('some custom link') 
    ```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-03-26T10:49:34.367

小代码澄清了**Diego Puente**的答案（python 3.6）：

```
class MyClassAdmin(admin.ModelAdmin):
    def __init__(self, model, admin_site): 
        self.request = None
        super().__init__(model, admin_site)

    def get_queryset(self, request):
        self.request = request      
        return super().get_queryset(request) 
```

因此，您可以`self.request`从任何其他方法获得`MyClassAdmin`.

如果`self.request`在`get_queryset`方法中定义（没有在中声明`__init__`）PyCharm 将生成警告`Instance attribute attribute_name defined outside __init__`。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-04-18T06:07:20.437

这是@user27478 答案的编辑版本，它使用线程本地变量：

```
class RadioGridAdmin(admin.ModelAdmin):
    def __init__(self, model, admin_site):
        super().__init__(model, admin_site)
        self._request_local = threading.local()

    def changelist_view(self, request, extra_context=None):
        self._request_local.request = request
        return super().changelist_view(request, extra_context)

    @property
    def _request(self):
        return self._request_local.request

    def example_highlight_link(self, obj):
        changelist = self.get_changelist_instance(self._request)
        url = changelist.get_query_string(new_params={'key1': 1}) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-16T21:00:18.130

我尝试了此处留下的其他答案，但遇到了对我来说变得越来越复杂的问题。我玩弄`def __call__()`并想出了以下内容。这可能不是正确的方法，但它有效......

在此处获取 GET 变量（所有在 RadioGridAdmin 类中，如我最初的帖子中所述）：

```
def __call__(self, request, url):
     global start_date
     start_date = request.GET['param']

     return super(RadioGridAdmin, self).__call__(request, url) 
```

由于它是全球性的，您现在可以在这里访问它：

```
def highlight_link(self):
    # access start_date here 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-13T12:48:07.177

```
import threading

_thread_local = threading.local()

def get_thread_local_request():
    return getattr(_thread_local, "request", None)

class RadioGridAdmin(admin.ModelAdmin):
    list_display = ('display_field', ...)

    def display_field(self, obj):
        # ...
        request = get_thread_local_request()
        # ... 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-05-18T04:46:03.267

## admin_mixins.py

```
from functools import partial, update_wrapper, lru_cache

# Django admin call 2 times get_list_display.
# We need to return the same function to make the method sortable using 'admin_order_field'
# https://github.com/django/django/blob/2161db0792f2e4d3deef3e09cd72f7a08340cafe/django/contrib/admin/templatetags/admin_list.py#L84
@lru_cache(maxsize=100)
def cache_display_wrap(f, request):
    wf = partial(f, request)
    nf = update_wrapper(wf, f)
    return nf

class ModelAdminMixin(admin.ModelAdmin):

    def get_list_display(self, request):
        def check_needs_request(display):
            f = getattr(self, display, None) if not callable(display) else display 
            if f and getattr(f, 'needs_request', False):
              return cache_display_wrap(f, request)
            return display
        return [check_needs_request(display) for display in super().get_list_display(request)] 
```

## any_app/admin.py

```
from django.contrib import admin
from core.admin_mixins import ModelAdminMixin

@admin.register(AnyModel)
class AnyModelAdmin(ModelAdminMixin, admin.ModelAdminMixin):

    list_display = ['id', 'especial_display_with_request']

    def especial_display_with_request(self, request, obj):
        # Make something special with the request
        return obj.any_field
    especial_display_with_request.needs_request = True  # Similar to short_description or any other django admin attr. 
```

来源：[https ://gist.github.com/pricco/24826bae3d5102d963eb13ecc0493f33](https://gist.github.com/pricco/24826bae3d5102d963eb13ecc0493f33)

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-05-04T18:12:46.153

这有什么问题：

```
def highlight_link(self, request):
    # access start_date here 
```

# c - main 的三个参数和其他混淆技巧

> ID：727930
> 
> 赞同：15
> 
> 时间：2009-04-07T23:04:09.717
> 
> 标签：c, obfuscation

以下经过混淆的 C 代码将单词打印到“圣诞节的 12 天”。

我试图弄清楚它是如何工作的。我基本上完全迷路了。初始调用中 main 的三个无类型参数、第一次返回后的一系列字符、main 调用的负数参数有什么意义？哎呀！

我主要是在做这个想法，也许我会学习 C 语言的一些有趣的角落，所以在这方面的回复是最受欢迎的。

```
#include <stdio.h>
main(t,_,a)char *a;{return!0<t?t<3?main(-79,-13,a+main(-87,1-_,
main(-86,0,a+1)+a)):1,t<_?main(t+1,_,a):3,main(-94,-27+t,a)&&t==2?_<13?
main(2,_+1,"%s %d %d\n"):9:16:t<0?t<-72?main(_,t,
"@n'+,#'/*{}w+/w#cdnr/+,{}r/*de}+,/*{*+,/w{%+,/w#q#n+,/#{l,+,/n{n+,/+#n+,/#\
;#q#n+,/+k#;*+,/'r :'d*'3,}{w+K w'K:'+}e#';dq#'l \
q#'+d'K#!/+k#;q#'r}eKK#}w'r}eKK{nl]'/#;#q#n'){)#}w'){){nl]'/+#n';d}rw' i;# \
){nl]!/n{n#'; r{#w'r nc{nl]'/#{l,+'K {rw' iK{;[{nl]'/w#q#n'wk nw' \
iwk{KK{nl]!/w{%'l##w#' i; :{nl]'/*{q#'ld;r'}{nlwb!/*de}'c \
;;{nl'-{}rw]'/+,}##'*}#nc,',#nw]'/+kd'+e}+;#'rdq#w! nr'/ ') }+}{rl#'{n' ')# \
}'+}##(!!/")
:t<-50?_==*a?putchar(31[a]):main(-65,_,a+1):main((*a=='/')+t,_,a+1)
  :0<t?main(2,2,"%s"):*a=='/'||main(0,main(-61,*a,
"!ek;dc i@bK'(q)-[w]*%n+r3#l,{}:\nuwloca-O;m .vpbks,fxntdCeghiry"),a+1);} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-07T23:12:24.110

有人已经离开并扭转了这一点：[http](http://research.microsoft.com/en-us/um/people/tball/papers/xmasgift/) ://research.microsoft.com/en-us/um/people/tball/papers/xmasgift/ 。通读一遍。它将解释这一切是如何工作的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T23:09:35.087

一些 Unix 系统不仅将参数计数和参数传递给 main，而且还将向量传递给环境（参见[http://en.wikipedia.org/wiki/Main_function_(programming)](http://en.wikipedia.org/wiki/Main_function_(programming))）。我很确定这就是这个混淆的例子所期望的。

我不认为你可以从这种混淆的代码中学到很多东西。它可能是[混淆 c 竞赛](http://www.ioccc.org/)的参赛者。

# javascript - 启动一个运行良好的文件下载，即使在 IE 中？

> ID：727934
> 
> 赞同：7
> 
> 时间：2009-04-07T23:05:17.920
> 
> 标签：javascript, internet-explorer, download

我正在寻找有关从 Javascript 启动文件下载的最佳方法的更多想法。

[启动下载的最佳方式？](https://stackoverflow.com/questions/60590/best-way-to-initiate-a-download)有很多好的想法，可以总结一下：

*   在 iframe 上设置 src
*   使用 window.location.replace()
*   使用带有元刷新标题的页面
*   使用 window.open()
*   让服务器直接输出文件，设置Content-Type和Content-Disposition

所有这些方法都适用于我一直在测试的浏览器，除了 IE8。使用 IE8，我遇到了一堆问题：

*   由于我使用的环境设置了 cookie，iframe 无法正常工作。我想我需要启用 P3P 标头来解决这个问题，但是环境不允许我设置标头，所以**P3P 不可用**
*   window.location.replace() 除了在 IE8 中，窗口的地址栏更改为文件的 URL 并且打开下载的文件后**底层窗口为空白**
*   元刷新方法也有效，但地址栏仍会更改为文件的 URL，并且文件下载后**底层窗口为空白**
*   我拼命地试图避免 window.open() 来**躲避任何弹出窗口拦截器问题**
*   我所在的服务器环境不允许您输出文件本身，就像您可以在 ASP.NET 的 Response 对象中做的那样

我什至没有在 IE6 或 IE7 上尝试过这些方法，所以那里可能还有其他惊喜。

那么是否有人对在 IE 中启动下载有任何其他建议，其中（1）不涉及弹出窗口，（2）可以保存或打开文件，（3）没有留下空白窗口，（3）只使用 Javascript ，HTML和文件的URL？

丹佛迈克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T09:51:55.807

下载文件页面的通常模式（如果你必须有一个；我个人讨厌它们）是：

```
<script type="text/javascript">
    window.onload= function() {
        window.location= document.getElementById('downloadlink').href;
    }
</script>
<p>
    Your download will begin shortly. If it doesn't,
    <a id="downloadlink" href="file.zip">click here</a>.
</p> 
```

或者与元刷新而不是脚本相同。无论哪种方式都应该表现得几乎相同。

> 元刷新方法也有效，但地址栏仍会更改为文件的 URL，并且文件下载后底层窗口为空白

那不应该发生。网上有可以测试的版本吗？通常，当浏览器通过任何常规方法（链接点击、位置.href、元刷新）被推送到直接文件下载时，它应该保持上一页在屏幕上。

> 环境不允许我设置标题，所以 P3P 出局了

您不必使用标头来设置 P3P 策略，HTML <link> 标签也可以：

```
<link rel="P3Pv1" href="/policy.p3p" /> 
```

但是你为什么需要呢？如果目标 URL 只是提供一个文件，则根本不需要设置 cookie，那么为什么要使用 P3P 呢？

> 我拼命地试图避免 window.open() 来躲避任何弹出窗口拦截器问题

如果您 window.open() 响应用户单击，则不存在弹出窗口阻止程序问题。

并不是说您无论如何都需要打开一个弹出窗口来下载文件。我开始认为您链接到的文件下载目的地有些奇怪 - 就像它根本不是文件下载而是某种奇怪的 HTML Web 应用程序一样。链接到下载并不难，您只需链接到文件，就完成了；你似乎比它本质上更难做到这一点。

仅链接到文件的唯一常见问题是，如果它包含文本、HTML、XML 或图像，浏览器将内联显示它而不是下载它。解决此问题的唯一方法是使用“Content-Disposition: attachment”标头，或者通过设置此标头的脚本提供它，或者通过配置您的 Web 服务器为所有文件下载发送该标头。如果您无法在服务器环境中执行其中任何一项，则没有解决方案。

# c# - 我可以从 linq-to-sql DataContext 访问 InsertOnSubmit 的记录列表吗？

> ID：727941
> 
> 赞同：4
> 
> 时间：2009-04-07T23:10:22.667
> 
> 标签：c#, linq, linq-to-sql

我有一些代码使用 Linq-To-SQL DataContext 来添加和修改表中的记录。

我遇到了一种情况，我通过 InsertOnSubmit 添加了几条记录，然后我想修改一条记录。但是这条记录可能已经在表中，或者它可能是我正在插入的记录之一。所以这：

```
db.MyTable.Single(t => t.Id == WhichId).Name="foobar"; 
```

可能不起作用，因为我可能还没有实际插入 ID 为的记录`WhichId`。

`SubmitChanges()`在我完成我将要做的所有事情之前，我真的不想这样做。

DataContext 必须保留要在 SubmitChanges() 上插入的记录列表 - 我可以访问该列表吗？我在想这样的事情：

```
(db.MyTable.SingleOrDefault(t => t.Id == WhichId) ??
 db.[list of records to be inserted].Single(t => t.Id == WhichId)
).Name="foobar"; 
```

所以问题是，有什么我可以放在方括号的地方吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-07T23:27:43.917

```
db.GetChangeSet().Inserts 
```

# c# - C#格式化外部Dll函数参数

> ID：727942
> 
> 赞同：3
> 
> 时间：2009-04-07T23:10:33.007
> 
> 标签：c#, marshalling, dllimport

我还没有找到关于这个主题的好参考。对于这个例子，我们将使用一些我试图移植到 C# 的 C++ 代码。

在 C++ 领域，我们有以下外部库函数原型：

```
extern "C" DWORD EXPORT FILES_GetMemoryMapping(
  PSTR pPathFile,
  PWORD Size,
  PSTR MapName,
  PWORD PacketSize,
  PMAPPING pMapping,
  PBYTE PagesPerSector); 
```

并在其中使用如下：

```
FILES_GetMemoryMapping((LPSTR)(LPCTSTR)MapFile, &Size, (LPSTR)MapName, &PacketSize, pMapping, &PagePerSector); 
```

现在我正在尝试将第一行移植到 C# 中，但这里没有明确的路径。

这是我到目前为止所得到的：

```
[DllImport("Files.DLL")]
public static extern uint FILES_GetMemoryMapping(
    [MarshalAs(UnmanagedType.LPStr)]
    string pPathFile,
    out ushort Size,
    [MarshalAs(UnmanagedType.LPStr)]
    string MapName,
    out ushort PacketSize,
    IntPtr pMapping,
    out byte PagesPerSector); 
```

现在的问题是：有没有好的指南告诉我“PSTR pPathFile”应该是“[MarshalAs(UnmanagedType.LPStr)] string pPathFile”......假设这是正确的？

或者，指向“PMAPPING”结构的指针变成“out IntPtr pMapping”......假设这是正确的？

对这个人有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T23:19:42.783

> 我还没有找到关于这个主题的好参考

[干得好。](http://www.pinvoke.net/)

奇怪的是，该站点目前已关闭，但它是编组问题的非常好的资源。同时，您可以在[http://web.archive.org/web/20080202041852/http://www.pinvoke.net使用 Archive.net 的 pinvoke.net 存档](http://web.archive.org/web/20080202041852/http://www.pinvoke.net)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T23:15:27.160

看起来是对的。您问题的第一部分（与 MarshalAs 有关）告诉编译器将托管 C# 变量转换为 PSTR。.NET 环境中的编组是指在托管和非托管环境之间传输数据。这些属性（以及其他几个属性）告诉编译器如何具体执行。

第二点表明它将传递一个指向结构的指针。.NET 中的 IntPtr 类型是一种托管类型，用于保留特定的内存。在 .NET 世界中，指针（通常）不存在，尽管仍然存在引用类型。指针和句柄管理由 CLR 为我们完成。IntPtr 结构用于编组指向数据结构或原始类型的指针

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T02:43:27.257

除了[P/Invoke](http://www.pinvoke.net/)站点之外，如果您对 .NET 互操作感兴趣的话，[Adam Nathan](http://blogs.msdn.com/adam_nathan/)的*[.NET and COM: The Complete Interoperability Guide](https://rads.stackoverflow.com/amzn/click/com/067232170X)*是值得添加到您的书架上的。

凯夫

# linux - chmod a=rwx 后 Linux 权限被拒绝

> ID：727948
> 
> 赞同：8
> 
> 时间：2009-04-07T23:12:33.237
> 
> 标签：linux, permissions, shell, wrapper, permission-denied

所以我有一点 Linux 问题，天哪，这将教会我在 Windows 上花费这么多年。无论如何，我做了一个小的 java 应用程序，用 Java Service Wrapper 脚本很好地包装了，但是当我运行该脚本时：

```
sh ./wrapper.sh console 
```

我马上就被拒绝了。权限被拒绝消息是这样的：

```
eval: 1: /home/user1/MyApp/bin/wrapper: Permission denied 
```

我的小 wrapper.sh 位于 MyApp/bin 文件夹中。MyApp/bin/wrapper 目录包含 2 个文件：

*   包装器-linux-x86-32
*   包装器-linux-x86-64

作为测试，我运行了以下 chmod 命令：

```
chmod a=rwx MyApp -R 
```

我验证了所有内容都是 rwx，即使在子文件夹中也是如此，并尝试再次运行脚本，结果完全相同......权限被拒绝。

有人知道我接下来可以尝试什么来让那个婴儿跑起来吗？

谢谢，兰斯洛特

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-07T23:19:23.673

托管您的脚本的文件系统可能会使用该`noexec`标志挂载。检查该文件系统的 /etc/fstab 条目，如果有，请`noexec`尝试将其删除，然后通过重新挂载该文件系统`mount /path/to/mountpoint -o remount`

再三考虑，检查`mount`命令的输出是否有 noexec 实例而不是 /etc/fstab（文件系统可能已动态挂载。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-07T23:37:28.030

I just noticed the error message references the name of the **directory** hosting your file:

```
eval: 1: /home/user1/MyApp/bin/wrapper: Permission denied 
```

We know it's a directory since you mentioned "The directory MyApp/bin/wrapper contains 2 files".

Could you check your script for instance where you're using the name of the directory as a command? Such as using wrapper (which is the directory name) instead of wrapper/wrapper-linux-x86-32 (which would be a file name), or similar errors?

Similar errors often appear when using spaces in filenames and forgetting to quote said filenames (probably not the case here, though.)

Failing that, could you edit your question to include the contents of the wrapper script you're calling?

*(New answer since it's completely unrelated to the previous noexec idea, and that one can stay for reference.)*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T23:17:18.343

您可能还必须向包装器授予执行脚本

chmod +x 包装器.sh

编辑：我刚刚注意到您的 wrapper.sh 位于您的 MyApp 文件夹 /EDIT

另外，如果你确定你有

```
#!/bin/sh 
```

在 .sh 文件的顶部，您可以像这样执行它：

.wrapper.sh

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T23:18:40.163

首先，尝试在文本编辑器中打开它，以确保您具有读取权限。如果是这样，做

```
chmod +x wrapper.sh 
```

并确保你`#!/bin/sh`在脚本的开头

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T04:39:02.760

You may try to execute the file that was there in other user's home directory, you can give permission to the user "user"

chmod -R a+x /home/user1 or chmod -R o+x /home/user1 chmod -R g+x /home/user1

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-04T09:57:32.990

Although my problem was a bit different this question appeared in my search few times while searching for similar problem so I'll post my findings here.

My problem was that I couldn't access storage/ folder after chmod command.

After executing command:

```
sudo chmod -755 storage -R    //notice -755 is wrong, it should be 755 
```

I couldn't access storage/ folder any more.

I've tried `ls -l`:

[![storage permissions d---------](https://i.stack.imgur.com/dB4l1.png)](https://i.stack.imgur.com/dB4l1.png)

Also after `git status`:

[![storage/.gitignore: Permission denied](https://i.stack.imgur.com/D7XLN.png)](https://i.stack.imgur.com/D7XLN.png)

After executing the right command:

```
sudo chmod 755 storage -R // without - 
```

everything returned back to normal.

# html - 左对齐和右对齐两个 div 标签的最佳方法是什么？

> ID：727958
> 
> 赞同：50
> 
> 时间：2009-04-07T23:16:13.540
> 
> 标签：html, alignment

在水平相邻的网页上右对齐和左对齐两个 div 标签的最佳方法是什么？如果可能的话，我想要一个优雅的解决方案来做到这一点。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-04-07T23:20:27.447

```
<div style="float: left;">Left Div</div>
<div style="float: right;">Right Div</div> 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-04-07T23:29:33.587

作为浮动的替代方式：

```
<style>
    .wrapper{position:relative;}
    .right,.left{width:50%; position:absolute;}
    .right{right:0;}
    .left{left:0;}
</style>
...
<div class="wrapper">
    <div class="left"></div>
    <div class="right"></div>
</div> 
```

考虑到没有必要将 .left div 定位为绝对（取决于您的方向，这可能是 .right ），因为这将位于 html 代码自然流中的所需位置。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-07T23:19:14.390

```
<style>
#div1, #div2 {
   float: left; /* or right */
}
</style> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-05T04:22:00.647

你可以用几行**CSS**代码来完成。您可以将**所有要彼此相邻出现的 div 对齐到 right**。

```
<div class="div_r">First Element</div>
<div class="div_r">Second Element</div>

<style>
.div_r{
float:right;
color:red;
}
</style> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-10-20T06:19:40.467

使用填充标签上面的浮动标签没有解决，我用过

```
padding left:5px; 

padding left :30px 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-18T11:47:29.160

我用下面的。流派元素将从 DJ 元素结束的地方开始，

```
<div>
<div style="width:50%; float:left">DJ</div>
<div>genre</div>
</div> 
```

请原谅内联CSS。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-21T18:58:22.917

此解决方案在最右侧具有左对齐的文本和按钮。

如果有人正在寻找材料设计的答案：

```
<div layout="column" layout-align="start start">
 <div layout="row" style="width:100%">
    <div flex="grow">Left Aligned text</div>
    <md-button aria-label="help" ng-click="showHelpDialog()">
      <md-icon md-svg-icon="help"></md-icon>
    </md-button>
 </div>
</div> 
```

# asp.net-mvc - ASP.NET MVC 中的动态站点地图

> ID：727961
> 
> 赞同：28
> 
> 时间：2009-04-07T23:17:46.610
> 
> 标签：asp.net-mvc

我正在尝试创建一个输出有效 sitemap.xml 文件的自动站点地图 ActionResult。文件的实际生成不是问题，但我似乎无法弄清楚如何填充系统中的 URL 列表。这是我到目前为止的代码：

```
 public ContentResult Sitemap()
    {
        XNamespace xmlns = "http://www.sitemaps.org/schemas/sitemap/0.9";
        XElement root = new XElement(xmlns + "urlset");

        //some kind of foreach here to get the loc variable for all URLs in the site
        //for each URL in the collection, add it to the root element as here

        //root.Add(
        //    new XElement("url", 
        //        new XElement("loc", "http://google.com"), 
        //        new XElement("changefreq", "daily")));

        using (MemoryStream ms = new MemoryStream())
        {
            using (StreamWriter writer = new StreamWriter(ms, Encoding.UTF8))
            {
                root.Save(writer);
            }

            return Content(Encoding.UTF8.GetString(ms.ToArray()), "text/xml", Encoding.UTF8);
        }
    } 
```

例如，假设我有两个控制器，每个控制器都有两个与之关联的操作：

**帮助控制器**

*   编辑
*   创造

**关于控制器**

*   公司
*   管理

我似乎无法弄清楚如何获取 URL 列表，例如：

*   [http://localhost/帮助/编辑](http://localhost/help/edit)
*   [http://localhost/help/create](http://localhost/help/create)
*   [http://localhost/about/company](http://localhost/about/company)
*   [http://localhost/about/management](http://localhost/about/management)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-09-11T01:35:48.287

我在`do-it-yourself`下面发布了一个答案。但这是一个为 MVC 站点开箱即用的包：

[http://mvcsitemap.codeplex.com/（<-](http://mvcsitemap.codeplex.com/)旧网站，但有大量文档！）

[https://github.com/maartenba/MvcSiteMapProvider/wiki（<-](https://github.com/maartenba/MvcSiteMapProvider/wiki)移动到新站点，缺少一些文档，并且不活跃）

请注意，它做了很多事情：

*   **自动在 Mvc 路由中注册自己以响应 SEO /sitemap.xml**请求（即使 /sitemap.xml 没有物理文件）。这与我发现的所有搜索引擎机器人完全兼容，并且在达到 10,000 时滚动等等。
*   附带一组局部视图，用于内置**BreadCrumb导航！**我们非常广泛地使用它，虽然动态数据部分有点麻烦，但它确实有效。
*   附带一组用于控制菜单的部分视图。
*   尊重 Controller 和 Action 方法的 [Authorize] 安全位。

以上所有点均由您编辑和配置的单个 mvc.sitemap XML 文件控制。我现在在许多项目中使用它来完成上述两点或三点。将其全部配置在 1 个地方，并动态生成，非常好。

虽然我发现创建动态数据提供者的能力有点麻烦（并且严重违反了您希望做的任何类型的 IoC），但一旦您绕过它们的缓存并使用您自己的缓存，它确实可以完成工作并很好地扩展。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-08T01:11:46.773

正如 likwid 所提到的，您希望反映您的模型命名空间并获取所有实现 IController 的类。拥有集合后，您想通过反射查看哪些成员（方法）返回 ActionResult 类型。

也许您可以创建自己的属性，[SitemapAttribute]，让您有选择地指定在站点地图中索引的方法（即，Index()，但不是 Edit()）。是的，我喜欢控制写入哪些方法（url）的想法。

这是一个很好的问题，因为我只是想这样做。+1！

```
// Controller abstract implements IController
public class HelpController : Controller
{
  public HelpController()
  {
  }

  [Sitemap]
  public ActionResult Index()
  {
    // does get written to the file, cause of [Sitemap]
  }

  public ActionResult Create()
  {
    // does not get mapped to the file
  }

  public ActionResult Edit()
  {
    // does not get mapped to the file
  }

  [Sitemap]
  public ActionResult ViewArticle()
  {
    // would get indexed.
  }
} 
```

关于如何进行反射，这里有一篇很好的 MSDN 文章来介绍反射：

[http://msdn.microsoft.com/en-us/library/ms172331.aspx](http://msdn.microsoft.com/en-us/library/ms172331.aspx)

好问题！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-09T00:24:40.137

根据 likwid 的评论，我查看了 Maarten Balliauw 的方法，但这对于我正在尝试做的事情似乎有点过头了。

我已经拼凑了一个临时解决方案。我只是传递控制器和操作名称来生成 URL。为了生成 URL，我使用以下代码：

```
 List<string> urlList = new List<string>();
    urlList.Add(GetUrl(new { controller = "Help", action = "Edit" }));
    urlList.Add(GetUrl(new { controller = "Help", action = "Create" }));
    urlList.Add(GetUrl(new { controller = "About", action = "Company" }));
    urlList.Add(GetUrl(new { controller = "About", action = "Management" })); 
```

其中GetUrl如下：

```
 protected string GetUrl(object routeValues)
    {
        RouteValueDictionary values = new RouteValueDictionary(routeValues);
        RequestContext context = new RequestContext(HttpContext, RouteData);

        string url = RouteTable.Routes.GetVirtualPath(context, values).VirtualPath;

        return new Uri(Request.Url, url).AbsoluteUri;
    } 
```

现在这似乎可以解决问题，尽管我确实喜欢将 actionfilter 应用于某些自动组合在一起的动作的想法。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-02-09T23:21:39.300

定义一个`ActionFilterAttribute`像这样的操作方法，它是您要在站点地图中列出的实际页面：-

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, Inherited = true, AllowMultiple = false)]
public class MVCUrlAttribute : ActionFilterAttribute
{
    public string Url { get; private set; }

    public MVCUrlAttribute(string url)
    {
        this.Url = url;
    }

    public override void OnResultExecuting(ResultExecutingContext filterContext)
    {
        // Put this 'canonical url' into the model (which feeds the view)
        // to help search engines with issues of duplicate content
        filterContext.Controller.ViewData["CanonicalUrl"] = url;
        base.OnResultExecuting(filterContext);
    }
} 
```

现在将类似这样的内容添加到您的全局应用程序启动代码中，或者在您的 sitemap.xml 生成代码中使用它：-

```
 // Find all the MVC Routes
    Log.Debug("*** FINDING ALL MVC ROUTES MARKED FOR INCLUSION IN SITEMAP");
    var allControllers = Assembly.GetExecutingAssembly().GetTypes().Where(t => t.IsSubclassOf(typeof(Controller)));
    Log.DebugFormat("Found {0} controllers", allControllers.Count());

    foreach (var controllerType in allControllers)
    {
        var allPublicMethodsOnController = controllerType.GetMethods(BindingFlags.Public | BindingFlags.Instance);
        Log.DebugFormat("Found {0} public methods on {1}", allPublicMethodsOnController.Count(), controllerType.Name);

        foreach (var publicMethod in allPublicMethodsOnController)
        {
            var mvcurlattr = publicMethod.GetCustomAttributes(true).OfType<MVCUrlAttribute>().FirstOrDefault();
            if (mvcurlattr != null)
            {
                string url = mvcurlattr.Url;
                Log.Debug("Found " + controllerType.Name + "." + publicMethod.Name + " <-- " + url);
                Global.SiteMapUrls.Add(url);  //<-- your code here using url
            }
        }
    } 
```

您可以扩展属性类以可能还包括更新提示的频率。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-08T19:58:53.117

因此，在我看来，控制器和操作的获取似乎是相对微不足道的部分。困难的部分是能够获取您可能希望在站点地图的 url 中显示的所有可能的参数值。如果您有类似 的 URL 模式`{controller}/{action}/{id}`，那么您将无法通过反射确定其含义`id`或可能的值。您能做的最好的事情就是确定系统类型。

当我看到这个时，我想到的是，站点地图实际上只是您站点数据的另一种视图。所以我的一个随机想法是，如果您从应用程序中的基本控制器继承，并且您在该基本控制器上有一个必须实现的方法，例如：

```
abstract ActionResult SiteMapSnippet(); 
```

然后，您可以创建一个`SiteMapController`调用解决方案中的每个其他控制器并询问它们的片段，然后在一个最终视图中将它们一起呈现。一种复合控制器，虽然这还不是这个框架中添加的概念。

# jquery - JQuery JEditable stay in edit mode on error

> ID：727973
> 
> 赞同：3
> 
> 时间：2009-04-07T23:23:18.967
> 
> 标签：jquery, jeditable

I'm successfully using jeditable to submit via a function using jQuery.ajax and the async : false option , but am having an issue aborting if an error is returned.

How can I get the edit box to stay activated and / or revert back to the original value if there are errors? I'm returning http status codes.

so something like

```
async : false .ajax submit here...
if (xhr.status == 200) {
  return value;
else {
  alert ('returned error');
  // keep edit box activated but available for another try, or revert back to original value
} 
```

I tried not returning a value from the function, which keeps the edit box activated and ready for another submit, but then the ESC key doesn't work anymore and if I click outside the edit area, the edit box stays.

Thanks in advance!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-15T18:30:05.497

不确定这对您的情况是否有帮助，但 jeditable 有一个重置方法......

尝试...

this.reset();

这会将元素恢复为具有原始值的显示模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-23T00:07:28.243

要保持编辑模式，只需设置响应标头“HTTP 404”并呈现错误文本。

PHP：

```
header('HTTP/1.1 400 Bad Request');
echo "Error Text"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-15T23:04:38.010

添加这个：

`$(this).editable("disable");`

这应该会阻止您的错误可编辑，不确定是否要恢复。我现在正在与恢复相同的问题作斗争，但我对 JavaScript 一无所知......

# jquery - jQuery hover() not working with absolutely positioned elements and animation

> ID：727975
> 
> 赞同：5
> 
> 时间：2009-04-07T23:23:33.117
> 
> 标签：jquery, animation, hover

I have some html that looks like this:

```
<a href="#" class="move"><span class="text">add</span><span class="icon-arrow"></span></a> 
```

And I have a jquery event registered on the anchor tag:

```
$('a.move').hover(
    function (event) {
        $(this).children('span.text').toggle();
        $(this).animate({right: '5px'}, 'fast');
    },
    function (event) {
        $(this).children('span.text').toggle();
        $(this).animate({right: '0px'}, 'fast');
    }
); 
```

When I mouse over the anchor tag, it displays the span.text and moves the anchor 5px to the right.

Now, due to complications that I don't feel like getting into, I have to set position: relative; on the container and absolutely position the icon and the text so that the icon appears on the left and the text on the right.

THE PROBLEM:

When I mouse over the anchor tag, the icon moves right, and the mouse ends up over top of the text (which appears). Unfortunately, the 'out' function gets called if I move my mouse from the icon to the text and the animation starts looping like crazy. I don't understand what's causing the "out" event to fire, as the mouse is never leaving the anchor tag.

Thanks!

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-08T04:51:15.437

您可以使用“mouseenter”和“mouseleave”事件代替悬停，当子元素妨碍时不会触发：

```
$('a.move').bind('mouseenter', function (e) {
  $(this).children('span.text').toggle();
  $(this).animate({right: '5px'}, 'fast');
})
.bind('mouseleave', function (e) {
  $(this).children('span.text').toggle();
  $(this).animate({right: '0px'}, 'fast');
}); 
```

# c# - 可以 在 asp.NET WebUserControl 中有类型标签吗？

> ID：727979
> 
> 赞同：0
> 
> 时间：2009-04-07T23:26:16.107
> 
> 标签：c#, .net, asp.net

我想在 asp.NET (C#) 中创建一个 WebUserControl（不是自定义控件）。当在 aspx 页面中使用时，我希望有`<param>`可以放在控件的开始/结束标签之间的标签。

例如：

```
<abc:myWebUserControl id="myWUC" runat="server">
    <param name="pName1" value="pValue1">
    <param name="pName2" value="pValue2">
    <param name="pName3" value="pValue3">
</abc:myWebUserControl> 
```

这可以做到吗？你是怎么做的，你是如何读取参数数据的？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-07T23:31:10.727

这仅在自定义服务器控件上可用...

这是一篇如何写的文章：

[http://www.devx.com/codemag/Article/32182/1763/page/1](http://www.devx.com/codemag/Article/32182/1763/page/1)

# c# - 关于实例字段和线程起源的安全问题

> ID：727981
> 
> 赞同：0
> 
> 时间：2009-04-07T23:27:02.483
> 
> 标签：c#, multithreading

在 C# 中，类字段意味着每个线程都有自己的该对象实例。

例如，线程 1 将拥有自己的对象 a 实例，对象 b 也将拥有。

所以 2 个 Web 应用程序的用户，在不同的 PC 上，应该在不同的线程下访问一个实例字段（比如说一个集合），对吧？

这让我提出一个问题，为什么我需要编写代码来同步集合？如果集合是基于实例而不是共享状态。

仅仅是因为我可能有另一个线程在我修改它的状态时尝试读取集合。我说“是”是因为这只是我实际编写的代码的一种可能情况吗？例如，产生一个线程来读取非同步集合，并使用原始线程写入集合。或者还有其他问题吗？

我把它放在初学者部分，因为这似乎是一个基本问题。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T23:32:02.830

在 C# 中，默认情况下一个类没有每个对象的自己的实例。

类实例和线程是两个独立的构造（除非成员被标记为 [ThreadStatic] 或其他一些异常）。如果您创建实例，然后运行单独的线程，它将在相同的实例上工作（除非单独的线程创建自己的对象实例）。

由于线程通常会在相同的实例上工作（为了共享数据和状态），因此您需要适当地同步它们。

如果线程从不共享对象的状态或实例，那么您无需担心同步问题。不过，这在实践中很少见——通常线程正在处理某种类型的共享数据。如果每个生成的线程都创建自己的对象，并且没有其他线程与它们通信，则可以忽略同步。

# asp.net - ASP.NET 树视图性能

> ID：727983
> 
> 赞同：2
> 
> 时间：2009-04-07T23:27:41.750
> 
> 标签：asp.net, javascript, performance, treeview, postback

在使用 TreeView 时，为了最大限度地提高性能，建议做些什么？

通过最大化性能，我的意思是最小化客户端到服务器之间的旅行次数，即回发。

这是否意味着，我的大部分业务逻辑都将位于 Javascript 中？这里的妥协是什么？

我说的是 ASP.net TreeView 服务器控件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T18:36:25.640

首先，决定你想把你的编程逻辑放在哪里：为了速度，最好使用其他一些树视图控件（不使用表格布局）和javascript框架来处理点击事件。我建议使用普通的旧 ashx 处理程序文件进行 AJAX 通信，它们的开销比 aspx 和调用页面方法少。AJAX 调用和结果必须仅包含 JSON 或 XML 格式的数据，而不是 HTML。

另一方面，像 VS 和 TreeView 控件这样的 RAD 工具提供了 Web 应用程序的快速生产，但当然有一些惩罚：您需要返回服务器处理每个单击/选择事件，这会导致整个页面生命周期处理的问题以及用于 ajax 调用的大量数据传输（对于每个 ajax 事件，ViewState 和 HTML 都会从服务器传输到客户端）。

但如果你想坚持使用 TreeView，我建议：
- CSS 友好控制适配器：它们大大减少了生成的 html 的大小（在我的例子中，从 100kb 到 20kb 的 html）并用 ul/li 元素替换表格布局
- 将 TreeView 包裹在里面ASP.NET AJAX UpdatePanel，但只是树视图，并使用面板的条件更新。不要害怕使用多个更新面板
——保持 ViewState 最小化

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T00:24:49.273

开发开销 - 您必须在 javascript 和代码后面维护您的业务逻辑。

如果脚本很大，客户端性能的降低也是一个问题。

# .net - Convert a 24 bit in memory image to indexed color

> ID：727987
> 
> 赞同：2
> 
> 时间：2009-04-07T23:28:34.617
> 
> 标签：.net, gdi+, system.drawing

I have an image that I have created in memory as Format24bppRgb.

I save this as a PNG and it is 24kb.

If I save the same image with photoshop as a 24bit PNG it comes to about the same size, but if i save it as an 8bit PNG with only 32 colors it goes down to 5kb.

How can I create an indexed version of a PNG file using C# / GDI+ / System.Drawing ?

I'm having a hard time finding any answers to this question that don't just apply to grayscale images or require an external library. is it not possible within GDI+ as is?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T23:46:26.470

我最终使用了带有 C# 包装器的[FreeImageAPI DLL 。](http://freeimage.sourceforge.net/)我尽量避免使用 3rd 方库，但我认为没有其他选择。它似乎是一个非常标准且使用良好的库。

在我的例子中，我有一个动态创建的`System.Drawing.Image`对象`'image'`——我想将它作为压缩图像保存到 HttpContext 输出流中。注意`Image`没有需要的`GetHbitmap()`方法，但是`Bitmap`有。

```
// convert image to a 'FreeImageAPI' image
var fiBitmap = FreeImageAPI.FreeImageBitmap.FromHbitmap((image as Bitmap).GetHbitmap());
fiBitmap.ConvertColorDepth(FreeImageAPI.FREE_IMAGE_COLOR_DEPTH.FICD_08_BPP);

// see http://stackoverflow.com/questions/582766
MemoryStream ms = new MemoryStream();
fiBitmap.Save(ms, FreeImageAPI.FREE_IMAGE_FORMAT.FIF_PNG, FreeImageAPI.FREE_IMAGE_SAVE_FLAGS.PNG_Z_BEST_COMPRESSION);
context.HttpContext.Response.OutputStream.Write(ms.ToArray(), 0, (int)ms.Length); 
```

我的 24kb 位图现在只有 9kb :-)

**提示：**当您运行它时，请确保在您的 bin 中同时提供 'FreeImageNET' 和 'FreeImage' dll。目前，C# 示例项目包含对“Library.DLL”的引用，该引用似乎不存在于其 zip 文件中。使用`FreeImageNET.dll`和`FreeImage.dll`工作。如果你没有意识到，你会得到一个恼人的文件未找到错误`FreeImageNet`！= `FreeImage`！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-20T02:49:06.647

您可以使用**nQuant**执行此操作（您可以使用 nuget 安装它，或参见下面的参考资料）。以下示例转换磁盘上的图像，并且很容易适应您的需要。

```
 public static bool TryNQuantify(string inputFilename, string outputFilename)
    {
        var quantizer = new nQuant.WuQuantizer();
        var bitmap = new Bitmap(inputFilename);
        if (bitmap.PixelFormat != System.Drawing.Imaging.PixelFormat.Format32bppArgb)
        {
            ConvertTo32bppAndDisposeOriginal(ref bitmap);
        }

        try
        {
            using (var quantized = quantizer.QuantizeImage(bitmap))
            {
                quantized.Save(outputFilename, System.Drawing.Imaging.ImageFormat.Png);
            }
        }
        catch
        {
            return false;
        }
        finally
        {
            bitmap.Dispose();
        }
        return true;
    }

    private static void ConvertTo32bppAndDisposeOriginal(ref Bitmap img)
    {
        var bmp = new Bitmap(img.Width, img.Height, System.Drawing.Imaging.PixelFormat.Format32bppArgb);
        using (var gr = Graphics.FromImage(bmp))
            gr.DrawImage(img, new Rectangle(0, 0, img.Width, img.Height));
        img.Dispose();
        img = bmp;
    } 
```

有关更多信息，请参阅：

*   [http://nquant.codeplex.com/](http://nquant.codeplex.com/)
*   [https://code.msdn.microsoft.com/windowsdesktop/Convert-32-bit-PNGs-to-81ef8c81](https://code.msdn.microsoft.com/windowsdesktop/Convert-32-bit-PNGs-to-81ef8c81)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T21:45:49.427

您正在尝试将 16777216 种颜色转换为 32 种颜色。这是一个非常重要的问题，并且有很多方法可以做到这一点，所有这些方法都有其优点和缺点。这不是您经常需要做的事情，尤其是在全彩色显示器变得无处不在之后。

这篇 Microsoft 文章有一些关于 GIF 文件的信息，这些信息也应该与 PNG 相关。

[http://support.microsoft.com/default.aspx?scid=kb;EN-US;Q319061](http://support.microsoft.com/default.aspx?scid=kb;EN-US;Q319061)

# git - git - 合并时跳过特定提交

> ID：727994
> 
> 赞同：227
> 
> 时间：2009-04-07T23:32:54.437
> 
> 标签：git, version-control

我已经使用 Git 大约一年了，觉得它很棒，但我刚刚开始了该项目的第二个版本，并为其创建了一个新分支。我正在努力寻找处理未来事情的最佳方式。

我有两个分支，分别称为 master10（用于 v1）和 master20（用于 v2）。我一直在 master10 分支的 v1 中进行错误修复，并开发 master20 的新内容。每当我进行错误修复时，我都会通过检查 master20 并将其合并到 v2 中并执行`git merge master10`. 到现在为止还挺好。

然而现在，我在 v1 中做了一些我不想在 v2 中进行的更改，但我想继续合并其他错误修复。我如何告诉 Git 跳过那个特定的提交（或一系列提交），但是我仍然想合并其他错误修复。

我认为`git rebase`这可能是我需要的，但读了文档，我的头几乎要爆炸了。

我想我想要的是一个类似于“git sync”的命令，它告诉 git 两个分支现在是同步的，并且将来只会合并来自这个同步点的提交。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2009-04-08T12:26:14.170

例如，如果您想将分支“maint”上的大部分但不是所有提交合并到“master”，您可以这样做。它需要一些工作——如上所述，通常的用例是合并分支中的所有内容——但有时会发生你对不应该集成回来的发布版本的更改（也许该代码的已经被master取代了），那么你如何表示呢？开始...

所以让我们假设 maint 已经应用了 5 个更改，其中一个 (maint~3) 不会合并回 master，尽管所有其他的都应该合并。您分三个阶段执行此操作：实际合并之前的所有内容，告诉 git 将 maint~3 标记为已合并，即使未合并，然后合并其余部分。神奇之处在于：

```
bash <master>$ git merge maint~4
bash <master>$ git merge -s ours maint~3
bash <master>$ git merge maint 
```

第一个命令在您麻烦的维护提交到 master*之前合并所有内容。*默认合并日志消息将说明您正在合并“分支'维护'（早期部分）”。

第二个命令合并了麻烦的 maint~3 提交，但是“-s ours”选项告诉 git 使用特殊的“合并策略”，实际上，它通过简单地保留您要合并到的树并忽略提交来工作（s ) 你正在完全合并。但它仍然会以 HEAD 和 maint~3 作为父级进行新的合并提交，因此修订图现在显示 maint~3 已合并。所以实际上你可能也想使用 -m 选项来`git merge`解释那个 maint~3 提交实际上被忽略了！

最后的命令只是将其余的 maint (maint~2..maint) 合并到 master 中，这样你就可以再次同步了。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-09-10T16:00:03.070

恕我直言，最合乎逻辑的做法是**合并所有内容，然后使用 git revert (commit_you_dont_want) 将其删除**。

例子：

```
git merge master
git revert 12345678 
```

如果您有多个“忽略”提交，或者想要编辑还原消息：

```
git merge master
git revert -n 123456
git revert -n abcdef
git commit -m "... Except commits 123456 and abcdef" 
```

那么您的历史记录可能如下所示：

```
| ... Except 123456 and abcdef
|\ Merge branch 'master' into 'your_branch' 
```

如果您的冲突仅涉及这些“忽略”提交，您可以使用：

```
git merge master -X ours 
```

因此，您的版本将持续存在于另一个版本之上。即使没有错误消息，您仍然可以“还原”那些不需要的提交，因为它们可能有其他不冲突的更改，而您仍然不想要它们。

如果您的冲突不仅涉及“to-ignore”提交，您应该手动解决它们，并且您可能必须在恢复期间再次解决它们。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-04-08T02:42:47.333

提交包括祖先。如果不合并先前的提交，则无法合并提交。

当然，您可以挑选它们。当您有一个处于维护模式的分支时，这是一个很好的流程。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-04-13T10:37:39.010

听起来像是 'git cherry-pick' [https://git-scm.com/docs/git-cherry-pick的经典案例](https://git-scm.com/docs/git-cherry-pick)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-07-20T21:01:59.757

[我的项目](https://github.com/niamster/gitmerge)的一种广告，它基本上包含了@araqnid 描述的过程。

它是一种引入以下 GIT 流程的助手：

*   从维护分支到 dev/master 分支的未决合并有每日/每周通知
*   分支维护者检查状态并自己决定是否需要所有提交，并阻止一些提交或要求开发人员阻止自己。最后维护分支并入上游。

项目页面的引用：

> 根据工作流程，可能会有维护或客户特定的分支以及主分支。这些分支也称为 LTS 分支。
> 
> 通常，热修复会进入报告错误的分支，然后将提交合并回主分支。
> 
> 一般的做法是让所有分支与主分支完美同步，即您希望查看特定分支和主分支之间的清晰增量，以了解主分支是否包含所有功能和错误修复。
> 
> 但是，有时您不想要特定的提交，因为它们是特定于客户的，其他用户不可见。或者您的主分支分歧很大，以至于需要完全不同的方法来解决问题，或者更好的是，问题不再存在。
> 
> 同样，如果从 master 中选择cherry-pick 到维护分支，则生成的提交应在 master 中被阻止。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-05-18T17:03:31.883

您可以为此使用 git-cherry pick：

```
git cherry-pick $(git merge-base HEAD origin/branch)..$(git rev-parse <offending-commit-hash>^)
git cherry-pick <offending-commit-hash>..$(git rev-parse origin/branch) 
```

这从当前的最后一次常见提交中挑选所有提交`HEAD`，`origin/branch`直到提交被忽略（注意`^`告诉cherry-pick 在该提交的父级处停止）。

第二个命令从`<offending-commit-hash>`其余的`origin/branch`.

请注意，如果需要跳过提交以合并其他补丁，则可能仍需要进行一些修补（git 将停止 cherry-pick 并告诉您解决冲突）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-08T00:02:55.130

在 master10 中为您想要的更改创建第三个分支，而不是在 master20 中。始终将 master10 视为您的“主人”，这是所有分支中最稳定的。所有其他分支都希望始终保持同步的分支。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-08T18:35:57.010

而不是这种`revert`情况`cherry-pick`，您需要让 git 考虑您跳过的更改比您所做的更改更早。

所以：

1.  在要跳过的提交之前合并最后一次提交。当然，这将合并之前的所有提交。 `git merge ccc`
2.  合并要跳过的提交。 `git merge fff --no-commit`
3.  暂存任何合并，取消暂存所有更改，撤消所有更改。（也许有防呆的命令，但我只是在 UI 中做这部分 - 但是你知道怎么做）
4.  完成空合并`git merge --continue`
5.  在您要跳过的提交之后合并提交。 `git merge source-branch-head`

在第 4 步之后，git 将认为您的分支比该提交更新，因为您已经处理了它（通过选择保留您的事物版本）。

# html - Internet Explorer 中的表格行高

> ID：727995
> 
> 赞同：10
> 
> 时间：2009-04-07T23:33:10.067
> 
> 标签：html, css, internet-explorer

我有下表：

```
<table>
    <tr>
        <td style="height: 7px; width: 7px"> A1 </td>
        <td style="height: 7px"> B1 </td>
        <td style="height: 7px; width: 7px"> C1 </td>
    </tr>
    <tr>
        <td style="width: 7px"> A2 </td>
        <td> B2 </td>
        <td style="width: 7px"> C2 </td>
    </tr>
    <tr>
        <td style="height: 7px; width: 7px"> A3 </td>
        <td style="height: 7px"> B3 </td>
        <td style="height: 7px; width: 7px"> C3 </td>
    </tr>
</table> 
```

基本思想是第一行必须是 7 个像素高。最左边和最右边的单元格（A1 和 C1）必须为 7px 宽，中间的单元格 (B1) 必须根据表格的宽度进行缩放。底行（A3、B3、C3）也是如此。

但是，中间行需要按高度缩放 ​​- 换句话说，它需要是`(tableheight - 14px)`. 最左边和最右边的单元格（A2、C2）需要 7 个像素宽。

一个例子：

```
 7px              x               7px
          |------|-------------------------|------|

---       +------+-------------------------+------+
 |        |      |                         |      |
 | 7px    |      |                         |      |
 |        |      |                         |      |
---       +------+-------------------------+------+
 |        |      |                         |      |
 |        |      |                         |      |
 |        |      |                         |      |
 |        |      |                         |      |
 | y      |      |                         |      |
 |        |      |                         |      |
 |        |      |                         |      |
 |        |      |                         |      |
 |        |      |                         |      |
---       +------+-------------------------+------+
 |        |      |                         |      |
 | 7px    |      |                         |      |
 |        |      |                         |      |
---       +------+-------------------------+------+ 
```

但是：在 Internet Explorer 中，宽度可以正常工作（A 列和 C 列是 7px，B 列是动态缩放的） - 但高度不能。无论我做什么，第 1 行、第 2 行和第 3 行都正好是桌子高度的 33%。不幸的是我必须使用这个表，所以用一组 DIV 替换它不是一个选项。

我有以下文档类型：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

我需要保留这一点，因为页面上的其他一些元素依赖于一些复杂的基于 CSS 的布局。

谁能指出我正确的方向来为 IE 鞭打这个形状？

编辑：应该在前面提到 - 这个表是使用 javascript 动态调整大小的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-08T10:21:57.667

过去我发现单元格的高度属性被单元格内的字体大小覆盖，即使没有字体存在。将字体大小设置为 1 或 0 像素，您的高度将真正生效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T07:24:25.883

试试这个：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T23:39:31.190

您可以使用垫片，而不是使用高度属性（因为它会导致问题）。例如一个透明的小 gif，你也可以将高度设置为你想要的数量。你会这样做的gif：`<img src="./gfx/spacer.gif" style="height:14px;" />`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T10:06:39.203

> 该表使用 javascript 动态调整大小。

那么如何设置：

```
table.rows[1].style.height= (totalheight-14)+'px'; 
```

明确地？

实际的老派正确答案是：

```
<tr height="7">...<tr>
<tr height="*">...<tr>
<tr height="7">...<tr> 
```

不幸的是，浏览器从未真正支持 HTML '*'/'n*' 语法。你可以说：

```
<tr style="height: 7px;">...</tr>
<tr style="height: 100%;">...</tr>
<tr style="height: 7px;">...</tr> 
```

但是 IE 从字面上理解这一点，并使中间行成为整个表格高度的 100%（这反过来又使表格比应有的高度高）。您*可以*将它与 IE hack 结合使用，以使该浏览器上的表格高度小 14px，也许。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-17T17:00:53.853

我所做的是首先用所有行的宽度和高度声明最外面的列，然后将中间列中的所有行与行跨度合并。

对于高度，在合并后的中间列中，我只写`<tr width`了没有高度，我认为所有浏览器都支持没有高度。不需要 GIF。它一直对我有用。

希望这能有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-12-30T18:34:18.737

打印预览和打印副本中也出现了 IE9-Beta 行高过高的问题。例如，当您尝试打印 1px 高的行时，会出现行高问题。为了解决这个问题，我在整个 HTML 代码块周围添加了`<div style="font-size:0pt;">`...。`</div>`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-06-03T18:44:05.043

我只是有一个类似的问题。我注意到在 IE 中`width`有时需要将属性定义为百分比才能与 IE 一起使用

```
style="width: 25%" 
```

然后在 css 中绝对定义以实现跨浏览器的连续性

```
.squares {
text-align: left;
margin: 0 auto;
height:250px; width:250px;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-10-21T16:04:00.783

试试这个

```
<table>
    <tr>
        <td style="height: 7px; width: 7px"> A1 </td>
        <td style="height: 7px"> B1 </td>
        <td style="height: 7px; width: 7px"> C1 </td>
    </tr>
    <tr height="100%">
        <td style="width: 7px"> A2 </td>
        <td> B2 </td>
        <td style="width: 7px"> C2 </td>
    </tr>
    <tr>
        <td style="height: 7px; width: 7px"> A3 </td>
        <td style="height: 7px"> B3 </td>
        <td style="height: 7px; width: 7px"> C3 </td>
    </tr>
</table> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-08-12T07:44:57.367

试试这个……它对我有用……

```
<td style="height:2px;font-size:2px;">
     <img  height="2px" alt="" src="images/transparent.gif" />
</td> 
```

# c# - 防止方法被继承

> ID：727996
> 
> 赞同：6
> 
> 时间：2009-04-07T23:33:52.327
> 
> 标签：c#, inheritance-prevention

我有一个具体的基类 Foo，它包含 30 个与其子类相关的方法。

现在我遇到了只针对基类的情况，我想创建一个不能被继承的方法，这可能吗？

```
Class Foo 
{
   /* ... inheritable methods ... */

   /* non-inheritable method */
   public bool FooSpecificMethod()
   { 
      return true;
   } 
}

Class Bar : Foo
{
    /* Bar specific methods */
}

var bar = new Bar();
bar.FooSpecificMethod(); /* is there any way to get this to throw compiler error */ 
```

**编辑**

我不确定我最初是否清楚。

我确实了解继承原则，也了解 Liskov 替换原则。在这种情况下，有一个异常只处理“未继承”的情况，所以我不想创建一个“未继承的Foo”子类。

我在问是否在技术上可以创建 foo.FooSpecificMethod() 是有效且可公开访问的方法，但 subclassoffoo.FooSpecificMethod() 会引发编译器错误的情况。

本质上，我想要一个未密封类的密封方法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-07T23:36:05.270

我会重新考虑这样做的必要性。

如果您使用继承，则建议“Bar”是“Foo”。如果“Bar”始终是“Foo”，则适用于“Foo”的方法也应该适用于“Bar”。

如果不是这种情况，我会将其重新设计为私有方法。在公开场合，Bar 应该始终是 Foo。

* * *

只是为了更进一步-

如果你能做到这一点，事情会变得非常复杂。您可能会遇到以下情况：

```
Foo myBar = new Bar(); // This is legal
myBar.FooSpecificMethod(); // What should this do?  
                           // It's declared a Foo, but is acutally a Bar 
```

不过，您实际上可以使用反射来强制执行此行为。我认为这是一个坏主意，但 FooSpecificMethod() 可以检查 this 的类型，如果不是 typeof(Foo)，则抛出异常。这将是非常混乱的，并且有非常难闻的气味。

* * *

针对问题的编辑进行编辑：

编译器无法强制执行您的要求。如果您真的想强制编译器检查并防止这种情况发生，您真的应该考虑将 Foo 设为密封类。在这种情况下，您可以使用除子类之外的其他扩展方法。

例如，您可能想要考虑使用事件或委托来扩展行为，而不是允许对象成为子类。

试图做你正在完成的事情基本上是试图阻止继承的主要目标。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-07T23:56:19.373

布赖恩关于 Liskov Substitution 的权利（升级）。里德关于“is-a”的说法是正确的（也升级了）；事实上，他们都在告诉你同样的事情。

您的公共方法是与您的类 Foo 的用户的*合同*，说“您总是可以”在 Foo 上调用这些方法。

子类化 Foo 意味着您说在可以使用 Foo 的地方总是可以使用子类，例如 Bar。特别是，这意味着您不（必然）继承 Foo 的实现（您可以覆盖它，或者 Foo 可能是抽象的并且没有为方法提供特定的实现）。

实现的继承（如果有）是一个细节；你*真正继承*的是公共接口、契约、对用户的*承诺*，即 Bar 可以像 Foo 一样使用。

事实上，他们甚至可能永远不会知道他们有一个 Bar，而不是 Foo：如果我创建一个 FooFactory，并且我编写它的 Foo* getAFoo() 来返回一个指向 Bar 的指针，他们可能永远不会知道，*也不必*.

当你打破这个契约时，你就打破了面向对象。（Java Collection 类通过抛出 NotSupported 异常，完全破坏了 OO——用户不能再多态地使用所谓的子类。这是糟糕的、糟糕的设计，这让许多 Java 用户非常头疼，*而不是*模仿。 )

如果有一个 Foo 子类不能使用的公共方法，那么该方法不应该在 Foo 中，它应该在 Foo 子类中，并且其他子类应该从 Foo 派生。

现在，这并不意味着 Foo 中的所有方法都可以在子类上调用。不，我不是在自相矛盾。*非公共*方法不是类的公共接口的一部分。

如果您希望 Foo 中的方法不能在 Bar 上调用，*并且*不应该在 Foo 中公开调用，那么将该方法设为私有或受保护。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-07T23:35:30.780

不，这将违反[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)。

务实地说，您可以让它在 Bar 中“抛出 NotImplementedException()”，或者从 Foo 中删除该方法并将其移至它适用的子类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-07T23:45:52.907

将函数设为私有将阻止子类直接调用它。

如果您正在谈论不想重载的虚函数，请在要“锁定”该函数起作用的点将该函数标记为密封。

即使它是一个私有函数，它仍然可以通过反射来调用。

您还可以在接口上声明函数，并在类上显式实现接口，这将迫使您将其强制转换为接口以使用该函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-07T23:40:42.343

您可以创建一个私有函数，然后使用反射调用它。可能有点过火了。无论如何，只需将函数放在您的基类中，并附上说明它只能从基类调用的注释。甚至可能是智能感知出现的那些漂亮的 /// 评论。然后，您可能会遇到错误，但是，您总是会遇到错误，您能做的最好的事情就是记录这种情况以尝试避免它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2022-01-04T14:38:04.287

我自己一直在努力实现这一目标，并遇到了这篇文章，它有一些很好的答案，但没有达到海报所追求的目标，但有*一种*方法可以强制执行。您需要覆盖现有方法，然后使用 Obsolete 属性。将 Obsolete 属性的 error 属性设置为 true 将阻止编译。

```
Class Foo 
{
   /* ... inheritable methods ... */

   /* non-inheritable method */
   public bool FooSpecificMethod()
   { 
      return true;
   } 
}

Class Bar : Foo
{
    /* Bar specific methods */

   [Obsolete("Don't use this for whatever reason", true)]//true triggers the compiler error
   public new bool FooSpecificMethod()
   { 
      return true;
   } 
}

var bar = new Bar();
bar.FooSpecificMethod(); /* this now throws a compiler error */ 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-12T21:33:36.847

我最终使用的解决方案是创建一个公共内部继承类。这样，它就能够访问基类的私有变量（根据需要），并且我不需要公开任何这些私有变量或函数（我不想这样做）。

非常感谢您的所有建议，它让我重新思考我需要从这个安排中得到什么。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-27T19:03:21.087

派生类可以在不违反里氏替换原则的情况下隐藏基类成员有两个原因：

1.  如果有问题的成员是“受保护的”，它本质上只代表父类和派生类之间的契约。因此，它不会对派生类强加任何义务，除非与父类的合同要求。如果基类的公共成员依赖于具有特定含义的外部实例的某些非公共特定成员，则更改该成员含义的派生类可能违反 LSP，即使该成员本身不是公共的，因为更改其含义可能改变使用它的公共成员的行为。然而，在基类定义了受保护成员但不使用它的情况下，派生类可以对该成员做任何它喜欢的事情，而不会违反 LSP。理解受保护成员的关键是`ToyotaCar` 不应该改变`Car` 的公共成员的语义的原因是对`ToyotaCar` 的引用可能被提供给期望`Car` 而不是比“丰田汽车”。另一方面，如果`ToyotaCar`以一种不被任何公共成员公开的方式改变`Car`的受保护方法的行为，唯一可以注意到这种改变的代码是`ToyotaCar`中的代码或其衍生物，这样的代码会知道它有一个`ToyotaCar`。其他一些`Car`派生的代码（例如`FordCar`）可以访问`Car`的受保护成员，但保证*不会*访问`ToyotaCar`实例上的那些方法。t 被任何公众成员公开，唯一可以注意到这种更改的代码是在“ToyotaCar”或其派生类中的代码，并且这样的代码会知道它有一个“ToyotaCar”。其他一些`Car`派生的代码（例如`FordCar`）可以访问`Car`的受保护成员，但保证*不会*访问`ToyotaCar`实例上的那些方法。t 被任何公众成员公开，唯一可以注意到这种更改的代码是在“ToyotaCar”或其派生类中的代码，并且这样的代码会知道它有一个“ToyotaCar”。其他一些`Car`派生的代码（例如`FordCar`）可以访问`Car`的受保护成员，但保证*不会*访问`ToyotaCar`实例上的那些方法。
2.  有时，让一个基类型或接口公开一些成员，这些成员并不都适用于每个实现类型，这很有用。虽然接口隔离原则建议应该避免“厨房水槽”接口，但在某些情况下，这种接口可能比任何替代方法都更实用。例如，某些“流”类可能支持不同的握手模式，但其他类型则不支持。如果引用流将通过不关心握手的代码传递，则让 Stream 类包含可能可用或可能不可用的握手选择属性可能比要求代码尝试强制转换传入的属性更容易如果是，请参考 `IHandshakeSelector` 并设置 `IHandshakeSelector.HandshakeMode`。另一方面，

我认为虽然基类成员隐藏*通常*是糟糕设计的标志，但在某些情况下隐藏基类成员比让它们暴露更合适；如果派生类不可能*正确*使用受保护的方法（就像 的派生类可用的方法一样`MemberwiseClone`）`List<T>`，则没有理由将其公开。不幸的是，没有完全干净的方法可以隐藏这些成员。最好的办法是声明一个同名的公共成员（使用“new”修饰符），这将阻止对基类成员的所有访问。例如，代码可以定义一个`MemberwiseClone`没有成员的嵌套公共静态类。这`EditorBrowseable`属性可用于阻止 Intellisense 显示该嵌套类，但即使代码确实尝试使用该类，它也没有成员，并且无法创建该类型的存储位置，因此它应该是无害的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-05-14T15:15:48.423

如果您想实现您正在尝试做的事情并从私有对象（即您当前继承的对象）公开方法，您应该考虑组合 [ [http://en.wikipedia.org/wiki/Composite_pattern } 而不是继承。](http://en.wikipedia.org/wiki/Composite_pattern)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-03-26T08:17:51.230

正如其他人指出的那样，这是不可能的，最重要的是，它不应该是必要的。

当我有以下结构时，我遇到了同样的问题：
- 具有子类属性的父类。
- 子类会暴露不同的属性，但都有相同的初始化过程，所以我把代码放在父类中。

```
public class Parent
{
    public CHILD1 Child1;
    public CHILD2 Child2;

    public Parent(params args){
        Child1 = new CHILD1(arg1, arg2);
        Child2 = new CHILD2(arg1, arg2);
    }
    //split here
    public Parent(object arg1, object arg2) {
        PropertyInfo[] list = this.GetType().GetProperties();
        foreach (var pi in list) {
            pi.SetValue(this, BL.Method(arg1, arg2, this.GetType().Name, pi.Name) // get data
        }
    }
}

public class CHILD1 : Parent
{
    public CHILD1(object arg1, object arg2) : base(arg1, arg2) { }

    public object C1Property1 { get; set; }
    public object C1Property2 { get; set; }
    // ..
}

public class CHILD2 : Parent
{
    public CHILD2(object arg1, object arg2) : base(arg1, arg2) { }

    public object C2Property1 { get; set; }
    public object C2Property2 { get; set; }
    // ..
} 
```

现在我可以打电话了`parent.Child1.C1Property1`。但是该代码还允许调用以下内容：`parent.Child1.Child1.Property1`，这没有意义并导致异常，因为`Child1.Child1`属性始终为`null`。

为了解决这个问题，我所要做的就是将父类的代码分成两个类：

*   一个持有 Child 属性并调用子构造函数
*   和一个用构造函数逻辑来填充属性。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-01-13T13:17:03.173

也许您可以简单地将它创建为父类上的**虚拟方法，****然后在继承它的子类上覆盖它**，抛出 NotImplementedException 或类似的东西。

此外，但只有当你愿意忍受一些意大利面条时，你才能**将方法的签名放在接口中**，然后让所有需要这种方法的类**实现它**。缺点是您必须在所有这些孩子中声明相同的方法。

我不确定这是否可能，但也许可以为该接口编写扩展方法？

请记住，这些都违反了 OOP 的封装原则，尽管是轻微的，这使它们变得更加有趣。

# css - 单选按钮的 CSS 格式

> ID：727999
> 
> 赞同：0
> 
> 时间：2009-04-07T23:36:01.060
> 
> 标签：css

给定以下 HTML 片段：

```
<span name="foo" class="foo-class">
   <input name="foo" value="0" id="foo2_0" type="radio">
   <label for="foo2_0">The Server Side</label>
   <input name="foo" value="1" id="foo2_1" type="radio">
   <label for="foo2_1">Java Lobby</label>
   <input name="foo" value="2" id="foo2_2" type="radio">
   <label for="foo2_2">Java.Net</label>
</span>

<span name="bar" class="bar-class">
   <input name="bar" value="0" id="bar2_0" type="radio">
   <label for="bar2_0">The Server Side</label>
   <input name="bar" value="1" id="bar2_1" type="radio">
   <label for="bar2_1">Java Lobby</label>
   <input name="bar" value="2" id="bar2_2" type="radio">
   <label for="bar2_2">Java.Net</label>
</span> 
```

是否有 CSS 将水平布局 foo 中的 radiochoices：

服务器端 Java 大厅 Java.Net

而 bar 中的 radiochoices 垂直，就好像它们被分开了`<br/>`？

服务器端
Java 大厅
Java.Net

或者您是否需要将 css 类属性添加到单选按钮、标签或两者？

编辑时：这是生成的代码，因此虽然可以将 span 标签更改为您希望的任何内容，但对 span*内的标签（输入和标签标签）的唯一可能更改*是将 css 类添加到输入和标签中。（如果我想要简单，我会将每个 radiochoice 包装在一个. 中`<li>...</li>`。不幸的是，我必须使用我所拥有的。）

注意：一个完全可以接受的答案是，“这不能（便携式）完成，找到更好的方法来生成代码，伙计”，但如果这是答案，请告诉我为什么。

* * *

啊，太好了！jdangel 的解决方案不仅有效，而且如果我将相同的 CSS 分配给包含跨度的 div，它也有效。谢谢jdangel。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T23:53:56.680

根据反馈编辑：太糟糕了。尝试：

```
.bar-class label {display:block; margin-left: 30px;clear:right;}
.bar-class input {float:left;clear:left;} 
```*`****``````**