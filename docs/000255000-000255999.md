# StackOverflow 问答 000255000-000255999

# php - Forking 开源 PHP 代码，项目类加载器策略

> ID：255000
> 
> 赞同：1
> 
> 时间：2008-10-31T21:22:08.703
> 
> 标签：php, open-source, refactoring, kohana

我一直在寻找一个好的 PHP ORM 工具来使用，最近我在 Kohana 中找到了一个好的 ORM 类。它有一个相当好的和简单的 ORM 实现。问题是，如果没有重写/重构，代码在 Kohana 框架之外是不可重用的。它依赖于 Kohana 类加载器和各种框架加载策略，甚至可以在第一时间工作。此外，所需的类不会被打包到单个依赖目录中，甚至不会打包到多个目录中。

当我进行重写时，我打算通过 sourceforge 或其他方式重新发布代码，如果他们愿意，这些人当然可以重用它。因此，我是否应该将所需的文件集打包到一个目录中，并让适当的类对任何依赖类执行 require_once，以及 2 我是否应该坚持使用依赖于项目的原始类名（如 Kohana_exception），即使它几乎与整个 Kohana 项目无关？

第二种选择是编写另一个类加载器，它是 Kohana 框架类加载器的简化版本，只关心 ORM 相关的东西......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T21:29:33.337

如果您认为您所做的将对 Kohana 项目产生显着的改进，您应该进行更改并提交一个补丁以供项目维护人员考虑。您可能不是第一个欣赏他们框架的一部分的人，并且将他们的框架组件化为更小的部分可能是您可以通过提交补丁来帮助鼓励的事情（尽管这将需要您更多的时间来设计）。

听起来您正在提取他们框架的一部分以供独立使用，因此听起来您根本不像在分叉，尽管我可以想象删除所有这些依赖项可能看起来确实像一个分叉。

# usb - 在 USB 上自动启动应用程序（通过自动运行？）

> ID：255006
> 
> 赞同：17
> 
> 时间：2008-10-31T21:25:09.757
> 
> 标签：usb, autorun

是否可以从 USB 闪存驱动器自动启动应用程序（绕过窗口提示询问用户他想做什么）？在 windows XP 或 vista 上。

我查看了“autorun.inf”和“open”条目似乎只适用于 Windows XP SP2+ 和 Vista 的 CD 驱动器。是否可以在所有 Windows 版本上自动启动程序？

我不在乎用户是否在 Windows 设置中禁用了自动运行。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-31T21:52:36.363

首先，有些人出于安全原因选择禁用自动运行；但 Windows 计算机到 Vista 已启用它。编辑：**显然该功能已从 Windows 7 开始删除。**

将名为 autorun.inf 的文件放在 USB 闪存驱动器的根目录中。这是我的：

```
[Autorun]
Open=PStart.exe
Action=Start portable apps
Icon=diskicon.ico 
```

它的作用：当您插入此磁盘时，启动`PStart.exe`

在较旧的计算机上，指定的程序`Open=`将自动启动。

在大多数现代计算机（Windows XP SP2+、Vista）上，将显示“你想做什么”对话框（出于安全原因），但你所拥有的`autorun.inf`将显示为选定的默认值，带有`Icon=`图标和`Action=`描述。如果要启动它，只需单击对话框中的“确定”按钮。

因此，虽然我不知道有什么方法可以立即启动应用程序（例如[PStart](http://pegtop.net/start/)），但可以插入具有此配置的闪存盘并单击 OK 启动应用程序。

在不同的计算机上进行了测试，在没有 SP 的情况下运行 Windows XP，也在 Windows XP sp 1、sp2、sp3 和各种 Vista 上进行了测试（不确定哪些类型，但应该可以从 Vista Home Basic 一直到 Vista Enterprise Super-Mega-高级扩展版）和“Windows 7”。也适用于 Windows 2000（尽管在默认配置中未启用可移动驱动器在 Win2000 上的自动运行）。

请注意，此外，某些应用程序可能会触发“未知/未签名的可执行”安全对话框，就像您手动打开它们一样。

编辑：有关更多详细信息，另请参阅：
[Windows XP 中的自动播放：自动检测系统上的新设备并做出反应](http://msdn.microsoft.com/en-us/magazine/cc301341.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T21:34:54.107

我已经在我的 USB 密钥上设置了一段时间。使用 autorun.inf 文件将起作用，具体取决于系统的自动运行设置。在几年前与索尼在人们的机器上安装 rootkit 软件的那次小失败之后，有些人完全禁用了它。这里有几篇文章可以查看。

[用您的姓名和号码标记闪存驱动器](http://lifehacker.com/375320/label-a-flash-drive-with-your-name-and-number)

[让您丢失的 USB 驱动器寻求帮助 (1)](http://dailycupoftech.com/have-your-lost-usb-drive-ask-for-help/)或[2](https://web.archive.org/web/20130303191604/http://www.dailycupoftech.com/have-your-lost-usb-drive-ask-for-help)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-09T13:57:37.703

你需要**UseAutoplay**让它在 USB 上工作。

如果您使用**ShellExecute**而不是**open**您也可以打开脚本/文档/...

```
 [Autorun]
ShellExecute=System\something.exe
UseAutoplay=1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T14:06:23.677

周围还有 U3 USB 棒，它们将在 Windows 中被识别为 cdrom 驱动器。如果您在其中一个上放置一个 autorun.inf，它将在不询问用户的情况下执行。

问候莫拉

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-14T11:00:07.607

我在这个博客中找到了解决方案

[如何使用 USB 记忆棒自动启动应用程序 [Windows]](http://www.makeuseof.com/tag/autolaunch-apps-usb-stick-windows/)

对我来说效果很好

（文章解释了如何使用 AutoIT，必须安装在主机上的第 3 方应用程序）

# asp.net - 缩小 ASP.NET 应用程序的 Html 输出

> ID：255008
> 
> 赞同：37
> 
> 时间：2008-10-31T21:25:54.200
> 
> 标签：asp.net, performance, optimization, minify

我们可以通过哪些方法来减小 asp.net 应用程序发送的 HTML 响应的大小？

我正在使用不属于我的控件，它会产生带有空格的输出。我对缩小页面的整个 HTML 输出很感兴趣，就像 google 所做的那样（查看源代码 www.google.com）以改进时间。

是否有任何可用于 ASP.NET 的实用程序类可以为我做这些事情？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2010-01-27T13:43:28.397

无需在运行时执行此操作。因为它可以在编译时完成。

详情： http: [//omari-o.blogspot.com/2009/09/aspnet-white-space-cleaning-with-no.html](http://omari-o.blogspot.com/2009/09/aspnet-white-space-cleaning-with-no.html)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-31T21:30:04.240

尝试此处描述的 HTTP 模块：http: [//madskristensen.net/post/a-whitespace-removal-http-module-for-aspnet-20](http://madskristensen.net/post/a-whitespace-removal-http-module-for-aspnet-20)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-09-16T11:54:11.833

对于 Microsoft .NET 平台，有一个名为[WebMarkupMin](https://webmarkupmin.codeplex.com/)的库，它可以生成 HTML 代码的缩小。对于每个 ASP.NET 框架都有自己的模块：

*   ASP.NET 核心 - [WebMarkupMin.Web](http://www.nuget.org/packages/WebMarkupMin.Web/)。实现为 HTTP 模块，因此它可以与任何框架一起使用。适合在 ASP.NET 网页框架 (Razor) 中使用。
*   ASP.NET MVC - [WebMarkupMin.Mvc](http://www.nuget.org/packages/WebMarkupMin.Mvc/)
*   ASP.NET Web 窗体 - [WebMarkupMin.WebForms](http://www.nuget.org/packages/WebMarkupMin.WebForms/)

文档位于 - [http://webmarkupmin.codeplex.com/documentation](http://webmarkupmin.codeplex.com/documentation)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-07-22T07:59:58.863

我想评论 Thorn 的建议（但我是堆栈溢出的新手）。

1.  链接代码 (omari-o.blogspot.com) 不支持 MVC4，虽然代码是开源的，但由于 MVC3 和 MVC4 之间的制动变化，它不能轻易升级。

2.  在运行时可能会有空格写入 http 结果，只有实际站点的开发人员才能知道。因此，模板文件 (aspx) 的静态缩小根本不是万无一失的。gius 建议的动态缩小应该用于保证正确删除空格，不幸的是这会产生运行时计算成本。如果代码**动态**将空格写入输出，则必须**动态**删除。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-11-20T01:07:58.880

接受的答案不适用于 MVC 4，因此这里有一个类似的库，在构建时会缩小[https://github.com/jitbit/HtmlOptimizerMvc4](https://github.com/jitbit/HtmlOptimizerMvc4)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-02-24T09:54:13.513

只需添加另一个我没有在此处列出的选项，这是我推荐使用的选项：

[Html minifier 命令行工具](https://github.com/deanhume/html-minifier)

用法： [这里](http://deanhume.com/home/blogpost/a-simple-html-minifier-for-asp-net/2097)和[这里](https://github.com/deanhume/html-minifier)

但是，此工具存在一个**问题**：它会留下单行 (//) 注释，并且会导致 Razor 解析出现问题，因为单行注释放置在 C# 块中，如下所示：

```
@{
  ... 
  ...
  // anything
  ...
} 
```

将导致从这一点开始，Razor 解析器忽略该行的缩小输出其余部分，从而引发错误，指出它无法找到该块的关闭“}”。

我针对此问题的解决方法是从输出中完全**删除**这些注释。 **这样**就可以了。为此，只需从第 145 行删除 RegexOptions.SingleLine：

```
htmlContents = Regex.Replace(htmlContents, @"//(.*?)\r?\n", ""/*, RegexOptions.Singleline*/); 
```

# jsp - 无脚本 JSP

> ID：255019
> 
> 赞同：1
> 
> 时间：2008-10-31T21:31:14.673
> 
> 标签：jsp, scriptlet

有没有办法在不使用 scriptlet 的情况下在 JSP 中执行以下等效操作？

```
<% response.setContentType("text/plain");  %> 
```

我不能简单地使用

因为我需要在 2 个地方设置内容类型（每个在 a 的不同分支中），而 JSP 编译器将只允许一个这样的指令。

此外，我不能编写两个单独的 JSP 并转发到 servlet 中的一个或另一个，因为当发生身份验证失败时，容器会触发 JSP。

干杯，唐

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T21:33:21.097

```
<%@ page language="java" contentType="text/plain" %> 
```

编辑：

如果您需要有条件地设置 MIME 类型，您可以使用

```
<% 
if( branch condition ) { 
  response.setContentType("text/plain");
} else {
  response.setContentType("text/html"); 
}
%> 
```

显然，上面是一个与原始问题背道而驰的脚本。是否有不想使用 scriptlet 的特殊原因？

更好的方法可能是在 servlet 中执行分支逻辑并将请求转发到仅处理显示的 JSP。如果内容本身不同，您可以选择使用两个单独的 JSP，每个内容类型一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T22:13:41.360

最简单的方法是创建一个可以执行此操作的标记文件标记，然后使用它。

在 WEB-INF/tags 目录中创建文件“setMimeType.tag”。

```
<%@tag description="put the tag description here" pageEncoding="UTF-8"%>
<%@ attribute name="mimeType" required="true"%>
<%
    response.setContentType(jspContext.findAttribute("mimeType"));
%> 
```

然后，在您的 JSP 中将其添加到标题中：

```
<%@ taglib prefix="t" tagdir="/WEB-INF/tags" %> 
```

然后在您的 JSP 中，您可以执行以下操作：

```
<t:setMimeType mimeType="text/plain"/> 
```

是的，标记文件不是免费的脚本，但实际的 JSP 页面是。你可以说我是在扯皮，但我不同意，因为我认为标签文件是放置脚本之类的完美媒介，因为它们在封装和抽象方面提供了很好的一点。此外，唯一的其他解决方案是用 Java 编写自己的 JSP 标记处理程序，这对于像这样简单的事情来说太疯狂了。

需要 JSP 2.0，但我发现 JSP 标记文件是 JSP 开发的一大福音。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T22:12:19.507

text/plain-response 和 text/html-response 听起来像是两个非常不同的响应，几乎没有共同点。

创建 2 个 JPS，并改为在 servlet 中分支。

如果它们确实有共同的元素，您仍然可以使用包含。

# python - 将日期时间转换为 POSIX 时间

> ID：255035
> 
> 赞同：55
> 
> 时间：2008-10-31T21:38:02.163
> 
> 标签：python, datetime, posix

如何在 python 中将日期时间或日期对象转换为 POSIX 时间戳？有一些方法可以根据时间戳创建日期时间对象，但我似乎没有找到任何明显的方法来以相反的方式进行操作。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-10-31T21:44:35.070

```
import time, datetime

d = datetime.datetime.now()
print time.mktime(d.timetuple()) 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-05-03T15:39:15.637

对于 UTC 计算，`calendar.timegm`是 的倒数`time.gmtime`。

```
import calendar, datetime
d = datetime.datetime.utcnow()
print calendar.timegm(d.timetuple()) 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2017-10-30T02:16:14.387

请注意，Python 现在（3.5.2）在对象中包含了一个用于此的[内置方法](https://docs.python.org/3/library/datetime.html#datetime.datetime.timestamp)`datetime`：

```
>>> import datetime
>>> now = datetime.datetime(2020, 11, 18, 18, 52, 47, 874766)
>>> now.timestamp() # Local time
1605743567.874766
>>> now.replace(tzinfo=datetime.timezone.utc).timestamp() # UTC
1605725567.874766 # 5 hours delta (I'm in UTC-5) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-16T22:52:43.277

在 python 中，time.time() 可以将秒作为浮点数返回，其中包括带有微秒的小数部分。为了将日期时间转换回此表示，您必须添加微秒组件，因为直接时间元组不包含它。

```
import time, datetime

posix_now = time.time()

d = datetime.datetime.fromtimestamp(posix_now)
no_microseconds_time = time.mktime(d.timetuple())
has_microseconds_time = time.mktime(d.timetuple()) + d.microsecond * 0.000001

print posix_now
print no_microseconds_time
print has_microseconds_time 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-23T04:33:25.427

从 posix/epoch 到 datetime 时间戳的最佳转换，反之亦然：

```
this_time = datetime.datetime.utcnow() # datetime.datetime type
epoch_time = this_time.timestamp()      # posix time or epoch time
this_time = datetime.datetime.fromtimestamp(epoch_time) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-18T02:19:09.100

# 这取决于

您的 datetime 对象时区是感知的还是幼稚的？

# 时区感知

如果它知道这很简单

```
from datetime import datetime, timezone
aware_date = datetime.now(tz=timezone.utc)
posix_timestamp = aware_date.timestamp() 
```

因为[date.timestamp()](https://docs.python.org/3/library/datetime.html#datetime.datetime.timestamp)给你“POSIX时间戳”

***注意**：将其称为纪元/unix 时间戳更准确，因为[它可能不符合 POSIX](https://en.wikipedia.org/wiki/Unix_time#Non-synchronous_Network_Time_Protocol-based_variant)*

# 时区幼稚

如果它不是时区感知（天真），那么您需要知道它最初位于哪个时区，以便我们可以使用[replace()](https://docs.python.org/3/library/datetime.html#datetime.datetime.replace)将其转换为时区感知日期对象。假设您已将其存储/检索为 UTC Naive。这里我们创建一个，例如：

```
from datetime import datetime, timezone
naive_date = datetime.utcnow()  # this date is naive, but is UTC based
aware_date = naive_date.replace(tzinfo=timezone.utc)  # this date is no longer naive

# now we do as we did with the last one

posix_timestamp = aware_date.timestamp() 
```

最好尽快到达时区感知日期，以防止天真的日期可能出现的问题（因为 Python 通常会认为它们是当地时间并且可能会搞砸你）

***注意**：还要小心您对时代的理解，因为它取决于平台*

# javascript - 在javascript中，我可以覆盖括号以访问字符串中的字符吗？

> ID：255041
> 
> 赞同：14
> 
> 时间：2008-10-31T21:39:51.037
> 
> 标签：javascript, syntax, operators

有什么方法可以定义`String[int]`避免使用`String.CharAt(int)`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-31T21:41:25.513

不，没有办法做到这一点。

这是从另一种语言转向 JavaScript 的开发人员的常见问题，其中**可以**为某种类型定义或覆盖运算符。

`operator*`在 C++ 中，重载on并不是完全不可能的`MyType`，最终会为涉及类型对象的操作提供一个唯一的星号运算符`MyType`。这种做法的可读性可能仍会受到质疑，但语言仍然可以做到这一点。

在 JavaScript 中，这根本是不可能的。您将无法定义允许您从`String`使用括号中索引字符的方法。

*@Lee Kowalkowski*提出了一个很好的观点，即在某种程度上，*可以*使用方括号访问字符，因为方括号可用于访问 JavaScript 的成员`Array`。这将涉及创建一个新的`Array`，使用字符串的每个字符作为其成员，然后访问`Array`.

这可能是一种令人困惑的方法。JavaScript 的一些实现将通过方括号提供对字符串的访问，而另一些则不会，因此这不是标准做法。该对象可能会与字符串混淆，并且由于 JavaScript 是一种松散类型的语言，因此已经存在错误表示类型的风险。仅仅为了使用与该语言已经提供的语法不同的语法而定义一个数组只会助长这种类型的混乱。这引起了*@Andrew Hedges*的问题：“为什么要对抗语言？”..

**JavaScript**中有一些有用的模式可用于**合法的函数重载**和**多态继承**。这不是任何一个例子。

除了所有的语义，操作符还没有被覆盖。

**旁注：**习惯于强类型检查和经典继承约定的开发人员有时会对 JavaScript 的 C 系列语法感到困惑。在引擎盖下，它以一种不熟悉的方式工作。最好以简洁明了的方式编写 JavaScript，以防止混淆。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-31T21:43:58.127

**请注意：**在*其他人*想否决我的答案之前，我回答的问题是：

> **IE javascript 字符串索引器**
> 
> 有什么方法可以定义 string[int] 以避免使用 string.CharAt(int)？”

没有关于具体覆盖括号、语法或最佳实践的问题，这个问题只是要求“某种方式”。（唯一的另一个答案是“不，没有。”）

* * *

嗯，实际上有一种：

```
var newArray = oldString.split(''); 
```

...现在您可以使用括号表示法访问 newArray，因为您刚刚将其转换为数组。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T21:51:35.133

**使用[String.charAt()](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/String/charAt)**

它是**标准**的，**适用于所有浏览器**。

在非 IE 浏览器中，您可以使用括号表示法来访问如下字符：

```
"TEST"[1]; // = E 
```

您可以执行以下操作将字符串转换为字符数组：

```
var myString = "TEST";
var charArray = myString.split(''); // charArray[1] == E 
```

这些将被劝阻。没有任何理由不使用 charAt() 方法，而且做其他任何事情都没有任何好处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-01T17:23:50.570

这不是答案，只是一个技巧（强烈反对！）。它特别表明，在 Javascript 中你可以做任何你想做的事情。这只是你的幻想问题。

您可以使用一个事实，即您可以像所有其他人一样为 String Object 设置任何其他属性，因此您可以创建 String.0、String.1、... 属性：

```
String.prototype.toChars = function()  {
    for (var i=0; i<this.length; i++) {
        this[i+""] = this.charAt(i);
    }
}; 
```

现在您可以使用以下方法访问单个字符：

```
var str = "Hello World";
str.toChars();
var i = 1+"";
var c = str[i]; // "e" 
```

请注意，它仅对访问有用。它应该是为以这种方式分配字符串字符而定义的另一种方法。

另请注意，每次修改字符串时都必须调用 .toChars() 方法。

# c# - 在没有 InstallUtil.exe 的情况下安装 .NET windows 服务

> ID：255056
> 
> 赞同：167
> 
> 时间：2008-10-31T21:46:32.147
> 
> 标签：c#, .net, deployment, windows-services, installutil

我有一个用 C# 编写的标准 .NET windows 服务。

它可以在不使用 InstallUtil 的情况下自行安装吗？我应该使用服务安装程序类吗？我应该如何使用它？

我希望能够调用以下内容：

```
MyService.exe -install 
```

它将与调用具有相同的效果：

```
InstallUtil MyService.exe 
```

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2008-10-31T21:49:56.820

是的，这是完全可能的（即我就是这样做的）；您只需要引用正确的 dll (System.ServiceProcess.dll) 并添加一个安装程序类...

[这是一个例子：](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/4d45e9ea5471cba4/4519371a77ed4a74)

```
[RunInstaller(true)]
public sealed class MyServiceInstallerProcess : ServiceProcessInstaller
{
    public MyServiceInstallerProcess()
    {
        this.Account = ServiceAccount.NetworkService;
    }
}

[RunInstaller(true)]
public sealed class MyServiceInstaller : ServiceInstaller
{
    public MyServiceInstaller()
    {
        this.Description = "Service Description";
        this.DisplayName = "Service Name";
        this.ServiceName = "ServiceName";
        this.StartType = System.ServiceProcess.ServiceStartMode.Automatic;
    }
}

static void Install(bool undo, string[] args)
{
    try
    {
        Console.WriteLine(undo ? "uninstalling" : "installing");
        using (AssemblyInstaller inst = new AssemblyInstaller(typeof(Program).Assembly, args))
        {
            IDictionary state = new Hashtable();
            inst.UseNewContext = true;
            try
            {
                if (undo)
                {
                    inst.Uninstall(state);
                }
                else
                {
                    inst.Install(state);
                    inst.Commit(state);
                }
            }
            catch
            {
                try
                {
                    inst.Rollback(state);
                }
                catch { }
                throw;
            }
        }
    }
    catch (Exception ex)
    {
        Console.Error.WriteLine(ex.Message);
    }
} 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-06-18T22:19:14.423

看一下[ManagedInstaller](http://msdn.microsoft.com/en-us/library/system.configuration.install.managedinstallerclass.aspx)类的[InstallHelper](http://msdn.microsoft.com/en-us/library/system.configuration.install.managedinstallerclass.installhelper.aspx)方法。您可以使用以下方式安装服务：

```
string[] args;
ManagedInstallerClass.InstallHelper(args); 
```

这正是 InstallUtil 所做的。参数与 InstallUtil 相同。

这种方法的好处是它不涉及注册表的混乱，并且它使用与 InstallUtil 相同的机制。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-11-28T13:39:02.750

您总是可以回退到良好的旧 WinAPI 调用，尽管所涉及的工作量并非微不足道。不要求通过 .NET 感知机制安装 .NET 服务。

安装：

*   通过打开服务管理器`OpenSCManager`。
*   调用`CreateService`注册服务。
*   可选择调用`ChangeServiceConfig2`以设置描述。
*   使用 关闭服务和服务管理器句柄`CloseServiceHandle`。

要卸载：

*   通过打开服务管理器`OpenSCManager`。
*   使用打开服务`OpenService`。
*   `DeleteService`通过调用返回的句柄删除服务`OpenService`。
*   使用 关闭服务和服务管理器句柄`CloseServiceHandle`。

`ServiceInstaller`我更喜欢使用/的主要原因`ServiceProcessInstaller`是您可以使用自己的自定义命令行参数注册服务。例如，您可以将其注册为`"MyApp.exe -service"`，然后如果用户在没有任何参数的情况下运行您的应用程序，您可以为他们提供一个 UI 来安装/删除服务。

运行 Reflector on`ServiceInstaller`可以填补这个简短解释中缺少的细节。

PS 显然，这不会有“与调用相同的效果：InstallUtil MyService.exe” - 特别是，您将无法使用 InstallUtil 进行卸载。但似乎这对你来说并不是一个真正的严格要求。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-31T22:08:05.350

这是我在编写服务时使用的一个类。我通常会在未调用服务时出现一个交互式屏幕。从那里我根据需要使用该课程。它允许在同一台机器上使用多个命名实例 - 因此 InstanceID 字段

样品电话

```
 IntegratedServiceInstaller Inst = new IntegratedServiceInstaller();
  Inst.Install("MySvc", "My Sample Service", "Service that executes something",
                    _InstanceID,
// System.ServiceProcess.ServiceAccount.LocalService,      // this is more secure, but only available in XP and above and WS-2003 and above
  System.ServiceProcess.ServiceAccount.LocalSystem,       // this is required for WS-2000
  System.ServiceProcess.ServiceStartMode.Automatic);
  if (controller == null)
  {
    controller = new System.ServiceProcess.ServiceController(String.Format("MySvc_{0}", _InstanceID), ".");
                }
                if (controller.Status == System.ServiceProcess.ServiceControllerStatus.Running)
                {
                    Start_Stop.Text = "Stop Service";
                    Start_Stop_Debugging.Enabled = false;
                }
                else
                {
                    Start_Stop.Text = "Start Service";
                    Start_Stop_Debugging.Enabled = true;
                } 
```

班级本身

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Diagnostics;
using Microsoft.Win32;

namespace MySvc
{
    class IntegratedServiceInstaller
    {
        public void Install(String ServiceName, String DisplayName, String Description,
            String InstanceID,
            System.ServiceProcess.ServiceAccount Account, 
            System.ServiceProcess.ServiceStartMode StartMode)
        {
            //http://www.theblacksparrow.com/
            System.ServiceProcess.ServiceProcessInstaller ProcessInstaller = new System.ServiceProcess.ServiceProcessInstaller();
            ProcessInstaller.Account = Account;

            System.ServiceProcess.ServiceInstaller SINST = new System.ServiceProcess.ServiceInstaller();

            System.Configuration.Install.InstallContext Context = new System.Configuration.Install.InstallContext();
            string processPath = Process.GetCurrentProcess().MainModule.FileName;
            if (processPath != null && processPath.Length > 0)
            {
                System.IO.FileInfo fi = new System.IO.FileInfo(processPath);

                String path = String.Format("/assemblypath={0}", fi.FullName);
                String[] cmdline = { path };
                Context = new System.Configuration.Install.InstallContext("", cmdline);
            }

            SINST.Context = Context;
            SINST.DisplayName = String.Format("{0} - {1}", DisplayName, InstanceID);
            SINST.Description = String.Format("{0} - {1}", Description, InstanceID);
            SINST.ServiceName = String.Format("{0}_{1}", ServiceName, InstanceID);
            SINST.StartType = StartMode;
            SINST.Parent = ProcessInstaller;

            // http://bytes.com/forum/thread527221.html
            SINST.ServicesDependedOn = new String[] { "Spooler", "Netlogon", "Netman" };

            System.Collections.Specialized.ListDictionary state = new System.Collections.Specialized.ListDictionary();
            SINST.Install(state);

            // http://www.dotnet247.com/247reference/msgs/43/219565.aspx
            using (RegistryKey oKey = Registry.LocalMachine.OpenSubKey(String.Format(@"SYSTEM\CurrentControlSet\Services\{0}_{1}", ServiceName, InstanceID), true))
            {
                try
                {
                    Object sValue = oKey.GetValue("ImagePath");
                    oKey.SetValue("ImagePath", sValue);
                }
                catch (Exception Ex)
                {
                    System.Windows.Forms.MessageBox.Show(Ex.Message);
                }
            }

        }
        public void Uninstall(String ServiceName, String InstanceID)
        {
            //http://www.theblacksparrow.com/
            System.ServiceProcess.ServiceInstaller SINST = new System.ServiceProcess.ServiceInstaller();

            System.Configuration.Install.InstallContext Context = new System.Configuration.Install.InstallContext("c:\\install.log", null);
            SINST.Context = Context;
            SINST.ServiceName = String.Format("{0}_{1}", ServiceName, InstanceID);
            SINST.Uninstall(null);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-06-04T17:17:56.797

上面的例子对我来说真的不起作用，作为#1 解决方案的论坛链接很难挖掘。这是我写的一个类（部分），另一部分是从[我发现埋在某处的这个链接中合并的](https://dl.dropboxusercontent.com/u/152585/ServiceInstaller.cs)

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

using System.ServiceProcess;
using System.Runtime.InteropServices;

namespace SystemControl {
    class Services {

#region "Environment Variables"
        public static string GetEnvironment(string name, bool ExpandVariables=true) {
            if ( ExpandVariables ) {
                return System.Environment.GetEnvironmentVariable( name );
            } else {
                return (string)Microsoft.Win32.Registry.LocalMachine.OpenSubKey( @"SYSTEM\CurrentControlSet\Control\Session Manager\Environment\" ).GetValue( name, "", Microsoft.Win32.RegistryValueOptions.DoNotExpandEnvironmentNames );
            }
        }

        public static void SetEnvironment( string name, string value ) {
            System.Environment.SetEnvironmentVariable(name, value);
        }
#endregion

#region "ServiceCalls Native"
        public static ServiceController[] List { get { return ServiceController.GetServices(); } }

        public static void Start( string serviceName, int timeoutMilliseconds ) {
            ServiceController service=new ServiceController( serviceName );
            try {
                TimeSpan timeout=TimeSpan.FromMilliseconds( timeoutMilliseconds );

                service.Start();
                service.WaitForStatus( ServiceControllerStatus.Running, timeout );
            } catch {
                // ...
            }
        }

        public static void Stop( string serviceName, int timeoutMilliseconds ) {
            ServiceController service=new ServiceController( serviceName );
            try {
                TimeSpan timeout=TimeSpan.FromMilliseconds( timeoutMilliseconds );

                service.Stop();
                service.WaitForStatus( ServiceControllerStatus.Stopped, timeout );
            } catch {
                // ...
            }
        }

        public static void Restart( string serviceName, int timeoutMilliseconds ) {
            ServiceController service=new ServiceController( serviceName );
            try {
                int millisec1=Environment.TickCount;
                TimeSpan timeout=TimeSpan.FromMilliseconds( timeoutMilliseconds );

                service.Stop();
                service.WaitForStatus( ServiceControllerStatus.Stopped, timeout );

                // count the rest of the timeout
                int millisec2=Environment.TickCount;
                timeout=TimeSpan.FromMilliseconds( timeoutMilliseconds-( millisec2-millisec1 ) );

                service.Start();
                service.WaitForStatus( ServiceControllerStatus.Running, timeout );
            } catch {
                // ...
            }
        }

        public static bool IsInstalled( string serviceName ) {
            // get list of Windows services
            ServiceController[] services=ServiceController.GetServices();

            // try to find service name
            foreach ( ServiceController service in services ) {
                if ( service.ServiceName==serviceName )
                    return true;
            }
            return false;
        }
#endregion

#region "ServiceCalls API"
        private const int STANDARD_RIGHTS_REQUIRED = 0xF0000;
        private const int SERVICE_WIN32_OWN_PROCESS = 0x00000010;

        [Flags]
        public enum ServiceManagerRights {
            Connect = 0x0001,
            CreateService = 0x0002,
            EnumerateService = 0x0004,
            Lock = 0x0008,
            QueryLockStatus = 0x0010,
            ModifyBootConfig = 0x0020,
            StandardRightsRequired = 0xF0000,
            AllAccess = (StandardRightsRequired | Connect | CreateService |
            EnumerateService | Lock | QueryLockStatus | ModifyBootConfig)
        }

        [Flags]
        public enum ServiceRights {
            QueryConfig = 0x1,
            ChangeConfig = 0x2,
            QueryStatus = 0x4,
            EnumerateDependants = 0x8,
            Start = 0x10,
            Stop = 0x20,
            PauseContinue = 0x40,
            Interrogate = 0x80,
            UserDefinedControl = 0x100,
            Delete = 0x00010000,
            StandardRightsRequired = 0xF0000,
            AllAccess = (StandardRightsRequired | QueryConfig | ChangeConfig |
            QueryStatus | EnumerateDependants | Start | Stop | PauseContinue |
            Interrogate | UserDefinedControl)
        }

        public enum ServiceBootFlag {
            Start = 0x00000000,
            SystemStart = 0x00000001,
            AutoStart = 0x00000002,
            DemandStart = 0x00000003,
            Disabled = 0x00000004
        }

        public enum ServiceState {
            Unknown = -1, // The state cannot be (has not been) retrieved.
            NotFound = 0, // The service is not known on the host server.
            Stop = 1, // The service is NET stopped.
            Run = 2, // The service is NET started.
            Stopping = 3,
            Starting = 4,
        }

        public enum ServiceControl {
            Stop = 0x00000001,
            Pause = 0x00000002,
            Continue = 0x00000003,
            Interrogate = 0x00000004,
            Shutdown = 0x00000005,
            ParamChange = 0x00000006,
            NetBindAdd = 0x00000007,
            NetBindRemove = 0x00000008,
            NetBindEnable = 0x00000009,
            NetBindDisable = 0x0000000A
        }

        public enum ServiceError {
            Ignore = 0x00000000,
            Normal = 0x00000001,
            Severe = 0x00000002,
            Critical = 0x00000003
        }

        [StructLayout(LayoutKind.Sequential)]
        private class SERVICE_STATUS {
            public int dwServiceType = 0;
            public ServiceState dwCurrentState = 0;
            public int dwControlsAccepted = 0;
            public int dwWin32ExitCode = 0;
            public int dwServiceSpecificExitCode = 0;
            public int dwCheckPoint = 0;
            public int dwWaitHint = 0;
        }

        [DllImport("advapi32.dll", EntryPoint = "OpenSCManagerA")]
        private static extern IntPtr OpenSCManager(string lpMachineName, string lpDatabaseName, ServiceManagerRights dwDesiredAccess);
        [DllImport("advapi32.dll", EntryPoint = "OpenServiceA", CharSet = CharSet.Ansi)]
        private static extern IntPtr OpenService(IntPtr hSCManager, string lpServiceName, ServiceRights dwDesiredAccess);
        [DllImport("advapi32.dll", EntryPoint = "CreateServiceA")]
        private static extern IntPtr CreateService(IntPtr hSCManager, string lpServiceName, string lpDisplayName, ServiceRights dwDesiredAccess, int dwServiceType, ServiceBootFlag dwStartType, ServiceError dwErrorControl, string lpBinaryPathName, string lpLoadOrderGroup, IntPtr lpdwTagId, string lpDependencies, string lp, string lpPassword);
        [DllImport("advapi32.dll")]
        private static extern int CloseServiceHandle(IntPtr hSCObject);
        [DllImport("advapi32.dll")]
        private static extern int QueryServiceStatus(IntPtr hService, SERVICE_STATUS lpServiceStatus);
        [DllImport("advapi32.dll", SetLastError = true)]
        private static extern int DeleteService(IntPtr hService);
        [DllImport("advapi32.dll")]
        private static extern int ControlService(IntPtr hService, ServiceControl dwControl, SERVICE_STATUS lpServiceStatus);
        [DllImport("advapi32.dll", EntryPoint = "StartServiceA")]
        private static extern int StartService(IntPtr hService, int dwNumServiceArgs, int lpServiceArgVectors);

        /// <summary>
        /// Takes a service name and tries to stop and then uninstall the windows serviceError
        /// </summary>
        /// <param name="ServiceName">The windows service name to uninstall</param>
        public static void Uninstall(string ServiceName)
        {
            IntPtr scman = OpenSCManager(ServiceManagerRights.Connect);
            try
            {
                IntPtr service = OpenService(scman, ServiceName, ServiceRights.StandardRightsRequired | ServiceRights.Stop | ServiceRights.QueryStatus);
                if (service == IntPtr.Zero)
                {
                    throw new ApplicationException("Service not installed.");
                }
                try
                {
                    StopService(service);
                    int ret = DeleteService(service);
                    if (ret == 0)
                    {
                        int error = Marshal.GetLastWin32Error();
                        throw new ApplicationException("Could not delete service " + error);
                    }
                }
                finally
                {
                    CloseServiceHandle(service);
                }
            }
            finally
            {
                CloseServiceHandle(scman);
            }
        }

        /// <summary>
        /// Accepts a service name and returns true if the service with that service name exists
        /// </summary>
        /// <param name="ServiceName">The service name that we will check for existence</param>
        /// <returns>True if that service exists false otherwise</returns>
        public static bool ServiceIsInstalled(string ServiceName)
        {
            IntPtr scman = OpenSCManager(ServiceManagerRights.Connect);
            try
            {
                IntPtr service = OpenService(scman, ServiceName,
                ServiceRights.QueryStatus);
                if (service == IntPtr.Zero) return false;
                CloseServiceHandle(service);
                return true;
            }
            finally
            {
                CloseServiceHandle(scman);
            }
        }

        /// <summary>
        /// Takes a service name, a service display name and the path to the service executable and installs / starts the windows service.
        /// </summary>
        /// <param name="ServiceName">The service name that this service will have</param>
        /// <param name="DisplayName">The display name that this service will have</param>
        /// <param name="FileName">The path to the executable of the service</param>
        public static void InstallAndStart(string ServiceName, string DisplayName,
        string FileName)
        {
            IntPtr scman = OpenSCManager(ServiceManagerRights.Connect |
            ServiceManagerRights.CreateService);
            try
            {
                IntPtr service = OpenService(scman, ServiceName,
                ServiceRights.QueryStatus | ServiceRights.Start);
                if (service == IntPtr.Zero)
                {
                    service = CreateService(scman, ServiceName, DisplayName,
                    ServiceRights.QueryStatus | ServiceRights.Start, SERVICE_WIN32_OWN_PROCESS,
                    ServiceBootFlag.AutoStart, ServiceError.Normal, FileName, null, IntPtr.Zero,
                    null, null, null);
                }
                if (service == IntPtr.Zero)
                {
                    throw new ApplicationException("Failed to install service.");
                }
                try
                {
                    StartService(service);
                }
                finally
                {
                    CloseServiceHandle(service);
                }
            }
            finally
            {
                CloseServiceHandle(scman);
            }
        }

        /// <summary>
        /// Takes a service name and starts it
        /// </summary>
        /// <param name="Name">The service name</param>
        public static void StartService(string Name)
        {
            IntPtr scman = OpenSCManager(ServiceManagerRights.Connect);
            try
            {
                IntPtr hService = OpenService(scman, Name, ServiceRights.QueryStatus |
                ServiceRights.Start);
                if (hService == IntPtr.Zero)
                {
                    throw new ApplicationException("Could not open service.");
                }
                try
                {
                    StartService(hService);
                }
                finally
                {
                    CloseServiceHandle(hService);
                }
            }
            finally
            {
                CloseServiceHandle(scman);
            }
        }

        /// <summary>
        /// Stops the provided windows service
        /// </summary>
        /// <param name="Name">The service name that will be stopped</param>
        public static void StopService(string Name)
        {
            IntPtr scman = OpenSCManager(ServiceManagerRights.Connect);
            try
            {
                IntPtr hService = OpenService(scman, Name, ServiceRights.QueryStatus |
                ServiceRights.Stop);
                if (hService == IntPtr.Zero)
                {
                    throw new ApplicationException("Could not open service.");
                }
                try
                {
                    StopService(hService);
                }
                finally
                {
                    CloseServiceHandle(hService);
                }
            }
            finally
            {
                CloseServiceHandle(scman);
            }
        }

        /// <summary>
        /// Stars the provided windows service
        /// </summary>
        /// <param name="hService">The handle to the windows service</param>
        private static void StartService(IntPtr hService)
        {
            SERVICE_STATUS status = new SERVICE_STATUS();
            StartService(hService, 0, 0);
            WaitForServiceStatus(hService, ServiceState.Starting, ServiceState.Run);
        }

        /// <summary>
        /// Stops the provided windows service
        /// </summary>
        /// <param name="hService">The handle to the windows service</param>
        private static void StopService(IntPtr hService)
        {
            SERVICE_STATUS status = new SERVICE_STATUS();
            ControlService(hService, ServiceControl.Stop, status);
            WaitForServiceStatus(hService, ServiceState.Stopping, ServiceState.Stop);
        }

        /// <summary>
        /// Takes a service name and returns the <code>ServiceState</code> of the corresponding service
        /// </summary>
        /// <param name="ServiceName">The service name that we will check for his <code>ServiceState</code></param>
        /// <returns>The ServiceState of the service we wanted to check</returns>
        public static ServiceState GetServiceStatus(string ServiceName)
        {
            IntPtr scman = OpenSCManager(ServiceManagerRights.Connect);
            try
            {
                IntPtr hService = OpenService(scman, ServiceName,
                ServiceRights.QueryStatus);
                if (hService == IntPtr.Zero)
                {
                    return ServiceState.NotFound;
                }
                try
                {
                    return GetServiceStatus(hService);
                }
                finally
                {
                    CloseServiceHandle(scman);
                }
            }
            finally
            {
                CloseServiceHandle(scman);
            }
        }

        /// <summary>
        /// Gets the service state by using the handle of the provided windows service
        /// </summary>
        /// <param name="hService">The handle to the service</param>
        /// <returns>The <code>ServiceState</code> of the service</returns>
        private static ServiceState GetServiceStatus(IntPtr hService)
        {
            SERVICE_STATUS ssStatus = new SERVICE_STATUS();
            if (QueryServiceStatus(hService, ssStatus) == 0)
            {
                throw new ApplicationException("Failed to query service status.");
            }
            return ssStatus.dwCurrentState;
        }

        /// <summary>
        /// Returns true when the service status has been changes from wait status to desired status
        /// ,this method waits around 10 seconds for this operation.
        /// </summary>
        /// <param name="hService">The handle to the service</param>
        /// <param name="WaitStatus">The current state of the service</param>
        /// <param name="DesiredStatus">The desired state of the service</param>
        /// <returns>bool if the service has successfully changed states within the allowed timeline</returns>
        private static bool WaitForServiceStatus(IntPtr hService, ServiceState
        WaitStatus, ServiceState DesiredStatus)
        {
            SERVICE_STATUS ssStatus = new SERVICE_STATUS();
            int dwOldCheckPoint;
            int dwStartTickCount;

            QueryServiceStatus(hService, ssStatus);
            if (ssStatus.dwCurrentState == DesiredStatus) return true;
            dwStartTickCount = Environment.TickCount;
            dwOldCheckPoint = ssStatus.dwCheckPoint;

            while (ssStatus.dwCurrentState == WaitStatus)
            {
                // Do not wait longer than the wait hint. A good interval is
                // one tenth the wait hint, but no less than 1 second and no
                // more than 10 seconds.

                int dwWaitTime = ssStatus.dwWaitHint / 10;

                if (dwWaitTime < 1000) dwWaitTime = 1000;
                else if (dwWaitTime > 10000) dwWaitTime = 10000;

                System.Threading.Thread.Sleep(dwWaitTime);

                // Check the status again.

                if (QueryServiceStatus(hService, ssStatus) == 0) break;

                if (ssStatus.dwCheckPoint > dwOldCheckPoint)
                {
                    // The service is making progress.
                    dwStartTickCount = Environment.TickCount;
                    dwOldCheckPoint = ssStatus.dwCheckPoint;
                }
                else
                {
                    if (Environment.TickCount - dwStartTickCount > ssStatus.dwWaitHint)
                    {
                        // No progress made within the wait hint
                        break;
                    }
                }
            }
            return (ssStatus.dwCurrentState == DesiredStatus);
        }

        /// <summary>
        /// Opens the service manager
        /// </summary>
        /// <param name="Rights">The service manager rights</param>
        /// <returns>the handle to the service manager</returns>
        private static IntPtr OpenSCManager(ServiceManagerRights Rights)
        {
            IntPtr scman = OpenSCManager(null, null, Rights);
            if (scman == IntPtr.Zero)
            {
                throw new ApplicationException("Could not connect to service control manager.");
            }
            return scman;
        }

#endregion

    }
} 
```

要安装服务，请运行 InstallAndStart 命令，如下所示：

```
 SystemControl.InstallAndStart(
                                 "apache",
                                 "Apache Web Server",
                                 @"""c:\apache\bin\httpd.exe"" -k runservice"
  ); 
```

Make sure the account that is running the program has permission to install services. You can always 'Run As Administrator' on the program.

I have also included several commands for non-api access which do not install or remove services, but you can list them and control several (start, stop, restart). You really only need to elevate permissions for installing or removing services.

There are a couple of commands for getting and setting environment variables as well, such as `OPENSSL_CONF` or `TEMP`. For the most part, the parameters and method names should be pretty self-explanatory.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-10-13T16:35:12.447

如果尝试将命令行应用程序安装为 Windows 服务，请尝试使用“ [NSSM](http://nssm.cc/) ”实用程序。[在此处](https://serverfault.com/questions/58025/install-service-in-windows-server-2008/321208#321208)找到相关的 ServerFault 详细信息。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2017-07-21T19:59:45.610

```
Process QProc = new Process();
QProc.StartInfo.FileName = "cmd";
QProc.StartInfo.Arguments ="/c InstallUtil "+ "\""+ filefullPath +"\"";
QProc.StartInfo.WorkingDirectory = Environment.GetEnvironmentVariable("windir") + @"\Microsoft.NET\Framework\v2.0.50727\";
QProc.StartInfo.UseShellExecute = false;
// QProc.StartInfo.CreateNoWindow = true;
QProc.StartInfo.RedirectStandardOutput = true;
QProc.Start();
// QProc.WaitForExit();
QProc.Close(); 
```

# .net - 多参数化线程效率

> ID：255063
> 
> 赞同：2
> 
> 时间：2008-10-31T21:49:58.660
> 
> 标签：.net, multithreading, parameters

是否有更优雅的方式来编写以下语法？

```
 Thread t0 = new Thread(new ParameterizedThreadStart(doWork));
        t0.Start('someVal');
        t0.Join();

        Thread t1 = new Thread(new ParameterizedThreadStart(doWork));
        t1.Start('someDiffVal');
        t1.Join(); 
```

假设我们要传递 20 个不同的值，那么最好的设置方法是什么？循环并在最后加入？

如果未实例化新线程（如下所示），则会错误地指出该线程无法重新启动。例如：

```
 Thread t1 = new Thread(new ParameterizedThreadStart(doWork));
        t1.Start('someVal');
        t1.Start('someDiffVal'); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-31T21:54:55.703

你为什么要开始一个线程然后立即加入反对它？

我通常会做这样的事情：

```
List<Thread> threads = new List<Thread>();

foreach (string item in items)
{
    string copy = item; // Important due to variable capture
    ThreadStart ts = () => DoWork(copy); // Strongly typed :)
    Thread t = new Thread(ts);
    t.Start();
    threads.Add(t);
}

foreach (Thread t in threads)
{
    t.Join();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T22:00:58.733

另一个选项（在 .NET 4.0 中或使用 CTP）是`Parallel.ForEach`. 不过，还不一定可行。我还看到了一个很好的博客条目（不记得是谁）`IDisposable`在这里使用的——即

```
using(StartThread(arg1))
using(StartThread(arg2))
{
} 
```

Dispose() 方法在产生的线程上进行了连接 - 即，当您退出块时，一切都完成了。很可爱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T22:15:13.557

为什么不让你的参数成为类的一部分，使它们成为属性，并让 get/set 方法锁定它们呢？如果你有足够的参数，让参数对象本身成为对象的属性，然后锁定那个参数块。如：

```
class GonnaDoSomeThreading {
   private Object mBlockLock = new Object();
   private MyParameterBlock mBlock;
   public MyParameterBlock Block {
       get { 
            MyParameterBlock tmp;
            lock (mBlockLock){
                tmp = new MyParameterBlock(mBlock); //or some other cloning
            }
            return tmp; //use a tmp in order to make sure that modifications done
                        //do not modify the block directly, but that modifications must
                        //be 'committed' through the set function
       }
       set { lock (mBlockLock){ mBlock = value; } } 
   }
} 
```

然后按照已经建议的那样做你的线程池。这样一来，你就有了数据访问的锁，所以如果你的所有线程都需要它，它们可以互相等待。

如果您这样做是为了图像处理（可以同时完成许多并行对象），那么最好将数据分解成个性化的块。IE，假设你想在一个较大的图像上运行一些卷积，所以想把它分成两半。然后，您可以使用“Fragmentimage”函数创建您要单独处理的图像块，然后调用“MergeFragments”函数来连接所有结果。所以你的片段可能看起来像：

```
class ThreadWorkFragment {
    <image type, like ushort>[] mDataArray;
    bool mDone;
} 
```

在该片段周围加一个锁（即，对象和片段的列表，每个对象和片段都有一个锁等等），这样当线程访问它的片段时，它最终可以声明它已经“完成”，释放锁，然后然后你可以有一个最终的合并函数，它只是等待那些完成的布尔值被标记。这样，如果其中一个线程在设置完成之前就死了，并且您知道该线程已经死了，那么您也知道该线程没有完成它的工作，您需要进行一些错误恢复；如果你只是等待连接发生，线程可能仍然会弄乱它的片段。

但是，根据您要解决的问题，有很多特定的想法需要实施。

# java - 在创建新包装器时引用现有的 SWIG 包装器

> ID：255068
> 
> 赞同：1
> 
> 时间：2008-10-31T21:52:41.900
> 
> 标签：java, c++, swig

我有一个现有的库 (JPhysX)，它是本机 C++ 库 (PhysX) 的 Java 包装器。Java 库使用 SWIG 生成的类型，例如 ，``com.jphysx.SWIGTYPE_p_NxStream``它表示指向`NxStream`C++ 代码中对象的指针。现在我想创建我自己的继承自 C++ type 的 C++ 类`NxStream`，并让我的类的 Java 包装器也继承自 wrapper ``com.jphysx.SWIGTYPE_p_NxStream``。

问题是，当我调用 SWIG 为我的类生成包装器时，它还创建了一个名为 的新包装器``SWIGTYPE_p_NxStream``，它在功能上与 in 中的包装器相同``com.jphysx``，但就 Java 而言仍然是不同的类型。

我如何说服 SWIG 重用这个现有的包装器`com.jphysx`并让我的类的包装器继承自``com.jphysx.SWIGTYPE_p_NxStream``？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T19:07:53.010

在这种情况下，让包装类显式继承所需的类型就可以了：

```
%typemap(javabase) UserStream "com.jphysx.SWIGTYPE_p_NxStream"; 
```

包装类中有一些方法我遇到了类似的问题，但我只是从 SWIG 接口文件中删除了它们，因为无论如何它们都不会从 Java 代码中调用。

**编辑**：这*不起作用*。由于包装器类型继承自另一个包装器类型，它突然有*两个* `swigCPtr`字段。子类型中的那个被初始化，超类型中的那个仍然存在`0`……但是当你在某处使用超类型时，就会用到这个。

**编辑2**：我终于解决了这个问题，通过向Java包装类添加一个方法来将`UserStream`对象转换为`SWIGTYPE_p_NxStream`对象：

```
%typemap(javacode) UserStream %{
    public native com.JPhysX.SWIGTYPE_p_NxStream toNxStreamPtr();
%} 
```

这个 JNI 方法是在 SWIG 的东西之外手写的：

```
JNIEXPORT jobject JNICALL Java_physics_UserStream_toNxStreamPtr(JNIEnv *env, jobject userStreamObject) {
    jclass userStreamClass = env->GetObjectClass(userStreamObject);
    jmethodID getCPtrMethodID = env->GetStaticMethodID(userStreamClass, "getCPtr", "(Lphysics/UserStream;)J");

    jlong cPtr = env->CallStaticLongMethod(userStreamClass, getCPtrMethodID, userStreamObject);
    jboolean futureUse = false;

    jclass nxStreamPtrClass = env->FindClass("com/JPhysX/SWIGTYPE_p_NxStream");
    jmethodID nxStreamPtrConstructor = env->GetMethodID(nxStreamPtrClass, "<init>", "(JZ)V");
    jobject nxStreamPtrObject = env->NewObject(nxStreamPtrClass, nxStreamPtrConstructor, cPtr, futureUse);
    return nxStreamPtrObject;
} 
```

# javascript - JQuery DatePicker 捆绑的控件不能包含在其他控件中

> ID：255071
> 
> 赞同：1
> 
> 时间：2008-10-31T21:54:49.743
> 
> 标签：javascript, jquery, datepicker, web-user-controls, westwind

我的任务是为我们的 Web 项目的多个区域实现日期/时间选择器，并指示使用另一个开发人员创建的控件作为其中的一部分。我正在处理的控件应该允许用户从日历中选择日期，选择显示该日期的格式（从几种预定义的格式中，或使用简单的文本覆盖）以及可选的时间字符串（这实际上只是自由格式的文本）。

我被指示使用的控件记录在这里：[http](http://www.west-wind.com/WebLog/posts/213015.aspx) ://www.west-wind.com/WebLog/posts/213015.aspx ，并使用来自 jQuery 的 DatePicker。

在我实现我的控件并对其进行测试之后，我开始将它集成到需要日期和/或时间输入的页面中。在我对这些实现的测试中，我发现了一个错误：当我在一个页面上包含我的控件的多个副本时，只有第一个获得 jQuery 日历。其他的与它无关。

我已经尝试了一个看似相关的问题（标题为“复制 jquery datepicker”）中建议的一些方法，例如通过 $( "css-selector").datepicker() 语法，并且 ASP.NET 保证所有文本框的唯一 ID。

所以，总而言之，它看起来像这样：

```
<page>
  <mycontrol>
   <west-windjQuerycontrol />
  </mycontrol>
  <mycontrol>
   <west-windjQuerycontrol />
  </mycontrol>
</page> 
```

现在，奇怪的部分：当页面上有多个西风控件的副本时，没有其他用户控件包含它们，它们可以正常工作。除了 jQuery 控件，我的控件没有什么特别之处：简单的标签、文本框、面板和下拉菜单。将 West-Wind jQuery 控件捆绑到用户控件中的某些东西似乎正在破坏它。

有什么建议吗？一段时间以来，由于我糟糕的 javascript 技能和对 jQuery 的有限接触，我一直在努力解决这个问题。

正如下面所指出的，没有 HTML 就很难说。我已经把它包括在下面了。

```
<form name="form1" method="post" action="ControlTest.aspx" id="form1">
<div>
<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
<input type="hidden" name="__LASTFOCUS" id="__LASTFOCUS" value="" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTU4NjEzMDEwOQ9kFgICAw9kFgQCAw9kFgRmD2QWAgIDD2QWAgIDDxBkZBYBZmQCAg9kFgICAw9kFgICAQ8QZGQWAWZkAgUPZBYEZg9kFgICAw9kFgICAw8QZGQWAWZkAgIPZBYCAgMPZBYCAgEPEGRkFgFmZGRDjfLpdb+XxaVaQYP2XkPil2Galw=="     />
</div>

<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['form1'];
if (!theForm) {
    theForm = document.form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
            theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
        }
}
//]]>
</script>

        <script src="/SSO/DE/WebResource.axd?d=jMPpL-KK8_mPj_ssZzGblw2&amp;t=633481894229838141" type="text/javascript"></script>

<script src="/SSO/DE/ScriptResource.axd?d=8KwRIGaNAD3hi2Loz3YV-uxgrdZpGe8nnwH5E3gxLW_lQpnYjRbyIYThTnHtD9rt0&amp;t=633613004148118290" type="text/javascript"></script>
<script src="/SSO/DE/ScriptResource.axd?d=8KwRIGaNAD3hi2Loz3YV-uxgrdZpGe8nnwH5E3gxLW-K0Kuw-pGK1O3mE_r1y3sjKmhHtQjSXeMtYSim0bjyGA2&amp;t=633613004148118290" type="text/javascript"></script>
<script src="/SSO/DE/ScriptResource.axd?d=Id5yAacLMZHF7TWlkgrrid30ZStmsXuLHcF6WQ404YLySP4Itj4qxv2wi9ffbsWQA86oLdnZPWkwDnu4NKxfG1Ue7qdGG1SbOfb4ooHVs7M1&amp;t=633481957084709567" type="text/javascript"></script>
<script type="text/javascript">
//<![CDATA[
if (typeof(Sys) === 'undefined') throw new Error('ASP.NET Ajax client-side framework failed to load.');
//]]>
</script>

<script src="/SSO/DE/ScriptResource.axd?d=Id5yAacLMZHF7TWlkgrrid30ZStmsXuLHcF6WQ404YLySP4Itj4qxv2wi9ffbsWQhT3MFELBAa2rFJZXnSlYAZIN7RT1npcBxJRsWGjJWIwTF0Es1m0vOd-xYnFqWJKz0&amp;t=633481957084709567" type="text/javascript"></script>
    <div style="margin:25px 10px;width:100%;">
        <script type="text/javascript">
//<![CDATA[
Sys.WebForms.PageRequestManager._initialize('stupidThing',     document.getElementById('form1'));
Sys.WebForms.PageRequestManager.getInstance()._updateControls([], [], [], 90);
//]]>
</script>

        <div id="datePicker_Div0" class="AdminRowOdd DERow">
            <div id="datePicker_Div1" class="DELabel">
                <span id="datePicker_DateLabel">Date</span>
            </div>
            <div id="datePicker_Div2" class="DEInput datePicker">
                <input name="datePicker$DateSelector" type="text" onchange="javascript:setTimeout('__doPostBack(\'datePicker$DateSelector\',\'\')', 0)" onkeypress="if (WebForm_TextBoxKeyHandler(event) == false) return false;" id="datePicker_DateSelector" style="width:80px;" />
                <select name="datePicker$languageSelector" onchange="javascript:setTimeout('__doPostBack(\'datePicker$languageSelector\',\'\')', 0)" id="datePicker_languageSelector">
    <option selected="selected" value="en-US">en-US</option>
    <option value="fr-CA">fr-CA</option>
    <option value="fr-FR">fr-FR</option>
    <option value="es-ES">es-ES</option>
    <option value="es-MX">es-MX</option>

</select>
            </div>
        </div>
        <div id="datePicker_Div3" class="AdminRowEven DERow">
            <div id="datePicker_Div4" class="DELabel">
                <span id="datePicker_FormatChoiceLabel">Choose your display format:    </span>
            </div>
            <div id="datePicker_Div5" class="DEInput">
                <select name="datePicker$DateFormatSelector" onchange="javascript:setTimeout('__doPostBack(\'datePicker$DateFormatSelector\',\'\')', 0)" id="datePicker_DateFormatSelector">
    <option selected="selected" value="Choose a date first">Choose a date     first</option>

</select>                
            </div>
        </div>
        <div id="datePicker_Div6" class="AdminRowOdd DERow">
            <div id="datePicker_Div7" class="DELabel">
                <span id="datePicker_FormatOverrideLabel">Or enter your own     text</span>
            </div>
            <div id="datePicker_Div8" class="DEInput">
                <input name="datePicker$DateFormatOverride" type="text"     onchange="javascript:setTimeout('__doPostBack(\'datePicker$DateFormatOverride\',\'\')', 0)" onkeypress="if (WebForm_TextBoxKeyHandler(event) == false) return false;"     id="datePicker_DateFormatOverride" />
            </div>
        </div>

        <br />
        <div id="date1_Div0" class="AdminRowOdd DERow">
            <div id="date1_Div1" class="DELabel">
                <span id="date1_DateLabel">Date</span>
            </div>
            <div id="date1_Div2" class="DEInput datePicker">
            <input name="date1$DateSelector" type="text" onchange="javascript:setTimeout('__doPostBack(\'date1$DateSelector\',\'\')', 0)" onkeypress="if (WebForm_TextBoxKeyHandler(event) == false) return false;" id="date1_DateSelector" style="width:80px;" />
                <select name="date1$languageSelector" onchange="javascript:setTimeout('__doPostBack(\'date1$languageSelector\',\'\')', 0)" id="date1_languageSelector">
    <option selected="selected" value="en-US">en-US</option>
    <option value="fr-CA">fr-CA</option>
    <option value="fr-FR">fr-FR</option>
    <option value="es-ES">es-ES</option>
    <option value="es-MX">es-MX</option>

</select>
            </div>
        </div>
        <div id="date1_Div3" class="AdminRowEven DERow">
            <div id="date1_Div4" class="DELabel">
                <span id="date1_FormatChoiceLabel">Choose your display format:</span>
            </div>
            <div id="date1_Div5" class="DEInput">
                <select name="date1$DateFormatSelector" onchange="javascript:setTimeout('__doPostBack(\'date1$DateFormatSelector\',\'\')', 0)" id="date1_DateFormatSelector">
    <option selected="selected" value="Choose a date first">Choose a date first</option>

</select>                
            </div>
        </div>
        <div id="date1_Div6" class="AdminRowOdd DERow">
            <div id="date1_Div7" class="DELabel">
                <span id="date1_FormatOverrideLabel">Or enter your own text</span>
            </div>
            <div id="date1_Div8" class="DEInput">
                <input name="date1$DateFormatOverride" type="text" onchange="javascript:setTimeout('__doPostBack(\'date1$DateFormatOverride\',\'\')', 0)" onkeypress="if (WebForm_TextBoxKeyHandler(event) == false) return false;" id="date1_DateFormatOverride" />
            </div>
        </div>

    </div>

<div>

    <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWFQLr6MeTCwKb1Zr0AwKVt6utCQKIwaTjAQKdwYzzBwLiwsDhDQKIwdCLBAKHwbCtCgLRr42cCQKi9vj4DgK2lM6kBQLLrsUtAsaboRMC2+2u3QgCzu2GzQ4Cse7K3wQC2+3atQ0C1O26kwMCpdTivwwC1o2X2wsCoubqnQk8I1BK30Q/iVw/rExUww2Cs4bicw==" />
</div>

<script type="text/javascript">
//<![CDATA[
jQuery(document).ready( function() {
var cal = jQuery('#datePicker_DateSelector').datepicker({yearRange: '-1500:+100',dateFormat: 'm/d/yy'});
} );
Sys.Application.initialize();
//]]>
</script>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T22:12:06.697

如果没有看到生成的 HTML 很难知道，但我的第一个猜测是您的控件没有将类名直接应用于`<input>`字段......或者您以某种方式依赖于`id`s （当嵌入用户时可能会改变控制）。

* * *

在您发布的 HTML 中，这些显示为三个相关部分：

### 块 #1（控制：datePicker）

```
<div id="datePicker_Div0" class="AdminRowOdd DERow">
    <div id="datePicker_Div1" class="DELabel">
        <span id="datePicker_DateLabel">Date</span>
    </div>
    <div id="datePicker_Div2" class="DEInput datePicker">
        <input name="datePicker$DateSelector" type="text" 
           onchange="javascript:setTimeout('__doPostBack(\'datePicker$DateSelector\',\'\')', 0)" 
           onkeypress="if (WebForm_TextBoxKeyHandler(event) == false) return false;" 
           id="datePicker_DateSelector" style="width:80px;" />
        <select name="datePicker$languageSelector" 
           onchange="javascript:setTimeout('__doPostBack(\'datePicker$languageSelector\',\'\')', 0)" 
           id="datePicker_languageSelector">
                <option selected="selected" value="en-US">en-US</option>
                <option value="fr-CA">fr-CA</option>
                <option value="fr-FR">fr-FR</option>
                <option value="es-ES">es-ES</option>
                <option value="es-MX">es-MX</option>
        </select>
    </div>
</div> 
```

...

### 块 #2（控制：date1）

```
<div id="date1_Div0" class="AdminRowOdd DERow">
   <div id="date1_Div1" class="DELabel">
       <span id="date1_DateLabel">Date</span>
   </div>
   <div id="date1_Div2" class="DEInput datePicker">
      <input name="date1$DateSelector" type="text" 
         onchange="javascript:setTimeout('__doPostBack(\'date1$DateSelector\',\'\')', 0)" 
         onkeypress="if (WebForm_TextBoxKeyHandler(event) == false) return false;" 
         id="date1_DateSelector" style="width:80px;" />
       <select name="date1$languageSelector" 
         onchange="javascript:setTimeout('__doPostBack(\'date1$languageSelector\',\'\')', 0)" 
         id="date1_languageSelector">
         <option selected="selected" value="en-US">en-US</option>
         <option value="fr-CA">fr-CA</option>
         <option value="fr-FR">fr-FR</option>
         <option value="es-ES">es-ES</option>
         <option value="es-MX">es-MX</option>
      </select>
   </div>
</div> 
```

...

### 块 #3（jQuery 日期选择器连线）

```
<script type="text/javascript">
   //<![CDATA[
   jQuery(document).ready( function() 
   {
      // matches input element for first control only (id selector)
      var cal = jQuery('#datePicker_DateSelector')
         .datepicker({yearRange: '-1500:+100',dateFormat: 'm/d/yy'});
   });
   Sys.Application.initialize();
   //]]>
</script> 
```

问题来自最后一个块。选择器特定于第一个控件，按 ID 匹配。如果将其修改为包含对第二个控件的单独调用...

```
 var cal = jQuery('#datePicker_DateSelector')
         .datepicker({yearRange: '-1500:+100',dateFormat: 'm/d/yy'});
      var cal2 = jQuery('#date1_DateSelector')
         .datepicker({yearRange: '-1500:+100',dateFormat: 'm/d/yy'}); 
```

...或更通用的选择器...

```
 // matches all text input elements that are descendants of 
      // a div element with a class of datePicker
      var cal = jQuery('div.datePicker input:text')
         .datepicker({yearRange: '-1500:+100',dateFormat: 'm/d/yy'}); 
```

...然后事情应该按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T20:24:46.943

我解决了这个问题。

服务器控件的 OnPreRender() 构建上面找到的 javascript，调用如下，其中 sbStartupScript 是包含生成的 javascript 的 StringBuilder：

```
sbStartupScript.AppendLine("} );");
scriptProxy.RegisterStartupScript(this.Page, typeof(ControlResources), "_cal" + this.ID,
sbStartupScript.ToString(), true); 
```

正确的形式应该是：

```
sbStartupScript.AppendLine("} );");
scriptProxy.RegisterStartupScript(this.Page, typeof(ControlResources), "_cal" + this.ClientID,
sbStartupScript.ToString(), true); 
```

现在，有了 ClientId，脚本名称是唯一的，并且都将呈现。

# firewall - Fedora Core 8 下开放端口（用于 VMWare Server）

> ID：255077
> 
> 赞同：0
> 
> 时间：2008-10-31T21:57:26.963
> 
> 标签：firewall, fedora, iptables, vmware-server

我刚刚在全新的 Fedora Core 8 安装上安装了 VMWare Server 2.0。VMWare 的 Web 访问控制台的端口是 8222 和 8333（与默认值一样）。

当我尝试对 myserver:8222 进行远程 http 访问时，它失败了。但是当我跑步时

```
/sbin/service iptables stop 
```

访问成为可能（虽然不是很令人满意）。因此，我更新了conf文件如下

```
cat /etc/sysconfig/iptables
# Firewall configuration written by system-config-firewall
# Manual customization of this file is not recommended.
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:RH-Firewall-1-INPUT - [0:0]
-A INPUT -j RH-Firewall-1-INPUT
-A RH-Firewall-1-INPUT -i lo -j ACCEPT
-A RH-Firewall-1-INPUT -p icmp --icmp-type any -j ACCEPT
-A RH-Firewall-1-INPUT -p 50 -j ACCEPT
-A RH-Firewall-1-INPUT -p 51 -j ACCEPT
-A RH-Firewall-1-INPUT -p udp --dport 5353 -d 224.0.0.251 -j ACCEPT
-A RH-Firewall-1-INPUT -p udp -m udp --dport 631 -j ACCEPT
-A RH-Firewall-1-INPUT -p tcp -m tcp --dport 631 -j ACCEPT
-A RH-Firewall-1-INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT
-A RH-Firewall-1-INPUT -j REJECT --reject-with icmp-host-prohibited
-A FORWARD -j REJECT --reject-with icmp-host-prohibited
# Custom authorization for VMWare administration
-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 8222 -j ACCEPT
-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 8333 -j ACCEPT
COMMIT 
```

然而，即使重新加载了 iptables 设置，它仍然无法正常工作。有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-01T00:40:30.360

您的 VMware 规则需要出现在 REJECT 条目之前；否则他们将永远无法到达。

一个好的调试工具是在您的规则之前添加一个 LOG 来验证：

```
-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT
# Custom authorization for VMWare administration
-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 8222 -j LOG --log-prefix="8222 "
-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 8222 -j ACCEPT
-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 8333 -j LOG --log-prefix="8333 "
-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 8333 -j ACCEPT
-A RH-Firewall-1-INPUT -j REJECT --reject-with icmp-host-prohibited
-A FORWARD -j REJECT --reject-with icmp-host-prohibited
COMMIT 
```

与其他目标不同，`LOG`返回以允许处理进一步的规则。和`ACCEPT`目标`REJECT`终止处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T19:36:40.720

解决此问题的一种简单方法是运行 system-config-securitylevel 或 system-config-securitylevel-tui 并将 8222 和 8333 添加为受信任端口。这添加了与您手动执行的基本相同的 iptables 规则。

# ruby - Ruby中的字符串和符号有什么区别？

> ID：255078
> 
> 赞同：74
> 
> 时间：2008-10-31T21:57:36.617
> 
> 标签：ruby, string, symbols

Ruby 中的字符串和符号之间有什么区别，我什么时候应该使用一个而不是另一个？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2008-10-31T22:11:01.363

主要区别在于表示单个值的多个符号是相同的，而字符串则不是这样。例如：

```
irb(main):007:0> :test.object_id
=> 83618
irb(main):008:0> :test.object_id
=> 83618
irb(main):009:0> :test.object_id
=> 83618 
```

这些是对 symbol 的三个引用`:test`，它们都是同一个对象。

```
irb(main):010:0> "test".object_id
=> -605770378
irb(main):011:0> "test".object_id
=> -605779298
irb(main):012:0> "test".object_id
=> -605784948 
```

这些是对字符串“test”的三个引用，但都是不同的对象。

这意味着使用符号可能会根据应用程序节省大量内存。比较符号是否相等也更快，因为它们是同一个对象，比较相同的字符串要慢得多，因为需要比较字符串值而不仅仅是对象 id。

至于何时使用，我通常对几乎所有东西都使用字符串，除了像哈希键这样我真的想要一个唯一标识符而不是字符串的东西。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-04-29T07:46:31.757

符号和字符串有什么区别？

1.  符号是不可变的：它们的值保持不变。
2.  相同符号的多次使用具有相同的对象 ID，并且与字符串相比是相同的对象，字符串每次都是具有唯一对象 ID 的不同对象。
3.  您不能像`split`在 Symbols 上那样调用任何 String 方法。

从[了解 Ruby 中符号和字符串之间的差异](http://www.gaurishsharma.com/2013/04/understanding-differences-between-symbols-strings-in-ruby.html)

如果你懂中文，你也可以阅读[理解 Ruby Symbol](https://www.ibm.com/developerworks/cn/opensource/os-cn-rubysbl/)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-09-15T19:23:55.810

该声明：

```
foo = "bar" 
```

在内存中创建一个新对象。如果我们重复这句话：

```
foo = "bar" 
```

我们创建另一个对象。

为了更清楚地理解它，请在 IRB 中尝试以下代码：

```
foo = "bar"
puts "string #{foo} with object id = #{foo.object_id}"
foo = "bar"
puts "string #{foo} with object id = #{foo.object_id}" 
```

你会得到如下输出：

```
string bar with object id = 70358547221180
string bar with object id = 70358548927060 
```

这清楚地表明同一字符串有两个不同的对象。现在，如果您使用符号，它将**为每个符号创建一个对象，**因此：

```
foo = :bar
puts "symbol #{foo} with object id = #{foo.object_id}"
foo = :bar
puts "symbol #{foo} with object id = #{foo.object_id}" 
```

显示：

```
symbol bar with object id = 7523228
symbol bar with object id = 7523228 
```

这意味着只有一个对象`:bar`。

此外，符号是**不可变**的，您不能调用任何字符串方法，如符号`upcase`或`split`符号。

比较符号比比较字符串更快。符号可以被认为是形成一个唯一集合的常量/不可变字符串，这些字符串有效地转换为堆上的内存指针。这意味着比较两个符号很快，因为您只是比较两个整数（内存指针）。

字符串是可变的，因此指向它们在堆上的值的内存指针可以在修改后更改。这意味着比较操作更慢，因为可以存在语义上等价的重复项。

当您确定值将保持不变时使用符号，例如使用符号作为哈希键。当您想要更改值或想要对其使用字符串方法时，请使用字符串。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-01T18:24:46.483

`String`和之间的另一个区别`Symbol`是 a`String`有更多用于字符串操作的方法，而 a`Symbol`是一个相对精简的对象。

查看[`String`class](http://www.ruby-doc.org/core/classes/String.html)和[`Symbol`class](http://www.ruby-doc.org/core/classes/Symbol.html)的文档。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-07-05T00:00:13.250

Ruby 中的 String 和 Symbol 有两个主要区别。

1.  String 是可变的，而 Symbol 不是：

    *   因为字符串是可变的，它可以在某个地方发生变化，并可能导致结果不正确。
    *   符号是不可变的。
2.  String 是一个 Object 所以它需要内存分配

    ```
    puts "abc".object_id # 70322858612020
    puts "abc".object_id # 70322846847380
    puts "abc".object_id # 70322846815460 
    ```

    另一方面， Symbol 将返回相同的对象：

    ```
    puts :abc.object_id # 1147868
    puts :abc.object_id # 1147868
    puts :abc.object_id # 1147868 
    ```

因此，String 的使用和比较时间将比 Symbol 多。

阅读“ [Ruby 符号和字符串之间的区别](http://www.reactive.io/tips/2009/01/11/the-difference-between-ruby-symbols-and-strings)”了解更多信息。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-01-15T17:23:59.137

符号可能是灾难的情况。假设您 `params.map(&:to_sym)`在 rails controller 中有。现在在这里，如果您由于某种原因将用户提供的数据转换为符号，那么它可能很危险。如果用户提供的数据太大，并且我们知道该符号不是垃圾收集器，您最终可能会耗尽服务器的内存，从而导致您的网站崩溃。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-08-18T05:46:59.953

主要区别在于 string 可以在变量内具有值，而 symbol 不能。例如：

```
x     =     "hello"
p x  =>     "hello"
p :x =>     :x 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-31T22:02:52.427

符号是用来表示名称和字符串的东西。当您可能需要多次使用字符串时，您会想要使用符号，因为这样更容易且更有效率。

刚刚通过谷歌找到了这个，它可能会提供更多的细节：[给你](http://glu.ttono.us/articles/2005/08/19/understanding-ruby-symbols)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-31T22:04:43.093

符号和字符串完全不同，[这篇文章](http://onestepback.org/index.cgi/Tech/Ruby/SymbolsAreNotImmutableStrings.red)对差异有一点了解。至于何时何地使用它们，关于这个主题有一篇相当广泛的帖子，上面[有很多 :through](http://blog.hasmanythrough.com/2008/4/19/symbols-are-not-pretty-strings)。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-07-21T18:24:58.063

字符串是可变的，符号是不可变的
注意：可变对象可以在赋值后更改，而不可变对象只能被覆盖 [http://www.robertsosinski.com/2009/01/11/the-difference-between-ruby-symbols-and -字符串/](http://www.robertsosinski.com/2009/01/11/the-difference-between-ruby-symbols-and-strings/)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2014-03-17T12:14:56.927

符号是不可变的，字符串是可变的。

当我们对字符串执行任何操作时，它会创建一个新对象并占用内存。随着我们对字符串执行越来越多的操作意味着我们正在消耗越来越多的内存。

符号是不可变的对象，意味着如果我们执行任何操作，它就会对原始对象进行更改，它不会创建任何对象，这就是为什么它更有利可图。

欲了解更多信息，您可以[点击这里](http://www.robertsosinski.com/2009/01/11/the-difference-between-ruby-symbols-and-strings/)

# c++ - 是否可以让 vs2008 c++ 项目从另一个文件导入源文件名？

> ID：255081
> 
> 赞同：-2
> 
> 时间：2008-10-31T22:00:00.687
> 
> 标签：c++, visual-studio

我有一种情况，另一个开发人员正在包含我在他维护的项目中维护的项目的源文件。文件的性质是每个源文件在解释环境中注册一个“命令”，因此您所要做的就是链接一个新的源文件以注册一个新的“命令”。我们不能将这些文件放在静态库中，因为除非项目明确引用文件中的符号，否则链接器会将文件优化掉。

似乎一个潜在的解决方案是在两个项目之外都有一个文件，该文件“包含”两个项目中的源文件名列表。问题是我不知道是否或如何做到这一点。建议，有人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T22:37:52.497

源文件没有理由不能在多个项目中。只需将其添加为 VS 中的“现有项目”即可。

如果您使用的是预编译的头文件，那么这两个项目都需要等效的设置才能正常工作。

您还可以在库中使用#pragma 来强制包含一个符号，否则链接器会丢弃它。

```
#pragma comment(linker, "/include:__mySymbol") 
```

[有关#pragma 注释](http://msdn.microsoft.com/en-us/library/7f0aews7(VS.80).aspx)和[包含](http://msdn.microsoft.com/en-us/library/2s3hwbhs(VS.80).aspx)选项的信息，请参见 MSDN 文档

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T22:04:02.767

你能简单地编写一个只包含`#include`指令的源文件吗？不过，我不确定 VS 是否会检查依赖文件是否已更改（如果它们不在项目中）。

# php - 我应该使用哪个框架来确保更好的长期升级/可维护性，CakePHP 或 CodeIgniter？

> ID：255082
> 
> 赞同：2
> 
> 时间：2008-10-31T22:00:26.753
> 
> 标签：php, codeigniter, cakephp, maintainability

我正在决定一个框架来试用 PHP。我已将范围缩小到 CakePHP 和 CodeIgniter。对于使用过或熟悉两者的任何人，我有几个问题：

1.  我喜欢 CakePHP 默认将大部分代码保留在 webroot 之外的事实。特别是因为我最终可能会为多个应用程序使用单个框架安装。我看到 CodeIgniter 也会这样做，但是您必须对其进行配置并移动一些东西。这种解决方法是安全可靠的，还是事后才想到的黑客攻击？

2.  哪个（如果不是两者）更容易升级和长期维护？随着新版本的框架（和 PHP 本身）的出现。我不想发现我的东西坏了，或者变得过时了。

**编辑：**

这是一篇很老的帖子，但我想我会用我最终做的事情来更新它，那就是使用 Kohana。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T01:33:32.357

你应该**尝试**这两个框架一周左右，在这两个框架中构建一些琐碎的东西（比如博客或维基），然后看看你更喜欢使用哪个。*任何对你*最有意义的东西都可能通过升级和弃用来维持你最长的时间。

CakePHP 目前处于不稳定的状态，在推动发布 1.2 版（不向后兼容）时仍会发现错误。*如果你现在*需要一些坚如磐石的东西，我不建议用它来构建一个关键的应用程序。如果您可以等待一两个月让事情解决，那么这可能是一个有争议的问题。

解决您的疑虑：

1）Cake 和 CI 的做法相同（iirc）。在这方面，它们同样安全、可靠和骇人听闻。

2）一切都变了。如果您需要具体的、永久的稳定性和向后兼容性保证，请推出您自己的框架。它没有那么多，而且除非你愿意，否则你可以保证没有任何变化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T23:40:34.273

我在 CakePHP 上部署了多个应用程序，这是一次非常非常好的体验。无论哪种方式，您都不会出错，因为两者都是可靠的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T22:03:34.110

1.  不是问题。

2.  CodeIgniter 背后有赞助商，所以它绝对是长期选择的赞助商。此外，它更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T22:14:39.517

1.  这是一个非问题。该应用程序有几行说明核心和您的应用程序代码所在的位置。您只需要更改这些行。

2.  你永远无法预料到这一点。

PHP 的状态在这里是一个通配符。一个应用程序 (CI) 与 PHP4 兼容，另一个则需要 PHP5。如果您需要处理仅支持旧版本 PHP 的网络主机的可能性，那么您需要使用 CO。

另一个问题是单元测试。如果您需要您的框架附带测试，那么 CI 不是可行的方法。

就个人而言，由于公司的支持，我对 CI 感到满意。CI 背后的公司正在从他们的努力中获得真正的利润。尽管 CI 是免费的，但他们的付费产品（ExpressionEngine）最终将在 CI 上运行。Zend 框架甚至是 Rails 的诞生（最初是为 Basecamp 构建的）也是如此。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T00:43:56.920

对上述评论的小修正：两者都与 PHP4 兼容，而不仅仅是 CI。另外，我不认为有赞助商会使 CI 或多或少可升级或可维护。金钱至少不能解决这些问题。

我将 CakePHP 用于各种应用程序，到目前为止我对它很满意。1.2 是对 1.1 的巨大改进，虽然库源代码可能会从 RC3 更改为 Final，但我认为您编写的任何代码都不会过时。我唯一的烦恼是该手册没有应有的全面（在我看来），而且我最终使用了 API。权衡是我现在非常了解幕后的代码。无论如何，我强烈推荐它。

另一方面，我从来没有玩过 CI，所以我不能推荐 CakePHP*而不是*CI。我会每一个都试一试，看看哪个能抓住你。无论您选择哪一个，都要研究它的约定和功能。当我开始使用 Cake 时，我不知不觉地编写了一堆代码，让我在控制器中设置一个变量，从而让 Cake“自动”完成一些事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T04:02:27.943

CodeIgniter 非常灵活，一旦您尝试过就会看到。因此，您的应用程序如何可维护将落到您的手中。

我还使用相同的安装部署了多个应用程序。我通常为 CMS 项目创建 2 个应用程序（一个用于管理，一个用于前端）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-09T07:10:05.313

从 CodeIgniter 的角度解决您的两个问题（我不使用 Cake）：

1) 默认情况下，CodeIgniter 不会将自身保留在 webroot 之外，但它可以通过一些非常简单的更改来做到这一点。[我的 CI 教程系列](http://www.jimohalloran.com/2007/09/10/building-a-complete-codeigniter-application-part-1/)的第一部分解释了如何做到这一点，并介绍了新 CI 实例的设置。完成后，唯一需要在 webroot 中的 CI 部分是一个小的 index.php 引导文件。

2) 我有一个最初在 CI 1.4.x 中开发的应用程序，并且我已成功迁移到 1.5.x，然后是 1.6.x。对于每个新版本，CI 开发人员都会提供详细的升级说明，列出需要更换的内容，因此升级相当容易。

吉姆。

# xhtml - xHTML IE7 MIME 类型

> ID：255096
> 
> 赞同：1
> 
> 时间：2008-10-31T22:07:59.750
> 
> 标签：xhtml, xforms

有人能告诉我将静态 XHTML 文件的 MIME-Type 定义为 text/html 的方法吗？我不想用 php，asp.net…….. javascript 就可以了

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T22:37:37.647

你不应该。原因如下：

**将 XHTML 作为 text/html 发送被认为是有害的**( [http://hixie.ch/advocacy/xhtml](http://hixie.ch/advocacy/xhtml) )

> 如果您使用 XHTML，您应该使用 application/xhtml+xml MIME 类型来交付它。如果不这样做，则应使用 HTML4 而不是 XHTML。另一种方法是使用 XHTML，但将其作为 text/html 提供，这会导致下面概述的许多问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T22:13:57.677

使用您的网络服务器来执行此操作。如果您使用的是 apache，请在包含该文件的目录中创建一个名为 .htaccess 的文件并添加以下行：

AddType 文本/html .html

# c# - C# 中的委托数组

> ID：255098
> 
> 赞同：9
> 
> 时间：2008-10-31T22:09:08.997
> 
> 标签：c#, arrays, delegates

我正在尝试从委托数组中调用委托函数。我已经能够创建代表数组，但是如何调用代表？

```
public delegate void pd();

public static class MyClass
{

    static void p1()
    {
        //...
    }

    static void p2 ()
    {
        //...
    }

    //...

    static pd[] delegates = new pd[] {

        new pd( MyClass.p1 ),
        new pd( MyClass.p2)
        /* ... */
    };
}

public class MainClass
{
    static void Main()
    {
        // Call pd[0]
        // Call pd[1]
    }
} 
```

**编辑：** 数组的原因是我需要根据需要通过索引调用委托函数。它们不会响应事件而运行。我在我的代码中看到一个严重（愚蠢）错误，因为我试图使用 pd[] 类型而不是数组（委托）的名称来执行委托函数。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-31T22:16:01.060

如果它们都是相同的类型，为什么不将它们组合成一个多播委托呢？

```
static pd delegateInstance = new pd(MyClass.p1) + new pd(MyClass.p2) ...;

...
pd(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-31T22:14:30.220

```
public class MainClass
{
    static void Main()
    {
        pd[0]();
        pd[1]();
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-31T23:31:28.270

在 .Net 中，任何委托实际上都是“多播”委托（它继承自这个内置基类），因此包含一个内部链表，其中可以包含任意数量的目标委托。

您可以通过在委托本身上调用 GetInvocationList() 方法来访问此列表。此方法返回一个委托数组...

唯一的限制是给定委托链表中的所有委托必须具有相同的签名（具有相同的委托类型）。如果您需要您的集合能够包含不同类型的委托，那么您需要构建自己的列表或集合类。

但如果这没问题，那么您可以像这样“调用”给定委托的调用列表中的委托：

```
public delegate void MessageArrivedHandler(MessageBase msg);
public class MyClass
{
     public event MessageArrivedHandler MessageArrivedClientHandler;   

     public void CallEachDelegate(MessageBase msg)
     {
          if (MessageArrivedClientHandler == null)
              return;
          Delegate[] clientList = MessageArrivedClientHandler.GetInvocationList();
          foreach (Delegate d in clientList)
          {
              if (d is MessageArrivedHandler)
                  (d as MessageArrivedHandler)(msg);
          }
     }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-08T07:54:09.883

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        pd[0]();
        pd[1]();
    }

    public delegate void delegates();

    static delegates[] pd = new delegates[] 
                            { 
                               new delegates(MyClass.p1), 
                               new delegates(MyClass.p2) 
                            };

    public static class MyClass
    {
        public static void p1()
        {
            MessageBox.Show("1");
        }

        public static void p2()
        {
            MessageBox.Show("2");
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T08:15:20.770

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        pd[0](1);
        pd[1](2);
    }

    public delegate void delegates(int par);
    static delegates[] pd = new delegates[] 
                                     { 
                                      new delegates(MyClass.p1), 
                                      new delegates(MyClass.p2) 
                                     };
    public static class MyClass
    {

        public static void p1(int par)
        {
            MessageBox.Show(par.ToString());
        }

        public static void p2(int par)
        {
            MessageBox.Show(par.ToString());
        }

    }

} 
```

# .net - 处理用户在winforms应用程序中双击按钮的最佳方法？

> ID：255104
> 
> 赞同：4
> 
> 时间：2008-10-31T22:13:01.407
> 
> 标签：.net, winforms, user-interface, button, double-click

我正在开发一个 WinForms 应用程序，其中有一个用户控件。用户控件中的按钮将事件引发到要由其他代码处理的表单。其中一个按钮启动一些进程，如果它们同时运行会导致问题。我在代码中有管理状态的逻辑，因此如果进程已经在运行，用户通常无法运行该进程。但是，如果用户双击该按钮，它将以如此快的速度启动该过程两次，以至于我很难阻止它。

我想知道，处理这个问题的最佳方法是什么？

我首先在单击事件中禁用按钮，但在第一次单击之前第二次单击会导致按钮被禁用。在代码中设置其他标志也没有捕捉到它。

我正在考虑在引发事件的代码上添加某种同步锁，但我想知道你们是否有更好的主意。

由于这个项目大部分已经完成，我正在寻找不涉及彻底重写应用程序（如实现复合应用程序块）的答案，但是，也可以随意发布这些想法，因为我可以在我的下一个项目中使用它们.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T22:28:41.953

确保您的按钮禁用或您所做的任何其他锁定是您在事件处理程序中所做的 /first/ 事情。如果您甚至可以在第一条指令触发之前将两个点击事件排队，我会感到非常惊讶，但我想如果您使用的是一台非常慢且被其他应用程序困住的计算机，这是可能的。

在这种情况下，请使用标志。

```
private bool runningExclusiveProcess = false;

public void onClickHandler(object sender, EventArgs e)
{
    if (!runningExclusiveProcess)
    {
        runningExclusiveProcess = true;
        myButton.Enabled = false;

        // Do super secret stuff here

        // If your task is synchronous, then undo your flag here:
        runningExclusiveProcess = false;
        myButton.Enabled = true;
    }
}

// Otherwise, if your task is asynchronous with a callback, then undo your flag here:
public void taskCompletedCallback()
{
    runningExclusiveProcess = false;
    myButton.Enabled = true;
} 
```

如果您仍然可以通过两次点击来完成类似的操作，那么请确保您没有意外订阅了 doubleClick 事件，或者发生了其他任何奇怪的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-01T00:17:32.060

**您是否两次处理该事件？**

在您禁用按钮之前，我*很*惊讶地看到第二次点击即将到来。我希望确保您不会两次连接该活动。我以前偶然这样做过。然后，您将几乎立即获得两个事件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T22:23:49.437

在按钮事件处理程序完成之前，不会设置该按钮上的禁用标志，并且任何额外的点击都将在第一次点击之后的 Windows 消息队列中排队。确保按钮事件处理程序快速完成以释放 UI 线程。有几种方法可以做到这一点，但都涉及生成线程或保持工作线程准备就绪并等待 AutoResetEvent。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T12:27:05.677

无论如何，您是否用图标标记按钮？一定要使用代码来防止同时运行两个进程，但是如果您的按钮看起来和操作起来像传统的命令按钮（矩形，仅文本标签，“凸起”的表面，按下点击）。只是一个想法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T12:09:46.413

单击后立即禁用该按钮。因此，该事件不能被处理两次。处理完事件后，您可以重新启用该按钮。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-28T20:11:28.800

检查的答案很接近，如果充其量是轶事。对于没有经验的人来说，它缺少太多没有意义的代码。我写了一篇关于使用定时器和线程的文章，代码示例非常容易理解。尝试通读它并查看是否可以通过在新线程中运行任务进程来设置上面示例中的标志：

[http://www.robault.com/category/Threading.aspx](http://www.robault.com/category/Threading.aspx)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-31T22:18:02.927

在用户第一次单击按钮后和开始任务之前禁用该按钮。任务完成后，重新启用按钮。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2008-11-04T12:15:13.327

> 我首先在单击事件中禁用按钮，但在第一次单击之前第二次单击会导致按钮被禁用。在代码中设置其他标志也没有捕捉到它。

鉴于 WinForms 本质上是单线程的，在第一次处理完成之前应该不可能触发第二次单击（除非您使用新线程或 BackgroundWorkers 等）。

你能给我们看一个例子来说明你的问题吗？

# perl - 如何在 Perl 中存储数组或哈希中的重复值？

> ID：255114
> 
> 赞同：-1
> 
> 时间：2008-10-31T22:16:08.797
> 
> 标签：perl, arrays, hash, duplicates

让我们很容易做到这一点。我想要的是：

```
@array = qw/one two one/;
my @duplicates = duplicate(@array);
print "@duplicates"; # This should now print 'one'. 
```

如何打印数组/哈希的重复值？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-31T22:44:54.353

```
sub duplicate {
    my @args = @_;
    my %items;
    for my $element(@args) {
        $items{$element}++;
    }
    return grep {$items{$_} > 1} keys %items;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T22:48:47.590

您想要做的更详细、更易读的版本：

```
 sub duplicate {
   my %value_hash;
   foreach my $val (@_) {
     $value_hash{$val} +=1;
   }
   my @arr;
   while (my ($val, $num) = each(%value_hash)) {
     if ($num > 1) {
        push(@arr, $val)
     }
   }
  return @arr;
} 
```

这可以大大缩短，但我故意让它冗长，以便您可以跟进。

不过，我没有对其进行测试，因此请注意我的拼写错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T22:50:07.637

```
# assumes inputs can be hash keys
@a = (1, 2, 3, 3, 4, 4, 5);

# keep count for each unique input
%h = ();
map { $h{$_}++  } @a;

# duplicate inputs have count > 1
@dupes = grep { $h{$_} > 1 } keys %h;

# should print 3, 4
print join(", ", sort @dupes), "\n"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T22:32:17.233

使用字典，将值放入键中，将计数放入值中。

啊，刚刚注意到你标记为 perl

```
尽管 （[...]） {
 $哈希{[dbvalue]}++
}

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-02T02:53:19.610

问题中未指定的是应返回重复项的顺序。

我能想到几种可能：不关心；按输入列表中第一次/第二次/最后一次出现的顺序；排序。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-01T23:01:30.357

我要去打高尔夫球！

```
sub duplicate {
    my %count;
    grep $count{$_}++, @_;
}

@array = qw/one two one/;
my @duplicates = duplicate(@array);
print "@duplicates"; # This should now print 'one'.

# or if returning *exactly* 1 occurrence of each duplicated item is important
sub duplicate {
    my %count;
    grep ++$count{$_} == 2, @_;
} 
```

# amazon-ec2 - 大型数据仓库系统推荐

> ID：255131
> 
> 赞同：3
> 
> 时间：2008-10-31T22:25:57.513
> 
> 标签：amazon-ec2, data-warehouse

我有大量数据需要存储，并且能够生成报告——每个数据都代表网站上的一个事件（我们说每秒超过 50 个，因此显然需要汇总旧数据）。

我正在评估实现这一点的方法，显然它需要可靠，并且应该尽可能容易扩展。还应该可以以灵活有效的方式从数据中生成报告。

我希望一些 SOer 有此类软件的经验并可以提出建议，和/或指出其中的缺陷。

理想情况下，我想在 EC2 上部署它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T22:44:27.023

哇。你正在打开一个巨大的话题。

有几件事就在我的脑海中...

1.  仔细考虑您在事务部分中插入和在报告部分中读取的模式，如果您的数据量非常大，最好将它们分开
2.  仔细查看您在交易实时报告和历史数据汇总报告之间可以容忍的延迟。也许您应该有一个定期运行并汇总您的交易的流程。
3.  仔细查看任何要求您报告交易和汇总数据的任何要求，无论是在同一个报告中还是作为从一个到另一个的向下钻取
4.  具有一些有意义的查询和一些实际数据量的原型
5.  让自己拥有真正的生产质量、企业级数据库，即 Oracle / MSSQL
6.  考虑使用其他人的代码/产品进行报告，例如[Crystal/BO](http://www.businessobjects.com/product/catalog/crystalreports/) / [Cognos](http://www.cognos.com/performance-management/software-reporting-analysis.html)

正如我所说，巨大的话题。当我想到更多时，我将继续添加到我的列表中。

HTH 祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-01T01:37:43.040

@Simon[提出](https://stackoverflow.com/users/24039/simon)了很多优秀的观点，我将添加一些并重新迭代/强调其他一些：

1.  为时间戳使用正确的数据类型 - 确保 DBMS 具有适当的精度。
2.  考虑排队以捕获事件，允许多个线程/进程处理事件的实际存储。
3.  分离事务和数据仓库的模式
4.  认真考虑从事务数据库到数据仓库的定期 ETL。
5.  请记住，您可能*不会*有 50 个事务/秒 24x7x365 - 峰值事务与平均事务
6.  调查DBMS 中的*分区*表。Oracle 和 MSSQL 都将根据一个值（如日期/时间）进行分区。
7.  从一开始就制定归档/数据保留政策。太多的项目只是开始记录数据而没有计划删除/归档它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-13T14:12:23.087

我很惊讶这里的答案都没有涵盖 Hadoop 和 HDFS - 我建议这是因为 SO 是程序员 qa，而您的问题实际上是一个数据科学问题。

如果您正在处理大量查询和大量处理时间，您将使用 HDFS（EC 上的一种分布式存储格式）来存储您的数据并在商品硬件上运行批量查询（即分析）。

然后，您将根据需要预置尽可能多的 EC2 实例（数百或数千个，具体取决于您的数据处理要求有多大）并针对您的数据运行 map reduce queires 以生成报告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T14:20:44.583

哇..这是一个很大的话题。

让我从数据库开始。如果您要拥有大量数据，请首先获得一些好的东西。我喜欢甲骨文和 Teradata。

其次，记录交易数据和报告/分析之间存在明确的区别。将您的交易数据放在一个区域中，然后定期将其汇总到报告区域（模式）中。

我相信你可以通过这两种方式来处理

*   花钱解决问题：购买一流的软件（数据库、报告软件）并聘请一些精明的技术人员提供帮助

*   采用本土方法：只构建你现在需要的东西，并有机地发展整个东西。从一个简单的数据库开始，构建一个 Web 报告框架。有很多血统开源工具和廉价机构可以完成这项工作。

就 EC2 方法而言。我不确定这将如何适应数据存储策略。处理是有限的，这是 EC2 强大的地方。您的主要目标是有效的存储和检索。

# flash - 在 AS3 中最简单的 onReleaseOutside 实现？

> ID：255133
> 
> 赞同：4
> 
> 时间：2008-10-31T22:27:05.733
> 
> 标签：flash, actionscript-3, migration, actionscript-2

我是 ActionScript 2 的长期用户，现在开始使用 ActionScript 3。我缺少的一件事是复制 AS2 的 MovieClip.onReleaseOutside 功能的简单方法。几乎总是有必要实现这个事件，否则你会得到一些有趣的错误，比如 flash 认为你的鼠标在真正启动时已经关闭。

根据[AS2 to AS3 Migration Guide](http://livedocs.adobe.com/flex/2/langref/migration.html)，我应该使用`flash.display.InteractiveObject.setCapture()`它，但据我所知它并不存在。我猜这个文件已经过时或不正确。我在网上找到了一些关于如何复制此功能的帖子，但它们都有自己的问题：

*   即使没有相应的 onPress 事件，[这个也会触发 onReleaseOutside。](http://www.arpitonline.com/blog/?p=33)
*   [这](http://www.kirupa.com/forum/showpost.php?p=1948182&postcount=204)似乎非常低效，每次在应用程序内的任何位置单击鼠标时，您都将添加和删除一个事件侦听器。

必须有更简单的方法，不要告诉我Adobe在重写Actionscript时忘记了这一点？

示例 AS2 代码：

```
// Assume myMC is a simple square or something on the stage

myMC.onPress = function() {
  this._rotation = 45;
}

myMC.onRelease = myMC.onReleaseOutside = function() {
  this._rotation = 0;
} 
```

如果没有 onReleaseOutside 处理程序，如果您按下方形，将鼠标拖到方形之外，然后释放鼠标，则方形不会停止旋转，并且似乎被卡住了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-02T21:56:14.640

简单且万无一失：

```
button.addEventListener( MouseEvent.MOUSE_DOWN, mouseDownHandler );
button.addEventListener( MouseEvent.MOUSE_UP, buttonMouseUpHandler ); // *

function mouseDownHandler( event : MouseEvent ) : void {
    trace( "onPress" );
    // this will catch the event anywhere
    event.target.stage.addEventListener( MouseEvent.MOUSE_UP, mouseUpHandler );
}

function buttonMouseUpHandler( event : MouseEvent ) : void {
    trace( "onRelease" );
    // don't bubble up, which would trigger the mouse up on the stage
    event.stopImmediatePropagation( );
}

function mouseUpHandler( event : MouseEvent ) : void {
    trace( "onReleaseOutside" );
    event.target.removeEventListener( MouseEvent.MOUSE_UP, mouseUpHandler );
} 
```

如果您不关心 onRelease 和 onReleaseOutside 之间的区别（例如对于可拖动项目），您可以跳过按钮本身的鼠标向上监听器（此处用星号注释）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-01T19:42:17.577

你看过这个事件吗：

```
flash.events.Event.MOUSE_LEAVE 
```

从文档中：

**当鼠标指针移出舞台区域时由舞台对象调度。Event.MOUSE_LEAVE 常量定义了 mouseLeave 事件对象的 type 属性值。**

如果您只对用户的鼠标是否离开舞台而不是在特定的 MovieClip 之外感兴趣，它将解决您的问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-01T19:52:50.347

root.addEventListener(MouseEvent.UP, onMouseReleaseOutside);

你当然定义了 onMouseReleaseOutside。基本上，在您的按钮（或 mc）之外发生的任何 MouseEvent.UP（鼠标释放）都会到达舞台而不是您的按钮。这是我通常捕捉它的方式。

# python - 如何防止 Python 打印添加换行符或空格？

> ID：255147
> 
> 赞同：242
> 
> 时间：2008-10-31T22:33:21.633
> 
> 标签：python, printing, formatting, python-2.x

在python中，如果我说

```
print 'h' 
```

我得到字母 h 和换行符。如果我说

```
print 'h', 
```

我得到字母 h 并且没有换行符。如果我说

```
print 'h',
print 'm', 
```

我得到字母 h、空格和字母 m。如何防止 Python 打印空间？

打印语句是同一循环的不同迭代，所以我不能只使用 + 运算符。

* * *

## 回答 #1

> 赞同：300
> 
> 时间：2008-10-31T22:44:14.170

在[Python 3](https://docs.python.org/whatsnew/3.0.html#print-is-a-function)中，使用

```
print('h', end='') 
```

抑制 endline 终止符，和

```
print('a', 'b', 'c', sep='') 
```

抑制项目之间的空格分隔符。请参阅[文档`print`](https://docs.python.org/library/functions.html#print)

* * *

## 回答 #2

> 赞同：202
> 
> 时间：2008-10-31T22:35:49.363

```
import sys

sys.stdout.write('h')
sys.stdout.flush()

sys.stdout.write('m')
sys.stdout.flush() 
```

您需要调用[`sys.stdout.flush()`](https://docs.python.org/library/io.html#io.IOBase.flush)，否则它会将文本保存在缓冲区中，而您将看不到它。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2008-10-31T22:53:52.027

Greg 是对的——你可以使用 sys.stdout.write

不过，也许您应该考虑重构您的算法以累积 <whatevers> 列表，然后

```
lst = ['h', 'm']
print  "".join(lst) 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2009-01-04T11:27:42.423

或使用 a `+`，即：

```
>>> print 'me'+'no'+'likee'+'spacees'+'pls'
menolikeespaceespls 
```

只要确保所有都是可连接的对象。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2008-11-01T00:21:28.450

```
Python 2.5.2 (r252:60911, Sep 27 2008, 07:03:14)
[GCC 4.3.1] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import sys
>>> print "hello",; print "there"
hello there
>>> print "hello",; sys.stdout.softspace=False; print "there"
hellothere 
```

但实际上，您应该`sys.stdout.write`直接使用。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2008-11-01T00:43:51.040

为了完整起见，另一种方法是在执行写入后清除软空间值。

```
import sys
print "hello",
sys.stdout.softspace=0
print "world",
print "!" 
```

印刷`helloworld !`

不过，在大多数情况下，使用 stdout.write() 可能更方便。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2013-12-19T09:32:40.503

这可能看起来很愚蠢，但似乎是最简单的：

```
 print 'h',
    print '\bm' 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-06-24T04:26:03.730

重新控制您的控制台！简单地：

```
from __past__ import printf 
```

其中`__past__.py`包含：

```
import sys
def printf(fmt, *varargs):
    sys.stdout.write(fmt % varargs) 
```

然后：

```
>>> printf("Hello, world!\n")
Hello, world!
>>> printf("%d %d %d\n", 0, 1, 42)
0 1 42
>>> printf('a'); printf('b'); printf('c'); printf('\n')
abc
>>> 
```

额外奖励：如果您不喜欢`print >> f, ...`，您可以将此 caper 扩展到 fprintf(f, ...)。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2014-10-13T15:46:56.940

我没有添加新的答案。我只是将最好的标记答案以更好的格式。我可以看到评分的最佳答案是使用`sys.stdout.write(someString)`. 你可以试试这个：

```
 import sys
    Print = sys.stdout.write
    Print("Hello")
    Print("World") 
```

将产生：

```
HelloWorld 
```

就这些。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-04-23T14:27:07.163

在 python 2.6 中：

```
>>> print 'h','m','h'
h m h
>>> from __future__ import print_function
>>> print('h',end='')
h>>> print('h',end='');print('m',end='');print('h',end='')
hmh>>>
>>> print('h','m','h',sep='');
hmh
>>> 
```

因此，使用 __future__ 中的 print_function 可以显式设置 print 函数的**sep**和**end**参数。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-01-26T22:06:39.153

您可以像 C 中的 printf 函数一样使用 print。

例如

打印 "%s%s" % (x, y)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-07-10T21:13:39.137

```
print("{0}{1}{2}".format(a, b, c)) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-12-04T13:41:52.800

`sys.stdout.write`是（在 Python 2 中）唯一可靠的解决方案。Python 2 打印太疯狂了。考虑这段代码：

```
print "a",
print "b", 
```

这将打印`a b`，导致您怀疑它正在打印尾随空格。但这是不正确的。试试这个：

```
print "a",
sys.stdout.write("0")
print "b", 
```

这将打印`a0b`. 你怎么解释？***空间去哪儿了？***

我仍然不能完全弄清楚这里到底发生了什么。有人可以看看我最好的猜测：

*`,`当你有一个尾随时，我尝试推断规则`print`*：

首先，让我们假设`print ,`（在 Python 2 中）不打印任何空格（空格*或*换行符）。

然而，Python 2 确实会注意您的打印方式——您使用的是`print`、 或`sys.stdout.write`还是其他东西？如果您*连续两次*调用`print`，那么 Python 将坚持在两者之间放置一个空格。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-02-18T19:21:28.077

```
print('''first line \
second line''') 
```

它会产生

> 第一行 第二行

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2015-04-18T07:21:47.273

```
import sys
a=raw_input()
for i in range(0,len(a)):
       sys.stdout.write(a[i]) 
```

# mysql - mysql字符集cli

> ID：255153
> 
> 赞同：3
> 
> 时间：2008-10-31T22:35:46.603
> 
> 标签：mysql, character-encoding, command-line-interface

我如何确定 mysql db 的字符集设置为什么？在cli？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-31T22:40:53.770

```
SHOW CREATE DATABASE db-name 
```

将向您显示数据库的默认字符集，

```
SHOW CREATE TABLE db-name.table-name 
```

将向您显示特定表的字符集（以及许多其他信息）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T23:20:38.387

您可以使用命令“显示表状态”，

它会向您显示有关您的表格的大量信息（包括字符集）

mysql> 显示表状态；

# python - 如何在 GAE 中覆盖 HTTP 请求动词

> ID：255157
> 
> 赞同：1
> 
> 时间：2008-10-31T22:37:00.283
> 
> 标签：python, google-app-engine, rest, metaclass

在 Google App Engine Webapp 框架应用程序的上下文中：

我想在提供参数_method的情况下更改请求的请求动词，例如，如果POST请求带有参数_method=PUT，我需要更改请求以调用处理程序的put方法。这是为了应对prototype.js 处理PUT 和DELETE 等动词的方式（IE 的解决方法）。这是我的第一次尝试：

```
MyRequestHandler 类（webapp.RequestHandler）：
   定义初始化（自我，请求，响应）：
       m = request.get('_method')
       如果米：
           request.method = m.upper()
       webapp.RequestHandler.initialize（自我，请求，响应）

```

问题是，由于某种原因，每当重定向完成时，self.request.params 在调用处理方法（放置或删除）时被清空，即使它们在调用初始化时被填充。任何人都知道这是为什么？作为一种解决方法，我认为我可以在 initialize() 时间克隆参数，但是 .copy() 不起作用，我也没有找到一种方法来做到这一点。

*更新：我收到了来自 Arachnid 的非常有用的回复。我最终得到的解决方案使用了元类。它在下面找到。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-01T18:22:13.057

无论如何，从初始化调用处理程序都不是正确的方法——如果你这样做，webapp 也会调用原始处理程序。

相反，您有几个选择：

*   您可以继承 webapp.WSGIApplication 并覆盖**调用**以选择基于 _method 的方法（当它存在时）。
*   您可以在initialize中检查_method是否存在，如果存在，则相应地修改请求对象的'REQUEST_METHOD'环境变量。这将导致 WSGIApplication 类执行您选择的方法。

无论哪种方式，请查看 SDK 中的 google/appengine/ext/webapp/ **init** .py，以便了解它是如何工作的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-02T17:35:47.190

那是你的回应的蛛形纲动物。向我指出框架的来源真的很有帮助。最后我查看了源不存在（只有 .pyc），也许它随着 SDK 的新版本而改变。对于我的情况，我认为重写 WSGIApplication 是正确的做法。但是，我选择使用元类，因为它不需要我将一堆框架代码导入（复制）到我的代码中然后修改它。这是我的解决方案：

```
类 RequestHandlerMetaclass（类型）：
    def __init__(cls, name, bases, dct):
        超级（RequestHandlerMetaclass，cls）.__init__（名称，基地，dct）
        org_post = getattr(cls, 'post')
        def post(self, *params, **kws):
            动词 = self.request.get('_method')
            如果动词：
                动词 = verb.upper()
                如果动词 == '删除'：
                    self.delete(*params, **kws)
                elif 动词 == 'PUT'：
                    self.put(*params, **kws)
            别的：
                org_post(self, *params, **kws)
        setattr（cls，“发布”，发布）

MyRequestHandler 类（webapp.RequestHandler）：
    __metaclass__ = RequestHandlerMetaclass

```

# html - Markdown 和图像对齐

> ID：255170
> 
> 赞同：230
> 
> 时间：2008-10-31T22:43:46.417
> 
> 标签：html, css, markdown

我正在制作一个网站，每个月都会在问题中发布文章。这很简单，我认为使用 Markdown 编辑器（如 Stack Overflow 中的[WMD](http://code.google.com/p/wmd/)编辑器）将是完美的。

但是，**他们确实需要在给定段落中使图像右对齐的能力**。

我看不到使用当前系统的方法 - 有可能吗？

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2008-10-31T22:47:23.227

您可以在 Markdown 中嵌入 HTML，因此您可以执行以下操作：

```
<img style="float: right;" src="whatever.jpg">

Continue markdown text... 
```

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2016-09-21T11:12:28.430

**我在纯 Markdown**中找到了一个不错的解决方案，带有一点**CSS 3 hack** :-)

```
![image alt >](/image-right.jpg)
![image alt <](/image-left.jpg)
![image alt ><](/center-image.jpg) 
```

当以或`image alt`结尾时，遵循左侧或右侧的 CSS 3 代码浮动图像。`<``>`

```
img[alt$=">"] {
  float: right;
}

img[alt$="<"] {
  float: left;
}

img[alt$="><"] {
  display: block;
  max-width: 100%;
  height: auto;
  margin: auto;
  float: none!important;
} 
```

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2013-04-29T12:12:45.757

许多 Markdown “额外”处理器支持属性。所以你可以像这样包含一个类名（PHP Markdown Extra）：

```
![Flowers](/flowers.jpeg){.callout} 
```

或者，或者（Maruku、[Kramdown](https://kramdown.gettalong.org/syntax.html#attribute-list-definitions)、[Python Markdown](https://pythonhosted.org/Markdown/extensions/attr_list.html)）：

```
![Flowers](/flowers.jpeg){: .callout} 
```

然后，当然，您可以以正确的方式使用样式表：

```
.callout {
    float: right;
} 
```

如果你的支持这种语法，它会给你两全其美：没有嵌入的标记，以及一个足够抽象的样式表，不需要你的内容编辑器修改。

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2017-04-29T03:22:42.487

对于上面使用 ALT 标记和 alt 标记上的 CSS 选择器的方法，我有一个替代方法......相反，添加这样的 URL 哈希：

首先是您的 Markdown 图像代码：

```
![my image](/img/myImage.jpg#left)
![my image](/img/myImage.jpg#right)
![my image](/img/myImage.jpg#center) 
```

请注意添加的 URL 哈希 #center。

现在使用 CSS 3 属性选择器在 CSS 中添加此规则以选择具有特定路径的图像。

```
img[src*='#left'] {
    float: left;
}
img[src*='#right'] {
    float: right;
}
img[src*='#center'] {
    display: block;
    margin: auto;
} 
```

您应该能够像定义类名一样使用这样的 URL 哈希，并且它不是像某些人针对该解决方案所评论的那样滥用 ALT 标记。它也不需要任何额外的扩展。为左右浮动或您可能想要的任何其他样式做一个。

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2013-01-24T18:33:34.690

我喜欢通过使用表格将图像与垂直管道 ( `|`) 语法对齐来变得超级懒惰。这得到了一些 Markdown 风格的支持（如果你的船漂浮的话，[Textile](https://en.wikipedia.org/wiki/Textile_(markup_language))也支持）：

```
| I am text to the left  | ![Flowers](/flowers.jpeg) | 
```

或者

```
| ![Flowers](/flowers.jpeg) | I am text to the right | 
```

它不是最灵活的解决方案，但它可以满足我的大部分简单需求，以 markdown 格式易于阅读，并且您不需要记住任何 CSS 或原始 HTML。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2011-02-19T22:51:48.307

嵌入 CSS 很糟糕：

```
![Flowers](/flowers.jpeg) 
```

另一个文件中的 CSS：

```
img[alt=Flowers] { float: right; } 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2010-11-14T15:08:03.223

更`p#given img { float: right }`简洁的方法是只放入样式表，或者`<head>`放入`style`标签中。然后，只需使用 markdown `![Alt text](/path/to/img.jpg)`。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-08-04T15:18:46.853

```
<div style="float:left;margin:0 10px 10px 0" markdown="1">
    ![book](/images/book01.jpg)
</div> 
```

`markdown`Markdown 内部的属性可能性。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2016-06-03T06:37:34.580

我喜欢[learnvst](https://stackoverflow.com/a/14508301/1112124)使用表格的答案，因为它非常易读（这是编写 Markdown 的目的之一）。

但是，对于 GitBook 的 Markdown 解析器，除了一个空的标题行之外，我还必须在其下添加一个分隔线，以便识别和正确呈现表格：

```
| - | - |
|---|---|
| I am text to the left  | ![Flowers](/flowers.jpeg) |
| ![Flowers](/flowers.jpeg) | I am text to the right | 
```

分隔线需要至少包含三个破折号`---`。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2013-09-27T00:36:46.857

如果你在 Python 中实现它，有[一个扩展](http://pythonhosted.org/Markdown/extensions/attr_list.html)可以让你添加 HTML 键/值对和类/ID 标签。语法是：

```
![A picture of a cat](cat.png){: style="float:right"} 
```

或者，如果嵌入式样式不能让你的船漂浮，

```
![A picture of a cat](cat.png){: .floatright} 
```

带有相应的样式表，`stylish.css`：

```
.floatright {
    float: right;
    /* etc. */
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-05-04T09:43:27.407

正如 greg[所说](https://stackoverflow.com/a/255182/766570)，您可以在 Markdown 中嵌入 HTML 内容，但 Markdown 的要点之一是避免必须拥有广泛的（或任何，就此而言）CSS/HTML 标记知识，对吧？这就是我所做的：

在我的 Markdown 文件中，我只是指示我所有的 wiki 编辑器嵌入所有图像，如下所示：

```
'<div> // Put image here  </div>` 
```

（当然..他们不知道是什么`<div>`意思，但这不重要）

所以 Markdown 文件看起来像这样：

```
<div>
![optional image description][1]
</div>

[1]: /image/path 
```

在包含整个页面的 CSS 内容中，我可以使用图像标签做任何我想做的事情：

```
img {
   float: right;
} 
```

当然，您可以对 CSS 内容做更多的事情......（在这种特殊情况下，`img`用 div 包装标签可以防止其他文本包装在图像上......不过，这只是一个例子），但恕我直言，*Markdown*的重点是您不希望潜在的非技术人员进入 CSS/HTML 的来龙去脉。作为 Web 开发人员，您可以让包含页面的 CSS 内容尽可能通用和干净，但是随后再次，您的编辑不需要知道这一点。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-02-09T05:26:06.383

我有同样的任务，我通过添加以下内容将图像向右对齐：

```
<div style="text-align: right"><img src="/default/image/sms.png" width="100" /></div> 
```

要将图像向左或居中对齐，请替换

```
<div style="text-align: right"> 
```

和

```
<div style="text-align: center">
<div style="text-align: left"> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-10-28T03:23:52.407

**在警告框中将图像和文本并排对齐，作为单个块中段落的一部分。**

```
<div class="warning" style='background-color:#EDF2F7; color:#1A2067; border-left: solid #718096 4px; border-radius: 4px;'>
<p style='padding:0.7em; margin-left:0.7em; display: inline-block;'>
<img src="typora_images/image-20211028083121348.png" style="zoom:70%;  float:right; padding:0.7em"/>
<b>isomorphism</b>  &rarr;  In mathematics, an isomorphism is a structure-preserving mapping between two structures of the same type that can be reversed by an inverse mapping.<br>
</p>
</div> 
```

**输出 ：**

[![在此处输入图像描述](https://i.stack.imgur.com/EAVm6.png)](https://i.stack.imgur.com/EAVm6.png)

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2020-05-20T19:07:41.200

这对我有用

```
<p align="center">
 <img src="/LogoOfficial.png" width="300" >
</p> 
```

* * *

## 回答 #15

> 赞同：-16
> 
> 时间：2011-12-13T05:58:46.460

最简单的是将图像包装在中心标签中，就像这样......

```
<center>![Alt test](http://upload.wikimedia.org/wikipedia/en/b/bc/Wiki.png)</center> 
```

与 Markdown 相关的任何事情都可以在这里进行测试 - [http://daringfireball.net/projects/markdown/dingus](http://daringfireball.net/projects/markdown/dingus)

当然，`<center>`可能会被弃用，但它很简单而且有效！

# c# - 如何在 C# 中针对流安全地创建 XPathNavigator？

> ID：255171
> 
> 赞同：2
> 
> 时间：2008-10-31T22:44:10.877
> 
> 标签：c#, xml, encoding, stream

给定一个 Stream 作为输入，我如何安全地创建一个针对 XML 数据源的 XPathNavigator？

XML 数据源：

*   可能包含需要删除的无效十六进制字符。
*   可能包含与文档声明的编码不匹配的字符。

例如，云中的某些 XML 数据源将声明编码为*utf-8*，但实际编码为*windows-1252*或*ISO 8859-1*，这可能会导致在创建 XmlReader 时抛出无效字符异常流。

来自*StreamReader.CurrentEncoding*属性文档：“当前阅读器使用的当前字符编码。在第一次调用 StreamReader 的任何 Read 方法后，该值可能不同，因为在第一次调用 Read 方法之前不会进行编码自动检测。 " 这似乎表明可以在第一次读取后检查 CurrentEncoding，但是当我们需要将 XML 数据写入 Stream 时，我们是否会卡住存储此编码？

我希望找到一种最佳实践，针对 XML 数据源安全地创建 XPathNavigator/IXPathNavigable 实例，该数据源将优雅地处理编码无效字符问题（最好在 C# 中）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T04:53:54.410

当使用错误的编码（没有与 XML 片段一起存储的编码）将一些 XML 片段导入 CRM 系统时，我遇到了类似的问题。

在一个循环中，我使用列表中的当前编码创建了一个包装流。编码是使用 DecoderExceptionFallback 和 EncoderExceptionFallback 选项构建的（如@Doug 所述）。如果在处理过程中抛出 DecoderFallbackException，则重置原始流并使用下一个最可能的编码。

我们的编码列表类似于 UTF-8、Windows-1252、GB-2312 和 US-ASCII。如果您从列表的末尾掉下来，那么流真的很糟糕并且被拒绝/忽略/等等。

编辑：

我制作了一个快速示例和基本测试文件（来源[在这里](http://www.devstuff.com/test/Soq255171.zip)）。该代码没有任何启发式方法可以在都匹配相同字节集的代码页之间进行选择，因此 Windows-1252 文件可能会被检测为 GB2312，反之亦然，具体取决于文件内容和编码首选项顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T03:12:47.110

可以使用[DecoderFallback](http://msdn.microsoft.com/en-us/library/system.text.decoderfallback.aspx)类（和一些相关的类）来处理坏字符，要么跳过它们，要么做其他事情（用新的编码重新开始？）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T23:03:44.630

当使用 XmlTextReader 或类似的东西时，阅读器本身会找出 xml 文件中声明的编码。

# delphi - 如何填充 Delphi 集？

> ID：255189
> 
> 赞同：10
> 
> 时间：2008-10-31T22:48:52.163
> 
> 标签：delphi, set

如果我有一个类型定义为枚举类型的**集合**，用 [] 创建一个空集很容易，但是如何创建一个*完整*集呢？

编辑：是的，显而易见的解决方案是使用 for 循环。如果有另一种方法，那也是一个非常糟糕的解决方案。有谁知道一种可以在恒定时间内起作用的方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-03T04:02:32.323

Low() 和 High() 是可以在编译时评估的“编译器魔法”函数。这允许它们在常量声明中使用，如下所示：

```
变量
  MySet : TBorderIcons;
  MySet2 : TBorderIcons;
常量
  AllIcons : TBorderIcons = [Low(TBorderIcon)..High(TBorderIcon)];
开始
  MySet := [Low(TBorderIcon)..High(TBorderIcon)];
  MySet2 := AllIcons;
结尾;

```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-01T00:34:31.857

根据巴里的建议：

```
FillChar(VarSet, SizeOf(VarSet), $FF); 
```

# hibernate - 休眠条件 - 获取单个对象

> ID：255194
> 
> 赞同：3
> 
> 时间：2008-10-31T22:51:37.647
> 
> 标签：hibernate, grails, groovy, grails-orm

我正在使用 Hibernate (GORM) 进行 Grails 项目。我有以下领域模型：

```
ClientContact {
   static hasMany = [owners: Person]
   static belongsTo = [Person]
}

Person {
   static hasMany = [clientContacts: ClientContact]
} 
```

当我尝试`ClientContacts`使用特定所有者 ( `Person`) 检索所有内容时，我遇到了一些有趣的问题。我正在使用以下查询条件：

```
def query = {
   owners {
      eq("id", Long.parseLong(params.ownerId))
   }
}
def criteria = ClientContact.createCriteria()
def results = criteria.list(params, query) 
```

问题是当我遍历`ClientContacts`结果中的每一个时，它们只有**一个所有者**- 事实上，大多数都有许多其他所有者。是什么赋予了？我知道 hibernate/GORM 使用延迟获取，但我认为`ClientContact`当我尝试访问它们时它会获取所有其他所有者。

有什么想法吗？我想继续使用*list()*函数，因为它提供了一些不错的分页功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-01-27T15:14:34.250

我知道这个线程很老，但我今天遇到了完全相同的问题，解决方案似乎是使用别名，所以改为：

```
def query = {
        owners {
                eq("id", Long.parseLong(params.ownerId))
        }
} 
```

可以尝试：

```
def query = {
        createAlias("owners", "o")
        eq("o.id", Long.parseLong(params.ownerId))
} 
```

第一个查询创建左外连接，第二个查询创建内连接。请参阅此链接以获取更详细的说明：[http ://adhockery.blogspot.com/2009/06/querying-by-association-redux.html](http://adhockery.blogspot.com/2009/06/querying-by-association-redux.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-01T00:05:15.347

两个快速观察：

1.  [Grails 文档]（[http://grails.org/doc/1.0.x/guide/5.%20Object%20Relational%20Mapping%20](http://grails.org/doc/1.0.x/guide/5.%20Object%20Relational%20Mapping%20(GORM).html#5.2.1.3) (GORM).html#5.2.1.3多对多）说**多对多**关联必须手动编码，默认脚手架不会这样做。
2.  您可能需要使用`eqId()`标准 - 请参阅[createCriteria](http://grails.org/doc/1.0.x/ref/Domain%20Classes/createCriteria.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-22T22:48:19.357

id 和 version 是所有 GORM 类的特殊属性。您不需要在类声明中指定它们，也不能对它们使用标准标准。

您肯定需要使用 eqID 标准

```
 def query = {
          owners {
                eqId(Long.parseLong(params.ownerId))
          }
   }
   def criteria = ClientContact.createCriteria()
   def results = criteria.list(params, query) 
```

# c++ - 用于 C++ 的非 GPL JSON-RPC 库

> ID：255198
> 
> 赞同：7
> 
> 时间：2008-10-31T22:53:44.070
> 
> 标签：c++, json-rpc

哪些非 GPL 库可用于在原生 C++ 中编写 JSON-RPC 服务器和客户端？

根据[http://json-rpc.org/wiki/implementations](http://json-rpc.org/wiki/implementations)，似乎只存在一种用于 C++ 的 JSON-RPC 实现，即[JsonRpc-Cpp](http://sourceforge.net/projects/jsonrpc-cpp)，但仅在 GPL 下可用。不幸的是，我们不能在我们的软件中使用 GPL 代码。

big-llc.com的[JSON RPC C 库可能是一个替代方案。](http://www.big-llc.com/software.jsp)他们称其为“一个免费的轻量级实现 C 库，可以更轻松地处理 JSON-RPC 请求”，但他们没有提及许可。

谁知道其他选择？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-09-22T18:34:08.300

[JsonRpc-Cpp](http://sourceforge.net/projects/jsonrpc-cpp/)自 0.3 版本 2011-05-06 起作为 LGPLv3 提供。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T02:43:21.190

老实说，我对此一无所知，但在搜索其他序列化工具时遇到了它：

[C/C++ 中的 JSON-RPC 和 XML-RPC](http://realtimelogic.com/ba/doc/en/C/WebServices.html)

# git - 如何使用我喜欢的差异工具/查看器查看“git diff”输出？

> ID：255202
> 
> 赞同：794
> 
> 时间：2008-10-31T22:55:12.493
> 
> 标签：git, diff, difftool, git-difftool, diffmerge

当我输入 时`git diff`，我想使用我选择的视觉差异工具（Windows 上的 SourceGear “diffmerge”）查看输出。我如何配置 git 来做到这一点？

* * *

## 回答 #1

> 赞同：400
> 
> 时间：2008-10-31T23:03:43.460

从 Git1.6.3 开始，您可以使用**git difftool 脚本**：请参阅[下面的答案](https://stackoverflow.com/questions/255202/how-do-i-view-git-diff-output-with-visual-diff-program/949242#949242)。

* * *

也许这篇[文章](https://web.archive.org/web/20170508180316/http://git.net:80/ml/version-control.msysgit/2008-06/msg00200.html)会对你有所帮助。以下是最好的部分：

指定外部差异工具有两种不同的方法。

第一个是您使用的方法，通过设置 GIT_EXTERNAL_DIFF 变量。但是，该变量应该指向可执行文件的完整路径。此外，由 GIT_EXTERNAL_DIFF 指定的可执行文件将使用一组固定的 7 个参数调用：

```
path old-file old-hex old-mode new-file new-hex new-mode 
```

由于大多数 diff 工具将需要不同的参数顺序（并且仅需要一些），因此您很可能必须指定一个包装脚本，而后者又会调用真正的 diff 工具。

我更喜欢的第二种方法是**通过 "git config" 配置外部差异工具**。这是我所做的：

1）创建一个包装脚本“git-diff-wrapper.sh”，其中包含类似

```
-->8-(snip)--
#!/bin/sh

# diff is called by git with 7 parameters:
# path old-file old-hex old-mode new-file new-hex new-mode

"<path_to_diff_executable>" "$2" "$5" | cat
--8<-(snap)-- 
```

如您所见，只有第二个（“旧文件”）和第五个（“新文件”）参数将传递给 diff 工具。

2) 类型

```
$ git config --global diff.external <path_to_wrapper_script> 
```

在命令提示符处，替换为“git-diff-wrapper.sh”的路径，因此您的 ~/.gitconfig 包含

```
-->8-(snip)--
[diff]
    external = <path_to_wrapper_script>
--8<-(snap)-- 
```

确保使用正确的语法来指定包装脚本和差异工具的路径，即使用正斜杠而不是反斜杠。就我而言，我有

```
[diff]
    external = \"c:/Documents and Settings/sschuber/git-diff-wrapper.sh\" 
```

在 .gitconfig 和

```
"d:/Program Files/Beyond Compare 3/BCompare.exe" "$2" "$5" | cat 
```

在包装脚本中。注意尾随的“猫”！

（我想 ' `| cat`' 仅适用于某些可能无法返回正确或一致的返回状态的程序。如果您的差异工具具有明确的返回状态，您可能想尝试不使用尾随猫）

（[Diomidis Spinellis](https://stackoverflow.com/users/20520/diomidis-spinellis)[在评论中](https://stackoverflow.com/questions/255202/how-do-i-view-git-diff-output-with-my-preferred-diff-tool-viewer/255212#comment96247087_255212)补充道：

> 该`cat`命令是必需的，因为[`diff(1)`](http://man7.org/linux/man-pages/man1/diff.1.html)如果文件不同，默认情况下会以错误代码退出。
> Git 期望外部 diff 程序仅在发生实际错误时以错误代码退出，例如内存不足。
> 通过管道输出`git`到`cat`非零错误代码被屏蔽。
> 更有效的是，程序可以只`exit`使用 0 的参数运行。）

* * *

那（上面引用的文章）是**通过配置文件**（而不是通过环境变量）定义的外部工具的理论。
在实践中（仍然是外部工具的配置文件定义），您可以参考：

*   [如何使用 msysgit / gitk 设置 DiffMerge？](https://stackoverflow.com/questions/780425/how-do-i-setup-diffmerge-with-msysgit-gitk/783667#783667)它说明了 MsysGit 和 gitk 的 DiffMerge 和 WinMerge 的具体设置
*   [如何设置编辑器以在 Windows 上使用 Git？](https://stackoverflow.com/questions/10564/how-can-i-set-up-an-editor-to-work-with-git-on-windows/773973#773973)用于将 Notepad++ 定义为外部编辑器。

* * *

## 回答 #2

> 赞同：219
> 
> 时间：2009-06-04T08:25:41.700

要完成上面我之前的[“diff.external”配置答案](https://stackoverflow.com/questions/255202/how-do-i-view-git-diff-output-with-visual-diff-program/255212#255212)：

正如[Jakub 所说](https://stackoverflow.com/questions/255202/how-do-i-view-git-diff-output-with-visual-diff-program/901386#901386)，Git1.6.3 引入了[git **difftool**](http://marc.info/?l=git&m=123025539212603&w=2)，最初于 2008 年 9 月提出：

USAGE= `'[--tool=tool] [--commit=ref] [--start=ref --end=ref] [--no-prompt] [file to merge]'`
（请参阅`--extcmd`此答案的最后一部分）

`$LOCAL`包含起始修订版`$REMOTE`中的文件内容，并包含结束修订版中文件的内容。
`$BASE`包含工作中文件的内容

> 它基本上`git-mergetool`被修改为在 git index/worktree 上操作。
> 
> 此脚本的常见用例是当您有暂存或未暂存的更改并且您希望在并排差异查看器中查看更改（例如`xxdiff`，`tkdiff`等）。

```
git difftool [<filename>*] 
```

> 另一个用例是当您想查看相同的信息但正在比较任意提交时（这是 revarg 解析可能更好的部分）

```
git difftool --start=HEAD^ --end=HEAD [-- <filename>*] 
```

最后一个用例是当您想将当前工作树与 HEAD 以外的其他内容（例如标签）进行比较时

```
git difftool --commit=v1.0.0 [-- <filename>*] 
```

**注意：从 Git 2.5 开始，`git config diff.tool winmerge`就足够了！**
参见“ [git mergetool winmerge](https://stackoverflow.com/a/30699239/6309) ”

[从 Git 1.7.11 开始](https://stackoverflow.com/a/10879804/6309)，您可以选择`--dir-diff`生成外部差异工具，这些工具可以在填充两个临时目录后一次比较两个目录层次结构，而不是为每个文件对运行一次外部工具实例。

* * *

在 Git 2.5 之前：

`difftool`使用自定义差异工具进行配置的实际案例：

```
C:\myGitRepo>git config --global diff.tool winmerge
C:\myGitRepo>git config --global difftool.winmerge.cmd "winmerge.sh \"$LOCAL\" \"$REMOTE\""
C:\myGitRepo>git config --global difftool.prompt false 
```

将 winmerge.sh 存储在 PATH 的目录部分中：

```
#!/bin/sh
echo Launching WinMergeU.exe: $1 $2
"C:/Program Files/WinMerge/WinMergeU.exe" -u -e "$1" "$2" -dl "Local" -dr "Remote" 
```

如果您有其他工具（kdiff3、P4Diff、...），请创建另一个 shell 脚本和相应的`difftool.myDiffTool.cmd`配置指令。
然后您可以轻松地使用`diff.tool`配置切换工具。

您还拥有[Dave 的此博客条目](http://www.davesquared.net/2009/05/setting-up-git-difftool-on-windows.html)以添加其他详细信息。
（或者[这个问题](https://stackoverflow.com/q/2468230/6309)的`winmergeu`选项）

此设置的有趣之处在于**`winmerge.sh`脚本**：您可以自定义它以考虑特殊情况。

例如，请参阅下面的[David Marble](https://stackoverflow.com/users/216735/david-marble)的[回答，](https://stackoverflow.com/questions/255202/how-do-i-view-git-diff-output-with-visual-diff-program/4116806#4116806)以获取处理以下内容的示例：

*   *源或目标中的*新文件**
**   *删除*源或目标中的文件*

 ** * *

正如[Kem Mason在](https://stackoverflow.com/users/398582/kem-mason)[他的回答](https://stackoverflow.com/questions/255202/how-do-i-view-git-diff-output-with-visual-diff-program/4881489#4881489)中提到的那样，您还可以**通过使用以下`--extcmd`选项**来避免任何包装：

```
--extcmd=<command> 
```

> 指定用于查看差异的自定义命令。`git-difftool`忽略配置的默认值并**`$command $LOCAL $REMOTE`**在指定此选项时运行。

例如，这就是[`gitk`能够运行/使用任何`diff`工具](http://git.661346.n2.nabble.com/PATCH-gitk-Use-git-difftool-for-external-diffs-td4810847.html)的方式。

* * *

## 回答 #3

> 赞同：117
> 
> 时间：2010-03-14T16:28:42.500

试试这个解决方案：

```
$ meld my_project_using_git 
```

[Meld](http://meldmerge.org/)了解 Git 并提供围绕最近更改的导航。

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2009-08-27T09:39:30.063

使用新的 git *difftool*，只需将其添加到您的*.gitconfig*文件中即可：

```
[diff]
    tool = any-name
[difftool "any-name"]
    cmd = "\"C:/path/to/my/ext/diff.exe\" \"$LOCAL\" \"$REMOTE\"" 
```

（可选）还添加：

```
[difftool]
    prompt = false 
```

[另请查看***diffall***](https://stackoverflow.com/questions/1220309/git-difftool-open-all-diff-files-immediately-not-in-serial/1291578#1291578)，这是我编写的一个简单脚本，用于扩展令人讨厌的（IMO）默认差异行为，即以串行方式打开每个。

Windows 上的全局 .gitconfig 位于`%USERPROFILE%\.gitconfig`

* * *

## 回答 #5

> 赞同：43
> 
> 时间：2009-05-23T11:37:18.927

从 Git 版本 1.6.3 开始，您可以配置“ **[git difftool](http://schacon.github.com/git/git-difftool.html "git-difftool - 使用常见的差异工具显示更改")** ”以使用您最喜欢的图形差异工具。

当前支持（在撰写此答案时）开箱即用的是*[KDiff3](http://kdiff3.sourceforge.net/)、[Kompare](https://apps.kde.org/kompare/)、[tkdiff](https://tkdiff.sourceforge.io/)、[Meld](http://meldmerge.org/)、[xxdiff](http://furius.ca/xxdiff/)、emerge 、 vimdiff 、 gvimdiff 、 ecmerge 、[Diffuse](http://diffuse.sourceforge.net/index.html)*和*opendiff*；如果您要使用的工具不在此列表中，您可以随时使用 ' `difftool.<tool>.cmd`' 配置选项。

“git difftool”接受与“git diff”相同的选项。

* * *

## 回答 #6

> 赞同：25
> 
> 时间：2011-02-03T00:16:47.537

我对此有一个补充。我喜欢定期使用不支持作为默认工具之一的差异应用程序（例如万花筒），通过

```
git difftool -t 
```

我也喜欢将默认值设置`diff`为常规命令行，因此设置`GIT_EXTERNAL_DIFF`变量不是一个选项。

`diff`您可以使用以下命令一次性使用任意应用程序：

```
git difftool --extcmd=/usr/bin/ksdiff 
```

它只是将 2 个文件传递给您指定的命令，因此您可能也不需要包装器。

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2010-11-07T07:12:50.220

基于[VonC](https://stackoverflow.com/questions/255202/how-do-i-view-git-diff-output-with-my-preferred-diff-tool-viewer/255212#255212)处理文件删除和添加的答案，使用以下命令和脚本：

```
git config --global diff.tool winmerge
git config --global difftool.winmerge.cmd "winmerge.sh \"$LOCAL\" \"$REMOTE\" \"$BASE\""
git config --global difftool.prompt false 
```

这与将其放入全局文件*.gitconfig 相同*：

```
[diff]
    tool = winmerge
[difftool "winmerge"]
    cmd = winmerge.bat "$LOCAL" "$REMOTE" "$BASE"
[difftool]
    prompt = false 
```

然后将以下内容放入文件*winmerge.sh*中，该文件必须位于您的路径中：

```
#!/bin/sh
NULL="/dev/null"
if [ "$2" = "$NULL" ] ; then
    echo "removed: $3"
elif [ "$1" = "$NULL" ] ; then
    echo "added: $3"
else
    echo "changed: $3"
    "C:/Program Files (x86)/WinMerge/WinMergeU.exe" -e -ub -dl "Base" -dr "Mine" "$1" "$2"
fi 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2009-02-21T19:10:35.320

## Windows/ [MSYS](https://en.wikipedia.org/wiki/MinGW#History) Git解决方案

阅读答案后，我发现了一种更简单的方法，即只更改一个文件。

1.  使用参数 2 和 5 创建一个批处理文件来调用您的 diff 程序。该文件必须在您的路径中的某个位置。（如果您不知道它在哪里，请将其放在*C:\windows*中。）例如，将其称为“gitdiff.bat”。我的是：

    ```
    @echo off
    REM This is gitdiff.bat
    "C:\Program Files\WinMerge\WinMergeU.exe" %2 %5 
    ```

2.  将环境变量设置为指向您的批处理文件。例如：`GIT_EXTERNAL_DIFF=gitdiff.bat`。或通过 PowerShell 键入`git config --global diff.external gitdiff.bat`.

    重要的是不要使用引号或指定任何路径信息，否则它将不起作用。这就是为什么*gitdiff.bat*必须在你的路径中。

现在，当您键入“git diff”时，它将调用您的外部差异查看器。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2010-03-30T17:42:42.490

如果您通过[Cygwin](https://en.wikipedia.org/wiki/Cygwin)执行此操作，则可能需要使用**cygpath**：

```
$ git config difftool.bc3.cmd "git-diff-bcomp-wrapper.sh \$LOCAL \$REMOTE"
$ cat git-diff-bcomp-wrapper.sh
#!/bin/sh
"c:/Program Files (x86)/Beyond Compare 3/BComp.exe" `cygpath -w $1` `cygpath -w $2` 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2017-06-20T22:09:46.750

在查看了其他一些外部差异工具后，我发现`diff`IntelliJ IDEA（和 Android Studio）中的视图对我来说是最好的。

# 第 1 步 - 设置 IntelliJ IDEA 以从命令行运行

[如果您想使用 IntelliJ IDEA 作为您的差异工具，您应该首先设置 IntelliJ IDEA，以便按照此处](https://www.jetbrains.com/help/idea/running-intellij-idea-as-a-diff-or-merge-command-line-tool.html)的说明从命令行运行：

**在 macOS 或 UNIX 上：**

1.  确保 IntelliJ IDEA 正在运行。
2.  在主菜单上，选择`Tools | Create Command-line Launcher`。创建启动器脚本对话框打开，其中包含启动器脚本的建议路径和名称。您可以接受默认值，也可以指定自己的路径。请注意它，因为稍后您将需要它。在 IntelliJ IDEA 之外，将启动器脚本的路径和名称添加到您的路径中。

**在 Windows 上：**

1.  在 Path 系统环境变量中指定 IntelliJ IDEA 可执行文件的位置。在这种情况下，您将能够从任何目录调用 IntelliJ IDEA 可执行文件和其他 IntelliJ IDEA 命令。

# 第 2 步 - 配置 git 以使用 IntelliJ IDEA 作为 difftool

[按照此博客文章](http://brian.pontarelli.com/2013/10/25/using-idea-for-git-merging-and-diffing/)中的说明进行操作：

**重击**

```
export INTELLIJ_HOME /Applications/IntelliJ\ IDEA\ CE.app/Contents/MacOS
PATH=$IDEA_HOME $PATH 
```

**鱼**

```
set INTELLIJ_HOME /Applications/IntelliJ\ IDEA\ CE.app/Contents/MacOS
set PATH $INTELLIJ_HOME $PATH 
```

现在将以下内容添加到您的 git 配置中：

```
[merge]
   tool = intellij
[mergetool "intellij"]
   cmd = idea merge $(cd $(dirname "$LOCAL") && pwd)/$(basename "$LOCAL") $(cd $(dirname "$REMOTE") && pwd)/$(basename "$REMOTE") $(cd $(dirname "$BASE") && pwd)/$(basename "$BASE") $(cd $(dirname "$MERGED") && pwd)/$(basename "$MERGED")
   trustExitCode = true
[diff]
   tool = intellij
[difftool "intellij"]
   cmd = idea diff $(cd $(dirname "$LOCAL") && pwd)/$(basename "$LOCAL") $(cd $(dirname "$REMOTE") && pwd)/$(basename "$REMOTE") 
```

您可以尝试使用`git difftool`或`git difftool HEAD~1`

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2012-02-02T21:26:34.793

这适用于我在 Windows 7 上。不需要中间*[sh](https://en.wikipedia.org/wiki/Bourne_shell)*脚本

.gitconfig 的内容：

```
 [diff]
      tool = kdiff3

    [difftool]
       prompt = false

    [difftool "kdiff3"]
      path = C:/Program Files (x86)/KDiff3/kdiff3.exe
      cmd = "$LOCAL" "$REMOTE" 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2014-11-04T10:36:46.460

对以前的好答案的简短总结：

```
git difftool --tool-help
git config --global diff.tool <chosen tool>
git config --global --add difftool.prompt false 
```

然后通过键入（也可以指定文件名）来使用它：

```
git difftool 
```

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2008-12-25T15:44:25.967

## 介绍

作为参考，我想包括我对[VonC 的回答的](https://stackoverflow.com/questions/255202/how-do-i-view-git-diff-output-with-my-preferred-diff-tool-viewer/255212#255212)变体。请记住，我使用的是 MSys 版本的 Git（此时为 1.6.0.2）并修改了 PATH，并从 PowerShell（或 cmd.exe）而不是 Bash shell 运行 Git 本身。

我引入了一个新命令，`gitdiff`. 运行此命令会临时重定向`git diff`以使用您选择的可视差异程序（与 VonC 永久执行此操作的解决方案相反）。这使我可以同时拥有默认的 Git 差异功能 ( `git diff`) 和视觉差异功能 ( `gitdiff`)。两个命令都采用相同的参数，例如，为了直观地区分特定文件中的更改，您可以键入

```
gitdiff path/file.txt 
```

## 设置

请注意，`$GitInstall`它用作安装 Git 的目录的占位符。

1.  创建一个新文件，`$GitInstall\cmd\gitdiff.cmd`

    ```
     @echo off
     setlocal
     for /F "delims=" %%I in ("%~dp0..") do @set path=%%~fI\bin;%%~fI\mingw\bin;%PATH%
     if "%HOME%"=="" @set HOME=%USERPROFILE%
     set GIT_EXTERNAL_DIFF=git-diff-visual.cmd
     set GIT_PAGER=cat
     git diff %*
     endlocal 
    ```

2.  创建一个新文件，`$GitInstall\bin\git-diff-visual.cmd`（用`[visual_diff_exe]`您选择的 diff 程序的完整路径替换占位符）

    ```
     @echo off
     rem diff is called by git with 7 parameters:
     rem path old-file old-hex old-mode new-file new-hex new-mode
     echo Diffing "%5"
     "[visual_diff_exe]" "%2" "%5"
     exit 0 
    ```

3.  你现在完成了。从 Git 存储库中运行`gitdiff`现在应该为每个更改的文件调用您的可视差异程序。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2009-04-09T02:21:04.757

这是一个适用于 Windows 的批处理文件 - 假设 DiffMerge 安装在默认位置，处理 x64，根据需要处理正反斜杠替换，并且能够自行安装。应该很容易用您最喜欢的差异程序替换 DiffMerge。

安装：

```
gitvdiff --install 
```

gitvdiff.bat：

```
@echo off

REM ---- Install? ----
REM To install, run gitvdiff --install

if %1==--install goto install

REM ---- Find DiffMerge ----

if DEFINED ProgramFiles^(x86^) (
    Set DIFF="%ProgramFiles(x86)%\SourceGear\DiffMerge\DiffMerge.exe"
) else (
    Set DIFF="%ProgramFiles%\SourceGear\DiffMerge\DiffMerge.exe"
)

REM ---- Switch forward slashes to back slashes ----

set oldW=%2
set oldW=%oldW:/=\%
set newW=%5
set newW=%newW:/=\%

REM ---- Launch DiffMerge ----

%DIFF% /title1="Old Version" %oldW% /title2="New Version" %newW%

goto :EOF

REM ---- Install ----
:install
set selfL=%~dpnx0
set selfL=%selfL:\=/%
@echo on
git config --global diff.external %selfL%
@echo off

:EOF 
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2011-09-04T09:03:16.483

如果您在 Mac 上并且安装了[Xcode](https://en.wikipedia.org/wiki/Xcode)，那么您已经安装了[FileMerge](https://en.wikipedia.org/wiki/Apple_Developer_Tools#FileMerge)。终端命令是 opendiff，所以你可以这样做：

```
git difftool -t opendiff 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2015-09-19T01:46:02.760

安装[融合](http://meldmerge.org/)：

```
 # apt-get install meld 
```

然后选择它作为 difftool：

```
 $ git config --global diff.tool meld 
```

如果要在控制台中运行它，请键入：

```
 $ git difftool 
```

如果要使用图形模式，请键入：

```
 $ git mergetool 
```

输出将是：

```
 'git mergetool' will now attempt to use one of the following tools:
 meld opendiff kdiff3 tkdiff xxdiff tortoisemerge gvimdiff diffuse
 diffmerge ecmerge p4merge araxis bc3 codecompare emerge vimdiff
 Merging:
 www/css/style.css
 www/js/controllers.js

 Normal merge conflict for 'www/css/style.css':
   {local}: modified file
   {remote}: modified file
 Hit return to start merge resolution tool (meld): 
```

所以只需按下`Enter`使用融合（默认）。这将打开图形模式。进行魔法保存并按下解决合并的按钮。就这样。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2009-10-22T13:28:44.330

对于如何在 1.6.3 之前的 Git 版本上配置差异工具的 Linux 版本（1.6.3 将差异工具添加到 Git），[这](http://technotales.wordpress.com/2009/05/17/git-diff-with-vimdiff/)是一个很棒的简明教程。

简单来说：

第 1 步：将其添加到您的 .gitconfig

```
[diff]
  external = git_diff_wrapper
[pager]
  diff = 
```

第 2 步：创建一个名为 git_diff_wrapper 的文件，将其放在 $PATH 中的某个位置

```
#!/bin/sh

vimdiff "$2" "$5" 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2016-05-09T06:52:18.877

在 Mac OS X 上，

```
git difftool -t diffuse 
```

在 Git 文件夹中为我完成这项工作。对于安装[Diffuse](http://diffuse.sourceforge.net/index.html)，可以使用端口 -

```
sudo port install diffuse 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2013-12-06T11:23:01.463

您可以使用`git difftool`.

例如，如果你有[Meld](http://meldmerge.org/)，你可以编辑分支`master`并`devel`通过：

```
git config --global diff.external meld
git difftool master..devel 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2018-12-18T17:01:29.657

以下可以从这里的其他答案中收集到，但对我来说这很困难（信息太多），所以这里是 tkdiff 的“只需输入”答案：

```
git difftool --tool=tkdiff <path to the file to be diffed> 
```

你可以用你最喜欢的 diffing 工具的可执行文件名替换 tkdiff。只要（例如 tkdiff），（或您最喜欢的差异工具）在您的 PATH 中，它就会被启动。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2013-12-05T00:26:25.557

我在这里尝试了花哨的东西（使用 tkdiff），但对我没有任何用处。所以我写了下面的脚本，tkgitdiff。它做我需要它做的事情。

```
$ cat tkgitdiff
#!/bin/sh

#
# tkdiff for git.
# Gives you the diff between HEAD and the current state of your file.
#

newfile=$1
git diff HEAD -- $newfile > /tmp/patch.dat
cp $newfile /tmp
savedPWD=$PWD
cd /tmp
patch -R $newfile < patch.dat
cd $savedPWD
tkdiff /tmp/$newfile $newfile 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2010-02-15T17:33:30.977

我在 Ubuntu 上使用[Kompare ：](https://en.wikipedia.org/wiki/Kompare)

```
sudo apt-get install kompare 
```

比较两个分支：

```
git difftool -t kompare <my_branch> master 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2013-07-11T07:36:25.677

我已经在文件`~/.gitconfig`中使用这个位很长时间了：

```
[diff]
    external = ~/Dropbox/source/bash/git-meld 
```

与`git-meld`：

```
#!/bin/bash
if [ "$DISPLAY" = "" ];
then
    diff $2 $5
else
    meld $2 $5
fi 
```

但是现在我厌倦了总是在图形环境中使用[Meld](http://meldmerge.org/)，并且使用这个设置调用普通的差异并不是一件容易的事，所以我切换到了这个：

```
[alias]
    v =  "!sh -c 'if [ $# -eq 0 ] ; then git difftool -y -t meld ; else git difftool -y $@ ; fi' -" 
```

使用此设置，类似这样的工作：

```
git v
git v --staged
git v -t kompare
git v --staged -t tkdiff 
```

而且我仍然可以保持良好的旧状态`git diff`。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2010-10-01T07:29:17.830

您可能想尝试[xd](http://github.com/jiqingtang/xd)，它是 Git/SVN diff 的 GUI 包装器。它本身*不是*差异工具。

`xd`当你想运行`git diff`时运行`svn diff`，它会显示一个文件列表，一个预览窗口，你可以启动任何你喜欢的 diff 工具，包括 tkdiff，xxdiff，gvimdiff，Emacs (ediff)，[XEmacs](https://en.wikipedia.org/wiki/XEmacs) (ediff)，[Meld](http://meldmerge.org/)，[漫反射](http://diffuse.sourceforge.net/index.html)、[Kompare](https://en.wikipedia.org/wiki/Kompare)和[KDiff3](http://kdiff3.sourceforge.net/)。您还可以运行任何自定义工具。

不幸的是，该工具不支持 Windows。

**披露**：我是这个工具的作者。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2014-01-28T20:31:36.303

如果您碰巧已经有一个与文件类型关联的差异工具（例如，因为您安装了带有差异查看器的 TortoiseSVN），您可以将常规`git diff`输出通过管道传输到“临时”文件，然后直接打开该文件而无需知道关于观众的任何事情：

```
git diff > "~/temp.diff" && start "~/temp.diff" 
```

将其设置为全局别名效果更好：`git what`

```
[alias]
    what = "!f() { git diff > "~/temp.diff" && start "~/temp.diff"; }; f" 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2016-01-11T14:58:17.600

如果您不是命令行用户，那么如果您安装[TortoiseGit](https://en.wikipedia.org/wiki/TortoiseGit)，您可以右键单击文件以获取带有“Diff later”选项的 TortoiseGit 子菜单。

当你在第一个文件上选择它时，你可以右键单击第二个文件，进入 TortoiseGit 子菜单并选择“Diff with ==yourfilehere==”。这将为结果提供 TortoiseGit 合并 GUI。

# design-patterns - 什么时候应该使用访问者设计模式？

> ID：255214
> 
> 赞同：331
> 
> 时间：2008-10-31T23:04:18.887
> 
> 标签：design-patterns, visitor-pattern

我一直在博客中看到对访问者模式的引用，但我不得不承认，我就是不明白。我阅读了[该模式的维基百科文章，](http://en.wikipedia.org/wiki/Visitor_pattern)并且了解它的机制，但我仍然对何时使用它感到困惑。

作为一个最近才真正**获得**装饰器模式并且现在在任何地方都看到它的用途的人，我希望能够真正直观地理解这个看似方便的模式。

* * *

## 回答 #1

> 赞同：323
> 
> 时间：2008-11-01T00:11:54.537

我对访客模式不是很熟悉。让我们看看我是否正确。假设你有一个动物等级

```
class Animal {  };
class Dog: public Animal {  };
class Cat: public Animal {  }; 
```

（假设它是一个具有完善接口的复杂层次结构。）

现在我们要在层次结构中添加一个新操作，即我们希望每只动物都发出声音。就层次结构如此简单而言，您可以使用直接多态性来做到这一点：

```
class Animal
{ public: virtual void makeSound() = 0; };

class Dog : public Animal
{ public: void makeSound(); };

void Dog::makeSound()
{ std::cout << "woof!\n"; }

class Cat : public Animal
{ public: void makeSound(); };

void Cat::makeSound()
{ std::cout << "meow!\n"; } 
```

但是以这种方式进行，每次要添加操作时，都必须修改层次结构中每个类的接口。现在，假设您对原始界面感到满意，并且希望对其进行尽可能少的修改。

访问者模式允许您将每个新操作移动到合适的类中，并且您只需扩展层次结构的接口一次。我们开始做吧。[首先，我们定义了一个抽象操作（ GoF](https://en.wikipedia.org/wiki/Design_Patterns)中的“Visitor”类），它对层次结构中的每个类都有一个方法：

```
class Operation
{
public:
    virtual void hereIsADog(Dog *d) = 0;
    virtual void hereIsACat(Cat *c) = 0;
}; 
```

然后，我们修改层次结构以接受新操作：

```
class Animal
{ public: virtual void letsDo(Operation *v) = 0; };

class Dog : public Animal
{ public: void letsDo(Operation *v); };

void Dog::letsDo(Operation *v)
{ v->hereIsADog(this); }

class Cat : public Animal
{ public: void letsDo(Operation *v); };

void Cat::letsDo(Operation *v)
{ v->hereIsACat(this); } 
```

最后，我们实现实际操作，*既不修改 Cat 也不修改 Dog*：

```
class Sound : public Operation
{
public:
    void hereIsADog(Dog *d);
    void hereIsACat(Cat *c);
};

void Sound::hereIsADog(Dog *d)
{ std::cout << "woof!\n"; }

void Sound::hereIsACat(Cat *c)
{ std::cout << "meow!\n"; } 
```

现在您可以在不修改层次结构的情况下添加操作。下面是它的工作原理：

```
int main()
{
    Cat c;
    Sound theSound;
    c.letsDo(&theSound);
} 
```

* * *

## 回答 #2

> 赞同：137
> 
> 时间：2008-10-31T23:09:36.847

您感到困惑的原因可能是访客是一个致命的误称。许多（突出的¹！）程序员都偶然发现了这个问题。它实际上做的是在本机不支持它的语言中实现[双重调度](http://en.wikipedia.org/wiki/Double_dispatch)（大多数不支持）。

* * *

^(1))我最喜欢的例子是著名的“Effective C++”作者 Scott Meyers，他称这是他[最重要的 C++ 之一啊哈！*永远的*](http://www.artima.com/cppsource/top_cpp_aha_moments.html)[时刻](http://www.artima.com/cppsource/top_cpp_aha_moments.html)。

* * *

## 回答 #3

> 赞同：91
> 
> 时间：2009-01-26T02:00:56.507

这里的每个人都是正确的，但我认为它无法解决“何时”。首先，从设计模式：

> Visitor 允许您定义一个新的操作，而无需更改它所操作的元素的类。

现在，让我们考虑一个简单的类层次结构。我有 1、2、3 和 4 类以及方法 A、B、C 和 D。像在电子表格中一样布置它们：类是行，方法是列。

现在，面向对象的设计假定您更可能生成新类而不是新方法，因此可以说添加更多行更容易。您只需添加一个新类，指定该类中的不同之处，然后继承其余部分。

不过，有时类是相对静态的，但您需要经常添加更多方法——添加列。OO 设计中的标准方法是将此类方法添加到所有类中，这可能会很昂贵。访问者模式使这很容易。

顺便说一句，这就是 Scala 的模式匹配想要解决的问题。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-11-01T02:44:57.427

**访问者**设计模式非常适用于“递归”结构，如目录树、XML 结构或文档大纲。

访问者对象访问递归结构中的每个节点：每个目录、每个 XML 标记等等。访问者对象不会循环遍历结构。相反，Visitor 方法应用于结构的每个节点。

这是一个典型的递归节点结构。可以是目录或 XML 标记。[如果你是一个 Java 人，想象一下有很多额外的方法来构建和维护子列表。]

```
class TreeNode( object ):
    def __init__( self, name, *children ):
        self.name= name
        self.children= children
    def visit( self, someVisitor ):
        someVisitor.arrivedAt( self )
        someVisitor.down()
        for c in self.children:
            c.visit( someVisitor )
        someVisitor.up() 
```

该`visit`方法将一个访问者对象应用于结构中的每个节点。在这种情况下，它是一个自上而下的访问者。您可以更改`visit`方法的结构以进行自下而上或其他一些排序。

这是访问者的超类。它被`visit`方法使用。它“到达”结构中的每个节点。由于该`visit`方法调用`up`and `down`，因此访问者可以跟踪深度。

```
class Visitor( object ):
    def __init__( self ):
        self.depth= 0
    def down( self ):
        self.depth += 1
    def up( self ):
        self.depth -= 1
    def arrivedAt( self, aTreeNode ):
        print self.depth, aTreeNode.name 
```

一个子类可以做一些事情，比如计算每个级别的节点并累积一个节点列表，生成一个很好的路径分层节号。

这是一个应用程序。它构建了一个树结构，`someTree`. 它创建一个`Visitor`, `dumpNodes`。

然后它将 应用于`dumpNodes`树。该`dumpNode`对象将“访问”树中的每个节点。

```
someTree= TreeNode( "Top", TreeNode("c1"), TreeNode("c2"), TreeNode("c3") )
dumpNodes= Visitor()
someTree.visit( dumpNodes ) 
```

TreeNode`visit`算法将确保每个 TreeNode 都用作访问者`arrivedAt`方法的参数。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2008-10-31T23:13:05.217

一种看待它的方法是，访问者模式是一种让您的客户向特定类层次结构中的所有类添加附加方法的方法。

当您有一个相当稳定的类层次结构时，它很有用，但是您对该层次结构需要做什么的要求不断变化。

经典的例子是编译器等。抽象语法树 (AST) 可以准确地定义编程语言的结构，但是您可能希望在 AST 上执行的操作会随着项目的进展而改变：代码生成器、漂亮打印机、调试器、复杂性度量分析。

如果没有访问者模式，每次开发人员想要添加新功能时，他们都需要将该方法添加到基类中的每个功能中。当基类出现在单独的库中或由单独的团队生产时，这尤其困难。

（我听说访问者模式与良好的 OO 实践相冲突，因为它将数据的操作从数据中移开。访问者模式恰好在正常的 OO 实践失败的情况下很有用。）

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2017-12-25T12:47:54.507

双分派只是**使用这种模式的原因之一**。
但请注意，这是在使用单一分派范式的语言中实现双重或多重分派的单一方法。

以下是使用该模式的原因：

1）**我们希望定义新的操作而不每次都改变模型，**因为模型不会经常改变，而操作会经常改变。

2)**我们不想耦合模型和行为**，因为**我们希望**在多个应用程序中拥有一个可重用的模型，或者**我们希望拥有一个**允许客户端类使用它们自己的类定义它们的行为的可扩展模型。

3）我们有取决于模型的具体类型的通用操作，但**我们不想在每个子类中实现逻辑，因为这会在多个类中以及在多个地方爆炸通用逻辑**。

4）我们正在使用域模型设计，并且**相同层次结构的模型类执行了太多不同的事情，这些事情可以在其他地方收集**。

5)**我们需要双重调度**。
我们有使用接口类型声明的变量，并且我们希望能够根据它们的运行时类型来处理它们……当然不需要使用`if (myObj instanceof Foo) {}`或任何技巧。
例如，这个想法是将这些变量传递给将接口的具体类型声明为参数的方法，以应用特定的处理。这种方式不可能开箱即用，因为语言依赖于单一调度，因为在运行时调用的选择仅取决于接收器的运行时类型。
请注意，在 Java 中，要调用的方法（签名）是在编译时选择的，它取决于参数的声明类型，而不是它们的运行时类型。

最后一点是使用访问者的原因也是一个结果，因为当您实现访问者时（当然对于不支持多分派的语言），您必然需要引入双分派实现。

请注意，遍历元素（迭代）以将访问者应用于每个元素并不是使用该模式的理由。
您使用模式是因为您拆分了模型和处理。
通过使用该模式，您还可以从迭代器能力中受益。
这种能力非常强大，超越了使用特定方法对通用类型进行迭代`accept()`的泛型方法。
这是一个特殊的用例。所以我会把它放在一边。

* * *

**Java 中的示例**

我将通过一个国际象棋示例来说明该模式的附加价值，在该示例中，我们希望将处理定义为玩家请求移动棋子。

如果不使用访问者模式，我们可以直接在碎片子类中定义碎片移动行为。
例如，我们可以有一个`Piece`接口，例如：

```
public interface Piece{

    boolean checkMoveValidity(Coordinates coord);

    void performMove(Coordinates coord);

    Piece computeIfKingCheck();

} 
```

每个 Piece 子类都会实现它，例如：

```
public class Pawn implements Piece{

    @Override
    public boolean checkMoveValidity(Coordinates coord) {
        ...
    }

    @Override
    public void performMove(Coordinates coord) {
        ...
    }

    @Override
    public Piece computeIfKingCheck() {
        ...
    }

} 
```

对于所有 Piece 子类也是如此。
这是一个说明此设计的图表类：

[![【模型类图](https://i.stack.imgur.com/5pQTS.jpg)](https://i.stack.imgur.com/5pQTS.jpg)

这种方法存在三个重要缺点：

– 诸如`performMove()`或`computeIfKingCheck()`将很可能使用通用逻辑的行为。
例如，无论具体是什么`Piece`，`performMove()`最终都会将当前棋子设置到特定位置，并可能拿走对手棋子。
在多个类中拆分相关行为而不是收集它们在某种程度上破坏了单一责任模式。使它们的可维护性更难。

– 处理 as`checkMoveValidity()`不应该是`Piece`子类可能看到或改变的东西。
它是超越人类或计算机行为的检查。该检查在玩家请求的每个动作中执行，以确保请求的棋子移动有效。
所以我们甚至不想在`Piece`界面中提供它。

– 在对 bot 开发者具有挑战性的国际象棋游戏中，通常应用程序提供标准的 API（`Piece`接口、子类、Board、常见行为等），并让开发者丰富他们的 bot 策略。
为了能够做到这一点，我们必须提出一个模型，其中数据和行为在`Piece`实现中不是紧密耦合的。

所以让我们使用访问者模式吧！

我们有两种结构：

– 接受访问的模型类（碎片）

– 访问他们的访客（移动操作）

这是一个说明该模式的类图：

[![在此处输入图像描述](https://i.stack.imgur.com/2GtFI.jpg)](https://i.stack.imgur.com/2GtFI.jpg)

上半部分是访问者，下半部分是模型类。

这是`PieceMovingVisitor`接口（为每种指定的行为`Piece`）：

```
public interface PieceMovingVisitor {

    void visitPawn(Pawn pawn);

    void visitKing(King king);

    void visitQueen(Queen queen);

    void visitKnight(Knight knight);

    void visitRook(Rook rook);

    void visitBishop(Bishop bishop);

} 
```

现在定义了 Piece：

```
public interface Piece {

    void accept(PieceMovingVisitor pieceVisitor);

    Coordinates getCoordinates();

    void setCoordinates(Coordinates coordinates);

} 
```

它的关键方法是：

```
void accept(PieceMovingVisitor pieceVisitor); 
```

它提供了第一个调度：基于`Piece`接收者的调用。
在编译时，方法绑定到`accept()`Piece 接口的方法，在运行时，绑定的方法将在运行时`Piece`类上调用。
它将执行第二次分派的是`accept()`方法实现。

实际上，每个`Piece`想要被对象访问的子类都会通过作为参数本身传递来`PieceMovingVisitor`调用该方法。 这样，编译器在编译时就将声明参数的类型与具体类型绑定。 有第二次派遣。 这是说明这一点的子类：`PieceMovingVisitor.visit()`

`Bishop`

```
public class Bishop implements Piece {

    private Coordinates coord;

    public Bishop(Coordinates coord) {
        super(coord);
    }

    @Override
    public void accept(PieceMovingVisitor pieceVisitor) {
        pieceVisitor.visitBishop(this);
    }

    @Override
    public Coordinates getCoordinates() {
        return coordinates;
    }

   @Override
    public void setCoordinates(Coordinates coordinates) {
        this.coordinates = coordinates;
   }

} 
```

这里有一个用法示例：

```
// 1\. Player requests a move for a specific piece
Piece piece = selectPiece();
Coordinates coord = selectCoordinates();

// 2\. We check with MoveCheckingVisitor that the request is valid
final MoveCheckingVisitor moveCheckingVisitor = new MoveCheckingVisitor(coord);
piece.accept(moveCheckingVisitor);

// 3\. If the move is valid, MovePerformingVisitor performs the move
if (moveCheckingVisitor.isValid()) {
    piece.accept(new MovePerformingVisitor(coord));
} 
```

**访客缺点**

访问者模式是一种非常强大的模式，但它也有一些重要的限制，您应该在使用它之前考虑这些限制。

**1) 减少/破坏封装的风险**

在某些操作中，访问者模式可能会减少或破坏域对象的封装。

例如，当`MovePerformingVisitor` 类需要设置实际块的坐标时，`Piece`接口必须提供一种方法来做到这一点：

```
void setCoordinates(Coordinates coordinates); 
```

坐标更改的责任`Piece`现在对子类以外的其他类开放`Piece`。
在子类中移动访问者执行的处理`Piece`也不是一种选择。当接受任何访问者实现
时，它确实会产生另一个问题。`Piece.accept()`它不知道访问者执行了什么操作，因此不知道是否以及如何更改 Piece 状态。
一种识别访问者的方法是`Piece.accept()`根据访问者实现执行后处理。这将是一个非常糟糕的主意，因为它会在 Visitor 实现和 Piece 子类之间创建高度耦合，此外它可能需要使用技巧 as`getClass()`或`instanceof`任何标识 Visitor 实现的标记。

**2) 需要改变模型**

与其他一些行为设计模式相反，`Decorator`例如，访问者模式是侵入性的。
我们确实需要修改初始接收器类以提供`accept()`接受访问的方法。
我们没有任何问题`Piece`及其子类，因为这些是**我们的类**。
在内置或第三方类中，事情并不那么容易。
我们需要包装或继承（如果可以的话）它们以添加`accept()`方法。

**3）间接**

该模式创建多个间接。
双重调度意味着两次调用而不是一次调用：

```
call the visited (piece) -> that calls the visitor (pieceMovingVisitor) 
```

当访问者改变访问对象状态时，我们可以有额外的间接。
它可能看起来像一个循环：

```
call the visited (piece) -> that calls the visitor (pieceMovingVisitor) -> that calls the visited (piece) 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2013-08-08T09:44:37.647

使用访问者模式至少有三个很好的理由：

1.  减少仅在数据结构发生变化时略有不同的代码的扩散。

2.  将相同的计算应用于多个数据结构，而无需更改实现计算的代码。

3.  在不更改遗留代码的情况下向遗留库添加信息。

请看一下[我写的一篇关于这个的文章](http://rgomes-info.blogspot.com/2013/01/a-better-implementation-of-visitor.html)。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2016-07-13T02:58:08.057

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2014-07-06T12:47:39.377

我发现以下链接更容易：

在 [http://www.remondo.net/visitor-pattern-example-csharp/](http://web.archive.org/web/20120618142236/http://www.remondo.net/visitor-pattern-example-csharp/)中，我找到了一个示例，该示例显示了一个模拟示例，该示例显示了访问者模式的好处。在这里，您有不同的容器类`Pill`：

```
namespace DesignPatterns
{
    public class BlisterPack
    {
        // Pairs so x2
        public int TabletPairs { get; set; }
    }

    public class Bottle
    {
        // Unsigned
        public uint Items { get; set; }
    }

    public class Jar
    {
        // Signed
        public int Pieces { get; set; }
    }
} 
```

正如您在上面看到的，您`BilsterPack`包含成对的药丸，因此您需要将成对的数量乘以 2。此外，您可能会注意到`Bottle`使用`unit`不同的数据类型并且需要强制转换。

因此，在 main 方法中，您可以使用以下代码计算药丸数：

```
foreach (var item in packageList)
{
    if (item.GetType() == typeof (BlisterPack))
    {
        pillCount += ((BlisterPack) item).TabletPairs * 2;
    }
    else if (item.GetType() == typeof (Bottle))
    {
        pillCount += (int) ((Bottle) item).Items;
    }
    else if (item.GetType() == typeof (Jar))
    {
        pillCount += ((Jar) item).Pieces;
    }
} 
```

请注意，上面的代码违反了`Single Responsibility Principle`. 这意味着如果添加新类型的容器，则必须更改 main 方法代码。延长开关时间也是不好的做法。

所以通过引入以下代码：

```
public class PillCountVisitor : IVisitor
{
    public int Count { get; private set; }

    #region IVisitor Members

    public void Visit(BlisterPack blisterPack)
    {
        Count += blisterPack.TabletPairs * 2;
    }

    public void Visit(Bottle bottle)
    {
        Count += (int)bottle.Items;
    }

    public void Visit(Jar jar)
    {
        Count += jar.Pieces;
    }

    #endregion
} 
```

您将计算 s 数量的责任转移`Pill`到了名为的类`PillCountVisitor`（并且我们删除了 switch case 语句）。这意味着每当您需要添加新类型的药丸容器时，您应该只更改`PillCountVisitor`类。还要注意`IVisitor`接口是通用的，用于其他场景。

通过将 Accept 方法添加到药丸容器类：

```
public class BlisterPack : IAcceptor
{
    public int TabletPairs { get; set; }

    #region IAcceptor Members

    public void Accept(IVisitor visitor)
    {
        visitor.Visit(this);
    }

    #endregion
} 
```

我们允许访客参观药丸容器课程。

最后，我们使用以下代码计算药丸数：

```
var visitor = new PillCountVisitor();

foreach (IAcceptor item in packageList)
{
    item.Accept(visitor);
} 
```

这意味着：每个药丸容器都可以让`PillCountVisitor`访客看到他们的药丸数量。他知道如何计算你的药丸。

在`visitor.Count`具有药丸的价值。

在 [http://butunclebob.com/ArticleS.UncleBob.IuseVisitor](http://butunclebob.com/ArticleS.UncleBob.IuseVisitor)中，您会看到无法使用[多态性](https://stackoverflow.com/questions/126409/ways-to-eliminate-switch-in-code)（答案）来遵循单一责任原则的真实场景。事实上在：

```
public class HourlyEmployee extends Employee {
  public String reportQtdHoursAndPay() {
    //generate the line for this hourly employee
  }
} 
```

该`reportQtdHoursAndPay`方法用于报告和表示，这违反了单一责任原则。所以最好使用访问者模式来解决这个问题。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2015-05-06T13:27:29.017

[Cay Horstmann在他的 OO 设计和模式一书中](http://bcs.wiley.com/he-bcs/Books?action=mininav&bcsId=2561&itemId=0471744875&assetId=73207&resourceId=6077&newwindow=true)有一个很好的例子来说明在哪里应用访问者。他总结了这个问题：

> 复合对象通常具有复杂的结构，由单个元素组成。某些元素可能再次具有子元素。...对元素的操作访问其子元素，将操作应用于它们，并组合结果。... 但是，要在这样的设计中添加新的操作并不容易。

之所以不容易，是因为操作是在结构类本身中添加的。例如，假设您有一个文件系统：

![文件系统类图](https://www.plantuml.com/plantuml/svg/LOkn3i8m44FtVCKftr5rGXsxTEqIKYDEvDBexXZozuG118jb-zdsuDgI9Y7pNZ1KEVjJIhZp0O8qxoIGAzG2LuVUKWR5QVg6UTxhmWLRDuViTJqFH4f6oxQ6N98DD_2x9fPM8AZ-I-E55TbFxP_p_-m5.svg)

以下是我们可能希望使用此结构实现的一些操作（功能）：

*   显示节点元素的名称（文件列表）
*   显示计算的节点元素的大小（其中目录的大小包括其所有子元素的大小）
*   等等

您可以向 FileSystem 中的每个类添加函数来实现操作（过去人们已经这样做了，因为它很明显如何做到这一点）。问题是，每当您添加新功能（上面的“等”行）时，您可能需要向结构类添加越来越多的方法。在某些时候，在您添加到软​​件中的一些操作之后，这些类中的方法就类的功能内聚而言不再有意义。例如，您有`FileNode`一个方法`calculateFileColorForFunctionABC()`，以便在文件系统上实现最新的可视化功能。

访问者模式（像许多设计模式一样）源于开发人员的*痛苦和痛苦*，他们知道有更好的方法可以让他们的代码更改而不需要到处进行大量更改，并且还尊重良好的设计原则（高内聚，低耦合）。我的观点是，在你感受到痛苦之前，很难理解很多模式的用处。解释痛苦（就像我们试图在上面添加的“等”功能一样）在解释中占用空间并且会分散注意力。出于这个原因，理解模式很困难。

访问者允许我们将数据结构（例如`FileSystemNodes`）上的功能与数据结构本身分离。该模式允许设计尊重内聚——数据结构类更简单（它们具有更少的方法），并且功能被封装到`Visitor`实现中。这是通过*双重调度*完成的（这是模式的复杂部分）：使用`accept()`结构类`visitX()`中的方法和访问者（功能）类中的方法：

![应用了访问者的文件系统类图](https://www.plantuml.com/plantuml/svg/ZOwn2iCm34HtVuN8r2xzWf2fPCmIo9J5TLGgQZd6LWkcvDzhboHZw2BGwVJkufESrq4pH4aMymnavCLMFMX2GFQIW95l6A8Y9nZksY1KTRqlJJEwbYpsAGhowBfvmWfqXBRluAC0j37evNHMYp9Mntp8xk82Oc-HqSc1kRfIG2DpI1lw-Ek_aWD5oiorv_23l8ksTSkiLTdpLtbH9VNIbByl.svg)

这种结构允许我们添加在结构上作为具体访问者工作的新功能（无需更改结构类）。

![应用了访问者的文件系统类图](https://www.plantuml.com/plantuml/svg/hOv12i8m44NtESNGbMuyGUbAkYn2eQjkOZhYO9AM90fL2fx6WtaI4qcBRegYcu7vy-VzRm-aEswu0kjwYNuQ4kwe9DjJWu2gSpqeL5iqbf5sQ7PS82HfEYrPLkkS99QzTQXgNRGD9i0jv6K15mR0XS3EBPPiO49owm_U7Ln0gfEeKBiPSx8cWyArfX_Hyr-VbQp8acV6djKJSWhQsCspeZBbHtbW8NMLXR_OSMDyK4I-r_kI_88hwOp_Gzwljvye3m00.svg)

例如，a`PrintNameVisitor`实现目录列表功能，a`PrintSizeVisitor`实现具有大小的版本。我们可以想象有一天有一个以 XML 格式生成数据的“ExportXMLVisitor”，或者另一个以 JSON 格式生成数据的访问者，等等。我们甚至可以让一个访问者使用[诸如 DOT 之类的图形语言](http://www.graphviz.org/doc/info/lang.html)来显示我的目录树，以进行可视化与另一个程序。

最后一点：Visitor 的双重调度的复杂性意味着它更难理解、编码和调试。简而言之，它具有很高的极客因子，并且违背了 KISS 原则。[在研究人员进行的一项调查中，Visitor 被证明是一种有争议的模式（对其有用性没有达成共识）。一些实验甚至表明它并没有使代码更易于维护。](http://www.infoq.com/articles/design-patterns-magic-or-myth)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2013-03-09T06:41:40.023

在我看来，添加新操作的工作量或多或少与使用`Visitor Pattern`或直接修改每个元素结构相同。此外，如果我要添加新的元素类，例如`Cow`，Operation 接口将受到影响，这会传播到所有现有的元素类，因此需要重新编译所有元素类。那么有什么意义呢？

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2013-06-25T22:07:33.417

访问者模式与 Aspect Object 编程的地下实现相同。

例如，如果您定义一个新操作而不更改它所操作的元素的类

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2018-02-18T16:16:50.070

**访客模式的快速描述。**需要修改的类都必须实现 'accept' 方法。客户端调用此接受方法来对该类族执行一些新操作，从而扩展它们的功能。通过为每个特定操作传入不同的访问者类，客户端可以使用这个接受方法来执行范围广泛的新操作。访问者类包含多个重写的访问方法，这些方法定义了如何为家庭中的每个类实现相同的特定操作。这些访问方法通过一个实例来工作。

**什么时候可以考虑使用它**

1.  当你有一个类族时，你知道你将不得不添加许多新的动作，但是由于某种原因，你将来不能改变或重新编译这个类族。
2.  当您想要添加一个新操作并将该新操作完全定义在一个访问者类中而不是分散在多个类中时。
3.  **当你的老板说你必须制作一系列必须立即**做某事的课程时！......但实际上没有人确切知道那是什么。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2018-11-15T08:48:52.087

直到我遇到[鲍勃叔叔的文章](http://butunclebob.com/ArticleS.UncleBob.IuseVisitor)并阅读评论时，我才理解这种模式。考虑以下代码：

```
public class Employee
{
}

public class SalariedEmployee : Employee
{
}

public class HourlyEmployee : Employee
{
}

public class QtdHoursAndPayReport
{
    public void PrintReport()
    {
        var employees = new List<Employee>
        {
            new SalariedEmployee(),
            new HourlyEmployee()
        };
        foreach (Employee e in employees)
        {
            if (e is HourlyEmployee he)
                PrintReportLine(he);
            if (e is SalariedEmployee se)
                PrintReportLine(se);
        }
    }

    public void PrintReportLine(HourlyEmployee he)
    {
        System.Diagnostics.Debug.WriteLine("hours");
    }
    public void PrintReportLine(SalariedEmployee se)
    {
        System.Diagnostics.Debug.WriteLine("fix");
    }
}

class Program
{
    static void Main(string[] args)
    {
        new QtdHoursAndPayReport().PrintReport();
    }
} 
```

虽然它看起来不错，因为它确认了[单一责任](https://docs.google.com/open?id=0ByOwmqah_nuGNHEtcU5OekdDMkk)，但它违反了[开放/封闭](http://docs.google.com/a/cleancoder.com/viewer?a=v&pid=explorer&chrome=true&srcid=0BwhCYaYDn8EgN2M5MTkwM2EtNWFkZC00ZTI3LWFjZTUtNTFhZGZiYmUzODc1&hl=en)原则。每次您有新的 Employee 类型时，您都必须添加 if 类型检查。如果你不这样做，你将永远不会在编译时知道这一点。

使用访问者模式，您可以使代码更简洁，因为它不违反开放/封闭原则，也不违反单一职责。如果您忘记执行访问，它将无法编译：

```
public abstract class Employee
{
    public abstract void Accept(EmployeeVisitor v);
}

public class SalariedEmployee : Employee
{
    public override void Accept(EmployeeVisitor v)
    {
        v.Visit(this);
    }
}

public class HourlyEmployee:Employee
{
    public override void Accept(EmployeeVisitor v)
    {
        v.Visit(this);
    }
}

public interface EmployeeVisitor
{
    void Visit(HourlyEmployee he);
    void Visit(SalariedEmployee se);
}

public class QtdHoursAndPayReport : EmployeeVisitor
{
    public void Visit(HourlyEmployee he)
    {
        System.Diagnostics.Debug.WriteLine("hourly");
        // generate the line of the report.
    }
    public void Visit(SalariedEmployee se)
    {
        System.Diagnostics.Debug.WriteLine("fix");
    } // do nothing

    public void PrintReport()
    {
        var employees = new List<Employee>
        {
            new SalariedEmployee(),
            new HourlyEmployee()
        };
        QtdHoursAndPayReport v = new QtdHoursAndPayReport();
        foreach (var emp in employees)
        {
            emp.Accept(v);
        }
    }
}

class Program
{

    public static void Main(string[] args)
    {
        new QtdHoursAndPayReport().PrintReport();
    }       
}  
} 
```

神奇的是，虽然`v.Visit(this)`看起来一样，但实际上是不同的，因为它调用了不同的访问者重载。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2016-03-28T23:48:38.713

基于@Federico A. Ramponi 的出色回答。

想象一下你有这个层次结构：

```
public interface IAnimal
{
    void DoSound();
}

public class Dog : IAnimal
{
    public void DoSound()
    {
        Console.WriteLine("Woof");
    }
}

public class Cat : IAnimal
{
    public void DoSound(IOperation o)
    {
        Console.WriteLine("Meaw");
    }
} 
```

如果你需要在这里添加一个“Walk”方法会发生什么？这对整个设计来说是痛苦的。

同时，加入“Walk”方法会产生新的问题。“吃”还是“睡”呢？我们真的必须为我们想要添加的每个新动作或操作添加一个新方法到 Animal 层次结构吗？这很丑陋，最重要的是，我们永远无法关闭 Animal 界面。因此，使用访问者模式，我们可以在不修改层次结构的情况下向层次结构添加新方法！

因此，只需检查并运行此 C# 示例：

```
using System;
using System.Collections.Generic;

namespace VisitorPattern
{
    class Program
    {
        static void Main(string[] args)
        {
            var animals = new List<IAnimal>
            {
                new Cat(), new Cat(), new Dog(), new Cat(), 
                new Dog(), new Dog(), new Cat(), new Dog()
            };

            foreach (var animal in animals)
            {
                animal.DoOperation(new Walk());
                animal.DoOperation(new Sound());
            }

            Console.ReadLine();
        }
    }

    public interface IOperation
    {
        void PerformOperation(Dog dog);
        void PerformOperation(Cat cat);
    }

    public class Walk : IOperation
    {
        public void PerformOperation(Dog dog)
        {
            Console.WriteLine("Dog walking");
        }

        public void PerformOperation(Cat cat)
        {
            Console.WriteLine("Cat Walking");
        }
    }

    public class Sound : IOperation
    {
        public void PerformOperation(Dog dog)
        {
            Console.WriteLine("Woof");
        }

        public void PerformOperation(Cat cat)
        {
            Console.WriteLine("Meaw");
        }
    }

    public interface IAnimal
    {
        void DoOperation(IOperation o);
    }

    public class Dog : IAnimal
    {
        public void DoOperation(IOperation o)
        {
            o.PerformOperation(this);
        }
    }

    public class Cat : IAnimal
    {
        public void DoOperation(IOperation o)
        {
            o.PerformOperation(this);
        }
    }
} 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2016-02-15T10:19:40.657

[游客](https://en.wikipedia.org/wiki/Visitor_pattern)

> 访问者允许在不修改类本身的情况下向类族中添加新的虚函数；相反，我们创建了一个访问者类，它实现了虚函数的所有适当的特化

访客结构：

[![在此处输入图像描述](https://i.stack.imgur.com/PpfGR.png)](https://i.stack.imgur.com/PpfGR.png)

*在以下情况下使用访客模式：*

1.  *必须对结构中分组的不同类型的对象*执行类似的操作**
**   您需要执行许多不同且不相关的操作。*它将操作与对象结构分开**   必须在不改变对象结构的情况下添加新操作*   *将相关操作收集到单个类*中，而不是强迫您更改或派生类*   *将函数添加到您没有源或无法更改源的*类库*

 **尽管*访问者*模式提供了在不更改 Object 中现有代码的情况下添加新操作的灵活性，但这种灵活性也有一个缺点。

*如果添加了新的 Visitable 对象，则需要更改 Visitor 和 ConcreteVisitor 类中的代码*。有一个解决方法可以解决这个问题：使用反射，这会对性能产生影响。

代码片段：

```
import java.util.HashMap;

interface Visitable{
    void accept(Visitor visitor);
}

interface Visitor{
    void logGameStatistics(Chess chess);
    void logGameStatistics(Checkers checkers);
    void logGameStatistics(Ludo ludo);    
}
class GameVisitor implements Visitor{
    public void logGameStatistics(Chess chess){
        System.out.println("Logging Chess statistics: Game Completion duration, number of moves etc..");    
    }
    public void logGameStatistics(Checkers checkers){
        System.out.println("Logging Checkers statistics: Game Completion duration, remaining coins of loser");    
    }
    public void logGameStatistics(Ludo ludo){
        System.out.println("Logging Ludo statistics: Game Completion duration, remaining coins of loser");    
    }
}

abstract class Game{
    // Add game related attributes and methods here
    public Game(){

    }
    public void getNextMove(){};
    public void makeNextMove(){}
    public abstract String getName();
}
class Chess extends Game implements Visitable{
    public String getName(){
        return Chess.class.getName();
    }
    public void accept(Visitor visitor){
        visitor.logGameStatistics(this);
    }
}
class Checkers extends Game implements Visitable{
    public String getName(){
        return Checkers.class.getName();
    }
    public void accept(Visitor visitor){
        visitor.logGameStatistics(this);
    }
}
class Ludo extends Game implements Visitable{
    public String getName(){
        return Ludo.class.getName();
    }
    public void accept(Visitor visitor){
        visitor.logGameStatistics(this);
    }
}

public class VisitorPattern{
    public static void main(String args[]){
        Visitor visitor = new GameVisitor();
        Visitable games[] = { new Chess(),new Checkers(), new Ludo()};
        for (Visitable v : games){
            v.accept(visitor);
        }
    }
} 
```

解释：

1.  `Visitable`( `Element`) 是一个接口，这个接口方法必须添加到一组类中。
2.  `Visitor`是一个接口，它包含对`Visitable`元素执行操作的方法。
3.  `GameVisitor`是一个类，它实现了`Visitor`接口（`ConcreteVisitor`）。
4.  每个`Visitable`元素接受`Visitor`并调用`Visitor`接口的相关方法。
5.  您可以将`Game`as`Element`和具体游戏`Chess,Checkers and Ludo`视为 as `ConcreteElements`。

在上面的例子中，`Chess, Checkers and Ludo`是三个不同的游戏（和`Visitable`类）。在一个美好的日子里，我遇到了一个记录每场比赛的统计数据的场景。因此，无需修改单个类来实现统计功能，您可以将该职责集中在`GameVisitor`类中，这样就可以为您解决问题，而无需修改每个游戏的结构。

输出：

```
Logging Chess statistics: Game Completion duration, number of moves etc..
Logging Checkers statistics: Game Completion duration, remaining coins of loser
Logging Ludo statistics: Game Completion duration, remaining coins of loser 
```

参考

[OO设计文章](http://www.oodesign.com/visitor-pattern.html)

[来源](https://sourcemaking.com/design_patterns/visitor)文章

更多细节

[装饰者](https://en.wikipedia.org/wiki/Decorator_pattern)

> 模式允许将行为静态或动态添加到单个对象，而不会影响同一类中其他对象的行为

相关文章：

[IO 的装饰器模式](https://stackoverflow.com/questions/6366385/decorator-pattern-for-io/37482635#37482635)

[何时使用装饰器模式？](https://stackoverflow.com/questions/1549743/when-to-use-the-decorator-pattern/37504043#37504043)

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2016-11-04T15:35:30.913

[我真的很喜欢http://python-3-patterns-idioms-test.readthedocs.io/en/latest/Visitor.html](http://python-3-patterns-idioms-test.readthedocs.io/en/latest/Visitor.html)中的描述和示例。

> 假设您有一个固定的主要类层次结构；也许它来自另一个供应商，您无法更改该层次结构。但是，您的意图是您想向该层次结构添加新的多态方法，这意味着通常您必须向基类接口添加一些东西。所以困境是你需要在基类中添加方法，但你不能触及基类。你如何解决这个问题？
> 
> 解决此类问题的设计模式称为“访问者”（设计模式一书中的最后一个），它建立在上一节所示的双重调度方案之上。
> 
> 访问者模式允许您通过创建一个单独的访问者类型的类层次结构来扩展主要类型的接口，以虚拟化对主要类型执行的操作。主要类型的对象只是简单地“接受”访问者，然后调用访问者的动态绑定成员函数。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-11-25T23:04:31.153

虽然我了解了如何以及何时，但我从未了解过原因。如果它对任何具有 C++ 等语言背景的人有所帮助，您需要非常仔细地[阅读本文。](https://en.wikipedia.org/wiki/Double_dispatch#Double_dispatch_is_more_than_function_overloading)

对于懒惰的人，我们使用访问者模式，因为**“在 C++ 中虚拟函数是动态调度的，而函数重载是静态完成的”**。

或者，换一种说法，确保在传入实际绑定到 ApolloSpacecraft 对象的 SpaceShip 引用时调用 CollideWith(ApolloSpacecraft&)。

```
class SpaceShip {};
class ApolloSpacecraft : public SpaceShip {};
class ExplodingAsteroid : public Asteroid {
public:
  virtual void CollideWith(SpaceShip&) {
    cout << "ExplodingAsteroid hit a SpaceShip" << endl;
  }
  virtual void CollideWith(ApolloSpacecraft&) {
    cout << "ExplodingAsteroid hit an ApolloSpacecraft" << endl;
  }
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-05-29T03:34:19.917

感谢[@Federico A. Ramponi](https://stackoverflow.com/questions/255214/when-should-i-use-the-visitor-design-pattern/50575946#50575946#answer-255300)的精彩解释，我刚刚在**java**版本中做了这个。希望它可能会有所帮助。

也正如[@Konrad Rudolph](https://stackoverflow.com/questions/255214/when-should-i-use-the-visitor-design-pattern/50575946#50575946#answer-255224)指出的那样，它实际上是使用**两个**具体实例一起确定运行时方法的**双重调度。**

 **所以实际上，只要我们正确定义了*操作*接口，就不需要为*操作执行器创建一个***通用**接口。

 **```
import static java.lang.System.out;
public class Visitor_2 {
    public static void main(String...args) {
        Hearen hearen = new Hearen();
        FoodImpl food = new FoodImpl();
        hearen.showTheHobby(food);
        Katherine katherine = new Katherine();
        katherine.presentHobby(food);
    }
}

interface Hobby {
    void insert(Hearen hearen);
    void embed(Katherine katherine);
}

class Hearen {
    String name = "Hearen";
    void showTheHobby(Hobby hobby) {
        hobby.insert(this);
    }
}

class Katherine {
    String name = "Katherine";
    void presentHobby(Hobby hobby) {
        hobby.embed(this);
    }
}

class FoodImpl implements Hobby {
    public void insert(Hearen hearen) {
        out.println(hearen.name + " start to eat bread");
    }
    public void embed(Katherine katherine) {
        out.println(katherine.name + " start to eat mango");
    }
} 
```

正如你所期望的，一个**通用**的接口会给我们带来更多的清晰，虽然它实际上不是这个模式的*本质*部分。

```
import static java.lang.System.out;
public class Visitor_2 {
    public static void main(String...args) {
        Hearen hearen = new Hearen();
        FoodImpl food = new FoodImpl();
        hearen.showHobby(food);
        Katherine katherine = new Katherine();
        katherine.showHobby(food);
    }
}

interface Hobby {
    void insert(Hearen hearen);
    void insert(Katherine katherine);
}

abstract class Person {
    String name;
    protected Person(String n) {
        this.name = n;
    }
    abstract void showHobby(Hobby hobby);
}

class Hearen extends  Person {
    public Hearen() {
        super("Hearen");
    }
    @Override
    void showHobby(Hobby hobby) {
        hobby.insert(this);
    }
}

class Katherine extends Person {
    public Katherine() {
        super("Katherine");
    }

    @Override
    void showHobby(Hobby hobby) {
        hobby.insert(this);
    }
}

class FoodImpl implements Hobby {
    public void insert(Hearen hearen) {
        out.println(hearen.name + " start to eat bread");
    }
    public void insert(Katherine katherine) {
        out.println(katherine.name + " start to eat mango");
    }
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-06-25T03:15:35.060

你的问题是什么时候知道：

我不首先使用访问者模式进行编码。我编码标准并等待需要发生然后重构。因此，假设您有多个支付系统，一次安装一个。在结帐时，您可能有许多 if 条件（或 instanceOf），例如：

```
//psuedo code
    if(payPal) 
    do paypal checkout 
    if(stripe)
    do strip stuff checkout
    if(payoneer)
    do payoneer checkout 
```

现在想象一下我有 10 种付款方式，它有点难看。因此，当您看到出现这种模式时，访问者会派上用场将所有内容分开，然后您最终会调用这样的东西：

```
new PaymentCheckoutVistor(paymentType).visit() 
```

您可以从此处的示例数量中了解如何实现它，我只是向您展示了一个用例。

# asp.net - 为什么 jquery 在发送到 asp.net web 方法之前不将我的数组转换为 json 字符串？

> ID：255216
> 
> 赞同：8
> 
> 时间：2008-10-31T23:04:29.027
> 
> 标签：asp.net, jquery, serialization

到目前为止，我只是将 javascript 字符串传递给我的 web 方法，这些方法通常被解析为 Guid。但现在我有一个在客户端上接受 IList 的方法，我构建了这个对象数组，然后尝试像这样传递它：

```
$.ajax({
  type: 'POST',
  url: 'personalization.aspx/SetPersonalization',
  data: "{'backerEntries':" + backerEntries + "}",
  contentType: 'application/json; charset=utf-8',
  dataType: 'json',
  success: postcardManager.SetPersonalizationComplete
}); 
```

帖子：

```
{'backerEntries':[object Object],[object Object],[object Object]} 
```

错误响应：

```
Invalid JSON primitive: object. 
```

出于某种原因，jquery 似乎没有将我的数组转换为 json 字符串？任何想法为什么？我尝试将 [] 放在 backerEntries 和 {} 以及 {[]} 周围，只是出于绝望。我在这里遗漏了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-31T23:45:46.587

> 数据：“{'backerEntries'：”+ backerEntries +“}”，

..是相同的

```
data: "{'backerEntries':" + backerEntries.toString() + "}", 
```

......这几乎没用。如果您只想在查询字符串中传递名称为“backerEntries”的编码值列表，请使用[Duncan的建议。](https://stackoverflow.com/questions/255216/why-doesnt-jquery-turn-my-array-into-a-json-string-before-sending-to-aspnet-web#255261)如果要对数据进行 JSON 编码，请获取[JSON 库](https://raw.github.com/douglascrockford/JSON-js/master/json2.js)并调用`JSON.stringify()`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-31T23:39:48.270

您传递的数据已经尝试将其作为字符串传递。如果您希望 jQuery 对其进行转换，请将整个事物保留为对象，例如

```
data:{backerEntries: backerEntries } 
```

假设当然 backerEntries 是一个数组。jQuery 应该对其进行转换并将其附加到查询字符串中，因为这是它的默认行为。您当前的代码依赖于默认的 JavaScript 行为，默认情况下不会将数组转换为其字符串表示形式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-01T16:46:55.513

由于您使用的是 ASP.NET，因此可以使用内置的 ASP.NET AJAX 序列化库：

```
var backerEntriesJson = Sys.Serialization.JavaScriptSerializer.serialize(backerEntries); 
```

然后直接在你的 jQuery ajax 调用中传递它：

```
...
data: backerEntriesJson,
... 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-08-14T21:04:20.690

这不是有效的 JSON：{ 'foo': 'bar' }

不是，从来没有，永远不会。JSON 处理器通常非常宽容，这当然是一种虚假的便利。

阅读规范。字符串被定义为用双引号括起来，而不是单引号，不是笑脸字符，不是弯成直角的金属片，不是砖块。没有提到单引号，句号。

现在，属性名称是 JSON 字符串。根据定义，它们必须用双引号括起来。

有效：{“foo”：“bar”}有效”{“foo”：100}有效：{“foo”：true}有效：{“foo”：[“one”，“two”]，“bar”：错误的 }

见 www.json.org

见 www.jsonlint.com

# ruby-on-rails - 如何强制 Capistrano 部署的应用程序使用我的开发数据库？

> ID：255233
> 
> 赞同：1
> 
> 时间：2008-10-31T23:14:32.873
> 
> 标签：ruby-on-rails, ruby, capistrano

我有一个使用 Capistrano 部署到开发服务器的应用程序。我想强制此部署使用开发数据库。到目前为止，我设法做到这一点的唯一方法是使我的生产数据库信息`database.yml`等于开发信息。但这是一个完整的黑客。

我试过设置`rails_env`开发，`deploy.rb`但没有奏效。

想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-01T20:42:28.657

我最终在[这里](http://www.ahabman.com/blog/2008/05/mod_rails-set-rails_env-variable-to-qa-staging-or-production/)使用了解决方案。基本上是在部署之后但重新启动之前替换 environment.rb 中的一行的方法。

问题似乎与 DreamHost 的乘客配置有关。它假设您在生产模式下运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-01T00:29:23.677

我会使用[Capistrano Ext](http://rubyforge.org/projects/capistrano/)来定义多个部署环境。我过去曾使用它来部署我的应用程序的登台和生产安装，所以我认为它对你很有效。

如果您想了解如何使用它的概述，[Jamis Buck 有一篇文章。](http://weblog.jamisbuck.org/2007/7/23/capistrano-multistage)

# java - 哪个是 Java 最好的 JSON 重写器？

> ID：255237
> 
> 赞同：7
> 
> 时间：2008-10-31T23:18:16.363
> 
> 标签：java, json

哪种 JSON 重写器最适合用 Java 编写的应用程序？标准可能会有所不同。我个人对稳定性和性能最感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-02T03:21:30.193

我正在使用来自[http://www.json.org](http://www.json.org)的那个。Java 代码的直接链接是：http: [//www.json.org/java/index.html](http://www.json.org/java/index.html)。

它的好处是它不需要任何依赖项。您只需将七个源文件添加到您的项目中，您就拥有了一个 JSON 构建器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-01T18:03:17.200

这个工作得很好：http: [//json-lib.sourceforge.net/](http://json-lib.sourceforge.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T09:29:11.713

这个 JsonTools 库非常完整。您可以在[Berlios](http://jsontools.berlios.de/)找到它。

# java - Hibernate CRUD à la Ruby on Rails 的脚手架

> ID：255254
> 
> 赞同：9
> 
> 时间：2008-10-31T23:33:26.457
> 
> 标签：java, ruby-on-rails, hibernate, jsp, jsf

你知道有什么工具可以像 Ruby on Rails 的 Scaffolding（为任何特定类创建简单的 CRUD 页面以允许使用虚拟数据快速填充数据库），仅使用带有 Hibernate 的 Java 类进行数据库访问，以及 JSP/JSF页面？

当您编写应用程序的一部分时，这是一种拖累，但需要的数据只能与尚未准备好的另一部分一起添加，或者通过直接将其插入数据库非常麻烦。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-01T20:10:35.647

[Grails](http://grails.org/)是一个非常好的类 Rails 框架，构建在 Spring MVC 之上。对于持久性，他们使用[GORM](http://grails.org/GORM)，它基本上是一个建立在 Hibernate 之上的类似 ActiveRecord 的框架。很光滑。

如果您已经拥有 Hibernate 实体，它们实际上可以立即在 Grails 中使用，无需额外工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-14T09:57:43.810

您可以尝试**Telosys Tools**，这是一个用于代码生成（脚手架）的 Eclipse 插件，它使用可自定义的 Velocity 模板从现有数据库中工作。它非常简单易用。

使用 Spring MVC 和 Spring Data 生成代码的教程在这里：[https ://sites.google.com/site/telosystutorial/](https://sites.google.com/site/telosystutorial/)

另见：[http ://tools.telosys.org/](http://tools.telosys.org/)

Eclipse 市场：[http ://marketplace.eclipse.org/content/telosys-tools](http://marketplace.eclipse.org/content/telosys-tools)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-24T09:08:21.550

我在这个方面有点晚了，但它出现在“相关”链接中 →

JBoss Seam 和它的[Seam Gen](http://docs.jboss.org/seam/2.2.0.CR1/reference/en-US/html_single/#gettingstarted)任务正是您正在寻找的（Hibernate + JSF）。您可以在几秒钟内从 Hibernate 前端数据库生成整个 Web 应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-01T02:27:49.520

你可以使用grails。Grails 试图成为 Groovy on Rails —— 在后台使用 Rails 来搭建脚手架等。由于您几乎可以在 groovy 类中编写完整的 Java 代码，因此您也可以拥有 CAKE 和 EAT IT。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-17T19:29:26.987

Grails 与 Rails 有点不同，尽管它基于 Rails 并且有相似的感觉。Grails 使用 spring 来帮助将您的服务连接在一起。该环境不仅是动态的（使用 Groovy），还允许您使用 Java（静态环境）。这真的很酷，特别是如果您来自 java 环境。Grails 的人接受了 Rails 的想法，并使用域驱动模型对其进行了扩展。Rails 仍然以数据模型为中心，您必须与数据库打交道才能创建对象（称为模型），而 Grails 允许您使用真正的域对象模型来设计应用程序，您可以在其中处理来自域的对象类的视角而不是数据库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-24T08:09:20.363

[这里](http://netbeans.dzone.com/news/generation-jsf-20-crud-in-netbeans-68)有一个关于如何在 Netbeans 中执行此操作的很好的教程。我以前使用过这个向导，效果很好。开箱即用，您可以选择要使用的持久性框架，并且它生成的 JSF 页面非常漂亮和干净。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-24T08:43:38.633

[Spring](http://en.wikipedia.org/wiki/Spring_Framework) + [AspectJ](http://en.wikipedia.org/wiki/Aspectj) + [Hibernate](http://en.wikipedia.org/wiki/Hibernate_(Java)) + [CLI](http://en.wikipedia.org/wiki/Command-line_interface) = [**Spring Roo**](http://www.springsource.org/roo) [RAD](http://en.wikipedia.org/wiki/Rapid_application_development)框架。

试试看。

# python - Redland 的 Python 绑定中的存储事务？

> ID：255263
> 
> 赞同：5
> 
> 时间：2008-10-31T23:42:20.307
> 
> 标签：python, transactions, rdf, rdfstore, redland

我目前浏览了 Redland 的 Python 绑定，但还没有找到一种干净的方法来通过它在存储引擎上进行事务。我在低级 Redland 模块中发现了一些模型事务：

```
import RDF, Redland

storage = RDF.Storage(...)
model = RDF.Model(storage)
Redland.librdf_model_transaction_start(model._model)
try:
    # Do something
    Redland.librdf_model_transaction_commit(model._model)
    model.sync()
except:
    Redland.librdf_model_transaction_rollback(model._model) 
```

这些是否也转化为存储层？

谢谢 ：-）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-02T23:40:46.347

是的，这应该有效。目前 python 包装器中的模型类没有便利函数，但它们与您编写的类似：

```
class Model(object):
  ...
  def transaction_start(self):
    return Redland.librdf_model_transaction_start(self._model) 
```

# apache-flex - Flash / Flex 之外的 Actionscript 3

> ID：255266
> 
> 赞同：5
> 
> 时间：2008-10-31T23:45:06.480
> 
> 标签：apache-flex, flash, actionscript-3, ria

我刚刚完成了一个 Flash 项目，我在“纯”AS3 中完成了整个项目，没有使用 Flex 框架。我在网上找到的关于这个的文章很少，所以我不确定这是否是开发 RIA 的常用方法，或者我是否已经从巨人的肩膀上跳下来做了一些愚蠢的事情，以后会咬我。

这在当时似乎是个好主意（著名的遗言！），但希望能听到能证实的人的消息。

谢谢，马库斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-02T11:58:50.897

它没有任何问题。人们每天都使用 FlashDevelop 和纯 AS3 框架（如[PureMVC](http://puremvc.org/) ）来做这件事。在没有任何框架支持的情况下做一个复杂的应用程序将来可能很难支持，但如果你坚持众所周知的最佳实践，应该没问题。未来的可维护性，特别是如果它必须由其他人维护，也可以通过在整个代码和体系结构中使用通用设计模式来大大提高。除此之外，如果您真的只是在编写代码来构建具有任何真正复杂性的东西，那么您可能会被搞砸，除非您很好地记录了每个功能和整体架构。也许不是今天，也许不是明天，但总有一天你（或其他人）被搞砸了！;)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-01T23:44:55.513

听起来是个好主意。Flex 实际上只是在纯 AS3 之上的快速原型设计和通信标准的叠加。

您在易于开发和大型库和 API 中获得的东西，您会在流线型、强度和简单性中失去。

我目前正在用 Flex 开发一个中型应用程序，尽管开发的第一阶段轻而易举，但后期阶段却充满了奇怪的框架怪癖。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-01T00:41:59.250

如果您想在 Flex 框架为您提供的范围内快速创建看起来很棒的东西，那么 Flex 非常好。

我们过去常常与 Adob​​e 似乎并不关心或修复时间过长的奇怪框架错误作斗争。因此，我们选择放弃 Flex，转而使用我们自己的 UI 框架，此后我们再也没有回头。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T15:49:48.573

绝对没问题。例如，我听说 Issuu.com 平台不是基于 Flex，而是基于自定义框架。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T22:56:50.040

谢谢大家！我对 AS3 非常满意，并且喜欢我获得的控制量，而不是使用 MXML/Flex。很高兴听到我没有疯！

# .net - FLV 缩略图

> ID：255268
> 
> 赞同：5
> 
> 时间：2008-10-31T23:45:34.997
> 
> 标签：.net, flash

我正在寻找可以让我从 FLV 文件中提取缩略图的 .NET 库或命令行工具（AVI 也不错，但不是必需的）。可以让我将一帧提取到电影中的 15% 就足够了。如果它可以提取几帧，比如说每分钟一帧，然后用这些帧制作一个动画 GIF，那就更酷了。不必是开源的，但它必须是我可以合并到我的应用程序中的东西。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-31T23:57:43.520

ffmpeg。

```
ffmpeg.exe -i video.flv -an -ss 00:00:03 -an -r 1 -vframes 1 -y %d.jpg 
```

（将视频期间3秒位置的单帧保存为jpeg）

# iphone - #Import 的问题 在 Xcode 中

> ID：255275
> 
> 赞同：2
> 
> 时间：2008-10-31T23:51:43.020
> 
> 标签：iphone, cocoa-touch

我需要使用似乎需要从`<AppKit/AppKit.h>`. 我已经包含了 AppKit 框架，我确实看到`AppKit.h`了。但我仍然收到编译错误说`<AppKit/AppKit.h>`未找到。

我可能错过了什么？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T23:58:07.390

AppKit 在 iPhone 上不可用，NSIMage 也不可用。你需要引入 UIKit 并使用 UIImage。

# multithreading - 如何优雅地停止长时间执行的线程？

> ID：255276
> 
> 赞同：5
> 
> 时间：2008-10-31T23:51:49.743
> 
> 标签：multithreading, delphi

我对 Delphi 有一个线程问题。我想这在其他语言中也很常见。我在线程中执行了一个很长的过程，该过程填充了主窗口中的列表。但是如果同时一些参数发生变化，那么我应该停止当前正在执行的线程并从头开始。Delphi 建议通过设置 Terminated:=true 并在线程中检查该变量的值来终止线程。但是我的问题是，长执行部分隐藏在库调用中，在此调用中我无法检查 Terminated 变量。因此我不得不等待这个库调用完成，这会影响整个程序。

在这种情况下，首选的方法是什么？我可以立即杀死线程吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-01T00:05:06.160

首选方法是修改代码，使其在不检查取消的情况下不会阻塞。

既然你不能修改代码，你就不能那样做；您要么必须忍受后台操作（但您可以将其与任何 UI 取消关联，这样它的完成将被忽略）；或者，您可以尝试终止它（TerminateThread API 将粗暴地终止任何给定其句柄的线程）。终止不是干净的，但是，就像 Rob 所说的那样，线程持有的任何锁都将被放弃，并且任何受此类锁保护的跨线程状态都可能处于损坏状态。

您可以考虑在单独的可执行文件中调用该函数吗？也许使用 RPC（管道，TCP，而不是由于相同的锁定问题而共享内存），以便您可以终止进程而不是终止线程？进程隔离将为您提供更多保护。只要你不依赖像互斥锁这样的跨进程命名的东西，它应该比杀死一个线程安全得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-01T00:01:24.153

线程需要合作以实现正常关闭。我不确定 Delphi 是否提供中止另一个线程的机制，但此类机制在 .NET 和 Java 中可用，但应被视为最后的选择，并且应用程序的状态在使用后是不确定的。

如果您可以在任意点杀死一个线程，那么您可以在它持有内存分配器中的锁时杀死它（例如）。当您的主线程下一次需要访问该锁时，这将使您的程序处于挂起状态。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-01T00:26:10.703

如果您不能修改代码来检查是否终止，那么只需将其优先级设置得很低，并在它返回时忽略它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T21:24:28.697

我写这个是为了回答一个[类似的问题](https://stackoverflow.com/questions/209086/how-do-i-guarantee-fast-shutdown-of-my-win32-app#210385)：

> 我使用了一种基于异常的技术，该技术在许多 Win32 应用程序中都非常有效。
> 
> 为了终止一个线程，我使用 QueueUserAPC 对一个引发异常的函数的调用进行排队。但是，抛出的异常不是从“异常”类型派生的，因此只会被我线程的包装程序捕获。

我已经非常成功地将它与 C++Builder 应用程序一起使用。我不知道 Delphi 与 C++ 异常处理的所有微妙之处，但我希望它可以很容易地修改以工作。

# programming-languages - 来自函数/逻辑/面向对象编程的想法

> ID：255277
> 
> 赞同：2
> 
> 时间：2008-10-31T23:52:44.280
> 
> 标签：programming-languages

有人可以指点我讨论不同编程范式（函数/逻辑/OOP）的文章或书籍...我不是在寻找语法细节，而是在寻找使它们变得更好的想法。

例如：使用函数式编程，我们避免了任何副作用。如果我知道这个想法，我甚至可以用一种不强制执行它的语言 (OOP) 来编写无副作用的程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T23:58:51.583

据我了解，在 OOP 中编写函数式的方法是让每个成员都成为最终成员（几乎总是如此）。这避免了副作用，虽然我对函数式编程并没有真正失望，但我认为自从我开始尽可能将变量设为 final 后，我的代码得到了改进——所以它肯定有一些好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-01T00:06:02.380

[Programming Language Pragmatics](http://www.cs.rochester.edu/~scott/pragmatics/)对不同的范式进行了非常全面的概述。这本书是关于语言设计的，所以它谈到了很多关于语法、语义、类型系统、目标架构等的内容。最新版本有一整章是关于逻辑编程语言的，一章是关于函数式语言的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-01T00:36:58.247

[这里有一个关于编程语言概念](http://www.cis.upenn.edu/%7Ebcpierce/courses/670Fall04/GreatWorksInPL.shtml)的阅读列表

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-13T23:08:43.173

我已经开始阅读 Peter Van Roy 的“计算机编程的概念、技术和模型”，到目前为止它非常好......

# c# - 在 C# 中确定对象的值

> ID：255278
> 
> 赞同：2
> 
> 时间：2008-10-31T23:53:18.227
> 
> 标签：c#, casting

在 C# 中确定对象是否等于数字零 (0) 或 string.empty 的最佳方法是什么？

**编辑：**该对象可以等于任何内置 System.Value 类型或引用类型。

源代码：

```
public void MyMethod(object input1, object input2)
{
    bool result = false;
    object compare = new object();

    if(input != null && input2 != null)
    {
        if(input1 is IComparable && input2 is IComparable)
        {
            //do check for zero or string.empty
            //if input1 equals to zero or string.empty
            result = object.Equals(input2);

            //if input1 not equals to zero or string.empty
            result = object.Equals(input1) && object.Equals(input2); //yes not valid, but this is what I want to accomplish
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T18:39:33.847

使用 Jonathan Holland 代码示例并稍作修改，以下是有效的解决方案：

```
static bool IsZeroOrEmpty(object o1)
{
    bool Passed = false;
    object ZeroValue = 0;

    if(o1 != null)
    {
        if(o1.GetType().IsValueType)
        {
            Passed = (o1 as System.ValueType).Equals(Convert.ChangeType(ZeroValue, o1.GetType()))
        }
        else
        {
            if (o1.GetType() == typeof(String))
            {
                Passed = o1.Equals(String.Empty);
            }
        }
    }

    return Passed;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-01T01:46:15.003

这有什么问题？

```
public static bool IsZeroOrEmptyString(object obj)
{
    if (obj == null)
        return false;
    else if (obj.Equals(0) || obj.Equals(""))
        return true;
    else
        return false;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-01T00:02:09.470

迈克尔，你需要在这里提供更多信息。

可以使用方法将字符串与 null 或 string.Empty 进行比较

```
string x = "Some String"
if( string.IsNullOrEmpty(string input) ) { ... } 
```

int、decimals、doubles（和其他数值类型）可以通过简单的 == 测试与 0（零）进行比较

```
int x = 0;
if(x == 0) { ... } 
```

您也可以使用 ? 实例化它们时的运算符。这允许您将值类型设置为 null。

```
int? x = null;
if( !x.HasValue ) {  } 
```

对于任何其他对象，一个简单的 == null 测试将告诉您它是否为 null

```
object o = new object();
if( o != null ) { ... } 
```

希望能对事情有所启发。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-01T00:47:25.153

不太确定这背后的原因，因为 .Equals 是引用类型上的引用相等，以及值类型上的值相等。

这似乎有效，但我怀疑它是你想要的：

```
 static bool IsZeroOrEmpty(object o1)
    {
        if (o1 == null)
            return false;
        if (o1.GetType().IsValueType)
        {                
            return (o1 as System.ValueType).Equals(0);
        }
        else
        {
            if (o1.GetType() == typeof(String))
            {
                return o1.Equals(String.Empty);
            }

            return o1.Equals(0);
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T23:56:36.817

如果您在谈论字符串，您的意思是 null 还是 string.empty？

if (String.IsNullOrEmpty(obj as string)) { ... 做点什么 }

*   奥辛

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T23:58:02.803

在第一种情况下，通过测试它是否为空。在第二种情况下，通过测试它是否为 string.empty （您回答了自己的问题）。

我应该补充一点，一个对象永远不能等于 0。一个对象变量可以有一个空引用（实际上这意味着变量的值为 0；虽然在这种情况下没有对象）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-01T01:32:45.700

```
obj => obj is int && (int)obj == 0 || obj is string && (string)obj == string.Empty 
```

# .net - 如何使用.net将字符串“yyyy-MM-ddZ”转换为日期时间？

> ID：255287
> 
> 赞同：4
> 
> 时间：2008-10-31T23:59:12.053
> 
> 标签：.net, datetime, timezone

我在使用 VB.net 转换格式为“yyyy-MM-ddZ”的字符串时遇到问题。

例如，我有字符串“2007-10-21Z”。

使用 CDate 或 TryParse 可以得出 2007 年 10 月 20 日而不是 2007 年 10 月 21 日。

我不明白 Z 如何影响日期字符串，以便在解析它时会在前一天产生结果。

据我了解 Z 指定零时区。但是日期字符串没有时间信息。这是如何运作的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-01T00:23:23.487

它将日期解释为午夜 Zulu (GMT) 时间，然后将其转换回您当地的时区。如果您在前一天下午 3:00 到晚上 7:00 之间的美国。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-01T01:04:54.820

尝试

DateTime.ParseExact("2007-10-21Z", "yyyy-MM-ddZ", CultureInfo.InvariantCulture);

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-01T00:22:51.567

将“Z”添加到日期指定时间为[UTC](http://en.wikipedia.org/wiki/ISO_8601#UTC)。当您对 TryParse 日期进行 CDate 时，它​​会将其转换为本地时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-01T00:18:21.920

哇，这很有趣。我尝试在 C# DateTime.Parse("2008-10-31").ToString(); 结果是“10/30/2008 5:00:00 PM”。

我等不及要回答了！

# c++ - TinyXML++ 的奇怪行为

> ID：255302
> 
> 赞同：2
> 
> 时间：2008-11-01T00:16:15.200
> 
> 标签：c++, tinyxml, tinyxml++

希望你们中的一些 TinyXML++ 人可以帮助我。真的，因为你在我认为你欠我之前向我推荐了；）

我有以下代码：

```
 //ticpp::Iterator< ticpp::Element > child( "SetPiece" );
    ticpp::Iterator< ticpp::Node > child("SetPiece");
    GLuint lc_SPieces = 0;
    for(child = child.begin( this ); child != child.end(); child++ )
    {
        lc_SPieces++;
    } 
```

如果我对 child 使用 top 声明，我会收到错误：

> Drawing.exe 中 0x7c812aeb 处未处理的异常：Microsoft C++ 异常：__non_rtti_object @ 0x0012f7b4。

我在这一行的 dbgheap.c 中得到它：

```
pvBlk = _heap_alloc_dbg(nSize, nBlockUse, szFileName, nLine); 
```

奇怪的是它适用于 Node，而且我知道其中有元素（我使用 TinyXML 迭代方法进行了检查）。

有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T15:57:02.197

只是在黑暗中戳，我不知道 tinyxml，但似乎 dynamic_cast 出错了。如果你 dynamic_cast<> 一个指针，你会在失败时得到一个 NULL 指针。但是，如果转换为引用类型，则没有 NULL 引用的概念，因此运行时会抛出此异常（或 bad_type）。[关于 dynamic_cast 的 MSDN，以及为什么会出错](http://msdn.microsoft.com/en-us/library/cby9kycs(VS.71).aspx)

您为发生异常而粘贴的行无助于清除情况，因为它识别的是症状而不是原因。

尝试识别出错的演员表，如果您向上走堆栈并在 tinyxml 库或标头中找到最后一个方法，您应该能够找到它。然后您可以决定是否使用 tinyxml，或者您只是以错误的方式应用它。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T23:38:55.207

`__non_rtti_object`如果传递的指针或引用不指向多态对象，而是指向一些垃圾，则由 dynamic_cast 运算符生成。也许该对象之前已被删除。

单步调试调试器中的代码并检查 dynamic_cast 的使用位置以及传递给它的内容。

帕沃

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T16:12:22.040

项目 -> 属性 -> C/C++ -> 语言 -> 启用运行时类型信息

# php - 如何在 PHP 中将变量名作为字符串获取？

> ID：255312
> 
> 赞同：217
> 
> 时间：2008-11-01T00:28:31.960
> 
> 标签：php

假设我有这个 PHP 代码：

```
$FooBar = "a string"; 
```

然后我需要这样的功能：

```
print_var_name($FooBar); 
```

打印：

```
FooBar 
```

任何想法如何实现这一目标？这在PHP中甚至可能吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-01-01T06:18:20.253

我也想不出一种有效地做到这一点的方法，但我想出了这个。它适用于以下有限用途。

*耸耸肩*

```
<?php

function varName( $v ) {
    $trace = debug_backtrace();
    $vLine = file( __FILE__ );
    $fLine = $vLine[ $trace[0]['line'] - 1 ];
    preg_match( "#\\$(\w+)#", $fLine, $match );
    print_r( $match );
}

$foo = "knight";
$bar = array( 1, 2, 3 );
$baz = 12345;

varName( $foo );
varName( $bar );
varName( $baz );

?>

// Returns
Array
(
    [0] => $foo
    [1] => foo
)
Array
(
    [0] => $bar
    [1] => bar
)
Array
(
    [0] => $baz
    [1] => baz
) 
```

它基于调用函数的行工作，它在其中找到您传入的参数。我想它可以扩展为使用多个参数，但是，就像其他人所说的那样，如果你能更好地解释这种情况，另一种解决方案可能会工作得更好。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-11-01T00:42:30.687

您可以使用[get_defined_vars()](http://php.net/get_defined_vars)来查找与您要查找的名称具有相同值的变量的名称。显然这并不总是有效，因为不同的变量通常具有相同的值，但这是我能想到的唯一方法。

编辑： get_defined_vars() 似乎无法正常工作，它返回 'var' 因为在函数本身中使用了 $var。$GLOBALS 似乎有效，所以我将其更改为。

```
function print_var_name($var) {
    foreach($GLOBALS as $var_name => $value) {
        if ($value === $var) {
            return $var_name;
        }
    }

    return false;
} 
```

编辑：需要明确的是，在 PHP 中没有这样做的好方法，这可能是因为你不应该这样做。可能有更好的方法来做你想做的事情。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-01-01T05:14:24.250

您可能会考虑改变您的方法并使用变量变量名？

```
$var_name = "FooBar";
$$var_name = "a string"; 
```

那么你可以

```
print($var_name); 
```

要得到

```
FooBar 
```

这是[关于变量变量的 PHP 手册的链接](http://us3.php.net/variables.variable)

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2013-04-10T20:52:34.110

似乎没有人提到*为什么*这是 a) 困难和 b) 不明智的根本原因：

*   “变量”只是指向其他事物的符号。在 PHP 中，它在内部指向一个叫做“zval”的东西，它实际上可以同时用于多个变量，或者因为它们具有相同的值（PHP 实现了一个叫做“copy-on-write”的东西，所以`$foo = $bar`不需要立即分配额外的内存）或因为它们已通过引用（例如）分配（或传递给函数`$foo =& $bar`）。所以 zval 没有名字。
*   当您将参数传递给函数时，您正在创建一个*新*变量（即使它是一个引用）。你可以传递一些匿名的东西，比如`"hello"`，但是一旦进入你的函数，它就是你命名的任何变量。这对于代码分离来说是相当基础的：如果一个函数依赖于过去调用的变量*，*那么它更像是一个`goto`而不是一个适当分离的函数。
*   全局变量通常被认为是一个坏主意。这里的很多例子都假设你想“反映”的变量可以在 中找到`$GLOBALS`，但这只有在你的代码结构不好并且变量没有作用于某个函数或对象的情况下才会成立。
*   变量名可以帮助程序员阅读他们的代码。重命名变量以更好地适应它们的目的是一种非常常见的重构实践，重点是它没有任何区别。

现在，我理解了对调试的渴望（尽管一些建议的用法远不止于此），但作为一个通用的解决方案，它实际上并没有你想象的那么有用：如果你的调试函数说你的变量被称为 "$file ”，它仍然可以是代码中数十个“$file”变量中的任何一个，或者是一个您已称为“$filename”但传递给其参数称为“$file”的函数的变量。

一条更有用的信息是在代码中调用调试函数的位置。由于您可以在编辑器中快速找到它，因此您可以查看自己输出的变量，甚至可以一次性将整个表达式传递给它（例如`debug('$foo + $bar = ' . ($foo + $bar))`）。

为此，您可以在调试函数的顶部使用此代码段：

```
$backtrace = debug_backtrace();
echo '# Debug function called from ' . $backtrace[0]['file'] . ' at line ' . $backtrace[0]['line']; 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2016-04-28T17:22:52.550

这正是您想要的 - 它是一个随时可用的“复制并插入”功能，它回显给定 var 的名称：

```
function print_var_name(){
    // read backtrace
    $bt   = debug_backtrace();
    // read file
    $file = file($bt[0]['file']);
    // select exact print_var_name($varname) line
    $src  = $file[$bt[0]['line']-1];
    // search pattern
    $pat = '#(.*)'.__FUNCTION__.' *?\( *?(.*) *?\)(.*)#i';
    // extract $varname from match no 2
    $var  = preg_replace($pat, '$2', $src);
    // print to browser
    echo '<pre>' . trim($var) . ' = ' . print_r(current(func_get_args()), true) . '</pre>';
} 
```

用法： print_var_name($FooBar)

打印：FooBar

> **提示**
> 现在您可以重命名该函数，它仍然可以工作，并且可以在一行中多次使用该函数！感谢@Cliffordlife
> 我添加了一个更好的输出！感谢@Blue-Water

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2010-03-10T05:31:24.840

出于调试原因，我做了一个检查功能。它就像类固醇上的 print_r()，很像 Krumo，但对对象更有效。我想添加 var 名称检测并提出了这个，灵感来自 Nick Presta 在此页面上的帖子。它检测作为参数传递的任何表达式，而不仅仅是变量名。

这只是检测传递的表达式的包装函数。适用于大多数情况。如果您在同一行代码中多次调用该函数，它将不起作用。

这工作正常：死（**检查（****$this->getUser()->hasCredential("删除")*****)** );***

 ***inspect() 是检测传递的表达式的函数。

我们得到： *$this->getUser()->hasCredential("delete")*

```
function inspect($label, $value = "__undefin_e_d__")
{
    if($value == "__undefin_e_d__") {

        /* The first argument is not the label but the 
           variable to inspect itself, so we need a label.
           Let's try to find out it's name by peeking at 
           the source code. 
        */

        /* The reason for using an exotic string like 
           "__undefin_e_d__" instead of NULL here is that 
           inspected variables can also be NULL and I want 
           to inspect them anyway.
        */

        $value = $label;

        $bt = debug_backtrace();
        $src = file($bt[0]["file"]);
        $line = $src[ $bt[0]['line'] - 1 ];

        // let's match the function call and the last closing bracket
        preg_match( "#inspect\((.+)\)#", $line, $match );

        /* let's count brackets to see how many of them actually belongs 
           to the var name
           Eg:   die(inspect($this->getUser()->hasCredential("delete")));
                  We want:   $this->getUser()->hasCredential("delete")
        */
        $max = strlen($match[1]);
        $varname = "";
        $c = 0;
        for($i = 0; $i < $max; $i++){
            if(     $match[1]{$i} == "(" ) $c++;
            elseif( $match[1]{$i} == ")" ) $c--;
            if($c < 0) break;
            $varname .=  $match[1]{$i};
        }
        $label = $varname;
    }

    // $label now holds the name of the passed variable ($ included)
    // Eg:   inspect($hello) 
    //             => $label = "$hello"
    // or the whole expression evaluated
    // Eg:   inspect($this->getUser()->hasCredential("delete"))
    //             => $label = "$this->getUser()->hasCredential(\"delete\")"

    // now the actual function call to the inspector method, 
    // passing the var name as the label:

      // return dInspect::dump($label, $val);
         // UPDATE: I commented this line because people got confused about 
         // the dInspect class, wich has nothing to do with the issue here.

    echo("The label is: ".$label);
    echo("The value is: ".$value);

} 
```

这是检查器功能（和我的 dInspect 类）的示例：

[http://inspect.ip1.cc](http://inspect.ip1.cc)

该页面中的文本为西班牙语，但代码简洁且非常易于理解。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2010-10-27T14:16:09.207

PHP.net 上的 Lucas 提供了一种检查变量是否存在的可靠方法。在他的示例中，他遍历变量的全局变量数组（或范围数组）的副本，将值更改为随机生成的值，并在复制的数组中检查生成的值。

```
function variable_name( &$var, $scope=false, $prefix='UNIQUE', $suffix='VARIABLE' ){
    if($scope) {
        $vals = $scope;
    } else {
        $vals = $GLOBALS;
    }
    $old = $var;
    $var = $new = $prefix.rand().$suffix;
    $vname = FALSE;
    foreach($vals as $key => $val) {
        if($val === $new) $vname = $key;
    }
    $var = $old;
    return $vname;
} 
```

然后尝试：

```
$a = 'asdf';
$b = 'asdf';
$c = FALSE;
$d = FALSE;

echo variable_name($a); // a
echo variable_name($b); // b
echo variable_name($c); // c
echo variable_name($d); // d 
```

请务必查看他在 PHP.net 上的帖子：http: [//php.net/manual/en/language.variables.php](http://php.net/manual/en/language.variables.php)

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2011-08-13T10:50:33.017

来自[php.net](http://www.php.net/manual/en/language.variables.php#49997 "php.net")

@Alexandre - 简短的解决方案

```
<?php
function vname(&$var, $scope=0)
{
    $old = $var;
    if (($key = array_search($var = 'unique'.rand().'value', !$scope ? $GLOBALS : $scope)) && $var = $old) return $key;  
}
?> 
```

@Lucas - 用法

```
<?php
//1\.  Use of a variable contained in the global scope (default):
  $my_global_variable = "My global string.";
  echo vname($my_global_variable); // Outputs:  my_global_variable

//2\.  Use of a local variable:
  function my_local_func()
  {
    $my_local_variable = "My local string.";
    return vname($my_local_variable, get_defined_vars());
  }
  echo my_local_func(); // Outputs: my_local_variable

//3\.  Use of an object property:
  class myclass
  {
    public function __constructor()
    {
      $this->my_object_property = "My object property  string.";
    }
  }
  $obj = new myclass;
  echo vname($obj->my_object_property, $obj); // Outputs: my_object_property
?> 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-03-16T01:13:58.530

许多回复质疑这是否有用。但是，获取变量的引用可能非常有用。特别是在对象和*$this*的情况下。我的解决方案适用于对象，也适用于属性定义的对象：

```
function getReference(&$var)
{
    if(is_object($var))
        $var->___uniqid = uniqid();
    else
        $var = serialize($var);
    $name = getReference_traverse($var,$GLOBALS);
    if(is_object($var))
        unset($var->___uniqid);
    else
        $var = unserialize($var);
    return "\${$name}";    
}

function getReference_traverse(&$var,$arr)
{
    if($name = array_search($var,$arr,true))
        return "{$name}";
    foreach($arr as $key=>$value)
        if(is_object($value))
            if($name = getReference_traverse($var,get_object_vars($value)))
                return "{$key}->{$name}";
} 
```

上述示例：

```
class A
{
    public function whatIs()
    {
        echo getReference($this);
    }
}

$B = 12;
$C = 12;
$D = new A;

echo getReference($B)."<br/>"; //$B
echo getReference($C)."<br/>"; //$C
$D->whatIs(); //$D 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-12-27T23:32:12.553

改编自上述许多变量的答案，具有良好的性能，只需一次 $GLOBALS 扫描即可

```
function compact_assoc(&$v1='__undefined__', &$v2='__undefined__',&$v3='__undefined__',&$v4='__undefined__',&$v5='__undefined__',&$v6='__undefined__',&$v7='__undefined__',&$v8='__undefined__',&$v9='__undefined__',&$v10='__undefined__',&$v11='__undefined__',&$v12='__undefined__',&$v13='__undefined__',&$v14='__undefined__',&$v15='__undefined__',&$v16='__undefined__',&$v17='__undefined__',&$v18='__undefined__',&$v19='__undefined__'
) {
    $defined_vars=get_defined_vars();

    $result=Array();
    $reverse_key=Array();
    $original_value=Array();
    foreach( $defined_vars as $source_key => $source_value){
        if($source_value==='__undefined__') break;
        $original_value[$source_key]=$$source_key;
        $new_test_value="PREFIX".rand()."SUFIX";
        $reverse_key[$new_test_value]=$source_key;
        $$source_key=$new_test_value;

    }
    foreach($GLOBALS as $key => &$value){
        if( is_string($value) && isset($reverse_key[$value])  ) {
            $result[$key]=&$value;
        }
    }
    foreach( $original_value as $source_key => $original_value){
        $$source_key=$original_value;
    }
    return $result;
}

$a = 'A';
$b = 'B';
$c = '999';
$myArray=Array ('id'=>'id123','name'=>'Foo');
print_r(compact_assoc($a,$b,$c,$myArray) );

//print
Array
(
    [a] => A
    [b] => B
    [c] => 999
    [myArray] => Array
        (
            [id] => id123
            [name] => Foo
        )

) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-09-25T17:51:54.220

您可以使用 compact() 来实现这一点。

```
$FooBar = "a string";

$newArray = compact('FooBar'); 
```

这将创建一个以变量名作为键的关联数组。然后，您可以使用所需的键名循环遍历数组。

```
foreach($newarray as $key => $value) {
    echo $key;
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-01T03:46:59.313

如果变量是可互换的，那么您必须在*某处*具有确定使用哪个变量的逻辑。您需要做的就是`$variable`在执行其他所有操作时将变量名放入该逻辑中。

我想我们都很难理解你需要这个做什么。示例代码或对您实际尝试*做*的事情的解释可能会有所帮助，但我怀疑您是在想**太多**了。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-08-05T10:16:36.957

我实际上有一个有效的用例。

我有一个函数 cacheVariable($var) （好的，我有一个函数 cache($key, $value)，但我想要一个前面提到的函数）。

这样做的目的是：

```
$colour = 'blue';
cacheVariable($colour); 
```

...

```
// another session 
```

...

```
$myColour = getCachedVariable('colour'); 
```

我试过了

```
function cacheVariable($variable) {
   $key = ${$variable}; // This doesn't help! It only gives 'variable'.
   // do some caching using suitable backend such as apc, memcache or ramdisk
} 
```

我也试过

```
function varName(&$var) {
   $definedVariables = get_defined_vars();
   $copyOfDefinedVariables = array();
   foreach ($definedVariables as $variable=>$value) {
      $copyOfDefinedVariables[$variable] = $value;
   }
   $oldVar = $var;
   $var = !$var;
   $difference = array_diff_assoc($definedVariables, $copyOfDefinedVariables);
   $var = $oldVar;
   return key(array_slice($difference, 0, 1, true));
} 
```

但这也失败了...... :(

当然，我可以继续做缓存（'colour'，$ colour），但我很懒，你知道......;）

所以，我想要的是一个获取变量原始名称的函数，因为它被传递给一个函数。在函数内部，我似乎无法知道这一点。在上面的第二个示例中通过引用传递 get_defined_vars() 对我有所帮助（感谢 Jean-Jacques Guegan 的这个想法）。后一个函数开始工作，但它仍然只返回局部变量（“变量”，而不是“颜色”）。

我还没有尝试过结合使用 get_func_args() 和 get_func_arg()、${}-constructs 和 key()，但我认为它也会失败。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-06-15T14:19:35.890

我有这个：

```
 debug_echo(array('$query'=>$query, '$nrUsers'=>$nrUsers, '$hdr'=>$hdr)); 
```

我更喜欢这个：

```
 debug_echo($query, $nrUsers, $hdr); 
```

现有函数显示一个带有红色轮廓的黄色框，并按名称和值显示每个变量。数组解决方案有效，但在需要时输入有点复杂。

这是我的用例，是的，它确实与调试有关。我同意那些质疑它的使用的人。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-03-08T07:42:49.300

这是我的解决方案，基于`Jeremy Ruten`

```
class DebugHelper {

    function printVarNames($systemDefinedVars, $varNames) {
        foreach ($systemDefinedVars as $var=>$value) {
            if (in_array($var, $varNames )) {
                var_dump($var);
                var_dump($value);
            }
        }
    }
} 
```

使用它

```
DebugHelper::printVarNames(
    $systemDefinedVars = get_defined_vars(),
    $varNames=array('yourVar00', 'yourVar01')
); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-04-03T16:39:04.213

我想你想知道变量名和它的值。您可以使用关联数组来实现此目的。

对数组键使用变量名：

```
$vars = array('FooBar' => 'a string'); 
```

当您想获取变量名时，使用`array_keys($vars)`，它将返回一个数组，其中包含在您的`$vars`数组中使用的那些变量名作为它的键。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-04-26T14:15:50.680

我就是这样做的

```
function getVar(&$var) {
    $tmp = $var; // store the variable value
    $var = '_$_%&33xc$%^*7_r4'; // give the variable a new unique value
    $name = array_search($var, $GLOBALS); // search $GLOBALS for that unique value and return the key(variable)
    $var = $tmp; // restore the variable old value
    return $name;
} 
```

**用法**

```
$city  = "San Francisco";
echo getVar($city); // city 
```

**注意：**`array_search`某些 PHP 7 版本由于with中的错误而无法正常工作`$GLOBALS`，但所有其他版本都可以正常工作。

请参阅此[https://3v4l.org/UMW7V](https://3v4l.org/UMW7V)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-01-09T16:34:52.890

PHP 中没有预定义的函数可以输出变量的名称。但是，您可以使用 的结果`get_defined_vars()`，它返回范围内定义的所有变量，包括名称和值。这是一个例子：

```
<?php
    // Function for determining the name of a variable
    function getVarName(&$var, $definedVars=null) {
        $definedVars = (!is_array($definedVars) ? $GLOBALS : $definedVars);
        $val = $var;
        $rand = 1;
        while (in_array($rand, $definedVars, true)) {
            $rand = md5(mt_rand(10000, 1000000));
        }
        $var = $rand;

        foreach ($definedVars as $dvName=>$dvVal) {
            if ($dvVal === $rand) {
                $var = $val;
                return $dvName;
            }
        }

        return null;
    }

    // the name of $a is to be determined.   
    $a = 1;

    // Determine the name of $a
    echo getVarName($a);
?> 
```

阅读[如何在 PHP 中将变量名作为字符串获取？](https://stackhowto.com/how-to-get-a-variable-name-as-a-string-in-php/)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-06-19T17:17:08.030

你为什么不构建一个简单的函数并告诉它呢？

```
/**
 * Prints out $obj for debug
 *
 * @param any_type $obj
 * @param (string) $title
 */
function print_all( $obj, $title = false )
{
    print "\n<div style=\"font-family:Arial;\">\n";
    if( $title ) print "<div style=\"background-color:red; color:white; font-size:16px; font-weight:bold; margin:0; padding:10px; text-align:center;\">$title</div>\n";
    print "<pre style=\"background-color:yellow; border:2px solid red; color:black; margin:0; padding:10px;\">\n\n";
    var_export( $obj );
    print "\n\n</pre>\n</div>\n";
}

print_all( $aUser, '$aUser' ); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-11-15T04:45:32.203

我一直在寻找这个，但只是决定将名字传递进去，无论如何我通常在剪贴板中有名字。

```
function VarTest($my_var,$my_var_name){
    echo '$'.$my_var_name.': '.$my_var.'<br />';
}

$fruit='apple';
VarTest($fruit,'fruit'); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-03-16T06:07:51.640

我知道这是旧的并且已经回答但我实际上正在寻找这个。我发布这个答案是为了节省人们一些时间来完善一些答案。

选项1：

```
$data = array('$FooBar');  

$vars = [];  
$vars = preg_replace('/^\\$/', '', $data); 

$varname = key(compact($vars));  
echo $varname; 
```

印刷：

> 富吧

无论出于何种原因，您会发现自己处于这种情况，它确实有效。

.
选项 2：

```
$FooBar = "a string";  

$varname = trim(array_search($FooBar, $GLOBALS), " \t.");  
echo $varname; 
```

如果`$FooBar`持有一个唯一值，它将打印“FooBar”。如果`$FooBar`为空或 null，它将打印它找到的第一个空或 null 字符串的名称。

它可以这样使用：

```
if (isset($FooBar) && !is_null($FooBar) && !empty($FooBar)) {
    $FooBar = "a string";
    $varname = trim(array_search($FooBar, $GLOBALS), " \t.");
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-09-14T02:52:37.320

其他用途：

耸耸肩

```
function varsToArrayAssoc(...$arguments){

    $bt   = debug_backtrace();
    $file = file($bt[0]['file']);
    $src  = $file[$bt[0]['line']-1];
    $pat = '#(.*)'.__FUNCTION__.' *?\( *?(.*) *?\)(.*)#i';
    $vars  =explode(',',substr_replace(trim(preg_replace($pat, '$2', $src)) ,"", -1));
    $result=[];
    foreach(func_get_args() as $key=>$v){
        $index=trim(explode('$',$vars[$key])[1]);
        $result[$index]=$v;
    }
    return $result;
}

$a=12;
$b=13;
$c=123;
$d='aa';

var_dump(varsToArrayAssoc($a,$b,$c,$d)); 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2012-06-09T09:25:26.747

使用它从全局中分离用户变量以检查当前变量。

```
function get_user_var_defined () 
{
    return array_slice($GLOBALS,8,count($GLOBALS)-8);     
}

function get_var_name ($var) 
{
    $vuser = get_user_var_defined(); 
    foreach($vuser as $key=>$value) 
    {
        if($var===$value) return $key ; 
    }
} 
```

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2014-02-23T20:03:15.420

它可能被认为是又快又脏，但我个人的偏好是使用这样的函数/方法：

```
public function getVarName($var) {      
  $tmp = array($var => '');
  $keys = array_keys($tmp);
  return trim($keys[0]);
} 
```

基本上它只是创建一个包含一个空/空元素的关联数组，使用您想要名称的变量作为键。

然后我们使用 array_keys 获取该键的值并返回它。

显然这会很快变得混乱，并且在生产环境中是不可取的，但它适用于所提出的问题。

* * *

## 回答 #25

> 赞同：-3
> 
> 时间：2012-05-03T16:48:17.327

为什么我们必须使用全局变量来获取变量名......我们可以像下面这样简单地使用。

```
 $variableName = "ajaxmint";

    echo getVarName('$variableName');

    function getVarName($name) {
        return str_replace('$','',$name);
    } 
```

* * *

## 回答 #26

> 赞同：-4
> 
> 时间：2008-11-01T00:33:46.490

我真的看不到用例...如果您输入 print_var_name($foobar) ，那么输入 print("foobar") 有什么困难（和不同）？

因为即使你要在函数中使用它，你也会得到变量的本地名称......

无论如何，这是[反射手册](http://www.php.net/oop5.reflection)，以防万一您需要其中的东西。

# c# - 从父页面验证 ASP.NET 用户控件

> ID：255317
> 
> 赞同：7
> 
> 时间：2008-11-01T00:31:19.677
> 
> 标签：c#, asp.net, validation, user-controls, custom-controls

我有一个带有按钮的 asp.net 页面。此按钮生成用户控件并将其插入页面中，因此一个页面上可能存在许多控件。我需要验证生成的控件内是否存在某个动态生成的控件。

所以..Page 有 0 到 N 个 Control1。每个 Control 1 可以有 0 到 N 个 Control2。当在 Page 上单击 SaveButton 时，我需要确保每个 Control1 中至少有 1 个 Control2。

我目前在两个选项之间：

• 为每个生成的控件动态插入CustomValidators，每个控件都会验证一个Control1。

• 手动进行验证（使用jQuery），从SaveButton.OnClientClick 调用验证函数。

两者都以自己的方式草率——这就是我与大家分享这个的原因。我错过了简单的解决方案吗？

在此先感谢..（顺便说一句 - 包括 .NET 3.5 SP1 在内的任何东西都是公平的游戏）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-01T23:30:42.420

嗯，我喜欢 digiguru 建议的界面想法，但我会使用容器 Control1 上的界面而不是子控件，因为它似乎是代码存在的更合乎逻辑的地方。这是我的看法：

```
public interface IValidatableControl
{
    bool IsValidControl();    
} 
```

然后在你的 Control1 上实现这个

```
public class Control1 : IValidatableControl
{
... Other methods
    public bool IsValidControl()
    {

        foreach(object c in this.Controls)
        {
            if(c.GetType() == "Control2")
                return true;
        }
        return false;
    }

} 
```

可能有更好的方法来写这个，但它应该给你足够的想法来开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-01T18:56:18.323

如果您正在动态添加用户控件，您可以使用 Validate 函数使每个控件实现相同的接口。这样，您可以将控件加载到页面上每个父控件的占位符中。提交页面时，只需循环遍历占位符中的控件，将它们转换为接口类，然后调用 validate 函数。我不使用自定义验证器，但您可以使用从 validate 函数返回的对象构建验证错误列表，您可以以任何您喜欢的方式呈现此验证错误集合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-21T16:39:35.717

我认为你可以通过在 Control1 中分配一个引用 Control2 的 ID 存在的公共属性，然后用 ValidationProperty 装饰 Control1 的类来做到这一点。我在想一些事情：

```
[ValidationProperty("Control2Ref")]
public partial class Control1 : UserControl
{
    public string Control2Ref
    {
        get { return FindControl("Control2"); }
    }
    // rest of control 1 class
} 
```

然后您应该能够将RequiredFieldValidator 指向Control1 的一个实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-01T18:36:13.903

您可以尝试的一种方法是创建和维护一个表示您的自定义控件层次结构的简单 xml 结构。每当您创建或销毁自定义用户控件时，都可以在此结构中插入或删除。保存后，验证 xml 结构中表示的控制层次结构是否正确。您可以将 xml 保存在 Session 对象中以将其保留在回发中。

# c# - 为单个查询中的多个 SQL 选择的结果定义表名

> ID：255322
> 
> 赞同：5
> 
> 时间：2008-11-01T00:34:59.950
> 
> 标签：c#, sql, ado.net, dataadapter

例如，如果我运行以下查询：

```
select * from table1
select * from table2 
```

并使用数据库适配器（C#）运行它，我得到一个包含两个表的数据集。如何在 SQL 中定义结果表的名称？

我只能在 SQL 中执行此操作。我无权访问 c# 代码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-01T00:57:14.930

@Timothy Khouri：可以做到！编辑：但不是在 SQL 级别！

您可以在 DataAdapter 上使用 TableMappings。

如果 DataAdapter 的 SelectCommand 返回多个结果集，则 DataAdapter 使用表映射来填充 DataSet 中相应的 DataTable。默认情况下，第一个结果集将填充到名为“Table”的 DataTable，第二个结果集将填充到名为“Table1”的 DataTable，以此类推。

```
SqlDataAdapter sqlDa = new SqlDataAdapter();
SqlCommand selectCmd = new SqlCommand();
selectCmd.CommandText = "spReturnMultpileResultSets";
selectCmd.CommandType = CommandType.StoredProcedure;
selectCmd.Connection = this.sqlConnection1;
sqlDa.SelectCommand = selectCmd;

// Add table mappings to the SqlDataAdapter
sqlDa.TableMappings.Add("Table", "Customers");
sqlDa.TableMappings.Add("Table1", "Orders");

// DataSet1 is a strongly typed DataSet
DataSet1 ds = new DataSet1();

this.sqlConnection1.Open();

sqlDa.Fill(ds);

this.sqlConnection1.Close(); 
```

参考：

[http://blogs.msdn.com/vsdata/archive/2007/03/08/tableadapter-multiple-result-sets.aspx](http://blogs.msdn.com/vsdata/archive/2007/03/08/tableadapter-multiple-result-sets.aspx) [http://www.eggheadcafe.com/software/aspnet/32696845/strongly-typed-datasets .aspx](http://www.eggheadcafe.com/software/aspnet/32696845/strongly-typed-datasets.aspx)

# python - Python re.findall 与 groupdicts

> ID：255332
> 
> 赞同：16
> 
> 时间：2008-11-01T00:41:54.463
> 
> 标签：python, regex

我有点希望有一个版本`re.findall`返回`groupdict`s 而不仅仅是`group`s。我是否错过了一些简单的方法来完成相同的结果？（有人知道这个功能不存在的原因吗？）

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-01T00:52:19.213

您可以使用 finditer() 函数。这将为您提供一系列匹配对象，因此您可以通过以下方式获取每个对象的 groupdict：

```
[m.groupdict() for m in regex.finditer(search_string)] 
```

# events - 串行通信中的事件/中断

> ID：255337
> 
> 赞同：2
> 
> 时间：2008-11-01T00:46:03.097
> 
> 标签：events, serial-port

我想使用事件/中断从串行读取和写入。目前，我在一个while循环中使用它，它通过串行连续读写。我希望它仅在来自串行端口的内容时读取。如何在 C++ 中实现它？

这是我当前的代码：

```
    而（真）
    {
        //读
        if(!ReadFile(hSerial, szBuff, n, &dwBytesRead, NULL)){
        //错误发生。向用户报告。
        }

        //写
        if(!WriteFile(hSerial, szBuff, n, &dwBytesRead, NULL)){
        //错误发生。向用户报告。
        }

        //打印你正在阅读的内容
        printf("%s\n", szBuff);

    }

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-01T00:51:20.027

使用一个`select`语句，它会在不阻塞的情况下检查读写缓冲区并返回它们的状态，所以你只需要在知道端口有数据时读取，或者在知道输出缓冲区有空间时写入。

[http://www.developerweb.net/forum/showthread.php?t=2933](http://www.developerweb.net/forum/showthread.php?t=2933)上的第三个示例和相关评论可能会有所帮助。

**编辑：** select 的手册页在结尾处有一个更简单、更完整的示例。如果在您的系统上不起作用，您可以在[http://linux.die.net/man/2/select](http://linux.die.net/man/2/select)找到它。`man 2 select`

**注意：**掌握`select()`将允许您使用串行端口和套接字；它是许多网络客户端和服务器的核心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-01T01:31:51.553

对于 Windows 环境，更原生的方法是使用[异步 I/O](http://msdn.microsoft.com/en-us/library/aa365683(VS.85).aspx)。在这种模式下，您仍然使用对 ReadFile 和 WriteFile 的调用，但不是阻塞，而是传入一个将在操作完成时调用的回调函数。

但是，要正确处理所有细节是相当棘手的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-01T02:57:05.733

这是几年前在 c/C++ 用户杂志上发表的[一篇文章](http://www.ewoodruff.us/CUJArticle/CUJArticle.html)的副本。它详细介绍了 Win32 API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T10:54:32.443

这里有一个代码在windows上使用中断读取串行传入数据你可以看到在等待中断时间内经过的时间

```

`int pollComport(int comport_number, LPBYTE buffer, int size)
{
    BYTE Byte;
    DWORD dwBytesTransferred;
    DWORD      dwCommModemStatus;
    int n;

    double TimeA,TimeB;
    // Specify a set of events to be monitored for the port.
    SetCommMask (m_comPortHandle[comport_number], EV_RXCHAR );

    while (m_comPortHandle[comport_number] != INVALID_HANDLE_VALUE) 
    {
        // Wait for an event to occur for the port.
        TimeA = clock();
        WaitCommEvent (m_comPortHandle[comport_number], &dwCommModemStatus, 0);
        TimeB = clock();
        if(TimeB-TimeA>0)
        cout <<"              ok            "<<TimeB-TimeA<<endl;

        // Re-specify the set of events to be monitored for the port.
        SetCommMask (m_comPortHandle[comport_number], EV_RXCHAR);

        if (dwCommModemStatus & EV_RXCHAR) 
        {
            // Loop for waiting for the data.
            do 
            {
               ReadFile(m_comPortHandle[comport_number], buffer, size, (LPDWORD)((void *)&n), NULL);

              // Display the data read.
              if (n>0)
                  cout << buffer <<endl;
            } while (n > 0);
        }
      return(0);
    }
}` 

c# - 获取通用字典的指定值的多个键？

ID：255341

赞同：126

时间：2008-11-01T00:49:07.973

标签：c#, .net

从 .NET 通用字典中获取键的值很容易：

```
Dictionary<int, string> greek = new Dictionary<int, string>();
greek.Add(1, "Alpha");
greek.Add(2, "Beta");
string secondGreek = greek[2];  // Beta 
```

但是尝试获取给定值的键并不那么简单，因为可能有多个键：

```
int[] betaKeys = greek.WhatDoIPutHere("Beta");  // expecting single 2 
```

            回答 #1

赞同：150

时间：2008-11-01T08:03:09.360

好的，这是多个双向版本：

```
using System;
using System.Collections.Generic;
using System.Text;

class BiDictionary<TFirst, TSecond>
{
    IDictionary<TFirst, IList<TSecond>> firstToSecond = new Dictionary<TFirst, IList<TSecond>>();
    IDictionary<TSecond, IList<TFirst>> secondToFirst = new Dictionary<TSecond, IList<TFirst>>();

    private static IList<TFirst> EmptyFirstList = new TFirst[0];
    private static IList<TSecond> EmptySecondList = new TSecond[0];

    public void Add(TFirst first, TSecond second)
    {
        IList<TFirst> firsts;
        IList<TSecond> seconds;
        if (!firstToSecond.TryGetValue(first, out seconds))
        {
            seconds = new List<TSecond>();
            firstToSecond[first] = seconds;
        }
        if (!secondToFirst.TryGetValue(second, out firsts))
        {
            firsts = new List<TFirst>();
            secondToFirst[second] = firsts;
        }
        seconds.Add(second);
        firsts.Add(first);
    }

    // Note potential ambiguity using indexers (e.g. mapping from int to int)
    // Hence the methods as well...
    public IList<TSecond> this[TFirst first]
    {
        get { return GetByFirst(first); }
    }

    public IList<TFirst> this[TSecond second]
    {
        get { return GetBySecond(second); }
    }

    public IList<TSecond> GetByFirst(TFirst first)
    {
        IList<TSecond> list;
        if (!firstToSecond.TryGetValue(first, out list))
        {
            return EmptySecondList;
        }
        return new List<TSecond>(list); // Create a copy for sanity
    }

    public IList<TFirst> GetBySecond(TSecond second)
    {
        IList<TFirst> list;
        if (!secondToFirst.TryGetValue(second, out list))
        {
            return EmptyFirstList;
        }
        return new List<TFirst>(list); // Create a copy for sanity
    }
}

class Test
{
    static void Main()
    {
        BiDictionary<int, string> greek = new BiDictionary<int, string>();
        greek.Add(1, "Alpha");
        greek.Add(2, "Beta");
        greek.Add(5, "Beta");
        ShowEntries(greek, "Alpha");
        ShowEntries(greek, "Beta");
        ShowEntries(greek, "Gamma");
    }

    static void ShowEntries(BiDictionary<int, string> dict, string key)
    {
        IList<int> values = dict[key];
        StringBuilder builder = new StringBuilder();
        foreach (int value in values)
        {
            if (builder.Length != 0)
            {
                builder.Append(", ");
            }
            builder.Append(value);
        }
        Console.WriteLine("{0}: [{1}]", key, builder);
    }
} 
```

            回答 #2

赞同：75

时间：2008-11-01T07:51:45.560

正如其他人所说，字典中没有从值到键的映射。

**我刚刚注意到您想从值映射到多个键 - 我将这里的解决方案留给单值版本，但我将为多条目双向映射添加另一个答案。**

这里采用的正常方法是有两个字典 - 一个映射一种方式，一个映射另一种。将它们封装在一个单独的类中，并确定当您有重复的键或值时您想要做什么（例如，抛出异常、覆盖现有条目或忽略新条目）。就个人而言，我可能会抛出异常 - 它使成功行为更容易定义。像这样的东西：

```
using System;
using System.Collections.Generic;

class BiDictionary<TFirst, TSecond>
{
    IDictionary<TFirst, TSecond> firstToSecond = new Dictionary<TFirst, TSecond>();
    IDictionary<TSecond, TFirst> secondToFirst = new Dictionary<TSecond, TFirst>();

    public void Add(TFirst first, TSecond second)
    {
        if (firstToSecond.ContainsKey(first) ||
            secondToFirst.ContainsKey(second))
        {
            throw new ArgumentException("Duplicate first or second");
        }
        firstToSecond.Add(first, second);
        secondToFirst.Add(second, first);
    }

    public bool TryGetByFirst(TFirst first, out TSecond second)
    {
        return firstToSecond.TryGetValue(first, out second);
    }

    public bool TryGetBySecond(TSecond second, out TFirst first)
    {
        return secondToFirst.TryGetValue(second, out first);
    }
}

class Test
{
    static void Main()
    {
        BiDictionary<int, string> greek = new BiDictionary<int, string>();
        greek.Add(1, "Alpha");
        greek.Add(2, "Beta");
        int x;
        greek.TryGetBySecond("Beta", out x);
        Console.WriteLine(x);
    }
} 
```

            回答 #3

赞同：26

时间：2008-11-01T01:02:59.943

字典并不是真的要像这样工作，因为虽然保证了键的唯一性，但值的唯一性却没有。所以，如果你有

```
var greek = new Dictionary<int, string> { { 1, "Alpha" }, { 2, "Alpha" } }; 
```

你期望得到`greek.WhatDoIPutHere("Alpha")`什么？

因此，你不能指望这样的东西会被纳入框架。您需要自己的方法来实现自己的独特用途——您想返回一个数组（或`IEnumerable<T>`）吗？如果有多个具有给定值的键，你想抛出异常吗？如果没有怎么办？

就我个人而言，我会选择一个可枚举的，如下所示：

```
IEnumerable<TKey> KeysFromValue<TKey, TValue>(this Dictionary<TKey, TValue> dict, TValue val)
{
    if (dict == null)
    {
        throw new ArgumentNullException("dict");
    }
    return dict.Keys.Where(k => dict[k] == val);
}

var keys = greek.KeysFromValue("Beta");
int exceptionIfNotExactlyOne = greek.KeysFromValue("Beta").Single(); 
```

            回答 #4

赞同：23

时间：2008-11-01T01:03:33.717

在没有 Linq 的情况下，最简单的方法可能是遍历这些对：

```
int betaKey; 
foreach (KeyValuePair<int, string> pair in lookup)
{
    if (pair.Value == value)
    {
        betaKey = pair.Key; // Found
        break;
    }
}
betaKey = -1; // Not found 
```

如果你有 Linq，它可以通过这种方式轻松完成：

```
int betaKey = greek.SingleOrDefault(x => x.Value == "Beta").Key; 
```

            回答 #5

赞同：3

时间：2008-11-01T01:40:53.733

字典不保留值的散列，只保留键，因此使用值对其进行的任何搜索都至少需要线性时间。您最好的选择是简单地遍历字典中的元素并跟踪匹配的键或切换到不同的数据结构，也许维护两个字典映射 key->value 和 value->List_of_keys。如果你做后者，你将用存储来换取查找速度。将@Cybis 示例转换为这样的数据结构并不需要太多。

            回答 #6

赞同：3

时间：2016-10-13T12:09:00.150

因为我想要一个完整的双向字典（而不仅仅是地图），所以我添加了缺少的函数以使其成为 IDictionary 兼容类。这是基于具有唯一键值对的版本。如果需要，这是文件（大部分工作是通过 XMLDoc）：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Common
{
    /// <summary>Represents a bidirectional collection of keys and values.</summary>
    /// <typeparam name="TFirst">The type of the keys in the dictionary</typeparam>
    /// <typeparam name="TSecond">The type of the values in the dictionary</typeparam>
    [System.Runtime.InteropServices.ComVisible(false)]
    [System.Diagnostics.DebuggerDisplay("Count = {Count}")]
    //[System.Diagnostics.DebuggerTypeProxy(typeof(System.Collections.Generic.Mscorlib_DictionaryDebugView<,>))]
    //[System.Reflection.DefaultMember("Item")]
    public class BiDictionary<TFirst, TSecond> : Dictionary<TFirst, TSecond>
    {
        IDictionary<TSecond, TFirst> _ValueKey = new Dictionary<TSecond, TFirst>();
        /// <summary> PropertyAccessor for Iterator over KeyValue-Relation </summary>
        public IDictionary<TFirst, TSecond> KeyValue => this;
        /// <summary> PropertyAccessor for Iterator over ValueKey-Relation </summary>
        public IDictionary<TSecond, TFirst> ValueKey => _ValueKey;

        #region Implemented members

        /// <Summary>Gets or sets the value associated with the specified key.</Summary>
        /// <param name="key">The key of the value to get or set.</param>
        /// <Returns>The value associated with the specified key. If the specified key is not found,
        ///      a get operation throws a <see cref="KeyNotFoundException"/>, and
        ///      a set operation creates a new element with the specified key.</Returns>
        /// <exception cref="T:System.ArgumentNullException"><paramref name="key"/> is null.</exception>
        /// <exception cref="T:System.Collections.Generic.KeyNotFoundException">
        /// The property is retrieved and <paramref name="key"/> does not exist in the collection.</exception>
        /// <exception cref="T:System.ArgumentException"> An element with the same key already
        /// exists in the <see cref="ValueKey"/> <see cref="Dictionary&lt;TFirst,TSecond&gt;"/>.</exception>
        public new TSecond this[TFirst key]
        {
            get { return base[key]; }
            set { _ValueKey.Remove(base[key]); base[key] = value; _ValueKey.Add(value, key); }
        }

        /// <Summary>Gets or sets the key associated with the specified value.</Summary>
        /// <param name="val">The value of the key to get or set.</param>
        /// <Returns>The key associated with the specified value. If the specified value is not found,
        ///      a get operation throws a <see cref="KeyNotFoundException"/>, and
        ///      a set operation creates a new element with the specified value.</Returns>
        /// <exception cref="T:System.ArgumentNullException"><paramref name="val"/> is null.</exception>
        /// <exception cref="T:System.Collections.Generic.KeyNotFoundException">
        /// The property is retrieved and <paramref name="val"/> does not exist in the collection.</exception>
        /// <exception cref="T:System.ArgumentException"> An element with the same value already
        /// exists in the <see cref="KeyValue"/> <see cref="Dictionary&lt;TFirst,TSecond&gt;"/>.</exception>
        public TFirst this[TSecond val]
        {
            get { return _ValueKey[val]; }
            set { base.Remove(_ValueKey[val]); _ValueKey[val] = value; base.Add(value, val); }
        }

        /// <Summary>Adds the specified key and value to the dictionary.</Summary>
        /// <param name="key">The key of the element to add.</param>
        /// <param name="value">The value of the element to add.</param>
        /// <exception cref="T:System.ArgumentNullException"><paramref name="key"/> or <paramref name="value"/> is null.</exception>
        /// <exception cref="T:System.ArgumentException">An element with the same key or value already exists in the <see cref="Dictionary&lt;TFirst,TSecond&gt;"/>.</exception>
        public new void Add(TFirst key, TSecond value) {
            base.Add(key, value);
            _ValueKey.Add(value, key);
        }

        /// <Summary>Removes all keys and values from the <see cref="Dictionary&lt;TFirst,TSecond&gt;"/>.</Summary>
        public new void Clear() { base.Clear(); _ValueKey.Clear(); }

        /// <Summary>Determines whether the <see cref="Dictionary&lt;TFirst,TSecond&gt;"/> contains the specified
        ///      KeyValuePair.</Summary>
        /// <param name="item">The KeyValuePair to locate in the <see cref="Dictionary&lt;TFirst,TSecond&gt;"/>.</param>
        /// <Returns>true if the <see cref="Dictionary&lt;TFirst,TSecond&gt;"/> contains an element with
        ///      the specified key which links to the specified value; otherwise, false.</Returns>
        /// <exception cref="T:System.ArgumentNullException"><paramref name="item"/> is null.</exception>
        public bool Contains(KeyValuePair<TFirst, TSecond> item) => base.ContainsKey(item.Key) & _ValueKey.ContainsKey(item.Value);

        /// <Summary>Removes the specified KeyValuePair from the <see cref="Dictionary&lt;TFirst,TSecond&gt;"/>.</Summary>
        /// <param name="item">The KeyValuePair to remove.</param>
        /// <Returns>true if the KeyValuePair is successfully found and removed; otherwise, false. This
        ///      method returns false if <paramref name="item"/> is not found in the <see cref="Dictionary&lt;TFirst,TSecond&gt;"/>.</Returns>
        /// <exception cref="T:System.ArgumentNullException"><paramref name="item"/> is null.</exception>
        public bool Remove(KeyValuePair<TFirst, TSecond> item) => base.Remove(item.Key) & _ValueKey.Remove(item.Value);

        /// <Summary>Removes the value with the specified key from the <see cref="Dictionary&lt;TFirst,TSecond&gt;"/>.</Summary>
        /// <param name="key">The key of the element to remove.</param>
        /// <Returns>true if the element is successfully found and removed; otherwise, false. This
        ///      method returns false if <paramref name="key"/> is not found in the <see cref="Dictionary&lt;TFirst,TSecond&gt;"/>.</Returns>
        /// <exception cref="T:System.ArgumentNullException"><paramref name="key"/> is null.</exception>
        public new bool Remove(TFirst key) => _ValueKey.Remove(base[key]) & base.Remove(key);

        /// <Summary>Gets the key associated with the specified value.</Summary>
        /// <param name="value">The value of the key to get.</param>
        /// <param name="key">When this method returns, contains the key associated with the specified value,
        ///      if the value is found; otherwise, the default value for the type of the key parameter.
        ///      This parameter is passed uninitialized.</param>
        /// <Returns>true if <see cref="ValueKey"/> contains an element with the specified value; 
        ///      otherwise, false.</Returns>
        /// <exception cref="T:System.ArgumentNullException"><paramref name="value"/> is null.</exception>
        public bool TryGetValue(TSecond value, out TFirst key) => _ValueKey.TryGetValue(value, out key);
        #endregion
    }
} 
```

            回答 #7

赞同：2

时间：2008-11-01T00:57:14.150

修订：可以找到某种查找，您将需要字典以外的东西，因为如果您考虑一下，字典是单向键。也就是说，这些值可能不是唯一的

那就是说您似乎正在使用 c#3.0，因此您可能不必求助于循环，并且可以使用以下内容：

```
var key = (from k in yourDictionary where string.Compare(k.Value, "yourValue", true)  == 0 select k.Key).FirstOrDefault(); 
```

            回答 #8

赞同：2

时间：2008-11-01T08:16:11.423

字典类没有针对这种情况进行优化，但如果你真的想这样做（在 C# 2.0 中），你可以这样做：

```
public List<TKey> GetKeysFromValue<TKey, TVal>(Dictionary<TKey, TVal> dict, TVal val)
{
   List<TKey> ks = new List<TKey>();
   foreach(TKey k in dict.Keys)
   {
      if (dict[k] == val) { ks.Add(k); }
   }
   return ks;
} 
```

我更喜欢优雅的 LINQ 解决方案，但这是 2.0 的方式。

            回答 #9

赞同：1

时间：2008-11-01T01:17:40.990

您不能创建具有该功能的 Dictionary 子类吗？

```
 public class MyDict < TKey, TValue > : Dictionary < TKey, TValue >
    {
        private Dictionary < TValue, TKey > _keys;

        public TValue this[TKey key]
        {
            get
            {
                return base[key];
            }
            set 
            { 
                base[key] = value;
                _keys[value] = key;
            }
        }

        public MyDict()
        {
            _keys = new Dictionary < TValue, TKey >();
        }

        public TKey GetKeyFromValue(TValue value)
        {
            return _keys[value];
        }
    } 

```

编辑：对不起，第一次没有得到正确的代码。

            回答 #10

赞同：1

时间：2012-08-07T20:05:46.920

```
Dictionary<string, string> dic = new Dictionary<string, string>();
dic["A"] = "Ahmed";
dic["B"] = "Boys";

foreach (string mk in dic.Keys)
{
    if(dic[mk] == "Ahmed")
    {
        Console.WriteLine("The key that contains \"Ahmed\" is " + mk);
    }
} 
```

            回答 #11

赞同：1

时间：2013-04-24T17:45:12.470

这里提出的“简单”双向字典解决方案很复杂，可能难以理解、维护或扩展。最初的问题也要求“值的键”，但显然可能有多个键（我已经编辑了这个问题）。整个方法相当可疑。

软件变更。编写易于维护的代码应该优先考虑其他“聪明”的复杂解决方法。从字典中的值取回键的方法是循环。字典并非设计为双向的。

            回答 #12

赞同：1

时间：2014-03-06T16:49:15.350

使用**LINQ**进行反向`Dictionary<K, V>`查找。但请记住，您的价值观中的`Dictionary<K, V>`价值观可能并不明显。

**示范：**

```
using System;
using System.Collections.Generic;
using System.Linq;

class ReverseDictionaryLookupDemo
{
    static void Main()
    {
        var dict = new Dictionary<int, string>();
        dict.Add(4, "Four");
        dict.Add(5, "Five");
        dict.Add(1, "One");
        dict.Add(11, "One"); // duplicate!
        dict.Add(3, "Three");
        dict.Add(2, "Two");
        dict.Add(44, "Four"); // duplicate!

        Console.WriteLine("\n== Enumerating Distinct Values ==");
        foreach (string value in dict.Values.Distinct())
        {
            string valueString =
                String.Join(", ", GetKeysFromValue(dict, value));

            Console.WriteLine("{0} => [{1}]", value, valueString);
        }
    }

    static List<int> GetKeysFromValue(Dictionary<int, string> dict, string value)
    {
        // Use LINQ to do a reverse dictionary lookup.
        // Returns a 'List<T>' to account for the possibility
        // of duplicate values.
        return
            (from item in dict
             where item.Value.Equals(value)
             select item.Key).ToList();
    }
} 
```

**预期输出：**

```
== Enumerating Distinct Values ==
Four => [4, 44]
Five => [5]
One => [1, 11]
Three => [3]
Two => [2] 
```

            回答 #13

赞同：1

时间：2020-08-20T07:39:39.497

*许多这些答案现在已经过时了，这是一种现代 C# 方法，使用 LINQ*
由于值不一定是唯一的，因此您可能会得到多个结果。您可以返回`IEnumerable<KeyValuePair<int, string>>`：

```
var betaKeys = greek.Where(x => x.Value == "beta"); 
```

要将其转换为`IEnumerable<int>`类型，只需使用`.Select()`：

```
var betaKeys = greek.Where(x => x.Value == "beta").Select(x => x.Key); 
```

            回答 #14

赞同：0

时间：2014-11-03T22:01:28.280

作为已接受答案（[https://stackoverflow.com/a/255638/986160](https://stackoverflow.com/a/255638/986160)）的转折，假设键将与字典中的信号值相关联。类似于 ( [https://stackoverflow.com/a/255630/986160](https://stackoverflow.com/a/255630/986160) ) 但更优雅一点。新颖之处在于消费类可以用作枚举替代方案（但也适用于字符串），并且字典实现了 IEnumerable。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections;

namespace MyApp.Dictionaries
{

    class BiDictionary<TFirst, TSecond> : IEnumerable
    {
        IDictionary<TFirst, TSecond> firstToSecond = new Dictionary<TFirst, TSecond>();
        IDictionary<TSecond, TFirst> secondToFirst = new Dictionary<TSecond, TFirst>();

        public void Add(TFirst first, TSecond second)
        {
            firstToSecond.Add(first, second);
            secondToFirst.Add(second, first);
        }

        public TSecond this[TFirst first]
        {
            get { return GetByFirst(first); }
        }

        public TFirst this[TSecond second]
        {
            get { return GetBySecond(second); }
        }

        public TSecond GetByFirst(TFirst first)
        {
            return firstToSecond[first];
        }

        public TFirst GetBySecond(TSecond second)
        {
            return secondToFirst[second];
        }

        public IEnumerator GetEnumerator()
        {
            return GetFirstEnumerator();
        }

        public IEnumerator GetFirstEnumerator()
        {
            return firstToSecond.GetEnumerator();
        }

        public IEnumerator GetSecondEnumerator()
        {
            return secondToFirst.GetEnumerator();
        }
    }
} 
```

作为一个消费阶层，你可以拥有

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace MyApp.Dictionaries
{
    class Greek
    {

        public static readonly string Alpha = "Alpha";
        public static readonly string Beta = "Beta";
        public static readonly string Gamma = "Gamma";
        public static readonly string Delta = "Delta";

        private static readonly BiDictionary<int, string> Dictionary = new BiDictionary<int, string>();

        static Greek() {
            Dictionary.Add(1, Alpha);
            Dictionary.Add(2, Beta);
            Dictionary.Add(3, Gamma);
            Dictionary.Add(4, Delta);
        }

        public static string getById(int id){
            return Dictionary.GetByFirst(id);
        }

        public static int getByValue(string value)
        {
            return Dictionary.GetBySecond(value);
        }

    }
} 
```

            回答 #15

赞同：0

时间：2018-06-07T01:30:16.337

然后外行的解决方案
可以编写类似于下面的函数来制作这样的字典：

```
 public Dictionary<TValue, TKey> Invert(Dictionary<TKey, TValue> dict) {
    Dictionary<TValue, TKey> ret = new Dictionary<TValue, TKey>();
    foreach (var kvp in dict) {ret[kvp.value] = kvp.key;} return ret; } 
```

        agile - 你能推荐一个免费的 Windows 任务板/燃尽工具吗？

ID：255350

赞同：29

时间：2008-11-01T00:59:44.223

标签：agile

真的没有太多要补充的主题。

我正在寻找适用于 Windows 的免费任务板/燃尽报告工具。

            回答 #1

赞同：23

时间：2008-11-08T21:42:26.803

如果您愿意托管您的工具，

*   目标进程（[http://www.targetprocess.com/](http://www.targetprocess.com/Product/agile_tour.aspx)）
*   XPlanner（[http://xplanner.codehaus.org/](http://xplanner.codehaus.org/)）

如果不，

*   关键跟踪器 ( [http://www.pivotaltracker.com/](http://www.pivotaltracker.com/) )
*   ScrumWorks ( [http://danube.com/scrumworks/basic](http://danube.com/scrumworks/basic) )

所有这些都是免费的或有免费版本。

            回答 #2

赞同：15

时间：2008-11-09T18:24:20.167

根据您的实际需求，解决方案范围包括：

*   手写卡片，辅以手动绘制的燃尽图，作为  Ilja 推荐的[大可见图表](http://xprogramming.com/articles/bigvisiblecharts/)
*   具有自动燃尽图生成的基于电子表格的列表（[示例](http://agilesoftwaredevelopment.com/scrum/simple-sprint-backlog)）
*   在线工具，例如[scrumy](http://scrumy.com/)、[scrumpad](http://www.scrumpad.com/)和  [skinnyboard](http://skinnyboard.com/) 
*   具有 Web 访问权限的本地应用程序

    *   免费的[ScrumWorks 基础](http://www.danube.com/scrumworks/basic)版，[Icescrum2](http://www.icescrum.org)

    *   或商业[ScrumWorks Pro ](http://www.danube.com/scrumworks/pro) [ProjectCards](http://www.projectcards.com/)，或者如 Eliza 推荐的  [TargetProcess](http://www.targetprocess.com/Product.aspx) 

但是请记住，[敏捷宣言](http://agilemanifesto.org/)建议支持“个人和交互胜过流程和工具”。

我建议从小处着手，如果您坚持使用自动燃尽图，也许可以使用电子表格。

            回答 #3

赞同：6

时间：2009-09-21T16:36:18.067

在 www.seenowdo.com 上查看 SeeNowDo

这是分布式敏捷团队的免费在线任务板。它非常酷，并提供了方便的功能，例如“始终在线”和“即时同步”功能。一旦你有很多任务，它也有一些很酷的方法来管理任务板布局。最重要的是，它是*完全*免费的。

            回答 #4

赞同：4

时间：2012-01-10T03:08:35.930

**显然我必须透露我制造了这个产品**

您可能想尝试：[http ://www.burndown-charts.com](http://www.burndown-charts.com)

这是一个用于管理燃尽图的免费网络应用程序。您创建了一个团队和一个 sprint，然后您就可以开始了。完成后输入您的任务。非常适合当您仍想保留白板和/或便利贴时。如果需要，您可以将队友添加到您的团队中。

你不会花一个小时弄清楚如何使用它。

            回答 #5

赞同：3

时间：2009-02-16T19:31:57.417

这正是 Scrumy.com 的所在。这是一个带有便签的白板。专业版有烧毁。

            回答 #6

赞同：3

时间：2010-05-21T23:53:18.770

试试[名乐](http://www.thoughtworks-studios.com/mingle-agile-project-management)。它对最多 5 个用户免费。

            回答 #7

赞同：3

时间：2010-05-26T10:08:18.203

开源应用程序： http: [//taskboard.cognifide.com/](http://taskboard.cognifide.com/)

快速、整洁的工具:)

            回答 #8

赞同：2

时间：2012-10-11T12:52:17.757

**编辑**

好的，我们正在做的事情正是你所要求的，而且做得更多：

*   可操作的指标
*   强大的分析
*   所有这一切都在一个光滑的仪表板上

它旨在消除使用 excel 表来手动构建您自己的报告。这是一个更好的解决方案，目前处于测试阶段。

注册并参与测试，以确保您的功能得到很好的覆盖！
[http://www.in-sight.io](http://www.in-sight.io)

            回答 #9

赞同：1

时间：2008-11-01T15:32:16.847

好吧，在不了解您的情况的情况下，我必须*强烈*推荐一面索引卡墙和一张挂图纸上的手绘图表。在标准情况下比任何软件都好用。

如果您真的必须使用软件，我可以毫无保留地推荐任何软件，更不用说免费的了。您可能要记住，一些商业项目对于开源或学术项目也是免费的。除其他事项外，哪个适合您将取决于您希望它定义您的流程的程度。

            回答 #10

赞同：1

时间：2008-11-08T21:37:44.783

您可以考虑使用电子表格创建自己的解决方案。通过这种方式，您可以在数据输入和报告功能方面获得较低的开销，而无需使用外部工具来定义您的流程。

特别是在单人项目上（因为这似乎来自对 Ilja Preuß 答案的评论），我发现一个简单的电子表格实际上对我来说效果更好。

我将所有任务保存在一个工作簿中，将有趣数据和计算的公式保存在一个单独的工作簿中。

            回答 #11

赞同：1

时间：2009-12-04T19:22:47.893

我制作了一个基本插件，可以插入到 google wave 中并用作任务板。[http://agilebooknote.blogspot.com/2009/11/taskboardy-available.html](http://agilebooknote.blogspot.com/2009/11/taskboardy-available.html)中的更多详细信息。干杯，-喂

            回答 #12

赞同：1

时间：2011-06-14T23:39:16.437

我是 google docs 的粉丝，因为它很简单，也因为我可以访问我的团队，以便他们可以每天更新他们的任务。我使用的模板和如何使用它的教程可在

[燃尽图教程：简单的敏捷项目跟踪](http://joel.inpointform.net/software-development/burn-down-charts-tutorial-simple-agile-project-tracking/)

            回答 #13

赞同：1

时间：2013-04-10T18:46:54.740

我知道这是旧线程，但我遇到了这个问题，正在寻找类似的东西。我注册了 AgileZen ( [http://www.agilezen.com/](http://www.agilezen.com/) )，它实际上非常好。

我想要一些免费的东西，我和妻子可以用来做个人/家庭用品。如果您只愿意拥有一个项目（我称之为“家”）和另一个合作者（我的妻子），它是免费的。这对我们来说是一个很好的解决方案。

我保证我和他们没有任何关系！除了我现在使用他们的产品。

            回答 #14

赞同：0

时间：2012-10-11T13:03:23.590

如果您的项目是开源的、非营利性的或课堂项目，您可以免费使用 Atlassians 的 JIRA + Greenhopper（和其他工具）来进行敏捷项目管理。否则，小团队只需象征性的费用即可获得访问权限。

请参阅[http://www.atlassian.com/software/greenhopper/overview](http://www.atlassian.com/software/greenhopper/overview)和[http://www.atlassian.com/software/jira/overview](http://www.atlassian.com/software/jira/overview)。

如果您是开源项目，请参阅[http://www.atlassian.com/software/views/open-source-license-request 。](http://www.atlassian.com/software/views/open-source-license-request)

[http://www.atlassian.com/software/views/community-license-request](http://www.atlassian.com/software/views/community-license-request)如果您是非营利组织

和

[http://www.atlassian.com/survey/classroom-license-request](http://www.atlassian.com/survey/classroom-license-request)如果您是教室。

        java - 为 Eclipse 插件开发自动化单元测试 (junit)

ID：255370

赞同：16

时间：2008-11-01T01:20:41.683

标签：java, testing, junit, eclipse-pde, eclipse-3.4

我正在开发 Eclipse 插件，我需要能够为每个插件自动构建和执行测试套件。（使用 Junit）

测试在 Eclipse 中工作，我可以将插件分解为实际插件和用于单元测试的片段插件，如此处、[此处和](http://rcpquickstart.com/2007/08/06/running-automated-tests-with-pde-build/)[此处](http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.test/testframework.html?view=co)的几个地方[所述](http://eclipsenuggets.blogspot.com/2007/09/6-great-links-for-eclipse-build.html)。

但是，上述每种方法都会导致相同的问题：发出构建或应该触发测试的 java ant 任务/命令行命令不会产生可观察到的副作用，并返回值“13”。我已经尝试了所有我能找到的东西，并且我对 Eclipse 的启动方式有了一些了解（例如：从 v3.3 开始，您不能再使用 startup.jar - 它不存在 - 但您应该使用[org.eclipse.equinox.launcher](http://blog.ciscavate.org/2008/11/treat-your-mailing-lists-like-reference-documents-please.html)）。不幸的是，虽然这显然是必要的信息，但还远远不够。

我正在使用 Eclipse 3.4、Junit 4.3.1（org.junit4 捆绑包，但我更愿意使用 JUnit 4.4。请参见[此处](https://stackoverflow.com/questions/251791)。）

所以，我的问题是：您究竟如何自动化 Eclipse 插件的构建和测试？

*编辑：*澄清一下，我*想*使用类似 ant + 巡航控制的东西，但我什至无法让单元测试*在*Eclipse 之外运行。我说“类似”是因为有其他技术可以完成同样的事情，而且我不会因为使用 Maven 或 Buckminster 等技术而放弃一个可行的解决方案，如果这些技术使这变得更容易的话。

*Edit2：*上面提到的'Java Result 13'似乎是由于找不到coretestrunner造成的。从日志：

```
java.lang.RuntimeException: Application "org.eclipse.test.coretestapplication" could not be found in the registry. The applications available are: org.eclipse.equinox.app.error, com.rcpquickstart.helloworld.application.
    at org.eclipse.equinox.internal.app.EclipseAppContainer.startDefaultApp(EclipseAppContainer.java:242)
    at org.eclipse.equinox.internal.app.MainApplicationLauncher.run(MainApplicationLauncher.java:29)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:382)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:549)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:504)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1236)
    at org.eclipse.equinox.launcher.Main.main(Main.java:1212)
    at org.eclipse.core.launcher.Main.main(Main.java:30)

!ENTRY org.eclipse.osgi 2 0 2008-11-04 21:02:10.514
!MESSAGE The following is a complete list of bundles which are not resolved, see the prior log entry for the root cause if it exists:
!SUBENTRY 1 org.eclipse.osgi 2 0 2008-11-04 21:02:10.515
!MESSAGE Bundle update@plugins/org.eclipse.test_3.2.0/ [34] was not resolved.
!SUBENTRY 2 org.eclipse.test 2 0 2008-11-04 21:02:10.516
!MESSAGE Missing required bundle org.apache.ant_0.0.0.
!SUBENTRY 2 org.eclipse.test 2 0 2008-11-04 21:02:10.516
!MESSAGE Missing required bundle org.eclipse.ui.ide.application_0.0.0.
!SUBENTRY 1 org.eclipse.osgi 2 0 2008-11-04 21:02:10.518
!MESSAGE Bundle update@plugins/org.eclipse.ant.optional.junit_3.2.100.jar [60] was not resolved.
!SUBENTRY 2 org.eclipse.ant.optional.junit 2 0 2008-11-04 21:02:10.519
!MESSAGE Missing host org.apache.ant_[1.6.5,2.0.0).
!SUBENTRY 2 org.eclipse.ant.optional.junit 2 0 2008-11-04 21:02:10.519
!MESSAGE Missing required bundle org.eclipse.core.runtime.compatibility_0.0.0. 
```

            回答 #1

赞同：12

时间：2008-11-13T20:00:28.997

我刚刚将 JUnit 测试作为我们 RCP 应用程序的无头构建的一部分。

我发现这篇文章 - [Automating Eclipse PDE Unit Tests using Ant](http://www.eclipse.org/articles/article.php?file=Article-PDEJUnitAntAutomation/index.html)非常有帮助。它提供了帮助您入门的代码和方法。但是，我发现了一些事情：

关于文章的代码

*   只有一个包在测试中（我们使用[Buckminster](http://wiki.eclipse.org/Buckminster_Project)将构建过程从代码中分离出来）
*   只有一个测试班。
*   这些都被有效地硬编码到构建脚本中

关于 Eclipse PDE

*   需要`uitestapplication`另一个`testApplication`。使用`coretestapplication`不。
*   因为这些应用程序都在依赖于 SWT 的包中。在大多数情况下，这是一个交易杀手，但如果您的构建机器是 Windows 机器，则不是。我希望看到这些拆分成非 UI 包。

我发现提供的代码是一个很好的起点，但在其实现中隐含了许多上述假设。

发现这些假设后，做这项工作就相对简单了。

我们新的闪亮设置

*   buckminster 构建捆绑包。
*   target 将包从目标平台、org.eclipse.pde.runtime 和 org.eclipse.jdt.junit 复制到“tester-eclipse-install”中。这应该可以解决您的`Java Result 13`问题。
*   通过查看工作区找到测试片段
*   通过查看清单找到片段主机
*   通过查看工作区中的项目找到测试类。
*   注册一个`PDETestListener`修改来处理多个测试类
*   使用多个测试类调用 tester-eclipse-install。

我还阅读[了插件和功能的构建和测试自动化，](http://www.eclipse.org/articles/Article-PDE-Automation/automation.html)但我们没有直接使用 PDE-Build。

            回答 #2

赞同：3

时间：2015-01-13T23:04:00.677

对于仍在寻找在 Eclipse 之外执行 Eclipse 插件测试的方法的任何人，以下命令对我有用：

```
java -Xms40m -Xmx1024m -XX:MaxPermSize=512m -Dorg.eclipse.swt.browser.DefaultType=mozilla -Declipse.pde.launch=true -classpath C:\eclipse\eclipse-standard-luna-M2-win32-x86_64\eclipse\plugins/org.eclipse.equinox.launcher_1.3.0.v20130327-1440.jar org.eclipse.equinox.launcher.Main -port 22 -testLoaderClass org.eclipse.jdt.internal.junit4.runner.JUnit4TestLoader -loaderpluginname org.eclipse.jdt.junit4.runtime -classNames testpackage.testClass -application org.eclipse.pde.junit.runtime.uitestapplication -data C:\temp\log.temp -dev bin -consoleLog -testpluginname PluginName 
```

`-classpath`应设置为 Eclipse 启动器 jar。您可以从`eclipse.ini`文件中获取 Eclipse 的确切版本。

`-className`是junit插件测试文件名

`-data`设置为临时文件。

`-testpluginname`是您要测试的插件的名称。

            回答 #3

赞同：2

时间：2009-06-08T07:41:27.460

查看您的异常，它说缺少 coretestapplication。可以在 plugins/org.eclipse.test_3.1.0/library.xml:10 中找到 ant 目标

这实际上是一个依赖问题。Eclipse 需要拥有所有插件才能构建。

要正确配置它，需要查看 2 个文件。

1.  产品档案
2.  特征.xml

**产品**

确保您的产品文件包含您需要的所有插件。

之后，添加 org.eclipse.rcp 和 org.eclipse.test 特性

...插件在上面...

```
<features>
      <feature id="mock_feature" version="1.0.0"/>
      <feature id="mock_feature_test" version="1.0.0"/>
      <feature id="org.eclipse.rcp" version="3.2.0.v20060609m-SVDNgVrNoh-MeGG"/>
      <feature id="org.eclipse.test" version="3.2.0.v20060220------0842282442"/>
 </features> 
```

您需要 org.eclipse.test 来运行测试，并需要 org.eclipse.rcp 来启动 eclipse 来运行测试。

不要忘记将 useFeatures 设置为 'true'

```
<product name="mock" id="com.example.mock" application="com.example.mock.application" useFeatures="true"> 
```

**特征.xml**

假设您有一个测试功能，您必须添加 2 个额外的插件。

...上面的其他插件...

```
<plugin
         id="org.apache.ant"
         download-size="0"
         install-size="0"
         version="0.0.0"/>

   <plugin
         id="org.eclipse.core.runtime.compatibility"
         download-size="0"
         install-size="0"
         version="0.0.0"
         unpack="false"/> 
```

测试需要 org.apache.ant 来运行测试和 org.eclipse.core.runtime.compatibility 来启动。

**另一个问题**

确保在您的目标 eclipse（用于构建的 eclipse 副本）中，每个插件只有 1 个副本。例如，如果插件文件夹中有 2 个版本的 com.ibm.icu 插件，则 eclipse 将使用较新的版本。由于 pde 构建插件配置为使用特定版本，因此 eclipse 会抱怨它无法找到特定插件，即使它存在。

**一些想法**

构建eclipse的整个过程可能会好很多。事实上，我主要通过反复试验得到了这个过程。文档已过时且稀疏。错误消息没有帮助。它只会让你感到无助和沮丧。让我们希望这篇文章可以帮助程序员节省一些时间！

            回答 #4

赞同：0

时间：2008-11-01T07:29:12.750

我们正在使用 PDE 构建脚本（请参阅[此问题](https://stackoverflow.com/questions/133234/building-eclipse-plugins-and-features-on-the-command-line)），并为我们的单元测试插件导出 ant 构建文件。然后使用“ant”ant 任务从 PDE 构建脚本 (customTargets.xml) 调用这些 ant 构建脚本。不幸的是，这只适用于 JUnit3。JUnit3 应该有一个 JUnit4 适配器，因此您可以从 JUnit3 测试运行器运行 JUnit4 测试。

我们可能会转向 Maven 之类的东西；PDE 构建脚本并没有真正适合我们需要用它们做的事情。

            回答 #5

赞同：0

时间：2009-09-03T14:20:44.080

作为 Ant 的替代品，我在使用全新的 Maven+Tycho 和 Hudson 方面有很好的经验。Tycho 为 Maven 中的 Osgi 和 Eclipse 开发提供完整的支持。它目前正在大力开发，但我需要的大部分功能都可以使用。它只需要您进行很少的配置，因为它可以解析 MANIFEST.MF 文件。

如果您对 Maven 有一定的经验，那么开始使用它并不难。由于缺少 Maven 3 支持，Hudson 的问题更加严重。（Tycho使用的是Maven 3的开发版）

开始链接：

*   [不完整的用户文档](https://docs.codehaus.org/display/M2ECLIPSE/Tycho+user+docs)

            回答 #6

赞同：-1

时间：2008-11-03T12:56:54.447

如果有人对 TDD 感兴趣，我可以推荐一个工具： 
 [Infinitest](http://www.junit.org/node/343)

从 Infinitest 网站提取的简短描述：

什么是无限？

Infinitest 是一个持续测试运行器，旨在促进测试驱动开发。Infinitest 通过在工作时提供反馈来帮助您学习 TDD，并通过将反馈周期从几分钟缩短到几秒钟来帮助您掌握 TDD。

每当您更改课程时，Infinitest 都会为您运行测试。运行什么测试很聪明，只运行你需要的测试。如果发生任何错误，它会清晰简洁地报告它们。这会给你关于代码语义正确性的即时反馈，就像现代 IDE 给你关于语法错误的即时反馈一样。

            回答 #7

赞同：-1

时间：2008-11-04T19:28:25.183

使用[Ant](http://ant.apache.org/)和[CruiseControl - 您可以在](http://cruisecontrol.sourceforge.net/)[Ant](http://ant.apache.org/)脚本中调用单元测试以及构建逻辑的其余部分，并且可以在每次构建迭代时运行它们 - 然后[CruiseControl](http://cruisecontrol.sourceforge.net/)可以自动执行构建调用并每次运行这些测试。

        sql-server - 如何从 MS Access 迁移到 SQL Server 2005？

ID：255371

赞同：3

时间：2008-11-01T01:22:41.027

标签：sql-server, vb.net, ms-access, ssis, strongly-typed-dataset

我有一个从 MS Access 数据库中提取信息的 VB.NET Windows 应用程序。该应用程序的主要作用是从各种格式的 Excel 文件中提取信息，标准化文件布局并将其写入 csv 文件。该应用程序使用 MS Access 作为密钥和交叉引用文件的来源。

Windows 应用程序使用类型化的数据集进行数据库之间的大部分用户交互。标准化是在每台客户端机器上完成的。该应用程序不是...我怎么能这么说...FAST :-)。

问题：将数据库和应用程序迁移到 SQL Server 2005 的最佳方法是什么。我认为在 SSIS 包中编写用于标准化的代码可能是个好主意。

进行此迁移的适当方法是什么？

该应用程序每周从 250 个 excel 文件和每月大约 800 个文件中提取数据，每个文件平均大约 5000 行。有 13 种不同的文件格式被标准化并输出为 3 种不同的标准格式。该应用程序需要 25 分钟。并且运行 40 分钟，具体取决于我们要运行的数据。95%的申请是标准化过程。用户所做的只是选择一些参数然后开始运行。

            回答 #1

赞同：2

时间：2008-11-01T01:26:50.830

Microsoft 提供了一个[免费工具](http://www.microsoft.com/downloads/details.aspx?familyid=D842F8B4-C914-4AC7-B2F3-D25FFF4E24FB&displaylang=en)来将 Access 数据库迁移到 SQL Server。升级后，您应该能够将连接字符串更改为指向 SQL Server。

            回答 #2

赞同：1

时间：2008-11-01T01:28:04.713

您可能希望通过分析器运行您的应用程序，以确保 Access DB 确实是降低您的应用程序速度的原因，而不是其他原因。完成所有工作以将其转换为 SQL Server 并且没有什么可展示的，这将是一种耻辱。  

            回答 #3

赞同：1

时间：2008-11-01T01:32:05.030

Access 升迁向导可用作起点。

您可以在不更改前端的情况下将后端更改为带有 Access 中链接表的 SQL Server。然后，您可以随意修改前端直接进入SQL Server。

除非您对 Access 的打击很大，否则我怀疑这是您的瓶颈。

就读取 Excel 文件而言，SSIS 可以做到，但它可能不如您现在在 VB.NET 中使用的机制可靠，如果您的 VB.NET 代码有很多智能逻辑来处理学位输入文件的变化

就将数据写入 CSV 而言，SSIS 很好，而且我发现 SSIS 的表现非常好。

如果您可以提供有关工作流程以及用户与数据库交互的程度以及程序拉取配置的更多详细信息，则可能更容易帮助您的体系结构。

SSIS 非常易于动态配置（程序包在运行时对其自身进行了一些配置），并且在许多情况下，它可以被编程为读取各种 Excel 文件并将它们转换为 CSV，但它不像手动配置那样动态配置编码系统。也可以使用 SSIS 对象模型以编程方式生成包然后执行它们 - 这没有包配置自身的一些限制，但对象模型非常复杂。

            回答 #4

赞同：0

时间：2008-11-01T01:40:03.173

确保范围明确：

1.  使用 .NET 程序
2.  驱动 Access 数据库前端，使您能够
3.  从多个 Excel 电子表格中提取数据，
4.  适当地按摩数据，以及
5.  将结果保存在 CSV 文件中。

我们在谈论什么类型的卷？有多少个客户，每个客户有多少个电子表格，每个电子表格有多少行（我认为单个电子表格最多 32767，对吧？我们在谈论多少时间？

似乎有很多活动部件。Access 通常是一个非常好的工具（使用 VBA）可以自行完成这类事情。

对于设计良好的 Access 数据库前端 Excel 使用 VBA 完成整个过程，它似乎没有足够的容量来提供主要的时间接收器。如果您的替代方案涉及在每个客户端上安装和操作 SQL Server（代替 Access），那么如果管理和操作开销没有增加，我会感到惊讶。

            回答 #5

赞同：0

时间：2008-11-01T03:37:37.087

因此，每周，每个客户：25 分钟 250 个文件 = 10 个文件/分钟或每个文件 6 秒。

每月，每个客户：40 分钟 800 个文件 = 20 个文件/分钟或每个文件 3 秒。

我的期望会小于 1 秒。每个文件（5000 行）往返包括

：将 xls 导入或附加到 mdb，

b。通过 Access SQL 转换

c. 导出为 csv

想到的唯一解释是，.NET 应用程序可能一次读取、转换和保存一行。有可能是这样吗？

如果您转换为 SSIS，那么这可能会使 .NET 应用程序过时，因为 SSIS 将希望自己处理 ETL（并保存）。所以你基本上会重写软件。但是您可能拥有比 Access 更好的 SSIS 资源。但在我看来，这有点矫枉过正。但是，.NET 而不是 VBA 也可能是矫枉过正；并且用 VBA 重写也是可行的。我认为最少的努力是看看你是否可以使用 Access SQL 来完成整个 ETL（并保存），并且只使用 VBA 来编写脚本，遍历目录中的输入文件等。

我认为您至少可以对基本用例进行原型设计，并找出您是否可以很快找出现在花费的时间（如先前的回复所建议的那样。）但是在提交针对问题的错误部分。如果您可以在这些领域进行一些扩展，我可能会进一步指导您。但是 Access 非常适合这种事情，在（恕我直言）比 SQL Server + SSIS + .NET 更低的 TCO。

更不用说如果 csv 文件是真正的终点，我会感到惊讶，这可能会在决定中发挥作用。Excel 数据真的不会走得更远吗？

最后，一个 25 到 40 分钟的过程可能是无人看管的，可以在午休时间运行，并且可能基本上可以正常工作，这有多令人反感？

笔记：

```
每个星期    

Excel 文件 250
分钟 25
分钟/文件 0.1
秒/文件 6

每月   

Excel 文件 800
分钟 40
分钟/文件 0.05
秒/文件 3

```

        php - 按下提交按钮时是否发送单独表单中的输入？

ID：255393

赞同：2

时间：2008-11-01T01:42:57.600

标签：php, html

我正在尝试在 php 中创建一个页面，该页面从数据库中获取行，显示它们，然后让查看者有机会对特定条目进行投票或否决。这是一个片段：

```
echo("<form action=\"vote.php\" method=\"post\"> \n");
echo("<INPUT type=\"hidden\" name=\"idnum\" value=\"".$row[0]."\">");
echo("<INPUT type=\"submit\" name=\"up\" value=\"Upvote.\">  \n");
echo("<INPUT type=\"submit\" name=\"down\" value=\"Downvote\"> ");
echo("<form/>\n"); 
```

问题是当我点击提交按钮时，发送的 idnum 值是基于它看起来最下方的值。所以我的问题是，当按下提交按钮时，是否发送了页面上所有输入的值？

            回答 #1

赞同：8

时间：2008-11-01T01:45:24.723

您的表单标签未正确关闭。你有`<form/>`，但它应该是`</form>`。

这使整个页面成为一个表单，因此它发送所有输入。但是，对于正确关闭的表单，它只会在按下按钮所在的表单标签内发送输入。

            回答 #2

赞同：4

时间：2008-11-01T02:32:15.473

虽然这对解决这个特定问题没有帮助，但我建议尽可能不要将您的标记与您的逻辑混合。这更具可读性，也更具可编辑性：

```
<form action="vote.php" method="post">
    <input type="hidden" name="idnum" value="<?php echo $row[0]; ?>">
    <input type="submit" name="up" value="Upvote.">
    <input type="submit" name="down" value="Downvote">
</form> 
```

            回答 #3

赞同：3

时间：2008-11-01T01:44:47.750

您的表单未正确关闭。使用`</form>`而不是`<form/>`.

            回答 #4

赞同：3

时间：2008-11-01T01:45:19.293

你的 html 的问题是你应该有`</form>`，而不是`<form/>`.

        c# - 通过 Web 服务序列化自定义对象中的名称/值对

ID：255400

赞同：7

时间：2008-11-01T01:48:59.817

标签：c#, php, web-services, serialization, class-design

这是一个非常复杂的问题，当数据不是强类型时，如何通过 Web 服务调用序列化数据。我会尽量把它布置好。

**样本存储对象：**

```
[Serializable]
public class StorageObject {
  public string Name { get; set; }
  public string Birthday { get; set; }
  public List<NameValuePairs> OtherInfo { get; set; }  
}
[Serializable]   
public class NameValuePairs {
  public string Name { get; set; }
  public string Value { get; set; }
} 
```

**样品用途：**

```
[WebMethod]
    public List<StorageObject> GetStorageObjects() {
      List<StorageObject> o = new List<StorageObject>() {
        new StorageObject() { 
          Name = "Matthew",
          Birthday = "Jan 1st, 2008", 
          OtherInfo = new List<NameValuePairs>() {
            new NameValuePairs() { Name = "Hobbies", Value = "Programming" },
            new NameValuePairs() { Name = "Website", Value = "Stackoverflow.com" }
          }
        },
        new StorageObject() { 
          Name = "Joe",
          Birthday = "Jan 10th, 2008",
          OtherInfo = new List<NameValuePairs>() { 
            new NameValuePairs() { Name = "Hobbies", Value = "Programming" },
            new NameValuePairs() { Name = "Website", Value = "Stackoverflow.com" }
          }
        }
      };

      return o;
    } 
```

**来自 Web 服务的返回值：**

```
<StorageObject>
    <Name>Matthew</Name>
    <Birthday>Jan 1st, 2008</Birthday>
    <OtherInfo>
        <NameValuePairs>
            <Name>Hobbies</Name>
            <Value>Programming</Value>
        </NameValuePairs>
        <NameValuePairs>
            <Name>Website</Name>
            <Value>Stackoverflow.com</Value>
        </NameValuePairs>
    </OtherInfo>
</StorageObject> 
```

**我想要的是：**

```
<OtherInfo>
    <Hobbies>Programming</Hobbies>
    <Website>Stackoverflow.com</Website>
</OtherInfo> 
```

**原因和其他东西：**

首先，我很抱歉这篇文章的长度，但我也想提供可重现的代码。  

我想要这种格式，因为我正在使用 PHP 的 Web 服务。我想轻松地去：

// 这很重要

```
In PHP => "$Result["StorageObject"]["OtherInfo"]["Hobbies"]". 
```

如果它是其他格式，那么我根本无法做到这一点。此外，在 C# 中，如果我正在使用该服务，我还希望能够执行以下操作：

// 这很重要

```
In C# => var m = ServiceResult[0].OtherInfo["Hobbies"]; 
```

不幸的是，我不确定如何做到这一点。通过构建一个实现 IXmlSerializer 的自定义 Dictionary （请参阅[StackOverflow：IXmlSerializer Dictionary](https://stackoverflow.com/questions/67959/c-xml-serialization-gotchas)），我能够以这种方式获得它，但是，它使 WSDL 模式脱离了水。它也太复杂了，并且在我的 WinFormsTester 应用程序中产生了可怕的结果！

有没有办法做到这一点？我需要创建什么类型的对象？除了制作强类型集合/之外，还有什么方法可以做到这一点/？显然，如果我让它像这样强类型：

```
public class OtherInfo {
  public string Hobbies { get; set; }
  public string FavoriteWebsite { get; set; }
} 
```

然后它将完美运行，我不会有 WSDL 问题，我将能够轻松地从 PHP 和 C# (.OtherInfo.Hobbies) 访问它。

但是，我将完全失去 NVP 的意义，因为我必须提前知道列表是什么，而且它是不可更改的……比如说，来自数据库。

谢谢大家！！我希望我们能够为此提出某种解决方案。再次提出要求：

1.  WSDL 模式不应中断
2.  名称值对 (NVP) 应序列化为属性格式
3.  通过名称 ["Hobbies"] 应该很容易在 PHP 中访问 NVP
4.  应该很容易在 C# 中访问（并且与它的代理生成器兼容）
5.  易于序列化
6.  不需要我强输入数据

现在，我/完全/愿意输入更好/不同的方式来做到这一点。我正在存储一些相对“静态”的信息（如名称）和一堆数据。如果有更好的方法，我很想听听。

            回答 #1

赞同：5

时间：2008-11-01T02:17:33.987

这就像对象的动态属性。与 javascript 不同，C# 不是一种动态语言，或者 PHP 可以动态解析对象属性。以下两种方法是我能想到的。第二个可能符合您的要求。

**亲吻方式** 

保持简单愚蠢的方式

```
public class StorageObject {
  public string Name { get; set; }
  public string Birthday { get; set; }
  public List<string> OtherInfo { get; set; }  
} 
```

您可以拥有由“|”分隔的名称值对

```
OtherInfo = {"Hobbies|Programming", "Website|Stackoverflow.com"} 
```

序列化表格

```
<StorageObject>
    <Name>Matthew</Name>
    <Birthday>Jan 1st, 2008</Birthday>
    <OtherInfo>
        <string>Hobbies|Programming</string>
        <string>Website|Stackoverflow.com</string>
    </OtherInfo>
</StorageObject> 
```

**C#中的动态方式**

使名称值对部分成为 XML 元素，以便您可以动态构建它。

```
public class StorageObject {
  public string Name { get; set; }
  public string Birthday { get; set; }
  public XElement OtherInfo { get; set; } // XmlElement for dot net 2
} 
```

您可以轻松地将 OtherInfo 对象构建为以元素为中心，例如

```
XElement OtherInfo = new XElement("OtherInfo");
OtherInfo.Add( ..Hobbies xelement & text value..);
OtherInfo.Add( ..WebSite xelement & text value..); 
```

序列化的形式将是

```
<OtherInfo>
    <Hobbies>Programming</Hobbies>
    <Website>Stackoverflow.com</Website>
</OtherInfo> 
```

或将其构建为以属性为中心

```
XElement OtherInfo = new XElement("OtherInfo");
OtherInfo.Add( ..nvp xattribute Hobbies & value..);
OtherInfo.Add( ..nvp xattribute WebSite & value..);

<OtherInfo>
    <nvp n="Hobbies" v="Programming" />
    <nvp n="Website" v="Stackoverflow.com" />
</OtherInfo> 
```

对于任何动态语言，它都可以直接访问属性。其余的，他们可以通过读取 XML 来访问该值。大多数框架都很好地支持读取 XML。

            回答 #2

赞同：4

时间：2008-11-01T03:16:47.847

这就是我所决定的。

班级结构：

```
public class StorageObject {
  public string Name { get; set; }
  public string Birthday { get; set; }
  [XmlAnyElement("Info")]  // this prevents double-nodes in the XML
  public XElement OtherInfo { get; set; }
} 
```

用法：

```
StorageObject o = new StorageObject();
o.OtherInfo.Add(new XElement("Hobbies","Programming");
o.OtherInfo.Add(new XElement("Website","Stackoverflow.com"); 
```

输出：

```
<Info>
  <Hobbies>Programming</Hobbies>
  <Website>Stackoverflow.com</Website>
</Info> 
```

我要感谢大家的帮助，我非常感谢他们的帮助和想法。

            回答 #3

赞同：1

时间：2008-11-01T03:04:13.800

作为对此完全不同的看法，为什么不考虑完全不同的做法。有一个 Web 服务方法来返回序列化的存储对象，减去`OtherInfo`和另一种方法来返回属性（键）列表`OtherInfo`，以及第三种方法来返回任何键的值列表。当然，如果您想要所有数据，则需要更多往返 Web 服务，但解决方案会更简单、更灵活。

```
[Serializable]
public class StorageObject {
  public string Name { get; set; }
  public string Birthday { get; set; }

  [Nonserializable]
  public Dictionary<string,List<string>> OtherInfo { get; set; }  
}

[WebMethod]
public List<StorageObject> GetStorageObjects() {
    // returns list of storage objects from persistent storage or cache
}

[WebMethod]
public List<string> GetStorageObjectAttributes( string name )
{
    // find storage object, sObj
    return sObj.Keys.ToList();
}

[WebMethod]
public List<string> GetStorageObjectAtributeValues( sting name, string attribute )
{
    // find storage object, sObj
    return sObj[attribute];
} 
```

            回答 #4

赞同：0

时间：2008-11-01T02:07:00.657

查看 System.Xml.Serialization.XmlSerializerAssemblyAttribute 属性。这使您可以指定自定义类级序列化程序。您将能够吐出您喜欢的任何 XML。

快速了解这些内容的一种快速方法是使用 sgen.exe 生成一个并使用 Reflector 查看它。

-Oisin

            回答 #5

赞同：-1

时间：2008-11-01T02:03:55.637

我不确定这会解决你的问题（它会在 C# 中，但可能不会在 PHP 中），但尝试使用`Dictionary<string,List<string>> OtherInfo`而不是`List<NameValuePairs>`. 然后“爱好”和“网站”将是您的键，值将是爱好或网站的列表。不过，我不确定它会如何序列化。

您可以将爱好列表引用为：

```
List<string> hobbies = storageObject.OtherInfo["Hobbies"]; 
```

[编辑] 请参阅[此处](http://weblogs.asp.net/pwelter34/archive/2006/05/03/444961.aspx)以获取通用 XML 可序列化字典。这个派生类是您需要使用的，而不是通用字典。

        ms-word - 当从 Word 复制/粘贴 'hello' 到 textarea 时，保存后变为 018hello 019

ID：255402

赞同：2

时间：2008-11-01T01:50:20.110

标签：ms-word, character-encoding, smart-quotes

我有 Word 'hello'，当我粘贴它时，我得到 018hello 019，所以撇号变成了这些奇怪的字符。

Web 应用程序的类型应该无关紧要，因为行为因我使用的工作站而异。

我用记事本、Excel 和写字板检查过，没有出现这个问题，仅适用于 Word。

它应该是 Word/IE 设置。

你知道是哪一个吗？

谢谢

            回答 #1

赞同：6

时间：2008-11-01T01:54:55.827

word中的引号不是“常规”引号。Word 会在您键入时自动将引号替换为称为“智能引号”的花哨的引号。由于您的浏览器不理解智能引号，它会替换它们。

            回答 #2

赞同：0

时间：2008-11-01T01:54:01.603

这被称为 Word“智能引号”功能。Word设置中的某处应该有一个地方可以将其关闭。

更多信息可以在[引号字形](http://en.wikipedia.org/wiki/Quotation_mark_glyphs)维基百科文章中找到。

        bash - 为什么我不能在脚本中使用“cd”更改目录？

ID：255414

赞同：806

时间：2008-11-01T02:07:08.800

标签：bash

我正在尝试编写一个小脚本来将当前目录更改为我的项目目录：

```
#!/bin/bash
cd /home/tree/projects/java 
```

我将此文件保存为 proj，添加了执行权限`chmod`，并将其复制到`/usr/bin`. 当我通过 : 调用它时
`proj`，它什么也不做。我究竟做错了什么？

            回答 #1

赞同：671

时间：2008-11-01T02:09:06.970

Shell 脚本在子shell 中运行，每个子shell 都有自己的当前目录概念。成功了`cd`，但是一旦子 shell 退出，你就回到了交互式 shell，那里没有任何改变。

解决此问题的一种方法是改用别名：

```
alias proj="cd /home/tree/projects/java" 
```

            回答 #2

赞同：537

时间：2008-11-01T02:09:09.420

你没有做错任何事！您已经更改了目录，但仅在运行脚本的子shell 中。

您可以使用“dot”命令在当前进程中运行脚本：

```
. proj 
```

但我更喜欢 Greg 的建议，在这种简单的情况下使用别名。

            回答 #3

赞同：223

时间：2011-08-11T04:20:14.397

在`cd`您的脚本中，它在技术上*起作用*，因为它更改了运行脚本的 shell 的目录，但这是一个从交互式 shell 派生的单独进程。

解决此问题的一种与 Posix 兼容的方法是定义一个*shell 过程*，而不是一个 shell 调用的*命令脚本*。

```
jhome () {
  cd /home/tree/projects/java
} 
```

您可以输入或将其放入各种 shell 启动文件之一。

            回答 #4

赞同：169

时间：2010-02-10T12:07:46.400

这`cd`是在脚本的外壳中完成的。当脚本结束时，该 shell 退出，然后您将留在原来的目录中。“来源”脚本，不要运行它。代替：

```
./myscript.sh 
```

做

```
. ./myscript.sh 
```

（注意脚本名称前的点和空格。）

            回答 #5

赞同：100

时间：2010-05-06T03:41:15.260

要制作一个将 cd 到一个选择目录的 bash 脚本：

创建脚本文件

```
#!/bin/sh
# 文件：/scripts/cdjava
#
cd /home/askgelal/projects/java

```

然后在您的启动文件中创建一个别名。

```
#!/bin/sh
# 文件 /scripts/mastercode.sh
#
别名 cdjava='。/脚本/cdjava'

```

*   我创建了一个启动文件，我在其中转储了所有别名和自定义函数。
    *   然后我将此文件源到我的 .bashrc 中，以便在每次启动时设置它。

例如，创建一个主别名/函数文件：**/scripts/mastercode.sh** 

*（将别名放在此文件中。）*

然后在**.bashrc**文件的末尾：

```
源 /scripts/mastercode.sh

```

现在很容易 cd 到您的 java 目录，只需键入 cdjava 即可。

            回答 #6

赞同：56

时间：2014-02-10T11:59:39.857

您可以使用`.`在当前 shell 环境中执行脚本：

```
. script_name 
```

或者，它更具可读性但特定于 shell 的别名`source`：

```
source script_name 
```

这避免了子 shell，并允许任何变量或内置函数（包括`cd`）改为影响当前 shell。

            回答 #7

赞同：40

时间：2008-11-01T04:21:41.210

Jeremy Ruten 使用符号链接的想法引发了一个尚未跨越任何其他答案的想法。采用：

```
CDPATH=:$HOME/projects 
```

前导冒号很重要；这意味着如果当前目录中有目录“dir”，那么“ `cd dir`”将更改为该目录，而不是跳到其他地方。使用如图所示设置的值，您可以执行以下操作：

```
cd java 
```

并且，如果当前目录中没有名为 java 的子目录，那么它将直接将您带到 $HOME/projects/java - 没有别名，没有脚本，没有可疑的执行程序或点命令。

我的 $HOME 是 /Users/jleffler；我的 $CDPATH 是：

```
:/Users/jleffler:/Users/jleffler/mail:/Users/jleffler/src:/Users/jleffler/src/perl:/Users/jleffler/src/sqltools:/Users/jleffler/lib:/Users/jleffler/doc:/Users/jleffler/work 
```

            回答 #8

赞同：36

时间：2016-04-21T11:34:52.547

`exec bash`最后使用

bash 脚本在其当前环境或其子环境上运行，但从不在其父环境上运行。

但是，这个问题经常被问到，因为在从另一个目录中**执行 bash 脚本之后，希望留在某个目录中的（新）bash 提示符处。**
如果是这种情况，只需在脚本末尾**执行一个子 bash 实例：**

```
#!/usr/bin/env bash
cd /home/tree/projects/java
echo -e '\nHit [Ctrl]+[D] to exit this child shell.'
exec bash 
```

要返回上一个父`bash`实例，请使用`Ctrl`+ `D`。
更新
至少对于较新版本的`bash`，`exec`最后一行的 不再需要。此外，可以通过使用`$SHELL`环境变量使脚本与任何首选的 shell 一起工作。然后给出：

```
#!/usr/bin/env bash
cd desired/directory
echo -e '\nHit [Ctrl]+[D] to exit this child shell.'
$SHELL 
```

            回答 #9

赞同：27

时间：2012-10-28T19:42:52.293

我让我的代码通过使用`. <your file name>`

`./<your file name>`不起作用，因为它不会更改终端中的目录，它只会更改特定于该脚本的目录。

这是我的程序

```
#!/bin/bash 
echo "Taking you to eclipse's workspace."
cd /Developer/Java/workspace 
```

这是我的终端

```
nova:~ Kael$ 
nova:~ Kael$ . workspace.sh
Taking you to eclipe's workspace.
nova:workspace Kael$ 
```

            回答 #10

赞同：19

时间：2017-03-10T14:33:04.903

只需运行：

```
cd /home/xxx/yyy && command_you_want 
```

            回答 #11

赞同：12

时间：2008-11-01T02:09:12.553

当您触发一个 shell 脚本时，它会运行该 shell 的一个*新*实例 ( `/bin/bash`)。因此，您的脚本只是启动一个 shell，更改目录并退出。换句话说，`cd`shell 脚本中的（和其他此类命令）不会影响也无法访问启动它们的 shell。

            回答 #12

赞同：12

时间：2008-11-01T02:46:31.107

您可以执行以下操作：

```
#!/bin/bash
cd /your/project/directory
# start another shell and replacing the current
exec /bin/bash 
```

编辑：这也可以“点缀”，以防止创建后续外壳。

例子：

```
. ./previous_script  (with or without the first line) 
```

            回答 #13

赞同：11

时间：2012-09-14T10:53:29.953

在我的特殊情况下，我需要为同一个目录更改太多次。所以在我的 .bashrc（我使用 ubuntu）上，我添加了

1 -

$纳米〜./bashrc

```
 function switchp
 {
    cd /home/tree/projects/$1
 } 
```

2-

$ 源 ~/.bashrc

3 -

$ switchp java

直接它会做： cd /home/tree/projects/java

希望有帮助！

            回答 #14

赞同：7

时间：2008-11-01T02:10:01.290

它只会更改脚本本身的目录，而您的当前目录保持不变。

您可能想改用[符号链接](http://en.wikipedia.org/wiki/Symbolic_link)。它允许您创建文件或目录的“快捷方式”，因此您只需键入类似`cd my-project`.

            回答 #15

赞同：7

时间：2008-11-03T17:22:42.257

您可以结合别名和脚本，

```
alias proj="cd \`/usr/bin/proj !*\`" 
```

前提是脚本回显目标路径。请注意，这些是围绕脚本名称的反引号。 

例如，您的脚本可能是

```
#!/bin/bash
echo /home/askgelal/projects/java/$1 
```

这种技术的优点是脚本可以采用任意数量的命令行参数并发出由可能复杂的逻辑计算的不同目的地。

            回答 #16

赞同：7

时间：2012-02-09T07:33:41.693

您可以结合 Adam & Greg 的别名和点方法来制作更具动态性的东西——</p>

```
alias project=". project" 
```

现在运行项目别名将在当前 shell 中执行项目脚本，而不是子 shell。

            回答 #17

赞同：6

时间：2008-11-02T12:50:00.590

为了快速导航目录，有 $CDPATH、cdargs 和自动生成别名的方法

[http://jackndempsey.blogspot.com/2008/07/cdargs.html](http://jackndempsey.blogspot.com/2008/07/cdargs.html)

[http://muness.blogspot.com/2008/06/lazy-bash-cd-aliaes.html](http://muness.blogspot.com/2008/06/lazy-bash-cd-aliaes.html)

[https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5827311.html](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5827311.html)

            回答 #18

赞同：5

时间：2013-08-19T04:53:08.810

在您的 ~/.bash_profile 文件中。添加下一个功能

```
move_me() {
    cd ~/path/to/dest
} 
```

重启终端，你可以输入

```
move_me 
```

您将被移动到目标文件夹。

            回答 #19

赞同：3

时间：2013-03-24T16:56:27.433

您可以使用运算符 && ：

cd myDirectory && ls

            回答 #20

赞同：3

时间：2014-02-01T12:40:36.973

虽然采购您想要运行的脚本是一种解决方案，但您应该知道该脚本可以直接修改当前 shell 的环境。也不能再传递参数了。

另一种方法是将脚本实现为 bash 中的函数。

```
function cdbm() {
  cd whereever_you_want_to_go
  echo "Arguments to the functions were $1, $2, ..."
} 
```

此技术被 autojump 使用：http://github.com/joelthelion/autojump/wiki[为](http://github.com/joelthelion/autojump/wiki)您提供学习 shell 目录书签。

            回答 #21

赞同：3

时间：2016-08-04T15:05:26.170

您可以在您的中创建如下所示的功能`.bash_profile`，它将顺利运行。

以下函数采用一个可选参数，它是一个项目。例如，您可以运行

```
cdproj 
```

或者

```
cdproj project_name 
```

这是函数定义。

```
cdproj(){
    dir=/Users/yourname/projects
    if [ "$1" ]; then
      cd "${dir}/${1}"
    else
      cd "${dir}"
    fi
} 
```

不要忘记来源你的`.bash_profile`

            回答 #22

赞同：3

时间：2018-05-02T23:54:49.770

这应该做你想要的。切换到感兴趣的目录（从脚本中），然后生成一个新的 bash shell。

```
#!/bin/bash

# saved as mov_dir.sh
cd ~/mt/v3/rt_linux-rt-tools/
bash 
```

如果你运行它，它会带你到你感兴趣的目录，当你退出它时，它会带你回到原来的地方。

```
root@intel-corei7-64:~# ./mov_dir.sh

root@intel-corei7-64:~/mt/v3/rt_linux-rt-tools# exit
root@intel-corei7-64:~# 
```

`CTRL`当您退出 ( + `d`)时，这甚至会带您回到原始目录

            回答 #23

赞同：2

时间：2011-04-11T21:42:31.793

我做了以下事情：
创建一个名为 case 的文件
将以下内容粘贴到文件中：

```
#!/bin/sh

cd /home/"$1" 
```

保存它，然后：

```
chmod +x case 
```

我还在我的中创建了一个别名`.bashrc`：

```
alias disk='cd /home/; . case' 
```

现在当我输入：

```
case 12345 
```

基本上我在输入：

```
cd /home/12345 
```

您可以在“case”之后键入任何文件夹：

```
case 12

case 15

case 17 
```

这就像打字：

```
cd /home/12

cd /home/15

cd /home/17 
```

分别
在我的情况下，这条路要长得多——这些家伙早先用 ~ 信息总结了它。

            回答 #24

赞同：1

时间：2018-04-10T07:50:52.720

如其他答案所述，您已更改目录，但仅在**运行脚本的子外壳**内。这不会影响父外壳。

一种解决方案是使用**bash 函数**而不是 bash 脚本 ( `sh`)；通过将 bash 脚本代码放入函数中。这使得该函数可作为命令使用，然后，这将在没有子进程的情况下执行，因此任何`cd`命令都会影响调用者 shell。

**重击功能：**

bash 配置文件的一个功能是存储可以在终端或 bash 脚本中运行的自定义函数，就像运行应用程序/命令一样，这也可以用作长命令的快捷方式。

为了使您的功能高效系统广泛使用，您需要在几个文件的末尾复制您的功能

```
/home/user/.bashrc
/home/user/.bash_profile
/root/.bashrc
/root/.bash_profile 
```

您可以`sudo kwrite /home/user/.bashrc /home/user/.bash_profile /root/.bashrc  /root/.bash_profile`快速编辑/创建这些文件

**如何 ：**

将 bash 脚本代码复制到 bash 配置文件末尾的新函数中，然后重新启动终端，然后您可以运行`cdd`或编写任何您编写的函数。

**脚本示例**

制作快捷`cd ..`方式`cdd`

```
cdd() {
  cd ..
} 
```

ls 快捷方式

```
ll() {
  ls -l -h
} 
```

ls 快捷方式

```
lll() {
  ls -l -h -a
} 
```

            回答 #25

赞同：0

时间：2012-12-12T16:46:17.017

如果您使用[fish](http://ridiculousfish.com/shell/)作为 shell，最好的解决方案是创建一个函数。例如，给定原始问题，您可以复制下面的 4 行并将它们粘贴到您的 fish 命令行中：

```
function proj
   cd /home/tree/projects/java
end
funcsave proj 
```

这将创建函数并将其保存以供以后使用。如果您的项目发生变化，只需使用新路径重复该过程。

如果您愿意，可以通过执行以下操作手动添加函数文件：

```
nano ~/.config/fish/functions/proj.fish 
```

并输入文字：

```
function proj
   cd /home/tree/projects/java
end 
```

最后按 ctrl+x 退出，然后按 y 返回保存更改。

（*注意：使用 funcsave 的第一种方法会为您创建 proj.fish 文件*）。

            回答 #26

赞同：0

时间：2013-10-02T10:43:15.100

我有一个名为 p 的简单 bash 脚本来管理
[github.com/godzilla/bash-stuff](https://github.com/godzilla/bash-stuff "github")
上的目录更改，
只需将脚本放在本地 bin 目录 (/usr/local/bin)

中并放入

```
alias p='. p' 
```

在你的 .bashrc

            回答 #27

赞同：0

时间：2016-09-09T07:27:47.297

您不需要脚本，只需设置正确的选项并创建环境变量。

```
shopt -s cdable_vars 
```

在您`~/.bashrc`允许`cd`环境变量的内容中。

创建这样一个环境变量：

```
export myjava="/home/tree/projects/java" 
```

你可以使用：

```
cd myjava 
```

[其他替代品](https://askubuntu.com/a/481733/4246)。

            回答 #28

赞同：0

时间：2018-08-23T12:46:05.717

注意讨论[如何设置父进程的工作目录？](https://stackoverflow.com/questions/2375003/how-do-i-set-the-working-directory-of-the-parent-process/)

它包含一些骇人听闻的答案，例如
[https://stackoverflow.com/a/2375174/755804](https://stackoverflow.com/a/2375174/755804)（通过 gdb 更改父进程目录，不要这样做）和[https://stackoverflow.com/a/51985735/755804](https://stackoverflow.com/a/51985735/755804)（将*cd dirname*`tailcd`注入父进程的输入流的命令；好吧，理想情况下，它应该是 bash 的一部分，而不是 hack） ** * *

## 回答 #29

> 赞同：0
> 
>             
> 
> 时间：2020-02-27T06:33:41.213

这是一个老问题，但我真的很惊讶我在这里看不到这个技巧

而不是使用**cd**你可以使用

```
export PWD=the/path/you/want 
```

无需创建子外壳或使用别名。

请注意，确保 /path/you/want 存在是您的责任。

* * *

## 回答 #30

> 赞同：0
> 
>             
> 
> 时间：2020-09-16T19:41:36.353

我必须在 tcsh 中工作，我知道这不是一个优雅的解决方案，但是例如，如果我必须将文件夹更改为一个单词不同的路径，那么整个事情都可以在别名中完成

```
a alias_name 'set a = `pwd`; set b = `echo $a | replace "Trees" "Tests"` ; cd $b' 
```

如果路径总是固定的，那么

```
a alias_name2 'cd path/you/always/need' 
```

应该可以在上面的行中，设置了新的文件夹路径

* * *

## 回答 #31

> 赞同：0
> 
>             
> 
> 时间：2020-10-25T23:49:32.890

这结合了[Serge的](https://stackoverflow.com/a/36768357/)[答案和 David](https://unix.stackexchange.com/a/352430/)的一个不相关的答案。它更改目录，然后**启动用户的默认 shell，而不是强制使用 bash shell**。但是，它需要`getent`和`/etc/passwd`来检测默认 shell。

```
#!/usr/bin/env bash
cd desired/directory
USER_SHELL=$(getent passwd <USER> | cut -d : -f 7)
$USER_SHELL 
```

当然，这仍然存在创建嵌套 shell 的相同缺陷。

* * *

## 回答 #32

> 赞同：-3
> 
>             
> 
> 时间：2013-04-06T10:02:43.073

如果以反斜杠结束行，则可以在同一个子 shell 中执行某些行。

```
cd somedir; \
pwd 
```

# winapi - 如何从 PowerShell 静音/取消静音

> ID：255419
> 
>         
> 
> 赞同：25
> 
>         
> 
> 时间：2008-11-01T02:11:17.543
> 
>         
> 
> 标签：winapi, powershell, volume, mute

尝试编写一个 PowerShell cmdlet，它将在开始时静音，除非已经静音，并在最后取消静音（只有在开始时没有静音）。找不到我可以使用的任何 PoweShell 或 WMI 对象。我正在玩弄使用[auxGetVolume](http://msdn.microsoft.com/en-us/library/ms706237(VS.85).aspx)或[auxSetVolume 之](http://msdn.microsoft.com/en-us/library/ms706237(VS.85).aspx)类的 Win32 函数，但不能完全让它工作（如何从 IntPtr 读取值？）。

我正在使用 V2 CTP2。有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：35
> 
>             
> 
> 时间：2013-10-13T17:40:00.600

从 Vista 开始，您必须使用[Core Audio API](http://msdn.microsoft.com/en-us/library/windows/desktop/dd370802%28v=vs.85%29.aspx)来控制系统音量。它是一个不支持自动化的 COM API，因此需要从 .NET 和 PowerShell 使用大量样板文件。

无论如何，下面的代码让您可以从 PowerShell 访问`[Audio]::Volume`和`[Audio]::Mute`属性。这也适用于可能有用的远程计算机。只需将代码复制粘贴到您的 PowerShell 窗口中即可。

```
Add-Type -TypeDefinition @'
using System.Runtime.InteropServices;

[Guid("5CDF2C82-841E-4546-9722-0CF74078229A"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
interface IAudioEndpointVolume {
  // f(), g(), ... are unused COM method slots. Define these if you care
  int f(); int g(); int h(); int i();
  int SetMasterVolumeLevelScalar(float fLevel, System.Guid pguidEventContext);
  int j();
  int GetMasterVolumeLevelScalar(out float pfLevel);
  int k(); int l(); int m(); int n();
  int SetMute([MarshalAs(UnmanagedType.Bool)] bool bMute, System.Guid pguidEventContext);
  int GetMute(out bool pbMute);
}
[Guid("D666063F-1587-4E43-81F1-B948E807363F"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
interface IMMDevice {
  int Activate(ref System.Guid id, int clsCtx, int activationParams, out IAudioEndpointVolume aev);
}
[Guid("A95664D2-9614-4F35-A746-DE8DB63617E6"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
interface IMMDeviceEnumerator {
  int f(); // Unused
  int GetDefaultAudioEndpoint(int dataFlow, int role, out IMMDevice endpoint);
}
[ComImport, Guid("BCDE0395-E52F-467C-8E3D-C4579291692E")] class MMDeviceEnumeratorComObject { }

public class Audio {
  static IAudioEndpointVolume Vol() {
    var enumerator = new MMDeviceEnumeratorComObject() as IMMDeviceEnumerator;
    IMMDevice dev = null;
    Marshal.ThrowExceptionForHR(enumerator.GetDefaultAudioEndpoint(/*eRender*/ 0, /*eMultimedia*/ 1, out dev));
    IAudioEndpointVolume epv = null;
    var epvid = typeof(IAudioEndpointVolume).GUID;
    Marshal.ThrowExceptionForHR(dev.Activate(ref epvid, /*CLSCTX_ALL*/ 23, 0, out epv));
    return epv;
  }
  public static float Volume {
    get {float v = -1; Marshal.ThrowExceptionForHR(Vol().GetMasterVolumeLevelScalar(out v)); return v;}
    set {Marshal.ThrowExceptionForHR(Vol().SetMasterVolumeLevelScalar(value, System.Guid.Empty));}
  }
  public static bool Mute {
    get { bool mute; Marshal.ThrowExceptionForHR(Vol().GetMute(out mute)); return mute; }
    set { Marshal.ThrowExceptionForHR(Vol().SetMute(value, System.Guid.Empty)); }
  }
}
'@ 
```

使用示例：

```
PS C:\> [Audio]::Volume         # Check current volume (now about 10%)
0,09999999
PS C:\> [Audio]::Mute           # See if speaker is muted
False
PS C:\> [Audio]::Mute = $true   # Mute speaker
PS C:\> [Audio]::Volume = 0.75  # Set volume to 75%
PS C:\> [Audio]::Volume         # Check that the changes are applied
0,75
PS C:\> [Audio]::Mute
True
PS C:\> 
```

如果您需要，还有更全面的 Core Audio API 的 .NET 包装器，但我不知道有一组 PowerShell 友好的 cmdlet。

*PS * [Diogo 的答案](https://stackoverflow.com/q/12397737)似乎很聪明，但对我不起作用。

* * *

## 回答 #2

> 赞同：22
> 
>             
> 
> 时间：2012-09-13T00:12:58.590

在 ps1 powershell 脚本上使用以下命令：

```
$obj = new-object -com wscript.shell 
$obj.SendKeys([char]173) 
```

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2016-10-07T16:18:20.207

Alexandre 的回答适合我的情况，但由于有关“var”名称空间的编译错误，他的示例不起作用。似乎较新/不同版本的 .net 可能会导致该示例不起作用。如果您发现收到了编译错误，这是针对这些情况的替代版本：

```
Add-Type -Language CsharpVersion3 -TypeDefinition @'
using System.Runtime.InteropServices;

[Guid("5CDF2C82-841E-4546-9722-0CF74078229A"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
interface IAudioEndpointVolume {
  // f(), g(), ... are unused COM method slots. Define these if you care
  int f(); int g(); int h(); int i();
  int SetMasterVolumeLevelScalar(float fLevel, System.Guid pguidEventContext);
  int j();
  int GetMasterVolumeLevelScalar(out float pfLevel);
  int k(); int l(); int m(); int n();
  int SetMute([MarshalAs(UnmanagedType.Bool)] bool bMute, System.Guid pguidEventContext);
  int GetMute(out bool pbMute);
}
[Guid("D666063F-1587-4E43-81F1-B948E807363F"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
interface IMMDevice {
  int Activate(ref System.Guid id, int clsCtx, int activationParams, out IAudioEndpointVolume aev);
}
[Guid("A95664D2-9614-4F35-A746-DE8DB63617E6"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
interface IMMDeviceEnumerator {
  int f(); // Unused
  int GetDefaultAudioEndpoint(int dataFlow, int role, out IMMDevice endpoint);
}
[ComImport, Guid("BCDE0395-E52F-467C-8E3D-C4579291692E")] class MMDeviceEnumeratorComObject { }

public class Audio {
  static IAudioEndpointVolume Vol() {
    var enumerator = new MMDeviceEnumeratorComObject() as IMMDeviceEnumerator;
    IMMDevice dev = null;
    Marshal.ThrowExceptionForHR(enumerator.GetDefaultAudioEndpoint(/*eRender*/ 0, /*eMultimedia*/ 1, out dev));
    IAudioEndpointVolume epv = null;
    var epvid = typeof(IAudioEndpointVolume).GUID;
    Marshal.ThrowExceptionForHR(dev.Activate(ref epvid, /*CLSCTX_ALL*/ 23, 0, out epv));
    return epv;
  }
  public static float Volume {
    get {float v = -1; Marshal.ThrowExceptionForHR(Vol().GetMasterVolumeLevelScalar(out v)); return v;}
    set {Marshal.ThrowExceptionForHR(Vol().SetMasterVolumeLevelScalar(value, System.Guid.Empty));}
  }
  public static bool Mute {
    get { bool mute; Marshal.ThrowExceptionForHR(Vol().GetMute(out mute)); return mute; }
    set { Marshal.ThrowExceptionForHR(Vol().SetMute(value, System.Guid.Empty)); }
  }
}
'@ 
```

用法是一样的：

```
PS C:\> [Audio]::Volume         # Check current volume (now about 10%)
0,09999999
PS C:\> [Audio]::Mute           # See if speaker is muted
False
PS C:\> [Audio]::Mute = $true   # Mute speaker
PS C:\> [Audio]::Volume = 0.75  # Set volume to 75%
PS C:\> [Audio]::Volume         # Check that the changes are applied
0,75
PS C:\> [Audio]::Mute
True
PS C:\> 
```

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2008-11-01T05:29:05.910

您可以通过简单地管理 Windows 音频服务以另一种方式给猫剥皮。停止静音，启动取消静音。

* * *

## 回答 #5

> 赞同：7
> 
>             
> 
> 时间：2008-11-01T19:25:32.010

似乎没有一种快速简便的方法来调整音量。如果您有 c++ 经验，您可以使用[这篇博](http://blogs.msdn.com/larryosterman/archive/2007/03/06/how-do-i-change-the-master-volume-in-windows-vista.aspx)文做一些事情，Larry Osterman 描述了如何从平台 api 调用 IAudioEndpointVolume 接口（对于 Vista，从我在几次搜索中发现的内容来看，XP 可能更难）。  

V2 确实允许您编译内联代码（通过 Add-Type），因此这可能是一种选择。

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2016-02-18T22:44:52.313

我知道这不是 PowerShell，但结合 Michael 和 Diogo 的答案给出了一个单行 VBScript 解决方案：

```
CreateObject("WScript.Shell").SendKeys(chr(173)) 
```

把它拍进去`mute.vbs`，你可以双击来切换静音

*   仍然适用于 Windows 10 (10586.104)

*   无需`Set-ExecutionPolicy`像使用 PowerShell 那样

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2009-11-03T23:33:19.223

我没有找到如何在 PowerShell 中执行此操作，但是有一个名为 NirCmd 的命令行实用程序可以通过运行以下命令来解决问题：

C:\utils\nircmd.exe mutesysvolume 2

NirCmd 可在此处免费获得：http:
 [//www.nirsoft.net/utils/nircmd.html](http://www.nirsoft.net/utils/nircmd.html)

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2013-01-31T00:43:05.310

vbscript中的解决方案：

```
Set WshShell = CreateObject("WScript.Shell")
For i = 0 To 50
  WshShell.SendKeys(chr(174))
  WScript.Sleep 100
Next 
```

按键每次将音量降低 2。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2014-07-29T12:48:37.243

查看我对[从 powershell 更改音频级别的回答？](https://stackoverflow.com/questions/21355891/change-audio-level-from-powershell)

```
Set-DefaultAudioDeviceMute 
```

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2020-12-23T16:49:25.100

*在得到对我的回答的一些反馈后，让我再试一次*

这是基于@frgnca 的 AudioDeviceCmdlets，可在此处找到：[https ://github.com/frgnca/AudioDeviceCmdlets](https://github.com/frgnca/AudioDeviceCmdlets)

这是将使每个录音设备静音的代码。

```
Import-Module .\AudioDeviceCmdlets
$audio_device_list = Get-AudioDevice -list
$recording_devices = $audio_device_list | ? {$_.Type -eq "Recording"}
$recording_devices 
$recording_device_index = $recording_devices.Index | Out-String -stream
foreach ($i in $recording_device_index) {
    $inti = [int]$i
    Set-AudioDevice $inti | out-null -erroraction SilentlyContinue
    Set-AudioDevice -RecordingMute 1 -erroraction SilentlyContinue
} 
```

您导入 AudioDeviceCmdlets dll，然后保存所有音频设备的列表，过滤到录音设备中。您获取所有录音设备的索引，然后遍历每个设备，首先将设备设置为主音频设备，然后将该设备设置为静音（这 2 步过程是 dll 施加的限制）。

要取消静音，请将**-RecordingMute 1**更改为**RecordingMute 0**

同样，要使播放设备静音，您可以使用以下代码：

```
Import-Module .\AudioDeviceCmdlets
$audio_device_list = Get-AudioDevice -list
$playback_devices = $audio_device_list | ? {$_.Type -eq "Playback"}
$playback_devices 
$playback_device_index = $playback_devices.Index | Out-String -stream
foreach ($i in $playback_device_index) {
$inti = [int]$i
    Set-AudioDevice $inti | out-null -erroraction SilentlyContinue
    Set-AudioDevice -PlaybackMute 1 -erroraction SilentlyContinue
} 
```

要取消静音，请将**-PlaybackMute 1**更改为**PlaybackMute 0**

此代码来自我拥有的一个更大项目的一部分，该项目通过 Arduino 连接到物理按钮/LED 静音状态显示，以启用单按钮按下静音/取消静音所有系统麦克风（以帮助 Zoom、Meet、Teams、Discord 等.) 并帮助人们避免令人尴尬的热点麦克风事件。

[https://github.com/dakota-mewt/mewt](https://github.com/dakota-mewt/mewt)

[![1](https://raw.githubusercontent.com/dakota-mewt/mewt/main/images/mewtdemosmall.gif)](https://raw.githubusercontent.com/dakota-mewt/mewt/main/images/mewtdemosmall.gif)

PS 我真的很喜欢一些单线解决方案，例如[从 powershell 更改音频级别？](https://stackoverflow.com/questions/21355891/change-audio-level-from-powershell)

但是，请注意，单线静音通常仅适用于当前设置为 Windows 默认值的单个设备。因此，如果您拥有能够处理不同音频设备（如 Zoom 和 Meet）的软件，而它们恰好使用的是非默认设备，则它可能无法按预期工作。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2020-07-29T14:46:28.787

在上面的第二个脚本中，要在 PowerShell 7 或 PowerShell Core 中的第一行更改：

```
-Language CsharpVersion3 
```

到...

```
-Language Csharp 
```

在 W10 上工作

# html - 交替颜色

> ID：255422
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-11-01T02:16:20.853
> 
>         
> 
> 标签：html, xslt

我想创建一个 HTML 表格，其行颜色会根据位置和内容而变化。但不是交替每一行，我希望能够将行组合在一起，这样我就可以拥有一些这样的 XML：

```
<itemlist>
   <item group="0">Conent...blah blah</item>
   <item group="0">Content...who cares</item>
   <item group="1">Content</item>
   <item group="2">Content</item>
   <item group="2">Content</item>
</itemlist> 
```

并且所有 group=0 的项目都是一种颜色，而 group=1 的项目是另一种颜色，而 group=2 要么切换回第一种颜色，要么是它们自己的颜色。

我似乎发现有办法交替每一行，但在实际使用节点数据来帮助我做出决定时，我似乎无法“理解”。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T03:14:55.167

这是一个使用“选择”基于组值应用不同类值的示例。如果您想以特定方式对待每个组，则类似的方法会起作用。如果您处理第 2 组的决策逻辑更复杂，那么您可以在第 2 组的“何时”语句测试中放置额外的决策逻辑。

```
<xsl:template match="/">
    <ul>
        <xsl:apply-templates select="itemlist/item"/>
    </ul>
</xsl:template>

<xsl:template match="item">
    <li>
        <xsl:attribute name="class">
            <xsl:choose>
                <xsl:when test="@group = 0">
                    red
                </xsl:when>
                <xsl:when test="@group = 1">
                    green
                </xsl:when>
                <xsl:when test="@group = 2">
                    blue
                </xsl:when>
                <xsl:otherwise>
                    black
                </xsl:otherwise>
            </xsl:choose>
        </xsl:attribute>
        <xsl:value-of select="."/>
    </li>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T03:05:29.273

前两组很简单，因为您可以根据它们的组号解析它们。

要处理组 2，请考虑使用[前面](http://www.zvon.org/xxl/XSLTreference/Output/axis_preceding.html)的函数来获取 proir 注释列表，并使用[count](http://www.zvon.org/xxl/XSLTreference/Output/function_count.html)来确定有多少。然后，您可以根据计数是偶数还是奇数来替换值。

# optimization - 我如何弄清楚 -O
gcc 中的选项？

> ID：255423
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T02:16:23.943
> 
>         
> 
> 标签：optimization, gcc, flags

我似乎记得能够打印出（或定位）每个 -O<num> 选项打开的特定开关。你能提醒一下吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T02:52:10.470

[gcc 4.3 的新特性列表](http://gcc.gnu.org/gcc-4.3/changes.html)显示了一种方法，通过扩展`--help`命令行选项：

```
gcc -c -Q -O3 --help=optimizers > /tmp/O3-opts
gcc -c -Q -O2 --help=optimizers > /tmp/O2-opts
diff /tmp/O2-opts /tmp/O3-opts | grep enabled 
```

请注意，但是我从未尝试过，只阅读过它。有关此命令行选项的文档位于[http://gcc.gnu.org/onlinedocs/gcc/Overall-Options.html#Overall-Options](http://gcc.gnu.org/onlinedocs/gcc/Overall-Options.html#Overall-Options)

如果你读过 gcc 4.3 的新特性列表，也许这就是你所回忆的。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T02:38:47.610

你也可以试试这本不错的手册

```
$ man gcc 
```

在“控制优化的选项”小节中。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T04:25:06.913

在许多机器上，' `info gcc`' 会产生丰富的信息。在我的 Mac（PPC G4 和 MacOS X 10.4.11）上，使用 ' `gcc -v --help`' 产生了一个很长的子进程选项列表（实际上，stdout 上有 1001 行，stderr 上有 14 行）。

# python - 确定是否传递了命名参数

> ID：255429
> 
>         
> 
> 赞同：17
> 
>         
> 
> 时间：2008-11-01T02:23:27.220
> 
>         
> 
> 标签：python, default-value, named-parameters

我想知道是否可以确定是否在 Python 中传递了具有默认值的函数参数。例如，dict.pop 是如何工作的？

```
>>> {}.pop('test')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 'pop(): dictionary is empty'
>>> {}.pop('test',None)
>>> {}.pop('test',3)
3
>>> {}.pop('test',NotImplemented)
NotImplemented 
```

pop方法如何判断第一次没有传递默认返回值？这是只能在C中完成的事情吗？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2008-11-01T06:17:54.533

约定是经常使用`arg=None`和使用

```
def foo(arg=None):
    if arg is None:
        arg = "default value"
        # other stuff
    # ... 
```

检查它是否通过。允许用户通过`None`，这将被解释为参数*未*通过。

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2008-11-01T02:45:13.463

当您说“命名参数”时，我猜您的意思是“关键字参数”。`dict.pop()`不接受关键字参数，所以这部分问题没有实际意义。

```
>>> {}.pop('test', d=None)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: pop() takes no keyword arguments 
```

也就是说，检测是否提供了参数的方法是使用`*args`or`**kwargs`语法。例如：

```
def foo(first, *rest):
    if len(rest) > 1:
        raise TypeError("foo() expected at most 2 arguments, got %d"
                        % (len(rest) + 1))
    print 'first =', first
    if rest:
        print 'second =', rest[0] 
```

通过一些工作，并且也使用`**kwargs`语法，可以完全模拟 python 调用约定，其中参数可以按位置或名称提供，并且多次提供的参数（按位置和名称）会导致错误。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T02:34:46.123

你可以这样做：

```
def isdefarg(*args):
    if len(args) > 0:
        print len(args), "arguments"
    else:
        print "no arguments"

isdefarg()
isdefarg(None)
isdefarg(5, 7) 
```

有关完整信息，请参阅有关[调用的 Python 文档。](http://python.org/doc/2.5/ref/calls.html)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T03:19:07.063

我不确定我是否完全理解你想要什么；然而：

```
def fun(arg=Ellipsis):
    if arg is Ellipsis:
        print "No arg provided"
    else:
        print "arg provided:", repr(arg) 
```

那是你想要的吗？如果不是，那么正如其他人所建议的那样，您应该使用`*args, **kwargs`语法声明您的函数，并在 kwargs 字典中检查参数是否存在。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T02:58:41.423

```
def f(one, two=2):
   print "I wonder if", two, "has been passed or not..."

f(1, 2) 
```

如果这是您问题的确切含义，我认为无法区分默认值中的 2 和已通过的 2 。[即使在检查](http://www.python.org/doc/2.5.2/lib/module-inspect.html)模块中，我也没有找到如何实现这种区分。

# asp.net - 解析接受标头

> ID：255436
> 
>         
> 
> 赞同：26
> 
>         
> 
> 时间：2008-11-01T02:43:10.723
> 
>         
> 
> 标签：asp.net, regex, http, http-headers

是否有人对解析 HTTP Accept 标头有任何建议（或正则表达式）？

我正在尝试在 ASP.NET MVC 中进行一些内容类型协商。似乎没有内置的方式（这很好，因为这里有很多思想流派），但是解析并不是完全微不足道的，如果有人已经做过，我宁愿不重新发明轮子它很好，愿意分享。

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2008-11-01T16:50:42.277

你看过[这篇文章](http://www.xml.com/pub/a/2005/06/08/restful.html)吗？它提供了一个非常全面的实现来解析 Accept 标头并随后用它做一些有用的事情。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2018-02-27T14:42:20.917

从 .NET 4.5 开始（我认为微软已经使框架版本 < 4.5 的信息变得晦涩难懂），您可以使用以下[内置解析器之一](https://docs.microsoft.com/en-gb/dotnet/api/system.net.http.headers.mediatypewithqualityheadervalue?view=netframework-4.5)：`System.Net.Http.Headers`

```
public IOrderedEnumerable<MediaTypeWithQualityHeaderValue> GetMediaTypes(string headerValue) =>
    headerValue?.Split(',')
        .Select(MediaTypeWithQualityHeaderValue.Parse)
        .OrderByDescending(mt => mt.Quality.GetValueOrDefault(1)); 
```

然后你可以做这样的事情：

```
var headerValue = "application/json, text/javascript, */*; q=0.01";
var mediaTypes = GetMediaTypes(headerValue); 
```

为您提供所有媒体类型的精美列表，其中*首选*选项是第一项。`Dump`这是`mediaTypes`示例结果的 LINQPad ：

[![LINQPad 转储结果](https://i.stack.imgur.com/13u4s.png)](https://i.stack.imgur.com/13u4s.png)

提示[这个答案](https://stackoverflow.com/questions/9927871/need-an-example-on-how-to-get-preferred-language-from-accept-language-request-he#27585837)，让我走上正轨。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-04-24T08:16:20.837

我用 PHP[编写了一个解析器](http://jrgns.net/parse_http_accept_header)。它并不复杂，但它会按优先顺序为您提供一系列 mime 类型。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2011-02-15T10:04:13.727

在 php [here中找到另一个实现](http://www.thefutureoftheweb.com/blog/use-accept-language-header)

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2013-01-30T13:15:32.270

阅读 xml.com 文章后，我决定自己不为 Accept 标头编写函数；）

幸运的是，这篇文章指向了一个很好的库：[https](https://code.google.com/p/mimeparse/) ://code.google.com/p/mimeparse/ - 在我的情况下，我需要它作为 Node.js 模块：[https ://github.com/kriskowal/mimeparse](https://github.com/kriskowal/mimeparse)

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2018-10-15T09:13:49.583

以[https://stackoverflow.com/users/43140/mark-bell](https://stackoverflow.com/a/49011308/275501)的[https://stackoverflow.com/a/49011308/275501](https://stackoverflow.com/users/43140/mark-bell)为基础：

```
public class MyController : Controller
{

    [HttpGet]
    [Route("/test")]
    public ActionResult Index() {

        // does this request accept HTML?
        var acceptsHTML = IsAcceptable("text/html");
        var model = FetchViewModel();
        return acceptsHTML ? (ActionResult) View(model) : Ok(model);

    }

    private bool IsAcceptable(string mediaType) =>
        Request.Headers["Accept"].Any(headerValue =>
            !string.IsNullOrWhiteSpace(headerValue) &&
            headerValue.Split(",").Any(segment => MediaTypeHeaderValue.Parse(segment).MediaType == mediaType));

    private object FetchViewModel() {

        return new { Description = "To be completed" };

    }

} 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T04:48:32.013

[RFC](http://www.w3.org/Protocols/rfc2616/rfc2616.html)相当复杂。如果正则表达式在哪里遵循这些规则来写信，就会变成好几行。

如果您已经有 Accept-header，并忽略引号和参数，您可以执行以下操作来匹配每一对：

```
/([^()<>@,;:\\"\/[\]?={} \t]+)\/([^()<>@,;:\\"\/[\]?={} \t]+)/ 
```

`*`包含在字符类中，因此在正则表达式中不需要任何特殊情况。

# parsing - 教我的学生使用哪个解析器生成器？

> ID：255442
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2008-11-01T02:55:32.103
> 
>         
> 
> 标签：parsing, compiler-construction

我正在（和其他人）为没有计算机科学背景的 IT 专业人士教授一门相对入门的计算机科学课程。由于我开发了有关自动机和语法的课程材料，因此我还负责有关编译器和编译器构造的教学。

多年前，当我在大学学习编译时，我们所有的例子都来自 Lex 和 Yacc。这些还在广泛使用吗？有没有更常用于 Java 的东西？学生们精通 C 和 Java，但从未使用过解析器生成器。

任何关于教什么的提示将不胜感激

* * *

## 回答 #1

> 赞同：28
> 
>             
> 
> 时间：2008-11-01T03:02:54.943

[Antlr](http://www.antlr.org/)被广泛使用、有据可查且免费。它由 Ant 支持，并且可以在许多其他语言中以 Java 为目标。

* * *

## 回答 #2

> 赞同：14
> 
>             
> 
> 时间：2008-11-04T10:44:28.487

我不使用词法分析器和解析器生成器。它们很简单，可以手动生成，并且是编译器中最容易编写的部分。此外，当您手动构建它们时，您可以使它们变得非常快。

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2008-11-02T01:31:18.013

很遗憾你的学生不精通C++。一旦我遇到了[Spirit](http://spirit.sourceforge.net/)库，它具有丰富的 EBNF 风格的 DSL 的概念，我就把 Antlr、Lex 和 Yacc 抛在了后面！将语法与代码一起描述会更加灵活*。*

辉煌的图书馆，虽然有一个公认的不平凡的学习曲线。

但是，如果没有 C++，[Antlr](http://www.antlr.org/)可能是您最好的选择。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-11-01T03:07:40.657

Lex 和 Yacc 仍在使用中。最新的语言之一，F#，有它自己的版本（fslex，fsyacc——见[这里](http://strangelights.com/blog/archive/2006/05/11/1302.aspx)的例子。）所以我认为教他们仍然是相关的。

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2008-12-05T04:25:09.407

Yacc 和所有其他 LALR(1) 解析器都可以追溯到机器资源稀缺的时代，并且有必要花费大量时间来设计语法，以便您可以在具有 64K RAM 的 PDP-11 上运行解析器. 今天，教一个像 yacc 这样具有糟糕的人机界面和它可以使用的语法非常有限的工具是没有意义的。

我会推荐其中一种基于 PEG 的解析器，例如 Rats!，或者由 George Necula 和 Scott McPeak 开发的 GLR 解析器[Elkhound （感谢 quark）。](http://www.scottmcpeak.com/elkhound/)抱歉，我不能推荐 Java 的特定工具，但是 Rats！对 C 有好处。

ANTLR 还可以，但对我来说太复杂了。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T04:54:30.147

[像RATS](http://cs.nyu.edu/rgrimm/xtc/rats.html)这样的PEG 解析器系统比 lex/yacc 组合更简单。这可能对您的课程有好处，也可能不会：您的目标是教授正则表达式和有限自动机，以及 LR 语法和下推自动机等？还是您想要最简单实用的编译器前端工具？

（因为这些天我没有用 Java 编程，所以我没有特别尝试过 RATS。）

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2008-11-25T22:37:04.807

Javacc 这很容易。

在同一个文件中，您有语法和标记列表。  

[https://javacc.dev.java.net/](https://javacc.dev.java.net/)

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T03:04:12.037

我记得使用 CUP 并喜欢它。看看[CUP Parser Generator for Java](http://www.cs.princeton.edu/~appel/modern/java/CUP/)。

CUP 由慕尼黑工业大学维护。我相信它的主要目的是教学生。

它还具有免费许可模式。

> ...特此授予以任何目的免费使用、复制、修改和分发本软件及其文档的许可，前提是上述版权声明出现在所有副本中，并且版权声明和本许可声明和保证免责声明出现在支持文档中...

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T03:30:02.733

您可以跳过生成器部分并查看 Scalas 解析器组合器。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2008-11-25T22:46:56.410

如果您打算使用 Java，JavaCC 或 ANTLR 就足够了。后者也支持 C 和 Python。但是如果你打算使用 C++，也许你应该看看 Boost::Spirit。

* * *

## 回答 #11

> 赞同：1
> 
>             
> 
> 时间：2008-11-25T22:48:40.460

还没试过，不过前几天找到了[jparsec 。](http://jparsec.codehaus.org)它不是解析器生成器，而是解析器由 EBNF 样式的组合器在 java 中构建。

* * *

## 回答 #12

> 赞同：1
> 
>             
> 
> 时间：2009-07-07T12:27:17.777

我非常喜欢[GOLD 解析系统](http://www.devincook.com/)，因为它基本上会生成所需的表，然后您只需使用处理器的（通用）实现，该处理器使用表信息来处理令牌。这个引擎（因为它被称为）非常容易编写，并且基本上是一个使用 LALR 和 DFA 表来处理输入的纯实现，编写这样的实现可能是一个很好的练习来教授这些。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T05:04:39.283

我目前正在学习使用 Lex 和 Yacc 的编译器课程。我真的不知道那里有任何其他类型，但我们正在学习的理论似乎很好地映射到这些工具。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2008-11-25T22:41:18.293

我记得在我的一个编译器类中使用了 Bison。我们还使用了 flex 和 YACC。

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2009-07-07T12:22:49.447

OCaml 有一组很棒的解析器生成器。[这里](http://www.ffconsultancy.com/ocaml/benefits/parsing.html)有一些简单的例子。

JavaCC 也相当不错。

为此，我强烈建议避免使用 C（和 C++），因为在这种情况下它们非常痛苦。

# javascript - 信用卡的客户端验证

> ID：255445
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2008-11-01T02:58:27.213
> 
>         
> 
> 标签：javascript, validation, luhn

在用户点击提交之前，是否有人有一个库或 JavaScript 片段来验证信用卡的校验位？

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2008-11-01T03:52:49.287

[jQuery 验证插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)有一个验证信用卡号码的[方法。](http://jquery.bassistance.de/api-browser/plugins.html#jQueryvalidatormethodscreditcard)

还有其他特定的脚本：

*   [JavaScript 信用卡验证函数](http://www.braemoor.co.uk/software/creditcard.shtml)

*   [信用卡验证](http://www.breakingpar.com/bkp/home.nsf/0/87256B280015193F87256CC70060A01B)

他们中的大多数使用[Luhn 算法](http://en.wikipedia.org/wiki/Luhn_algorithm)。

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2013-12-21T02:54:05.053

可能 OP 甚至不再关注这个线程，但这可能对其他人有帮助：

[http://jquerycreditcardvalidator.com](http://jquerycreditcardvalidator.com/)

它检查卡片类型，验证其长度并使用 Luhn 算法检查 mod 10。

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2014-04-22T14:34:10.540

[您可以使用此代码段通过Luhn 算法](http://en.wikipedia.org/wiki/Luhn_algorithm)验证 16 位卡号：

```
function validateCardNumber(number) {
    var regex = new RegExp("^[0-9]{16}$");
    if (!regex.test(number))
        return false;

    return luhnCheck(number);
}

function luhnCheck(val) {
    var sum = 0;
    for (var i = 0; i < val.length; i++) {
        var intVal = parseInt(val.substr(i, 1));
        if (i % 2 == 0) {
            intVal *= 2;
            if (intVal > 9) {
                intVal = 1 + (intVal % 10);
            }
        }
        sum += intVal;
    }
    return (sum % 10) == 0;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2015-06-16T12:48:21.390

Luhn 算法（也称为[Luhn 公式](https://en.wikipedia.org/wiki/Luhn_algorithm)）可用于验证各种识别号（例如**信用卡号**、**IMEI**）。

我省略了算法的解释，因为它已经被其他人公开了，但如果你需要**最快的 Javascript 实现，你可以**[在这里](https://github.com/leodido/luhn.js/blob/master/src.js)看到它。

简单地说 ...

```
function luhn(array) {
  return function (number) {
    let len = number ? number.length : 0,
      bit = 1,
      sum = 0;

    while (len--) {
      sum += !(bit ^= 1) ? parseInt(number[len], 10) : array[number[len]];
    }
    return sum % 10 === 0 && sum > 0;
  };
}([0, 2, 4, 6, 8, 1, 3, 5, 7, 9]); 
```

请注意，链接源代码采用**ES6**语言（也称为 JavaScript 2015），但在**ES5**中进行了转译（参见[index.js](https://github.com/leodido/luhn.js/blob/master/index.js)），并且经过了全面的单元测试。

此外，它可以在**浏览器**和/或**node.js**中使用。

[在jsperf](http://jsperf.com/credit-card-validator/20)上进行基准测试和其他实现，以验证其高性能。

现在，如果您只是想使用它，请从链接[存储库](https://github.com/leodido/luhn.js)中获取代码。

否则通过[凉亭](http://bower.io/)安装它...

```
bower install luhn-alg 
```

或者通过[npm](http://npmjs.com) ...

```
npm install luhn-alg 
```

* * *

免责声明：我是`luhn-alg`包的作者。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2010-08-18T16:33:17.813

如果您还没有使用 jQuery 插件，您可以使用此功能。它基于 Luhn 算法，可以容忍空格或破折号，因此应该适用于您需要它的大多数数据输入案例。

[http://af-design.com/blog/2010/08/18/validating-credit-card-numbers/](http://af-design.com/blog/2010/08/18/validating-credit-card-numbers/)

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2015-01-26T10:08:51.793

[**Luhn 公式**](http://en.wikipedia.org/wiki/Luhn_algorithm)是信用卡验证中最流行的算法。不要害怕`algorithm`你正在寻找图书馆的词。这非常容易理解。根据维基百科的描述，这个算法可以分为 3 个步骤：

> *   从最右边的数字（即校验位）开始，向左移动，每第二位的值加倍；如果这个加倍运算的乘积大于 9（例如，8 × 2 = 16），则将乘积的数字相加（例如，16: 1 + 6 = 7, 18: 1 + 8 = 9）。
> 
> *   取所有数字的总和。
> 
> *   如果总模 10 等于 0（如果总和以 0 结尾），则根据 Luhn 公式，该数是有效的；否则无效。

这是我的工作草稿。

```
function luhn(anum){
    anum = anum+'';
    var sum = 0,
        max = anum.length - 1;
    //From the rightmost digit, which is the check digit, moving left
    for(var j=max;j>=0;j--){
        var digit = parseInt(anum[j]);
        //Take the sum of all the digits
        if((max - j) & 1){
            //double the value of every second digit
            var add = digit * 2;
            //if the product of this doubling operation is greater than 9 ,
            //then sum the digits of the products
            sum += add < 10 ? add : 1 + add % 10;
        }else{
            sum += digit;
        }
    }
    //If the total modulo 10 is equal to 0 (if the total ends in zero)
    //then the number is valid according to the Luhn formula;else it is not valid.
    return sum % 10 === 0;
}

luhn(79927398713) -> true 
```

# oop - 在不创建子类型关系的情况下创建继承的任何明智示例？

> ID：255447
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-11-01T02:59:45.417
> 
>         
> 
> 标签：oop, inheritance, language-agnostic

我一直在教 OOP，并试图向我的学生传达继承和创建两种类型之间的子类型关系之间的重要区别。例如，在 C++ 中，我可以使用私有继承来确保外部没有人看到子类型关系。

然而，虽然我可以想到很多我不想创建子类型关系的情况（例如，通过双向链表类实现堆栈），但我真的想不出我会想的好的设计示例实际上选择遵循继承而不创建公共子关系（而不是使用聚合）。

有什么好的例子吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T03:14:40.300

作为一名 Python 程序员，让我说这些事情太微妙了。它们似乎是纯粹的 C++ 主义。

在 Python 中，我们有继承，它会创建适当的子类型。

我们使用简单属性或可用集合进行组合。

私有继承作为一种组合的业务似乎只是令人困惑。而且基本上没用。  

C++ 示例展示了使用公共接口创建组合的私有继承。在 Java 中，我们有一个通用接口。在 Python 中，我们有鸭子类型，不需要形式。

我不认为有很好的例子——我认为这个概念太微妙了，没有任何实际价值。  

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T03:04:52.940

没有子类型的代码重用是使用*委托*完成的。

[委托就是继承](http://c2.com/cgi/wiki?DelegationIsInheritance)。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T03:26:54.863

在 javascript 中，您可以通过原型进行继承。我不会称之为子类型。由于javascript对象中没有类从其原型继承，但同时具有相同原型的对象彼此独立，可以演变为非常不同类型的对象。

# markdown - 存储和显示 Markdown 输入文本的最佳方式是什么？

> ID：255448
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2008-11-01T03:00:01.080
> 
>         
> 
> 标签：markdown

我注意到 wmd 编辑器可以输出 HTML 或 markdown。将用户输入（在数据库中）存储为 markdown 或 HTML 是否更有意义？如果作为降价，稍后在网页上显示它的最佳方式是什么（任何示例将不胜感激）。

鉴于建议将其存储为降价，是否有任何标准转换器/样式表/其他任何东西可以在之后实际显示它？

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2008-11-01T03:36:56.510

我会说将降价存储在数据库中并在显示时将其处理为 HTML 更容易。

您*可以*将输入存储为 HTML，然后当用户想要编辑它时，使用[markdownify](http://milianw.de/projects/markdownify/)之类的东西将其转换回 markdown - 但您并没有真正获得任何东西，并且损失了很多（原始的 markdown 格式） . 它也是一个回合（你将markdown转换为HTML，存储它。然后将HTML转换为markdown，允许用户编辑它，将它转换回HTML，然后存储它..）

如果您担心在每个页面视图上解析 Markdown 的性能：将输出 HTML 缓存在临时的某个地方（在内存中或在磁盘上）。HTML 比源 markdown 更容易重新创建

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2008-11-01T03:12:01.320

从对降价和 wmd 的几乎完全无知说起：

如果您希望用户以后能够编辑条目，您*不必*将其存储为降价吗？

在检索/显示时，您需要通过某种降价渲染器运行它。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-11-05T10:46:35.130

看起来有关于如何为[另一个线程](https://stackoverflow.com/questions/125911/saving-contents-of-the-wmd-editor-control)上保存的降价生成相应 HTML 的详细信息。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-01-17T22:35:22.583

我认为允许后续编辑的最佳方法是存储降价文件。用户编辑或上传后，它是markdown语法的文件保存并生成html并存储生成的html。

当用户更新 markdown 文件时，您只需要“重新生成”html。

我不确定您使用的是什么技术，但是有一个 python markdown 处理器，有用于代码语法突出显示的 pygments，并且 python-markdown 内置了对 pygments 的支持，因此您可以在一行中从 markdown 文件中获取 html 并突出显示所有源代码。

您需要更新 css 以包含用于代码突出显示的样式，您可以从 pygments 转储默认样式并将其附加到您的页面样式。

这是一个如何在[Blogger 中使用 markdown 和 pygments](http://mybyteofcode.blogspot.com/2010/01/use-markdown-and-pygments-with-blogger.html)的示例。

# java - apache common vfs和mercurial的集成

> ID：255453
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-11-01T03:02:57.313
> 
>         
> 
> 标签：java, mercurial, apache-commons-vfs

Apache common vfs api 可以从 Mercurial 版本控制系统检索/更新/添加文件吗？常见的 vfs 确实有访问 vcs 的接口 api。Mercurial 有供应商吗？

巴吉

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T03:16:20.280

我不认为有一个。Mercurial 在很大程度上建立在“你应该拥有本地历史”的心态。任何缺少同步或随意浏览网页的远程访问通常都被认为是不受支持的。甚至建议不要通过 nfs 或其他网络文件系统访问 mercurial 存储库。

有一些项目使用 mercurial 作为后端（例如 ikiwiki），但远程访问通常不是建议的配置。

# html - html中有哪些不同的文档类型，它们是什么意思？

> ID：255470
> 
>         
> 
> 赞同：35
> 
>         
> 
> 时间：2008-11-01T03:16:54.273
> 
>         
> 
> 标签：html, xhtml, doctype

正如标题所描述的，有哪些不同的文档类型可用，它们是什么意思？我注意到当我从 IE7 切换时布局看起来有点不同

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" > 
```

到

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

还有其他的吗？有什么影响或后果？

谢谢！

* * *

## 回答 #1

> 赞同：54
> 
>             
> 
> 时间：2008-11-01T03:23:52.170

传统上，**Doctype**或**Document Type Declaration**将文档与**Document Type Definition**相关联。

**文档类型定义**是特定 XML 或 SGML 文档的标准。除了标签和属性的一般工作方式之外，XML 和 SGML 本身没有太多的模式或非常具体的规则集。您可以将 DTD 视为对特定类型文档（如 HTML、SVG 或 MathML）的规则的描述。他们说在哪里允许使用哪些标签（例如，一个`html`元素必须包含一个`head`元素，后跟一个`body`元素）。

有 DTD 的替代品，例如今天更常用的 XML 模式。

然而，浏览器根本不使用 DTD。他们读取 Doctype 来确定*呈现模式*，但解析文档的规则完全嵌入到浏览器中。

这就是为什么 HTML 5 有一个 Doctype（用于确定呈现模式）但没有 DTD。

**渲染模式**

早期的网络浏览器漏洞百出。当新版本发布时，他们必须保持与前辈和竞争对手的兼容性。这使得修复 bug 变得非常困难，因为网站的构建依赖于它们。

为了解决这个问题，现代浏览器有不同的渲染模式（**标准模式**，用于根据标准渲染文档和 css，以及**怪癖模式**，其中浏览器模拟早期浏览器的错误，以及介于两者之间的**几乎标准模式）。**

**选择文档类型**

选择 Doctype 时需要考虑两个因素：

*   它会触发标准模式吗？（对于新页面*应该*是，您需要与不支持标准模式的浏览器兼容的情况在今天非常罕见）。

*   它是否支持我需要的功能？

一般来说，这意味着您应该使用 HTML 5。它是当前标准，最能反映浏览器的实际工作方式：

```
<!DOCTYPE html> 
```

失败了。严格的文档类型避免了大多数应该用 CSS 处理的特性。

在**XHTML 1.0**中编写时，这种 Doctype 很常见：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

更多过时的功能可通过以下方式获得：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"> 
```

**当用HTML 4.01**编写时，这个很常见：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd"> 
```

随着过时的功能在

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd"> 
```

和

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN"
"http://www.w3.org/TR/html4/frameset.dtd"> 
```

请注意，以上大部分内容都有变体（例如，您可以省略 URL 并依赖公共标识符），这对标准模式的支持有影响。[这篇文章包括一个广泛的列表](https://hsivonen.fi/doctype/)。

**关于严格文档类型与过渡文档类型的辩论**

（请注意，以下内容很多， 2021 年的真实性**肯定**不如 2008 年的真实性）

标准传播者呼吁 Web 开发人员停止在新页面上使用 Transitional Doctype，而是使用 Strict。同样，这是一个理论和实践难以协调的案例。过渡型 Doctype 最初的希望是为遗留网站向标准合规性过渡提供一个中途站。使用过渡文档类型，对元素和属性的限制实际上是“不那么严格”，因此开发人员可以更快地在标准模式下运行他们的工作，并随着时间的推移逐步消除突出的差异。

存在争议是因为开发人员在企业环境中更改 Doctype 并不总是那么简单。中小型网站的自由开发者和制造商通常可以更轻松地确定他们的 Doctype 并进行这种转换。在高需求的基于 Web 的服务的企业生产环境中，对遗留系统和 3rd 方代码产品本身存在更复杂的依赖关系，它们本身可能在移除或重新设计的路线图上，但这些更改的执行必须是有条不紊地、循序渐进地完成。

**有用的工具**

W3C（[**万维网联盟**](http://en.wikipedia.org/wiki/W3C)）是一个在定义这些标准方面发挥积极作用的组织。[**他们在http://validator.w3.org/**](http://validator.w3.org/)维护了一个有用的在线工具，用于根据他们的标准验证和验证文档。还有许多其他具有类似功能的3rd 方工具和[**浏览器扩展。**](http://addons.mozilla.org/en-US/firefox/search?q=validator&cat=all)

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2008-11-01T16:29:39.900

浏览器[不在乎](http://wiki.whatwg.org/wiki/FAQ#Syntax_issues)您使用什么文档类型（嗯，几乎是真的），它们只将它用于一件事且仅一件事：决定使用哪种*渲染模式*。请参阅例如[Fx](https://developer.mozilla.org/en/Mozilla%27s_DOCTYPE_sniffing)或[Opera 文档](http://www.opera.com/docs/specs/doctype/)，了解有关使用哪些算法来决定使用哪种模式的真实示例（我想在 MSDN 的某个地方也有一些 IE 文档...... [这可能是正确的页面]（[http ://msdn.microsoft.com/en-us/library/ms535242(VS.85).aspx)](http://msdn.microsoft.com/en-us/library/ms535242(VS.85).aspx))，我不知道，抱歉）。

然而，大多数浏览器有两种主要模式（一些浏览器也有[几乎标准模式](https://developer.mozilla.org/en/Gecko%27s_%22Almost_Standards%22_Mode)）：

*   **怪癖模式**（当没有找到“正确”的文档类型时使用，从浏览器的角度来看是“正确的”）：尝试像某些旧版本的 IE 那样渲染文档（最重要的区别之一，即最影响渲染, 是某些浏览器在这种模式下利用了[IE 框模型的 bug ),](http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug)

*   和**标准模式**（当浏览器发现它认为正确的文档类型时使用）：尝试按照标准所说的那样做。

您可以在前面提到的浏览器中使用（非标准）[`document.compatMode`](https://developer.mozilla.org/En/DOM/Document.compatMode)属性来检查用于呈现当前文档的模式。

（关于 XHTML 的注意事项：我假设您将文档作为 HTML ( `text/html`) 提供，如果您将文档作为 XHTML 提供（可能`application/xhtml+xml`）大多数浏览器会直接跳转到标准模式并且根本不关心文档类型 AFAIK。）

顺便说一句：另一个答案中的建议（或看起来像建议的内容）已损坏，[过渡性](http://dictionary.reference.com/search?q=transitional)DTD 不应用于新文档。始终使用严格（术语“严格”有点误导，应该是“默认”或其他不可怕的东西），句号：

> 作者应尽可能使用 Strict DTD，但在需要支持表示属性和元素时可以使用 Transitional DTD。- [HTML 4.01：22 过渡文档类型定义](http://www.w3.org/TR/REC-html40/sgml/loosedtd.html)。
> 
>   
>   
> 
> 我们建议作者编写符合严格 DTD 而不是本规范定义的其他 DTD 的文档。-- [HTML 4.01: 4 一致性：要求和建议](http://www.w3.org/TR/REC-html40/conform.html#h-4.1)

并且有很多关于此的博客文章，例如[，请不要再使用过渡文档类型](http://www.456bereastreet.com/archive/200609/no_more_transitional_doctypes_please/)（从 2006 年开始，但*有些*显然仍然存在问题:)。

这篇文章一开始指出浏览器不在乎你选择什么，然后发展成为关于如何选择正确的 DTD 的咆哮，很有趣……但是如果你要花费（/浪费？）时间和精力要选择 DTD，您不妨选择正确的 DTD（从 HTML 4.01 标准的角度来看）。

*或者*，您可以忽略所有这些并使用以下命令[，](http://ishtml5readyyet.com)[无论如何](http://blog.whatwg.org/two-thousand-twenty-two) ：

```
<!doctype html> 
```

（[这个回答](https://stackoverflow.com/questions/5629/any-reason-not-to-start-using-the-html-5-doctype#14192)“有什么理由不开始使用 HTML 5 doctype？”与最后一部分有关。）

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T03:23:06.070

以下是 W3C 对各种 DTD 的官方解释：

[http://www.w3.org/QA/2002/04/valid-dtd-list.html](http://www.w3.org/QA/2002/04/valid-dtd-list.html)

您可能还会发现以下好处：

[http://www.freedivs.com/tutorials/Choosing%20a%20DOCTYPE/](http://www.freedivs.com/tutorials/Choosing%20a%20DOCTYPE/)

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2008-11-02T21:00:33.737

我写了[一篇文章，解释了文档类型如何参与渲染模式选择](http://hsivonen.iki.fi/doctype/)。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-11-02T08:48:32.763

关于文档类型有很多错误信息。混淆源于这样一个事实，即 doctypes 最初是为了一个目的（识别 DTD，即使用的 HTML 版本），但在现实世界中，浏览器用于完全不相关的目的。

在当今的浏览器中， Doctype 声明仅用于**一件事，即在***quirks*渲染模式和CSS*标准*渲染模式之间切换。所以基本上它是 CSS 的东西，而不是 HTML 的东西。

Quirks 模式渲染向后兼容旧浏览器中的一些旧渲染错误，并且对于您不想修复的遗留内容非常有用。新内容应始终使用标准模式，因为它在浏览器之间呈现更正确和一致。（使用标准模式时，浏览器之间仍然存在渲染差异，但在 quirks 模式下更差。）

无论您选择 HTML 还是 XHTML 文档类型都没有任何区别，如果您选择严格或过渡文档类型也没有任何区别**。**渲染模式基本上是这样选择的：

*   如果文档没有任何 doctype，则选择*quirks*模式。

*   如果文档具有*无法识别*的文档类型，则选择*标准*模式。这意味着你可以编写一个随机的文档类型`<!DOCTYPE Chris>`，它会工作得很好。

*   *没有*正确 url（标签中的第二个字符串）的官方 W3C 文档类型会选择*quirks*模式。所有其他文档类型选择标准模式。（编辑：当然它比这更复杂，甚至在浏览器之间会有所不同，哪些已识别的文档类型会触发怪癖模式[。Se hsivonens overview](http://hsivonen.iki.fi/doctype/)，链接自另一个答案。）

从历史上看，文档类型旨在声明使用了哪个版本和 HTML 的子集。HTML4 定义了几个版本，其中“过渡”允许许多元素和属性（如 FONT）在“严格”中是不允许的。理论上，浏览器可以处理与“过渡”文档不同的“严格”文档。但是*实际上没有浏览器这样做*。

编辑：sculiffe 指出 IE8 将有另一种渲染模式，“IE8 标准”模式。然而，AFAIK 这种模式不是由文档类型触发，而是由元标记触发。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T22:11:25.373

基本上，文档类型决定了 IE 的疯狂程度。

如果您不将其设置为 XHTML 或“严格”，那么当涉及到 IE 时，您将生活在一个痛苦的世界中（即使您设置了它，您仍然会讨厌 IE，但它确实做到了好了很多）。

# python - 基于浏览器的应用程序还是独立的 GUI 应用程序？

> ID：255476
> 
>         
> 
> 赞同：33
> 
>         
> 
> 时间：2008-11-01T03:25:09.843
> 
>         
> 
> 标签：python, user-interface, browser

我确定以前有人问过这个问题，但我找不到。

将基于浏览器的界面用于独立应用程序与使用普通 GUI 框架相比有哪些好处/限制？

我正在开发一个当前使用 wxPython 为 GUI 实现的 Python 程序。该应用程序只是用户输入表单和对话框。我正在考虑迁移到 PyQt，因为它有一些小部件（用于未来的扩展），然后我意识到我可能只使用浏览器来做很多相同的事情。

该应用程序目前不需要 Internet 访问权限，但将来有可能。如果我基于浏览器，我正在考虑将[Karrigell用于 Web 框架。](http://karrigell.sourceforge.net/)

* * *

**编辑**为澄清起见，截至目前，该应用程序将基于浏览器，而不是基于 Web。所有信息都将本地存储在客户端计算机上；不需要进行服务器调用，也不需要访问 Internet（不过可能会在以后出现）。它只是一个浏览器 GUI 而不是 wxPython/PyQt GUI。希望这是有道理的。

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2008-11-01T03:53:47.490

让我们假设开发/部署/维护工作量/成本是相等的，我们从应用程序用户的角度来看：

*用户会发现哪个 UI 更有用？*

按照

*   便于使用

*   响应能力

*   熟悉的导航/使用模式

*   最像平台上使用的其他工具/应用程序（即本机）

我知道“有用”是主观的。如果我能侥幸逃脱，我个人永远不会再使用（作为用户，而不是开发人员）Web 界面。我***恨***他们。

有些应用程序开发为基于浏览器的应用程序是没有意义的。

从发展的角度

*   今天没有两个可用的浏览器呈现*完全相同*的内容。

*   即使使用 Ajax、javascript 和动态、响应式接口，实现/调试也并非易事。

有许多非常糟糕的独立 GUI 应用程序，没有争议。多平台 GUI 的开发/部署和维护并非易事。

开发良好的用户界面是困难的，时期。

现实情况是，在过去的 10 年里，我以开发主要基于 Web 的应用程序为生，因为它们开发速度更快、部署更容易，并且提供了足够的实用程序，以便人们在必要时使用它们。

如果有替代方案，我不相信大多数用户会使用 Web 界面。

明示

* * *

## 回答 #2

> 赞同：14
> 
>             
> 
> 时间：2008-11-01T03:29:53.123

基于浏览器的明显优势：

*   无论平台如何，您都可以呈现相同的 UI

*   您可以轻松升级应用程序，并且所有用户都运行相同版本的应用程序

*   您知道您的应用程序将在其中运行的环境（服务器硬件/操作系统），与安装 GUI 应用程序的众多操作系统/硬件配置相比，这使得测试和支持更容易。

对于基于 GUI：

*   一些应用程序（例如：图像编辑）可以说在原生 GUI 应用程序中工作得更好

*   不需要网络访问

另请参阅我对[这个问题](https://stackoverflow.com/questions/115501/is-ruby-any-good-for-gui-development#115638)的评论：

> 跨平台 GUI 是一个古老的问题。Qt、GTK、wxWindows、Java AWT、Java Swing、XUL——它们都面临着同样的问题：生成的 GUI 并不是在每个平台上看起来都是原生的。更糟糕的是，每个平台的外观和**感觉**都略有不同，因此即使您能够以某种方式获得一个在每个平台上看起来都是原生的工具包，您也必须以某种方式编写您的应用程序以在每个平台上都感觉原生。
> 
> 它归结为一个决定：您是想尽量减少开发工作并拥有一个在每个平台上看起来和感觉都不太正确的 GUI，还是想最大限度地提高用户体验？如果选择第二个选项，则需要为每个平台开发一个通用后端和自定义 UI。*[编辑：或使用网络应用程序。]*

我刚刚想到的另一个想法：您还需要考虑您的应用程序操作的数据类型及其存储位置，以及用户对此的感受。人们显然可以将他们的 facebook 个人资料数据存储在网络服务器上，但是如果您正在编写像 MYOB 这样的财务应用程序并且您希望将他们所有的个人财务详细信息存储在您的服务器上，他们可能会有不同的感受。您也许可以让它发挥作用，但需要付出很多努力来实现所需的安全性并确保用户群他们的数据是安全的。在这种情况下，如果您使用原生 GUI 应用程序，您可能会认为整体工作量会更低。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2008-11-01T03:37:23.703

当谈到使用用户输入表单的简单数据输入时，我认为使用基于浏览器的解决方案可能会更容易和更快地开发。

除非您的核心功能是界面本身（“*如果它是核心业务功能 - 无论如何都要自己做。* ”，请参阅Joel的[In Defense of Not-Invented-Here Syndrome](http://www.joelonsoftware.com/articles/fog0000000007.html) [on Software](http://www.joelonsoftware.com/)），我觉得浏览器会能够比从头开始开发 GUI 更好地执行表单渲染和处理。此外，更不用说编写 GUI 代码需要更长的时间，而不是生成 HTML 表单并在浏览器发布后处理它们。

过去我发现，一个朋友让我写一个应用程序来输入调查结果。起初，我正在编写一个 Java 小程序来显示带有所有单选框的调查本身，当我突然想到我最好编写一个简单的 HTTP 服务器来生成表单并处理它们。

真正归结为您是否正在开发：

1.  用户界面

2.  数据输入应用程序

如果您正在制作数据输入应用程序，则将用户界面留给浏览器，并专注于您的核心功能。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T03:49:50.463

基于浏览器的界面的好处：

*   更易于管理：无需在用户机器上安装，升级只需在服务器端执行，所有用户都可以立即使用。数据备份可以在单台机器上执行，因为数据不会分布在多个客户端上。

*   可以使用浏览器从任何机器访问应用程序。

*   可以轻松一致地支持多个平台。

*   客户端的内存和 CPU 需求可能会大大减少，因为可以在服务器上执行密集的操作。

*   提高安全性：数据存储在单个服务器而不是多个客户端计算机上，并且可以更好地控制访问。

*   集中式环境的许多其他好处，包括日志记录、从多个来源输入的数据可以立即从其他客户端获得等。

*   根据我的经验，开发基于 Web 的解决方案通常更容易调试和更快。

基于 GUI 的界面的优点：

*   可能更容易设计一个响应更快、更流畅的界面。

*   可以利用浏览器可能无法使用的特定于操作系统的功能。

*   不一定需要网络访问。

*   无需担心浏览器兼容性问题。

*   如果服务器出现故障或不可用，则不会出现单点故障。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T03:51:15.500

有很好的证据表明，在大多数情况下，王牌问题是可部署性和可支持性。浏览器应用程序的开销通常较低；实施和支持几十个用户最终会消耗大量支持资源。

一两年前我看到一张桌子，上面显示如下：

UI 质量 -

验证的桌面粒度 - 桌面

响应性 - 桌面

用户接受度 - 桌面

  等 - 桌面

  等 - 桌面

安装和支持 - 浏览器

和浏览器获胜。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T04:05:43.957

对于这项任务（基于表单的文本输入），浏览器非常棒。作为桌面应用程序，您不需要任何东西（速度、灵活性）

作为 Web 应用程序存在一些缺点，例如..

**这是一个网页。有些事情你不能（容易）做**

你不能轻易地映射 ctrl+j 键来做某事。例如：谷歌电子表格尝试映射键盘快捷键并且  *大部分*时间都可以工作，有时浏览器默认处理快捷键会接管..

你不能发出咆哮警报（一个 OS X 通知框架）。您无法访问文件系统。离线时很难允许访问。

**Javascript 占用大量 CPU。**

尝试调整 Google 电子表格文档的大小，或在 Digg（一个非常重的 javascript 网站）上加载页面 - 浏览器 CPU 使用率将在一段时间内达到 100%。在本机桌面应用程序中做同样的事情是微不足道的

**当您执行升级时，您会*强制*对所有用户进行升级。**
对于桌面应用程序，他们可以选择不升级。例如，我不喜欢其中一项 Google 阅读器升级，但我被卡住了。使用 NetNewsWire（一个桌面应用程序），如果我不喜欢最新版本的更改，我可以很容易地继续使用这个（或尝试它，然后降级）

**您的网络服务器*必须*随时可以访问，永远**

如果服务器消失，您的用户将没有追索权。应用程序不见了。如果它关闭了 10 分钟，他们将无法使用它。

* * *

对于您的应用程序，虽然我不太确定它是什么，但以上似乎都不是问题。

*“这是一个网页”*：表单和对话框在 HTML 和 javascript 中很容易实现（甚至使用服务器端脚本，例如`<?php if($_POST["email"] ==""){echo("Are you sure you want to continue?); ?>`）

*“Javascript is very CPU-heavy”*：听起来您的应用程序不需要任何 Javascript（当用户单击“提交”时可能需要一些客户端输入验证，以警告他们任何输入错误？）

*“强制升级”*：我想这可能是可取的，因为您不希望用户以旧方式输入数据。

*“服务器必须可访问”*：可能是一个问题，但我认为这不会是一个大问题。假设您想将所有用户数据存储在中央数据库中，无论如何这个问题都变得不可避免 - 保持网络和数据库服务器运行的工作并不比数据库多多少（用于连接 GUI）

此外，您还可以获得其他人发布的好处 - 您只需开发一次，它就可以在每个可以运行正常浏览器的操作系统上以相同的方式运行。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-11-05T18:29:28.890

我讨厌基于 Web 的 UI 的一件事是它们在另一个窗口中运行。这意味着，您拥有与您的应用程序无关的控件（可能有几十个）。从可用性的角度来看，这可能会让人感到困惑，尽管我们大多数人已经通过“调整”额外的东西来适应。

当我在键入此内容时查看浏览器窗口时，窗口可能有 12 英寸高，但我键入的窗口可能只有 3 英寸。在这 12 英寸的整体中，可能有两英寸被浏览器工具栏、选项卡、书签行和状态栏占据，这些都与我正在与之交互的 Web 应用程序无关。浪费了很多空间（例如，编辑窗口没有整个窗口那么宽），空间充满了我不需要的东西，等等。一些最基本的控件（后退按钮，I'我看着你）可以完全破坏设计不佳的 Web 应用程序。

更不用说如果我输入足够长的响应，我现在会得到两组滚动条。stackoverflow.com 通过给我一个可调整大小的文本区域来部分解决这个问题，但我仍然必须与内部滚动条交互以滚动我正在编辑的文本，然后向上或向下滚动整个窗口以访问顶部或底部的应用程序控件的编辑窗口。

总而言之，基于 Web 的应用程序无法与桌面应用程序的可用性相提并论。那么，对我来说，问题就变成了“您是对可用性更感兴趣，还是对让您（作为开发人员）的生活更轻松更感兴趣”。

如果您想要可用性，请使用桌面应用程序，放下手。如果您关心部署和支持 Web 应用程序，则需要考虑，但仍有许多简单的方法可以部署桌面应用程序，包括创建可以在运行时通过网络自我更新的应用程序。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T03:30:08.117

可以在任何地方通过互联网访问浏览器，并将其部署在服务器上。桌面应用程序必须部署到他们的计算机上，并且每台计算机在某种程度上都有自己的独特性，即使使用相同的操作系统和相同的版本。这可能会给您带来很多麻烦。上网吧。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-11-02T11:07:25.963

一切都有优点和缺点，但是：

*我还没有在 localhost、Intranet 或 Internet 上使用单一的基于浏览器的应用程序，它使用起来感觉很好、响应迅速，并且谁的用户界面不受 HTML/JS/CSS 限制的严格限制。*

注意：基于 Flash/Java 的 UI 是一个例外（但在某些方面甚至更糟，我认为这不是您在此处所说的）。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-02-22T07:41:51.613

我认为基于浏览器的 UI 概念将继续存在。没有什么比 Web 本身更可入口的了，只要一个人停留在像样的 javascript 库的范围内……呈现几乎是一样的。另外，由于渲染不是您的头疼问题，您可以更多地关注开发业务逻辑本身。

我完全同意...

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2010-04-25T06:14:31.617

富客户端 GUI 通常会更快更好地与用户习惯处理的外观和感觉集成 - 这不仅意味着花里胡哨，还意味着节省大量时间的功能，如键盘快捷键。

基于 Web 的 UI 将更具可移植性，因为它不会将开发绑定到单个平台，并且如果应用程序在远程运行，则更容易在一致的环境中更新和测试所有应用程序（不包括 GUI...）（你的服务器）。但是你应该明白，虽然所有这些都很棒并且非常具有开创性，但它也带来了一些严重的缺点。您不仅应该在所有目标系统下调试应用程序，而且还应该在每个目标系统上运行的每个浏览器下调试......并且不要忘记同一浏览器的多个版本可能会共存一段时间，并且每个浏览器的设置可能会运行不同的流行插件集（和版本），这使其行为不同，并且可能网络设置将由用户自定义。如果应用程序在远程，它会带来很多有趣的新问题，从不同的 ISP 开始，会在中间丢弃不同的问题，或者由于服务器、用户机器或中间任何地方的网络问题导致服务停机。在网络服务质量低或价格不合理的国家，并非所有用户都可以选择远程应用程序；对您来说也是如此：只有在您所在国家/地区的带宽合理且价格合理的情况下，您才能开始提供此类服务。如果应用程序必须在用户的系统上做一些不平凡的事情，那么无论如何你可能注定要创建大量依赖于平台的代码。或由于您的服务器、用户机器或中间任何地方的网络问题导致的服务停机。在网络服务质量低或价格不合理的国家，并非所有用户都可以选择远程应用程序；对您来说也是如此：只有在您所在国家/地区的带宽合理且价格合理的情况下，您才能开始提供此类服务。如果应用程序必须在用户的系统上做一些不平凡的事情，那么无论如何你可能注定要创建大量依赖于平台的代码。或由于您的服务器、用户机器或中间任何地方的网络问题导致的服务停机。在网络服务质量低或价格不合理的国家，并非所有用户都可以选择远程应用程序；对您来说也是如此：只有在您所在国家/地区的带宽合理且价格合理的情况下，您才能开始提供此类服务。如果应用程序必须在用户的系统上做一些不平凡的事情，那么无论如何你可能注定要创建大量依赖于平台的代码。只有在您所在国家/地区的带宽合理且价格合理时，您才能开始提供此类服务。如果应用程序必须在用户的系统上做一些不平凡的事情，那么无论如何你可能注定要创建大量依赖于平台的代码。只有在您所在国家/地区的带宽合理且价格合理时，您才能开始提供此类服务。如果应用程序必须在用户的系统上做一些不平凡的事情，那么无论如何你可能注定要创建大量依赖于平台的代码。

归根结底，今天这两种解决方案中的任何一种都有优点和缺点。有些应用程序确实需要在富客户端模型下开发，而有些应用程序确实需要在基于 Web 的范式下开发。两种选择都很好，清楚地了解最适合我们的开发/部署/支持策略的方式至关重要，而且，我可能会补充说，追求其中一个或另一个是愚蠢的是追随当下时尚的终极灵丹妙药。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2013-06-27T10:00:29.277

我的解决方案是这样

1.  网站应用程序显然在浏览器上运行

2.  不需要访问客户计算机的联网应用程序通过浏览器运行

3.  一次需要多个客户端访问的任何应用程序都通过浏览器进行

4.  将在每个客户端使用且对网络没有明显需求的应用程序保留在 gui 中，这可能包括在使用时需要大量安全性的软件（尽管基于浏览器可以解决相同的安全性问题）。

这是通过艰苦的方式学到的东西。一个主要原因是客户发现安装和管理基于浏览器的应用程序比基于 gui 的应用程序更容易，例如，使用 JavaWebStart 意味着客户端需要具有最低限度的 JRE 和他们的喜好，而基于浏览器的只需要一个链接。

在所有的决定真的是你的！作为使用 JavaFX 和 Swing 的 Java 开发人员可以解决我的问题。

# rest - Why did Microsoft choose a RESTful API over WebDAV for BLOB storage?

> ID：255477
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T03:25:33.493
> 
>         
> 
> 标签：rest, webdav

Microsoft's new [Windows Live Application Based Storage API](http://msdn.microsoft.com/en-us/library/cc305108.aspx) is a RESTful API.

More info is [here](http://msdn.microsoft.com/en-us/library/cc305108.aspx).

Why did they choose not to support WebDAV?

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T03:38:11.143

WebDAV is for managing files on a remote server, but perhaps is not generic enough for what Microsoft was trying to accomplish.

There's also a lot of hype around REST lately and they are probably in competition with S3 from Amazon which offers a REST API.

It would have been good of them to provide their RESTful API as well as WebDAV.

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T03:39:48.597

Microsoft has ADO.NET data service which provides RESTful API for data. 
Perhaps they have used the framework for the storage.

* * *

## 回答 #3

> 赞同：-2
> 
>             
> 
> 时间：2013-05-07T12:02:16.790

Im been using WebDav on some other project like android and see all kind of scenario compare from REST Api.

Using WebDav, when you had multiple files like 5 thousand files or more and getting there value from the webdav server, open the file take time because of streaming or reading each of them, using REST Api in one content for all records in good format of json is faster than webdav.

# kpi - 什么是新项目的基本工具？

> ID：255485
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T03:30:12.110
> 
>         
> 
> 标签：kpi

很长一段时间，我认为要开始一个新项目，我们只需要 3 个基本工具。1) 构建系统（例如 Maven 和 CruiseControl） 2) 版本控制系统（例如 CVS 和 SVN 和 GIT） 3) 错误跟踪系统（例如 Bugzilla）

昨天，一位资深人士告诉我，我们至少还需要一件事。那就是KPI（关键绩效指标）。没有KPI，就无法衡量项目进展是否顺利。

与 Maven/SVN/Bugzilla 相比，KPI 是一种 SOFT 工具。我相信，既然我错过了 SOFT 工具，那么肯定还有其他一些我错过的工具。那么，有人知道新项目还需要哪些其他基本工具吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T03:34:53.707

用于团队成员、客户或用户的项目管理工具。

最重要的部分之一是与人互动，项目管理工具允许您显示进度/里程碑，并组织功能请求、缺陷和资源以及论坛、通知和文档上传等其他功能。这使您的客户可以清楚地了解项目。

Redmine 非常适合我。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-11-02T03:18:41.807

我们发现 wiki 对于记录规格、设计、想法、问题以及我们需要记住的任何其他“活”信息非常宝贵。

Atlassian 提供 Confluence，这是一个非常便宜（1200 美元）的基于 Web 的 wiki，*开箱*即用。它非常可定制，但我们开始使用它几乎是零努力。有大量的社区支持（他们使用自己的工具），并且有许多插件可用。从[http://www.atlassian.com/software/confluence/ConfluenceDownloadCenter.jspa](http://www.atlassian.com/software/confluence/ConfluenceDownloadCenter.jspa)下载或在[http://confluence.demo.atlassian.com/display/ds/Confluence+Overview](http://confluence.demo.atlassian.com/display/ds/Confluence+Overview)在线试用。

*我不为 Atlassian 工作；我只是一个**非常**满意的客户！*

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2010-01-05T19:13:24.383

The human can be one of the biggest factors when creating a project that sometimes people (sadly) overlook. If the human side isn't up to scratch then the project won't always reach is full potential.

Lots of tools exist, forums, mail lists ect. They all are paramount if you want to make a good project where everyone can work and feel part of the development community where everyone knows the over all **goal** and where the project as a whole is headed at all times.

# refactoring - TDD 如何使重构更容易？

> ID：255509
> 
>         
> 
> 赞同：28
> 
>         
> 
> 时间：2008-11-01T03:56:36.673
> 
>         
> 
> 标签：refactoring, tdd

我听说使用 TDD 开发的项目更容易重构，因为这种做法产生了一套全面的单元测试，如果任何更改破坏了代码，这些测试将（希望）失败。然而，我所看到的所有示例都涉及重构实现——例如，用更有效的算法更改算法。

我发现重构架构在设计仍在制定的早期阶段更为常见。接口发生变化，添加和删除新类，甚至函数的行为也可能略有变化（我以为我需要它来做这个，但它实际上需要做那个）等等......但是如果每个测试用例都是紧密耦合的对于这些不稳定的类，您不是每次更改设计时都必须不断地重写您的测试用例吗？

在 TDD 中什么情况下可以更改和删除测试用例？您如何确保更改测试用例不会破坏它们？另外，似乎必须将全面的测试套件与不断变化的代码同步会很痛苦。我知道单元测试套件可以在维护期间提供巨大帮助，一旦软件构建、稳定和运行，但这是在游戏后期，而 TDD 也应该在早期提供帮助。

最后，一本关于 TDD 和/或重构的好书会解决这些问题吗？如果是这样，你会推荐哪个？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2008-11-01T20:41:54.040

您需要记住的一件事是，TDD 主要*不是*一种测试策略，而是一种设计策略。您首先编写测试，因为这有助于您提出更好的解耦设计。更好的解耦设计也更容易重构。

当您更改类或方法的功能时，测试也必须更改，这是很自然的。事实上，遵循 TDD 意味着您*首先*更改测试，当然。如果您必须更改大量测试以仅更改单个功能，这通常意味着大多数测试都过度指定了行为 - 它们测试的内容超出了应测试的范围。另一个问题可能是责任没有很好地封装在您的生产代码中。

不管是什么，当你因为一个小改动而经历许多测试失败时，你应该重构你的代码，这样它就不会在将来再次发生。总是有可能做到这一点，尽管并不总是显而易见的。

随着更大的设计更改，事情可能会变得更加复杂。是的，有时编写新测试并丢弃旧测试会更容易。有时，您至少可以编写一些集成测试来测试整个重构部分。并且您希望仍然拥有您的验收测试套件，这些测试大多不受影响。

我还没有读过它，但是我听说过《XUnit 测试模式 - 重构测试代码》这本书的好东西。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2008-11-02T22:09:06.610

> 另外，似乎必须将全面的测试套件与不断变化的代码同步会很痛苦。我知道单元测试套件可以在维护期间提供巨大帮助，一旦软件构建、稳定和运行，但这是在游戏后期，而 TDD 也应该在早期提供帮助。

我确实同意在这些早期变化中可以感受到单元测试套件的开销，当主要的架构变化发生时，但我认为单元测试的好处远远超过这个缺点。我经常认为问题出在心理问题上——我们倾向于将单元测试视为代码库的二等公民，我们讨厌不得不与它们打交道。但随着时间的推移，随着我开始依赖它们并欣赏它们的有用性，我开始认为它们与代码库的任何其他部分一样重要，也同样值得维护和工作。

主要的架构“变化”真的只是重构吗？如果您只是重构，无论多么显着，并且测试开始失败，那可能会告诉您您无意中更改了某处的功能。这正是单元测试应该帮助你抓住的。如果您同时对功能和架构进行彻底的更改，您可能需要考虑放慢速度并进入红/绿/重构槽：没有新的（或更改的）功能没有额外的测试，也没有更改重构时的功能（和中断测试）。

更新（基于评论）：

@Cybis 对我的主张提出了一个有趣的反对意见，即重构不应该破坏测试，因为重构不应该改变行为。他的反对意见是重构*确实会*改变 API，因此会测试“中断”。

首先，我鼓励任何人访问有关重构的规范参考：[Martin Fowler 的 bliki](http://www.martinfowler.com/bliki/refactoring.html)。刚才我回顾了它，有几件事突然出现在我身上：

*   [改变接口重构？](http://www.martinfowler.com/bliki/IsChangingInterfacesRefactoring.html)  Martin 将重构称为“行为保持”更改，这意味着当接口/API 更改时，该接口/API 的所有调用者也必须更改。我说，包括测试。

*   这并不意味着*行为*已经改变。Fowler 再次强调，他对重构的定义是更改是
    *保持*行为的。

鉴于此，如果一个或多个测试在重构期间必须更改，我不认为这是“破坏”测试。它只是重构的一部分，保留了整个代码库的行为。我认为必须更改的测试与作为重构的一部分必须更改的代码库的任何其他部分之间没有区别。（这可以追溯到我之前所说的将测试视为代码库的一等公民。）

此外，我希望测试，甚至是修改后的测试，在重构完成后*继续通过。*无论该测试正在测试什么（可能是该测试中的断言）在重构完成后都应该仍然有效。否则，这是一个危险信号，在重构过程中行为以某种方式改变/退化。

也许这种说法听起来像是胡说八道，但仔细想想：我们对在生产代码库中移动代码块并期望它们继续在新的上下文中工作（新类、新方法签名等）没有任何想法。我对测试也有同样的感觉：也许重构改变了测试必须调用的 API，或者测试必须使用的类，但最终测试点不应该因为重构而改变。

（我能想到的唯一例外是测试您可能希望在重构期间更改的低级实现细节的测试，例如用 ArrayList 或其他东西替换 LinkedList。但在这种情况下，人们可能会争辩说测试过度测试并且过于僵化和脆弱。）

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2008-11-01T04:04:19.483

TDD 给重构带来的主要好处是开发者有更多的勇气去改变他们的代码。准备好单元测试后，开发人员敢于更改代码然后运行它。如果 xUnit 条仍然是绿色的，他们就有信心继续前进。

就个人而言，我喜欢 TDD，但不鼓励过度 TDD。也就是不要写太多的单元测试用例。单元测试应该足够了。如果您过度单元测试，那么当您想要进行架构更改时，您可能会发现自己处于两难境地。生产代码中的一个大变化会带来大量单元测试用例的变化。所以，只要保持你的单元测试足够。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T03:58:46.017

TDD 说先写一个*失败*的测试。编写测试是为了表明开发人员了解用例/故事/场景/流程应该实现的目标。

然后编写代码来满足测试。

如果需求发生变化或被误解，*请先编辑或重写测试。*  

红条，绿条，对吧？

Fowler's *Refactoring*是重构*的*参考，很奇怪。

Scott Ambler 在*Dobb 博士*（“敏捷边缘？？”）中的系列文章是 TDD 在实践中的一个很好的演练。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T06:08:05.427

> 例如，用更有效的算法更改算法。

这不是重构，这是*性能优化*。重构是关于**改进**现有代码的设计。即改变其形状以更好地满足开发者的需求。以影响外部可见行为为目的而更改代码不是重构，这包括为提高效率而进行的更改。

TDD 的部分价值在于，您的测试可以帮助您保持可见行为不变，同时改变产生结果的方式。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T04:53:59.257

我会推荐（和其他人一样）：

*   [重构：改进现有代码的设计](https://rads.stackoverflow.com/amzn/click/com/0201485672)- Martin Fowler

*   [测试驱动开发：通过示例](https://rads.stackoverflow.com/amzn/click/com/0321146530)- Kent Beck

*   [企业架构模式](https://rads.stackoverflow.com/amzn/click/com/0321127420)- Fowler 等人。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T04:21:28.527

Kent Beck 的 TDD 书籍。

先测试。如果不需要，遵循 SOLID OOP 原则和使用良好的重构工具是必不可少的。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T04:58:15.583

> 在 TDD 中什么情况下可以更改和删除测试用例？您如何确保更改测试用例不会破坏它们？另外，似乎必须将全面的测试套件与不断变化的代码同步会很痛苦。

测试和规范的重点是定义系统的正确行为。所以，非常简单：

```
if definition of correctness changes
  change tests/specs
end

if definition of correctness does not change
  # no need to change tests/specs
  # though you still can for other reasons if you want/need
end 
```

因此，如果应用程序/系统规范或期望的行为发生变化，则有**必要**更改测试。在这种情况下仅更改代码而不更改测试显然是破坏了方法论。您可能将其视为“痛苦”，但没有测试套件会更痛苦。:) 正如其他人所提到的，拥有“敢于”更改代码的自由确实是非常授权和解放的。:)

# php - PHP 回显换行符

> ID：255511
> 
>         
> 
> 赞同：46
> 
>         
> 
> 时间：2008-11-01T04:02:45.790
> 
>         
> 
> 标签：php, cross-platform, newline, eol, line-breaks

\n 和 \r 之间有什么区别（我知道它与操作系统有关），以及回显跨平台工作的换行符的最佳方法是什么？

**编辑：**作为对 Jarod 的回应，我将使用 ths 在 .txt 日志文件中回显换行符，但我确信将来我会使用它来将 HTML makup 回显到页面上。

* * *

## 回答 #1

> 赞同：129
> 
>             
> 
> 时间：2008-11-01T04:25:44.447

使用`PHP_EOL`常量，它会自动设置为运行 PHP 脚本的操作系统的正确换行符。

请注意，这个常量是从 PHP 5.0.2 开始声明的。

```
<?php
    echo "Line 1" . PHP_EOL . "Line 2";
?> 
```

为了向后兼容：

```
if (!defined('PHP_EOL')) {
    switch (strtoupper(substr(PHP_OS, 0, 3))) {
        // Windows
        case 'WIN':
            define('PHP_EOL', "\r\n");
            break;

        // Mac
        case 'DAR':
            define('PHP_EOL', "\r");
            break;

        // Unix
        default:
            define('PHP_EOL', "\n");
    }
} 
```

* * *

## 回答 #2

> 赞同：48
> 
>             
> 
> 时间：2008-11-01T04:04:13.307

*   `\n`是 Linux/Unix 换行符。

*   `\r`是经典的 Mac OS（非 OS X）换行符。Mac OS X 使用上面的 unix `\n`。

*   `\r\n`是 Windows 换行符。

我通常只`\n`在我们的 Linux 系统上使用，而且大多数 Windows 应用程序都可以处理它。

* * *

## 回答 #3

> 赞同：31
> 
>             
> 
> 时间：2008-11-01T04:23:43.500

Jarod 的答案包含在各种操作系统上正确使用 \r \n 。这里有一些历史：

*   \r，或十进制代码为 13 的 ASCII 字符，在“回车”之后命名为 CR。

*   \n 或十进制代码为 10 的 ASCII 字符被命名为“换行符”，或“换行符”后的 LF。

术语“回车”和“换行”可以追溯到使用电传打字机代替带有监视器和键盘的终端时。对于电传打字机或打字机，“回车”意味着移动光标并返回到文本的第一列，而“换行”意味着旋转滚轮以进入下一行。在那个时候，这种区别是有道理的。今天，表示一行文本结尾的 \n、\r、\r\n 组合完全是任意的。

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2012-04-13T12:59:32.730

PHP4 上的 PHP_EOL 不需要向后兼容。

需要更正 Moore 关于恒定 PHP_EOL 可用性的声明：“......自 PHP 5.0.2 起声明。”。

不，它从 PHP 4.3.10 开始就存在了。任何仍在运行比这更少的东西的人无论如何都不应该从事商业活动。到今天为止，没有人应该使用低于 PHP 5 的任何东西！

[来自 PHP 手册：“PHP_EOL 此平台的正确‘行尾’符号。自 PHP 4.3.10 和 PHP 5.0.2 起可用”。](http://php.net/manual/en/reserved.constants.php)

# jquery - 使用 jQuery 在悬停时为超链接添加下划线

> ID：255516
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2008-11-01T04:08:14.780
> 
>         
> 
> 标签：jquery

我用的方法

```
$("#dvTheatres a").hover(function (){
        $(this).css("text-decoration", "underline");
    },function(){
        $(this).css("text-decoration", "none");
    }
); 
```

有没有更优雅的方法？（单行）

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2008-11-01T04:09:40.940

为什么不直接使用 CSS？

```
#dvTheatres a {
    text-decoration: none;
}

#dvTheatres a:hover {
    text-decoration: underline;
} 
```

* * *

## 回答 #2

> 赞同：13
> 
>             
> 
> 时间：2008-11-01T05:33:23.937

您可能会遇到其他 CSS 规则覆盖您想要的规则的问题。即使它在文件中最后声明，其他声明也可能更重要，因此您将被忽略。例如：

```
#myDiv .myClass a {
    color: red;
}
#myDiv a {
    color: blue;
} 
```

因为第一条规则**更具体**，所以它优先。这是一个解释 CSS 特异性的页面：http: [//www.htmldog.com/guides/cssadvanced/specificity/](http://www.htmldog.com/guides/cssadvanced/specificity/)

您的 jQuery 解决方案有效的原因是因为通过`style=""`参数应用样式具有非常高的特异性。

找出正在应用哪些规则以及哪些规则被其他人否决的最佳方法是使用 Firefox 的 Firebug 扩展。检查其中的元素并单击 CSS 选项卡：它将显示正在应用的每一个 CSS 声明，并在被否决的声明上加上删除线。

如果您想要一种真正快速简便的方法来解决您的问题，请尝试以下操作：

```
#dvTheatres a:hover {
    text-decoration: underline !important;
} 
```

* * *

如果您真的想坚持使用 jQuery，那么您的方法很好，并且可能是最优雅的方法（使用 jQuery）。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T04:45:04.003

没有好的答案，但也许你只是在寻找替代品。一种是使用命名函数（和 CSS）来表达意图，而不是内联原始指令。

脚本

```
function toggleUnderline() { $(this).toggleClass('underline') };
$("#dvTheatres a").hover(toggleUnderline, toggleUnderline); 
```

CSS

```
.underline { text-decoration: underline; } 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2018-02-10T18:19:19.720

试试这个

```
$('.my-awesome div a').hover().css('text-decoration', 'none'); 
```

# mysql - MySQL 偏移无限行

> ID：255517
> 
>         
> 
> 赞同：122
> 
>         
> 
> 时间：2008-11-01T04:08:58.473
> 
>         
> 
> 标签：mysql, sql, sql-limit

我想构建一个在表中显示所有结果的查询，但从表的开头偏移 5。据我所知，MySQL`LIMIT`需要一个限制和一个偏移量。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：161
> 
>             
> 
> 时间：2008-11-07T09:51:50.293

来自[MySQL Manual on LIMIT](http://dev.mysql.com/doc/refman/5.0/en/select.html#id4651990)：

> 要检索从某个偏移量到结果集末尾的所有行，您可以为第二个参数使用一些较大的数字。此语句检索从第 96 行到最后一行的所有行：

```
SELECT * FROM tbl LIMIT 95, 18446744073709551615; 
```

* * *

## 回答 #2

> 赞同：27
> 
>             
> 
> 时间：2008-11-07T09:51:12.913

正如您提到的 LIMIT 是必需的，因此您需要使用可能的最大限制，即 18446744073709551615 （无符号 BIGINT 的最大值）

```
SELECT * FROM somewhere LIMIT 18446744073709551610 OFFSET 5 
```

* * *

## 回答 #3

> 赞同：16
> 
>             
> 
> 时间：2016-07-27T16:46:26.543

如其他答案中所述，MySQL 建议使用 18446744073709551615 作为限制中的记录数，但请考虑一下：如果您有 18,446,744,073,709,551,615 条记录，您会怎么做？事实上，如果你有 1,000,000,000 条记录，你会怎么做？

也许您确实想要超过 10 亿条记录，但我的意思是您*想要*的数量有一些限制，并且少于 18 quintillion。为了稳定性、优化和可能的可用性，我建议对查询设置一些有意义的限制。这也将减少任何从未见过这个神奇数字的人的困惑，并有额外的好处，即至少可以传达您愿意一次处理多少记录。

如果您真的必须从数据库中获取所有 18 个 quintillion 记录，那么您真正想要的可能是以 1 亿为增量获取它们并循环 1840 亿次。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-11-07T10:03:50.127

另一种方法是选择一个自动增加的列，然后使用 HAVING 对其进行过滤。

```
SET @a := 0; 
select @a:=@a + 1 AS counter, table.* FROM table 
HAVING counter > 4 
```

但我可能会坚持使用上限方法。

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2019-11-11T17:35:10.663

正如其他人提到的，来自 MySQL 手册。为了实现这一点，您可以使用无符号大整数的最大值，即这个可怕的数字 (18446744073709551615)。但是为了让它不那么混乱，你可以使用波浪号“~”位运算符。

```
 LIMIT 95, ~0 
```

它作为按位否定工作。“~0”的结果是 18446744073709551615。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2016-06-10T17:39:08.883

您可以使用带有 LIMIT 的 MySQL 语句：

```
START TRANSACTION;
SET @my_offset = 5;
SET @rows = (SELECT COUNT(*) FROM my_table);
PREPARE statement FROM 'SELECT * FROM my_table LIMIT ? OFFSET ?';
EXECUTE statement USING @rows, @my_offset;
COMMIT; 
```

在 MySQL 5.5.44 中测试。因此，我们可以避免插入数字 18446744073709551615。

注意：事务确保变量@rows 与执行语句时考虑的表一致。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2021-05-18T20:55:00.667

[我在练习LC#1321](https://leetcode.com/problems/restaurant-growth/)时遇到了一个非常相似的问题，我必须选择所有日期，但前 6 个日期被跳过。

我借助`ROW_NUMBER()`窗口函数和子查询在 MySQL 中实现了这一点。例如，以下查询返回跳过前五行的所有结果：

```
SELECT
    fieldname1,
    fieldname2
FROM(
    SELECT
        *,
        ROW_NUMBER() OVER() row_num
    FROM
        mytable
) tmp
WHERE
    row_num > 5; 
```

您可能需要在子查询中添加更多逻辑，尤其是`OVER()`为了满足您的需要。此外，可以使用`RANK()`/窗口函数而不是取决于您的实际偏移逻辑。`DENSE_RANK()``ROW_NUMBER()`

参考：

[MySQL 8.0 参考手册 - ROW_NUMBER()](https://dev.mysql.com/doc/refman/8.0/en/window-function-descriptions.html#function_row-number)

* * *

## 回答 #8

> 赞同：-1
> 
>             
> 
> 时间：2014-01-29T17:42:10.887

我知道这很旧，但我没有看到类似的响应，所以这是我将使用的解决方案。

首先，我将对表执行计数查询以查看存在多少条记录。此查询速度很快，通常执行时间可以忽略不计。就像是：

```
SELECT COUNT(*) FROM table_name; 
```

然后，我将使用从 count 获得的结果作为我的限制来构建我的查询（因为这是表可能返回的最大行数）。就像是：

```
SELECT * FROM table_name LIMIT count_result OFFSET desired_offset; 
```

或者可能是这样的：

```
SELECT * FROM table_name LIMIT desired_offset, count_result; 
```

当然，如有必要，您可以从 count_result 中减去 desired_offset 以获得一个实际的、准确的值作为限​​制。如果我实际上可以确定要提供的适当限制，则传递“18446744073709551610”值是没有意义的。  

* * *

## 回答 #9

> 赞同：-2
> 
>             
> 
> 时间：2012-04-11T12:30:51.903

就在今天，我正在阅读有关从 mysql 表中获取大量数据（超过一百万行）的最佳方法。一种方法是，如建议的那样，使用`LIMIT x,y`where`x`是偏移量和`y`要返回的最后一行。但是，正如我发现的那样，这并不是最有效的方法。如果您有一个自动增量列，您可以轻松地使用`SELECT`带有`WHERE`子句的语句，说明您想从哪条记录开始。

例如，
    `SELECT * FROM table_name WHERE id > x;`

似乎 mysql 在您使用时会获得所有结果`LIMIT`，然后只向您显示适合偏移量的记录：不是最好的性能。

资料来源：回答这个问题[MySQL 论坛](http://forums.mysql.com/read.php?24,112440,112440)。请注意，这个问题大约有 6 年的历史。

* * *

## 回答 #10

> 赞同：-7
> 
>             
> 
> 时间：2014-02-10T23:53:31.617

```
WHERE .... AND id > <YOUROFFSET> 
```

id 可以是您拥有的任何自动递增或唯一的数字列...

# java - 不可或缺的 JSP 标签库

> ID：255518
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T04:09:31.673
> 
>         
> 
> 标签：java, jsp, jsp-tags

我很想知道除了 JSTL 之外的“必备”JSP 标记库是什么。到目前为止我发现的是

*   [ccc](http://www.javaranch.com/journal/200601/Journal200601.jsp#a3) - 用于访问 JSP 中的静态常量（无 scriptlet）

*   [displaytag](http://displaytag.sourceforge.net/11/) - 用于生成复杂的 HTML 表格，包括数据分页、分组、排序、导出等。

还有哪些其他不可或缺的标签库？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T05:40:57.090

我使用 displaytag，并且对它非常满意。我使用的唯一其他标签库是 Stripes Action Framework 附带的标签库。

但我真正不可或缺的标签库是我们编写的。

在办公室，我们现在必须有超过 50 个用于我们的内部框架。

但是，它们背后的关键是它们是 JSP 2.0 标记文件，而不是用 Java 编写的类 JSP 标记。标记文件功能强大且非常易于使用。

经典的 JSP 标签不鼓励标签开发，因为它非常困难，而标签文件鼓励它到现在重构 JSP 页面微不足道的地方。

我认为标记文件和 JSTL 将 JSP 作为一种页面标记技术从平庸变成了最好的技术之一。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T15:32:51.060

struts 或您喜欢的框架中可用的一组标签。这些往往几乎是必不可少的。同意 displaytag 是一个很棒的库。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-11-03T14:33:14.377

很明显，[核心 JSTL 库](http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/c/tld-summary.html)。

# algorithm - 产生常数模 2 的幂的乘法链

> ID：255527
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T04:23:12.953
> 
>         
> 
> 标签：algorithm, language-agnostic, math, puzzle

有没有给出“乘法链”的实用算法

澄清一下，目标是产生**任意和精确**长度的乘法变化

长度为 1 的乘法链是微不足道的。

“乘法链”将定义为 2 个数字，{start} 和 {multiplier}，在代码中使用：

```
 Given a pointer to array of size [{count}]   // count is a parameter
 a = start;
 do 
 {
      a = a * multiplier;  // Really: a = (a * multiplier) MOD (power of 2
      *(pointer++) = a;   
 }
 while (a != {constant} )
 // Postcondition:  all {count} entries are filled. 
```

我想找到一个采用三个参数的例程

     1\. 2 的幂

     2\. 停止 {constant} 

     3\. {count} - 循环将迭代的次数   

该例程将返回 {start} 和 {multiplier}。  

理想情况下，{Constant} 值 0 应该是有效的。

简单的例子：

```
power of 2 = 256  
stopping constant = 7
number of times for the loop = 1  
returns {7,1} 
```

不平凡的例子：  

```
power of 2 = 256  
stopping constant = 1
number of times for the loop = 49
returns {25, 19} 
```

给定 2 的幂的最大 {count} 可能相当小。

    例如，2^4 (16) 似乎限制为 4

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-11-01T05:26:05.887

您要求以下模方程的非平凡解：

```
s * m^N = C (mod 2^D)
```

在哪里

*   s 是起始常数

*   m 是乘数

*   N 是迭代次数（由问题给出）

*   C 是最终常数（由问题给出）

*   D 是 2 的幂的指数（由问题给出）

看看数论中的[欧拉定理](http://en.wikipedia.org/wiki/Euler%27s_theorem)。

对于任意*奇数*m（它是 2^D 的素数），你有

```
m^phi(2^D) = 1 (mod 2^D)
```

因此

```
C * m^phi(2^D) = C (mod 2^D)
```

最后

```
C * m^(phi(2^D)-N) * m^N = C (mod 2^D)
```

拿

```
s = C * m^(phi(2^D)-N)
```

你就完成了。2 次方的[欧拉 phi 函数](http://en.wikipedia.org/wiki/Euler%27s_totient_function)是 2 次方的*一半*，即：

```
phi(2^D) = 2^(D-1)
```

**例子**。让

*   N = 5

*   C = 3

*   2^D = 16

*   φ(16) = 8

任意选择 m = 7（奇数），并计算

```
3 * 7^(8-5) = 1029
s = 1029 mod 16 = 5 
```

现在

```
s * m^N = 5 * 7^5 = 84035
84035 mod 16 = 3 == C 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T18:16:59.107

以下是在常数为奇数的情况下计算 start 和 multiplier 值的方法：

1.  找到这样的奇数 m（m = 乘数），即 m 模 2^D 的阶数至少是计数，这意味着最小的 n 使得 m^n = 1 (mod 2^D) 至少是计数。除了随机猜测之外，我不知道找到这样的 m 的任何其他方法，但是从一些实验来看，1 到 2^D 之间的奇数的一半似乎具有最大的 2^(D-2) 阶。（我最多尝试了 D 12。）

2.  计算 x 使得 x * m^count = 1 (mod 2^D) 并设置 start = x * constant (mod 2^D)。

这样的 x 可以通过“扩展欧几里得算法”找到：给定 a 和 b 没有公约数，它给你 x 和 y 使得 a * x + b * y = 1。这里 a=m^count mod 2^D 和b = 2^D。

**编辑：**如果常数恰好是偶数，您可以将其除以 2 的幂，例如 2^k，使其变为奇数，然后对输入 {constant/2^k, count, 2^(Dk)} 执行上述操作最后返回 {start*2^k,multiplier}。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T04:37:18.793

为什么不能满足要求？

```
start = constant;
multiplier = 1; 
```

更新：我现在看到循环数是输入参数之一。听起来这个问题是离散对数问题的一个特例，或者至少与[离散对数](http://mathworld.wolfram.com/DiscreteLogarithm.html)问题有关。

# javascript - 打印 HTML 时删除默认浏览器页眉和页脚

> ID：255534
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2008-11-01T04:31:19.757
> 
>         
> 
> 标签：javascript, html, printing-web-page

我得到了一个带有`<body onload="window.print()">`.

我想问的问题是：

*   有什么方法可以删除 Web 浏览器添加到打印页面的字符串？

*   如：

    *   打印页面的网站

    *   页数

    *   网页标题

    *   印刷日期

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2008-11-01T04:35:15.503

这些通常是浏览器特定的打印设置。

例如，在 IE 和 FireFox 中，您可以进入页面设置并更改页眉和页脚详细信息以进行打印。

我认为这不能由网页本身控制。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2011-03-25T18:47:15.650

Google Docs 现在通过生成您的文档的 PDF 版本来[绕过这个问题。](http://docs.google.com/support/bin/answer.py?hl=en&answer=50089)

如果您使用的是 Chrome，它将自动在新选项卡中打开 PDF 并弹出打印对话框。其他浏览器会提示您下载生成的文件（这不一定是明显的行为）。

虽然我认为这不是一个优雅的解决方案，但应该能够使用大多数现有的 Web 技术相当容易地重新创建它。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T08:57:51.713

如果您的用户使用 IE，您可以使用 activeX 插件，例如 Meadroid 的 scriptX：[http ://www.meadroid.com/sx_intro.asp](http://www.meadroid.com/sx_intro.asp)

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2018-10-23T14:58:39.663

备查：

```
@page {
  margin: 0;
}
@media print {
  footer {
    display: none;
    position: fixed;
    bottom: 0;
  }
  header {
    display: none;
    position: fixed;
    top: 0;
  }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2019-09-06T17:17:54.140

使用这个 CSS 代码

```
@page {
    margin-top: 0cm;
    margin-bottom : 0cm;
} 
```

# shared-libraries - 如何使用 pkglib_LTLIBRARIES = test.la 仅构建 *.so

> ID：255551
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-11-01T05:06:10.183
> 
>         
> 
> 标签：shared-libraries, autotools, libtool

我正在使用自动工具来构建共享对象。  

`pkglib_LTLIBRARIES`在我的 Makefile.am 中使用会导致构建`libtest.la`AND 。`libtest.so`

我*只*希望它构建/安装`libtest.so`。

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T07:06:04.110

生成库的细节因平台而异。例如，在 OS X 上，您的库将被称为 libtest.dylib 而不是 libtest.so。libtool 是 autotools 套件的一部分，它的工作是抽象出所有与平台相关的杂乱细节。为此，它创建了库的高级、独立于平台的描述。这是您看到的 libtest.la 文件。libtools 使用这个独立于平台的库描述来组合最终的本地库。

如果您使用的是自动工具，我认为您将无法避免生成 libtest.la。我想您可以破解您的本地 libtool shell 脚本以在完成时将其删除，但您只需要在下次运行 make 时再次生成它。

我发现[libtool 上的 GNU 文档](http://www.gnu.org/software/libtool/manual/html_node/index.html#Top)有些不透明。这是一个[不太透明但有点过时的描述](http://sources.redhat.com/autobook/autobook/autobook_68.html#SEC68)。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-09-06T07:43:40.793

您可以`--disable-static`作为选项传递给`configure`.

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2017-11-14T15:05:25.190

另一种选择是将其设置为`configure.ac`：

```
LT_INIT([disable-static]) 
```

请参阅[有关 LT_INIT 的文档](https://www.gnu.org/software/libtool/manual/libtool.html#LT_005fINIT)。

# c# - 是否可以在 C# 中实现 mixins？

> ID：255553
> 
>         
> 
> 赞同：70
> 
>         
> 
> 时间：2008-11-01T05:14:33.537
> 
>         
> 
> 标签：c#, extension-methods, mixins

我听说可以使用扩展方法，但我自己不太清楚。如果可能的话，我想看一个具体的例子。

谢谢！

* * *

## 回答 #1

> 赞同：100
> 
>             
> 
> 时间：2008-11-01T07:30:56.600

这真的取决于你所说的“mixin”是什么意思——每个人的想法似乎都略有不同。我希望看到的那种 mixin *（*但在 C# 中不可用）使实现通过组合变得简单：

```
public class Mixin : ISomeInterface
{
    private SomeImplementation impl implements ISomeInterface;

    public void OneMethod()
    {
        // Specialise just this method
    }
} 
```

编译器将通过将每个成员代理到“impl”来实现 ISomeInterface，除非类中直接有另一个实现。

不过，目前这一切都不可能:)

* * *

## 回答 #2

> 赞同：13
> 
>             
> 
> 时间：2011-10-13T11:43:43.690

我通常采用这种模式：

```
public interface IColor
{
    byte Red   {get;}
    byte Green {get;}
    byte Blue  {get;}
}

public static class ColorExtensions
{
    public static byte Luminance(this IColor c)
    {
        return (byte)(c.Red*0.3 + c.Green*0.59+ c.Blue*0.11);
    }
} 
```

我在同一个源文件/命名空间中有两个定义。这样，在使用接口时（使用“使用”），扩展始终可用。

这为您提供了一个*有限的 mixin*，如 CMS 的第一个链接中所述。

限制：

*   没有数据字段

*   没有属性（你必须用括号调用 myColor.Luminance()，[扩展属性](https://stackoverflow.com/questions/619033/c-extension-properties)有人吗？）

对于许多情况，它仍然足够。

如果他们（MS）可以添加一些编译器魔法来自动生成扩展类，那就太好了：

```
public interface IColor
{
    byte Red   {get;}
    byte Green {get;}
    byte Blue  {get;}

    // compiler generates anonymous extension class
    public static byte Luminance(this IColor c)     
    {
        return (byte)(c.Red*0.3 + c.Green*0.59+ c.Blue*0.11);
    }
} 
```

尽管 Jon 提出的编译器技巧会更好。

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2011-01-12T09:24:58.690

有一个开源框架使您能够通过 C# 实现 mixins。看看[http://remix.codeplex.com/](http://remix.codeplex.com/)。

用这个框架很容易实现 mixins。只需查看示例和页面上给出的“附加信息”链接。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T15:44:32.860

[LinFu](http://code.google.com/p/linfu/)和[Castle 的](https://github.com/castleproject/Core/tree/master/src/Castle.Core.Tests/Mixins)DynamicProxy实现了 mixins。COP（面向复合编程）可以被认为是用 mixins 制作一个完整的范例。[Anders Noras 的这篇文章](http://web.archive.org/web/20081228224052/http://andersnoras.com/blogs/anoras/archive/2008/08/27/cop-c-4-0-and-doing-open-source-stuff.aspx)包含有用的信息和链接。

编辑：这在 C# 2.0 中都是可能的，没有扩展方法

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2015-02-21T23:00:24.747

我需要类似的东西，所以我想出了以下使用 Reflection.Emit。在下面的代码中，动态生成了一个新类型，它有一个“mixin”类型的私有成员。所有对“mixin”接口方法的调用都转发给这个私有成员。定义了一个单参数构造函数，它接受一个实现“mixin”接口的实例。基本上，它等同于为给定的具体类型 T 和接口 I 编写以下代码：

```
class Z : T, I
{
    I impl;

    public Z(I impl)
    {
        this.impl = impl;
    }

    // Implement all methods of I by proxying them through this.impl
    // as follows: 
    //
    // I.Foo()
    // {
    //    return this.impl.Foo();
    // }
} 
```

这是课程：

```
public class MixinGenerator
{
    public static Type CreateMixin(Type @base, Type mixin)
    {
        // Mixin must be an interface
        if (!mixin.IsInterface)
            throw new ArgumentException("mixin not an interface");

        TypeBuilder typeBuilder = DefineType(@base, new Type[]{mixin});

        FieldBuilder fb = typeBuilder.DefineField("impl", mixin, FieldAttributes.Private);

        DefineConstructor(typeBuilder, fb);

        DefineInterfaceMethods(typeBuilder, mixin, fb);

        Type t = typeBuilder.CreateType();

        return t;
    }

    static AssemblyBuilder assemblyBuilder;
    private static TypeBuilder DefineType(Type @base, Type [] interfaces)
    {
        assemblyBuilder = AppDomain.CurrentDomain.DefineDynamicAssembly(
            new AssemblyName(Guid.NewGuid().ToString()), AssemblyBuilderAccess.RunAndSave);

        ModuleBuilder moduleBuilder = assemblyBuilder.DefineDynamicModule(Guid.NewGuid().ToString());

        TypeBuilder b = moduleBuilder.DefineType(Guid.NewGuid().ToString(),
            @base.Attributes,
            @base,
            interfaces);

        return b;
    }
    private static void DefineConstructor(TypeBuilder typeBuilder, FieldBuilder fieldBuilder)
    {
        ConstructorBuilder ctor = typeBuilder.DefineConstructor(
            MethodAttributes.Public, CallingConventions.Standard, new Type[] { fieldBuilder.FieldType });

        ILGenerator il = ctor.GetILGenerator();

        // Call base constructor
        ConstructorInfo baseCtorInfo =  typeBuilder.BaseType.GetConstructor(new Type[]{});
        il.Emit(OpCodes.Ldarg_0);
        il.Emit(OpCodes.Call, typeBuilder.BaseType.GetConstructor(new Type[0]));

        // Store type parameter in private field
        il.Emit(OpCodes.Ldarg_0);
        il.Emit(OpCodes.Ldarg_1);
        il.Emit(OpCodes.Stfld, fieldBuilder);
        il.Emit(OpCodes.Ret);
    }

    private static void DefineInterfaceMethods(TypeBuilder typeBuilder, Type mixin, FieldInfo instanceField)
    {
        MethodInfo[] methods = mixin.GetMethods();

        foreach (MethodInfo method in methods)
        {
            MethodInfo fwdMethod = instanceField.FieldType.GetMethod(method.Name,
                method.GetParameters().Select((pi) => { return pi.ParameterType; }).ToArray<Type>());

            MethodBuilder methodBuilder = typeBuilder.DefineMethod(
                                            fwdMethod.Name,
                                            // Could not call absract method, so remove flag
                                            fwdMethod.Attributes & (~MethodAttributes.Abstract),
                                            fwdMethod.ReturnType,
                                            fwdMethod.GetParameters().Select(p => p.ParameterType).ToArray());

            methodBuilder.SetReturnType(method.ReturnType);
            typeBuilder.DefineMethodOverride(methodBuilder, method);

            // Emit method body
            ILGenerator il = methodBuilder.GetILGenerator();
            il.Emit(OpCodes.Ldarg_0);
            il.Emit(OpCodes.Ldfld, instanceField);

            // Call with same parameters
            for (int i = 0; i < method.GetParameters().Length; i++)
            {
                il.Emit(OpCodes.Ldarg, i + 1);
            }
            il.Emit(OpCodes.Call, fwdMethod);
            il.Emit(OpCodes.Ret);
        }
    }
} 
```

这是用法：

```
public interface ISum
{
    int Sum(int x, int y);
}

public class SumImpl : ISum
{
    public int Sum(int x, int y)
    {
        return x + y;
    }
}

public class Multiply
{        
    public int Mul(int x, int y)
    {
        return x * y;
    }
}

// Generate a type that does multiply and sum
Type newType = MixinGenerator.CreateMixin(typeof(Multiply), typeof(ISum));

object instance = Activator.CreateInstance(newType, new object[] { new SumImpl() });

int res = ((Multiply)instance).Mul(2, 4);
Console.WriteLine(res);
res = ((ISum)instance).Sum(1, 4);
Console.WriteLine(res); 
```

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2012-08-03T16:03:48.267

您还可以扩展扩展方法方法以合并状态，其模式与 WPF 的附加属性不同。

这是一个带有最小样板的示例。请注意，不需要对目标类进行任何修改，包括添加接口，除非您需要以多态方式处理目标类——在这种情况下，您最终会得到非常接近实际多重继承的东西。

```
// Mixin class: mixin infrastructure and mixin component definitions
public static class Mixin
{ 
    // =====================================
    // ComponentFoo: Sample mixin component
    // =====================================

    //  ComponentFooState: ComponentFoo contents
    class ComponentFooState
    {
        public ComponentFooState() {
            // initialize as you like
            this.Name = "default name";
        }

        public string Name { get; set; }
    }

    // ComponentFoo methods

    // if you like, replace T with some interface 
    // implemented by your target class(es)

    public static void 
    SetName<T>(this T obj, string name) {
        var state = GetState(component_foo_states, obj);

        // do something with "obj" and "state"
        // for example: 

        state.Name = name + " the " + obj.GetType();

    }
    public static string
    GetName<T>(this T obj) {
        var state = GetState(component_foo_states, obj);

        return state.Name; 
    }

    // =====================================
    // boilerplate
    // =====================================

    //  instances of ComponentFoo's state container class,
    //  indexed by target object
    static readonly Dictionary<object, ComponentFooState>
    component_foo_states = new Dictionary<object, ComponentFooState>();

    // get a target class object's associated state
    // note lazy instantiation
    static TState
    GetState<TState>(Dictionary<object, TState> dict, object obj) 
    where TState : new() {
        TState ret;
        if(!dict.TryGet(obj, out ret))
            dict[obj] = ret = new TState();

        return ret;
    }

} 
```

用法：

```
var some_obj = new SomeClass();
some_obj.SetName("Johny");
Console.WriteLine(some_obj.GetName()); // "Johny the SomeClass" 
```

请注意，它也适用于空实例，因为扩展方法自然会这样做。

您还可以考虑使用 Wea​​kDictionary 实现来避免由于集合将目标类引用作为键而导致的内存泄漏。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2018-10-04T09:07:46.700

我在[这里](https://www.c-sharpcorner.com/UploadFile/b942f9/how-to-create-mixin-using-C-Sharp-4-0/)找到了一种解决方法，虽然不完全优雅，但可以让您实现完全可观察的 mixin 行为。此外，IntelliSense 仍然有效！

```
using System;
using System.Runtime.CompilerServices; //needed for ConditionalWeakTable
public interface MAgeProvider // use 'M' prefix to indicate mixin interface
{
    // nothing needed in here, it's just a 'marker' interface
}
public static class AgeProvider // implements the mixin using extensions methods
{
    static ConditionalWeakTable<MAgeProvider, Fields> table;
    static AgeProvider()
    {
        table = new ConditionalWeakTable<MAgeProvider, Fields>();
    }
    private sealed class Fields // mixin's fields held in private nested class
    {
        internal DateTime BirthDate = DateTime.UtcNow;
    }
    public static int GetAge(this MAgeProvider map)
    {
        DateTime dtNow = DateTime.UtcNow;
        DateTime dtBorn = table.GetOrCreateValue(map).BirthDate;
        int age = ((dtNow.Year - dtBorn.Year) * 372
                   + (dtNow.Month - dtBorn.Month) * 31
                   + (dtNow.Day - dtBorn.Day)) / 372;
        return age;
    }
    public static void SetBirthDate(this MAgeProvider map, DateTime birthDate)
    {
        table.GetOrCreateValue(map).BirthDate = birthDate;
    }
}

public abstract class Animal
{
    // contents unimportant
}
public class Human : Animal, MAgeProvider
{
    public string Name;
    public Human(string name)
    {
        Name = name;
    }
    // nothing needed in here to implement MAgeProvider
}
static class Test
{
    static void Main()
    {
        Human h = new Human("Jim");
        h.SetBirthDate(new DateTime(1980, 1, 1));
        Console.WriteLine("Name {0}, Age = {1}", h.Name, h.GetAge());
        Human h2 = new Human("Fred");
        h2.SetBirthDate(new DateTime(1960, 6, 1));
        Console.WriteLine("Name {0}, Age = {1}", h2.Name, h2.GetAge());
        Console.ReadKey();
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2015-05-28T10:08:57.807

如果您有一个可以存储数据的基类，您可以强制编译器安全并使用标记接口。这或多或少是公认答案中的“C# 3.0 中的混合”所提出的。

```
public static class ModelBaseMixins
{
    public interface IHasStuff{ }

    public static void AddStuff<TObjectBase>(this TObjectBase objectBase, Stuff stuff) where TObjectBase: ObjectBase, IHasStuff
    {
        var stuffStore = objectBase.Get<IList<Stuff>>("stuffStore");
        stuffStore.Add(stuff);
    }
} 
```

对象库：

```
public abstract class ObjectBase
{
    protected ModelBase()
    {
        _objects = new Dictionary<string, object>();
    }

    private readonly Dictionary<string, object> _objects;

    internal void Add<T>(T thing, string name)
    {
        _objects[name] = thing;
    }

    internal T Get<T>(string name)
    {
        T thing = null;
        _objects.TryGetValue(name, out thing);

        return (T) thing;
    } 
```

因此，如果您有一个类，您可以从“ObjectBase”继承并使用 IHasStuff 进行装饰，您现在可以添加 sutff

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2016-03-27T22:23:23.313

这是我刚刚提出的一个 mixin 实现。我可能会将它与我[的库](https://github.com/Imms/Imms)一起使用。

它可能以前在某个地方做过。

它都是静态类型的，没有字典或其他东西。每种类型都需要一些额外的代码，每个实例不需要任何存储。另一方面，如果您愿意，它还为您提供了动态更改 mixin 实现的灵活性。没有后期构建、预构建、中期构建工具。

它有一些限制，但它确实允许诸如覆盖之类的事情。

我们首先定义一个标记接口。也许稍后会添加一些内容：

```
public interface Mixin {} 
```

该接口由 mixins 实现。Mixins 是常规类。类型不直接继承或实现 mixins。相反，他们只是使用接口公开了一个 mixin 的实例：

```
public interface HasMixins {}

public interface Has<TMixin> : HasMixins
    where TMixin : Mixin {
    TMixin Mixin { get; }
} 
```

实现这个接口意味着支持 mixin。显式实现它很重要，因为每种类型都会有几个。

现在来看一个使用扩展方法的小技巧。我们定义：

```
public static class MixinUtils {
    public static TMixin Mixout<TMixin>(this Has<TMixin> what)
        where TMixin : Mixin {
        return what.Mixin;
    }
} 
```

`Mixout`公开适当类型的 mixin。现在，为了测试这一点，让我们定义：

```
public abstract class Mixin1 : Mixin {}

public abstract class Mixin2 : Mixin {}

public abstract class Mixin3 : Mixin {}

public class Test : Has<Mixin1>, Has<Mixin2> {

    private class Mixin1Impl : Mixin1 {
        public static readonly Mixin1Impl Instance = new Mixin1Impl();
    }

    private class Mixin2Impl : Mixin2 {
        public static readonly Mixin2Impl Instance = new Mixin2Impl();
    }

    Mixin1 Has<Mixin1>.Mixin => Mixin1Impl.Instance;

    Mixin2 Has<Mixin2>.Mixin => Mixin2Impl.Instance;
}

static class TestThis {
    public static void run() {
        var t = new Test();
        var a = t.Mixout<Mixin1>();
        var b = t.Mixout<Mixin2>();
    }
} 
```

有趣的是（尽管回想起来，它确实有意义），IntelliSense 没有检测到扩展方法`Mixout`适用于`Test`，但编译器确实接受它，只要`Test`实际上有 mixin。如果你试试，

```
t.Mixout<Mixin3>(); 
```

它给你一个编译错误。

您可以花点心思，也可以定义以下方法：

```
[Obsolete("The object does not have this mixin.", true)]
public static TSome Mixout<TSome>(this HasMixins something) where TSome : Mixin {
    return default(TSome);
} 
```

它的作用是，a) 显示`Mixout`在 IntelliSense 中调用的方法，提醒您它的存在，并且 b) 提供更具描述性的错误消息（由`Obsolete`属性生成）。

# networking - 开放互联网上的一对一多播可靠吗？

> ID：255557
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2008-11-01T05:23:34.707
> 
>         
> 
> 标签：networking, multicast

我是网络新手。我了解多播的概念，但想知道它在开放/公共互联网上是否可靠？

这似乎是一种边缘情况，不同的骨干网或 ISP 可能会故意中断以减少路由器负载或通常将网络分段以用于实际的高使用应用程序。

我的恐惧合理吗？

PS 后续问题：
[应用程序多播的最佳教程？](https://stackoverflow.com/questions/256125/best-tutorial-for-application-multicasting)

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T07:03:04.473

互联网中的 IP 多播实际上不起作用。来自[维基百科的文章](http://en.wikipedia.org/wiki/Multicast)：

> 由于这两个原因以及经济原因，IP 组播一般不用于商业互联网。

希望参与全球 IP 多播的人需要将自己附加到 MBONE。Wikipedia 文章指出，应用程序级的多播基础设施确实有效，例如 IRC。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2010-02-06T05:10:55.533

> 是的，互联网规模的多播路由并不是一个真正解决的问题，据我所知也没有太大的进展。

当前推荐的大规模解决方案是源特定的多播，SSM，作为客户端从特定源请求多播流量，而不是广泛开放的侦听。这仍然需要所有中间路由器的支持，因此可能只会在 IPv6 中变得更加实用，它要求多播支持，而不是 IPv4，它是可选的并且经常被禁用。

[http://en.wikipedia.org/wiki/Source-specific_multicast](http://en.wikipedia.org/wiki/Source-specific_multicast)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T07:06:49.660

是的，互联网规模的多播路由并不是一个真正解决的问题，据我所知也没有太大的进展。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-11T10:06:58.867

它与 UDP 广播一样有用或可靠（意味着在您可以控制的网络上有用，并且与标准 UDP 一样可靠），但在您的网络上使用的资源较少。如果您要编写一个新的广播应用程序，请改用多播。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T07:03:30.853

通常多播是指UDP多播，它是不可靠的。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2014-02-13T21:42:54.377

当您使用 youtube 时，它​​是您和服务器之间的通信，它是单播的，尽管它像多播一样通过 UDP。组播需要使用组播路由器。此类路由器并未特别提供 Internet。此外，对于视频流服务提供商，他无法向用户收费，因为组播组的配置是在路由器中完成的，他无法控制 Internet 中的那些路由器。公司经常使用多播进行视频会议，这可以是运营商服务提供商在他自己的 Mbone 或公司自己的网络上提供的服务。

# ms-access - MS-Access 数据库中的代码行

> ID：255566
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T05:36:45.693
> 
>         
> 
> 标签：ms-access

有没有办法找到 MS-Access 数据库中使用的代码行数？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-11-03T14:35:01.033

再一次，我应该参考[MZ-tools](https://stackoverflow.com/posts/edit/177631) az 一个非常有趣的 VBA/Access 工具。它将为您提供每个过程/模块的行数（代码与注释）。它还允许您自动编号您的线路。然后，您将能够在错误管理过程中使用未记录的 Erl 属性。此 Erl 属性为您提供引发错误的行号。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T05:41:07.370

这篇[Allen Browne](http://allenbrowne.com/vba-CountLines.html)文章向您展示了如何操作。[顺便说一句，这是一个简单的谷歌......）

# sql-server - 主键的 Sql 数据类型 - SQL Server？

> ID：255569
> 
>         
> 
> 赞同：51
> 
>         
> 
> 时间：2008-11-01T05:49:29.363
> 
>         
> 
> 标签：sql-server, database-design, types

我们应该将哪种 sql 数据类型用于基于数字的主键：

1.  整数

2.  大整数

3.  数字

4.  漂浮

* * *

## 回答 #1

> 赞同：68
> 
>             
> 
> 时间：2008-11-01T05:57:07.353

一般来说，`int`.

`bigint`如果您认为您的行数将超过宇宙中的原子数。

`uniqueidentifier`如果您需要*全局*唯一键（保证在架构中的所有表中唯一的键，甚至可能是通用唯一的（我不记得了）），这很有用

另外两个我不会使用它们不是整数类型（它们有分数，作为键没有多大意义）

* * *

## 回答 #2

> 赞同：25
> 
>             
> 
> 时间：2009-01-28T21:56:20.713

您确实需要将两个单独的问题分开：

1)*主键*是一个逻辑构造 - 唯一且可靠地标识表中的一行的关键候选者之一。这可以是任何东西，真的 - 一个 INT、一个 GUID、一个字符串 - 选择对您的场景最有意义的东西。

2)*聚集键*（在表上定义“聚集索引”的一列或多列）——这是一个与*物理*存储相关的东西，在这里，一个小的、稳定的、不断增长的数据类型是你最好的选择——INT或 BIGINT 作为您的默认选项。

By default, the primary key on a SQL Server table is also used as the clustering key - but that doesn't need to be that way! I've personally seems massive performance gains over time when breaking up the previous GUID-based Primary Clustered Key into two separate key - the primary (logical) key on the GUID, and the clustering (ordering) key on a separate INT IDENTITY(1,1) column. 

The index fragmentation was down to minimal levels, and thus the index seek performance was was up - highly recommended !

Marc

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T06:05:25.167

不将 GUID 用于 PK 的一个重要原因是它们对索引页面的糟糕填充率 - 这种滥用会大大增加您的 I/O 性能成本。GUID 应保留为 AK，而是尽可能使用 int 派生的 PK 驱动查询。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T06:10:27.933

对于 32 位处理器，int 可能是最有效的处理大小。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T22:00:01.750

`unsigned int` of whichever size that meets your particular needs

# php - CodeIgniter 中的图像处理

> ID：255571
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-11-01T05:53:34.787
> 
>         
> 
> 标签：php, codeigniter

我在使用 CodeIgniter 1.7 处理图像时遇到了一些问题。使用以下代码，图像已正确上传。唉，而不是制作一个新的图像，然后修改；现有图像被修改。有什么帮助吗？

```
//Upload image first
$config['upload_path'] = './uploads/';
$config['allowed_types'] = 'gif|jpg|png|bmp';

$this->load->library('upload', $config);        
$this->upload->do_upload();

//Now fix the image
$picloc = $this->upload->data();
$picloc = $picloc['file_name'];

$thumbnail = "thumb_".$picloc;

$imagemanip['image_library'] = 'gd2';
$imagemanip['source_image'] = './uploads/'.$picloc;
$imagemanip['new_img'] = './uploads/'.$thumbnail;
$imagemanip['maintain_ratio'] = TRUE;
$imagemanip['width'] = 250;
$imagemanip['height'] = 250;

$this->load->library('image_lib', $imagemanip);

$this->image_lib->resize(); 
```

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T07:51:02.753

问题很简单，你有一个错字：

```
$imagemanip['new_img'] = './uploads/'.$thumbnail; 
```

索引应该是“new_image”，而不是“new_img”，所以该行变为..

```
$imagemanip['new_image'] = './uploads/'.$thumbnail; 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2015-04-29T07:51:38.543

```
//Upload image first
$config['upload_path'] = './uploads/';
$config['allowed_types'] = 'gif|jpg|png|bmp';

$this->load->library('upload', $config);        
$this->upload->do_upload();

//Now fix the image
$picloc = $this->upload->data();
$picloc = $picloc['file_name'];

$thumbnail = "thumb_".$picloc;

$imagemanip['image_library'] = 'gd2';
$imagemanip['source_image'] = './uploads/'.$picloc;
$imagemanip['new_image'] = './uploads/'.$thumbnail;// this will get change in new code.
$imagemanip['maintain_ratio'] = TRUE;
$imagemanip['width'] = 250;
$imagemanip['height'] = 250;

$this->load->library('image_lib', $imagemanip);

$this->image_lib->resize(); 
```

现在这将完成你的工作

# php - PHP 会话是否难以跨分布式系统扩展？

> ID：255573
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2008-11-01T06:03:05.047
> 
>         
> 
> 标签：php, session, distributed-system

在工作中，我们几乎用 Java 和 perl 做所有事情，但我想使用 PHP 和会话构建一个功能。一些窥视者认为尝试在我们的系统上进行 PHP 会话是一个坏主意，因为它分布在许多服务器上。具体问题会是什么？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2008-11-01T15:42:04.723

您还可以使用自定义会话保存处理程序：

[http://www.php.net/manual/en/function.session-set-save-handler.php](http://www.php.net/manual/en/function.session-set-save-handler.php)

我从未尝试过，但您可以使用它定义自己的保存/读取功能，因此您可以实现数据库或共享 nfs 后端，而无需安装任何扩展。

此外，@Eran Galperin 建议的 Msession 作为我之前提到的替代方案看起来非常有趣。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2008-11-01T16:57:06.850

您的具体问题的答案，即问题是什么，在于默认情况下 PHP 将其会话存储在文件系统上的文件中。对于服务请求的单个网络服务器，这不是问题，因为您的会话数据将始终可用。但是，如果您有两个负载平衡的网络服务器来处理请求怎么办？

想象一下用请求访问第一个网络服务器，它会在其文件系统上创建您的会话文件。然后，您的下一个请求会到达第二个网络服务器。第二个网络服务器当然不会看到会话文件。对于用户来说，您可能会登录到一个网站，然后突然被注销。

这不是 PHP 特有的问题，而且很常见。解决方案是将会话数据存储在某个公共区域。最常见的方法是将会话数据存储在所有 Web 服务器都可以访问的数据库中，或者存储在一些共享内存缓存服务器（如 memcached）中。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T06:40:07.453

跨多个服务器保持会话（也称为会话集群）是扩展 Web 应用程序的常见问题，并且并非特定于 PHP。PHP 确实提供了几种解决方案来处理它，例如[Zend Platform](http://www.zend.com/en/products/platform/product-comparison/)（商业应用服务器）和[Msession](http://www.php.net/msession)（扩展）。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2011-12-09T10:05:57.120

一个相当模糊的问题，但我会说问题比答案中提到的要大。当然，您可以覆盖加载和保存 cookie 的方式，但它也有成本。例如，您将不得不考虑以下场景/问题：

*   如果您将 cookie 放在另一台主机上，这将如何影响 cookie 的速度？这显然取决于您进行了多少次写入/读取。

*   您这样做是为了提高速度还是进行故障转移？答案肯定会导致不同的解决方案：

    *   如果您这样做是为了进行故障转移，如果您的网络服务器由于网络链接断开而无法访问您的会话存储，您将如何处理？如果您的会话存储出现故障怎么办？您将不得不使用某种主-主复制来解决这个问题，可能在与网络服务器相同的机器上运行分布式会话存储以获得额外的高可用性（如果所有会话都可以放入内存）。看看[Riak](http://wiki.basho.com/Riak.html)或类似的 master-master 复制。

    *   如果您只是为了速度而这样做，我会使用 apache、nginx 或（最快的）haproxy 来简单地根据客户端 IP 地址进行负载平衡。这样您就不必费心设置分布式会话存储。当然，如果您的一个 PHP 实例出现故障，您的用户将丢失他们的 cookie，但也许这不是问题。由你决定。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2012-05-05T09:37:34.380

最简单的是 memcached 或 redis。

这是如何在 redis 中执行此操作 - 我们目前正在使用它：
 [http ://redis4you.com/articles.php?id=001&name=Redis+as+session+handler+in+PHP](http://redis4you.com/articles.php?id=001&name=Redis+as+session+handler+in+PHP)

# php - 如何找到事件发生后的时间？

> ID：255584
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-11-01T06:35:44.047
> 
>         
> 
> 标签：php, datetime, time

该事件返回格式为“Sat Oct 25 21:55:29 +0000 2008”的标准化时间戳我如何将其与 PHP 中的当前时间进行比较，以便它以类似“已经 15 岁”的形式给出结果分钟！” 或“已经三天了！” 另外，我怎样才能得到当前时间？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-11-01T06:42:51.440

[首先使用strtotime()](http://php.net/strtotime)将该字符串转换为 UNIX 时间戳：

```
$event_time = strtotime('Sat Oct 25 21:55:29 +0000 2008'); 
```

然后使用[time()](http://php.net/time)获取当前的 UNIX 时间戳：

```
$current_time = time(); 
```

然后获取这些时间戳之间的秒数：

```
$difference = $current_time - $event_time; 
```

最后使用除法将秒数转换为天数或小时数或其他：

```
$hours_difference = $difference / 60 / 60;
$days_difference = $difference / 60 / 60 / 24; 
```

有关计算相对时间的更多信息，请参阅[如何计算相对时间？](https://stackoverflow.com/questions/11/how-do-i-calculate-relative-time).

# php - BiCubic Shaper PHP 图像调整大小

> ID：255585
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-11-01T06:37:10.953
> 
>         
> 
> 标签：php, image-processing, resize, gd, imagemagick

Photoshop 有一个很棒的功能：用于调整大小的 BiCube Shaper 选项。

但是我找不到等价物。

我已经看到使用 GD 的各种代码，这些代码使用了 imagecopyresampled 和自定义 unsharp mask，但没有达到我期望的质量。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-11-01T08:54:27.947

如果您尝试的只是 GD，您可能想试一试 ImageMagick 采样过滤器。这是一个与 PhotoShop 一起检查它们的页面：

[http://www.xs4all.nl/~bvdwolf/main/foto/down_sample/down_sample.htm](http://www.xs4all.nl/~bvdwolf/main/foto/down_sample/down_sample.htm)

# database - 存储大量数据点？

> ID：255601
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-11-01T07:05:44.453
> 
>         
> 
> 标签：database

存储大量数据点的最佳方式是什么？

例如，在许多位置每分钟测量一次的温度值？

每个数据点一行的 SQL 数据库似乎效率不高。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T07:17:52.337

我想知道您为什么认为它“效率不高”。可能您需要解释您的数据模型和模式以提供更好的场景上下文。

将多个数据点存储在一行中，当它们彼此不相关并且确实应该独立存在时，这不是一个好方法。网格化将产生非常违反直觉和古怪的查询语句，以提取给定场景所需的正确数据点。

我们之前在发电站做过工作，从各种系统和计量设备收集数据，包括需要监控和汇总的各种气体和电气参数。根据参数的类型，它们可以每 3-5 分钟到 30-60 分钟出现一次。这些自然会导致每月数百万条记录。

关键是正确地索引表，以便它们的物理顺序与记录进入的顺序相关联。（聚集索引）新页面和范围由传入数据按顺序创建和填充。这应该可以防止大量的页面拆分和重新洗牌。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T21:39:22.147

关键问题可能是：您以后需要如何访问它们？

如果您需要将每个点与时间戳和位置 ID 相关联，然后需要从多个客户端检索基于时间/时间范围和位置的单个测量值，那么数据库可能确实是最有效的**检索**。

OTOH，如果您的客户将加载和处理一个位置的一整天的数据，则将数据存储在每个位置和每天的一个文件中可以减少依赖性并且可能更容易。

其他问题是备份和存档，以及您的用户是否可以/应该自己处理。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T08:12:13.273

像这样的表可能会起作用：

LocationID、温度、时间戳

我不明白为什么这不会有效。毕竟，这就是数据库的用途。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2021-05-27T17:33:57.797

将它们作为行和列存储在数据表中，因为数据表稍后可以按年份、月份和位置进行分区，以便使用并行处理提高提取速度。

# biztalk - 提取内部模式 XML 值以映射到编排的入站模式的方法

> ID：255605
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-11-01T07:07:03.327
> 
>         
> 
> 标签：biztalk, biztalk2006r2

作为其工作过程的一部分，有几个应用程序系统相互传递消息。由于围绕事务完整性的技术限制，应用程序数据和消息传递都提交到单个大型机 DB2 数据库中。消息不直接传递到 BizTalk 服务器 (2006 R2)；稍后由 BTS 从 DB2 数据库中提取消息。

DB2 数据库中的消息队列表有几个字段。关键字段是 MESSAGE_DATA 列 - 实际消息；它是 XML 内容本身。当使用 DB2 适配器从表中查询出记录时，传入的模式将类似于

更正更新：DB2Message 模式是基于属性的；我以前误认为它是基于元素的。

```
<DB2Message MESSAGE_DATA="&lt;InternalXML&gt; ........ &lt;/InternalXML&gt;"
 MESSAGE_DATE="2008-1-1 00:00:00" MESSAGE_ID="GUID" TXN_ID="GUID" .... other attrib /> 
```

编排使用模式

```
<EAIMessage>
 <Header>
  <ServiceID>
  <MessageID>
  ....
  <Mode>
 </Header>
 <Body>
  <RawXML>
 </Body>
</EAIMessage> 
```

编排将使用 Header 中的几个提升字段来做出路由和处理决策。问题是，这些标题字段实际上来自存储在 DB2Message 的 MESSAGE_DATA 中的内部 XML 内容。

在这个单一级别上，当将两个模式放在一起时，映射器不知道 MESSAGE_DATA 中的这个底层 XML 模式。可能应该有一些 XPath functoid 可以进一步深入 MESSAGET_DATA 元素以进行正确的值映射，但之前没有处理过广泛的 XML 和 XSLT 应用程序，我无法看到可以帮助我执行此任务的可用功能.

有没有人做过这样的数据提取和映射？

更新。根据要求，在 MESSAGE_DATA 内部 XML 中可能看起来像

```
<Message>
    <Id>e86970f4-0455-4535-8e65-a06eb7aaef8a</Id>
    <SenderApp>999</SenderApp>
    <ReceiverApp>2000</ReceiverApp>
    <ServiceId>8798973454</ServiceId>
    <Mode>P</Mode>
    <MuxId></MuxId>
    <ExceptionCode></ExceptionCode>
    <ExceptionMessage></ExceptionMessage>
    <Body>
        <WorkItem xmlns="http://tempuri.org/WorkItem.xsd">
            <ServiceHeader xmlns="http://tempuri.org/Service.xsd">
                <ID_UPDATED_BY>username</ID_UPDATED_BY>
                <ID_HISTORY_REF>xxxxxxx</ID_HISTORY_REF>
                <SESSION_ID>sessionID</SESSION_ID>
                <DT_LAST_UPDATE>timestamp</DT_LAST_UPDATE>
                <TM_LAST_UPDATE>time</TM_LAST_UPDATE>
            </ServiceHeader>
        </WorkItem>
    </Body>
</Message> 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-12-06T14:20:55.537

克里斯是正确的——看起来它只是你真正关心的信息的内部部分，外部部分只是一个信封。

因此，我建议您创建一个反汇编程序，该程序在接收管道中将剥离信封（如果您需要采取行动，您可以将其作为上下文属性保持完整和/或从中提取一些位作为单独的属性上），并提取将成为发布到消息框的消息的内部部分。

现在真正的消息是得到处理的消息，但发送端口的其余部分和任何订阅者，以及您从信封中需要的任何信息都会通过它的上下文流动。

现在您可以完全访问消息及其属性；如果适用，您可以为此消息部署一个模式，该模式可能具有可区分的属性，可以让您快速访问某些（简单类型）节点。或者，您可以使用 xlang/s xpath 来提取信息。

如果您的嵌入消息在信封中的一个元素内，您当然可以使用内置的 XmlDisassembler 来完成所有这些工作（您只需要正确部署您的模式并相应地配置组件；我不确定这有多好用包含在属性中的消息，但可能值得一试。

最坏的情况是，您正在考虑编写一个自定义反汇编程序，该反汇编程序会剥离信封，然后调用内置反汇编程序来处理内部消息，但这也不应该花费太多精力。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-12-05T04:15:11.003

I would suggest looking into envelope schemas to 'unwrap' the interior message from the outer message.  I believe the envelope can promote properties from the envelope into the inner message's context as it moves through the receive pipeline.  The inner message will then have to map to a schema of its own type.  You will then be able to route or make decisions based on the schema type and use XPath to pick out whatever you need.  Have not tried all of these things, but I am certain the functionality exists to do do this.  

# performance - 哪个性能更好：Crystal Reports 或 SQL Server Reporting Services？

> ID：255607
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T07:11:34.707
> 
>         
> 
> 标签：performance, reporting-services

哪个性能更好：Crystal Reports 或 SQL Server Reporting Services？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T16:14:02.410

SSRS 在使报告变得快速和简单方面做得很好。就像大多数微软的工具一样，如果你坚持他们认为你应该做的事情，这不是问题。如果您尝试跳出框框，事情就会变得有趣，并且您最终将不得不使用一些非常奇怪的解决方法来使事情正常进行。

另一方面，Crystal Reports 更难学习，但在您可以做的事情上为您提供了更大的灵活性。

我们有很多我在 Crystal Reports 工作的报表，并决定将它们转换为 SSRS。这需要一段时间，我们发现有一些东西不能按照我们想要的方式工作，但 SSRS 具有与 SQL Server 一起免费的明显优势。Crystal 的成本很高，所以如果您必须考虑 SSRS 的成本并了解这些怪癖

编辑：至于性能，我们无法看出 Crystal 与 SSRS 报告的渲染时间有很大差异。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-11-18T14:57:18.357

性能方面，我认为 MSRS 在纯报告方面表现更好。如果您需要创建提供给外部客户的报告或表格，我会使用 CR。它具有更多功能，并且可以更好地控制报表的布局。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T07:14:51.877

如果您使用的是 sql server，则 ssrs 很好

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T16:08:37.447

总体而言，SSRS 对于内部报告功能来说是一个不错的解决方案。它的功能很强大，但恕我直言，它对于强大的分析和报告还不够通用。开箱即用，它将生成一个数据表或一个简单的图表。

我使用 SSRS 2000 和 2005 构建了一些基本报告，并使用了 MOM 2005 等应用程序提供的内容。SSRS 在针对参数化 SQL 查询构建报告方面具有很大的灵活性。您可以使用 .NET CLR 扩展报告生成功能，以进行后查询处理、图像生成等。Web 界面非常人性化，您可以以多种格式导出生成的报告。

Web 界面无法自定义。参数输入框无法调整大小，因此如果您有一个包含许多参数的报表，SSRS 会将其大小调整为较大，而报表输出较小，您无法在浏览器中更改它。说到很多参数，所有的参数都是静态声明的。您不能以编程方式从用户界面构建参数。例如，性能数据的 MOM 2005 报告仅给您 4 个插槽来指定要报告的性能指标。您无法添加更多、重新排列等。您还会发现无法生成嵌套报告，例如包含多个图形、表格等的摘要报告，如网络日志报告。

我没有用过水晶报表，所以无法比较。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2015-10-27T07:12:00.637

聚会迟到了:)

如果你在做桌面应用程序，CR 会有很大的开销。在客户端上安装应用程序之前安装正确的 .NET 框架和 CR 本身。我们已经使用 CR 很长时间了，但是现在我们想要进行广泛的分发，我们认为这对我们的客户来说太麻烦了，其中一些客户没有完成所有步骤的技能。当您在 x64 计算机上安装时，CR 13 经常需要安装 x86 版本和 x64 版本……对客户来说有点混乱和沮丧！

我们不久前开始了这种转换，到目前为止，我们还没有发现任何我们不能用 SSRS（*.rdl 和 *.rdlc）报告做的事情。我们的应用程序的安装现在从应用程序设置开始；该设置安装了 .NET 框架（如果缺少），这就是我们需要部署的全部内容。

此外，我通常会在 Access 中给学生报告作业，当他们完成后，将其发送给我，将它们转换为 .rdl 并集成非常容易。他们只需要 Office 即可完成任务。

至于报告水平：我们做 ERP。对于分析：我用 SSRS 做了几篇硕士论文分析，我发现用 SPSS 很难做这些事情；可能是因为我对它的了解有限。

# version-control - TortoiseCVS 和 TortoiseSVN 同时安装时会冲突吗？

> ID：255608
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2008-11-01T07:12:42.847
> 
>         
> 
> 标签：version-control, tortoisesvn, tortoisecvs

我对在同一台计算机上安装 TortoiseCVS 和 TortoiseSVN 是否安全感兴趣？我们所有的公司项目都由 CVS 控制，但我想将 SVN 用于我的个人文档（并使用 TortoiseSVN 作为客户端）。是否可以？

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2008-12-25T08:13:19.323

它们都可以一起使用而没有（好的，几乎没有）问题。您可能会遇到的一个问题是某些覆盖图标将不再显示。这是因为 Windows 只有大约 12 个可用于覆盖图标的插槽，并且在安装了 TortoiseSVN 和 TortoiseCVS 后，它们一起使用的可用插槽超过了 12 个。

请参阅此常见问题解答条目：
[覆盖图标出现，但不是全部！](http://tortoisesvn.tigris.org/faq.html#ovlnotall)

然而，TortoiseSVN 创建了一个通用的覆盖处理程序，其他 Tortoise 客户端可以使用它来避免这个问题。TortoiseCVS 现在也使用该通用处理程序，但尚未包含在稳定版本中。您必须使用此处的不稳定版本：http:
 [//testpilot.tortoisecvs.org/](http://testpilot.tortoisecvs.org/)
使用来自 testpilot 站点的 TortoiseSVN 1.5.x 和 TortoiseCVS 将为您提供 SVN 和 CVS 工作副本的所有覆盖。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T07:14:44.810

它们可以在同一台机器上毫无问题地使用。如果您愿意，即使在[同一个文件夹中...](http://tortoisesvn.net/node/105)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T07:14:21.720

我都安装了它，没有遇到任何问题。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-12-31T10:42:11.750

我已经更新了 tortoiseCVS 和 tortoise SVN 

，它们无法正常工作（CVS 图标覆盖未显示），这些版本我对任何其他建议都很感兴趣。

我在 Windows XP pro SP3 下运行。

TortoiseCVS 版本 1.10.8 RC 11 加上测试修复构建于 2008 年 8 月 18 日星期一 22:10:04

TortoiseSVN 1.5.6，Build 14908 - 32 位，2008/12/20 11:51:04 Subversion 1.5.5，apr 1.2.12 apr-utils 1.2.12 berkeley db 4.4.20 neon 0.28.3 OpenSSL 0.9.8i 15 2008 年 9 月 zlib 1.2.3

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-27T13:39:19.383

重新安装 TortoiseCVS-1.10.10.exe 和 TortoiseSVN-1.6.2.16344-win32-svn-1.6.2 时让我的工作正常。我有带有最新更新的 win x64 sp2，当我打开资源管理器时，它只显示 cvs 文件夹图标，但是当我像这样打开资源管理器 '%WinDir%\SysWow64\Explorer.exe /e, /separate' 然后它只显示 svn 文件夹图标，所以在 x64 上也有一些困难。我对这两个程序都有问题，尤其是 svn64bit 版本。希望对 XP x64 用户有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-07-17T07:32:43.497

我安装了 TortoiseCSV，后来又安装了 TortoiseSVN，每次尝试打开右键单击上下文菜单时，我都会立即开始窗口资源管理器崩溃。右键单击桌面屏幕时甚至开始发生这种情况。屏幕将变为空白，然后尝试重新加载所有任务栏应用程序。卸载 TortoiseSVN 纠正了这种情况......不再崩溃！

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-07-17T07:43:45.410

在 vista64 上，我安装了 (cvs:1.10.10, svn: 1.6.3) 和 smartcvs/svn。我没有任何问题，只是图标覆盖是任意错误的，但不会导致崩溃。

# c++ - 动态分配对象数组

> ID：255612
> 
>         
> 
> 赞同：63
> 
>         
> 
> 时间：2008-11-01T07:15:28.833
> 
>         
> 
> 标签：c++, memory-management, pointers, destructor, copy-constructor

我有一个包含动态分配数组的类，比如说

```
class A
{
    int* myArray;
    A()
    {
        myArray = 0;
    }
    A(int size)
    {
        myArray = new int[size];
    }
    ~A()
    {
        // Note that as per MikeB's helpful style critique, no need to check against 0.
        delete [] myArray;
    }
} 
```

但现在我想为这些类创建一个动态分配的数组。这是我当前的代码：

```
A* arrayOfAs = new A[5];
for (int i = 0; i < 5; ++i)
{
    arrayOfAs[i] = A(3);
} 
```

但这炸得太厉害了。因为当循环迭代完成时（通过调用）创建的新`A`对象`A(3)`被破坏`for`，这意味着该`myArray`实例`A`的内部被`delete []`-ed。

所以我认为我的语法一定是非常错误的？我想有一些修复看起来有点矫枉过正，我希望避免：

*   为`A`.

*   使用`vector<int>`，`vector<A>`所以我不必担心这一切。

*   与其`arrayOfAs`成为一个`A`对象数组，不如让它成为一个`A*`指针数组。

我认为这只是一些初学者的事情，其中​​有一种语法在尝试动态分配具有内部动态分配的事物数组时实际上有效。

（此外，风格批评很受欢迎，因为我已经有一段时间没有使用 C++ 了。）

**未来观众**的更新：以下所有答案都非常有帮助。Martin 的被接受是因为示例代码和有用的“4 规则”，但我真的建议阅读它们。有些是错误的简洁陈述，有些则正确地指出了如何以及为什么`vector`s 是一个好方法。

* * *

## 回答 #1

> 赞同：131
> 
>             
> 
> 时间：2008-11-01T16:28:21.383

对于构建容器，您显然希望使用标准容器之一（例如 std::vector）。但这是当您的对象包含 RAW 指针时您需要考虑的事情的一个完美示例。

如果您的对象有一个 RAW 指针，那么您需要记住规则 3（现在是 C++11 中的 5 规则）。

*   构造函数

*   析构函数

*   复制构造函数

*   赋值运算符

*   移动构造函数 (C++11)

*   移动赋值 (C++11)

这是因为如果未定义，编译器将生成自己的这些方法版本（见下文）。编译器生成的版本在处理 RAW 指针时并不总是有用。

复制构造函数是很难正确的（如果你想提供强大的异常保证，这很重要）。赋值运算符可以根据复制构造函数定义，因为您可以在内部使用复制和交换习语。

有关包含指向整数数组的指针的类的绝对最小值的完整详细信息，请参见下文。

知道要使其正确并非易事，您应该考虑使用 std::vector 而不是指向整数数组的指针。该向量易于使用（和扩展）并涵盖与异常相关的所有问题。将下面的类与下面的 A 的定义进行比较。

```
class A
{ 
    std::vector<int>   mArray;
    public:
        A(){}
        A(size_t s) :mArray(s)  {}
}; 
```

看看你的问题：

```
A* arrayOfAs = new A[5];
for (int i = 0; i < 5; ++i)
{
    // As you surmised the problem is on this line.
    arrayOfAs[i] = A(3);

    // What is happening:
    // 1) A(3) Build your A object (fine)
    // 2) A::operator=(A const&) is called to assign the value
    //    onto the result of the array access. Because you did
    //    not define this operator the compiler generated one is
    //    used.
} 
```

编译器生成的赋值运算符几乎适用于所有情况，但是当 RAW 指针起作用时，您需要注意。在您的情况下，由于**浅拷贝**问题，它会导致问题。您最终得到了两个包含指向同一块内存的指针的对象。当 A(3) 在循环结束时超出范围时，它会在其指针上调用 delete []。因此，另一个对象（在数组中）现在包含一个指向已返回给系统的内存的指针。

**编译器生成复制构造函数**；使用该成员复制构造函数复制每个成员变量。对于指针，这只意味着指针值从源对象复制到目标对象（因此是浅拷贝）。

**编译器生成赋值运算符**；使用该成员赋值运算符复制每个成员变量。对于指针，这只意味着指针值从源对象复制到目标对象（因此是浅拷贝）。

因此，包含指针的类的最小值：

```
class A
{
    size_t     mSize;
    int*       mArray;
    public:
         // Simple constructor/destructor are obvious.
         A(size_t s = 0) {mSize=s;mArray = new int[mSize];}
        ~A()             {delete [] mArray;}

         // Copy constructor needs more work
         A(A const& copy)
         {
             mSize  = copy.mSize;
             mArray = new int[copy.mSize];

             // Don't need to worry about copying integers.
             // But if the object has a copy constructor then
             // it would also need to worry about throws from the copy constructor.
             std::copy(&copy.mArray[0],&copy.mArray[c.mSize],mArray);

         }

         // Define assignment operator in terms of the copy constructor
         // Modified: There is a slight twist to the copy swap idiom, that you can
         //           Remove the manual copy made by passing the rhs by value thus
         //           providing an implicit copy generated by the compiler.
         A& operator=(A rhs) // Pass by value (thus generating a copy)
         {
             rhs.swap(*this); // Now swap data with the copy.
                              // The rhs parameter will delete the array when it
                              // goes out of scope at the end of the function
             return *this;
         }
         void swap(A& s) noexcept
         {
             using std::swap;
             swap(this.mArray,s.mArray);
             swap(this.mSize ,s.mSize);
         }

         // C++11
         A(A&& src) noexcept
             : mSize(0)
             , mArray(NULL)
         {
             src.swap(*this);
         }
         A& operator=(A&& src) noexcept
         {
             src.swap(*this);     // You are moving the state of the src object
                                  // into this one. The state of the src object
                                  // after the move must be valid but indeterminate.
                                  //
                                  // The easiest way to do this is to swap the states
                                  // of the two objects.
                                  //
                                  // Note: Doing any operation on src after a move 
                                  // is risky (apart from destroy) until you put it 
                                  // into a specific state. Your object should have
                                  // appropriate methods for this.
                                  // 
                                  // Example: Assignment (operator = should work).
                                  //          std::vector() has clear() which sets
                                  //          a specific state without needing to
                                  //          know the current state.
             return *this;
         }   
 } 
```

* * *

## 回答 #2

> 赞同：12
> 
>             
> 
> 时间：2008-11-01T08:26:08.800

我建议使用 std::vector: 类似的东西

```
typedef std::vector<int> A;
typedef std::vector<A> AS; 
```

STL 的轻微矫枉过正并没有错，您将能够花更多的时间来实现您的应用程序的特定功能，而不是重新发明自行车。

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2008-11-01T16:20:26.017

A 对象的构造函数动态分配另一个对象，并将指向该动态分配对象的指针存储在原始指针中。

对于这种情况，您*必须*定义自己的复制构造函数、赋值运算符和析构函数。编译器生成的将无法正常工作。（这是“三巨头法则”的推论：具有析构函数、赋值运算符、复制构造函数中的任何一个的类通常需要全部 3 个）。

您已经定义了自己的析构函数（并且您提到了创建一个复制构造函数），但是您需要定义三巨头中的另外两个。

另一种方法是将指向您动态分配的指针存储在`int[]`将为您处理这些事情的其他对象中。像 a `vector<int>`（正如你提到的）或 a之类的东西`boost::shared_array<>`。

归结为 - 为了充分利用 RAII，您应该尽可能避免处理原始指针。

而且由于您要求对其他样式进行批评，因此一个次要的问题是，当您删除原始指针时，您不需要在调用之前检查 0 `delete`-`delete`通过什么都不做来处理这种情况，这样您就不必用检查来弄乱您的代码.

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T07:46:33.590

1.  仅当对象具有默认构造函数和复制构造函数时，才对对象使用数组或公共容器。

2.  否则存储指针（或智能指针，但在这种情况下可能会遇到一些问题）。

PS：始终定义自己的默认构造函数和复制构造函数，否则将使用自动生成的构造函数

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T15:36:44.140

您需要一个赋值运算符，以便：

```
arrayOfAs[i] = A(3); 
```

正常工作。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T17:55:00.243

为什么没有 setSize 方法。

```
A* arrayOfAs = new A[5];
for (int i = 0; i < 5; ++i)
{
    arrayOfAs[i].SetSize(3);
} 
```

我喜欢“复制”，但在这种情况下，默认构造函数并没有真正做任何事情。SetSize 可以将数据从原始 m_array 中复制出来（如果存在）。您必须在类中存储数组的大小才能做到这一点。

或者

SetSize 可以删除原来的 m_array。

```
void SetSize(unsigned int p_newSize)
{
    //I don't care if it's null because delete is smart enough to deal with that.
    delete myArray;
    myArray = new int[p_newSize];
    ASSERT(myArray);
} 
```

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2016-04-22T17:16:11.043

使用`new`运算符的放置功能，您可以就地创建对象并避免复制：

> 放置 (3) :void* operator new (std::size_t size, void* ptr) noexcept;
> 
>   
>   
> 
> 只需返回 ptr （不分配存储空间）。但请注意，如果函数由 new 表达式调用，则将执行正确的初始化（对于类对象，这包括调用其默认构造函数）。

我建议如下：

```
A* arrayOfAs = new A[5]; //Allocate a block of memory for 5 objects
for (int i = 0; i < 5; ++i)
{
    //Do not allocate memory,
    //initialize an object in memory address provided by the pointer
    new (&arrayOfAs[i]) A(3);
} 
```

# asp.net - 使用 Web 方法 ASP.NET 获取从基类继承的自定义对象时出错

> ID：255615
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-11-01T07:22:39.957
> 
>         
> 
> 标签：asp.net, methods

我创建了一个基类 A，而 B 类是从 A 类继承的派生类。这两个类都标记为序列化。当我尝试通过 Web 方法返回 B 类型的对象时，出现以下错误：

**System.Web.Services.Protocols.SoapException：System.Web.Services.Protocols.SoapException：服务器无法处理请求。---> System.InvalidOperationException：生成 XML 文档时出错。---> System.InvalidOperationException：类型 CSI.API.RPartyMembershipInfo 不是预期的。使用 XmlInclude 或 SoapInclude 属性指定静态未知的类型。**

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T23:57:47.357

在我们提供帮助之前，您需要发布您的代码。

我在 Google 中快速搜索了错误消息的最后一行，得到了这 2 个页面，这可能会有所帮助。

[http://www.theserverside.net/discussions/thread.tss?thread_id=37823](http://www.theserverside.net/discussions/thread.tss?thread_id=37823)

[http://social.msdn.microsoft.com/Forums/en-US/asmxandxml/thread/aa18e76b-0efc-4c5c-be28-5fb578cf47f2/](http://social.msdn.microsoft.com/Forums/en-US/asmxandxml/thread/aa18e76b-0efc-4c5c-be28-5fb578cf47f2/)

# database-design - 我应该为多客户端应用程序使用单个还是多个数据库设置？

> ID：255616
> 
>         
> 
> 赞同：65
> 
>         
> 
> 时间：2008-11-01T07:25:32.120
> 
>         
> 
> 标签：database-design, architecture, database-schema, multi-tenant

我正在开发一个旨在简化公司工作流程和项目管理的 PHP 应用程序，比如说[Basecamp](http://www.basecamphq.com/)和[GoPlan](http://goplan.org)。

我不确定数据库方面的最佳方法是什么。我应该使用单个数据库并向每个表添加特定于客户端的列，还是应该为每个新客户端创建一个数据库？一个重要的因素是自动化：我希望创建一个新客户变得非常简单（也许可以为自己注册）。

我可以考虑使用一个数据库的可能缺点：

*   缺乏可扩展性

*   安全问题（尽管*一开始就不应该存在*错误）

您对此有何看法？您对上述公司最有可能选择哪种解决方案有任何想法吗？

* * *

## 回答 #1

> 赞同：37
> 
>             
> 
> 时间：2008-11-01T08:21:14.380

我通常将 ClientID 添加到所有表并使用一个数据库。但由于数据库通常难以扩展，我还将为部分或所有客户端在不同的数据库实例上运行成为可能。

这样，您可以在一个数据库中拥有一堆小客户端，而在不同的服务器上拥有大客户端。

但是，可维护性的一个关键因素是您在所有数据库中保持模式相同。在不引入特定于客户端的模式的情况下管理版本控制将非常令人头疼。

* * *

## 回答 #2

> 赞同：36
> 
>             
> 
> 时间：2008-11-01T16:19:48.640

收听 Joel 和 Jeff 谈论相同问题的 Stackoverflow 播客。Joel 正在谈论他们提供软件托管版本的经验。他指出，在您的数据库中添加客户端 ID 会使设计和代码复杂化（您确定您没有不小心忘记将其添加到某些 WHERE 子句中吗？）并使托管功能（例如特定于客户端的备份）复杂化。

它出现在第 20 集或第 21 集中（详情请查看成绩单）。

* * *

## 回答 #3

> 赞同：24
> 
>             
> 
> 时间：2008-11-01T15:58:39.150

在我看来，这将取决于您可能的客户群。如果您可能遇到主要竞争对手都在使用您的系统的情况，那么使用单独的数据库会更好。它还取决于您的 DBMS 如何实现多个数据库。如果每个数据库都有一个单独的基础架构副本，那么这表明只有一个数据库（或 DBMS 的更改）。如果基础设施的一个副本可以为多个数据库提供服务，那么我会选择单独的数据库。

想想数据库备份。客户 A 说“请向我发送一份我的数据”。与共享单个数据库相比，在单独的数据库设置中要容易得多。考虑移除一个客户；同样，使用单独的数据库要容易得多。

（例如，“基础设施”部分是粉饰的，因为不同的 DBMS 在“数据库”和“服务器实例”的构成方面存在重大差异。  *添加*：问题被标记为“mysql”，所以也许这些想法是不完全相关。）

*添加*：还有一个问题 - 在单个数据库中有多个客户，每个 SQL 查询都需要确保选择正确客户的数据。这意味着 SQL 将更难编写和读取，DBMS 将不得不更加努力地处理数据，索引会更大，而且......我真的会使用单独的数据库客户用于多种用途。

显然，StackOverflow（例如）没有每个用户单独的数据库；我们都使用相同的数据库。但是，如果您为不同的公司运行会计系统，我认为共享数据库是不可接受的（对公司而言，可能对法律人员而言也是如此）。

* * *

## 回答 #4

> 赞同：15
> 
>             
> 
> 时间：2009-02-15T12:54:20.827

*   **开发**
    为了快速开发，请为每个客户使用一个数据库。想想备份、恢复或删除客户数据是多么容易。或测量/监控/账单使用情况。您无需自己编写代码，只需使用您的数据库原语即可。

*   **性能**
    为了性能，请为所有人使用数据库。想想连接池、共享内存、缓存等。

*   **业务**
    如果您的业务计划是拥有大量小客户（想想 hotmail），您可能应该在单个数据库上工作。并让所有管理任务（如注册、删除、数据迁移等）完全自动化并显示在友好的界面中。如果您计划拥有数十个或多达数百个大客户，那么您可以在每个客户一个数据库中工作，并拥有可由您的客户支持人员操作的系统管理脚本。

* * *

## 回答 #5

> 赞同：11
> 
>             
> 
> 时间：2008-11-01T08:04:28.000

对于多租户，性能通常会增加您设法在租户之间共享的资源越多，请参阅

[http://en.wikipedia.org/wiki/Multitenancy](http://en.wikipedia.org/wiki/Multitenancy)

因此，如果可以，请使用单个数据库。我同意安全问题只会由于错误而发生，因为您可以在应用程序中实现所有访问控制。在某些数据库中，您仍然可以通过仔细使用视图来使用数据库访问控制（以便每个经过身份验证的用户获得不同的视图）。

还有一些方法可以提供可扩展性。例如，您可以创建一个具有扩展属性（由租户、基本记录和扩展属性 id 键入）的表。或者您可以创建每个租户的扩展表，以便每个租户都有自己的扩展架构。

* * *

## 回答 #6

> 赞同：7
> 
>             
> 
> 时间：2016-10-08T18:38:40.680

在设计多租户数据库时，通常有三个选项：

1.  每个租户拥有一个数据库

2.  每个租户有一个架构

3.  让所有租户共享同一张桌子

您选择的选项会影响可伸缩性、可扩展性和隔离性。这些影响已在不同的[StackOverflow 问题](https://stackoverflow.com/search?tab=votes&q=multi-tenant%20database)和数据库文章中得到广泛讨论。

在实践中，三个设计选项中的每一个——只要付出足够的努力——都可以解决有关规模、跨租户变化的数据和隔离的问题。该决定取决于您要构建的主要维度。摘要：

*   如果您正在构建规模：让所有租户共享同一张桌子

*   如果您正在构建隔离：为每个租户创建一个数据库

例如，[Google](http://static.googleusercontent.com/media/research.google.com/en//pubs/archive/41344.pdf)和 Salesforce 遵循第一种模式并让他们的租户共享相同的表。另一方面，Stackoverflow 遵循第二种模式，并为每个租户保留一个数据库。第二种方法在医疗保健等受监管的行业中也更为常见。

决定归结为您优化数据库设计的主要维度。[这篇关于为规模设计 SaaS 数据库的文章](https://www.citusdata.com/blog/2016/10/03/designing-your-saas-database-for-high-scalability/)讨论了权衡取舍，并提供了 PostgreSQL 上下文中的摘要。

* * *

## 回答 #7

> 赞同：5
> 
>             
> 
> 时间：2008-11-01T20:52:06.267

要考虑的另一点是，您可能有法律义务将一家公司的数据与另一家公司的数据分开。

* * *

## 回答 #8

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T21:07:59.120

每个客户端拥有一个数据库通常不能很好地扩展。MySQL（可能还有其他数据库）为每个表保留打开的资源，这不适合一个实例上的 10k+ 个表，这在大规模多租户情况下会发生。

当然，如果您在达到此级别之前有其他问题导致其他问题，这可能无关紧要。

此外，随着您的应用程序变得越来越大，“分片”多租户应用程序最终可能是正确的做法。

然而，分片并不意味着每个租户一个数据库（或实例），而是每个分片或一组分片一个，每个分片可能有多个租户。您将需要为自己找到正确的调整参数，可能在生产中（因此它可能需要从一开始就进行相当的调整）

€ 我不能保证。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-01-02T23:15:17.223

您可以从单个数据库开始，并随着应用程序的增长对其进行分区。如果你这样做，我会推荐几件事：

1) 以易于分区的方式设计数据库。例如，如果客户要共享数据，请确保在每个数据库中轻松复制数据。

2）当您只有一个数据库时，请确保将其备份到另一台物理服务器。如果发生故障转移，您可以将流量恢复到这台其他服务器，并且您的数据仍然完好无损。

# asp.net - 如何在javascript中设置定时间隔？

> ID：255617
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-11-01T07:27:36.343
> 
>         
> 
> 标签：asp.net, javascript, jquery, asp.net-mvc

下面的 javascript 应该设置一个间隔，以便 json 对象列表中的新项目将缓慢添加到列表顶部，但它们都是同时添加的。

```
<script type="text/javascript">
    var json;
    var count = 0;
    $(document).ready(function() {
        $.ajax({
            type: "POST",
            url: "/Home/PublicTimeLine",
            data: "{}",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function(msg) {
                json = eval(msg);
                createRow();
            }

        });
    });

    function createRow() {
        if (count < json.length) {
            var data = json[count];
            var row = document.createElement("div");
            $(row).hide();
            row.appendChild(document.createTextNode(data.text));
            $(document).find("#results").prepend(row);
            $(row).fadeIn("slow");
            count++;
            setTimeout(createRow(), 3000);
        }
    }
</script>

<div id="results">
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T07:31:47.987

如果我是你，我会以稍微不同的方式解决它。为什么不将所有数据添加到您的页面上，而只是隐藏它并仅在您需要时显示。这样你就不必担心关闭和诸如此类的事情。

```
var intervalId;
$.ajax({
    type: "POST",
    url: "/Home/PublicTimeLine",
    dataType : "json",
    success : function (msg) {
        var json = eval(msg); // is this even needed?
        $.each(json, function(ind, data) {
            $("<div></div>")        // use jQuery to create the div
                .hide()
                .text(data)        // you can use jQuery to add contents too. (use .html() if you need HTML)
                .prependTo('#results')
            ;
        });
        intervalId = setInterval(showRow, 3000);
    }
});
function showRow() {
    var $myDiv = $('#results div:hidden:last');
    if ($myDiv.length) {
        $myDiv.show('slow');
    } else {
        clearInterval(intervalId);    // none more to show, stop checking
    }
} 
```

# vim - 编写 Vim 中的常见任务

> ID：255624
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2008-11-01T07:44:03.143
> 
>         
> 
> 标签：vim, scripting, automation, code-snippets

在使用 Vim 时（在家和工作中），我经常发现自己反复做类似的事情。例如，我可能会将一堆 CSV 文本转换为一系列 SQL 插入。我已经使用 Vim 多年了，但直到最近我才开始认真思考如何在使用它的同时提高工作效率。

我的问题是.. 有没有一种好方法（或正确的方法）来存储常用命令或命令序列？以及如何执行它们的最佳方式是什么？如果能够在实时会话中使用相同的脚本，也可以通过命令行对某个文件使用相同的脚本，那就太好了。

我希望我可以将它们存储在一个 .vim 文件中，以便我可以将它们交给同事（他们不熟悉 vim）供他们使用。

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2008-11-01T07:57:32.833

您可以将常用任务宏存储在 .vim 文件中，例如[这样](http://www.vanhemert.co.uk/vim/vimacros/html2.vim)，然后您可以使用命令*:so file.vim加载它们*

[在这里](http://www.vanhemert.co.uk/vim/)你可以找到一堆好用的宏，另外我推荐你好好学习好用的*q* [宏录制](http://julipedia.blogspot.com/2005/12/vim-macros.html)命令，它非常非常强大...

*使用q*命令创建的宏存储在一个寄存器中，qq将宏存储在q寄存器中，所以当你结束录制时你可以简单地粘贴宏，用*“qp*保存它，以后你可以通过简单的拉动来加载它将宏放入寄存器，即：*“qY*，宏只是文本，记住您可以使用任何寄存器代替 q。有一个用于存储*q*宏的 Vim 脚本：

[marvim : VIM 的宏持久存储和可共享存储库](http://www.vim.org/scripts/script.php?script_id=2154) 

还可以查看[Vim Scripting Language](http://en.wikibooks.org/wiki/Learning_the_vi_editor/Vim/Exim_Script_language)。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-11-02T03:59:35.077

我经常使用`q`/来录制/重放宏。`@`

下一步是尝试编写 3 个或更少的 ex 命令。

如果某些东西如此复杂以至于宏或短的 ex 序列都不够用，我倾向于将其编写为 Perl 脚本。根据我的口味，vim 脚本语言有点太有限，无法尝试做大事。（尽管 vim 7 在这方面取得了长足的进步，从 Python 中借用了很多东西。）

请注意，`@`它做了一些非常简单的事情：它获取寄存器的内容并重放它们，就像您在正常模式下键入它们一样。同样`q`，只需将您输入的序列记录到您命名的寄存器中。这些是您用于拉/放*的相同*`.vimrc`寄存器——这意味着您可以直接将记录的序列粘贴到文件中（任何人？）或从文件中拉出一系列命令并重放它（这样您就可以保留一堆他们在`~/my-vim-macros.txt`什么的）。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T08:28:22.350

您可以将命令序列存储在您的文件中`.vimrc`，并为它们分配与`:map`命令的键绑定。例如：

```
echo >>~/.vimrc ":map ,c :%s/,/','/g<CR>:%s/^/('/g<CR>:%s/$/'),/g<CR>" 
```

在实时会话中按“ `,c`”时，这会将您的 CSV 文件转换为 INSERT 语句的一部分。

在命令行上，可以通过以下方式将相同的编辑应用于文件（这将覆盖，请务必先备份）：

```
vim file.txt -c ':normal ,c | :x' 
```

可能有更好的方法，但这有效。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T16:18:47.830

就个人而言，可能部分是因为我在 vim 存在之前很久就使用 Unix（见鬼，我使用的第一个 Unix 版本也没有“vi”——但那是另一回事），我通常会使用“shell 脚本”（或者更可能是 Perl 脚本）来进行转换。为了将 CSV 数据转换为 INSERT，完全通用地处理引号/非引号和嵌入的逗号是很麻烦的——我可能打算使用带有 Text::CSV_XS 的 Perl 脚本来保证正确的解析。然后，我会在需要转换的文本范围内运行该脚本。

这样做的一个优点是集中的工具方法 - 一种工具可以正确完成一项工作。我的私人 bin 目录中有 300 个或更多的脚本和程序；RCS 目录中有超过 500 个脚本。

这并不是说 vim 中的脚本不好。我使用（或多或少）复杂的地图命令来编写复杂的操作，通常当我将不得不对一组文件进行相同的更改时，并且我认为不值得为工作。但是，如果我认为我可能需要多次更改，那么我将编写脚本。例如，GCC 开始对不在目标文件中嵌入未使用的静态字符串感到自负（大约 2005 年）——这意味着我的版本控制信息不可见。因此，多年来，当我编辑源文件时，我已经从静态（固定）名称转换为公共名称 - 不情愿，但必须是 AFAIAC。我有一个脚本可以为我进行编辑，所以当我需要在文件中进行更改时，我会运行该脚本来执行此操作。我有另一个更新版权信息的脚本；每次我在给定年份第一次修改文件时都需要它。是的，我可能可以把它作为 vim 中的东西藏起来——我从小就认为单独的脚本更好，尤其是因为如果我切换到任何其他编辑器，我仍然可以使用该脚本。

# c# - 检索满足选定条件的数据的最佳实践

> ID：255642
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-11-01T08:14:04.207
> 
>         
> 
> 标签：c#, .net, sql, datatable

我有一个名为 call 的数据库表，其中包含 call_time、location、emergency_type 列，并且紧急情况分为三种类型：护理人员、警察和消防员。在 windows 窗体中，我创建了 CheckBoxes 'paramedics'、'police'、'firefighters'，并且我想检索所有符合用户选择的表列。

我创建了一个函数：

```
public static DataTable GetHistory(DateTime from, DateTime to, bool paramedics, bool police, bool firefighters)
    {
        string select =
            "SELECT call_time, location, emergency_type where call_time between @from AND @to AND";
        if(paramedics)
        {
            select += " emergency_type = 'paramedics' ";
        }
        if(paramedics && police)
        {
           select +=" emergency_type = 'paramedics' OR emergency_type = 'police';
        }
        ...

    } 
```

然而，这段代码看起来很脏，因为如果有 30 种紧急情况，就会有 30 种！组合，我会在写所有 if 语句之前变老。

如果您可以分享您检索满足所选搜索条件的数据的做法，如果您可以选择很多选项，我将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-11-01T08:42:24.803

好吧，如果您必须使用紧急类型作为字符串，那么您可以发送一个包含紧急类型的文本表示的列表，而不是传入布尔值。例如，要调整上面的代码，您可以将方法签名更改为

```
public static DataTable GetHistory(DateTime from, DateTime to, List<string> types)
{
 ..
} 
```

然后传入一个看起来像这样的列表（例如）

```
List<string> types = 
  new List<string> { "paramedics" };

or 

List<string> types = 
  new List<string> { "paramedics", "police" }; 
```

然后，您可以调整查询以在 where 子句中使用 SQL IN 语句。接下来将字符串列表转换为逗号分隔的字符串，例如

```
string values = "'paramedics', 'police'" 
```

创建值变量的一种简单方法是使用

```
string values = string.Empty;
            types.ForEach(s =>
            {
               if (!string.IsNullOrEmpty(values))
                   values += ",";
               values += string.Format("'{0}'", s);

            }); 
```

顺便说一句，您可以使用参数化命令来避免 SQL 注入。一旦你有了字符串，你可以简单地做

```
string select =
 "SELECT call_time, location, emergency_type where call_time between @from AND @to AND emergency_type IN " + values 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T08:35:51.337

这是一种肮脏的做法。

```
string select = "SELECT call_time, location, emergency_type where call_time between @from AND @to AND (1=0";

if(paramedics) { select += " OR emergency_type = 'paramedics' "; }
if(police)     { select += " OR emergency_type = 'police'"; }
if(xyz)        { select += " OR emergency_type = 'xyz'"; }

select += ")"; 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T17:04:35.353

应避免字符串连接，因为它可能会导致一些令人讨厌的漏洞。如果您正在寻找编程访问方面的最佳实践，那么这里的最佳实践是使用参数化查询。

如果你想便宜，那么让 in 子句接受一个参数，并将该字符串从选中的复选框列表中连接在一起，并将其作为 in 子句的参数值传递。它看起来像这样：

```
where ... and emergency_type in (?) 
```

另一种方法是计算被选中的复选框的数量，并为 in 子句构建参数列表，使其看起来更像这样：

```
where ... and emergency_type in(?,?...) -- as many params as there are checked checkboxes. 
```

这些中的任何一个都可以。使用这些类型的查询，我已经构建了自己的 SQL 构造函数方法，我保留了参数的内部计数及其数据类型，并动态构建 sql，然后使用已知的好参数列表进行准备.

你可以看看学习 Linq。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T17:29:35.270

构建用户的比较值列表 (@EmergencyList)，并使用包含运算符的参数化查询使用 SQL。

```
SELECT call_time, 
       location, 
       emergency_type 
where call_time between @from AND @to 
  AND CONTAINS( Emegency_Type, @EmergencyList ) 
```

# c# - C#接口实现关系只是“Can-Do”关系？

> ID：255644
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2008-11-01T08:18:34.913
> 
>         
> 
> 标签：c#, inheritance, interface, liskov-substitution-principle

今天有人告诉我，C#中的接口实现只是“Can-Do”关系，而不是“Is-A”关系。这与我长期以来对 LSP（Liskov Substitution Principle）的信念相冲突。我一直认为所有继承都应该意味着“Is-A”关系。

所以，如果接口实现只是一个“可以做”的关系。如果有一个接口“IHuman”和“IEngineer”，一个类“Programmer”继承自“IHuman”和“IEngineer”怎么办？当然，“程序员”是“IHuman”和“IEngineer”。

如果只是“Can-Do”关系，是否意味着我们不能期望“Programmer”实例的行为在被视为 IHuman 和被视为 IEngineer 时可能会有所不同？

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2008-11-01T08:35:36.830

根据我的经验，考虑“是一个”和“可以做”的关系并没有太大帮助。你很快就会遇到问题。基本上，这是现实世界和 OO 之间的阻抗不匹配。不管有多少人真正谈论对现实世界进行建模，您都需要从根本上了解类型之间的关系在您使用的平台上意味着什么。

有时接口可以用作能力，有时它们可​​以代表更多的正常“is-a”关系。我不会对此过于挂念——只要确保你了解他们能做什么和不能做什么。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2008-11-01T08:28:26.593

我倾向于将接口视为行为契约。IComparable 和 IEnumerable 等接口是经典示例。

在您给出的示例中，IHuman 和 IEngineer 并不是真正的行为。  

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-01-07T21:11:37.470

发现这个问题很晚，但我想插话。

C# 中的接口具有 is-a 关系，但没有 is-an-object。相反，is-an-implementation。

换句话说，对于实现 IBar 的类 Foo，以下测试：

```
Foo myFoo = new Foo(); 
return myFoo is IBar; 
```

从字面上返回 true。你也可以说，

```
IBar bar = myArrayList[3] as IBar;
Foo foo = bar as Foo; 
```

或者，如果一个方法需要一个 IBar，你可以传递一个 Foo。

```
void DoSomething(IBar bar) {
}

static void Main() {
    Foo myFoo = new Foo();
    DoSomething(myFoo);
} 
```

显然，IBar 本身没有实现，所以可以做的关系也适用。

```
interface IBar { void happy(); }
class Foo : IBar
{
    void happy()
    {
        Console.Write("OH MAN I AM SO HAPPY!");
    }
}
class Program
{
    static void Main()
    {
        IBar myBar = new Foo();
        myBar.happy();
    }
} 
```

但是，就此而言，对象继承也是如此。继承类 Bar 的类 Foo 的对象具有 can-do 关系以及 is-a 关系，与接口相同。只是它的实现是为它预先构建的。

真正的问题是，是*什么*，能做*什么*？继承的类对象是-a- *[父实例]*和 can-do- *[父行为]*，而接口的实现是-an- *[接口实现]*因此 can-do- *[接口行为]*。

在大多数使用程序化 is-a 关系（例如上面列出的那些）的情况下，只评估接口，因此继承的类和实现的接口共享相同的 is-a 和 can-do 质量。

HTH，乔恩

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T08:37:06.733

.NET 框架的设计者使用接口来指定“有”（或“可以”）关系，而“是”是使用继承实现的。

[可以在 .NET Framework 开发人员指南的选择类和接口](http://msdn.microsoft.com/en-us/library/ms229013.aspx)部分中找到这样做的理由：

> 接口定义了实现者必须提供的一组成员的签名。接口不能为成员提供实现细节。

因此，由于您的“程序员”和“工程师”示例类很可能带有自己的特定功能，因此使用继承来实现它们会更合适。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T17:17:43.187

实际上这就是为什么大多数接口都是功能而不是名称，所以你有

IComparable, ITestable, IEnumerable

和

人、动物、狗等

无论如何，正如已经提到的，你必须务实，我在编码时有一个一般规则：**永远不要让概念、约定或标准实践妨碍完成工作，务实而不是学术.**

因此，如果您确定界面确实更适合您的设计，那就去做吧，不要担心诸如此类的问题。

# c++ - 如何计算 C++ 中的操作？

> ID：255645
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-11-01T08:19:19.030
> 
>         
> 
> 标签：c++, performance

如何计算 C++ 中的操作？我想以更好的方式分析代码，而不仅仅是计时，因为时间通常四舍五入到 0 毫秒。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-11-01T08:28:32.350

如果您正在计时代码，则值得在循环中多次运行它以避免计时器分辨率的影响。因此，您可能会运行您正在计时的事物 10,000 次，并测量运行所有迭代所需的时间。运行可能只需要几秒钟，您将获得更好的计时数据。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2008-11-01T08:41:23.697

在考虑性能时，使用“操作次数”是个坏主意。它没有考虑每个操作的最佳情况/最坏情况循环计数之间的差异、缓存未命中、管道未命中、潜在（自动）并行化等的成本。

正如 Greg 所说，对于微基准测试来说，通常最好只运行相同的代码足够多次以获得相当长的时间跨度。

更好的是使用实际工作负载运行整个应用程序并测量您真正感兴趣的指标，但这是另一回事......

当然有用的是计算代码的*复杂**性*——知道一个方法什么时候会是 O(1)、O(log n)、O(n) 等。这通常不涉及知道什么的细节C++ 中的各个指令都可以 - 尽管您*确实*需要知道您调用的任何内容的复杂性。（乔尔关于[画家施莱米尔和斯特伦](http://www.joelonsoftware.com/articles/fog0000000319.html)的故事是最明显的例子。）

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T15:37:10.147

样本分析器在这里是一个不错的选择。在 Windows 上，您可以使用[内置于 Visual Studio 的分析器](http://blogs.msdn.com/profiler/)，或来自 Windows 组织的[xperf 工具。](http://msdn.microsoft.com/en-us/performance/default.aspx)xperf 工具是免费的。这是我本人关于 xperf 工具的[系列文章。](http://blogs.msdn.com/pigscanfly/pages/xperf-articles.aspx)[这是关于 profiling](http://blogs.msdn.com/pigscanfly/archive/2008/03/02/using-the-windows-sample-profiler-with-xperf.aspx)的。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T15:50:24.550

生成装配和计数操作。然后查看您的处理器使用的周期/操作。*然后*记住你正在开发一个先发制人的操作系统，而且这些都不是有效的。

更严重的是，提升你的*n*并将你的程序缩放到淫秽的大小。这将使您了解您的程序速度。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T17:27:08.160

在 Linux 上使用 valgrind。它具有指令级时序，包括缓存分析。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T19:55:52.930

您可以通过读取 CPU 的时间戳计数器 ( **tsc** ) 进行精确测量，该计数器在每个 cpu 时钟加一。

不幸的是，读取是在代码中内联一些汇编指令完成的。根据底层架构，读取成本在 ~11(AMD) 和 ~33(Intel) **tsc**之间变化。使用 1 Ghz CPU，您几乎可以拥有纳秒级的精度。

为了对一段代码执行可靠且非侵入性的测量，您可以：

*   通过禁用诸如*AMD cool'n quiet*或*Intel SpeedStep*之类的 cpu 功能来防止 cpu 缩放频率。

*   重复测试几次，将测量值收集到一个数组中，然后将数据保存到文件中以供离线分析。

*   为被测进程选择实时调度策略，例如**SHED_RR**或**SHED_FIFO**。实时策略减少了被测进程与其他被阻塞的正常进程/内核线程之间的上下文切换次数。

*   通过 mlockall() 系统调用将所有进程的虚拟地址空间锁定在 RAM 中。

[在这里](http://web.archive.org/web/20090107031753/http://awgn.antifork.org/codes++/arch-cpu.hh)，您可以找到我为 Linux 编写的准可移植 C++ 类，它源自 Linux 内核，旨在读取 i386、x86_64 和 ia64 架构的 tsc。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T15:56:44.380

如果您想要来自硬件的实际操作计数，那么您可能需要考虑安装像[PAPI](http://icl.cs.utk.edu/papi/) - Performance API 这样的包 - 它适用于许多不同的操作系统和处理器组合。它使用实际的硬件计数器并报告许多不同性能指标的直接值或派生值，例如 Total Ops、FLOPS、缓存命中/未命中等。它还可以访问更高分辨率的计时器。

这不是有史以来最简单的软件包，但报告级别确实可以帮助您分析应用程序在硬件上的行为。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T15:34:42.600

使用更高分辨率的计时器。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-11-02T11:16:33.603

为什么不直接在分析器下运行代码？这通常会为您提供有关函数花费了多少时间以及调用它们的次数的数据。

知道一个函数被调用了多少次是很有用的，因为它可以让你发现潜在的性能问题，如果一个函数被调用的频率远远超过你认为应该的频率。

当然，使用分析器会使您的代码变慢，但在添加任何类型的检测时这是不可避免的。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2008-11-02T12:37:07.840

如果您想要在不使用分析器的情况下精确计时（在 Windows 上），您可以查看[这个线程](https://stackoverflow.com/questions/61278/quick-and-dirty-way-to-profile-your-code)，它提供了分析 C++ 代码的不同方法。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2008-11-04T21:51:02.557

如果您担心让程序尽可能快地运行，并且它是单线程的，并且您使用的是 IDE，请查看： 
[如何优化程序的性能](http://www.wikihow.com/Optimize-Your-Program%27s-Performance)

# c# - 如何在 .NET 中启用程序集绑定失败日志记录 (Fusion)

> ID：255669
> 
>         
> 
> 赞同：880
> 
>         
> 
> 时间：2008-11-01T08:58:30.200
> 
>         
> 
> 标签：c#, .net, vb.net, binding, assemblies

如何在 .NET 中启用程序集绑定失败日志记录 (Fusion)？

* * *

## 回答 #1

> 赞同：937
> 
>             
> 
> 时间：2009-10-06T18:23:54.280

将以下值添加到

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Fusion
添加：
DWORD ForceLog 设置值为 1
DWORD LogFailures 将值设置为 1
DWORD LogResourceBinds 设置值为 1
DWORD EnableLog 设置值为 1
String LogPath 设置日志文件夹的值（例如 C:\FusionLog\）

```

确保在文件夹名称后**包含反斜杠**并且该**文件夹存在**。

您需要重新启动正在运行的程序以强制它读取这些注册表设置。

顺便说一句，不要忘记在不需要时关闭融合日志记录。

[![在此处输入图像描述](https://i.stack.imgur.com/hcled.jpg)](https://i.stack.imgur.com/hcled.jpg)

* * *

## 回答 #2

> 赞同：294
> 
>             
> 
> 时间：2010-07-15T14:49:48.717

我通常使用 Fusion Log Viewer（[Visual Studio 命令提示符](https://docs.microsoft.com/en-us/dotnet/framework/tools/developer-command-prompt-for-vs)中的[Fuslogvw.exe](https://docs.microsoft.com/en-us/dotnet/framework/tools/fuslogvw-exe-assembly-binding-log-viewer)或开始菜单中的 Fusion Log Viewer）——我的标准设置是：

*   以管理员身份打开 Fusion Log Viewer

*   点击**设置**

*   选中**启用自定义日志路径**复选框

*   输入您希望将日志写入的位置，例如`c:\FusionLogs`（**重要提示：**确保您已在文件系统中实际创建了此文件夹。）

*   确保打开了正确的日志记录级别（我有时只是选择**记录所有绑定到磁盘**只是为了确保一切正常）

*   点击**确定**

*   将日志位置选项设置为**自定义**

完成后记得关闭注销！

（我刚刚在一个类似的问题上发布了这个 - 我认为它在这里也很相关。）

* * *

## 回答 #3

> 赞同：196
> 
>             
> 
> 时间：2010-05-19T08:26:46.220

如果您的机器上安装了 Windows SDK，您将在 Microsoft SDK\Tools 下找到“Fusion Log Viewer”（只需在 Vista 或 Windows 7/8 的开始菜单中键入“Fusion”）。启动它，单击“设置”按钮，然后选择“记录绑定失败”或“记录所有绑定”。

如果这些按钮被禁用，请返回开始菜单，右键单击日志查看器，然后选择“以管理员身份运行”。

* * *

## 回答 #4

> 赞同：98
> 
>             
> 
> 时间：2015-10-08T10:26:24.200

您可以以管理员身份运行此 Powershell 脚本来启用 FL：

```
Set-ItemProperty -Path HKLM:\Software\Microsoft\Fusion -Name ForceLog         -Value 1               -Type DWord
Set-ItemProperty -Path HKLM:\Software\Microsoft\Fusion -Name LogFailures      -Value 1               -Type DWord
Set-ItemProperty -Path HKLM:\Software\Microsoft\Fusion -Name LogResourceBinds -Value 1               -Type DWord
Set-ItemProperty -Path HKLM:\Software\Microsoft\Fusion -Name LogPath          -Value 'C:\FusionLog\' -Type String
mkdir C:\FusionLog -Force 
```

这个要禁用：

```
Remove-ItemProperty -Path HKLM:\Software\Microsoft\Fusion -Name ForceLog
Remove-ItemProperty -Path HKLM:\Software\Microsoft\Fusion -Name LogFailures
Remove-ItemProperty -Path HKLM:\Software\Microsoft\Fusion -Name LogResourceBinds
Remove-ItemProperty -Path HKLM:\Software\Microsoft\Fusion -Name LogPath 
```

* * *

## 回答 #5

> 赞同：89
> 
>             
> 
> 时间：2008-11-01T09:00:13.630

设置以下注册表值：

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Fusion!EnableLog] (DWORD) 为 1

要禁用，请设置为 0 或删除该值。

[编辑]：将以下文本以 Windows 注册表编辑器格式保存到文件，例如 FusionEnableLog.reg：

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Fusion]
"EnableLog"=dword:00000001 
```

然后从 Windows 资源管理器运行文件并忽略有关可能损坏的警告。

* * *

## 回答 #6

> 赞同：29
> 
>             
> 
> 时间：2019-05-09T21:39:14.180

[程序集绑定日志查看器 (FUSLOGVW.exe)有很多问题](https://stackoverflow.com/a/61012329/704281)，我决定编写一个名为[Fusion++ 的替代查看器并将其放在 GitHub 上](https://github.com/awaescher/Fusion)。**它在内部使用相同的机制**，但会为您解析日志。您根本不需要关心任何设置，甚至不需要记录路径

[您可以从这里](https://github.com/awaescher/Fusion/releases)或通过巧克力 ( `choco install fusionplusplus`)获取最新版本。

我希望你和这里的一些访客可以用它来节省一些有价值的终生时间。

[![融合++](https://i.stack.imgur.com/2uOEO.png)](https://i.stack.imgur.com/2uOEO.png)

* * *

## 回答 #7

> 赞同：20
> 
>             
> 
> 时间：2011-10-21T05:37:21.420

[Fusion Log Settings Viewer changer script](http://www.paraesthesia.com/archive/2004/10/20/fusion-log-viewer-settings-changer.aspx)是最好的方法。

在[ASP.NET](http://en.wikipedia.org/wiki/ASP.NET)中，有时很难让它正常工作。这个脚本效果很好，也被列在[Scott Hanselman 的电动工具列表](http://www.hanselman.com/blog/ScottHanselmans2011UltimateDeveloperAndPowerUsersToolListForWindows.aspx)中。我个人使用它已有多年，它从未让我失望。

* * *

## 回答 #8

> 赞同：14
> 
>             
> 
> 时间：2015-03-31T17:22:02.867

除了使用丑陋的日志文件，您还可以通过[ETW/xperf](https://msdn.microsoft.com/en-us/library/windows/hardware/hh448186.aspx)激活 Fusion 日志，方法是打开`Microsoft-Windows-DotNETRuntimePrivate`带有 GUID`763FD754-7086-4DFE-95EB-C01A46FAF4CA`和`FusionKeyword`关键字 (0x4) 的 DotnetRuntime Private 提供程序 ( )。

```
@echo off
echo Press a key when ready to start...
pause
echo .
echo ...Capturing...
echo .

"C:\Program Files (x86)\Windows Kits\8.1\Windows Performance Toolkit\xperf.exe" -on PROC_THREAD+LOADER+PROFILE -stackwalk Profile -buffersize 1024 -MaxFile 2048 -FileMode Circular -f Kernel.etl
"C:\Program Files (x86)\Windows Kits\8.1\Windows Performance Toolkit\xperf.exe" -start ClrSession -on Microsoft-Windows-DotNETRuntime:0x8118:0x5:'stack'+763FD754-7086-4DFE-95EB-C01A46FAF4CA:0x4:0x5 -f clr.etl -buffersize 1024

echo Press a key when you want to stop...
pause
pause
echo .
echo ...Stopping...
echo .

"C:\Program Files (x86)\Windows Kits\8.1\Windows Performance Toolkit\xperf.exe" -start ClrRundownSession -on Microsoft-Windows-DotNETRuntime:0x8118:0x5:'stack'+Microsoft-Windows-DotNETRuntimeRundown:0x118:0x5:'stack' -f clr_DCend.etl -buffersize 1024 

timeout /t 15

set XPERF_CreateNGenPdbs=1

"C:\Program Files (x86)\Windows Kits\8.1\Windows Performance Toolkit\xperf.exe" -stop ClrSession ClrRundownSession 
"C:\Program Files (x86)\Windows Kits\8.1\Windows Performance Toolkit\xperf.exe" -stop
"C:\Program Files (x86)\Windows Kits\8.1\Windows Performance Toolkit\xperf.exe" -merge kernel.etl clr.etl clr_DCend.etl Result.etl -compress
del kernel.etl
del clr.etl
del clr_DCend.etl 
```

[现在，当您在PerfView](http://www.microsoft.com/en-us/download/details.aspx?id=28567)中打开 ETL 文件并查看 Events 表时，您可以找到 Fusion 数据：

[![PerfView 中的融合事件](https://i.stack.imgur.com/eccjZ.png)](https://i.stack.imgur.com/eccjZ.png)

* * *

## 回答 #9

> 赞同：6
> 
>             
> 
> 时间：2019-05-08T15:46:15.033

对于那些有点懒惰的人，我建议您将其作为 bat 文件运行，以便在您想要启用它时使用：

```
reg add "HKLM\Software\Microsoft\Fusion" /v EnableLog /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Microsoft\Fusion" /v ForceLog /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Microsoft\Fusion" /v LogFailures /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Microsoft\Fusion" /v LogResourceBinds /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Microsoft\Fusion" /v LogPath /t REG_SZ /d C:\FusionLog\

if not exist "C:\FusionLog\" mkdir C:\FusionLog 
```

* * *

## 回答 #10

> 赞同：4
> 
>             
> 
> 时间：2013-07-18T15:03:37.500

只是一点点可能对其他人有所帮助的信息；如果您按照在某个目录中搜索所有程序集以查找继承/实现类/接口的类的方式执行某些操作，那么如果您收到与您自己的程序集之一有关的此错误，请确保清除过时的程序集。

场景将类似于：

1.  程序集 A 在某个文件夹中加载所有程序集

2.  此文件夹中的程序集 B 已过时，但引用程序集 C

3.  程序集 C 存在，但命名空间、类名或其他一些细节可能在程序集 B 过时后发生了变化（在我的例子中，命名空间是通过重构过程更改的）

简而言之：A ---loads--> B (stale) ---references---> C

如果发生这种情况，唯一的标志是错误消息中的命名空间和类名。仔细检查它。如果您在解决方案中的任何地方都找不到它，则可能是在尝试加载过时的程序集。

* * *

## 回答 #11

> 赞同：3
> 
>             
> 
> 时间：2012-04-17T23:50:38.963

如果您已经启用了日志记录，但在 Windows 7 64 位上仍然出现此错误，请在 IIS 7.5 中尝试：

1.  创建一个新的应用程序池

2.  转到此应用程序池的高级设置

3.  将*启用 32 位应用程序*设置为*True*

4.  让您的 Web 应用程序使用这个新池

* * *

## 回答 #12

> 赞同：3
> 
>             
> 
> 时间：2018-10-27T15:31:11.797

以防万一您想知道 FusionLog.exe 的位置 - 您知道您拥有它，但找不到它？在过去的几年里，我一遍又一遍地寻找 FUSLOVW。迁移到 .NET 4.5 后，FUSION LOG 的版本数量激增。她是可以在磁盘上找到它的地方，具体取决于您安装的软件：

C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 Tools\x64

C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\x64

C:\Program Files (x86)\Microsoft SDKs\Windows\v8.1A\bin\NETFX 4.5.1 Tools\x64

C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 工具

C:\Program Files (x86)\Microsoft SDKs\Windows\v8.1A\bin\NETFX 4.5.1 工具

C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin

* * *

## 回答 #13

> 赞同：-1
> 
>             
> 
> 时间：2019-01-21T09:45:16.793

在我的情况下，帮助输入小写的磁盘名称

**错误**- C:\someFolder

**正确**- c:\someFolder

# windows - 静态 ARP 条目在 Windows Server 2003 中重新启动时消失

> ID：255672
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-11-01T15:29:57.507
> 
>         
> 
> 标签：windows, arp

我使用命令行“arp -s IP MAC”命令在 Windows Server 2003 上设置静态 ARP 条目。当我运行“arp -a”时，它作为“静态”条目存在。当我重新启动时，它就消失了。有没有像 lmhosts 这样的文件，我可以让它成为永久的？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2011-08-31T10:12:51.947

不需要在域中。可以做本地组策略，或者启动脚本。但是，我发现即使注销，静态条目也会消失

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T15:55:22.620

我不认为已经支持 ARP 条目的持久配置。但是，您应该能够创建一个每次都执行此操作的引导脚本。

在组策略中，转到计算机配置\Windows 设置\脚本，添加启动脚本。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T17:38:51.257

我有一个不在域中的 Windows Server 2003，因此上述答案不适用于我，尽管它确实适用于 AD 中的框。下面的 Autoexecnt.bat 脚本对我有用（也适用于 XP）：

[http://support.microsoft.com/kb/243486](http://support.microsoft.com/kb/243486)

# objective-c - 使用父初始化程序初始化对象 (init) 后尝试访问子类方法时应用程序崩溃

> ID：255679
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-11-01T15:36:14.033
> 
>         
> 
> 标签：objective-c, inheritance

我有一个继承 NSMutableArray 的类。

我使用以下方法初始化它：

> MyClass 类 = [MyClass arrayWithContentsOfFile:path];

当我尝试访问我的任何子类方法时，应用程序崩溃并出现以下错误：

> -[NSCFArray loadCards]：无法识别的选择器发送到实例 0x454a30
>    *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“*** -[NSCFArray > mymethod]：无法识别的选择器发送到实例 0x454a30”应用程序 [32259:20b] 堆栈：（ 2524995915,

我怀疑发生这种情况是因为 arrayWithContentsOfFile:path 返回 NSArray 而不是“MyClass”，因此它无法响应我的选择器。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T16:28:08.327

NSArray 是一个[类 cluster](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaObjects/chapter_3_section_9.html)。要在类集群中创建新的子类，您必须[实现其原始方法](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/Reference/Reference.html#//apple_ref/doc/uid/20000137-740830)。

如果您想要继承数组的*行为，那么使用 has-a 关系而不是 is-a 通常会更好。*也就是说，编写一个具有 NSArray 实例变量的类，并简单地将相关消息转发给它。

或者，如果你想为 NSArray 添加新的行为，你应该通过直接在[category](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/chapter_4_section_3.html)中的 NSArray 类中添加方法来实现。

本质上，如果您想为不同的存储机制提供 NSArray 接口，您基本上只想进行子类化，并且对于该工作，您无论如何都需要实现原始方法。

# sql-server-2005 - 使用服务器复制和客户端复制配置 SQL Server 2005

> ID：255680
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-11-01T15:36:17.497
> 
>         
> 
> 标签：sql-server-2005, replication

我需要设置这个场景：

> SQL Server 2005 数据库将从另一个数据库创建事务复制订阅以填充一组查找表。然后，这些查找表将作为合并复制发布发布到客户端的 SQL Server Mobile。

我记得在某处的 SQL Server 联机丛书中看到了类似的场景，但我再也找不到链接了。我希望有人可以帮助我找到它，或者以其他方式将我指向任何其他类似的链接。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-11-06T13:05:28.670

好的，我设法在[MSDN SQL Server Replication 论坛](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=4093478&SiteID=1&mode=1)上得到了我需要的答案。

我正在寻找的文章名为：[重新发布数据](http://msdn.microsoft.com/en-us/library/ms152553(SQL.90).aspx)。

显然，它位于“**配置和维护复制**”部分的“**高级复制功能和内部**结构”中。这有点不明显，所以我大部分时间都在查看“**在服务器和客户端之间复制数据**”部分，而不是那里。很高兴知道，因为那里似乎还有许多其他特殊情况值得一看。

 ***** * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-11-05T12:44:05.390

我没有兴趣使用事务复制来生成查找表。这样的表不是从客户端更新的，那么当你没有订阅者修改的数据时，为什么要结合事务+合并复制呢？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-11-06T08:55:43.993

也许最初的场景不清楚，所以让我澄清一下。

原始查找表位于远程网络连接不良或在重负载下运行的数据库。建议使用这种方法，以便将查找表复制到另一个数据库，该数据库将执行与客户端的所有合并复制。

当然，这可能不是解决我们问题的最合适的方法，所以如果有人有更好的想法，我们很想听听他们的意见。

尽管如此，这个问题的主要原因是找到一篇我之前找到的文章（但愚蠢地没有加入书签），它很好地描述了我们的场景。任何可能导致本文的内容（标题、作者、类似主题等）都绝对值得赞赏。

# math - 是否有用于从计数数据中学习 Dirichlet 先验的 R 包

> ID：255697
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-11-01T15:48:30.187
> 
>         
> 
> 标签：math, r, statistics, bayesian, dirichlet

我正在寻找一个`R`可用于从计数数据中训练 Dirichlet 的软件包。求一个在用的同事，`R`自己不用，所以不太清楚怎么找包。搜索起来有点困难，因为“R”是一个非特定的搜索字符串。[CRAN](http://cran.r-project.org/web/packages/index.html)上似乎没有任何东西，但是还有其他地方可以看吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T19:29:54.997

我只是顺便遇到了 R 和 Dirichlet 分布，所以我希望我不会太过分。

[此邮件列表消息](https://stat.ethz.ch/pipermail/r-help/2006-September/113258.html)似乎回答了您的问题：

> 滚动浏览 RSiteSearch("dirichlet") 的结果表明 VGAM 包中有一些有用的工具。gtools 包和 MCMC 包还具有 ddirichlet() 函数，可用于构造（负对数）似然函数并使用 optim/nlmin/etc 进行优化。

交易、DPpackage 和混合包也可能提供也可能不提供您需要的东西。

再说一次，这些仍然是 CRAN 包，所以我不确定你是否已经找到这些并且发现它们不合适。

至于搜索 R，[R 项目站点](http://www.r-project.org/)本身已经在[其搜索页面](http://www.r-project.org/search.html)上提供了一些链接。

# python - 如何在您自己的网络应用程序中实现 Google Suggest（例如使用 Python）

> ID：255700
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2008-11-01T15:50:30.320
> 
>         
> 
> 标签：python, autocomplete, autosuggest

在我的网站中，用户可以存储链接。

在指定字段中输入互联网地址期间，我想显示一个类似于 Google Suggest 或 Chrome Omnibar 的建议/自动完成框。

例子：

用户输入为 URL：

```
http://www.sta 
```

将显示的建议：

```
http://www.staples.com
http://www.starbucks.com
http://www.stackoverflow.com 
```

如何在不重新发明轮子的情况下实现这一目标？:)

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2008-11-01T15:58:31.600

您可以尝试使用
[http://google.com/complete/search?output=toolbar&q=keyword](http://google.com/complete/search?output=toolbar&q=keyword)

然后解析xml结果。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T20:59:34.003

我以前在 Django 服务器中做过一次。有两个部分 - 客户端和服务器端。

客户端您必须在用户键入时向服务器发送 XmlHttpRequests，然后当信息返回时，显示它。这部分需要大量的 javascript，包括一些棘手的部分，如回调和按键处理程序。

在服务器端，您必须处理 XmlHttpRequests，它包含用户迄今为止输入的内容。就像一个网址

```
www.yoursite.com/suggest?typed=www.sta 
```

然后以某种方式编码的建议做出回应。（我建议对建议进行 JSON 编码。）您还必须实际从数据库中获取建议，这可能只是一个简单的 SQL 调用或其他取决于您的框架的东西。

但是服务器端部分非常简单。我认为客户端部分更棘手。我发现这篇[文章](http://www.phpriot.com/articles/google-suggest-ajaxac)很有帮助

他用 php 写东西，但客户端的工作几乎是一样的。特别是您可能会发现他的 CSS 很有帮助。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-17T21:34:59.023

雅虎有一个很好的[自动完成控制](http://developer.yahoo.com/yui/autocomplete/)。

他们在[这里有一个样本。](http://developer.yahoo.com/yui/examples/autocomplete/ac_basic_array.html).

显然，这对您获取数据没有任何帮助 - 但看起来您有自己的来源，并且实际上并不希望从 Google 获取数据。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T19:00:16.523

如果您希望自动完成使用您自己数据库中的日期，您需要自己进行搜索并使用 AJAX 作为用户类型更新建议。对于搜索部分，您可能想查看[Lucene](http://lucene.apache.org/java/docs/)。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-03-17T22:05:48.000

该控件通常称为字轮。MSDN 最近有一篇[关于](http://msdn.microsoft.com/en-us/magazine/cc721610.aspx)使用`LINQ`. 有两个关键方面：延迟执行和惰性求值。文章也有源代码。

# hibernate - JPA / Hibernate在加入时选择列子集

> ID：255703
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-11-01T15:56:43.227
> 
>         
> 
> 标签：hibernate, jpa, join, mapping

在 SQL 中，很容易进行连接，并且只从连接表中返回您想要的列。在 JPA / Hibernate 中映射它的最佳方法是什么？

例如，有一个文件夹实体映射到 EMAIL_FOLDER，一个电子邮件实体映射到 EMAIL 表。从文件夹到电子邮件是一对多的关系。Email 实体相当重，因为它包含文本、附件等的 CLOB。在某些情况下，我们需要取回整个电子邮件，而在其他情况下，我们只想带回 senderName、subject 和 sentDate 以及不希望引入 CLOB 数据的内存开销。在 SQL 中实现这一点很简单，但我不确定在 JPA / Hibernate 中最好的方法是什么。

我正在考虑创建一个仅映射到 senderName、subject 和 sentDate 的 LightEmail。这是处理此类事情的最佳方法吗？

更新：此时我想尽可能避免使用字节码检测。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T16:38:14.250

将属性（CLOB）注释为`@Basic(fetch=FetchType.LAZY)` 

请参阅Hibernate 参考中的[声明基本属性映射](http://www.hibernate.org/hib_docs/annotations/reference/en/html_single/#entity-mapping-property)

# ruby - 将块放在一行上的语法

> ID：255714
> 
>         
> 
> 赞同：30
> 
>         
> 
> 时间：2008-11-01T16:04:21.370
> 
>         
> 
> 标签：ruby, syntax

所以我有一个像这样的Ruby方法：

```
def something(variable, &block)
  ....
end 
```

我想这样称呼它：

```
something 'hello' { do_it } 
```

除了这对我不起作用，我遇到了语法错误。如果我这样做，它会起作用：

```
something 'hello' do
  do_it
end 
```

除了那里我有点想念它在一条线上的漂亮外观。

我可以看到为什么会发生这种情况，因为它看起来像是作为第二个变量传递的哈希，但变量之间没有逗号......但我认为必须有一种方法来处理这个我'米失踪。有没有？

* * *

## 回答 #1

> 赞同：46
> 
>             
> 
> 时间：2008-11-01T17:20:17.380

你需要用括号括起来你的论点：

```
something('hello') { do_it } 
```

那应该行得通。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T16:22:22.877

如果你想让“def something”接受一个块，你需要向那个块产生数据。例如：

```
#to uppercase string
def something(my_input)
 yield my_input.upcase
end

# => "HELLO WORLD"
something("hello world") { |i| puts i} 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-11-02T06:33:46.403

呃，怎么样：

```
>> def something(arg1 , &block)
>>   yield block
>> end
=> nil
>> def do_it
>>   puts "Doing it!"
>> end
=> nil
>> something('hello') { do_it }
"Doing it!"
=> nil 
```

# linux - 什么是最好的邮件列表包？(Linux)

> ID：255715
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T16:04:50.917
> 
>         
> 
> 标签：linux, mailing-list

我们需要一个类似于[Python Mailman](http://www.gnu.org/software/mailman/index.html)的邮件列表包。我会使用 Mailman，除了一件事：我们想将订阅者列表链接到 MySQL 数据库中的一个表。除了通过电子邮件界面外，我们希望人们能够直接从我们的网站选择加入/退出和控制交付选项。我认为 Mailman 没有一种简单的方法可以链接到 MySQL 表。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T16:23:57.617

这些帖子中的任何一个都回答了这个问题吗？

[GNU Mailman 的简单/轻量级替代品？](https://stackoverflow.com/questions/66677/simplelightweight-alternative-to-gnu-mailman)

[LISTSERV 有 API 吗？](https://stackoverflow.com/questions/203453/does-listserv-have-an-api)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T18:36:08.397

有一个 MySQL 成员适配器

[https://sourceforge.net/tracker/?func=detail&atid=300103&aid=839386&group_id=103](https://sourceforge.net/tracker/?func=detail&atid=300103&aid=839386&group_id=103)

我没有尝试过，从自述文件看来，你需要一些 Python 专业知识才能使用它，但是，其他成功使用它的人在跟踪器中也有评论。

# testing - XSS 酷刑测试 - 它存在吗？

> ID：255723
> 
>         
> 
> 赞同：18
> 
>         
> 
> 时间：2008-11-01T16:10:20.110
> 
>         
> 
> 标签：testing, xss, user-input

我正在寻找编写一个 html 清理程序，显然为了测试/证明它可以正常工作，我需要一组 XSS 示例来反对它，看看它是如何执行的。这是[来自 Coding Horror 的一个很好的例子](http://www.codinghorror.com/blog/archives/001167.html)

```
<img src=""http://www.a.com/a.jpg<script type=text/javascript 
src="http://1.2.3.4:81/xss.js">" /><<img 
src=""http://www.a.com/a.jpg</script>" 
```

我知道有一个[Mime Torture Test](http://sourceforge.net/project/showfiles.php?group_id=32721&package_id=98949)，其中包含几个嵌套的电子邮件，其中包含用于测试 Mime 解码器的附件（如果它们可以正确解码，那么它们已被证明有效）。我基本上是在寻找 XSS 的等价物，即我可以扔给我的消毒剂的狡猾 html 的示例列表，以确保它可以正常工作。

如果有人也有任何关于如何编写消毒剂的好资源（即人们尝试使用的常见漏洞等），他们也会受到感激。

提前致谢 ：-）

编辑：抱歉，如果之前不清楚，但我经过了一系列折磨测试，所以我可以为消毒剂编写单元测试，而不是在浏览器中测试它等等。理论上源数据可能来自任何地方 -不仅仅是一个浏览器。

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2008-11-01T16:27:25.583

看看这个 XSS 作弊列表：[https ://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet](https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet)

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2008-11-01T16:29:12.507

[XSS Me](https://addons.mozilla.org/en-US/firefox/addon/7598)是一个很棒的 Firefox 插件，你可以在你的 sanitizer 上运行。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T16:33:37.787

查看[OWASP](http://www.owasp.org/index.php/Main_Page)。他们对 XSS 的工作原理、寻找什么，甚至[WebGoat](http://www.owasp.org/index.php/Category:OWASP_WebGoat_Project)项目都有很好的指导，您可以在其中尝试在易受攻击的网站上动手。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T16:37:20.447

您可以尝试 Jesse Ruderman 的 jsfunfuzz ( [http://www.squarefree.com/2007/08/02/introducing-jsfunfuzz/](http://www.squarefree.com/2007/08/02/introducing-jsfunfuzz/) )，它会在您的 Javascript 中抛出随机数据以试图破坏它。Firefox 团队似乎在使用它方面取得了巨大成功。

# asp.net - 将数据保留在会话中与在回发时填充

> ID：255728
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-11-01T16:19:25.240
> 
>         
> 
> 标签：asp.net, session, dataset, postback, populate

什么是可取的，将数据集保持在会话中或在每次回发时填充数据集？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-11-01T16:26:10.017

这将取决于许多因素。如果您的会话在进程中或在状态服务器上，通常最好不要在会话内存中保留太多项目，因为它的可扩展性较低。

如果您的会话驻留在数据库中，最好只重新查询并重新填充数据集，除非查询的执行成本很高。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2008-11-04T01:18:36.587

不要使用会话！如果用户使用不同的请求打开第二个选项卡，则会话将被重用，结果将不是他/她期望的结果。您可以使用 ViewState 和 Session 的组合，但在诉诸缓存之前，您仍然可以测量在没有任何类型缓存的情况下您可以处理多少。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T16:27:20.670

这取决于您将执行此操作的程度以及会话数据在服务器上的存储位置。

将数据集保持在会话中肯定会影响**内存使用**。所有会话变量都存储在内存中，如果您使用 SQL Server 状态，则存储在 SQL Server 中。您还可以使用 State Server 模式将负载卸载到另一台机器上。

序列化/反序列化方面。如果你使用非常大的数据集，它可能会严重影响服务器的 seide 性能。

另一方面，**在页面上拥有非常大的视图状态可能会成为真正的性能杀手**。因此，我会将数据集保存在会话或缓存中，并寻找一种“outproc”方式来存储该会话数据。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T16:47:25.013

由于我希望尽可能少的数据库操作，我会将数据保留在会话中，但我不确定什么是最好的方法。我如何处理并发，并且由于两个用户同时使用页面时共享数据，我如何确保他们每个人在会话中都有自己的数据集？

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T16:28:06.080

如果它不是太大和/或数据库又远又慢，我通常会保持它在会话中。如果数据很大，一般情况下最好重新加载。

有时我使用缓存，我第一次从 Db 加载并将其放入缓存中。在回发期间，我检查 chache，如果它是空的，我会重新加载。所以服务器自己管理缓存。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T17:00:41.180

会话的问题在于，如果它在 proc 中，它可能会消失，这不是很好，如果它是状态服务器，那么你必须序列化，如果它是 sql，那么你无论如何都要进行往返！

如果结果集很大，请执行自定义分页，以便您只返回总结果的一小部分。

然后，如果您认为多个用户会看到此结果集，请将每个页面作为用户页面放入缓存中，确保在数据更改或一段时间未访问时更新缓存。

如果您不想进行多次往返，并且您认为您已经拥有内存，那么将整个数据集放入缓存中，但要小心它不会破坏 Web 服务器。  

使用缓存意味着用户不需要自己的数据集，而是使用全局集。

就并发性而言，当您加载插入/编辑页面时，您需要用新数据填充它并在添加/更新后更新缓存。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-11-02T22:41:48.930

我非常相信解耦，而且我很少（如果有的话）认为需要将完整的数据集扔到用户界面上。

您实际上应该只将对象传递给需要使用的 UI，因此除非您显示大图或某种需要显示数据之间关系的数据结构，否则不值得付出代价。

如果适用，较小的数据子集效率要高得多。您的应用程序实际上是否使用了 UI 数据集中的所有功能？如果没有，那么最好的方法是只传递您正在显示的数据。

如果您将数据绑定到控件并通过它进行排序/分页等，您可以在更小的代码中实现许多使数据集能够支持这一点的接口。

关于这一点，我会在缓存中保留大部分静态的数据（例如，它不会经常更新）。因此，您需要查看数据的更新频率，然后才能真正做出决定。

最后，我再说一遍，我认为在 UI 中使用数据集的需求非常非常少。它是一个非常繁重的数据对象，查看数据需求的成本效益与实施的简易性相比，可能远远不够超过缓存数据集的需要。

恕我直言，如果您担心性能或内存利用率，那么使用数据集是相当糟糕的。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-11-03T01:27:03.183

您的回答并未暗示数据的使用。是参考数据吗？用户是否在积极更新它？是否意味着不止一位用户在任何时候都具有更新访问权限？

如果没有比您提供的更好的信息，请遵循公认的观点，即在会话中保留大量数据是一种保证您的应用程序*不会*扩展并且需要大量资源来为少数人服务的方法。

通常有更好的方法来管理大型数据集，而无需将所有数据加载到内存中。

如果做不到这一点，如果您的应用程序数据需求真的很庞大，那么请考虑使用带有 Web 服务后端的重型客户端。它可能比制作网页更适合。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2008-11-04T01:43:14.913

正如其他答案所指出的，答案“取决于”。但是，我假设您正在谈论用户之间共享的数据。在这种情况下，您不应*将*数据集存储在用户会话中，而应在回发时重新填充。

此外，您应该在应用程序的数据访问层附近填充缓存，以提高交互性能并减少数据库负载。缓存的设计将再次取决于数据的类型（只读 vs. 读/写 vs. read-mostly）。

这种方法将用户会话（UI 层概念）与数据管理分离，并提供支持共享使用缓存数据的额外好处（在数据在用户之间通用的情况下）。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T16:22:01.490

保持会话。如果需要，可以选择重新填充，例如，如果会话内存被擦除。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T16:27:35.037

也不——不要“保留”任何东西！仅显示用户需要查看的内容并构建有效的分页方案以向后或向前查看行。

rp

# c++ - 你能从 C++ 中调用 Ada 函数吗？

> ID：255741
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2008-11-01T16:28:04.130
> 
>         
> 
> 标签：c++, c, ada, cross-language

我是一个完整的 Ada 新手，虽然我在 HS 期间使用了 Pascal 2-3 年。

IIRC，可以从 C/C++ 调用 Pascal 编译函数。是否可以从 C++ 调用用 Ada 编写的过程和函数？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-11-01T16:59:28.763

根据this [old tutorial](http://www.ghs.com/download/whitepapers/ada_c++.pdf)，应该是可以的。

但是，正如[该线程](http://archives.devshed.com/forums/programming-132/problem-passing-in-out-parameter-from-c-to-ada-1023388.html)所示，您必须小心 Ada 函数的 c++ extern "C" 定义。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2017-01-24T02:40:09.153

这是使用 g++/gnatmake 5.3.0 的示例：

*注意：在 C++ 和 Ada 之间传递数据时要小心*

**ada_pkg.ads**

```
 package Ada_Pkg is
        procedure DoSomething (Number : in Integer);
        pragma Export (C, DoSomething, "doSomething");
    end Ada_Pkg; 
```

**ada_pkg.adb**

```
 with Ada.Text_Io;
    package body Ada_Pkg is
        procedure DoSomething (Number : in Integer) is
        begin
            Ada.Text_Io.Put_Line ("Ada: RECEIVED " & Integer'Image(Number));
        end DoSomething;
    begin
        null;
    end Ada_Pkg; 
```

**主文件**

```
 /*
    TO BUILD:
    gnatmake -c ada_pkg
    g++ -c main.cpp
    gnatbind -n ada_pkg
    gnatlink ada_pkg -o main --LINK=g++ -lstdc++ main.o
    */

    #include <iostream>

    extern "C" {
        void doSomething (int data);
        void adainit ();
        void adafinal ();
    }

    int main () {
        adainit(); // Required for Ada
        doSomething(44);
        adafinal(); // Required for Ada 
        std::cout << "in C++" << std::endl;
        return 0;
    } 
```

参考：

*   [https://gcc.gnu.org/onlinedocs/gnat_ugn/Building-Mixed-Ada-and-C_002b_002b-Programs.html#Building-Mixed-Ada-and-C_002b_002b-Programs](https://gcc.gnu.org/onlinedocs/gnat_ugn/Building-Mixed-Ada-and-C_002b_002b-Programs.html#Building-Mixed-Ada-and-C_002b_002b-Programs)

*   [http://www.ghs.com/download/whitepapers/ada_c++.pdf](http://www.ghs.com/download/whitepapers/ada_c++.pdf)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-09T17:54:52.150

这种事情一直在做。诀窍是告诉双方对例程使用“C”风格的调用协议。在 C++ 中，这是通过 extern "C" 声明完成的，而在 Ada 端，则使用 pragma Export ("C", ...

在您最喜欢的相应参考资源中查找这些内容以获取详细信息。注意指针和引用参数！

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-11-02T02:43:23.937

绝对有可能。在过去的五年里，我一直在研究一个混合了 C++ 和 Ada 的系统。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2011-01-06T23:39:04.370

是的。几年前，我写了一个简短的简单演示来证明这一点。有两个 DLL，一个用 C++ 编写，另一个用 Ada 编写。他们只是将常量添加到浮点值。两个应用程序，一个在 C++ 中，一个在 Ada 中，每个都使用 DLL。因此，从 Ada 调用/调用的 C++ 的所有可能组合都存在。一切都很好。这在 Windows 上是当时最新的版本；我不记得了，但可能已经在 Linux 或 BeOS 上运行了。

现在，如果我能从中找到源代码...

# vxworks - 关于 VxWorks 的良好信息来源？

> ID：255764
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T16:59:02.697
> 
>         
> 
> 标签：vxworks

我是 VxWorks 环境的新手，那里有什么好的信息来源吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-01-28T13:49:13.800

2本书帮助了我：

*   嵌入式系统的实时概念 ISBN-10：1578201241 ISBN-13：978-1578201242（基本 RT 概念，通用模式）

*   Tornado 和 VxWorks：手册中没有的内容 ISBN-10：3833410698 ISBN-13：978-3833410697

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-11-10T20:55:41.623

如果您的预算允许，我建议您参加 WindRiver 提供的课程之一。我的公司请来了他们的一位培训师在现场教授课程，效果非常好。他们提供了动手编程活动和大量信息。如果您不熟悉实时或嵌入式编程的概念，它们会提供必要的背景信息，即使您已经熟悉这些（就像我一样），也有大量针对 VxWorks 和 Workbench 的有用培训。我相信他们除了来公司外，也会组织自己的课程。  [课程安排](http://education.windriver.com/lmt/CLMSCATALOGSCHEDULE.prMain?in_sessionId=&in_portId=0&in_folderName=North%20America)

# data-structures - 在 MainFrame（或主对话框）和模态对话框之间传递数据的最佳方式是什么？

> ID：255771
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T17:02:09.490
> 
>         
> 
> 标签：data-structures, oop, interface-design

我需要一个模式对话框来收集一些用户输入。然后，我需要应用程序 MainFrame 使用相同的数据。

通常我的模态对话框会有一个指向某个 DataType 的指针，它能够存储我需要的内容，并且我会通过 MainFrame 的引用传递这个对象，以便能够在用户关闭模态对话框后恢复数据。

这是传递数据的最佳方式吗？

感觉不太对！

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T17:18:18.180

因为一旦用户关闭了对话框（大概是在 DialogResult.OK 上），您正在传递数据，您可以轻松地执行此操作而无需 MainFrame 引用。

因此，假设您的对话框中有一个名为 userNameTextBox 的 TextBox 和一个以 OK 结果结束对话框的按钮。您可以将 userNameTextBox 设为公开（不推荐）或添加属性以返回文本。

```
public string UserName
{
    get { return userNameTextBox.Text; }
} 
```

要在对话结束后获取此值，您只需执行以下操作：

```
Dialog dialog = new Dialog();
if (dialog.ShowDialog() == DialogResult.OK)
{
    string username = dialog.UserName;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T18:51:35.463

从用户那里收集一两个值时，@Samuel 的建议是完全足够的。

如果您获得许多值，那么您问题中的解决方案也很好。

不要成为过早优化和过度设计解耦解决方案的牺牲品。通过边界对象，我假设您指的是大型机和对话框引用的数据结构实例。对话框和大型机都引用这个对象有什么问题？在这种情况下解耦边界/传输对象有什么好处？

我在这里可以看到的唯一解耦收益是将大型机与向其提供数据的特定实现解耦。因此，不是大型机实例化 Dialog 并调用 Dialog.ShowModal，依赖注入将为大型机提供一个 IDataYouNeedGetter（这恰好是同一个模态对话框），并且在适当的时候大型机会这样做

```
myGetter.SetTransferObject(dataStructInstance)
myGetter.GoGetTheData()
// do stuff with dataStructInstance now that myGetter set it up. 
```

但是，除非您已经知道解耦的特定需求，否则没有理由添加间接层。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T17:05:52.727

通常您可以使用单个类或其他数据类型来传输数据。所以对话框是用来改变类的属性的。为什么感觉不对？

[幽默] 对于大型机，我认为您指的不是大型旧计算机（尽管还活着并且还在运转）。否则，我认为 TCP/IP 将是一个不错的选择。[/幽默]

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T17:10:41.923

执行此操作的最佳方法是将数据打包到事件中并在事件总线上发送出去。

这将对话框与大型机分离 - 如果您正确设计事件，它不会限制您仅使用对话框。

根据语言和环境的不同，这个事件系统可以很容易且廉价地实现。我称我的版本类为基于对象间通信。

# c++ - 哪些 C/C++ 编译器可用于 VxWorks？

> ID：255773
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-11-01T17:02:31.300
> 
>         
> 
> 标签：c++, c, vxworks

我是 VxWorks 环境的新手，我想知道 VxWorks 可以使用哪些 C 和 C++ 编译器？

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2008-11-01T18:50:04.500

有两个：gcc和diab。它们将随您的 WindRiver 平台一起提供（例如“通用平台 3.6”）。gcc 由 WindRiver（和/或 CodeSourcery）修改以与 VxWorks 一起使用。

现在使用 VxWorks 6.9 有第三种选择：Intel C++ 编译器（仅适用于 Intel 目标架构，32 位和 64 位）——diab 不会针对 64 位

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-11-07T10:12:37.380

[Greenhills](http://www.ghs.com)开发工具过去也支持 VXWorks 环境。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2019-08-07T17:20:59.340

除了惯用的 Diab（“Wind River Compiler”）和 GNU，VxWorks 6.9 还添加了 Intel C Compiler（ICC），但 ICC 似乎已从版本 7 中删除。

VxWorks 版本 7 添加了 LLVM/Clang。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T17:06:13.850

据我所知 Tornado VxWorks IDE 使用 gcc 工具链。

我建议以任何方式使用 WindRiver 提供的编译器（我相信他们的 gcc 版本）以避免兼容性问题。可能值得一提的是您想到的 VxWorks 版本。

我猜 gcc 版本将取决于 VxWorks 版本，并且可能取决于目标平台。

# javascript - 是否存在用于动态更改浏览器中正在运行的 javascript 的工具？

> ID：255785
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-11-01T17:13:49.263
> 
>         
> 
> 标签：javascript, dynamic-data

是否存在用于动态更改浏览器中正在运行的 javascript 的工具？例如，在运行时更改 javascript 变量的值。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-11-01T17:34:16.057

因此，Firebug 确实是最好的选择之一——或者，如果您是拥有 Visual Studio 并希望使用 IE 进行调试的开发人员，您可以这样做。假设您将使用 Firefox 使用 Firebug 执行此操作。

首先，确定要更改代码的位置，并将以下行放在要开始弄乱的行*之前：*

```
debugger; 
```

这将导致 Firebug 在该点停止脚本的执行，此时您可以单步执行代码并更改变量的值。

您也可以使用 Firebug 来放置断点，方法是在 Firebug 的脚本窗口中单击一行代码的左侧：

![Firebug 断点截图](https://i160.photobucket.com/albums/t162/JasonBunting/FirebugBreakpoint-1.gif)

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T17:16:11.273

Firebug 或 Venkman Javascript 调试器。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T17:28:23.010

[在这里](http://www.squarefree.com/shell/)查看 javascript shell 。它就像浏览器中的调试器。您可以在活动文档对象上运行/更改任何 javascript 函数。

在您无法访问源/服务器的站点上调试/处理其他人的 javascript 非常好用。

我有没有提到它有制表符完成？这很棒。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T17:59:26.753

[Opera 9 现在与Dragonfly](http://www.opera.com/products/dragonfly/) （FireBug 等价物）捆绑在一起，我知道它也可以动态编辑 JavaScript。无论如何，如果他们没有时间包含它，它至少是一个功能。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T17:16:56.200

看看[萤火虫](https://addons.mozilla.org/firefox/addon/1843)

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T17:35:36.023

正如其他人所提到的，Firebug 允许您在 JavaScript 中设置断点（尽管当我的 JavaScript 在 HTML 文档中而不是外部文件中时，我在命中断点方面没有取得很大成功），这将在期间中断函数的执行运行。

它还允许您查看 DOM 对象和所有属性（包括您的 JavaScript 变量）。

还有一个[精简版的 Firebug](http://getfirebug.com/lite.html)，可以在非 Firefox 浏览器中运行。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T18:37:43.340

Mozdev 有一个名为[MozREPL](http://hyperstruct.net/projects/mozrepl)的工具。您不仅可以即时更改和重新定义代码，还可以访问底层浏览器代码。这真的很酷。

它在 yoru 计算机 amnmd 上打开了一个端口，您可以将 telnet 会话（仅从本地主机）附加到它以开始执行代码。您还可以将该端口打开到不是来自本地主机的连接......（但请注意，这是非常不安全和危险的，等等）。

它带有一个 emacs 次要模式，可让您将各种文本区域直接发送到 mozdev，并提供非常好的交互模式。我进一步扩展它以直接从 emacs 设置 Firebug 断点，并启动 selenium 测试。基本上我可以从我的编辑器编写我的浏览器。它太酷了。在不久的某个时候，我将发布源代码。

* * *

## 回答 #8

> 赞同：-3
> 
>             
> 
> 时间：2008-11-01T17:20:28.847

JavaScript 有一个[eval](http://www.w3schools.com/jsref/jsref_eval.asp) () 函数，你可以构建你的字符串然后运行它。

```
<script type="text/javascript" language="javascript">
  example = function() {alert('first');}
  example();
  eval("example = function() {alert('second');}");
  example();
</script> 
```

上面的代码是如何使用 eval 更改现有代码的示例。

@eyelidlessness，这表明您*可以*更改现有代码。您对问题的编辑澄清了原始问题，但因此使我的答案看起来无效，但在最初发布时它是一个有效点，原始发帖人应该使问题更清楚。

# database - 消息系统中针对表的队列

> ID：255794
> 
>         
> 
> 赞同：18
> 
>         
> 
> 时间：2008-11-01T17:20:59.390
> 
>         
> 
> 标签：database, queue, message-queue

**在实际生产环境**中，我一直在体验消息传递系统的优点和缺点，我必须承认，一个组织良好的表或表模式每次都比任何其他形式的消息队列都要好，因为：

1.  数据永久存储在表中。我见过很多 java (jms) 应用程序由于未捕获的异常或其他错误而在途中丢失或消失消息。

2.  队列往往会被填满。相反，数据库存储实际上是无限的。

3.  表格很容易访问，而您必须使用深奥的工具从队列中读取。

您对每种方法有何看法？

* * *

## 回答 #1

> 赞同：35
> 
>             
> 
> 时间：2008-11-03T12:10:06.100

*每次都跳动*这句话完全取决于您的要求。当然，它不会每次都击败每个人。

如果您正在构建一个已经在使用数据库的单个系统，那么您没有非常高的性能吞吐量要求并且您不必与任何其他团队或系统进行通信，那么您可能是对的。

对于简单、低吞吐量、主要是单线程的东西，数据库是消息队列的完全替代品。

消息队列的亮点在于何时

*   你想要一个高性能、高并发和可扩展的负载均衡器，这样你就可以在许多服务器/进程上同时处理每秒数万条消息（使用数据库表，你很幸运每秒可以处理几百个并处理多个线程非常困难，因为一个进程往往会锁定消息队列表）

*   您需要使用不同的数据库在不同的系统之间进行通信（因此不必将系统数据库的写访问权限分发给不同团队中的其他人等）

对于具有单个数据库、团队和相当适中的性能要求的简单系统 - 请务必使用数据库。为工作使用正确的工具等。

然而，消息队列在大型组织中大放异彩，那里有许多需要相互通信的系统（因此您不希望业务数据库成为故障的中心点或版本地狱的地方），或者当您有高性能要求。

就性能而言，消息队列总是胜过数据库表——因为消息队列是专门为这项工作设计的，不依赖于悲观表锁（这是数据库实现队列所必需的——进行负载平衡）并且[好的消息队列会执行预先加载消息到队列以避免数据库的网络开销](http://activemq.apache.org/what-is-the-prefetch-limit-for.html)。

同样——你永远不会使用数据库在你的 Web 服务器上对 HTTP 请求进行负载平衡——因为它太慢了——如果你对负载平衡器有很高的性能要求，你也不会使用数据库。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2008-11-01T17:44:21.123

我首先使用了表，然后在（如果）有原因时重构为一个成熟的 msg 队列 - 如果您的设计合理，这将是微不足道的。

最大的好处是 a.) 它更容易，(b. 这是一个更好的审计跟踪，因为您有其他表要加入，c.) 如果您非常了解数据库工具，它们比 Message Queue 工具更容易使用, d.) 在您的应用程序已经存在的上下文中设置测试/开发环境通常会更容易一些（如果同样熟悉的话）。

哦，还有 e.) 也许对于您和其他人来说，它不是另一个需要学习、安装、配置、管理和支持的产品。

IMPE，它同样可靠，可断开连接，如果需要更多可扩展性，您可以转换。

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2008-11-01T18:51:57.333

1.  数据永久存储在表中。我见过很多 java (jms) 应用程序在它们的途中因未捕获的异常或其他错误而丢失或消失消息。

    哪个 JMS 实现？Sun 销售不会丢失消息的可靠队列。也许您刚刚购买了符合 JMS 标准的俗气产品。IBM 的 MQ 非常可靠，并且有 JMS 库可以访问它。

2.  队列往往会被填满。相反，数据库存储实际上是无限的。

    嗯...如果您的队列已满，听起来好像有什么东西坏了。如果您的应用程序崩溃，那不是一件好事，队列与此关系不大。如果您购买了一个非常糟糕的 JMS 实现，我可以看到您可能对它不满意的地方。这是一个竞争激烈的市场。寻找更好的队列管理器。Sun 的 JCAPS 有一个非常好的队列管理器，以前是 SeeBeyond 消息队列。

3.  表格很容易访问，而您必须使用深奥的工具从队列中读取。  

    这不符合我的经验。表是通过这种特殊的“其他语言”(SQL) 访问的，并且要求我了解从表到对象的结构映射以及从 VARCHAR2 到字符串的数据类型映射。此外，我必须使用某种访问层（JDBC 或使用 JDBC 的 ORM）。这看起来非常非常复杂。使用简单的发送和接收通过 MessageConsumers 和 MessageProducers 访问队列。

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2008-11-01T21:03:02.563

听起来您遇到的问题似乎不是消息传递所固有的，而是消息传递系统实现不善的产物。构建消息系统是否比构建数据库系统更难？是的，如果您所做的只是构建数据库系统。

*   将消息丢失给未捕获的异常？这几乎不是消息队列的错。您使用的应用程序设计不佳。他们在处理完成之前从队列中删除消息。他们没有使用交易或日记。  

*   数据库存储“几乎无限”时消息队列已满？你说的好像管理磁盘空间是数据库不需要的东西。消息队列服务器需要管理，就像数据库服务器一样。

*   从队列中读取的深奥仪器？也许如果您发现异步方法深奥。也许如果您发现序列化和反序列化深奥。（至少，这些是我在学习消息传递时发现的深奥的东西。就像许多看似深奥的技术一样，一旦你理解它们，它们实际上就很平凡，而理解它们是经验丰富的开发人员教育的重要组成部分。）

使其优于数据库的消息传递方面：

*   **异步处理。**  当新消息到达时，消息队列会通知等待进程。要在数据库中完成此功能，等待进程必须轮询数据库。

*   **关注点分离。**  通信通道与消息内容的实现细节分离。只有发送者和接收者需要知道给定消息中数据流的格式。

*   **容错。**. 当服务器之间的连接断断续续时，消息传递可以发挥作用。消息队列可以在本地存储消息，并且仅在连接处于活动状态时将它们转发到远程服务器。

*   **系统集成。**  至少在 Windows 世界中，消息传递是内置在操作系统中的。它使用操作系统的安全模型，通过操作系统的工具等进行管理。

如果您不需要这些东西，则可能不需要消息传递。

这是消息传递应用程序的一个简单示例：我现在正在构建一个系统，其中分布在多个网络中的用户正在输入用于产生打印输出的相当复杂的事务集。输出生成的计算成本很高，并且不是其工作流程的一部分；即用户不在乎何时生成输出，只是它确实如此。

因此，我们将事务序列化为消息并将其放入队列中。在服务器上运行的进程从队列中获取消息，生成输出，并将输出存储在成像系统中。

如果我们使用数据库作为我们的消息存储，我们必须想出一个模式来存储目前只有发送者和接收者关心的事务格式，我们需要确保网络上的每个工作站都有永久的与数据库服务器的持久连接，我们将无法在多个服务器之间分配此事务负载，并且我们的输出服务器每天必须查询数据库数千次，等待是否有新的作业要处理。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T17:27:57.037

队列提供可靠的消息传递。队列的存储转发、断开连接的特性使其比数据库更具可扩展性，更不用说更健壮了。

队列不应该真正用于信息的永久存储——最好将它们视为临时收件箱，与数据库不同。

# state-machine - 用于状态机

> ID：255797
> 
>         
> 
> 赞同：68
> 
>         
> 
> 时间：2008-11-01T17:27:00.003
> 
>         
> 
> 标签：state-machine

我会在哪些编程领域使用状态机？为什么 ？我怎么能实现一个？

**编辑：**请提供一个实际的例子，如果它不是太多的要求。

* * *

## 回答 #1

> 赞同：89
> 
>             
> 
> 时间：2008-11-01T19:46:35.790

## 我会在哪些编程领域使用状态机？

使用状态机来表示一个（真实的或逻辑的）对象，该对象可以存在于有限数量的条件（“*状态*”）中，并根据一组固定的规则从一个状态前进到下一个状态。

## 为什么要使用状态机？

状态机通常是一种*非常*紧凑的方式来表示一组复杂的规则和条件，并处理各种输入。您会在内存有限的嵌入式设备中看到状态机。实施得好，状态机是自记录的，因为每个逻辑状态代表一个物理条件。与其程序等效项相比，状态机可以包含在*少量代码中，并且运行效率极高。*此外，管理状态更改的规则通常可以作为数据存储在表中，提供易于维护的紧凑表示。

## 我该如何实施？

简单的例子：

```
enum states {      // Define the states in the state machine.
  NO_PIZZA,        // Exit state machine.
  COUNT_PEOPLE,    // Ask user for # of people.
  COUNT_SLICES,    // Ask user for # slices.
  SERVE_PIZZA,     // Validate and serve.
  EAT_PIZZA        // Task is complete.
} STATE;

STATE state = COUNT_PEOPLE;
int nPeople, nSlices, nSlicesPerPerson;

// Serve slices of pizza to people, so that each person gets
/// the same number of slices.   
while (state != NO_PIZZA)  {
   switch (state)  {
   case COUNT_PEOPLE:  
       if (promptForPeople(&nPeople))  // If input is valid..
           state = COUNT_SLICES;       // .. go to next state..
       break;                          // .. else remain in this state.
   case COUNT_SLICES:  
       if (promptForSlices(&nSlices))
          state = SERVE_PIZZA;
        break;
   case SERVE_PIZZA:
       if (nSlices % nPeople != 0)    // Can't divide the pizza evenly.
       {                             
           getMorePizzaOrFriends();   // Do something about it.
           state = COUNT_PEOPLE;      // Start over.
       }
       else
       {
           nSlicesPerPerson = nSlices/nPeople;
           state = EAT_PIZZA;
       }
       break;
   case EAT_PIZZA:
       // etc...
       state = NO_PIZZA;  // Exit the state machine.
       break;
   } // switch
} // while 
```

**笔记：**

*   为简单起见，该示例使用`switch()`带有显式`case`/`break`状态的 a。在实践中，a`case`将经常“失败”到下一个状态。

*   为了便于维护大型状态机，每个状态机所做的工作都`case`可以封装在一个“worker”函数中。获取顶部的任何输入，`while()`将其传递给 worker 函数，并检查 worker 的返回值以计算下一个状态。

*   `switch()`为了紧凑，可以用函数指针数组替换整个。每个状态都由一个函数体现，该函数的返回值是指向下一个状态的指针。  *警告：*这可能会简化状态机或使其完全无法维护，因此请仔细考虑实现！

*   嵌入式设备可以实现为仅在发生灾难性错误时退出的状态机，之后它执行硬重置并重新进入状态机。

* * *

## 回答 #2

> 赞同：22
> 
>             
> 
> 时间：2008-11-01T20:00:28.243

已经有一些很好的答案。对于稍微不同的观点，考虑在更大的字符串中搜索文本。有人已经提到过正则表达式，这实际上只是一种特殊情况，尽管它很重要。

考虑以下方法调用：

```
very_long_text = "Bereshit bara Elohim et hashamayim ve'et ha'arets." …
word = "Elohim"
position = find_in_string(very_long_text, word) 
```

你将如何实施`find_in_string`？简单的方法是使用嵌套循环，如下所示：

```
for i in 0 … length(very_long_text) - length(word):
    found = true
    for j in 0 … length(word):
        if (very_long_text[i] != word[j]):
            found = false
            break
    if found: return i
return -1 
```

除了效率低下之外，*它还形成了一个状态机*！这里的状态有些隐藏；让我稍微重写一下代码，让它们更明显：

```
state = 0
for i in 0 … length(very_long_text) - length(word):
    if very_long_text[i] == word[state]:
        state += 1
        if state == length(word) + 1: return i
    else:
        state = 0
return -1 
```

这里的不同状态直接代表了我们搜索的单词中的所有不同位置。图中每个节点都有两个转换：如果字母匹配，则进入下一个状态；对于每个其他输入（即当前位置的每个其他字母），回到零。

这种轻微的重新制定有一个巨大的优势：现在可以使用一些基本技术对其进行调整以产生更好的性能。事实上，每一个高级字符串搜索算法（暂时不考虑索引数据结构）都建立在这个状态机之上并改进了它的某些方面。

* * *

## 回答 #3

> 赞同：13
> 
>             
> 
> 时间：2008-11-01T18:08:31.150

**什么样的任务？**

除了我所看到的任何任务之外，任何类型的解析都经常被实现为状态机。

**为什么？**

解析语法通常不是一项简单的任务。在设计阶段，绘制状态图来测试解析算法是相当普遍的。将其转换为状态机实现是一项相当简单的任务。

**如何？**

好吧，你只受到你的想象力的限制。

我已经看到它是用[case statements 和 loops](http://www.kirit.com/Implementing%20a%20state%20engine%20using%20instance%20behaviour)完成的。

我已经看到它使用[标签和 goto](http://backpan.perl.org/authors/id/D/DW/DWHEELER/FSA-Rules-0.05.readme)语句完成

我什至看到它是用代表当前状态的函数指针结构完成的。当状态改变时，一个或多个[函数指针](http://www.gamedev.net/reference/articles/article2116.asp)被更新。

我已经看到它只在代码中完成，其中状态的变化仅仅意味着你在不同的代码部分中运行。（没有状态变量和必要的冗余代码。这可以被证明为非常简单的排序，这仅对非常小的数据集有用。

```
int a[10] = {some unsorted integers};

not_sorted_state:;
    z = -1;
    while (z < (sizeof(a) / sizeof(a[0]) - 1)
    {
        z = z + 1
        if (a[z] > a[z + 1])
        {
            // ASSERT The array is not in order
            swap(a[z], a[z + 1];        // make the array more sorted
            goto not_sorted_state;      // change state to sort the array
        }
    }
    // ASSERT the array is in order 
```

没有状态变量，但代码本身就代表了状态

* * *

## 回答 #4

> 赞同：9
> 
>             
> 
> 时间：2008-11-01T18:06:28.457

[状态](http://en.wikipedia.org/wiki/State_pattern)设计模式是一种面向对象的方式，通过有限状态机来表示对象的状态。它通常有助于降低该对象实现的逻辑复杂性（嵌套的 if、许多标志等）

* * *

## 回答 #5

> 赞同：6
> 
>             
> 
> 时间：2008-11-01T17:31:26.407

大多数工作流可以实现为状态机。例如，处理休假申请或订单。

如果您使用的是 .NET，请尝试使用 Windows Workflow Foundation。您可以使用它非常快速地实现状态机工作流。

* * *

## 回答 #6

> 赞同：6
> 
>             
> 
> 时间：2008-11-01T17:43:02.123

如果您使用 C#，则任何时候编写迭代器块时，您都在要求编译器为您构建状态机（跟踪您在迭代器中的位置等）。

* * *

## 回答 #7

> 赞同：4
> 
>             
> 
> 时间：2008-11-01T22:05:42.983

这是一个经过测试和工作的状态机示例。假设您在串行流上（串行端口、tcp/ip 数据或文件是典型示例）。在这种情况下，我正在寻找一个特定的数据包结构，它可以分为三个部分，同步、长度和有效负载。我有三种状态，一种是空闲，等待同步，第二种是我们同步良好，下一个字节应该是长度，第三种状态是累积有效负载。

该示例是纯串行的，只有一个缓冲区，如此处所述，它将从坏字节或数据包中恢复，可能会丢弃数据包但最终会恢复，您可以执行其他操作，例如滑动窗口以允许立即恢复。这就是您所说的部分数据包被缩短然后一个新的完整数据包开始的地方，下面的代码不会检测到这一点，并且会丢弃部分数据包和整个数据包并在下一个数据包中恢复。如果您确实需要处理所有整个数据包，则滑动窗口可以将您保存在那里。

我一直使用这种状态机，无论是串行数据流、tcp/ip、文件 i/o。或者可能是 tcp/ip 协议本身，比如说你要发邮件，打开端口，等待服务器发送响应，发送 HELO，等待服务器发送数据包，发送数据包，等待回复，等等。基本上在这种情况下以及在下面的情况下，您可能正在等待下一个字节/数据包进入。要记住您在等待什么，还要重用等待您可以使用的东西的代码状态变量。与在逻辑中使用状态机的方式相同（等待下一个时钟，我在等待什么）。   

就像在逻辑中一样，您可能希望为每个状态做一些不同的事情，在这种情况下，如果我有一个良好的同步模式，我会将偏移量重置到我的存储中，并重置校验和累加器。数据包长度状态演示了您可能希望退出正常控制路径的情况。并非全部，事实上许多状态机可能会在正常路径中跳跃或循环，下面的一个几乎是线性的。

我希望这很有用，并希望在软件中更多地使用状态机。

测试数据有故意的问题，状态机可以从中恢复。在第一个好的数据包之后有一些垃圾数据，一个带有错误校验和的数据包，一个具有无效长度的数据包。我的输出是：

好数据包：FA0712345678EB 无效同步模式 0x12 无效同步模式 0x34 无效同步模式 0x56 校验和错误 0xBF 无效数据包长度 0 无效同步模式 0x12 无效同步模式 0x34 无效同步模式 0x56 无效同步模式 0x78 无效同步模式 0xEB 好数据包：FA081234567800EA 没有更多测试数据

尽管有坏数据，但仍提取了流中的两个好数据包。并对不良数据进行检测和处理。

```
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>

unsigned char testdata[] =
{
    0xFA,0x07,0x12,0x34,0x56,0x78,0xEB,  
    0x12,0x34,0x56,  
    0xFA,0x07,0x12,0x34,0x56,0x78,0xAA,  
    0xFA,0x00,0x12,0x34,0x56,0x78,0xEB,  
    0xFA,0x08,0x12,0x34,0x56,0x78,0x00,0xEA  
};

unsigned int testoff=0;

//packet structure  
// [0] packet header 0xFA  
// [1] bytes in packet (n)  
// [2] payload  
// ... payload  
// [n-1] checksum  
//  

unsigned int state;

unsigned int packlen;  
unsigned int packoff;  
unsigned char packet[256];  
unsigned int checksum;  

int process_packet( unsigned char *data, unsigned int len )  
{  
    unsigned int ra;  

    printf("good packet:");
    for(ra=0;ra<len;ra++) printf("%02X",data[ra]);
    printf("\n");
}  
int getbyte ( unsigned char *d )  
{  
    //check peripheral for a new byte  
    //or serialize a packet or file  

    if(testoff<sizeof(testdata))
    {
        *d=testdata[testoff++];
        return(1);
    }
    else
    {
        printf("no more test data\n");
        exit(0);
    }
    return(0);
}

int main ( void )  
{  
    unsigned char b;

    state=0; //idle

    while(1)
    {
        if(getbyte(&b))
        {
            switch(state)
            {
                case 0: //idle
                    if(b!=0xFA)
                    {
                        printf("Invalid sync pattern 0x%02X\n",b);
                        break;
                    }
                    packoff=0;
                    checksum=b;
                    packet[packoff++]=b;

                    state++;
                    break;
                case 1: //packet length
                    checksum+=b;
                    packet[packoff++]=b;

                    packlen=b;
                    if(packlen<3)
                    {
                        printf("Invalid packet length %u\n",packlen);
                        state=0;
                        break;
                    }

                    state++;
                    break;
                case 2: //payload
                    checksum+=b;
                    packet[packoff++]=b;

                    if(packoff>=packlen)
                    {
                        state=0;
                        checksum=checksum&0xFF;
                        if(checksum)
                        {
                            printf("Checksum error 0x%02X\n",checksum);
                        }
                        else
                        {
                            process_packet(packet,packlen);
                        }
                    }
                    break;
            }
        }

        //do other stuff, handle other devices/interfaces

    }
} 
```

* * *

## 回答 #8

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T17:37:36.970

状态机无处不在。状态机是通信接口中的关键，其中需要在接收到消息时对其进行解析。此外，在嵌入式系统开发中，由于严格的时序限制，我曾多次需要将一个任务分成多个任务。

* * *

## 回答 #9

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T18:29:51.250

许多数字硬件设计都涉及创建状态机来指定电路的行为。如果您正在编写 VHDL，它会出现很多。

* * *

## 回答 #10

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T17:38:54.580

QA 基础设施，旨在筛选或以其他方式运行被测过程。（这是我的特定经验领域；我为我的上一个雇主用 Python 构建了一个状态机框架，支持将当前状态推送到堆栈上，并使用各种状态处理程序选择方法，用于我们所有基于 TTY 的屏幕抓取工具） . 概念模型非常适合，因为通过 TTY 应用程序运行，它会经历有限数量的已知状态，并且可以移回旧状态（考虑使用嵌套菜单）。已发布（经上述雇主许可）；使用[Bazaar](http://bazaar-vcs.org/)检查`http://web.dyfis.net/bzr/isg_state_machine_framework/`是否要查看代码。

工单、流程管理和工作流系统——如果您的工单有一组规则来确定其在 NEW、TRIAGED、IN-PROGRESS、NEEDS-QA、FAILED-QA 和 VERIFIED（例如）之间的移动，那么您有一个简单的状态机。

构建小型、易于证明的嵌入式系统——交通灯信号是一个关键示例，其中必须完全枚举和了解所有可能状态的列表*。*

解析器和词法分析器在很大程度上是基于状态机的，因为确定流入的方式取决于您当时所处的位置。

* * *

## 回答 #11

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T18:24:29.857

[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)是有限状态机（或“有限状态自动机”）发挥作用的另一个例子。

编译的正则表达式是一个有限状态机，正则表达式可以匹配的字符串集正是有限状态自动机可以接受的语言（称为“正则语言”）。

* * *

## 回答 #12

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T18:33:18.060

FSM 用于您有多个状态并且需要在刺激时转换到不同状态的任何地方。

（事实证明，这涵盖了大多数问题，至少在理论上如此）

* * *

## 回答 #13

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T19:38:59.707

我有一个来自我正在使用的当前系统的示例。我正在建立一个股票交易系统。跟踪订单状态的过程可能很复杂，但是如果您为订单的生命周期构建状态图，则可以将新传入交易应用于现有订单变得更加简单。如果您从当前状态知道新事务只能是三件事之一而不是 20 件事之一，那么应用该事务所需的比较就会少得多。它使代码更加高效。

* * *

## 回答 #14

> 赞同：2
> 
>             
> 
> 时间：2008-11-18T22:36:07.090

我在这里没有看到任何可以解释我看到它们被使用的原因的东西。

出于实际目的，当程序员在操作中间被迫返回线程/退出时，通常必须添加一个。

例如，如果您有一个多状态 HTTP 请求，您的服务器代码可能如下所示：

```
Show form 1
process form 1
show form 2
process form 2 
```

问题是，每次显示表单时，您都必须退出服务器上的整个线程（在大多数语言中），即使您的代码在逻辑上都流在一起并使用相同的变量。

在代码中插入中断并返回线程的行为通常使用 switch 语句完成，并创建所谓的状态机（非常基本版本）。

随着您变得越来越复杂，很难弄清楚哪些状态是有效的。人们通常然后定义一个“[状态转换表](http://en.wikipedia.org/wiki/State_transition_table)”来描述所有的状态转换。

我写了一个[状态机库](http://code.google.com/p/state-machine/)，主要概念是你可以直接实现你的状态转换表。这是一个非常巧妙的练习，虽然不知道它会有多好......

* * *

## 回答 #15

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T18:08:13.913

有限状态机可用于任何自然语言的形态分析。

从理论上讲，这意味着形态和句法在计算级别之间被分割，一个至多是有限状态，另一个至多是温和的上下文敏感的（因此需要其他理论模型来解释词对词而不是语素与语素的关系）。

这在机器翻译和文字修饰领域很有用。从表面上看，它们是在 NLP 中为不太琐碎的机器学习应用程序提取的低成本特征，例如句法或依赖项解析。

如果您有兴趣了解更多信息，可以查看Beesley 和 Karttunen 的  *Finite State Morphology ，以及他们在 PARC 设计的 Xerox Finite State Toolkit。*

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T19:08:11.373

状态驱动代码是实现某些类型逻辑的好方法（解析器就是一个例子）。它可以通过多种方式完成，例如：

*   状态驱动在给定点实际执行的代码位（即状态隐含在您正在编写的代码段中）。  [递归下降解析器](http://en.wikipedia.org/wiki/Recursive_descent_parser)是这类代码的一个很好的例子。

*   状态驱动在条件（例如 switch 语句）中执行的操作。

*   显式状态机，例如由[Lex](http://en.wikipedia.org/wiki/Lex_programming_tool)和[Yacc](http://en.wikipedia.org/wiki/Yacc)等解析器生成工具生成的状态机。

并非所有状态驱动代码都用于解析。通用状态机生成器是  [smc](http://smc.sourceforge.net/)。它吸入状态机的定义（以其语言），并以各种语言为状态机输出代码。

* * *

## 回答 #17

> 赞同：0
> 
>             
> 
> 时间：2008-11-18T23:08:38.410

很好的答案。这是我的 2 美分。有限状态机是一种理论上的想法，可以以多种不同的方式实现，例如表格，或作为一个 while-switch（但不要告诉任何人这是一种说 goto*恐怖*的方式）。任何 FSM 都对应一个正则表达式是一个定理，反之亦然。由于正则表达式对应于结构化程序，因此您**有时**可以只编写结构化程序来实现您的 FSM。例如，一个简单的数字解析器可以这样写：

```
/* implement dd*[.d*] */
if (isdigit(*p)){
    while(isdigit(*p)) p++;
    if (*p=='.'){
        p++;
        while(isdigit(*p)) p++;
    }
    /* got it! */
} 
```

你明白了。而且，如果有一种运行速度更快的方法，我不知道它是什么。

* * *

## 回答 #18

> 赞同：0
> 
>             
> 
> 时间：2010-08-20T09:56:14.853

一个典型的用例是交通信号灯。

关于实现说明：Java 5 的枚举可以有抽象方法，这是封装状态相关行为的绝佳方式。

# data-structures - 用于目录结构的数据结构？

> ID：255800
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2008-11-01T17:28:10.530
> 
>         
> 
> 标签：data-structures, directory, directory-structure

我正在制作一个用户构建目录的程序（不是在 Windows 中，在我的应用程序中），并且在这些文件夹中有子文件夹等等；每个文件夹都必须包含文件夹或文档。什么是最好的数据结构？请注意，用户可以选择一个子文件夹并在其中及其子文件夹中搜索文档。而且我不想限制文件夹或子文件夹级别。

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2008-11-01T17:44:31.340

这就是我所做的：

数据库中的每条记录都有两个字段：ID 和 ParentID。ID 为 4-5 个字符（Base36、az:0-9 或类似字符）。父 ID 是父级完整结构的串联...

所以...

这种结构：

```
Root
   Folder1
   Folder2
      Folder3
   Folder4
      Folder5
         Folder6 
```

将像这样表示：

```
ID     ParentID     Name

0000   NULL           ROOT
0001   0000           Folder1
0002   0000           Folder2
0003   00000002       Folder3
0004   0000           Folder4
0005   00000004       Folder5
0006   000000040005   Folder6 
```

我喜欢这种结构，因为如果我需要查找文件夹下的所有文件，我可以执行如下查询：

```
SELECT * FROM Folders WHERE ParentID LIKE '0000%' -- to find all folders under Folder1 
```

要删除文件夹及其所有子文件夹：

```
DELETE FROM Folders WHERE ID='0004' AND ParentID LIKE '00000004%' 
```

要移动文件夹及其子文件夹，您必须将使用同一父文件夹的所有记录更新为新的父文件夹。

> 而且我不想限制文件夹或子文件夹级别

一个明显的限制是子文件夹的数量受限于 ParentID 字段的大小。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2008-11-01T17:39:24.440

我可以想出几种方法来构建它，但没有什么能比得上显而易见的：

**使用实际的文件系统。**

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2008-11-01T17:50:56.523

我会考虑使用某种[树数据结构](http://en.wikipedia.org/wiki/Tree_data_structure)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2013-10-17T08:42:41.260

我应该推荐 B+ Tree .... 您可以轻松使用索引（页面、文件夹等）和所有 .

[B+ 树 http://commons.wikimedia.org/wiki/File:Btree.png](http://commons.wikimedia.org/wiki/File:Btree.png)

欲了解更多信息：
 http: [//ozark.hendrix.edu/~burch/cs/340/reading/btree/index.html](http://ozark.hendrix.edu/~burch/cs/340/reading/btree/index.html)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T19:47:29.203

我知道这个问题是专门要求一个数据结构，但是......

如果您使用的是面向对象的语言，也许您可​​以使用非常适合这种类型的分层树状结构的复合设计模式。你得到你想要的。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T20:01:08.817

大多数 OO 语言都带有文件系统的某种抽象，所以我将从这里开始。如果需要，然后将其子类化。

例如，我希望目录作为目录或文件的对象数组。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2010-04-02T17:51:25.417

您可以使用 m-way 树数据结构

# wiki - 如何在您的 Web 应用程序中实现 wiki 样式的编辑？

> ID：255802
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-11-01T17:28:32.650
> 
>         
> 
> 标签：wiki

在我正在开发的 Web 应用程序中，我希望实现 wiki 样式的编辑（每个编辑都被保存，可以比较，并且用户可以轻松地回滚编辑）。

在不重新发明轮子的情况下实现这一点的好方法是什么？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T17:49:21.330

我相信您真的在寻找*内容管理系统*(CMS)，而 Wiki 是其中的一个专业化 (恕我直言)。

谷歌搜索“ [CMS Open Source](http://www.google.com/search?rlz=1C1GGLS_en-USUS292&aq=f&sourceid=chrome&ie=UTF-8&q=cms+open+source) ”是其热门：

[开源CMS](http://www.opensourcecms.com/)，安装前先试试

*   Joomla

*   德鲁巴

*   WordPress

还有*很多*其他信息。

在商业上，我真的很喜欢 Atlassian 的[Confluence](http://www.atlassian.com/software/confluence/)。Wiki 喜欢标记、编辑历史记录、轻松附加文档，现在支持在 Word、Excel 和 Powerpoint 中进行编辑。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-11-02T04:48:58.177

使用像 tikiwiki 这样的 cms，它非常接近您计划要做的事情.. :D

# regex - 如何修复我的正则表达式，使其与贪婪的量词不匹配？

> ID：255815
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-11-01T17:35:05.430
> 
>         
> 
> 标签：regex, perl, parsing, greedy, regex-greedy

我有以下行：

```
"14:48 say;0ed673079715c343281355c2a1fde843;2;laka;hello ;)" 
```

我使用一个简单的正则表达式来解析它：

```
if($line =~ /(\d+:\d+)\ssay;(.*);(.*);(.*);(.*)/) {
    my($ts, $hash, $pid, $handle, $quote) = ($1, $2, $3, $4, $5);
} 
```

但是; 最后把事情搞砸了，我不知道为什么。贪婪的运营商不应该处理“一切”吗？

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2008-11-01T17:44:16.597

贪婪的操作符试图尽可能多地抓取东西，并且仍然匹配字符串。发生的事情是第一个（在“say”之后）获取“0ed673079715c343281355c2a1fde843;2”，第二个获取“laka”，第三个找到“hello”，第四个匹配括号。

您需要做的是使除最后一个之外的所有内容都非贪婪，因此它们尽可能少地抓取并仍然匹配字符串：

```
(\d+:\d+)\ssay;(.*?);(.*?);(.*?);(.*) 
```

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2008-11-01T17:40:29.087

```
(\d+:\d+)\ssay;([^;]*);([^;]*);([^;]*);(.*) 
```

应该工作得更好

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2008-11-01T18:06:41.857

尽管正则表达式可以轻松做到这一点，但我不确定它是否是最直接的方法。它可能是最短的，但这实际上并不能使它成为最可维护的。

相反，我会建议这样的事情：

```
$x="14:48 say;0ed673079715c343281355c2a1fde843;2;laka;hello ;)";

if (($ts,$rest) = $x =~ /(\d+:\d+)\s+(.*)/)
{
    my($command,$hash,$pid,$handle,$quote) = split /;/, $rest, 5;
    print join ",", map { "[$_]" } $ts,$command,$hash,$pid,$handle,$quote
} 
```

这导致：

```
[14:48],[say],[0ed673079715c343281355c2a1fde843],[2],[laka],[hello ;)] 
```

我认为这只是更具可读性。不仅如此，我认为它也更容易调试和维护，因为这更接近于人类用笔和纸尝试同样的事情。将字符串分解成块，然后您可以更轻松地解析 - 让计算机完全按照您的意愿执行。当需要进行修改时，我认为这个会更好。YMMV。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T17:39:00.523

尝试使前 3 个`(.*)`不贪婪`(.*?)`

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2008-11-02T01:21:51.167

如果分号分隔列表中的值本身不能包含任何分号，则只需将其拼出即可获得最有效和最直接的正则表达式。如果某些值只能是一串十六进制字符，请将其拼写出来。当正则表达式与主题字符串不匹配时，使用惰性或贪婪点的解决方案总是会导致大量无用的回溯。

```
(\d+:\d+)\ssay;([a-f0-9]+);(\d+);(\w+);([^;\r\n]+) 
```

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T17:47:39.680

您可以通过附加问号使 * 不贪心：

```
$line =~ /(\d+:\d+)\ssay;(.*?);(.*?);(.*?);(.*)/ 
```

或者您可以匹配除最后一个部分之外的每个部分中除分号之外的所有内容：

```
$line =~ /(\d+:\d+)\ssay;([^;]*);([^;]*);([^;]*);(.*)/ 
```

# javascript - Javascript 拖放

> ID：255830
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-11-01T17:39:47.683
> 
>         
> 
> 标签：javascript, drag-and-drop

我正在找人解释如何在 javascript 中拖放，我想要一条带有一些可自定义图像的水平线。

我已经查看了这些的在线教程，但发现它们很难使用。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-11-01T17:54:23.393

我建议您查看其中的 Javascript 框架之一。我们使用带有 scriptaculous 的[原型。](http://www.prototypejs.org/)

[您可以在此处查看](http://github.com/madrobby/scriptaculous/wikis/puzzle-demo)Scriptaculous 中的拖放演示。您可以在[此处](http://www.tutorialspoint.com/script.aculo.us/scriptaculous_drag_drop.htm)浏览教程。

或者查看任何其他框架，例如 JQuery 或 Dojo。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T18:08:11.230

这是我的代码......我已经使用[这个页面](http://www.webreference.com/programming/javascript/mk/column2/)来做到这一点......

它目前将所有内容移至第一列，我认为这与鼠标有关。

```
print("<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Page</title>
<--
<style type="text/css">
<!--
.DragContainer, .OverDragContainer {
  float: left;
  margin: 3px;
  width: 100px;
  border: #669999 2px solid;
  padding: 5px;
}

.DragBox, .OverDragBox, .DragDragBox, .miniDragBox {
  border: #000 1px solid;
  padding: 2px;
  font-size: 10px;
  margin-bottom: 5px;
  width: 94px;
  cursor: pointer;
  font-family: verdana, tahoma, arial;
  background-color: #eee;
}

.OverDragContainer {
    background-color: #eee;
}

.OverDragBox, .DragDragBox {
  background-color: #ffff99;
}

.DragDragBox {
  filter: alpha(opacity=50);
  background-color: #ff99cc;
}

legend {
  font-weight: bold;
  font-size: 12px;
  color: #666699;
  font-family: verdana, tahoma, arial;
}

fieldset {
  padding: 3px;
}

.History {
  font-size: 10px;
  overflow: auto;
  width: 100%;
  font-family: verdana, tahoma, arial;
  height: 82px;
}

#DragContainer8 {
  border: #669999 1px solid;
  padding: 5px 0 0 5px
  width: 110px;
  height: 40px;
}

.miniDragBox {
  float: left;
  margin: 0 5px 5px 0;
  width: 20px;
  height: 20px;
}
-->
</style>
<--script type="text/javascript">

// iMouseDown represents the current mouse button state: up or down
/*
lMouseState represents the previous mouse button state so that we can
check for button clicks and button releases:

if(iMouseDown && !lMouseState) // button just clicked!
if(!iMouseDown && lMouseState) // button just released!
*/
var mouseOffset = null;
var iMouseDown  = false;
var lMouseState = false;
var dragObject  = null;

// Demo 0 variables
var DragDrops   = [];
var curTarget   = null;
var lastTarget  = null;
var dragHelper  = null;
var tempDiv     = null;
var rootParent  = null;
var rootSibling = null;

Number.prototype.NaN0=function(){return isNaN(this)?0:this;}

function CreateDragContainer(){
    /*
    Create a new "Container Instance" so that items from one "Set" can not
    be dragged into items from another "Set"
    */
    var cDrag        = DragDrops.length;
    DragDrops[cDrag] = [];

    /*
    Each item passed to this function should be a "container".  Store each
    of these items in our current container
    */
    for(var i=0; i<arguments.length; i++){
        var cObj = arguments[i];
        DragDrops[cDrag].push(cObj);
        cObj.setAttribute('DropObj', cDrag);

        /*
        Every top level item in these containers should be draggable.  Do this
        by setting the DragObj attribute on each item and then later checking
        this attribute in the mouseMove function
        */
        for(var j=0; j<cObj.childNodes.length; j++){

            // Firefox puts in lots of #text nodes...skip these
            if(cObj.childNodes[j].nodeName=='#text') continue;

            cObj.childNodes[j].setAttribute('DragObj', cDrag);
        }
    }
}

function getMouseOffset(target, ev){
    ev = ev || window.event;

    var docPos    = getPosition(target);
    var mousePos  = mouseCoords(ev);
    return {x:mousePos.x - docPos.x, y:mousePos.y - docPos.y};
}

function getPosition(e){
    var left = 0;
    var top  = 0;

    while (e.offsetParent){
        left += e.offsetLeft;
        top  += e.offsetTop;
        e     = e.offsetParent;
    }

    left += e.offsetLeft;
    top  += e.offsetTop;

    return {x:left, y:top};
}

function makeDraggable(item){
    if(!item) return;
    item.onmousedown = function(ev){
        dragObject  = this;
        mouseOffset = getMouseOffset(this, ev);
        return false;
    }
}

function makeClickable(object){
    object.onmousedown = function(){
        dragObject = this;
    }
}

function mouseCoords(ev){
    if(ev.pageX || ev.pageY){
        return {x:ev.pageX, y:ev.pageY};
    }
    return {
        x:ev.clientX + document.body.scrollLeft - document.body.clientLeft,
        y:ev.clientY + document.body.scrollTop  - document.body.clientTop
    };
}

function mouseMove(ev){
    ev         = ev || window.event;

    /*
    We are setting target to whatever item the mouse is currently on

    Firefox uses event.target here, MSIE uses event.srcElement
    */
    var target   = ev.target || ev.srcElement;
    var mousePos = mouseCoords(ev);

    // mouseOut event - fires if the item the mouse is on has changed
    if(lastTarget && (target!==lastTarget)){
        // reset the classname for the target element
        var origClass = lastTarget.getAttribute('origClass');
        if(origClass) lastTarget.className = origClass;
    }

    /*
    dragObj is the grouping our item is in (set from the createDragContainer function).
    if the item is not in a grouping we ignore it since it can't be dragged with this
    script.
    */
    var dragObj = target.getAttribute('DragObj');

     // if the mouse was moved over an element that is draggable
    if(dragObj!=null){

        // mouseOver event - Change the item's class if necessary
        if(target!=lastTarget){
            var oClass = target.getAttribute('overClass');
            if(oClass){
                target.setAttribute('origClass', target.className);
                target.className = oClass;
            }
        }

        // if the user is just starting to drag the element
        if(iMouseDown && !lMouseState){
            // mouseDown target
            curTarget     = target;

            // Record the mouse x and y offset for the element
            rootParent    = curTarget.parentNode;
            rootSibling   = curTarget.nextSibling;

            mouseOffset   = getMouseOffset(target, ev);

            // We remove anything that is in our dragHelper DIV so we can put a new item in it.
            for(var i=0; i<dragHelper.childNodes.length; i++) dragHelper.removeChild(dragHelper.childNodes[i]);

            // Make a copy of the current item and put it in our drag helper.
            dragHelper.appendChild(curTarget.cloneNode(true));
            dragHelper.style.display = 'block';

            // set the class on our helper DIV if necessary
            var dragClass = curTarget.getAttribute('dragClass');
            if(dragClass){
                dragHelper.firstChild.className = dragClass;
            }

            // disable dragging from our helper DIV (it's already being dragged)
            dragHelper.firstChild.removeAttribute('DragObj');

            /*
            Record the current position of all drag/drop targets related
            to the element.  We do this here so that we do not have to do
            it on the general mouse move event which fires when the mouse
            moves even 1 pixel.  If we don't do this here the script
            would run much slower.
            */
            var dragConts = DragDrops[dragObj];

            /*
            first record the width/height of our drag item.  Then hide it since
            it is going to (potentially) be moved out of its parent.
            */
            curTarget.setAttribute('startWidth',  parseInt(curTarget.offsetWidth));
            curTarget.setAttribute('startHeight', parseInt(curTarget.offsetHeight));
            curTarget.style.display  = 'none';

            // loop through each possible drop container
            for(var i=0; i<dragConts.length; i++){
                with(dragConts[i]){
                    var pos = getPosition(dragConts[i]);

                    /*
                    save the width, height and position of each container.

                    Even though we are saving the width and height of each
                    container back to the container this is much faster because
                    we are saving the number and do not have to run through
                    any calculations again.  Also, offsetHeight and offsetWidth
                    are both fairly slow.  You would never normally notice any
                    performance hit from these two functions but our code is
                    going to be running hundreds of times each second so every
                    little bit helps!

                    Note that the biggest performance gain here, by far, comes
                    from not having to run through the getPosition function
                    hundreds of times.
                    */
                    setAttribute('startWidth',  parseInt(offsetWidth));
                    setAttribute('startHeight', parseInt(offsetHeight));
                    setAttribute('startLeft',   pos.x);
                    setAttribute('startTop',    pos.y);
                }

                // loop through each child element of each container
                for(var j=0; j<dragConts[i].childNodes.length; j++){
                    with(dragConts[i].childNodes[j]){
                        if((nodeName=='#text') || (dragConts[i].childNodes[j]==curTarget)) continue;

                        var pos = getPosition(dragConts[i].childNodes[j]);

                        // save the width, height and position of each element
                        setAttribute('startWidth',  parseInt(offsetWidth));
                        setAttribute('startHeight', parseInt(offsetHeight));
                        setAttribute('startLeft',   pos.x);
                        setAttribute('startTop',    pos.y);
                    }
                }
            }
        }
    }

    // If we get in here we are dragging something
    if(curTarget){
        // move our helper div to wherever the mouse is (adjusted by mouseOffset)
        dragHelper.style.top  = mousePos.y - mouseOffset.y;
        dragHelper.style.left = mousePos.x - mouseOffset.x;

        var dragConts  = DragDrops[curTarget.getAttribute('DragObj')];
        var activeCont = null;

        var xPos = mousePos.x - mouseOffset.x + (parseInt(curTarget.getAttribute('startWidth')) /2);
        var yPos = mousePos.y - mouseOffset.y + (parseInt(curTarget.getAttribute('startHeight'))/2);

        // check each drop container to see if our target object is "inside" the container
        for(var i=0; i<dragConts.length; i++){
            with(dragConts[i]){
                if(((getAttribute('startLeft'))                               < xPos) &&
                    ((getAttribute('startTop'))                                < yPos) &&
                    ((getAttribute('startLeft') + getAttribute('startWidth'))  > xPos) &&
                    ((getAttribute('startTop')  + getAttribute('startHeight')) > yPos)){

                        /*
                        our target is inside of our container so save the container into
                        the activeCont variable and then exit the loop since we no longer
                        need to check the rest of the containers
                        */
                        activeCont = dragConts[i];

                        // exit the for loop
                        break;
                }
            }
        }

        // Our target object is in one of our containers.  Check to see where our div belongs
        if(activeCont){
            // beforeNode will hold the first node AFTER where our div belongs
            var beforeNode = null;

            // loop through each child node (skipping text nodes).
            for(var i=activeCont.childNodes.length-1; i>=0; i--){
                with(activeCont.childNodes[i]){
                    if(nodeName=='#text') continue;

                    // if the current item is "After" the item being dragged
                    if(
                        curTarget != activeCont.childNodes[i]                              &&
                        ((getAttribute('startLeft') + getAttribute('startWidth'))  > xPos) &&
                        ((getAttribute('startTop')  + getAttribute('startHeight')) > yPos)){
                            beforeNode = activeCont.childNodes[i];
                    }
                }
            }

            // the item being dragged belongs before another item
            if(beforeNode){
                if(beforeNode!=curTarget.nextSibling){
                    activeCont.insertBefore(curTarget, beforeNode);
                }

            // the item being dragged belongs at the end of the current container
            } else {
                if((curTarget.nextSibling) || (curTarget.parentNode!=activeCont)){
                    activeCont.appendChild(curTarget);
                }
            }

            // make our drag item visible
            if(curTarget.style.display!=''){
                curTarget.style.display  = '';
            }
        } else {

            // our drag item is not in a container, so hide it.
            if(curTarget.style.display!='none'){
                curTarget.style.display  = 'none';
            }
        }
    }

    // track the current mouse state so we can compare against it next time
    lMouseState = iMouseDown;

    // mouseMove target
    lastTarget  = target;

    // track the current mouse state so we can compare against it next time
    lMouseState = iMouseDown;

    // this helps prevent items on the page from being highlighted while dragging
    return false;
}

function mouseUp(ev){
    if(curTarget){
        // hide our helper object - it is no longer needed
        dragHelper.style.display = 'none';

        // if the drag item is invisible put it back where it was before moving it
        if(curTarget.style.display == 'none'){
            if(rootSibling){
                rootParent.insertBefore(curTarget, rootSibling);
            } else {
                rootParent.appendChild(curTarget);
            }
        }

        // make sure the drag item is visible
        curTarget.style.display = '';
    }
    curTarget  = null;
    iMouseDown = false;
}

function mouseDown(){
    iMouseDown = true;
    if(lastTarget){
        return false;
    }
}

document.onmousemove = mouseMove;
document.onmousedown = mouseDown;
document.onmouseup   = mouseUp;

window.onload = function(){
    // Create our helper object that will show the item while dragging
    dragHelper = document.createElement('DIV');
    dragHelper.style.cssText = 'position:absolute;display:none;';

    CreateDragContainer(
        document.getElementById('DragContainer1'),
        document.getElementById('DragContainer2'),
        document.getElementById('DragContainer3')
    );

    document.body.appendChild(dragHelper);
}
</script><!--the mouse over and dragging class are defined on each item-->

</head>
<body>

<br/>
<div class="DragContainer" id="DragContainer1">
    <div class="DragBox" id="Item1"  overClass="OverDragBox" dragClass="DragDragBox">Item #1</div>
    <div class="DragBox" id="Item2"  overClass="OverDragBox" dragClass="DragDragBox">Item #2</div>
    <div class="DragBox" id="Item3"  overClass="OverDragBox" dragClass="DragDragBox">Item #3</div>
    <div class="DragBox" id="Item4"  overClass="OverDragBox" dragClass="DragDragBox">Item #4</div>
</div>
<div class="DragContainer" id="DragContainer2">
    <div class="DragBox" id="Item5"  overClass="OverDragBox" dragClass="DragDragBox">Item #5</div>
    <div class="DragBox" id="Item6"  overClass="OverDragBox" dragClass="DragDragBox">Item #6</div>
    <div class="DragBox" id="Item7"  overClass="OverDragBox" dragClass="DragDragBox">Item #7</div>
    <div class="DragBox" id="Item8"  overClass="OverDragBox" dragClass="DragDragBox">Item #8</div>
</div>
<div class="DragContainer" id="DragContainer3">
    <div class="DragBox" id="Item9"  overClass="OverDragBox" dragClass="DragDragBox">Item #9</div>
    <div class="DragBox" id="Item10" overClass="OverDragBox" dragClass="DragDragBox">Item #10</div>
    <div class="DragBox" id="Item11" overClass="OverDragBox" dragClass="DragDragBox">Item #11</div>
    <div class="DragBox" id="Item12" overClass="OverDragBox" dragClass="DragDragBox">Item #12</div>
</div>
<br/>

</body>
</html>
"); 
```

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2011-03-13T01:23:10.717

找到 2x 的：

```
dragHelper.style.top  = mousePos.y - mouseOffset.y;
dragHelper.style.left = mousePos.x - mouseOffset.x; 
```

改成：

```
dragHelper.style.top  = mousePos.y - mouseOffset.y + 'px';
dragHelper.style.left = mousePos.x - mouseOffset.x + 'px'; 
```

适用于FF。3.6

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2011-03-13T14:08:08.290

答案就在这里[带有图像和文本的 jQuery 拖放 DIV 选择](https://stackoverflow.com/questions/4911928/jquery-drag-and-drop-div-selection-with-images-and-text/5266416#5266416)

```
<script type="text/javascript" src="http://www.dynamicdrive.com/dynamicindex11/domdrag/dom-drag.js"></script>
<script type="text/javascript">
Drag.init(document.getElementById("exampleid")); //sets the id to look for to make object draggable
</script> 
```

# oop - 你什么时候停止封装？

> ID：255845
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-11-01T17:47:47.840
> 
>         
> 
> 标签：oop, encapsulation

我在管理给定通用事务的持久性机制的边界类上有一些事件处理程序：

```
void MyBoundaryClass::MyEventHandler(...)
{
  //retrieve stuff from the UI
  //...
  //declare and initialize trasaction to persist
  SimpleTransaction myTransaction(.../*pass down stuff*/);
  //do some other checks
  //...
  //declare transaction persistor
  TransactionPersistor myPersistor(myTransaction, .../*pass down connection to DB and other stuff*/);
  //persist transaction
  try
  {
    myPersistor.Persist();
  }
  catch(...)
  {
    //handle errors
  }
} 
```

使用某种 TransactionManager 来包装 SimpleTransaction 和 TransactionPERsistor 对象会更好吗？

是否有任何有用的经验法则可以理解我是否需要进一步的封装？

目前我遵循的经验法则是“如果方法变得太大 - 做点什么”。在处理边界事件处理程序时，有时很难在过程和面向对象之间找到正确的平衡。

有什么意见吗？

干杯

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T18:13:55.710

考虑到：

*   [封装](https://stackoverflow.com/questions/99688/private-vs-public-members-in-practice-how-important-is-encapsulation#100035)的概念是关于定义一个容器，并且

*   面向对象的设计基于消息传递（方法的调用）的概念

我认为***API***很好地表明了新的高级封装的相关性（即新对象的定义）

如果这个新对象提供的服务（即 API）是一致的，并且在重新组合成一个特殊对象时更好地暴露给程序的其余部分，那么一定要使用一个新对象。

否则，很可能是矫枉过正。

由于您通过创建新对象来公开***公共****API，因此在该新对象（以及一些其他模拟对象）中执行***测试**的概念可能更容易，而不是创建许多旧对象来测试这些相同的操作。

 *在您的情况下，如果您想测试事务，您必须实际测试 MyBoundaryClass 的 MyEventHandler，以便从 UI 检索数据。

但是，如果您定义一个 TransactionManager，那么您就有机会**降低 MyBoundaryClass 中存在的不同架构级别**（GUI 与数据）的耦合，并将数据管理导出到专用类中。

然后，您可以在独立的测试场景中测试数据持久性，特别关注限制值、数据库故障、非标称条件等。

测试场景可以帮助您细化不同对象的*内聚力*（[Daok](https://stackoverflow.com/questions/255845/when-do-you-stop-encapsulating#255967)提到的重点）。如果您的测试简单且连贯，那么您的对象很可能具有明确定义的服务边界。

由于可以说[耦合和内聚是面向对象编程的两个基石](http://javaboutique.internet.com/tutorials/coupcoh/)，因此可以根据它将执行的一组操作来评估像 TransactionManager 这样的新类的内聚。

> 内聚意味着某个类执行一组密切相关的动作。另一方面，缺乏凝聚力意味着一个班级正在执行几个不相关的任务。[...] 随着越来越多的行为变得分散并最终出现在错误的地方，应用软件最终将变得无法管理。

如果您将在几个不同地方实现的行为重新组合到您的 TransactionManager 中，那应该没问题，只要它的公共 API 代表事务涉及的明确步骤，而不是像各种实用程序函数那样的“关于事务的东西”。一个名字本身不足以判断一个类的凝聚力。需要名称及其公共 API 的组合。

例如，TransactionManager 的一个有趣方面是完全封装 Transaction 的概念，它将：

*   系统的其余部分几乎不知道，并且会降低其他类和“事务”之间的耦合

*   通过将其 API 集中在事务步骤（如 initTransaction()、persistTransaction()、...）周围来增强 TransactionManager 的内聚性，避免任何 Transaction 实例的任何 getter 或 setter。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T18:43:30.130

详细阐述 VonC 的建议，请考虑以下准则：

*   如果您希望以相同的方式在其他地方调用相同的函数，那么将它们封装在一个新对象中是合理的。

*   如果一个函数（或一个对象）提供了一组单独有用的工具，那么将其重构为更小的组件是合理的。

VonC 关于 API 的观点是一个极好的试金石：创建有效的*接口*，并且*对象*通常变得显而易见。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T19:03:00.603

封装的程度应该与你的对象**的内聚度直接相关。**您的对象必须执行单个任务或必须划分为多个类并封装其所有行为和属性。

**经验法则**是何时测试您的对象。如果您正在执行单元测试并且您意识到您正在测试多个不同的事物（不在同一个区域操作中），那么您可能会尝试将其拆分。

**对于你的情况**，我会用你的“TransactionManager”的想法来封装。这样，“TransactionManager”将处理事务的工作方式，而不是“MyBoundaryClass”。

# cocoa - 处理从可可便捷方法返回的对象

> ID：255846
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-11-01T17:48:26.403
> 
>         
> 
> 标签：cocoa, nsdate, autorelease, convenience-methods

我有很多关于 NSDate 对象被过早释放的问题。我怀疑这些问题可能与我处理从 NSDate 便捷方法返回的对象的方式有关。我*认为*我在 JKShow 类中的 showDate 属性声明应该是“保留”，但是将其更改为分配或复制似乎对问题没有影响。

```
JKShow *show; 
NSDate *date;
NSMutableArray *list = [[NSMutableArray alloc] init];

// Show 1
show = [[JKShow alloc] init];
//...
date = [gregorian dateFromComponents:dateComponents];
show.showDate = date;
[list addObject:[show autorelease]];

// Show 2
show = [[JKShow alloc] init];
//...
date = [gregorian dateFromComponents:dateComponents];
show.showDate = date;
[list addObject:[show autorelease]]; 
```

*更新*

问题不在此处复制的代码中。在我的`JKShow init`方法中，我没有保留从`NSDate`便捷方法返回的日期。谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T18:03:48.213

从 dateFromComponents 返回的日期应该在自动释放池中，所以你的 showDate 属性应该是“保留”是正确的。事实上它应该是无论如何（除非你特别想要“复制”）。

从您显示的代码看来，您将 show 对象的所有权完全授予列表（因为您在添加它们时设置了自动释放）。您是说日期对象在显示对象从列表中出来之前被释放（或者列表被释放）？

另外，您是使用合成属性，还是手动编写它们？如果是后者，你的 setShowDate 属性方法是什么样的？

你也可以尝试在不同的地方记录日期对象的retainCount（尽管我总是发现自动释放确实使这复杂化）。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T18:10:26.140

如果 showDate 是一个足够的保留属性，则考虑到您发布的代码。其他东西（可能在 JKShow 的实现中）可能不正确。

如果你想弄清楚发生了什么，你可以使用 Instruments 来检查对象的寿命。您需要使用分配工具集运行它以记住保留和释放。如果您运行泄漏性能工具，默认情况下会以这种方式设置。

当你像这样运行 Instruments 时，它会记录所有对象的生命周期，以及针对它们发出的每个保留和释放的回溯。如果您查看对象，找到您的日期之一，并查看所有保留和释放，您应该能够确定虚假释放发生的位置。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T18:35:35.433

您显示的代码没有过早发布问题。事实上，它会泄漏数组和其中的所有内容，因为它不会释放数组。

您是否在打开垃圾收集器的情况下运行？

是`list`实例变量还是静态变量，还是局部变量？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T19:21:09.850

我想通了，感谢您的所有帮助，但问题出在我在这里发布的代码之外。我没有保留`NSDate`在我的 init 方法中创建的内容。不幸的是，直到我创建了两个新`NSDate`对象之后才发生崩溃，所以我完全是在找错树。

# c++ - 并行编程和 C++

> ID：255852
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2008-11-01T17:51:12.793
> 
>         
> 
> 标签：c++, design-patterns, parallel-processing, idioms

我最近写了很多关于并行计算和编程的文章，我确实注意到在并行计算方面出现了很多模式。注意到 Microsoft 已经发布了一个库以及 Microsoft Visual C++ 2010 社区技术预览版（名为 Parallel Patterns Library），我想知道您一直在使用和遇到哪些常见的并行编程模式可能值得记住？当您使用 C++ 编写并行程序时，您是否有任何遵循的习语和似乎不断出现的模式？

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2008-11-01T18:38:14.647

图案：

*   生产/消费者

    *   一个线程产生数据

    *   一个线程消费数据

*   循环并行

    *   如果你能证明每个循环是独立的，那么

        每次迭代都可以在一个单独的线程中完成

*   重新绘制线程

    *   其他线程确实工作并更新数据结构，但一个线程重新绘制屏幕。

*   主事件线程

    *   多个线程可以生成事件

    *   一个线程必须处理事件（因为顺序很重要）

    *   应该尝试分离事件线程/重绘线程

        这（有助于）防止 UI 冻结

        但如果不小心可能会导致过度重绘。

*   工作组

    *   一组线程等待队列上的作业。

    *   线程从队列中提取一个工作项（如果没有可用则等待）。

        线程在一个工作项上工作，直到完成

        一旦完成，线程将返回队列。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T18:26:41.583

首先，您必须在共享内存计算和无共享计算之间做出选择。共享内存更容易，但不能很好地扩展 - 如果你要么使用 shared-nothing

a) 有一个集群，而不是一个多处理器系统，或者

b) 如果您有很多 CPU（例如 > 60），并且内存高度不均匀

对于共享内存，常见的解决方案是使用线程；它们作为一个概念很容易理解，并且在 API 中易于使用（但难以调试）。

对于无共享，您使用某种消息传递。在高性能计算中，MPI 被建立为消息传递中间件。

然后，您还需要为并行活动设计架构。最常见的方法（同样因为它很容易理解）是农夫模式（又名主从）。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2012-12-12T15:06:39.350

**并行执行模式**

具有确定性模式的结构化并行编程是一种高级方法，主要基于循环并行执行模式的集合，通常称为算法骨架或并行构造，它抽象程序描述并隐藏低级多线程细节和并行性固有的许多复杂性来自程序员。

这些可重用的模式自动化了许多与范式相关的并行例程，例如同步、通信、数据分区或任务调度，并在内部处理它们。这种高级方法尝试使用更多抽象和更简单的方式来表达并行性并关注生产力和可编程性而不是性能的传统低级线程锁模型。

有许多常用的模式，例如：Map-Reduce、Fork-Join、Pipeline 或 Parallel Loop...

**文件**

“Structured Parallel Programming with Deterministic Patterns”是一篇讨论这些模式的论文。您还可以看到“MHPM：多尺度混合编程模型：灵活的并行化方法”，它描述了这种名为 XPU 的方法的 C++ 实现。

**图书馆**

[XPU](http://xpu-project.net)是一个基于任务的 C++ 库，由一组可重用的执行模式组成。它允许在单个同构编程模型内以多个粒度级别表达多种类型的并行性。它易于使用并说明了使用模式设计并行程序的兴趣。

例如，它允许表达：

1.  任务并行模式：

    简单或分层的 Fork/Join 执行模式，具有自动检测和保护共享数据等功能。

2.  数据并行模式：

    具有可扩展数据分区的并行循环模式。

3.  时间并行模式：

    管道执行模式。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2017-10-12T02:48:28.397

您拥有将并行性固定到程序部分的基础知识。C++17 得到了很多（例如 foreach、sort、find 和friends、map_reduce、map、reduce、prefix_sum 的并行版本......）请参阅[C++ Extensions for Parallelism](http://en.cppreference.com/w/cpp/experimental/parallelism)

然后你有像延续这样的项目。想想[std::future](http://en.cppreference.com/w/cpp/thread/future)但继续。实现这些的方法很少（[boost](http://www.boost.org/doc/libs/1_65_0/doc/html/thread/synchronization.html#thread.synchronization.futures.then)现在有一个很好的方法，因为 std 没有 next(...) 或 then(...) 方法，但最大的好处是不必等待它做下一个任务

```
auto fut = async([]( ){..some work...} ).then( [](result_of_prev ){...more work} ).then... ;
fut.wait( ); 
```

后续任务之间缺乏同步很重要，因为任务/线程/...之间的通信会减慢并行程序的速度。

因此，基于任务的并行性非常好。使用任务调度程序，您只需传递任务并走开。他们可能有一些方法，比如信号量，来回传信息，但这不是强制性的。[Intel Thread Building Blocks](https://software.intel.com/en-us/node/506294)和[Microsoft Parallel Pattern Library](https://msdn.microsoft.com/en-us/library/dd492418.aspx)都有这方面的功能。

之后，我们就有了 fork/join 模式。它并不意味着为每个任务创建 N 个线程。只是你有这些 N 件，理想情况下是独立的，要做的事情（fork），并且当它们完成时在某处有一个同步点（join）。

```
auto semaphore = make_semaphore( num_tasks );
add_task( [&semaphore]( ) {...task1...; semaphore.notify( ); } );
add_task( [&semaphore]( ) {...task2...; semaphore.notify( ); } );
...
add_task( [&semaphore]( ) {...taskN...; semaphore.notify( ); } );
semaphore.wait( ); 
```

从上面你可以开始看到这是一个流程图的模式。未来是（A >> B >> C >> D），分叉连接是（A|B|C|D）。有了它，您可以将它们组合成一个图表。(A1>>A2|B1>>B2>>B3|C1|D1>>D2>>(E1>>E2|F1)) 其中 A1>>A2 表示 A1 必须先于 A2 而 A|B 表示 A 和 B可以同时运行。缓慢的部分位于事物相遇的图/子图的末尾。

目标是找到系统中不需要通信的独立部分。如上所述，并行算法几乎在所有情况下都比它们的顺序算法慢，直到工作负载变得足够高或大小变得足够大（假设通信不太健谈）。例如排序。在 4 核计算机上，您将获得大约 2.5 倍的性能，因为合并很繁琐，需要大量同步，并且在第一轮合并后无法使用所有核心。在 N 非常大的 GPU 上，可以使用效率较低的排序，比如 Bitonic，它最终会非常快，因为你有很多工作人员要为工作提供动力，每个人都安静地做自己的事情。

减少通信的一些技巧包括，使用数组作为结果，这样每个任务就不会尝试锁定对象以推送值。通常以后这些结果的减少会非常快。

但是对于所有类型的并行，缓慢来自于通信。减少它。

# visual-studio - 是真的，Visual Studio 无法处理安装后的字体吗？

> ID：255855
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-11-01T17:52:46.143
> 
>         
> 
> 标签：visual-studio, fonts

[当我在这里](http://www.xnaresources.com/pages.asp?pageid=33)找到这个时，我试图解决我的[XNA 字体问题](https://stackoverflow.com/questions/254718/how-do-you-use-fonts-after-installing-xna)：

> Visual Studio 在启动并运行后无法识别您添加的任何字体。

有没有办法使用 Visual Studio 之后安装的字体？

在发现那是字体文件后，为什么教程会提到类似的东西？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-11-01T17:56:08.243

我已经成功安装了[PROGGY](http://www.proggyfonts.com/index.php?menu=download)字体。重启VC6后就可以使用了。

我怀疑他们正在谈论重新启动您的视觉工作室，而不是重新安装您的视觉工作室。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2012-09-25T18:05:48.747

我遇到了 VS 识别在 VS 打开时安装的字体的问题。重新启动 VS 和机器并没有解决问题。修复是关闭 VS，卸载字体，然后在 VS 未运行时重新安装它们。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T17:56:15.967

我想这只有在您重新启动 IDE 之前才是正确的。很容易测试，不是吗？

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T18:01:41.553

您应该关闭 Visual Studio 并再次打开它。如果它不起作用，那么您可能需要卸载字体（如果从程序中）并在 Visual Studio 关闭后安装它。但是，我怀疑这是必要的，也许在万不得已时重新启动您的机器，但关闭 VS 并再次打开它应该可以完成这项工作，

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2015-02-11T16:34:06.043

我试图安装 Source Code Pro 字体，发现 Visual Studio 只会在下拉列表中显示 TTF 字体。我一直在安装 ODF 版本，并花了很多时间以各种组合重新启动计算机和 Visual Studio。最后我尝试了TTF，它立即被识别出来。

# ruby - 使用 WIN32OLE 的文字自动化

> ID：255857
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-11-01T17:53:06.283
> 
>         
> 
> 标签：ruby, ms-word, win32ole

我正在尝试将图像（jpg）插入到 word 文档中，而 win32old 似乎不支持 Selection.InlineShapes.AddPicture，或者我做错了什么。有没有人有任何运气插入图像。  

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-08-25T05:59:28.117

您可以通过调用 Document.InlineShapes.AddPicture() 方法来做到这一点。

以下示例在第二句之前将图像插入到活动文档中。

```
 require 'win32ole'

    word = WIN32OLE.connect('Word.Application')
    doc = word.ActiveDocument

    image = 'C:\MyImage.jpg'
    range = doc.Sentences(2)

    params = { 'FileName' => image, 'LinkToFile' => false, 
               'SaveWithDocument' => true, 'Range' => range }

    pic = doc.InlineShapes.AddPicture( params ) 
```

关于 AddPicture() 方法的文档可以在[这里](http://msdn.microsoft.com/en-us/library/bb148763.aspx)找到。

可以在[此处](http://rubyonwindows.blogspot.com/search/label/word)找到有关使用 Ruby 自动化 Word 的更多详细信息。

这是 David Mullet 的答案，可以在[这里找到](https://stackoverflow.com/questions/1316162/insert-image-in-doc-using-win32ole-library-of-ruby)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-11-03T11:33:21.697

在 WinXP、Ruby 1.8.6、Word 2002/XP SP3 上运行，我录制了宏并将它们翻译成我能理解的内容：

```
require 'win32ole'

begin
  word = WIN32OLE::new('Word.Application')   # create winole Object
  doc = word.Documents.Add
  word.Selection.InlineShapes.AddPicture "C:\\pictures\\some_picture.jpg", false, true
  word.ChangeFileOpenDirectory "C:\\docs\\"
  doc.SaveAs "doc_with_pic.doc"
  word.Quit
rescue Exception => e
  puts e
  word.Quit
ensure
  word.Quit unless word.nil?
end 
```

它似乎工作。有什么用？

# java - Net Beans 中的自动换行

> ID：255862
> 
>         
> 
> 赞同：23
> 
>         
> 
> 时间：2008-11-01T17:56:29.273
> 
>         
> 
> 标签：java, ide, netbeans, javabeans

Netbeans 很棒，但无法在其中包含文本（或者希望我还没有找到它）。有什么方法可以做到这一点，如果没有，是否有任何类似的具有此功能的 Java IDE（希望也是免费的）。

* * *

## 回答 #1

> 赞同：48
> 
>             
> 
> 时间：2010-10-30T14:25:02.567

您可以在 Netbeans 中使用自动换行。

在netbeans.conf中添加如下内容（netbeans_installation_path/etc/netbeans.conf，linux下默认/etc/netbeans.conf）：

```
-J-Dorg.netbeans.editor.linewrap=true 
```

到第六行，看起来像这样：

```
netbeans_default_options="-J-client -J-Xss2m -J-Xms32m -J-XX:PermSize=32m -J-XX:MaxPermSize=200m -J-Dapple.laf.useScreenMenuBar=true -J-Dapple.awt.graphics.UseQuartz=true -J-Dsun.java2d.noddraw=true -J-Dorg.netbeans.editor.linewrap=true" 
```

并重新启动 Netbeans。

在 Tools->Options->Editor->Formating 中设置**Line Wrap选项。**

在 Netbeans 6.9 和 7 中工作正常

* * *

## 回答 #2

> 赞同：21
> 
>             
> 
> 时间：2010-06-23T18:43:31.363

如果您从事 Web 开发，您将理解为什么文本换行很重要。

从未接触过 HTML 的程序员从未见过真正的网络。您可以随心所欲地坚持使用 MVC，但自从它诞生以来，99.9% 的万维网都不是这样构建的。除非你总是从头开始开发，并且可以使用 MVC 将 HTML 分离出来，并且假设你有一个在职的网页设计师来做 html/css/javascript，或者你有一个界面开发人员，你可以把它放在你身上将不得不处理已经开发/组装/破解的所有内容以及当时手头或流行或负担得起的任何技术，现在或多或少地用作“网络应用程序”。在 99.9% 的情况下，您必须使用某种编程语言的混合体，很可能是解释型语言，html 和 javascript 都混合在同一个页面中。

这意味着没有漂亮的短行整洁干净的java代码，哦，很方便地在80个字符之前结束。

当你处理这个问题时——亲爱的，这是网络的大部分内容——你神奇地发现了文本换行的迫切需要，以防止长行让你向右滚动到它的结尾。

有些人。嘘。他们认为整个开发世界总是适合每行 80 个字符，从其中一些评论来看，他们似乎认为它总是会的。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2011-05-05T13:59:57.090

Netbeans 7 已经推出，它支持开箱即用的自动换行！

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-03-26T05:28:38.437

就像约瑟夫说的：你为什么需要这个。Java 对空格不敏感，并且具有很长的语句不会使您的代码易于阅读。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-25T10:00:35.487

有 word-wrap eclipse 插件：见[http://ahtik.com/blog/eclipse-word-wrap/](http://ahtik.com/blog/eclipse-word-wrap/)

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2011-02-12T02:00:33.173

在这个网站[blog.robbychen.com上有一个很好的解决方案](http://blog.robbychen.com/2010/04/26/enable-line-wrap-option-in-netbeans-nightly/)

jist 是在配置文件中的 netbeans_default_options 引号内添加以下行，然后重新启动 netbeans：

```
-J-Dorg.netbeans.editor.linewrap=true 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2010-08-15T05:22:21.997

实际上，我听说 netbeans 将在 6.7 版本中添加自动换行功能，但后来他们决定在 7.0 中包含此功能。希望我们会在下一个版本中看到自动换行，根据少数开发人员的说法，这不是必要的功能，但对于 Web 开发人员来说，这是完全需要的。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-05-05T23:55:20.673

它总是回到 Ultraedit。

为什么我们人类无法弄清楚这一点？netbeans、eclipse、zend studio (eclipse) 等并没有做一些非常简单的编程，大多数程序员 - 需要 - 保持良好的编码约定。当然，编码风格确实会影响行的长度（微软程序员，振作起来），但有时无法避免长字符串文字。这是精神错乱！然而我不能生气或忘恩负义，因为它是开源的。我 - 很感激。不过，人们不得不怀疑制作这些编辑器的 wtf 程序员实际上是在使用自己。

我希望编辑器在第 80 列或第 120 列换行，而不是像记事本++那样在窗口边缘换行。我发现进行硬/软包装的唯一工具是ultraedit，所以也许我应该尝试看看我是否可以让它在wine下运行，因为UE是唯一一个除了奇怪的东西之外还能完成它的工作的“真正”编辑器/丑陋的/像emacs一样需要永远学习和配置。而且我不会走那条路——它让我很想看它，因为现在是 2009 年，我们有明文和 guis。

真的有那么难解决的问题吗？如果您从 x 列向下画一条线并且您的单词跨越它，则将单词的开头放在它开始的行的缩进之下，并将溢出行标记为换行行。完毕。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-03-26T01:57:36.010

当您到达您希望该行结束的位置时，只需开始一个新行而不结束该语句。在您结束语句之前，它可能会用红色下划线，但不会导致任何异常。

我发现这也是组织长 println() 语句的好方法。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-10-11T15:33:26.020

科莫多编辑。除了许多其他奇妙的功能外，它实际上还包含线条。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T09:05:47.703

除了 Eclipse 也不支持自动换行，他们甚至没有为此设置目标。就像 Netbeans 一样，这已经被许多用户询问过，但从未被包括在内。看起来它需要很多改变，而且似乎也不是开发人员的首要任务。曾经有一个插件试图以有限的方式自动换行，但它当然不适用于最近的版本。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2012-09-10T11:31:45.920

当然，自动换行对编码人员很有用 - 当您编写 README.txt 文件时，您必须遵守[http://drupal.org/node/161085](http://drupal.org/node/161085)等编码标准，其中说需要有 80 个字符自动换行。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2012-01-12T20:35:53.677

新版本的 Netbeans 支持它。有关说明，请参阅此帖子：

[Netbeans 中的自动换行](http://www.ozonesolutions.com/programming/2012/01/wordwrap-in-netbeans/)

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2010-10-01T13:39:52.623

正如许多人已经指出的那样，答案是“你不能”。作为一个每天都在使用 Visual Studio 和基于 Eclipse 的产品的人，当我使用 Eclipse 时，我经常会想念 Visual Studio 的换行功能，我可以通过按键来打开和关闭这些功能。

对于许多回答“你不需要这个”的人，不要再如此居高临下。仅仅因为您不需要某个功能并不意味着世界上没有其他人需要。即使一个人要虔诚地遵循“一行永远不要超过 80 个字符”的建议，你也需要编辑其他人编写的超过 80 个字符的代码。尤其是在网络世界中，行会变得非常长。您不可避免地会花费大量时间查看其他人的超过 80 个字符的代码。

jEdit 的换行非常好。它保留了缩进，并且可以非常快速地打开和关闭。如果我正在处理一些非常笨拙的长行，我有时会在 jEdit 中复制/粘贴（它为无数语言提供语法突出显示）并使用那里可用的换行。

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2010-03-10T23:37:51.323

2点：

*   刚刚发现，如果想要查看从 SVG 调色板放置组件时自动生成的那些该死的 SVG 源，那么包装是非常必要的……

*   我将通过复制粘贴到 jEdit 来解决我当前的问题，该问题与 Ultraedit（在包装方面）和 FoC 一样可配置！

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2013-05-12T17:59:50.163

在netbeans 7.3中，您转到工具->选项->编辑器->格式，在左侧菜单区域中选择最底部的显示换行的下拉菜单，选择您的首选项...完成

* * *

## 回答 #17

> 赞同：-7
> 
>             
> 
> 时间：2009-03-26T21:22:22.670

买一个更大的显示器。

在 1920 x 1080 下，您不需要 steenkin 自动换行。

**更新：**
哇，仍然得到downvotes。也许这就是我所说的。至少它还没有赶上 Eclipse 的答案。

我真的认为这是一个合理的建议。我从没想过拥有更大的显示器会对我的编码产生如此大的影响。如果您使用小型显示器进行编码，请考虑购买一个不错的大新显示器。在很多情况下，它确实消除了自动换行的需要。

# asp.net-mvc - 带有“文件扩展名”的 ASP.NET MVC 路由

> ID：255876
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2008-11-01T18:04:22.627
> 
>         
> 
> 标签：asp.net-mvc

我想为一个新闻列表创建一个 MVC 路由，它可以以多种格式提供。

*   新闻 -> (X)HTML

*   新闻.rss -> RSS

*   news.atom -> 原子

是否有可能通过一条路线做到这一点（在我计划的设计中，更普遍的“可选扩展”情况出现在多个地方）？还是我需要像这样制作两条路线：

```
routes.MapRoute("News-ImplicitFormat",
                "news",
                new { controller = "News", action = "Browse", format = "" });

routes.MapRoute("News-ExplicitFormat",
                "news.{format}"
                new { controller = "News", action = "Browse" }); 
```

让路由系统支持以下内容似乎很有用：

```
routes.MapRoute("News",
                "news(.{format})?",
                new { controller = "News", action = "Browse" }); 
```

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2008-11-01T18:04:43.250

我做了一个方法来支持像这样添加对，如下所示：

```
public static void MapRouteWithOptionalFormat(this RouteCollection routes,
                                              string name,
                                              string url,
                                              object defaults)
{
    Route implicitRoute = routes.MapRoute(name + "-ImplicitFormat",
                                          url,
                                          defaults);
    implicitRoute.Defaults.Add("format", string.Empty);

    Route explicitRoute = routes.MapRoute(name + "-ExplicitFormat",
                                          url + ".{format}",
                                          defaults);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-11-02T16:22:09.790

您可以考虑使用约束来使其与正常路线一起使用。

更新：实际上，我误读了这个问题。另一个答案是现在要做的正确的事情。或创建自定义路线。我们正在将可选分段的想法视为未来可能的功能。

# wpf - 等效的 WPF 绑定语法

> ID：255879
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T18:04:38.163
> 
>         
> 
> 标签：wpf, data-binding

我需要一些关于 WPF 绑定语法的帮助：

```
public class ApplicationPresenter
{
    public ObservableCollection<Quotes> PriceList {get;}
}

public class WebSitePricesView
{
    private IApplicationPresenter presenter
    {
        get { return (ApplicationPresenter)DataContext; }
    }   

//  public ObservableCollection<Quotes> PriceList
//  {
//      get {return presenter.PriceList; }
    }
} 
```

此 XAML 工作正常：

```
<UserControl.Resources>       
    <ObjectDataProvider x:Key="ApplicationPresenterDS" ObjectType="{x:Type local:ApplicationPresenter}" />
    <xcdg:DataGridCollectionViewSource x:Key="price_list" Source="{Binding Path=PriceList} />
</UserControl.Resources>                   
<xcdg:DataGridControl ItemsSource="{Binding Source={StaticResource price_list}} /> 
```

但是我不希望 WebSitePricesView 公开 PriceList，我想将 DataGridCollectionViewSource 直接绑定到 ApplicationPresenter.PriceList。

此 XAML 不会将任何值绑定到网格。显然我在为 price_list 定义绑定源时做错了.....

```
<UserControl.Resources>       
    <ObjectDataProvider x:Key="ApplicationPresenterDS" ObjectType="{x:Type local:ApplicationPresenter}" />
        <xcdg:DataGridCollectionViewSource x:Key="price_list" Source="{Binding Source={StaticResource ApplicationPresenterDS}, Path=PriceList />            
</UserControl.Resources>  
<xcdg:DataGridControl ItemsSource="{Binding Source={StaticResource price_list}} /> 
```

第一次成功绑定的调试输出是：

```
Step into: Stepping over method without symbols 'Fenix.App.App'
System.Windows.Data Warning: 52 : Created BindingExpression (hash=35059110) for Binding (hash=15586314)
System.Windows.Data Warning: 54 :   Path: 'PriceList'
System.Windows.Data Warning: 56 : BindingExpression (hash=35059110): Default mode resolved to OneWay
System.Windows.Data Warning: 57 : BindingExpression (hash=35059110): Default update trigger resolved to PropertyChanged
System.Windows.Data Warning: 58 : BindingExpression (hash=35059110): Attach to Xceed.Wpf.DataGrid.DataGridCollectionViewSource.Source (hash=28137373)
System.Windows.Data Warning: 60 : BindingExpression (hash=35059110): Use Framework mentor <null>
System.Windows.Data Warning: 63 : BindingExpression (hash=35059110): Resolving source 
System.Windows.Data Warning: 65 : BindingExpression (hash=35059110): Framework mentor not found
System.Windows.Data Warning: 61 : BindingExpression (hash=35059110): Resolve source deferred
System.Windows.Data Warning: 91 : BindingExpression (hash=35059110): Got InheritanceContextChanged event from DataGridCollectionViewSource (hash=28137373)
System.Windows.Data Warning: 63 : BindingExpression (hash=35059110): Resolving source 
System.Windows.Data Warning: 66 : BindingExpression (hash=35059110): Found data context element: WebSitePricesXc (hash=11090012) (OK)
System.Windows.Data Warning: 67 : BindingExpression (hash=35059110): DataContext is null
System.Windows.Data Warning: 52 : Created BindingExpression (hash=53154844) for Binding (hash=52037308)
System.Windows.Data Warning: 54 :   Path: ''
System.Windows.Data Warning: 56 : BindingExpression (hash=53154844): Default mode resolved to OneWay
System.Windows.Data Warning: 57 : BindingExpression (hash=53154844): Default update trigger resolved to PropertyChanged
System.Windows.Data Warning: 58 : BindingExpression (hash=53154844): Attach to Xceed.Wpf.DataGrid.DataGridControl.ItemsSource (hash=16991442)
System.Windows.Data Warning: 63 : BindingExpression (hash=53154844): Resolving source 
System.Windows.Data Warning: 66 : BindingExpression (hash=53154844): Found data context element: <null> (OK)
System.Windows.Data Warning: 72 : BindingExpression (hash=53154844): Use View from DataGridCollectionViewSource (hash=28137373)
System.Windows.Data Warning: 74 : BindingExpression (hash=53154844): Activate with root item <null>
System.Windows.Data Warning: 100 : BindingExpression (hash=53154844): Replace item at level 0 with <null>, using accessor {DependencyProperty.UnsetValue}
System.Windows.Data Warning: 97 : BindingExpression (hash=53154844): GetValue at level 0 from <null> using <null>: <null>
System.Windows.Data Warning: 76 : BindingExpression (hash=53154844): TransferValue - got raw value <null>
System.Windows.Data Warning: 85 : BindingExpression (hash=53154844): TransferValue - using final value <null>
A first chance exception of type 'System.FormatException' occurred in mscorlib.dll
System.Windows.Data Warning: 63 : BindingExpression (hash=35059110): Resolving source 
System.Windows.Data Warning: 66 : BindingExpression (hash=35059110): Found data context element: WebSitePricesXc (hash=11090012) (OK)
System.Windows.Data Warning: 74 : BindingExpression (hash=35059110): Activate with root item ApplicationPresenter (hash=22260412)
System.Windows.Data Warning: 104 : BindingExpression (hash=35059110):   At level 0 - for ApplicationPresenter.PriceList found accessor RuntimePropertyInfo(PriceList)
System.Windows.Data Warning: 100 : BindingExpression (hash=35059110): Replace item at level 0 with ApplicationPresenter (hash=22260412), using accessor RuntimePropertyInfo(PriceList)
System.Windows.Data Warning: 97 : BindingExpression (hash=35059110): GetValue at level 0 from ApplicationPresenter (hash=22260412) using RuntimePropertyInfo(PriceList): ObservableCollection`1 (hash=40261689 Count=0)
System.Windows.Data Warning: 76 : BindingExpression (hash=35059110): TransferValue - got raw value ObservableCollection`1 (hash=40261689 Count=0)
System.Windows.Data Warning: 85 : BindingExpression (hash=35059110): TransferValue - using final value ObservableCollection`1 (hash=40261689 Count=0)
System.Windows.Data Warning: 92 : BindingExpression (hash=53154844): Got PropertyChanged event from DataGridCollectionViewSource (hash=28137373) for View
System.Windows.Data Warning: 75 : BindingExpression (hash=53154844): Deactivate
System.Windows.Data Warning: 99 : BindingExpression (hash=53154844): Replace item at level 0 with {NullDataItem}
System.Windows.Data Warning: 72 : BindingExpression (hash=53154844): Use View from DataGridCollectionViewSource (hash=28137373)
System.Windows.Data Warning: 74 : BindingExpression (hash=53154844): Activate with root item DataGridCollectionView (hash=22444475 Count=0)
System.Windows.Data Warning: 100 : BindingExpression (hash=53154844): Replace item at level 0 with DataGridCollectionView (hash=22444475 Count=0), using accessor {DependencyProperty.UnsetValue}
System.Windows.Data Warning: 97 : BindingExpression (hash=53154844): GetValue at level 0 from DataGridCollectionView (hash=22444475 Count=0) using <null>: DataGridCollectionView (hash=22444475 Count=0)
System.Windows.Data Warning: 76 : BindingExpression (hash=53154844): TransferValue - got raw value DataGridCollectionView (hash=22444475 Count=0)
System.Windows.Data Warning: 85 : BindingExpression (hash=53154844): TransferValue - using final value DataGridCollectionView (hash=22444475 Count=0)
System.Windows.Data Warning: 91 : BindingExpression (hash=35059110): Got PropertyChanged event from ApplicationPresenter (hash=22260412)
System.Windows.Data Warning: 97 : BindingExpression (hash=35059110): GetValue at level 0 from ApplicationPresenter (hash=22260412) using RuntimePropertyInfo(PriceList): ObservableCollection`1 (hash=6408547 Count=27)
System.Windows.Data Warning: 76 : BindingExpression (hash=35059110): TransferValue - got raw value ObservableCollection`1 (hash=6408547 Count=27)
System.Windows.Data Warning: 85 : BindingExpression (hash=35059110): TransferValue - using final value ObservableCollection`1 (hash=6408547 Count=27)
System.Windows.Data Warning: 92 : BindingExpression (hash=53154844): Got PropertyChanged event from DataGridCollectionViewSource (hash=28137373) for View
System.Windows.Data Warning: 75 : BindingExpression (hash=53154844): Deactivate
System.Windows.Data Warning: 99 : BindingExpression (hash=53154844): Replace item at level 0 with {NullDataItem}
System.Windows.Data Warning: 72 : BindingExpression (hash=53154844): Use View from DataGridCollectionViewSource (hash=28137373)
System.Windows.Data Warning: 74 : BindingExpression (hash=53154844): Activate with root item DataGridCollectionView (hash=61423861 Count=27)
System.Windows.Data Warning: 100 : BindingExpression (hash=53154844): Replace item at level 0 with DataGridCollectionView (hash=61423861 Count=27), using accessor {DependencyProperty.UnsetValue}
System.Windows.Data Warning: 97 : BindingExpression (hash=53154844): GetValue at level 0 from DataGridCollectionView (hash=61423861 Count=27) using <null>: DataGridCollectionView (hash=61423861 Count=27)
System.Windows.Data Warning: 76 : BindingExpression (hash=53154844): TransferValue - got raw value DataGridCollectionView (hash=61423861 Count=27)
System.Windows.Data Warning: 85 : BindingExpression (hash=53154844): TransferValue - using final value DataGridCollectionView (hash=61423861 Count=27) 
```

第二个绑定的调试输出是：

```
Step into: Stepping over method without symbols 'Fenix.App.App'
System.Windows.Data Warning: 52 : Created BindingExpression (hash=35059110) for Binding (hash=15586314)
System.Windows.Data Warning: 54 :   Path: 'PriceList'
System.Windows.Data Warning: 56 : BindingExpression (hash=35059110): Default mode resolved to OneWay
System.Windows.Data Warning: 57 : BindingExpression (hash=35059110): Default update trigger resolved to PropertyChanged
System.Windows.Data Warning: 58 : BindingExpression (hash=35059110): Attach to Xceed.Wpf.DataGrid.DataGridCollectionViewSource.Source (hash=28137373)
System.Windows.Data Warning: 63 : BindingExpression (hash=35059110): Resolving source 
System.Windows.Data Warning: 66 : BindingExpression (hash=35059110): Found data context element: <null> (OK)
System.Windows.Data Warning: 73 : BindingExpression (hash=35059110): Use Data from ObjectDataProvider (hash=61302538)
System.Windows.Data Warning: 74 : BindingExpression (hash=35059110): Activate with root item ApplicationPresenter (hash=20390146)
System.Windows.Data Warning: 104 : BindingExpression (hash=35059110):   At level 0 - for ApplicationPresenter.PriceList found accessor RuntimePropertyInfo(PriceList)
System.Windows.Data Warning: 100 : BindingExpression (hash=35059110): Replace item at level 0 with ApplicationPresenter (hash=20390146), using accessor RuntimePropertyInfo(PriceList)
System.Windows.Data Warning: 97 : BindingExpression (hash=35059110): GetValue at level 0 from ApplicationPresenter (hash=20390146) using RuntimePropertyInfo(PriceList): ObservableCollection`1 (hash=12781633 Count=0)
System.Windows.Data Warning: 76 : BindingExpression (hash=35059110): TransferValue - got raw value ObservableCollection`1 (hash=12781633 Count=0)
System.Windows.Data Warning: 85 : BindingExpression (hash=35059110): TransferValue - using final value ObservableCollection`1 (hash=12781633 Count=0)
System.Windows.Data Warning: 52 : Created BindingExpression (hash=12661120) for Binding (hash=31408037)
System.Windows.Data Warning: 54 :   Path: ''
System.Windows.Data Warning: 56 : BindingExpression (hash=12661120): Default mode resolved to OneWay
System.Windows.Data Warning: 57 : BindingExpression (hash=12661120): Default update trigger resolved to PropertyChanged
System.Windows.Data Warning: 58 : BindingExpression (hash=12661120): Attach to Xceed.Wpf.DataGrid.DataGridControl.ItemsSource (hash=16991442)
System.Windows.Data Warning: 63 : BindingExpression (hash=12661120): Resolving source 
System.Windows.Data Warning: 66 : BindingExpression (hash=12661120): Found data context element: <null> (OK)
System.Windows.Data Warning: 72 : BindingExpression (hash=12661120): Use View from DataGridCollectionViewSource (hash=28137373)
System.Windows.Data Warning: 74 : BindingExpression (hash=12661120): Activate with root item DataGridCollectionView (hash=49343907 Count=0)
System.Windows.Data Warning: 100 : BindingExpression (hash=12661120): Replace item at level 0 with DataGridCollectionView (hash=49343907 Count=0), using accessor {DependencyProperty.UnsetValue}
System.Windows.Data Warning: 97 : BindingExpression (hash=12661120): GetValue at level 0 from DataGridCollectionView (hash=49343907 Count=0) using <null>: Data``GridCollectionView (hash=49343907 Count=0)
System.Windows.Data Warning: 76 : BindingExpression (hash=12661120): TransferValue - got raw value DataGridCollectionView (hash=49343907 Count=0)
System.Windows.Data Warning: 85 : BindingExpression (hash=12661120): TransferValue - using final value DataGridCollectionView (hash=49343907 Count=0)
A first chance exception of type 'System.FormatException' occurred in mscorlib.dll 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T23:27:48.137

不确定您的问题是什么，绑定（除了缺少的结束引号）似乎很好。以下代码对我来说很好。

```
public class Quotes
{
    public string Description { get; set; }
    public decimal Value { get; set; }
}

public class ApplicationPresenter
{
    public ApplicationPresenter()
    {
        PriceList = new ObservableCollection<Quotes>()
        {
            new Quotes(){Description="Quote One", Value=10m},
            new Quotes(){Description="Quote Two", Value=10m},
            new Quotes(){Description="Quote Three", Value=10m},
            new Quotes(){Description="Quote Four", Value=10m},
        };
    }
    public ObservableCollection<Quotes> PriceList { get; private set; }
}

<Window 
    x:Class="ObjectDataProviderPresenterSample.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:xcdg="http://schemas.xceed.com/wpf/xaml/datagrid"
    xmlns:local="clr-namespace:ObjectDataProviderPresenterSample"
    Title="Window1" 
    Height="300" 
    Width="300" 
    >
    <Window.Resources>
        <ObjectDataProvider 
            x:Key="ApplicationPresenterDS" 
            ObjectType="{x:Type local:ApplicationPresenter}" 
            />
        <xcdg:DataGridCollectionViewSource 
            x:Key="price_list" 
            Source="{Binding 
                        Source={StaticResource ApplicationPresenterDS}, 
                        Path=PriceList}" 
            />            
    </Window.Resources>  

    <Grid>
        <xcdg:DataGridControl ItemsSource="{Binding Source={StaticResource price_list}}" />
    </Grid>
</Window> 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-11-05T08:46:38.693

我不确定，因为从您的代码中数据到 PriceList 的位置不是很清楚，但我看到的是这个集合在第二个 xaml 中只是空的。

在这两种情况下，在 xaml 中创建 ObjectDataProvider 只是通过默认构造函数创建 ApplicationPresenter 类型的对象。您的构造函数创建空集合 PriceList。（Ian 的构造函数创建 PriceList 并用假数据填充它。这就是他的示例有效的原因）。

因此，您示例的第二个 xaml 中的 DataGridCollectionViewSource 基本上是指具有空 PriceList 的 ApplicationPresenter。

相比之下，第一个 xaml 指的是 WebSitePricesView 的 PriceList，我相信它以某种方式填充在给定代码片之外的某个地方。

如果我的理论是好的，那么从第一个 xaml 中删除 ObjectDataProvider 不会有任何问题 - 它仍然可以工作，因为数据直接进入 presenter.PriceList。

但是，同样，我不确定。

# bash - 如何迭代 Bash 脚本中的参数

> ID：255898
> 
>         
> 
> 赞同：1059
> 
>         
> 
> 时间：2008-11-01T18:14:21.607
> 
>         
> 
> 标签：bash, command-line

我有一个复杂的命令，我想制作一个 shell/bash 脚本。我可以`$1`很容易地写出来：

```
foo $1 args -o $1.ext 
```

我希望能够将多个输入名称传递给脚本。正确的方法是什么？  

而且，当然，我想处理带有空格的文件名。

* * *

## 回答 #1

> 赞同：1743
> 
>             
> 
> 时间：2008-11-01T18:25:27.233

用于`"$@"`表示所有参数：

```
for var in "$@"
do
    echo "$var"
done 
```

这将遍历每个参数并将其打印在单独的行上。$@ 的行为类似于 $* ，只是在引用时，如果参数中有空格，则它们会被正确分解：

```
sh test.sh 1 2 '3 4'
1
2
3 4 
```

* * *

## 回答 #2

> 赞同：260
> 
>             
> 
> 时间：2008-11-01T23:04:33.707

^(*[重写VonC](https://stackoverflow.com/users/6309/vonc)现已删除的[答案](https://stackoverflow.com/a/255939/)。*)

[Robert Gamble](https://stackoverflow.com/a/255913/417685)的简洁回答直接涉及这个问题。这一个放大了包含空格的文件名的一些问题。

另请参阅：[/bin/sh 中的 ${1:+"$@"}](https://stackoverflow.com/questions/154625/1-in-binsh)

**基本论点：** `"$@"`是正确的，并且`$*`（未引用）几乎总是错误的。这是因为`"$@"`当参数包含空格时可以正常工作，并且与不包含空格时相同`$*`。在某些情况下，`"$*"`也可以，但`"$@"`通常（但不总是）在相同的地方工作。未引用，`$@`并且`$*`是等效的（并且几乎总是错误的）。

`$*`那么, `$@`, `"$*"`, 和之间有什么区别`"$@"`？它们都与“shell 的所有参数”有关，但它们做不同的事情。当未引用时，`$*`做`$@`同样的事情。他们将每个“单词”（非空白序列）视为一个单独的参数。但是，带引号的形式完全不同：`"$*"`将参数列表视为单个空格分隔的字符串，而`"$@"`将参数几乎完全按照在命令行中指定时的方式处理。
`"$@"`当没有位置参数时，扩展为空；`"$*"`扩展为一个空字符串——是的，有区别，尽管很难察觉。在引入（非标准）命令之后，请参阅下面的更多信息`al`。

**次要论点：**如果您需要处理带有空格的参数，然后将它们传递给其他命令，那么您有时需要非标准工具来协助。（或者你应该小心地使用数组：`"${array[@]}"`行为类似于`"$@"`。）

*例子：*

```
 $ mkdir "my dir" anotherdir
    $ ls
    anotherdir      my dir
    $ cp /dev/null "my dir/my file"
    $ cp /dev/null "anotherdir/myfile"
    $ ls -Fltr
    total 0
    drwxr-xr-x   3 jleffler  staff  102 Nov  1 14:55 my dir/
    drwxr-xr-x   3 jleffler  staff  102 Nov  1 14:55 anotherdir/
    $ ls -Fltr *
    my dir:
    total 0
    -rw-r--r--   1 jleffler  staff  0 Nov  1 14:55 my file

    anotherdir:
    total 0
    -rw-r--r--   1 jleffler  staff  0 Nov  1 14:55 myfile
    $ ls -Fltr "./my dir" "./anotherdir"
    ./my dir:
    total 0
    -rw-r--r--   1 jleffler  staff  0 Nov  1 14:55 my file

    ./anotherdir:
    total 0
    -rw-r--r--   1 jleffler  staff  0 Nov  1 14:55 myfile
    $ var='"./my dir" "./anotherdir"' && echo $var
    "./my dir" "./anotherdir"
    $ ls -Fltr $var
    ls: "./anotherdir": No such file or directory
    ls: "./my: No such file or directory
    ls: dir": No such file or directory
    $ 
```

为什么那行不通？它不起作用，因为 shell 在扩展变量之前会处理引号。因此，要让外壳注意嵌入的引号`$var`，您必须使用`eval`：

```
 $ eval ls -Fltr $var
    ./my dir:
    total 0
    -rw-r--r--   1 jleffler  staff  0 Nov  1 14:55 my file

    ./anotherdir:
    total 0
    -rw-r--r--   1 jleffler  staff  0 Nov  1 14:55 myfile
    $ 
```

当您有诸如“ `He said,
"Don't do this!"`”（带引号、双引号和空格）之类的文件名时，这会变得非常棘手。

```
 $ cp /dev/null "He said, \"Don't do this!\""
    $ ls
    He said, "Don't do this!"       anotherdir                      my dir
    $ ls -l
    total 0
    -rw-r--r--   1 jleffler  staff    0 Nov  1 15:54 He said, "Don't do this!"
    drwxr-xr-x   3 jleffler  staff  102 Nov  1 14:55 anotherdir
    drwxr-xr-x   3 jleffler  staff  102 Nov  1 14:55 my dir
    $ 
```

shell（所有这些）并没有使处理这些东西特别容易，所以（很有趣）许多 Unix 程序不能很好地处理它们。在 Unix 上，文件名（单个组件）可以包含除斜杠和 NUL 之外的任何字符`'\0'`。但是，shell 强烈建议在路径名中的任何位置都不要使用空格、换行符或制表符。这也是标准 Unix 文件名不包含空格等的原因。

在处理可能包含空格和其他麻烦字符的文件名时，您必须非常小心，而且我很久以前就发现我需要一个在 Unix 上不标准的程序。我称之为`escape`（1.1 版的日期为 1989-08-23T16:01:45Z）。

这是一个`escape`使用中的示例 - 与 SCCS 控制系统一起使用。它是一个封面脚本，同时执行`delta`（想想*签入*）和
`get`（想想*签出*）。各种参数，尤其是`-y`（您进行更改的原因）将包含空格和换行符。请注意，该脚本可追溯到 1992 年，因此它使用反引号而不是
`$(cmd ...)`符号，并且不在`#!/bin/sh`第一行使用。

```
:   "@(#)$Id: delget.sh,v 1.8 1992/12/29 10:46:21 jl Exp $"
#
#   Delta and get files
#   Uses escape to allow for all weird combinations of quotes in arguments

case `basename $0 .sh` in
deledit)    eflag="-e";;
esac

sflag="-s"
for arg in "$@"
do
    case "$arg" in
    -r*)    gargs="$gargs `escape \"$arg\"`"
            dargs="$dargs `escape \"$arg\"`"
            ;;
    -e)     gargs="$gargs `escape \"$arg\"`"
            sflag=""
            eflag=""
            ;;
    -*)     dargs="$dargs `escape \"$arg\"`"
            ;;
    *)      gargs="$gargs `escape \"$arg\"`"
            dargs="$dargs `escape \"$arg\"`"
            ;;
    esac
done

eval delta "$dargs" && eval get $eflag $sflag "$gargs" 
```

（这些天我可能不会那么彻底地使用 escape - 例如，参数不需要它`-e`- 但总的来说，这是我使用的更简单的脚本之一`escape`。）

该`escape`程序只是输出它的参数，就像这样`echo`
做一样，但它确保参数受到保护以供使用
`eval`（一级`eval`；我确实有一个执行远程 shell 执行的程序，并且需要转义 的输出`escape`）。

```
 $ escape $var
    '"./my' 'dir"' '"./anotherdir"'
    $ escape "$var"
    '"./my dir" "./anotherdir"'
    $ escape x y z
    x y z
    $ 
```

我有另一个名为的程序`al`，它每行列出一个参数（它甚至更古老：1.1 版，日期为 1987-01-27T14:35:49）。它在调试脚本时最有用，因为它可以插入命令行以查看实际传递给命令的参数。

```
 $ echo "$var"
    "./my dir" "./anotherdir"
    $ al $var
    "./my
    dir"
    "./anotherdir"
    $ al "$var"
    "./my dir" "./anotherdir"
    $ 
```

[*补充：*
现在为了展示各种`"$@"`符号之间的区别，这里还有一个例子：

```
$ cat xx.sh
set -x
al $@
al $*
al "$*"
al "$@"
$ sh xx.sh     *      */*
+ al He said, '"Don'\''t' do 'this!"' anotherdir my dir xx.sh anotherdir/myfile my dir/my file
He
said,
"Don't
do
this!"
anotherdir
my
dir
xx.sh
anotherdir/myfile
my
dir/my
file
+ al He said, '"Don'\''t' do 'this!"' anotherdir my dir xx.sh anotherdir/myfile my dir/my file
He
said,
"Don't
do
this!"
anotherdir
my
dir
xx.sh
anotherdir/myfile
my
dir/my
file
+ al 'He said, "Don'\''t do this!" anotherdir my dir xx.sh anotherdir/myfile my dir/my file'
He said, "Don't do this!" anotherdir my dir xx.sh anotherdir/myfile my dir/my file
+ al 'He said, "Don'\''t do this!"' anotherdir 'my dir' xx.sh anotherdir/myfile 'my dir/my file'
He said, "Don't do this!"
anotherdir
my dir
xx.sh
anotherdir/myfile
my dir/my file
$ 
```

请注意，在命令行中没有保留`*`和之间的原始空白。`*/*`另外，请注意，您可以使用以下命令更改 shell 中的“命令行参数”：

```
set -- -new -opt and "arg with space" 
```

这设置了 4 个选项，' `-new`'、' `-opt`'、' `and`' 和 ' `arg with space`'。

]

嗯，这是一个很长的*答案*——也许*解释*是更好的术语。可根据要求提供源代码`escape`（通过电子邮件发送至 gmail dot com 的 firstname dot lastname）。的源代码`al`非常简单：

```
#include <stdio.h>
int main(int argc, char **argv)
{
    while (*++argv != 0)
        puts(*argv);
    return(0);
} 
```

就这样。它相当于`test.sh`Robert Gamble 展示的脚本，可以写成 shell 函数（但我第一次写的时候本地版本的 Bourne shell 中不存在 shell 函数`al`）。

另请注意，您可以编写`al`为简单的 shell 脚本：

```
[ $# != 0 ] && printf "%s\n" "$@" 
```

需要条件，以便在不传递任何参数时不产生输出。该`printf`命令将生成一个仅包含格式字符串参数的空行，但 C 程序不生成任何内容。

* * *

## 回答 #3

> 赞同：148
> 
>             
> 
> 时间：2009-12-31T22:25:49.187

请注意，罗伯特的答案是正确的，它也适用`sh`。您可以（可移植地）进一步简化它：

```
for i in "$@" 
```

相当于：

```
for i 
```

即，你不需要任何东西！

测试（`$`是命令提示符）：

```
$ set a b "spaces here" d
$ for i; do echo "$i"; done
a
b
spaces here
d
$ for i in "$@"; do echo "$i"; done
a
b
spaces here
d 
```

我首先在Kernighan 和 Pike的*Unix Programming Environment*中读到了这一点。

在`bash`中，`help for`记录了这一点：

> `for NAME [in WORDS ... ;] do COMMANDS; done`
> 
>   
>   
> 
> 如果`'in WORDS ...;'`不存在，则`'in "$@"'`假定。

* * *

## 回答 #4

> 赞同：74
> 
>             
> 
> 时间：2012-10-29T08:36:10.083

对于简单的情况，您也可以使用`shift`. 它将参数列表视为队列。每个都`shift`抛出第一个参数，并且每个剩余参数的索引都递减。

```
#this prints all arguments
while test $# -gt 0
do
    echo "$1"
    shift
done 
```

* * *

## 回答 #5

> 赞同：26
> 
>             
> 
> 时间：2017-10-30T00:58:36.800

您还可以将它们作为数组元素访问，例如，如果您不想遍历所有这些元素

```
argc=$#
argv=("$@")

for (( j=0; j<argc; j++ )); do
    echo "${argv[j]}"
done 
```

* * *

## 回答 #6

> 赞同：10
> 
>             
> 
> 时间：2021-01-31T17:53:52.453

对 $#（参数变量的数量）进行循环也可以。

```
#! /bin/bash

for ((i=1; i<=$#; i++))
do
  printf "${!i}\n"
done 
```

```
test.sh 1 2 '3 4' 
```

输出：

```
1
2
3 4 
```

* * *

## 回答 #7

> 赞同：6
> 
>             
> 
> 时间：2020-02-02T02:56:40.367

放大 baz 的答案，如果您需要使用索引枚举参数列表（例如搜索特定单词），您可以在不复制列表或对其进行变异的情况下执行此操作。

假设您想在双破折号（“--”）处拆分参数列表，并将破折号之前的参数传递给一个命令，并将破折号之后的参数传递给另一个命令：

```
 toolwrapper() {
   for i in $(seq 1 $#); do
     [[ "${!i}" == "--" ]] && break
   done || return $? # returns error status if we don't "break"

   echo "dashes at $i"
   echo "Before dashes: ${@:1:i-1}"
   echo "After dashes: ${@:i+1:$#}"
 } 
```

结果应如下所示：

```
 $ toolwrapper args for first tool -- and these are for the second
 dashes at 5
 Before dashes: args for first tool
 After dashes: and these are for the second 
```

* * *

## 回答 #8

> 赞同：4
> 
>             
> 
> 时间：2016-01-14T14:20:54.960

```
aparse() {
while [[ $# > 0 ]] ; do
  case "$1" in
    --arg1)
      varg1=${2}
      shift
      ;;
    --arg2)
      varg2=true
      ;;
  esac
  shift
done
}

aparse "$@" 
```

* * *

## 回答 #9

> 赞同：2
> 
>             
> 
> 时间：2020-03-03T15:31:25.570

**getopt**在脚本中使用命令来格式化任何命令行选项或参数。

```
#!/bin/bash
# Extract command line options & values with getopt
#
set -- $(getopt -q ab:cd "$@")
#
echo
while [ -n "$1" ]
do
case "$1" in
-a) echo "Found the -a option" ;;
-b) param="$2"
echo "Found the -b option, with parameter value $param"
shift ;;
-c) echo "Found the -c option" ;;
--) shift
break ;;
*) echo "$1 is not an option";;
esac
shift 
```

# php - 您如何管理 PHP 项目开发生命周期？

> ID：255902
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2008-11-01T18:19:34.983
> 
>         
> 
> 标签：php, lifecycle

我从事过几个 PHP 项目，但在组织工作时总是遇到问题。您在哪里开发您的应用程序 - 在本地主机、远程服务器或生产服务器上（！）？当我在创建一些主要路径后在本地主机上工作时，我通过 ftp 发送新文件 - 但有时它碰巧忘记了一个文件，浏览多个方向以复制更改的文件只是很累。您提出了哪些最佳实践？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2008-11-01T18:45:00.437

这是我们管理商业网站的方式：

1.  在本地沙盒中开发

2.  签到 SVN

3.  从 SVN 到内部开发服务器的自动构建/测试

4.  使用 rsync 脚本化部署到 QA/UAT 的登台服务器

5.  脚本化部署到生产服务器上。

暂存和生产服务器都由 ISP 托管，硬件和版本匹配并运行 RHEL，内部开发服务器与 CentOS 版本匹配。

这样，当代码到达生产服务器时，不应该有任何令人讨厌的意外，因为即使部署脚本在第 4 阶段也得到检查。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T18:30:38.813

[Google App Engine](http://code.google.com/appengine/)有一个合适的工具，可以自动将修改后的文件上传到生产环境；不知道PHP是否有类似的东西。因此，执行 dev2prod 脚本（自动执行此操作的脚本）应该是一个很好的解决方案。

做本地源文件管理，大家可能会建议你使用[源代码控制系统](http://en.wikipedia.org/wiki/Revision_control)。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T18:30:29.437

我正在一台开发机器上进行开发，该机器具有与生产环境相同的环境 - 由于不同的版本或配置，它可以防止一些不同的行为。完成后，我只是将所有文件移到生产服务器上。

[Winmerge](http://www.winmerge.org/)是一个不错的免费 Windows 工具，用于在开发机器和生产机器之间区分文件。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T22:32:17.280

在本地机器上使用与开发环境相同的配置（即 apache mods、php 扩展等）进行开发，使用版本控制系统（我更喜欢 SVN）来跟踪修改过的文件等等。

然后，您可以在生产或测试环境中编写脚本，将存储库中的文件复制/更新到 Web 服务器路径。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2014-03-09T03:54:07.330

可能会因为重定向旧帖子而被告知，但这是我使用免费工具的方法：

我使用 Netbeans、Git、bitbucket、源代码树、gitflow 和 FTPloy。

Bitbucket.com：注册免费帐户。SourceTree：从 bitbucket 中免费。管理 git 存储库的好工具。所有的提交、合并和拉取都可以在这里完成。可以跟踪 bitbucket 中的问题。

在 sourcetree 中，选择 master 分支并单击“git flow” - google gitflow - 这是功能、修补程序、开发和发布分支的出色工作流程，并且 sourcetree 有助于自动化该过程。  

FTPloy.com 自动部署您的主分支。免费是一个存储库/服务器。但如果您想将开发分支推送到服务器沙箱进行测试，则值得升级。

希望这对搜索网络的人有所帮助！

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2020-07-26T15:59:12.153

这是我自己的 PHP 开发生命周期。

1.  在 Github 或 Bitbucket 上创建 GIT 私有存储库。

2.  将 GIT 与 cPanel 连接。（将更改提交到 repo 以及生产服务器非常容易）。

3.  使用 Visual Studio Code 或 Sublime Text 在 Localhost（可能在 Windows 上的 Xampp）上开发

4.  初始化 GIT 并连接到私有存储库。

5.  将更改推送到 GIT 存储库（主/分支） - 主更改将自动上传到生产服务器。

# dynamics-crm - 在 MS CRM 4.0 中创建或更新自定义实体

> ID：255904
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T18:21:00.067
> 
>         
> 
> 标签：dynamics-crm, dynamics-crm-4

对于一项要求，我被要求将信息导出到在 MS CRM 4.0 中创建的自定义实体中。我正在尝试以编程方式执行此操作，但我还没有找到实际完成此操作的单个代码。我编写了代码来检查实体中是否存在某个字段的某个值，但是创建一个新实体对我来说似乎有点困惑。对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-06-22T08:56:34.163

要从代码创建自定义实体，您需要使用 MetadataService Web 服务。'CreateEntity' 方法用于创建自定义实体。

用于 v4.0 的 CRM SDK 向您展示了如何：

[创建实体消息（元数据服务）](http://msdn.microsoft.com/en-us/library/cc156288.aspx)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T19:24:58.923

这是我在 MS CRM 3.0 中有类似要求时的经验。我开始使用 CRM sdk 导入数据，但发现并不容易。

然后我最终使用[了 CRM 的 Scribe 适配器](http://www.scribesoftware.com/scribe-adapters.asp)。它不是免费的，但可以轻松解决您导入自定义实体的问题。将发布一些链接。需要浏览一些旧书签。

不确定此功能是否适用于 CRM 4.0。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-08-20T09:13:16.963

我一直在使用的一个产品是来自 Simego 的 DataSync（它有一个支持 MS CRM 4.0 的插件）[http://www.simego.net/products/Data-Synchronisation-Studio](http://www.simego.net/products/Data-Synchronisation-Studio)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T19:40:12.167

感谢您的链接。我对 Scribe Adapter 很熟悉。Catch 是客户想要 MS CRM 4.0 中的这个导入向导。无论如何，我[在这里](http://nishantrana.wordpress.com/2008/10/29/understanding-dynamicentity-in-microsoft-dynamic-crm/)找到了我的解决方案的答案。谢谢你的回复:)。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-09T07:19:14.060

在 MSCRM 4.0 中使用从 CSV 导入功能有什么问题？它迎合自定义实体（3.0 没有）并允许良好的映射功能和保存映射？

# mysql - 如何同步开发和生产数据库

> ID：255905
> 
>         
> 
> 赞同：43
> 
>         
> 
> 时间：2008-11-01T18:21:05.993
> 
>         
> 
> 标签：mysql, synchronization

你知道同步两个数据库的任何应用程序吗？在开发过程中，有时需要添加一两个表行或新表或列。通常我在某个文件中编写每个 sql 语句，并且在上传路径期间，我在我的生产数据库中删除这些行（之前备份它）。我使用 mySQL 和 postreSQL 数据库。

你的做法是什么，哪些应用程序可以帮助你。

* * *

## 回答 #1

> 赞同：30
> 
>             
> 
> 时间：2010-10-12T11:46:52.247

您要求提供工具或应用程序答案，但您真正需要的是流程答案。这里的基本主题是您应该对数据库 DDL（和 DML，如果需要）进行版本控制，并提供更改脚本以便能够将数据库的任何版本更新到更高版本。

由 Jeff Atwood 提供并由 K. Scott Allen 编写的这组链接详细解释了这应该是什么样子 - 他们做得比我在这里写的要好：http:   [//www.codinghorror.com/blog/ 2008/02/get-your-database-under-version-control.html](http://www.codinghorror.com/blog/2008/02/get-your-database-under-version-control.html)

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2008-11-01T18:38:48.343

对于 PostgreSQL，您可以使用[Another PostgreSQL Diff Tool](http://apgdiff.sourceforge.net/)。它可以非常快速地区分两个 SQL 转储（在具有大约 300 个表、50 个视图和 500 个存储过程的数据库上只需几秒钟）。因此，您可以轻松找到您的更改并获得可以执行的 sql 差异。

从 APGDiff 页面：

> 另一个 PostgreSQL Diff Tool 是简单的 PostgreSQL diff 工具，可用于模式升级。该工具比较两个模式转储文件并创建适合升级旧模式的输出文件（经过一些手工修改后）。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2008-11-01T18:25:24.800

拥有只添加到底部的脚本（当然是在源代码控制下）。结合从您的生产数据库到开发的定期恢复，您应该是黄金。如果您对此要求严格，则效果很好。

否则，我知道很多人为 SQLServer 使用 redgate 的东西。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-11-01T19:53:16.790

对 RedGate SQL 比较的另一票

[http://www.red-gate.com/products/SQL_Compare/index.htm](http://www.red-gate.com/products/SQL_Compare/index.htm)

没有它不想活！

编辑：对不起，这似乎只适用于 SQL Server。仍然 - 如果任何 SQL Server 用户有同样的问题，我肯定会推荐这个工具。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-11-03T20:35:33.787

如果您为您的开发数据库编写 SQL 语句（我想这是一系列 DDL 指令，例如 CREATE、ALTER 和 DROP），为什么不通过将它们记录在一个表中来跟踪它们，并带有“版本” “ 指数？然后，您将能够：

1.  跟踪您的版本更改

2.  制定一个小例程，通过将记录的指令发送到数据库来“自动”更新您的生产数据库。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-11-02T11:19:09.667

我真的很喜欢[EMS 工具](http://sqlmanager.net)。

这些工具适用于所有流行的数据库，并且您对每种类型的数据库都有相同的用户体验。

工具之一是 DB 比较器。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2010-10-12T14:36:54.073

蟾蜍

过去曾多次救过许多驴。为什么人们在没有退出策略的情况下运行 sql？

红门一号也不错。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T18:25:25.487

Siebel（CRM、销售等管理产品）有一个内置工具可以将生产数据库与开发数据库保持一致（dev2prod）。

否则，您必须坚持使用手动执行的脚本。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T18:28:20.457

[Navicat](http://navicat.com/)有一个结构同步向导来处理这个。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2014-01-02T20:29:16.690

[DBV](https://github.com/victorstanciu/dbv) - “数据库版本控制，变得简单！” (PHP)

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T21:47:31.100

我通过使用[Hibernate](http://www.hibernate.org/)解决了这个问题。它可以检测并自动创建丢失的表、列等。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2010-10-13T08:25:10.617

[您可以使用dbDeploy](http://dbdeploy.com/)或类似的脚本为您当前的工作方式添加一些自动化。这将允许您跟踪您的架构更改并在您认为合适的时候升级/回滚您的架构。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2011-09-08T19:54:03.557

这是我为同步 Magento 数据库而编写的直接 linux bash 脚本......但您可以轻松修改它以用于其他用途:)

[http://markshust.com/2011/09/08/syncing-magento-instance-production-development](http://markshust.com/2011/09/08/syncing-magento-instance-production-development)

# c# - 如何在 C# 中的 System.Windows.Forms.Button 上放置 unicode 字符？

> ID：255907
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-11-01T18:23:34.037
> 
>         
> 
> 标签：c#, visual-studio, unicode, character

在 C# WinForms 项目的 Visual Studio 2008 中，表单上有一个按钮。在属性视图中，属性“字体”设置为“Arial Unicode MS”。

我需要在“文本”属性中添加什么，以便在按钮上显示 unicode 字符 \u0D15？

当我将 \u0D15 放入“Text”属性时，按钮显示六个字符“\u0D15”而不是一个 unicode 字符。

在以下 PDF 中，您可以看到 \u0D15 的 unicode 字符：http:
 [//unicode.org/charts/PDF/U0D00.pdf](http://unicode.org/charts/PDF/U0D00.pdf)

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2008-11-01T18:28:19.347

您不必转义字符串中的 unicode 字符，因为 C# 本质上是 unicode。只需将您的 unicode 字符原样放入字符串中即可。例如：

```
button1.Text = "日本"; 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T18:26:38.960

一种可能的方法是运行“charmap”并从那里复制粘贴或从其他地方复制粘贴。

* * *

## 回答 #3

> 赞同：-2
> 
>             
> 
> 时间：2021-05-25T19:06:30.950

只需在 C# 代码中尝试以下操作：

```
button.Text = "0x0D15"; 
```

# eclipse - BIRT：pdf 发射器，从相对路径或 jar 文件加载/使用字体

> ID：255916
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-11-01T18:27:51.923
> 
>         
> 
> 标签：eclipse, pdf, reporting, report, birt

我从早期就使用 BIRT，但仍然对 PDF 发射器有疑问。

**短篇小说**：我可以配置 fontsConfig.xml 以从相对路径或 jar 加载字体吗？

**长话短说：**
我们同时使用 FOP 和 BIRT 在我们的 Web 应用程序中生成 PDF。在库之间共享字体会很好。不幸的是，我找不到使用 BIRT 2.3.1 的方法

万恶之源是 fontsConfig.xml 如果我如下所示配置它，它可以正常工作：

```
<font-paths>
<path path="fonts"/>
</font-paths> 
```

但是路径不允许我使用相对路径和类路径（或者我找不到合适的方式来配置它）。config1 和 config2 都不起作用。

配置1：

```
<font-paths>
<path path="../fonts"/>
</font-paths> 
```

配置2：

```
<font-paths>
<path path="classpath:fonts"/>
</font-paths> 
```

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2014-02-11T14:47:04.547

对于某些 BIRT 版本，您可以使用 SystemProperty “birt.font.dirs”。这会覆盖 fontsConfig.xml。

好吧，这曾经有效，但显然后来它从 BIRT 源代码中删除了。

现在你可以调用类似的东西

```
EngineConfig engineConfig = new EngineConfig();
URL fontsConfigurationURL = new URL("file:///path/to/my/fontsConfig.xml");
engineConfig.setFontConfig(fontsConfigurationURL);

Platform.startup(engineConfig); 
```

这允许您为 BIRT 提供自定义版本的 fontsConfig.xml，而无需在 JAR 中四处寻找。

使用 BIRT 4.3.0 测试。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2014-03-06T14:20:56.327

有一种方法可以在 Birt 中使用相对路径上的字体。

您需要做的是将字体复制到 Web 应用程序中的某个位置。我的在：C:\\src\main\webapp\Reports

现在在应用程序中，使用以下命令从上述位置注册字体。

```
FontFactory.registerDirectory( scContext.getRealPath("/Reports") ); 
```

这将注册字体。

**通过 Spring MVC 在 Birt 4.3 上测试**

# asp.net - 关于使用哪种模式弹出窗口的建议：ASP.NET AjaxControlToolkit vs jQuery 插件 vs Greybox vs?

> ID：255926
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-11-01T18:32:08.763
> 
>         
> 
> 标签：asp.net, javascript, ajax, user-interface, popup

这一切都在 ASP.NET Web 表单应用程序中完成：

我需要一个模式弹出窗口，它将向用户显示与搜索条件匹配的图像的预览（例如，他们搜索“狗”并且弹出窗口向他们显示所有与狗相关的图片）。搜索结果不应该太长，但弹出窗口应该支持在必要时滚动的能力。我还需要捕获他们选择的图像并将该信息发送回调用页面。

我已经查看了一些选项，并且很难决定使用哪个选项。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T19:10:55.300

我更喜欢使用 jquery，因为它不需要使用任何服务器端计算。此外，如果该应用程序曾经移植到 asp.net 以外的其他技术，它仍然很可能可以工作。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T19:38:21.750

我对[jqModal](http://dev.iceburg.net/jquery/jqModal/)很满意，这个插件非常简约（基本上 2.97kb 的 JS 和 496 字节的 css）并且效果很好......

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-10T07:21:45.743

不要使用任何模态插件，创建你自己的。

<div id="modal"></div>

# 模态{位置：绝对；顶部：200px；左：200px；z 指数：12；宽度：200px；高度：100px；背景：红色；颜色：蓝色；}

然后你可以在上面放一些javascript，我推荐jquery的可拖动，然后放一些你可以点击的元素让它消失。

瞧！！！

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-11-20T09:03:23.063

我会说和我们一起去；[Ajax Calendar Starter-Kit](http://ra-ajax.org/samples/Viewport-Calendar-Starter-Kit.aspx)（单击左下角的按钮）但我又一次肯定有偏见......

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T19:26:46.063

我对 jQuery 插件[Simple Modal](http://www.ericmmartin.com/projects/simplemodal/)非常满意。

# ios - -didSelectRowAtIndexPath：未被调用

> ID：255927
> 
>         
> 
> 赞同：304
> 
>         
> 
> 时间：2008-11-01T18:32:26.343
> 
>         
> 
> 标签：ios, uitableview, cocoa-touch, didselectrowatindexpath

我正在编写一个在选项卡视图中带有表格视图的 iOS 应用程序。在我的`UITableViewController`, 我实现`-tableView:didSelectRowAtIndexPath:`了 ，但是当我在运行时选择一行时，没有调用该方法。不过，表格视图正在被填充，所以我知道我的控制器中的其他 tableView 方法正在被调用。

有谁知道我可能搞砸了什么来实现这一点？

* * *

## 回答 #1

> 赞同：534
> 
>             
> 
> 时间：2012-09-25T16:55:11.947

以防万一有人犯了和我一样的愚蠢错误：

检查您期望的方法名称是否`didSelect`可能以某种方式意外获得`didDeselect`。我花了大约两个小时才发现...

* * *

## 回答 #2

> 赞同：516
> 
>             
> 
> 时间：2012-10-12T09:05:34.480

可能导致问题的另一件事是未选择选择类型：

![UITableView 选择种类](https://i.stack.imgur.com/IxRWD.png)

应该是`Single Selection`正常选择，*不*应该`No Selection`。

要以编程方式执行此操作，请执行以下操作：

```
tableView.allowsSelection = YES 
```

* * *

## 回答 #3

> 赞同：302
> 
>             
> 
> 时间：2012-11-02T16:20:01.050

另一种可能性是 UITapGestureRecognizer 可能正在吃掉这些事件，就像这里的情况一样：[https ://stackoverflow.com/a/9248827/214070](https://stackoverflow.com/a/9248827/214070)

我没有怀疑这个原因，因为表格单元格仍然会突出显示蓝色，就好像水龙头正在通过一样。

* * *

## 回答 #4

> 赞同：151
> 
>             
> 
> 时间：2012-05-05T21:30:56.280

**所有的好答案，但还有一个要注意...**

*（特别是在以编程方式创建 UITableView 时）*

`[tableView setAllowsSelection:YES];`确保 tableView 可以通过设置或删除任何将其设置为 的行来响应选择`NO`。

* * *

## 回答 #5

> 赞同：98
> 
>             
> 
> 时间：2008-11-01T19:00:09.487

听起来该类可能不是该`UITableViewDelegate`表视图的，尽管`UITableViewController`应该自动设置。

您有没有机会将代表重置为其他班级？

* * *

## 回答 #6

> 赞同：94
> 
>             
> 
> 时间：2015-01-30T09:22:40.883

如果出现问题，`UITapGestureRecognizer`您可以解决此问题：

*   在故事板中：

![在此处输入图像描述](https://i.stack.imgur.com/BJlAK.png)

在代码中`Objective-C`：

```
UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(dismissKeyboard)]; 
[self.view addGestureRecognizer:tap];

[tap setCancelsTouchesInView:NO]; 
```

在代码中`Swift`：

```
let tap = UITapGestureRecognizer(target: self, action:Selector("dismissKeyboard"))
view.addGestureRecognizer(tap)

tap.cancelsTouchesInView = false 
```

* * *

## 回答 #7

> 赞同：68
> 
>             
> 
> 时间：2008-11-01T23:54:02.500

在这种情况下，我遇到了两件事。

1.  您可能忘记实现 UITableViewDelegate 协议，或者您的类和表视图之间没有委托出口。

2.  您的行内可能有一个 UIView ，它是第一响应者，并会带走您的点击。说一个 UIButton 或类似的东西。

* * *

## 回答 #8

> 赞同：45
> 
>             
> 
> 时间：2010-10-26T12:37:12.307

我曾经也有过一样的问题。而且很难找到。但在我的代码中某处是这样的：

```
- (NSIndexPath *)tableView:(UITableView *)tableView willSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    return nil;
} 
```

它必须是`return indexPath`，否则`-tableView:didSelectRowAtIndexPath:`不会被调用。

* * *

## 回答 #9

> 赞同：39
> 
>             
> 
> 时间：2016-02-24T08:19:09.557

如果你在 UITableView 上添加了一个gestureRecognizer，`didSelectRowAtIndexPath`将不会被调用。

因此，您需要使用gestureRecognizer 委托方法来避免在特定视图中触摸。

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch {
    if ([touch.view isDescendantOfView:YourTable]) {
        return NO;
    }
    return YES;
} 
```

* * *

## 回答 #10

> 赞同：30
> 
>             
> 
> 时间：2013-07-23T05:05:47.217

我遇到了一个问题，几个月不看我的代码后，我忘记了由于一些不必要的要求而实现了以下方法

```
- (BOOL)tableView:(UITableView *)tableView shouldHighlightRowAtIndexPath:(NSIndexPath  *)indexPath{
    return NO;
} 
```

它应该为一行返回 YES 以使其被选中。

* * *

## 回答 #11

> 赞同：24
> 
>             
> 
> 时间：2016-07-25T11:02:22.013

您必须选择这些选项

[![在此处输入图像描述](https://i.stack.imgur.com/17mjH.png)](https://i.stack.imgur.com/17mjH.png)

但是如果你想`UITableView`在点击时不突出显示，那么你应该在`UITableViewCell`属性中进行更改。

为选择选择无选项，如下所示

[![在此处输入图像描述](https://i.stack.imgur.com/KC3mu.png)](https://i.stack.imgur.com/KC3mu.png)

* * *

## 回答 #12

> 赞同：21
> 
>             
> 
> 时间：2014-02-10T19:48:29.980

我在我的桌面视图上放了一个`UITapGestureRecognizer`以关闭阻止`didSelectRowAtIndexPath:`被调用的键盘。希望它可以帮助某人。

* * *

## 回答 #13

> 赞同：19
> 
>             
> 
> 时间：2012-02-22T02:50:32.560

如果您遇到和我一样的问题：显然，如果您的 tableView 处于编辑模式，则不会调用此方法。您必须将allowSelectionDuringEditing 设置为true。

通过这个问题：[编辑时，`UITableView` 不调用 didSelectRowAtIndexPath ??](https://stackoverflow.com/questions/3047538/enable-editing-does-not-call-didselectrowatindexpath)

* * *

## 回答 #14

> 赞同：19
> 
>             
> 
> 时间：2014-06-10T07:47:01.710

我有同样的问题，

原因是使用`UITapGestureRecognizer`. 当我点击其他任何地方时，我希望键盘关闭。我意识到这会覆盖所有点击动作，这就是为什么`didSelectRowAtIndexPath`没有调用函数。

当我评论与 相关的行时`UITapGestureRecognizer`，它可以工作。此外，您可以检查`UITapGestureRecognizer selector`是否被点击的功能`UITableViewCell`。

* * *

## 回答 #15

> 赞同：15
> 
>             
> 
> 时间：2018-09-06T16:45:53.137

在我的情况下，没有调用 didSelctRowAtIndexPath 是因为我在 tableView 的**Selection**属性中选择了**none ，设置为****单选**解决了我的问题

 ****[![在此处输入图像描述](https://i.stack.imgur.com/IEvtN.png)](https://i.stack.imgur.com/IEvtN.png)

* * *

## 回答 #16

> 赞同：11
> 
>             
> 
> 时间：2015-09-28T07:31:56.163

对于 Xcode 6.4，Swift 1.2。选择“标签”已在 IB 中更改。我不知道如何以及为什么。将其设置为“单选”使我的表格视图单元格再次可选择。  [![在此处输入图像描述](https://i.stack.imgur.com/ld8wi.png)](https://i.stack.imgur.com/ld8wi.png)

* * *

## 回答 #17

> 赞同：10
> 
>             
> 
> 时间：2012-03-06T21:24:19.413

即使另一个答案已被接受，我也会为观察此问题的人添加一个可能的问题和解决方案：

如果您打开了自动引用计数 (ARC)，您可能会发现即使将控制器指定为视图的委托后，由于 ARC 正在删除控制器，因此不会收到视图发送给控制器的消息。显然 UITableView 的委托指针不算作 ARC 的引用，所以如果这是对它的唯一引用，控制器将被释放。您可以通过在控制器上实现 dealloc 方法并在那里设置断点或 NSLog 调用来验证这是否发生。

解决方案是在其他地方使用强引用来跟踪控制器，直到您确定不再需要它为止。

* * *

## 回答 #18

> 赞同：10
> 
>             
> 
> 时间：2013-02-21T16:59:19.040

记得在 viewDidLoad 方法中设置 datasource 和 delegate 如下：

```
[self.tableView setDelegate:self];

[self.tableView setDataSource:self]; 
```

* * *

## 回答 #19

> 赞同：9
> 
>             
> 
> 时间：2011-07-02T21:04:35.210

我的问题不是以上任何一个。而且很蹩脚。但我想我会在这里列出它以防它帮助某人。

我有一个`tableViewController`是我的“基本”控制器，然后我创建了这个控制器的子类。我`tableView:didSelectRowAtIndexPath`在“基”类的例程中编写了所有代码。完全忘记了默认情况下，这个例程也在我的所有子类中创建（尽管没有代码做任何事情）。所以当我运行我的应用程序时，它运行了代码的子类版本，什么也没做，这让我很伤心。因此，当然，一旦我从子类中删除了该例程，它就使用了 mt“基”类例程，并且我在做生意。

我知道。不要笑。但也许这会节省我失去的时间......

* * *

## 回答 #20

> 赞同：9
> 
>             
> 
> 时间：2012-05-31T00:36:25.453

给我2美分。

我有一个自定义 UITableViewCell 并且有一个按钮覆盖整个单元格，所以当触摸发生时，按钮被选中而不是单元格。

要么删除按钮，要么在我的情况下，我将按钮上的 User Interation Enable 设置为 false，这样单元格就是被选中的单元格。

* * *

## 回答 #21

> 赞同：8
> 
>             
> 
> 时间：2012-07-19T12:28:39.820

如果您阅读此内容，那么仍然无法解决问题。

我有**自定义**单元格，其中复选框“**启用用户交互**”被禁用。所以，我只是打开它。祝你好运。

* * *

## 回答 #22

> 赞同：7
> 
>             
> 
> 时间：2014-07-25T01:44:35.927

我刚刚有了这个，就像过去发生在我身上的那样，它没有用，因为我在尝试添加方法时没有注意自动完成功能，实际上我最终实现了`tableView:didDeselectRowAtIndexPath`: 而不是`tableView:didSelectRowAtIndexPath:`.

* * *

## 回答 #23

> 赞同：7
> 
>             
> 
> 时间：2015-03-13T07:18:17.847

确保您实施`tableView:didSelectRowAtIndexPath`而不是`tableView:didDeSelectRowAtIndexPath`

这让我不止几次！

* * *

## 回答 #24

> 赞同：6
> 
>             
> 
> 时间：2019-08-08T12:48:41.930

请检查 UITapGestureRecognizer。在我的情况下，为放置 tableview 的视图添加了 tapgesture，它正在像 didselect 一样吃掉 UITableview 的用户交互。在为视图禁用 Tapgesture 后，触发了 didselect 委托。

* * *

## 回答 #25

> 赞同：5
> 
>             
> 
> 时间：2016-06-28T02:58:51.710

如果您的表格视图处于编辑模式（例如`[tableView setEditing:YES animated:NO];`），您需要设置`tableView.allowsSelectionDuringEditing = YES;`

* * *

## 回答 #26

> 赞同：5
> 
>             
> 
> 时间：2017-03-14T14:46:38.657

在我的情况下，解决方案是在下面的函数中将 NO 更改为 YES。

iOS 9+

```
- (BOOL)tableView:(UITableView *)tableView shouldHighlightRowAtIndexPath:(NSIndexPath *)indexPath
{
    return YES;
} 
```

* * *

## 回答 #27

> 赞同：5
> 
>             
> 
> 时间：2018-02-22T17:44:43.607

检查您`viewController`是否有以下方法：

```
- (BOOL) tableView:(UITableView *)tableView shouldHighlightRowAtIndexPath:(NSIndexPath *)indexPath {
    return NO;
} 
```

如果您返回“NO”，则不会调用 didSelectRow

* * *

## 回答 #28

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T20:29:32.267

我知道是旧的并且问题已解决，但是有类似的问题，我认为问题出在我的自定义 UITableViewCell 上，但解决方案完全不同 - 我重新启动 XCode :) 然后工作正常！几乎像 Windows :)

* * *

## 回答 #29

> 赞同：4
> 
>             
> 
> 时间：2013-06-29T07:56:38.390

您可能会犯的另一个错误（就像我一样）：如果您在单元格上设置了一个 segue，`didSelectRowAtIndexPath`则不会调用。你应该在视图控制器上设置你的 segues。

* * *

## 回答 #30

> 赞同：4
> 
>             
> 
> 时间：2013-07-27T00:10:39.630

这些答案都不适合我。大约一个小时后，我发现了一些非常阴险的东西：

我在另一个表格视图的单元格中有一个表格视图。我决定制作一个包含内部表格视图的封闭视图。我将此视图称为 contentView 并将其连接到 xib 中。

原来 UITableViewCell 已经有一个 contentView 并用它做了一些奇怪的事情。当我将属性重命名为 mainContentView 并将视图重新连接到此重命名的属性时，问题自行解决。

* * *

## 回答 #31

> 赞同：4
> 
>             
> 
> 时间：2014-06-04T04:40:31.887

注意`UITableView`情节提要中的属性，在我的情况下发生的事情是我将情节提要中的组合框选为“选择：单选”，这不允许该方法`didSelectRowAtIndexPath`运行。

* * *

## 回答 #32

> 赞同：4
> 
>             
> 
> 时间：2014-07-25T03:33:58.953

就我而言，我在加载时动态计算`TableView`'s的高度。`SuperView`由于计算错误，`TableView`被定位在`SuperView`. 画得`TableView`很好，但是所有交互都被禁用（并且`didSelectRowAtIndexPath`从未被调用）。很难检测到，因为没有视觉指示表明`TableView`“不可访问”。

* * *

## 回答 #33

> 赞同：4
> 
>             
> 
> 时间：2015-10-18T20:22:23.583

就我而言，问题是我有一个`UITableViewCell`子类，并且我实现了这两种方法：
 `touchesBegan:withEvent:`&`touchesEnded:withEvent`来处理精美的触摸动画。但我忘记添加`[super touchesBegan:touches withEvent:event];`方法广告`[super touchesEnded:touches withEvent:event];`也通知触摸的单元格的父级。

所以将代码更改为以下解决了我的问题：

```
-(void) touchesBegan:(NSSet*)touches withEvent:(UIEvent*)event{
    [super touchesBegan:touches withEvent:event];
    //blah blah blah
}

-(void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{
    [super touchesEnded:touches withEvent:event];
    //rest of the code
} 
```

* * *

## 回答 #34

> 赞同：3
> 
>             
> 
> 时间：2011-05-25T16:05:14.647

好的，我刚遇到这个问题，在这里更新，我的问题与这里发现的略有不同。  

我查看了 IB 并看到我的委托 WAS 已设置，但它被错误地设置为 VIEW 而不是 File's Owner（右键单击表视图以查看委托指向的位置）。

希望对某人有所帮助

* * *

## 回答 #35

> 赞同：3
> 
>             
> 
> 时间：2016-03-09T16:16:29.383

这篇文章中有一些惊人的线索和答案（也许是我见过的最好的讨论之一！）这里的线索帮助我弄清楚我的问题是什么，但我仍然花了很多时间在键盘上流口水试图发现问题，与其他帖子类似。但是，我最终发现它的方式有点不同，所以我想分享一下，以防其他人也遇到它。

原来我的问题是，在代码中，一个超类添加了一个全屏“错误视图”，它不是隐藏的，而是透明的。但是，因为它在 tableview 上并且“用户操作”设置为 YES，所以它拦截了我对 tableview 的触摸。

我使用 Xcode 很酷的“Debug View Hierarchy”按钮对此进行了诊断。这是一个带有注释的屏幕截图，希望能解释我做了什么以及我最终如何诊断出这个问题。

在代码中，我只需要这样做：

```
errorMessageView.setUserInteractionEnabled = NO;
// or
errorMessageView.hidden = YES; 
```

[![调试视图层次结构](https://i.stack.imgur.com/WP0Ys.png)](https://i.stack.imgur.com/WP0Ys.png)

* * *

## 回答 #36

> 赞同：3
> 
>             
> 
> 时间：2020-09-07T20:01:21.447

```
tableView?.allowsSelection = true 
```

在 Xcode 11.7 中默认为 False

* * *

## 回答 #37

> 赞同：2
> 
>             
> 
> 时间：2013-06-13T15:00:26.973

这可能只是在我的情况下，但我已经从备份中重新加载了一些文件并且事情没有工作，包括这个。进行完全清洁（产品 > 清洁或 Shift + Command + K）后，它起作用了。可能在预编译的标头中有些东西搞砸了。这对你来说可能不是问题，但值得一试。

* * *

## 回答 #38

> 赞同：2
> 
>             
> 
> 时间：2014-02-11T16:32:27.003

如果您有自定义单元格，请记住在单元格的 Xib（或通过代码）中设置 UserInteractionEnabled。

* * *

## 回答 #39

> 赞同：2
> 
>             
> 
> 时间：2014-03-17T09:50:00.137

检查 -heightForRowAtIndexPath 是否不返回 0。

* * *

## 回答 #40

> 赞同：2
> 
>             
> 
> 时间：2014-08-26T21:55:26.707

就我而言，只有一个细胞有这个问题。该单元格包括处于只读模式的 UITextView 插座。虽然在点击之前它是只读的。敲击后，键盘升起。事实证明，它仍然需要禁用交互。

```
cell.content.scrollEnabled = NO;
cell.content.editable = NO;
cell.content.userInteractionEnabled = NO;
cell.content.delegate = nil; 
```

[cell.content resignFirstResponder];

* * *

## 回答 #41

> 赞同：2
> 
>             
> 
> 时间：2015-03-20T05:25:32.780

我间歇性地遇到这个问题。有时触摸一个单元格会导致它被选中。有时它不会收到触摸事件。

我正在使用 ios8 中引入的称为自调整单元格的功能。我看到这篇[博客文章](http://www.appcoda.com/self-sizing-cells/)指出：

> 首次显示表格视图时，您可能会发现某些单元格的大小不正确。但是当您滚动表格视图时，新单元格将以正确的行高显示。要解决此问题，您可以在视图出现后强制重新加载：

```
override func viewDidAppear(animated: Bool) {
    tableView.reloadData()
} 
```

这为我解决了这个问题。即使表格视图正确呈现，触摸处理（特别是 UITableView 的 hitTest）似乎也受到上述错误的影响。

* * *

## 回答 #42

> 赞同：2
> 
>             
> 
> 时间：2015-07-04T19:36:45.520

我迭代了所有以前的答案，但没有一个对我有帮助。经过反复试验，我找到了不同的解决方案。我有一个 UIImageView 覆盖整个单元格（作为背景）。默认情况下 UIImageView 禁用用户交互。通过启用 imageviews 用户交互委托方法 -didSelectRowAtIndexPath: 再次被调用。例如。

```
cell.imgView.userInteractionEnabled = YES; 
```

* * *

## 回答 #43

> 赞同：2
> 
>             
> 
> 时间：2017-08-16T07:20:11.157

如果您单击的单元格被突出显示但该函数仍未被调用，请仔细检查您的函数签名。它应该如下所示：

```
override func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) 
```

* * *

## 回答 #44

> 赞同：1
> 
>             
> 
> 时间：2010-10-14T02:08:36.097

我自己也有这个问题。我已经在 IB 中构建了视图的骨架（只是一个视图和一个 TableView），并且没有设置委托。我将它连接到 File's Owner，它就像一个魅力。：：节省：：

* * *

## 回答 #45

> 赞同：1
> 
>             
> 
> 时间：2013-07-24T17:25:32.857

另一个可能的原因似乎`UITableView`是嵌入在`UIScrollView`. 我今天遇到了这个问题，因为我无意中将滚动视图而不是普通视图作为控制器的根视图。

* * *

## 回答 #46

> 赞同：1
> 
>             
> 
> 时间：2013-10-31T17:06:24.993

我在一些定制的表格代码中调用了 cell.userInteractionEnabled。

愚蠢，但不是大多数错误吗？

* * *

## 回答 #47

> 赞同：1
> 
>             
> 
> 时间：2014-04-06T09:48:03.310

另一个疯狂的可能性：我在 iPhone 5S 上运行我的应用程序，我使用了：

```
- (float)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath 
```

就像我过去一样。

但是，我没有仔细查看我的编译器警告......它说我应该将上面的行更改为：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath 
```

64位兼容性！  *握拳*

要小心，以防你开始拔头发。

* * *

## 回答 #48

> 赞同：1
> 
>             
> 
> 时间：2014-12-10T17:12:05.967

我刚刚遇到了这个问题，但是它并没有立即发生；选择几个单元格后，他们将停止调用`didSelectItemAtIndexPath`。我意识到问题在于集合视图已`allowsMultipleSelection`设置为 TRUE。因为单元格永远不会被取消选择，所以这阻止了未来的调用调用`didSelectItemAtIndexPath`。

* * *

## 回答 #49

> 赞同：1
> 
>             
> 
> 时间：2019-03-16T06:11:44.277

我已阅读所有答案并强烈同意。但在我的情况下完全不同。我有新`segue`的`detailViewController`直接链接到我`tableCell`在 StoryBoard 中的链接，这导致了这种情况。所以我不得不从我的单元格中删除那个segue并将它与它`UITableViewController`本身联系起来。现在通过编写以下代码它可以工作，

```
override func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
        tableView.deselectRow(at: indexPath, animated: true)
        // Do any operation
        performSegue(withIdentifier: "DetailSegue", sender: self)
    } 
```

希望这个解决方案能帮助那里的人！

* * *

## 回答 #50

> 赞同：0
> 
>             
> 
> 时间：2013-04-02T10:19:04.220

我遇到了问题，即在应用断点后控件没有进入 didselect 行。问题就在眼前。我从视图中删除了标签手势。然后它工作正常

* * *

## 回答 #51

> 赞同：0
> 
>             
> 
> 时间：2014-08-26T09:20:23.643

我不能评论，写在这里。在我的情况下`didSelectRow`工作，但不是`didDeselectRow`。我设置了`delegate`，这解决了我的情况。`dataSource``tableView`

* * *

## 回答 #52

> 赞同：0
> 
>             
> 
> 时间：2016-11-15T11:10:18.520

1.  添加`@interface ExampleViewController () <UITableViewDelegate, UITableViewDataSource>`

2.  在情节提要中进行委托

[![在此处输入图像描述](https://i.stack.imgur.com/AtQRA.png)](https://i.stack.imgur.com/AtQRA.png)

3.  添加代码

    ```
    - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
        UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
       NSString *cellText = cell.textLabel.text;
    } 
    ```

* * *

## 回答 #53

> 赞同：0
> 
>             
> 
> 时间：2017-11-07T22:51:41.393

我不确定是否有人滚动到足以看到这个答案，但由于这是关于这个主题的最流行的问题并且答案不存在我会添加它：

从 Xcode 9 / Swift 4 开始，所有 Objective-C 方法都应该标记为`@objc`. 编译器在识别应该应用它的地方做了合理的工作，但是它没有弄清楚继承。例如：

```
class Delegate: NSObject, UITableViewDelegate {
}

class SuperDelegate: Delegate {
    override func tableView(_ tableView: UITableView, willSelectRowAt indexPath: IndexPath) -> IndexPath? { return indexPath }
} 
```

这不会产生任何警告、崩溃或构建错误。但是，在您添加之前不会调用您的线路`@objc`：

```
@objc class SuperDelegate: Delegate {
    override func tableView(_ tableView: UITableView, willSelectRowAt indexPath: IndexPath) -> IndexPath? { return indexPath }
} 
```

* * *

## 回答 #54

> 赞同：0
> 
>             
> 
> 时间：2018-01-03T17:58:17.677

确保调用`reloadData`主线程。如果您从某种异步方法（例如：某种网络请求）调用该方法，表格视图可能会或可能不会正确响应（在某些情况下应用程序甚至可能崩溃）。

`reloadData`如果调用是在其他方法块（您不确定）中进行的，请使用主线程代码块来执行调用：

```
[[NSOperationQueue mainQueue] addOperationWithBlock:^{
    [tableView reloadData];
}]; 
```

* * *

## 回答 #55

> 赞同：0
> 
>             
> 
> 时间：2018-03-28T08:41:10.787

在我的情况下，我犯了一个小错误，我分配了：

```
tableView.isUserInteractionEnabled = false 
```

它应该是：

```
tableView.isUserInteractionEnabled = true 
```

* * *

## 回答 #56

> 赞同：0
> 
>             
> 
> 时间：2018-06-16T17:14:04.137

我刚刚找到了另一种*不*调用您的`didSelect`方法的方法。在某些时候，在 func 声明本身出现一些错误时，XCode 建议我将 @nonobjc 添加到我的方法中：

`@nonobjc func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {`

这将继续编译而不会抱怨，但您永远不会被 ui 操作调用。

“那是我的两分钱，我想要我的零钱回来”

* * *

## 回答 #57

> 赞同：0
> 
>             
> 
> 时间：2018-12-26T18:47:19.017

就我而言，问题在于将该方法声明为私有方法。

这没有用：

```
private func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) { 
```

这有效：

```
func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) { 
```

* * *

## 回答 #58

> 赞同：0
> 
>             
> 
> 时间：2019-03-16T06:18:44.590

您必须检查此选择必须是单选并且编辑在编辑期间必须没有选择并且您更改 uttableviewcell 属性中的设置并且您在表格视图中编辑的单元格样式必须是自定义的并且标识符必须是 Rid 并且部分是无

* * *

## 回答 #59

> 赞同：0
> 
>             
> 
> 时间：2021-02-07T19:50:14.777

我遇到了这个问题，当`class name`我`TableViewController`在`Interface Builder`.

# windows - 如何获取安装目录？

> ID：255928
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2008-11-01T18:32:49.650
> 
>         
> 
> 标签：windows, deployment, installation, windows-installer

MSI 为将来的卸载任务存储安装目录。

使用该`INSTALLPROPERTY_INSTALLLOCATION`属性（即`"InstallLocation"`）仅适用于安装程序在安装期间设置了该`ARPINSTALLLOCATION`属性。但是这个属性是可选的，几乎没有人使用它。

如何检索安装目录？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T18:42:17.650

使用注册表项来跟踪您的安装目录，这样您就可以在升级和删除产品时引用它。

使用 WIX，我将在安装目录的 Directy 标记之后创建一个创建密钥的组件，声明

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-08-20T14:30:52.523

我会使用 MsiGetComponentPath() - 您需要 ProductId 和 ComponentId，但您可以获得已安装文件的完整路径 - 只需选择一个指向安装目录位置的路径即可。如果您想获取任何随机 MSI 的目录值，我不相信有一个 API 可以让您做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T18:52:31.343

我会尝试使用 Installer.OpenProduct(productcode)。这将打开一个会话，然后您可以在该会话上请求 Property("TARGETDIR")。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-01T12:44:06.283

试试这个： var sPath = this.Context.Parameters["assemblypath"].ToString();

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2011-05-18T22:08:08.023

正如线程中其他地方所述，我通常在 HKLM 中编写一个注册表项，以便能够轻松检索安装目录以进行后续安装。

如果我正在处理尚未执行此操作的设置，我会使用内置的 Windows Installer 功能 AppSearch： http: [//msdn.microsoft.com/en-us/library/aa367578 (v=vs.85 ).aspx](http://msdn.microsoft.com/en-us/library/aa367578(v=vs.85).aspx)通过指定要查找的文件签名来定位先前安装的目录。

文件签名可以由文件名、文件大小和文件版本以及其他文件属性组成。可以以一定程度的灵活性指定每个签名，以便您可以找到同一文件的不同版本，例如通过指定要查找的版本范围。请查看 SDK 文档： http: [//msdn.microsoft.com/en-us/library/aa371853 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/aa371853(v=vs.85).aspx)

在大多数情况下，我使用主应用程序 EXE 并通过寻找具有正确版本和日期的文件的窄版本范围来设置严格的签名。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2017-12-29T03:12:17.093

最近我需要通过[Ketarin自动安装](https://ketarin.org)[Natural Docs](http://www.naturaldocs.org)。我可以假设它已安装到默认路径 ( ) 中，但我决定采取一种安全的方法。可悲的是，即使安装程序在 上创建了一个密钥，它也没有任何价值让我找到安装目录。`%ProgramFiles(x86)%\Natural Docs``HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall`

Stein 的回答建议使用 AppSearch MSI 功能，它看起来很有趣，但遗憾的是 Natural Docs MSI 安装程序没有为他的方法工作提供签名表。

所以我决定在注册表中搜索任何对 Natural Docs 安装目录的引用，并找到一个 into `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components`key。

[![MSI 组件注册表项](https://i.stack.imgur.com/afok5.png)](https://i.stack.imgur.com/afok5.png)

我在 C# 中为 Ketarin 开发了一个允许递归的 Reg 类。因此，我查看所有值`HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components`，如果在其中一个子键值中找到主应用程序可执行文件 (NaturalDocs.exe)，则将其提取 (`C:\Program Files (x86)\Natural Docs\NaturalDocs.exe`成为`C:\Program Files (x86)\Natural Docs`)并将其添加到系统环境变量 %PATH% (所以我可以调用“NaturalDocs.exe " 直接而不是使用完整路径）。

注册表“类”（实际上是函数）可以在 GitHub ( [RegClassCS](https://github.com/coldscientist/RegClassCS) ) 上找到。

```
System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo("NaturalDocs.exe", "-h");
startInfo.UseShellExecute = false;
startInfo.CreateNoWindow = true;

var process = System.Diagnostics.Process.Start (startInfo);
process.WaitForExit();

if (process.ExitCode != 0)
{
    string Components = @"SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components";

    bool breakFlag = false;

    string hKeyName = "HKEY_LOCAL_MACHINE";
    if (Environment.Is64BitOperatingSystem)
    {
        hKeyName = "HKEY_LOCAL_MACHINE64";
    }

    string[] subKeyNames = RegGetSubKeyNames(hKeyName, Components);
    // Array.Reverse(subKeyNames);
    for(int i = 0; i <= subKeyNames.Length - 1; i++)
    {
        string[] valueNames = RegGetValueNames(hKeyName, subKeyNames[i]);
        foreach(string valueName in valueNames)
        {
            string valueKind = RegGetValueKind(hKeyName, subKeyNames[i], valueName);
            switch(valueKind)
            {
                case "REG_SZ":
                // case "REG_EXPAND_SZ":
                // case "REG_BINARY":
                    string valueSZ = (RegGetValue(hKeyName, subKeyNames[i], valueName) as String);
                    if (valueSZ.IndexOf("NaturalDocs.exe") != -1)
                    {
                        startInfo = new System.Diagnostics.ProcessStartInfo("setx", "path \"%path%;" + System.IO.Path.GetDirectoryName(valueSZ) + "\" /M");
                        startInfo.Verb = "runas";

                        process = System.Diagnostics.Process.Start (startInfo);
                        process.WaitForExit();

                        if (process.ExitCode != 0)
                        {
                            Abort("SETX failed.");
                        }

                        breakFlag = true;
                    }
                    break;

                /*  
                case "REG_MULTI_SZ":
                    string[] valueMultiSZ = (string[])RegGetValue("HKEY_CURRENT_USER", subKeyNames[i], valueKind);

                    for(int k = 0; k <= valueMultiSZ.Length - 1; k++)
                    {
                        Ketarin.Forms.LogDialog.Log("valueMultiSZ[" + k + "] = " + valueMultiSZ[k]);
                    }
                    break;
                */

                default:
                    break;
            }

            if (breakFlag)
            {
                break;
            }
        }

        if (breakFlag)
        {
            break;
        }
    }
} 
```

即使您不使用 Ketarin，您也可以轻松粘贴该函数并通过 Visual Studio 或[CSC](https://stackoverflow.com/a/36156326/1031340)构建它。

可以使用允许注册表项递归且不依赖于 .NET Framework 平台或构建过程的[RegClassVBS](https://github.com/coldscientist/RegClassVBS)采取更通用的方法。

请注意，枚举组件密钥的过程可能是 CPU 密集型的。上面的示例有一个 Length 参数，您可以使用它向用户显示一些进度（可能类似于“i from (subKeysName.Length - 1) keys remaining” - 有创意）。在 RegClassVBS 中可以采用类似的方法。

两个类（RegClassCS 和 RegClassVBS）都有可以指导您的文档和示例，您可以在任何软件中使用它并为它们的开发做出贡献，在 git repo 上提交，并且（当然）在它的 github 上打开问题如果您发现任何您无法自行解决的问题，请查看页面，以便我们可以尝试重现该问题以找出我们可以做些什么。=)

# php - 可视化分析 PHP 应用程序的内存使用情况的工具

> ID：255941
> 
>         
> 
> 赞同：23
> 
>         
> 
> 时间：2008-11-01T18:41:34.097
> 
>         
> 
> 标签：php, memory-management, profiling

是否有任何免费软件或商业软件可以帮助分析 PHP 应用程序的内存使用情况？我知道 xdebug 可以生成跟踪文件，通过函数调用显示内存使用情况，但如果没有图形工具，数据很难解释。

理想情况下，我希望不仅能够查看总内存使用量，还能够查看堆上的对象以及与[Jprofiler](http://www.codework.com/jprofiler/product.htm)类似的引用它们的对象。

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2014-05-23T12:55:26.277

你可能知道，Xdebug 从 2.* 版本开始就放弃了内存分析支持。请在此处搜索“已删除函数”字符串：[http ://www.xdebug.org/updates.php](http://www.xdebug.org/updates.php)

> **删除的功能**
> 
> 删除了对内存分析的支持，因为它不能正常工作。

所以我尝试了另一种工具，它对我来说效果很好。

[https://github.com/arnaud-lb/php-memory-profiler](https://github.com/arnaud-lb/php-memory-profiler)

这是我在我的 Ubuntu 服务器上为启用它所做的：

```
sudo apt-get install libjudy-dev libjudydebian1
sudo pecl install memprof
echo "extension=memprof.so" > /etc/php5/mods-available/memprof.ini
sudo php5enmod memprof
service apache2 restart 
```

然后在我的代码中：

```
<?php

memprof_enable();

// do your stuff

memprof_dump_callgrind(fopen("/tmp/callgrind.out", "w")); 
```

最后用[KCachegrind](http://kcachegrind.sourceforge.net/html/Home.html)`callgrind.out`打开文件

# 使用 Google gperftools（推荐！）

首先通过在此处下载最新软件包来安装**Google gperftools ：** [https ://code.google.com/p/gperftools/](https://code.google.com/p/gperftools/)

然后像往常一样：

```
sudo apt-get update
sudo apt-get install libunwind-dev -y
./configure
make
make install 
```

现在在您的代码中：

```
memprof_enable();

// do your magic

memprof_dump_pprof(fopen("/tmp/profile.heap", "w")); 
```

然后打开你的终端并启动：

```
pprof --web /tmp/profile.heap 
```

*pprof*将在您现有的浏览器会话中创建一个新窗口，如下所示：

![使用 memprof 和 gperftools 进行 PHP 内存分析](https://i.stack.imgur.com/EAnGC.png)

# Xhprof + Xhgui（我认为最好的配置 CPU 和内存）

使用**Xhprof**和**Xhgui**，您还可以分析 cpu 使用情况，或者如果这是您目前的问题，则只分析内存使用情况。这是一个非常完整的解决方案，它可以让您完全控制，并且日志可以写在 mongo 或文件系统中。

有关更多详细信息[，请参见我的答案](https://stackoverflow.com/questions/16787462/php-xdebug-how-to-profile-forked-process/31388948#31388948)。

# 黑火

Blackfire 是 SensioLabs 的 PHP 分析器，Symfony2 的家伙[https://blackfire.io/](https://blackfire.io/)

如果您使用[puphpet](https://puphpet.com/)设置您的虚拟机，您会很高兴知道它受支持；-)

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2008-12-01T01:50:50.110

我最近遇到了同样的问题，不幸的是找不到任何特定的工具。

但是有帮助的是在启用 mem deltas 的情况下以人类可读的格式输出 xdebug 跟踪（一个 INI 设置，xdebug.show_mem_deltas 或我认为的什么？）。然后在输出上运行 sort（如果你在 *nix 上）：

```
sort -bgrk 3 -o sorted.txt mytracefile.xt 
```

这对第三列进行排序，即内存增量。您还可以对第二列进行排序，在这种情况下，您可以找到您的应用程序总共使用最多内存的行。

当然，这无法检测到对象的内存使用量何时仅以小幅递增但最终总体上使用了大量内存。我有一个相当愚蠢的方法，它试图结合使用对象迭代和序列化来做到这一点。它可能并不完全等同于内存使用情况，但希望能给出从哪里开始查找的想法。请记住，它本身会耗尽内存，并且还没有经过广泛的测试，所以买家要注意：

```
function analyzeMem($obj, $deep=false)
{
    if (!is_scalar($obj))
    {
        $usage = array('Total'=>strlen(serialize($obj)));
        while (list($prop, $propVal) = each($obj)) 
        {
            if ($deep && (is_object($propVal) || is_array($propVal)))
            {
                $usage['Children'][$prop] = analyzeMem($propVal);
            }
            else
            {
                $usage['Children'][$prop] = strlen(serialize($propVal));
            }
        }
        return $usage;
    }
    else
    {
        return strlen(serialize($obj));
    }
}

print_r(analyzeMem(get_defined_vars())); 
```

另外，刚刚被同事推荐了这种方法（欢呼 Dennis ;-) 这隐藏了低于 2 级缩进的步骤，您可以很容易地看到整体内存使用率上升的点，并且可以通过增加来缩小范围缩进：

```
egrep '[0-9]+ (  ){1,2}-> ' mytracefile.xt 
```

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-02-26T11:38:25.413

在Xdebug 2.0.4 的[http://www.xdebug.org/updates.php](http://www.xdebug.org/updates.php)上，他们在“删除的功能”部分中写道：“......删除了对内存分析的支持，因为它不能正常工作......”。因此 xdebug 不会是一个选项

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2019-02-01T21:08:15.307

我个人使用[https://github.com/arnaud-lb/php-memory-profiler](https://github.com/arnaud-lb/php-memory-profiler)

在 PHP 5.6 和 Ubuntu 18 上，以及用于可视化的 Kcachegrind。

Kcachegrind 还可以，但不是最好的。我希望找到更好的替代方案，即使它在 Mac 或 Windows 上。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2019-08-21T22:19:28.963

在 2018 年 1 月 29 日的 2.6.0 版本中，xdebug 添加了对分析内存使用情况的支持。现在您可以生成带有时间和内存信息的 callgrind 文件。在 Mac 上，您可以使用 Qcachegrind 或[Profiling Viewer](https://profilingviewer.com/)（高级版）来可视化该信息。

[![分析查看器调用图](https://i.stack.imgur.com/cCWR6.png)](https://i.stack.imgur.com/cCWR6.png)

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T19:11:12.210

xdebug 输出的图形工具是[KCacheGrind](http://kcachegrind.sourceforge.net/)。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-11-02T00:09:23.763

尝试[webgrind](http://code.google.com/p/webgrind/)。它以易于阅读、基于浏览器的格式为您提供 CacheGrinder 的分析。我在 Mac 上，它使分析变得轻而易举。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-11-02T16:10:25.600

phpDesigner 2008 可以使用 xdebug 和 KCacheGrind 调试和基准测试网站。它还具有内置监视器。

# nhibernate - 我可以在不提交事务的情况下刷新我的 NHibernate 会话并获得一个新会话吗？

> ID：255942
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T18:41:44.860
> 
>         
> 
> 标签：nhibernate, testing, castle-activerecord, database-testing

我正在使用 Castle ActiveRecord 进行持久性，并且我正在尝试为我的持久性测试编写一个基类，它将执行以下操作：

*   为每个测试用例打开一个事务并在测试用例结束时将其回滚，这样我就可以为每个测试用例获得一个干净的数据库，而无需为每个测试用例重建架构。

*   提供刷新我的 NHibernate 会话并在测试过程中获得一个新会话的能力，这样我就知道我的持久性操作确实影响了数据库，而不仅仅是 NHibernate 会话。

为了证明我的基类 ( `ARTestBase`) 有效，我提出了以下示例测试。

```
[TestFixture]
public class ARTestBaseTest : ARTestBase
{
    [Test]
    public void object_created_in_this_test_should_not_get_committed_to_db()
    {
        ActiveRecordMediator<Entity>.Save(new Entity {Name = "test"});

        Assert.That(ActiveRecordMediator<Entity>.Count(), Is.EqualTo(1));
    }

    [Test]
    public void object_created_in_previous_test_should_not_have_been_committed_to_db()
    {
        ActiveRecordMediator<Entity>.Save(new Entity {Name = "test"});

        Assert.That(ActiveRecordMediator<Entity>.Count(), Is.EqualTo(1));
    }

    [Test]
    public void calling_flush_should_make_nhibernate_retrieve_fresh_objects()
    {
        var savedEntity = new Entity {Name = "test"};
        ActiveRecordMediator<Entity>.Save(savedEntity);
        Flush();
        // Could use FindOne, but then this test would fail if the transactions aren't being rolled back
        foreach (var entity in ActiveRecordMediator<Entity>.FindAll())
        {
            Assert.That(entity, Is.Not.SameAs(savedEntity));
        }
    }
} 
```

这是我在基类上的最大努力。它正确实现`Flush()`了，所以第三个测试用例通过了。但是它不会回滚事务，因此第二个测试失败。

```
public class ARTestBase
{
    private SessionScope sessionScope;
    private TransactionScope transactionScope;

    [TestFixtureSetUp]
    public void InitialiseAR()
    {
        ActiveRecordStarter.ResetInitializationFlag();
        ActiveRecordStarter.Initialize(typeof (Entity).Assembly, ActiveRecordSectionHandler.Instance);
        ActiveRecordStarter.CreateSchema();
    }

    [SetUp]
    public virtual void SetUp()
    {
        transactionScope = new TransactionScope(OnDispose.Rollback);
        sessionScope = new SessionScope();
    }

    [TearDown]
    public virtual void TearDown()
    {
        sessionScope.Dispose();
        transactionScope.Dispose();
    }

    protected void Flush()
    {
        sessionScope.Dispose();
        sessionScope = new SessionScope();
    }

    [TestFixtureTearDown]
    public virtual void TestFixtureTearDown()
    {
        SQLiteProvider.ExplicitlyDestroyConnection();
    }
} 
```

请注意，我正在使用带有内存数据库的自定义 SQLite 提供程序。我的自定义提供程序取自[这篇博](http://brian.genisio.org/2008/07/active-record-mock-framework.html)文，它始终保持连接打开以维护架构。删除它并使用常规 SQL Server 数据库不会改变行为。

有没有办法实现所需的行为？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-11-03T10:49:47.917

Not too sure about ActiveRecord, but in NHibernate a transaction belongs to a session, not the otherway round.

If you've used ADO.Net a lot, this will make more sense, as to create an `IDbTransaction` you need to use the connection. ActiveRecord's `TransactionScope` (and NHibnerate's `ITransaction`)  essentially wrap an `IDbTransaction`, so you need to create the `SessionScope` before the `TransactionScope`.

What you might also find (depending on if you're using NHibernate 1.2 GA or NHibernate 2.*, and what `FlushMode` your `SessionScope` has) is that your call to `FindAll()` may cause the session to flush anyway, as NHibernate will realise that it can't retrieve the correct data without actioning the last call to `Save`.

This all said and done, have you tried using `SessionScope.Flush()` instead of creating a new `SessionScope`?

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-11-03T13:00:56.217

使用`SessionScope.Flush()`使我的第三次测试失败。据我了解，`Flush()`执行 SQL 将我的记录推送到数据库中，但不会从会话中驱逐对象。这符合你所说的`FindAll()`引起冲洗的说法。

我真正想要的是`SessionScope.Flush()`（将数据库的状态与会话同步）加上`SessionScope.EvictAll()`（以确保我在后续查询中获得新的对象）。我`new SessionScope()`的尝试是模拟`EvictAll()`.

您对包含交易的会话的评论而不是相反的评论确实给了我一个想法。我不确定在 flushed`SessionScope`内部  创建一个 new并期望它参与事务是多么的洁净，但它似乎有效：`TransactionScope``SessionScope`

```
public abstract class ARTestBase
{
    private SessionScope sessionScope;
    private TransactionScope transactionScope;
    private bool reverse;
    private IList<SessionScope> undisposedScopes;

    [TestFixtureSetUp]
    public void InitialiseAR()
    {
        ActiveRecordStarter.ResetInitializationFlag();
        ActiveRecordStarter.Initialize(typeof (Entity).Assembly, ActiveRecordSectionHandler.Instance);
        ActiveRecordStarter.CreateSchema();
        InitialiseIoC();
        undisposedScopes = new List<SessionScope>();
    }

    [SetUp]
    public virtual void SetUp()
    {
        sessionScope = new SessionScope();
        transactionScope = new TransactionScope(OnDispose.Rollback);
        transactionScope.VoteRollBack();
        base.CreateInstanceUnderTest();
        reverse = false;
    }

    [TearDown]
    public virtual void TearDown()
    {
        if (reverse)
        {
            sessionScope.Dispose();
            transactionScope.Dispose();
        }
        else
        {
            transactionScope.Dispose();
            sessionScope.Dispose();
        }
    }

    [TestFixtureTearDown]
    public virtual void TestFixtureTearDown()
    {
        foreach (var scope in undisposedScopes)
        {
            scope.Dispose();
        }
        SQLiteProvider.ExplicitlyDestroyConnection();
    }

    protected void Flush()
    {
        reverse = true;
        sessionScope.Flush();
        undisposedScopes.Add(sessionScope);
        sessionScope = new SessionScope();
    }
} 
```

进一步考虑，这将不允许您在每个测试用例中多次刷新。我想我可以通过更仔细地跟踪范围来处理这个问题。我以后可能会研究一下。

# c# - 重新实现另一个接口已经继承的接口

> ID：255951
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-11-01T18:50:06.403
> 
>         
> 
> 标签：c#, .net, interface, language-design

我经常看到这样的东西：

```
interface A { ... }
interface B : A { ... }
class C : B, A { ...} 
```

当 B 已经继承 A 时，为什么要指定 C 实现接口 A？它会产生任何语义差异还是只是风格问题？

*（许多示例之一是`List<T>`实现`IList<T>`and `ICollection<T>`，同时`IList<T>`也派生自`ICollection<T>`）。*

* * *

**更新：**感谢您确认我的猜测，它不会产生任何语义差异。

我想出了一个相关的情况，显式命名已经在继承树中的接口*确实会有所不同：*

如果`B`是一个类，则`C`只会（重新）实现接口成员，`A`如果它`A`在“”之后显式命名`:`。

[编辑] 我更改了问题的措辞以避免与显式实现的接口成员混淆，这将成员的使用限制在对象被转换为接口的情况下。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2008-11-01T18:57:45.250

我相信这只是风格问题。在查看框架/库类时，这一点特别重要 - 例如，在您的示例中，它强调了可以将此类视为 ICollection 或 IList 的想法，而开发人员不必知道 IList 实际上是 ICollection。

它没有功能性后果。具体来说，无论类“C”是否显式实现“A”，此代码都会编译：

```
namespace DotNetInterfaceTest {
    class Program {
        static void Main(string[] args) {
            A c = new C();
        }
    }

    interface A {
        void foo();
    }

    interface B : A {
        void bar();
    }

    class C : B {
        public void bar() {}
        public void foo() {}
    }
} 
```

# c# - 如何将 Windows 窗体控件设为只读？

> ID：255955
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-11-01T18:54:41.307
> 
>         
> 
> 标签：c#, .net, winforms

时隔许久回到VS2008中的WinForms..修补VS2008 Express版中的OOD问题。

我需要一些控件作为“仅显示”小部件。用户不应该能够更改这些控件的值......小部件由定期更新滴答事件更新。我隐约记得有一个 ReadOnly 属性，您可以将其设置为具有此行为……现在找不到。

**Enabled**属性设置为 false：使控件内容变灰。我希望控件看起来正常。**Locked**属性设置为 false: 似乎可以保护用户免于意外扭曲可视表单设计器中的控件。

我错过了什么？

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2008-11-01T19:02:19.543

对于一些典型的 winforms 控件：

[http://jquiz.wordpress.com/2007/05/29/c-winforms-readonly-controls/](http://jquiz.wordpress.com/2007/05/29/c-winforms-readonly-controls/)

这也是保持外观的好技巧：

```
 Color clr = textBox1.BackColor;
    textBox1.ReadOnly = true;
    textBox1.BackColor = clr; 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2010-10-05T09:22:26.933

要使表单一键立即控制只读，请使用以下代码：

```
 public void LockControlValues(System.Windows.Forms.Control Container)
    {
        try
        {
            foreach (Control ctrl in Container.Controls)
            {
                if (ctrl.GetType() == typeof(TextBox))
                    ((TextBox)ctrl).ReadOnly = true;
                if (ctrl.GetType() == typeof(ComboBox))
                    ((ComboBox)ctrl).Enabled= false;
                if (ctrl.GetType() == typeof(CheckBox))
                    ((CheckBox)ctrl).Enabled = false;

                if (ctrl.GetType() == typeof(DateTimePicker))
                    ((DateTimePicker)ctrl).Enabled = false;

                if (ctrl.Controls.Count > 0)
                    LockControlValues(ctrl);
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.ToString());
        }
    } 
```

然后从您的按钮单击事件中调用它，如下所示：

```
LockControlValues(this) 
```

希望，这有助于解决您的问题：

快乐编程，

拉詹·阿罗拉 www.simplyrajan.co.nr

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T19:06:37.117

**文本框**

.ReadOnly 属性为 true

**没有 ReadOnly 的控件**

其他控件并不总是具有 ReadOnly 属性。您将需要使用事件来取消编辑过程并保持您的值不可编辑。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T20:03:58.797

两个相关属性 ReadOnly 和 Enabled。ReadOnly = true 防止编辑使背景变灰，但它仍然允许焦点。Enabled = false 使背景、文本变灰并阻止编辑或聚焦。

Windows UI 约定为用户提供一个控件是只读的视觉提示（这样他们就不会尝试编辑它并随后感到沮丧）。灰显的禁用状态是定义的系统约定，但它有太多的暗示（而不是足够清晰的暗示）。

最简单的方法是将您的控件设置为 ReadOnly，将背景设置为 System.Drawing.SystemColors.Window，然后阻止焦点消息。您可以通过捕获 OnEnter 事件并立即将 Focus 移动到另一个非只读控件（例如，关闭或编辑按钮）来做到这一点。或者您可以派生自己的控制权并吃掉任何 WM_SETFOCUS 消息。下面的例子。

我相信各种第三方控件集为您提供了额外的选项和粒度。

```
public class ReadOnlyTextBox : TextBox
{
   const uint WM_SETFOCUS = 0x0007;

   public ReadOnlyTextBox()
   {
      this.ReadOnly = true;
      this.BackColor = System.Drawing.SystemColors.Window;
      this.ForeColor = System.Drawing.SystemColors.WindowText;
   }

   protected override void WndProc(ref Message m)
   {
      // eat all setfocus messages, pass rest to base
      if (m.Msg != WM_SETFOCUS)
         base.WndProc(ref m);
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2013-09-18T21:42:22.163

昨天我在工作中也得到了同样的要求。除了不是文本框，我必须禁用整个表单而不改变它的颜色。

所以我换了一个电话

```
form->Enabled = false; 
```

和

```
IntPtr hWnd = form->Handle;
HWND window_handle = (HWND)hWnd.ToPointer();
::EnableWindow(window_handle, aEnable ? TRUE:FALSE); 
```

效果很好。您可以在上面看到我正在使用托管 C++。整个表单现在被禁用，但没有变灰。

# web-services - 我在哪里可以找到关于 REST 核心概念的好文档？

> ID：255960
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-11-01T18:59:48.677
> 
>         
> 
> 标签：web-services, language-agnostic, rest

[我在维基百科](http://en.wikipedia.org/wiki/Representational_State_Transfer)上找到了一个很好的描述，有一些参考链接，但可能有更好的，请帮我找到这些！

需要明确的是，我不是在寻找任何特定于语言的实现指南的实现，只是纯粹的概念。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-11-01T19:31:40.437

[构建 RESTful Web 服务的指南](http://www.25hoursaday.com/weblog/2007/11/19/GuidelinesForBuildingRESTfulWebServices.aspx)包含有关您需要的资源的所有信息。

这是另一个有用的[博客条目](http://www.25hoursaday.com/weblog/2008/08/17/ExplainingRESTToDamienKatz.aspx)：

统一接口约束描述了为 Web 构建的服务如何成为 Web 体系结构的良好参与者。这些约束简要描述如下：

1) 资源标识：资源是可以命名和表示的任何信息项（例如，文件、给定时间点的股票价格、拉斯维加斯当前的天气等）。您的服务中的资源应使用 URI 进行标识。

2）通过表示操作资源：表示是资源的物理表示，应该对应于有效的媒体类型。使用标准媒体类型作为服务背后的数据格式，可以让广泛的潜在客户访问您的服务，从而扩大服务的覆盖范围。与资源的交互应基于对其 URI 标识的资源表示的检索和操作。

3）自描述消息：遵循服务交互中的无状态原则，使用标准媒体类型并通过HTTP方法使用和控制标头正确指示消息的可缓存性，确保消息是自描述的。自描述消息使得消息可以由客户端和服务器之间的中介处理，而不会影响任何一方。

4）超媒体作为应用程序状态的引擎：应用程序状态应该使用URI和超链接来表示状态之间的转换。这可能是[Roy Fielding 论文](http://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm)中提出的架构约束中最具争议性和最不被理解的。事实上，Fielding 的论文包含一个明确的论点，反对使用 HTTP cookie 来表示应用程序状态来强调这一点，但它经常被忽略。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T20:28:08.967

或者你可以直接从马的嘴里得到它，[架构风格和基于网络的软件架构的设计](http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T19:01:29.717

我阅读[了 O'Reilly 的 RESTful Web 服务，](http://oreilly.com/catalog/9780596529260/)并且非常喜欢它。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T19:39:50.513

我不确定您要寻找多少细节，但要全面了解 REST 的全部内容，我推荐 Ryan Tomayko 的[《我如何向妻子解释 REST》](http://tomayko.com/writings/rest-to-my-wife)。

# ruby - 在 Ruby 的 Test::Unit::TestCase 中，如何覆盖初始化方法？

> ID：255969
> 
>         
> 
> 赞同：28
> 
>         
> 
> 时间：2008-11-01T19:08:09.860
> 
>         
> 
> 标签：ruby, unit-testing, testunit

我正在努力使用 Test::Unit。当我想到单元测试时，我会想到每个文件一个简单的测试。但在 Ruby 的框架中，我必须改为：  

```
class MyTest < Test::Unit::TestCase 
   def setup 
   end

   def test_1 
   end

   def test_1 
   end
end 
```

但是每次调用 test_* 方法都会运行 setup 和 teardown 。这正是我不想要的。相反，我想要一个只为整个班级运行一次的设置方法。但是我似乎无法在不破坏 TestCase 的初始化的情况下编写自己的 initialize()。

那可能吗？还是我让这一切变得复杂到无可救药？

* * *

## 回答 #1

> 赞同：28
> 
>             
> 
> 时间：2009-04-22T19:09:39.047

正如 Hal Fulton 的书“The Ruby Way”中提到的那样。他重写了 Test::Unit 的 self.suite 方法，该方法允许类中的测试用例作为套件运行。

```
def self.suite
    mysuite = super
    def mysuite.run(*args)
      MyTest.startup()
      super
      MyTest.shutdown()
    end
    mysuite
end 
```

这是一个例子：

```
class MyTest < Test::Unit::TestCase
    class << self
        def startup
            puts 'runs only once at start'
        end
        def shutdown
            puts 'runs only once at end'
        end
        def suite
            mysuite = super
            def mysuite.run(*args)
              MyTest.startup()
              super
              MyTest.shutdown()
            end
            mysuite
        end
    end

    def setup
        puts 'runs before each test'
    end
    def teardown
        puts 'runs after each test'
    end 
    def test_stuff
        assert(true)
    end
end 
```

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2012-09-25T14:53:54.697

**最后，测试单元已经实现了！哇！** 
如果您使用的是 v 2.5.2 或更高版本，则可以使用：

```
Test::Unit.at_start do
  # initialization stuff here
end 
```

这将在您开始测试时运行一次。除了在每个测试（设置）之前运行的回调之外，还有在每个测试用例（启动）开始时运行的回调。

[http://test-unit.rubyforge.org/test-unit/en/Test/Unit.html#at_start-class_method](http://test-unit.rubyforge.org/test-unit/en/Test/Unit.html#at_start-class_method)

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2008-11-01T20:25:37.927

这就是它应该如何工作！

每个测试都应该与其他测试完全隔离，因此每个测试用例都执行一次`setup`and`tear_down`方法。但是，在某些情况下，您可能希望对执行流程进行更多控制。然后，您可以将测试用例分组到*suites*中。

在您的情况下，您可以编写如下内容：

```
require 'test/unit'
require 'test/unit/ui/console/testrunner'

class TestDecorator < Test::Unit::TestSuite

  def initialize(test_case_class)
    super
    self << test_case_class.suite
  end

  def run(result, &progress_block)
    setup_suite
    begin
      super(result, &progress_block)      
    ensure
      tear_down_suite
    end
  end

end

class MyTestCase < Test::Unit::TestCase

  def test_1
    puts "test_1"
    assert_equal(1, 1)
  end

  def test_2
    puts "test_2"
    assert_equal(2, 2)
  end

end

class MySuite < TestDecorator

  def setup_suite
    puts "setup_suite"
  end

  def tear_down_suite
    puts "tear_down_suite"
  end

end

Test::Unit::UI::Console::TestRunner.run(MySuite.new(MyTestCase)) 
```

`TestDecorator`定义了一个特殊的套件，它提供了一个`setup`and方法，该`tear_down`方法在运行它包含的一组测试用例之前和之后只运行一次。

这样做的缺点是您需要告诉*Test::Unit*如何在单元中运行测试。如果您的单元包含许多测试用例并且您只需要其中一个的装饰器，您将需要这样的东西：

```
require 'test/unit'
require 'test/unit/ui/console/testrunner'

class TestDecorator < Test::Unit::TestSuite

  def initialize(test_case_class)
    super
    self << test_case_class.suite
  end

  def run(result, &progress_block)
    setup_suite
    begin
      super(result, &progress_block)      
    ensure
      tear_down_suite
    end
  end

end

class MyTestCase < Test::Unit::TestCase

  def test_1
    puts "test_1"
    assert_equal(1, 1)
  end

  def test_2
    puts "test_2"
    assert_equal(2, 2)
  end

end

class MySuite < TestDecorator

  def setup_suite
    puts "setup_suite"
  end

  def tear_down_suite
    puts "tear_down_suite"
  end

end

class AnotherTestCase < Test::Unit::TestCase

  def test_a
    puts "test_a"
    assert_equal("a", "a")
  end

end

class Tests

  def self.suite
    suite = Test::Unit::TestSuite.new
    suite << MySuite.new(MyTestCase)
    suite << AnotherTestCase.suite
    suite
  end

end

Test::Unit::UI::Console::TestRunner.run(Tests.suite) 
```

[*Test::Unit*文档](http://www.ruby-doc.org/stdlib/libdoc/test/unit/rdoc/classes/Test/Unit.html)文档很好地解释了套件的工作原理。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-07-14T16:31:38.770

好吧，我以一种非常丑陋和可怕的方式完成了基本相同的方式，但它更快。:) 一旦我意识到测试是按字母顺序运行的：

```
class MyTests < Test::Unit::TestCase
def test_AASetup # I have a few tests that start with "A", but I doubt any will start with "Aardvark" or "Aargh!"
    #Run setup code
end

def MoreTests
end

def test_ZTeardown
    #Run teardown code
end 
```

它不漂亮，但它有效:)

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2013-09-17T12:53:25.200

我知道这是一篇相当老的帖子，但我遇到了这个问题（并且已经使用 Tes/unit 编写了类）并且已经使用另一种方法进行了回答，所以如果它可以帮助......

如果只需要等价的启动函数，可以使用类变量：

```
class MyTest < Test::Unit::TestCase
  @@cmptr = nil
  def setup
    if @@cmptr.nil?
      @@cmptr = 0
      puts "runs at first test only"
      @@var_shared_between_fcs = "value"
    end
    puts 'runs before each test'
  end
  def test_stuff
    assert(true)
  end
end 
```

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2010-11-07T23:02:03.287

为了解决这个问题，我使用了 setup 构造，只使用了一种测试方法。这一种测试方法正在调用所有其他测试。

例如

```
class TC_001 << Test::Unit::TestCase
  def setup
    # do stuff once
  end

  def testSuite
    falseArguments()
    arguments()
  end

  def falseArguments
    # do stuff
  end

  def arguments
    # do stuff
  end
end 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T21:02:31.190

我遇到了这个确切的问题并创建了一个子类`Test::Unit::TestCase`来完全按照您的描述进行操作。

这就是我想出的。它提供了它自己的`setup`方法`teardown`来计算类中以“test”开头的方法的数量。在第一次调用`setup`它时调用`global_setup`，最后一次调用`teardown`它调用`global_teardown`

```
class ImprovedUnitTestCase < Test::Unit::TestCase
  cattr_accessor :expected_test_count

  def self.global_setup; end
  def self.global_teardown; end    

  def teardown
    if((self.class.expected_test_count-=1) == 0)
      self.class.global_teardown
    end
  end
  def setup
    cls = self.class

    if(not cls.expected_test_count)
      cls.expected_test_count = (cls.instance_methods.reject{|method| method[0..3] != 'test'}).length
      cls.global_setup
    end
  end
end 
```

像这样创建您的测试用例：

```
class TestSomething < ImprovedUnitTestCase
  def self.global_setup
    puts 'global_setup is only run once at the beginning'
  end

  def self.global_teardown
    puts 'global_teardown is only run once at the end'
  end

  def test_1 
  end

  def test_2
  end
end 
```

这样做的错误是，除非您使用类方法（仅在 Rails 2.X 中可用？）并且如果您有一个测试套件或仅运行一个测试的东西，否则您无法提供自己的每个测试`setup`和方法方法，则不会调用，因为它假定所有测试方法最终都会运行。`teardown``setup :method_name``global_teardown`

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T21:48:21.847

将 TestSuite 用作 @romulo-a-ceccon 描述的每个测试套件的特殊准备。

但是我认为这里应该提到单元测试是完全隔离运行的。因此执行流程是 setup-test-teardown 这应该保证每个测试运行不受其他测试所做的任何干扰。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-12-15T21:07:16.730

我创建了一个名为 SetupOnce 的 mixin。这是一个使用它的例子。

```
require 'test/unit'
require 'setuponce'

class MyTest < Test::Unit::TestCase
  include SetupOnce

  def self.setup_once
    puts "doing one-time setup"
  end

  def self.teardown_once
    puts "doing one-time teardown"
  end

end 
```

这是实际的代码；请注意，它需要脚注中第一个链接中提供的另一个模块。

```
require 'mixin_class_methods' # see footnote 1

module SetupOnce
  mixin_class_methods

  define_class_methods do
    def setup_once; end

    def teardown_once; end

    def suite
      mySuite = super

      def mySuite.run(*args)
        @name.to_class.setup_once
        super(*args)
        @name.to_class.teardown_once
      end

      return mySuite
    end
  end
end

# See footnote 2
class String
  def to_class
    split('::').inject(Kernel) {
      |scope, const_name|
      scope.const_get(const_name)
    }
  end
end 
```

脚注：

1.  [http://redcorundum.blogspot.com/2006/06/mixing-in-class-methods.html](http://redcorundum.blogspot.com/2006/06/mixing-in-class-methods.html)

2.  [http://infovore.org/archives/2006/08/02/getting-a-class-object-in-ruby-from-a-string-containing-that-c​​lasses-name/](http://infovore.org/archives/2006/08/02/getting-a-class-object-in-ruby-from-a-string-containing-that-classes-name/)

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2011-08-13T17:10:19.750

+1 为@orion-edwards 提供的上述 RSpec 答案。我会评论他的答案，但我还没有足够的声誉来评论答案。

我经常使用 test/unit*和*RSpec，我不得不说......每个人发布的代码都缺少一个*非常*重要的特性`before(:all)`：@instance 变量支持。

在 RSpec 中，您可以执行以下操作：

```
describe 'Whatever' do
  before :all do
    @foo = 'foo'
  end

  # This will pass
  it 'first' do
    assert_equal 'foo', @foo
    @foo = 'different'
    assert_equal 'different', @foo
  end

  # This will pass, even though the previous test changed the 
  # value of @foo.  This is because RSpec stores the values of 
  # all instance variables created by before(:all) and copies 
  # them into your test's scope before each test runs.
  it 'second' do
    assert_equal 'foo', @foo
    @foo = 'different'
    assert_equal 'different', @foo
  end
end 
```

最重要的是确保这些方法的实现`#startup`只`#shutdown`为整个`TestCase`类调用一次，但是这些方法中使用的任何实例变量都将丢失！

RSpec`before(:all)`在它自己的 Object 实例中运行它，并且在每个测试运行之前复制所有局部变量。

要访问在全局方法期间创建的任何变量`#startup`，您需要：

*   复制由创建的所有实例变量`#startup`，就像 RSpec 一样

*   将变量定义`#startup`到可以从测试方法访问的范围内，例如。`@@class_variables`或创建类级 attr_accessors 提供对`@instance_variables`您在其中创建的访问权限`def self.startup`

只是我的 0.02 美元！

# java - 教儿子Java编程有什么好方法

> ID：255976
> 
>         
> 
> 赞同：22
> 
>         
> 
> 时间：2008-11-01T19:13:53.780
> 
>         
> 
> 标签：java

好的，所以我已经阅读了有关教授初学者编程的各种帖子，其中有一些有用的东西我会更仔细地研究。但我想知道的是，是否有任何有效的工具可以专门教孩子*Java*？  

我想专门教他 Java，因为 (a) 我在 CI 方面的深厚背景觉得这太复杂了，(b) Java 是我非常熟悉的另一种语言，因此我可以提供有意义的帮助，而无需自学新的但是（我）无用的语言，以及（c）我认为托管语言是未来，最后（d）Java 是我熟悉的所有语言中最简单的一种（除了基本语言）。

我学过基础知识，我愿意先教它，但我不知道有一个像样的免费 Windows 基础外壳（虽然我没有真正搜索过，但因为它不是我的第一选择），无论如何都想进步快速到Java。

我儿子 8 岁，所以这比我开始工作早了几年——但他表达了对学习编程的兴趣（可能是因为我经常在家工作，他一直看到我在编程）。

如果没有人能推荐为此目的而设计的工具，我可能会从他开始使用基于文本/控制台的应用程序来教授基础知识，然后进行 GUI 构建。

哦，最后一件事，我不是 IDE（老式文本编辑器类型）的粉丝，所以我不会被一个让他输入真实代码的系统推迟，并且可能更喜欢玩具拖/掉落系统。

编辑：只是为了澄清；我真的很喜欢教他 Java 的方法；已经有很多帖子为其他语言替代品提供了很好的答案——但这不是我在这里寻找的。

编辑： 用于 2D 视频游戏的 Java 框架怎么样 - 任何人都可以根据个人经验推荐它们中的任何一个吗？我喜欢他从现有机制（主要游戏循环、得分等）开始并为他自己想象的游戏添加细节的想法——这就是我所做的，尽管对我来说这是 Commodore VIC-20 的基础和辛克莱 ZX-81。

* * *

## 回答 #1

> 赞同：28
> 
>             
> 
> 时间：2008-11-01T19:16:26.210

你可能会在这个项目中找到一些灵感：

[教孩子编程：即使是年幼的孩子也可以学习 Java](http://java.sys-con.com/node/44575)

> 面向儿童、父母和祖父母的 Java 编程。

您可以在[faratasystems 网站上找到（](http://www.faratasystems.com/?page_id=69)[此处](http://myflex.org/yf/JavaKid811.pdf)直接链接）

在这样一个项目中吸取的教训中，作者提到：

*   大多数编程任务需要最少的算术和代数技能知识。要开始编程，孩子需要了解 x = y+2 的含义。另一个需要理解的重要概念是 if 语句。

*   孩子们在五年级时就发展出抽象推理能力，他们还可以轻松完成浏览网页、下载和安装软件等任务。Dave 很快就学会了如何在 Eclipse IDE 中键入、编译和运行 Java 程序。

*   孩子们学得比成年人快得多，但他们没有“以前的编程经验”，这实际上可能是一件好事，因为他们不必从程序化思维方式切换到面向对象的思维方式。在了解了继承之后，戴夫称我的妻子为超类。

*   成年人是负责任的生物，他们可以比孩子更长时间地做无聊的操作。与孩子一起编程的课程必须简短。每周一到两节 45 分钟的课程就足够了。高中生应该可以多学习，但我还没有这样的经验。

*   插图帮助。在我的书中，我包含了许多类似于 Java 织物柔软剂的彩色卡通人物。

    ![人物](https://i.stack.imgur.com/hLnZo.gif)

*   孩子们喜欢立即看到结果并喜欢玩较短的程序，例如 Fish 类有一个方法 dip(int howDeep)。让我尝试用不同的参数多次调用这个方法......

    ![方法](https://i.stack.imgur.com/KEbdh.gif)

*   图形编程是最有趣的，甚至像计算器、井字游戏或乒乓球这样相当大的程序也可以向孩子们解释。

* * *

## 回答 #2

> 赞同：14
> 
>             
> 
> 时间：2008-11-01T19:32:56.207

你看过[BlueJ](http://www.bluej.org/)吗？我知道您说过您反对 IDE，但它是专门用于教授 Java 的 IDE。此外，它似乎有一些 8 岁的孩子可能会觉得很酷的东西，比如类结构的图形表示。

* * *

## 回答 #3

> 赞同：11
> 
>             
> 
> 时间：2008-11-03T15:57:50.180

我认为 8 岁的 Greenfoot 比 BlueJ 好。它是由制作 Bluej 的同一个人开发的，但它更加图形化，仍然允许对应用程序进行完整的 Java 编程。

[http://www.greenfoot.org/getting-started/](http://www.greenfoot.org/getting-started/) 
1- 下载并安装 JDK 2- 然后下载并安装 greenfoot，您就可以开始了 3- 查看 CrabWorld 的简单易用的教程：[http://www .greenfoot.org/scenarios/files/crab.zip](http://www.greenfoot.org/scenarios/files/crab.zip)

我最近使用 GreenFoot 在我们大学的一个非常简短的高中生入门课程中讨论 Java 编程：http: [//aaue.dk/~av/brobygning2008-software/](http://aaue.dk/~av/brobygning2008-software/)（如果它可能有用的话）。

如果支持Java不是基本特性，也可以试试MIT的scratch（squeak的单机版）：[http](http://scratch.mit.edu/) ://scratch.mit.edu/
非常适合入手，我2个月前在涉及 2 名 13 岁的公关活动。经过不到 1 天的从头开始摆弄，他们制作了自己的视频游戏：
    [http](http://aaue.dk/~av/personal.html) ://aaue.dk/~av/personal.html （“该死的”游戏，他们这样称呼它：>）但它是在它的自己的（视觉）编程语言...

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2010-03-19T13:50:11.343

只要让学习变得有趣，其余的都会随之而来！[令人惊讶的是，如果您尝试Kojo](http://www.kogics.net/sf:kojo)，Scala 可能是最简单的语言
（Scala 是更好的 Java，您当然可以访问所有 J​​ava 库）

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2008-11-01T19:33:17.423

我知道它不是 Java，而是我的一个朋友在家上学他的孩子，他正在使用

[alice - 以 3D 形式教授编程](http://www.alice.org)

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T19:21:52.563

我知道您要求使用 Java，但我会冒险并建议查看基于 Ruby 的鞋子：[http](http://shoooes.net/) ://shoooes.net/和[http://hackety.org/press/](http://hackety.org/press/)

我相信它最初是作为教具写的。

如果我是一个学习编程的孩子，这会让我感兴趣。

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T19:32:04.977

我会尝试使用 python，因为

1) Python 带有一个不错的 REPL - Idle .. 而不是编写长的代码文件，javacing 然后 javaing 它.. 在你放入它的那一刻评估你的表达式可能更适合一个人的注意力范围八岁......你仍然可以制作函数和模块和东西......但是在一个更具交互性的环境中

2）python没有严格的类型，允许你用很少的语法来玩字典和可变大小的链表..那样..你可以先教他一些编程背后的重要思想，然后在他已经非常参与这些东西的时候学习很多语法，

看看[http://openbookproject.net//thinkCSpy/](http://openbookproject.net//thinkCSpy/)

* * *

## 回答 #8

> 赞同：3
> 
>             
> 
> 时间：2008-11-01T23:12:18.683

我会去计划。不管怎样，看看这个网站，它有一些 Java 和教学资源：[http ://www.teach-scheme.org/](http://www.teach-scheme.org/)

* * *

## 回答 #9

> 赞同：3
> 
>             
> 
> 时间：2008-11-03T16:15:15.433

有一个有趣的 Google Tech Talk on [Teching Kids to Code](http://www.youtube.com/watch?v=Tcwx-I6Arwk) - 它涵盖了一个名为[Greenfoot](http://www.greenfoot.org/)的软件，它是一个使用 Java 的介绍性编程工具。它使用拖放和其他与类交互的可视化方法。

* * *

## 回答 #10

> 赞同：3
> 
>             
> 
> 时间：2009-03-07T03:43:25.840

我不会从 Java 开始一个孩子。首先教他一些概念上更干净的东西。像 LISP 或[Logo](http://en.wikipedia.org/wiki/Logo_programming_language)之类的东西。Logo 是一种非常强大的编程语言，而且它开箱即用，具有视觉吸引力，因此学习起来非常有趣。

* * *

## 回答 #11

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T19:19:25.250

找到他感兴趣的项目作为项目，特别是如果你能找到一种不涉及 GUI 的方法。我相信 GUI 有助于引起人们的兴趣，但从根本上讲，它们很难 - 尝试同时学习 GUI 框架和语言太多了，IMO。我喜欢控制台程序 - 一个简短的控制台程序将*所有内容都呈现在您面前，因此您可以**相对*轻松地理解每个字符。

例如，如果他对足球感兴趣，您可能会有一个包含结果的文本文件，并制作一个读取数据的项目，计算出谁得了多少分等。

编辑：基于 VonC 关于“让我们尝试......”的观点要考虑的另一件事 - 可能从诸如 Groovy 之类的交互式语言（非常类似于 Java）开始，或者找到一些描述的“Java shell”以允许您的儿子通过立即执行事物来“探索”语言。

看这个帖子我会很感兴趣——我真的很想在几年后教我的孩子们编程，我想在那之前写一本介绍性的 C# 书……

* * *

## 回答 #12

> 赞同：2
> 
>             
> 
> 时间：2008-11-04T19:38:13.107

我今天偶然注意到[Sun/Oracle 有一个专门针对年轻开发人员的页面。](http://www.oracle.com/technetwork/topics/newtojava/youngdevelopers/index.html)我认为这可能是一个有用的参考页面。

它具有指向 BlueJ、Alice 和 Greenfoot（都已经讨论过）以及其他一些资源的链接。

* * *

## 回答 #13

> 赞同：1
> 
>             
> 
> 时间：2008-11-01T20:06:04.440

我推荐 Ian Cinnamon 的“为邪恶天才编程视频游戏”。作者写这本书的时候才 15 岁......无论如何，这本书相对容易理解，并教你如何用 Java 做一些类似游戏的事情。因为老实说，大多数孩子都想制作电子游戏。在我 10 岁左右的时候，我正在制作基于文本的冒险游戏的 Visual Basic 程序。这个制作电子游戏的梦想贯穿了整个高中。无论如何，这本书展示了你可以在这方面使用 Java 做的很多事情......别管一个 29 岁的人会用 15 岁的*口哨*写的书做什么。我买的时候才28岁......

无论如何，Java 拥有如此多的库使得绘制图形变得相当容易。Qbasic 有糟糕的图形，但它有相当简单的调用来打开和关闭像素并绘制线条，当我 12 或 13 岁时，我们中的很多人只会使用循环等在 QBasic 中对图形产生奇怪的效果......虽然它是完全是浪费时间，它进一步帮助加强了迭代、数组等的概念......

所以无论如何，根据我的经验和我当时会编程的朋友的经验，我会说孩子们喜欢花里胡哨的图形效果和创建视频游戏。即使是文字游戏也很重要。Java 拥有大量的库，这些库可以做很多事情，并将程序员从实现细节中解放出来，这意味着如果 Java 在我年轻的时候就已经存在，我可能会一直在修补它。添加一本由 15 岁的孩子写的关于 Java 中简单视频游戏的书（注意他不是一个正常的 15 岁，那个孩子当时是大学二年级的学生……所以想想神童），你就有了一个食谱勾起孩子的兴趣。

如果 Java 的冗长太冗长而无法引起您孩子的兴趣，请尝试使用 Python。我想我记得在那里看到了一个用于制作 2d 游戏的库......但至少它可能会比 qbasic 制作更好的文字冒险游戏 :)

* * *

## 回答 #14

> 赞同：1
> 
>             
> 
> 时间：2008-11-03T07:47:52.977

一旦你开始让你的儿子开始你可以尝试 CodeInvaders，竞争对于让他思考非常有用，甚至可能是父子竞争。

[代码入侵者@IBM](https://www.ibm.com/developerworks/community/wikis/home/wiki/HSPC%20-%20High%20School%20Programming%20Contest%20Central/page/CodeInvaders?lang=en)

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T19:29:52.767

这个问题类似于[https://stackoverflow.com/questions/165905/how-and-when-do-you-teach-a-kid-to-code#165909](https://stackoverflow.com/questions/165905/how-and-when-do-you-teach-a-kid-to-code#165909)。

我最大的孩子也是 8 岁，我知道他有编程的右脑，但他需要时间。我认为你应该保持小任务，但他们必须有早期的结果。否则他们可能会感到失望。

# 3d - “在线房间规划器”网站最好的 3-D 技术是什么？

> ID：255979
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-11-01T19:17:11.200
> 
>         
> 
> 标签：3d

主要的用户案例是：

1.  创建二维平面图

2.  以颜色和动态照明（打开和关闭灯）查看房间的 3D 视图

3.  从预定义样本的大型库中选择家具。

4.  改变家具样品的颜色和质地。

5.  从不同的角度创建 3D 房间视图的照片。

6.  用户还可以在房间内移动和转动相机并发现视图。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-11-02T11:23:29.300

虽然在 Flash 中做 3D 很酷很不错，但为什么不在用户显卡上使用真正支持 3D 加速的工具，而[Unity](http://unity3d.com/)是一个游戏引擎，我认为你可以用它创建你的工具，此外你得到支持在各种建模工具中创建 3D 内容，Unity 支持 Web 插件。还有几个 Java 3D 引擎，[JMonkeyEngine](http://www.jmonkeyengine.com/)只是其中之一。

我认为使用这些中的任何一个都可以获得比 Flash 更好的性能和视觉质量。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-08-25T22:18:11.663

这是一个非常好的 Java 房间规划器 - [http://www.sweethome3d.eu/index.jsp](http://www.sweethome3d.eu/index.jsp)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2010-08-05T14:12:23.520

你可以试试[3DMLW 3D引擎](http://www.3dmlw.com)。这将允许您执行任何能够在 Web 浏览器中运行的自定义 3D 应用程序。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-11-01T22:53:59.657

我建议你看看像 Suite75 的人在 floorplanner.com 时所做的那样为 Flash[平台](http://www.floorplanner.com/)[进行](http://www.suite75.net)开发。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2010-03-19T10:39:45.023

[http://www.3decorator.com](http://www.3decorator.com)怎么样。由 Flex/Papervision3D 制成它是完全 3D 在线房间规划器。看起来很好！

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2014-09-13T23:28:24.800

查看 Unity 3D 资源商店中的 Prototyper，它具有用于在 Unity 中进行建筑建模的工具。pro builder 版本将满足您的规格中规定的要求。干杯。

* * *

## 回答 #7

> 赞同：-2
> 
>             
> 
> 时间：2008-11-01T19:19:30.820

看看有些人在 Flash/Flex 中使用[Papervision3D做了什么。](http://papervision3d.org/)

但是，如果您问这个问题，那么这对您来说太雄心勃勃了。********** 
```**********