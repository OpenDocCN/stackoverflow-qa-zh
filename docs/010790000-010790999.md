# StackOverflow 问答 10790000-10790999

# python - 根据特定模式将单个文本文件分成多个文件

> ID：10790003
> 
> 赞同：1
> 
> 时间：2012-05-28T20:16:50.030
> 
> 标签：python, perl, unix, awk, grep

假设我有以下文件：（Song.txt）

```
Song one
bla bla bla bla 
bla bla bla bla bla
Song two
yaya ya yaa 
blaaa bla bla blaaaaa
Song three
bla bla bla 
```

我想将此文件分成三个文件，如下所示：

第一个文件名应该是 Song_1.txt

```
Song One
bla bla bla bla 
bla bla bla bla bla 
```

第二个文件名应该是 Song_2.txt

```
Song two
yaya ya yaa 
blaaa bla bla blaaaaa 
```

第三个文件名应该是 Song_3.txt

```
Song three
bla bla bla 
```

如何使用 awk、grep、perl、python 和/或任何可用的基于 unix 的工具和语言来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T20:48:54.210

```
csplit Song.txt --elide-empty-files --prefix=Song_ --suffix-format='%1d.txt' '/Song one/' '/Song two/' '/Song three/' 
```

或者

```
csplit Song.txt -z -f Song_ -b '%1d.txt' '/Song one/' '/Song two/' '/Song three/' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T20:21:17.520

`csplit`可用于使用正则表达式拆分文本文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-28T22:07:07.687

这应该有帮助 -

```
gawk -v RS="Song" 'NF{ print RS$0 > "Song_"++n".txt" }' Song.txt 
```

### 测试：

```
[jaypal:~/Temp] cat Song.txt 
Song one
bla bla bla bla 
bla bla bla bla bla
Song two
yaya ya yaa 
blaaa bla bla blaaaaa
Song three
bla bla bla

[jaypal:~/Temp] gawk -v RS="Song" 'NF{ print RS$0 > "Song_"++n".txt" }' Song.txt

[jaypal:~/Temp] ls -l S*
-rw-r--r--  1 jaypalsingh  staff  113 28 May 17:55 Song.txt
-rw-r--r--  1 jaypalsingh  staff   47 28 May 18:06 Song_1.txt
-rw-r--r--  1 jaypalsingh  staff   45 28 May 18:06 Song_2.txt
-rw-r--r--  1 jaypalsingh  staff   24 28 May 18:06 Song_3.txt

[jaypal:~/Temp] cat Song_1.txt 
Song one
bla bla bla bla 
bla bla bla bla bla

[jaypal:~/Temp] cat Song_2.txt 
Song two
yaya ya yaa 
blaaa bla bla blaaaaa

[jaypal:~/Temp] 
```

# php - PHP - 根据字段的值划分多维数组

> ID：10790009
> 
> 赞同：3
> 
> 时间：2012-05-28T20:17:47.880
> 
> 标签：php, arrays, multidimensional-array, split

我有一个初始数组：

```
$arr0 = array(
    0 => array(
        'a' => 1,
        'b' => 1
    )
    1 => array(
        'a' => 2,
        'b' => 1
    )
    2 => array(
        'a' => 3,
        'b' => 2
    )
    3 => array(
        'a' => 4,
        'b' => 3
    )
    4 => array(
        'a' => 5,
        'b' => 3
    )
); 
```

我希望根据字段“b”的成员值将其划分为单独的数组，如下所示：

```
// $arr1 contains $arr0[0] and $arr0[1] because their value of 'b' is 1.
$arr1 = array(
    0 => array(
        'a' => 1,
        'b' => 1
    )
    1 => array(
        'a' => 2,
        'b' => 1
    )
);

// $arr2 contains $arr0[2] because its value of 'b' is 2.
$arr2 = array(
    0 => array(
        'a' => 3,
        'b' => 2
    )
);

// $arr3 contains $arr0[3] and $arr0[4] because their value of 'b' is 3.
$arr3 = array(
    0 => array(
        'a' => 4,
        'b' => 3
    )
    1 => array(
        'a' => 5,
        'b' => 3
    )
); 
```

现在，字段“b”可以具有任何自然数作为值，因此我并不总是需要三个结果数组。

我在[这里](https://stackoverflow.com/questions/1019076/how-to-search-by-key-value-in-a-multidimensional-array-in-php)找到了一个相关的问题（和答案） ，但我的问题是具体的，因为我事先不知道原始值 'b' 有什么，以及有多少不同的值。

有任何想法吗？

（编辑：$arr3 写成 $arr1）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T20:24:53.357

```
foreach ($arr0 as $value) {
  ${"arr" . $value['b']}[] = $value;
}
// $arr1, $arr2 and $arr3 are defined 
```

第二行有一个神奇的地方，它动态地构建了一个变量名。但是，这种编程方式确实很笨拙。您最好将结果放入另一个数组中，如下所示：

```
foreach ($arr0 as $value) {
  $allarr[$value['b']][] = $value;
}
// $allarr is defined 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T20:23:09.460

```
foreach ($arr0 as $val) {
    $b = $val ['b'];
    if (!$arr$b) $arr$b = array();
    $arr$b[] = $val;
} 
```

# javascript - KMZ 文件在 Google 地球中加载，但在 Google 地图中不加载

> ID：10790011
> 
> 赞同：0
> 
> 时间：2012-05-28T20:17:47.970
> 
> 标签：javascript, google-maps, kml, google-earth, kmz

我需要能够将一些 KML 和 KMZ 文件加载到 Google 地图中。我正在使用的文件在 Google 地球中显示没有问题，但是当我尝试在 Google 地图中上传它们时，该文件似乎上传但不显示任何内容。

[http://www.ec.gc.ca/inrp-npri/default.asp?lang=en&n=1D892B9F-1](http://www.ec.gc.ca/inrp-npri/default.asp?lang=en&n=1D892B9F-1)上的 KMZ 文件（2010、2009 或 1993-2010 文件）似乎可以正常上传，但是它不会在地图上显示任何点。加拿大各地应该有五颜六色的点，但没有出现。这些文件也小于 10MB。

我尝试将公共 URL 粘贴到搜索框中而不是导入，但出现与导入文件时相同的问题。必须做些什么才能让我在 Google 地图中显示它们？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T21:46:15.510

问题在于，在这种情况下，KML 使用 ListStyle 创建您在 Google 地球中看到的单选按钮界面。但这在谷歌地图中不受支持： [https ://developers.google.com/kml/documentation/kmlelementsinmaps](https://developers.google.com/kml/documentation/kmlelementsinmaps)

# c# - 又一个引用/值类型误用

> ID：10790017
> 
> 赞同：0
> 
> 时间：2012-05-28T20:18:18.317
> 
> 标签：c#, .net, arrays, reference

看起来我没能理解引用和值类型列表背后的概念。

在这里，我想填充一个包含 30000 个 uint16 的数组，一次包含 125 个值。

完成后，我想将其添加到列表中并开始填充另一块 30000 个值。但是，我只存储对一个数组的引用。这是一个测试代码：

```
UInt16[] ND = new UInt16[30000];
OMD.Clear();
for (int i = 0; i < 30000; i++) ND[i] = (ushort)i;
OMD.Add(ND);
for (int i = 0; i < 30000; i++) ND[i] = 13;
OMD.Add(ND); 
```

在第二个循环中，OMD 的第一个数组成员丢失了它的值并变为 13。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:21:39.193

您可以清除引用并在每个循环后创建一个新引用。

```
UInt16[] ND = new UInt16[30000];
OMD.Clear();
for (int i = 0; i < 30000; i++) ND[i] = (ushort)i;
OMD.Add(ND);

ND = new UInt16[30000];
for (int i = 0; i < 30000; i++) ND[i] = 13;
OMD.Add(ND); 
```

# java - spring hibernate 自动接线 - 在自动接线 sessionFactory 上获取 NPE - httpinvoker 远程处理项目

> ID：10790018
> 
> 赞同：0
> 
> 时间：2012-05-28T20:18:22.990
> 
> 标签：java, spring, hibernate, configuration, autowired

我正在尝试配置和运行 spring + hibernate 客户端服务器项目（`Spring's HTTP invoker`）。我省略了 httpinvoker 配置和 web.xml，因为 httpinvoker 的配置运行良好。根据答案中的建议，我删除了`TestSimple`该类，并在尝试从客户端运行服务时发布了堆栈跟踪。

我`mvn tomcat:run`在服务器端运行时发布了日志（如下），并在调用客户端代码后发布了堆栈跟踪（发布在下面）。我正在为 sessionFactory 获取 NPE。你能提出一些想法吗？

我的 applicationContext.xml 看起来像：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
    xmlns:p="http://www.springframework.org/schema/p" xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
            http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
            http://www.springframework.org/schema/context
            http://www.springframework.org/schema/context/spring-context-3.0.xsd
            http://www.springframework.org/schema/tx 
            http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
            http://www.springframework.org/schema/mvc 
            http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

        <!-- Database Configuration -->
    <bean
        class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location">
            <value>/WEB-INF/config.properties</value>
        </property>
    </bean>

    <bean id="dataSource"
        class="org.springframework.jdbc.datasource.DriverManagerDataSource"
        p:driverClassName="${jdbc.driverClassName}" p:url="${jdbc.url}"
        p:username="${jdbc.username}" p:password="${jdbc.password}" />

    <bean id="sessionFactory"
        class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="hibernateProperties">
            <props>
                <prop key="dialect">${hibernate.dialect}</prop>
                <prop key="show_sql">${hibernate.show_sql}</prop>
                <prop key="format_sql">true</prop>
                <prop key="use_sql_comments">true</prop>
                <prop key="hibernate.connection.autocommit">true</prop>
                <prop key="hbm2ddl.auto">${hibernate.hbm2ddl.auto}</prop>
            </props>
        </property>
        <property name="packagesToScan" value="com.gt.cbpr.model"></property>
    </bean>

    <!-- auto wired/scan annotation based config -->
    <context:annotation-config />
    <context:component-scan base-package="com.gt.cbpr.server" />
    <tx:annotation-driven />

    <bean id="transactionManager"
        class="org.springframework.orm.hibernate4.HibernateTransactionManager">
        <property name="dataSource" ref="dataSource" />
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>

</beans> 
```

我的 LoginUserServiceImpl ：

```
package com.gt.cbpr.server.service.impl;

import org.hibernate.SessionFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import com.gt.cbpr.model.LoginUser;
import com.gt.cbpr.service.LoginUserService;

@Component
public class LoginUserServiceImpl implements LoginUserService {
    @Autowired
    private SessionFactory sessionFactory;

    public void saveLoginUser(LoginUser user) throws Exception {
        System.out.println(sessionFactory);
        sessionFactory.getCurrentSession().saveOrUpdate(user);

    }
} 
```

客户端代码：

```
import com.gt.cbpr.model.LoginUser;
import com.gt.cbpr.service.LoginUserService;
import com.gt.lib.utils.BeanUtils;

public class HelloClient {

    public static void main(String[] args) throws Exception{
        LoginUserService lus = (LoginUserService) BeanUtils.getBean("loginService");
        LoginUser u  = new LoginUser();
        u.setUsername("AA");
        u.setPassword("AAAASS");
        lus.saveLoginUser(u); // I get exception here.
    }
} 
```

tomcat 日志： http: [//pastebin.com/Xw92PJv6](http://pastebin.com/Xw92PJv6)

我运行上述客户端代码时的堆栈跟踪：

```
10:47:11,938 DEBUG DispatcherServlet:819 - DispatcherServlet with name 'remoting' processing POST request for [/cbpr/remoting/helloService]
10:47:11,942 DEBUG BeanNameUrlHandlerMapping:124 - Mapping [/helloService] to HandlerExecutionChain with handler [org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter@93fd01] and 1 interceptor
10:47:11,946 DEBUG HttpInvokerServiceExporter:73 - Applying RemoteInvocation: method name 'setHello'; parameter types [com.gt.cbpr.model.HelloObject]
10:47:11,950 DEBUG RemoteInvocationTraceInterceptor:66 - Incoming HttpInvokerServiceExporter remote call: com.gt.cbpr.service.HelloService.setHello
10:47:11,950 DEBUG RemoteInvocationTraceInterceptor:72 - Finished processing of HttpInvokerServiceExporter remote call: com.gt.cbpr.service.HelloService.setHello
10:47:11,956 DEBUG DispatcherServlet:957 - Null ModelAndView returned to DispatcherServlet with name 'remoting': assuming HandlerAdapter completed request handling
10:47:11,956 DEBUG DispatcherServlet:913 - Successfully completed request
10:47:11,961 DEBUG DispatcherServlet:819 - DispatcherServlet with name 'remoting' processing POST request for [/cbpr/remoting/helloService]
10:47:11,961 DEBUG BeanNameUrlHandlerMapping:124 - Mapping [/helloService] to HandlerExecutionChain with handler [org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter@93fd01] and 1 interceptor
10:47:11,962 DEBUG HttpInvokerServiceExporter:73 - Applying RemoteInvocation: method name 'getHello'; parameter types []
10:47:11,962 DEBUG RemoteInvocationTraceInterceptor:66 - Incoming HttpInvokerServiceExporter remote call: com.gt.cbpr.service.HelloService.getHello
10:47:11,963 DEBUG RemoteInvocationTraceInterceptor:72 - Finished processing of HttpInvokerServiceExporter remote call: com.gt.cbpr.service.HelloService.getHello
10:47:11,964 DEBUG DispatcherServlet:957 - Null ModelAndView returned to DispatcherServlet with name 'remoting': assuming HandlerAdapter completed request handling
10:47:11,965 DEBUG DispatcherServlet:913 - Successfully completed request
10:47:11,994 DEBUG DispatcherServlet:819 - DispatcherServlet with name 'remoting' processing POST request for [/cbpr/remoting/loginService]
10:47:11,995 DEBUG BeanNameUrlHandlerMapping:124 - Mapping [/loginService] to HandlerExecutionChain with handler [org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter@9036e] and 1 interceptor
10:47:11,997 DEBUG HttpInvokerServiceExporter:73 - Applying RemoteInvocation: method name 'saveLoginUser'; parameter types [com.gt.cbpr.model.LoginUser]
10:47:11,999 DEBUG RemoteInvocationTraceInterceptor:66 - Incoming HttpInvokerServiceExporter remote call: com.gt.cbpr.service.LoginUserService.saveLoginUser
null

10:47:12,009  WARN RemoteInvocationTraceInterceptor:80 - Processing of HttpInvokerServiceExporter remote call resulted in fatal exception: com.gt.cbpr.service.LoginUserService.saveLoginUser
java.lang.NullPointerException
        at com.gt.cbpr.server.service.impl.LoginUserServiceImpl.saveLoginUser(LoginUserServiceImpl.java:25)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:318)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
        at org.springframework.remoting.support.RemoteInvocationTraceInterceptor.invoke(RemoteInvocationTraceInterceptor.java:70)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
        at $Proxy26.saveLoginUser(Unknown Source)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.springframework.remoting.support.RemoteInvocation.invoke(RemoteInvocation.java:205)
        at org.springframework.remoting.support.DefaultRemoteInvocationExecutor.invoke(DefaultRemoteInvocationExecutor.java:38)
        at org.springframework.remoting.support.RemoteInvocationBasedExporter.invoke(RemoteInvocationBasedExporter.java:76)
        at org.springframework.remoting.support.RemoteInvocationBasedExporter.invokeAndCreateResult(RemoteInvocationBasedExporter.java:112)
        at org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter.handleRequest(HttpInvokerServiceExporter.java:117)
        at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:49)
        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
        at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:857)
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)
        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
        at java.lang.Thread.run(Thread.java:662)
10:47:12,020 DEBUG HttpInvokerServiceExporter:92 - Target method failed for RemoteInvocation: method name 'saveLoginUser'; parameter types [com.gt.cbpr.model.LoginUser]
java.lang.NullPointerException
        at com.gt.cbpr.server.service.impl.LoginUserServiceImpl.saveLoginUser(LoginUserServiceImpl.java:25)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:318)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
        at org.springframework.remoting.support.RemoteInvocationTraceInterceptor.invoke(RemoteInvocationTraceInterceptor.java:70)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
        at $Proxy26.saveLoginUser(Unknown Source)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.springframework.remoting.support.RemoteInvocation.invoke(RemoteInvocation.java:205)
        at org.springframework.remoting.support.DefaultRemoteInvocationExecutor.invoke(DefaultRemoteInvocationExecutor.java:38)
        at org.springframework.remoting.support.RemoteInvocationBasedExporter.invoke(RemoteInvocationBasedExporter.java:76)
        at org.springframework.remoting.support.RemoteInvocationBasedExporter.invokeAndCreateResult(RemoteInvocationBasedExporter.java:112)
        at org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter.handleRequest(HttpInvokerServiceExporter.java:117)
        at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:49)
        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
        at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:857)
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)
        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
        at java.lang.Thread.run(Thread.java:662)
10:47:12,064 DEBUG DispatcherServlet:957 - Null ModelAndView returned to DispatcherServlet with name 'remoting': assuming HandlerAdapter completed request handling
10:47:12,067 DEBUG DispatcherServlet:913 - Successfully completed request 
```

我不知道出了什么问题。你能帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T20:23:04.523

只是一个猜测，但你是`saveUser`从构造函数调用的。我不确定spring，但是在我使用的其他CDI中，bean不是在创建对象时注入的，而是在创建对象之后注入的。

对于这种“初始化”，您应该使用`saveUser`with `@PostConstruct`（在注入依赖项后执行该方法）。该方法不应带任何参数。当然，您应该从构造函数中删除方法调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T20:27:48.940

您显示的日志是您的 Web 应用程序的日志。您的测试是一个独立的应用程序，其中主要方法只是使用`new`. Spring 无法自动装配不实例化自身的 bean。当你使用 new 构造一个 bean 时，你完全绕过了 Spring。

您的 main 方法需要实例化一个应用程序上下文，并向该上下文询问 type 的 bean `TestSimple`。

@SJUan76 的答案也是正确的。Spring 实例化 bean ，然后自动装配它。所以在构造函数中，还没有自动装配任何东西。在构造函数中执行初始化以外的操作通常是一种不好的做法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T20:28:15.500

您没有将 TestSimple 拉出 Spring 上下文，因此 @Autowired 标记什么也不做。在您的主体中，将对象从弹簧上下文中拉出来，这会更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T21:12:44.313

如果您正在编写集成测试来测试应用程序容器中 bean 的行为，那么您应该考虑使用[Spring TestContext 框架](http://static.springsource.org/spring/docs/3.0.5.RELEASE/reference/testing.html#testcontext-framework)（这是为 Spring 编写集成测试的官方方法） - 没有魔法 - 通常 JUnit 将运行 Spring Test实现 JUnit Class Runner Api 的上下文类。因此，您运行 JUnit，JUnit 运行 TestContext Framework，Test Context Framework 从指定的 XML 配置文件创建应用程序上下文并运行您的测试。简单的。

单元测试是另一回事，你可以通过模拟它们的依赖项来分别测试你的 bean。在这一部分中，您必须手动注入 bean 的依赖项 - 没有 DI 容器，因此您必须直接从测试类调用构造函数和属性设置器。这也可能意味着您必须用公共 @Autowired 属性设置器替换您的 @Autowired 字段。

# c# - Entity Framework 4.3 - Code First - 更新列表属性

> ID：10790022
> 
> 赞同：0
> 
> 时间：2012-05-28T20:18:48.767
> 
> 标签：c#, entity-framework

[作为我之前的问题](https://stackoverflow.com/questions/10785595/updating-an-objects-list-property-in-entity-framework-4-3-code-first-n-tier)的后续，我现在知道 EF 不会自动为我保存整个实体的所有更改。如果我的实体有一个 List<Foo>，我需要更新该列表并保存它。但是怎么做？我已经尝试了一些事情，但我无法正确保存列表。

我在 Application 和 CustomVariableGroup 之间有一个多对多的关联。一个应用程序可以有一个或多个组，一个组可以属于一个或多个应用程序。我相信我的 Code First 实现正确设置了这个，因为我在数据库中看到了多对多关联表。

底线是 Application 类有一个 List<CustomVariableGroup>。我的简单案例是应用程序已经存在，现在用户选择了一个属于该应用程序的组。我想将该更改保存在数据库中。

**尝试#1**

```
this.Database.Entry(application).State = System.Data.EntityState.Modified;
this.Database.SaveChanges(); 
```

结果：关联表仍然没有行。

**尝试#2**

```
this.Database.Applications.Attach(application);
var entry = this.Database.Entry(application);
entry.CurrentValues.SetValues(application);
this.Database.SaveChanges(); 
```

结果：关联表仍然没有行。

**尝试#3**

```
CustomVariableGroup group = application.CustomVariableGroups[0];
application.CustomVariableGroups.Clear();
application.CustomVariableGroups.Add(group);
this.Database.SaveChanges(); 
```

结果：关联表仍然没有行。

我研究了很多，我尝试的东西比我展示的要多，我根本不知道如何使用新的 CustomVariableGroup 更新应用程序的列表。应该怎么做？

**编辑（解决方案）**

经过数小时的反复试验，这似乎奏效了。看来我需要从数据库中获取对象，修改它们，然后保存它们。

```
public void Save(Application application)
{
    Application appFromDb = this.Database.Applications.Single(
      x => x.Id == application.Id);
    CustomVariableGroup groupFromDb = this.Database.CustomVariableGroups.Single(
      x => x.Id == 1);
    appFromDb.CustomVariableGroups.Add(groupFromDb);
    this.Database.SaveChanges();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T01:09:35.063

虽然我认为这有点骇人听闻，但它确实有效。我发布这个是希望它可以帮助其他人节省一整天的工作量。

```
public void Save(Application incomingApp)
{
    if (incomingApp == null) { throw new ArgumentNullException("incomingApp"); }

    int[] groupIds = GetGroupIds(incomingApp);

    Application appToSave;

    if (incomingApp.IdForEf == 0)  // New app
    {
        appToSave = incomingApp;
        // Clear groups, otherwise new groups will be added to the groups table.
        appToSave.CustomVariableGroups.Clear();
        this.Database.Applications.Add(appToSave);                
    }
    else
    {
        appToSave = this.Database.Applications
                .Include(x => x.CustomVariableGroups)
                .Single(x => x.IdForEf == incomingApp.IdForEf);
    }

    AddGroupsToApp(groupIds, appToSave);
    this.Database.SaveChanges();
}

private void AddGroupsToApp(int[] groupIds, Application app)
{
    app.CustomVariableGroups.Clear();

    List<CustomVariableGroup> groupsFromDb2 =
        this.Database.CustomVariableGroups.Where(g => groupIds.Contains(g.IdForEf)).ToList();

    foreach (CustomVariableGroup group in groupsFromDb2)
    {
        app.CustomVariableGroups.Add(group);
    }
}

private static int[] GetGroupIds(Application application)
{
    int[] groupIds = new int[application.CustomVariableGroups.Count];

    int i = 0;
    foreach (CustomVariableGroup group in application.CustomVariableGroups)
    {
        groupIds[i] = group.IdForEf;
        i++;
    }

    return groupIds;
} 
```

# java - 如何在 J2ME 中创建带有数据库的 Midlet SVG

> ID：10790030
> 
> 赞同：0
> 
> 时间：2012-05-28T20:19:38.877
> 
> 标签：java, java-me, svg, midp, netbeans-7

我需要知道如何使用 SVG Netbeans 完成一个应用程序，并且它可以与 Midlet 应用程序的数据库一起使用。然后我对 Netbeans 的 SVG 教程有疑问，因为我创建了 SVG，但在 visualmidlet 屏幕中看不到它。

# ios - 以编程方式更改三个 TTTableImageItem 的图像

> ID：10790032
> 
> 赞同：1
> 
> 时间：2012-05-28T20:19:55.720
> 
> 标签：ios, three20

我正在使用 TTTableViewController（three20 框架）来显示用户配置文件数据（用户名、用户图像等）。

tableview数据源设置如下：

```
_profileImageItem = [TTTableImageItem itemWithText:@"Change Profile Image" imageURL:DEFAULT_PROFILE_IMG URL:@"tt://photoThumbs"];
self.dataSource = [TTSectionedDataSource dataSourceWithObjects:
        @"Profile Image",
        _profileImageItem,  
        @"Profile Name",
        _profileName,
        ...,
        ...]; 
```

当用户选择 _profileImageItem 时，会显示一个 UIImagePicker 视图，用户可以在其中选择新图像。之后，我缩小图像并将其写入应用程序文件夹。

我现在的问题是：如何更新数据源中的图像 URL？目前它仍然指向 DEFAULT_PROFILE_IMG。即使我使用以下方法更新 _profileImageItem 成员：

```
[_profileImageItem setImageURL:@"new URL here"]; 
```

显示旧图像。我试过刷新视图 - 同样的问题。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:46:59.550

好吧，我犯了一个愚蠢的错误。

*TTURLCache*已启用，我只更新了图像，而不是路径（即我已经覆盖了个人资料图像）。由于路径被用作 TTURLCache 中的键，因此缓存返回了缓存的图像；）

```
[[TTURLCache sharedCache] setDisableImageCache:YES]; 
```

解决了这个问题。

# twitter - Twitter Bootstrap 模态数据关闭

> ID：10790041
> 
> 赞同：7
> 
> 时间：2012-05-28T20:20:52.707
> 
> 标签：twitter, twitter-bootstrap, modal-dialog

我正在尝试让模态数据关闭操作在单击时关闭模态。似乎有一个问题我找不到记录，希望这里有人可以对此有所了解。这是代码

```
<!DOCTYPE html>
<html>
<head>
    <meta charset='UTF-8'/>
    <title> Modal test </title>
    <link href='themes/default/bootstrap/css/bootstrap.css' rel='stylesheet'/>
    <link href='themes/default/bootstrap/css/bootstrap-responsive.css'     rel="stylesheet"/>
</head>
<body>
<div class="modal" id="myModal">
  <div class="modal-header">
    <button class="close" data-dismiss="modal">×</button>
    <h3>Modal header</h3>   
  </div>
  <div class="modal-body">
    <p>One fine body…&lt;/p>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn">Close</a>
    <a href="#" class="btn btn-primary">Save changes</a>
  </div>
</div>
<div class="alert alert-block">
  <a class="close" data-dismiss="alert" href="#">x</a>
  <h4 class="alert-heading">Warning!</h4>
    Best check yo self, you're not...
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="themes/default/bootstrap/js/bootstrap.js"></script>
</body>
</html> 
```

是全套引导程序，包括 bootstrap-modal.js

我输入了`<div class="alert alert-block">`用于测试动作，它似乎在警报中起作用，但在模态中不起作用！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T09:32:07.970

请添加此代码：

```
<script  type="text/javascript">
    $(document).ready(function() {
        $('#myModal').modal(); // initialized with defaults
        $('#myModal').modal('show'); // open your modal dialog
    });
</script> 
```

# java - 如何使用正则表达式显示数字？（安卓）

> ID：10790043
> 
> 赞同：0
> 
> 时间：2012-05-28T20:20:58.557
> 
> 标签：java, android, regex

我有这条线：

```
stringer = str.replaceAll("[\\P{L}\\p{N}\\p{Latin}/u]", " "); 
```

它用空格替换所有拉丁字符，`(" ")`但它也替换数字符号

而且我不希望它替换数字符号，我需要在这一行中进行哪些更改才能使其正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T20:23:53.470

以下应该有效：

```
stringer = str.replaceAll("[\\P{L}\\p{N}\\p{Latin}/u&&[^\\d]]", " "); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:46:35.167

你可能想看看内置的 android normalizer，它将把它们转换成非拉丁版本。

[http://developer.android.com/reference/java/text/Normalizer.html](http://developer.android.com/reference/java/text/Normalizer.html)

# python - 为 ios 创建数据库

> ID：10790044
> 
> 赞同：0
> 
> 时间：2012-05-28T20:21:03.023
> 
> 标签：python, ios, database

我正在创建一个应用程序，其中数据库将通过服务器更新，或者它应该被新的替换。你能给我一些提示，我应该使用 CoreData 还是 SqlLite。以及它应该如何更新。我正在使用 python 来解析数据，然后我想创建数据库。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T15:14:01.207

这个问题不是很具体，但如果你不确定你真正需要什么，请远离 CoreData。从 SQLite 开始，也许在它上面使用一个轻量级的包装器。我个人使用[FMDB](https://github.com/ccgus/fmdb)。

FMDB 中有很多关于如何选择、插入、更新等的示例。从自述文件的[执行查询](https://github.com/ccgus/fmdb#executing-queries)部分中选择快速示例：

```
FMDatabase *db = [FMDatabase databaseWithPath:@"/tmp/tmp.db"];

FMResultSet *s = [db executeQuery:@"SELECT * FROM myTable"];
while ([s next]) {
    //retrieve values for each record
} 
```

# php - 在文本中搜索单词并突出显示包含它的所有单词的功能

> ID：10790047
> 
> 赞同：1
> 
> 时间：2012-05-28T20:21:15.047
> 
> 标签：php

此函数在文本中搜索单词（来自 $words 数组）并突出显示它们。

```
function highlightWords(Array $words, $text){ // Loop through array of words
    foreach($words as $word){ // Highlight word inside original text
        $text = str_replace($word, '<span class="highlighted">' . $word . '</span>', $text);
    }         
    return $text; // Return modified text
} 
```

这是问题所在：

假设 $words = array("car", "drive");

**有没有办法让该功能不仅突出显示汽车一词，还突出包含字母“汽车”的单词，例如：汽车、汽车等。**

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:45:23.870

你想要的是一个正则表达式，特别是 preg_replace 或 peg_replace_callback （建议在你的情况下使用回调）

```
<?php
$searchString = "The car is driving in the carpark, he's not holding to the right lane.\n";

// define your word list
$toHighlight = array("car","lane"); 
```

因为您需要一个正则表达式来搜索您的单词，并且您可能希望或需要随时间变化或变化，所以将其硬编码到您的搜索词中是不好的做法。因此，最好使用 array_map 遍历数组并将搜索词转换为正确的正则表达式（这里只是用 / 括起来并添加“接受所有内容直到标点符号”表达式）

```
$searchFor = array_map('addRegEx',$toHighlight);

// add the regEx to each word, this way you can adapt it without having to correct it everywhere
function addRegEx($word){
    return "/" . $word . '[^ ,\,,.,?,\.]*/';
} 
```

接下来，您希望将找到的单词替换为突出显示的版本，这意味着您需要进行动态更改：使用 preg_replace_callback 而不是常规的 preg_replace ，以便它为找到的每个匹配项调用一个函数并使用它来生成正确的结果。在这里，我们将找到的单词包含在其 span 标签中

```
function highlight($word){
    return "<span class='highlight'>$word[0]</span>";
}

$result = preg_replace_callback($searchFor,'highlight',$searchString);

print $result; 
```

产量

```
The <span class='highlight'>car</span> is driving in the <span class='highlight'>carpark</span>, he's not holding to the right <span class='highlight'>lane</span>. 
```

因此，显然只需将这些代码片段粘贴在另一个之后即可获得工作代码。;)

编辑：下面的完整代码稍作修改=放置在例程中，以便原始请求者使用。+ 不区分大小写

完整代码：

```
<?php

$searchString = "The car is driving in the carpark, he's not holding to the right lane.\n";
$toHighlight = array("car","lane");

$result = customHighlights($searchString,$toHighlight);

print $result;

// add the regEx to each word, this way you can adapt it without having to correct it everywhere

function addRegEx($word){
    return "/" . $word . '[^ ,\,,.,?,\.]*/i';
}

function highlight($word){
    return "<span class='highlight'>$word[0]</span>";
}

function customHighlights($searchString,$toHighlight){

// define your word list
$searchFor = array_map('addRegEx',$toHighlight);
$result = preg_replace_callback($searchFor,'highlight',$searchString);
return $result;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:31:09.993

我还没有测试过，但我认为应该这样做：-

```
$text = preg_replace('/\W((^\W)?$word(^\W)?)\W/', '<span class="highlighted">' . $1 . '</span>', $text); 
```

这会在一个完整的有界单词中查找字符串，然后使用 preg_replace 和正则表达式将跨度放在整个字符串中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T21:01:11.410

```
function replace($format, $string, array $words)
{
    foreach ($words as $word) {
        $string = \preg_replace(
            sprintf('#\b(?<string>[^\s]*%s[^\s]*)\b#i', \preg_quote($word, '#')),
            \sprintf($format, '$1'), $string);
    }
    return $string;
}

// courtesy of http://slipsum.com/#.T8PmfdVuBcE
$string = "Now that we know who you are, I know who I am. I'm not a mistake! It
all makes sense! In a comic, you know how you can tell who the arch-villain's
going to be? He's the exact opposite of the hero. And most times they're friends,
like you and me! I should've known way back when... You know why, David? Because
of the kids. They called me Mr Glass.";

echo \replace('<span class="red">%s</span>', $string, [
    'mistake',
    'villain',
    'when',
    'Mr Glass',
]); 
```

正因为它使用`sprintf`周围字符串的格式，您可以相应地更改替换。

[请原谅 5.4 语法]

# perl - 如何检测XML元素是否有子元素

> ID：10790057
> 
> 赞同：2
> 
> 时间：2012-05-28T20:22:29.230
> 
> 标签：perl, libxml2

我正在使用 CPAN[`XML::LibXML`](http://metacpan.org/module/XML::LibXML)模块来处理下面的 XML 数据。我需要确定每个元素是否有子元素。环顾四周，我找不到任何用于此目的的示例。

```
<A>
    <ts>2012</ts>
    <T>M1</T>
    <T>M2</T>
    <B>
        <id>PC</id>
        <r>10</r>
        <r>30</r>
    </B>
</A> 
```

这是我写的 Perl 代码

```
#!/usr/bin/perl

use strict;
use warnings;

use XML::LibXML;

my ($x,$elname,$haschild)= ();
my $parser = XML::LibXML->new();
my $npo    = $parser->parse_file("test.xml");
my $rootel = $npo -> getDocumentElement();
$elname = $rootel -> nodeName();
print "Root name=$elname\n";

foreach $x ($rootel->childNodes) {
    $elname = $x -> nodeName();
    $haschild = $x->hasChildNodes;
    print "Child name = $elname and has child = $haschild.\n" unless ($elname =~ /#text/i);
} 
```

虽然我曾经`childNodes`遍历每个节点，但我找不到一种简单的方法来确定该节点是否有子节点。

我希望在遍历所有节点后得到结果：

```
A: Has children
ts: Has none
T: has none
T: has none
B: Has children
id: Has none
r: Has none
r: Has none 
```

我得到的结果是这样的：

```
Root name=A
Child name = ts and has child = 1.
Child name = T and has child = 1.
Child name = T and has child = 1.
Child name = B and has child = 1. 
```

`hasChildNodes`条件检查后似乎所有节点都返回 true 。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T22:12:53.820

您要的是节点的子*元素的数量。*子*节点*将包括文本和无关紧要的空白。

计算节点拥有的子元素数量的最简单方法是使用`findnodes('*')->size`XPath 表达式`*`仅计算子元素。

这是一些执行您描述的代码

```
use v5.14;
use warnings;

use XML::LibXML;

my $xml = XML::LibXML->load_xml(string => <<XML);
<A>
    <ts>2012</ts>
    <T>M1</T>
    <T>M2</T>
    <B>
        <id>PC</id>
        <r>10</r>
        <r>30</r>
    </B>
</A>
XML

my $nodes = $xml->findnodes('//*');
foreach my $node ($nodes->get_nodelist) {
  my $children;
  for ($node->findnodes('*')->size) {
    $children = 'none' when 0;
    $children = '1 child' when 1;
    default { $children = "$_ children" }
  }
  printf "%s: has %s\n", $node->localname, $children;
} 
```

**输出**

```
A: has 4 children
ts: has none
T: has none
T: has none
B: has 3 children
id: has none
r: has none
r: has none 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T22:01:14.630

`hasChildNodes`方法呢？

```
use XML::LibXML;
my $xml = XML::LibXML->createDocument;
$xml->setDocumentElement($xml->createElement('root'));
$xml->documentElement->addChild($xml->createElement('son'));
for my $node ($xml->documentElement,
              $xml->documentElement->firstChild) {
    print $node->hasChildNodes, "\n";
} 
```

印刷

```
1
0 
```

请记住，文本节点也是子节点（即节点和元素是不同的概念）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-06T11:21:39.767

如果您只需要知道是否存在子节点，那么测试：

`$node->exists('*')`

会比：

`$node->findnodes('*')->size`

因为一旦找到第一个节点，它就会退出。

# ruby - 如何仅选择 h4 标签之后的 p 标签 - 但不是 Nokogiri 中的子标签？

> ID：10790061
> 
> 赞同：0
> 
> 时间：2012-05-28T20:22:50.563
> 
> 标签：ruby, nokogiri

我可以使用 Xpath 或 CSS。

我试过：

```
my_page.xpath('//h4/p') 
```

但这似乎只寻找`p`属于`h4`.

我正在解析的 HTML 结构如下所示：

```
<h4 class="ban">Mon May 28</h4>
<p><a href="http://phoenix.craigslist.org/cph/cpg/3043067349.html">.Net/Java Developers</a> - <font size="-1"> (phoenix )</font></p>
<p><a href="http://phoenix.craigslist.org/cph/cpg/3043066699.html">QA and Business Analysts</a> - <font size="-1"> (Phoenix Metro)</font></p> 
```

页面上还有其他`p`&`a`元素......但基本上我想要做的是将`h4`标签中的单词与页面上它之后的链接相关联（不嵌套在其中）。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:25:52.533

`my_page.css("h4 + p")`应该管用。

`+`是[相邻的兄弟选择器](http://www.w3.org/TR/CSS2/selector.html#adjacent-selectors)。

# javascript - Javascript - 将输入字段的值设置为等于从下拉列表中选择的值

> ID：10790065
> 
> 赞同：0
> 
> 时间：2012-05-28T20:23:06.033
> 
> 标签：javascript, select, drop-down-menu, input

我有一个基于 PHP 的表单。它有一个从 mysql 数据库中获取值的下拉列表。

```
<select name=cat onchange="AjaxFunction(this.value);" style="width=600"> <br>
<option value='' Select One</option> 
<br>
<? 
  require "config.php";// connection to database  
  $q=mysql_query("select cat_id from categories"); 
  while($n=mysql_fetch_array($q)){ 
    echo "<option value=$n[cat_id]>$n[category]</option>"; 
  } 
?> 
</select> 
```

下拉列表 100% 有效。然后我有另一个文本输入字段，

```
<input type=text name=copycat> 
```

我希望山寨输入框的值等于下拉列表的选定值，并实时更新。

这可以做到吗？我应该很容易想象。我在想类似的事情：

```
<input type=text name=copycat onBlur="document.getElementById('cat').value=this.value;"> 
```

任何帮助，将不胜感激。

谢谢和问候， 瑞安

**更新**

使 javscript sendValue 与山寨值一起工作的代码。

catalin87，请协助让 sendvalue 正常工作，目前，单击选择按钮没有来自浏览器的响应。

再次感谢，瑞安

```
<? 

  $con = mysql_connect('localhost', 'username', 'password'); 
 if (!$con) 
   { 
   die('Could not connect to server: ' . mysql_error()); 
   } 
   $db=mysql_select_db("database", $con); 

    if (!$db) 
   { 
   die('Could not connect to DB: ' . mysql_error()); 
   } 

$sql="select packcode,category,description,grouping,packconfig,sellingunits,eottpoints from skudata order by category, packcode";
$result=mysql_query($sql);

 ?> 

<script type="text/javascript"> 

  function AjaxFunction(cat_id) { 
    var httpxml; 
    try { 
      // Firefox, Opera 8.0+, Safari 
      httpxml = new XMLHttpRequest(); 
    } catch (e) { 
      // Internet Explorer 
      try { 
        httpxml = new ActiveXObject("Msxml2.XMLHTTP"); 
      } catch (e) { 
        try { 
          httpxml = new ActiveXObject("Microsoft.XMLHTTP"); 
        } catch (e) { 
          alert("Your browser does not support AJAX!"); 
          return false; 
        } 
      } 
    } 
    function stateck() { 
      if (httpxml.readyState == 4) { 
        var myarray = eval(httpxml.responseText); 
        // Before adding new we must remove previously loaded elements 
        for (j = document.testform.subcat.options.length - 1; j >= 0; j--) { 
          document.testform.subcat.remove(j); 
        } 
        for (i = 0; i < myarray.length; i++) { 
          var optn = document.createElement("OPTION"); 
          optn.text = myarray[i]; 
          optn.value = myarray[i]; 
          document.testform.subcat.options.add(optn); 
        }  
      } 
    } 
    var url="dd.php"; 
    url = url+"?cat_id="+cat_id; 
    url = url+"&sid="+Math.random(); 
    httpxml.onreadystatechange = stateck; 
    httpxml.open("GET",url,true); 
    httpxml.send(null); 
  } 

</script> 

 <script type="text/javascript"> 
function updateinput(){ 
var e = document.getElementById("subcat"); 
var catSelected = e.options[e.selectedIndex].value; 

document.getElementById("copycat").value=catSelected; 
} 
</script> 

<script type="text/javascript"> 
function sendValue(value)
 { 
 value = e.options[e.selectedIndex].value; 
 var parentId = <?php echo json_encode($_GET['id']); ?>; 
 window.opener.updateValue(parentId, value); 
 window.close(); 
 } 
 </script> 

<form name="testform">
Category: &nbsp; <select name=cat id=cat onchange="AjaxFunction(this.value);" style="width=600"> <br>
<option value='' style="width=600">Select One</option> 
<br>
<? 

  require "config.php";// connection to database  
  $q=mysql_query("select * from categories"); 
  while($n=mysql_fetch_array($q)){ 
    echo "<option value=$n[cat_id]>$n[category]</option>"; 
  } 

?> 
</select> 
 <br><br>
 Pack Code:
<select name=subcat onchange="updateinput();" > 
 <br><br>
</select>
<br><br>
<input type=text name=copycat id=copycat > 
<br><br>
<td><input type=button value="Select" onClick="sendValue(document.getElementById(copycat))" /></td>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T20:37:29.527

1`st为选择框和输入设置一个id，并添加一个onChange事件：

```
<select name=cat id=cat onchange="updateinput();" style="width=600">
<input type=text name=copycat id=copycat > 
```

然后把这个函数放在某个地方：

```
<script type="text/javascript">
function updateinput(){
var e = document.getElementById("cat");
var catSelected = e.options[e.selectedIndex].text;

document.getElementById("copycat").value=catSelected;
}    
</script> 
```

这将填充所选项目的标签，如果您想要所选项目的值，请使用此函数：

```
<script type="text/javascript">
function updateinput(){
var e = document.getElementById("cat");
var catSelected = e.options[e.selectedIndex].value;

document.getElementById("copycat").value=catSelected;
}
</script> 
```

* * *

这是您的完整代码：

```
 <? 

  $con = mysql_connect('localhost', 'username', 'password'); 
 if (!$con) 
   { 
   die('Could not connect to server: ' . mysql_error()); 
   } 
   $db=mysql_select_db("dbname", $con); 

    if (!$db) 
   { 
   die('Could not connect to DB: ' . mysql_error()); 
   } 

$sql="select packcode,category,description,grouping,packconfig,sellingunits,eottpoints from skudata order by category, packcode";
$result=mysql_query($sql);

 ?> 

<script type="text/javascript"> 

  function AjaxFunction(cat_id) { 
    var httpxml; 
    try { 
      // Firefox, Opera 8.0+, Safari 
      httpxml = new XMLHttpRequest(); 
    } catch (e) { 
      // Internet Explorer 
      try { 
        httpxml = new ActiveXObject("Msxml2.XMLHTTP"); 
      } catch (e) { 
        try { 
          httpxml = new ActiveXObject("Microsoft.XMLHTTP"); 
        } catch (e) { 
          alert("Your browser does not support AJAX!"); 
          return false; 
        } 
      } 
    } 
    function stateck() { 
      if (httpxml.readyState == 4) { 
        var myarray = eval(httpxml.responseText); 
        // Before adding new we must remove previously loaded elements 
        for (j = document.testform.subcat.options.length - 1; j >= 0; j--) { 
          document.testform.subcat.remove(j); 
        } 
        for (i = 0; i < myarray.length; i++) { 
          var optn = document.createElement("OPTION"); 
          optn.text = myarray[i]; 
          optn.value = myarray[i]; 
          document.testform.subcat.options.add(optn); 
        }  
      } 
    } 
    var url="dd.php"; 
    url = url+"?cat_id="+cat_id; 
    url = url+"&sid="+Math.random(); 
    httpxml.onreadystatechange = stateck; 
    httpxml.open("GET",url,true); 
    httpxml.send(null); 
  } 

</script> 

<script type="text/javascript"> 
function sendValue(value) 
{ 
    var parentId = <?php echo json_encode($_GET['id']); ?>; 
   window.opener.updateValue(parentId, value);
    window.close(); 
} 
</script> 

 <script type="text/javascript"> 
function updateinput(){ 
var e = document.getElementById("cat"); 
var catSelected = e.options[e.selectedIndex].value; 

document.getElementById("copycat").value=catSelected; 
} 
</script> 

<form name="testform">
Category: &nbsp; <select name=cat id=cat onchange="updateinput();" style="width=600"> <br>
<option value='' style="width=600">Select One</option> 
<br>
<? 

  require "config.php";// connection to database  
  $q=mysql_query("select * from categories"); 
  while($n=mysql_fetch_array($q)){ 
    echo "<option value=$n[cat_id]>$n[category]</option>"; 
  } 

?> 
</select> 
 <br><br>
 Pack Code:
<select name=subcat > 
 <br><br>
</select>
<br><br>
<input type=text name=copycat id=copycat >
<br><br>
<td><input type=button value="Select" onClick="sendValue('<?php echo $rows['packcode']; ?>')" /></td>
</form> 
```

我变了：

**把： onchange="updateinput();"**

```
<select name=cat id=cat onchange="updateinput();" style="width=600"> 
```

和

```
<input type=text name=copycat id=copycat > 
```

消除：

```
 onBlur="document.getElementById('cat').value=this.value;" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T20:26:36.090

你应该添加`id="cat"`到：

```
<select name="cat" id="cat" onchange="AjaxFunction(this.value);" style="width=600"> 
```

和：

```
echo "<option value='".$n['cat_id']."'>".$n['category']."</option>"; 
```

演示：http: [//jsfiddle.net/V94AJ/](http://jsfiddle.net/V94AJ/)

# c++ - 为 C++ 库集成 python 脚本控制台

> ID：10790068
> 
> 赞同：2
> 
> 时间：2012-05-28T20:23:27.177
> 
> 标签：c++, qt, boost, binding, console-application

我有一个库，其中包含用 C++ 编写的类和公共方法。

我想从一个用 C++ 和 Qt 编写的交互式程序中，将命令发送到 Python 语言的解析器，然后将它们转换为调用我的库的方法和函数。

类似于 Octave/Matlab 中所做的事情，字符串由解析器处理，然后在内部执行命令。

在我的 C++ 库的某个地方，我有一个函数

```
int myFooCPPfunction(int value)
{
    return value*value;
} 
```

然后在我的程序执行期间，我想启动一个控制台并输入 Python 语法：

```
for i in range(0,20):
    print("%d" % myFooCPPfunction(i)) 
```

例如，我给出的命令会更新程序的内部状态。

我认为这是编写链接到 C++ 的 Python 代码的问题。在我看来，像 boost::python 之类的东西已经做到了……我问你的建议，哪个是编写绑定的更好方法。

第二点：如何将该东西集成到从 Qt 应用程序启动的交互式 shell 中？一些像 QConsole 这样的在线项目应该做类似的事情，但是 QConsole 似乎是一个非常过时的项目。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T06:34:28.103

[PythonQt](http://pythonqt.sourceforge.net/)正是为此目的而创建的。

# c# - 如何在两个并排的墨水画布上绘画

> ID：10790070
> 
> 赞同：0
> 
> 时间：2012-05-28T20:23:41.797
> 
> 标签：c#, .net, wpf

我在 WPF 中有两个 inkCanvas 元素并排显示。我希望能够从一个 inkCanvas 到下一个无缝绘制线条。现在笔画在边界处被剪裁，您必须释放鼠标并在下一个画布上再次按下它才能继续画线。

我还读到inkCanvas 并不是真正的绘画方式。它更适用于签名等简单的事情。你应该用什么代替？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T04:02:47.937

首先尝试使用一个 inkcancas：

*   通过用更大的替换当前的 inkcanvas 并复制笔画来添加图块
*   它可能有效
*   如果不是，您将知道您需要更多

是的，inkcanvas 用于简单的事情，但在您开始编写大量代码之前，请尝试指定您需要的内容。

# apache - 非 www 到 www cname 重定向

> ID：10790071
> 
> 赞同：1
> 
> 时间：2012-05-28T20:23:42.120
> 
> 标签：apache, dns

我正在尝试执行以下操作

*   将非 www 重定向到 www（因此 example.com 到 www.example.com）以限制因浏览器发送图像 cookie 导致的网络流量。

我知道 301 重定向是不可取的。

有没有办法使用 cname dns 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T02:08:04.470

如果您确实有权访问您的 apache VirtualHosts 配置 (http.conf)，则：

```
<VirtualHost *:80>
    ServerName example.com
    Redirect permanent / http://www.example.com/
</VirtualHost> 
```

恕我直言，这是最好的方法。您不能将 CNAME 记录放在顶级域上，因此直接 DNS 不是一个简单的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-27T07:56:55.910

如果要将非 www 重定向到 www，则应使用重定向。301 重定向是“永久的”，因此最好使用它，因为它只需要告诉网络浏览器一次，然后网络浏览器就会直接转到重定向的内容。

# jquery - 处理更改选项卡以调整 div 大小的事件

> ID：10790072
> 
> 赞同：0
> 
> 时间：2012-05-28T20:23:43.723
> 
> 标签：jquery, tabs, focus

我有一个带有多个选项卡的页面，其中设置了具有相应 div 的链接，这些 div 在单击选项卡时显示。我在每个选项卡上都有不同大小的 div，我希望父容器在更改选项卡时随其内容更改大小。我似乎找不到正确的事件来挂钩，焦点没有可靠地触发，当我选择选项卡时会触发模糊（为什么？？？）并且在我选择选项卡时单击触发，在内部 div 之前我可以检查以修改父 div 的宽度。

有没有更好的事件可以使用，或者有更好的方法来完全做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T21:58:45.797

原来我正在寻找的事件是 tabsshow 事件[http://jqueryui.com/demos/tabs/](http://jqueryui.com/demos/tabs/)。这个事件让我在标签加载后更改父 div 的宽度，让我可以访问新孩子的宽度。

# c# - 任何生成表驱动的 LL 解析器的解析器生成器？

> ID：10790074
> 
> 赞同：1
> 
> 时间：2012-05-28T20:24:00.133
> 
> 标签：c#, parsing, antlr

我正在尝试为我们开发的查询语言构建一个随机查询生成器。这个想法是通过遵循解析表中的规则来生成随机查询。到目前为止，我尝试过的所有 LL 解析器生成器都只生成递归下降解析器。我可以尝试修改生成的解析器，但查看 ANTLR 为小型表达式语言生成的解析器，我们的查询语言的解析器将非常大。

所以，我认为表驱动的解析器会更小，更容易调整。是否有任何开源工具可以生成表驱动的 LL 解析器？

或者，可以“反向”使用 LR 解析表来派生随机查询吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:31:04.397

是的，LR 解析器表可用于生成随机查询。您只需像解析一样遍历表，并且在状态表为您提供令牌的转换或缩减的任何地方，您随机提议该令牌，一旦查询的大小“足够大”，则优先选择缩减。令牌序列是您的查询。

但是你不需要 LR 表。您可以以类似的方式遍历您的语法定义（一组 BNF 规则）。您需要首先将所有规则标准化为以下形式：

```
 LHS = RHS1 RHS2 ... RHSn ; 
```

这通过添加新生成的非终结符来表示原始规则中的复杂子短语，从而摆脱了 Kleene 星号和加号以及替代方案。这很简单。

如果你有一个非终结符（最初是目标符号），只需找到与 LHS 匹配的规则，随机选择一个，然后扩展该规则。您必须将您在规则中的位置作为“点”来跟踪（与 LR 解析器生成中的“项目”相同）。给定一个规则和一个点，选择的标记要么是终结符（提出它，别无选择！）或非终结符（使用本段的方法为非终结符递归生成标记序列）。

# php - 下拉搜索菜单列表没有放在应该放在哪里

> ID：10790075
> 
> 赞同：0
> 
> 时间：2012-05-28T20:24:08.163
> 
> 标签：php, javascript, html, css, ajax

我有 4 个相互关联的搜索下拉菜单。我有两个问题：

1.  当我在任何下拉菜单中按下一个键时，mysql-connected 列表会下降，但不在实际的“输入类型搜索框”下方。

2.  此外，例如，当我在第一个菜单中按下一个键时，其他菜单会在下拉列表下方移动，但菜单/“输入类型搜索框”实际上应保持固定在彼此旁边。

这可能只是一个简单的 css 问题，但我现在尝试了很多东西，但我无法让它工作很长一段时间，所以我发布了它。谢谢你的帮助！

这是代码：HTML

```
<input type="text" class="autosuggest" id="autosuggest1" placeholder="Select Continent...">
    <div class="type">
        <ul class="result" id="result1"></ul>
    </div>
<input type="text" class="autosuggest" id="autosuggest2" placeholder="Select Country...">
    <div class="type">
        <ul class="result" id="result2"></ul>
    </div>
<input type="text" class="autosuggest" id="autosuggest3" placeholder="Select Area...">
    <div class="type">
    <ul class="result" id="result3"></ul>
    </div>
<input type="text" class="autosuggest" id="autosuggest4" placeholder="Select Category...">
    <div class="type">
    <ul class="result" id="result4"></ul>
    </div> 
```

CSS

```
 #search_line{
        margin-top: 20px;
        display: inline;
    }
.autosuggest, .type, .result{
    width: 150px;
}
#autosuggest1{
    padding: 4px;
    border: 1px solid blue;
    background: white;
    float: left;
}
#autosuggest2{
    padding: 4px;
    border: 1px solid blue;
    background: white;
    float: left;
}
#autosuggest3{
    padding: 4px;
    border: 1px solid blue;
    background: white;
    float: left;
}
#autosuggest4{
    padding: 4px;
    border: 1px solid blue;
    background: white;
    float: left;
}
.result{
    width: 150px;
    list-style: none;
}
.result li{
    padding:5px;
    border:1px solid #000;
    border-top: 0;
    cursor: pointer;
} 
```

JS

```
$(document).ready(function() { 
$('#autosuggest1').keyup(function() {
    var continent = $(this).attr('value');
    $.post('php/dropdown.php', {continent:continent},  function(data) {
        $('#result1').html(data);

        $('.result li').click(function() {
            var result_value = $(this).text();
            $('#autosuggest1').attr('value', result_value);
            $('#result1').html('');
        });
    });
});

$('#autosuggest2').keyup(function() {
    var country = $(this).attr('value');
    $.post('php/dropdown.php', {country:country}, function(data) {
        $('#result2').html(data);

        $('.result li').click(function() {
            var result_value = $(this).text();
            $('#autosuggest2').attr('value', result_value);
            $('#result2').html('');
        });
    });
});

$('#autosuggest3').keyup(function() {
    var area = $(this).attr('value');
    $.post('php/dropdown.php', {area:area}, function(data) {
        $('#result3').html(data);

        $('.result li').click(function() {
            var result_value = $(this).text();
            $('#autosuggest3').attr('value', result_value);
            $('#result3').html('');
        });
    });
});

$('#autosuggest4').keyup(function() {
    var category = $(this).attr('value');
    $.post('php/dropdown.php', {category:category}, function(data) {
        $('#result4').html(data);

        $('.result li').click(function() {
            var result_value = $(this).text();
            $('#autosuggest4').attr('value', result_value);
            $('#result4').html('');
            $('#result4').focusout('');
        });
    });
});

}); 
```

这里还有 PHP

```
<?php
include '../core/db/connectdropdown.php';

if (isset($_POST['continent']) == true && empty($_POST['continent']) == false) {
$continent = mysql_real_escape_string($_POST['continent']);
$query = mysql_query("SELECT DISTINCT `continent` FROM `area` WHERE `continent` LIKE   '$continent%'");
while (($row = mysql_fetch_assoc($query)) !== false) {
    echo '<li>', $row['continent'], '</li>';
}   
}

if (isset($_POST['country']) == true && empty($_POST['country']) == false) {
$country = mysql_real_escape_string($_POST['country']);
$query = mysql_query("SELECT DISTINCT `country` FROM `area` WHERE `country` LIKE     '$country%'");
while (($row = mysql_fetch_assoc($query)) !== false) {
    $dbcountry = $row['country'];

}   
}

if (isset($_POST['area']) == true && empty($_POST['area']) == false) {
$area = mysql_real_escape_string($_POST['area']);
$query = mysql_query("SELECT DISTINCT `area` FROM `area` WHERE `area` LIKE '$area%'");
while (($row = mysql_fetch_assoc($query)) !== false) {
    echo '<li>', $row['area'], '</li>';
}   
}

if (isset($_POST['category']) == true && empty($_POST['category']) == false) {
$category = mysql_real_escape_string($_POST['category']);
$query = mysql_query("SELECT `category` FROM `categories` WHERE `category` LIKE '$category%'");
while (($row = mysql_fetch_assoc($query)) !== false) {
    echo '<li>', $row['category'], '</li>';
}   
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:23:20.030

听起来您可能也遇到了一些 JavaScript 问题。您的脚本是按 ID 还是按类别附加列表的结果？只是好奇。

我没有看到您发布的 CSS 和 HTML 有任何明显的问题，但我尝试在这个小提琴中稍微更改 HTML 和 CSS 结构。也许它可以为您改善：

[http://jsfiddle.net/w8zG6/](http://jsfiddle.net/w8zG6/)

如果你使用我的 CSS/HTML 会发生什么。你能得到更好的结果吗？（也许更糟？）

如果这没有帮助，您可以发布处理创建菜单的 JavaScript 吗？

**编辑：**

您的 PHP 中似乎存在问题：

在您的其他 Ajax 处理程序代码块中，您有以下内容：

```
echo '<li>', $row['continent'], '</li>'; 
```

而您的国家/地区处理代码有：

```
$dbcountry = $row['country']; 
```

尝试用以下内容替换该行：

```
echo '<li>', $row['country'], '</li>'; 
```

# javascript - 为什么这个变量没有被初始化？

> ID：10790077
> 
> 赞同：-1
> 
> 时间：2012-05-28T20:24:27.730
> 
> 标签：javascript

在`<head>`我的页面中，我这样做：

```
<script type="text/javascript" src="js/foo.js"></script>
<script type="text/javascript">
  console.log(foo.bar);
</script> 
```

代码`foo.js`：

```
var foo = function()
{
    this.bar = function()
    {
        console.log('here');
    }
} 
```

稍后在 html 文档中：

```
<a href="#" onclick="foo.bar();">Test</a> 
```

但是，如果我点击上面的那个链接，它会说即使 foo.js 已经包含了函数也没有定义。另外，如果我这样做`console.log(foo)`，它只会显示'function（）'并`console.log(foo.bar)`显示未定义。这是为什么，为什么我无法访问该功能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T20:26:47.450

因为你还没有创建一个对象。这是运行代码的正确方法：

```
var foo = function()
{
    this.bar = function()
    {
        console.log('here');
    }
}

var instance = new foo();
instance.bar(); 
```

[http://jsfiddle.net/zerkms/wDaEn/](http://jsfiddle.net/zerkms/wDaEn/)

或者，您可以用另一种方式定义它：

```
var foo = {
    bar: function() {
        console.log('here');
    }
};

foo.bar();​ 
```

[http://jsfiddle.net/zerkms/wDaEn/1/](http://jsfiddle.net/zerkms/wDaEn/1/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-28T20:27:03.683

由于您正在使用`this`和创建*实例类成员*，因此您需要先***实例化***该类：

```
var fooClass = new foo;
console.log(fooClass.bar()); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-28T20:30:23.663

我不确定你是否想要这样，但为了让你`console.log(foo.bar);`工作，你可以这样做：

```
var foo = {
    bar: function() {
        console.log('here');
    }
}; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-28T20:36:52.350

对于最小的代码更改，请使用以下内容：

```
<script type="text/javascript">
    var foo = function()
    {
        this.bar = function()
        {
           console.log('here');
        };
        return this; // magic yes ?
    };

foo().bar();
</script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-28T20:28:21.477

的内容`foo.js`只是将 foo 初始化为一个函数......实现中的内容在`foo()`被调用之前并不重要。所以 foo.bar 是未定义的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-28T20:34:34.327

上面的答案并不都是正确的，请记住 javascript 没有类或所述类的实例的概念。我会阅读 Javascript 范围和闭包。

当您将对象分配给变量名 bar 时，您将其分配给本地范围。然后，您尝试从全局上下文访问您的本地函数。这是错误的。

我敢打赌您正在尝试以下方法：-

```
var foo = {
      bar: function() {

      }
} 
```

ETC...

# objective-c - 可达性类在 iOS 中不起作用

> ID：10790081
> 
> 赞同：3
> 
> 时间：2012-05-28T20:24:52.503
> 
> 标签：objective-c, ios, reachability

我已经实现了可达性 API 2.2。当网络从关闭状态变为开启状态时，它不会触发。

另外，我可以在应用程序委托中实现它吗？如果是这样，我应该在哪里删除观察者？

这是我的代码（不调用解除模型viewController）

```
- (void)viewDidLoad
{
    // check for internet connection
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(checkNetworkStatus:) name:kReachabilityChangedNotification object:nil];

     internetReachable = [[Reachability reachabilityForInternetConnection] retain] ;
    [internetReachable startNotifier];
    // check if a pathway to a random host exists
    hostReachable = [[Reachability reachabilityWithHostName: @"www.google.com"] retain];
    [hostReachable startNotifier];
 }

- (void) checkNetworkStatus:(NSNotification *)notice
{
    // called after network status changes

    NetworkStatus hoststatus=[hostReachable currentReachabilityStatus];

    NetworkStatus internetStatus=[internetReachable currentReachabilityStatus];

    for (NSString *msg  in messageArray) {
        [stringg appendString:[NSString stringWithFormat:@"%@",msg]]; 
    }

    if  (hoststatus==NotReachable||internetStatus==NotReachable) {
        [self.navigationController presentModalViewController:inter animated:YES];
    }
    else{
        [self dismissModalViewControllerAnimated:YES];
    }

    [inter release];
} 

- (void)viewDidUnload
{

    [[NSNotificationCenter defaultCenter] removeObserver:self];
    [super viewDidUnload];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:27:08.550

您在哪里注册通知？

你需要这样的东西：

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(reachabilityChange:)
                                             name:kReachabilityChangedNotification
                                           object:nil]; 
```

我使用作为参数传递的可达性对象，如下所示：

```
- (void) reachabilityChange: (NSNotification*) notification
{
    Reachability* curReach = [notification object];
    NSParameterAssert([curReach isKindOfClass: [Reachability class]]);
    BOOL isServerCurrentlyReachable = (NotReachable != [curReach currentReachabilityStatus]);
    BOOL wasServerPreviouslyReachable = self.isServerReachable;
    self.isServerReachable = isServerCurrentlyReachable;

    if (NO == wasServerPreviouslyReachable && YES == isServerCurrentlyReachable)
    {
        // Moving from non reachable to reachable state

    }
    else if (YES == wasServerPreviouslyReachable && NO == isServerCurrentlyReachable)
    {
        // Moving from a reachable to a non reachable state

    }
} 
```

你似乎没有使用它。

此外，通知可能会以相同的状态被多次调用，因此您需要确保考虑到这一点，就像在代码段中所做的那样。

如果您在应用程序委托中使用它，则停止/删除 applicationDidResignActive 中的内容似乎是合适的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T08:57:29.650

将开发者 Apple 中的 Reachability.h 和 Reachability.m 文件包含到您的项目中。将 SDK 库中的 SystemConfiguration 框架导入到您的项目中。然后将以下 GlobalFunction.h 和 GlobalFunction.m 文件添加到您的项目中

```
//GlobalFunction.h

#import <Foundation/Foundation.h>

@class Reachability;

@interface GlobalFunction  :  NSObject
{
Boolean internetActive;
Boolean hostActive;

Reachability * internetReachable;
Reachability * hostReachable;
Reachability * wifiReach;

}

@property (readwrite,assign) Boolean internetActive;
@property (readwrite,assign) Boolean hostActive;

 - (Boolean) checkNetworkStatus;
 - (BOOL)connectedToNetwork;
 @end

 //GlobalFunction.m

 #import "GlobalFunction.h"
 #import "Reachability.h"
 #include <netinet/in.h>
 #import <SystemConfiguration/SCNetworkReachability.h>

 @implementation GlobalFunction

  @synthesize  internetActive,hostActive;
  - (id)init
   {
 self = [super init];
  if (self) {
 // Initialization code here.
     }

 return self;
 }

 //  Checking Internet Connectivity
 - (Boolean) checkNetworkStatus//:(NSNotification *)notice
  {
 // called after network status changes
  internetReachable = [[Reachability reachabilityForInternetConnection] retain];
    [internetReachable startNotifier];

   // check if a pathway to a random host exists
  hostReachable = [[Reachability reachabilityWithHostName: @"www.apple.com"] retain];
     [hostReachable startNotifier];

   NetworkStatus internetStatus = [internetReachable currentReachabilityStatus];
  switch (internetStatus)
 {
case NotReachable:
{
    //NSLog(@"The internet is down.");
    //[self ShowMsg:@"The internet connection appears to be offline."];
    self.internetActive = NO;
    break;

}
case ReachableViaWiFi:
{
    //NSLog(@"The internet is working via WIFI.");
    self.internetActive = YES;

    break;

}
case ReachableViaWWAN:
{
    //NSLog(@"The internet is working via WWAN.");
    self.internetActive = YES;

    break;

}
default :
    self.internetActive = YES;
    break;

 }

 NetworkStatus hostStatus = [hostReachable currentReachabilityStatus];
 switch (hostStatus)

  {
 case NotReachable:
 {
    //NSLog(@"A gateway to the host server is down.");
    self.hostActive = NO;

    break;

}
case ReachableViaWiFi:
{
    //NSLog(@"A gateway to the host server is working via WIFI.");
    self.hostActive = YES;

    break;

}
case ReachableViaWWAN:
{
    //NSLog(@"A gateway to the host server is working via WWAN.");
    self.hostActive = YES;

    break;

  }
 }

  [hostReachable release];
  [internetReachable release];

 return self.internetActive;
  }

  - (BOOL)connectedToNetwork
 {
  // Create zero addy
  struct sockaddr_in zeroAddress;
 bzero(&zeroAddress, sizeof(zeroAddress));
 zeroAddress.sin_len = sizeof(zeroAddress);
 zeroAddress.sin_family = AF_INET;
// Recover reachability flags 
    SCNetworkReachabilityRef defaultRouteReachability =                                                                           SCNetworkReachabilityCreateWithAddress(NULL, (struct sockaddr*)&zeroAddress);
SCNetworkReachabilityFlags flags;
BOOL didRetrieveFlags = SCNetworkReachabilityGetFlags(defaultRouteReachability, &flags);
CFRelease(defaultRouteReachability);
    if (!didRetrieveFlags)
    {
//NSLog(@"Error. Could not recover network reachability flags");
return 0;
    }
    BOOL isReachable = flags & kSCNetworkFlagsReachable;
    BOOL needsConnection = flags & kSCNetworkFlagsConnectionRequired;
    //below suggested by Ariel
    BOOL nonWiFi = flags & kSCNetworkReachabilityFlagsTransientConnection;
    NSURL *testURL = [NSURL URLWithString:@"http://www.apple.com/"];
   //comment by friendlydeveloper: maybe use www.google.com
  NSURLRequest *testRequest = [NSURLRequest requestWithURL:testURL             cachePolicy:NSURLRequestReloadIgnoringLocalCacheData timeoutInterval:20.0];
  //NSURLConnection *testConnection = [[NSURLConnection alloc]     initWithRequest:testRequest delegate:nil]; //suggested by Ariel
   NSURLConnection *testConnection = [[[NSURLConnection alloc] initWithRequest:testRequest delegate:nil] autorelease];
 //modified by friendlydeveloper
   return ((isReachable && !needsConnection) || nonWiFi) ? (testConnection ? YES : NO) : NO;

  }

-(void)dealloc 
{
internetReachable=nil;
hostReachable=nil;
 wifiReach=nil;

[super dealloc];
}

@end

  ------>Just write the code for checking internet connection
 #import<GlobalFunction.m>

-(void)viewDidLoad
   {
   if([globalFunc checkNetworkStatus])
 {
[self ShowAlert:@"Internet Connection appears"];
  }
 else
 {
[self ShowAlert:@"The Internet connection appears to be offline.."];
 }
 } 
```

# jsf - ui:repeat 和 p:poll

> ID：10790084
> 
> 赞同：0
> 
> 时间：2012-05-28T20:24:58.580
> 
> 标签：jsf, primefaces

我有一个 ui:repeat。我希望它每 5 秒刷新一次。我试过 p:poll 但它不起作用。有什么办法可以使这个工作吗？

```
<ui:repeat value="#{videoImpl.fGetAllComments()}" var="v" id="commentlist">
<div class="comment-entry"><h:outputText value="#{v.comment}"/></div>
</ui:repeat>

<p:poll update="commentlist" interval="5" /> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T17:52:30.523

`<ui:repeat>`本身不会生成任何 HTML 。因此 HTML 输出中没有元素，`id="commentlist"`因此后面的 JS 代码`<p:poll>`找不到任何要更新的内容。

将它包装在另一个 JSF 组件中，该组件呈现一个完整的 HTML 元素，例如`<h:panelGroup>`, 并更新它。

```
<h:panelGroup id="commentlist">
    <ui:repeat value="#{videoImpl.fGetAllComments()}" var="v">
        <div class="comment-entry">#{v.comment}</div>
    </ui:repeat>
</h:panelGroup>

<p:poll update="commentlist" interval="5" /> 
```

# c# - 我怎样才能让我的物理对象安定下来？

> ID：10790085
> 
> 赞同：9
> 
> 时间：2012-05-28T20:25:01.343
> 
> 标签：c#, bullet, bulletphysics, rigid-bodies

我正在使用 BulletSharp，子弹库的 C# 发行版。我一直在一个据说恢复为 0.0f 的对象中出现一些弹跳。

我有一个动态圆柱体（即将成为网格）落在两个静态圆​​柱体上。像这样：

![起始物体位置](../Images/0c5aa26348b98808886cf3318236978e.png)

顶部的圆柱体经常剧烈地弹跳，通常弹到一边。

这是我用来设置场景的代码：

```
 //now figure out bulletsharp stuff...
        CollisionConfiguration collConfig = new DefaultCollisionConfiguration();
        Dispatcher collDispatch = new CollisionDispatcher(collConfig);

        BroadphaseInterface broadphase = new DbvtBroadphase();
        ConstraintSolver sol = new SequentialImpulseConstraintSolver();
        world = new DiscreteDynamicsWorld(collDispatch, broadphase, sol, collConfig);

        world.Gravity = new Vector3(0.0f, -10.0f, 0.0f);

        //log (moving object)
        MotionState still = new DefaultMotionState();
        CylinderShape shape = new CylinderShapeZ(0.5f, 1.0f, 1.0f);
        still.WorldTransform = Matrix.Translation(0.0f, 0.4f, 0.0f);
        RigidBodyConstructionInfo constructInfo = new RigidBodyConstructionInfo(1.0f, still, shape);
        logBody = new RigidBody(constructInfo);
        logBody.SetDamping(0.04f, 0.1f);
        world.AddRigidBody(logBody);

        //rollers (static objects)
        CylinderShape r1s = new CylinderShapeZ(0.1f, 1.0f, 1.0f);
        MotionState r1m = new DefaultMotionState();
        r1m.WorldTransform = Matrix.Translation(-0.2f, -0.4f, 0.0f);
        RigidBodyConstructionInfo r1ci = new RigidBodyConstructionInfo(0.0f, r1m, r1s);
        r1 = new RigidBody(r1ci);
        world.AddRigidBody(r1);

        CylinderShape r2s = new CylinderShapeZ(0.1f, 1.0f, 1.0f);
        MotionState r2m = new DefaultMotionState();
        r2m.WorldTransform = Matrix.Translation(0.2f, -0.4f, 0.0f);
        RigidBodyConstructionInfo r2ci = new RigidBodyConstructionInfo(0.0f, r2m, r2s);
        r2 = new RigidBody(r2ci);
        world.AddRigidBody(r2); 
```

以及我`world.StepSimulation(0.05f, 100, 0.0005f);`用来更新物理模拟的每一帧。

我是否缺少任何明显的设置？为什么我的模拟会这样做？

小更新：我已经成功地在 Blender 的 Bullet 中进行了类似的模拟。那里没有弹跳……我不知道那和这之间可能有什么区别。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T03:04:07.433

您没有在模型中添加惯性。这应该会减慢抖动，并且不会产生最终从滚轮反弹的混响。您需要为所有三个对象添加它，包括滚轮上的零。试试这个，让我知道它是如何工作的：

```
//now figure out bulletsharp stuff...
CollisionConfiguration collConfig = new DefaultCollisionConfiguration();
Dispatcher collDispatch = new CollisionDispatcher(collConfig);

BroadphaseInterface broadphase = new DbvtBroadphase();
ConstraintSolver sol = new SequentialImpulseConstraintSolver();
world = new DiscreteDynamicsWorld(collDispatch, broadphase, sol, collConfig);

world.Gravity = new Vector3(0.0f, -10.0f, 0.0f);

//log (moving object)
Vector3 cylinderInertia;
MotionState still = new DefaultMotionState();
CylinderShape shape = new CylinderShapeZ(0.5f, 1.0f, 1.0f);
still.WorldTransform = Matrix.Translation(0.0f, 0.4f, 0.0f);
shape.CalculateLocalInertia(1.0f, out cylinderInertia);    
RigidBodyConstructionInfo constructInfo = new RigidBodyConstructionInfo(1.0f, still, shape, cylinderInertia);
logBody = new RigidBody(constructInfo);
logBody.SetDamping(0.04f, 0.1f);
world.AddRigidBody(logBody);

//rollers (static objects)
CylinderShape r1s = new CylinderShapeZ(0.1f, 1.0f, 1.0f);
MotionState r1m = new DefaultMotionState();
r1m.WorldTransform = Matrix.Translation(-0.2f, -0.4f, 0.0f);
RigidBodyConstructionInfo r1ci = new RigidBodyConstructionInfo(0.0f, r1m, r1s, Vector3.Zero);
r1 = new RigidBody(r1ci);
world.AddRigidBody(r1);

CylinderShape r2s = new CylinderShapeZ(0.1f, 1.0f, 1.0f);
MotionState r2m = new DefaultMotionState();
r2m.WorldTransform = Matrix.Translation(0.2f, -0.4f, 0.0f);
RigidBodyConstructionInfo r2ci = new RigidBodyConstructionInfo(0.0f, r2m, r2s, Vector3.Zero);
r2 = new RigidBody(r2ci);
world.AddRigidBody(r2); 
```

# api - GitHub v3 API - 如何在存储库中创建初始提交？

> ID：10790088
> 
> 赞同：10
> 
> 时间：2012-05-28T20:25:21.620
> 
> 标签：api, github, repository, github-api

我正在使用 v3 API 并设法列出 repos/trees/branches、访问文件内容并创建 blobs/trees/commits。我现在正在尝试创建一个新的存储库，并设法使用“POST user/repos”来做到这一点

但是当我尝试在这个新的 repo 中创建 blobs/trees/commits/references 时，我会收到相同的错误消息。(409) “Git 存储库为空。”。显然，我可以通过 git 命令行自己去初始化存储库，但我宁愿我的应用程序为我做这件事。

有没有办法做到这一点？创建空存储库后，我需要通过 API 做的第一件事是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T08:46:44.867

根据GitHub 博客上发布的[这篇博](http://developer.github.com/changes/2012-9-28-auto-init-for-repositories/)文，自 2012 年以来，现在可以在创建后自动初始化存储库：

> 今天，我们让通过 GitHub API 向存储库添加提交变得更加容易。到目前为止，您可以创建一个存储库，但在通过 API 添加任何提交之前，您需要通过 Git 客户端在本地初始化它。
> 
> 现在，您可以通过为 auto_init 参数发送 true 来选择在创建存储库时对其进行初始化：
> 
> ```
> curl -i -u pengwynn \
>      -d '{"name": "create-repo-test", "auto_init": true}' \
>      https://api.github.com/user/repos 
> ```
> 
> 生成的存储库将有一个 README 存​​根和一个初始提交。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T20:15:30.570

2013 年 5 月更新：请注意，[存储库内容 API](http://developer.github.com/v3/repos/contents/)现在授权[添加文件](http://developer.github.com/v3/repos/contents/#create-a-file)。

请参阅“ [API 中现在提供的文件 CRUD 和存储库统计信息](https://github.com/blog/1498-file-crud-and-repository-statistics-now-available-in-the-api)”。

* * *

原始答案（2012 年 5 月）

由于它似乎还不被支持（“ [GitHub v3 API：如何为我闪亮的新存储库创建初始提交？](https://stackoverflow.com/questions/9670604/github-v3-api-how-to-create-initial-commit-for-my-shiny-new-repository) ”，如[aclark](https://stackoverflow.com/users/185820/aclark)评论），您可以从推送**初始*空*提交开始**

```
git commit --allow-empty -m 'Initial commit'
git push origin master 
```

无论如何，这可能是[初始化一个存储库的好习惯。](http://kevin.deldycke.com/2010/05/initialize-git-repositories/)
并在《[git的半秘密空树](https://stackoverflow.com/questions/9765453/gits-semi-secret-empty-tree/9766506#9766506)》中有说明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-25T20:50:15.773

如果您想创建一个**空**的初始提交（即没有任何文件的提交），您可以执行以下操作：

1.  `auto_init`使用Jai Pandya 的答案中的选项创建存储库；*或者*，如果存储库已经存在，则使用[create file 端点](https://developer.github.com/v3/repos/contents/#create-a-file)创建一个虚拟文件 - 这将创建分支：

```
把 https://api.github.com/repos/USER/REPO/contents/dummy

{
  “分支”：“主”，
  "message": "创建一个虚拟文件以创建分支",
  “内容”：“ZHVtbXk=”
}

```

这将为您提供一堆数据，包括提交 SHA，但您可以丢弃所有数据，因为我们即将删除该提交。

2.  使用[create commit 端点](https://developer.github.com/v3/git/commits/#create-a-commit)创建指向[空树](https://stackoverflow.com/questions/9765453/is-gits-semi-secret-empty-tree-object-reliable-and-why-is-there-not-a-symbolic)的提交：

```
发布 https://api.github.com/repos/USER/REPO/git/commits

{
  "message": "初始提交",
  “树”：“4b825dc642cb6eb9a060e54bf8d69288fbee4904”
}

```

这次你需要注意返回的提交 SHA。

3.  使用[更新参考端点](https://developer.github.com/v3/git/refs/#update-a-reference)使分支指向您刚刚创建的提交（注意 Use Of The Force ^(TM)）：

```
补丁 https://api.github.com/repos/USER/REPO/git/refs/heads/master

{
    "sha": "<提交的 SHA>",
    “力”：真
}

```

4.  完毕！您的存储库现在有一个分支、一个提交和零个文件。

# javascript - HTML5 音频事件未在 Chrome 上触发

> ID：10790091
> 
> 赞同：4
> 
> 时间：2012-05-28T20:25:38.747
> 
> 标签：javascript, html, google-chrome, dom-events, html5-audio

我试图在我的游戏中有一个加载进度条，并且我有一个分配给`onloadeddata`我的音频属性的函数，但它没有在 Chrome 中触发。它适用于其他浏览器。我还尝试了许多其他事件，例如`oncanplay`, `oncanplaythrough`,`onloadedmetadata`等。它们都不会触发。

我认为这可能与缓存有关。试着环顾四周，2-3 年前有一些关于此的报道，但最近没有。

有没有其他方法可以检测音频是否已加载或使这些事件起作用？

编辑：这是一个简单的例子：http: [//jsfiddle.net/3vxCu/1/](http://jsfiddle.net/3vxCu/1/) 适用于 Opera 和 Firefox，但不适用于 Chrome。如果完成加载，它应该在发出声音时发出警报。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T23:04:59.697

似乎该`onloadeddata`属性由于某种原因不起作用。`addEventListener`但通过（或通过 jQuery）附加事件处理程序有效：http: [//jsfiddle.net/3vxCu/4/](http://jsfiddle.net/3vxCu/4/)

```
bgSound = new Audio();
bgSound.src = "http://www.ehsankia.com/hawkthorne/audio/level.ogg";
bgSound.preload = "auto";
// Standard browsers (not IE before version 9):
// bgSound.addEventListener("loadeddata", testFunction, false);

// jQuery:
$(bgSound).on("loadeddata", testFunction);

function testFunction () {
    alert("Data loaded");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T23:00:51.397

如果附加的 jsfiddle 是您实现代码的方式，那么我想我知道出了什么问题。

您的 jsfiddle 显示：

```
bgSound = document.createElement('audio');
bgSound.src = "http://www.ehsankia.com/hawkthorne/audio/level.ogg";
bgSound.onloadeddata = testFunction;

function testFunction(){
    alert("Data loaded");
} 
```

它应该是这样的：

```
bgSound = document.createElement('audio');
bgSound.onloadeddata = testFunction; // Event listener is attached _before_ loading the resource
bgSound.src = "http://www.ehsankia.com/hawkthorne/audio/level.ogg";

function testFunction(){
    alert("Data loaded");
} 
```

基本上，您在指定之后附加事件侦听*器*`src`。指定源应该是您做的最后一件事，因为它会启动一切。当 Chrome 附加到您的代码中时，它可能已经超过了为该事件调用侦听器的时间。

# google-app-engine - 全文搜索和 LIKE 语句

> ID：10790093
> 
> 赞同：2
> 
> 时间：2012-05-28T20:25:54.183
> 
> 标签：google-app-engine, full-text-search, sql-like

GAE 实验性全文搜索 API 是否提供 SQL“LIKE 语句”的替代方案？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T00:28:49.757

不。SQL`like`语句支持任意子字符串匹配——例如，“abbatton”将匹配“bat”——而全文搜索实现[了全文索引](http://en.wikipedia.org/wiki/Full_text_search)，它使用规范化、词干和倒排索引来构造一个好的索引在回答用户倾向于为文本文档输入的查询时。

如果您的意思是“全文搜索 API 是否为 SQL 的 LIKE 运算符通常（误用）的用途提供了替代方案”，答案是肯定的 - 因为 SQL 的 LIKE 最常见的应用程序似乎是全文搜索，全文搜索API 实际上比 LIKE 更适合这一点，原因有很多，包括效率（“LIKE”需要扫描表格的每一行）、准确性（全文搜索提供排名、词干和其他功能）以及消除误报（见上面的例子）。

# wordpress - 如何添加wordpress插件更新可用代码

> ID：10790094
> 
> 赞同：0
> 
> 时间：2012-05-28T20:25:55.203
> 
> 标签：wordpress, plugins

我已经在谷歌上搜索了一段时间，但可以在任何地方或一个很好的资源中找到解释如何向插件添加功能的方法，当插件准备好更新时，您会看到这些功能。

有人可以解释如何将此功能添加到 wp 插件，以便在更新插件时获得以下信息

> 有一个新版本的用户访问管理器可用。查看版本 1.2.2 详细信息或自动更新。

？？？有人可以指出我正确的方向吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:32:11.900

该行是内置的 wordpress 代码。要启用它，您必须使用[wordpress 代码插件存储库](http://wordpress.org/extend/plugins/about/)。

# ruby-on-rails - Rails 3 使用特定路由在控制器中找到正确的 :id

> ID：10790095
> 
> 赞同：1
> 
> 时间：2012-05-28T20:26:22.600
> 
> 标签：ruby-on-rails, ruby-on-rails-3, controller, routes, nested-attributes

我安排了我的路线，以便在访问该站点时`:id`显示在蛞蝓之前

```
match "/causes/:id/:slug" => "causes#show", :as => :cause, :via => 'get' 
```

但我也有一个名为“post”的嵌套属性，它属于这样的原因

```
match "/causes/:id/:slug/posts" => "causes#posts", :via => 'get', :as => :posts 
```

当我使用它时，一切都适用于原因，但不适用于帖子。

如果我使用

```
@post = Post.find(params[:id]) 
```

在原因或帖子控制器中，它总是查找原因的 ID，而不是帖子的 :id。所以如果帖子`:id`是 9，原因`:id`是 1，我使用

```
@post = Post.find(params[:id]) 
```

它总是会寻找`post[1]`而不是 9 或任何帖子 id 的真正含义。

我究竟做错了什么？有没有办法让它在路由中工作，或者可能有不同的方法来找到控制器中嵌套对象的 id？

我需要路线是我设置的方式，`:id/:slug...`

耙路线信息：

```
 cause GET        /causes/:id/:slug(.:format)            causes#show
            edit_cause GET        /causes/:id/:slug/edit(.:format)       causes#edit
                       PUT        /causes/:id/:slug(.:format)            causes#update
                 posts GET        /causes/:id/:slug/posts(.:format)      causes#posts
                       POST       /causes/:id/:slug/posts(.:format)           
                       PUT        /causes/:id/:slug/posts(.:format)  causes#update_post
                       DELETE     /causes/:id/:slug/posts(.:format)  causes#destroy_post
                causes GET        /causes(.:format)                      causes#index
                       POST       /causes(.:format)                      causes#create 
```

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:58:25.297

这是因为您正在使用原因的 id，如果您正在这样做，您`/causes/:id/posts`不应该这样做`@posts = @cause.posts`吗？

如果我是你，我会研究 Rails 3 的新路由器语法，因为有更好的方法来嵌套资源[http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)

* * *

编辑：使用friendly_id gem并嵌套你的资源，以避免混淆遵循REST最佳实践，有问题的资源在最后，所以

```
/causes/:slug/posts/:slug 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T21:01:04.853

为了解决您眼前的问题，您需要添加类似这样的内容`routes.rb`

```
# config/routes.rb
match "/causes/:cause_id/:slug/post/:id" => "causes#update_post", :via => 'put', :as => :update_post 
```

然后你可以像这样在你的视图中生成 URL...

```
link_to 'Update this post', update_post_path(@cause, @post) 
```

`params[:id]`...并以（对于帖子）和`params[:cause_id]`（对于原因）访问控制器中的参数。

不过，更一般地说，您指定路线的方式非常麻烦，而且我怀疑您正在使您的生活变得比需要的更难。如果这是我，我会做类似的事情

```
# config/routes.rb
resources :causes do
  resources :posts
end 
```

这将完成与您现在所拥有的非常接近的事情，主要区别在于它不包含蛞蝓。我不确定为什么您需要同时拥有 slug 和 ID，也许您可​​以通过它们的 slug 来确定您的原因？ [Stringex](https://github.com/rsl/stringex)是一个很好的生成 slug 的 gem，你可以设置它以保证 slug 是唯一的。

这是 Rails 指南中关于嵌套资源的部分 [http://guides.rubyonrails.org/routing.html#nested-resources](http://guides.rubyonrails.org/routing.html#nested-resources)

这是一个关于使用嵌套资源的 slug 的 Railscast [http://railscasts.com/episodes/314-pretty-urls-with-friendlyid?view=comments](http://railscasts.com/episodes/314-pretty-urls-with-friendlyid?view=comments)

希望这可以帮助。

# ruby-on-rails - 如何从 products.images 添加 Spree 电子邮件附件（图像）？

> ID：10790106
> 
> 赞同：1
> 
> 时间：2012-05-28T20:27:11.250
> 
> 标签：ruby-on-rails, paperclip, html-email, spree

## 我想将图片附加到来自产品[Spreecommerce](https://github.com/spree/spree/blob/master/core/app/views/spree/order_mailer/confirm_email.text.erb)的电子邮件中。但是下面的代码不起作用。

../app/views/order_mailer/confirm_email.html.erb

```
<% for item in @order.line_items %>

# I'm not sure this product.image containts images. And it doesn't work =(
<%= image_tag image.attachment.url(:product), :itemprop => "image" %>

<%=item.variant.sku %> <%=item.variant.product.name%>
<%= variant_options(item.variant) %>(<%=item.quantity%>) @ <%= number_to_currency item.price %>
<%= number_to_currency(item.price * item.quantity) %>
<% end %>
<%= number_to_currency @order.total %> 
```

**[看下图](http://ib3.keep4u.ru/b/2012/05/29/7f/7ff731b88c4f31b58401bf366cfdafd7.jpg)就更明白了。**

您能否提出将 image.products 添加到确认电子邮件的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T02:52:13.907

您需要执行以下操作：

```
<%= image_tag "#{root_url}#{image.attachment.url(:product)}", :itemprop => "image" %> 
```

您得到的是相对图像路径，而不是绝对 url。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T12:55:50.370

./app/views/order_mailer/confirm_email.html.erb

```
<%= link_to image_tag('http://mysite.com' + item.variant.images.first.attachment.url(:small)), item.variant.product %> 
```

在项目块中添加此行，您将在确认电子邮件中获得图像。

# javascript - 使用 javascript 自动刷新 div

> ID：10790110
> 
> 赞同：2
> 
> 时间：2012-05-28T20:27:34.940
> 
> 标签：javascript, reload

我一直在寻找最简单的方法来刷新页面上的特定 div，每隔 x 秒自动刷新一次。

到目前为止，我有：

```
<script type="text/javascript">
window.onload = startInterval;
function startInterval()
{
    setInterval("startTime();",1000);
}

function startTime()
{
    document.getElementById('time').innerHTML = Date();
} 
```

然而，innerHTML 设置为日期函数的最后一部分是我希望用“时间”ID 的内容代替，而不是实际的日期打印。

我知道我可以加载 iframe 或 externa html 页面，但我想简单地调用页面上的现有 div 而不必更改现有内容。那可能吗？

谢谢！

编辑：我的意思是我在页面上有一个看起来像这样的 div：

一些东西

我希望该 div 每 x 秒刷新一次，所以是的，您可以忽略我示例中的 Date() 部分，我只是按原样找到了该代码，但是当我尝试删除 .innerHTML 部分时，它什么也没做，我想想哈哈！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:32:44.537

你在寻找这样的东西吗？

```
<script type="text/javascript">
window.onload = startInterval;
function startInterval() {
    setInterval("startTime();",1000);
}

function startTime() {
    var now = new Date();
    document.getElementById('time').innerHTML = now.getHours() + ":" + now.getMinutes() + ":" +now.getSeconds();
}
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:39:00.150

**注意：** OP 实际上是想在页面上已经包含的广告服务中重新加载脚本。以下内容对此无济于事；但是，由于提出问题的方式，我将留下这个答案，因为我认为它可以帮助其他人寻找以下类型的解决方案。请注意，这并没有演示如何“重新运行”已经包含的（可能是全局的和非函数式的）代码。

* * *

假设我有以下`div`要动态刷新的内容：

```
<div id="refresh">Refreshes...</div> 
```

jQuery 提供了一[`$.ajax`组函数](http://api.jquery.com/category/ajax/)，允许您动态请求页面并将响应用作 HTML。例如：

```
$(document).ready(function(){
    var $refresh = $('#refresh'),
        loaded = 1,
        data = {
            html: $.toJSON({
                text: 'some text',
                object: {}
            }),
            delay: 3
        };

    var refresh = function(){
        $.ajax({
            url: "/echo/html/",
            data: data,
            type: "GET",
            success: function(response) {
                $refresh.html($refresh.html() + '<br/>#' + loaded);
                loaded++;
                setTimeout(refresh, 3000);
            }
        });
    };

    refresh();
}); 
```

[http://jsfiddle.net/Ah3jS/](http://jsfiddle.net/Ah3jS/)

注意，我在[`echo/html/`](http://doc.jsfiddle.net/use/echo.html)这里也使用了 jsFiddle 的功能。出于演示目的，该`data`变量已调整为与此一起使用。实际上，`data`与请求一起发送的要么是`GET`你`POST`正常使用的变量，要么是变量。另外，我*不*使用`response`in `success`，但那是因为它在 jsFiddle 的演示模式下不返回任何内容。

jQuery 使这些东西变得非常容易。真的，我会考虑使用它而不是大多数其他方法（尽管有要求）。

# python - 最新稳定的 Debian 上的 Python OpenCV 中没有 cv.Point

> ID：10790116
> 
> 赞同：12
> 
> 时间：2012-05-28T20:28:25.873
> 
> 标签：python, opencv, debian

当尝试使用 cv.Circle 在图像上绘制圆时，我意识到 Python OpenCV 中没有 cv.Point 函数来创建 cvPoint。我正在使用 Debian 的最新稳定版本，并使用 Synaptic 安装了所有 Python OpenCV 包。如何创建一个与 cv.Circle 函数一起使用的 cvPoint？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-28T20:52:48.153

使用元组。这是实心绿色圆圈的示例：

```
cv2.circle(img, (x1, y1), 3, (0, 255, 0), -1) 
```

# ruby-on-rails - 迁移模型未显示在我的架构中之后

> ID：10790117
> 
> 赞同：0
> 
> 时间：2012-05-28T20:29:06.887
> 
> 标签：ruby-on-rails, postgresql, migration

我现在已经尝试解决这个问题几次，但没有运气。

我最近将我的应用程序从 Sqlite3 切换到 Postgress，但现在在 Rails 中生成模型时遇到问题。奇怪的是，当我运行 Rake db:migrate 时，我的终端窗口显示表已成功创建。虽然当我查看我的架构文件时，几乎创建的模型没有出现。该模型的属性无法通过 Rails 控制台访问，这似乎让我知道该模型尚不存在于数据库中。

我的假设是错的，还是你们认为这里还有其他事情发生？我已经用谷歌搜索了这个问题，但似乎找不到任何关于这个问题的相关帖子，所以欢迎任何帮助或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T10:29:20.613

这些表可能是在您的搜索路径之外创建的。

尝试`\dn`列出命名空间，然后

```
\d myschema.* 
```

列出我的架构中的所有表结构。你也可以

```
SET search_path = 'myschema';
\d
RESET search_path; 
```

# php - 我可以用 php curl 执行以下操作吗

> ID：10790119
> 
> 赞同：-2
> 
> 时间：2012-05-28T20:29:25.230
> 
> 标签：php, curl

我想弄清楚 php 的 curl 函数是否有资格进入受密码保护的页面，当然还有给定的凭据，并 curl 指定的页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T20:34:14.547

当然，请参阅此示例代码：

```
<?php

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "http://www.example.com/path/to/form");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POST, true);

$data = array(
    'login' => 'foobar',
    'passwd' => 'xxxxxxxxx'
);

curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
$output = curl_exec($ch);
$info = curl_getinfo($ch);
curl_close($ch); 
```

（来自[http://www.electrictoolbox.com/php-curl-form-post/](http://www.electrictoolbox.com/php-curl-form-post/)）

应编辑字段名称以满足您的需要，请参阅输出

```
mech-dump --forms http://YOUR_domain.tld 
```

（`mech-dump`根据需要安装）

# java - 弹簧单例被调用两次

> ID：10790120
> 
> 赞同：10
> 
> 时间：2012-05-28T20:29:30.060
> 
> 标签：java, spring, singleton, postconstruct

在我的 Spring 应用程序中遇到一些问题。

我有非常简单的春豆，它们被注入到其他各种春豆中。在调试时我发现它们被调用了两次，Constructor 和@PostConstruct 都被调用了两次。

我的应用程序没有前端技术。它只是与后端任务相关。

**弹簧配置**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:lang="http://www.springframework.org/schema/lang" xmlns:p="http://www.springframework.org/schema/p"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang.xsd">

    <context:component-scan base-package="com.green.integration" />

    <!-- ######################################################## -->
    <!-- EXPOSING SPRING BEAN VIA HTTPINVOKER SPRING REMOTING -->
    <!-- ######################################################## -->

    <bean name="/switch"
        class="org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter">
        <property name="service" ref="SwitchController" />
        <property name="serviceInterface"
            value="com.green.ISwitchController" />
    </bean>

    <!-- Load in application properties reference -->
    <bean id="applicationProperties"
        class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="classpath:application.properties" />
    </bean>

    <bean id="mongo" class="com.mongodb.Mongo">
        <constructor-arg value="${mongo.server}" />
        <constructor-arg value="${mongo.port}" />
    </bean>

    <bean id="morphia" class="com.google.code.morphia.Morphia">
    </bean>

</beans> 
```

**Spring Bean 类**

```
@Repository
public class TransactionDAO extends BasicDAO<Transaction, ObjectId>  {
    private Datastore datastore;

    @Autowired
    public TransactionDAO(Mongo mongo, Morphia morphia) {
        super(mongo, morphia, "itransact");
        morphia.map(Transaction.class);
        // TO USE MONGO WITHOUT SECURITY
        this.datastore = morphia.createDatastore(mongo, "itransact");
        logger.debug("***** CONNECTED TO MONGODB SUCCESSFULLY *****");
        this.datastore.ensureIndexes();
        // this.datastore.ensureCaps();
    }
} 
```

构造函数“TransactionDAO”被调用了两次。

我试图通过以下方式观看调用堆栈跟踪

```
Throwable t = new Throwable();
System.out.println(t.getStackTrace()[1].toString()); 
```

并且每次显示以下内容

```
sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-29T08:56:51.123

我刚刚发现了这个问题，特别感谢@Juan Alberto，他给了我这个问题的提示。

描述：实际上，我为 contextListner 和调度程序 servlet 提供了一个 applicationContext.xml 文件。因此，第一个 bean 正在为 spring 核心初始化，第二次为 spring 调度程序初始化。

我现在将配置溢出到 applicationContext.xml 和 applicationContext-dispatcher.xml 中，它们只有它们的相关配置，并且我的 bean 正在正确初始化一次。

**有问题的配置**

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/applicationContext.xml</param-value>
</context-param>

<servlet>
    <servlet-name>remoting</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/applicationContext.xml</param-value>
    </init-param>
    <load-on-startup>0</load-on-startup>
</servlet> 
```

已解决的配置

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/applicationContext.xml</param-value>
</context-param>

<servlet>
    <servlet-name>remoting</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/applicationContext-dispatcher.xml</param-value>
    </init-param>
    <load-on-startup>0</load-on-startup>
</servlet> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T14:02:04.347

实际上，您的问题是您可能正在调度程序 servlet 以及您的 spring 上下文中定义 bean，调度程序提供了不同的上下文，但它（我认为是子上下文）是主上下文，所以正确的做事方式是让您的主上下文扫描您的“模型类”，调度程序只扫描控制器。

我希望这可以帮助你。

# java - java中文件的状态

> ID：10790121
> 
> 赞同：4
> 
> 时间：2012-05-28T20:29:30.907
> 
> 标签：java, io

如何知道文件的状态，即应用程序是否被阻止并且它正在阻止。在 java 中，如果有用于此的 API，或者您可以使用 Java IO。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T20:31:56.133

如果您询问文件锁，[Example Depot](http://www.exampledepot.com/egs/java.nio/SetFileLock.html)中的以下示例显示了如何使用它：

```
try {
    // Get a file channel for the file
    File file = new File("filename");
    FileChannel channel = new RandomAccessFile(file, "rw").getChannel();

    // Use the file channel to create a lock on the file.
    // This method blocks until it can retrieve the lock.
    FileLock lock = channel.lock();

    // Try acquiring the lock without blocking. This method returns
    // null or throws an exception if the file is already locked.
    try {
        lock = channel.tryLock();
    } catch (OverlappingFileLockException e) {
        // File is already locked in this thread or virtual machine
    }

    // Release the lock
    lock.release();

    // Close the file
    channel.close();
} catch (Exception e) {
} 
```

# javascript - 在 forEach 中使用条件语句时，如何检测是否每个孩子都不符合条件？

> ID：10790124
> 
> 赞同：3
> 
> 时间：2012-05-28T20:29:52.813
> 
> 标签：javascript, foreach, conditional, firebase

从 Firebase [DataSnapshot](http://www.firebase.com/docs/datasnapshot.html)开始，我想要一些东西，用简单的英语，“如果所有孩子都未能满足条件，则执行一些东西”。

这是我现在拥有的：

```
 appleappsRef.on('value', function (allApplesSnapshot){
            allApplesSnapshot.forEach(function (appleSnapshot) {
                if (condition) {
                   //execute code
                } 
            });             
      }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T00:16:50.490

根据[文档](http://www.firebase.com/docs/datasnapshot/foreach.html)，您的 forEach 回调可以返回 true 以取消枚举，而 forEach() 将返回 true 以表示枚举已取消。

这意味着您可以执行以下操作：

```
appleappsRef.on('value', function (allApplesSnapshot){
  var foundOne = allApplesSnapshot.forEach(function (appleSnapshot) {
    if (condition) {
       return true; // found one, cancel enumeration
    }
  });
  if (!foundOne) {
    // all children failed the condition.
  }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T20:32:15.887

```
if (allApplesSnapshot.every(function (appleSnapshot) { return !condition; }))
    // ... 
```

[`Array.every`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/every)如果数组的每个元素都满足您传递给它的函数，则返回`true`（也就是说，当传递该元素时，函数返回 true）。因此，要测试每个元素是否*不*符合条件，只需在函数中否定条件即可。

请注意，有些浏览器不[支持](http://kangax.github.com/es5-compat-table/) `Array.every`，但每个支持的浏览器也`Array.forEach`应该支持`Array.every`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-28T20:57:06.360

如果您发现条件为真，您可以使用 .forEach 使用布尔值来跟踪：

```
 appleappsRef.on('value', function (allApplesSnapshot){
        var foundOne = false;
        allApplesSnapshot.forEach(function (appleSnapshot) {
            if (condition) {
               foundOne = true;
            } 
        });             
        if (!foundOne) {
            // all children failed the condition
        }
  }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T20:33:13.443

好吧，您总是可以循环遍历它，并且在任何时候其中一个孩子通过时都会以某种方式退出该方法，否则会触发所有孩子都失败时应该触发的方法。在这种情况下，您甚至可以使用布尔值。

例如：创建一个布尔值并将其命名为 allChildrenFailed，并默认将其设置为 true。通过 foreach 循环，如果有任何子通过，则将其更改为 false。仅当 allChildrenFailed 为真时，才在循环后触发您需要的方法。

# android - 如何为android获得正确的宽度和高度？

> ID：10790125
> 
> 赞同：1
> 
> 时间：2012-05-28T20:30:06.037
> 
> 标签：android, opengl-es, screen

阅读以下内容后：

[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

[如何将 ppi 转换为 Android 图像的 dpi？](https://stackoverflow.com/questions/6930031/how-do-i-convert-ppi-into-dpi-for-android-images)

我假设“dp = px / (dpi / 160)”。我在 LDPI 屏幕上测试了它，它运行良好，我的第一个想法是“终于，一个突破！”，但后来在 HDPI 屏幕上测试后发现它并没有那么好用。所以然后我尝试了“dp = px * (dpi / 160)”并发现它不起作用，并不是我认为它会......我尝试了其他几个公式，但没有一个起作用。其中之一是只在小屏幕上使用 dp，然后只为其他屏幕获取屏幕 px。那没有用。

显然，在阅读了如何支持多个屏幕之后，我想使用 DP 来获得正确的宽度和高度。我不太清楚为什么这会失败，所以我为什么转向你。

这是我的代码：

```
public class Scale {

    ScreenType type;
    Display display;

    public Scale(WindowManager wm) {
        this.display = wm.getDefaultDisplay();

        // Get Display Type //
        DisplayMetrics metrics = new DisplayMetrics();
        wm.getDefaultDisplay().getMetrics(metrics);
        int density = metrics.densityDpi;
        switch(density) {
            case DisplayMetrics.DENSITY_LOW:
                this.type = ScreenType.LDPI;
                break;
            case DisplayMetrics.DENSITY_MEDIUM:
                this.type = ScreenType.MDPI;
                break;
            case DisplayMetrics.DENSITY_HIGH:
                this.type = ScreenType.HDPI;
                break;
            default:
                this.type = ScreenType.XHDPI;
                System.exit(0);
                break;
        }
    }

    public ScreenType getScreenType() {
        return this.type;
    }

    public int getWidth() {
        return this.display.getWidth();
    }

    public int getHeight() {
        return this.display.getHeight();
    }

    public int getDPWidth() {
        float dp = this.getWidth() / (this.getScreenType().getDensity() / 160f);
        return (int) dp;
    }

    public int getDPHeight() {
        float dp = this.getHeight() / (this.getScreenType().getDensity() / 160f);
        return (int) dp;
    }

} 
```

ScreenType 枚举如下：

```
public enum ScreenType {
    LDPI(120), MDPI(160), HDPI(240), XHDPI(320);

    private final int density;
    ScreenType(int density) {
        this.density = density;
    }

    public int getDensity() {
        return this.density;
    }
} 
```

我知道我不需要 ScreenType 枚举，但目前不谈论这个。只需要弄清楚为什么屏幕总是尺寸错误。

现在，当我去绘制背景时，我会执行以下操作...

```
batcher.beginBatch(Assets.loadingAtlas);
for(int x = 0; x <= this.scale.getDPWidth(); x += 50) {
    for(int y = 0; y <= this.scale.getDPHeight(); y += 50) {
        batcher.drawSprite(x, y, 50, 50, Assets.backgroundPattern);
    }
}
batcher.endBatch(); 
```

然后它转到具有以下代码的批处理器...

```
public void beginBatch(Texture texture) {
    texture.bind();
    numSprites = 0;
    bufferIndex = 0;
}

public void drawSprite(float x, float y, float width, float height, TextureRegion region) {
    float halfWidth = width / 2;
    float halfHeight = height / 2;
    float x1 = x - halfWidth;
    float y1 = y - halfHeight;
    float x2 = x + halfWidth;
    float y2 = y + halfHeight;

    verticesBuffer[bufferIndex++] = x1;
    verticesBuffer[bufferIndex++] = y1;
    verticesBuffer[bufferIndex++] = region.u1;
    verticesBuffer[bufferIndex++] = region.v2;

    verticesBuffer[bufferIndex++] = x2;
    verticesBuffer[bufferIndex++] = y1;
    verticesBuffer[bufferIndex++] = region.u2;
    verticesBuffer[bufferIndex++] = region.v2;

    verticesBuffer[bufferIndex++] = x2;
    verticesBuffer[bufferIndex++] = y2;
    verticesBuffer[bufferIndex++] = region.u2;
    verticesBuffer[bufferIndex++] = region.v1;

    verticesBuffer[bufferIndex++] = x1;
    verticesBuffer[bufferIndex++] = y2;
    verticesBuffer[bufferIndex++] = region.u1;
    verticesBuffer[bufferIndex++] = region.v1;

    numSprites++;
}

public void endBatch() {
    vertices.setVertices(verticesBuffer, 0, bufferIndex);
    vertices.bind();
    vertices.draw(GL10.GL_TRIANGLES, 0, numSprites * 6);
    vertices.unbind();
} 
```

然后，当您绘制顶点时，将使用以下代码...

```
public void draw(int primitiveType, int offset, int numVertices) {        
    GL10 gl = glGraphics.getGL();

    if(indices!=null) {
        indices.position(offset);
        gl.glDrawElements(primitiveType, numVertices, GL10.GL_UNSIGNED_SHORT, indices);
    } else {
        gl.glDrawArrays(primitiveType, offset, numVertices);
    }        
} 
```

**现在我最大的两个问题是**：第一，我是否使用正确的公式来计算我应该在哪里绘制以及我应该绘制多少次背景？二，当我绘制元素以将 dp 放回像素时，我应该有一个公式吗？

当我失败时会发生以下情况：

![背景_HDPI_SCREEN.png](../Images/e077f92400a7b0b66d914907d3e02d96.png)

**黄色标记可以有黑色，蓝色 X 标记不能有黑色。蓝色应该比现在延伸得更远。**

我从数学上理解为什么会发生这种情况，但感觉可能有一个更好的公式适用于 LDPI 和 HDPI 屏幕，而不仅仅是 LDPI。这个公式还使它在 MDPI 上稍微小了一点。

数学是与密度无关的像素 (DP) = WIDTH / (DENSITY / 160)。所以一个例子是 DP = 800/(240/160) = 800/1.5 = 533

所以你的想法是什么？

提前感谢您的任何意见！如果你想要一个 SSCCE，请告诉我，但这个实例需要一些时间，我希望我们不需要这样做。

# android - onActivityResult 参数的意图是什么

> ID：10790129
> 
> 赞同：14
> 
> 时间：2012-05-28T20:30:16.010
> 
> 标签：android, android-intent, android-activity

这是我`first activity`调用的代码`second Activity`：

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
  if (keyCode == KeyEvent.KEYCODE_DPAD_LEFT){       
    startActivityForResult(new Intent("chap.two.Chapter2Activity2"),request_Code);          
  }    
  return false;
}

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
  if (requestCode == request_Code) {
    if (resultCode == RESULT_OK) 
      Toast.makeText(this,data.getData().toString(),Toast.LENGTH_SHORT).show();             
  }
} 
```

这是一个代码`chap.two.Chapter2Activity2`：

```
Button n = (Button) findViewById(R.id.btn_OK);
n.setOnClickListener(new View.OnClickListener() {               
   @Override
   public void onClick(View v) {
     // TODO Auto-generated method stub

     Intent data = new Intent();
     //---get the EditText view---
     EditText txt_username =(EditText) findViewById(R.id.txt_username);
     //---set the data to pass back---
     data.setData(Uri.parse(txt_username.getText().toString()));
     setResult(RESULT_OK, data);
     //---closes the activity---
     finish();

   }
}); 
```

在这里，我看到它`setResult(RESULT_OK, data)`有两个参数，但
`onActivityResult(int requestCode, int resultCode, Intent data)`有三个，我想知道如何`onActivityResult`获取第三个参数的值？它是如何工作的，谁能告诉我？为什么不是这个错误？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-28T20:36:50.273

当你调用 Activity.startActivityForResult() 时，你设置了`requestCode`. 稍后，需要此请求代码`onActivityResult()`以确定哪个 Activity 正在向其发送数据。我们不需要`requestCode`再次供应，`setResult()`因为它`requestCode`是随身携带的。

`data`从已启动的意图返回的[意图数据](http://developer.android.com/reference/android/app/Activity.html#setResult%28int,%20android.content.Intent%29)。我们通常在设置`extras`被调用意图时使用此数据。

考虑这个例子：

**呼叫第二个活动**

```
Intent i = new Intent(MainActivity.this, CheckActivity.class);
startActivityForResult(i, REQUEST_CODE_CHECK); 
```

**在第二次活动中，设定意图结果**

```
getIntent().putExtra("TADA", "bla bla bla");
setResult(RESULT_OK, getIntent());
finish(); 
```

**回到第一个活动，ONACTIVITYRESULT()**

```
if(requestCode == REQUEST_CODE_CHECK && resultCode == RESULT_OK){
    text1.setText(data.getExtras().getString("TADA") );
} 
```

你去吧。您现在应该了解什么是`Intent data`以及如何设置和获取值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-10T13:39:31.107

第三个参数是 Intent，它是您从子 Activity 发送的（第二个 Activity，即将完成）。

如果你想在子活动中执行一些计算或获取一些用户名/密码，并且你想将结果发送到主活动，那么你将数据放在意图中并在完成（）之前返回到主活动。

之后，您将在主活动中检查 onActivityResult(int, int, Intent) 以获取带有 Intent 参数的结果。

示例:: MainActivity:

```
public void onClick(View view) {
  Intent i = new Intent(this, subActivity.class);
  startActivityForResult(i, REQUEST_CODE);
} 

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
  if (resultCode == RESULT_OK && requestCode == REQUEST_CODE) {
    if (data.hasExtra("username") && data.hasExtra("password")) {
      String username =  data.getExtras().getString("username");
      String password =  data.getExtras().getString("password");

    }
  } 
```

子活动::

```
@Override
public void finish() {
  // Create one data intent 
  Intent data = new Intent();
  data.putExtra("username", "Bla bla bla..");
  data.putExtra("password", "*****");
  setResult(RESULT_OK, data);
  super.finish();
} 
```

# php - CodeIgniter + jQuery Ajax 运行成功但调用错误回调

> ID：10790130
> 
> 赞同：0
> 
> 时间：2012-05-28T20:30:18.193
> 
> 标签：php, ajax, codeigniter, jquery

我有一个非常简单的 CodeIgniter 项目，它可以完成一些简单的数据库工作。目前我有一个控制器方法可以删除数据库中的一个项目。在我看来，代码使用 jQuery ajax 对象来引用该控制器，然后通过其回调显示成功或失败。

问题是，尽管控制器工作正常（按预期删除数据库中的项目），但调用的是 ajax“错误”回调，而不是“成功”。

我确定我在这里遗漏了一些超级基本的东西......

这是我的控制器方法：

```
public function delete_note()
{
    $this->load->helper('url');
    $this->load->model('auth/user', 'User');
    $this->load->database();

    $note_id = $this->input->post('id');

    $this->db->delete('admin_notes', array('id' => $note_id));
    $this->db->query();

    $this->output->set_status_header('200'); // Attempting to force the issue
} 
```

这是视图中的代码：

```
$('.delete_note').each(function(){
    var current = this;

    this.onclick = function(event)
    {
        var note_id = this.title;

        $.ajax({
            type: "POST",
            url: "/admin/delete_note",
            data: { id: note_id },

            success: function(data) { alert('I never see this!');},
            error: function () { alert('I *always* see this!');}
        });
    }
}); 
```

任何答案尝试表示赞赏。任何正确的答案都会受到双重赞赏；）

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:41:20.300

仅仅因为数据库逻辑正在工作，您可能会收到与其他问题相关的问题（也许是跨浏览器？）。要查看错误，请将您的错误函数更改为如下所示：

```
error: function (jqXHR, textStatus, errorThrown) {
   alert(textStatus);
   alert(errorThrown);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:43:09.150

我要感谢 WojtekT 提醒我检查我在 Firebug 中的回复。我实际上收到了 PHP 错误的 500 状态代码。我无关的 $this->db->query(); 调用需要被删除。

现在一切都很好。

谢谢！

# java - Apache POI HSSF XLS 读取错误

> ID：10790136
> 
> 赞同：3
> 
> 时间：2012-05-28T20:31:48.090
> 
> 标签：java, excel, apache-poi

在读取 .xls 文件时使用以下代码，其中 s 是文件目录：

```
InputStream input = new FileInputStream(s);
Workbook wbs = new HSSFWorkbook(input); 
```

我收到以下错误消息：

```
Exception in thread "main" java.io.IOException: Invalid header signature; read 0x0010000000060809, expected 0xE11AB1A1E011CFD0 
```

我需要一个能够读取 XLSX 或 XLS 的程序，并且使用刚刚针对 XSSF 调整的完全相同的代码，它在 XLSX 文件中的读取完全没有问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T15:00:00.543

如果文件是 xlsx 格式而不是 xls，您可能会收到此错误。我会尝试使用通用 Workbook 对象（也称为 SS Usermodel）

查看[Workbook 接口](http://poi.apache.org/apidocs/org/apache/poi/ss/usermodel/Workbook.html)和[WorkbookFactory 对象](http://poi.apache.org/apidocs/org/apache/poi/ss/usermodel/WorkbookFactory.html)。工厂应该能够使用 xlsx 或 xls 为您创建通用工作簿。

我以为我有一个很好的教程，但我似乎找不到它。不过我会继续寻找。

**编辑**

我从 Apache 的网站上找到了这个关于使用 SS 用户模型进行读取和重写的[小片段。](http://poi.apache.org/spreadsheet/quick-guide.html#ReadWriteWorkbook)

我希望这有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T06:32:30.480

> 无效的标头签名；读取 0x342E312D46445025，预期 0xE11AB1A1E011CFD0

好吧，当我上传损坏的 xls/xlsx 文件时出现此错误（为了上传损坏的文件，我将 sample.pdf 重命名为 sample.xls）。添加验证，如：

```
Workbook wbs = null;
try {
    InputStream input = new FileInputStream(s);
    wbs = new HSSFWorkbook(input);
} catch(IOException e) {
    // log "file is corrupted", show error message to user
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T15:10:47.230

你得到的异常是告诉你你提供的文件不是一个有效的 Excel 二进制文件，至少不是一个自 1990 年左右产生的有效 Excel 文件。你得到的异常告诉你 POI 期望什么，并且它发现了其他不是有效`.xls`文件的东西，也不是 POI 可以检测到的其他任何东西。

需要注意的一件事是 Excel 可以打开多种不同的文件格式，包括 .csv 和 .html。它对文件扩展名也不是很挑剔，所以会很高兴地打开一个已重命名为 .xls 的 CSV 文件。但是，由于将 .csv 重命名为 .xls 并不会神奇地改变格式，因此 POI 仍然无法打开它！

.

从异常中，我可以知道发生了什么，我也可以告诉您使用的是旧版本的 Apache POI！标题签名`0x0010000000060809`对应于大约 25 年前的 Excel 4 文件格式！如果您使用较新版本的 Apache POI，它会给您一个有用的错误消息，告诉您提供的文件是旧的并且很大程度上不受支持的 Excel 文件。POI 的新版本确实包括[OldExcelExtractor 工具](https://poi.apache.org/apidocs/org/apache/poi/hssf/extractor/OldExcelExtractor.html)，它可以从那些古老的格式中提取一些信息。

否则，与此类型的所有例外情况一样，请尝试在 Excel 中打开文件并另存为。这将使您了解文件当前是什么（例如，保存为 .xls 的 .html、保存为 .xls 的 .csv 等），还可以让您将其重新保存为适当的 .xls 文件以供 POI 加载和一起工作。

# html - 带边框的液体假柱

> ID：10790137
> 
> 赞同：1
> 
> 时间：2012-05-28T20:31:51.930
> 
> 标签：html, css

我正在设计一个 2 列的 HTML5 界面（向后兼容性并不重要，所有用户都将使用最新的 Chrome/FF），左侧是侧边栏，右侧是主要内容区域。

我希望侧边栏具有背景颜色和右边框（类似于 OS X Finder 侧边栏）。我希望该背景和边框扩展到页面底部，即使页面内容不足以将页面扩展到该大小。我还希望将侧边栏设置为百分比，而不是设置的像素数量。

通常，在这种情况下，我会使用人造柱，甚至是液体人造柱。但是我想在列的右侧有一个边框，我不确定这是否/如何可能。

理想情况下，我完全可以在没有图像/人造列的情况下完成所有这些工作。是否有允许这样做的 CSS3/HTML5 功能（正如我所说，向后兼容性不是问题）？如果没有，除了将侧边栏设置为固定大小之外，还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:04:40.647

I think this demonstrates what you're looking for. If you have any questions about how this example works, don't hesitate to ask! :)

[http://www.thechoppr.com/2009/02/09/2-column-fluid-layout-100-height-with-leftright-sidebar](http://www.thechoppr.com/2009/02/09/2-column-fluid-layout-100-height-with-leftright-sidebar)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-28T20:46:48.813

嗯……那个？

```
<style type="text/css">
  #left
  { height:100%;
    width:25%;
    min-width: 100px;
    float:left;
    background-color:red;
    border-right:solid 3px orange;
  }
</style>
<div id="left">menu</div>
<div id="right">contents</div> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-28T21:16:19.943

你可以使用一些 jQuery：

```
var sidebar_height = 0;
var content_height = 0;

sidebar_height = $("#sidebar").height();
content_height = $("#content").height();
if(sidebar_height > content_height){
    $("#content").css("height", sidebar_height);
} else {
    $("#sidebar").css("height", content_height);
} 
```

# android - Android 设备在 adb 中无法识别

> ID：10790139
> 
> 赞同：2
> 
> 时间：2012-05-28T20:31:58.747
> 
> 标签：android, ubuntu, adb, samsung-mobile

我的 android 三星 Galaxy Tab 7 出现了很大的问题。

每当我尝试将它连接到我的计算机时，而不是在我的 adb 设备中正常显示，设备的名称是：????? 它的状态是在线或设备。

我真的不知道是什么问题，任何帮助将不胜感激。如果您需要更多信息，我很乐意提供。

Ubuntu : 11.04

设备：三星 Galaxy Tab 7"

安卓版本：3.2 蜂巢

我还在 /etc/udev/rules.d/51-android.rules 中添加了规则

非常感谢你！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-13T21:18:05.890

您的 USB 设备供应商 ID 可能有问题。

尝试 Android 文档 ( [http://developer.android.com/tools/device.html](http://developer.android.com/tools/device.html) ) 中提供的不同设备 ID。许多设备都可以使用 Google (18d1) 进行识别。所有其他的事情都很简单。只需创建一个文件：

```
sudo gedit /etc/udev/rules.d/51-android.rules 
```

并添加：

```
SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", MODE="0666", GROUP="plugdev" 
```

然后运行：

```
sudo chmod a+r /etc/udev/rules.d/51-android.rules 
```

然后将您的设备插入 PC 并关闭 USB 调试，连接后，打开 USB 调试并转到：

```
cd <sdk_path>/platform-tools 
```

并运行：

```
./adb devices 
```

您将看到一个带有一些代码的设备，不包括模拟器（如果正在运行）。就是这样！现在您可以在真实设备中测试您的应用程序。运行时，如果模拟器也在运行，SDK 将提供您选择设备。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T13:54:05.580

当这种情况发生在我身上时，我必须重新启动 adb，如下所示：

$ adb kill-server $ sudo /path_to_android_sdks/android-sdks/platform-tools/adb devices

我有一个简短的脚本，每当我得到“？？？？？？” 设备出现。每次都为我工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-11T09:23:39.673

Ghazi 的回应很有用，但我必须在我的 Ubuntu 12.04 上以不同的方式进行。我不得不将 GROUP 更改为 OWNER="your username on ubuntu" 然后它就起作用了。

# php - 某些用户的签名请求为空

> ID：10790142
> 
> 赞同：1
> 
> 时间：2012-05-28T20:32:15.557
> 
> 标签：php, facebook, facebook-php-sdk

我的 Facebook Tab 应用程序有一个奇怪的问题。

我想知道是否有用户喜欢我的页面。

当我启动我的应用程序时，没有问题，我得到了`signed_request`填满。

但是我的一些用户`signed_request`空了，我不知道为什么。

我使用 Facebook PHP SDK 来解码我的`signed_request`.

```
require_once('sdk/src/facebook.php');

$facebook = new Facebook(array(
  'appId'  => 'appId',
  'secret' => 'appSecret',
  'cookie' => true,
));

$signed_request = $facebook->getSignedRequest(); 
```

我的应用程序没有任何用户限制，我的页面标签 URL 上也没有重定向。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T06:24:41.093

您可以使用 307 而不是 301 将请求从 http 重定向到 https。这也将保持发布数据在下一个请求中持续存在。

仅供参考：[307](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.8)

# visual-studio-2010 - 如何在 Visual Studio 的多项目解决方案中将平台更正为 AnyCPU？

> ID：10790144
> 
> 赞同：2
> 
> 时间：2012-05-28T20:32:27.387
> 
> 标签：visual-studio-2010

我有一个解决方案，其中一个项目设置为 AnyCPU。然后我添加了一个控制台应用程序作为第二个项目，它的默认平台似乎是 x86。现在它（ - 控制台应用程序）正在构建为 x86，我无法更改它。

“解决方案平台”始终显示“AnyCPU”。但是当我显示控制台应用程序的属性时 -> 构建。它显示 x86 没有任何改变它的方法。那么我该如何*改变*呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T20:35:46.983

转到**构建 -> 配置管理器**

*   为整体解决方案选择 Active Platform = AnyCPU
*   转到控制台应用程序行并将平台设置为 AnyCPU
*   如果没有声音创建一个新的配置
*   检查控制台应用程序是否标记为编译。

另请查看有关控制台应用程序默认为 x86的[讨论](http://connect.microsoft.com/VisualStudio/feedback/details/455103/new-c-console-application-targets-x86-by-default)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T20:53:53.760

这是 VS 用户界面设计中的一个不幸缺陷。解决方案的平台名称与托管项目无关，它仅对本机 C++ 项目有意义。其中“AnyCPU”没有任何意义，因为本机代码无法在任何 cpu 上运行。这在 VS2010 中稍微好一点，新的默认平台名称为“x86”。只是一点点。

唯一*真正*重要的设置是 EXE 项目的平台目标设置。项目 + 属性，C# 项目的编译选项卡。类库项目设置也不相关，因为它是确定进程位数的 EXE。

最好的办法就是忽略它。您可以使用工具 + 自定义使其更加永久，只需将组合框拖出工具栏，这样您就不必再次查看它。

# google-maps-api-3 - 从侧边栏的元素单击时显示标记

> ID：10790145
> 
> 赞同：0
> 
> 时间：2012-05-28T20:32:30.573
> 
> 标签：google-maps-api-3

在这个 v3 地图（未完成）中：http: [//pp.gestion.webconcepteur.com/webconcepteur/styles/villerimouski/carte/carteTestClear.htm](http://pp.gestion.webconcepteur.com/webconcepteur/styles/villerimouski/carte/carteTestClear.htm)，我希望能够只显示我从类别中选择的标记右侧边栏（选择框）。喜欢这个 V2 版本： http: [//www.ville.rimouski.qc.ca/styles/carte/carte.jsp](http://www.ville.rimouski.qc.ca/styles/carte/carte.jsp)。

提前谢谢！

# dynamics-crm - 在 Dynamics CRM 2011 中对运费/运费金额收取税费

> ID：10790152
> 
> 赞同：3
> 
> 时间：2012-05-28T20:34:07.087
> 
> 标签：dynamics-crm, dynamics-crm-2011, microsoft-dynamics

有没有办法在 Dynamics CRM 2011 中使用 Orders 实体对运输/运费收取销售税？

默认情况下，CRM 仅对金额征税，并将运费视为免税，但是许多地区（例如加拿大）要求对运费/金额征税。

或者，是否可以从当前更改总税计算（CRM 管理字段）：

> 总税额 =（明细金额）* *TaxRate*

至：

> 总税额 = (明细金额 +*运费金额*) * *TaxRate*

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T02:43:05.287

使用自定义 javascript 添加一个名为“总税（包括运费）”的自定义字段以执行计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T13:49:23.947

我们最终决定绕过内置的运费金额计算，将运费创建为单独的行项目。不是理想的解决方案，但至少它使我们能够完全控制运费税。

# java - 超出范围数组并且找不到行扫描仪：1516 错误

> ID：10790156
> 
> 赞同：0
> 
> 时间：2012-05-28T20:34:19.277
> 
> 标签：java, arrays, while-loop

我知道什么是越界错误，并且我研究了 1516 错误。但是当我尝试修复我的代码时，我都会得到一个错误。我认为这与我的 while 循环无限运行有关，但我无法调试它。

确切的错误

```
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: 11
    at Invest.makeCfPanel(Invest.java:131)
    at Invest.main(Invest.java:25)

Exception in thread "main" java.util.NoSuchElementException: No line found
    at java.util.Scanner.nextLine(Scanner.java:1516)
    at Invest.makeCfPanel(Invest.java:131)
    at Invest.main(Invest.java:25) 
```

这是我的 txt PASTEBUCKET.COM/2303

我的代码是

```
import java.util.*;
import java.io.*;
import java.awt.*;
import javax.swing.*;
import java.awt.event.KeyEvent;

public class Invest extends JFrame {

public static void main(String[] args) throws Exception{
    JFrame frame = new JFrame();
    Dimension minSize = new Dimension(1000,500);
    frame.setMinimumSize(minSize);
    frame.setTitle("Financial Calculator | Financial Statment Driven Ratios");

    JTabbedPane tabbedPane = new JTabbedPane();
    //Income Statement Panel
    JComponent panel1 = makeIsPanel();
    tabbedPane.addTab("Income Statement", panel1);
    tabbedPane.setMnemonicAt(0, KeyEvent.VK_1);
    //Balance Sheet Panel   
    JComponent panel2 = makeBsPanel();
    tabbedPane.addTab("Balance Sheet", panel2);
    tabbedPane.setMnemonicAt(1, KeyEvent.VK_2);
    //Cash Flows Panel  
    JComponent panel3 = makeCfPanel();
    tabbedPane.addTab("Cash Flows ", panel3);
    tabbedPane.setMnemonicAt(2, KeyEvent.VK_3);

    //////////////////////////////////////////////////////////////////////

    frame.add(tabbedPane);

    JPanel bottompanel = new JPanel(new FlowLayout());
    bottompanel.setBackground(new Color(150, 150, 150));
    frame.add(bottompanel, BorderLayout.SOUTH);

    JButton compute = new JButton("Compute Ratios");
    bottompanel.add(compute);

    frame.pack();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setLocationRelativeTo(null);
    frame.setVisible(true);
}

protected static JComponent makeIsPanel() {
      String[] columnNames = {"Entry", "Year", "Year", "Year", "Year"};

    Object[][] data = {{"Period Ending:", "2011", "Snowboarding", Integer.valueOf(5), false},
        {"Values in Millions of $", "12-31", "Rowing", Integer.valueOf(3), true},
        {"Revenue:", "46,542", "Knitting", Integer.valueOf(2), false},
        {"Revenue Other:", "-", "Speed reading", Integer.valueOf(20), true},
        {"Total Revenue:", "46,542", "Speed reading", Integer.valueOf(20), true},
        {"Cost of Revenue:", "18,216", "Speed reading", Integer.valueOf(20), true},
        {"Gross Profit:", "28,326", "Speed reading", Integer.valueOf(20), true},
        {"Selling Gen. Admin Expenses:", "12,111", "Speed reading", Integer.valueOf(20), true},
        {"Research & Development:", "-", "Speed reading", Integer.valueOf(20), true},
        {"Depreciation/Amortization:", "-", "Speed reading", Integer.valueOf(20), true},
        {"Total Operating Expense:", "154", "Speed reading", Integer.valueOf(20), true},
        {"Operating Income:", "35,810", "Speed reading", Integer.valueOf(20), true},
        {"Interest Income (Exp.), Net NonOp:", "10,732", "Speed reading", Integer.valueOf(20), true},
        {"Interest/Invest Inc. Non-Operating:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Interest Inc. Net Non-Operating:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Gain/Loss on Sale of Assets:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Other, Net:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Net Income Before Taxes:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Income Tax - Total:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Minority Interest:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Equity In Affiliates:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Accounting Change:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Discontinued Operations:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Extraordinary Items:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Net Income:", "Brown", "Pool", Integer.valueOf(10), false}};
    JPanel isPanel = new JPanel();
    JTable isTable = new JTable(data, columnNames);
    JScrollPane scrollPane = new JScrollPane(isTable);
    isPanel.add(scrollPane, BorderLayout.CENTER);

    return isPanel;
}

    protected static JComponent makeBsPanel() {
    String[] columnNames = {"Entry", "Year", "Year", "Year", "Year"};
Object[][] data = {{"Period Ending:", "2011", "Snowboarding", Integer.valueOf(5), false},
        {"Values in Millions of $", "12-31", "Rowing", Integer.valueOf(3), true},
        {"Cash:", "46,542", "Knitting", Integer.valueOf(2), false},
        {"Cash and Cash Equivalents:", "-", "Speed reading", Integer.valueOf(20), true},
        {"Short Term Investments:", "46,542", "Speed reading", Integer.valueOf(20), true},
        {"Cash and Short Term Investments:", "18,216", "Speed reading", Integer.valueOf(20), true},
        {"Accounts Recievable- Trade, Net:", "28,326", "Speed reading", Integer.valueOf(20), true},
        {"Total Receivables, Net:", "12,111", "Speed reading", Integer.valueOf(20), true},
        {"Total Inventory:", "-", "Speed reading", Integer.valueOf(20), true},
        {"Prepaid Expenses:", "-", "Speed reading", Integer.valueOf(20), true},
        {"Other Current Assets, Total:", "154", "Speed reading", Integer.valueOf(20), true},
        {"Total Current Assets:", "35,810", "Speed reading", Integer.valueOf(20), true},
        {"Propert/Plant/Equipment - Gross:", "10,732", "Speed reading", Integer.valueOf(20), true},
        {"Accumulated Depreciation,Total:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Property/Plant/Equipment - Net:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Gain/Loss on Sale of Assets:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Other, Net:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Net Income Before Taxes:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Income Tax - Total:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Minority Interest:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Equity In Affiliates:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Accounting Change:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Discontinued Operations:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Extraordinary Items:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Net Income:", "Brown", "Pool", Integer.valueOf(10), false}};

    JPanel bsPanel = new JPanel();
    JTable bsTable = new JTable(data, columnNames);
    JScrollPane scrollPane = new JScrollPane(bsTable);
    bsPanel.add(scrollPane, BorderLayout.CENTER);

    return bsPanel;
}
    protected static JComponent makeCfPanel() throws IOException {
    String[] columnNames = {"Entry","Year","Year", "Year", "Year", "Year","Year","Year", "Year", "Year", "Year"};

    File f = new File ("data/IS.txt");
    Scanner input = new Scanner(f);

        Object [][] fs = new String[53][11];

            while (input.hasNextLine())
            {   
                for (int col=0;col<53;col++){
                    for (int row=0;row<11;row++){
                        fs[row][col] = input.nextLine();
                    //  System.out.printf("%s\t",fs[row][col]);
                    }
                }
                if (input.hasNextLine()) 
                    input.nextLine();

            }

    /*Object[][] data = {{"Period Ending:", "2011", "Snowboarding", Integer.valueOf(5), false},
        {"Values in Millions of $", "12-31", "Rowing", Integer.valueOf(3), true},
        {"Revenue:", "46,542", "Knitting", Integer.valueOf(2), false},
        {"Revenue Other:", "-", "Speed reading", Integer.valueOf(20), true},
        {"Total Revenue:", "46,542", "Speed reading", Integer.valueOf(20), true},
        {"Cost of Revenue:", "18,216", "Speed reading", Integer.valueOf(20), true},
        {"Gross Profit:", "28,326", "Speed reading", Integer.valueOf(20), true},
        {"Selling Gen. Admin Expenses:", "12,111", "Speed reading", Integer.valueOf(20), true},
        {"Research & Development:", "-", "Speed reading", Integer.valueOf(20), true},
        {"Depreciation/Amortization:", "-", "Speed reading", Integer.valueOf(20), true},
        {"Total Operating Expense:", "154", "Speed reading", Integer.valueOf(20), true},
        {"Operating Income:", "35,810", "Speed reading", Integer.valueOf(20), true},
        {"Interest Income (Exp.), Net NonOp:", "10,732", "Speed reading", Integer.valueOf(20), true},
        {"Interest/Invest Inc. Non-Operating:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Interest Inc. Net Non-Operating:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Gain/Loss on Sale of Assets:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Other, Net:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Net Income Before Taxes:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Income Tax - Total:", "White", "Speed reading", Integer.valueOf(20), true},
        {"Minority Interest:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Equity In Affiliates:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Accounting Change:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Discontinued Operations:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Extraordinary Items:", "Brown", "Pool", Integer.valueOf(10), false},
        {"Net Income:", "Brown", "Pool", Integer.valueOf(10), false}};*/
    JPanel cfPanel = new JPanel();
    JTable cfTable = new JTable(fs, columnNames);
    JScrollPane scrollPane = new JScrollPane(cfTable);
    cfPanel.add(scrollPane, BorderLayout.CENTER);

    return cfPanel;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T20:43:10.083

`Scanner`永远不会在嵌套循环中查询它`for`以确定它`hasNextLine()`之前`nextLine()`是否被调用，如果没有下一行则`nextLine()`抛出。`NoSuchElementException`

您需要处理该异常或`nextLine()`在 中进行保护`for`，并决定减少预期的行数意味着什么。

数组中的索引顺序错误，导致`ArrayIndexOutOfBoundsException`. 改成：

```
fs[col][row] = input.nextLine(); 
```

考虑在循环中查询数组的维度，`for`而不是重复硬编码的值：

```
for (int col = 0, col_size = fs.length; col < col_size; col++)
{
    for (int row = 0, row_size = fs[col].length; row < row_size; row++)
    {
        ...
    }
} 
```

# c++ - 带向量的 shared_ptr

> ID：10790161
> 
> 赞同：1
> 
> 时间：2012-05-28T20:34:47.997
> 
> 标签：c++, boost, shared-ptr

我目前有向量，例如：

```
vector<MyClass*> MyVector; 
```

我使用

```
MyVector[i]->MyClass_Function(); 
```

我想利用`shared_ptr`. 这是否意味着我所要做的就是将我的更改`vector`为：

```
typedef shared_ptr<MyClass*> safe_myclass

vector<safe_myclass> 
```

我可以像以前一样继续使用我的其余代码吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T20:46:46.677

大概只是`std::vector<MyClass>`。你是

1.  使用多态类或
2.  买不起复制构造函数或者有理由不能复制并且确定编译器不会写出这一步？

如果是这样，那么共享指针就是要走的路，但人们通常会使用这种范式，因为它根本没有利于他们。

如果您确实更改为完整`std::vector<MyClass>`，则如果您的代码稍后变为多态，您可能需要进行一些难看的维护，但理想情况下，您需要的所有更改都是更改您的 typedef。

*在这一点上，包装整个*std::vector可能是有意义的。

```
class MyClassCollection {
     private : std::vector<MyClass> collection;
     public  : MyClass& at(int idx);
     //...
 }; 
```

因此，您不仅可以安全地换出共享指针，还可以换出整个向量。权衡取舍更难输入到需要向量的 API，但这些设计不当，因为它们应该与您可以为您的类提供的迭代器一起使用。

可能这对您的应用程序来说工作量太大（尽管如果要在面向客户的库中公开它会是谨慎的），但这些都是有效的考虑因素。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-28T22:23:02.897

`vector<shared_ptr<MyClass>> MyVector;`应该可以。

但是，如果 的实例`MyClass`不在向量之外共享，并且您使用现代 C++11 编译器，`vector<unique_ptr<MyClass>>`则比`shared_ptr`（因为`unique_ptr`没有 的引用计数开销`shared_ptr`）更有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T21:38:04.010

不要立即跳转到共享指针。如果您需要避免复制对象，您可能更适合使用简单的[指针容器。](http://www.boost.org/libs/ptr_container/)

# delphi - Delphi中的微控制器编程

> ID：10790162
> 
> 赞同：2
> 
> 时间：2012-05-28T20:34:55.900
> 
> 标签：delphi, activex, pic

我一直在寻找有关微控制器编程的一些信息，但我发现的信息要么超出我的想象，要么似乎不存在。我正在寻找更容易消化的东西！我对编程比较陌生，并且具有 SQL DBA 背景，因此我决定学习一些编程基础知识然后自学 Delphi 比通过我公司疯狂的设计更改注释系统实现一些更改更快！经过几年的 Delphi 编程，我可以轻松地编写数据库应用程序，并且我希望能够更上一层楼。我们在 PCB 上使用 PIC 微控制器；主要是 PIC18F 系列。PICS 上的软件是用 C 语言编写的，但有一些参数值由 Delphi 应用程序写入，该应用程序使用 ActiveX 控件与 PIC 接口。基本上，SQL 数据库保存参数信息，Delphi 客户端应用程序检索这些值，将它们传递给 ActiveX 控件，该控件执行 PIC 上的所有低级操作。例如，内部 EEPROM 将有一个映射，并且在任何特定地址内将存储一个值以打开或关闭某些东西或保存一个整数值等。我已经拿到了一个 MPLAB 套件，它有一个可以读取和读取的 ICD2 设备将值写入内部 EEPROM，我了解如何使用 MPLAB 软件更改这些十六进制值。我的希望不是学习嵌入式微控制器编程；而是我可以编写一个类似于 MPLAB 软件的 Delphi 应用程序。例如，读取和写入值到 EEPROM 中的某些内存地址。如果有人能指出我可能已经存在的任何库或组件的正确方向，我将非常感激，以弥合简单的 Delphi 表单应用程序和编写低级 PIC EEPROM 之间的差距。我怀疑是否存在任何简单的界面，但我想我会问。总而言之，我希望能够拥有一个简单的表单应用程序，其中包含用户输入或从下拉框中选择的一些编辑框、参数值、单击按钮并将这些参数值分配给特定的 EEPROM 内存地址。感谢您的阅读，我们将不胜感激地收到任何意见。如果有人能指出我可能已经存在的任何库或组件的正确方向，以弥合简单的 Delphi 表单应用程序和编写低级 PIC EEPROM 之间的差距，我将不胜感激。我怀疑是否存在任何简单的界面，但我想我会问。总而言之，我希望能够拥有一个简单的表单应用程序，其中包含用户输入或从下拉框中选择的一些编辑框、参数值、单击按钮并将这些参数值分配给特定的 EEPROM 内存地址。感谢您的阅读，我们将不胜感激地收到任何意见。如果有人能指出我可能已经存在的任何库或组件的正确方向，以弥合简单的 Delphi 表单应用程序和编写低级 PIC EEPROM 之间的差距，我将不胜感激。我怀疑是否存在任何简单的界面，但我想我会问。总而言之，我希望能够拥有一个简单的表单应用程序，其中包含用户输入或从下拉框中选择的一些编辑框、参数值、单击按钮并将这些参数值分配给特定的 EEPROM 内存地址。感谢您的阅读，我们将不胜感激地收到任何意见。我怀疑是否存在任何简单的界面，但我想我会问。总而言之，我希望能够拥有一个简单的表单应用程序，其中包含用户输入或从下拉框中选择的一些编辑框、参数值、单击按钮并将这些参数值分配给特定的 EEPROM 内存地址。感谢您的阅读，我们将不胜感激地收到任何意见。我怀疑是否存在任何简单的界面，但我想我会问。总而言之，我希望能够拥有一个简单的表单应用程序，其中包含用户输入或从下拉框中选择的一些编辑框、参数值、单击按钮并将这些参数值分配给特定的 EEPROM 内存地址。感谢您的阅读，我们将不胜感激地收到任何意见。

问候

KD

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T20:57:41.123

我是 MikroElectronika 的忠实粉丝，并且已经成功地将他们的 Pascal 工具用于 pic16 系列 MCU（触摸屏界面、ZigBee 等）。 [http://www.mikroe.com/](http://www.mikroe.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T23:57:21.473

**2015 年更新答案：**

为什么不使用[带有 FreePascal 和 Lazarus 的 Raspberry Pi](http://wiki.freepascal.org/Lazarus_on_Raspberry_Pi)？截至目前，这些板的价格从 5 美元到 25 美元不等，并且开发工具是免费的。

**2012 年原始答案：** 如果您喜欢使用 Pascal，您可能会发现 Free Pascal 在小型嵌入式系统上很有用，但我相信您会发现它可以编译的最低限度是基于 Linux 的 ARM 嵌入式系统。你在两边都使用帕斯卡这一事实不太可能帮助你完成任何重大的事情。

如果您想一直使用最小的 PIC 微控制器，您会发现它几乎总是您将使用的 C 的变体。坦率地说，在那个级别上，差异并没有那么大。如果你会写 Pascal，你可以在一天内学会足够多的 C 来使用微控制器。

不要害怕使用大多数微控制器支持的本地语言。我个人最喜欢的是 Rabbit 微控制器，以前来自 Z-World，现在来自[digi——](http://www.digi.com/products/wireless-wired-embedded-solutions/solutions-on-module/rabbit-minicore/rcm6700#overview)我想我花了大约 100 美元购买了第一块电路板和开发工具包。

将这样的应用程序与 delphi 连接起来非常容易，通常这些天，我会通过有线以太网或无线 (Wifi) 使用 TCP/IP 进行连接。但如果你真的想要，你可以使用 RS-232 或 RS-485 串行链路。（RS-485 的优势在于您可以将其连接到 5 英里长。）如果我使用的是串行链路，我可能会在两侧实现类似 Modbus 的东西，如果我只是想发回一些数字数据并且第四，如果我正在做一些面向文本的事情，我想我会在嵌入式控制器上编写一个迷你 HTTP Web 服务器，而现在大多数主板都带有足够的 HTTP 服务器演示，以使该操作变得简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T14:19:36.350

如果您想要一个简单的界面来写入 PIC EEPROM，一种选择是使用 ICD 命令行实用程序。不幸的是，它不适用于 ICD2，但 PICkit 2 和 3（价格便宜）、ICD3 和 RealICE 具有命令行实用程序，使您能够写入 EEPROM（google pk2cmd）。在 Delphi 中，您可以将一组非常简单的命令行调用包装到 pk2cmd。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T21:14:07.283

Delphi 输出 Win32 和 Win64 本机应用程序，如果 PCB 具有串行通信或 I2C，您可以编写可以与某些设备交互的软件，您可以在 Delphi 中编写与物理设备交互的软件。

但是，如果您想自己对设备进行编程，请编写将在此设备上运行的软件，而这在 Delphi 中是做不到的。我建议您购买 Arduino，它对于微控制器编程的初学者来说是一个很好的环境。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T12:28:16.417

如果您有 pic 微控制器的源代码，那么您可以用 C 语言实现代码，以从硬件中可用的串行、USB 或其他接口读取并将其写入 eeprom。这样就可以轻松地用任何高级语言（如 delphi、c++ 等）编写应用程序。

或者您可以使用 mikroeletronika 的 mikropascal 编译器编写您的 PIC 应用程序，它非常好，我已经使用了很长时间，但是正如您所看到的，您必须实现一些机制才能从接口读取并写入您的 eeprom正如我之前提到的。

该编译器附带了许多库，可与许多设备一起使用。你应该看看它，它不是免费的，但价格很低，在他们的网站上你可以找到样品和样品板来测试它。

# vb.net - 多个数据绑定到 Datalist ASP.net VB 或 C#

> ID：10790163
> 
> 赞同：0
> 
> 时间：2012-05-28T20:34:58.087
> 
> 标签：vb.net, datatable, datalist

我想在 Datalist 的项目模板中显示一些变量值（大约 6 个）。假设我有

```
 Dim A As String = "hello world" 
```

我想在 Datalist 中展示它。Dim A 需要在页面加载或某处的方法中声明.. 因为源是数据库，所以我不能只在页面顶部声明为 public const。

我在 Datalist 中试过这个，但我不会按预期工作。

```
 <%= a %> 
```

我还尝试将 ItemDataBound 或 Page init 等不同的地方放在一起。如果我做错了，它就行不通。

Datalist 的数据源中是一个包含其他数据的数据表。所以就好像我有不止一个 Datalist 的来源。除了将 Dim A 放在数据表中之外，还有其他方法吗？

谢谢刘

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:43:47.240

作为变量放入类中（并在需要时在页面加载中分配值）

```
Public A As string = "hello world" 
```

然后在 DataList 模板字段中使用：

```
<%# A %> 
```

# sql - 用于合并不完全匹配的表的 SQL 代码

> ID：10790165
> 
> 赞同：0
> 
> 时间：2012-05-28T20:35:25.797
> 
> 标签：sql, netezza

我有一个看起来像这样的表：

代码动物

```
123  "Alligator"
1254 "Cardinal"
5675 "Golden Retreiver" 
```

我有另一个看起来像这样的表：

```
CODE  TYPE
12367 Reptile
12    Bird
56    Dog 
```

我想根据代码将列类型添加到第一个表中。我不确定如何进行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:48:47.200

那么第一项工作是使用alter table 语句添加列。

就像在类似的东西

```
Alter Table Animals Add AnimalTypeCode int null 
```

然后你需要填充它，这将是一堆更新语句

用类似的东西说

```
Update Animals 
Set AnimalTypeCode = 12367
Where Code = 123 
```

或者如果说鳄鱼是 679

```
Update Animals 
Set AnimalTypeCode = 12367
Where Code in (123,679) 
```

或者，如果您更喜欢它的可读性

```
Update Animals 
Set AnimalTypeCode = 12367
Where Animal in ('Alligator','Crocodile') 
```

继续打，直到他们都得到一个，也许根据需要添加一些新类型，然后你可以添加一个外键。

除非您在某处将动物与动物类型联系起来，否则没有简单的方法可以做到这一点

编辑添加。给定 AnimalCode = AnimalTypeCode * 100 + ? 然后

```
Update Animals
Set AnimalTypeCode = Cast(AnimalCode / 100 as Int) 
```

可能会做这项工作

```
Select * 
From Animals
outer join AnimalTypes On Animals.AnimalTypeCode = AnimalTypes.Code
Where AnimalTypes.Code is null 
```

将为您提供所有动物类型代码未指向现有动物类型的内容。

您必须提防的是 1269, Elephant, Bird(12)。如果你有类似的东西，你将不得不单独修复它们。

# ruby-on-rails-3 - ActiveRecord Rail 3 查询以包括没有现有关系的结果

> ID：10790166
> 
> 赞同：1
> 
> 时间：2012-05-28T20:35:40.370
> 
> 标签：ruby-on-rails-3, activerecord

有没有办法使用 :joins 或 :includes 查询项目，但也可以在同一个查询中返回没有对应关系的结果？

当前示例查询

```
Company.find(1).users.includes(:billing_statuses).where('billing_statuses.expires < ?', Time.now) 
```

这应该返回所有已过期 billing_statuses 的用户，但是，最终目标是获取所有“未计费”用户，这将包括尚未具有 :billing_statuses 关系的用户。

有没有办法将它组合在一个查询中？

我探索的另一种方法是获取公司的所有用户，然后减去没有过期账单的用户。但我觉得这不是最优化的解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T04:59:26.337

试试这个：

`User.where(company_id: 1).joins("LEFT OUTER JOIN billing_statuses ON billing_statuses.user_id = users.id").where("billing_statuses.expires < ? or billing_statuses.id IS NULL", Time.now)`

# java - 如何在没有 ACTION_DOWN 和 ACTION_UP 的情况下检测类似拖动的行为

> ID：10790169
> 
> 赞同：1
> 
> 时间：2012-05-28T20:35:48.773
> 
> 标签：java, android

我的问题涉及 onTouch。据我所知，没有办法检测一个视图的 ACTION_DOWN，而不是在同一个 onTouch 事件或滑动时检测另一个视图的 ACTION_UP，因为每个 onTouch 事件都链接到一个视图。

我有一个带有一些图形的视图 (A)，在 EVENT_DOWN 上检测到坐标并制作一个“弹出窗口”，其中包含一个视图 (B)，该视图 (B) 拥有更多视图 (“按钮”)。B 的位置和大小可能会不时变化。我更愿意在 B 的一个孩子（“按钮”）上检测 ACTION_UP。

我想使用 onInterceptTouchEvent 不好。毕竟，B 不是 A 的父母。它反过来。

使用 androids 的拖放功能似乎有点过头了。看起来它是用于实际拖动图形和传输数据的。拖动不可见的图形来检测手指离开屏幕不是很优雅。

另一种方法是在每次显示弹出窗口时检测 B 的孩子的位置（和大小），但这也不是很顺利。

检测视图 A 的 ACTION_DOWN 及其子视图 B（或它的子视图）ACTION_UP 的最佳方法是什么？

还是有其他方法可以检测这些事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:24:45.407

我确实为非常相似的事情挣扎了一两天，最后我得出结论，据我所知 onInterceptTouchEvent 是唯一的方法。我刚刚为 A 和 B 创建了一个容器视图“C”，然后当 A 收到 ACTION_DOWN 时，我指示“C”拦截滑动中的所有进一步事件，针对 B 的已知位置测试坐标，然后将事件转发到如果 ACTION_UP 对 B 的边界测试为阳性，则通过自定义方法“B”（小心手动将 MotionEvents 从一个类传递到另一个类，因为坐标都是错误的）。

不是一个非常令人满意的解决方案，但这是我唯一能想到的。

另外，以防万一您使用它，android 3.0+ 有一些拖放辅助方法，我确信它们非常有用，尽管我正在为 2.x 开发，所以它们对我没用。

# performance - 设置 UIImageView 的图像属性会导致严重滞后

> ID：10790183
> 
> 赞同：23
> 
> 时间：2012-05-28T20:37:20.017
> 
> 标签：performance, asynchronous, uiimageview, uiimage, core-graphics

让我告诉你我遇到的问题以及我如何尝试解决它。我有一个 UIScrollView 加载子视图作为一个从左到右滚动。每个子视图有 10-20 个图像，每个图像大约 400x200。当我从一个视图滚动到另一个视图时，我会遇到相当多的延迟。

调查后发现，卸载所有视图后再次尝试，卡顿消失了。我认为图像的同步缓存是滞后的原因。所以我创建了一个异步加载图像的 UIImageView 的子类。加载代码如下所示（`self.dispatchQueue`返回一个串行调度队列）。

```
- (void)loadImageNamed:(NSString *)name {
    dispatch_async(self.dispatchQueue, ^{
        UIImage *image = [UIImage imageNamed:name];

        dispatch_sync(dispatch_get_main_queue(), ^{
            self.image = image;
        });
    });
} 
```

但是，在将我所有的 UIImageViews 更改为这个子类之后，我仍然遇到了延迟（我不确定它是否减少了）。我将问题的原因归结为`self.image = image;`. 为什么这会导致如此多的延迟（但仅在第一次加载时）？

请帮我。=(

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-05-30T15:00:36.527

编辑 3：iOS 15 现在提供[`UIImage.prepareForDisplay(completionHandler:)`](https://developer.apple.com/documentation/uikit/uiimage/3750844-preparefordisplay).

```
image.prepareForDisplay { decodedImage in
    imageView.image = decodedImage
} 
```

或者

```
imageView.image = await image.byPreparingForDisplay() 
```

* * *

编辑 2：这是一个包含一些改进的 Swift 版本。（未经测试。） [https://gist.github.com/fumoboy007/d869e66ad0466a9c246d](https://gist.github.com/fumoboy007/d869e66ad0466a9c246d)

* * *

编辑：实际上，我相信所有必要的都是以下内容。（未经测试。）

```
- (void)loadImageNamed:(NSString *)name {
    dispatch_async(self.dispatchQueue, ^{
        // Determine path to image depending on scale of device's screen,
        // fallback to 1x if 2x is not available
        NSString *pathTo1xImage = [[NSBundle mainBundle] pathForResource:name ofType:@"png"];
        NSString *pathTo2xImage = [[NSBundle mainBundle] pathForResource:[name stringByAppendingString:@"@2x"] ofType:@"png"];

        NSString *pathToImage = ([UIScreen mainScreen].scale == 1 || !pathTo2xImage) ? pathTo1xImage : pathTo2xImage;

        UIImage *image = [[UIImage alloc] initWithContentsOfFile:pathToImage];

        // Decompress image
        if (image) {
            UIGraphicsBeginImageContextWithOptions(image.size, NO, image.scale);

            [image drawAtPoint:CGPointZero];

            image = UIGraphicsGetImageFromCurrentImageContext();

            UIGraphicsEndImageContext();
        }

        // Configure the UI with pre-decompressed UIImage
        dispatch_async(dispatch_get_main_queue(), ^{
            self.image = image;
        });
    });
} 
```

* * *

原始答案：事实证明，它不是`self.image = image;`直接的。UIImage 图像加载方法不会立即解压缩和处理图像数据；当视图刷新其显示时，他们会这样做。所以解决的办法是降级到Core Graphics，自己解压处理图像数据。新代码如下所示。

```
- (void)loadImageNamed:(NSString *)name {
    dispatch_async(self.dispatchQueue, ^{
        // Determine path to image depending on scale of device's screen,
        // fallback to 1x if 2x is not available
        NSString *pathTo1xImage = [[NSBundle mainBundle] pathForResource:name ofType:@"png"];
        NSString *pathTo2xImage = [[NSBundle mainBundle] pathForResource:[name stringByAppendingString:@"@2x"] ofType:@"png"];

        NSString *pathToImage = ([UIScreen mainScreen].scale == 1 || !pathTo2xImage) ? pathTo1xImage : pathTo2xImage;

        UIImage *uiImage = nil;

        if (pathToImage) {
            // Load the image
            CGDataProviderRef imageDataProvider = CGDataProviderCreateWithFilename([pathToImage fileSystemRepresentation]);
            CGImageRef image = CGImageCreateWithPNGDataProvider(imageDataProvider, NULL, NO, kCGRenderingIntentDefault);

            // Create a bitmap context from the image's specifications
            // (Note: We need to specify kCGImageAlphaPremultipliedFirst | kCGBitmapByteOrder32Little
            // because PNGs are optimized by Xcode this way.)
            CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
            CGContextRef bitmapContext = CGBitmapContextCreate(NULL, CGImageGetWidth(image), CGImageGetHeight(image), CGImageGetBitsPerComponent(image), CGImageGetWidth(image) * 4, colorSpace, kCGImageAlphaPremultipliedFirst | kCGBitmapByteOrder32Little);

            // Draw the image into the bitmap context
            CGContextDrawImage(bitmapContext, CGRectMake(0, 0, CGImageGetWidth(image), CGImageGetHeight(image)), image);

            //  Extract the decompressed image
            CGImageRef decompressedImage = CGBitmapContextCreateImage(bitmapContext);

            // Create a UIImage
            uiImage = [[UIImage alloc] initWithCGImage:decompressedImage];

            // Release everything
            CGImageRelease(decompressedImage);
            CGContextRelease(bitmapContext);
            CGColorSpaceRelease(colorSpace);
            CGImageRelease(image);
            CGDataProviderRelease(imageDataProvider);
        }

        // Configure the UI with pre-decompressed UIImage
        dispatch_async(dispatch_get_main_queue(), ^{
            self.image = uiImage;
        });
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:51:27.047

我认为，问题可能出在图像本身。例如 - 我在我的一个项目中获得了 10 张 640x600 的图像，它们相互之间具有 alpha 透明度。当我尝试从这个视图控制器推送或弹出视图控制器时......它滞后了很多。

当我只留下几张图片或使用非常小的图片时 - 没有延迟。

PS 在 sdk 4.2 ios5 iphone 4 上测试。

# jquery - .submit() 表单后重定向

> ID：10790187
> 
> 赞同：2
> 
> 时间：2012-05-28T20:38:10.203
> 
> 标签：jquery, forms, redirect, submit

我有一个 HTML 表单，它使用 div (submitme) 来触发以下代码......然后代码使用 bValidator 插件来验证表单字段，然后在提交表单之前检查蜜罐字段是否为空白...... .

当我排除“window.location ...”等时，.submit() 可以工作并通过它发布表单，但是在包含它时；验证/蜜罐仍然有效，但没有提交表单。

我是 JQUERY 的新手，想知道是否缺少一些简单的东西或更好的方法来编写以下内容：

```
$("#submitme").click(function(){
    if($('#right-body-div').data('bValidator').validate()) {

        if ($("#honeypot").val() == "") {
                $('#pgpost').submit();
                window.location = "http://www.homepage.co.uk/thankyou";    
                return true;
              }
           window.location = "http://www.homepage.co.uk/nothankyou";
           return false;
    }
}); 
```

如果可能的话，我想在不使用 AJAX/PHP 的情况下完成此操作。

您的想法将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T20:42:14.203

```
$('#pgpost').submit(function(e) {  // this handles the submit event
    if($('#right-body-div').data('bValidator').validate()) {
        if ($("#honeypot").val() == "") {
            /*
             * url = $('#pgpost').val('action');
             * data = $('#pgpost').serialize();
             * $.post(url, data, function() {
             *     window.location = "http://www.homepage.co.uk/thankyou";
             * });
             */
            window.location = "http://www.homepage.co.uk/thankyou";
        }
        else {
            window.location = "http://www.homepage.co.uk/nothankyou";
        }
    }

    e.preventDefault();
    return false;
    /*
     * the 2 lines above are meant to prevent the normal behaviour
     * that the <form> would have (which is to submit via browser).
     * 
     * e.preventDefault() is the jquery way prevent the normal behaviour
     * return false is the legacy way to do it, you can use either or both
     * 
     * the reason for which the code didn't validate your form is
     * that e.prevenDefault() was only called inside the IF statement
     * which means that it would only be called if the field was
     * already in valid form. So basically if the form was invalid the normal
     * behaviour is not prevented and the browser submits the form, if the form
     * was valid the submit behaviour was prevented and the redirect was used.
     * 
     */
});

$("#submitme").click(function(){
    $('#pgpost').submit(); // this triggers the submit event
}); 
```

通过 JavaScript 处理提交事件时，您可以：

*   始终防止正常行为（我们的案例）：
    *   当表单有效时，您通过 JavaScript[提交数据](http://api.jquery.com/jQuery.post/)，也许您在提交之前对其进行处理；
    *   当表格无效时，您会显示错误消息；
*   **仅当表单无效**时才阻止正常行为：
    *   当表单有效时，您允许正常行为（浏览器提交数据）；
    *   当表格无效时，您会显示错误消息；

您的案例中的错误消息应说明蜜罐不应为空。

在以下情况下防止正常行为是有意义的： - 您需要在将数据发送到服务器之前对其进行处理（创建新值，更改当前值；**而不是验证**）；- 您需要避免页面刷新，以便通过 AJAX 发送；

只是为了验证，阻止该行为是没有意义的，因为您可以验证然后允许正常行为继续。

# google-app-engine - 访问 Google App Engine 管理控制台结算数据

> ID：10790188
> 
> 赞同：0
> 
> 时间：2012-05-28T20:38:44.700
> 
> 标签：google-app-engine

有没有办法使用代码访问和下载应用程序实例的 App Engine 账单和配额数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:24:01.850

不，目前没有访问计费或配额数据的程序化方法。

# android - 使用哪些 Android 意图标志

> ID：10790202
> 
> 赞同：4
> 
> 时间：2012-05-28T20:40:53.517
> 
> 标签：android, android-intent, android-activity

我有一个应用程序接收来自`AlarmManager`. 在此之后，它会启动一个透明的`Activity`( `AlarmAlertDialogActivity`)，然后显示一个`AlertDialog`. `AlertDialog`在调用结果上单击取消`finish()`。

由于`AlarmAlertDialogActivity`不是从另一个发射`Activity`器而是从广播接收器发射的，因此它是用发射的

```
Intent.FLAG_ACTIVITY_NEW_TASK 
```

这意味着 Activity 将在新任务中启动。

我的问题是，当应用程序在取消`AlertDialog`（即按住主页按钮并单击应用程序的图标）后从最近的历史记录中重新启动时，AlertDialog 会重新启动。我曾希望通过使用`finish()`/`Intent`标志能够避免这种情况；我想要发生的是要启动的父 Activity`Activity`之前的最后一个。`AlertDialog`

我`Intent.FLAG_ACTIVITY_NO_HISTORY`在启动时尝试将位掩码作为附加标志，`AlarmAlertDialogActivity`但这似乎没有什么区别。

位掩码`Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS`有效，但只能通过从最近的历史记录中删除应用程序（顾名思义）。这对用户体验是不利的。

那么，是否有可能获得我正在寻找的 UI 流程？

**更新**- 根据要求提供更多信息：

来自广播接收器的 Logcat、AlertDialog 活动和我的主要活动：

```
 05-30 10:36:00.132: D/everyOtherApp(362): Received alarm broadcast at: Wed May 30 10:36:00 GMT+00:00 2012
05-30 10:36:00.262: D/everyOtherApp(362): AlarmAlertDialogActivity.onCreate()
05-30 10:36:00.912: D/everyOtherApp(362): AlarmAlertDialogActivity.onResume()
05-30 10:36:12.461: D/everyOtherApp(362): Cancel pressed

//Cancel exits the activity. I now relaunch the app from recent history:

05-30 10:36:20.233: D/everyOtherApp(362): AlarmAlertDialogActivity.onCreate()
05-30 10:36:21.621: D/everyOtherApp(362): AlarmAlertDialogActivity.onResume() 
```

从 BroadcastReceiver 启动 Activity 的代码：

```
 Intent intent = new Intent(new Intent(applicationContext, AlarmAlertDialogActivity.class));
    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    intent.putExtra(Constants.SCHEDULED_ALARM_TAG, alarm);
    applicationContext.startActivity(intent); 
```

清单文件中的 AlarmAlertDialogActivity：

```
 <activity
        android:name=".AlarmAlertDialogActivity"
        android:theme="@android:style/Theme.NoDisplay" >
    </activity> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T14:16:57.407

我在另一个项目中做了类似的事情。我有一个 BroadcastReceiver，它获取有关数据连接和 SIM 配置文件更改的信息，并显示一个对话框（使用像你这样的活动）警告用户他可能会产生费用。我最终做的是以下内容：

在清单中的`<Activity>`AlarmAlertDialogActivity 标记中，添加以下内容：

```
android:excludeFromRecents="true"
android:noHistory="true"
android:taskAffinity="" 
```

**说明：**设置`excludeFromRecents`和`noHistory`“真”确保活动不会出现在最近的应用程序列表中，并且一旦用户离开它，他将无法回到那里（这可能是你想要的）。设置`taskAffinity`为空字符串可确保 AlarmAlertDialogActivity 将在它自己的任务中运行，即使您的应用程序在显示对话框时正在运行。

只要您有另一个活动作为应用程序的主要活动（即：使用意图过滤器`action.MAIN`和`category.LAUNCHER`），这应该可以解决您的问题。

# validation - Symfony2 自定义验证

> ID：10790203
> 
> 赞同：0
> 
> 时间：2012-05-28T20:40:59.613
> 
> 标签：validation, symfony, entity

我有一个“产品”实体，我想使用自定义回调函数验证此类的属性（例如价格）。我的自定义验证比 sf2(minLength, max, etc) 提供的默认验证更复杂。我想做这样的事情：

```
class Product
{
/**
* @Assert\NotBlank()
* @Assert\CallbackValidationFunction('validatePrice', 'Your price is not the expected')
*/
private $price;
}

function validatePrice($priceValue){
$x = " i want";
return $priceValue == "the value".$x;
} 
```

然后，在错误中，消息“您的价格不是预期的”与 $form->isValid() 或通过 $this->get('validator') 的产品验证后的 Product 中的属性 $price 相关；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:59:36.527

您最好编写自定义验证约束。有关说明，请参阅[http://symfony.com/doc/current/cookbook/validation/custom_constraint.html](http://symfony.com/doc/current/cookbook/validation/custom_constraint.html)。

# r - 如何在data.table中通过引用删除一行？

> ID：10790204
> 
> 赞同：163
> 
> 时间：2012-05-28T20:41:07.663
> 
> 标签：r, data.table

我的问题与引用分配与复制有关`data.table`。我想知道是否可以通过引用删除行，类似于

```
DT[ , someCol := NULL] 
```

我想知道

```
DT[someRow := NULL, ] 
```

我想这个函数不存在是有充分理由的，所以也许你可以指出一个很好的替代通常复制方法的方法，如下所示。特别是，与我最喜欢的示例（data.table）一起使用，

```
DT = data.table(x = rep(c("a", "b", "c"), each = 3), y = c(1, 3, 6), v = 1:9)
#      x y v
# [1,] a 1 1
# [2,] a 3 2
# [3,] a 6 3
# [4,] b 1 4
# [5,] b 3 5
# [6,] b 6 6
# [7,] c 1 7
# [8,] c 3 8
# [9,] c 6 9 
```

假设我想从此 data.table 中删除第一行。我知道我可以这样做：

```
DT <- DT[-1, ] 
```

但通常我们可能希望避免这种情况，因为我们正在复制对象（并且需要大约 3*N 内存，如果 N `object.size(DT)`，[正如在此处指出的那样](https://stackoverflow.com/questions/9508118/out-of-memory-when-modifying-a-big-r-dataframe)。现在我发现`set(DT, i, j, value)`了。我知道如何设置特定值（例如这里：set all第 1 行和第 2 行以及第 2 和第 3 列中的值为零）

```
set(DT, 1:2, 2:3, 0) 
DT
#      x y v
# [1,] a 0 0
# [2,] a 0 0
# [3,] a 6 3
# [4,] b 1 4
# [5,] b 3 5
# [6,] b 6 6
# [7,] c 1 7
# [8,] c 3 8
# [9,] c 6 9 
```

但是，我怎样才能擦除前两行呢？正在做

```
set(DT, 1:2, 1:3, NULL) 
```

将整个 DT 设置为 NULL。

我的SQL知识很有限，各位大佬告诉我：给定的data.table使用了SQL技术，有没有等价的SQL命令

```
DELETE FROM table_name
WHERE some_column=some_value 
```

在数据表中？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-05-29T00:20:29.977

好问题。`data.table`还不能通过引用删除行。

`data.table`如您所知，可以通过引用添加和删除*列*，因为它过度分配了列指针的向量。计划是对行做类似的事情，并允许快速`insert`和`delete`. 行删除将`memmove`在 C 中用于在删除的行之后移动项目（在每一列中）。与 SQL 等行存储数据库相比，删除表中间的一行仍然非常低效，后者更适合快速插入和删除行，无论这些行在表中的何处。但是，它仍然比复制没有删除行的新大对象快得多。

另一方面，由于列向量会被过度分配，因此可以立即*在末尾*插入（和删除）行；例如，增长的时间序列。

* * *

它作为一个问题提交：[Delete rows by reference](https://github.com/Rdatatable/data.table/issues/635)。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-01-21T18:39:18.060

为了使内存使用类似于就地删除，我采取的方法是一次子集一列并删除。不如适当的 C memmove 解决方案快，但我在这里只关心内存使用。像这样的东西：

```
DT = data.table(col1 = 1:1e6)
cols = paste0('col', 2:100)
for (col in cols){ DT[, (col) := 1:1e6] }
keep.idxs = sample(1e6, 9e5, FALSE) # keep 90% of entries
DT.subset = data.table(col1 = DT[['col1']][keep.idxs]) # this is the subsetted table
for (col in cols){
  DT.subset[, (col) := DT[[col]][keep.idxs]]
  DT[, (col) := NULL] #delete
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-11-18T08:29:35.497

这是基于@vc273 的回答和@Frank 的反馈的工作函数。

```
delete <- function(DT, del.idxs) {           # pls note 'del.idxs' vs. 'keep.idxs'
  keep.idxs <- setdiff(DT[, .I], del.idxs);  # select row indexes to keep
  cols = names(DT);
  DT.subset <- data.table(DT[[1]][keep.idxs]); # this is the subsetted table
  setnames(DT.subset, cols[1]);
  for (col in cols[2:length(cols)]) {
    DT.subset[, (col) := DT[[col]][keep.idxs]];
    DT[, (col) := NULL];  # delete
  }
   return(DT.subset);
} 
```

及其用法示例：

```
dat <- delete(dat,del.idxs)   ## Pls note 'del.idxs' instead of 'keep.idxs' 
```

其中“dat”是一个 data.table。在我的笔记本电脑上，从 140 万行中删除 14000 行需要 0.25 秒。

```
> dim(dat)
[1] 1419393      25
> system.time(dat <- delete(dat,del.idxs))
   user  system elapsed 
   0.23    0.02    0.25 
> dim(dat)
[1] 1404715      25
> 
```

PS。由于我是 SO 新手，我无法向@vc273 的线程添加评论:-(

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-28T22:33:18.413

而是尝试设置为 NULL，尝试设置为 NA（匹配第一列的 NA 类型）

```
set(DT,1:2, 1:3 ,NA_character_) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-08-27T21:52:22.860

这个话题对很多人（包括我）来说仍然很有趣。

那个怎么样？我曾经`assign`替换`glovalenv`和 前面描述的代码。捕获原始环境会更好，但至少`globalenv`它是内存高效的，并且就像 ref 的更改一样。

```
delete <- function(DT, del.idxs) 
{ 
  varname = deparse(substitute(DT))

  keep.idxs <- setdiff(DT[, .I], del.idxs)
  cols = names(DT);
  DT.subset <- data.table(DT[[1]][keep.idxs])
  setnames(DT.subset, cols[1])

  for (col in cols[2:length(cols)]) 
  {
    DT.subset[, (col) := DT[[col]][keep.idxs]]
    DT[, (col) := NULL];  # delete
  }

  assign(varname, DT.subset, envir = globalenv())
  return(invisible())
}

DT = data.table(x = rep(c("a", "b", "c"), each = 3), y = c(1, 3, 6), v = 1:9)
delete(DT, 3) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-01-29T01:47:34.007

以下是我使用的一些策略。我相信 .ROW 功能可能会出现。以下这些方法都不是快速的。这些是一些超出子集或过滤的策略。我试着像 dba 一样思考只是试图清理数据。如上所述，您可以选择或删除 data.table 中的行：

```
data(iris)
iris <- data.table(iris)

iris[3] # Select row three

iris[-3] # Remove row three

You can also use .SD to select or remove rows:

iris[,.SD[3]] # Select row three

iris[,.SD[3:6],by=,.(Species)] # Select row 3 - 6 for each Species

iris[,.SD[-3]] # Remove row three

iris[,.SD[-3:-6],by=,.(Species)] # Remove row 3 - 6 for each Species 
```

注意：.SD 创建原始数据的子集，并允许您在 j 或后续 data.table 中做大量工作。请参阅[https://stackoverflow.com/a/47406952/305675](https://stackoverflow.com/a/47406952/305675)。在这里，我按萼片长度订购了我的虹膜，以指定的 Sepal.Length 为最小值，选择所有物种的前三个（按萼片长度）并返回所有随附数据：

```
iris[order(-Sepal.Length)][Sepal.Length > 3,.SD[1:3],by=,.(Species)] 
```

删除行时，上述所有方法都会按顺序对 data.table 进行重新排序。您可以转置 data.table 并删除或替换现在是转置列的旧行。当使用 ':=NULL' 删除转置的行时，随后的列名也将被删除：

```
m_iris <- data.table(t(iris))[,V3:=NULL] # V3 column removed

d_iris <- data.table(t(iris))[,V3:=V2] # V3 column replaced with V2 
```

当您将 data.frame 转回 data.table 时，您可能希望从原始 data.table 重命名并在删除的情况下恢复类属性。将 ":=NULL" 应用于现在转置的 data.table 会创建所有字符类。

```
m_iris <- data.table(t(d_iris));
setnames(d_iris,names(iris))

d_iris <- data.table(t(m_iris));
setnames(m_iris,names(iris)) 
```

您可能只想删除可以使用或不使用 Key 的重复行：

```
d_iris[,Key:=paste0(Sepal.Length,Sepal.Width,Petal.Length,Petal.Width,Species)]     

d_iris[!duplicated(Key),]

d_iris[!duplicated(paste0(Sepal.Length,Sepal.Width,Petal.Length,Petal.Width,Species)),] 
```

也可以使用“.I”添加增量计数器。然后，您可以搜索重复的键或字段，并通过使用计数器删除记录来删除它们。这在计算上很昂贵，但有一些优点，因为您可以打印要删除的行。

```
d_iris[,I:=.I,] # add a counter field

d_iris[,Key:=paste0(Sepal.Length,Sepal.Width,Petal.Length,Petal.Width,Species)]

for(i in d_iris[duplicated(Key),I]) {print(i)} # See lines with duplicated Key or Field

for(i in d_iris[duplicated(Key),I]) {d_iris <- d_iris[!I == i,]} # Remove lines with duplicated Key or any particular field. 
```

您也可以只用 0 或 NA 填充一行，然后使用 i 查询删除它们：

```
 X 
   x v foo
1: c 8   4
2: b 7   2

X[1] <- c(0)

X
   x v foo
1: 0 0   0
2: b 7   2

X[2] <- c(NA)
X
    x  v foo
1:  0  0   0
2: NA NA  NA

X <- X[x != 0,]
X <- X[!is.na(x),] 
```

# javascript - JavaScript 单选按钮

> ID：10790205
> 
> 赞同：0
> 
> 时间：2012-05-28T20:41:07.963
> 
> 标签：javascript, jquery, html

我有几个`radio`按钮，当我选择其中一个时，我还必须检查另一个。

例如，如果我在一个按钮上选择*yes* ，则必须使用*no*`radio`自动检查另一个按钮。我尝试了一些脚本，但似乎不起作用。`radio`

 *有谁知道解决方案？我是JS的新手。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:53:47.437

## [***`　　　　　　　 　　　　　>　Live Demo　<　　　　 　　　　　　　 　`***](http://jsfiddle.net/DerekL/ePD9k/2/)

* * *

```
<!--HTML-->
<input type="radio" name="group_1" value="yes" id="r1">Yes<br>
<input type="radio" name="group_1" value="no" id="r2">No<br>
<br>
<input type="radio" name="group_2" value="yes" id="r3">Yes<br>
<input type="radio" name="group_2" value="no" id="r4">No<br>​

//Script
$("input[name='group_1']").click(function(){
    if(this.value=="yes"){
        $("input#r4").attr("checked",true);
    }else{
        $("input#r3").attr("checked",true);
    }
});
$("input[name='group_2']").click(function(){
    if(this.value=="yes"){
        $("input#r2").attr("checked",true);
    }else{
        $("input#r1").attr("checked",true);
    }
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:47:40.713

我不太确定您要达到的目标，但是通过使用“名称”属性，这会自动发生……当您检查一个收音机时……其他具有相同名称的收音机被设置为未选中。

```
<input type="radio" name="someoption" value="0" />0 
<input type="radio" name="someoption" value="1" />1 
<input type="radio" name="someoption" value="2" />2 
```

检查上述任何一项将导致其他 2 个未被选中

除非你可能意味着复选框或多个选项集？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T20:50:16.173

javascript:

```
$('#myradio1').bind('change', function () {
  $('#myradio3').attr('checked', 'checked');
}); 
```

html

```
<input type="radio" name="cols1" value="1" id="myradio1" />
<input type="radio" name="cols1" value="2" id="myradio2" />
<input type="radio" name="cols2" value="1" id="myradio3" />
<input type="radio" name="cols2" value="2" id="myradio4" /> 
```

[请参阅http://jsfiddle.net/9jXbv/](http://jsfiddle.net/9jXbv/)上的工作示例

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T20:50:45.690

对于如下 HTML 标记：

```
<div>
    <input type="radio" name="one" value="yes"> yes
    <input type="radio" name="one" value="no"> no
</div>

<div>
    <input type="radio" name="two" value="yes"> yes
    <input type="radio" name="two" value="no"> no
</div> 
```

你可以使用这个 JavaScript 代码：

```
$(":radio").on("change", function() {
    var that = this;
    $(":radio").filter(function() {
        return this.value == "no" && this.name != that.name;
    }).prop("checked", true);
});​ 
```

**演示：http:** [//jsfiddle.net/nKLMX/](http://jsfiddle.net/nKLMX/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-28T20:55:29.373

使用 jquery：

```
​$("#radio1").change(function() {
    $("#radio2").removeAttr("checked");
});​​​ 
```

[http://jsfiddle.net/](http://jsfiddle.net/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-28T21:09:23.107

我已经为此模拟了一个纯 JS 解决方案（没有库）

```
<input type="radio" name="g1" value="1" />Yes
<br />
<input type="radio" name="g1" value="0" />No
<br /><br />
<input type="radio" name="g2" value="1" />Yes
<br />
<input type="radio" name="g2" value="0" />No

<script type="text/javascript">
    var g1 = document.getElementsByName('g1'); // store g1 elements
    var g2 = document.getElementsByName('g2'); // store g2 elements

    // handle click functionality
    function radio_checked_event(obj, f) {
        if(obj.addEventListener) {
            obj.addEventListener('click', f, false);
        } else if(obj.attachEvent) {
            obj.attachEvent('onclick', f);
        }
    }

    // when you click on g1 yes
    radio_checked_event(g1[0], function() {
            //set g1 no to checked
        g2[1].setAttribute('checked', 'checked');
    });
</script> 
```*

# java - Java servlet 的参数值不被解码

> ID：10790206
> 
> 赞同：1
> 
> 时间：2012-05-28T20:41:10.033
> 
> 标签：java, url, servlets, encoding, getparameter

我对 java servlet 的 getParameter() 有一些问题，即使我在 server.xml 中正确设置了 Tomcat 的编码，它也不会解码参数。

```
 <Connector port.. URIEncoding="UTF-8"/> 
```

如果我解码原始查询，我会得到解码后的查询，但 getParamter 不会自行解码！

```
 protected void service(HttpServletRequest request, HttpServletResponse response) 
                throws ServletException, IOException {
    System.out.println("CharacterEncoding: "+ request.getCharacterEncoding());
    System.out.println("Query String: "+ URLDecoder.decode(request.getQueryString(), "UTF-8");
    System.out.println("Query param name: "+request.getParameter("name"));
    ... 
```

我得到的结果如下：

字符编码：UTF-8

查询字符串：name=日本语一番ぜソＦＯＸ_&'">•«Ç€Ö™»_αß_iİıI_Администратор_cœur d´Ouchy__عربي

查询参数名称：æ¥æ¬èªä¸çªãã½ï¼¦ï¼¯ï¼¸_&'">â¢Â«Ãâ¬Ãâ¢Â»_Î±Ã_iÄ°Ä±I_Ð´Ð¼Ð¸Ð½Ð¸ÑÑÑÑÐ°ÑÐ¾Ñ_cÅur dÂ´Ouchy_ð ð ðª_Ø¹ØØØØØ ±Ø¨Ù

您可以清楚地看到查询和名称的值不一样！在我的 jsp 页面中，我使用 <%@page contentType="text/html; charset=UTF-8" %>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:32:10.190

我了解这涉及 GET 请求。设置`<Connector URIEncoding="UTF-8">`应该这样做。它不起作用只能意味着您在 Eclipse 之类的 IDE 中运行 Tomcat，并且当您在`/conf/server.xml`.

目前还不清楚您使用的是哪个 IDE，但如果是 Eclipse，您需要*编辑*工作`server.xml`区的*Servers*项目中的文件，而不是 Tomcat 自己的`/conf/server.xml`文件

![在此处输入图像描述](../Images/17dfc75165b546f65813af082ba5a795.png)

*或者通过双击**服务器*视图中的 Tomcat 服务器条目并相应地更改*服务器位置*部分来配置 Eclipse 以控制 Tomcat 的安装。

![在此处输入图像描述](../Images/f8e07c18ffa79b595c412727c5b3ed34.png)

回到您的调查/修复尝试：`request.getCharacterEncoding()`它没有用于解码 GET 查询字符串（因为这超出了 Servlet API 的控制范围），它仅用于解码 POST 请求正文。`<%@page pageEncoding="UTF-8"%>`只会设置响应和后续表单提交的字符编码。

### 也可以看看

*   [Unicode - 如何让字符正确？](http://balusc.blogspot.com/2009/05/unicode-how-to-get-characters-right.html)

# wordpress - .htaccess 重写 WordPress 多站点

> ID：10790207
> 
> 赞同：0
> 
> 时间：2012-05-28T20:41:19.177
> 
> 标签：wordpress, .htaccess, redirect, rewrite

在我的服务器上，我为自己的公司网站安装了一个 WordPress。除此之外，我想为客户创建一个演示区。

目前我有以下设置和文件夹：

www.domain.com - 公司网站的单一 WordPress 安装

www.domain.com/demo/ - WordPress 多站点

目前所有客户网站的域名结构如下：www.domain.com/demo/client1、www.domain.com/demo/client2等。

我想要一个子域，而不是那些长 URL：demo.domain.com/client1、demo.domain.com/client2 等。

WordPress 多站点标准生成以下 .htaccess：

```
RewriteEngine On
RewriteBase /demo/
RewriteRule ^index\.php$ - [L]

RewriteRule ^([_0-9a-zA-Z-]+/)?files/(.+) wp-includes/ms-files.php?file=$2 [L]

RewriteRule ^([_0-9a-zA-Z-]+/)?wp-admin$ $1wp-admin/ [R=301,L]

RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]
RewriteRule  ^[_0-9a-zA-Z-]+/(wp-(content|admin|includes).*) $1 [L]
RewriteRule  ^[_0-9a-zA-Z-]+/(.*\.php)$ $1 [L]
RewriteRule . index.php [L] 
```

从 stackoverflow 的其他主题中，我发现了以下内容：

```
RewriteRule ^demo/(.*) demo.domain.com/$2/ 
```

但不幸的是，这不起作用。有谁能帮助我吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:39:00.460

将多站点 .htaccess 保留在原处，并将其放在 Web 目录根目录下的 .htaccess 中：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^demo
RewriteRule ^(.*)$ http://www.domain.com/demo/$1 
```

# c# - 无法找到之前设置的请求的 cookie

> ID：10790209
> 
> 赞同：0
> 
> 时间：2012-05-28T20:41:26.747
> 
> 标签：c#, asp.net

我正在尝试使用 ashx 文件开发一个简单的单点登录解决方案来设置/删除 cookie。.Net 4.0，C#。我正在向 ashx 资源（在不同的域 siteb.com/file.ashx 上）发出 Web 请求（来自 sitea.com/）以设置 cookie，然后我向同一个请求（来自 sitec.com/）发出另一个请求资源（在 siteb.com/file.ashx）查看是否存在相同的 cookie。不幸的是，它返回为空。当我摆弄它时，我可以看到 cookie 在这两种情况下都存在（在 siteb.com 上的请求/响应标头中）。

我不明白的是，它怎么不能通过代码获得。我尝试使用 context.Request.Cookies（上下文来自公共 void ProcessRequest(HttpContext context) 方法）、HttpContext.Current.Request.Cookies，也在 Response 上，但没有成功。

```
HttpCookie AuthCookie = context.Request.Cookies["SiteCookie"]; 
```

PS：我在各个方面都编写代码，即发出请求和检查 cookie 验证。知道可能是什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T21:00:47.153

Cookie 具有域属性，请参阅[http://msdn.microsoft.com/en-us/library/system.web.httpcookie.domain.aspx](http://msdn.microsoft.com/en-us/library/system.web.httpcookie.domain.aspx)。因此，您的 cookie 似乎是为域 siteb.com 设置的，因此对于其他域不可用。

# batch-file - 如何控制评估顺序？

> ID：10790217
> 
> 赞同：0
> 
> 时间：2012-05-28T20:42:18.663
> 
> 标签：batch-file

例如，`cd (echo ..)`在 powershell 中工作，但我如何让它批量工作（它首先评估回声，所以命令是有效的`cd ..`）？`mycommand.exe (ls -fi *.hs -exclude \"#*\" -name -r)`是我实际尝试转换的内容（它将一个完整的过滤文件列表发送到`mycommand`）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:45:47.397

```
setlocal enabledelayedexpansion
set LIST=
for /r %%F in (*.hs) do (
   set "FN=%%F"
   if not "!FN:~0,1!"=="#" set LIST=!LIST! "%%F"
)
mycommand.exe !LIST! 
```

将是一个粗略的翻译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:47:46.817

首先添加`$`符号以评估括号中的命令：

```
mycommand.exe $(ls -fi *.hs -exclude \"#*\" -name -r) 
```

或者

```
ls -fi *.hs -exclude \"#*\" -name -r | mycommand.exe 
```

如果要对从 ls 返回的每个项目执行命令，可以：

```
ls -fi *.hs -exclude \"#*\" -name -r | %{mycommand.exe $_ } 
```

# java - Java - 如何设置我的应用程序始终在主屏幕上运行，而不是在第二个屏幕上？

> ID：10790218
> 
> 赞同：2
> 
> 时间：2012-05-28T20:42:43.603
> 
> 标签：java, linux, swing, xorg

我有两个屏幕，主笔记本电脑和第二个显示器。每当我启动此应用程序时，它都会在我的第二个屏幕而不是主屏幕上运行。

我如何告诉应用程序仅在左侧的主屏幕上运行。

例子：

```
screen = Toolkit.getDefaultToolkit().getScreenSize();
GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
GraphicsDevice[] screenDevices = ge.getScreenDevices();
for (int i = 0; i < screenDevices.length; i++) {
  System.out.println(screenDevices[i].getIDstring());
  DisplayMode dm = screenDevices[i].getDisplayMode();
  int screenWidth = dm.getWidth();
  int screenHeight = dm.getHeight();
  System.out.println("[myResolution]: " + screenWidth + " " + screenHeight);
  screen.width = screenWidth;
  screen.height = screenHeight;
}

Output:
0.0
1024x768
0.1
1024x768 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:35:51.040

没有`JFrame.setLocation()`工作吗？如果您真的对屏幕很挑剔，您可以指定在哪里显示您的 JFrame： [http ://docs.oracle.com/javase/6/docs/api/java/awt/GraphicsDevice.html](http://docs.oracle.com/javase/6/docs/api/java/awt/GraphicsDevice.html)

第一段给出了一个例子如何实现你想要的

# java - Android历史堆栈清除没有一个

> ID：10790222
> 
> 赞同：1
> 
> 时间：2012-05-28T20:43:06.393
> 
> 标签：java, android, android-activity

我有一些活动喜欢

```
A-> Splash Screen
B-> Home Screen
C-> a List activity
D-> a View activty
E-> a List activity
F-> a View activty 
```

通常应用程序从 A -> B 开始

然后用户选择一个列表活动

然后用户从列表活动中选择一个视图。

我的问题是清除活动堆栈。

我的应用程序会将列表或查看活动跳转到活动（使用 facefook 样式导航）

例如，用户选择一个列表活动 C，然后选择查看活动 D。在开始点，用户可以跳转到活动 E。在活动 E 中，如果用户按下 o 后退按钮，则用户转到活动 D。

我想把它转到活动 B(Home)。

我的意思是我想在没有家庭活动的情况下清除活动状态。

我怎样才能做到这一点 ？。

抱歉英语太差了。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:07:56.207

您可以像这样拦截后退按钮按下：

```
@Override
public void onBackPressed() {
    // You want to start B Activity
    Intent a = new Intent(this, B.class);

    // But you dont want it on top of E.
    a.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);

    // Launching this will now remove every activity on top of B and bring B to front, not! relaunch it.
    startActivity(a);
} 
```

您可能想查看[Android Intent 标志](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_CLEAR_TOP)和[Tasks and Back Stack Documentation](https://developer.android.com/guide/components/tasks-and-back-stack.html)。

祝你今天过得愉快！

**编辑：**

如果您想在按下返回时关闭您的应用程序：

```
@Override
public void onBackPressed() {
    moveTaskToBack(true);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:02:08.650

如果您希望用户从您的所有活动返回到 B，您可以`finish()`在调用任何 Intent 时从所有其他活动调用。这样，它们将从活动堆栈中删除。

此外，您可以覆盖后退按钮行为：

```
@Override
public void onBackPressed() {
   Intent setIntent = new Intent(Intent.ACTION_MAIN);
   startActivity(setIntent);
} 
```

但要确保它真的是你想要的。因为看起来你在做一些对用户体验非常不利的事情。阅读有关活动堆栈和任务的更多信息。应避免覆盖后退按钮的默认行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T21:09:16.990

您可以在 AndroidManifest.xml 文件中使用标记 android:noHistory="true" 来活动元素。此标签允许不在活动堆栈中写入活动。

# jquery - jQuery 图片加载回调

> ID：10790226
> 
> 赞同：6
> 
> 时间：2012-05-28T20:43:39.393
> 
> 标签：jquery, callback, load, image

加载后动态将图像添加到页面，然后进行用户交互，并且在该图像完全加载后无法触发功能。我认为使用 jQuery 的`.load()`方法会很好.. 但根据我的控制台和一堆文档`.log`业务，它从未执行过。见下文..谢谢！

```
$('body')
    .append('<img id="ad" src="img/ad.jpg" alt="Advertising Network" />')
    .load(function(){
        console.log('ad load complete');
        $('#submit').click();
    }); 
```

* * *

更新：

澄清一下，这是在两者`document`和`window`加载之后。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-28T20:48:49.670

在您的代码`.load()`中与`body`链接有关。

将代码更改为：

```
var img = $('<img id="ad" src="img/ad.jpg" alt="Advertising Network" />');
img.load(function(){
    console.log('ad load complete');
    $('#submit').click();
});

$('body').append(img); 
```

它应该可以工作（[http://jsfiddle.net/zerkms/f7epb/](http://jsfiddle.net/zerkms/f7epb/)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:54:50.417

append 函数返回包含元素，而不是附加的元素，因此您将函数绑定到 body 的负载而不是 img。

我建议使用 appendTo，如下所示：

```
$('<img id="ad" src="img/ad.jpg" alt="Advertising Network" />')
.load(function(){
    console.log('ad load complete');
    $('#submit').click();
})
.appendTo($('body')); 
```

# debugging - Codelite 调试器错误：无法找到 gdb！在'gdb'？

> ID：10790231
> 
> 赞同：2
> 
> 时间：2012-05-28T20:44:49.937
> 
> 标签：debugging, compiler-construction, gdb, codelite

我正在尝试使用 Codelite 来尝试编译我使用 DevCpp 编写的一些 c++ 项目。我对编译器和调试器了解不多。每次我尝试在 Codelite 中编译和调试任何代码时，我都会收到此错误消息：

找不到 gdb！在“gdb”

我尝试弄乱调试器设置，但没有任何效果。在构建窗口中它说：

“mingw32-make.exe”不是内部或外部命令、可运行程序或批处理文件。

再说一次，我真的不知道那是什么意思。有人愿意分享解决这个问题的方法吗？如果可能的话，给我一个关于这些编译器和调试器之间区别的快速解释？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T15:20:47.420

我弄清楚出了什么问题..我没有安装完整的软件包。我只安装了 IDE codelite，但没有安装调试器文件

[http://sourceforge.net/projects/codelite/files/Releases/codelite-3.5/](http://sourceforge.net/projects/codelite/files/Releases/codelite-3.5/)

在这个链接中，dl 包：codelite-3.5.5377-mingw4.6.1-wx2.9.2.exe

对于整个调试器/编译器/ide/等，你的代码应该编译..至少我的做到了:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-07-22T19:43:30.630

您必须按照以下步骤操作：

打开 Codelite 并转到：

设置 -> 构建设置 -> 编译器 -> 工具 -> Gbd

在这种情况下，“Gdb”栏应该是空的，您必须查找“gdb32.exe”文件。

就像在这个网站的图片中一样： [构建设置图片](https://i.stack.imgur.com/WAH5Z.jpg)

您必须在以下地址中找到该文件：

C:/程序文件 (x86)/CodeBlocks/MinGW/bin

文件：gdb32.exe

# git - 挂在“POST git-receive-pack (chunked)”

> ID：10790232
> 
> 赞同：69
> 
> 时间：2012-05-28T20:44:51.007
> 
> 标签：git, version-control, bitbucket

老实说，我对 git 的内部结构知之甚少。

我已经上演并提交了一个 40mb 的目录，但是当我来推...

```
$ git push --verbose --progress
Pushing to https://acron0@bitbucket.org/acron0/project.git
Password for 'https://acron0@bitbucket.org':
POST git-receive-pack (chunked) 
```

就这样持续了20分钟。我假设它挂了，但是……我能做些什么来找出原因吗？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2013-01-30T00:10:42.637

这是 Git 中的一个错误；使用 HTTPS 时，它将使用分块编码来上传超过一定大小的内容。那些不起作用。

一个简单的解决方法是告诉 git 在一些可笑的大尺寸值之前不要分块，例如：

```
git config http.postBuffer 524288000 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-05-28T21:09:45.550

可能是你的凭据。使用 git+ssh 协议而不是 https。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-02-13T09:08:40.923

使用 SourceTree 推送到 BitBucket 我每隔几个月就会收到一次此错误。事实证明，我只需要多等五分钟，它就会自行解决。看起来它已经挂了，诱惑是取消并再试一次，但可能会挂在那里更长时间。我知道这已经得到了回答，但我的提交量可能只有几百 kb，而不是原始发帖人所说的 40mb。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-24T21:22:30.910

使用 Git 2.13（2017 年第二季度），您将能够设置`http.postBuffer`一个非常大的数字（即，比`ulong`某些平台上的更大）。

请参阅[David Turner (](https://github.com/csusbdt) [)的](https://github.com/csusbdt)[提交 37ee680](https://github.com/git/git/commit/37ee680d9b90fe4c4fc5be4e14f17baf49f6ce59)（2017 年 4 月 11 日） 。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 4c01f67](https://github.com/git/git/commit/4c01f67d9102942cc7f0a737de4c609a6ac1832e))^(中，2017 年 4 月 24 日）)[`csusbdt`](https://github.com/csusbdt)
^([`gitster`](https://github.com/gitster))

> ## `http.postbuffer`: 允许全范围的`ssize_t`值

> 不幸的是，为了推送一些服务器不支持分块编码的大型存储库，`http postbuffer`有时必须超过 2 GB。
> 在 64 位系统上，这没问题：我们只是 malloc 一个更大的缓冲区。
> 
> 这意味着我们需要使用 CURLOPT_POSTFIELDSIZE_LARGE 来设置缓冲区大小。

* * *

因此，Git 2.34（2021 年第四季度）放弃了对 cURL 库的旧版本（7.19.4 之前）的支持：

请参阅[Jeff King (](https://github.com/peff) [)的](https://github.com/peff)[提交 644de29](https://github.com/git/git/commit/644de29e220de7441e51a29bf512278b3de0bbe1)、[提交 013c7e2](https://github.com/git/git/commit/013c7e2b070f5b69d6585b0c18426a959f1bf739)、[提交 1119a15](https://github.com/git/git/commit/1119a15b5c8521e75c412a129cd6318285cac773)（2021 年 7 月 30 日） 。 请参阅[Ævar Arnfjörð Bjarmason ( ) 的](https://github.com/avar)[提交 8dda4cb](https://github.com/git/git/commit/8dda4cbdf258be05e7201ef5d6e9d532cacb9178)和[提交 5db9d38](https://github.com/git/git/commit/5db9d383590c37272a9f16464a66dfbd3a3c8aff)（2021 年 7 月 30 日[）](https://github.com/avar)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 e48a623](https://github.com/git/git/commit/e48a623dea0c9170e4daa5e27e5bbc3f1ce84354))^(中，2021 年 8 月 24 日）)[`peff`](https://github.com/peff)
[`avar`](https://github.com/avar)
^([`gitster`](https://github.com/gitster))

> ## [`http`](https://github.com/git/git/commit/1119a15b5c8521e75c412a129cd6318285cac773): 放弃对 curl < 7.11.1 的支持
> 
> ^(签字人：Jeff King)
> ^(签字人：Ævar Arnfjörð Bjarmason)

> 放弃对这个古老版本的 curl 的支持，并通过让我们摆脱一些“#ifdef”来简化代码。
> 
> 由于我们`CURLOPT_POSTFIELDSIZE`在[37ee680](https://github.com/git/git/commit/37ee680d9b90fe4c4fc5be4e14f17baf49f6ce59)中使用（“ `http.postbuffer`：允许全范围`ssize_t`值”，2017-04-11，Git v2.13.0-rc1 -- [merge](https://github.com/git/git/commit/4c01f67d9102942cc7f0a737de4c609a6ac1832e)），Git 不会使用 7.11.1 之前的 vanilla curl 构建。
> 此字段是在 curl 7.11.1 中引入的。
> 
> 我们可以用 more 来解决这些编译问题`#ifdefs`，但这不值得。
> 7.11.1 版于 2004 年 3 月发布，距今已有 17 年之久。
> 让我们声明它太旧并丢弃任何更早的存在`ifdefs`。
> 一个明显的好处是我们将有更少的条件位使代码混乱。
> 
> 此补丁删除了所有`#ifdefs`引用旧版本的内容（请注意，curl 的预处理器宏是十六进制的，所以我们正在寻找 070b01，而不是 071101）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-24T15:35:05.250

如果您发现该站点是因为 BitBucket 失败并显示该错误消息，请查看此站点的答案：

*   [如何将 git 扩展与 bitbucket 存储库一起使用？](https://stackoverflow.com/questions/7053608/how-to-use-git-extension-with-bitbucket-repository)

特别是[Nicholas Pickering](https://stackoverflow.com/users/1270996/nicholas-pickering)和[Simon Tewsi](https://stackoverflow.com/users/216440/simon-tewsi)关于需要将密钥的哪一部分粘贴到 BitBucket 对话框中的评论。

# python - 无法导入 Matplotlib python 2.7 windows 7

> ID：10790233
> 
> 赞同：0
> 
> 时间：2012-05-28T20:44:52.357
> 
> 标签：python, matplotlib

我无法导入 matplotlib

我可以通过命令提示符（python解释器）导入它但是当我在一个只有一行的程序中使用它时，`import matplotlib as plt` 我得到了这些错误

```
Traceback (most recent call last):
  File "D:\python\gis\test.py", line 1, in <module>
    import matplotlib as plt
  File "C:\Python27\lib\site-packages\matplotlib\__init__.py", line 133, in <module>
    from matplotlib.rcsetup import (defaultParams,
  File "C:\Python27\lib\site-packages\matplotlib\rcsetup.py", line 19, in <module>
    from matplotlib.colors import is_color_like
  File "C:\Python27\lib\site-packages\matplotlib\colors.py", line 54, in <module>
    import matplotlib.cbook as cbook
  File "C:\Python27\lib\site-packages\matplotlib\cbook.py", line 15, in <module>
    import new
  File "D:\python\gis\new.py", line 27, in <module>
    nx.draw(G, pos=pos)
  File "C:\Python27\lib\site-packages\networkx-1.7.dev_20120522142611-py2.7.egg\networkx\drawing\nx_pylab.py", line 114, in draw
    raise ImportError("Matplotlib required for draw()")
ImportError: Matplotlib required for draw() 
```

我检查了它只包含 C:/python27 的路径，但不包含其他 python 目录 伙计们请帮帮我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:13:22.000

该`D:\python\gis\new.py`模块正在遮蔽 Python 标准库[新](http://docs.python.org/library/new.html)模块。尝试重命名您的`new`模块。

# rest - 聊天与 REST 和 PubNub 推送架构

> ID：10790234
> 
> 赞同：0
> 
> 时间：2012-05-28T20:45:15.557
> 
> 标签：rest, web, push-notification, pubnub

我的聊天应用程序的主要用例是一位代理通常会与一位客人交谈。最多我计划支持低个位数的客人和代理，但使用这样的功能会非常少。更重要的是，发送者不需要接收他们自己的消息，因为 HTTP 状态会确认收到消息。

我正在考虑将 PubNub 用于“仅推送”。因此，每个客户端将通过 HTTP (PUT/POST) 向应用程序 Web 服务器发送消息，并且仅通过其自己的 PubNub 订阅通道接收消息。

当 Web 服务器应用程序接收到 HTTP 聊天消息时，它会映射消息发送到的*客户端*并将消息发布到这些*特定客户端的通道*。所以一个循环调用`PubNub.publish(client_channel_id, the_message)`.

这样，每个客户端必须只订阅一个通道而不是多个通道，并且每个客户端只接收为其指定的消息（即没有全局通道，也没有客户端过滤）。

（我也在考虑使用 Redis 来保存哪些客户端在哪些房间聊天的地图。因此，每次 Web 应用程序收到聊天消息时，它*可能*（使用本地缓存）必须首先签入 Redis 以映射消息的目的地渠道...）

### 潜在问题

*   在服务器范围内使用单个 PubNub 连接可能无法很好地扩展。连接池可能会更好。由于我们只是广播这些连接而不是订阅，所以它应该很简单，对吧？

你能看到这个设计的任何其他潜在问题吗？其他的建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T03:37:53.660

您在此处描述的方法非常适合安全地创建聊天应用程序。我建议为每个用户会话创建一个随机生成的通道，以提供额外的安全性，而不是使用诸如**user_id_1234 之**类的通道。每次用户登录时，都会生成一个新的频道名称，例如：**YTM0NZomIzI2OTsmIzM0NTueYQ**，并让经过身份验证的用户连接到该频道。因此，在 Redis 中，您将拥有一个与用户对象关联的简单键/值。可能是一个带有关键字段**pubnub_channel**的 HKEY，它会更新每个新的会话 ID。 [http://redis.io/commands/hset](http://redis.io/commands/hset)

# iis - Web Config 中的 IIS 7.5 压缩

> ID：10790239
> 
> 赞同：2
> 
> 时间：2012-05-28T20:45:38.087
> 
> 标签：iis, compression, iis-7.5, http-compression

可以在 web 配置中指定 http 压缩的哪些方面。

我已经通过更改 iis 的 applicationHost 文件来进行动态压缩，但我想在应用程序的 web 配置中尽可能多地进行配置。

我没有成功在 applicationHost 文件之外执行此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T22:30:02.627

可以为每个网站启用或禁用动态和静态内容的压缩，但技术参数如最小文件大小（压缩文件之前）、缓存压缩文件的目录位置以及每个应用程序的压缩缓存大小池只能在服务器级别配置（因此在 applicationHost.config 中）。

# ruby-on-rails - rails 3 模块化应用

> ID：10790240
> 
> 赞同：1
> 
> 时间：2012-05-28T20:45:42.293
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我想创建一个 rails 3 项目，它将作为我未来所有应用程序的骨架。这个框架将提供我更快开始新项目所需的一切（角色、成员、权限、身份验证）。

如果我可以将所有这些功能作为一个单独的应用程序包装在我的项目中，那就太好了，让我们说一个包含所有控制器模型和东西的“骨架”文件夹。如果我需要建立一个博客，我只需在与我的骨架应用程序相同的目录中创建一个“博客”文件夹，其中包含控制器、模型等。博客仍然能够与骨架通信并查询其模型，就像在任何真正的模块化应用程序中一样.

这可能吗？暂时没找到素材，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T20:57:05.950

看看[应用程序模板](http://guides.rubyonrails.org/generators.html#application-templates)和[Rails 引擎](http://api.rubyonrails.org/classes/Rails/Engine.html)。

# java - 如何使用 JQuery 在 JSF 页面中创建进度条

> ID：10790243
> 
> 赞同：0
> 
> 时间：2012-05-28T20:45:49.203
> 
> 标签：java, javascript, jsf, jsf-2

我想在 JSF 页面中创建进度条原型。此代码用于创建简单的 html 进度条：

```
 <script type="text/javascript">
            $(function(){
                // Progressbar
                $("#progressbar").progressbar({
                    value: 50
                });                         
            });

           </script>

                <!-- Progressbar -->
            <h2 class="demoHeaders">Progressbar</h2>    
            <div id="progressbar"></div> 
```

此代码可视化简单的进度条。一个backing bean 将`for`循环并返回进度条完成任务的百分比。我最大的谜团是如何将已完成任务的值从 Java 方法传递回 JS 代码？以及如何在每次`for`增加值时自动进行 AJAX 调用？

# wcf - 将服务引用添加到类型为 ObservableCollection 的 WCF 服务时出错

> ID：10790248
> 
> 赞同：4
> 
> 时间：2012-05-28T20:46:18.180
> 
> 标签：wcf, xamarin.ios

尝试向现有 WCF 服务（提供类型集合`ObservableCollection`）添加服务引用时，我收到以下错误消息：

> 尚未导入架构类型“http://schemas.microsoft.com/2003/10/Serialization/Arrays:ArrayOfString”。先导入。

我尝试将框架（在“添加 Web 引用”屏幕中）更改为“.NET 2.0 Web 服务”。在这种情况下，我没有收到上述错误消息，但是，我无法调用 WCF 服务提供的几个函数（它们根本没有生成）。

有谁能够帮我？

提前致谢。

恩斯特詹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T11:19:16.840

Microsoft 在 'http://schemas.microsoft.com/2003/10/Serialization/Arrays' 名称空间中定义数组，非 MS 会遇到问题，因此请定义您的“ArrayOfString”并对其进行序列化：

```
[CollectionDataContract(ItemName = "string", Namespace = "SAME NAMESPACE AS YOUR PROJECT!!!")]

public class ArrayOfString : List<string>

{

} 
```

那你应该没事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:22:14.123

这是 Mono 的 WSDL Importer 中的一个错误，它不完全支持集合类型。

我刚刚实现了这个，所以你很快就会在 Monotouch 中看到它。作为临时解决方法，您需要在 Windows 上使用 Visual Studio 或`Svcutil.exe`.

# java - 将触摸事件添加到 Android 应用程序

> ID：10790249
> 
> 赞同：-2
> 
> 时间：2012-05-28T20:46:28.860
> 
> 标签：java, android, touch

我做了一个简单的安卓程序。

它的作用：在启动时它显示一个文本和一个按钮。按钮上有一个数字，每次触摸都会增加。在 2 到 10 之间的按钮上的随机数字处，会显示一张图片 + 一个声音剪辑。

这就是它的作用。所以当它显示图片时，应用程序就完成了。

我现在要做的是创建一个触摸功能，将我引导回应用程序启动页面。为此，我需要你的帮助。我曾尝试在互联网上搜索解决方案，但由于我是初学者，因此我不知道如何在我的代码中实现它。

这是我的代码：

```
package net.ibasic;

import android.app.Activity;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.TextView;

public class HelloAndroidActivity extends Activity implements OnClickListener {
private int i = 0;
public int low = 2;
public int high = 10;
public int num = low + (int) ( Math.random()*(high -low) + 0.5 );
MediaPlayer mpAudio;
MediaPlayer mpAudio1;
/** Called when the activity is first created. */ 
@Override

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    //setContentView(R.layout.main);
    //creating the setContentView by java-code instead of Xml
    LinearLayout linearLayout = new LinearLayout(this);
    linearLayout.setOrientation(LinearLayout.VERTICAL);

    TextView textView = new TextView(this);
    textView.setText(R.string.hello);

    linearLayout.addView(textView);

    //creating a button for the app
    Button button = new Button(this);
    linearLayout.addView(button);

    setContentView(linearLayout);
    update(button);

    //adding buttonListener
    button.setOnClickListener(this);
    mpAudio = MediaPlayer.create(this, R.raw.kitten);
    mpAudio1 = MediaPlayer.create(this, R.raw.scary);
}

private void update(Button button) {
    button.setText("Amount of Clicks " + i++);

}

public void onClick(View button) {
    update((Button)button);

    if (i==num){

        LinearLayout linearLayout = new LinearLayout(this);
        linearLayout.setOrientation(LinearLayout.VERTICAL);

        if (num % 2 == 0){
        mpAudio.start();
        ImageView imageView = new ImageView(this);
        imageView.setImageResource(R.drawable.kitten);

        TextView textView1 = new TextView(this);
        textView1.setText(R.string.kittentext);
        linearLayout.addView(textView1);
        linearLayout.addView(imageView);

        }
        else{
            mpAudio1.start();
            ImageView imageView = new ImageView(this);
            imageView.setImageResource(R.drawable.scary);

            TextView textView1 = new TextView(this);
            textView1.setText(R.string.scarytext);
            linearLayout.addView(textView1);
            linearLayout.addView(imageView);

        }

        setContentView(linearLayout);
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:01:29.390

完成后，使用以下代码重新启动您的活动：

```
Intent intent = getIntent();
finish();
startActivity(intent); // 
```

[参考](https://stackoverflow.com/questions/1397361/how-do-i-restart-an-android-activity)

* * *

您可以通过单击按钮执行此操作/也可以使用`performClick()`按钮对象上的方法或任何时候自动单击按钮。

# ipad - 在 uipopover 中加载 uiwebview

> ID：10790254
> 
> 赞同：0
> 
> 时间：2012-05-28T20:47:11.423
> 
> 标签：ipad, uiwebview, uipopovercontroller

在我的应用程序中，每次用户点击一个 url 时，都会弹出一个 uipopover 来显示该网站。问题是弹出框只有 320x480，但 uiwebview 与 iPad 视图一样大。

如何使 uiwebview 以较小的视图加载网站。

谢谢。这是我的代码的一部分：

```
- (IBAction)openWeb:(id)sender{
    ShowWebOnBrowserViewController *swobvc = [self.storyboard instantiateViewControllerWithIdentifier:@"WebView"];
    swobvc.title = self.companyName.text;
    swobvc.companyWebURL = self.web.titleLabel.text;

swobvc.companyWebView.scalesPageToFit = YES;
swobvc.companyWebView.scrollView.contentSize = CGSizeMake(320,480);
swobvc.companyWebView.scrollView.frame = CGRectMake(0, 0, 320, 480);
swobvc.companyWebView.frame = CGRectMake(0, 0, 320, 480);

    popOverController = [[UIPopoverController alloc] initWithContentViewController:swobvc];

    popOverController.popoverContentSize = CGSizeMake(320, 480);
    [popOverController presentPopoverFromRect:[((UIButton*)sender) bounds] inView:self.view permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];
}

//in popover class
-(IBAction)loadURL:(id)sender
{    
    NSString* webText = self.companyWebURL;
    webText = [webText stringByAddingPercentEscapesUsingEncoding: NSUTF8StringEncoding];
    NSURL *webURL = [NSURL URLWithString:webText];
    NSURLRequest *requestObj = [NSURLRequest requestWithURL:webURL];
    [self.companyWebView loadRequest:requestObj];
    self.companyWebView.scalesPageToFit = YES;

} 
```

![在此处输入图像描述](../Images/27603fe7a356dd87e7caa0ac90891d37.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:08:50.753

在 openWeb 方法中，在显示 popOver 之前设置 companyWebView 的框架。此外，确保 scalesPageToFit 也设置为 YES（默认为 NO）。

```
//...cut...
popOverController.companyWebView.scalesPageToFit = YES;

popOverController.companyWebView.scrollView.contentSize = CGSizeMake(320,480);

popOverController.companyWebView.frame = CGRectMake(popOverController.companyWebView.frame.origin.x, popOverController.companyWebView.frame.origin.y, 320, 480);
//...cut... 
```

您对网站内容有控制权吗？尝试添加一个元标记来设置视口，例如：

# c - 访问套接字的文件描述符

> ID：10790258
> 
> 赞同：1
> 
> 时间：2012-05-28T20:47:37.117
> 
> 标签：c, sockets

这是 .c 文件的一部分，该文件包含在每个线程有一个客户端的 tcp 服务器-客户端消息服务中；我想在服务器线程中使用 select 来处理新的传入连接或写入缓冲区的数据，但我遇到的问题是我需要套接字文件描述符来执行客户端和服务器的操作。

在这部分代码中，服务器的套接字描述符位于 s->sd 内部，但我似乎可以在此函数之外访问它，因为它返回（套接字）。

我能做些什么？（为了便于阅读，省略了大部分代码）

```
#include <sys/types.h>
#include <sys/socket.h>
#include <arpa/inet.h>

typedef struct {
  int sd; //id of the socket??
  char *ip_addr;
  int port;   
  } MySocket;   

Socket tcp_passive_open(int port) 
{                                                                                      
  MySocket *s = (MySocket *)malloc( sizeof(MySocket) );
  struct sockaddr_in addr;
  s->sd = socket(PROTOCOLFAMILY, TYPE, PROTOCOL);

  memset(&addr, 0, sizeof(struct sockaddr_in));
  addr.sin_family = PROTOCOLFAMILY;
  addr.sin_addr.s_addr = htonl(INADDR_ANY);
  addr.sin_port = htons(port);

  if ( bind(s->sd, (struct sockaddr *)&addr, sizeof(addr)) != 0 ) {
    die("tcp_open_server failed(): bind() failed"); 
  }

  s->port = port;
  s->ip_addr = NULL;  //INADDR_ANY ...  
  return (Socket)s;  
} 
```

主要的：

```
Socket server = tcp_passive_open( PORT );
FD_SET(SOCKETDESCRIPTOR_SERVER??,&master_socketDescriptors); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:40:54.510

`MySocket::sd`是您需要与 . 一起使用的描述符`select()`。`socket()`和返回`accept()`可以与 . 一起使用的套接字描述符`select()`。更改`tcp_passive_open()`为返回 a`MySocket*`而不是 a `Socket`，然后您的主服务器线程将有权访问服务器的套接字描述符以传递`select()`给以检测传入连接，例如：

```
#include <sys/types.h>
#include <sys/socket.h>
#include <arpa/inet.h>

typedef struct {
    int sd;
    char *ip_addr;
    int port;
} MySocket;

MySocket* tcp_passive_open(int port) {
    MySocket *s = (MySocket *)malloc( sizeof(MySocket) );
    if ( s == NULL ) {
        die("tcp_open_server failed(): malloc() failed");
    }

    s->sd = socket(PROTOCOLFAMILY, TYPE, PROTOCOL);
    if ( s->sd == -1 ) {
        die("tcp_open_server failed(): socket() failed");
    }

    struct sockaddr_in addr;
    memset(&addr, 0, sizeof(struct sockaddr_in));
    addr.sin_family = PROTOCOLFAMILY;
    addr.sin_addr.s_addr = htonl(INADDR_ANY);
    addr.sin_port = htons(port);

    if ( bind(s->sd, (struct sockaddr *)&addr, sizeof(addr)) != 0 ) {
        die("tcp_open_server failed(): bind() failed");
    }

    s->port = port;
    s->ip_addr = NULL;  //INADDR_ANY ...
    return s;
} 
```

.

```
MySocket* server = tcp_passive_open( PORT );
FD_SET(server->sd, &master_socketDescriptors); 
```

之后，当`select()`在服务器套接字上报告一个未决的入站连接连接时，调用`accept()`接受连接并获取其套接字描述符，然后您可以为其分配一个单独`MySocket`的：

```
int sd = accept(server->sd, ...);
if ( sd != -1 ) {
    MySocket *client = (MySocket*) malloc(sizeof(MySocket));
    client->sd = sd;
    ...
} 
```

然后您可以为此创建一个新线程`MySocket`，并且该线程可以根据需要调用`select()`以检测该连接上的入站数据。

# jquery - 验证十进制数

> ID：10790261
> 
> 赞同：11
> 
> 时间：2012-05-28T20:47:46.540
> 
> 标签：jquery, jquery-validate

我有一个表单，我正在使用 jQuery 验证插件来验证它。现在我正在尝试验证十进制数字输入。

我已经尝试了以下代码，但它不起作用。是正则表达式的问题还是我的代码中编写自定义规则的方式有问题？

```
 rules: {
      paid_amount: {
              required:true,
                      rexp: ^[1-9]\d*(\.\d+)?$
      },

   }
     },

 messages: {
             paid_amount: {
                      required: "Enter Paid Amount",
              rexp:"Decimal Numbers Only"
    },  

     }
}); 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-28T20:58:25.800

您可以使用[此处找到的号码验证方法](http://docs.jquery.com/Plugins/Validation/Methods/number)

从文档：

```
$("#myform").validate({
  rules: {
    field: {
      required: true,
      number: true
    }
  }
}); 
```

在你的情况下：

```
rules: {
    paid_amount: {
        required:true,
        number: true
    }
},
messages: {
    paid_amount: {
        required: "Enter Paid Amount",
        number: "Decimal Numbers Only"
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T20:58:56.377

我不熟悉 jquery 验证器插件，对不起，但你的正则表达式是有效的。

另一种方法是

```
var reg = "/^[1-9]\d*(\.\d+)?$/"; //reg pattern<br/>
if(reg.test("1.23"))//validate
{
 //do something <br/>
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-07T11:03:48.767

jQuery 验证器还支持使用范围方法进行十进制验证。

```
factor:
      {
        required: true,
        range:[0.08,20.09]  
      }, 
```

在此处阅读更多内容并在[此处](http://jqueryvalidation.org/range-method/)进行[演示](http://codepen.io/prasanthmj/pen/lvKoG)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T20:57:14.093

使用 jQuery isNumeric 函数：[http ://api.jquery.com/jQuery.isNumeric/](http://api.jquery.com/jQuery.isNumeric/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-24T01:58:43.680

您的问题出在“rexg”方法上。你应该使用“模式”。例子：

```
paid_amount: {
     required:true,
     pattern: ^[1-9]\d*(\.\d+)?$
} 
```

# asynchronous - HttpClient SendAsync 线程回调在解析响应之前死亡

> ID：10790264
> 
> 赞同：0
> 
> 时间：2012-05-28T20:48:05.003
> 
> 标签：asynchronous, java-metro-framework, dotnet-httpclient

我正在测试 httpClient sendAsync 方法。同步调用它工作正常。但是，当我尝试执行异步 http 请求时，任务在我处理消息之前终止。任何机构遇到这个问题？

这个同步调用有效

```
HttpRequestMessage httprequest = new HttpRequestMessage(httpmethod, "http://www.google.ca");
var result =   _httpClient.SendAsync(httprequest, HttpCompletionOption.ResponseContentRead, cancellationToken);
HttpResponseMessage response = result.Result; 
```

但是异步调用不起作用。当我尝试解析响应时，线程死了。

```
HttpRequestMessage httprequest = new HttpRequestMessage(httpmethod, "http://www.google.ca");
var result =   await _httpClient.SendAsync(httprequest, HttpCompletionOption.ResponseContentRead, cancellationToken);
HttpResponseMessage response = result; 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:40:57.390

如果您使用的是 VS11 Beta，请确保您的单元测试返回`Task`.`void`

如果您使用的是 VS2010 或 VS11 Dev Preview，那么您可以使用我的[Async Unit Tests](http://asyncunittests.codeplex.com/)项目。

完整的详细信息[在我的博客上](http://nitoprograms.blogspot.com/2012/02/async-unit-tests-part-1-wrong-way.html)，但归结为：

*   `async`当它必须异步等待时将返回。
*   在单元测试中，它返回到测试运行器，它会看到测试完成。

# java - 如何将对象作为可比参数发送到方法？

> ID：10790265
> 
> 赞同：0
> 
> 时间：2012-05-28T20:48:17.380
> 
> 标签：java, generics, object, casting, comparable

我有这个提供的功能，我想使用：

```
boolean check(Comparable<Object> obj1, Comparable<Object> obj2) {
   // do something
} 
```

我有：

```
Object obj1,obj2; 
```

我想发送到方法检查，如何将两个对象转换或转换为 Comparables ？

我希望我清楚，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T20:51:28.450

如你所说：

```
check((Comparable<Object>) obj1, (Comparable<Object>) obj2); 
```

也就是说，我不知道有任何类实现`Comparable<Object>`. 该方法可能应该`Comparable<?>`作为参数而不是`Comparable<Object>`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T20:50:37.373

好吧，如果你的两个对象引用真正指向 Comparable 对象，你可以简单地做

```
check((Comparable<Object>) obj1, (Comparable<Object>) obj2); 
```

**-编辑-**

当然这会产生一个警告，你基本上是在告诉编译器你知道得更好。`obj`编译器警告您，如果就其泛型类型参数而言不是您所说的那样，您可能会出错。你可以告诉你的编译器闭嘴，你真的非常确定，使用注释：

```
@SuppressWarnings("unchecked")
Comparable<Object> cmp1 = (Comparable<Object>) obj;
@SuppressWarnings("unchecked")
Comparable<Object> cmp2 = (Comparable<Object>) obj;     
check(cmp1,cmp2); 
```

当您使用`@SupressWarning`注释时，您通常会添加一条注释，说明您为什么如此肯定地确定不安全的强制转换总是会成功。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-28T20:50:45.473

不要使用

```
Object obj1, obj2; 
```

反而

```
Comparable obj1, obj2; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T21:11:27.700

您要发送到此方法的对象必须是`Comparable`. 所以他们必须实现`Comparable`接口。

```
Comparable obj1 = new Comparable() {
    // ... realize compare method
} 
```

然后您可以将此对象发送到您的函数。

如果您有自己的类以这种方式实现接口：

```
public class MyClass implements Comparable {
    // realize compare method
} 
```

# css - 创建一个带箭头的盒子 CSS3 问题

> ID：10790268
> 
> 赞同：1
> 
> 时间：2012-05-28T20:48:34.573
> 
> 标签：css, shapes, css-shapes

我正在尝试在`10px by 10px`气泡的右侧创建一个箭头，但我看不到它。到目前为止，我有：

**CSS：**

```
.pageHelp{
    float:right;
    margin:10px 20px 0 0;
    width:85px;
    height:25px;
    background-color:#354E69;
    border-radius:3px;
}
.pageHelp:before{
    content:"";
    position:absolute;
    right:100%;
    top:26px;
    width:0;
    height:0;
    border-top:13px solid transparent;
    border-right:26px solid #354E69;
    border-top:13px solid transparent;
} 
```

**HTML：**

```
<div class="pageHelp"><p>In Page Help</p></div> 
```

**路易斯：**

```
.pageHelp{
    float:right;
    margin:10px 20px 0 0;
    width:85px;
    height:25px;
    background-color:#354E69;
    border-radius:3px;
    position: relative;
}
.pageHelp:after, .pageHelp:before {
    left: 100%;
    border: solid transparent;
    content: " ";
    height: 0;
    width: 0;
    position: absolute;
    pointer-events: none;
}
.pageHelp:after {
    border-left-color: #354E69;
    border-width: 10px;
    top: 50%;
    margin-top: -10px;
}
.pageHelp:before {
    border-left-color: ##354E69;
    border-width: 16px;
    top: 50%;
    margin-top: -16px;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T21:40:19.783

您可以尝试使用这个友好的[css-arrow-maker-help](http://cssarrowplease.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T21:01:19.950

您需要指定

```
position: relative; 
```

在你的`.pageHelp`课上；否则，内容`position: absolute`上的`:before`不会引用它。

您还`border-top`指定了两次；我认为其中之一应该是`border-bottom`。

如果你修复了这两个，那么你至少应该能够看到 div 旁边的三角形。

在这里工作样机：http: [//jsfiddle.net/Nzazm/](http://jsfiddle.net/Nzazm/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T21:03:34.107

也许这可以帮助：http: [//jsfiddle.net/EkaMc/](http://jsfiddle.net/EkaMc/)

第一件事是`position:relative`添加`.pageHelp`

```
.pageHelp{
    [...]
    position:relative;
} 
```

这将有助于*相*对于气泡定位箭头。

那么对于你的伪元素，我建议你从使用`content:" "`. 我在尝试设计没有任何内容的伪元素时运气不佳，我不确定为什么。也许更有经验的用户可以帮助澄清。

```
.pageHelp:before{
    [...]
    content:" ";
} 
```

设置箭头的样式`right:100%`会将其撞到气泡的左端。另外，如果您不设置`position:relative;`，您的箭头将被强制退出页面。

```
.pageHelp:before{
    content:" ";
    position:absolute;
    right:-23px;
    top:6px;
    width:0;
    height:0;
    border-top:7px solid transparent;
    border-left:13px solid #354E69;
    border-bottom:7px solid transparent;
    border-right:13px solid transparent;
}​ 
```

您可以玩转边框大小，看看什么适合您。

# facebook-like - Facebook 应用程序：“如何为点赞按钮添加应用程序页面描述

> ID：10790273
> 
> 赞同：1
> 
> 时间：2012-05-28T20:49:00.410
> 
> 标签：facebook-like

我有一个 Facebook 应用程序，其中嵌入了一个赞按钮。现在，当用户单击“喜欢”时，它会显示在他们的时间轴右侧。问题是只显示我的应用程序的标题和图像。我如何添加/显示描述？也许是like按钮的属性？我的喜欢按钮如下：

```
<script src="http://connect.facebook.net/en_US/all.js#appId=353195451398908&amp;xfbml=1">  
</script><fb:like href="http://apps.facebook.com/e-phoneapp" layout="button_count" 
width="90" height="24px" show_faces="false" action="like" font="lucida grande"></fb:like> 
```

谢谢

# ruby-on-rails - ruby on rails 中的“错误 URI（绝对但没有路径）：http://”错误是什么意思，我该如何防止它？

> ID：10790278
> 
> 赞同：0
> 
> 时间：2012-05-28T20:49:28.213
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rubygems, ruby-on-rails-3.2

**我收到以下错误：**

```
bad URI(absolute but no path): http:// 
```

**从视图：**

```
= get_video(micropost.link) if micropost.link 
```

**辅助方法：**

```
 def get_video(url)
    OpenGraph.fetch(url)
 end 
```

但是，如果我从数据库中手动放置完全相同的 URL/链接（http://www.youtube.com/watch?v=1OLz4sr971w）代替“micropost.link”，在我看来没有错误。

我不知道问题可能是什么，以及存储在我的数据库中的字符串与复制和粘贴的字符串有何不同，但我确信问题非常简单，所以我期待解决方案谢谢。

亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:51:33.297

```
OpenGraph.fetch(url) 
  calls -> RestClient.get(uri).body 
```

RestClient 反过来又需要一个完整的 uri，包括协议，例如 http:// 所以你需要确保你传递的是一个 url 而不仅仅是一个绝对路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T07:07:13.857

这解决了我的问题。我忽略了这样一个事实，即我的数据库中有没有视频链接的行，所以我应该检查是否存在空白，而不是检查链接是否存在。

```
= get_video(micropost.link) unless micropost.link.blank? 
```

# grails - 使用 GORM 对集合执行脏检查

> ID：10790279
> 
> 赞同：0
> 
> 时间：2012-05-28T20:49:37.440
> 
> 标签：grails, grails-orm

我试图以一种可以触发创建新对象的方式检测对集合的更改。例如，一个库存有许多项目。一个项目有一个名称和一个数量。我能够使用脏检查从项目中检测到添加/删除。

```
//Detecting add/change
inventoryInstance.items.isDirty() 
```

我很难识别关联项目对象（名称、数量）的更改以及项目的订单更改。isDirty() 似乎无法识别这些更改。我正在使用 Grails 1.3.7，并且我正在通过 HTML 表单和索引字段名称（items[0].name、items[0].quantity）使用 grails 数据绑定。有没有人有建议的解决方案或替代方法？

示例域类：

```
class Inventory {
  List items = new ArrayList()

  static hasMany = [items:Item]
  static constraints = {
    items(size:0..10)
  }
  static mapping = {
    items cascade: 'all-delete-orphan'
  }
}

class Item {
  String name
  Integer quantity = 1
  Boolean deleted = false

  static transients = ['deleted']
  static belongsTo = Inventory
  static constraints = {
    name blank:false
    quantity size:1..100
  }
} 
```

控制器

```
def inventoryInstance = Inventory.get(params.id)

if( inventoryInstance ) {
  inventoryInstance.properties = params

  // Check for add/removes, this works.
  def isDirty = inventoryInstance.items.isDirty()

  if(!isDirty) {
    // Check items in list for changes, does not work..
    inventoryInstance.items.each { item ->
      if(item.dirtyPropertyNames) isDirty = true
    }
  }

  if(isDirty) {
    //do something...
  }

  inventoryInstance.save(flush:true)
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T01:54:26.923

这是我的代码，其功能类似于您所要求的：

```
 def taskChanges = []
        requestInstance?.tasks?.each { task ->
            taskChanges << [task,
                    task?.dirtyPropertyNames?.collect {name ->
                        def originalValue = task.getPersistentValue(name)
                        def newValue = task."$name"
                        log.debug "$name : old:: $originalValue , new:: $newValue ."
                        [(name): [originalValue: originalValue, newValue: newValue]] //returned and added to taskChanges list
                    }
            ]
        } 
```

# qt - QML 共享状态和转换

> ID：10790280
> 
> 赞同：0
> 
> 时间：2012-05-28T20:49:43.490
> 
> 标签：qt, qml, extensibility

在我的应用程序中，我在文件中定义了一个配置屏幕：“ConfigScreen.qml”。它包含状态，以及它们之间定义的转换，以使其平滑地出现和消失：

```
Rectangle {
    id: container
    width: parent.width
    height: parent.height           
    anchors.horizontalCenter: parent.horizontalCenter
    anchors.bottomMargin: 5      
    state: "start"
    states: [
        State {
            name: "start"
            AnchorChanges { target: container; anchors.verticalCenter: undefined }
            AnchorChanges { target: container; anchors.bottom: container.parent.top }
        },
        State {
            name: "center"
            AnchorChanges { target: container; anchors.bottom: undefined }
            AnchorChanges { target: container; anchors.verticalCenter: container.parent.verticalCenter }
        }
    ]

    transitions: Transition {
        AnchorAnimation { duration: 800; easing.type: Easing.InOutBack; easing.overshoot: 2 }
    }
} 
```

矩形进入场景并相应地将其保留为当前状态（即在父项中设置的某处）。

现在我想创建更多视图（单独的文件），具有与上述相同的效果，但内容不同。如果将来需要对此效果进行一些更新，我想在一个地方进行更改，而不是在每个使用它的屏幕中进行更改。

这可以以某种方式在 QML 中完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T04:19:02.917

您可以将它定义为一个项目，并给它一个属性来指定它所操作的对象。一般概念可以在这里看到：

滑动过渡.qml：

```
Item {
    property Item container;

    state: "start"
    states: [
        State {
            name: "start"
            AnchorChanges { target: container; anchors.verticalCenter: undefined }
            AnchorChanges { target: container; anchors.bottom: container.parent.top }
        },
        State {
            name: "center"
            AnchorChanges { target: container; anchors.bottom: undefined }
            AnchorChanges { target: container; anchors.verticalCenter: container.parent.verticalCenter }
        }
    ]

    transitions: Transition {
        AnchorAnimation { duration: 800; easing.type: Easing.InOutBack; easing.overshoot: 2 }
    }
} 
```

main.qml：

```
Text {
    id: example
    width: parent.width
    height: parent.height
    anchors.horizontalCenter: parent.horizontalCenter
    anchors.bottomMargin: 5
    text: "Hello out there!"

    SlidingTransition {
        id: textState
        container: example
    }
} 
```

现在设置`textState.state = "center"`，你应该看到它发生。如果你想让它变得不那么麻烦，你可以做一些事情，比如将`container`属性默认为父级并将 SlidingTransition.state 绑定到容器的状态。

# android - 在android中自动拍照？

> ID：10790286
> 
> 赞同：0
> 
> 时间：2012-05-28T20:50:16.707
> 
> 标签：android, android-intent, android-widget

到目前为止，我在客户端运行了 android 代码。用户可以点击按钮启动摄像头。相机开始工作。用户必须单击按钮拍照，然后单击“完成”按钮。然后保存图像，稍后我将其发送到服务器。

我现在希望自动化这个过程，即当用户启动相机时，应该自动拍摄照片，然后控件返回父屏幕。我想知道这是否可能，那么如何？？？

将等待您的指导。我的相机代码如下：-

受保护的无效 startCameraActivity() {

```
 Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
    intent.putExtra(MediaStore.EXTRA_OUTPUT,Uri.fromFile(new File(file_name)));
    startActivityForResult(intent, 1);
    finish();
} 
```

# javascript - 在使 dojo 1.7.2 工作时遇到问题

> ID：10790287
> 
> 赞同：0
> 
> 时间：2012-05-28T20:50:27.810
> 
> 标签：javascript, dojo, digit

我似乎无法让 dojo 1.7.2 为我工作。有人可以告诉我为什么这不起作用吗？ [http://jsfiddle.net/YApwK/22/](http://jsfiddle.net/YApwK/22/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:31:22.820

小部件位于 下`dijit/`，而不是`digit/`- 您输入错误。

您也没有包含`dojo/main`，这是某些常见 Dojo 操作（如 dojo.byId）所必需的。使用新的 AMD 模块时，Dojo 一开始不会加载太多。

（另外，因为你没有添加任何 CSS，它看起来不太好，但这将帮助你开始。）

这是正常工作的基本 dijit：

[http://jsfiddle.net/9ezc7/2/](http://jsfiddle.net/9ezc7/2/)

# c++ - C++ 对对象数组的访问冲突

> ID：10790291
> 
> 赞同：0
> 
> 时间：2012-05-28T20:50:46.270
> 
> 标签：c++, arrays, visual-c++, memory-management, access-violation

我是 C++ 的新手，我尝试创建一个对象数组。我使用类似的代码

```
const int SORT_SIZE = 20;

int _tmain(int argc, _TCHAR* argv[])
{
    CSimple * data;
    data = new CSimple[SORT_SIZE];

    for(int i = 0; i < SORT_SIZE; i++)
    {
/*Access violation here*/   *(data + i * (sizeof(CSimple))) = *(new CSimple(rand() % 10000));
    } 
```

在 i = 5 的循环中，我遇到了访问冲突。sizeof(CSimple) 是 8 （那里只有一个 int 字段）如果重要的话

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:55:32.227

将 for 循环中的行替换为`data[i] = CSimple(rand() % 10000)`. 更具可读性，不是吗？

您的代码失败的原因是因为`data + i`不会按 i 字节而是按 i 增加数据`CSimple`。比如说，如果 CSimple 是 4 个字节长，那么`data + i * sizeof(CSimple)`数据会增加 16 个字节而不是 4 个字节。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-28T21:20:28.847

作为一个新手，你为什么不让你的生活更轻松，并使用自动为你完成艰苦工作的类型呢？

```
#include <vector>

const int SORT_SIZE = 20;

int _tmain(int argc, _TCHAR* argv[])
{
    std::vector<CSimple> data;

    for(int i = 0; i < SORT_SIZE; i++)
    {
        data.push_back( CSimple(rand() % 10000) );
    } 
```

# java - 我的 JFrame 中什么都没有出现

> ID：10790292
> 
> 赞同：0
> 
> 时间：2012-05-28T20:50:49.937
> 
> 标签：java, swing, jframe

我正在练习使用 GUI。我一直在遵循一组说明，但是当我尝试运行程序时，只会出现一个空框架。框架内看不到任何信息。

这是我的代码：

```
package practice528;

import java.util.Scanner;
import java.io.*;
import javax.swing.*;
import java.awt.*;

public class Practice528 
{
public static void main(String[] args) 
{
    JFrame frame = new JFrame("Rectangle Calculator");
    frame.setVisible(true);
    frame.setSize(400,300);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    JLabel lengthL, widthL, areaL, perimeterL;
    lengthL = new JLabel("Enter the length: ", SwingConstants.RIGHT);
    widthL = new JLabel("Enter the width: ", SwingConstants.RIGHT);
    areaL = new JLabel("The area is ", SwingConstants.RIGHT);
    perimeterL = new JLabel("The perimeter is ", SwingConstants.RIGHT);

    frame.setLayout(new GridLayout(5,2));

    System.out.println();
} //end main
} //end class 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:52:17.970

`setVisible(true)`简单：在向 JFrame添加组件*之前*不要调用它。*只有在*整个事情都设置好之后才调用它，至少在最初是这样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T20:52:49.873

将组件添加到内容窗格:)

这是使用多功能[MigLayout](http://miglayout.com)的建议：

```
JPane panel = (JPanel) frame.getContentPane();
panel.setLayout(new MigLayout("fill, wrap 2", "[right][fill]"));

panel.add(lengthL);
panel.add(new JTextField());
panel.add(widthL);
panel.add(new JTextField());
panel.add(areaL);
panel.add(new JTextField());
panel.add(perimeterL);
panel.add(new JTextField()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-28T20:54:35.343

您应该使用以下代码将组件添加到 JFrame：

```
frame.getContentPane().add(lengthL);
frame.getContentPane().add(widthL);
frame.getContentPane().add(areaL);
frame.getContentPane().add(perimeterL); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T12:33:50.227

您需要在给定的框架中添加 Jlabels。

```
frame.add(lengthL);
frame.add(widthL);
frame.add(areaL);
frame.add(perimeterL); 
```

如果您想要另一个组件，则仅添加您创建的标签，然后创建并将其添加到 frame.ex 文本字段。

# c - 使用 mmap 映射的内存，并与 mprotect 一起使用

> ID：10790294
> 
> 赞同：1
> 
> 时间：2012-05-28T20:51:17.590
> 
> 标签：c, mmap, mprotect

我必须为线程提供内存区域并应用内存管理的基本概念。这个想法是创建一个线程本地存储，并通过写入、读取、克隆和擦除来管理。问题是当我尝试使用 mprotect 取消保护与 TLS 中的线程关联的页面时，这会向我发送一个错误。这是我的结构：

每页的分配

```
int cnt;
for (cnt = 0; cnt < page_num; cnt++) {
    struct page *p;
    p = (struct page *) calloc(1, sizeof(struct page));

    int *map =  mmap(0, page_size, 0, MAP_ANON | MAP_PRIVATE, 0, 0);
    if (map == MAP_FAILED) {
        perror("Error mmapping the file");
        exit(EXIT_FAILURE);
    }

    p->address = (unsigned int)map; 
```

它是由 mmap 映射的，但是当我尝试使用此代码保护页面时（或取消保护我有同样的错误，这是我第一次尝试）

```
for(int i = 0; i < currentTLS->page_num; i++){
    tls_unprotect(currentTLS->pages[i]);
} 
```

以及 tls_unprotect 方法：

```
void tls_protect(struct page *p){
  if (mprotect((void *) p->address,PAGESIZE, PROT_READ | PROT_WRITE)) {
      fprintf(stderr, "tls_unprotect: could not unprotect page\n");
      exit(errno);
  }
} 
```

保护方法是一样的。

errorno 代码是 12。

我感谢任何形式的帮助。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T05:39:10.447

```
p->address = (unsigned int)map; 
```

这个演员非常可疑。在大多数 64 位系统（包括 OS X AFAIK）上，`int`是 32 位宽，因此太短而无法容纳指针。
该转换丢弃了构成指针的 8 个字节中的 4 个字节。

`p->address`应该声明为 a `void*`，并且该分配根本不需要强制转换。如果您需要将其存储为无符号整数类型，请使用`uintptr_t`(in `<stdint.h>`, C99)。

# performance - PPL 和英特尔媒体 SDK

> ID：10790297
> 
> 赞同：2
> 
> 时间：2012-05-28T20:51:29.343
> 
> 标签：performance, concurrency, tbb, ppl

我想在我的项目中集成英特尔 QSV 编码器。我想澄清一下英特尔已知限制发布说明中的一点：

> 将英特尔 Media SDK 与英特尔® 线程构建模块并行使用可能会影响性能

为什么线程管理会影响英特尔 QSV 编码器？

我的项目没有使用 Intel TBB，而是使用了 Microsoft 并发运行时并行模式库 (PPL) 技术。PPL 会影响英特尔 QSV 性能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T17:50:37.983

以下是英特尔的回答：

> 很抱歉，发行说明不是很清楚。基本上，该声明适用于 Media SDK SW 编解码器，归结为 SW 编解码器在执行工作负载时利用所有可用的逻辑处理器内核这一事实。这与使用 PPL 或 TBB 等线程框架或通用线程无关。处理器内核总是有可能被超额订阅，从而可能影响性能。Media SDK 目前没有机制来控制 SW 编解码器的内部线程数。

# java - 在 Java Web 服务中引发用户定义的异常时出错

> ID：10790299
> 
> 赞同：0
> 
> 时间：2012-05-28T20:51:33.970
> 
> 标签：java, web-services, exception

我不能在我的 Web 服务的方法上抛出异常。当我在我的方法中抛出异常并尝试从 Soap UI 测试我的应用程序时，它会给出该错误：

```
Failed to import WSDL 
```

和

```
java.lang.NullPointerException 
```

我的问题是：

如何为 Java Web 服务编写用户定义的异常？

（即，有一种方法可以返回由名称给出的学生。但是，如果学生在数据库中找不到，则会引发错误？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:03:28.170

In [wsdl](/questions/tagged/wsdl "show questions tagged 'wsdl'") exceptions are first-class citizens and are known as [soap](/questions/tagged/soap "show questions tagged 'soap'") [fault](/questions/tagged/fault "show questions tagged 'fault'")s. Basically a fault is yet another message that your operation can return - but with different semantics. Typically faults are translated to strongly-typed exceptions in endpoint interfaces.

Example taken from [Web services hints and tips: Design reusable WSDL faults](http://www.ibm.com/developerworks/webservices/library/ws-tip-wsdlfaults/index.html):

```
<message name="faultMsg"><part name="fault" element="tns:fault"/>
<portType name="Interface">
    <operation name="op1">
        <input name="op1Request" message="tns:op1RequestMsg"/>
        <output name="op1Response" message="tns:op1ResponseMsg"/>
        <fault name="fault" message="tns:faultMsg"/>
    </operation>
</portType> 
```

If you throw suvh exception from your service method it is translated to `<fault>` message and rethrown on the client side. If you simply throw arbitrary message on the server side, it is treated as an error and might result e.g. with 500 error code on the client side.

# javascript - 我应该使用 (typeof(val) === 'undefined') 还是 (val === undefined)？

> ID：10790300
> 
> 赞同：5
> 
> 时间：2012-05-28T20:51:43.880
> 
> 标签：javascript

这类似于 SO 上的许多其他问题，但与我能找到的任何问题都不完全相同。

哪种方法是检查 Javascript 中未定义值的最佳方法，为什么？

第一个例子：

```
var a;
if (typeof(a) === 'undefined'){...} 
```

第二个例子：

```
var a;
if (a === undefined){...} 
```

因此，第一个示例是将类型名称与字符串进行比较，第二个示例将变量与未定义对象进行比较，使用相等运算符检查类型和值是否相同。

哪个更好？还是他们俩都一样好？

请注意，我不是在询问 undefined 和 null 或真或假之间的任何区别，只是这两种方法中的哪一种是正确的和/或更好的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-28T20:53:57.873

如果一个变量不存在，那么当你尝试使用它时，你会得到一个引用错误——即使你将它与`undefined`. 所以总是使用`typeof`.

```
> foo === undefined
ReferenceError: foo is not defined
    at repl:1:2
    at REPLServer.eval (repl.js:80:21)
    at Interface.<anonymous> (repl.js:182:12)
    at Interface.emit (events.js:67:17)
    at Interface._onLine (readline.js:162:10)
    at Interface._line (readline.js:426:8)
    at Interface._ttyWrite (readline.js:603:14)
    at ReadStream.<anonymous> (readline.js:82:12)
    at ReadStream.emit (events.js:88:20)
    at ReadStream._emitKey (tty.js:320:10)
> typeof foo === "undefined"
true 
```

（坏）代码也有可能覆盖`undefined`，这将导致未定义的值不等于`undefined`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T20:54:29.280

可以分配一个值，类型检查将`undefined`不起作用。除非代码的范围受到保护，例如

```
(function(undefined){
    var a;
    if (a === undefined) {
})();
// note called without parameter, so undefined is actually an undefined value 
```

这种检查方式不安全，首选第一种

编辑：ECMA 5 似乎不允许为未定义的值分配值，但这仍然取决于浏览器的实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T20:59:54.327

这两种方法都是正确的，但`typeof`一种不受 值变化的影响`undefined`。如果您需要更严格的检查，请使用`typeof()`.

在 ECMA 3 标准中，您可以修改 undefined 的值，如下所示：

```
undefined = "not undefined"; 
```

与`undefined`以后相比，这可能会导致丑陋。在 ECMA 5 中，这是不允许的。这意味着大多数现代浏览器不会让您设置 的值`undefined`，您应该可以安全地使用`=== undefined`.

此外，如果您甚至不确定您要检查的变量是否已定义，您应该使用`typeof`，否则您将收到引用错误。

# ruby - CanCan 2.0 创建/更新授权

> ID：10790304
> 
> 赞同：0
> 
> 时间：2012-05-28T20:52:00.500
> 
> 标签：ruby, ruby-on-rails-3, cancan

据我了解，CanCan 在加载时授权创建和更新操作，并在分配参数哈希时再次授权。

有没有办法使用新的参数哈希跳过第二次授权检查？这是导致问题的场景：

我有模型在日期过去时阻止编辑（基本上，一旦日期过去，记录就会成为历史）。如果我编辑一个日期仍在未来的记录，并为其分配一个过去的日期，而不是让验证处理它，阻止历史记录的能力会引发 CanCan::Unauthorized 异常。这对可用性不利。有没有解决的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:19:52.493

如果我理解正确，您希望只允许打开具有将来日期的记录以进行编辑（`edit`操作，编辑表单），但能够`update`对所有记录执行操作（保存表单），即使参数中已传递日期。

`edit`可能，您应该为不同的能力和`update`行动编写不同的能力。喜欢

```
can :edit, YourModel do |model|
  model.date > Date.today # something like this
end

can :update, YourModel 
```

但是您需要使用这种方法添加额外的检查（在`update`操作中，可能是在验证器中），因为任何人都可以通过发送由手动发布请求生成的发送来更改记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T21:34:47.590

我不知道你现在的情况如何，但我认为你可以做这样的事情。

```
can :update, Model do |model|
  persisted_date = model.changes[:date].first
  persisted_date > Date.today 
end 
```

# java - 如何通过 Java 以编程方式查找给定操作系统和用户的默认安装目录？

> ID：10790306
> 
> 赞同：0
> 
> 时间：2012-05-28T20:52:17.497
> 
> 标签：java

我需要找到给定操作系统和用户组合默认使用的目录来安装新应用程序。例如，在 Windows 上，对于任何用户，该目录都可以是`C:\Program Files`; 对于 Linux + root，它可能是`/usr/local`；对于 Linux + 非 root 用户，可能是`/home/username`等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T07:54:47.233

我不知道回复这个帖子是否为时已晚。但即使我也需要使用 Java 的类似内容。

最后我发现对于获取System环境变量，java提供了两种方法

```
1>System.getenv(name) 
```

这里名称是一个需要值的键。它返回“字符串”另一个是

```
2> System.getenv(); 
```

这将返回所有系统环境变量。它返回“地图”。

我会坚持你最初使用第二种方法，并且知道你正在使用的操作系统的所有键值对。然后，当你获得需要获取的属性的正确键名时，你可以继续使用第一种方法。

如果您需要更清晰的说明，还请检查 Java 文档。 [javadoc 链接](http://docs.oracle.com/javase/6/docs/api/java/lang/System.html)

# google-app-engine - GAE全文搜索，找到完全匹配

> ID：10790308
> 
> 赞同：0
> 
> 时间：2012-05-28T20:52:31.633
> 
> 标签：google-app-engine, full-text-search

使用 GAE 实验全文搜索，我如何搜索“汽车”等内容，而不会得到“汽车”是句子一部分的结果。所以基本上我想根据关键字找到完全匹配。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T00:51:37.563

我不太清楚您要做什么，但您可能会看一下字段类型`AtomField`：被视为单个标记的字符串。

# asp.net - ASP.Net MVC 中等效的 CakePHP 回调函数

> ID：10790309
> 
> 赞同：2
> 
> 时间：2012-05-28T20:52:36.023
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, cakephp

我是 ASP.Net MVC 的新手，想知道是否有与 CakePHP 等中的回调函数或`beforeFilter()`方法`afterFilter()`等效`beforeRender()`。

我想做的是使用`ViewBag`设置一些全局变量`PageTitle`，例如我有多个模块共享相同的标题和其他属性。

我以前也有一个父类——它`AppController`在 CakePHP 中被调用，它可以实现那些使我能够运行函数并将变量发送到我的视图的回调函数。我在 ASP.Net MVC 中做了类似的事情，但它现在没用了，因为我无法在函数运行之前启动我想要运行的`Index()`函数。

应用控制器.cs

```
public class AppController : Controller
{
    public static string message = "Nice!";

    public void PageInfo()
    {
        ViewBag.Message = message;
    }
} 
```

家庭控制器.cs

```
public class HomeController : AppController
{
    public ActionResult Index()
    {
        PageInfo();
        return View();
    }

    public ActionResult About()
    {
        return View();
    }
} 
```

我知道这听起来很傻，但是作为一个 ASP.Net 初学者是一种可怕的感觉，所以请放轻松！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T05:57:46.773

您可以编写一个自定义操作过滤器：

```
public class MyActionFilterAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        // This will run before the action
        filterContext.Controller.ViewBag.Message = "some message";
    }

    public override void OnResultExecuted(ResultExecutedContext filterContext)
    {
        // This will run after the action
    }

    public override void OnResultExecuting(ResultExecutingContext filterContext)
    {
        // This will run before the result executes
    }

    public override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        // This will run after the result executes
    }
} 
```

然后用它装饰您的控制器（在这种情况下，它将应用于此控制器中的所有操作）或单个操作：

```
[MyActionFilter]
public class HomeController : AppController
{
    public ActionResult Index()
    {
        return View();
    }

    public ActionResult About()
    {
        return View();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:56:39.530

您只需要创建自定义操作过滤器，实现抽象[ActionFilterAttribute](http://msdn.microsoft.com/en-us/library/system.web.mvc.actionfilterattribute.aspx)及其方法：

*   OnAction执行
*   OnActionExecuted
*   OnResultExecuting
*   OnResultExecuted

# python - Numpy：检查数组的字符串数据类型

> ID：10790312
> 
> 赞同：20
> 
> 时间：2012-05-28T20:52:57.700
> 
> 标签：python, arrays, string

如何确定 Numpy 数组是否包含字符串？数组`a`在

```
a = np.array('hi world') 
```

具有数据类型`dtype('|S8')`，其中`8`指的是字符串中的字符数。

我看不出正则表达式（例如`re.match('\|S\d+', a.dtype)`）如何在这里工作，因为数据类型不是 simple `'|S8'`。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-28T21:31:50.343

```
a.dtype.char == 'S' 
```

或者

```
a.dtype.type is np.string_ 
```

请参阅[NumPy 文档、数据类型对象、属性](http://docs.scipy.org/doc/numpy/reference/arrays.dtypes.html#attributes)。

# java - CXF 错误解组错误 UnsupportedOperationException

> ID：10790313
> 
> 赞同：3
> 
> 时间：2012-05-28T20:53:00.823
> 
> 标签：java, jax-ws, cxf

TL;DR 出于某种原因，我无法在使用 CXF 的 Java 优先 Web 服务中解组一个相当简单的对象。

我有一个 Java-First CXF Web 服务，其 API 类似于：

```
@WebMethod
public SearchResponse search(@WebParam(name = "searchRequest") SearchRequest searchRequest); 
```

响应（不会解组的类）大致是：

```
public class SearchResponse {

    private List<SearchResult> results;
    public List<SearchResult> getResults() {
        return results;
    }
    public void setResults(List<SearchResult> results) {
        this.results = results;
    }
} 
```

SearchResult 是一个非常简单的两个属性类：

```
public class SearchResult {
    private long id;
    private String name;

    public long getId() {
        return id;
    }
    public void setId(long id) {
        this.id = id;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
} 
```

我可以通过 Soap-UI 调用此服务，它运行良好。但是，当我使用 jaxws 客户端调用时，出现错误：

```
javax.xml.ws.soap.SOAPFaultException: Unmarshalling Error: null 
    at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:143)
    at $Proxy67.search(Unknown Source)
    at com.blah.MyTest.curseYouSearch(MyTest.java:76)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.internal.runners.TestMethod.invoke(TestMethod.java:59)
    at org.junit.internal.runners.MethodRoadie.runTestMethod(MethodRoadie.java:98)
    at org.junit.internal.runners.MethodRoadie$2.run(MethodRoadie.java:79)
    at org.junit.internal.runners.MethodRoadie.runBeforesThenTestThenAfters(MethodRoadie.java:87)
    at org.junit.internal.runners.MethodRoadie.runTest(MethodRoadie.java:77)
    at org.junit.internal.runners.MethodRoadie.run(MethodRoadie.java:42)
    at org.junit.internal.runners.JUnit4ClassRunner.invokeTestMethod(JUnit4ClassRunner.java:88)
    at org.junit.internal.runners.JUnit4ClassRunner.runMethods(JUnit4ClassRunner.java:51)
    at org.junit.internal.runners.JUnit4ClassRunner$1.run(JUnit4ClassRunner.java:44)
    at org.junit.internal.runners.ClassRoadie.runUnprotected(ClassRoadie.java:27)
    at org.junit.internal.runners.ClassRoadie.runProtected(ClassRoadie.java:37)
    at org.junit.internal.runners.JUnit4ClassRunner.run(JUnit4ClassRunner.java:42)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: java.lang.UnsupportedOperationException
    at java.util.AbstractList.add(AbstractList.java:131)
    at java.util.AbstractList.add(AbstractList.java:91)
    at com.sun.xml.internal.bind.v2.runtime.reflect.Lister$CollectionLister.addToPack(Lister.java:290)
    at com.sun.xml.internal.bind.v2.runtime.reflect.Lister$CollectionLister.addToPack(Lister.java:254)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.Scope.add(Scope.java:106)
    at com.sun.xml.internal.bind.v2.runtime.property.ArrayERProperty$ReceiverImpl.receive(ArrayERProperty.java:195)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallingContext.endElement(UnmarshallingContext.java:524)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.StAXStreamConnector.handleEndElement(StAXStreamConnector.java:206)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.StAXStreamConnector.bridge(StAXStreamConnector.java:170)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:351)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal(UnmarshallerImpl.java:330)
    at org.apache.cxf.jaxb.JAXBEncoderDecoder.unmarshall(JAXBEncoderDecoder.java:610)
    at org.apache.cxf.jaxb.JAXBEncoderDecoder.unmarshall(JAXBEncoderDecoder.java:530)
    at org.apache.cxf.jaxb.io.DataReaderImpl.read(DataReaderImpl.java:114)
    at org.apache.cxf.interceptor.DocLiteralInInterceptor.handleMessage(DocLiteralInInterceptor.java:99)
    at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:236)
    at org.apache.cxf.endpoint.ClientImpl.onMessage(ClientImpl.java:658)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponseInternal(HTTPConduit.java:2139)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponse(HTTPConduit.java:2022)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1947)
    at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:66)
    at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:632)
    at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:62)
    at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:236)
    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:472)
    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:302)
    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:254)
    at org.apache.cxf.frontend.ClientProxy.invokeSync(ClientProxy.java:73)
    at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:123)
    ... 24 more 
```

我可以在 AbstractList.add 上设置一个断点，并根据生成的堆栈，似乎解组正在尝试添加到空列表中，这当然是不可变的：

```
Thread [main] (Suspended (breakpoint at line 131 in AbstractList))  
    Collections$EmptyList(AbstractList<E>).add(int, E) line: 131    
    Collections$EmptyList(AbstractList<E>).add(E) line: 91  
    Lister$CollectionLister<BeanT,T>.addToPack(T, Object) line: 290 
    Lister$CollectionLister<BeanT,T>.addToPack(Object, Object) line: 254    
    Scope<BeanT,PropT,ItemT,PackT>.add(Accessor<BeanT,PropT>, Lister<BeanT,PropT,ItemT,PackT>, ItemT) line: 106 
    ArrayERProperty$ReceiverImpl.receive(UnmarshallingContext$State, Object) line: 195  
    UnmarshallingContext.endElement(TagName) line: 524  
    StAXStreamConnector.handleEndElement() line: 206    
    StAXStreamConnector.bridge() line: 170  
    UnmarshallerImpl.unmarshal0(XMLStreamReader, JaxBeanInfo) line: 351 
    UnmarshallerImpl.unmarshal(XMLStreamReader, Class<T>) line: 330 
    JAXBEncoderDecoder.unmarshall(Unmarshaller, Object, QName, Class<?>, boolean) line: 610 
    JAXBEncoderDecoder.unmarshall(Unmarshaller, Object, MessagePartInfo, boolean) line: 530 
    DataReaderImpl<T>.read(MessagePartInfo, T) line: 114    
    DocLiteralInInterceptor.handleMessage(Message) line: 99 
    PhaseInterceptorChain.doIntercept(Message) line: 236    
    ClientImpl.onMessage(Message) line: 658 
    HTTPConduit$WrappedOutputStream.handleResponseInternal() line: 2139 
    HTTPConduit$WrappedOutputStream.handleResponse() line: 2022 
    HTTPConduit$WrappedOutputStream.close() line: 1947  
    HTTPConduit(AbstractConduit).close(Message) line: 66    
    HTTPConduit.close(Message) line: 632    
    MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(Message) line: 62 
    PhaseInterceptorChain.doIntercept(Message) line: 236    
    ClientImpl.invoke(BindingOperationInfo, Object[], Map<String,Object>, Exchange) line: 472   
    ClientImpl.invoke(BindingOperationInfo, Object[], Exchange) line: 302   
    ClientImpl.invoke(BindingOperationInfo, Object...) line: 254    
    JaxWsClientProxy(ClientProxy).invokeSync(Method, BindingOperationInfo, Object[]) line: 73   
    JaxWsClientProxy.invoke(Object, Method, Object[]) line: 123 
    ...endless stack lines omitted... 
```

我的客户端在 Spring 中设置为 jaxws:client:

```
<jaxws:client id="searchServiceClient"
    serviceClass="qualified.class.of.Service"
    address="${url.searchService}">
</jaxws:client> 
```

我们有许多其他 Web 服务以非常相似的方式返回 List 并且工作正常；我有点不知所措，这与这个有什么区别。

该系统使用 Java 6、CXF 2.2.3。

任何建议都将受到欢迎。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T22:03:52.660

我想我遇到了同样的问题并且至少在我的情况下有一个解决方案，它可能对你有帮助。

这里的用例与您的用例略有不同，因为我从平面应用程序中读取 XML 文件。没有网络交互。

配置文件的重要元素是：

```
private static final List<StrategyConfiguration<Transaction>> EMPTY_CONFIGURATION_LIST = Collections.emptyList();
private List<StrategyConfiguration<Transaction>> configurations;
@XmlElementWrapper(name = "boundaries")
@XmlElements({
    @XmlElement(name = "a", type = abtStrategyConfig.class),
    @XmlElement(name = "b", type = bbtStrategyConfig.class),
    @XmlElement(name = "c", type = cbtStrategyConfig.class)
})
public void setConfigurations(List<StrategyConfiguration<Transaction>> configurations) {
    this.configurations = configurations;
}
public List<StrategyConfiguration<Transaction>> getConfigurations() {
    if (configurations == null) {
        return EMPTY_CONFIGURATION_LIST;
    }
    return configurations;
} 
```

我没有时间调查“为什么”，但调试运行显示了导致问题的“什么”。在 setter 之前调用了 null 安全的“get”访问器。我想这是为了提供类型安全检查。“空”列表被返回，非空，然后用作后续集合的基础。

我发现通过提供一个直接的 setter 和 getter，然后提供一个 null 安全的 getter 供外部使用，我清除了错误。

```
private static final List<StrategyConfiguration<Transaction>> EMPTY_CONFIGURATION_LIST = Collections.emptyList();
private List<StrategyConfiguration<Transaction>> configurations;
@XmlElementWrapper(name = "boundaries")
@XmlElements({
    @XmlElement(name = "a", type = abtStrategyConfig.class),
    @XmlElement(name = "b", type = bbtStrategyConfig.class),
    @XmlElement(name = "c", type = cbtStrategyConfig.class)
})
public void setJaxBConfigurations(List<StrategyConfiguration<Transaction>> configurations) {
    this.configurations = configurations;
}
public List<StrategyConfiguration<Transaction>> getJaxBConfigurations() {
    return configurations;
}
public List<StrategyConfiguration<Transaction>> getConfigurations() {
    List<StrategyConfiguration<Transaction>> response = getConfigurationConfigs();
    if (response == null) {
        response = EMPTY_CONFIGURATION_LIST;
    }
    return response;
} 
```

# jquery-mobile - 如何使用 PhoneGap 和 jQuery mobile 创建应用内浏览器？

> ID：10790315
> 
> 赞同：2
> 
> 时间：2012-05-28T20:53:16.737
> 
> 标签：jquery-mobile, cordova

我希望模仿 Twitter、Hootsuite、Facebook 等应用程序中的行为，其中我的应用程序中的外部链接在应用程序内的浏览器窗口中打开。总的来说，我对 PhoneGap、JQM 和移动开发非常陌生，所以我认为这可能是我没有以正确的方式寻找的简单事物。

我在想我应该使用 iFrame，但似乎 iFrames 和 PhoneGap 玩得不好？

[http://wiki.phonegap.com/w/page/51586852/iFrames%20and%20PhoneGap](http://wiki.phonegap.com/w/page/51586852/iFrames%20and%20PhoneGap)

任何帮助深表感谢。

编辑：如果可能的话，希望解决方案能够跨平台兼容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:42:22.347

你想看看 phonegap 的 childbrowser 插件。

iOS：[https ://github.com/purplecabbage/phonegap-plugins/tree/master/iPhone/ChildBrowser](https://github.com/purplecabbage/phonegap-plugins/tree/master/iPhone/ChildBrowser)

安卓：[https ://github.com/purplecabbage/phonegap-plugins/tree/master/Android/ChildBrowser](https://github.com/purplecabbage/phonegap-plugins/tree/master/Android/ChildBrowser)

BB：[https ://github.com/purplecabbage/phonegap-plugins/tree/master/BlackBerry/ChildBrowser](https://github.com/purplecabbage/phonegap-plugins/tree/master/BlackBerry/ChildBrowser)

WP：[https ://github.com/purplecabbage/phonegap-plugins/tree/master/WindowsPhone/ChildBrowser](https://github.com/purplecabbage/phonegap-plugins/tree/master/WindowsPhone/ChildBrowser)

它允许您在应用程序中显示网页。它适用于安卓、iOS、黑莓和 WindowsPhone。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T02:56:13.230

似乎 PhoneGap 的人添加了一个子浏览器，也称为[In App Browser](http://docs.phonegap.com/en/2.4.0/cordova_inappbrowser_inappbrowser.md.html#InAppBrowser)

# php - getUser() 始终返回 0，即使我已登录

> ID：10790316
> 
> 赞同：0
> 
> 时间：2012-05-28T20:53:41.000
> 
> 标签：php, facebook-graph-api, facebook-php-sdk

我正在测试一些基于 example.php 的代码，并`getUser()`返回 0，即使我目前已登录 FB。我的 index.php 页面上的代码如下：

```
<?php

include 'fbLibrary/facebook.php';

$facebook=new Facebook(array(
        'appId' => 'myAppID',
        'secret' => 'mySecret',
        'cookie' => true
        ));

$user=$facebook->getUser();
echo "getUser() returned " . $user . "<p>";

if ($user)
{
    //fb query
    try
    {
        $me=$facebook->api('/me');
        print_r($me);

    }
    catch (FacebookApiException $e)
    {
        echo $e->getMessage();
    }
}

if ($me)
{
    $logoutUrl=$facebook->getLogoutUrl();
    echo "<a href='$logoutUrl'>Logout</a>";
}

else
{
    $loginUrl=$facebook->getLoginUrl(array(
        'scope' => 'friends_status,publish_stream'
    ));
    echo "<a href='$loginUrl'>Login</a>";
}

?> 
```

当我转到 index.php 页面时，“返回的 getUser()”回显测试返回 0。即使`$loginUrl`设置为 URL，当我单击它时，它也会将我带到同一个 index.php 页面。

如果我退出 FB 并重新加载页面，当我单击“登录”时，我会被带到 Facebook 以登录我的应用程序。然后当我成功登录后，我回到 index.php 页面，登录 URL 无效，getUser() 继续返回 0。

我昨天刚刚下载了 PHP SDK，所以我认为它是最新的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:10:27.247

然后可以设置 FB Class 的参数域。像这样的东西：

```
<?php
$facebook = new Facebook(array(
'appId' => APP_ID,//$app_id,
'secret' => APP_SECRET,//$app_secret,
'cookie' => true,
'domain'=>'xxxdomain.com',
));
$session = $facebook->getUser(); 
```

# asp.net-mvc - 客户端验证asp.net mvc 3上的时间跨度

> ID：10790320
> 
> 赞同：3
> 
> 时间：2012-05-28T20:53:50.617
> 
> 标签：asp.net-mvc, validation, timespan, custom-formatting

我需要以“hh:mm”（**无秒**）格式接收一些时间信息。属性定义如下：

```
[DataType(DataType.Time), DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = @"{0:hh\:mm}")]
public TimeSpan SomeTimeProperty { get; set; } 
```

服务器端验证按预期工作。但是，我无法让客户端验证工作，因为没有生成客户端验证规则。

我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T21:53:37.880

恐怕您需要走很长的路并为它创建一个自定义验证器属性。

```
public class TimeSpanValidationAttribute : ValidationAttribute, IClientValidatable
{
    public bool IsValid() {
        // Your IsValid() implementation here
    }

    // IClientValidatable implementation
    public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
    {
        var rule = new TimeSpanValidationRule("Please specify a valid timespan (hh:mm)", "hh:mm");
        yield return rule;
    }
} 
```

然后你需要编写 TimeSpanValidationRule 类：

```
public class TimeSpanValidationRule : ModelClientValidationRule
{
    public TimeSpanValidationRule(string error, string format)
    {
        ErrorMessage = error;
        ValidationType = "timespan";
        ValidationParameters.Add("format", format);
    }
} 
```

这足以让 Html Helper为 html 输入框生成 a`data-val-timespan="Please specify a valid timespan (hh:mm)"`和 a 。`data-val-timespan-format="hh:mm"`

这两个值可以通过为“timespan”属性添加一个适配器到 javascript 不显眼的验证来“收获”。然后它将通过其相应的规则（将模仿服务器端规则）进行验证：

```
$.validator.unobtrusive.adapters.add('timespan', ['format'], function (options) {
    options.rules['timespan'] = {
        format: options.params.format //options.params picked up the extra data-val- params you propagated form the ValidationRule. We are adding them to the rules array.
    };
    if (options.message) { // options.message picked up the message defined in the Rule above
        options.messages['timespan'] = options.message; // we add it to the global messages
    }
});

$.validator.addMethod("timespan", function (value, el, params) {
    // parse the value and return false if not valid and true if valid :)
    // params.format is the format parameter coming from the ValidationRule: "hh:mm" in our case
}); 
```

# c# - 获取画布中矩形的位置

> ID：10790326
> 
> 赞同：3
> 
> 时间：2012-05-28T20:54:45.440
> 
> 标签：c#, wpf-controls, cursor, position

我正在制作一个仅在画布中显示形状的软件，如果用户单击该形状，它就会消失并显示另一个形状，依此类推。我的问题是如何检查用户是否点击了形状？我的解决方案是获取对象在画布中的位置和鼠标相对于画布的位置，并检查鼠标光标是否在形状区域的范围内。但我找不到在画布中获取对象位置的方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T21:20:22.760

您可以通过调用[Canvas.GetLeft](http://msdn.microsoft.com/en-us/library/system.windows.controls.canvas.getleft.aspx)和[Canvas.GetTop](http://msdn.microsoft.com/en-us/library/system.windows.controls.canvas.gettop.aspx)方法来获取控件在画布上的位置：

```
double x = Canvas.GetLeft(rect);
double y = Canvas.GetTop(rect); 
```

但我认为你无论如何都不需要这样做......只需`MouseDown`在形状本身上处理事件，而不是在`Canvas`.

# c# - 使用 Excel 互操作将 VBA 代码添加到 excel 文件

> ID：10790327
> 
> 赞同：2
> 
> 时间：2012-05-28T20:54:48.527
> 
> 标签：c#, excel

标题很简单。如何使用 Excel 互操作将 VBA 代码添加到 Excel 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:44:57.203

您是否尝试将 VBA 代码保存在“.bas”文件中？然后，您可以尝试通过 Excel 互操作以编程方式添加代码。

如果这不起作用，为什么不在`Workbook_Open`事件触发时简单地添加以下代码：

```
Private Sub Workbook_Open()
    Dim sModulePath As String

    sModulePath = "path"
    ThisWorkbook.VBProject.VBComponents.Import Filename:=sModulePath
End Sub 
```

# php - 检查记录是否成功插入 Symfony2

> ID：10790338
> 
> 赞同：6
> 
> 时间：2012-05-28T20:56:05.440
> 
> 标签：php, symfony, doctrine-orm

如何使用 symfony2 中的 Doctrine 检查记录是否成功插入数据库？

我在控制器中的操作是

```
public function createAction(){
    $portfolio = new PmPortfolios();
    $portfolio->setPortfolioName('Umair Portfolio');
    $em = $this->getDoctrine()->getEntityManager();
    $em->persist($portfolio);
    $em->flush();
    if(){
         $this->get('session')->setFlash('my_flash_key',"Record Inserted!");
    }else{
         $this->get('session')->setFlash('my_flash_key',"Record notInserted!");
    }
} 
```

我应该在`if`声明中写什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-28T21:32:52.903

您可以将控制器包装在这样的`try / catch`块中：

```
public function createAction() {
    try {
        $portfolio = new PmPortfolios();
        $portfolio->setPortfolioName('Umair Portfolio');
        $em = $this->getDoctrine()->getEntityManager();
        $em->persist($portfolio);
        $em->flush();

        $this->get('session')->setFlash('my_flash_key',"Record Inserted!");

    } catch (Exception $e) {
        $this->get('session')->setFlash('my_flash_key',"Record notInserted!");
    }
} 
```

如果插入失败，将抛出异常并捕获。您可能还希望通过调用`$e->getMessage()`和/或`$e->getTraceAsString()`解释异常的方式以某种方式在您的 catch 块中记录错误消息。

# css - 使用 CSS 创建圆形菜单

> ID：10790341
> 
> 赞同：22
> 
> 时间：2012-05-28T20:56:30.070
> 
> 标签：css

我正在尝试在 CSS 中为学校项目创建一个圆形菜单。

这是菜单的样子：

![在此处输入图像描述](../Images/044c1a6f17c07a991c1ed87c556dc4aa.png)

我不是在寻找完整的源代码，只是想知道您有经验的开发人员将如何做到这一点。

我正在考虑创建 8 个三角形，然后在中间放置一个绝对位置的圆形 div；**但是**三角形，因为它们是用边框创建的，所以当你将它们悬停时，它们并不是绝对可选择的。这有点马车。

甚至可以在没有图像的情况下创建它吗？

编辑：

菜单将使用 jQuery 进行动画处理；因此我将使用 jQuery 和 jQuery UI，但没有其他库和图像（无论如何我不需要图标）。至于兼容性，应该适用于 IE9+ / Chrome / Opera 11.52+ / Firefox 4+。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-28T22:08:23.217

以下是使用 HTML 画布执行此操作的一种方法，它可以检测鼠标的完美位置。不过它看起来和你的不太一样，而且我没有添加图标或分隔线（尽管抗锯齿允许背景在区域之间稍微显示出来，从而产生绘制线条的错觉）。

[http://jsfiddle.net/jcubed111/xSajL/](http://jsfiddle.net/jcubed111/xSajL/)

**编辑 - 错误修复：http: [//jsfiddle.net/jcubed111/xSajL/2/](http://jsfiddle.net/jcubed111/xSajL/2/)**

通过更多的工作，您可以使画布版本看起来与您的模型相同，我的版本只是为了降低功能。

您还可以使用 css 使其看起来正确，然后覆盖一个清除`a`以检测鼠标位置并提供链接功能。当然，你不能用它`:hover`来改变区域的外观。

我只在 Chrome 19 中测试过。

如果链接断开，下面是完整的代码：

HTML：

```
<a id='link'><canvas id='c' width='224' height='224' onmousemove="update(event);"></canvas></a>
<input id='i' />​​​​​​​​ 
```

CSS：

```
#c{
    width:224px;
    height:224px;
}​ 
```

JS（在页面加载时运行并使用 jquery）：

```
ctx = $('#c')[0].getContext('2d');

function update(E) {
    ctx.clearRect(0, 0, 224, 224);
    if (E === false) {
        mx = 112;
        my = 112;
    } else {
        mx = E.clientX;
        my = E.clientY;
    }

    mangle = (-Math.atan2(mx-112, my-112)+Math.PI*2.5)%(Math.PI*2);
    mradius = Math.sqrt(Math.pow(mx - 112, 2) + Math.pow(my - 112, 2));

    $('#i').val("Not over any region");
    $('#link').attr('href', '');
    for (i = 0; i < 8; i++) {
        angle = -Math.PI / 8 + i * (Math.PI / 4);

        if (((mangle > angle && mangle < (angle + Math.PI / 4)) || (mangle > Math.PI*15/8 && i==0)) && mradius<=112 && mradius>=69) {
            ctx.fillStyle="#5a5a5a";
            $('#i').val("In region "+i);
            $('#link').attr('href', '#'+i);
        } else {
            ctx.fillStyle="#4c4c4c";
        }

        ctx.beginPath();
        ctx.moveTo(112, 112);
        //ctx.lineTo(112+Math.cos(angle)*112, 112+Math.sin(angle)*112);
        ctx.arc(112, 112, 112, angle, angle + Math.PI / 4, false);
        ctx.lineTo(112, 112);
        ctx.fill();

    }

    ctx.fillStyle = "#f2f2f2";
    ctx.beginPath();
    ctx.arc(112, 112, 69, 0, 2 * Math.PI, false);
    ctx.fill();
}

update(false);​ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-28T22:14:03.913

可以使用常规的 HTML+CSS*来*完成，但为了您的理智，请不要尝试。这不值得。

在 Canvas 或 SVG 中做这样的事情会好得多。特别是如果您不需要支持旧版本的 IE。

对于 Canvas 和 SVG 解决方案，我建议找到合适的库。在 SVG 世界中，我强烈推荐[Raphael](http://raphaeljs.com/)。对于 Canvas，不妨试试[Paper](http://paperjs.org/)。只需几行代码，您就可以使用这些库中的任何一个来启动和运行基础知识。

如果您*必须*在 CSS 中执行此操作（也许这是您项目的标准，或者您只是一个受惩罚的贪吃者），您需要从 using`border-radius`开始制作圆圈。然后使用 1px 宽的框绘制分割线，并使用`transform`. 你明白了；这并不容易，正如您可能已经发现的那样。让这件事变得生动起来将是一场彻头彻尾的噩梦。它是可以做到的，并且作为 CSS 可以实现的东西的示范片，这将是非常聪明的。但是当你所有的目标浏览器都支持 SVG 和 Canvas 时，在 CSS 中做这样的事情真的只是为了聪明而聪明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-02-20T13:56:52.413

HTML 代码

```
<a class='button ctrl' href='#' tabindex='1'>★&lt;/a>
<ul class='tip ctrl'>
    <li class='slice'><div>✦&lt;/div></li>
    <li class='slice'><div>✿&lt;/div></li>
    <li class='slice'><div>✵&lt;/div></li>
    <li class='slice'><div>✪&lt;/div></li>
    <li class='slice'><div>☀</div></li>
</ul> 
```

CSS 代码

```
 .ctrl {
        position: absolute;
        top: 75%; left: 50%;
        font: 1.5em/1.13 Verdana, sans-serif;
        transition: .5s;
    }

    a.ctrl, .ctrl div {
        display: block;
        opacity: .56;
        background: #c9c9c9;
        color: #7a8092;
        text-align: center;
        text-decoration: none;
        text-shadow: 0 -1px dimgrey;
      cursor: pointer;
    }

    .button {
        z-index: 2;
        margin: -.625em;
        width: 1.25em; height: 1.25em;
        border-radius: 50%;
        box-shadow: 0 0 3px 1px white;
    }

    .tip {
        z-index: 1;
        /**outline: dotted 1px white;/**/
        margin: -5em;
        width: 10em; height: 10em;
        transform: scale(.001);
        list-style: none;
        opacity: 0;
    }

.slice {
    overflow: hidden;
    position: absolute;
    /**outline: dotted 1px yellow;/**/
    width: 50%; height: 50%;
    transform-origin: 100% 100%;
} 
```

完整代码：[CSSCodeLab](https://www.csscodelab.com/pure-css-half-circle-menu-icons/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T21:10:15.500

这取决于几件事。首先，您需要动画菜单吗？其次你需要严格使用css吗？您需要菜单完美对齐吗？

如果您不需要 100% 精确的东西，您可以使用将圆圈分成小方块并仅使用 css 来完成它。

如果你需要它是 100% 准确的并且你没有动画，你可以试试`<map>` [map](http://www.w3schools.com/tags/tag_map.asp)

如果你想要动画并且 100% 准确，那么你很可能需要像[RaphaelJS这样的东西](http://raphaeljs.com/)

希望它可以帮助你。

# android - 在第二个 ActionBar 中居中 MenuItems？

> ID：10790350
> 
> 赞同：0
> 
> 时间：2012-05-28T20:57:37.593
> 
> 标签：android, menu, android-actionbar

所以我试图让我的图标居中，就像谷歌开发者的这张图片：

![在此处输入图像描述](../Images/2719d955fb2a296c212a3741ca679715.png)

我的第二行实际上就在顶行的下方（这也是在活动中未启用标题或图标的操作栏选项卡）。所以，现在，正如我在我的三个按钮（只是文本，没有图标）中添加的那样，它们堆叠在栏的右侧，我似乎在文档中找不到任何关于居中的内容。有任何想法吗？

相关代码：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:id="@+id/menu_demos"          
          android:title="Chart +/-"
          android:showAsAction="always|withText" />
    <item android:id="@+id/menu_data"          
          android:title="Datas"
          android:showAsAction="always|withText" />
    <item android:id="@+id/menu_reset"          
          android:title="Reset"
          android:showAsAction="always|withText" />
</menu> 
```

清单行：

```
<activity android:name="polling.Chart" android:label="Chart"
        android:icon="@drawable/chart512"     android:windowSoftInputMode="stateHidden"/> 
```

主要活动：

```
 bar = getSupportActionBar();
    bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
    bar.setDisplayShowTitleEnabled(false);
    bar.setDisplayShowHomeEnabled(false);

public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.chartsmenu, menu);
    return true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T14:02:25.387

使用拆分操作栏选项。所有未在顶部操作栏中修复的项目将显示在屏幕底部的第二个操作栏中。其余项目将在第二个操作栏中居中。

```
protected void onCreate(final Bundle savedInstanceState) {
    getSherlock().setUiOptions(ActivityInfo.UIOPTION_SPLIT_ACTION_BAR_WHEN_NARROW);
    super.onCreate(savedInstanceState);
} 
```

# nsurlconnection - 取消以 sendAsynchronousRequest:queue:completionHandler:? 开始的 NSURLConnection

> ID：10790355
> 
> 赞同：12
> 
> 时间：2012-05-28T20:58:35.090
> 
> 标签：nsurlconnection, nsurlconnectiondelegate, sendasynchronousrequest

1.  是否可以取消`NSURLConnection`start with `sendAsynchronousRequest:queue:completionHandler:`？

2.  为什么不`sendAsynchronousRequest:queue:completionHandler:`返回`NSURLConnection`它创建的对象以便我可以取消它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T13:54:08.250

**编辑 - 由于我提供的答案似乎是错误的，您应该查看以下相关问题及其答案：**

## [如何通过 NSURLConnection sendAsynchronousRequest 取消异步调用？](https://stackoverflow.com/questions/8072893/how-can-i-cancel-an-asynchronous-call-through-nsurlconnection-sendasynchronousre)

**老答案：**

在你的类的标题中（例如 ViewController），声明一个操作队列：

```
NSOperationQueue *downloadOperationQueue; 
```

要下载文件，请调用以下内容：

```
downloadOperationQueue = [[NSOperationQueue alloc] init];
NSURLRequest *fileRequest = [NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.google.com/images/nav_logo114.png"]
                                             cachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData
                                         timeoutInterval:10];
[NSURLConnection sendAsynchronousRequest:fileRequest
                                   queue:downloadOperationQueue
                       completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
                           NSLog(@"download successful");
                       }]; 
```

稍后在通话中取消下载：

```
[downloadOperationQueue cancelAllOperations]; 
```

# c# - WP7 ScrollViewer 以编程方式滚动背景 ScrollViewer 与前端 ScrollViewer 同步

> ID：10790357
> 
> 赞同：0
> 
> 时间：2012-05-28T20:58:46.157
> 
> 标签：c#, silverlight, windows-phone-7, windows-phone-7.1

我正在尝试创建一个动画，当用户滚动“FrontScroll”时，应用程序会自动以相同的速度滚动相同大小的“BackgroundScroll”到相同的偏移量。在前面和背景滚动之间分层的是一个我想保持静止的图像。中间的图像只占屏幕的 1/4，其余的图像在 png 中是透明的。我正在尝试创建当用户滚动时其他图像逐渐出现在静态图像上方和后面的效果。

目前，我在 ManipulationCompleted 上有一个有效的事件，但是它会产生非常“抖动”的效果，因为在用户从屏幕上抬起手指之前，背景滚动不会滚动到某个位置。我想让动画即时，无论操作是否完成，从而使 2 个 ScrollViewer 保持完美同步。同样目前，当用户“轻拂” ScrollViewer 以移动更远的距离时，ManipulationCompleted 事件不会触发，因此 2 个 ScrollViewer 变得不同步。我也尝试过 MouseWheel、MouseLeave、MouseMove 事件，但都没有得到我想要的效果。

有谁知道我正在尝试使用 Windows Phone 7.5 中的当前 API 做的事情是否可行，如果是这样，任何关于我如何做到这一点的指针将不胜感激？

我当前的 XAML 和 CodeBehind 事件如下。

```
 <ScrollViewer HorizontalAlignment="Center" Margin="0,0,0,0" Name="backgroundScroll" VerticalAlignment="Top"  Background="Transparent" MaxHeight="Infinity">
                <Image HorizontalAlignment="Center" Height="2000" Stretch="Fill" Source="background@2x.png" />
        </ScrollViewer>

        <Image Source="MiddleStatic@2x.png" HorizontalAlignment="Center" Name="MiddleStatic" Stretch="Fill" VerticalAlignment="Top" Margin="-1,-1,0,0" />

        <ScrollViewer   HorizontalAlignment="Center" Name="FrontScroll" VerticalAlignment="Top" MaxHeight="Infinity" MinHeight="0"  ManipulationCompleted="FrontScroll_ManipulationCompleted">
            <StackPanel Background="#00000000">
                <Image Height="2000" Source="FrontScrollImage@2x.png" HorizontalAlignment="Center" Name="FrontScroll" Stretch="Fill" />
            </StackPanel>
        </ScrollViewer>
    </Grid>

    private void FrontScroll_ManipulationCompleted(object sender, ManipulationCompletedEventArgs e)
    {
        backgroundScroll.ScrollToVerticalOffset(((ScrollViewer)sender).VerticalOffset);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:57:04.067

`Scroll`不幸的是，因为WP7没有事件`ScrollViewer`，我不确定是否有一种“平滑”的方式来保持两个 ScrollViewer 同步。

但是，有一种方法可以使 ScrollViewers 保持同步 - 创建一个`DispatcherTimer`，并将 Interval 属性设置为一个 small `TimeSpan`；例如 0.2 秒。在`Tick`事件处理程序中，将第二个滚动查看器的 VerticalOffset 设置为第一个滚动查看器的垂直偏移量（就像您在 ManipulationCompleted 事件中所做的那样）。

它仍然不会平滑，但计时器触发应该保持滚动同步。

# asp.net-mvc-3 - 在 ASP.NET MVC3 中创建和访问 Cookie

> ID：10790359
> 
> 赞同：9
> 
> 时间：2012-05-28T20:58:51.240
> 
> 标签：asp.net-mvc-3

如何在控制器中创建 cookie 并在任何视图中访问它，例如

```
User.Identity.Name 
```

自从用户登录后，我可以在任何地方使用该代码，并且当用户根据默认代码注销时它也会被删除

```
FormsAuthentication.SetAuthCookie 
```

我还想知道如何删除或清除该 cookie。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-28T21:04:55.067

```
....    
//create cookie
var cookie = new HttpCookie("cookieName");

cookie.Value = "value";
Response.Cookies.Add(cookie);

//remove cookie
var cookie = new HttpCookie("cookieName");
cookie.Expires = DateTime.Now.AddDays(-1d);
Response.Cookies.Add(cookie);

//To Request the cookies value
var val = Request.Cookies["cookieName"].Value;
.... 
```

# html - 如何使内联跨度标记转到下一行，而无需将其显示更改为阻止？

> ID：10790361
> 
> 赞同：3
> 
> 时间：2012-05-28T20:59:21.957
> 
> 标签：html, css

如何使*内联* `span`标记转到下一行，而不必更改其显示以阻止？

我想保留其*内联*行为，因为该`span`标签旨在包含一条短消息。但是，因为它是内联的，所以它的位置从它的前一个元素（在它的前一个元素旁边）继续。我需要跨度定位到下一行，即在其前一个元素下方而不是并排。

是否可以在不将其显示更改为阻止的情况下执行此操作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T21:21:41.857

用这个：

```
span:before{
 content: '\a' ; 
 white-space: pre;  
} 
```

来自`\a`：[http](http://www.w3.org/TR/CSS2/syndata.html#strings) ://www.w3.org/TR/CSS2/syndata.html#strings ：

*字符串不能直接包含换行符。要在字符串中包含换行符，请使用表示 ISO-10646 (U+000A) 中换行符的转义符，例如“\A”或“\00000a”。这个字符代表 CSS 中“换行符”的通用概念。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:12:57.393

您可以将 span 放入块元素中，例如段落元素。或者你可以在跨度和你想在上一行的元素之间放置一条不可见的水平线。或者你可以加入一个换行元素。

# r - 将三元组重新组合成对？

> ID：10790362
> 
> 赞同：0
> 
> 时间：2012-05-28T20:59:34.303
> 
> 标签：r, combinatorics

考虑以下矩阵：

```
sequence <- structure(list(C1 = c(2L, 9L, 3L, 9L, 1L, 8L, 9L, 6L, 4L, 5L, 
3L, 2L), C2 = c(3L, 6L, 5L, 8L, 8L, 7L, 3L, 7L, 2L, 1L, 4L, 1L
), C3 = c(8L, 2L, 6L, 4L, 6L, 5L, 7L, 4L, 5L, 9L, 1L, 7L)), .Names = c("C1", 
"C2", "C3"), class = "data.frame", row.names = c(NA, -12L)) 
```

每行有 3 个数字的组合。我正在尝试将所有三元组重新组合成对，每个三元组行分为三行（每行包含一个可能的对）。例如，第 1 行 (2, 3, 8) 应转换为第 1 行 (2, 3)、第 2 行 (3, 8) 和第 3 行 (2, 8)。结果应如下所示：

```
result <- structure(list(Col1 = structure(c(1L, 1L, 1L, 2L, 2L, 2L, 3L, 
3L, 3L), .Label = c("Row 1", "Row 2", "Row 3"), class = "factor"), 
    Col2 = c(2L, 3L, 2L, 9L, 6L, 9L, 3L, 5L, 3L), Col3 = c(3L, 
    8L, 8L, 6L, 2L, 2L, 5L, 6L, 6L)), .Names = c("Col1", "Col2", 
"Col3"), class = "data.frame", row.names = c(NA, -9L)) 
```

（表格重复，直到所有行都重新组合）

我尝试使用 combn 函数来做到这一点：`t(combn(unlist(t(sequence)),2))`但这是重新组合矩阵的所有元素，而不是仅重新组合每一行的元素。有光吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:09:25.333

我敢肯定有一种更清洁的方法，但您可以使用 cbind 获得兴趣对 3 次，然后使用 rbind 将它们放在一起。

```
sequence <- structure(list(C1 = c(2L, 9L, 3L, 9L, 1L, 8L, 9L, 6L, 4L, 5L, 
3L, 2L), C2 = c(3L, 6L, 5L, 8L, 8L, 7L, 3L, 7L, 2L, 1L, 4L, 1L
), C3 = c(8L, 2L, 6L, 4L, 6L, 5L, 7L, 4L, 5L, 9L, 1L, 7L)), .Names = c("C1", 
"C2", "C3"), class = "data.frame", row.names = c(NA, -12L))

# Essentially what you wanted
temp.result <- with(sequence, rbind(cbind(C1, C2), cbind(C2, C3), cbind(C1, C3)))
# Identify which rows we're talking about
id <- rep(seq(nrow(sequence)), 3)
# Put it all together
result <- cbind(id, temp.result)
# Order it the way you imply in your question
result <- result[order(result[,1]),]
# Give it the colnames you want
colnames(result) <- c("Col1", "Col2", "Col3")
head(result)
#     Col1 Col2 Col3
#[1,]    1    2    3
#[2,]    1    3    8
#[3,]    1    2    8
#[4,]    2    9    6
#[5,]    2    6    2
#[6,]    2    9    2 
```

# iphone - RestKit 0.10 安装代码找不到Core Data相关的扩展

> ID：10790365
> 
> 赞同：0
> 
> 时间：2012-05-28T21:00:03.537
> 
> 标签：iphone, ios, restkit, xcode4.3

我已经用 0.10 替换了 RestKit 0.9。经历了所有的安装步骤。现在我得到选择器未找到错误。

似乎这些选择器与导入的核心数据标头有关，而不是与基于其余套件的核心数据有关

```
No visible @interface for 'RKManagedObjectStore' declares the selector 'save'
No known class method for selector 'managedObjectContext'
No visible @interface for 'RKClient' declares the selector 'get:queryParams:delegate:' 
```

在过去的 2 个小时里，这让我发疯了。请帮忙！

[RestKit安装说明](https://github.com/RestKit/RestKit/wiki/Installing-RestKit-in-Xcode-4.x)

![错误描述](../Images/e363442bf6a84635b61b4e08833a826d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T11:15:01.367

是因为您没有将restkit 配置为在ios5 上与ARC 一起使用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T19:06:03.507

这是一个与 Xcode 项目设置相关的错误。我不得不删除所有rest kit导入，关闭项目，重新导入restkit。在黑暗中刺了很多，但它终于消失了

# jquery - 无法在 DataTables 中设置行类

> ID：10790367
> 
> 赞同：1
> 
> 时间：2012-05-28T21:00:16.653
> 
> 标签：jquery, datatables, html-table

我将 DataTables 与 PHP 和 MySQL 一起使用，效果很好，但是在设置行的类时遇到了很多麻烦。我的 SQL 表有一个名为“class_style”的列，其中包含一些值，如“blue_class”、“green_class”、“red_class”……

我的目标是在结果的每一行上声明这个类名，这样我就可以（例如）显示带有红色背景的“red_class”行，就像这个例子[http://www.datatables.net/release-datatables/examples/ basic_init/zero_config.html](http://www.datatables.net/release-datatables/examples/basic_init/zero_config.html)其中以红色显示。

我认为可行的代码如下：

```
echo "<tbody>";
    for($i=0; $i < $number_of_results; $i++){
        echo "<tr class='" . mysql_result($result, $i, 'class_style') . "'>";;
            echo "<td>" . mysql_result($result, $i, 'family_name') . "</td>";
            echo "<td>" . mysql_result($result, $i, 'team') . "</td>";
        echo "</tr>";           
    };
echo "</tbody>"; 
```

当我用浏览器打开页面时，表格的每一行都显示有以下类：

```
<tr class='odd'>
<tr class='even'> 
```

即使我使用如下自动化程度较低的解决方案

```
echo "<tbody>";
    for($i=0; $i < $number_of_results; $i++){
        echo "<tr class='my_class'>";;
            echo "<td>" . mysql_result($result, $i, 'family_name') . "</td>";
            echo "<td>" . mysql_result($result, $i, 'team') . "</td>";
        echo "</tr>";           
    };
echo "</tbody>"; 
```

所有的课程都变成了

```
<tr class='my_class odd'>
<tr class='my_class even'> 
```

我怎样才能得到这个问题的解决方案？我想达到以下结果：

```
<tr class='green_class'>
    <td>Smith</td>
    <td>the Duck</td>
</tr>
<tr class='red_class'>
    <td>Jackbson</td>
    <td>Big great team</td>
</tr>
<tr class='green_class'>
    <td>Awaiters</td>
    <td>the flowers</td>
</tr> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T04:34:14.507

看起来您正在服务器端呈现表，然后将其发送回客户端，之后您在其上调用 DataTables。那是对的吗？

另一种方法是在“[服务器端处理](http://datatables.net/usage/server-side)”模式下使用 DataTables，这意味着服务器只会发回当前“页面”的数据 JSON。或者，如果您的数据源不是特别大，您可以只使用 Ajax 源（它也应该返回 JSON，但返回整个数据集）。然后你可以使用[fnRowCallback](http://datatables.net/ref#fnRowCallback)函数来设置行的样式[编辑：从 1.10 开始，现在简称为“rowCallback”]。您将从数据集中获取类名，并使用 jQuery 将其添加到行中。

像这样的东西：

```
"fnRowCallback": function( nRow, aData, iDisplayIndex, iDisplayIndexFull ) {
  var rowClass = aData[4] // imagining that your class is found in column 4  
  $(nRow).addClass(rowClass);
  }
} 
```

* * *

作为一个你可以忽略的完全迂腐的旁白（因为只是我在没有被邀请的地方戳我的鼻子），使用彩色课程可能不是最佳的长期决定。我假设“红色”、“绿色”等都对应于单个记录的某种状态。也许“绿色”意味着“当前活跃”或类似的东西。您应该使用反映目的而不是外观的类，因为有一天您可能会认为“紫色”实际上是表示“当前活动”（或其他）的更好颜色。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-06T09:34:27.000

在此处查看文档： [https ://datatables.net/reference/option/createdRow](https://datatables.net/reference/option/createdRow)

我这样解决这个问题：

```
jQuery('.js-dataTable-full').dataTable({
        "processing": true,
        "serverSide": true,
        "ajax": "/path/to/ajax",
        "createdRow": function(row, data, index) {
            if(data.condition) {
                $(row).addClass('warning');
            }
        },
 }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T08:16:30.110

之前设置默认类。

$.fn.dataTableExt.oStdClasses.sStripeOdd = '';

$.fn.dataTableExt.oStdClasses.sStripeEven = '';

有关更多参考，请参见此处

[http://www.datatables.net/styling/custom_classes](http://www.datatables.net/styling/custom_classes)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-01T10:46:41.797

如果您添加了行并且您需要为此行添加唯一的类

```
var table = $('#example').DataTable();
var id = 99;

table
    .row
    .add(['cell-1', 'cell-2', 'cell-3', 'cell-4',])
    .draw()
    .nodes()
    .to$()
    .addClass( 'js__list-item-'+id ); 
```

结果

```
<tr class="js__list-item-99 odd" role="row">
     <td>cell-1</td>
     <td>cell-2</td>
     <td>cell-3</td>
     <td>cell-4</td>
</tr> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-19T16:40:04.760

您需要将其设置为使用服务器端处理第一。完成后，您可以在 JSON 或 PHP 数组中使用 DataTable 自己的格式指定行的类名：

```
'DT_RowClass' => 'class', 
```

这是直接从他们的论坛中提取的：http: [//datatables.net/forums/discussion/7100/dt-rowid-and-rowclass](http://datatables.net/forums/discussion/7100/dt-rowid-and-rowclass)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-28T21:04:59.587

尝试

```
echo "<tbody>";
    for($i=0; $i < $number_of_results; $i++){
        if($i%2==0){
            echo "<tr class='even'>";
          else
             echo "<tr class='odd'>";
            echo "<td>" . mysql_result($result, $i, 'family_name') . "</td>";
            echo "<td>" . mysql_result($result, $i, 'team') . "</td>";
        echo "</tr>";           
    };
echo "</tbody>"; 
```

# c# - 定义运算符 == 但不定义 Equals() 或 GetHashCode() 有什么问题？

> ID：10790370
> 
> 赞同：25
> 
> 时间：2012-05-28T21:00:26.750
> 
> 标签：c#, warnings, equals, equals-operator

对于下面的代码

```
public struct Person
{
    public int ID;
    public static bool operator ==(Person a, Person b) { return  a.Equals(b); }
    public static bool operator !=(Person a, Person b) { return !a.Equals(b); }
} 
```

为什么编译器会给我这些警告？
不定义下面的方法有什么问题？

```
warning CS0660: 'Person' defines operator == or operator != but
    does not override Object.Equals(object o)

warning CS0661: 'Person' defines operator == or operator != but
    does not override Object.GetHashCode() 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-28T21:03:48.203

**编辑**：此答案已得到纠正，除其他事项外，请注意用户定义的值类型不会生成`==`，并提及[`ValueType.Equals`](http://msdn.microsoft.com/en-us/library/2dts52z7.aspx).

* * *

一般来说，覆盖一个，但不是全部，是令人困惑的。用户不希望被覆盖，或者两者都被覆盖，具有相同的语义。

Microsoft对此状态的[建议（除其他外）：](http://msdn.microsoft.com/en-us/library/7h9bszxx%28v=vs.100%29.aspx)

> *   每当您实现 Equals 方法时，就实现 GetHashCode 方法。这使 Equals 和 GetHashCode 保持同步。
>     
>     
> *   每当您实现相等运算符 (==) 时，重写 Equals 方法，并使它们执行相同的操作。

在您的情况下，您有正当理由推迟`Equals`（编译器不会自动实现`==`）并仅覆盖这两个（`==`/ `!=`）。但是，仍然存在性能问题，因为`ValueType.Equals`使用反射：

> “重写特定类型的 Equals 方法以提高方法的性能并更接近地表示该类型的相等概念。”

因此，仍然建议最后覆盖所有 ( `==`/ `!=`/ `Equals`)。当然，对于这个微不足道的结构，性能可能并不重要。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-28T22:10:23.330

框架内普遍期望[某些操作](http://msdn.microsoft.com/en-us/library/dd183755.aspx)应始终产生相同的结果。原因是某些操作（特别是排序和搜索，它们构成任何应用程序的很大一部分）依赖于这些不同的操作来产生有意义且一致的结果。在这种情况下，您打破了其中的几个假设：

*   如果和`==`之间有一个有效的操作，它应该产生相同的结果`a``b``a.Equals(b)`
*   类似地，如果和`!=`之间有一个有效的操作，它应该产生相同的结果`a``b``!a.Equals(b)`
*   如果两个对象`a`和`b`存在，对于 which `a == b`，那么`a`和`b`应该在存储在哈希表中时产生相同的键。

前两个，IMO，很明显；如果您要定义两个对象相等的含义，您应该包括可以检查两个对象是否相等的所有方法。请注意，编译器不会（通常，*不能*）强制您实际遵循这些规则。它不会对操作符的主体执行复杂的代码分析以查看它们是否已经模仿`Equals`，因为在最坏的情况下，这可能等同于[解决停机问题。](http://blogs.msdn.com/b/ericlippert/archive/2011/02/24/never-say-never-part-two.aspx)

但是，它可以做的是检查您最有可能违反这些规则的情况，特别是您提供了自定义比较运算符并且没有提供自定义`Equals`方法。这里的假设是，如果您不希望它们做一些特殊的事情，您就不会费心提供运算符，在这种情况下，您应该为*所有*需要同步的方法提供自定义行为。

如果您确实实现`Equals`了与编译器不同`==`的东西，则不会抱怨；你会达到 C# 愿意努力阻止你做一些愚蠢的事情的极限。它愿意阻止你在代码中意外引入细微的错误，但如果你想要的话，它会让你*故意这样做。*

第三个假设与框架中的许多内部操作使用哈希表的某种变体这一事实有关。如果我有两个对象，根据我的定义，“相等”，那么我应该能够做到这一点：

```
if (a == b)
{
    var tbl = new HashTable();
    tbl.Add(a, "Test");

    var s = tbl[b];
    Debug.Assert(s.Equals("Test"));
} 
```

这是哈希表的一个基本属性，如果它突然不正确会导致非常奇怪的问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-28T21:44:04.737

我的猜测是您收到这些警告，因为编译器不知道您`Equals`在`==`方法中使用

假设你有这个实现

```
public struct  Person
{
    public int ID;
    public static bool operator ==(Person a, Person b) { return Math.Abs(a.ID - b.ID) <= 5; }
    public static bool operator !=(Person a, Person b) { return Math.Abs(a.ID - b.ID) > 5; }
} 
```

然后

```
 Person p1 = new Person() { ID = 1 };
 Person p2 = new Person() { ID = 4 };

 bool b1 = p1 == p2;
 bool b2 = p1.Equals(p2); 
```

b1 为*真*，但 b2为*假*

**- 编辑 -**

现在假设你想这样做

```
Dictionary<Person, Person> dict = new Dictionary<Person, Person>();
dict.Add(p1, p1);
var x1 = dict[p2]; //Since p2 is supposed to be equal to p1 (according to `==`), this should return p1 
```

但这会引发类似 KeyNotFound 的异常

但是如果你添加

```
public override bool Equals(object obj)
{
    return Math.Abs(ID - ((Person)obj).ID) <= 5; 
}
public override int GetHashCode()
{
    return 0;
} 
```

你会得到你想要的。

*编译器只是警告您可能会遇到类似的情况*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T21:49:46.570

您需要做的就是将另一个成员添加到您的结构中，例如 Forename。

因此，如果您有两个 ID 为 63 但名字不同的人，他们是否相等？

一切都取决于您要实现的“相同”定义。

使用更好的示例结构，编写一个点头应用程序来执行各种方法，看看当你改变相等和/或等价的定义时会发生什么，如果它们不完全一致，你最终会得到像 !(a == b) != (a != b)，这可能是真的，但是如果你不覆盖所有使用你的代码的方法，那么你的代码会想知道你的意图是什么。

基本上，编译器是在告诉你做个好公民并明确你的意图。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-28T21:03:15.087

可能是因为默认`Equals()`方法对于实际系统来说不够好（例如，在你的类中它应该比较`ID`字段）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-28T21:07:05.863

如果您覆盖`Equals`并且`GetHashCode`您甚至不需要覆盖运算符，那是一种更清洁的方法。编辑：它应该可以工作，因为这是一个结构。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-28T21:07:47.650

阅读 MSDN 页面。

[CS0660](http://msdn.microsoft.com/en-us/library/4wtxwb6k%28v=vs.90%29.aspx)

[CS0661](http://msdn.microsoft.com/en-us/library/xsf9f0ex%28v=vs.90%29.aspx)

编译器基本上是在说：“既然你说知道如何比较你的对象，你应该让它一直这样比较。”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-06T09:45:26.203

```
public struct Coord
{
    public int x;
    public int y;

    public Coord(int x, int y)
    {
        this.x = x;
        this.y = y;
    }

    public static bool operator ==(Coord c1, Coord c2)
    {
        return c1.x == c2.x && c1.y == c2.y;
    }

    public static bool operator !=(Coord c1, Coord c2)
    {
        return !(c1 == c2);
    }

    public bool Equals(Coord other)
    {
        return x == other.x && y == other.y;
    }

    public override bool Equals(object obj)
    {
        if (ReferenceEquals(null, obj)) return false;
        return obj is Coord && Equals((Coord) obj);
    }

    public override int GetHashCode()
    {
        return 0;
    }
} 
```

这是一个例子。希望它会有所帮助。

# javascript - JS Div 重叠

> ID：10790371
> 
> 赞同：0
> 
> 时间：2012-05-28T21:00:37.127
> 
> 标签：javascript, jquery, html

好吧，这让我很生气，我不知道我做错了什么我有多个宽度为 350 像素，高度为 100 像素的 div，我想避免它们重叠......这是我目前拥有的代码但它们仍然重叠，我不知道我做错了什么

```
 <html>
<head>
    <title>WebWall</title>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <style type="text/css">
        .timeliner{
            width: 350px;
            height: 100px;
            background: #eeeeee;
            border-radius: 4px;
            background: #f8faf9; /* Old browsers */
            background: -moz-linear-gradient(top,  #f8faf9 0%, #c1cdcc 100%); /* FF3.6+ */
            background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f8faf9), color-stop(100%,#c1cdcc)); /* Chrome,Safari4+ */
            background: -webkit-linear-gradient(top,  #f8faf9 0%,#c1cdcc 100%); /* Chrome10+,Safari5.1+ */
            background: -o-linear-gradient(top,  #f8faf9 0%,#c1cdcc 100%); /* Opera 11.10+ */
            background: -ms-linear-gradient(top,  #f8faf9 0%,#c1cdcc 100%); /* IE10+ */
            background: linear-gradient(top,  #f8faf9 0%,#c1cdcc 100%); /* W3C */
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f8faf9', endColorstr='#c1cdcc',GradientType=0 ); /* IE6-9 */
            opacity: 0.9;
            display: none;
            position: absolute;

        }
        .timeline_title{
            font-family: Arial;
            font-weight: bold;
            font-size: 18px;
            color: #333333;
            text-shadow: 0 1px 0 #ffffff;
        }

        .timeline_subtitle{
            font-family: Arial;
            font-weight: bold;
            font-size: 13px;
            color: #555555;
            text-shadow: 0 1px 0 #ffffff;
        }

        .timeline_text{
            font-family: Arial;
            font-size: 12px;
            color: #777777;
            text-shadow: 0 1px 0 #ffffff;
        }
    </style>
    <script type="text/javascript">
        var vert_array = new Array();
        var hori_array = new Array();

        function getRandomizer(a,b) {
            var y = (Math.floor( Math.random()* (1+b-a) ) ) + a;
            var check = checky(y); // 200
            if(check==1){
                return y;
            }
            else{
                getRandomizer(a,b);
            }
        }

        function getRandomizerx(a,b) {
            var x = (Math.floor( Math.random()* (1+b-a) ) ) + a;
            var check = checkx(x); // 200
            if(check==1){
                return x;
            }
            else{
                getRandomizer(a,b);
            }
        }

        function checky(y){
            for(var i = 0; i<=vert_array.length;i++){
                if(y>=vert_array[i] && y<=vert_array[i]+100){
                    return 0;
                }
                else{
                    return 1;
                }
            }
        }

        function checkx(x){
            for(var i = 0; i<=hori_array.length;i++){
                if(x>=hori_array[i] && x<=hori_array[i]-350){
                    return 0;
                }
                else{
                    return 1;
                }
            }
        }

        function slide_in(div){
            var y = getRandomizer(100, 600);
            document.getElementById(div).style.top = y + "px";
            document.getElementById(div).style.display="block";
            vert_array.push(y);
            var x = getRandomizerx(1, 1000);
            hori_array.push(x);
            $("#" + div).animate({
                left: x + "px"
            },1200);
        }

        function init(){
            vert_array.push(100);
            hori_array.push(1);
            slide_in('timeline_1');
            setTimeout("slide_in('timeline_2')",2000);
            setTimeout("slide_in('timeline_3')",4000);
        }
    </script>
</head>
<body onload="javascript: init();" style="background: #111111; background-image: url('http://newevolutiondesigns.com/images/freebies/hd-wallpaper-8.jpg');">
    <div id="timeline_1" class="timeliner">
        <table width="100%" height="100%" cellspacing="0" cellpadding="0">
            <tr valign="top">
                <td style="padding: 10px; width: 80px;">
                    <div style="border-radius: 4px; box-shadow:inset 0 0 20px #000000; position: absolute; top: 10px; height: 80px; width: 80px;"></div>
                    <img height="80" width="80" style="border-radius: 4px; box-shadow:inset 0 0 20px #000000; background: #333333;" src="http://i1.ytimg.com/i/H-_hzb2ILSCo9ftVSnrCIQ/1.jpg?v=4f457758">
                </td>
                <td align="left" style="padding: 12px;">
                    <span class="timeline_title"></span><br>
                    <span class="timeline_subtitle"></span><br>
                    <span class="timeline_text"></span>
                </td>
            </tr>
        </table>
    </div>
    <br>
    <div id="timeline_2" class="timeliner">
        <table width="100%" height="100%" cellspacing="0" cellpadding="0">
            <tr valign="top">
                <td style="padding: 10px; width: 80px;">
                    <div style="border-radius: 4px; box-shadow:inset 0 0 20px #000000; position: absolute; top: 10px; height: 80px; width: 80px;"></div>
                    <img height="80" width="80" style="border-radius: 4px; box-shadow:inset 0 0 20px #000000; background: #333333;" src="http://i2.ytimg.com/i/y1Ms_5qBTawC-k7PVjHXKQ/1.jpg?v=b1e249">
                </td>
                <td align="left" style="padding: 12px;">
                    <span class="timeline_title"></span><br>
                    <span class="timeline_subtitle"></span><br>
                    <span class="timeline_text"></span>
                </td>
            </tr>
        </table>
    </div>
    <div id="timeline_3" class="timeliner">
        <table width="100%" height="100%" cellspacing="0" cellpadding="0">
            <tr valign="top">
                <td style="padding: 10px; width: 80px;">
                    <div style="border-radius: 4px; box-shadow:inset 0 0 20px #000000; position: absolute; top: 10px; height: 80px; width: 80px;"></div>
                    <img height="80" width="80" style="border-radius: 4px; box-shadow:inset 0 0 20px #000000; background: #333333;" src="img/f###.png">
                </td>
                <td align="left" style="padding: 12px;">
                    <span class="timeline_title"></span><br>
                    <span class="timeline_subtitle"></span><br>
                    <span class="timeline_text"></span>
                </td>
            </tr>
        </table>
    </div>
</body> 
```

页面加载时调用函数 init()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:42:08.430

你是对的，第一个解决方案不起作用。我认为这是一个快速修复，但......不。不过，这应该可行。

[http://jsfiddle.net/fWP2u/1/](http://jsfiddle.net/fWP2u/1/)

# javascript - Browser's previous or next button control

> ID：10790373
> 
> 赞同：1
> 
> 时间：2012-05-28T21:00:41.353
> 
> 标签：javascript, jquery

i want to access browser previous or next button using jQuery.When i click browser previous button i want to see alert("yes"); or any response.is it possible?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T21:02:42.513

Yes. It is *(somehow)* possible in HTML5\. It does not require jQuery. Use `onpopstate` for that.

MDN: [https://developer.mozilla.org/en/DOM/window.onpopstate](https://developer.mozilla.org/en/DOM/window.onpopstate)

```
window.onpopstate = function(event) {  
    alert("location: " + document.location);  
}; 
```

But in order to use `onpopstate`, you will have to use `pushState` first.

**DEMO:** [http://jsfiddle.net/DerekL/LZCj7/show](http://jsfiddle.net/DerekL/LZCj7/show)

PS: it is originally made for AJAX applications.

Alternative method:

```
<body onbeforeunload="return 'This is an alert.'"> 
```

# ruby-on-rails - (Rails) I have 2 models, Area (parent) & RadioStation (child). How might I pull an Area object's name in a Station form using an :area_id foreign key?

> ID：10790375
> 
> 赞同：0
> 
> 时间：2012-05-28T21:00:50.737
> 
> 标签：ruby-on-rails, controller, foreign-keys, parent-child, asp.net-mvc-scaffolding

I have two "CRUD" forms generated by the "rails g scaffold ModelName type:attribute1, type2:attribute2" command, which is quite powerful.

I'll try to just show what is relevant. First here are my models (attr_accessible tells the db migration stories for the most part)

```
class Area < ActiveRecord::Base
  attr_accessible :description, :frequency, :name, :area_id
  has_many :stations
end

class Station < ActiveRecord::Base
  attr_accessible :description, :frequency, :name, :area_id
  belongs_to :area
end 
```

Next, here is the _form.html.erb for a Station object (currently I'm using a simple drop down which is OK, but I want those :area_id tags to somehow be able to pull the Area.find(params[:area_id]).name, or something like that. If '1' is Denver and '2' is Boulder, I want '1` to pull 'Denver' and so on on the Station _form.

So here is stations_controller.rb, which was generated by the "generate scaffold" command for the most part.

```
class StationsController < ApplicationController

  def index

  @stations = Station.all

    respond_to do |format|
    format.html # index.html.erb
    format.json { render json: @stations }

 end

 end

  def show
    @station = Station.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @station }
    end
  end

  def new
    @area_count = Area.count
    @station = Station.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @station }
    end
  end

  def edit
    @station = Station.find(params[:id])
  end

  def create
   @station = Station.new(params[:station])

    respond_to do |format|
      if @station.save
        format.html { redirect_to @station, notice: 'Station was successfully created.' }
        format.json { render json: @station, status: :created, location: @station }
  else
        format.html { render action: "new" }
        format.json { render json: @station.errors, status: :unprocessable_entity }
      end
    end
  end

  def update
    @station = Station.find(params[:id])

    respond_to do |format|
      if @station.update_attributes(params[:station])
        format.html { redirect_to @station, notice: 'Station was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @station.errors, status: :unprocessable_entity }
      end
    end
  end

  def destroy
    @station = Station.find(params[:id])
    @station.destroy

    respond_to do |format|
      format.html { redirect_to stations_url }
      format.json { head :no_content }
    end
  end
end 
```

Lastly, here is the _form.html.erb for Station

```
<%= form_for(@station) do |f| %>
  <% if @station.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@station.errors.count, "error") %> prohibited this station from     being saved:</h2>

      <ul>
      <% @station.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :name %><br />
    <%= f.text_field :name %>
  </div>
  <div class="field">
    <%= f.label :frequency %><br />
   <%= f.text_field :frequency %>
  </div>
  <div class="field">
    <%= f.label :description %><br />
    <%= f.text_field :description %>
  </div>
  <div class="field">
    <%= f.label :area_id %><br />
    <%= f.select(:area_id, 1..@area_count) %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

So to reiterate my goal/question, what I have currently for the :area_id selector is a dropdown bar which allows me to select from 1.."Area.count". I would like that drop down bar to list the names of the the different areas given the area_id.

Also, I'd like to be able to see a list of Station objects which are "owned" by a given area on the list of areas or perhaps just on the show.html.erb for a given Area.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:14:38.033

**对于选择框：**

您应该使用[collection_select](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-collection_select)表单助手。

代替

```
<%= f.select(:area_id, 1..@area_count) %> 
```

和

```
<%= f.collection_select :area_id, Area.all, :id, :name %> 
```

**用于在区域的显示视图上显示电台列表：**

有几种方法可以做到这一点，具体取决于您希望如何在 HTML 中显示它们。

这是获取以逗号分隔的电台名称列表的一种方法：

```
<%= @area.stations.pluck(:name).join(", ") %> 
```

如果您需要除了 just 之外的站点的其他属性，则`:name`可以迭代集合而不是使用 pluck：

```
<ul>
  <% @area.stations.each do |s| %>
    <li><%= s.name %> - <%= s.frequency %></li>
  <% end %>
</ul> 
```

# php - count first time occurrence of foreign keys

> ID：10790376
> 
> 赞同：0
> 
> 时间：2012-05-28T21:00:52.467
> 
> 标签：php, mysql

Besides the tags, I would like to solve this on query, if possible. I have this table

```
activity_type | value | date       | company_id
network.new   | 1     | 2011-10-08 | 1
members.count | 3     | 2011-10-08 | 1
network.new   | 1     | 2011-10-10 | 2
network.new   | 1     | 2011-10-11 | 3
members.count | 4     | 2011-10-11 | 2 
```

*   That's basically a log activity.
*   'network.new' activity occur only once per company_id
*   'members_count' activity occur only after 'network.new' appears per company_id and can appear once per day per company_id.

I need to make a line graph that the X axis is the date, the Y axis is the quantity of two things:

1.  How many company_ids have members each day of activity for the **first time** (That is the one that is giving me a hard time);
2.  How many have the network.new activity and only that activity for each given day.

All queries I tried gave me false-positive lists, mostly because it counts company_ids that have the 'members_count' activity every day.

I wish, if possible, to create a query that give me date, first_time_members, new_company columns for `create view` purposes. I hope my question was clear enough, and not silly because I couldn't find it anything that looks close to my problem anywhere.

**[EDIT]**

Since my english is really poor, I couldn't make myself clear I'm going to try explain a litle more:

> My client have a network of companies and he wishes to learn how many companies join the network day by day but there's a catch: A company when sign in for the network, it is only considered a completed one when it is also had registered members. So he wants to know, how many companies make a 'incomplete' sign up and how many make a 'complete' sign up.

Mr Ollie Jones put me in the right direction, I think I can use what he tough me, but it is not right there yet. Thank ollie Jones for your answer by the way. Answers like yours made me love this site.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T01:35:46.130

我会伸出我的脖子，猜猜你想要什么。您是在询问“每天有多少 company_ids 第一次有活动成员”。恕我直言，这是一个很难理解的声明。

我认为您的意思是：对于每一天，在 network.new 活动类型中第一次出现多少 company_id 值，其中有多少伴随着非零成员。在同一天计数项目，有多少是不是？

这是你要做的：

首先考虑一个查询，它将给出系统中出现的每家公司的第一个日期。尝试这个。

```
SELECT MIN(date) networknewdate, company_id
  FROM table
 WHERE activity_type = 'network.new'
 GROUP BY company_id 
```

这会产生一个networknewdate 的虚拟表company_id。

接下来，您需要一个查询，该查询将为每个公司提供 members.count 项目出现的第一个日期。

```
 SELECT MIN(date) memberscountdate, company_id
     FROM table
    WHERE activity_type = 'members.count'
    GROUP BY date 
```

好的，现在我们有两个不错的虚拟表，每个 company_id 值最多有一行。让我们加入他们，将加入从第一个 (network.new) 值中移除。

```
 SELECT a.networknewdate, 
         a.company_id,
         IFNULL(b.members_present, 'no') members
    FROM (
      SELECT MIN(date) networknewdate, company_id
        FROM table
       WHERE activity_type = 'network.new'
       GROUP BY company_id
    ) a
    LEFT JOIN (
     SELECT MIN(date) memberscountdate, company_id, 'yes' members_present
       FROM table
      WHERE activity_type = 'members.count'
      GROUP BY date
    ) b ON (a.networknewdate = b.memberscountdate and a.company_id = b.company_id) 
```

这将返回三列：日期、company_id 和“yes”或“no”，表示是否有第一个 members.count 记录与每个 company_id 的第一个 network.new 记录在同一天。

现在您需要总结整个事情，以便您每天获得一条记录，列出“是”项的数量和“否”项的数量。开始了。

每天“是”记录的数量。

```
SELECT networknewdate, count(*) yesrecords
  FROM (
      SELECT a.networknewdate, 
             a.company_id,
             IFNULL(b.members_present, 'no') members
        FROM (
          SELECT MIN(date) networknewdate, company_id
            FROM table
           WHERE activity_type = 'network.new'
           GROUP BY company_id
        ) a
        LEFT JOIN (
         SELECT MIN(date) memberscountdate, company_id, 'yes' members_present
           FROM table
          WHERE activity_type = 'members.count'
          GROUP BY date
        ) b ON (a.networknewdate = b.memberscountdate and a.company_id = b.company_id)
     ) r
 WHERE r.members = 'yes'
 GROUP BY networknewdate 
```

按日期的无记录数是一个类似的查询。然后，您需要在 networknewdate 上将这两个查询左连接在一起，这样您就可以得到一个日期表，yesrecords，norecords。我将把它作为一个剪切粘贴练习留给你。它比我写的以`GROUP BY networknewdate`.

欢迎使用实现真实世界业务逻辑的 SQL！我认为关于这个问题的带回家的教训是，您要求的结果实际上很难指定。一旦你准确地指定了你想要的，编写一个查询来得到它是乏味和重复的，但并不难。

另一个小提示。创建一些视图可能对您有意义，这样您的查询就不会那么庞大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T15:13:31.190

因此，使用 Ollie jones 向我展示的相同方法，我想通了：首先，我需要一个“members_count”或“network.new”发生的日期列表

```
SELECT date as current_date
FROM activity_log ld
WHERE `activity_type` in ('members_count', 'network.new')
GROUP BY date
ORDER BY date 
```

他们我离开了加入第一次出现的公司列表

```
SELECT MIN(date) AS new_date, company_id
FROM activity_log
WHERE activity_type =  'network.new'
GROUP BY company_id
ORDER BY date 
```

也离开了 首次加入公司计数成员

```
 SELECT min(date) as members_count_date, company_id 
FROM `activity_networks` WHERE `activity_type` = 'network.daily.members_count'
GROUP BY company_id 
ORDER BY date 
```

然后 a 按日期对新公司和首次统计成员的公司进行明确计数。然后我有这个：

```
 SELECT DATE(FROM_UNIXTIME(ld.date)) as curr_date,
COUNT(DISTINCT(new_co)) as new_co,
COUNT(DISTINCT(complete_co)) as complete
FROM activity_log ld 
LEFT JOIN (SELECT date AS new_date, company_id as new_co
FROM activity_networks
WHERE activity_type =  'network.new'
GROUP BY company_id
ORDER BY date) nd ON (ld.date=nd.new_date)
LEFT JOIN (SELECT min(date) as members_count_date, company_id as complete_co
FROM `activity_log` WHERE `activity_type` = 'members_count'
GROUP BY company_id 
ORDER BY date) mcd ON (mcd.members_count_date=ld.date)
WHERE `activity_type` in ('members_count', 'network.new')
GROUP BY DATE(FROM_UNIXTIME(ld.date))
ORDER BY ld.date 
```

独特的功能至关重要，因为没有它，计数就不会正确。它并不完美。我命名的列`'new_co'`应该只带来不完整的注册（不完整的意思是新注册，没有与公司关联的成员），但这些信息仍然很有用。

# python - In app engine, can I call "get_or_insert" from inside a transaction?

> ID：10790381
> 
> 赞同：2
> 
> 时间：2012-05-28T21:01:29.970
> 
> 标签：python, google-app-engine

In google app engine, can I call "get_or_insert" from inside a transaction?

The reason I ask is because I'm not sure if there is some conflict with having this run its own transaction inside an already running transaction.

Thanks!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T17:36:51.897

实际上，这取决于您使用的是 NDB 还是旧的 db 包。尼克的回答仅适用于旧的 db 包。但是，在 NDB 中， get_or_insert() 会加入当前事务（如果有的话）。如果在事务外部调用，它会创建自己的事务。这与此处记录的propagation=ALLOWED 的语义相匹配： [https ://developers.google.com/appengine/docs/python/ndb/functions#context_options](https://developers.google.com/appengine/docs/python/ndb/functions#context_options)

（尼克在加入现有事务时对实体组的限制是正确的。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T00:22:59.823

No.`get_or_insert`是获取或插入记录的事务函数的语法糖。您可以自己简单地实现它，但这仅在您正在操作的记录与当前事务中的其余实体位于同一实体组中，或者您启用了跨组事务时才有效。

# redis - How can I clear all Instances of type X in ServiceStack Redis Client

> ID：10790385
> 
> 赞同：1
> 
> 时间：2012-05-28T21:01:37.933
> 
> 标签：redis, servicestack

I want to clear all X instance from Redis Db for testing. But I could not find redisClient.As().CLEAR() method? How can I clear all X instance?

I can add X Instances using

```
var client=new PooledRedisClientManager(ConfigurationManager.AppSettings["RedisServer"]).GetClient();
X x=new X();
client.As<X>().Store(x); 
```

all x instances are added to Db as urn:X:x.id pattern.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:23:04.750

IRedisTypedClient实现了具有[方法](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.Interfaces/Redis/Generic/IRedisTypedClient.cs#L21)的通用[IBasicPersistenceProvider<T>](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.Interfaces/DataAccess/IBasicPersistenceProvider.Generic.cs#L30)`DeleteAll()`接口。所以你所追求的只是：

```
client.As<T>().DeleteAll(); 
```

对于更细粒度的删除选项，您还可以：

```
client.As<T>().DeleteById(id);
client.As<T>().DeleteByIds(ids); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:08:29.373

如果您使用的是 RedisNativeClient 类，则可以使用此方法删除特定键：

```
 public int Del(string key) 
```

如果要删除所有键，可以使用 * 作为键调用 Del

你也有这些方法：

```
 public void FlushDb()
 public void FlushAll() 
```

如果你使用的是 RedisClient 类，你有这个方法：

```
 public bool Remove(string key) // Again i guess you can use the * for delete all keys 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T21:59:15.933

客户端.As().DeleteAll();

我认为命名“删除”是为了关系。

User.Cars.Remove("红车")

如果你想删除对象“删除”:)

删除（“红车”）

这没用。我越来越奇怪{“'del'命令的参数数量错误，sPort：19570，LastCommand：”}错误。

# twitter4j - E/AndroidRuntime(585): java.lang.NoClassDefFoundError twitter4j.http.AccessToken

> ID：10790390
> 
> 赞同：0
> 
> 时间：2012-05-28T21:02:01.130
> 
> 标签：twitter4j

我一直在关注这个教程

[http://www.android10.org/index.php/articleslibraries/291-twitter-integration-in-your-android-application](http://www.android10.org/index.php/articleslibraries/291-twitter-integration-in-your-android-application)

我为 consumer_key 和 consumer_secret 输入了这些详细信息

```
public class Constants {

    public static final String CONSUMER_KEY = "<FILL IN YOUR CONSUMER KEY FROM TWITTER HERE>";
    public static final String CONSUMER_SECRET= "<FILL IN YOUR CONSUMER SECRET FROM TWITTER HERE>";

    public static final String REQUEST_URL = "http://api.twitter.com/oauth/request_token";
    public static final String ACCESS_URL = "http://api.twitter.com/oauth/access_token";
    public static final String AUTHORIZE_URL = "http://api.twitter.com/oauth/authorize";

    public static final String  OAUTH_CALLBACK_SCHEME   = "x-oauthflow-twitter";
    public static final String  OAUTH_CALLBACK_HOST     = "callback";
    public static final String  OAUTH_CALLBACK_URL      = OAUTH_CALLBACK_SCHEME + "://" + OAUTH_CALLBACK_HOST;

} 
```

然后我添加了 lib 目录 .classpath 也是一个带有此路径 .gitignore 的文本文档

这允许文件被识别为我添加的新库文件。

这是我的错误日志

```
05-28 21:10:10.586: E/dalvikvm(538): Could not find class 'twitter4j.http.AccessToken', referenced from method alex.android.twitter.feed.TwitterUtils.isAuthenticated
05-28 21:10:10.586: W/dalvikvm(538): VFY: unable to resolve new-instance 67 (Ltwitter4j/http/AccessToken;) in Lalex/android/twitter/feed/TwitterUtils;
05-28 21:10:10.596: D/dalvikvm(538): VFY: replacing opcode 0x22 at 0x0010
05-28 21:10:10.596: E/dalvikvm(538): Could not find class 'twitter4j.http.AccessToken', referenced from method alex.android.twitter.feed.TwitterUtils.sendTweet
05-28 21:10:10.596: W/dalvikvm(538): VFY: unable to resolve new-instance 67 (Ltwitter4j/http/AccessToken;) in Lalex/android/twitter/feed/TwitterUtils;
05-28 21:10:10.606: D/dalvikvm(538): VFY: replacing opcode 0x22 at 0x0010
05-28 21:10:10.606: D/dalvikvm(538): DexOpt: unable to opt direct call 0x006c at 0x12 in Lalex/android/twitter/feed/TwitterUtils;.isAuthenticated
05-28 21:10:10.606: D/dalvikvm(538): DexOpt: unable to opt direct call 0x006a at 0x17 in Lalex/android/twitter/feed/TwitterUtils;.isAuthenticated
05-28 21:10:10.606: D/dalvikvm(538): DexOpt: unable to opt direct call 0x006c at 0x12 in Lalex/android/twitter/feed/TwitterUtils;.sendTweet
05-28 21:10:10.606: D/dalvikvm(538): DexOpt: unable to opt direct call 0x006a at 0x17 in Lalex/android/twitter/feed/TwitterUtils;.sendTweet
05-28 21:10:10.606: D/AndroidRuntime(538): Shutting down VM
05-28 21:10:10.616: W/dalvikvm(538): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
05-28 21:10:10.636: E/AndroidRuntime(538): FATAL EXCEPTION: main
05-28 21:10:10.636: E/AndroidRuntime(538): java.lang.NoClassDefFoundError: twitter4j.http.AccessToken
05-28 21:10:10.636: E/AndroidRuntime(538):  at alex.android.twitter.feed.TwitterUtils.isAuthenticated(TwitterUtils.java:17)
05-28 21:10:10.636: E/AndroidRuntime(538):  at alex.android.twitter.feed.TwitterActivity.updateLoginStatus(TwitterActivity.java:74)
05-28 21:10:10.636: E/AndroidRuntime(538):  at alex.android.twitter.feed.TwitterActivity.onResume(TwitterActivity.java:70)
05-28 21:10:10.636: E/AndroidRuntime(538):  at android.app.Instrumentation.callActivityOnResume(Instrumentation.java:1154)
05-28 21:10:10.636: E/AndroidRuntime(538):  at android.app.Activity.performResume(Activity.java:4539)
05-28 21:10:10.636: E/AndroidRuntime(538):  at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2434)
05-28 21:10:10.636: E/AndroidRuntime(538):  at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2472)
05-28 21:10:10.636: E/AndroidRuntime(538):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1986)
05-28 21:10:10.636: E/AndroidRuntime(538):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
05-28 21:10:10.636: E/AndroidRuntime(538):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
05-28 21:10:10.636: E/AndroidRuntime(538):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-28 21:10:10.636: E/AndroidRuntime(538):  at android.os.Looper.loop(Looper.java:137)
05-28 21:10:10.636: E/AndroidRuntime(538):  at android.app.ActivityThread.main(ActivityThread.java:4424)
05-28 21:10:10.636: E/AndroidRuntime(538):  at java.lang.reflect.Method.invokeNative(Native Method)
05-28 21:10:10.636: E/AndroidRuntime(538):  at java.lang.reflect.Method.invoke(Method.java:511)
05-28 21:10:10.636: E/AndroidRuntime(538):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-28 21:10:10.636: E/AndroidRuntime(538):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-28 21:10:10.636: E/AndroidRuntime(538):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T06:49:39.657

我在我的项目中也遇到了同样的问题。我将文件夹名称**lib**更改为**libs**然后它对我来说很好。

此问题是由于库的管理方式与新 ADT 构建不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T21:08:21.870

NoClassDefFoundError 意味着您的一个库依赖于另一个找不到的库。如果您没有将所有正确的库放在类路径中，则很可能会出现此错误。

例如，当 twitter 库使用 slf4j 库进行日志记录，但您尚未将其包含在类路径中时，就会出现此错误。

此外，下次发布时，请确保输入完整的错误日志。仅 1 行没有太大帮助

# blackberry-playbook - PlayBook 的 HTML5 应用程序 - 如何“处理”手势？

> ID：10790398
> 
> 赞同：2
> 
> 时间：2012-05-28T21:03:43.360
> 
> 标签：blackberry-playbook, blackberry-webworks

我被要求使用 HTML5 构建一个剧本应用程序。那是我第一次使用 Playbook，我没有任何经验。我用谷歌搜索了一下，看起来我可以使用 WebWorks 创建可以部署在 Playbook 上的 HTML5 应用程序。所以这应该不是问题。**这是我的问题**：

1.  该 HTML5 应用程序是否支持手势（左/右滑动、多点触控等）？

2.  如果是 - 如何捕获它们（例如，如果我使用 jQuery）？

3.  与“本机”应用程序相比，手势是否有任何限制？

4.  能否请您指出有关 jQuery 和与 WebWorks 的手势集成的文档/教程？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T19:15:27.267

1.  是的
2.  是的，JavaScript。或者像 jQuery / jqMobi 之类的库，等等。那里有很多。
3.  不。
4.  查看[厨房水槽](https://github.com/blackberry/WebWorks-Samples)触摸/手势示例。

# python - 无法使用 Python 的 MYSQLdb 模块将行添加到数据库

> ID：10790403
> 
> 赞同：0
> 
> 时间：2012-05-28T21:04:41.133
> 
> 标签：python, mysql

对于我的生活，我无法弄清楚为什么下面的模块不会向我的数据库添加新行。我可以使用命令行界面添加它们。我也可以使用其他方式添加它们（即，将命令写入脚本文件并使用`os.system('...')`，但如果我使用`cursor.execute()`，则不会添加任何行（即使创建了表）。这是一个最小的脚本，供您查看乐趣。注意运行此脚本时没有收到任何错误或警告

```
#!/usr/bin/env python

import MySQLdb

if __name__ == '__main__':
   db = MySQLdb.connect ( host="localhost", user="user", passwd="passwd", db="db" )
   cursor = db.cursor()

   cursor.execute ( 
   """
      CREATE TABLE IF NOT EXISTS god_i_really_hate_this_stupid_library
      (
         id            INT NOT NULL auto_increment,
         username      VARCHAR(32) NOT NULL UNIQUE,
         PRIMARY KEY(id)
      ) engine=innodb;
   """
   )

   cursor.execute ( 
   """
      INSERT INTO god_i_really_hate_this_stupid_library
      ( username )
      VALUES
      ( 'Booberry' );
   """
   )

   cursor.close() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:07:01.650

您需要调用`commit`您的连接，否则所做的所有更改都将自动回滚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T21:11:37.727

来自MySQLdb的[常见问题解答：](http://mysql-python.sourceforge.net/FAQ.html#my-data-disappeared-or-won-t-go-away)

> Starting with 1.2.0, MySQLdb disables autocommit by default, as required by the DB-API standard (PEP-249). If you are using InnoDB tables or some other type of transactional table type, you'll need to do connection.commit() before closing the connection, or else none of your changes will be written to the database.
> 
> Conversely, you can also use connection.rollback() to throw away any changes you've made since the last commit.
> 
> Important note: Some SQL statements -- specifically DDL statements like CREATE TABLE -- are non-transactional, so they can't be rolled back, and they cause pending transactions to commit.

You can call `db.autocommit(True)` to turn autocommit on for the connection or just call `db.commit()` manually whenever you deem it necessary.

# sql-server - How to write a trigger firing when someone made specific changes and saved on SQL Server

> ID：10790404
> 
> 赞同：1
> 
> 时间：2012-05-28T21:04:50.600
> 
> 标签：sql-server, eventtrigger, xp-cmdshell

I am new to SQL triggers scripting. Right now, I want to write a trigger firing when someone modify a create or alter statement in table definition in SQL Server and saved.

Can someone please tell me what can make this happen and what kind of trigger should I research on?

So far I have only read some dml triggers tutorial and it's not quite alike to what I want.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T21:22:20.043

DDL 是我的选择。[http://msdn.microsoft.com/en-us/library/ms186406(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms186406(v=sql.105).aspx)

# php - User profiles custom css

> ID：10790408
> 
> 赞同：0
> 
> 时间：2012-05-28T21:05:02.417
> 
> 标签：php, javascript, css

In the site i'm developing i would like to have users set their own custom "css" on their profile pages.

For example, i give users the ability to select a background color for `<body>` with a js color picker.

Then with php i create a 'css-ready' string and save it on db.

What i am asking is: how i can make this css apply everytime a user enter another user profile?

Probably will be there a lot of thing a user can customize, so there will be a big css string and i need something that will be cross browser and if possible that work also without javascript..

Thank you.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T06:14:44.050

这可以使用 asp.net 中的 Handler 来完成。我相信 PHP 中也会有类似的解决方案。首先，您需要将每个用户的样式属性保存在数据库中。确保样式的语法（选择器名称、大括号、分号等）是有序的。您可以从会话对象中获取用户信息或将带有查询字符串的变量传递给处理程序。

从处理程序接收到的响应可以直接放在标签之间作为内容类型 - 文本/css，如下所示：

有了这个，你应该准备好了！

但是，它会导致性能损失，因为每次页面加载时，都会加载整个文件（在普通的 css 文件中，它只加载一次）。最好只将那些您真正希望用户自定义的项目保存在数据库中。您可以将它与您的父 css 文件级联以获得更好的性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:16:26.333

您可以尝试一个带有内容类型文本/css 标题的 php 文件，该文件根据从数据库中获取的 CSS 回显 CSS，您可以将默认 CSS 添加到您的网站，然后在链接标签列表中创建最后一个该 php 文件的路径, 这样你就有了一个默认的 CSS 来回退和自定义的 CSS 来应用在默认之上（如果有定义的话）..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T06:31:32.440

你可以使用这是 user-profile.tpl.php

```
<?php 
if(isset($account->user_css)){
?>
<style>
<?php echo $account->user_css; ?>
</style>
<?php
}
?> 
```

# java - Logback failsafe to console logging

> ID：10790410
> 
> 赞同：2
> 
> 时间：2012-05-28T21:05:13.303
> 
> 标签：java, logging, logback

I'm migrating a legacy app to use logback, in the process I'm trying to keep all of the old functionality working in the same way. One thing the legacy app did was log to the console if the log file could not be written (due to lack of space, bad permissions, etc)

With logback it seems a StatusListener should handle this, I can use getOrigin to get the sifted appender, but I can't figure out how to get the logger associated with the origin appender. Is it possible?

logback.xml:

```
<statusListener class="com.example.LogStatusListener"/>

<appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
  <encoder>
    <pattern>WARNING: %logger is only being logged to CONSOLE!%n%msg%n</pattern>
  </encoder>
</appender>

<appender name="FILE-SIMPLE" class="ch.qos.logback.classic.sift.SiftingAppender">
  <discriminator class="com.example.CustomDiscriminator"/>
  <sift>
    <appender name="FILE-${logfile}" class="ch.qos.logback.core.rolling.FileAppender">
      <file>${logfile}.log</file>
      <encoder>
        <pattern>%msg%n</pattern>
      </encoder>
    </appender>
  </sift>
</appender>

<logger name="debug">
  <appender-ref ref="FILE-SIMPLE" />
</logger> 
```

Listener:

```
public class LogStatusListener implements StatusListener {
    @Override
    public void addStatusEvent(Status status) {
        if (status instanceof ErrorStatus) {
            System.err.println(status);
            if (status.getOrigin() instanceof Appender) {
                Appender origin = (Appender) status.getOrigin();
                if (!origin.isStarted()) {
                    // find the logger associated with origin, and add ConsoleAppender
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:00:57.360

[任何logback](/questions/tagged/logback "显示标记为“logback”的问题")组件都可以生成状态消息，而不仅仅是 appender。状态消息没有与之关联的记录器，因此您无法获取状态消息的记录器。顺便说一下，logback 实现了从 I/O 错误中优雅的恢复。例如，如果磁盘已满，logback 将停止记录，并在磁盘上有可用空间时自动重新开始记录。请注意，在此期间发生的日志记录事件会丢失。

# php - Remove ellipsis (&helip;) after sub-string concatenation

> ID：10790411
> 
> 赞同：-1
> 
> 时间：2012-05-28T21:05:22.033
> 
> 标签：php, html, substring, concatenation

I am concatenating two sub-strings with an ellipsis (...) added at the end of the first sub-string. However I want this elipsis to be removed after the concatenation. Is this possible via a script or other means, Thanks:

`<?php echo substr($post_text_result2, 0, 400) . "&hellip;";?><div id="second_post" class = "hidden"><?php echo substr($post_text_result2, 400, 5000);?></div>`:

str_replace deletes the elipsis like requested, however does not fully work in my situation: The code below works however, The first sub-string is repeated. I need a way to remove the first sub-string.

```
<?php
$string = substr($post_text_result2, 0, 400) . "&hellip;"; 
echo $string;
?>

<div id="second_post" class = "hidden">

<?php       
$string= str_replace('&hellip;','',$string); echo $string;
echo $string;
echo substr($post_text_result2, 400, 5000);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:12:07.363

您可以存储第一个字符串 A 的长度，然后构建一个连接 2 个子字符串的新字符串：

```
substring 1 from 0 until length(A) - 3

substring 2 from length(A) until total length 
```

您也可以使用正则表达式并将“...”替换为“”，但这可能会删除其他可能不需要的“...”。

抱歉没有代码，我不会 PHP，但你知道怎么做；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T21:16:11.177

简单的

```
<?php

$string = substr($post_text_result2, 0, 400) . "&hellip;";
$string = str_replace('&hellip;','',$string);

?> 
```

如果您希望始终在末尾使用省略号，请执行以下操作：

```
<?php

$string = substr($post_text_result2, 0, 400) . "&hellip;";
$string = str_replace('&hellip;','',$string) . "&hellip;";

?> 
```

# scala - Databinder 调度：获取 403 响应的未压缩内容

> ID：10790412
> 
> 赞同：2
> 
> 时间：2012-05-28T21:06:05.473
> 
> 标签：scala, scala-dispatch

我正在使用数据绑定器调度发出 HTTP 请求，只要 Web 服务器返回 404，它就可以很好地工作。

如果请求失败，Web 服务器会返回 403 状态代码，并在响应正文中以 XML 格式提供详细的错误消息。

如何读取 xml 正文（不考虑 403），例如如何让调度忽略所有 403 错误？

我的代码如下所示：

```
class HttpApiService(val apiAccount:ApiAccount) extends ApiService {
  val http = new Http

  override def baseUrl() = "http://ws.audioscrobbler.com/2.0"

  def service(call:Call) : Response = {
    val http = new Http
    var req = url(baseUrl())
    var params = call.getParameterMap(apiAccount)

    var response: NodeSeq = Text("")

    var request: Request = constructRequest(call, req, params)
    // Here a StatusCode exception is thrown. 
    // Cannot use StatusCode case matching because of GZIP compression
    http(request <> {response = _})
    //returns the parsed xml response as NodeSeq
    Response(response)
  }

  private def constructRequest(call: Call, req: Request, params: Map[String, String]): Request = {
    val request: Request = call match {
      case authCall: AuthenticatedCall =>
        if (authCall.isWriteRequest) req <<< params else req <<? params
      case _ => req <<? params
    }
    //Enable gzip compression
    request.gzip
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:03:33.607

我*相信*这样的事情是有效的：

```
val response: Either[String, xml.Elem] = 
  try { 
    Right(http(request <> { r => r })) 
  } catch { 
    case dispatch.StatusCode(403, contents) => 
      Left(contents)
  } 
```

错误将在左侧。成功将是正确的。错误是一个应包含所需 XML 响应的字符串。

如果您需要更多，我相信您可以查看 HttpExecutor.x，它应该可以让您完全控制。不过，我已经有一段时间没有使用 dispatch 了。

另外，我建议使用更多的 val 和更少的 var。

# php - 将数据数组保存到 CSV 文件

> ID：10790413
> 
> 赞同：2
> 
> 时间：2012-05-28T21:06:17.683
> 
> 标签：php, arrays, csv, fopen

我需要将数据数组保存到 CSV 文件。问题如下：当我打开 CSV 文件时，我看到数组的 0 行与标题保存在同一行。标题的最后一列也包含 0，即“www0”。如何避免这种情况？

```
 header("Content-type: text/csv");
        header("Pragma: no-cache");
        saveCSV($solutionCSV);

function saveCSV($data) {
    $outstream = fopen("schedule.csv", "a");

    $headers = 'xxx, yyy, zzz, www';
    fwrite($outstream,$headers);

    function __outputCSV(&$vals, $key, $filehandler) {
        fputcsv($filehandler, $vals);
    }
    array_walk($data, "__outputCSV", $outstream);
    fclose($outstream);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:09:49.550

标题后需要换行符。请注意从单引号到双引号的更改以启用转义。

```
$headers = "xxx, yyy, zzz, www\n"; 
```

如果这会使 Windows 出错，请使用`\r\n`：

```
$headers = "xxx, yyy, zzz, www\r\n"; 
```

或者，您也可以依靠`fputcsv`编写标题。这可能是最安全的方法，因为它会产生一致的格式。

```
$headers = array('xxx', 'yyy', 'zzz', 'www');
fputcsv($outstream, $headers); 
```

# python - 将范围元组列表折叠到重叠范围中

> ID：10790415
> 
> 赞同：5
> 
> 时间：2012-05-28T21:06:24.443
> 
> 标签：python, tuples, overlapping-matches

我正在寻找解决此问题的内存效率最高的方法。

我有一个表示句子中部分字符串匹配的元组列表：

```
[(0, 2), (1, 2), (0, 4), (2,6), (23, 2), (22, 6), (26, 2), (26, 2), (26, 2)] 
```

每个元组的第一个值是匹配的开始位置，第二个值是长度。

这个想法是折叠列表，以便只报告最长的连续字符串匹配。在这种情况下，它将是：

```
[(0,4), (2,6), (22,6)] 
```

我不想要最长的范围，就像在[算法中找到最长的非重叠序列](https://stackoverflow.com/questions/4593583)一样，但我希望所有的范围都被最长的折叠。

如果您想知道，我正在使用 Aho-Corasick 的纯 python 实现来将静态字典中的术语与给定的文本片段匹配。

编辑：由于这些元组列表的性质，重叠但不是独立的范围应该单独打印出来。例如，在字典中有单词`betaz`and`zeta`的匹配项`betazeta`是`[(0,5),(4,8)]`。由于这些范围重叠，但没有包含在另一个范围内，因此答案应该是`[(0,5),(4,8)]`。我还修改了上面的输入数据集，以便涵盖这种情况。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T08:54:56.417

```
import operator
lst = [(0, 2), (1, 2), (0, 4), (2,6), (23, 2), (22, 6), (26, 2), (26, 2), (26, 2)]
lst.sort(key=operator.itemgetter(1))
for i in reversed(xrange(len(lst)-1)):
    start, length = lst[i]
    for j in xrange(i+1, len(lst)):
        lstart, llength = lst[j]
        if start >= lstart and start + length <= lstart + llength:
            del lst[i]
            break
print lst
#[(0, 4), (2, 6), (22, 6)] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:41:56.463

```
a = [(0, 2), (1, 2), (0, 4), (23, 2), (22, 6), (26, 2), (26, 2), (26, 2)]
b = [set(xrange(i, i + j)) for i, j in a]
c = b.pop().union(*b)
collapsed = sorted(c)
print collapsed
#Maybe this is useful?:
[0, 1, 2, 3, 22, 23, 24, 25, 26, 27]

#But if you want the requested format, then do this:
d = []
start = collapsed[0]
length = 0
for val in collapsed:
    if start + length < val:
        d.append((start,length))
        start = val
        length = 0
    elif val == collapsed[-1]:
        d.append((start,length + 1))
    length += 1
print d
#Output:
[(0,4), (22,6)] 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-28T23:06:01.723

因此，请相信您的主要兴趣是空间效率，这是一种做您想做的事情的方法：

```
lst = [(0, 2), (1, 2), (0, 4), (23, 2), (22, 6), (26, 2), (26, 2), (26, 2)]
lst.sort()
start, length = lst.pop(0)
i = 0
while i < len(lst):
    x, l = lst[i]
    if start + length < x:
        lst[i] = (start, length)
        i += 1
        start, length = x, l
    else:
        length = max(length, x + l - start)
        lst.pop(i)
lst.append((start, length)) 
```

这会修改列表，不会使列表变长，只使用少量变量来保持状态，并且只需要遍历列表

如果您不想就地修改列表，则可以使用更快的算法 - 从列表中间弹出项目可能会很慢，尤其是在列表很长的情况下。

一种合理的优化是保留要删除的索引的列表，然后返回并在第二遍中重建该列表，这样您就可以一次重建整个列表并避免`pop`开销。但这会占用更多内存！

# monodevelop - helloworld monodevelop 3.0.2 抛出异常

> ID：10790416
> 
> 赞同：1
> 
> 时间：2012-05-28T21:06:27.070
> 
> 标签：monodevelop

认为我遵循了 Xamarin hello world 教程，但是当我针对 IOS 模拟器启动时，会引发以下异常：

**此类与键 lblOutlet 的键值编码不兼容。**

好吧，所有的 Outlet 代码都是从 IB 生成的，不要告诉我不要使用 IB，因为这是 Mono 的一大吸引力。代码如下：使用 MonoTouch.Foundation；

```
namespace hello
{
    [Register ("helloViewController")]
   partial class helloViewController
   {
       [Outlet]
       MonoTouch.UIKit.UIButton btnClickMe { get; set; }

       [Outlet]
       MonoTouch.UIKit.UILabel lblOutput { get; set; }

       [Action ("actnButtonlick:")]
       partial void actnButtonlick (MonoTouch.Foundation.NSObject sender); 
```

# apache - Apache默认端口更改不起作用ubuntu 12.04

> ID：10790417
> 
> 赞同：7
> 
> 时间：2012-05-28T21:06:53.150
> 
> 标签：apache, ubuntu, localhost, port

我正在使用 Ubuntu 12.04

我试图将我的默认 apache2 端口从 80 更改为 8085
我编辑`/etc/apache2/ports.conf`

我将行编辑`Listen 80`为`Listen 8085`

然后重新启动我的 apache 服务
然后在浏览器中测试这个`http://localhost:8085`
结果是`404 Not Found`

然后我打开终端并运行

```
网络统计-tulpn | grep 8085
```

o/p 是：

```
tcp 0 0 0.0.0.0:8085 0.0.0.0:* 听      
```

难道我做错了什么？还是我错过了什么？

谢谢并恭祝安康！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-16T05:44:21.943

我几乎不得不猜测，鉴于您的配置是正确的，您只需要重新加载并重新启动 apache：

```
sudo service apache2 reload

sudo service apache2 restart 
```

如果没有，我相信为什么这没有得到答复是没有足够的基本信息发布，如“/var/log/apache2/error.info”输出或进一步解释，以及向我们提供您之前所做的配置.

希望你能处理好，不要放弃！

=^)

# windows - LINUX 上是否需要 UNALIGNED 内存访问（从 Windows 移植到 Linux）

> ID：10790422
> 
> 赞同：0
> 
> 时间：2012-05-28T21:07:21.097
> 
> 标签：windows, linux

我正在将代码从 Windows 移植到 Linux（Red Hat Linux 或 Fed）。在现有代码中，我确实找到了具有 (datatype UNALIGNED*) 引用的代码。

你能告诉我 1) 移植到 Linux 时需要 UNALIGNED 内存访问吗 2) 如果需要，你能告诉我如何实现相同的目标吗？

我四处寻找linux版本。我遇到过使用 arm/unaligned.h。当我尝试添加相同的内容时，它给了我一个错误“没有这样的文件或目录”。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T03:42:22.347

对齐是 CPU 限制，而不是操作系统。x86 CPU 可以进行非对齐访问（有一些性能损失），如果您尝试从对齐指针以外的其他东西加载单词，许多其他 CPU 在相同的 Linux（或其他）版本下会产生总线错误。

据我所知，MSVC 中的 UNALIGNED 关键字在 x86 上是一个 noop。在其他架构上，它将发出更复杂的指令序列以确保访问成功完成。你想找到一个 gcc 等价物吗？我不相信一个存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T04:50:55.607

最近`gcc`你可以考虑使用[`__attribute__ ((__packed__))`](http://gcc.gnu.org/onlinedocs/gcc/Type-Attributes.html)

但我建议尽可能避免使用它。编译器在对齐字段方面做得很好。ABI 可能会定义对齐规则。

您应该了解为什么您的源代码使用`UNALIGNED`; 是因为数据具有外部定义的格式，还是出于“性能”原因？把优化留给编译器！

# java - 为色盲人士增强图像

> ID：10790427
> 
> 赞同：13
> 
> 时间：2012-05-28T21:07:59.210
> 
> 标签：java, image, accessibility, color-blindness

我正在寻找一个易于使用的 Java 库，它提供了一些标准方法来增强色盲人的现有图像。我发现一些[浏览器插件](https://addons.mozilla.org/en-US/firefox/addon/colorblindext/)和网站做了这些增强，但我没有找到相应的 Java 库。是否有这样的库，如果没有，是否至少有一个很好的信息来源，我可以如何自己实现这个功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T03:32:32.927

我还没有找到任何色盲专用库，但我确实遇到了一个非常有趣的文档，它解释了如何构建 Mozilla 色盲插件。该插件使用 Java Advance Imaging (JAI) 库来提高可读性。以下是该文档的链接：

[http://www.faer.ac.in/motorola/pdf/04_Mozilla%20Firefox%20Extension.pdf](http://www.faer.ac.in/motorola/pdf/04_Mozilla%20Firefox%20Extension.pdf)

编辑：文档说扩展的代码是开源的。

# javascript - 查找警告源的最佳方法：传递给 getElementById() 的空字符串

> ID：10790435
> 
> 赞同：60
> 
> 时间：2012-05-28T21:08:33.510
> 
> 标签：javascript, jquery

> 警告：传递给 getElementById() 的空字符串。
> 源文件：chrome://browser/content/browser.xul
> 行：0

几天前，我在开发我的网站时开始收到上述消息。事情正在按他们应该的方式工作（或者至少我认为是这样），但我想知道这是从哪里来的。我使用 jQuery，所以不要`getElementById()`直接使用。另外，我有 Firebug 和运行 Firefox 的 Web Developer 扩展。

我可以费力地输入代码来检查给 jQuery 选择的空字符串，或者查看 jQuery 本身，但我的技能很少，所以我在这里问是否有人有一个快速定位来源的好主意警告信息。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-28T21:13:24.883

```
Source File: chrome://browser/content/browser.xul 
```

这意味着错误在 Firefox 扩展中，而不是在您的代码中。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2019-07-29T09:25:19.233

在 Firefox 中收到此警告。

我刚刚遇到此警告，发现输入字段有标签，但属性标签未设置/为空，因此只需完成 for 属性即可为我解决此问题。

```
// Label's for attribute not set which caused the warning in FF

e.g. <label for=''>Text</label><input type="text" name="text" id="text" value="" /> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-27T19:35:03.560

如果您通过 '#' 选择器进行查询 - 确保选择器是唯一的（应该是唯一的），否则您最终会在 ff 中出现此错误

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-11T01:18:53.950

就我而言，这是由 Firefox 对我的表单上的输入字段执行 HTML5 检查引起的。一旦从表单元素中删除了“必需”属性，一切似乎又可以正常工作了。

这是我使用的 MVC 框架带来的东西，它根据需要字段非空的模型验证规则生成这些属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-13T00:34:51.567

这个答案对我找到它发生的原因非常有帮助，所以我决定分享。

我已将以下代码放在**外面** `document.ready`并收到此错误。

```
// Enable Line Items ONLY AFTER general info is filled out!
$( "#client_estimate_continue_next" ).click(function(e) {
//e.preventDefault();
console.log(this.id + ' click event fired.');

// DO SOMETHING...

}); 
```

我可以通过简单地把它放在里面来修复**错误** `document.ready`

附加信息：

我收到了错误，但**在我的情况下，它来自我自己的脚本**，根据 FireFox。

我相信我得到了错误，因为我引用了一个尚未完全呈现的元素的 id，例如。**还没准备好**。

> 警告：传递给 getElementById() 的空字符串。

# xcode - Xcode 4.3.2、GIT 和 Localizable.strings：编辑器感到困惑

> ID：10790436
> 
> 赞同：0
> 
> 时间：2012-05-28T21:08:40.263
> 
> 标签：xcode, git, localizable.strings

我上周为我正在工作的 Xcode 项目安装了 GIT，从那时起，我遇到了各种奇怪的问题。现在真正让我烦恼的是，当我编辑我的 localizable.strings （我有法语和英语文本）时，它们在 Xcode 中都变得相同，即如果我编辑英文的，然后打开法语的，它会显示与英文文本。但是如果我用文本编辑器直接在磁盘上编辑文件，它仍然包含正确的文本。我发现正确显示它的唯一方法是退出 Xcode 并重新打开它。

那么 GIT 和 Localizable 文件是否存在错误？

而在这期间：如果我在打开管理器并显示存储库时退出 Xcode，它就不会退出。编辑器窗口关闭，但管理器保持打开状态，从那里退出的唯一方法是杀死 Xcode。

谢谢，伯努瓦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T20:24:36.060

我已将 GIT 移回本地 Mac 磁盘，现在一切正常。所以我假设这是 Mac 和 Windows 服务器之间的某种安全/通信问题。

# python - 在 python 中为 websocket RFC 6455 提取/移位位

> ID：10790439
> 
> 赞同：0
> 
> 时间：2012-05-28T21:08:47.977
> 
> 标签：python, websocket

我正在尝试按照 RFC 6455 规范在 python 中实现我自己的 Websocket 服务器，并且我遇到了从基本帧头中提取位的问题

我对协议没有问题 我对基本的二进制/十六进制数学魔法有问题

根据规范，前 4 位是单个位值

所以为了获得第一点，我做了这样的事情（d是我来自websocket的数据）

```
first_byte = ord(d[0])
print "finished bit",(first_byte >> 7) & 1 
```

稍后，如果我想获得有效载荷大小，我会这样做

```
sec_byte = ord(d[1])
print "payload size",sec_byte & 0x7f 
```

然而，在规范的后面，我需要为操作码获取一个 4 位值，这就是我需要帮助的，甚至可能是一个指向这个数学如何工作的链接，我用谷歌搜索/duckduckgoed 我的大脑大部分结果来自stackoverflow

更多的修补和它开始到位我已经被困在这个问题上大约 4 天了，但仍然没有解决任何人都可以提供的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:51:04.730

如果您只需要考虑前 4 位（最高有效位），则需要右移 4 位（使用 And 进行额外屏蔽可能没有用，例如，如果您的值在 0-255 范围内，但它甚至会强调您的位'有兴趣）。例如

```
>>> d = [128, 80, 40]
>>> print (d[0] >> 4) & 15
8
>>> print (d[1] >> 4) & 15
5
>>> print (d[2] >> 4) & 15
2 
```

128 是二进制的`1000 0000`；右移 4 给出`0000 1000`（“新”0 位从左进入），即 8；80是`0101 0000`，让你获得`0000 0101`；最后是 40 `0010 1000`，我们得到`0000 0010`.

一般来说，考虑一个八位字节`abcd efgh`，每个字母都有一点。您必须转换 and 才能隔离您感兴趣的位。例如，假设您的规范说`cd`位定义了四种不同的东西。为了获得那个 0-3 的数字，你再右移 4，然后用 3，`0000 0011`也就是说，你“隔离”你想要的位。

# javascript - Socket.io Express 3 次会议

> ID：10790442
> 
> 赞同：7
> 
> 时间：2012-05-28T21:09:06.647
> 
> 标签：javascript, node.js, express, socket.io

有没有在 Express 3.0 中使用 Socket.io 会话的好方法？一种以安全方式获取客户会话 ID 的方法？以便我可以向特定于其帐户的成员发送通知并在成员之间进行私人聊天？

我在 Express 3.0 中使用 MySQL 存储

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-10T05:43:53.520

我写了一个小模块来抽象它，这是它的用法。它是使用 express 3、socket.io 0.9.10 和 connect 2.4.5 中的（默认）MemoryStore 编写和测试的。它应该适用于其他兼容的商店。

```
var SessionSockets = require('session.socket.io')
  , sessionSockets = new SessionSockets(io, sessionStore, cookieParser);

sessionSockets.on('connection', function (err, socket, session) {
  //your regular socket.io code goes here
}); 
```

有关其工作原理的更多详细信息，请参阅[https://github.com/wcamarao/session.socket.io](https://github.com/wcamarao/session.socket.io)

您可能需要注意 README 的一部分，它说明如何将它与您自己的会话存储密钥一起使用（我假设您的 mysql 存储使用默认的“connect.sid”以外的名称）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T20:38:36.417

您应该查看[express.io](http://express-io.org)，这是一个非常简单的用于 express 和 socket.io 集成的微框架。它自动处理 express 和 socket.io 会话。

```
npm install express.io 
```

在此处查看会话支持示例：

[https://github.com/techpines/express.io/tree/master/examples#sessions](https://github.com/techpines/express.io/tree/master/examples#sessions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T23:57:11.850

我做了一些稍微不同的事情来让它工作。[我在nodester github上](https://github.com/nodester/nodester/issues/393)阅读了很多帖子，并提供了以下解决方案......

代替：

```
http.createServer(app).listen(app.get('port'), function(){
      console.log("Express server listening on port " + app.get('port'));
    }); 
```

和：

```
var server = http.createServer(app).listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
});

var io = require('socket.io').listen(server); 
```

我的计划是继续使用这个解决方法，直到 express3 和 socket.io 的问题得到解决。

# symfony - 在学说中扩展实体的最佳方式

> ID：10790446
> 
> 赞同：0
> 
> 时间：2012-05-28T21:09:44.340
> 
> 标签：symfony, doctrine-orm

我在我制作的一个小框架中有一个用户实体。现在我想在几个项目中使用这个用户实体。但在某些项目中，我想在不修改文件的情况下向用户实体添加一些字段。

到目前为止我尝试了什么：

我在 DefaultUser Bundle 中创建了一个新的 DefaultUser 实体，并使 User Entity 成为映射的超类。但是现在我无法在其他实体中建立关联，例如

```
 /*
     * @ORM\ManyToOne(targetEntity="User", inversedBy="jobs")
     * @ORM\JoinColumn(name="user", referencedColumnName="id")
     */
     private $user; 
```

因为 Doctrine 在用户实体中找不到 id 列。这仅在我指定 DefaultUser 实体时才有效。根据学说文档，如果只有一个叶子存在，这仅适用于多对多关联。

然后我尝试了单表继承。这很好用，但如果我想扩展在多个项目中共享的用户实体，我必须修改 DiscriminatorMap ......

那么扩展 UserEntity 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T12:41:26.457

我有完全相同的问题 - 我刚刚从 RedBean 切换到 Doctrine（对于使用 Zend 框架的项目），并且我的类的结构没有考虑到这个问题。核心问题是，据我所知，Doctrine 中的地图与类具有一对一的关系。我们正在寻找一种方法来拥有一个使用抽象类（DefaultUser）中的映射的具体类（UserEntity）。我的解决方案可能有点像黑客（我只使用 Doctrine 几天），至少适用于 YAML：

创建一个扩展 YAML 驱动程序的新映射驱动程序，并使用以下内容覆盖 _loadMappingFile 方法：

```
class MyLibrary_Doctrine_Mapping_Driver_YamlExtended extends MyLibrary_Doctrine_Mapping_Driver_YamlExtended
{
protected $_basicEntityFolder;

protected function _loadMappingFile($file)
{
$entMaps = parent::_loadMappingFile($file);

//merge this with any extensions if defined
foreach($entMaps as $ent => $map)
  { //load the relevant map
    if (!isset($map['extendEntity'])) {
      continue;
    }
    $fileName = $this->_basicEntityFolder . DIRECTORY_SEPARATOR .  str_replace('\\', '.', $map['extendEntity']) . $this->_fileExtension;

$extendedMaps = $this->_loadMappingFile($fileName);
if (!is_array($extendedMaps[$map['extendEntity']])) {
  throw new MyProject_Doctrine_Exception("Entity to extend from could not be found.");
}
//merge so that the file lower in the class hierachy always overrides the higher
$map = array_merge($extendedMaps[$map['extendEntity']], $map);

//clear the  extendEntity value
unset($map['extendEntity']);
$entMaps[$ent] = $map;
  }
    return $entMaps;
}

public function setExtendedEntitiesFolder($path)
{
  $this->_basicEntityFolder = $path;
}
} 
```

然后我有两个 yaml 文件，位于不同的文件夹中，如下所示：

```
#MyApplication/Entities/Maps/Entities.User.dcm.yml
Entities\User:
 extendEntity: LibraryEntities\User 
```

那是应用程序中的文件。然后在图书馆里我有

```
#Library/Entities/Maps/ExtendedEntities/LibraryEntities.User.dcm.yml
LibraryEntities\User:
type: entity
table: user
fields:
  username:
    type: text
    nullable: true
password:
  type: text
  nullable: true
defaultProfile:
  type: text
  nullable: true
  column: default_profile 
```

它位于 ExtendedEntities 文件夹中的原因是，我可以使用普通命名空间在库中定义 mappedSuperclasses，当类扩展它们时，Doctrine 会自动加载它们，但是这些扩展实体不在 Doctrine 通常的类继承加载路径之外（如果它们都在正常的文件夹结构中，然后例如“class ApplicationUser extends LibraryUser”Doctrine 会尝试加载 LibraryUser 的配置，因为它会找到它，然后导致您已经遇到的相同错误）。

然后，当我设置我的 $em 时，我将它与我的驱动程序一起提供：

```
$driverImpl = new MyLibrary_Doctrine_Mapping_Driver_YamlExtended(array(APPLICATION_PATH . '/entities/maps', 
                                                                   LIBRARY_PATH . '/Entities/Maps'));
$driverImpl->setExtendedEntitiesFolder(LIBRARY_PATH . '/Entities/Maps/ExtendedEntities'); 
```

请注意，此解决方案允许由“extendEntity”定义的继承链（因为 _loadMappingFile 方法是递归的）。此外，任何位于链条下方的配置文件都可以覆盖任何已定义的属性，因此即使在您的库 yaml 中您有：

```
 username:
    type: text 
```

假设您有一个项目，其中的用户名是整数，您可以在应用程序配置中简单地覆盖它

```
 username:
    type: int 
```

管他呢。

因此这解决了在基类上定义 Doctrine 样式继承的问题。在每个项目中，您都可以根据需要定义 DiscriminatorMap。

原则上，同样的解决方案可以应用于注解，尽管扩展注解驱动程序稍微复杂一些，因为它不是通过一次读取一个文件并将其转换为数组来简单地读取元数据，而是向注释阅读器，这意味着实现这个结构会比较棘手。

我很想知道其他人是如何解决这个问题的。

# javascript - 带有 jquery 移动转换的 videojs

> ID：10790453
> 
> 赞同：1
> 
> 时间：2012-05-28T21:10:44.183
> 
> 标签：javascript, jquery, html, video, jquery-mobile

我正在使用 jquery mobile 滑动过渡到这样的页面：

```
$.mobile.changePage(video_page.html, {transition: "slide", reverse: false} ); 
```

我要过渡到的页面包含一个使用 videojs 显示的视频元素，如下所示：

```
<video id="vidWindow0" class="video-js vjs-default-skin ref-linked" 
controls preload="auto" data-model-renderer="video" 
data-model-play="true" ></video> 
```

该`<video>`元素不包含任何 src，因为我将它动态添加到绑定到`"pagebeforechange"`事件的函数中。我遇到的问题是，当转换到这个页面时，我可以短暂地看到`<video>`元素出现在旧页面开始滑走之前。它倾向于在旧页面上重叠，使过渡看起来很奇怪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T05:52:00.117

Try:

```
.ui-page {
        -webkit-backface-visibility: hidden;
} 
```

# c++ - Qt 创建布局并将小部件动态添加到布局

> ID：10790454
> 
> 赞同：7
> 
> 时间：2012-05-28T21:10:55.043
> 
> 标签：c++, user-interface, layout, qt4

我正在尝试在我的 MainWindow 类中动态创建布局。我有四个框架，它们放置了一个网格布局对象。每个框架都包含一个自定义 ClockWidget。当我调整主窗口大小时，我希望 ClockWidget 对象相应地调整大小，所以我需要将它们添加到布局中。但是，我需要在运行时执行此操作，因为对象本身是在运行时创建的。我试图以编程方式完成此操作，但下面试图创建新布局的注释掉的代码会导致程序崩溃。正确执行此操作的程序是什么？

头文件：

```
#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include <QMainWindow>

#include "ClockView.h"

namespace Ui{
    class MainWindow;
}

class QLayout;

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:

    explicit MainWindow(QWidget *parent = 0);

    ~MainWindow();

    void populateViewGrid();

private:

    Ui::MainWindow *ui;

    ClockView *clockView_1;
    ClockView *clockView_2;
    ClockView *clockView_3;
    ClockView *clockView_4;

    QLayout *layout_1;
    QLayout *layout_2;
    QLayout *layout_3;
    QLayout *layout_4;
};

#endif // MAINWINDOW_H 
```

实现文件：

```
#include <QVBoxLayout>

#include "MainWindow.h"
#include "ui_MainWindow.h"

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
    populateViewGrid();
}

MainWindow::~MainWindow()
{
    delete ui;
}

void MainWindow::populateViewGrid()
{
    clockView_1 = new ClockView(ui->frame_1);
    clockView_2 = new ClockView(ui->frame_2);
    clockView_3 = new ClockView(ui->frame_3);
    clockView_4 = new ClockView(ui->frame_4);

    /*
    layout_1 = new QVBoxLayout;
    layout_2 = new QVBoxLayout;
    layout_3 = new QVBoxLayout;
    layout_4 = new QVBoxLayout;

    layout1->addWidget(clockView_1);
    layout2->addWidget(clockView_2);
    layout3->addWidget(clockView_3);
    layout4->addWidget(clockView_4);

    ui->frame_1->setLayout(layout_1);
    ui->frame_2->setLayout(layout_2);
    ui->frame_3->setLayout(layout_3);
    ui->frame_3->setLayout(layout_4);
    */
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T23:50:41.067

你的程序是正确的。有一些拼写错误，例如，您为`frame3`. 那可能是你的问题。崩溃并不总是可重现的。我不认为你有任何其他问题。下面是一个自包含的示例。它还按值保留所有实例，避免通过指针对额外的取消引用过早悲观。

```
// https://github.com/KubaO/stackoverflown/tree/master/questions/dynamic-widget-10790454
#include <cmath>
#include <QtGui>
#if QT_VERSION >= QT_VERSION_CHECK(5,0,0)
#include <QtWidgets>
#endif
#include <array>

// Interface

class ClockView : public QLabel
{
public:
    explicit ClockView(QWidget* parent = nullptr) : QLabel(parent)
    {
        static int ctr = 0;
        setText(QString::number(ctr++));
    }
};

class MainWindow : public QMainWindow
{
public:
    explicit MainWindow(QWidget *parent = nullptr);
    void populateViewGrid();

private:
    static constexpr int N = 10;

    QWidget central{this};
    QGridLayout centralLayout{&central};
    std::array<QFrame, N> frames;

    std::array<ClockView, N> clockViews;
    std::array<QVBoxLayout, N> layouts;
};

// Implementation

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent)
{
    setCentralWidget(&central);

    const int n = ceil(sqrt(N));
    for (int i = 0; i < N; ++ i) {
        frames[i].setFrameShape(QFrame::StyledPanel);
        centralLayout.addWidget(&frames[i], i/n, i%n, 1, 1);
    }

    populateViewGrid();
}

void MainWindow::populateViewGrid()
{
    for (int i = 0; i < N; ++ i) {
        layouts[i].addWidget(&clockViews[i]);
        frames[i].setLayout(&layouts[i]);
    }
}

int main(int argc, char** argv)
{
    QApplication app{argc, argv};
    MainWindow w;
    w.show();
    return app.exec();
} 
```

以及 qmake 项目文件。

```
greaterThan(QT_MAJOR_VERSION, 4) {
    QT = widgets 
    CONFIG += c++11
} else {
    QT = gui 
    unix:QMAKE_CXXFLAGS += -std=c++11
    macx {
        QMAKE_CXXFLAGS += -stdlib=libc++
        QMAKE_MACOSX_DEPLOYMENT_TARGET = 10.7
    }
}
TARGET = dynamic-widget-10790454
TEMPLATE = app
SOURCES += main.cpp 
```

# java - 为什么我不应该在添加组件之前调用 setVisible(true)？

> ID：10790457
> 
> 赞同：12
> 
> 时间：2012-05-28T21:11:20.923
> 
> 标签：java, swing

我在这个网站上看到过很多次（比如[here](https://stackoverflow.com/a/5444335/626796)和[here](https://stackoverflow.com/a/10790307/626796)`setVisible(true)` ），在向 a 添加组件之前你不能调用它`JComponent`，但我还没有看到解释，互联网上的信息似乎很少。

为什么会这样，如果你违反规则会发生什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-28T21:17:03.933

如果你先调用它，你不会破坏任何东西，但如果你添加了任何东西，你可能需要再次调用它。否则 Swing 不会渲染添加的组件。您需要让 JVM 调用 JFrame 的`paint(...)`方法来渲染 JFrame 的组件，并`setVisible(true)`要求 JVM 执行此操作。如果您曾经在调用 setVisible(true) 之后添加过组件并且没有看到这些组件，那么您会发现如果您重新调整 JFrame 的大小，它们将“具体化”。这是因为重新调整它的大小会导致操作系统要求 Swing 重新绘制 GUI，这将导致`paint(...)`被调用。

请注意，如果您在创建 GUI 之后添加组件，您可以`revalidate()`经常`repaint()`在其容器上调用 and 以使新组件正确布局，然后进行渲染。如果组件的更改涉及删除，或者在先前可视化另一个组件的位置绘制一个组件，`repaint()`则*肯定是必要的。*

***我强烈***推荐的一本书建议：[肮脏的富客户](http://filthyrichclients.org/)购买盖伊和哈斯。就买吧！您不会后悔购买。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-28T21:49:57.443

放大@Hovercraft 的有用分析，您可能还必须重新`pack()`封装顶级容器。这个将元素添加到after的[示例](https://stackoverflow.com/a/5760093/230513)可以说明权衡取舍。`JList``setVisible()`

# c# - ISet 在 Mono 中不可用吗？

> ID：10790462
> 
> 赞同：0
> 
> 时间：2012-05-28T21:11:46.343
> 
> 标签：c#, .net, mono

Mono 中是否提供[ISet 接口](http://msdn.microsoft.com/en-us/library/dd412081.aspx)？我似乎找不到它。

编辑：在 MonoDevelop 中将 Target Framework 设置为 4.0 后，我仍然收到错误消息：

> 错误 CS0246：找不到类型或命名空间名称 ISet。您是否缺少 using 指令或程序集引用？

Mono 的任何人都可以确认是否`ISet`适合他们吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:21:13.000

您必须以框架 4.0 为目标才能使`ISet`界面可用。

该接口位于 System.Collections.Generic 命名空间中，因此您需要指定全名`System.Collections.Generic.ISet`或使用以下 using 语句：

```
using System.Collections.Generic; 
```

根据[Mono 兼容性页面](http://www.mono-project.com/Compatibility)，Mono 2.10.8 支持框架 4.0 中的所有内容，除了 WPF、EntityFramework 和 WF，WCF 的一部分。

# linux - rc.local 会阻塞直到命令完成执行吗？

> ID：10790465
> 
> 赞同：1
> 
> 时间：2012-05-28T21:12:23.847
> 
> 标签：linux, rc

rc.local 会等待每个命令完成，还是像 exec() 一样执行命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:16:54.640

他们阻止。它们可以通过在末尾添加“&”来异步运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T21:18:13.873

这是一个普通的shell脚本。因此，它们是否阻塞，取决于脚本如何调用命令（例如，有/无`&`）。

但是 exec 的工作方式也与您的想法不同。`exec()`不会异步执行任何操作。

# lua - A* 寻路 - 逻辑错误？

> ID：10790468
> 
> 赞同：1
> 
> 时间：2012-05-28T21:13:12.043
> 
> 标签：lua, logic, path-finding

***所有代码都在 Lua / 伪代码中***

我正在尝试编写 A* 探路者。但是，我似乎遇到了一些错误。我不确定我的程序是否正确...

```
local function AStar(Start, Goal)
    Start["GScore"] = 0 -- Distance from start.  
    Start["HScore"] = Heuristic(Start,Goal) -- Estimated Distance from Goal
    Start["FScore"] = Start.GScore + Start.HScore -- The Final Score 
```

我认为上面的代码是正确的......

现在......我正在使用的数据结构是一个“节点”数组，其中包含一个表：

*   X
*   是
*   源（指向另一个节点的指针）
*   评分
*   高分
*   分数

我有一张预先组装好的地图，里面有...

*   X
*   是
*   邻居表（X/Y 格式，但没有 Source、GScore 等）。

尝试减少计算。

## 启发式

我用的heusticis是...

```
function Heuristic(Start, Goal)
    return math.sqrt(((Start.X-Goal.X)^2) + ((Start.Y-Goal.Y)^2))
end 
```

欧几里得距离，虽然我试图使用切比雪夫距离。我认为这行得通，但我不能确定，所以我改用我认为的“故障安全”启发式方法，直到我认为它行得通......但是你得到......

```
S = Start
E = End

       S
      ***
     *****
      ***
       E 
```

寻路时，在哪里...

```
 S
      **O
     ****O
      **O
       E 
```

*技术上*可能是正确的路径。我不确定您是否有任何解决方法。我在做....

```
function HeuristicDiagonal(Start, Goal)
    return min(abs(Start.X-Goal.X), abs(Start.Y-Goal.Y))
end

function HeuristicStraight(Start, Goal)
    return abs(Start.X-Goal.X) + abs(Start.Y - Goal.Y)
end

function Heuristic(Start, Goal)
    local HD = HeuristicDiagonal(Start, Goal)
    return ((HD*1.414) + ((HeuristicStraight(Start, Goal) - (2*HD))))*1.01
end 
```

但它似乎降级为最佳搜索。

## 代码/算法的基础

我正在尝试遵循以下说明：

```
OPEN = priority queue containing START
CLOSED = empty set
while lowest rank in OPEN is not the GOAL:
  current = remove lowest rank item from OPEN
  add current to CLOSED
  for neighbors of current:
    cost = g(current) + movementcost(current, neighbor)
    if neighbor in OPEN and cost less than g(neighbor):
      remove neighbor from OPEN, because new path is better
    if neighbor in CLOSED and cost less than g(neighbor): **
      remove neighbor from CLOSED
    if neighbor not in OPEN and neighbor not in CLOSED:
      set g(neighbor) to cost
      add neighbor to OPEN
      set priority queue rank to g(neighbor) + h(neighbor)
      set neighbor's parent to current

reconstruct reverse path from goal to start
by following parent pointers

(**) This should never happen if you have an monotone admissible heuristic. However in games we often have inadmissible heuristics. 
```

从这个来源 [ [http://theory.stanford.edu/~amitp/GameProgramming/ImplementationNotes.html#sketch](http://theory.stanford.edu/~amitp/GameProgramming/ImplementationNotes.html#sketch) ]

不幸的是，对于这个**，我得到了这个，我很确定我使用的启发式方法很好，因为它是距离公式....

我的代码的基本轮廓是......

```
Define Functions / Variables (Openset, etc)

While No Goal and OpenSet > Value do
    If NOT the goal
    Get the Lowest Ranked Items in OpenSet
    Add to closed set

    For each neighbor pulled from premade calculated stuff do
        Calculate FScore, GScore, HScore
        If Neighbor in OpenSet and Cost less then the GScore of the item in open // In this case, the item in open is the one identified
            Remove it from open 
        If Neighbor in Closed and Cost loss then the GScore of the item in closed 
            Remove it from Closed
            **Thing that should not happen, but does anyway... :(
        If the Neighbor is not in Closed or Open
            Add it to open
    Else it is the Goal
        Say found Goal (Stop loop)
Reconstruct path 
```

## 实际代码

```
local function AStar(Start, Goal)
    print("AStar start")

    Start["GScore"]     = 0                                -- Distance from start.  
    Start["HScore"]     = Heuristic(Start,Goal)            -- Estimated Distance from Goal
    Start["FScore"]     = Start.GScore + Start.HScore      -- The Final Score

    local OpenSet       = {Start}                          -- The OpenSet is the set of nodes that need to be check.  In each repetition, it pulls out the smallest 'Scoring' one, and checks it.  
    local ClosedSet     = {}                               -- The ClosedSet is the set of nodes that have already been visited

    local Continue      = true                                 -- Until the Goal is found, continue will be true.  
    local LowestNode, IndexVal
    local Reps          = 0

        local function GetLowestRankInOpen()
            local LowestRanks = {}
            local LowestNode, IndexVal;
            local CurrentNodeFScore = math.huge
            print("OpenSet has :"..#OpenSet.." options")
            for Index, Node in pairs(OpenSet) do
                if Node.FScore < CurrentNodeFScore then
                    CurrentNodeFScore = Node.FScore
                    LowestNode = Node
                    IndexVal = Index;
                    LowestRanks = {}
                    LowestRanks[#LowestRanks+1] = {Node = Node,Index = Index}
                elseif Node.FScore == CurrentNodeFScore then 
                    LowestNode = Node
                    IndexVal = Index;
                    LowestRanks[#LowestRanks+1] = {Node = Node,Index = Index}
                end
            end
            return LowestRanks--LowestNode, IndexVal;
        end

        local function NodeIsTransversable(NodeX, NodeY)
            local MapX = Map[NodeX] -- Node out of bounds?
            if not MapX then 
                print("Node out of bounds")
                return false
            end
            local MapXY = MapX[NodeY] -- Node out of bounds?
            if not MapXY then
                print("Node out of bounds")
                return false
            end
            return MapXY.Transversable 
        end

        function NodeIsInOpenSet(NodeX, NodeY)
            for Index, Node in pairs(OpenSet) do
                if ((Node.X == NodeX) and (Node.Y == NodeY)) then
                    return true, Node, Index
                end
            end
            return false
        end

        function NodeIsInClosedSet(NodeX, NodeY)
            for Index, Node in pairs(ClosedSet) do
                if ((Node.X == NodeX) and (Node.Y == NodeY)) then
                    return true, Node, Index
                end
            end
            return false
        end

        local function ReconstructPath(Node, Tab)
            Tab = Tab or {}
            table.insert(Tab, Node)
            return Node.Source and ReconstructPath(Node.Source, Tab) or Tab;
        end

        local function Check(Num) -- Basically just debugging...  Not sure if it worked too well... 
            for _, Node in pairs(OpenSet) do
                if Node.FScore <= Num then
                    print("failed @ "..Node.FScore)
                end
            end
        end

        local SourceNode

    while ((#OpenSet > 0) and Continue) do
        LowestNodes = GetLowestRankInOpen()
        for _, TheNode in pairs(LowestNodes) do
            SourceNode = TheNode
            local LowestNode = TheNode.Node
            local IndexVal = TheNode.Index
            Reps = Reps + 1
            print("Loop #: "..Reps.." | Open #: "..#OpenSet)
            print(LowestNode and "Lowest node is there" or "Lowest node is not there")
            print("X: "..LowestNode.X.." Y: "..LowestNode.Y)

            local LowestNodeX = LowestNode.X
            local LowestNodeY = LowestNode.Y
            print("FScore: "..LowestNode.FScore)
            Check(LowestNode.FScore)
            wait(0.1)
            if not ((LowestNodeX == Goal.X) and (LowestNodeY == Goal.Y)) then
                ClosedSet[#ClosedSet+1] = LowestNode
                OpenSet[IndexVal] = nil

                if OpenSet[IndexVal] then
                    print("Hack")
                end

                RenderNiceBrick(LowestNodeX, LowestNodeY, BrickColor.new("Mid gray"))
                for _, NeighborNode in pairs(Map[LowestNodeX][LowestNodeY].Neighbors) do
                    local NeighborNodeX                 = NeighborNode.X -- Speed things up
                    local NeighborNodeY                 = NeighborNode.Y
                    if NodeIsTransversable(NeighborNodeX, NeighborNodeY) then
                        local NeighborGScore        = LowestNode.GScore + Heuristic(LowestNode, NeighborNode)
                        local NeighborHScore            = Heuristic(NeighborNode, Goal)*1.01
                        local NeighborFScore        = NeighborHScore + NeighborGScore
                        local NodeIsInOpen, OpenNode, OpenIndex         = NodeIsInOpenSet(NeighborNodeX, NeighborNodeY)
                        local NodeIsInClosed, ClosedNode, ClosedIndex       = NodeIsInClosedSet(NeighborNodeX, NeighborNodeY)

                        if NodeIsInOpen and NeighborGScore < OpenNode.GScore then
                            RenderNiceBrick(NeighborNodeX,NeighborNodeY, BrickColor.new("Bright orange"), NeighborFScore)
                            OpenSet[OpenIndex] = nil
                        end

                        if NodeIsInClosed and NeighborHScore < ClosedNode.GScore then
                            RenderNiceBrick(NeighborNodeX,NeighborNodeY, BrickColor.new("Bright red"), NeighborFScore)
                            ClosedSet[ClosedIndex] = nil
                        end

                        if not NodeIsInClosed and not NodeIsInOpen then
                            RenderNiceBrick(NeighborNodeX,NeighborNodeY, BrickColor.new("Bright blue"), NeighborFScore)
                            local NewNode = {}
                            NewNode.X           = NeighborNodeX
                            NewNode.Y           = NeighborNodeY
                            NewNode["GScore"] = NeighborGScore
                            NewNode["HScore"] = NeighborHScore
                            NewNode["FScore"] = NeighborFScore
                            NewNode.Source  = LowestNode
                            OpenSet[#OpenSet+1]     = NewNode
                        end
                    else
                        RenderNiceBrick(NeighborNodeX,NeighborNodeY, BrickColor.new("Hot pink"))
                        print("Can't walk on dat")
                    end
                end
            else
                RenderNiceBrick(LowestNode.X,LowestNode.Y, BrickColor.new("Bright yellow"))
                Continue = false
                print("Found goal")
            end
        end
    end
    print("Done with A*")
    return true, ReconstructPath(SourceNode, {});
end 
```

## 输出

输出看起来像......（来自我正在为其编写的游戏） [http://youtu.be/MNnWHRU7NtU](http://youtu.be/MNnWHRU7NtU)

注释 - 数字是 FScore - 红色 = 完成 - 绿色 = 开始

实际输出示例：

```
failed @ 59.430702270978
OpenSet has :102 options
Loop #: 156 | Open #: 102
Lowest node is there
X: 160 Y: -13
FScore: 59.424070168796
failed @ 59.424070168796
OpenSet has :104 options
Loop #: 157 | Open #: 104
Lowest node is there
X: 159 Y: -12
FScore: 59.417896359916
failed @ 59.417896359916
OpenSet has :106 options
Loop #: 158 | Open #: 106
Lowest node is there
X: 158 Y: -11
FScore: 59.412223982381
failed @ 59.412223982381
OpenSet has :108 options
Loop #: 159 | Open #: 108
Lowest node is there
X: 157 Y: -10
FScore: 59.407101745211
failed @ 59.407101745211
OpenSet has :110 options
Loop #: 160 | Open #: 110
Lowest node is there
X: 156 Y: -9
FScore: 59.402584854429
failed @ 59.402584854429
OpenSet has :112 options
Loop #: 161 | Open #: 112
Lowest node is there
X: 155 Y: -8
FScore: 59.398736129429
failed @ 59.398736129429
OpenSet has :114 options
Loop #: 162 | Open #: 114
Lowest node is there
X: 154 Y: -7
FScore: 59.395627356727
failed @ 59.395627356727
OpenSet has :116 options
Loop #: 163 | Open #: 116
Lowest node is there
X: 153 Y: -6
FScore: 59.393340941897
failed @ 59.393340941897
OpenSet has :118 options
Loop #: 164 | Open #: 118
Lowest node is there
X: 152 Y: -5
FScore: 59.391971938836
failed @ 59.391971938836
OpenSet has :120 options
Loop #: 165 | Open #: 120
Lowest node is there
X: 151 Y: -4
FScore: 59.391630560343
failed @ 59.391630560343
OpenSet has :122 options
Loop #: 166 | Open #: 122
Lowest node is there
X: 150 Y: -3
FScore: 59.392445307867
failed @ 59.392445307867
OpenSet has :124 options
Loop #: 167 | Open #: 124
Lowest node is there
X: 149 Y: -2
FScore: 59.39456690506
failed @ 59.39456690506
OpenSet has :127 options
Loop #: 168 | Open #: 127
Lowest node is there
X: 148 Y: -1
FScore: 59.398173284976
failed @ 59.398173284976
OpenSet has :128 options
Loop #: 169 | Open #: 128
Lowest node is there
X: 163 Y: -11
FScore: 59.484589358667
failed @ 59.484589358667
OpenSet has :205 options
Loop #: 170 | Open #: 205
Lowest node is there
X: 164 Y: -12
FScore: 59.498131722924
failed @ 59.498131722924
OpenSet has :204 options
Loop #: 171 | Open #: 204
Lowest node is there
X: 165 Y: -13
FScore: 59.511707387983
failed @ 59.511707387983
OpenSet has :206 options
Loop #: 172 | Open #: 206
Lowest node is there
X: 166 Y: -14
FScore: 59.525313655834
failed @ 59.525313655834
OpenSet has :207 options
Loop #: 173 | Open #: 207
Lowest node is there
X: 167 Y: -15
FScore: 59.53894811221
failed @ 59.53894811221
OpenSet has :208 options
Loop #: 174 | Open #: 208
Lowest node is there
X: 168 Y: -16
FScore: 59.552608590246
failed @ 59.552608590246 
```

如果你们发现我的程序或逻辑有任何问题，请告诉我。我确定这是我忽略的一些愚蠢的事情。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T04:23:07.507

如果您需要现有的 Lua 实现， [http://developer.anscamobile.com/code/pathfinding-module](http://developer.anscamobile.com/code/pathfinding-module)

# google-chrome-extension - 如何使用 Chrome 的扩展 API 获取用户右键单击的图像的尺寸？

> ID：10790471
> 
> 赞同：2
> 
> 时间：2012-05-28T21:14:06.980
> 
> 标签：google-chrome-extension

我正在编写一个扩展程序，该扩展程序对页面上的图像的右键单击做出反应。我想知道图像的尺寸以进行进一步处理。

开箱即用，我的回调获取对选项卡和“信息”对象（[OnClickData](http://code.google.com/chrome/extensions/contextMenus.html#type-OnClickData)）的引用，它只公开最少的信息。

有没有人遇到过这种情况？我都在考虑

*   基于 srcUrl 再次加载图像（如果 URL 是动态的，则可能无法重现）并询问它
*   尝试遍历选项卡的 DOM 以查找图像并询问它（不确定这是否需要内容脚本来跨越从扩展程序到网页的边界）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:57:42.993

[图像属性上下文菜单](https://chrome.google.com/webstore/detail/khagclindddokccfbmfmckaflngbmpon)扩展的作用是将用户脚本与上下文菜单 API 结合使用。

用户脚本被注入所有页面，监听上下文菜单事件，并通过以下方式将有关图像的信息发送到扩展`chrome.extension.sendRequest`：

```
document.addEventListener("contextmenu", function (e) {
    var elem = e.srcElement;
    if (elem instanceof HTMLImageElement) {
        var img = {
            src: elem.src,
            alt: elem.alt,
            height: elem.height,
            width: elem.width
        }
        chrome.extension.sendRequest(img);
    }
}, true); 
```

后台页面用于`chrome.extension.onRequest.addListener`接收此数据，并将其存储在全局变量中。上下文菜单 API 点击回调从这个全局变量中读取数据。

这假设`chrome.extension.sendRequest`调用总是在点击回调之前处理，但情况可能并非总是如此。您可能希望通过回调检查数据是否已到达，如果没有，请稍后再试（使用`setTimeout`）。

# html - 引导行 - 右对齐

> ID：10790473
> 
> 赞同：4
> 
> 时间：2012-05-28T21:14:13.137
> 
> 标签：html, button, twitter-bootstrap

我有一个连续的`<h1>`标题`<div>`。我想完全扩展`<h1>`样式，但在行的右侧放置一个按钮。

我无法弄清楚如何`<span>`正确设置值以使按钮保持在右侧，但也扩展了行的全部数量。

我唯一的想法是将`<h1>`a 放在 a 中`div .span6`，然后将按钮放在另一个向右拉的位置，但这会在标题样式和按钮`div span`之间留下难看的空白。`<h1>`

如果我们在右侧有 2 个按钮，它也需要流畅。

[这只是我尝试做的一个示例。](http://jsfiddle.net/pf6FB/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T14:58:22.913

Your original question was a bit unclear, so I had to guess if something like this was what you were after.

```
<div class="container">
  <div class="row">
    <a href="#" class="btn pull-right">Button 2</a>
    <a href="#" class="btn pull-right">Button 1</a>
    <h1>My fancy title</h1>
  </div>
</div> 
```

After you edited the jsfiddle example, I'd say that my solution should work if you're using bootstrap. For some reason your css has `.pull-right{float:none;}` in it that's causing pull-right not to work.

Here's a simple demonstration of your code with only changes being the button being *before* the `h1` and `.pull-right{float:right;}` added to the end of css

[http://jsfiddle.net/Arkkimaagi/KFsM6/1/](http://jsfiddle.net/Arkkimaagi/KFsM6/1/)

# python - 无法调用 Python tkinter 标签

> ID：10790480
> 
> 赞同：1
> 
> 时间：2012-05-28T21:15:38.330
> 
> 标签：python, grid, tkinter, label, tk

我正在用 Python 制作一个简单的 tkinter GUI，我需要放置大约 10 个或更多标签。我使用网格方法放置标签，但在一定数量后出现错误，提示“TypeError：Label object is not callable”。这是标签和网格放置的代码：

```
UnitPointLabel = ttk.Label(root, text = unit_points)
UnitLabel = ttk.Label(root, text = unit)
HQ1 = ttk.Label(root, text = "HQ:")
HQ2 = ttk.Label(root, text = "HQ:")
Elite1 = ttk.Label(root, text = "Elite:")
Elite2 = ttk.Label(root, text = "Elite:")
Elite3 = ttk.Label(root, text = "Elite:")
Troop1 = ttk.Label(root, text = "Troop:")
Troop2 = ttk.Label(root, text = "Troop:")
Troop3 = ttk.Label(root, text = "Troop:")
Troop4 = ttk.Label(root, text = "Troop:")
Troop5 = ttk.Label(root, text = "Troop:")
Troop6 = ttk.Label(root, text = "Troop:")
Fast_Attack1 = ttk.Label(root, text = "Fast Attack:")
Fast_Attack2 = ttk.Label(root, text = "Fast Attack:")
Heavy_Support1 = ttk.Label(root, text = "Heavy Support:")
Heavy_Support2 = ttk.Label(root, text = "Heavy Support:")
Heavy_Support3 = ttk.Label(root, text = "Heavy Support:")

UnitPointLabel.grid(row = 3, column = 7)
HQ1.grid(row = 3, column = 5)
HQ2.grid(row = 4, column = 5)
Troop1.grid(row = 5, column = 5)
Troop2.grid(row = 6, column = 5)
Troop3.grid(row = 7, column = 5)
Troop4.grid(row = 8, column = 5)
Troop5.grid(row = 9, column = 5)
Troop6.grid(row = 10, column = 5)
Fast_Attack1.grid(row = 11, column = 5)
Fast_Attack2.grid(row = 12, column = 5)

Stops working here: Heavy_Support1(row = 3, column = 6)
Heavy_Support2(row = 2, column = 6)
Heavy_Support3(row = 3, column = 6) 
```

如您所见，我尝试移动行和列，但仍然无法正常工作。有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T21:20:45.240

调试的第一条规则：假设错误信息是真实的。它说什么？它说“标签对象不可调用”。这意味着您有一些对象是 Label 对象的实例，并且您正在尝试调用它。例如，“foo=Label(...); ...; foo()”。

那么，看看你的代码，你想调用什么标签对象？看看这三行：

```
Heavy_Support1(row = 3, column = 6)
Heavy_Support2(row = 2, column = 6)
Heavy_Support3(row = 3, column = 6) 
```

回顾您的代码，我发现 Heavy_Support1 （等）都是 Label 的实例，您确实在尝试调用它。

长话短说，您似乎忘记添加`.grid`这些行了。他们应该是：

```
Heavy_Support1.grid(row = 3, column = 6)
Heavy_Support2.grid(row = 2, column = 6)
Heavy_Support3.grid(row = 3, column = 6) 
```

# iphone - 从服务器下载 .plist 并将其保存在本地 iPhone 应用程序中

> ID：10790482
> 
> 赞同：1
> 
> 时间：2012-05-28T21:15:59.950
> 
> 标签：iphone, objective-c, save, plist

我想将应用内购买集成到我的应用程序中，因此我想在用户购买新关卡集时下载 .plist 文件。如何从服务器下载文件并保存它，以便它永远留在我的 iPhone 应用程序中？

**编辑**

我想实现这样的目标：

*   由于这些 plist 并不多（从不超过 20 个），我可以将它们包含到应用程序中并设置一个布尔值`isPurchased`左右，对吧？如果用户购买了该类别，则布尔值设置为`YES`。每当我添加新类别时，我都会进行全新的更新，例如“割绳子”。这是一个好方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T09:45:36.003

第一：为什么不使用[Apple 的](https://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/Introduction/Introduction.html)服务进行应用内购买？为什么要使用您自己的实现？我不确定，但是……你认为你会得到苹果的批准吗？据我记得，亚马逊过去做过类似的事情，但他们*没有*得到它。

第二：我不会为此目的使用 NSData 。如果您有一个有效的属性列表，那么它是使用的最佳解决方案

```
NSDictionary *dict = [NSDictionary dictionaryWithContentsOfURL:[NSURL URLWithString:@"foobar.com/plistfile.plist"]]; 
```

然后，您可以存储此字典。老实说，我不建议使用您的解决方案。如果我对您的理解正确，一段时间后您将拥有数千个 plist。我的建议：例如，使用“全局”可变字典作为 App Delegate 的 ivar。这在开始时应该是空的。然后如上所述下载您的帮助字典并使用

```
[[delegateInstance globalDictionary] addEntriesFromDictionary:dict]; 
```

每次获得新数据时。

保存它

```
[[delegateInstance globalDictionary] writeToFile:@"path" atomically:YES]; 
```

并在您的应用程序每次启动时恢复它。

**编辑：**

当然，你可以这样做。如果这些 plist 真的存储信息，那很好。例如，您可以将帐单信息存储在那里，这样它们就不能被其他用户互换（或者至少不应该）。但是：如果您只想获取有关用户购买特定级别的问题的信息，或者不考虑将您的信息合并到一个 plist 中（如上所述）。无论如何：考虑让您的用户取回他们的数据的可能性。想想有人不小心删除了你的应用程序。你想如何向他解释他所有的购买都丢失了？应用内购买更安全。

或者至少：在您的服务器上存储收据副本，让用户登录以收集他们过去支付的费用；-)

玩得开心，祝你好运！:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T21:24:24.240

快速而肮脏的单线：

```
[[NSData dataWithContentsOfURL:@"http://<yourfile>.plist"] writeToFile:@"pathforthefile.plist" atomically:YES]; 
```

# html - 四个高度和宽度相等的 div

> ID：10790484
> 
> 赞同：1
> 
> 时间：2012-05-28T21:16:18.797
> 
> 标签：html, css, tablelayout

这个问题似乎很简单，但我没有完成。

我有一个我正在处理的 web 项目，将 body 的溢出设置为隐藏。所以我不能在页面中放置超过可用空间高度的内容，否则它们将被隐藏。

现在我有四个图形/图表显示在一个页面上，每个都占用相等的空间。我试图把每一个都放在一个 2 行 2 列的表中。但无论你怎么尝试，表格的高度总是会超出页面高度，并且内容会被隐藏。我可以通过给每个 50% 的宽度和设置 table-layout: fixed; 来控制单元格的宽度。

我该如何实施？使用 div 还是使用 table？请帮我创建高度和宽度完全相同的 div 或表格单元格；并且不会溢出页面高度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T21:23:09.050

您可以使用列表：

```
<ul>
    <li>1</li>
    <li>2</li>
    <li>3</li>
    <li>4</li>
</ul> 
```

CSS：

```
html, body, ul {
    width: 100%;
    height: 100%;
}

li {
    float: left;
    width: 50%;
    height: 50%;
} 
```

**现场演示：http:** [//jsfiddle.net/U7WJ4/1/show/light/](http://jsfiddle.net/U7WJ4/1/show/light/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T21:23:41.640

解决方案 - 根据您自己的需要进行调整。

```
<style type="text/css">
    #container {
        height:200px;
        width:400px;
        overflow:hidden;
        border:1px solid #000;
    }
    .item {
        float:left;
        height:100px;
        width:50%
    }
    .item-a { background-color: #CCC; }
    .item-b { background-color: #AAA; }
    .item-c { background-color: #900; }
    .item-d { background-color: #9CC; }
    .clear {
        clear:left;
    }
</style>

<div id="container">
    <div class="item item-a">abc</div>
    <div class="item item-b">abc</div>
    <div class="item item-c">abc</div>
    <div class="item item-d">abc</div>
    <div class="clear"></div>
</div> 
```

这是与 div 方法具有相同 CSS 的等效 table 方法

```
<div id="container">
    <table cellpadding="0" cellspacing="0" border="0" width="100%">
        <tr>
            <td class="item item-a">a</td>
            <td class="item item-b">b</td>
        </tr>
        <tr>
            <td class="item item-c">c</td>
            <td class="item item-d">d</td>
        </tr>
    </table>
</div> 
```

# .net - 如何使用 PixelFormat 从 PictureBox 获取图像：Format8bppIndexed

> ID：10790486
> 
> 赞同：0
> 
> 时间：2012-05-28T21:16:20.280
> 
> 标签：.net, c++-cli, picturebox, aforge, pixelformat

如何使用 Format8bppRgb 从 PictureBox 获取图像？因为这个函数返回 Format24bppRgb：

```
Bitmap ^getBitmap8() {
Bitmap ^tmpBmp = gcnew Bitmap(pictureBox1->Image->Width, pictureBox1->Image->Height, System::Drawing::Imaging::PixelFormat::Format8bppIndexed);
tmpBmp = dynamic_cast<Bitmap^>(pictureBox1->Image); <- this one change PixelFormat from 8 to 24bpp

Rectangle rec = Rectangle(0,0,tmpBmp->Width, tmpBmp->Height);
tmpBmp->Clone(rec, System::Drawing::Imaging::PixelFormat::Format8bppIndexed); <- this one doesn't work 

return tmpBmp;
} 
```

帮助，我需要使用 Format8bppRGB 返回位图 tmpBmp 才能使用 aFormge 过滤器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:02:48.427

好的，我刚刚解决了这个问题。如果有人需要：

```
Bitmap ^ConvertTo8bpp() {

    Bitmap ^originalImage = gcnew Bitmap(pictureBox1->Image->Width, pictureBox1->Image->Height, PixelFormat::Format8bppIndexed);
    originalImage = dynamic_cast<Bitmap^>(pictureBox1->Image);

    Bitmap ^newImage = gcnew Bitmap(pictureBox1->Image->Width, pictureBox1->Image->Height, PixelFormat::Format8bppIndexed);

    Rectangle rec = Rectangle(0, 0, newImage->Width, newImage->Height);

    BitmapData^ originalData = originalImage->LockBits(rec, System::Drawing::Imaging::ImageLockMode::ReadWrite, PixelFormat::Format24bppRgb);

    BitmapData^ newData = newImage->LockBits(rec, System::Drawing::Imaging::ImageLockMode::ReadWrite, PixelFormat::Format24bppRgb);

    int originalStride = originalData->Stride;
    System::IntPtr originalScan0 = originalData->Scan0;

    int newStride = newData->Stride;
    System::IntPtr newScan0 = newData->Scan0;

    unsigned char* pOriginal = (unsigned char*)(void*)originalScan0;
    unsigned char* pNew = (unsigned char*)(void*)newScan0;

    int nOffset = originalStride - newImage->Width *3;
    unsigned char red, green, blue;

    for(int y=0; y<newImage->Height; ++y) {
        for(int x=0; x<newImage->Width; ++x) {
            blue = pOriginal[0];
            green = pOriginal[1];
            red = pOriginal[2];

            unsigned char newPixel = System::Convert::ToByte((red+green+blue) / 3);

            pNew[0] = newPixel;
            pNew[1] = newPixel;
            pNew[2] = newPixel;

            pOriginal += 3;
            pNew += 3;
        }
        pOriginal += nOffset;
        pNew += nOffset;
    }

    originalImage->UnlockBits(originalData);
    newImage->UnlockBits(newData);
    return newImage;
} 
```

# mongodb - 在 MongoDB 中查询多对多关系

> ID：10790492
> 
> 赞同：0
> 
> 时间：2012-05-28T21:17:02.853
> 
> 标签：mongodb, mongodb-query, mongodb-ruby

我正在阅读[MongoDB in Action](https://rads.stackoverflow.com/amzn/click/com/1935182870)并且在谈论查询文档中的多对多关系时，我很难理解他是如何编写示例查询的（使用 Ruby 驱动程序）。

该查询正在查找特定类别中的所有产品，其中有一个`products`和`category`集合。作者说“要查询园艺工具类中的所有产品，代码很简单：

```
db.products.find({category_ids => category['id']}) 
```

一个产品文档是这样的：

```
doc =
{ _id: new ObjectId("4c4b1476238d3b4dd5003981"),
  slug: "wheel-barrow-9092",
  sku: "9092",
  name: "Extra Large Wheel Barrow",
  description: "Heavy duty wheel barrow...",

  details: {
    weight: 47,
    weight_units: "lbs",
    model_num: 4039283402,
    manufacturer: "Acme",
    color: "Green"
  },

  category_ids: [new ObjectId("6a5b1476238d3b4dd5000048"),
                    new ObjectId("6a5b1476238d3b4dd5000049")],

  main_cat_id: new ObjectId("6a5b1476238d3b4dd5000048"),

  tags: ["tools", "gardening", "soil"],

} 
```

CATEGORY 文档是这样的：

```
doc =
{  _id: new ObjectId("6a5b1476238d3b4dd5000048"),
   slug: "gardening-tools",
   ancestors: [{ name: "Home",
                 _id: new ObjectId("8b87fb1476238d3b4dd500003"),
                 slug: "home"
                },

                { name: "Outdoors",
                 _id:  new ObjectId("9a9fb1476238d3b4dd5000001"),
                 slug: "outdoors"
               }
   ],

   parent_id: new ObjectId("9a9fb1476238d3b4dd5000001"),

   name: "Gardening Tools",
   description: "Gardening gadgets galore!",
} 
```

有人可以向我解释一下吗？我仍然无法理解他是如何编写该查询的:(

谢谢大家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T21:48:59.623

`category['id']`该查询正在产品集合中搜索字段中值为 的所有产品`category_ids`

当您搜索包含特定值的数组的字段时，MongoDB 会自动枚举该数组中的每个值以搜索匹配项。

要构造查询，您必须首先注意该`category`集合定义了您的类别层次结构，并且每个类别都有一个唯一的 ID（存储在 MongoDB 中的`_id`字段中）

您还必须注意，该`product`集合有一个存储类别 ID 列表的字段`category_ids`，它引用该`category`集合的唯一 ID。

因此，要查找特定类别中的所有产品，您可以`category_ids`在集合的字段中搜索`product`您感兴趣的类别的唯一 ID，您可以从该`category`集合中获得该 ID。

如果我要为基于 Mongo javascript 的 shell 解释器编写查询，`mongo`在 Gardening Tools 类别中查找产品，我会执行以下操作：

1.  查找 Gardening Tools 类别的 ID（如前所述，该 ID 存储在集合 的`_id`字段中）`category`
    *   在这种情况下，您的示例中的值为`ObjectId("6a5b1476238d3b4dd5000048")`
2.  将值插入到通过集合 `category_ids`字段进行搜索的查询中`product`
    *   这是您在问题中给出的查询，对于`mongo`shell，我将其写为：`db.products.find({category_ids : new ObjectId("6a5b1476238d3b4dd5000048")})`

我希望这比原来的解释更清楚！

（顺便说一句：我不太确定您的查询是用什么语言编写的，可能是 PHP 吗？无论如何，javascript 似乎是 MongoDB 文档中示例的首选语言，因为 MongoDB 服务器安装了`mongo`命令行解释器旁边的服务器本身，所以每个人都可以访问它）

# apache - phpinfo() 什么也不输出

> ID：10790497
> 
> 赞同：7
> 
> 时间：2012-05-28T21:18:02.077
> 
> 标签：apache, php, phpinfo

我试过 phpinfo() 但它什么也没输出。有趣的是，`php-r "phpinfo();"`在 web 中使用 phpinfo() 时正常工作不会输出任何内容。同样，也没有向 error.log 写入任何内容。`php.ini`是空的。

我不知道现在该怎么办。

**编辑：**

感谢**lanzz**，我知道 phpinfo() 之前不需要输出。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-01-05T21:29:06.383

我有一个类似的问题。我在我的 Ubuntu 机器上运行 Apache2，以便在部署之前对项目进行本地测试。我创建了一个 phpinfo(); 页面，并注意到它是空白的。在我的浏览器中检查后，php 函数将被注释掉。

您的浏览器与 php 无关。

为了执行 PHP 脚本，您必须将文件保存为 .php 文件，我相信您已经这样做了。

单独的 PHP 标记在 HTML 文档中是无效的，因此您需要创建一个实际的 HTML 文档，并将其保存为 .php。然后，包含一个基本的 HTML 文档，如下所示：

```
<?php
   phpinfo();
?>

<html>
  <head>
    <title>Php Info</title>
  </head>
    <body>
    </body>
</html> 
```

然后你会做：localhost/phpinfo.php 或者你正在处理的任何事情。在我的情况下，它是一个映射到我的本地主机的实际域名，所以 'myProjectName'.com/phpinfo.php

这只是根据我的经验，它 100% 有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T21:27:57.860

首先，检查“access.log”的内容；如果您没有看到对 phpinfo 文件的调用，那么您的 Web 服务器肯定有问题。

否则，尝试获取一个简单的 php 文件：

```
<?php echo "Hello, world."; 
```

或 HTML 文件：

```
<h1>Hello, world !</h1> 
```

然后，您可以确定问题出在哪里。

可能未加载 Web 服务器的 PHP 模块。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-16T21:34:08.107

只是想补充一下，我使用的是短标签`'<?'`

```
<? phpinfo(); 
```

这是失败的，因为当它们被禁用时我使用的是短标签，所以它应该是

```
<?php phpinfo(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-01T16:17:07.233

php 文件没有输出的另一种情况是权限设置不正确。例如，您的 Web 服务器无权读取它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-08T09:13:09.127

我不得不使用一种解决方法来使其工作。我使用的代码是：我无法回答为什么它只能这样工作，但确实如此。

```
<?php
  echo phpinfo();
?> 
```

# jquery - 表单验证 Jquery 正则表达式

> ID：10790498
> 
> 赞同：2
> 
> 时间：2012-05-28T21:18:02.470
> 
> 标签：jquery, validation

这是我的脚本：

```
 <script type="text/javascript">
    $(document).ready(function () {
        $.validator.addMethod(
        "regex",
        function (value, element, regexp) {
            var re = new RegExp(regexp);
            return this.optional(element) || re.test(value);
        },
        "Matricule Invalide"
);
            $("form").validate({
                rules: {
                    idv: { required: true, regex: "/^(\d{3})TN(\d{4})$/" },
                    dd: { required: true },
                    df: { required: true },
                    remise: { required: true, range: [0, 100] }
                },
                messages: {
                  idv: { required:"champs requis", regex: "Matricule Invalide"},
                  dd: "champs requis",
                  df: "champs requis",
                  remise : { required: "champs requis",
                             range: "Valeur doit entre entre 0 et 100"}
                }
            });
        });
    </script> 
```

IDV 字段必须像这样“111TN000”或“222TN0123”在其他方面它是正则表达式：`Number of 3 digets +TN+ Number of Four digets`。我已经创建了我的正则表达式`"/^(\d{3})TN(\d{4})$/"`，但是这里的问题是当我把`Valide IDV`我的 Jquery 函数显示给我时`Matricule Invalide`，这个相同的正则表达式适用于 Java 和 ASP.net。
我想我在这里遗漏了一些非常简单的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T21:29:12.000

假设您正在使用 jQuery validate regex 插件，如[本问题](https://stackoverflow.com/questions/280759/jquery-validate-how-to-add-a-rule-for-regular-expression-validation)所述，您需要删除前导/尾随斜杠并转义正则表达式中的其他斜杠：

```
idv: { required: true, regex: "^(\\d{3})TN(\\d{4})$" } 
```

[**示例小提琴**](http://jsfiddle.net/HnrGY/)

* * *

或者，您可以通过删除它周围的引号将其变成一个正则表达式对象：

```
idv: { required: true, regex: /^(\d{3})TN(\d{4})$/ } 
```

[**示例小提琴**](http://jsfiddle.net/HnrGY/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T21:22:27.610

我认为你必须删除斜杠

```
"^(\d{3})TN(\d{4})$" 
```

# php - 使用 Microsoft SQL Server (T-SQL) 以 UTF-8 字符编码保存文件

> ID：10790501
> 
> 赞同：0
> 
> 时间：2012-05-28T21:18:52.017
> 
> 标签：php, sql-server, apache, tsql, character-encoding

亲爱的 stackoverflow 用户，

我目前正在从事一个学校项目，该项目涉及通过使用其元数据从现有的 MSSQL 数据库生成 PHP Web 应用程序。我目前在将 varchar 或 nvarchar 数据类型保存到硬盘时遇到问题。我在互联网上找到了几个存储过程，它们都使用 so_OAMethod 将字符串保存到硬盘。这些存储过程都可以工作。我的问题是他们使用 UTF-16 字符编码保存文件。我们必须使用带有标准 PHP 模块的 apache 网络服务器。这样做的问题是 PHP 解释器错误地解释了 UTF-16 文件，我们确实得到了带有 PHP 代码的普通网页作为普通文本。我的问题是有办法以 UTF-8 格式将文件从 Microsoft SQL Server 保存到硬盘吗？或者是否有可能让 PHP 解释器将 UTF-16 文件解释为普通的 PHP 代码？

亲切的问候，沃特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T22:19:00.433

[我假设您会在存储过程中调用CreateTextFile](http://msdn.microsoft.com/en-us/library/aa265018%28v=vs.60%29.aspx)之类的东西来写出数据，因为这些存储过程似乎调用了 vbscript。这样的例程通常有一种方法来指定你想要 unicode 还是 ansi。

所以你会得到类似的东西

```
sp_OAMethod @objFileSystem , 'CreateTextFile' , @objTextStream OUT, @FileAndPath,2,True 
```

所以 Scripting.FileSystemObject 实例，要保存的文本，文件路径，覆盖？，ANSI/UNICODE（False = ANSI，True = unicode）

通常，如果您使用此方法，它应该会自动创建一个 ANSI 文件。

以供参考：

```
Sub CreateAfile
    Set fs = CreateObject("Scripting.FileSystemObject")
    Set a = fs.CreateTextFile("c:\testfile.txt", True)
    a.WriteLine("This is a test.")
    a.Close
End Sub 
```

# c++ - C++：GetKeyState() 必须运行一次

> ID：10790502
> 
> 赞同：3
> 
> 时间：2012-05-28T21:18:55.977
> 
> 标签：c++, winapi, keyboard, keypress

我需要为我的小应用程序监听键盘按键状态。

```
#include <windows.h>
#include <fstream>
#include <iostream>

using namespace std;

int main()
{
    while(1)
    {
        if(GetKeyState(VK_SPACE) & 0x80)
        {
            cout << "Space pressed.\r\n";
            DoSpaceKeyTask();
        }

        if(GetKeyState(OTHER_KEY) & 0x80)
        {
            cout << "Other key pressed.\r\n";
            DoOtherKeyTask();
        }
    }
    return 0;
} 
```

一旦我从键盘上单击某些键，这些功能就必须运行一次。它们只是我的应用程序的一些小任务，与本主题无关。

我的问题是，当我按下一个键时，由于`while(1)`在按键期间循环了几次，它会执行几次功能。我不能`Sleep()`在这种情况下使用，因为它仍然不会有效。

我正在寻找这样的解决方案。

1.  我按空格键。
2.  `DoSpaceKeyTask()`执行“一次”。
3.  我按其他键。
4.  `DoOtherKeyTask()`执行“一次”。

我有 5 个我将要使用的键。有人可以帮我处理这个案子吗？

附言。如果`GetKeyState()`函数对此任务没有用，请随时提出您的建议。我对 C++ 的函数知识非常有限。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-26T12:47:52.827

由于按钮保持按下的持续时间，您的函数被多次调用。该系统非常敏感。所以这是一种解决方法。

你可以做这样的事情（设置一个标志，在按键按下时分配一个值，然后在按键向上时重新分配）。

```
int k=0;//Flag
while(1){
    //check if the key was pressed (key_down)
    if((GetAsyncKeyState('0') & 0x8000) && (k == 0)){k=1; cout<<"'0' PRESSED."<<k<<endl;}//do your stuff here
    //check if the key was released (key up)
    else if(GetAsyncKeyState('0') == 0) k = 0;//reset the flag
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-06T13:45:44.543

我认为您更愿意仅在松开按键时才执行“一次”功能，而不是在您按下（按下）它们时执行您的功能。

您不需要任何额外的标志和辅助变量来定义、分配、分配为 0，并将每个设置为 1 并重置为 0 等等，以实现此目标。您所需要的只是：首先您必须在 while(1) 的范围内使用 GetKeyState 函数来检查您何时按下了一个键。当表达式返回 true 时，执行器指针（执行代码行然后在您进入或跳过时前进到下一个代码行的箭头）将进入 if 语句的范围。然后立即将它困在一个循环中，并在您按下的键仍然按下时将其困在其中，并在它要执行该功能之前停止它，并在您释放该键时释放它，然后让它执行功能。

例如，要在您按下并释放空格键时只执行“一次” DoSpaceKeyTask 函数，然后执行以下应该可以工作的代码：

```
while (1)
{
    if (GetKeyState(VK_SPACE) & 0x80)
    {
        //The code here executes ONCE at the moment the space bar was pressed
        cout << "Space pressed.\r\n";
        while (GetKeyState(VK_SPACE) & 0x80) //You can write there ';' instead '{' and '}' below
        {
            //The executor pointer is trapped here while space bar is depressed and it will be free once space bar is released
        }
        //The code here executes ONCE at the moment the space bar was released
        cout << "Space released.\r\n";
        DoSpaceKeyTask();
    }
} 
```

与 DoOtherKeyTask 函数相同：

```
while (1)
{
    if (GetKeyState(OTHER_KEY) & 0x80)
    {
        //The code here executes ONCE at the moment the other key was pressed
        cout << "Other key pressed.\r\n";
        while (GetKeyState(OTHER_KEY) & 0x80) //You can write there ';' instead '{' and '}' below
        {
            //The executor pointer is trapped here while other key is depressed and it will be free once other key is released
        }
        //The code here executes ONCE at the moment the other key was released
        cout << "Other key released.\r\n";
        DoOtherKeyTask();
    }
} 
```

如果您已经使用了 BT_ 的想法或 Pawel Zubrycki 的想法，现在您想使用我的想法，那么您可以删除他们建议的所有标志和变量，因为您不再需要它们了。

顺便说一句，我已经尝试过 Pawel Zubrycki 发布的代码，但它对我不起作用。当我真正按下空格键或我选择的其他键时，没有显示说我按下了空格键或其他键的输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-30T12:56:33.667

我遇到了同样的问题。我有几个键，它们的作用类似于切换按钮，并且每次按下时只想注册一次键事件。我的解决方案是制作一个简单的对象来处理逻辑。这使主代码保持干净：

```
class KeyToggle {
public:
    KeyToggle(int key):mKey(key),mActive(false){}
    operator bool() {
        if(GetAsyncKeyState(mKey)){
            if (!mActive){
                mActive = true;
                return true;
            }  
        }
        else
            mActive = false;
        return false;
    }
private:
    int mKey;
    bool mActive;
}; 
```

这是用法：

```
#include <windows.h>

KeyToggle toggleT(0x54);  // T key toggle
KeyToggle toggleF(0x46);  // F key toggle

void main(void)
{
    while(true){
        if(toggleT) {;} // do something
        if(toggleF) {;} // do something
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T21:31:17.580

试试这个方法：

```
#include <windows.h>
#include <fstream>
#include <iostream>

using namespace std;

int main()
{
    char lastSpaceState = 0, lastOtherKeyState = 0, spaceState, otherKeyState;
    while(1)
    {
        spaceState = (GetKeyState(VK_SPACE & 0x80) != 0);
        lastSpaceState = (spaceState && !lastSpaceState);
        if(lastSpaceState)
        {
                cout << "Space pressed.\r\n";
                DoSpaceKeyTask();
        }

        otherKeyState = (GetKeyState(OTHER_KEY) & 0x80 != 0);
        lastOtherKeyState = (otherKeyState && !lastOtherKeyState);
        if(lastOtherKeyState)
        {
                cout << "Other key pressed.\r\n";
                DoOtherKeyTask();
        }

    }

    return 0;
} 
```

或者正如克里斯在 OP 评论中建议的那样，更“现代”的异步方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-23T16:24:13.477

我知道这是很老的线程，但我仍然想分享我的解决方案。我认为确实不需要创建某种“标志”或“开关”。这是我循环所有键码的代码：

```
 while (true) 
    {
        for (int i = 0x01; i < 0xFE; i++) 
        {
            if (GetKeyState(i) & 0x8000)
            {
                std::cout << (char)i << "\n";
                while (GetKeyState(i) & 0x8000) {}
            }
        }
    } 
```

如您所见，您可以轻松地使用 while 和相同的 GetKeyState 函数来等待按键松开。更简单的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-17T21:37:04.220

试试看。像这样;

```
 while (!GetKeyState(VK_SPACE) && !GetKeyState('A') == 1) {
    //std::cout << "Key not pressed... \n";
    Sleep(40);
}
if (GetKeyState('A')) {
    std::cout << "\"A \" key pressed... \n";
}
else if (GetKeyState(VK_SPACE)) {
    std::cout << "Space key pressed... \n";
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-05-28T22:09:54.700

您需要一个 windows 挂钩来挂钩游戏并对游戏获得的键盘输入做出反应。现在我还没有真正完成这种特定类型的钩子，但我可以让你对流程有一个很好的了解。我将留给您通过循环遍历您需要的键映射而不是巨大的重复开关来减少空间，并且还可以解决我放入的任何小问题。

```
int main()
{
    //I imagine the last argument here is the thread 
    //containing the game's message loop
    HHOOK hook = SetWindowsHookEx (WH_CALLWNDPROC, hookProc, NULL, NULL);

    //main loop

    UnhookWindowsHookEx (hook);
}

LRESULT CALLBACK hookProc (int code, WPARAM wParam, LPARAM lParam)
{
    if (code == HC_ACTION)
    {
         CWPSTRUCT details = *((LPCWPSTRUCT)lParam);

         if (details.message == WM_KEYDOWN)
         {   
              switch (details.wParam)
              { 
                  case KEY_ONE:
                      if (last [KEY_ONE] == UP)
                      {
                          DoKeyOneStuff();
                          last [KEY_ONE] = DOWN;
                      }
                      break;
              }
          }

          else if (details.message == WM_KEYUP)
          {
              switch (details.wParam)
              {
                   case KEY_ONE:
                       last [KEY_ONE] = UP;
                   break;
              }
          }
    }

    return CallNextHookEx (NULL, code, wParam, lParam);
} 
```

注意我如何使用`last [KEY_ONE]`. 我建议使用`std::map`他们的 vk 代码来存储您需要的密钥。然后，您可以循环遍历地图并减少切换所需的大量空间。

# java - 将模式导出到 XML 数据库

> ID：10790504
> 
> 赞同：0
> 
> 时间：2012-05-28T21:19:21.683
> 
> 标签：java, xml, xsd, xquery

我正在开发一个连接到数据库并用作设计和数据操作工具的 Java 程序。我最终想将我的程序移植到某种 XML 数据库中。

更具体地说，我希望能够使用 Java 将我生成的 XSD（表示数据库）上传到实际的 XML 数据库（如 Sedna），然后连接到该数据库并查询/更新它。

我一直在探索 Sedna 和 XQJ API，但我不知道如何做到这一点。可以通过Java完成吗？

**编辑**我没有任何要映射到 XML 或数据库的数据。我在 XSD 中指定了一个数据库结构，我只想在某处的服务器上创建相应的数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:34:26.593

对于 XML 到数据库的映射，至少有两个值得尝试的框架：

*   Castor XML [http://www.castor.org](http://www.castor.org)
*   休眠[http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/xml.html](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/xml.html)

# wpf - 在文本框中显示 XML 文件中的特定节点

> ID：10790513
> 
> 赞同：0
> 
> 时间：2012-05-28T21:20:26.580
> 
> 标签：wpf, xaml, xmldataprovider

我有一个看起来像这样的 xml 文件

```
<Data>
  <NumberID>23423</NumberID>
  <NumberID>34234</NumberID>
  <NumberID>45435</NumberID>
</Data> 
```

如何在文本框控件上显示特定节点？目前我正在尝试从我的 XML 文件中显示第二个“NumberID”：

```
<Window.Resources>
        <XmlDataProvider x:Key="RoutingData"
               Source="/RoutingLogic.xml"
               XPath="Data/NumberID[2]"/>         
</Window.Resources> 
```

...

```
<TextBox Text="{Binding ElementName=RoutingData}"> 
```

但它现在显示了任何东西。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:34:34.600

我想到了。我将绑定信息更改为：

```
<Window.Resources>
        <XmlDataProvider x:Key="RoutingData"
               Source="/RoutingLogic.xml"
               XPath="Data"/>         
</Window.Resources> 
```

...

```
<TextBox Text="{Binding Source={StaticResource RoutingData}, XPath=NumberID[2]}"/> 
```

# ruby-on-rails - 连接表的最佳 SQL 索引

> ID：10790518
> 
> 赞同：43
> 
> 时间：2012-05-28T21:20:36.667
> 
> 标签：ruby-on-rails, database-design, indexing, rails-migrations

考虑到性能改进，我想知道哪些索引对连接表有帮助（特别是在 Rails 3 has_and_belongs_to_many 上下文中使用）。

## 模型和表格设置

我的模型是`Foo`并且`Bar`根据 Rails 约定，我有一个名为`bars_foos`. 没有主键或时间戳使该表中的旧字段`bar_id:integer`和`foo_id:integer`. 我有兴趣知道以下哪些索引是最好的并且没有重复：

1.  复合索引：`add_index :bars_foos, [:bar_id, :foo_id]`
2.  *   两个指标
    *   一个。`add_index :bars_foos, :bar_id`
    *   B.`add_index :bars_foos, :foo_id`
3.  1 和 2-B 的组合

基本上，我不确定复合索引是否足够，假设它是有帮助的开始。我相信复合索引可以用作第一项的单个索引，这就是为什么我*很*确定使用所有三行肯定会导致不必要的重复。

## 可能的用法

最常见的用法将给出模型的实例`Foo`，我将`bars`使用 RoR 语法询问它的关联`foo.bars`，反之亦然，`bar.foos`用于模型的实例`Bar`。

这些将分别生成 和 类型的查询，`SELECT * FROM bars_foos WHERE foo_id = ?`然后`SELECT * FROM bars_foos WHERE bar_id = ?`使用这些结果 ID 到`SELECT * FROM bars WHERE ID in (?)`和`SELECT * FROM foos WHERE ID in (?)`。

如果我不正确，请在评论中纠正我，但我不相信，在 Rails 应用程序的上下文中，它会尝试执行一个查询，它指定两个 ID，如`SELECT * FROM bars_foos where bar_id = ? AND foo_id = ?`.

## 数据库

如果有特定于数据库的优化技术，我很可能会使用 PostgreSQL。但是，其他使用此代码的人可能希望根据他们的 Rails 配置在 MySQL 或 SQLite 中使用它，因此感谢所有答案。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-07-01T23:59:14.703

# 答案

经常重复的答案，往往总是如此，“这取决于”。更具体地说，这取决于您的数据是什么以及如何使用它。

# tl;dr 解释

我的具体案例（并涵盖所有未来的基础）的简短 tl;dr 答案是我怀疑的**选择＃2 。**但是，选择 #3 可以正常工作，因为根据我对数据的使用情况，创建复合索引所使用的额外时间和空间可能会减少未来的查询查找。

# 完整的解释

这样做的原因是数据库试图变得聪明，并试图尽可能快地做事，而不管程序员的输入如何。添加索引时要考虑的最基本的项目是是否会通过此键查找此对象。如果是，索引可能有助于加快速度。然而，这个索引是否被使用都归结为选择性和字段的基数。

由于外键通常是另一个 AR 类的 ID，因此基数通常会很高。但同样，这取决于您的数据。在我的示例中，如果有很多`Foo`s 但很少有`Bar`s，我的连接表中的许多条目都会有 simliar `bar_id`s。由于`bar_id`s 具有低基数，`bar_id`因此可能永远不会使用 on 索引，并且可能会因为每次`bars_foos`创建新条目时让数据库花费时间和资源* 来添加到该索引而受到阻碍。许多`Bar`s 和很少`Foo`s 以及两者中的少数也是如此。

一般的教训是，在考虑表上的索引时，要确定条目是否都将由该字段查找，以及该字段是否具有高基数。也就是说，这个字段有很多不同的值吗？在大多数连接表的情况下，“这取决于”，我们必须更仔细地考虑数据代表什么以及关系本身。在我的情况下，我将*同时*拥有许多`Foo`s 和s 并且将通过它们关联的 s`Bar`来查找s ，反之亦然。`Foo``bar`

我在办公室得到的另一个好答案是，“你为什么要担心你的索引？构建你的应用程序！”

## 脚注

[* 在有关 STI 指数](https://stackoverflow.com/questions/33486907/will-a-compound-index-with-a-second-column-of-low-cardinality-effect-performance#answer-33973140)的类似问题中，有人指出指数的成本非常低，因此如有疑问，只需添加即可。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-29T16:11:40.940

取决于您将如何查询数据。

假设您要搜索所有这些...

*   `WHERE bar_id = ?`
*   `WHERE foo_id = ?`
*   `WHERE bar_id = ? AND foo_id = ?`

...那么您可能应该使用 index on`{bar_id, foo_id}`和 index on `{foo_id}`。

虽然您*也可以*在 上创建第三个索引`{bar_id}`，但维护额外索引的代价可能会超过在较小索引中更好地[聚类的好处。](http://use-the-index-luke.com/sql/clustering)

* * *

另外，你打算如何用索引[覆盖你的查询？](http://use-the-index-luke.com/sql/glossary/covering-index)一些替代方案，例如...

*   `{foo_id, bar_id}`和`{bar_id}`
*   `{foo_id, bar_id}`和`{bar_id, foo_id}`

...可能会更好地涵盖某些类型的查询。

覆盖是一种平衡行为 - 有时仅出于覆盖目的将字段添加到索引是合理的，有时则不是。**在您测量**实际数据量之前，您不会知道。

*（免责声明：我不熟悉 Ruby。这个答案纯粹是从数据库的角度来看的。）*

# git - 禁用 git 自动合并

> ID：10790521
> 
> 赞同：1
> 
> 时间：2012-05-28T21:20:49.623
> 
> 标签：git

直到现在，我曾经这样做：'git pull origin master'，如果有东西要合并，我会得到一个错误，然后我可以使用'git mergetool'（加载 p4merge）来合并文件。

现在它只写快进并自动合并我的文件：

```
 * branch            master     -> FETCH_HEAD
Updating 508eb2e..b93d761
Fast-forward
 protected/controllers/AlbumController.php      |   14 +-
 protected/controllers/AlbumController.php.orig |  103 +++
 etc. 
```

问题是，我没有做任何特别的事情来允许自动合并。为什么会发生这种情况，我该如何禁用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T21:24:33.790

你似乎很困惑。“快进”意味着它*没有*合并。这意味着您没有本地提交，因此它只是将您的分支指针转发到您拉取的内容的尖端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:50:01.550

你没有什么可以合并的。因此，它只会更新您的分支以指向您要合并的分支指向的位置。您的工作目录现在将更新以代表您的分支指向的新位置。这就是“覆盖”您的文件的原因。为什么您希望您的工作目录的文件在合并其他更改后不会被覆盖（无论它是否是快进情况）。

`--no-ff`附带说明一下，如果您确实想保留分支点，则可以通过将选项添加到合并命令来强制 git 创建新的提交，即使由于快速转发而没有必要。

我还建议阅读有关分支和合并的 progit.org/book。这是设计使然。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T21:26:21.817

“快进”意味着您没有在本地进行任何不在远程存储库上的提交。

这意味着没有什么可以合并的；您当地的已签出分支刚刚更新。

diff-stat 只是用来告诉您自上次拉动以来在遥控器中进行了哪些更改。

# jquery - 在动态创建的元素上使用 Jquery '.last'？

> ID：10790522
> 
> 赞同：0
> 
> 时间：2012-05-28T21:21:08.373
> 
> 标签：jquery, html, jquery-selectors

我在弄清楚如何做到这一点时遇到了很多麻烦：

```
$('.add_education').click(function() {
    $('#education_form_clone:last').last().clone(true).appendTo('#education_form_container');
}); 
```

如果它是新创建的元素，它不会选择最后一个元素。基本上我想克隆最后一个`#education_form_clone`（以获取值。）我理解这是因为它是动态创建的，我之前必须解决类似的问题，但我一生都无法弄清楚我是如何管理它的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T21:23:44.740

1.  您不能有多个具有相同 id 的元素！这是**无效的 HTML**。
2.  您没有充分理由使用 last 两次 ( `:last`and )。`.last()`

您应该使用`class`而不是`id`：

```
$('.add_education').click(function() {
    $('.education_form_clone:last').clone(true).appendTo('#education_form_container');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T21:32:40.917

如果您将其更改`education_form_clone` `</div>`为一个类，您可以执行以下操作：

**HTML**

```
<div id="edutcation_form_container">
    <div class="education_form_clone">Education Form Element</div>
</div>

<a href="#" class="add_education">Click Me to Clone</a> 
```

**JS**

```
$('.add_education').bind('click', function(e){
    e.preventDefault();
    var $clone = $('.education_form_clone').filter(':last').clone();
    $('#edutcation_form_container .education_form_clone').filter(':last').after($clone);

    console.log($clone);
});​ 
```

[在这里](http://jsfiddle.net/jFgQW/2/)提琴

# python - python循环遍历列表并查找唯一性

> ID：10790523
> 
> 赞同：-2
> 
> 时间：2012-05-28T21:21:12.947
> 
> 标签：python, list, python-2.7

我在这里有一个脚本，它可以抓取一个 csv，在一列中它只是名称颜色。

您如何遍历列表并获取独特的项目（删除重复项）？

**电流输出：** 黑、蓝、蓝、红、红、绿

**所需输出：** 黑色、蓝色、红色、绿色

在我的代码中，我以某种方式管理了一个 continue for 循环。

```
#!/usr/bin/python
import csv
import sys
import argparse

# creates a text file of all the colors in pipe seperated format
# parsing command line options
parser = argparse.ArgumentParser(prog='desc', description=__doc__)
parser.add_argument('-i', '--input', help='Input file', nargs='?', type=argparse.FileType('r'), default=sys.stdin)
parser.add_argument('-o', '--output', help='Output file', nargs='?', type=argparse.FileType('w'), default=sys.stdout)
args = parser.parse_args(sys.argv[1:])
# Declare variables from input
inf, outf = args.input, args.output
outf = csv.writer(outf)

print 'Loading %s file into memory' % inf.name
data = []
needle = ''
for i, line in enumerate(csv.reader(inf).next()):
    needle = line[11]
    if len(data) == 0:
        data.append(needle)
        continue
    j = 0
    for j, item in enumerate(data):
        print item
        if needle == item:
            print 'match'
            continue
        else:
            print 'no match: appending item'
            data.append(item)
            continue 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T21:34:54.690

您可以使用`set()`. 看看这个简单的例子，我想这就是你想要的：

```
>>> list1=[1,2,3,4,5,6]
>>> list2=[4,5,6,7,8,9]
>>> sett=set(list1).union(set(list2))
>>> print(sett)
{1, 2, 3, 4, 5, 6, 7, 8, 9} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T22:36:29.830

您实际上没有 2 个列表。您只有一个列表，第 [11] 行，如果您在添加到结果之前曾查看过整个结果列表，您可以在每一行检查整个结果列表。这将提供 O(n2) 运行时间，如果您的列表较大，您会注意到它。已经建议设置符号：

```
data = set()
for row in csv.reader(inf).next():
    data.add(row[11]) 
```

唯一的缺点是这不稳定。如果你需要维持秩序，你只需要几个额外的步骤。

```
data = []
for row in csv.reader(inf).next():
    data.append(row[11])

result = []
for entry in data:
    if entry not in result: result.append(entry) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T21:29:44.327

不能只用set吗？

```
data = set()

for i, line in enumerate(csv.reader(inf)):
    if i == 0:
        continue
    data.add( line[11] ) 
```

在您的代码中，我找不到您需要迭代 2 个循环的原因（？）如果您需要列表，您可以将集合转换为列表： data = list(data)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T21:27:40.183

如何将列表转换为集合，并提取独特的项目：

```
a = set(list1)
b = set(list2)
unique_items = a - b #or b - a depending on how you define unique 
```

# c++ - 方法调用的括号

> ID：10790526
> 
> 赞同：0
> 
> 时间：2012-05-28T21:21:27.397
> 
> 标签：c++, stringstream

我想知道以下代码是否相同：

```
//first
string str; int num;
stringstream(str)>>num;
//second
string str; int num;
(stringstream)str>>num; 
```

我试图运行它们并且它们工作。你能告诉我这就是他们之间的区别吗？或者他们是一样的？非常感谢！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T21:34:49.740

正如[Luchian Grigore](https://stackoverflow.com/a/10790576/1139697)已经告诉你的那样，它们是等价的。

第一个将使用`stringstream::stringstream(const string&)`构造函数创建一个临时对象。第二种是 C 风格的类型转换，本质上与`static_cast<stringstream>(str) >> num;`. 将`static_cast<>`使用上面的构造函数，所以两者是等价的。

然而，正如 Luchian 已经告诉你的，你不应该使用 C 风格的类型转换。改为使用`static_cast<>`。

也可以看看：

*   [为什么使用 static_cast<int>(x) 而不是 (int)x？](https://stackoverflow.com/questions/103512/in-c-why-use-static-castintx-instead-of-intx)
*   [CPP：类型铸造](http://www.cplusplus.com/doc/tutorial%20%20/typecasting/)

# iphone - 使用不兼容的 void 类型初始化 NSMutableArray __strong

> ID：10790531
> 
> 赞同：3
> 
> 时间：2012-05-28T21:22:02.510
> 
> 标签：iphone, nsmutablearray, nsjsonserialization

这是返回错误的原因：

```
NSMutableArray *newArray = [[[NSMutableArray alloc] initWithArray:[NSJSONSerialization JSONObjectWithData:[[[appDelegate.Matches objectAtIndex:(NSUInteger)indexPath] objectForKey:@"chat"] dataUsingEncoding:NSUTF8StringEncoding] options:NSJSONReadingMutableContainers error:nil]] addObject:[NSDictionary dictionaryWithObjectsAndKeys:message, @"message", [NSString stringWithFormat:@"%llu", appDelegate.userId], @"id", nil]]; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-28T23:12:21.917

“神圣的连续表达，蝙蝠侠！”

如果你将它分成多行，你可以很容易地看到问题出在哪里。

或者，更有可能的是，错误会神秘地消失。

问题是`addObject:`返回`(void)`，但您试图将该方法的返回值分配给变量。

# c - 光线追踪球面纹理

> ID：10790533
> 
> 赞同：2
> 
> 时间：2012-05-28T21:22:19.203
> 
> 标签：c, math, geometry, textures, raytracing

我正在尝试在球体上拟合世界纹理。它几乎可以工作，但纹理重复了两次。这是我的映射代码：

```
v = acosf(sp->coll->z / (double)sp->radius) / M_PI ;
u = asinf(sp->coll->y / ((double)sp->radius * sinf(v * M_PI))) / M_PI;
u += 0.5;
// u and v are between 0 and 1
i = (int)((float)texture->xsize * (v - ((int)v)));
j = (int)((float)texture->ysize * (u - ((int)u)));
this->color = texture->map[j][i]; 
```

什么可能导致此问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:07:12.000

我认为问题在于您在 u 计算中丢失了一些符号信息。

对于给定的 z 和 y 对，球体上有一些点。要解决这种歧义，您应该使用`atan2`而不是`asin`. 代码大致如下所示：

```
u = atan2(sp->coll->y, sp->coll->x)/(2*PI); 
```

您可能需要将参数标准化为`atan2`- 但在大多数实现中您不需要。

# android - 如何在通过按钮移动时接收事件

> ID：10790534
> 
> 赞同：1
> 
> 时间：2012-05-28T21:22:21.983
> 
> 标签：android

我正在尝试在 android 中实现一个钢琴应用程序。我只有 8 个音符和每个音符的 8 个按钮。我对每个按钮都实现了onTouch，只触摸一个按钮就没有问题。但是，当我触摸一个按钮并将手指移动到下一个按钮时，不会调用该按钮的 onTouch 函数并且它会被忽略。如何在不抬起手指的情况下在按钮上滑动手指时演奏音符？我真的被困在这里了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:06:22.023

在您的 onTouch 覆盖中，确保您正在检查 ACTION_MOVE 事件，而不仅仅是 ACTION_DOWN。您需要跟踪已输入和离开的音符，以确保您不会为同一拖动条目的 ACTION_MOVE 事件重复播放音符。

# javascript - Jquery $.ajax 获取响应与将“this”对象嵌套传递给“success”回调函数冲突

> ID：10790536
> 
> 赞同：0
> 
> 时间：2012-05-28T21:22:24.637
> 
> 标签：javascript, jquery, callback

我正在尝试`$.ajax` `Get`在类的方法中执行 jquery。请求提供的数据`Get`将在成功的回调函数中使用，并且类也需要在同一个回调中进行修改。因此，我不得不对原始类`.apply`的**`this`**标识符进行回调，否则回调内部将**`this`**被本地替换。但是，在**`this`**对返回的数据应用回调时，将`Get`作为`undefined`. 我该如何解决这个问题。任何帮助表示赞赏。

```
var tableblock = function(tablename){
     this.tablename = tablename;
     this.numusers = 0;
     this.userpool = new Array();

     this.addme = function(){
        bodyContent = $.ajax({
            type: "GET",
            url: "controllers/bestpals.php",
            data: "addpal=1&palname="+userid+"&nocache="+Math.floor((Math.random()*100)+1),
            error: function(xhr, statusText){alert('could not add pal. refresh page.');},
            success: function(msg){
                alert(msg); // this will give undefined when .apply(this) 
                myid = msg;
                syncpals(this,true);
            }.apply(this) // using this alert(msg) above gives undefined 
        });
     };
 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T21:26:00.587

`context`你可以在你的ajax配置中提供一个参数；所有 ajax 回调都将在该上下文中调用（即，`this`回调内部将引用您`context`在`$.ajax()`调用中传递的值）：

```
SomeClass.prototype.methodName = function() {
    $.ajax({
        ....
        context: this    // callbacks will be called with the same context that methodName() is running in
        ....
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:29:06.937

你想要[`.bind(this)`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind)，没有[`.apply(this)`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply)。`bind`更改`this`函数的指针，而`apply`实际上在新上下文中运行该函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T21:30:42.327

我想你的意思`bind`不是`apply`。`bind`创建一个新函数，在设置时调用包装的函数`this`；`apply`运行后立即调用该函数`addme()`。

然而`bind`，这是 ECMAScript 第五版功能，因此您需要执行以下操作之一：

1.  [旧浏览器的polyfill](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind#Compatibility) `bind`；
2.  使用 jQuery 等价物[`proxy`](http://api.jquery.com/jQuery.proxy/)；
3.  使用显式设置的`context`参数 to ；`ajax``this`
4.  记住并在内部函数中`var that= this;`使用`addme`封闭的引用。`that`

# perl - Unix进程写入文件描述符在孩子还活着时结束（perl）

> ID：10790537
> 
> 赞同：2
> 
> 时间：2012-05-28T21:22:26.883
> 
> 标签：perl, unix, exec, fork, pipe

所以我有以下代码，问题是它在所有子进程（排序/gzip）完成之前就退出了。如何指示 Perl 等待所有后代进程？

```
#!/usr/bin/perl

use strict;
use warnings;

sub systemBash {
  my $cmd = shift;
  my @args = ( "bash", "-c", $cmd );
  print "command ".$cmd."\n";
  system(@args);
  if($? != 0){
    die "Command ".Dumper(@args)." failed";
  }
}
print "start";
systemBash("yes |head -n 1000000|awk '{print rand()}' > >(sort |gzip -9 -c > /dev/null)");
print "done"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T19:08:31.033

I wrote the following hideous code to solve this problem:

```
sub findAllPIDs{
 my ($firstPID) = @_;
 my %hashPID;
 $hashPID{$firstPID}=1;
 my $found;
 do{
   $found=0;
   foreach my $key (keys %hashPID){
     my $cmd="ps -o pid --ppid ".$key;
     my $out=`$cmd`;
     foreach my $line (split("\n",$out)){
       $line =~ s/^\s+//;
       $line =~ s/\s+$//;
       if($line ne "PID"){
         if(!(exists $hashPID{$line})){
           $hashPID{$line}=1;
           $found=1;
         }
       }
     }
   }

 }while($found);
 return (keys %hashPID);
}

sub poll{
 my $proc=shift;
 while(1){
   my $cmd="ps  -o s --pid $proc";
   my $out=`$cmd`;
   my $found=0;
   my @arr=split("\n",$out);
   shift(@arr);
   foreach my $line (@arr){
     $line =~ s/^\s+//;
     $line =~ s/\s+$//;
     if($line ne "Z"  ){
       $found=1;
     }
   }
   if(!$found){
     return $proc;
   }
   sleep(2);
 }
}

sub systemBash {
 my $cmd = shift;
 my @args = ( "bash", "-c", $cmd );

 print "running ".$cmd."\n";
 if(!$fakeRun){
   my $pid=fork();
   if($pid == 0){
     exec(@args);
   }else{
     sleep(1);
     my @array=findAllPIDs($pid);
     foreach my $pid (@array){
       my $code =poll($pid);
     }
   }
 }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T03:48:06.170

你将不得不重新设计你的方法或作弊。

Perl 的`system()`等待`bash`，它（如您所知）等待您的管道完成。但是，进程替换会运行与您的孩子“离婚”的命令`bash`及其通常的耐心。所以：

## 重新设计你的方法

1.  找到一种方法使子流程成为真正的管道，而无需流程替换。
2.  通过某种 IPC 让最终处理阶段信号 perl（例如，发送信号、写入字节、非阻塞、到命名管道等）

## 欺骗

您可以欺骗孩子、孙子等以影响上面的#2。

让子进程继承 a的写端，返回`pipe()`后关闭自己的写端副本。`system()`当所有后代终止时，读取端将选择可读。

您需要做一些扭曲才能使其工作，因为[`pipe()`d 文件句柄通常受`$^F`](http://perldoc.perl.org/functions/pipe.html). 就像是：

```
use POSIX qw(F_SETFD);

...
  # XXX - error checking omitted
  pipe(my $rd, my $wr);
  fcntl($wr, F_SETFD, 0);

  system(...);
  close($wr);

  readline($rd); # Will block until all inherited copies of $wr are closed 
```

这种技术几乎不是万无一失的，但经常奏效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T17:45:12.823

为了让 Perl 等待一个进程，它首先需要知道它应该等待的进程的 PID。

因为这个例子中的子进程是由系统产生的（bash 命令），Perl 不知道它们，所以没有简单的方法来处理这个，即：你必须猜测那些子进程的 PID。

我建议你采用以下两种方法之一：要么尝试猜测链中最后一个进程的 PID 并等待它结束，要么将事件序列分解为单个命令，每个命令都会产生一个稍后“馈送”的输出" 到下一个命令（这样你根本不需要做任何等待 - 'system' 命令会为你做这件事）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T00:11:10.047

您可以将您的进程替换转换为 FIFO，并明确等待它完成。

```
yes |head -n 1000000|awk '{print rand()}' > >(sort |gzip -9 -c > /dev/null) 
```

变成

```
mkfifo tmp-fifo; { sort |gzip -9 -c > /dev/null; } < tmp-fifo & pid=$! ; yes |head -n 1000000|awk '{print rand()}' > tmp-fifo; wait $pid; rm tmp-fifo 
```

Perl 代码不需要更改。

来源： http: [//lists.gnu.org/archive/html/bug-bash/2011-11/msg00137.html](http://lists.gnu.org/archive/html/bug-bash/2011-11/msg00137.html)

# php - 将信息分配给表并创建自动递增的 id...如何获取新创建的 id？

> ID：10790540
> 
> 赞同：0
> 
> 时间：2012-05-28T21:22:42.227
> 
> 标签：php, mysqli, get, addition

我有一段代码在 mysql 表中存储了一些基本的用户选择。

```
 $isACompany = $_POST['isACompany'];
    $hasDifBilling = $_POST['hasDifBilling'];
    $stmt = $link->prepare("
        INSERT INTO user_info SET
        id='',
        isACompany = ?,
        hasDifBilling = ?'
    ");
    if (!$stmt)
    {
        $error = "{$link->errno}  :  {$link->error}";
        include "$docRoot/html/main/error.html.php";
        exit();
    }
    if (!$stmt->bind_param("ii", $isACompany, $hasDifBilling))
    {
        $error = "{$stmt->errno}  :  {$stmt->error}";
        include "$docRoot/html/main/error.html.php";
        exit();
    }
    if (!$stmt->execute())
    {
        $error = "{$stmt->errno}  :  {$stmt->error}";
        include "$docRoot/html/main/error.html.php";
        exit();
    } 
```

鉴于该代码，我将如何在此实例中获取新创建的 id？

我也有另一个与此代码有关的问题，尽管它本身不是问题的一部分......因为前两个变量提取了这两个帖子的值，并且看到这些值被硬编码到 html 中并被选中通过复选框（“1”或“”为 0）。在将信息添加到数据库之前，我还需要对它们进行清理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:32:23.863

正如迈克尔正确指出的那样，可以使用该[`$stmt->insert_id`](http://www.php.net/manual/en/mysqli-stmt.insert-id.php)属性检索您插入的行的 ID。

这个问题更重要的部分是第二部分，答案是一个大胖子，**是**的，你*必须*逃避来自用户输入的所有内容！仅仅因为您将其“硬编码”到 HTML 中，并不意味着用户无法对其进行操作。有一百万零一种方法可以做到这一点 - [Javascript 注入](http://www.testingsecurity.com/how-to-test/injection-vulnerabilities/Javascript-Injection)和“欺骗”HTTP 请求仅举两例。

你**必须**逃避来自客户端的*任何东西。*总是。故事结局。

# javascript - jsxgraph：绘制后如何更改线条属性

> ID：10790542
> 
> 赞同：1
> 
> 时间：2012-05-28T21:23:22.073
> 
> 标签：javascript

我有

```
obj=board.create('segment'... 
```

我想在其他地方做：

```
obj.strokeWidth=function() {return 5;} //doesn't work
board.update(); 
```

或者

```
obj.strokeWidth=5; 
```

但没有任何效果

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:46:18.667

更改属性的最佳方法是：

```
obj=board.create('segment'...
obj.setProperty({strokeWidth:5}); 
```

可以设置多个属性

```
obj.setProperty({strokeWidth:5, strokeColor:'green'}); 
```

# extjs - 内联组合框

> ID：10790543
> 
> 赞同：0
> 
> 时间：2012-05-28T21:23:31.713
> 
> 标签：extjs, combobox, extjs4

在 ExtJS4 中生成内联组合框控件的最佳方法是什么？

示例代码：

```
 xtype:'container',
        items:[{
            xtype:"component",
            html:"this is some text that should appear before the combo: "
        },{
            xtype:'combo',
            queryMode: 'local',
            typeAhead: true,
            grow:true,
            store:["Alabama Alabama Alabama Alabama Alabama Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Georgia"]
        },{
            xtype:"component",
            html:"this is some text that should appear after the combo."
        }] 
```

期望的输出：

```
this is some text that should appear before the combo:<combobox> this is some text that
should appear after the combo. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:27:18.963

将以下内容添加到顶级容器：

```
layout: {
   type: 'hbox'
} 
```

# java - Java 引用变量

> ID：10790548
> 
> 赞同：3
> 
> 时间：2012-05-28T21:23:54.700
> 
> 标签：java, pointers, pass-by-reference

我知道 Java 不允许像 C++ 那样使用指针。但是，我听说过一些关于引用的事情（大概也类似于 C++）。我的问题与以下问题有关：

我有一个类“A”，比如说，我在内存中实例化（使用新的）一堆，我希望根据我的选择将这些类“链接”到彼此。在 C++ 中，我将只有一个 A 类指针的向量（在 A 类中定义），我将指针添加到要链接到的类 AI 实例的指针。这基本上就像在内存中构建一个全向图（或单向图，取决于我如何构建我的链接）

我的问题是我可以在 Java 中以一种优雅的方式做到这一点，以及如何做到这一点？我猜这与参考有关。指针似乎是这个问题的简单解决方案，但我是 Java 新手，正在学习如何在没有指针的情况下做这些事情。我不确定如何定义参考。在 C++ 中，我会使用 A * mypointer = new A();

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T21:43:31.850

```
import java.util.List;
import java.util.ArrayList;

class FunkyObject
{
    /** a list of other FunkyObject that this object is linked to */

    List<FunkyObject> referenceList = new ArrayList<FunkyObject>();

    /** creates a link between this object and someObject */

    public addRefrerence(FunkyObject someObject )
    {
        referenceList.add(a);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:26:35.807

```
public class A {

    private A[] refs;

    public A(A... refs) {
        this.refs = refs;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T21:27:26.123

您可以将引用视为指针，因为它们引用实例就像指针指向内存位置一样。最大的不同是 Java 不允许像 C 对指针那样对引用进行*算术运算。*您也不能创建对字段的引用——只能对对象进行引用，并且只能通过使用`new`.

至于存储对 的多个实例的引用`A`，您有很多选择。您可以使用[`List`](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)诸如此类[`ArrayList`](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)或任何其他[`Collection`](http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html)类。这实际上取决于您需要如何访问它们。仔细阅读`java.util`所有系列的包装。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T21:33:43.367

您在第二段中描述的几乎正是 Java 模型的工作原理。（这也是它工作的唯一方式。）当 Java 教程说“Java 是按值传递”时，它们所指的值是原始类型和*对象句柄*。也就是说，当您传递一个对象类型的值时，该对象不会被复制。（我认为这与在 C 中传递指向结构的指针的行为相同。）

例如，您不能做的是创建一个指向局部变量或对象字段的指针。您只能传递它们的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T07:10:03.483

感谢您的所有帮助 - 它非常有用。似乎引用提供了我一直在寻找的优雅解决方案，指针在 C/C++ 中提供。到目前为止，我能看到的唯一主要区别（没有实际实现）是我们不能对引用执行算术运算。

# python - 打印语句在 PSP 中不起作用（Python 服务器页面）

> ID：10790549
> 
> 赞同：0
> 
> 时间：2012-05-28T21:24:12.983
> 
> 标签：python, printing, python-server-pages

下面是python服务器页面（PSP）的代码；使用 mysqldb，我试图从表“addr”中获取记录，然后将其打印到 html 页面上。

但是由于某种原因，for循环内部（包含表行）和for循环外部（包含“Hello”语句）的打印语句不起作用，因为在代码执行后最后只显示语句“打印的行”没有别的了。

```
<% import MySQLdb 

conn = MySQLdb.Connect(host='localhost',user='user',passwd='password',db='db1')
cur = conn.cursor()
sql= "SELECT * from addr;"
try:
  cur.execute(sql)
  data = cur.fetchall()
  for row in data:
    print row[1]
  print("Hello")
  cur.close()
  conn.close()
%>
<br />
<html>
<h1> Rows Printed</h1>
</body>
</html>
<%
except MySQLdb.IntegrityError,message:
  errorcode = message[0]
%>
<html>
<body><h1> Technical issue</h1>
</body>
</html> 
```

即使没有 try catch 块，print 语句也不会显示结果，但是当作为 Python 脚本运行时，它可以正常工作并提供存储在表中的所需记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:09:57.153

我一生都无法理解您为什么要使用 Python 服务器页面，但是既然您是，您显然不能使用`print`. 您需要以 PSP 语法将结果实际输出到页面。就像是：

```
for row in data: %>
<br><%= row[1] =%>
<%
cur.close() 
```

等等

# file - 在条件内搜索 exe 文件

> ID：10790550
> 
> 赞同：0
> 
> 时间：2012-05-28T21:24:18.777
> 
> 标签：file, bash, shell, directory, executable

我想在当前文件夹及其子文件夹中搜索所有大于 200 kB 或小于 120 kB 的 .exe 文件。然后我想将它们移动到另一个名为“文件夹”的文件夹中，并在该文件夹中无限执行名为“executable.exe”的文件，并显示有关其内存消耗的一些信息。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T22:58:05.720

使用 gnu-ish `find`（不确定 mingw 使用什么），像这样？

```
cd your_folder

find . -name '*.exe' \( -size +200k -o -size -120k \) -exec mv {} folder \;

cd folder

run_some_executable.exe 
```

找到您的`find`文件，执行将每个文件移动到您的文件夹。

然后它 cd 到您的文件夹并运行可执行文件。

然后，您必须运行另一个工具来检查内存消耗。

# javascript - 在 localhost 上运行时，大型 javascript 文件在 Opera 中被截断

> ID：10790558
> 
> 赞同：3
> 
> 时间：2012-05-28T21:25:12.207
> 
> 标签：javascript, localhost, opera

根据标题，当查看我在 Opera 中工作的站点时，从 localhost 运行，大型脚本文件（超过 500k 的文件）被截断，然后引发错误，例如：

```
Syntax error at line 8 while loading: expected expression, got <end of file> 
```

没有其他浏览器会导致此行为。如果我从 CDN 加载文件（即外部站点），它可以正常工作。从 CDN 下载内容，将其添加到项目并在 localhost 和 blam 上引用，它会爆炸。

有什么想法会导致这种行为以及是否有解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:51:10.420

这听起来像是一个错误，尽管我个人从未见过这种情况。

文件是否以换行符结尾？如果用户脚本没有被 LF 或 CRLF 终止，则用户脚本可能会失败，这是一个已知问题。

# startup - 如何查看启动时使用的 vimrc 文件

> ID：10790559
> 
> 赞同：4
> 
> 时间：2012-05-28T21:25:12.890
> 
> 标签：startup, vim

我已将我的 vimrc 文件移出主目录以对设置进行病原化，但看起来我的 vim 仍在拾取我在某处制作的冗余 vimrc 文件。vim 中是否有一些变量可以回显，以显示启动期间使用的文件？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-29T06:32:29.637

`:scriptnames`列出所有来源的脚本名称，按照它们最初来源的顺序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T21:32:09.033

查找 $MYVIMRC 变量：

```
:echo $MYVIMRC 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-28T21:33:11.030

启动vim后，可以输入

```
:set runtimepath 
```

请参阅此处的文档：http: [//vimdoc.sourceforge.net/htmldoc/options.html#](http://vimdoc.sourceforge.net/htmldoc/options.html#) 'runtimepath'

我认为@skinp 的回答不一定足够。runtimepath 变量是 vim 看起来所有地方的定义

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T21:35:52.363

另外，您可以使用以下命令启动 Vim

```
$ vim --startuptime filename 
```

它应该将已加载脚本（包括 vimrc）的列表及其各自的处理时间写入文件`filename`。

# c - gtk+ 保存文件，同时在 linux 中保留文件权限

> ID：10790565
> 
> 赞同：0
> 
> 时间：2012-05-28T21:25:49.793
> 
> 标签：c, gtk, glib, gtk2

我正在用 gtk+ 2.0 和 gtksourceview 2.0 编写一个文本编辑器。目前我正在使用`gtk_text_buffer_get_text`并将`g_file_set_contents`文本缓冲区保存到文件中。我在文档中`g_file_set_contents`看到它说：

> 此外，由于文件被重新创建，现有权限、访问控制列表、元数据等可能会丢失。

我环顾了 devhelp 和 Google，找不到在保留文件权限的同时将文本缓冲区保存到文件的替代方法。关于如何做到这一点的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T21:45:16.783

正如@ptomato 建议的那样，使用一种截断文件的方法，然后根据需要写出文本缓冲区。这是一段对我有用的代码：

```
gtk_text_buffer_get_end_iter(tbuffer,&end_iter);
gtk_text_buffer_get_start_iter(tbuffer,&start_iter);
text = gtk_text_buffer_get_text(tbuffer,&start_iter,&end_iter,FALSE);
    FILE *fp;
    fp=fopen(path, "w");
    fprintf(fp, "%s", text);
    fclose(fp); 
```

# iphone - 带有 3 个按钮的 UIAlertView > 第三个按钮的间距

> ID：10790566
> 
> 赞同：0
> 
> 时间：2012-05-28T21:25:58.210
> 
> 标签：iphone, ios, uialertview

我正在创建一个带有 3 个按钮的简单警报视图，每个按钮都具有同等重要性，没有取消按钮或类似的东西：

```
UIAlertView* alert = [[UIAlertView alloc] initWithTitle:nil message:@"msg" delegate:self cancelButtonTitle:nil otherButtonTitles:@"button1",@"button2",@"button3",nil];
[alert show]; 
```

第三个按钮上方有额外的空间，就好像它是一个取消按钮一样。我希望按钮之间的空间相同。

任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:31:12.523

不幸的是，没有简单的方法可以做到这一点（您必须从字面上重新发明轮子，子类化 UIAlertView[不一定是一个非常可行的选择](https://stackoverflow.com/questions/551530/customizing-uialertview)）。

但是，您可能对[BlockAlertsAnd-ActionSheets](https://github.com/gpambrozio/BlockAlertsAnd-ActionSheets)库感兴趣，它可以为您提供漂亮的、基于块的警报视图，并在按钮之间提供一致的间距。

# windows - 检测 MSI 是否需要在安装前重新启动

> ID：10790570
> 
> 赞同：6
> 
> 时间：2012-05-28T21:26:12.823
> 
> 标签：windows, installation, windows-installer

如果我在安静模式下使用 MSIExec 启动安装程序，我可以通过检查退出代码是否为 3010 来检测是否需要重新启动才能完成安装。但我希望能够以可编程形式做的是测试是否在我启动实际安装程序**之前**，MSI 的安装需要重新启动才能完成。

我查看了 MSI API：

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa369426(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa369426(v=vs.85).aspx)

我确实认为我可以：

1.  调用 MsiOpenPackage 让安装程序准备好运行
2.  使用以下命令调用 MsiDoAction：CostInitialize、FileCost、CostFinalize、InstallValidate
3.  从 FilesInUse 表中读取记录（MSDN 上的以下文档建议此表是在运行 CostFinalize/InstallValidate 后创建的：

[http://msdn.microsoft.com/en-us/library/aa369546(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa369546(VS.85).aspx)

但是，当我在安装过程中查询它时，该表实际上并不存在。是否有其他方法可以检查是否需要重新启动？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T07:22:45.143

Gareth，理论上您不需要执行实际安装，您应该只执行操作，直到 InstallValidate（包含），因为此时会出现 Files In Use 消息。但是，当使用外部 UI 处理程序执行安装时，Windows Installer 的行为可能会有所不同，因此应该进行测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T21:45:06.003

最终仅在安装过程中做出决定。如您所知，它取决于诸如 DLL 被同时运行的应用程序锁定的情况，因此它非常不稳定。

无法保证在实际安装完成后您不会收到退出代码 3010。

也就是说，退出代码与正在使用的文件没有那么紧密的联系。它还可能表示无法停止服务，或者可能是其他一些暂时或永久的情况。在您尝试之前，您无法了解是否可以停止服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T22:21:38.970

Jirka 关于需要重启的波动性是正确的——在安装过程中可能会发生各种事情。

但是，我认为我已经接近了我希望能够用不同的方法做的事情：

1.  为 INSTALLLOGMODE_RMFILESINUSE 注册一个外部 UI 处理程序
2.  捕获 INSTALLMESSAGE_RMFILESINUSE 消息
3.  如果我捕获任何 INSTALLMESSAGE_RMFILESINUSE 消息，请在任何文件复制继续之前返回 -1 并退出安装

通过这种方式，我可以尝试在后台静默安装软件，但如果由于任何原因看起来我无法完成安装，我可以阻止。如果我最终处于用户在开始复制后锁定文件的状态，我想我也可以使用 MsiBeginTransaction 和 MsiEndTransaction 函数进行回滚。

# iphone - 在 iPhone 移动终端上使用 dd 命令时出现 /dev/disk0 错误

> ID：10790575
> 
> 赞同：0
> 
> 时间：2012-05-28T21:27:06.003
> 
> 标签：iphone, terminal, dd, invalid-argument

我正在使用该命令`dd if=/dev/disk0 | ssh username@labtop ip address 'dd of=iphone-dump.img'`，但得到了这个：`dd: reading '/dev/disk0': Invalid argument`。

我正在使用带有 iOs 5.1 的 iPhone 4，并试图找回一些我从未备份但恢复手机的家庭照片。自从恢复以来，我没有经常使用我的 iPhone，所以我确信数据仍然在我的手机上的某个地方。我在 iPhone 上使用 MobileTerminal。

有没有`dd`我应该使用的新命令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:48:36.680

If you really "restored" (and not "updated") your iPhone, there is no way to back up any data.

# java - 每个单独客户端的多线程服务器

> ID：10790582
> 
> 赞同：0
> 
> 时间：2012-05-28T21:27:40.380
> 
> 标签：java, sockets, connection, client, serversocket

好的，有一个问题，我有一个服务器，这个服务器是多线程的，它允许多个客户端连接到它。当一个客户端连接到服务器时，它会被扔到一个线程中来完成它的任务，等等其他客户端。

基本上，客户端所做的是在屏幕上绘制一个“图形”方块，当您在屏幕上移动这个方块时（使用键盘事件、箭头键），它会将 x 和 y 坐标发送到服务器以放入一个数组中在开始连接时给予客户端的客户端编号的对应索引。

我的问题不是将 x 和 y 线发送到服务器，无论我连接了多少个客户端，它们都可以工作并将 x 和 y 线发送到服务器进行存储，当然还有当玩家做出新动作时，数组中先前的 x 和 y 被新的 x 和 y 线覆盖。

我的问题是将每个客户端（不包括其客户端）绘制到其他客户端屏幕...

所以基本上如果我要在我的客户端屏幕上移动我的方块，它会在每个人的屏幕上移动（当然是连接到服务器）。我在想 id 为每个客户端都有一个多线程服务器，这意味着 id 每个连接有两个线程。但是，如果我在两个线程中同时来回发送东西，套接字就会混淆。另外，我希望客户不断收到这个 x 和 y 线数组，而不仅仅是在它移动时，这样如果有人移动它就会更新每个人。而且我还希望服务器不断地向客户端发送 x 和 y 线阵列，同时另外接收新的 x 和 y 并对阵列进行正确的更改。

我将发布我所拥有的基本结构，如果有人能指出我正确的方向，我是否必须制作另一个服务器套接字并在客户端接受另一个套接字？

对如何为每个连接设置多个线程感到困惑。谢谢！:)

客户端：

```
//some methods are taken out 
// All imports imported here
public class ClientSquares extends JFrame implements Runnable{
    //variables here
    public void run(){
        try{
            while(true){
                 //other calls here (just for client)
                if(online == true && (x != oldX || y != oldY)){
                    //only sends its X and Y cords when the player makes a move.
                    checkAbility check = new checkAbility(x, y, clientNum, alpha);
                    check.checking();
                    //the Checking method in checkAbilities class just assigns a client           
                    //number to this client, which is stored in a int variable called  
                    //clientNum, once its assigned then it can send its x and Y cords
                }
                Thread.sleep(3);
           }
       }catch(Exception e){
        System.err.println("Error in implemented Runnable's method Run");
       }
  }

//paint method stuff here, paints the the clients square, and everyone else (according 
//to the array received from the server.

  public static void main(String [] args){
       //thread for client started here
  }
  public ClientSquares(){
    //standard jFrame here, creates standard x and y cords here

    //This is how im making my connection with the server right now.. further 
    //communication (in getting client number, and x and y cords are done in a 
    //different class)
    try{
        sock = new Socket("localhost",4000); 
        OS = new DataOutputStream(sock.getOutputStream());
        IS = new DataInputStream(sock.getInputStream());
        OIS = new ObjectInputStream(sock.getInputStream());
        roomNum = IS.readInt();
        players = new int[roomNum + 1][2];
        defaultPlayerArray();
        online = true;
    }catch(Exception e){
      System.err.println("Cannot connect to the Server, check and make sure that the" + 
                         " correct ip is entered, and also check if port 777 is open" +
                         " you will now enter offline mode.");
        online = false;
    }
   }
   class AL extends KeyAdapter{
      //Key events here
   }
} 
```

服务器端：

```
//import heres
public class ServerRunner{
    //variables here, and this class is called somewhere else to start the server, 
    //which 
    //has the server socket, and a couple more variables
    public ServerRunner(Server2 ser){
        serv2 = ser;
        players = new Socket[ServerRunner.roomNum + 1];
        xy = new int[roomNum + 1][2];
        gui = new GUI();
        string = new String[0];
    }
    //start method is called in the class above, which passes it a server2 object 
    //(itself)
    public void start(){
        try{
            serv2.dataServ = new ServerSocket(4000);
            serv2.listening = true;
            defaultArray();
            gui.main(string); //the GUI class just draws the players for the server to
                              //see
            System.out.println("Listening for Connections...");
        }catch(Exception e){
            System.err.println("The port number 777 and 778 are not open");
        }
        while(serv2.listening){
            try{
                //the data class gives the client a client number, and stores the x & y
                //cord
                new data(serv2.dataServ.accept()).start();
            }catch(Exception e){
                System.err.println("Error in Server Runner");
            }
        }
    }
    public void defaultArray(){
        for(int i = 0; i < xy.length; i++){
            xy[i][0] = -1;
        }
    }
} 
```

谢谢你帮我解决这个问题！:)

编辑：总的来说，我有一个正在使用的套接字，但我需要用这个套接字（线程）做多件事，我如何在不混淆数据的情况下做这件事，我应该再做一个 serverSocket 吗？

客户端会将其 x 和 y 线发送到服务器以存储在一个数组中，但也将接收一个充满其他玩家 x 和 y 线的数组以同时在其屏幕上绘制......看这是螺纹到位的地方，但如果不是不可能的话，用一个插座就很难做到

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:19:14.093

服务器中每个连接有两个线程。一个监听客户端更新；对于接收到的每个客户端更新，它都会进行适当的处​​理，最后它会发出一个内部状态已更改的事件。

另一个线程监听“内部状态修改”事件，当它接收到一个时，将新状态发送给客户端。

现在，您需要仔细实现整个事件，因为您有多个发射器、一个事件和多个接收器。

客户端将不得不再次拥有两个线程，一个向服务器发送消息，一个接收更新的状态；同步它们应该很容易。

还有，不要这样...

```
IS = new DataInputStream(sock.getInputStream());
OIS = new ObjectInputStream(sock.getInputStream()); 
```

...因为从 IS 和 OIS 交替读取可能会导致问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-20T14:54:42.677

Another approach would be to register every client at the server. Then, every client has to open its own server port. Whenever a client sends new coordinates to the server, the server has to send this new coordinates to every client other than the one which sends this coordinates.

# jquery - Jquery 背景动画

> ID：10790586
> 
> 赞同：0
> 
> 时间：2012-05-28T21:28:00.867
> 
> 标签：jquery, html

我正在尝试在 JQuery 中使用背景动画方法，但它不起作用。这是我正在使用的代码。

```
$(".menu_item").mouseenter(function(){$(this).animate({backgroundColor: "#FF8040"}, 'fast');});
$(".menu_item").mouseleave(function(){$(this).animate({backgroundColor: "#999"}, 'fast');}); 
```

感谢任何帮助。

* * *

这是其余的。

菜单的 HTML：

```
<div id="menu">
    <a href="index.html" id="home_menu" class="menu_item">Home</a>
    <a href="index.html" class="menu_item">Tutorials</a>
    <a href="index.html" class="menu_item">News</a>
</div> 
```

和脚本：

```
<script type="text/javascript">
    $(document).ready(function(){

        jQuery().ready(function(){
            $(".menu_item").mouseenter(function(){$(this).animate({backgroundColor: "#FF8040"}, 'fast');});
            $(".menu_item").mouseleave(function(){$(this).animate({backgroundColor: "#999"}, 'fast');});

            var pos = $("#fixed_head").position();
            var height = $("#fixed_head").height();
            var height2 = $("#menu").height();

            var screenHeight = $("body").height();
            var newHeight = screenHeight - height - height2;
            $("#container").css("top", (pos.top + height));
            $("#container").css("height", newHeight);
            $("#content").css("height", newHeight);

            $(window).resize(function() {
                var pos = $("#fixed_head").position();
                var height = $("#fixed_head").height();
                var height2 = $("#menu").height();

                var screenHeight = $("body").height();
                var newHeight = screenHeight - height - height2;
                $("#container").css("top", (pos.top + height));
                $("#container").css("height", newHeight);
                $("#content").css("height", newHeight);
            });

        });

    });
    </script> 
```

在头脑中：

```
<script type="text/javascript" src="jquery.js"></script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:31:15.740

如果您使用[jQuery UI](http://jqueryui.com/)库，您的代码应该可以工作。它具有[`animate`](http://jqueryui.com/demos/animate/)方法的颜色过渡效果。

另一种写法是：

```
$(".menu_item").hover(function() {
    $(this).animate({
        backgroundColor: "#FF8040"
    }, 'fast');
}, function() {
    $(this).animate({
        backgroundColor: "#999"
    }, 'fast');
});​ 
```

**演示：http:** [//jsfiddle.net/kbKdY/](http://jsfiddle.net/kbKdY/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:39:03.390

我认为您缺少`jQuery UI 1.8.18`头部中的文件。

例如：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T21:35:26.267

好吧，这不是您问题的直接答案，但是您为什么不使用 CSS 过渡呢？

不过，您可以使用 jQuery 在鼠标事件上添加/删除类。

CSS 转换速度很快（比 JS 动画快）并且非常可靠。如果浏览器不支持 css 过渡，背景颜色将会改变（但不会有动画/过渡） - 这是一个双赢的局面。

**示例代码：http: [//jsfiddle.net/GuSQx/](http://jsfiddle.net/GuSQx/)**

# django - django相关查询过滤器，搜索有无相关项目的项目

> ID：10790590
> 
> 赞同：4
> 
> 时间：2012-05-28T21:28:48.327
> 
> 标签：django, filter, django-queryset

我在进行一个 django 查询，该查询将允许我列出所有具有和不具有任何特定相关对象的项目。

例如，如果我有模型：

```
def Customer(Model):
    name = CharField(...)
    ...

def Order(Model):
    customer = ForeignKey(Customer) 
```

现在，我怎么说“给我所有有订单的客户，反之，给我所有没有订单的客户”？

我到目前为止（不起作用）是这样的：

```
withords = model.objects.all().annotate(orders=Count('order')).filter(orders__gt=0)

without = model.objects.all().annotate(orders=Count('order')).filter(orders__lt=1) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T21:58:50.843

怎么样：

**所有有订单的客户：**

`Customer.objects.filter(order__isnull=False).distinct()`

**所有未下单的客户：**

`Customer.objects.filter(order__isnull=True)`

# javascript - Kotlin 编译器到 JavaScript 中的 JavaScript？

> ID：10790591
> 
> 赞同：6
> 
> 时间：2012-05-28T21:28:49.923
> 
> 标签：javascript, coffeescript, kotlin, coco

JavaScript 中是否有适用于 JavaScript 的 Kotlin 编译器（如 CoffeeScript 或 Coco）？

如果没有，预计何时可用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T07:01:28.073

目前没有这样的实现。

现有的编译器是用 Java 编写的。目前还不清楚我们（JetBrains）是否会在最近的将来开发另一个实现。另一方面，我们总是对贡献持开放态度......

# php - 选择的每个下拉菜单的 PHP

> ID：10790592
> 
> 赞同：-1
> 
> 时间：2012-05-28T21:28:54.643
> 
> 标签：php, drop-down-menu, selected

我在这里得到了这段代码......

```
<form action="InvoiceNotice.php?action=invoicenotice" method="post">
<label for="fordays">Select Day</label>
<select name="daySelected" id="daySelected">
<option value="0">Today</option>
<?php
$array = array_combine(range(1,$InvoiceDaysArray['days']), range(1,$InvoiceDaysArray['days']));
foreach($array as $row => $value){
    $selected = '';
    $daySelected = 0;
    if($daySelected == $row){
    $selected = 'SELECTED';
    }
    echo "<option selected='" . $selected . "' value='" . $row . "'>" . $value . " days ago</option>";
}
?>
</select>
<input type="submit" name="button" id="button" value="Submit" />
</form> 
```

我的问题是`$selected`$daysSelected 变量来自已选择的内容。我想要做的是当用户选择一个选项时，该选项现在在下拉列表中被选中，并且在客户端点击提交后页面返回。

有人知道我在说什么吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:34:27.420

我会做类似的事情：

```
foreach($array as $row => $value){
    $selected = '';
    if($_POST['daySelected'] == $row){
        $selected = ' selected="selected"';
    }
    echo "<option" . $selected . " value='" . $row . "'>" . $value . " days ago</option>";
} 
```

尽管您可能只需要`selected`而不是`selected="selected"`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:36:37.937

我在您的代码中看到一些问题：首先您正在设置`$daySelected = 0;`，然后尝试与数据库中的变量进行比较，第 0 天不在您的 foreach 循环中试试这个

```
 <form action="InvoiceNotice.php?action=invoicenotice" method="post">
<label for="fordays">Select Day</label>
<select name="daySelected" id="daySelected">
<option value="0">Today</option>
<?php
$array = array_combine(range(1,$InvoiceDaysArray['days']), range(1,$InvoiceDaysArray['days']));
foreach($array as $row => $value){
    $selected = '';
    $daySelected = $_POST['daySelected'];
    if($daySelected == $row){
    $selected = "selected=SELECTED";
    }else {$selected='';}
    echo "<option '" . $selected . "' value='" . $row . "'>" . $value . " days ago</option>";
}
?>
</select>
<input type="submit" name="button" id="button" value="Submit" />
</form> 
```

# javascript - 如何划分有向边界框？

> ID：10790593
> 
> 赞同：6
> 
> 时间：2012-05-28T21:28:58.693
> 
> 标签：javascript, geometry, computational-geometry, bounding-box

我正在编写代码，它将为二维的（不一定是凸的）多边形构建一个定向边界框（obb）树。

到目前为止，我能够通过找到它的凸包并在外壳上使用旋转卡尺来找到多边形的面积最小 obb。

下图就是一个例子。带有红线和红点的黄色填充多边形描绘了原始多边形。凸包用黑色线条显示为蓝色，而 obb 显示为紫色线条。

![](../Images/31c7bf9bd7890821962e7eb87124b60f.png)

## （编辑）根据要求：[交互式版本](http://jsfiddle.net/Pj2Ak/1)- 仅在 chrome 中测试

现在我想扩展我的代码来构建一个 OBB 树，而不仅仅是一个 OBB。这意味着我必须切割多边形，并为多边形的每一半计算新的 OBB。

推荐的方法似乎是通过将 OBB 切成两半来切割多边形。但是，如果我将 obb 从其任一轴的中间切开，看起来我将不得不在多边形上创建新顶点（否则我如何找到该分区的凸包？）。

1.  有没有办法避免添加这样的顶点？
2.  如果没有，最简单的方法是什么（相对于实施难度）？什么是运行时效率最高的方式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T05:08:03.530

这是我们要为其创建 OBB 树的凹多边形示例： ![](../Images/5778f258ae174d1b03515d311d76c6f8.png)

为了将它分割成一组新的凹多边形，我们可以简单地通过从中间切割边界框并适当地添加新的“交点”顶点来切割我们当前的多边形：

![](../Images/20d9af5bd245e21658bddd8d3375b14f.png)：

这可以在 O(vertices) 时间内完成，因为我们可以简单地遍历所有边，如果边与红色分割线相交，则添加一个相交顶点。

然后可以根据这些相交顶点划分多边形，以获得一组新的更小（但仍可能是凹面的）多边形。将至少有两个这样的多边形（红线的每边一个），但可能还有更多。在下一张图片中，新的多边形已被着色以强调：

![](../Images/0409a79860ff4e83ce6566826930c1ba.png)

递归地计算这些较小多边形的定向边界框可以得到所需的结果。例如，以下是递归深度为 2 的框：

![在此处输入图像描述](../Images/c6cd1bffa3506cd92cb1c4a37d882392.png)

希望这足以帮助那些与我一样挣扎的人！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T23:30:37.990

*如果没有进一步的上下文，我不确定这是你需要的，但这里有......*

## 将一个凹多边形细分为一组凸多边形

在我上面的评论中，我建议递归地细分凹多边形以获得一组凸多边形。一种（常见）方法如下：

1.  如果多边形是凸的，停止。（我想将多边形添加到数组中）
2.  选择多边形的未标记边。标记边缘。
3.  沿边缘分割多边形（实际上是与边缘重合的无限线）。
4.  对两个结果多边形（如果非空）递归重复此算法。

***注意：****这正是 BSP 树的构建方式。除了在上面的算法中，我们没有构建树节点并在其中存储多边形。也许仅 BSP 的解决方案也可以解决您的问题（而不是使用 OBB）。*

## 测试多边形的凸度（步骤 1）

对于每条边，将每个顶点分类为边上、前边或边后。所有顶点都应该在边上或边上。如果不是（边缘后面至少有 1 个顶点），则多边形是凹的。有关“分类”部分的详细信息，请参阅[我对另一个问题的回答](https://stackoverflow.com/questions/10394329/javascript-separating-axis-theorem/10401714#10401714)，它也这样做了。

## 其余的部分

获得凸子多边形列表后，您可以像在原始帖子中所做的那样为它们生成 OBB。你不会有一个OBB*树*虽然......

通过细分，您*正在*添加顶点（您的问题中的一个问题）。但是，根据您的应用程序，您可能不需要使用细分的多边形：如果您要使用 BSP 树并且只需要简单的碰撞，您只需遍历树并进行一些点/边分类而不处理任何多边形顶点。

无论如何，由于我不知道您希望您的应用程序做什么，因此不确定要进一步推荐什么，但希望这会有所帮助。

**编辑：**我刚刚意识到，也许这就是你想要做的：构建一个 BSP 树并为每个节点生成 OBB，从根节点到叶节点。因此根节点 OBB 将包含整个凹多边形，而叶节点仅包含凸子多边形。我记得最初的 Doom 引擎做了类似的事情（除了轴对齐的 BB）。

# ios - clearButton 在 UITextEditField 中不起作用

> ID：10790597
> 
> 赞同：1
> 
> 时间：2012-05-28T21:29:43.763
> 
> 标签：ios, uitextfield

这是“它在一段时间前工作”的故障排除工作之一。

我正在研究文档预览视图控制器，其中是一个滚动视图，它本身包含代表每个文档的 UIView 的子类。我将这个模型与 Keynote 处理其文档预览的方式非常接近，除了我水平构建滚动视图并使用分页。但是标准的用户体验是存在的：长按文档图标会导致所有文档图标开始抖动，导航栏有 + 按钮和编辑按钮等。

手头的问题是，当您点击文档的名称时，我会隐藏所有其他文档，将正在编辑的文档移到前面和中间，构建一个新的文本编辑字段，将其作为子视图添加到真实姓名标签上，然后将其设置为第一响应者；但是

```
 [editNameTextField setClearButtonMode:UITextFieldViewModeWhileEditing]; 
```

当用户点击清除按钮时，虽然在编辑字段中正确显示并没有采取任何行动。

我无法弄清楚我可能做了什么导致它不起作用 - 它曾经是！

我的第一个想法是不知何故我这个子类的实例不再是这个文本编辑字段的委托。为了尝试确认/否认这一点，我篡夺了文档预览的图像视图上的点击以将委托属性与自身进行比较，并且它通过了。

```
if (editNameTextField) {
    NSLog(@"editNameTextField is still active");
    if ([editNameTextField.delegate isEqual:self]) {
        NSLog(@"we're still the delegate for the editNameTextField");
    }
} 
```

在编辑字段中编辑文本工作正常。正确按下 Return/Done 键会发送代表消息`textFieldShouldReturn:`

在调查这个问题时，我实现了委托方法`textFieldShouldClear:`，只是为了在方法被调用时写一条日志消息（当然返回 YES）。它永远不会被调用。

我的下一个想法是，也许一个子视图覆盖了清除按钮所在的区域。所以我实现`textFieldShouldBeginEditing:`并利用这个机会把我的文本字段放在前面。这也没有改变任何东西。我在那里设置了一个调试器断点，以便在调用它时播放声音，它被调用了，所以我知道我的文本编辑字段在最前面。

我只剩下一个故障排除策略：通过快照倒退，直到它再次开始工作。在这样做之前，我想我会看看这里有没有经验丰富的人对下一步要尝试什么有任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:50:11.627

Where are you adding the textfield? As a subview of the scrollView? If you added the textfield and it is out of bounds of its parent view it won't receive any touches.

You can try and not call becomeFirstResponder and see if clicking it will show keyboard. Another possible error might be that the parent view of the UITextField has userInteractionEnabled = NO.

Without seeing more code I'm afraid I can not offer more solutions.

# ruby-on-rails - 您如何创建自己的 less 变量并使用 rails 资产管道将它们导入其他样式表？

> ID：10790598
> 
> 赞同：2
> 
> 时间：2012-05-28T21:29:44.103
> 
> 标签：ruby-on-rails, asset-pipeline, less

我在应用程序中使用 less css 和 twitter-bootstrap-rails，但我不知道如何创建自己的自定义 less 变量。我创建了一个名为 stylesheets/globals/variables.css.less 的文件，我想用它来定义自定义调色板。

我尝试将该文件导入到我想使用自定义颜色变量的其他样式表中，但我不断收到未定义的变量错误。

从 twitter-bootstrap rails gem 中引入变量没有问题。例如@import "twitter/bootstrap/bootstrap"；在 booststrap_and_overrides.css.less 文件中工作得很好。

解决这个问题的唯一方法是运行 rake assets:precompile，但这不是一个可行的解决方案。有没有办法在运行时使用变量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T20:41:31.263

我相信我遇到了类似的问题。我通过将自定义变量文件重命名为：

```
my_custom_variables.less 
```

并添加：

```
@import "my_custom_variables"; 
```

到引用我的自定义变量的 CSS 文件的顶部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T15:54:58.590

现在有没有更好的方法来做到这一点？必须将变量与您要在应用程序中使用的每个样式表一起导入似乎非常不干燥，特别是如果您为每个模型使用单独样式表的 Rails 约定。

# javascript - 为什么不是所有属性都可以从内置对象（Javascript）继承/访问？

> ID：10790600
> 
> 赞同：0
> 
> 时间：2012-05-28T21:30:17.420
> 
> 标签：javascript

在我读过的所有书籍/资料中，他们以通用的绝对术语谈论对象的所有实例都继承并可以访问创建对象的原型的方法。在大多数情况下，这似乎是正确的。但这似乎不像我读过的那样普遍。一个简单的例子：

对于数字类型的对象，长度属性未定义。

例如：

```
x = 5;
typeof x;
=> returns number
number.length
=> returns undefined 
```

我知道一个数字有一个长度没有多大意义（尽管我想它可以反映数字中的位数），困扰我的部分是我准备好的一切都在谈论这个绝对原则的继承。既然一切都是从内置的 Object 派生的，甚至内置的 Number 对象也有 length 属性，为什么在上面的例子中不能访问 x 的这个属性呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:40:05.100

该符号`Number`是指数字**构造函数**，而不是原型对象。所有函数都有一个“.length”属性，在函数声明中给出形式参数的数量。正如您所说，`Number`内置函数确实是一个对象，但特别是它是一个函数（的实例`Function`）。

没有“长度”属性`Number.prototype`，这就是实例没有这种属性的原因。（如果您愿意，当然可以将一个添加到任何实例或原型中。）

# performance - Spring-MVC 与原始 Servlet：内存消耗、性能

> ID：10790601
> 
> 赞同：6
> 
> 时间：2012-05-28T21:30:28.357
> 
> 标签：performance, memory, servlets, spring-mvc

我正在阅读[“原始 Servlet 与 Spring MVC”](https://stackoverflow.com/questions/10775522/raw-servlet-vs-spring-mvc)的问题，想知道与原始 servlet 相比，Spring MVC 是否会减慢或增加应用程序的内存消耗？

注意：我最初在上述问题中将其作为评论提出，然后被邀请将其作为单独的问题发布。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T21:37:58.443

定义“炸毁”。定义“减速”。

当然内存使用会更高，当然性能也会更低。

与 Spring 提供的附加功能和灵活性相比，高低*多少*才是*真正的*问题，而且对假设的应用程序一无所知，这是不可能的。

构建一个可测试、可扩展、架构良好的纯 servlet 应用程序将涉及重新实现 Spring 提供的许多功能。您更愿意做什么——重新实现一些（基本上）行业标准代码，使其达到已实现的程度，然后编写您的应用程序，还是只编写您的应用程序？你的*老板*希望你做什么？

# php - 将 POST 数据重定向到负载最少的服务器

> ID：10790602
> 
> 赞同：0
> 
> 时间：2012-05-28T21:30:29.540
> 
> 标签：php, post, amazon-ec2

我想使用 jQueryFileUpload ( [http://blueimp.github.com/jQuery-File-Upload/](http://blueimp.github.com/jQuery-File-Upload/) ) 上传数据，尤其是音乐到处理它的服务器。我想在普通网络服务器上有一个脚本，将当前上传的文件重定向到负载最小的服务器。这些服务器是 Amazon EC2 实例，由 Amazon CloudWatch 监控。如果所有 EC2 实例的平均使用率高于 70%，则会启动新实例。

那可能吗？如何将 Serverload 放入 PHP 重定向脚本？如何处理 $_POST 数据重定向？

# django - Heroku、Django 和 Sendgrid - 电子邮件不发送？

> ID：10790603
> 
> 赞同：2
> 
> 时间：2012-05-28T21:30:41.550
> 
> 标签：django, heroku, sendgrid

所以我使用 heroku 和 sendgrid 并认为我的 settings.py 配置正确：

```
EMAIL_HOST_USER = os.environ['SENDGRID_USERNAME']
EMAIL_HOST= 'smtp.sendgrid.net'
EMAIL_PORT = 587
EMAIL_USE_TLS = True
EMAIL_HOST_PASSWORD = os.environ['SENDGRID_PASSWORD'] 
```

我正在使用这样的 send_mail 发送电子邮件（使用 pre_save 接收器来检查属性是否已更改...还将“myemail@gmail.com”替换为我的实际电子邮件）：

```
@receiver(pre_save,sender=LotteryEntry)
def send_email_if_invited(sender,instance,**kwargs):
    try:
        obj = LotteryEntry.objects.get(pk=instance.pk)
    except LotteryEntry.DoesNotExist:
        #could send email here telling them when they should know
        pass
    else:
        if not obj.invited == instance.invited:
            l = Dinner.objects.get(id=instance.dinner.id)
            u = User.objects.get(id=instance.user.id)
            message = "You have been chosen to attend %s! Here is the description of the event: %s. We will see you there!" % (l.title,l.description)
            send_mail('You have been invited!',message,'myemail@gmail.com',[u.email],fail_silently=False) 
```

日志显示它正在发送..但我没有在我的收件箱中收到它，sendgrid 插件帐户部分也没有说我已经发送了电子邮件。以前有人有这个问题吗？

编辑：

这是我导入的 settings.py

```
import os
import sys 
```

还有我的模型文件（send_mail 发生的地方）：

```
from django.db import models
from django.contrib.auth.models import User
from django.db.models.signals import *
from django.dispatch import receiver
from django.core.mail import send_mail 
```

这是 send_mail 调用的日志：

```
Content-Type: text/plain; charset="utf-8"
2012-05-28T21:16:49+00:00 app[web.1]: MIME-Version: 1.0
2012-05-28T21:16:49+00:00 app[web.1]: Content-Transfer-Encoding: quoted-printable
2012-05-28T21:16:49+00:00 app[web.1]: Subject: You have been invited!
2012-05-28T21:16:49+00:00 app[web.1]: From: msencenb@stanford.edu
2012-05-28T21:16:49+00:00 app[web.1]: To: msencenb@stanford.edu
2012-05-28T21:16:49+00:00 app[web.1]: Date: Mon, 28 May 2012 21:16:49 -0000
2012-05-28T21:16:49+00:00 app[web.1]: Message-ID: <20120528211649.1.49209@2a33c2a2-9b5e-4da9-994c-15de8157702e>
2012-05-28T21:16:49+00:00 app[web.1]: 
2012-05-28T21:16:49+00:00 app[web.1]: You have been chosen to attend Web Development Pt. 1! Here is the descripti=
2012-05-28T21:16:49+00:00 app[web.1]: on of the event: Knight Management Center, 5/23/12 12:30 to 2 PM. We will s=
2012-05-28T21:16:49+00:00 app[web.1]: ee you there!
2012-05-28T21:16:49+00:00 app[web.1]: -------------------------------------------------------------------------------
2012-05-28T21:16:49+00:00 app[web.1]: [28/May/2012 16:16:49] "POST /admin/dinners/lotteryentry/1/ HTTP/1.1" 302 0
2012-05-28T21:16:49+00:00 heroku[router]: POST morning-frost-2949.herokuapp.com/admin/dinners/lotteryentry/1/ dyno=web.1 queue=0 wait=0ms service=107ms status=302 bytes=0 
```

# go - 编译了哪些文件？

> ID：10790605
> 
> 赞同：0
> 
> 时间：2012-05-28T21:30:43.643
> 
> 标签：go

当您有多个特定于系统的文件时，如何知道哪些文件将被编译和链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T03:01:32.553

至少有两种选择：

1.  用于`go build -n`列出将由构建执行的命令，然后解析输出。
2.  使用[`go/build`](http://golang.org/pkg/go/build/)包。具体来说，看一下[Import](http://golang.org/pkg/go/build/#Import)函数。

我建议第二种方法；如果我正确理解您的问题，它会满足您的需求。您指定要“导入”的包，它会返回一个`Package`结构，其中包含将被编译的 Go、C、ASM 文件集。

# java - Windows 7中的Javacv UnsatisfiedLinkError

> ID：10790613
> 
> 赞同：4
> 
> 时间：2012-05-28T21:31:20.587
> 
> 标签：java, windows-7, opencv, javacv, unsatisfiedlinkerror

在我的项目中，我想从我的网络摄像头捕获图像。

我按照此[“OpenCV-JavaCV：eclipse 项目配置 windows 7”博客文章](http://ganeshtiwaridotcomdotnp.blogspot.com/2011/12/opencv-javacv-eclipse-project.html)中的说明逐步配置。

配置完成后，我测试了示例代码，应用程序找到了我的网络摄像头

SETUP：设置设备 0

设置：Namuga 1.3M 网络摄像头

设置：使用 SmartTee 找不到预览图钉

SETUP：捕获回调集

SETUP：设备已设置并准备好捕捉。

然后我得到一个错误，即.dll错误。

我使用 Windows 7 x64。

```
Exception in thread "Thread-2" java.lang.UnsatisfiedLinkError: C:\Users\Administrator\AppData\Local\Temp\javacpp153028723186\jniopencv_core.dll: Can't find dependent libraries
at java.lang.ClassLoader$NativeLibrary.load(Native Method)
at java.lang.ClassLoader.loadLibrary1(Unknown Source)
at java.lang.ClassLoader.loadLibrary0(Unknown Source)
at java.lang.ClassLoader.loadLibrary(Unknown Source)
at java.lang.Runtime.load0(Unknown Source)
at java.lang.System.load(Unknown Source)
at com.googlecode.javacpp.Loader.loadLibrary(Loader.java:418)
at com.googlecode.javacpp.Loader.load(Loader.java:368)
at com.googlecode.javacpp.Loader.load(Loader.java:315)
at com.googlecode.javacv.cpp.opencv_core.<clinit>(opencv_core.java:131)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Unknown Source)
at com.googlecode.javacpp.Loader.load(Loader.java:334)
at com.googlecode.javacpp.Loader.load(Loader.java:315)
at com.googlecode.javacv.cpp.opencv_core$CvArr.<clinit>(opencv_core.java:158)
at com.googlecode.javacv.VideoInputFrameGrabber.grab(VideoInputFrameGrabber.java:158)
at GrabberShow.run(GrabberShow.java:24)
at java.lang.Thread.run(Unknown Source) 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T16:50:59.820

检查您的 Opencv 版本和 JavaCv 版本是否相互匹配。您可以在 javacv-bin 上的自述文件中检查它，它特别说明了所需的 opencv 版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T13:14:15.487

我在 Windows XP 和 Windows 7 上遇到了这个问题，这就是我使用 Netbeans 7.2 在两个平台上修复它的方法：

## 安装所有必需的软件：

*   **FFmpeg**（32 位共享）：[Zeranoe FFmpeg](http://ffmpeg.zeranoe.com/builds/)提供 win32 构建。下载并解压[ffmpeg-20121020-git-04bf2e7-win32-shared.7z](http://ffmpeg.zeranoe.com/builds/win32/shared/ffmpeg-20121020-git-04bf2e7-win32-shared.7z)。将其内容放在`C:\ffmpeg`.

***注意***：确保`C:\ffmpeg\bin`是有效路径。

*   **OpenCV 2.4.2** (32-bit)：下载[OpenCV-2.4.2.exe](http://sourceforge.net/projects/opencvlibrary/files/opencv-win/2.4.2/)并解压。将其内容放在`C:\opencv`.

***注意***：确保`C:\opencv\build\x86\vc10\bin`路径有效。

*   **JavaCV 0.2**：下载[javacv-0.2-bin.zip](http://code.google.com/p/javacv/downloads/list)并解压。将提取的文件夹移动到 `C:\javacv-bin`.

*   **Microsoft Visual C++ 可再发行包**（32 位）：下载并安装[vcredist_x86.exe](http://www.microsoft.com/download/en/details.aspx?id=5555)。

## 配置环境：

*   [编辑环境变量 PATH](http://www.computerhope.com/issues/ch000549.htm)并在末尾附加以下路径：

`C:\ffmpeg\bin;C:\opencv\build\x86\vc10\bin`

现在您已准备好创建一个新的 Netbeans 项目并测试您的应用程序。但在编译之前，不要忘记右键单击pProjects 窗口*中的**Libraries文件夹，然后单击****Add Jar/FOLDER**以选择位于 .jar 的所有**.jar**文件`C:\javacv-bin`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T21:46:21.223

不满意的链接意味着无法找到 jniopencv_core.dll 所需的所有本机代码库。

您是全部部署它们还是只部署了 jniopencv_core.dll？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T21:48:30.653

确保你的 vm arg`-Djava.library.path=<path-to-native>`指向你的 dll 所在的目录。

# objective-c - Objective-C - NSLog - "%@" 引用字符

> ID：10790614
> 
> 赞同：1
> 
> 时间：2012-05-28T21:31:20.600
> 
> 标签：objective-c, nslog

我正在阅读 BNR iOS 编程文本，并且遇到了这段代码：

```
 NSLog(@"%@", [items objectAtIndex:i]); 
```

我不确定“%@”的用途。我见过其他引用整数或字符的格式，但我从未见过这种情况。

我什至[在这里](http://blog.teliaz.com/2010/objective-c-basic-datatypes-and-nslog)检查了这个参考，它什么都没有。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T21:32:36.537

%@ 用于打印objective-c 对象。

更准确一点。每个对象都可以覆盖

```
-(NSString *)description 
```

使用 %@ 时会调用此方法。这取决于对象它将在`NSString`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T21:42:55.343

据苹果称：

> `descriptionWithLocale:`Objective-C 对象，如果可用，则打印为返回的字符串，`description`否则。也适用于`CFTypeRef`对象，返回`CFCopyDescription`函数的结果。

参考：

*   [字符串格式说明符](https://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/Strings/Articles/formatSpecifiers.html#//apple_ref/doc/uid/TP40004265)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T14:35:41.027

我正在处理相同的文本 - 并且来自 Java 背景，“%@”格式化程序似乎等同于 Java 将具有的“toString”方法。它用于显示有关对象的自定义信息。

在对“toString()”等价物的这个 StackOverflow[问题的回复中有一个很好的例子。](https://stackoverflow.com/questions/1104746/what-is-the-objective-c-equivalent-for-tostring-for-use-with-nslog)

# tfs - 根据 TFS 中的另一个字段自动更改字段

> ID：10790619
> 
> 赞同：2
> 
> 时间：2012-05-28T21:31:44.763
> 
> 标签：tfs

是否可以根据 TFS 中另一个字段的值更改字段的值？

我想要做的是，当故事点字段的值发生变化时，使用相应的 T 恤尺寸值自动更新另一个字段。

例如，我们使用 2 的幂来表示故事点；因此，对于 1 分的故事，它对应的 T 恤值为 XS，对于 2 分的故事，对应的 T 恤值为 S，依此类推。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:53:38.117

使用`WHEN`条件和[`COPY`](http://msdn.microsoft.com/en-us/library/ms194948)规则的组合：

```
<FIELD name="StoryPoints Size" refname="Custom.StoryPoints.Size" type="String">
  <WHEN field="Microsoft.VSTS.Scheduling.StoryPoints" value="1">
    <COPY from="value" value="XS" />
  </WHEN>
  <WHEN field="Microsoft.VSTS.Scheduling.StoryPoints" value="2">
    <COPY from="value" value="S" />
  </WHEN>
  <WHEN field="Microsoft.VSTS.Scheduling.StoryPoints" value="3">
    <COPY from="value" value="M" />
  </WHEN>
  <WHEN field="Microsoft.VSTS.Scheduling.StoryPoints" value="4">
    <COPY from="value" value="L" />
  </WHEN>         
  <WHEN field="Microsoft.VSTS.Scheduling.StoryPoints" value="5">
    <COPY from="value" value="XL" />
  </WHEN>         
</FIELD> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:37:02.800

您可以[在 MSDN 上](http://msdn.microsoft.com/en-us/library/ms194966.aspx)找到您需要的所有内容，更具体地说，该部分称为：

“在用户更改另一个字段时定义一个字段 (WHENCHANGED)”。

# ios - iOS Xcode：警告方法不在最低目标 SDK 中

> ID：10790622
> 
> 赞同：19
> 
> 时间：2012-05-28T21:32:21.080
> 
> 标签：ios, xcode, sdk

当我调用的方法在支持的最低目标的 SDK 中不可用时，有没有办法让 Xcode 告诉我？

例如方法[NSURLConnection sendAsynchronousRequest:queue:completionHandler:]。此方法适用于 iOS5 及更高版本。但我的应用程序的最低目标是 iOS4。

如果我使用该方法 (sendAsync)，我希望 Xcode 告诉我该方法不适用于我试图支持的最小目标。

我尝试将 __IPHONE_OS_VERSION_MAX_ALLOWED=40000 放在预处理器设置中，但这只会触发一堆无用的 Apple SDK 错误。（可能是因为我激活的SDK是iOS5.1）

获取旧 SDK 并将其安装在 Xcode 中的唯一解决方案是什么？

有没有更简单的解决方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T08:56:44.747

不幸的是，没有标准的方法可以做到这一点。通过将目标操作系统设置为比基础 SDK 更低的数字，Xcode 将弱链接库和框架。这样做时，Xcode 不会警告您使用目标操作系统上可能不可用的方法。

您可以暂时将基本 SDK 设置得较低，但这可能并不总是有效。由于您想忽略产生的大多数错误和警告（因为它们仅在您的代码路径中有条件地调用），并且许多警告和错误取决于您可能需要在编译器给出任何有意义的输出之前解决的其他错误。

我认为不存在任何静态分析工具，无论是来自 Apple 还是第三方。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-29T16:51:24.590

After doing some research, reading the [Apple Doc](http://developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/cross_development/Configuring/configuring.html#//apple_ref/doc/uid/10000163i-CH1-SW2) about it, and trying a number of things. The solution is downloading an old Xcode DMG from Apple, grab the .pkg file for the same SDK as your deployment target and install it in your version of Xcode. Here's how:

1.  Download older Xcode.dmg from Apple
2.  Open the DMG
3.  In Terminal, go into packages: "cd /Volumes/[DMG]/Packages; open ."
4.  Find the SDK you want, something like iPhoneSDK_4.0.pkg
5.  Install that package, but change the install directory to /Applications/Xcode/Contents/Developer
6.  Restart Xcode if it was open.

Now that you have the same SDK as your deployment target, set your BaseSDK to the same. When you build you'll get warnings about missing methods. Your project may or may not successfully build with an older BaseSDK in a new version of Xcode, but that doesn't matter - you've just found the method calls you need to wrap in a feature check with respondsToSelector:.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-09-22T04:54:52.583

从 Xcode 7.3 开始，编译器现在可以为您生成这些警告。您需要做的就是`-Wpartial-availability`在构建设置中设置警告标志，如[本答案](https://stackoverflow.com/a/45075684/3818946)中所述。

# css - Bootstrap CSS - 对齐绝对定位的按钮和输入

> ID：10790623
> 
> 赞同：0
> 
> 时间：2012-05-28T21:32:22.020
> 
> 标签：css, forms, twitter-bootstrap, css-position

[http://jsfiddle.net/D2RLR/122/](http://jsfiddle.net/D2RLR/122/)

我需要实现以下目标：

*   包含父有序列表/定义列表中的输入
*   让箭头按钮的右边缘与每个文本输入的右边缘齐平（从而部分覆盖输入。我稍后将隐藏这些并使用 jQuery 在悬停时显示）

    ```
    HTML

    <div class="container">
    <div class="row-fluid">
    <div class="span4">
      <form id="" class="well sidebar-nav">
        <dl>
            <dt><input type="text" class="counter nospace" name="myList_name" id="myList_name"/></dt>
            <dd>
                <ol>
                    <li><input type="text" name="myList_item_1" class="counter box" id="myList_item_1" /><div id="myList_chart_1" class="chart"><a class="btn" href="#">&uarr;</a><a class="btn" href="#">&darr;</a></div></li>
                    <li><input type="text" name="myList_item_2" class="counter box" id="myList_item_2" /><div id="myList_chart_2" class="chart"><a class="btn" href="#" style="z-index:0">&uarr;</a><a class="btn" href="#">&darr;</a></div></li>
                    <li><input type="text" name="myList_item_3" class="counter box" id="myList_item_3" /><div id="myList_chart_3" class="chart"><a class="btn" href="#">&uarr;</a><a class="btn" href="#">&darr;</a></div></li>
                    <li><input type="text" name="myList_item_4" class="counter box" id="myList_item_4" /><div id="myList_chart_4" class="chart"><a class="btn" href="#">&uarr;</a><a class="btn" href="#">&darr;</a></div></li>
                    <li><input type="text" name="myList_item_5" class="counter box" id="myList_item_5" /><div id="myList_chart_5" class="chart"><a class="btn" href="#">&uarr;</a><a class="btn" href="#">&darr;</a></div></li>
                    </ol>
            </dd>
        </dl>
      </form>
      </div>
    </div>
    </div>

    CSS

    @import url('http://twitter.github.com/bootstrap/assets/css/bootstrap.css');

    .sidebar-nav {
    padding: 9px 0;
    }
    .nav {
      list-style: decimal;
    }
    .counter {
      width: 100%;
    }
    dt {
      margin-left: 34px;
    }
    form dl dd ol {
      position: relative;
    }
    .box {
      position: absolute;
      top: 0;
    }

    #myList_item_1, #myList_chart_1 { top: 0; }
    #myList_item_2, #myList_chart_2 { top: 36px; }
    #myList_item_3, #myList_chart_3 { top: 72px; }
    #myList_item_4, #myList_chart_4 { top: 108px; }
    #myList_item_5, #myList_chart_5 { top: 144px; }

    ol li {
      margin-bottom: 18px;
      z-index: 0;
    }
    .chart {
      width: 58px;
      position: absolute;
      top: 0;
      z-index: 1;
      margin-left: 100%;
      margin-right: 0;
    } 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:47:10.950

好的 - 我快到了：

[http://jsfiddle.net/D2RLR/151/](http://jsfiddle.net/D2RLR/151/)

就像申请正确一样简单：0; 到 .chart 类。

我唯一仍在努力的是将按钮与输入对齐。

# iphone - UIImageView 泄漏/自动释放

> ID：10790629
> 
> 赞同：1
> 
> 时间：2012-05-28T21:32:43.957
> 
> 标签：iphone, xcode

我正在运行一个相当消耗内存的循环来生成图像，并且已经陷入内存泄漏/自动释放保留内存分配太久的问题。

任何人都可以准确解释下面持有和自动发布的内容吗？我已经通过 Allocations 工具运行了它，它的大小会增加，直到循环完成并释放所有自动释放对象（我从 3 天的反复试验中了解到）。这对于较少的循环是可以的，但是当我超过 200 时，它最终会在它自动释放之前崩溃。通过注释掉以下代码，这种增加停止并且仪器图表保持水平并具有一定的内存量：

```
 for (int l=0;1 < 300; 1++) {
      UIImage * Img = [[UIImage alloc] initWithContentsOfFile:Path]; //Path is a NSString pointing to bundlePath and a sample image
      UIImageView *ImgCont = [[UIImageView alloc] initWithImage:Img];

      //here I usually add the view to a UIView but it is not required to see the problem
      ImgCont.frame = CGRectMake(x, y, w, h);

      [ImgCont release];
      [Img release];
   } 
```

我试过用 NSAutoreleasePool 包装它但没有成功 - 任何想法我做错了什么？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:44:29.683

当您将 imageView 添加到视图时，它会被该视图保留，因此即使您释放 Img 和 ImgCont，它们仍然存在，并且您会留下 300 个对象。

另外，我对此并不完全确定，但是如果您一遍又一遍地使用相同的图像，则应该使用 [UIImage imageNamed:NAME]，因为它会重复使用图像，对于 [UIImage initWithContentsOfFile:小路]; （如果操作系统没有优化这种情况，现在你在内存中拥有相同的图像 300 次）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:39:06.343

您明确创建的所有对象都没有被自动释放，因此它必须是您拥有的那些 UIKit 调用中的内容。尽管就减少自动发布的数量而言，您对此无能为力。但是你能做的就是搞乱自动释放池。

您说您已经尝试过`NSAutoreleasePool`，但是您是否尝试过将循环的每次迭代包装在一个池中，如下所示：

```
for (int l=0;1 < 300; 1++) {
    @autoreleasepool {
        UIImage * Img = [[UIImage alloc] initWithContentsOfFile:Path]; //Path is a NSString pointing to bundlePath and a sample image
        UIImageView *ImgCont = [[UIImageView alloc] initWithImage:Img];

        //here I usually add the view to a UIView but it is not required to see the problem
        ImgCont.frame = CGRectMake(x, y, w, h);

        [ImgCont release];
        [Img release];
    } 
```

}

尽管您应该考虑不要完全那样做，因为它可能有点矫枉过正。但是我建议您尝试一下，如果您仍然遇到问题，那么这不是这个循环。

# windows - 使用 MultiByteToWideChar

> ID：10790632
> 
> 赞同：2
> 
> 时间：2012-05-28T21:33:16.353
> 
> 标签：windows, winapi

以下代码打印所需的输出，但在字符串末尾打印垃圾。最后一次调用 MultiByteToWideChar 有问题，但我不知道是什么问题。请帮忙？？

```
#include "stdafx.h"
#include<Windows.h>
#include <iostream>
using namespace std;
#include<tchar.h>

int main( int, char *[] )
{
    TCHAR szPath[MAX_PATH];
    if(!GetModuleFileName(NULL,szPath,MAX_PATH))
    {cout<<"Unable to get module path"; exit(0);}

    char ansiStr[MAX_PATH];
    if(!WideCharToMultiByte(CP_ACP,WC_COMPOSITECHECK,szPath,-1,
        ansiStr,MAX_PATH,NULL,NULL))
    {cout<<"Unicode to ANSI failed\n";
    cout<<GetLastError();exit(1);}

    string s(ansiStr);

    size_t pos = 0;

    while(1)
    {
        pos = s.find('\\',pos);
        if(pos == string::npos)
            break;
        s.insert(pos,1,'\\');
        pos+=2;
    }

    if(!MultiByteToWideChar(CP_ACP,MB_PRECOMPOSED,s.c_str(),s.size(),szPath,MAX_PATH))
    {cout<<"ANSI to Unicode failed"; exit(2);}

    wprintf(L"%s",szPath);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:37:40.197

MSDN 对 cbMultiByte 参数有这样的说法：

> 如果此参数为 -1，则该函数处理整个输入字符串，包括终止空字符。因此，生成的 Unicode 字符串有一个终止空字符，并且函数返回的长度包括该字符。
> 
> 如果此参数设置为正整数，则该函数将精确处理指定的字节数。如果提供的大小不包含终止空字符，则生成的 Unicode 字符串不是空终止的，并且返回的长度不包含此字符。

..因此，如果您希望输出字符串以 0 终止，则应在传入的长度中包含 0 终止符，或者根据返回值终止您自己...

# git - 使用带有子存储库和子模块的深层 Git 存储库-存储库-tree 更改权限？

> ID：10790634
> 
> 赞同：0
> 
> 时间：2012-05-28T21:33:49.960
> 
> 标签：git

我决定在 repository -tree 中默认限制可见性范围，以便为精美的东西创建 public 文件夹。现在因为有很多子存储库，我得到了一个痛苦的提交或一些聪明的想法。我不确定最好的方法——我想过用 find 遍历 repos，然后对每个 repo 做一个一致的 -dummy 提交，`"default perms lower and polished public things to public dir in the root to get the quality up"`但我可能正在重新发明轮子。我不能选择限制子存储库和子模块的数量，因此提交必须从最低的 repo 开始，然后如果使用 find 则一点一点地遍历。

如何处理这种深度 Git repo-repo -tree 更新？

**也许相关**

> 1.  [Git：如何避免重复提交 sub-sub-sub... Git -repos？](https://stackoverflow.com/questions/10068119/avoid-repetitive-committing-with-sub-sub-sub-git-repos)
>     
>     
> 2.  [Git：管理和构建项目的工具？](https://stackoverflow.com/questions/11253615/git-a-tool-to-manage-and-to-structure-projects-in-the-version-control)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T15:58:13.017

> *使用更好的工具！*

避免诸如`$ find . -exec git checkout '{}' \;`然后递归/手动修复权限之类的黑客行为。有一个名为 Gitslave 的工具可以更轻松地管理不断扩大的投资组合。有价值的文章[在这里](http://sethrobertson.github.com/GitBestPractices/#tool)。[我还建议您在这里](https://stackoverflow.com/a/11371872/164148)阅读此线程，再次出现 SethRobertson 的文章 - 非常好阅读。

**为什么需要 Gitslave？**

> `Happy.git`假设您对 repo的结构 进行了更改，例如`"Works.git > Project.git > Pictures.git > Happy.git"`. 然后有人试图从你的裸 -git repo 中提取，例如`Project.git`. 因为你是一个 git，你只在`Happy.git`. 现在你的朋友会得到一些令人讨厌的错误。懒惰的 git 会使用 `gitslave`-tool。
> 
> ```
> $ mkdir t1; cd t1; mkdir t2; cd t2; mkdir t3; git init; echo "t3" >t3; git add .; git commit -m "t3"; cd ..; git init; echo "t2" >t2; git add .; git commit -m "t2"; git init; echo "t1" >t1; git add .; git commit -m "t1"; cd ..; cd t1/t2/t3; echo "only here">only; git add .; git commit -m "only"; cd ../..; git status
> # On branch master
> # Untracked files:
> #   (use "git add <file>..." to include in what will be committed)
> #
> # t2/
> $ Look you need to do repetitive work because you did not use Gitslave! 
> ```

**安装 Gitslave 的演练**

> 不幸的是，Gitslave 还没有在 Apt-get 中，所以 [在这里](http://gitslave.sourceforge.net/)下载。
> 
> 它看起来有点像 Maven，更多 [在这里](https://stackoverflow.com/questions/11253615/structure-of-projects-in-version-control-something-like-maven-for-non-java-pro)。你用它来管理你的项目。首先，您指定超级-repo，然后附加从-repos。
> 
> ```
> $ git clone http://someGitRepoHere.com/xyz.git super
> $ cd super; gits prepare
> $ gits attach http://someBareRepo.git yourDirHere 
> ```
> 
> 更多关于 153 等行的 [信息](http://gitslave.git.sourceforge.net/git/gitweb.cgi?p=gitslave/gitslave;a=blob;f=README;h=15cc7076fc876c402ad86bd1e4de7ac6c53ee278;hb=e096b161b5bf7cac1ac537fa749bb27daa2ac999)。

当 Gitslave 进入 apt-get 等包管理软件时，我将继续这个答案，因此它对人们更有用。

# backbone.js - 如何使用 Backbone.js 生成模型 ID

> ID：10790637
> 
> 赞同：21
> 
> 时间：2012-05-28T21:34:18.880
> 
> 标签：backbone.js

我正在设置主干同步机制，有点困惑在哪里为模型生成 id。

当我创建一个新模型时，主干是否应该生成和设置 id，或者我应该实现一个 id 生成方法，或者是否有某种机制可以将数据“PUT”到服务器，生成 id 和返回带有 id 的模型？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-05-29T05:46:56.967

我提供第二个答案来简化您需要研究的代码，以获得您正在思考的要点 - 从模型到服务器的实际回合以及 id 如何发挥它们的作用。

假设您定义了一个模型 - 让我们使用侏罗纪公园。

```
// Define your model
var Dinosaur = Backbone.Model.extend({
    defaults: {
        cavemanEater: undefined    // Has one property, nom nom or not.
    },
    urlRoot: 'dino'               // This urlRoot is where model can be saved or retrieved
});

var tRex = new Dinosaur({'cavemanEater':true}); 
```

您现在已经实例化了一个肉食者恐龙。怒吼。

```
console.log(tRex); 
```

您应该注意的是，在 tRex 的属性中，您的模型没有 id。相反，您将看到一个 cID，您可以将其视为 Backbone 自动分配给您的模型的临时 id。当模型没有 id 时，它被认为是新的。持久化模型（数据库或本地存储）的概念允许您在创建该资源后返回该资源并执行保存（PUT）或销毁（DELETE）等操作。如果您无法再次直接指向该资源，将很难找到该资源！为了找到该资源，您的模型需要一个 ID，它目前没有。

因此，正如上述答案所解释的，为 Backbone 提供资源 ID 是您的数据库（或本地存储或其他解决方案）的工作。大多数情况下，这来自资源 ID 本身，也就是您的模型在某个表中的主键 ID。

通过我的设置，我使用 PHP 和 mySQL。我会有一个名为 Dinosaur 的表，每一行都是我的恐龙模型的持久表示。所以我有一个 id 列（唯一的自动递增 int）和cavemanEater（bool）。

数据通信流程是这样发生的。

1.  您创建一个模型。
2.  该模型是新的，因此它只有一个 cID - 没有正确的 ID。
3.  您保存模型。
4.  您的模型的 json 表示已发送到您的服务器（POST）
5.  您的服务器将其保存到表中并为其提供资源 ID。
6.  您的服务器发送回数据 {id:uniqueID} 的 json 表示
7.  Backbone 接收到这个带有 id 的 json 表示
8.  Backbone 使用 id 自动更新您的模型。

这是带注释的代码的样子。

客户：

```
tRex.save();
// {'cavemanEater':true} is sent to my server
// It uses the urlRoot 'dino' as the URL to send. e.g. http://www.example.com/dino 
```

服务器：

```
// Is setup to accept POST requests on this specific ROUTE '/dino'
// Server parses the json into something it can work with, e.g. an associative array
// Server saves the data to the database. Our data has a new primary id of 1.
// Data is now persisted, and we use this state to get the new id of this dino.

$dinoArray = array('id'=>1, 'cavemanEater'=>true);
$dinoJSON = json_encode($dinoArray);

// Server does something to send $dinoJSON back. 
```

客户：

```
// If successful, receives this json with id and updates your model. 
```

现在你的 tRex 有一个 id = 1。或者我应该说......

```
tRex.toJSON();
// RETURNS {'id':'1', 'cavemanEater':'true'} 
```

恭喜。如果你这样做`tRex.isNew()`，它将返回 false。

骨干很聪明。它知道 POST 已经具有资源 ID 的新模型和 PUT 模型。

下次您这样做时：

```
tRex.save(); 
```

Backbone 将向以下 URL 发出 PUT 请求。

[http://www.example.com/dino/1](http://www.example.com/dino/1)

顺便说一句，这是默认行为。但是您会注意到 URL 与保存不同。在服务器上，您需要一个接受 /dino/:id 而不是 /dino 的路由

默认情况下，它将为您的模型使用 /urlRoot/:id 路由模式，除非您另行调整。

不幸的是，恐龙已经灭绝了。

```
tRex.destroy(); 
```

这将调用......你能猜到吗？是的。对 /dino/1 的删除请求。

您的服务器必须区分对不同路由的不同请求，以便 Backbone 工作。有几种服务器端技术可以做到这一点。

如果你使用 Ruby，有人提到了 Sinatra。就像我说的，我使用 PHP，我使用 SLIM PHP Framework。它的灵感来自 Sinatra，所以很相似，我喜欢它。作者写了一些干净的代码。不过，这些 RESTful 服务器实现的工作原理不在本次讨论的范围之内。

我认为这是没有 id 的新 Backbone 数据的基本完整旅行，通过 Internet 到它生成的服务器，然后发回资源 id，让你的模型从此过上幸福的生活。（或者`destroy()`不是……）

我不知道这对你来说是否太初学者，但希望它能帮助遇到这个问题的其他人。Backbone 编程真的很有趣。

其他类似的答案： [如何保存 Backbone JS 模型数据](https://stackoverflow.com/a/9862135/972393)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-29T01:27:47.067

> > 或者是否有某种机制我将数据“PUT”到服务器，它生成 id 并返回带有 id 的模型？

有点儿。当您调用模型的保存方法时，主干会生成一个 POST XHR，并且您的应用程序服务器应该以包含 id 的 JSON 响应。你可以在这里看到一个例子：http: [//addyosmani.com/blog/building-backbone-js-apps-with-ruby-sinatra-mongodb-and-haml/](http://addyosmani.com/blog/building-backbone-js-apps-with-ruby-sinatra-mongodb-and-haml/)

引用链接：

```
post '/api/:thing' do 
  # parse the post body of the content being posted, convert to a string, insert into 
  # the collection #thing and return the ObjectId as a string for reference 
  oid = DB.collection(params[:thing]).insert(JSON.parse(request.body.read.tos)) 
  "{\"id\": \"#{oid.to_s}\"}" 
end 
```

如果您不了解 Ruby，请记住该方法自动返回的最后一个表达式是什么。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-29T00:04:41.263

我从您的问题中了解到的是，您希望拥有一个包含服务器上存在的模型的集合。为了将这些模型放入集合中，您必须在集合中添加调用“fetch()”。

url 将是“/users”或类似的东西，它必须返回一个包含用户数据的对象数组。然后将数组中的每个项目传递给 UserCollection.add()。好吧，实际上它会一次全部通过，但你明白了。

在此之后，您的集合被填充。模型上的 url 用于更新和保存单个模型。集合的 url 也将用于创建模型。Backbone 的同步是 RESTful 的，就像 Ruby on Rails 一样。实际上，您可以在 Ruby on Rails 的文档中了解更多信息：

[http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)

您通常会为您的模型设置与控制器不同的 url。填充您的集合后，您有每个模型的 ID，因为它们来自服务器。

现在，当您根据用户输入添加新模型时，您将执行以下操作：

```
var HomeModel = Backbone.Model.extend({
    defaults: {
        lead: "not logged in",
    },

    url: 'test.php',

    initialize: function(){
        _.bindAll(this, 'handleSave', 'handleError');
        // Save already knows if this.isNew.
        this.save(undefined, {success: this.handleSave, error: this.handleError});
    },

    handleSave: function(model, response){
        this.model.reset(model);
    },

    handleError: function(){

    },
});

var HomeView = Backbone.View.extend({
    initialize: function() {
        _.bindAll(this, 'render');
        this.model = new HomeModel();
        this.model.bind("change", this.render);
    },

    el: 'div',

    render: function() {    
        // Do things to render...
    }
});

var homeView = new HomeView(); 
```

这个例子来自我回答的别人的问题，我只是添加了相关的东西。

一般的想法是在创建模型时保存模型，如果您在其他地方需要它，您可以将代码移动到模型的函数中并根据事件或其他任何内容调用它。

# python - 在 Python 中按所有项目的数字排序列表

> ID：10790645
> 
> 赞同：5
> 
> 时间：2012-05-28T21:34:54.907
> 
> 标签：python, sorting

# 我想按每个项目的数字对列表进行排序。

例子：

```
myCmpItem = '511'
myList = ['111','222','333','444','555','123']

(some magic)

mySortedList = ['111', '222', '333', '123', '444', '555'] 
```

# 算法应该如何工作：

*   将 myList 中当前项目的每个数字与 myCmpItem 进行比较
    *   对于列表中的第一项，它将是这样的：
    *   5和1之间的差是4
    *   1和1之间的差为0
    *   1和1之间的差为0
    *   这两个数字之间的差是 4（数字比较的总和）
*   对所有其他项目执行相同操作
*   按此计算的相似度对列表进行排序

我可以用很多 for 循环对此进行编码，但我实际上正在寻找一种更快的方法来做到这一点。有没有类似的算法？快速地？

# 进一步的限制

*   在我的示例中，所有项目的长度为 3，在实际场景中，它们的长度为 25
*   所有项目的长度相同，len(myList[x])==25 始终为真
*   项目可以是字符串、整数、浮点数或任何更适合算法的东西
*   1到5之间只有数字

# 背景

所有项目的数字都是问题的答案，我想找到与给定答案集最相似的答案集。所以“123”表示用户回答了问题 1 = 答案 1、问题 2 = 答案 2、问题 3 = 答案 3。它们是多项选择题，共有 25 个问题（= 25 个问题的长度），并且总是有 5 个不同的回答的可能性（这些是数字 1-5）。

*PS：这是我在 Stackoverflow 上问的第一个问题，所以请善待我。我已经用谷歌搜索了几个小时，但找不到任何解决方案，所以我在这里问。我希望那很好。另外英语不是我的母语。*

# 答案（感谢所有参与者！）

@larsmans 的回答（[https://stackoverflow.com/a/10790714/511484](https://stackoverflow.com/a/10790714/511484)）很好地解释了如何以合理的速度解决这个问题。您甚至可以通过提前计算每个数字之间的距离来加速算法，请参阅@gnibbler 的帖子（[https://stackoverflow.com/a/10791838/511484](https://stackoverflow.com/a/10791838/511484)）所有其他答案也很好且正确，但我发现@larsmans 有最好的解释。再次感谢大家的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T21:43:30.913

首先，制作一个整数列表，`myCmpItem`以使减法成为可能。

```
myCmpItem = map(int, myCmpItem) 
```

然后，定义一个计算项目和 之间距离的函数`myCmpItem`。我们还需要将项目映射到整数列表。其余的只是[L1 距离](https://en.wikipedia.org/wiki/Taxicab_geometry)的普通公式（您正在计算的“差异”的数学名称）。

```
def dist(item):
    item = map(int, item)
    return sum(abs(item[i] - myCmpItem[i]) for i in xrange(len(item))) 
```

然后，将此函数用作`key`排序函数。

```
sorted(myList, key=dist) 
```

~~（PS：你确定 L1 距离对这个应用有意义吗？使用它表示假设答案 1 与答案 2 比答案 3 更相似，等等。如果不是这样，[汉明距离](https://en.wikipedia.org/wiki/Hamming_distance)可能更合适。）~~

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-28T21:46:26.920

使用`lambda`和列表理解：

```
sorted(myList, key=lambda item: sum([abs(int(x) - int(y)) for x, y in zip(item, myCmpItem)]) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-28T21:41:38.960

```
def cmpWith(num):
    def compare(item):
        """ calculate the difference between num and item """
        return sum(
            abs(int(n) - int(x)) # cast to int to make the substraction possible
            for x,n in zip(item, num) # zip makes pairs from both lists 
        )

    return compare

lst = ['111','222','333','444','555','123']
print sorted(lst, key=cmpWith('511')) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-28T21:44:39.853

这个怎么样？

```
myCmpItem = '511'
myList = ['111','222','333','444','555','123']

def make_key(x):
    diff = 0
    for a, b in zip(x, myCmpItem):
        diff += abs(int(a)-int(b))
    return diff

mySortedList = sorted(myList, key=make_key)

print mySortedList 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-29T00:40:47.870

预先计算距离表可能比将每个数字转换为更快`int`

```
myCmpItem = '511'
myList = ['111','222','333','444','555','123']

# only need to compute this dict once
dists = {(i,j):abs(int(i)-int(j)) for i in '12345' for j in '12345'}

print sorted(myList, key=lambda j: sum(dists[i] for i in zip(j, myCmpItem))) 
```

在我的电脑上，这比 larsmans 回答 100000 x 25 个字符串的速度快 2.9 倍

# haskell - Shift减少快乐语法中的冲突

> ID：10790647
> 
> 赞同：2
> 
> 时间：2012-05-28T21:35:34.537
> 
> 标签：haskell, grammar, yacc, happy

你好优秀的程序员，

我在快乐（haskell）中建立了以下语法：

```
P  :  program  C             {Prog $2}

E  :  int            {Num $1}
   |  ident           {Id $1}
   |  true           {BoolConst True}
   |  false          {BoolConst False}
   |  read           {ReadInput}
   |  '(' E ')'              {Parens $2}
   |  E '+' E                { Add $1 $3 }
   |  E '-' E                { Sub $1 $3 }
   |  E '*' E                { Mult $1 $3 }
   |  E '/' E                { Div $1 $3 }
   |  E '=' E                { Eq $1 $3 }
   |  E '>' E                { Gt $1 $3 }
   |  E '<' E                { Lt $1 $3 }

C  :   '(' C ')'             {$2}
   |  ident assign E         {Assign $1 $3}
   |  if E then C else C     {Cond $2 $4 $6}  
   |  output E               {OutputComm $2}
   |  while E do C           {While $2 $4 }
   |  begin D ';' C end      {Declare $2 $4}
   |  C ';' C                {Seq $1 $3 }

D  :  D ';' D                {DSeq $1 $3 } 
   |  '(' D ')'              {$2}
   |  var ident assign E     {Var $2 $4} 
```

现在，While 循环包含了“do”之后的所有命令。如何改变这种行为？我已经尝试过 %left, %right ... :(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T10:38:05.913

考虑这个代码片段：

```
while True do output 1 ; output 2 
```

这可以被解析为

```
(while True do output 1) ; (output 2) 
```

或者

```
while True do (output 1 ; output 2) 
```

这种模糊性是冲突的根源。

如果您不想按照@DanielWagner 的建议更改语法，则可以使用[优先规则](http://www.haskell.org/happy/doc/html/sec-Precedences.html)来解决歧义。具体如何取决于优先级应该是什么，但它可能是这样的：

```
%right do
%right then else
%right ';' 
```

优先级从低到高列出，因此在这种情况下，上述示例将以后一种方式解析。只需在标记下方但`%%`在行之前添加优先规则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T21:47:30.260

发明两种`C`，一种允许排序，另一种不允许。像这样的东西，也许：

```
Cnoseq : '(' Cseq ')'
       | ident assign E
       | while E do Cnoseq

Cseq : Cnoseq ';' Cseq
     | Cnoseq 
```

# php - 将图像堆叠在一起

> ID：10790649
> 
> 赞同：0
> 
> 时间：2012-05-28T21:35:49.243
> 
> 标签：php, css, image

我有一个显示图像表的 PHP 站点。每个图像都有一个用户定义的“背景”。因此，用户可以说“我想要红色背景”，所有图像都将显示，其颜色边框为 10 像素。

此外，它是一个静态背景。

为此，我首先回显静态图像，然后是用户彩色图像，然后是表格图像。

```
echo "<img src='Static.jpg' width='60' height='60' />";
echo "<img src='User$userColor.jpg'  width='60' height='60' />";
echo "<img alt='TableImage' width='50' height='50' />"; 
```

Currentley，我将后两个图像附加到它们上：

```
style='position:relative; top:-55px; margin-bottom: -55px;' 
```

这似乎很hacky。有没有一种不错的 CSS 方式可以堆叠图像，这样当我更改大小或顺序时，我就不必扫描和编辑每个图像的样式？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:42:25.000

您的问题有点不清楚，但与其使用图像在静态图像周围创建 10px 边框，不如直接使用 CSS 为您想要边框的每个图像添加一个类？

```
.staticImage { border: 10px solid <?php print $color; ?>; } 
```

例如，您可以将他们想要的边框颜色存储在 cookie 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T21:40:30.553

CSS：

```
<img alt='TableImage' width='50' height='50' style="border: 10px solid $userColor"/> 
```

# svg - SVG 圆位置的过渡导致移动时截断

> ID：10790654
> 
> 赞同：2
> 
> 时间：2012-05-28T21:36:17.650
> 
> 标签：svg, d3.js

我有许多`<circle>`元素，每个元素都在自己的`<g>`. 为了移动圆圈，我在每个`<g>`.

我注意到，随着圆圈的移动，其中一些似乎被略微截断。他们一停下来，看起来就很好，所以就在他们运动的时候。如果您有一个与圆形相同大小的方形视口，然后将圆形稍微移出中心，截断效果看起来就像您看到的那样。它只是在一侧略微变平。

这是我的一个元素组的样子：

```
<g class="datapoint dot" transform="translate(360,56)">
    <circle class="rendering" style="fill: #3182bd; stroke: #225b84; stroke-opacity: 1; fill-opacity: 1; " r="7"></circle>
</g> 
```

当我观察调试器运行转换时，我可以看到“翻译”中的值发生了变化，但其他一切都保持不变。所以这似乎不是我做错了什么，但你永远无法确定这一点。:)

最后一条评论是，我确实在多个浏览器中看到了这一点（到目前为止尝试过 Chrome 和 Firefox）。

有没有人遇到过这种事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-09T12:49:37.240

对你来说可能有点晚了，但我在使用`transform: scale()`. SVG 形状仅限于文件的原始大小。如果形状变得比这更大，那么它将被裁剪。

我的解决方法是使 SVG 的边界大于形状本身，以便它有一些扩展空间。

# c++ - 关联/随机访问容器

> ID：10790658
> 
> 赞同：3
> 
> 时间：2012-05-28T21:36:52.057
> 
> 标签：c++, data-structures

我正在寻找一种数据结构来保存唯一元素的无序集合，它将支持以下操作

1.  在集合中的任何位置插入/删除元素
2.  查询元素是否存在
3.  访问随机元素

天真地，1 和 2 建议使用关联容器，例如`unordered_set`，但是 3 在元素数量上是线性的。使用随机访问容器，例如`vector`，使 3 变得容易，1 可以在 O(1) 中完成，但是 2 又是 O(N)。

问题是是否有一种已知的方法可以解决这种线性复杂性？

编辑：我的意思是3中的随机元素：给定N个元素的任意顺序，检索一个介于0和N-1之间`j`的元素号。`j`对于 an`std::vector`它只是下标，对于 an`std::list`或 an`std::set`它从`begin()`等开始递增列表/集迭代器 j 次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T21:55:46.117

最适合您的任务的两个标准容器是 - 就像您说的那样，`vector`O(n) 中的 1\. 和 2\. 和 O(1) 中的 3\. 以及`set`O(log n) 中的 1\. 和 2.和 3\. 在 O(n) 中。根据数据结构的大小，算法复杂性并不那么重要。A`vector`具有数据局部性的额外优势，因此可以更好地利用 CPU 缓存。

如果元素的实际顺序无关紧要，则插入`vector`可以在摊销 O(1) ( `push_back`) 中完成，如果您`swap`要删除的元素与最后一个元素一起删除，则可以在摊销 O(1) 中完成删除删除那个。

如果你真的有一个大数据结构，你可以使用[Boost.Multi-Index](http://www.boost.org/doc/libs/1_49_0/libs/multi_index/doc/index.html)来构建一个数据结构，其中 1\. 是 O(n)，2\. 是 O(log n)，3\. 是 O(1)。但是，就像我说的那样，如果您的数据结构不是很大，那么`vector`应该可以工作。

如果随机访问索引中的顺序无关紧要，则可以在摊销 O(log n) ( `push_back`) 中完成插入。对于删除，您不能使用该`swap`技巧，因为这会使其他索引无效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:08:24.983

找这样的数据结构很久了。

最近，我发现了一个很有前途的库，它具有您正在寻找的所有功能。

请参阅 O(log n) 中随机访问的 cntree::set。

链接在这里。 [http://dl.dropbox.com/u/8437476/works/countertree/index.html](http://dl.dropbox.com/u/8437476/works/countertree/index.html)

虽然它似乎正在开发中，但我认为它非常有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-23T10:02:24.483

取决于您对#3 的需求`std::unordered_set`可能非常合适。

我一直在寻找具有上述属性的容器，以便可以遍历所有类似于`for(int i = 0; i < myset.size(); ++i) process(myset[i]);`. 我发现[这个页面](http://www.cplusplus.com/reference/unordered_set/unordered_set/bucket_count/)描述了`std::unordered_set::bucket_count()`,`std::unordered_set::begin(size_t bucket_number)`和`std::unordered_set::end(size_t bucket_number)`.

如果您有 OpenMP 循环，这将变得非常方便，因此您可以编写：

```
std::unordered_set<Element> myset;

#pragma omp parallel for
for(int i = 0; i < myset.bucket_count(); ++i) {
   for(auto it = myset.begin(i); it != myset.end(i); ++it)
      processElement(*it);
} 
```

这仍然不允许您直接访问`myset[i]`，但它非常接近，因为您可以访问编号存储桶中的元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T21:52:40.550

`std::unordered_set`. 如果使用索引`j`作为键，访问元素不是 O(N)，而是 O(1)。

如果您有一个要用于查找的唯一索引并且您不关心其他排序，那么您还打算使用什么作为关联容器的键？

# jquery-ui - jquery mobile fullcalendar 上一个 下一个 图标

> ID：10790660
> 
> 赞同：-3
> 
> 时间：2012-05-28T21:37:10.123
> 
> 标签：jquery-ui, fullcalendar, imagebutton

在 jquery mobile 上使用 jquery fullcalendar 插件 ( [http://arshaw.com/fullcalendar/](http://arshaw.com/fullcalendar/) ) 时，prev 和 next month 按钮图标仅显示向上箭头的背景图像，这是 long 256 x 240 上的第一个图标.png 图像文件。当我在 Firefox 中刷新页面时，会显示正确的东西箭头，但我会丢失所有其他样式，包括背景、主题等。刷新在 IE 中不起作用。

我从高处和低处寻找这个相对较小问题的答案。这里我认为可能是原因：

1\. jquery ui 和 jquery mobile 冲突（.js 和 .css 文件的顺序）--我尝试了所有命令都无济于事。
2\. 在移动页面上调用全日历主题（在页面内部而不是头部标签）
3\. 从主页到特定移动页面的转换问题
4\. ui-icon css 类的像素大小（对于移动设备，它应该大于 16px x 16px 吗？）
5\. 需要使用 $(document).ready() 函数自定义覆盖 jquery ui。

请在下面查看我包含的文件头代码：

```
<link rel='stylesheet' type='text/css' href='../fullcalendar/fullcalendar/fullcalendar.css'>
<link rel='stylesheet' type='text/css' href='../fullcalendar/demos/cupertino/thememobile.css'>
<link rel='stylesheet' type='text/css' href='../fullcalendar/fullcalendar/fullcalendar.print.css' media='print'>

<link rel="stylesheet" href="jquery.mobile-1.0.1.min.css" />
<script src="jquery-1.6.4.min.js"></script>
<script src="jquery.mobile-1.0.1.min.js"></script>

<script type='text/javascript' src='../fullcalendar/jquery/jquery-ui-1.8.17.custom.min.js'></script>
<script type='text/javascript' src='../fullcalendar/jquery/jquery-1.7.1.min.js'></script>
<script type='text/javascript' src='../fullcalendar/fullcalendar/fullcalendar.min.js'></script>
<script type='text/javascript' src='../fullcalendar/fullcalendar/jquery.qtip-1.0.0-rc3.min.js'></script>
<script type='text/javascript' src='../fullcalendar/fullcalendar/calendareventsmobile.js'></script> 
```

任何答案或对答案的头脑风暴都会非常有帮助。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:35:01.487

您是否尝试过使用 FullCalendar 并将`theme`选项设置为`true`？这迫使它使用 jQuery UI 主题而不是 fullCalendar 主题。也许CSS冲突可能会消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-13T13:47:28.967

从文档...

必须提供将按钮名称（从标题）映射到图标字符串的散列。图标字符串确定将在按钮上使用的 CSS 类。例如，字符串 'circle-triangle-w' 将产生类 'ui-icon-triangle-w'。

我正在寻找使用 ui-icon-carat-1-w 和 ui-icon-carat-1-e。我发现 firebug 在确定正确的哈希值以获取正确的映射时非常有帮助。

这是我需要使用的示例。

```
 buttonIcons: {
        prev: 'carat-1-w',
        next: 'carat-1-e'
    }, 
```

# php - 使用PHP在另一个字符串中查找数组中的任何字符串的匹配项

> ID：10790665
> 
> 赞同：0
> 
> 时间：2012-05-28T21:37:45.670
> 
> 标签：php, arrays, strpos

我正在将一组字符串与一个字符串进行匹配，如果数组中的一个字符串出现在字符串中，那么应该会出现一些文本。

在实践中：我只想在特定页面上包含一个菜单。因此，我在我的模板中包含了一个 PHP 片段，并且当定义的页面名称之一出现在 URL 中时，菜单应该会显示出来。目前我使用这个有效的代码：

```
$domain = $_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'].$_SERVER['QUERY_STRING'];

if (strpos($domain, '/page1.php') !== false) {
        echo 'Text',
}
elseif (strpos($domain, '/page2.php') !== false) {
        echo 'Text',
}
elseif (strpos($domain, '/page3.php') !== false) {
        echo 'Text',
}
elseif (strpos($domain, '/page4.php') !== false) {
        echo 'Text',
}; 
```

是否可以压缩代码以使其更高效，而不是为每一页重复一个 elseif 行。我尝试了以下但没有奏效：

```
$domain = $_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'].$_SERVER['QUERY_STRING'];
$string = array('page1.php', 'page2.php', 'page3.php', 'page4.php');

if (strpos($domain, $string) !== false) {
        echo 'Text',
}; 
```

有什么建议么？

菲利普

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:50:52.873

```
$domain = $_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'].$_SERVER['QUERY_STRING'];
$string = array('page1.php', 'page2.php', 'page3.php', 'page4.php');
foreach($string as $str){
   if (strpos($domain, $str) !== false) {
    echo 'Text',
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T21:46:41.257

如果每个页面都必须生成不同的结果，那么您应该使用`switch()`，如果所有结果都相同，则只需创建一个`array('page1.php', 'page2.php', 'page3.php', 'page4.php');`并使用`in_array()`...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T21:55:23.107

试试这个，

```
$domain = $_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'].$_SERVER['QUERY_STRING'];
$string = array('page1.php', 'page2.php', 'page3.php', 'page4.php');

foreach ($string as $key => $value) {
  if (strpos($domain, $value) !== false) {
    echo 'Text',
  }
} 
```

# codeigniter - 编写基于 PHP 的工具 - 我应该使用框架吗？

> ID：10790666
> 
> 赞同：1
> 
> 时间：2012-05-28T21:37:45.787
> 
> 标签：codeigniter, php

我正在制作一个非常具体的“控制面板”来组织信息、记录统计数据、发送警报等等。

我最初的计划是使用 CakePHP。我试过 Cake，虽然我觉得它真的很棒，但我真的很讨厌它，因为它是“自动的”。我不喜欢它是如何在我不知情的情况下完成所有这些事情的。昨天我切换到 CodeIgniter，因为一个朋友让我尝试一下。我更喜欢 CI，但是使用 PHP 框架感觉不对。对我来说，它感觉不够自由或不够灵活。

**我的问题是：** 我应该继续尝试使用框架，还是应该构建一个“半框架”，使某些事情变得更容易（布局、表单验证、本地化）？

我是否可以补充一点，我已经创建了一个安全的身份验证系统（嗯，我认为它是安全的，但这是一个不同的讨论：P），在这个站点上实现起来相当简单。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T21:43:49.073

> 我应该继续尝试使用框架，还是应该构建一个“半框架”，使某些事情变得更容易（布局、表单验证、本地化）？

我认为这里的大问题是**使用框架是否会让你的生活更轻松。**框架旨在通过为您提供在自己的代码中工作的强大基础来简化编码。如果该基础通过减少您需要编写的代码量和其中的维护量来帮助您，那么是的，我强烈建议您使用框架。如果该框架因为不太适合您的需求而使您的工作变得更加困难，并且没有减少您总体上需要完成的工作量，那么我强烈建议您不要在一个框架上浪费您的时间。

就像您停止使用不能帮助您更快或更好地洗碗的洗碗机一样，继续并停止使用不能帮助您更快或更好地*编码的框架。*

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-28T21:38:56.367

这取决于您的网站。如果你的网站有几十个页面，最好使用框架。但是，如果您的网站很小，则无需使用它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-28T21:48:53.917

尝试将 Zend 与 NuSphere PHPEd IDE 结合使用。Zend 是一个通用的通用框架，它可以让你随心所欲地进行硬核，它有大量的示例和文档。PHPEd 将使您能够进行非常好的调试，甚至在框架代码中，这样您就会感到完全控制。

另一方面，重新发明轮子从来都不是一个好主意。您将永远无法自己正确完成所有表单验证，并且所有这些代码的测试量将使您在墓地轮班期间在星期二呆在办公室:)

花一些时间阅读一些开源项目（如[Magento](http://www.magentocommerce.com/) ）可能是一个好主意，这样您就可以在尝试编写自己的框架之前观察通用框架的真正力量。

# android - 使用官方 facebook-android-sdk 获取用户个人资料 facebook

> ID：10790671
> 
> 赞同：2
> 
> 时间：2012-05-28T21:38:17.817
> 
> 标签：android, facebook-android-sdk

我正在使用 facebook-android-sdk 进行单点登录，但我无法获取用户 facebook 个人资料数据。这是我的代码：

```
try {
            JSONObject me = new JSONObject(facebook.request("me"));
            String id = me.getString("id");
            String name = me.getString("name");
            System.out.println("Id: " + id + "  ---- " + name);
        }catch(Exception ex) {
            System.out.println(ex);
        } 
```

如何获取用户数据配置文件？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T21:49:01.507

前提是您登录。

```
AsyncFacebookRunner myAsyncRunner = new AsyncFacebookRunner(facebook);
myAsyncRunner.request("me", new meRequestListener()); 
```

请求监听器：

```
public class meRequestListener implements RequestListener() {

    @Override
    public void onComplete(String response, Object state) {
        //response is your JSON response
    }

    //You also have to override all the other methods
} 
```

# ruby - Ruby + Testunit + ci_reporter：没有 xml 输出

> ID：10790673
> 
> 赞同：2
> 
> 时间：2012-05-28T21:38:47.680
> 
> 标签：ruby, testunit

我有以下 Rakefile：

```
require 'rake'

gem 'ci_reporter'
require 'ci/reporter/rake/test_unit'

task :test do
  ruby 'signup.rb'
end 
```

以及以下文件：

```
require 'rubygems'
require 'test/unit'

class SignupTest < Test::Unit::TestCase
    def test_signup
        assert true
    end
end 
```

当我运行“rake ci:setup:testunit test”时，我得到：

```
rm -rf test/reports
/Users/fernando/.rvm/rubies/ruby-1.9.3-p0/bin/ruby signup.rb
Run options: 

# Running tests:

.

Finished tests in 0.000820s, 1219.5122 tests/s, 1219.5122 assertions/s.

1 tests, 1 assertions, 0 failures, 0 errors, 0 skips 
```

似乎它应该在 test/reports 中生成了某种内容，但这个目录不存在。

关于我应该做什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:15:03.667

尝试将要求行更改为：

```
gem 'ci_reporter'
require 'ci/reporter/rake/test_unit_loader' 
```

（我在 MiniTest 中遇到了类似的问题，文档说需要 minitest，但我发现有一个 minitest_loader 并且要求它有效！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T09:59:08.007

我遇到了同样的问题。

尝试这个 ：

*   将以下要求添加到您的 test.rb ：`require 'test/unit'`

    `require 'ci/reporter/rake/test_unit_loader'` `gem 'test-unit'`

*   将以下要求添加到您的 rakefile.rb ：`require 'ci/reporter/rake/test_unit' #http://juretta.com/log/2008/11/11/hudson_test_drive_part_1_rails/`

*   使用 cmd 执行：`rake CI_REPORTS=reports test`

希望这会对你有所帮助，它对我有用。

# eclipse - Eclipse：选择不包含任何可以在服务器上运行的资源

> ID：10790679
> 
> 赞同：11
> 
> 时间：2012-05-28T21:39:13.647
> 
> 标签：eclipse, tomcat6, m2eclipse, web-deployment

我无法在 eclipse ide 中将 maven java web 应用程序项目运行到配置的 tomcat。

最初我可以右键单击该项目并在 tomcat 服务器上运行它，但自从我将项目共享到存储库后，我就无法做到这一点。

我断开了项目与存储库的连接，现在我什至看不到 Eclipse IDE 中的 Run as -> Run on Server 选项。

我正在使用 m2e 插件版本 .0.12.1 和 eclipse helios 和 tomcat 6。

有人可以帮助我了解我在这里缺少什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2017-01-18T10:35:11.993

> 问题

当您尝试使用“在服务器上运行”(SA+X+R) 选项在服务器上运行项目时，eclipse 返回以下消息： 选择不包含任何可以在服务器上运行的资源。

> 解决方案

在导航面板上，单击项目以获取弹出菜单、属性、项目方面，检查：-动态 Web 模块-Java 它对我有用，试试这可能是你的问题

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-11T08:15:33.007

也许你应该在你的 web 项目的 .settings 文件夹中更新两个文件：.settings/.jsdtscope

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
<classpathentry kind="src" path="src/main/WebContent"/>
<classpathentry kind="con" path="org.eclipse.wst.jsdt.launching.JRE_CONTAINER"/>
<classpathentry kind="con" path="org.eclipse.wst.jsdt.launching.WebProject">
    <attributes>
        <attribute name="hide" value="true"/>
    </attributes>
</classpathentry>
<classpathentry kind="con" path="org.eclipse.wst.jsdt.launching.baseBrowserLibrary"/>
<classpathentry kind="output" path=""/> 
```

.settings/org.eclipse.wst.common.component

```
<?xml version="1.0" encoding="UTF-8"?><project-modules id="moduleCoreId" project-version="1.5.0">
<wb-module deploy-name="Web">
    <wb-resource deploy-path="/" source-path="/target/m2e-wtp/web-resources"/>
    <wb-resource deploy-path="/WEB-INF/classes" source-path="/src/main/java"/>
    <wb-resource deploy-path="/" source-path="/src/main/WebContent" tag="defaultRootSource"/>
    <wb-resource deploy-path="/WEB-INF/classes" source-path="/src/main/resources"/>
    <wb-resource deploy-path="/WEB-INF/classes" source-path="/src/test"/>
    <property name="java-output-path" value="/Web/build/classes"/>
    <property name="context-root" value="shequwang-web"/>
</wb-module> 
```

**在两个文件中将path="src/main/WebContent"**值更改为您的值，然后重新启动 IDE。完成此操作后，它再次运行良好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T14:23:00.750

我不知道你是否解决了你的问题，但我遇到了完全相同的问题，永远无法解决。然后我保存了我所有的项目，删除了其他所有内容，从 0 开始 Eclipse，就好像它刚刚下载一样，重新安装插件并开始复制我旧项目的东西的新项目。是的，我花了大约一个小时，这不是一个专家解决方案，但有时重新开始会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-29T19:15:35.673

将您的项目复制到其他位置。转到eclipse并右键单击Project并展开runAs。点击maven安装。如果问题仍然存在，请删除该项目并再次导入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-16T16:43:30.393

你把它放在错误的文件夹中记住 src 中的 java 代码和 webapp 中的 UI 文件

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-17T13:51:25.923

我最近在 STS 中遇到了这个问题，
按照以下步骤操作后错误消失了。

1.  检查 IDE 中配置的默认 JRE 版本并检查项目中显示的 JRE 系统库版本

2.  如果版本不同，请先使它们相同。

3.  现在右键单击 Project 并选择 properties 。

4.  在 Project facets 上选择并选择 Dynamic Web Module

5.  刷新项目。

# silverlight - 如何从 RIA 服务中的实体获取服务上下文

> ID：10790681
> 
> 赞同：0
> 
> 时间：2012-05-28T21:39:22.790
> 
> 标签：silverlight, ria

我正在为 Silverlight 使用 RIA 服务，我想知道是否有办法仅从实体（在*客户端*，即使用 RIA-Service 域上下文和实体！）获取实体附加到的服务上下文。这将有助于在它们中实现需要一些上下文（服务上下文本身就是一个例子）的功能，而不依赖于全局（静态）存储。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T07:12:45.413

您可以根据需要创建许多自定义 DomainContext 实例。您可以将其转换为基类 (DomainContext) 并将其存储在全局存储中以供第二次使用。在第二次使用过程中，您应该再次将其转换为自定义 DaomainContext 类。例如：`((CustomDomainContext)instance).Customers.SubmitChanges();`

# java - 在 Applet 中生成随机三角形（动画）

> ID：10790682
> 
> 赞同：0
> 
> 时间：2012-05-28T21:39:26.423
> 
> 标签：java, applet

我试图解决这个问题，但我有一个无限循环，不知道如何解决这个问题。引导我。我是 Java 新手。

在终端：

```
Exception in thread "AWT-EventQueue-1" java.lang.NullPointerException
        at ThreadApplet.RandGen(ThreadApplet.java:10)
        at ThreadApplet.paint(ThreadApplet.java:30)
        at java.awt.Container.update(Container.java:1988)
        at sun.awt.RepaintArea.updateComponent(RepaintArea.java:255) 
```

感谢帮助！

问题：编写一个小程序，以不同颜色显示随机生成的三角形。

```
 /////////////Applet

import java.awt.*;

import java.applet.*;

public class ThreadApplet extends Applet{
    MyThread thread;
    int x[],y[];
    public boolean ctrl=true;

    public void RandGen(){
        for (int i=0; i<3;i++){
            x[i]=(int)Math.random()*100;
            y[i]=(int)Math.random()*100;
        }       
    }

    public void start(){
        if (thread==null){
            thread = new MyThread(this);
            thread.start();
        }
    }

    public void stop(){
        thread = null;
    }

    public void paint(Graphics g){
        if (ctrl==true){
            g.setColor(Color.blue);
        } else {
            g.setColor(Color.red);
        }
        RandGen();
        g.fillPolygon(x,y,3);   
    }
}

public class MyThread extends Thread{
    ThreadApplet applet;

    public MyThread (ThreadApplet applet){
        this.applet=applet;
    }
    public void run(){
        Thread thisThread = Thread.currentThread();
        while (this==thisThread){           
            applet.repaint();
            try{Thread.sleep(50);}
            catch(InterruptedException e){} 
        }       
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T21:42:01.100

您需要在使用前初始化数组：

```
 int x[] = new int[17]; 
```

例如。

# apache - ModRewrite 不会重写

> ID：10790683
> 
> 赞同：0
> 
> 时间：2012-05-28T21:39:31.253
> 
> 标签：apache, .htaccess, mod-rewrite, redirect

我有一个包含以下内容的 .htaccess 文件：

```
RewriteEngine On
RewriteBase /
RewriteRule ^heh$ ok 
```

但是当我去的时候`http://XXXXX/heh`，它仍然亮着`http://XXXXX/heh`，但没有亮着`http://XXXXX/ok`。我有什么问题？

PS 这有帮助：[为什么 .htaccess 没有任何效果？](https://stackoverflow.com/questions/4111682/why-doesnt-htaccess-have-any-effect). 我讨厌阿帕奇。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:57:10.813

它应该做的工作...

```
RewriteEngine on
RewriteRule ^ok$ heh [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T23:52:38.110

请结帐：
`RedirectMatch 301 /heh/(.*) /ok/$1`

# php - ON DUPLICATE KEY UPDATE 与 where 或 if

> ID：10790686
> 
> 赞同：0
> 
> 时间：2012-05-28T21:40:16.990
> 
> 标签：php, mysql

我目前有 3 个独立测验的测验结果存储在 3 个完全相同的单独表中，所以我在这个结构中有 quiz_results_1、quiz_results_2 和 quiz_results_3：

用户名 | 任务1 | 任务2 | 任务3 | 任务4 | 任务5 | 任务6 | 任务7 | 任务8 | 任务9 | 任务10 | 完全的

我想将这些表合并到 1 个表中，并包含一个 quiz_id 来确定哪些结果适用于哪些测验：

测验ID | 用户名 | 任务1 | 任务2 | 任务3 | 任务4 | 任务5 | 任务6 | 任务7 | 任务8 | 任务9 | 任务10 | 完全的

我可以使用这个查询来更新相关的表，用户名作为主键：

```
mysql_query("INSERT INTO quiz_results_1 (quest1,quest2,quest3,quest4,quest5,quest6,quest7,quest8,quest9,quest10,username‌​,complete) VALUES $queryData ON DUPLICATE KEY UPDATE quest1=VALUES(quest1),quest2=VALUES(quest2),quest3=VALUES(quest3),quest4=VALUES(‌​quest4),quest5=VALUES(quest5),quest6=VALUES(quest6),quest7=VALUES(quest7),quest8=‌​VALUES(quest8),quest9=VALUES(quest9),quest10=VALUES(quest10),complete=VALUES(comp‌​lete)"); 
```

我只想使用一个表，如果该行不存在则插入，或者如果用户名和 quiz_id 存在则更新。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:52:44.403

为 3 个测验设置 3 个表格并不是一个很好的设计。

因此，您选择只使用一张表似乎是合适的，但您应该将主键更改为`(quiz_id, username)`- 这也将解决`UPDATE`语句问题。

或者，如果您想为每个用户存储不同的测验版本/历史记录，请将主键更改为：`(quiz_id, username, complete)`

# c# - 从服务器而不是本地驱动器路径加载 MVC ASP.NET 中的 XML 文件

> ID：10790687
> 
> 赞同：1
> 
> 时间：2012-05-28T21:40:19.130
> 
> 标签：c#, asp.net, .net, relative-path

我觉得我可能在 IIS 或全局文件中缺少一些配置？

我想加载一个 xml 文件：

```
var icon = XDocument.Load("/images/body/logos/LogoImageMappings.xml"); 
```

运行时失败，因为它试图找到文件 @ C:\images\body\logos\LogoImageMappings.xml

如何正确地将其定向到本地主机（或发布时的 Web 服务器）应用程序驱动器而不是本地 c:？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T21:48:19.880

您必须将路径映射到文件所在的目录。用这个：

```
string path = Server.MapPath("~/images/body/logos/LogoImageMappings.xml");
var icon = XDocument.Load(path); 
```

该`Server.MapPath`函数会将相对路径映射到服务器上文件的完整路径，将波浪号替换为正确的目录（注意相对路径必须指向您网站目录的子目录，出于安全原因，通常您可以'不要访问任何比这更高的东西）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-28T21:48:39.207

您有虚拟路径，要获取物理路径，请使用 MapPath ：

```
var icon = XDocument.Load(HttpContext.Current.Server.MapPath("~/images/body/logos/LogoImageMappings.xml")); 
```

# java - System.out.println() 如何在线程中工作？

> ID：10790690
> 
> 赞同：0
> 
> 时间：2012-05-28T21:40:37.183
> 
> 标签：java

我有一个关于 System 类如何工作的问题。

假设有一个服务器为连接到它的每个客户端创建一个线程，并且一个线程在某个时候调用 System.out.println(message)。哪台计算机会打印出该消息？它是服务器的计算机还是客户端计算机？哪一方创建线程有关系吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:42:38.913

> 哪台计算机会打印出该消息？它是服务器的计算机还是客户端计算机？

它将在服务器上。

> 哪一方创建线程有关系吗？

客户端不可能在服务器上创建线程（反之亦然）。*服务器*可以创建新线程来响应来自客户端的连接，但这完全不同。

简单地说：如果代码在服务器上运行，则在服务器上输出，除非有人通过存储在本地线程存储中的套接字`System.out`覆盖正常行为[`setOut`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#setOut%28java.io.PrintStream%29)并实现输出。`PrintStream`他们不会，这将是一件很疯狂的事情。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:44:00.743

服务器上的线程与与之对话的某些客户端上的线程之间没有关系。服务器上的 System.out 与碰巧与之交谈的任何客户端上的任何内容之间都没有关系。向 System.out 发送内容的效果（除非您将其重定向）与程序是客户端、服务器还是衣架完全无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T21:42:16.963

每个`Thread`都在服务器的机器上创建并在服务器的机器上运行。呼叫将`System.out`打印在服务器的机器上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T21:42:33.690

服务器将打印出来；System.out.println 不受调用它的服务器-客户端的外部条件的影响。

# backbone.js - 用于拉斐尔画布的动态创建元素

> ID：10790693
> 
> 赞同：1
> 
> 时间：2012-05-28T21:40:56.683
> 
> 标签：backbone.js, raphael, requirejs, graphael

我创建了一个 Backbone.js/Require.js 应用程序，它动态加载 HTML 模板以用作应用程序中的“页面”。这意味着我的主 HTML 页面看起来像这样。

```
<head>
  // Necessary CSS and Javascripts here
</head>
<body>
  <div id="container"></div>
</body> 
```

然后我使用下划线模板将新元素动态呈现给 DOM。但是，一个新功能需要使用 Raphael.js 图表。我创建了一个新元素`<div id='canvas'></div>`并调用`Raphael('canvas')`，但由于 DOM 上没有 canvas 元素，Raphael 看不到新创建的元素。

我曾尝试使用 jQuery 选择器代替 id 引用，`Raphael($('#canvas'))`但这会将画布附加到 body 元素而不是我的容器元素。

关于如何将 Raphael 画布绑定到动态创建的元素的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T18:26:20.177

```
Raphael($('#canvas').first(), '100%', '100%') 
```

虽然我在其他地方有错误，但导致 Raphael 不触发的主要问题是忘记了 jQuery 选择器传递了一个元素数组，而 Raphael 的构造函数想要一个元素。Raphael 将自己附加到主体上，因为它是选择器结果的顶级父级。

Mosselman 也正确地指出，您可以在 Backbone 中完全在内存中构建视图，然后将其附加到 DOM。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T23:58:54.653

解决此问题的一种方法是在视图中创建一个空元素并将所有内容绑定到该元素上。我从未与 Raphael 合作过，但我认为这可行：

```
var someView = Backbone.View.extend({
    el: document.createElement('div'), // This creates a DOM element '<div></div>'

    initialize: function(){
        Raphael(this.el); // Attach Raphael, you could also go with jQuery
    },

    render: function(){
        jQuery('#container').append(this.el); // Add to DOM somehow
    }
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-19T14:46:07.547

我知道这是一个太老的问题，但无论如何它可以帮助某人。确保您的视图放置在页面上很重要，因此请使用 onShow 功能或渲染之类的东西。但无论如何，Raphael 不会正确显示，因为如果您向 Raphael 发送 this.$el 或类似的东西，它不会像您期望的那样接受它。你需要做的是这样的事情。$el.first() 或 this.$el[0]。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T23:08:15.403

似乎一个好方法是在模板添加到 DOM 后引发事件并让您对 Raphael('canvas') 的调用监听该事件或使用回调来触发 Raphael('canvas')。在这两种情况下，您都确保在目标元素就位之前不要调用 Raphael('canvas')。

非常粗略，像这样：

```
//from your raphael module / code
$(document).on('canvasAdded', function(){
    var paper = Raphael('canvas');
    //stuff!
});

//after you are sure your template has rendered
$(document).trigger('canvasAdded'); 
```

您可能想要创建某种 .init() 方法并从事件处理程序中调用它（与我上面显示的相比），但希望这会为您指明正确的方向。

# html - 环绕文本圆形图像问题

> ID：10790694
> 
> 赞同：1
> 
> 时间：2012-05-28T21:41:13.093
> 
> 标签：html, css, image

我需要您在评论框中显示图像的帮助。当评论的字符超过一定数量而不是向左环绕图像时，它实际上给出了下图中的外观。我怎样才能解决这个问题？

```
#comment img.floatright {
    float:right; 
    padding: 1px;
    clear:left;
} 
```

**图片**

![](../Images/9e3be38bd84855d6e030eb0bbff2a3a8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:01:29.677

我会亲自将文本设置在 a 中`<div>`并定义一个宽度，但如果您不想这样做，您可以创建一个 PHP 函数来`<wbr>`在有长单词时插入标签。该标签只会在需要时分解单词，因此您可以在一个单词中实现多个标签。

例子：

[http://jsfiddle.net/6rBUZ/](http://jsfiddle.net/6rBUZ/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:13:54.153

另一种选择是将以下样式添加到要包装的内容中：

```
word-wrap: break-word;
overflow: hidden; 
```

word-wrap 设置将允许单词被换行，尽管它的长度。在无法识别自动换行的浏览器中，溢出设置将导致它在可用空间结束时被切断。

示例：http: [//jsfiddle.net/Redsz/pBSDd/1/](http://jsfiddle.net/Redsz/pBSDd/1/)

# javascript - 为什么这个 JavaScript 函数总是返回“未定义”——以及如何解决这个问题？

> ID：10790695
> 
> 赞同：0
> 
> 时间：2012-05-28T21:41:18.010
> 
> 标签：javascript, iphone, ios, cordova, phonegap-plugins

我正在使用带有应用程序首选项插件的 phonegap 并尝试创建一个辅助函数来从中获取值。但是该函数没有返回正确的值。我知道这与异步事物有关，但不幸的是我不知道如何解决它。（我尝试在这里搜索帮助，发现很少，并尝试在辅助方法中实现它）

我想要实现的是：

```
function populateList() {
    var a = 1;

    var number = getSettingFromApplicationPreferences('number');
    // number is always undefined

    var letter = getSettingFromApplicationPreferences('letter');
    // letter is always undefined

    number = (number) ? number : 1;
    letter = (letter) ? letter : 'b';

    // Here I'll do some DOM manipulation and use 'number' and 'letter' on it, and 
    // define new variables based on 'number' and 'letter'

} 
```

这是我需要帮助的辅助函数：

```
function getSettingFromApplicationPreferences(setting) {

    var x = (function () {
        window.plugins.applicationPreferences.get(
            // setting
            setting, 
            // success callback
            function(returnValue) {
                console.log(setting + ': ' + returnValue);
                return returnValue;
            },
            // error callback
            function(error) {
                alert("Failed to get a setting: " + error);
                return false;
            }
        );
    })();

    return x;   
} 
```

**问题**
如何使用该辅助函数从应用程序首选项中返回“returnValue”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T21:44:27.203

问题是，您的回调实际上并没有为 x 设置值。所以，你将有一些其他的方式来做你正在做的任何事情，因为返回值不起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T21:44:58.873

您错误地使用了异步函数，您不能像现在这样分配，因为该函数尚未返回，因此您得到一个未定义的。您需要改用回调函数。

这意味着在成功函数中，您可以使用“returnValue”做任何您需要做的事情。

# javascript - 打破父级，iframe中的顶级变量以防止框架破坏，但仍然访问父级的功能

> ID：10790697
> 
> 赞同：1
> 
> 时间：2012-05-28T21:41:47.260
> 
> 标签：javascript

我正在通过服务器上的代理将网站内容加载到 iframe 中。如果我在文件顶部添加这个 javascript，

```
var top = "";
var parent = ""; 
```

我可以成功地防止网站框架破坏。我怎样才能做到这一点并仍然访问父窗口中的功能，如下所示：

```
parent.my_function('this is called from inside the iframe'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:49:29.877

我完全不确定覆盖这些变量是否一定会阻止帧破坏，但如果它对你有用，大概访问`parent`你可以做这样的事情：

```
(function() {
    var oldParent = window.parent;

    window.parent = "";
    // ...
})(); 
```

...并`oldParent`在函数内访问。

* * *

另外，请注意

```
var window.top = ""; 
```

和

```
var window.parent = ""; 
```

...都是语法错误。您`var`用来声明*变量*，而不是命名对象的属性。

如果您在全局范围内，如果还没有，`var top`则会创建一个属性`window`，但如果已经有（并且有），则它是无操作的，并且该`var`部分被完全忽略（分配部分仍在处理中）。没有语法错误，你的四行归结为：

```
top = "";
parent = ""; 
```

或者

```
window.top = "";
window.parent = ""; 
```

`top`...如果并且`parent`存在于`window`（并且它们确实存在）上，它们是等价的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:55:48.497

我认为最简单的事情是将`top`和`parent`值存储到您只知道的变量中。

例如：

```
window.__myTopWindow = window.top;
window.__myParentWindow = window.parent;
window.top = window.parent = null; 
```

当然，我们可以遍历 window 对象来发现 Window 对象是什么属性。在这种情况下，您可能需要重新分配您的范围，或使用 Crowder 的解决方案。

# android - Android：带有网络应用程序的猴子

> ID：10790698
> 
> 赞同：0
> 
> 时间：2012-05-28T21:41:54.220
> 
> 标签：android

我想在 android 上测试网络应用程序，我想使用 Monkey 工具。是否可以对 Monkey 说仅向 Browser 发送触摸事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:59:18.807

它当然适用于设备。我只是给了谷歌一些相当随机的输入。:-)

```
adb shell monkey -p com.google.android.browser -v 500 
```

关键是`com.google.android.browser`部分。如果设备上存在股票浏览器，那*应该会为您提供。*如果您不确定要测试的浏览器的包名称是什么，可以通过[AppXplore](https://play.google.com/store/apps/details?id=com.sonyericsson.androidapp.AppExplore&hl=en)找到。

话虽如此，我不确定 Monkey 在这里的效果如何，因为它还会调用菜单等。而且，当我在模拟器上尝试时，Monkey 找不到浏览器，这让我感到很奇怪。

无论如何，当然欢迎您进一步尝试。

# c# - 不能用不同颜色的WPF c#向datagrid添加多于一行

> ID：10790700
> 
> 赞同：0
> 
> 时间：2012-05-28T21:42:04.077
> 
> 标签：c#, wpf, datagrid, nullreferenceexception

我有一个绑定到 JobItems 的 ObservableCollection 的 DataGrid。JobItems 具有 DueDate 属性，并且根据 currentDate 与 DueDate 的接近程度，行颜色会相应更改。当用户通过 UI 将项目添加到 ObservableCollection 时，这非常有效，但是当我在后面的代码中创建多个虚拟 JobItem 以在程序开始时填充此数据网格时，它不起作用。然而，我添加的第一个假人完全没有问题。这很重要，因为当我的数据库就位时，我最终会需要它。

这就是我的代码在后面的样子：

```
ObservableCollection <JobItem> JobItemList = new ObservableCollection<JobItem>();
public AdminView(Employee currEmployee)
    {
        this.Title = "Administrator View - " + currEmployee.Name;
        InitializeComponent();
        jobItemDataGrid.DataContext = JobItemList;

        LoadDummies();

    }

    private void LoadDummies()
    {
        JobItem j1 = new JobItem();
        JobItem j2 = new JobItem();
        JobItem j3 = new JobItem();

        j1.WorkOrderNo = "W12-021";
        j2.WorkOrderNo = "W12-037";
        j3.WorkOrderNo = "W12-234";

        j1.DateReceived = DateTime.Now.ToString();
        j2.DateReceived = DateTime.Now.ToString();
        j3.DateReceived = DateTime.Now.ToString();

        j1.DueDate = (DateTime.Now.AddDays(2)).ToString();
        j2.DueDate = (DateTime.Now.AddDays(2)).ToString();
        j3.DueDate = (DateTime.Now.AddDays(9)).ToString();

        j1.RushPriority = true;

        j1.Status = "Completed";
        j2.Status = "Accepted";  
        j3.Status = "Completed";

        JobItemList.Add(j1);
        JobItemList.Add(j2);
        JobItemList.Add(j3);
    }

    private void newJobBtn_Click(object sender, RoutedEventArgs e)
    {
        NewJobDialog newJobWindow = new NewJobDialog(workOrderCounter);

        newJobWindow.ShowDialog();

        if (newJobWindow.DialogResult == true)
        {
            if (newJobWindow.HasContent && newJobWindow.DialogResult.Value)
            {
                JobItemList.Add(newJobWindow.newJob);
                workOrderCounter++;

            }

        }

    }

    /*Formats each row in the data grid depending on how close the due date of each
     * job is.  Each color corresponds to how close the due date is from today.
     * Blue: Job is due in more than 7 days
     * Green: Job is due between 4-7 days
     * Yellow: Job is due in 0-3 days
     * Red:
     * */
    private void jobItemDataGrid_LoadingRow(object sender, DataGridRowEventArgs e)
    {
        DateTime currentDate = DateTime.Now;
        DateTime dateValue = new DateTime();
        TimeSpan elapsed;
        Double daysLeft;
        Double enoughTime = 7;
        Double dueSoon = 3;
        Double dueToday = 0;

        foreach (JobItem item in jobItemDataGrid.ItemsSource)
        {

            var row = jobItemDataGrid.ItemContainerGenerator.ContainerFromItem(item) as DataGridRow;
            //subtracting the two dates to get an elapsed amount of days
            if ((DateTime.TryParse(item.DueDate.ToString(),out dateValue) == true))
            {

                //dateValue = DateTime.Parse(item.DueDate.ToString());
                elapsed = dateValue.Subtract(currentDate);
                daysLeft = elapsed.TotalDays;
                //MessageBox.Show("due date: " + dateValue.ToString() + " current date: " + currentDate.ToString() + " days left: " + daysLeft.ToString() + "rounded: "  + daysLeftRound.ToString());

                if (item.RushPriority == true)
                {
                    row.Background = new SolidColorBrush(Colors.Black);
                    row.Foreground = new SolidColorBrush(Colors.White);
                }
                else if (daysLeft > enoughTime)
                {
                    row.Background = new SolidColorBrush(Colors.Blue);
                    row.Foreground = new SolidColorBrush(Colors.White);
                }
                else if (daysLeft <= enoughTime && daysLeft > dueSoon)
                {
                    row.Background = new SolidColorBrush(Colors.Green);
                    row.Foreground = new SolidColorBrush(Colors.White);
                }
                else if (daysLeft <= dueSoon && daysLeft >= dueToday)
                {
                    row.Background = new SolidColorBrush(Colors.Yellow);
                }
                else if (daysLeft < dueToday)
                {
                    row.Background = new SolidColorBrush(Colors.Red);
                    row.Foreground = new SolidColorBrush(Colors.White);
                }

            }

        } 
    } 
```

当我从 LoadDummies() 添加多个虚拟项目时，我收到错误：“NullReferenceException 未处理。对象引用未设置为对象实例。”

感谢所有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:14:27.657

我想你忘了创建你的 JobItemList。尝试将其放入您的构造函数中：

```
JobItemList = new List<JobItem>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T14:09:47.113

在下面的 if 语句中，在行中添加一个空检查

```
if ((DateTime.TryParse(item.DueDate.ToString(), out dateValue) == true) && row != null) 
```

# netty - 用于每个请求的可变行协议的 Netty 帧解码器？

> ID：10790711
> 
> 赞同：1
> 
> 时间：2012-05-28T21:43:09.257
> 
> 标签：netty

我是 Netty 的新手，我正在尝试构建一个简单的 SMTP 服务器。我遇到的问题是大多数 SMTP 服务器命令都由一行组成，在 messageReceived() 方法中很容易阅读。但是，在从客户端接收到多个单行命令后，电子邮件的“数据”部分可以包含任意数量的行。这适用于短电子邮件，但较长的电子邮件可能只会产生部分数据。我的理解是，这是因为我现在在管道中没有任何帧解码器。

我遇到的问题是单行命令用换行符分隔，但“数据”部分由任何以“。”结尾的数字行组成。在自己的线上。

是否可以创建一个适用于单行命令和以特殊字符序列终止的多行请求的帧解码器？

谢谢！

达斯汀

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T03:23:44.443

Apache James 将 Netty 用于 SMTP，因此您可能想看看他们是如何做到的：http: [//svn.apache.org/viewvc/james/server/trunk/protocols-smtp/src/main/java/org/apache/詹姆斯/smtpserver/netty/](http://svn.apache.org/viewvc/james/server/trunk/protocols-smtp/src/main/java/org/apache/james/smtpserver/netty/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:45:32.710

您不一定需要一个解码器来完成这两项工作。您可以创建两个解码器，一个用于标头，一个用于数据部分。完成标头部分后，获取对管道的引用，删除“标头解码器”并添加“数据解码器”。完成后，将管道重置为原始配置并继续。

# c++ - 如何在没有警告的情况下使用 execv()？

> ID：10790719
> 
> 赞同：4
> 
> 时间：2012-05-28T21:44:06.610
> 
> 标签：c++, macos, g++, warnings, execv

我正在使用 GCC 4.2 开发 MacOS-X Lion。此代码有效，但我收到一条警告，我想修复：

```
#include <unistd.h>
main()
{
    char *args[] = {"/bin/ls", "-r", "-t", "-l", (char *) 0 };
    execv("/bin/ls", args);
} 
```

> 警告：不推荐将字符串常量转换为 'char*'

我不希望警告被压制，我根本不想拥有它。它是 C++ 代码，而不是 C。

使用 char *const（因此正是 execv() 所需的类型）仍然会产生警告。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T14:45:13.437

这似乎没问题：

```
#include <unistd.h>
main()
{
    char const *args[] = {"/bin/ls", "-r", "-t", "-l", NULL };
    execv("/bin/ls", const_cast<char**>(args));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:59:34.913

您正在将字符串常量转换为可变字符指针，使用隐式转换进行更改，编译器警告您该语言的较新版本不允许这种转换。

当定义一个字符串时，c++ 将它理解为一个常量字符数组，您已将其定义为一个可变字符数组，相应地更改您的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T23:16:07.927

改变：

```
char *args[] = {"/bin/ls", "-r", "-t", "-l", (char *) 0 }; 
```

到：

```
char *const args[] = {"/bin/ls", "-r", "-t", "-l", NULL }; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-05T06:53:10.977

您收到警告的唯一原因是您使用的是 g++，而不是 gcc。在纯 C 中，您绝对不会收到任何警告。从中创建无警告的 C++ 代码实际上非常困难。老实说，我尝试过，但没有成功。

这些障碍是某个哲学流派存在的原因之一。[在这里](http://harmful.cat-v.org/software/c++/linus)查看更多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-15T16:10:52.080

我不知道为什么选择接受的答案，当我运行此代码时它不会删除任何警告......

我无法在您的特定平台上确认，但是向每个字符串常量添加强制转换使警告对我来说消失了。

```
#include <unistd.h>
main()
{
    char* const args[] = {(char*)"/bin/ls", (char*)"-r", (char*)"-t", (char*)"-l", (char*) 0 };
    execv("/bin/ls", args);
} 
```

或者

```
#include <unistd.h>
main()
{
    char *args[] = {(char*)"/bin/ls", (char*)"-r", (char*)"-t", (char*)"-l", (char*) 0 };
    execv("/bin/ls", args);
} 
```

它可能过于冗长和烦人，但警告消失了。

我正在运行它：g++ (Ubuntu 4.8.4-2ubuntu1~14.04) 4.8.4

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-04T21:55:55.847

改变

`char *args[] = {"/bin/ls", "-r", "-t", "-l", (char *) 0 };`

到

`char *args[] = {(char**)"/bin/ls", (char*)"-r", (char*)"-t", (char*)"-l", 0 };`

为了可用性，你可以做一个简单的转换方法。

# facebook - Facebook：用户退出后用户访问令牌仍然有效吗？

> ID：10790728
> 
> 赞同：2
> 
> 时间：2012-05-28T21:45:07.440
> 
> 标签：facebook

我一直在寻找很多，但没有找到具体的解决方案。我的 FB 应用程序的用户获得 FB 访问令牌，然后手动注销 FB，令牌仍然有效。为什么？这是一个错误吗？如何确定用户是否已注销 FB？
无论我使用什么后端，我都可以手动从 FB 注销并输入[https://graph.facebook.com/me?access_token=OLd_ACCESS_TOKEN](https://graph.facebook.com/me?access_token=OLd_ACCESS_TOKEN)之类的网址，我将获得有关用户的所有信息。
看[这里](https://developers.facebook.com/docs/authentication/canvas/)：场景#4。令牌一定是无效的！
我需要的是确定哪个 FB 用户当前正在我的 FB 画布站点上执行操作。FB api 为自定义画布应用程序提供了一个入口点，可以在其中获取用户数据：应用程序的画布 url（您解析 signed_request 字符串）。从那时起，我应该创建 cookie 或其他任何东西来记住用户的凭据（id、token）并将其用于未来的操作。这不太好，因为用户可以在不同的浏览器选项卡中使用另一个 FB 帐户重新登录，并继续在旧帐户下使用我的应用程序。
好吧，如果我想知道当前用户，那么我需要在每次后端操作之前检查其访问令牌的有效性。我将用户重定向到身份验证页面（如果还没有）并将他的数据存储在 cookie 中。每次下一个操作，我都会从该 cookie 中提取用户信息并使用存储的访问令牌。但是现在，当令牌有效时，即使用户已经从 FB 注销，我也看不到维护它的方法:(
请帮忙！
谢谢。
**更新！**
刚刚发现我可以为同一个用户获得不同的访问令牌：
1)从我的画布 URL 的 signed_request 参数中提取的令牌运行良好，一旦用户注销 2) 令牌在服务器端身份验证流中交换到 (重定向到[https://www.facebook.com/dialog/oauth )](https://www.facebook.com/dialog/oauth)?...，在指定的 redirect_uri 捕获 CODE，使用[https://graph.facebook.com/oauth/access_token](https://graph.facebook.com/oauth/access_token)交换令牌上的 CODE ?...) - 好吧，这个令牌仍然存在很长时间。
看起来我需要处理第一个案例。无论如何，这对我来说还不够清楚。
**UPDATE2**
嗯，是的。[文档](https://developers.facebook.com/docs/authentication/canvas/)说要使用 signed_request 令牌，否则，如果设置为未经过身份验证，则运行身份验证流程并通过其他方式获取令牌。如果用户注销应用程序，最后一种方法会生成保持活动状态的令牌。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T01:04:12.077

好吧，临时解决方案是仅使用 canvas url 操作的 signed_request 参数中给出的令牌。

# c++ - 为什么代码会主动尝试阻止尾调用优化？

> ID：10790737
> 
> 赞同：81
> 
> 时间：2012-05-28T21:46:37.503
> 
> 标签：c++, c, optimization, compiler-optimization, tail-call-optimization

问题的标题可能有点奇怪，但事实是，据我所知，根本没有任何东西反对尾调用优化。然而，在浏览开源项目时，我已经遇到了一些积极尝试阻止编译器进行尾调用优化的函数，例如[CFRunLoopRef](http://opensource.apple.com/source/CF/CF-635.21/CFRunLoop.c)的实现，它充满了这样的*hacks*。例如：

```
static void __CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__() __attribute__((noinline));
static void __CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__(CFRunLoopObserverCallBack func, CFRunLoopObserverRef observer, CFRunLoopActivity activity, void *info) {
    if (func) {
        func(observer, activity, info);
    }
    getpid(); // thwart tail-call optimization
} 
```

我很想知道为什么这看起来如此重要，是否有任何情况下我作为​​一个*普通*的开发人员也应该记住这一点？例如。尾调用优化有常见的陷阱吗？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-05-28T22:03:43.343

我的猜测是，这是为了确保它`__CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__`在堆栈跟踪中以用于调试目的。它`__attribute__((no inline))`支持这个想法。

如果您注意到，该函数无论如何都会跳到另一个函数，所以它是一种蹦床形式，我只能认为它有这样一个冗长的名称来帮助调试。这将特别有用，因为该函数正在调用已从其他地方注册的函数指针，因此该函数可能无法访问调试符号。

还要注意其他类似名称的函数，它们执行类似的操作 - 它看起来确实可以帮助查看回溯中发生的情况。请记住，这是核心 Mac OS X 代码，也会显示在崩溃报告和处理示例报告中。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-05-28T21:56:30.407

这只是一个猜测，但可能是为了避免无限循环与堆栈溢出错误的轰炸。

由于所讨论的方法没有将任何东西放在堆栈上，因此尾调用递归优化似乎有可能生成进入无限循环的代码，而不是将返回地址放在堆栈上的非优化代码如果滥用，最终会溢出。

我唯一的其他想法与保留堆栈上的调用以进行调试和堆栈跟踪打印有关。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-05-28T21:59:49.013

一个潜在的原因是使调试和分析更容易（使用 TCO，父堆栈帧消失，这使得堆栈跟踪更难理解。）

# java - HashMap 中的 HashMap

> ID：10790741
> 
> 赞同：-1
> 
> 时间：2012-05-28T21:47:16.113
> 
> 标签：java, hashmap, linkedhashmap

**更新：-**

问题陈述是-

我需要储存这些东西——

```
For ID corresponding to 1, I need to Store these things

 - Key CGUID(String CGUID) and its Value, Key SGUID(String SGUID) and its Value, Key PGUID(String PGUID) and its Value, Key UID(String UID) and its Value, Key ALOC(String ALOC) and its Value

For ID corresponding to 2, I need to Store these things

- Key CGUID(String CGUID) and its Value, Key SGUID(String SGUID) and its Value, Key PGUID(String PGUID) and its Value, Key UID(String UID) and its Value, Key ALOC(String ALOC) and its Value

For ID corresponding to 3, I need to Store these things

- Key CGUID(String CGUID) and its Value, Key SGUID(String SGUID) and its Value, Key PGUID(String PGUID) and its Value, Key UID(String UID) and its Value, Key ALOC(String ALOC) and its Value 
```

因此，对于这个问题，我正在考虑制作这样的数据结构-

```
public static LinkedHashMap<String, Integer> GUID_VALUES = new LinkedHashMap<String, Integer>();

public static LinkedHashMap<Integer, LinkedHashMap<String, Integer>> GUID_ID_MAPPING = new LinkedHashMap<Integer, LinkedHashMap<String, Integer>>(); 
```

还有比这更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:53:36.913

目前尚不完全清楚您最终要存储的内容。

如果您只想要地图地图：

```
LinkedHashMap<Integer, LinkedHashMap<String, Integer>> 
```

但最后那些“等等等等”是什么？每个父 ID 是否有多个“子”ID？如果是这样，那么您可能想要某种树（可以通过地图实现，但对其进行抽象似乎是合理的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T21:55:02.887

在 Java 中，您可以通过以下方式实现：

```
public class Data {
    public static LinkedHashMap<String, Integer> GUID_VALUES = new LinkedHashMap<String, Integer>();
    public static LinkedHashMap<Integer, Map<String, Integer>> GUID_ID_MAPPING = new LinkedHashMap<Integer, Map<String, Integer>>();

    static {
        Integer someNumber = 0; //or another value, its for initialize the key
        GUID_ID_MAPPING.put(someNumber,GUID_VALUES);
    }
} 
```

不过，我不明白你为什么真的需要这个。我建议您发布您的功能要求并尝试选择更好的设计来解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T21:49:59.300

您可能想要一个多键映射，就像 Apache Commons Collections 中可用的那样：

[http://commons.apache.org/collections/api-release/org/apache/commons/collections/map/MultiKeyMap.html](http://commons.apache.org/collections/api-release/org/apache/commons/collections/map/MultiKeyMap.html)

# variables - AWK 在特定线槽通过变量替换模式

> ID：10790742
> 
> 赞同：3
> 
> 时间：2012-05-28T21:47:25.030
> 
> 标签：variables, awk, line

我试图将两个变量传递给 awk，以便在特定行**(-v var2)**用空格**(" ")替换单词****(-v var1** ) 。当我运行它时，我想要的行没有被替换。

 ****我的第一种方法是：

```
palabra=betina; i=5 ; awk -v var1="$i" -v var2="$palabra" 'NR==var1 {sub("var2"," ")}{print }' Countries > tmp 
```

在文件*"Countries"*上，内容是：

```
usa
usa
colombia
spain
betina 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T21:53:26.710

删除周围的引号`var2`，你应该很好。

```
palabra=betina; i=5 ; awk -v var1="$i" -v var2="$palabra" 'NR==var1 {sub(var2," ")}{print }' file 
```****

# websocket - Tornado 的 websocket 实现如何查找和关闭僵尸 websocket？

> ID：10790751
> 
> 赞同：3
> 
> 时间：2012-05-28T21:48:36.473
> 
> 标签：websocket, tornado, zombie-process

假设浏览器被强制终止，并且没有关闭消息发送到 Tornado 服务器。Tornado 怎么知道（或者它甚至知道？）这个连接已经在客户端被终止了？查看[Tornado websocket 代码](https://github.com/facebook/tornado/blob/master/tornado/websocket.py)对我来说并不明显。

我问是因为我曾经有几分钟没有调用服务器端 on_close 方法（可能是因为客户端未能发送其关闭消息），但是 Tornado 似乎注意到客户端已经消失并关闭了插座本身。

有什么见解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:38:01.327

Tornado 监控底层 TCP 连接是否关闭。由于关闭握手或发生网络错误而关闭连接都没有关系。在任何一种情况下，都会调用 on_close。

如果客户端失去网络连接，TCP 连接可能会被认为打开几分钟，然后 TCP 堆栈将决定连接超时。之后，它将关闭套接字，将通知 Tornado 等。

# php - 如何使用 id 名称作为 url 加载带有 jquery 的页面

> ID：10790753
> 
> 赞同：0
> 
> 时间：2012-05-28T21:48:45.727
> 
> 标签：php, javascript, jquery, ajax

我如何告诉 jquery 使用`<a id="">`or`<a href="">`作为 URL 来加载点击？例如 URL page1.php。通过获取 href，或通过获取 id 然后附加 .php

html

```
<a id="page1" class="load" href="page1.php">1</a>
<a id="page2" class="load" href="page2.php">2</a>
<a id="page3" class="load" href="page3.php">3</a> 
```

jQuery

```
<script>
    $(document).ready(function () {  
        $(".load").click(loadDynamic);  
    });  
    function loadDynamic() {  
        $("#load_in")  
            .load("",function (content) {  
                $(this).hide().fadeIn("slow");  
                return false;  
        }); 
    }  
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T21:50:37.990

用于`this.href`获取`href`.

```
$(document).ready(function() {
    $(".load").click(loadDynamic);
});

function loadDynamic() {
    $("#load_in").load(this.href, function(content) {
        $(this).hide().fadeIn("slow");
    });
        return false;
}​ 
```

当然你也可以使用`this.id + ".php"`。

**请注意**`return false`，您在回调中编写，`load`因此它不会阻止默认的锚点点击！您应该将其移至答案中的外部范围。

* * *

对于那些抱怨的`.click(fn)`人`on('click', fn)`

**这些是相同的功能**，`.click(fn)`是的别名`on('click', fn)`：

> 在前两个变体中，此方法是 .bind("click", handler) 的快捷方式，以及 jQuery 1.7 中的 .on("click", handler) 的快捷方式。

[**jQuery 文档**](http://api.jquery.com/click/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T21:51:30.797

您可以使用`this.href`：

```
$(".load").click(function() {
    $("#load_in").load(this.href, function() {
        $(this).hide().fadeIn("slow");
    });
    return false;
}); 
```

要获取 ID，请使用 simple `this.id`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T21:51:42.130

代替

```
.load("",function (content) { 
```

和

```
.load(this.href, function (content) { 
```

# sql-server - RavenDB 导出\导入数据到 SQL Server

> ID：10790761
> 
> 赞同：1
> 
> 时间：2012-05-28T21:49:22.740
> 
> 标签：sql-server, ravendb

简单问题：如何将数据从 SQL Server 导出到 RavenDB？

我编写了从 SQL Server 获取数据并存储在 raven 中的脚本，但它的运行速度非常慢。每秒大约 2500 次插入。

编辑：我的代码

```
 for (int i = 0; i < count; i+=8196)
    {
        StoreInTaven(WordStats.Skip(i).Take(8196).Select(x => new KeyPhraseInfo(){
           Key = x.Word,
           Id = x.Id,
           Count = x.Count,
           Date = x.Date
        }));
        GC.Collect();
    }

public static void StoreInTaven(IEnumerable<KeyPhraseInfo> wordStats)
{
     using(var session = store.OpenSession())
     {
           foreach (var wordStat in wordStats)
           {
              session.Store(wordStat);
           }

           session.SaveChanges();
     }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:28:29.580

我只是在做同样的事情。速度对我来说并不是真正的问题，所以我不知道这是否比你的快。

```
public static void CopyFromSqlServerToRaven(IDocumentSession db, bool ravenDeleteAll=true)
{
    if (ravenDeleteAll) db.DeleteAll();

    using (var connection = new SqlConnection(SqlConnectionString))
    {
        var command = new SqlCommand(SqlGetContentItems, connection);
        command.Connection.Open();
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                db.Store(new ContentItem
                            {
                                    Id = reader["Id"].ToString(),
                                    Title = (string)reader["Name"],
                                    Description = (string)reader["ShortDescription"],
                                    Keywords = (string)reader["SearchKeywords"]
                            });
            }
        }
        db.SaveChanges();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T18:03:58.493

我相信它在标准服务器上支持每秒 1,000 次写入。

当我增加缓存大小时，性能会提高。乌鸦/Esent/CacheSizeMax

[http://ravendb.net/docs/server/administration/configuration](http://ravendb.net/docs/server/administration/configuration)

# mysql - 索引查询执行从几秒到几小时，而数据的增加最少

> ID：10790768
> 
> 赞同：1
> 
> 时间：2012-05-28T21:50:22.797
> 
> 标签：mysql, performance, stored-procedures, indexing, innodb

在我的查询从几秒钟跳到几小时之前，我一直在体验出色的性能。

A) 调查 B) 在 Mysql 上查询过多数据时解决主要的性能瓶颈，我该怎么做？

也许与记忆有关？

* * *

### 结果

在测试存储过程的性能时，我在 5 分钟内运行了两次，首先...

```
mysql> CALL TopFromBigTable('2012-04-01','2012-05-01',5);
5 rows in set (23.76 sec) 
```

这是非常快的，但后来我再次调用它......我在一个多小时后杀死了它！

```
mysql> CALL TopFromBigTable('2012-04-01','2012-05-01',5);

---TRANSACTION 1484EF5C, ACTIVE 3571 sec fetching rows, thread declared inside InnoDB 193
mysql tables in use 2, locked 1
MySQL thread id 466174, OS thread handle 0x7f3616ab4700, query id 33098684 localhost    root Copying to tmp table 
```

更多测试：

```
mysql> CALL TopFromBigTable('2012-05-01','2012-05-04',5);
5 rows in set (1.28 sec)
mysql> CALL TopFromBigTable('2012-05-01','2012-05-05',5);
5 rows in set (1.55 sec)
mysql> CALL TopFromBigTable('2012-05-01','2012-05-06',5);
5 rows in set (1 hour 47 min 37.99 sec) 
```

* * *

### 细节

桌子

```
CREATE TABLE `BigTable` (
  `BigTableID` int(11) NOT NULL,
  `AnotherID` int(11) NOT NULL,
  `Type` char(2) COLLATE utf8_unicode_ci DEFAULT NULL,
  `StartTime` datetime NOT NULL,
  `EndTime` datetime DEFAULT NULL,
  PRIMARY KEY (`BigTableID`),
  KEY `Type` (`Type`),
  KEY `StartTime` (`StartTime`),
  KEY `EndTime` (`EndTime`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci 
```

查询（***注意使这个通用我`group by`错了***）

```
CREATE PROCEDURE `TopFromBigTable` (
    $StartDate DATETIME,
    $EndDate DATETIME,
    $ResultLimit INT
    )
BEGIN

    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED ;
    SELECT
        `Type`,
        COUNT(*) AS Count
    FROM
        `BigTable`
    WHERE                
            `StartTime` > $StartDate
        AND
            `StartTime` < $EndDate
    GROUP BY
        `Type`
    ORDER BY
        Count DESC
    LIMIT $ResultLimit
    ;
    COMMIT;

END $$ 
```

执行计划

```
EXPLAIN EXTENDED ...
           id: 1
  select_type: SIMPLE
        table: BigTable
         type: range
possible_keys: StartTime
          key: StartTime
      key_len: 8
          ref: NULL
         rows: 16446226
     filtered: 100.00
        Extra: Using where; Using temporary; Using filesort 
```

我在专用报告数据库上运行，因此并非所有正常规则都适用，即我阅读未提交以试图降低开销，因为准确性并不重要，并且该数据库在过去 6 小时内未更新。我想对这实际上有多大帮助（如果有的话）进行基准测试，但我无法可靠地为存储过程计时！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:13:00.430

这是一个艰难的...如果它真的是一个大表 - 在 StartTime 中添加和索引可能需要一些时间和一些额外的空间，但会提高选择速度，前提是根据[http://dev指定 USE INDEX .mysql.com/doc/refman/5.1/en/index-hints.html](http://dev.mysql.com/doc/refman/5.1/en/index-hints.html)

请务必根据每天插入的行数重新索引...请自行决定。

在研究您的有趣问题时，我也遇到了这个问题：[http ://www.petefreitag.com/item/613.cfm](http://www.petefreitag.com/item/613.cfm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T22:20:13.540

详细解答。

1.  将您的存储过程分解为示例查询
2.  采用`EXPLAIN EXTENDED`
3.  使用`EXPLAIN EXTENDED`不同的输入，因为优化器可以改变计划！

随机行为是优化器以不同的方式计算表统计信息（随着时间的推移它在后台这样做）并选择了一个不太有效的索引。解决方案是通过提示强制使用更好`USE INDEX(StartTime)`的索引或调整索引。

好的

```
EXPLAIN EXTENDED
SELECT
    `Type`,
    COUNT(*) AS Count
FROM
    `BigTable`
WHERE                
        (`StartTime` > '2012-02-01')  
    AND
        (`StartTime` < '2012-02-02' ) 
GROUP BY
    `Type`
ORDER BY
    Count DESC
LIMIT 5
;

           id: 1
  select_type: SIMPLE
        table: BigTable
         type: range
possible_keys: StartTime
          key: StartTime
      key_len: 8
          ref: NULL
         rows: 170986
     filtered: 100.00
        Extra: Using where; Using temporary; Using filesort 
```

坏（错误的索引，38M 行和 15% 已过滤）

```
EXPLAIN EXTENDED
SELECT
    `Type`,
    COUNT(*) AS Count
FROM
    `BigTable`
WHERE                
        (`StartTime` > '2012-02-01')  
    AND
        (`StartTime` < '2012-03-01' ) 
GROUP BY
    `Type`
ORDER BY
    Count DESC
LIMIT 5
;
           id: 1
  select_type: SIMPLE
        table: BigTable
         type: index
possible_keys: StartTime
          key: Type
      key_len: 7
          ref: NULL
         rows: 38311434
     filtered: 14.54
        Extra: Using where; Using temporary; Using filesort 
```

固定（5M 行）

```
EXPLAIN EXTENDED
SELECT
    `Type`,
    COUNT(*) AS Count
FROM
    `BigTable`
    USE INDEX (`StartTime`)
WHERE                
        (`StartTime` > '2012-02-01')  
    AND
        (`StartTime` < '2012-02-02' ) 
GROUP BY
    `Type`
ORDER BY
    Count DESC
LIMIT 5
;

           id: 1
  select_type: SIMPLE
        table: BigTable
         type: range
possible_keys: StartTime
          key: StartTime
      key_len: 8
          ref: NULL
         rows: 5572320
     filtered: 100.00
        Extra: Using where; Using temporary; Using filesort 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T22:26:46.123

由于您按`Type`它分组只有几个 (50) 不同的值，而不是 100K 值，我看到 2 个选项：

*   复合**`(Type, StartTime)`**索引。

索引“覆盖”了查询，这意味着查询将只使用索引而不命中表。它仍然需要扫描大部分索引并计算每个项目的数量`Type`，所以它不是最好的希望，但`Type`表中只有 50 个值，我认为它会表现良好。（最终的文件排序 - 只有 50 行 - 不会有问题。）

*   此查询的另一个覆盖索引是 Compound **`(StartTime, Type)`**。

如果查询使用这个，它将从索引的一部分读取所有数据，因此在某些情况下它可能会更快（当开始-结束时间窗口很小并且`Type`有更多不同的值时）。但是 group by`Type`可能会使这个性能不如第一个，尤其是在大窗户的情况下。

我认为最好的方法是同时使用上述指标和各种参数进行测试/实验。

# java-ee-6 - 如何升级过滤器以支持 Servlet 3.0 异步 servlet

> ID：10790770
> 
> 赞同：9
> 
> 时间：2012-05-28T21:50:45.940
> 
> 标签：java-ee-6, server-push, servlet-3.0

我有一个 servlet，用于从许多第三方 REST 数据点获取数据，集成所有数据并以 HTML 格式报告数据。我还有一个过滤器，它具有以下流程 -

1.  当请求命中过滤器时创建事件记录，并将 eventrecord 对象添加到请求中
2.  执行 chain.doFilter - 允许 servlet 向事件记录添加更多详细信息
3.  在返回浏览器的路上，filter 获取 eventrecord 对象并记录它。

现在，如果我使用 Asynchronous servlet using `AsyncContext context = request.getAsyncContext();`，它将与相同的 REST 数据点通信，但是当数据准备好时，它将写入响应流而不是等待所有 REST 数据点响应，我将如何重新编写我的过滤器? 它是否会附加到负责从 REST 数据点刷新数据的线程，以便在处理和刷新所有数据后，它将记录事件记录？是否有任何通用模式可供我研究以了解如何使用 Servlet 3.0 的异步 servlet 处理此类用例？我正在使用 JDK 6.0、Tomcat 7.0。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T12:02:54.110

只需`@WebFilter(urlPatterns = {"/*" }, asyncSupported = true)`为您的过滤器添加 web-xml。

或添加`<async-supported>true</async-supported>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-07T16:30:42.787

**由于我不确定自己如何正确地支持检测或诊断过滤器（例如[Codahales 指标过滤器](http://metrics.dropwizard.io/3.1.0/manual/servlet/)），因此我提供了赏金。**

虽然添加`<async-supported>true</async-supported>`到您的过滤器肯定会让它们看起来有效，但它可能无法获得您期望的结果（在指标的情况下，您的所有请求都会显得非常快）。

立即在过滤器中获取 AsyncContext 以绑定度量数据似乎是个好主意，[但各种容器显然对此存在问题](https://github.com/circlespainter/servlet3-filter-async-test#dispatching-requests-for-async-execution-in-spring-boot-with-or-without-actuator)，我相信像 Spring 这样的框架也有问题（这可能只是我的旧版本 Spring）。那就是大多数框架都希望请求处理的前半部分是同步的（我可能对此大错特错）。

因此，似乎唯一的万无一失的方法是在框架级别集成过滤器。例如 Spring 提供`org.springframework.web.context.request.async.DeferredResultProcessingInterceptor`的功能有点类似于 AsyncContext 事件。

这有点令人遗憾，因为并非所有请求都可能由 Web 框架处理，但是处理请求的第一部分和实际执行之间还是有区别的（即，现在这是您可能想要监控的两个指标）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-14T08:10:43.347

@WebFilter 注解已在 Java EE 6 中引入。它定义了不同的元素，如 filterName、asyncSupported 和 servletNames 等。@WebFilter 不能在没有 web.xml 的情况下使用，因为 @WebFilter 没有定义顺序。@WebFilter 减少了 web.xml 中的其他配置。

```
@WebFilter(filterName="filterOne")
public class FilterOne implements Filter {
    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
    }
    @Override
    public void doFilter(ServletRequest request, ServletResponse response,
            FilterChain chain) throws IOException, ServletException {
        System.out.println("Inside filter one.");
        chain.doFilter(request, response);
    }
    @Override
    public void destroy() {
    }
} 
```

# css - Div 随窗口调整大小而改变位置

> ID：10790773
> 
> 赞同：0
> 
> 时间：2012-05-28T21:51:19.513
> 
> 标签：css

我有一个问题，我一整天都在苦苦挣扎。我有两个相邻的 div 对齐。问题是当我调整浏览器窗口的大小（更小）时，右 div 跳到左 div 下方。我为包含父项指定了一个固定宽度，并确保两个内部 div 的宽度不超过父 div 的宽度。我的标记：

```
<div class="parent">
  <div class="left">contents</div>
  <div class="right">contents</div>
</div>

<style>
 .parent
 {
   width: 800px;
 }

 .left
 {
   float: left;
   width: 305px;
 }

 .right
 {
   display: inline-block; (also tried float: left)
   width: 480px;
 }
</style> 
```

我真的需要帮助，我快疯了。谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:57:38.353

这是您插入 jsFiddle 的代码：

[http://jsfiddle.net/FHqtK/](http://jsfiddle.net/FHqtK/)

必须有一些其他样式干扰，因为它在这里表现得很好`float: left`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:07:35.653

尝试这个：

```
 .right {
        display: inline-block;
        white-space: normal;
        width: 480px;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T22:04:06.093

你确定你的 div 是你指定的宽度吗？它们可能有边距或填充。另外，我希望您发布的代码与您正在使用的代码不完全相同。样式标签应该在头标签内。

你的结构应该是这样的：http: [//jsfiddle.net/XEamY/](http://jsfiddle.net/XEamY/)

# core-plot - 如何在带有coreplot的条形图上同时为各个条形使用自定义标签和标签？

> ID：10790779
> 
> 赞同：2
> 
> 时间：2012-05-28T21:52:11.273
> 
> 标签：core-plot, bar-chart

我正在尝试创建一个类似于下面的条形图 - 其中 x 轴有 2 个不同的标签 - 一个是条形本身的标签，表示性能，另一个在轴的底部，表示年份。只有数字需要旋转显示，在图表上而不是在顶部。

[条状图](http://images.yourdictionary.com/bar-graph)

我通过创建自定义标签来展示岁月。`-dataLabelForPlot:recordIndex:`通过实施该方法，我还可以显示条形图的性能数据。性能数据显示但水平，但我希望能够将性能数据旋转 90 度。在绘图上设置`labelRotation`无济于事，因为我已将 设置为`labelingPolicy`，`CPTAxisLabelingPolicyNone`因此我可以添加自定义标签。

下面是我的代码：

```
-(CPTLayer *)dataLabelForPlot:(CPTPlot *)plot recordIndex:(NSUInteger)index 
{
    CPTMutableTextStyle *axisTitleTextStyle = [CPTMutableTextStyle textStyle];
    axisTitleTextStyle.fontSize = 10.0;
    axisTitleTextStyle.color = [CPTColor blackColor];

    CPTTextLayer *label = [[CPTTextLayer alloc] init];
    label.textStyle = axisTitleTextStyle;
    if ( [plot isKindOfClass:[CPTBarPlot class]] ) {
        if ( [plot.identifier isEqual:@"Fund"] ) {
            label.text =  [[[self dataGroup1] objectAtIndex:index] stringValue];
        }
        else if ( [plot.identifier isEqual:@"Benchmark"] ) {
            label.text =  [[[self dataGroup2] objectAtIndex:index] stringValue];
        }

    }
    return [label autorelease];
}

- (void) drawGraph 
{
    graphHostingView_ = [[CPTGraphHostingView alloc] initWithFrame:self.bounds];

    calPerfGraph_ = [[CPTXYGraph alloc] initWithFrame:self.bounds];
    graphHostingView_.hostedGraph = calPerfGraph_;

    [self addSubview:graphHostingView_];

    calPerfGraph_.plotAreaFrame.masksToBorder = NO;

    calPerfGraph_.paddingLeft = 5.0;
    calPerfGraph_.paddingTop = 20.0;
    calPerfGraph_.paddingRight = 10.0;
    calPerfGraph_.paddingBottom =20.0;

    calPerfGraph_.plotAreaFrame.paddingTop = 10.0;
    calPerfGraph_.plotAreaFrame.paddingBottom = 50.0;
    calPerfGraph_.plotAreaFrame.paddingLeft = 10.0;
    calPerfGraph_.plotAreaFrame.paddingRight = 35.0;

    // Y axis scale - round to nearest ten
    int maxYScale = (([[self getPositiveMax] intValue] / 10 ) + 1) * 10;
    int minYScale = (([[self getNegativeMax] intValue] / 10 ) + 1) * 10;

    // Styles
    CPTMutableLineStyle *lineStyle = [CPTMutableLineStyle lineStyle];
    lineStyle.lineColor = [CPTColor grayColor];
    lineStyle.lineWidth = 2.0f;

    CPTMutableLineStyle *gridLineStyle = [CPTMutableLineStyle lineStyle];
    gridLineStyle.lineColor = [CPTColor grayColor];
    gridLineStyle.lineWidth = 1.0f;

    // X axis
    CPTXYAxisSet *axisSet = (CPTXYAxisSet *)calPerfGraph_.axisSet;
    axisSet.xAxis.minorTicksPerInterval = 0;
    axisSet.xAxis.majorTickLineStyle = lineStyle;
    axisSet.xAxis.axisLineStyle = lineStyle;
    axisSet.xAxis.majorTickLength = 0;
    axisSet.xAxis.labelingPolicy = CPTAxisLabelingPolicyNone;
    axisSet.xAxis.axisConstraints = [CPTConstraints constraintWithLowerOffset:0]; // Bring labels to the bottom on the plot
    axisSet.xAxis.labelRotation = M_PI/2;

    int currentYear = [self getCurrentYear];
    NSMutableArray *customLabels = [NSMutableArray arrayWithCapacity:6];
    for (int i=currentYear-5,count=1; currentYear>=i; i++,count++) {
        CPTAxisLabel *newLabel = [[CPTAxisLabel alloc] initWithText:[NSString stringWithFormat:@"%d",i] textStyle:axisSet.xAxis.labelTextStyle];
        newLabel.tickLocation = CPTDecimalFromInt(count);
        newLabel.offset = axisSet.xAxis.labelOffset + axisSet.xAxis.majorTickLength;
        [customLabels addObject:newLabel];
        [newLabel release];
    }
    axisSet.xAxis.axisLabels =  [NSSet setWithArray:customLabels];

    // Y axis
    if ( maxYScale >= 40 || minYScale >= 40) {
        axisSet.yAxis.majorIntervalLength = [[NSDecimalNumber decimalNumberWithString:@"20"] decimalValue];
    }
    else {
        axisSet.yAxis.majorIntervalLength = [[NSDecimalNumber decimalNumberWithString:@"10"] decimalValue];
    }

    axisSet.yAxis.minorTicksPerInterval = 0;
    axisSet.yAxis.majorTickLength = 0;
    axisSet.yAxis.majorGridLineStyle = gridLineStyle;
    axisSet.yAxis.axisLineStyle = nil;
    axisSet.yAxis.axisConstraints = [CPTConstraints constraintWithUpperOffset:0]; // Bring labels to the right end of the plot
    axisSet.yAxis.tickDirection = CPTSignPositive;

    CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *)calPerfGraph_.defaultPlotSpace;
    plotSpace.xRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromDouble(0.0) length:CPTDecimalFromDouble([[self calPerfFundData] count]+1)];
    plotSpace.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromDouble(-minYScale) length:CPTDecimalFromDouble(minYScale + maxYScale)];

    CPTBarPlot *barPlot = [CPTBarPlot tubularBarPlotWithColor:[CPTColor greenColor] horizontalBars:NO];    
    barPlot.baseValue = CPTDecimalFromString(@"0");
    barPlot.dataSource = self;
    barPlot.barOffset = CPTDecimalFromFloat(.7);
    barPlot.identifier = @"Fund";
    barPlot.barWidth = CPTDecimalFromFloat(.25);
    [barPlot addAnimation:[self animateVerticalBars] forKey:@"FundAnimation"];
    [calPerfGraph_ addPlot:barPlot toPlotSpace:plotSpace];

    CPTBarPlot *bbarPlot = [CPTBarPlot tubularBarPlotWithColor:[CPTColor colorWithComponentRed:0.9 green:0.9 blue:0.9 alpha:0.8] horizontalBars:NO];    
    bbarPlot.baseValue = CPTDecimalFromString(@"0");
    bbarPlot.dataSource = self;
    bbarPlot.barOffset = CPTDecimalFromFloat(1);
    bbarPlot.barWidth = CPTDecimalFromFloat(.25);
    bbarPlot.identifier = @"Benchmark";
    [bbarPlot addAnimation:[self animateVerticalBars] forKey:@"BenchmarkAnimation"];
    [calPerfGraph_ addPlot:bbarPlot toPlotSpace:plotSpace];
} 
```

如何旋转条上的性能数据？任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T22:36:49.900

图和轴都有自己独立的`labelRotation`属性。您将负责设置自定义轴标签的旋转，但`labelRotation`条形图的属性应设置条形上方数据标签的旋转。

# c++ - 访问 COM 对象中的不透明数据成员

> ID：10790784
> 
> 赞同：1
> 
> 时间：2012-05-28T21:52:34.650
> 
> 标签：c++, com

我最近遇到了 COM inproc 服务器的问题。

我有一个实现接口的`MCanvasFont`COM 对象：`ICanvasFont`

```
ICanvasFont : public IUnknown
{
    virtual HRESULT STDMETHODCALLTYPE Create(
        /* [in] */ BSTR bstrFamily,
        /* [in] */ double fSize) = 0;

    virtual HRESULT STDMETHODCALLTYPE SetSize(
        /* [retval][out] */ double fSize) = 0;
}; 
```

这些`MCanvasFont`对象持有一个不透明的指针，指向一个`FontDelegate`实现实际字体操作的对象：

```
class MCanvasFont : public ICanvasFont
{
public:
    MCanvasFont();
    virtual ~MCanvasFont();

    virtual HRESULT STDMETHODCALLTYPE QueryInterface(const IID& iid, void** ppv);
    virtual ULONG   STDMETHODCALLTYPE AddRef();
    virtual ULONG   STDMETHODCALLTYPE Release();

    virtual HRESULT STDMETHODCALLTYPE Create(
        /* [in] */ BSTR bstrFamily,
        /* [in] */ double fSize);

    virtual HRESULT STDMETHODCALLTYPE SetSize(
        /* [in] */ double fSize);

protected:
    class FontDelegate;
    const std::unique_ptr<FontDelegate> m_font; // opaque pointer

    // Reference count
    long m_cRef;
}; 
```

还有一个`MCanvas`实现`ICanvas`接口的类。该`ICanvas`接口具有`SetFont(ICanvasFont* pFont)`设置当前字体的抽象方法和`DrawText`在画布上绘制文本的方法：

```
class MCanvas : public ICanvas
{
public:
    MCanvas();
    virtual ~MCanvas();

    virtual HRESULT STDMETHODCALLTYPE QueryInterface(const IID& iid, void** ppv);
    virtual ULONG   STDMETHODCALLTYPE AddRef();
    virtual ULONG   STDMETHODCALLTYPE Release();

    STDMETHODDECL GetFont(
        /* [retval][out] */ ICanvasFont** ppFont);
    STDMETHODDECL SetFont(
        /* [in] */ ICanvasFont* pFont);

    // ...

    STDMETHODDECL DrawText(
        /* [in] */ double x,
        /* [in] */ double y,
        /* [in] */ BSTR text);

protected:
    COMAutoPtr<ICanvasPen>     m_pen;
    COMAutoPtr<ICanvasBrush>   m_brush;
    COMAutoPtr<ICanvasFont>    m_font;

    // Reference count
    long m_cRef;
}; 
```

我需要一种从方法访问`FontDelegate`对象的`MCanvas::DrawText`方法。最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T07:43:15.970

> 另一种方法似乎是从 ICanvasFont 转换为 MCanvasFont。

一种对 COM 友好的方法是定义一个私有 GUID 来“按原样”表示您的类：让 MCanvasFont 在其 QI 中通过返回一个未强制转换的“this”来响应它。然后，MCanvas 可以使用带有这个私有 GUID 的 QI 来检查 ICanvasFont 是否真的是 MCanvasFont；如果 QI 成功，它现在可以使用正确投射的 MCanvasFont。

这允许第 3 方代码以不透明 COM 对象的形式获取和传递他们从您那里获得的对象，但是当您取回您自己的对象之一时，您可以确定它实际上是“您自己的”，然后适当地访问其内部.

这种技术的好处是它在不受支持的场景中优雅地失败 - 您可以将其视为一种安全的 COM 样式转换，将您从 COM 的不可知世界带回 C++ 的世界：

如果第 3 方尝试自己实现 ICanvasFont，那么它当然会通过 QI 测试，因为他们不会实现私有 GUID，所以你会知道拒绝它，这是合适的，因为听起来你的代码是使用此接口作为库功能的抽象，而不是作为扩展点。

如果您收到一个远程对象的 ICanvasFont，QI 将失败，因为 COM 远程处理基础设施将无法为您的私有 GUID 找到代理/存根信息，如果您不考虑提供远程处理，这可能也是合适的或在这种情况下支持跨单元/多线程。

* * *

...或者至少如果您有一个期望在单个线程（公寓）中使用的简单 GUI/STA 风格对象，它可以工作。*如果*你允许你的接口在一个进程中被编组到不同的单元，你需要在上面的一般主题上做更多的工作，因为你实际上可能想要支持一个源自另一个单元的 ICanvasFont。您仍然可以使用带有私有 GUID 的 QI 来询问该对象是否是“您的一个”，但现在您需要 QI 到一个也具有编组支持的中间私有接口，然后有一个方法，您可以隧道原始指针通过（并且，为了偏执，检查对象是否在同一个进程中！）；一旦你这样做了，你需要知道你从那里开始承担所有编组/线程的责任。但考虑到您问题的 GUI 风格性质，我猜这里可能不是这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T00:41:02.540

也许我错过了一些东西。您不能简单地将 MCanvas 声明为 MCanvasFont 中的友元类，然后将 ICanvasFont 指针向下转换为 MCanvas::DrawText 中的 MCanvasFont 吗？

应该注意的是，您正在使用的 ICanvasFont 指针可能不是 MCanvasFont 类型。如果您使用`dynamic_cast`向下转换，这应该只在您获得的 ICanvasFont 指针来自与您的 MCanvas 实例相同的进程内服务器的情况下才能成功。这是我能看到的唯一一种情况，你正在尝试做的事情甚至是可能的。但是在尝试访问 FontDelegate 之前，您应该检测并验证您是否在此上下文中操作。

# java - JUnit 生命周期

> ID：10790786
> 
> 赞同：5
> 
> 时间：2012-05-28T21:52:40.327
> 
> 标签：java, testing, junit

我在使用 JUnit 做一些测试套件时遇到了生命周期问题。

为了编写方便的 JPA 2.0 单元测试作为 Java 开发人员，我想：

*   在所有测试套件之前初始化一次 EntityManagerFactory 实例。我通过使用 @BeforeClass 注释来实现对象
*   实例化一个 EntityManager 实例并在每个测试用例之前启动一个新事务，并在通知之前/之后或周围回滚已启动的事务，如 AOP
*   能够在任何派生的测试套件之前/之后进行任何设置/拆卸操作

我一直在编写 JUnit 测试。但在这种情况下，我对列表中的第二项和第三项有疑问。

请查看以下测试套件示例：

**一个抽象的测试套件**：

```
public abstract class AbstractPersistenceTest {

    protected static EntityManagerFactory emf;
    protected EntityManager em;

    @BeforeClass
    public static void setUpClass() {
        emf = Persistence.createEntityManagerFactory("test");
    }

    @Before
    public void setUp() {
        em = emf.createEntityManager();
        em.getTransaction().begin();
    }

    @After
    public void tearDown() {
        em.getTransaction().rollback();
        em.close();
    }

    @AfterClass
    public static void tearDownClass() {
        emf.close();
    }

} 
```

**派生的测试套件**：

```
public class EmployeeJpqlTest extends AbstractPersistenceTest {

    private Employee john;
    private Employee jack;

    @Before
    public void setUp() {
        john = new Employee("John Doe", 1000);
        jack = new Employee("Jack Line", 1010);

        em.persist(john);
        em.persist(jack);
    }

    @Test
    public void itShouldRetrieveAllEmplloyees() {
        TypedQuery<Employee> query = em.createQuery("SELECT e FROM Employee e",
                Employee.class);
        List<Employee> employees = query.getResultList();

        assertArrayEquals(new Employee[] { john, jack }, employees.toArray());
    }

    @Test
    public void itShoulRetrieveAllEmployeeNames() {
        TypedQuery<String> query = em.createQuery(
                "SELECT e.name FROM Employee e", String.class);
        List<String> names = query.getResultList();

        assertArrayEquals(new String[] { john.getName(), jack.getName() },
                names.toArray());
    }

} 
```

由于未指定 JUnit 生命周期注释的顺序，NullPointerException 在派生类的 setUp() 方法中占有一席之地。这对我来说很清楚。

是否可以在不手动在任何派生测试套件类的每个 setUp()/tearDown() 方法中注入启动/回滚事务代码的情况下实现目标？或者，是否有替代的 JUnit 均值或测试框架可以提供一种简单的方式来表达我的需求？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:14:51.873

您如何看待使用[Google Guice](http://code.google.com/p/google-guice/wiki/JPA)将实体管理器和事务注入您的测试方法的想法？

```
import com.google.inject.persist.Transactional;
import javax.persistence.EntityManager; 

public class MyTest {
        @Inject EntityManager em; 

        @Test
        @Transactional 
        public void createNewPerson() {
                em.persist(new Person(...)); 
        } 
} 
```

它可以简化这方面的大量工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:28:29.100

你为什么不`super.setUp()`打电话`setUp`等等`super.setUpClass`？您实际上在做的是覆盖子类的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T06:35:59.027

考虑使用 Spring 处理非静态实体管理器的一次性实例化和事务回滚。即使您没有在应用程序中使用 Spring，您也可以从仅在测试中使用它中受益。[有关详细信息，请参阅http://static.springsource.org/spring/docs/3.0.5.RELEASE/reference/testing.html](http://static.springsource.org/spring/docs/3.0.5.RELEASE/reference/testing.html)的第 9.3 节。

# java - 以编程方式切换 API 命名约定

> ID：10790795
> 
> 赞同：5
> 
> 时间：2012-05-28T21:53:46.930
> 
> 标签：java, c++, vim, naming-conventions, swig

## 背景

FreeLing API 定义了一个不遵循标准 Java 命名约定的接口[。](http://nlp.lsi.upc.edu/freeling/)例如：

```
package freeling;

public class sentence extends ListWord {
  public void set_parse_tree(parse_tree arg0) { 
```

该接口使用[SWIG](http://www.swig.org/)定义，类似于[IDL](http://en.wikipedia.org/wiki/Interface_description_language)：

```
class sentence : public std::list<word> {
 public:
  sentence(void);

  void set_parse_tree(const parse_tree &); 
```

## 问题

从学术上讲，您如何将接口映射到传统的 Java 命名标准（例如，`class Sentence`和`setParseTree( parseTree arg0 )`）？

## 想法

1.  手动转换 650+ 行[接口文件](http://pastebin.com/raw.php?i=m4XPJ5sT)（并将补丁发送给开发人员）。
2.  正则表达式[搜索和替换](http://vim.wikia.com/wiki/Converting_variables_to_or_from_camel_case)voodoo（使用 vi）：`:1,$s/_\([a-z]\)/\u\1/g`
3.  从 53 个自动生成的 Java 源文件创建包装类。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T22:38:33.750

SWIG 提供了一个`%rename`指令，允许名称在客户端和实现语言中不同。 ~~但是这样做会使接口文件的长度几乎增加一倍。~~

实际上，SWIG 提供批量重命名。请参阅[文档](http://swig.org/Doc2.0/SWIG.html#SWIG_advanced_renaming)

> 5.4.7.2 高级重命名支持
> 
> 虽然为特定声明编写 %rename 很简单，但有时需要将相同的重命名规则应用于 SWIG 输入中的许多（可能是全部）标识符。例如，可能需要对目标语言中的所有名称进行一些转换，以更好地遵循其命名约定，例如为所有包装函数添加特定前缀。为每个函数单独执行此操作是不切实际的，因此如果未指定要重命名的标识符的名称，SWIG 支持将重命名规则应用于所有声明：
> 
> ```
> %rename("myprefix_%s") ""; // print -> myprefix_print 
> ```
> 
> 这也表明 %rename 的参数不必是文字字符串，也可以是类似 printf() 的格式字符串。在最简单的形式中，“%s”被替换为原始声明的名称，如上所示。然而，这并不总是足够的，SWIG 提供了对常用格式字符串语法的扩展，以允许将（SWIG 定义的）函数应用于参数。例如，要将所有 C 函数 do_something_long() 包装为更像 Java 的 doSomethingLong() ，您可以使用“lowercamelcase”扩展格式说明符，如下所示：
> 
> ```
> %rename("%(lowercamelcase)s") ""; // foo_bar -> fooBar; FooBar -> fooBar 
> ```
> 
> 一些函数可以参数化，例如“strip”从它的参数中去除提供的前缀。前缀被指定为格式字符串的一部分，紧跟在函数名后面的冒号后面：
> 
> ```
> %rename("%(strip:[wx])s") ""; // wxHello -> Hello; FooBar -> FooBar 
> ```

我的建议是保持原样。您正在调用 C++ 函数，它们具有 C++ 名称。如果有的话，这可以帮助您记住您正在调用 C++ 并且需要遵循 C++ 规则进行对象生命周期管理，还有轻微的 JNI 性能损失等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:27:13.280

你知道你不应该用正则表达式解析 HTML 吗？是的，也不要用正则表达式编写编译器级逻辑。所以不是（2）。

不要重写他们的界面。他们的代码需要它以及您可能使用的其他中间库。不是（1）。

如果您想将丑陋的代码排除在代码之外，请编写一个包装器接口。这样，在向他们发送一封礼貌的信之后，或者换成由更严格遵守约定的开发人员制作的库之后，您就可以灵活地进行迁移。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T09:20:54.107

在尝试集成 FreeLing JNI API 时，我遇到了同样的命名约定危机，然后我意识到这个 API 让我在项目的编译周期中遇到困难，而且性能方面远非最佳（因为它在内部重新创建所有对象你提交的每一句话）。我建议您切换到捆绑包中的分析器服务器：[客户端/服务器模式文档](http://nlp.lsi.upc.edu/freeling/doc/userman/html/node84.html)

您可以重新创建他们在 PHP 示例和*Analyzer.cc*中实现的内容。

# google-app-engine - 使用 GWT openlayers MapWidget 时出错

> ID：10790796
> 
> 赞同：1
> 
> 时间：2012-05-28T21:53:50.093
> 
> 标签：google-app-engine, gwt, maps, openlayers, gwt-openlayers

我正在尝试使用 GAE 和 GWT openlayers 库创建一个带有地图的网站。我试图通过在 SiteNameWidget.ui.xml 文件中使用 MapWidget 来实现它，但我收到以下错误。

我已经设法通过使用 RootPanel.get().add(MapWidget) 方法使其工作，但我希望能够使用 XML 文件方法，因为以这种方式操作布局似乎更容易。

任何人？

> org.gwtopenmaps.openlayers.client.MapWidget 没有默认（零参数）构造函数。要解决此问题，您可以在 UiBinder 的所有者上定义 @UiFactory 方法，或者使用 @UiConstructor 注释 MapWidget 的构造函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T18:47:23.023

这意味着，因为 MapWidget 只能使用参数进行实例化，所以您不能只在视图中将其声明为 @UiField 并依靠 GWT 使用默认构造函数对其进行实例化。

相反，您必须提供一个构造函数（如果您正在专门处理一个小部件）或一个工厂方法，它们将被调用以适当地实例化您的 MapWidget（在这种情况下使用 MapOptions 作为参数）。

例如，添加：

```
@UiFactory MapWidget createMapWidget() {  // The method name is irrelevant
   MapOptions opts = MapOptions.newInstance();
   options.setScrollWheel(false);         // Some sample customization. You may use fields initialized in your actual view constructor (which is called before) to do so.
   return new MapWidget(opts);
} 
```

请参阅[http://developers.google.com/web-toolkit/doc/latest/DevGuideUiBinder?#Using_a_widget](http://developers.google.com/web-toolkit/doc/latest/DevGuideUiBinder?#Using_a_widget)

# ios - 使用 iOS SDK 获取 Facebook 好友对某些好友返回 null

> ID：10790797
> 
> 赞同：1
> 
> 时间：2012-05-28T21:54:02.890
> 
> 标签：ios, facebook-graph-api

我正在使用此代码来获取朋友的生日：

```
- (void)apiGraphFriendsWithBirthdays {
[self showActivityIndicator];

HackbookAppDelegate *delegate = (HackbookAppDelegate *)[[UIApplication sharedApplication] delegate];
NSMutableDictionary * params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
 @"picture,id,name,link,birthday,gender,last_name,first_name",@"fields",
 nil];

[[delegate facebook] requestWithGraphPath:@"me/friends" andParams:params andHttpMethod:@"GET" andDelegate:self]; 
```

}

然后我正在打印以记录我获取的一些内容：

```
 NSMutableArray *friends = [[NSMutableArray alloc] initWithCapacity:1];
        NSArray *resultData = [result objectForKey:@"data"];
        if ([resultData count] > 0) {
            for (NSUInteger i=0; i<[resultData count] && i < 25; i++) {
                [friends addObject:[resultData objectAtIndex:i]];

                NSDictionary *friend = [resultData objectAtIndex:i];
                long long fbid = [[friend objectForKey:@"id"]longLongValue];
                NSString *name = [friend objectForKey:@"name"];
                NSString *birthday = [[friend objectForKey:@"birthday"] description];
                NSLog(@"id: %lld - Name: %@ - Birthday: %@", fbid, name,birthday);

            }

        } else {
            [self showMessage:@"You have no friends."];
        }
        [friends release]; 
```

出于某种原因，我的一些朋友的生日是空的，尽管我可以在 Facebook 上看到他们的生日。

这是我的代码上的东西还是某种特定的用户隐私设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-07T16:25:33.293

您需要申请权限才能查看“friends_birthday”

[脸书权限](https://developers.facebook.com/docs/facebook-login/permissions)

# blackberry - SDK 5.0 及更高版本中的标准和 GPS

> ID：10790798
> 
> 赞同：1
> 
> 时间：2012-05-28T21:54:31.127
> 
> 标签：blackberry

我目前正在开发一个 BB 应用程序，我需要获得我目前的职位。

在带有 v5.0 的 BB 模型中没问题，但在带有 v6.0 的 BB 中，我总是将 locationProvider 设为空。（GPS 已打开）。

任何人都知道会发生什么以及如何解决它？

我使用的一段代码是：

```
private boolean startLocationUpdate() {
    boolean retval = false;

    try {
        Criteria criteria = new Criteria();
        criteria.setCostAllowed(true);
        criteria.setHorizontalAccuracy(Criteria.NO_REQUIREMENT);

        criteria.setVerticalAccuracy(Criteria.NO_REQUIREMENT);
        criteria.setPreferredPowerConsumption(Criteria.POWER_USAGE_LOW);

        locationProvider = LocationProvider.getInstance(criteria);

        if (locationProvider == null) {

            Runnable showGpsUnsupportedDialog = new Runnable() {
                public void run() {

                    Dialog.alert("GPS is not supported on this platform...");
                    // System.exit( 1 );
                }
            };

            UiApplication.getUiApplication().invokeAndWait(
                    showGpsUnsupportedDialog); // Ask event-dispatcher
                                                // thread to display dialog
                                                // ASAP.
        } else {

            locationProvider.setLocationListener(
                    new LocationListenerImpl(), interval, 1, 1);

            retval = true;
        }
    } catch (LocationException le) {
        System.err
                .println("Failed to instantiate the LocationProvider object, exiting...");
        System.err.println(le);
        System.exit(0);
    }
    return retval;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:59:05.560

根据[Criteria](http://www.blackberry.com/developers/docs/5.0.0api/javax/microedition/location/Criteria.html)的 API 文档，您正在请求 Cellsite 模式。[LocationProvider.getInstance()](http://www.blackberry.com/developers/docs/5.0.0api/javax/microedition/location/LocationProvider.html#getInstance%28javax.microedition.location.Criteria%29)的文档指定：

```
a LocationProvider meeting the defined criteria or null if a LocationProvider that meets the defined criteria can't be returned but there are other supported available or temporarily unavailable providers that do not meet the criteria. 
```

因此 API 告诉您不支持 Cellsite，但还有其他支持的模式可用。如果您想使用 GPS，您需要指定一个要求自主模式的标准。

# ruby-on-rails - 运行“git push heroku master”后找不到RubyGem railties

> ID：10790809
> 
> 赞同：0
> 
> 时间：2012-05-28T21:56:19.440
> 
> 标签：ruby-on-rails, ruby-on-rails-3, git, heroku, aptana3

所以这是我的情况，很奇怪。使用 Aptana（通过 ruby​​installer 安装 rails）我使用以下 GemFile 将我的应用程序推送到 heroku stack cedar：

```
source 'http://rubygems.org'
gem 'rails', '3.2.3'
#Added Web Design Framework
gem 'bootstrap-sass', '2.0.0'

group :development, :test do
gem 'sqlite3', '1.3.5'
gem 'rspec-rails', '2.10.0'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
gem 'sass-rails',   '3.2.4'
gem 'coffee-rails', '3.2.2'
gem 'uglifier', '1.2.3'
end

gem 'jquery-rails', '2.0.0'
group :test do
gem 'capybara', '1.1.2'
end

group :production do
gem 'pg', '0.12.2'
end 
```

我曾尝试将源从 https 更改为 http，但关键是在此推送和以下错误之后，rails 字面上消失了！rails -v 命令导致无法加载 ruby​​gem!Ruby 的错误，但 rails -v 不再工作。任何帮助将不胜感激，伙计们！

```
-----> Heroku receiving push
-----> Ruby/Rails app detected
-----> Installing dependencies using Bundler version 1.2.0.pre
   Running: bundle install --without development:test --path vendor/bundle --binstubs bin/
   Fetching gem metadata from http://rubygems.org/........
   Bundler could not find compatible versions for gem "railties":
   In Gemfile:
   rails (= 3.2.3) ruby depends on
   railties (= 3.2.3) ruby
   jquery-rails (= 2.0.0) ruby depends on
   railties (3.2.4.rc1)

 !
 !     Failed to install gems via Bundler.
 !
 !     Heroku push rejected, failed to compile Ruby/rails app 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T07:58:44.607

看起来它基本上是一个依赖冲突。`jquery-rails`需要`railties`比所需版本更新的版本`rails`。

要解决它（至少我可以在本地测试应用程序中解决它），只需将所需的版本`jquery-rails`从 2.0.0 升级到 2.0.2。`rails`或者，我怀疑您可以升级到 3.2.4 或 .5。

一般而言，gems 应与`~>`而不是`=`，即

```
gem "jquery-rails", "~> 2.0.0" 
```

而不是

```
gem "jquery-rails", "2.0.0" 
```

通过这种方式，Bundler 可以使用 gem 版本 2.0.X 而不仅仅是 2.0.0，从而为 Bundler 提供了更大的余地来寻找适用于应用程序的依赖关系树。而且它不会使您的应用程序依赖项更加脆弱，因为实际的工作版本将被锁定，`Gemfile.lock`并且仅在您需要时才更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:48:06.133

I would try and deploy again, could have been a bad connection to rubygems.

# multithreading - Groovy 并发

> ID：10790813
> 
> 赞同：3
> 
> 时间：2012-05-28T21:57:08.070
> 
> 标签：multithreading, groovy

我对 Groovy 线程有疑问。

我的任务是以某种方式翻译给定目录中的每个文件，并将结果输出放在另一个目录中的文件中。

我编写了以下代码，该代码有效：

```
static def translateDir(fromDir, targetDir) {
    def allFiles = new File(fromDir).listFiles()
    def numFiles = allFiles.length

    for (i in 0..(numFiles - 1))
        translate(allFiles[i].getAbsolutePath(), targetDir)
} 
```

现在，我尝试像这样并行化这段代码：

```
static def translateDir(fromDir, targetDir) {
    def allFiles = new File(fromDir).listFiles()
    def numFiles = allFiles.length
    def numCores = Runtime.getRuntime().availableProcessors()

    for (i in 0..(numCores - 1)) {
        println("Thread " + i + "starting")
        Thread.start {
            for (def j = i; j < numFiles; j += numCores) {
                println("j = " + j) 
                translate(allFiles[j].getAbsolutePath(), targetDir)
            }
        }
    }
} 
```

这不起作用并提供输出：

```
Thread 0 starting
Thread 1 starting
Thread 2 starting
Thread 3 starting 
```

在我的测试用例中，nunCores 是 4，numFiles 是 3。这里发生了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-28T22:13:47.630

您正在启动线程，但是您的程序在它们运行之前完成。

如[文档](http://groovy.codehaus.org/Concurrency+with+Groovy)中所示，您需要调用`join`线程以等待它们完成

使用执行器框架可能更容易，该框架在同一页面的下方显示

* * *

### 编辑

只是为了好玩，我使用`Thread.start`它实现了一些你想要实现的东西

```
// This will perform the task required for a list of files
def translate( List files ) {
  files.each {
    // We will just print it out, and sleep for a bit
    println it
    Thread.sleep( 300 )
  }
}

// makeWorker returns a closure that will process the files
def makeWorker( List files ) {
  { -> translate( files ) }
}

// Main processing function
void process( List files ) {
  int numCores = Runtime.getRuntime().availableProcessors()
  // Split the files to process into groups (one for each worker)
  def partitioned = (0..<numCores).collect { i ->
    files[ (i..<files.size()).step( numCores ) ]
  }
  // Then create a Thread for each group
  def threads = partitioned.collect { group ->
    Thread.start makeWorker( group )
  }
  // And wait for them all to finish
  threads*.join()
}

// Simulate the process with the letters a through z
process( 'a'..'z' ) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-28T22:12:14.530

好的，有两件事：

1.  在线程的隐式 run() 方法中，您正在引用“i”变量。我必须通过调试器逐步了解会发生什么，但从技术上讲，你甚至不应该在那里访问“i”，因为它不是最终的。因此，我建议创建一个 Runnable 对象，在构造函数中将“i”传递给该对象。然后在线程上启动runnable。

2.  Groovy 有很好的并发支持——没有理由像这样滚动你自己的。看看[GPar](http://gpars.github.io/)

# php - 如何分隔字符串，以便第一个单词在一个变量中，最后一个单词在另一个变量中？

> ID：10790821
> 
> 赞同：0
> 
> 时间：2012-05-28T21:58:32.790
> 
> 标签：php

我有一个看起来像这样的字符串：`This is a sample string`

我想分离刺痛，以便第一个词在一个变量中，最后一个词在另一个变量中。所以：

```
$beginning = "This is a sample"
$lasword = "string" 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T22:02:34.257

有几种方法可以做到这一点。一种简单的方法（虽然不一定是最有效的）是通过分割空格来创建一个数组，删除最后一个，然后通过[`explode()`](http://us3.php.net/manual/en/function.explode.php), [`array_pop()`](http://us3.php.net/manual/en/function.array-pop.php),将其余部分重新组合成一个字符串[`implode()`](http://us3.php.net/manual/en/function.implode.php)

```
// All words into an array
$words = explode(" ", "This is a string");
// Remove the last one into $last
$last = array_pop($words);
// And stick the first words back together into a string
$rest = implode(" ", $words);
echo $rest;
echo $last; 
```

使用一堆子字符串操作`strrpos()`来查找空间的最后一次出现`substr()`或`str_split()`将其切碎可能更有效，但老实说，除非性能确实是一个问题，否则我更有可能使用这种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:02:32.313

我对php一无所知，但在其他语言中我们使用子字符串函数。

[这](http://php.net/manual/en/function.substr.php)是关于 substring 函数的 php 参考链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T22:06:39.057

好吧，您可以拆分字符串然后访问它们

$mystring = explode(" ", "这是一个示例字符串");

然后访问它们

echo $mystring[0] //这个

要获得最后一个单词，您需要首先获取 $mystring $len = strlen($mystring); 的长度

回声 $mystring[$len]; //细绳

# ios - IOS 中 Cordovas 的 ChildBrowser 在查看 PDF 文件时不显示“打开方式”附加内容

> ID：10790825
> 
> 赞同：0
> 
> 时间：2012-05-28T21:59:00.450
> 
> 标签：ios, pdf, cordova, phonegap-plugins, childbrowser

ChildBrowser PhoneGap 插件在我们的主应用程序之上使用 WebView 来显示外部 url。有许多关于通过 ChildBrowser 显示本地 PDF 文件的帖子。因此我可以通过 ChildBrowser 查看本地 PDF 文件。到现在为止还挺好。

我的问题是，我注意到在 Safari 中查看 PDF 时，它有一个“点击事件”，显示“打开方式”功能，使用户能够以另一种方式与 PDF 文件进行交互。如果 ChildBrowser 是 WebView，如何启用此功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T09:10:40.463

我已经通过编写一些本机代码解决了这个问题。在 ChildBrowser.xib 文件中添加了一个新按钮和一些自定义实现。

# sqlite - SQLiteMetro Windows8 数据库不存储数据

> ID：10790826
> 
> 赞同：0
> 
> 时间：2012-05-28T21:59:10.723
> 
> 标签：sqlite, windows-8

我有两个问题。

1.  如何让 SQLite Db 存储数据？数据库已创建，我可以在其 FilePath 位置找到数据库，但我从未看到任何数据。

2.  如何更改位置以将数据保存在本地文件夹中，而不是用户... appdata 文件夹中？

这是我的代码：

```
 Database db = new Database(Path.Combine(Windows.Storage.ApplicationData.Current.LocalFolder.Path,"alpha2.db"));
  //   Database db = new Database("c:\\Projects\\alpha2.db");

        Statement stm;
        stm = db.PrepareStatement("CREATE TABLE IF NOT EXISTS person(id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, age INTEGER, data BLOB)");
        stm.Execute();
        stm.Dispose();

        stm=db.PrepareStatement("INSERT INTO person(name,age VALUES(?,?)");
        stm.BindParamText(1,"John Doe");
        stm.BindParamInt(2,35);

        stm.Execute();
        stm.Dispose();

        long insertRowId = db.LastInsertRowId;

        stm=db.PrepareStatement("SELECT * FROM person");
            while(stm.GetNextRow())
            {
                int id=stm.GetIntAt(0);
                string name=stm.GetTextAt(1);
                textBlock1.Text=name.ToString();

            }

        stm.Dispose();
        db.Dispose(); 
```

TIA，这已经是两天的头疼了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:16:13.400

插入查询的语法看起来错误。应该更像...

```
INSERT INTO person(name,age) VALUES(?,?) 
```

（在年龄之后添加了一个近括号。）

您不能从 Metro Style 应用程序写入用户驱动器上的任意位置。LocalFolder 是您最好的选择。

编辑评论：查看[Tim](http://timheuer.com/blog/archive/2012/05/20/using-sqlite-in-metro-style-app.aspx)关于 Sqlite 的文章，了解本地文件夹的语法。

# glsl - 使用 GLSL 着色器从图像生成高度图

> ID：10790827
> 
> 赞同：2
> 
> 时间：2012-05-28T21:59:13.517
> 
> 标签：glsl, shader, webgl, heightmap

最近我一直在玩 webGl，我在这里偶然发现了一个很酷的小演示**[（](http://codeflow.org/entries/2011/nov/10/webgl-gpu-landscaping-and-erosion/)**来源**[在这里](https://github.com/pyalot/craftscape)**），我想稍微改变一下以获得一些很酷的结果。

我对改变地形的生成方式很感兴趣。而不是分层 10 个八度的单纯形噪声（位于 simplex3d.shader 中）：

```
float h = 0.0;
for(int i=0; i<10; i++){
        float factor = pow(2.0, float(i));
        h += snoise(vec3(uv*factor, delta*float(i+1)))/(pow(factor, 0.88)*10.0);
} 
```

我希望能够将自定义的黑白高度图图像加载到场景中并从中生成地形。我对 GLSL 还很陌生，在网上找到合适的资源并从这里开始时遇到了麻烦。

任何帮助将不胜感激！

**编辑：**

```
vertex:
    attribute vec2 position;
    void main(){
        gl_Position = vec4(position, 0.0, 1.0);
    }

fragment:
    uniform vec2 viewport;
    uniform sampler2D u_heightmap;

    void main(){
    float scale = 0.5;
    float bias = 0.25;
    vec2 texCoord;

    // Get the height value and calculate the new texture coord.
    float h = scale * texture2D(u_heightmap, texCoord).r - bias;
    vec2 newTexCoord = h * viewport + texCoord;

    vec4 texColor = texture2D(u_heightmap, newTexCoord);

    gl_FragColor = texColor;
    } 
```

**编辑2：**

```
vertex:
    attribute vec2 position;
    void main(){
        gl_Position = vec4(position, 0.0, 1.0);
    }

fragment:
    uniform sampler2D heightmap;
    uniform vec2 viewport;

    void main(){
    float scale = 1.0;
    float bias = 0.25;
    vec2 uv = gl_FragCoord.xy/viewport;

    float h = 0.0;

    h = scale * ((texture2D(heightmap, uv).r) - bias);
    clamp(h, 0.0, 1.0);
    gl_FragColor = vec4(0.0, h, 0.0, 1.0);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T05:04:22.053

似乎您只需使用高度图加载纹理并将上面的代码更改为

```
uniform float u_heightRange;
uniform sampler2D u_heightMap;

attribute vec2 a_texCoords;

...
float h = texture2D(u_heightMap, a_texCoords).r * u_heightRange;
... 
```

还是我误解了你的问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:07:21.277

我的 hightmap **MESH**是使用非常简单的算法从图像生成的，天真的方法是生成一个具有相同数量的顶点的平面，然后使用强度分量在边界的最小和最大 y 值之间进行插值图像，我不太确定您认为着色语言与此有什么关系。

你的意思是你想要一个来自hightmap的法线贴图？

# jquery - 根据浏览器速度优化 jQuery.fx.interval

> ID：10790830
> 
> 赞同：1
> 
> 时间：2012-05-28T21:59:28.977
> 
> 标签：jquery, performance

我注意到我网站的 jQuery 动画在 Chrome 与 IE7、台式机与旧笔记本电脑、处理器速度等方面的显着差异。我正在玩弄使用 jQuery 的区间函数：

```
jQuery.fx.interval = 20; 
```

是否可以根据用户浏览器和计算机的性能**动态设置最佳间隔？**

如果无法适应实际性能，那么仅针对 <= IE7 等较旧的浏览器减慢间隔是否是一个很好的下一个最佳解决方案？

# c++ - 将正则表达式添加到 C++ 审查系统中

> ID：10790833
> 
> 赞同：0
> 
> 时间：2012-05-28T21:59:44.727
> 
> 标签：c++, trinitycore

一段时间以来，我一直在尝试为 WoW 模拟器创建一个名为 TrinityCore 的审查系统。我基本上做的是用“坏词”填充一个数据库表（chat_filter），在启动时用这些填充一个向量，在玩家制作的每条聊天线上，它都会根据我的向量的内容进行检查。如果它包含一个坏词，它会被*** * 替换（而 * 的数量也将从数据库表 (todo) 的列中获取）并且玩家会受到惩罚（静音左右）。

现在我遇到的问题是如何制作合适的过滤器。现在你必须添加你能想到的所有可能的单词组合，例如“ass”也应该读作“ass”，我不知道该怎么做！

这是当前代码的重要部分，我省略了数据库拉动，因为它无论如何都没有任何用处（而且它在不同的文件中会使其不太清楚）。

```
char* msg3 = strdup(msg.c_str());
char* words = strtok(msg3, " ,.-()&^%$#@!{}'<>/?|\\=+-_1234567890"); // This splits the sentence in seperated words and removes the symbols
ObjectMgr::ChatFilterContainer const& censoredWords = sObjectMgr->GetCensoredWords();

while (words != NULL && !censoredWords.empty())
{
    for (uint32 i = 0; i < censoredWords.size(); ++i)
    {  
        if (!stricmp(censoredWords[i].c_str(), words))
        {
            sLog->outString("%s", words);
            //msg.replace(msg.begin(), msg.end(), msg.c_str(), "***");
            msg.replace(msg.begin(), msg.end(), censoredWords[i].c_str(), '*');
        }
        //msg.replace(msg.begin(), msg.end(), censoredWords[i].c_str(), /*replacement*/ "***");
        //msg.replace(msg.find(censoredWords[i].c_str()), censoredWords.size(), 
    }

    words = strtok(NULL, " ,.-()&^%$#@!{}'<>/?|\=+-_1234567890");
} 
```

提前致谢，

碧玉

PS 'GetCensoredWords' 返回向量。

PSS 'msg' 是一个 std::string - 它是玩家发送的实际消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T23:15:57.047

我不会使用`std::string`，`char*`所以内存管理是全自动的。这将解决您的示例代码中的内存泄漏问题。Boost.Algorithm 提供了一个[`boost::algorithm::split`](http://www.boost.org/doc/libs/1_49_0/doc/html/string_algo/usage.html#id3184031)比`strtok`.

存储被审查词的所有可能排列是不可行的，特别是如果您要为每个输入循环遍历整个词集。如果要审查“fubar”，则必须存储“Fubar”、“FUbar”和“FuBaR”、“fub4r”、“FUBAR”和“fubar”等。

取而代之的是，您可以将每个被审查的词只存储一次，以规范化的形式，例如“fubar”，然后将输入的每个词转换为规范化的形式。因此，如果用户输入“FuBaR”，您将其规范化为“fubar”，那么您可以对一组审查词进行简单查找（可以使用关联容器，因此查找为 O(log n) 甚至 O(1) )

# c# - 如何访问对象中字典中的值？

> ID：10790840
> 
> 赞同：1
> 
> 时间：2012-05-28T22:00:20.277
> 
> 标签：c#, javascript, object, dictionary

好吧，我不确定我问的问题是否正确，但这里是。我正在使用[Javascript .NET](http://javascriptdotnet.codeplex.com/)来解析 Javascript 对象数组。我的代码看起来像这样：

```
object packlist;
using (var context = new JavascriptContext())
{
    context.Run(@"function packlist() { this.packs = new Array(); }
                var packlist = new packlist();
                packlist.packs[0] = { item1:""something"", item2:""something2"", item3:""something3"" };
                packlist.packs[1] = { item1:""something"", item2:""something2"", item3:""something3"" };
                packlist.packs[2] = { item1:""something"", item2:""something2"", item3:""something3"" };");
    packlist = context.GetParameter("packlist");
} 
```

调试时，Locals 窗口显示对象看起来像[**这样**](https://i.stack.imgur.com/bOHR6.png) ![这](../Images/24b08a4f919f5ed0e96a4dc0b98796b5.png) 我的问题是我将如何访问`item1`from `packlist.packs[0]`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T22:22:07.703

您的 packlist 变量是具有单个键的字典，其值是对象数组，并且该数组中的每个条目也是字典。所以获得价值会是这样的。

```
Dictionary<string,object> dicPacklist =(Dictionary<string,object>) packlist;
object[] packs = (object[])dicPacklist["packs"];
Dictionary<string,object> dicPackOne = (Dictionary<string,object>)packs[0];
object item1Value = dicPackOne["item1"]; //"something" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T22:08:12.553

一般结构如下：

```
PackList => Dictionary of <string, Dictionary<string,object>[]> 
```

这意味着它是一个字典，其中每个值都是一个字典。

应该

```
object[] arr = packlist["packs"] as object[]; 
Dictionary<string, object> dictPack = arr[0] as Dictionary<string, object>;
object item1 = dictPack["item1"]; 
```

或者

```
object packs;
if (packlist.TryGetValue("packs",out packs)) { 
     object[] arr = packs as object[]; 
     Dictionary<string, object> dictPack = arr[0] as Dictionary<string, object>;
     object item1 = dictPack["item1"];
} 
```

它们之间的区别在于，首先，假设键存在于字典中，否则会引发异常。第二，它会尝试获取值并告诉您密钥是否有效。

要检查一个键是否在字典中，您可以使用：

```
bool exists = packlist.ContainsKey("item1"); 
```

遍历字典中的所有项目

```
foreach KeyPairValue<string,object> kp in packlist
{
    string key =  kp.Key;
    object value = kp.Value;
} 
```

这是字典类的 MSDN 链接

[http://msdn.microsoft.com/fr-fr/library/bb347013.aspx](http://msdn.microsoft.com/fr-fr/library/bb347013.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T22:09:50.623

我认为是这样：

var a = packlist.packs[0]["item1"];

# c++ - 基于 type_info 对象的专业化代码

> ID：10790842
> 
> 赞同：0
> 
> 时间：2012-05-28T22:00:28.773
> 
> 标签：c++, boost, generic-programming, typeinfo

我有一个`type_info`在我的属性映射中定义属性类型的对象。我想运行一段代码（例如从 cin 读取值），使用我的 type_info 对象定义的类型进行参数化。它可能是一些模板函数，即：

```
template<typename T>
void do_something()
{
  T a; cin >> a;
} 
```

然后在代码的其他部分我想调用它：

```
const type_info &type_description = foo.get_type_of_something();
do_some_magic(do_something, type_description); 
```

我正在寻找`do_some_magic`专门`do_something`为`type_descriptor`. 模板函数可以包装成某种结构，没关系。

当然，它只能用于预先定义的有限类型集（因为必须在编译时为每个类型生成特化）。

一种方法是制作一个链`if(type_descriptor==typeid(int)) /*...*/ else if(type_descriptor==...`等，但这不是非常漂亮的解决方案（imo）。

我想知道是否存在更干净的解决方案？或者也许某些库（最好是“boost”）已经实现了这种机制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:02:30.480

**对象在运行时**`type_info`向您提供有关对象的信息。解决问题的唯一方法是将其与运算符的结果与每种目标类型进行比较。**`typeid`**

 **由于您正在寻找*漂亮*的东西，您可以将 a `map`of `type_info`(wrapped, 实际上) 设置为 `(boost|std)::function<>`s。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T23:45:17.347

在编译时知道类型的简单情况是使用函数重载：

RETURN_TYPE_1 do_something_magic ( TYPE_1 ) { ... }

RETURN_TYPE_2 do_something_magic (TYPE_2) { ... }

...

do_something_magic ( foo ); // 按预期工作

只要您在编译时知道它们的类型，就可以将技巧扩展到多个参数。

如果要基于 ONE 参数类型动态分派，为了获得类型信息，您必须使用动态多态性，然后只需使用 RTTI 和 C++ 的原生能力基于第一个类型签名进行分派，上面的代码仍然是好的，前提是您有一个虚拟析构函数（非平凡析构函数）并且每个重载函数的返回类型都相同。

如果你想基于几种参数类型动态地调度，关注点是完全不同的，你必须使用一种称为 Mutimemethod 的技术，它在 Wikipedia 上有很好的解释，boost 提供了一个实现。**

# c# - ViewModel 会降低 Web 应用程序的性能吗

> ID：10790845
> 
> 赞同：5
> 
> 时间：2012-05-28T22:01:15.673
> 
> 标签：c#, asp.net-mvc-3, nhibernate, viewmodel, view-model-pattern

据我所知，使用视图模型可以使 Web 开发。生活更轻松，从某种意义上说，我们可以使用这种方法在本地化字符串中只显示需要的属性。我还在 mvc3 视图模型中使用 jquery 验证等。

现在我很怀疑，因为我的 webapp 遇到了真正的瓶颈。像这样查询所有对象（其中 20 个）

```
 List<Domain.Property> data = session.Query<Domain.Property>().ToList();    
 return PropertyViewModel.FromDomainModel(data); 
```

并且该属性对象列表被发送到我的 ViewModel，其中 FromDomainModel 期望像这样的属性对象列表

```
List<PropertyViewModel> dataVm = new List<PropertyViewModel>();
{
            foreach (Property p in x)
            {
                dataVm.Add(new PropertyViewModel(p));
            }
            return dataVm;
} 
```

现在在我正在使用的同一个班级

```
public PropertyViewModel(Property x)
        {
            Id = x.Id;
            Created = x.Created;
            Title = x.Title;
             ....
            Photo = x.Photos.First();
} 
```

但是使用这种方法将对象集合发送到视图模型，从那里返回相同的视图模型，只需要我需要的几个属性，奇怪的是（至少对我来说）我经历了多个实体负载和持续时间急剧增加。

如果您需要更多信息。请问。

另外，如果您知道更好的解决方案，请分享。

**更新：** 当使用域模型时，我加载了 20 个实体，当使用上述视图模型时，加载了 67 个实体，这大大降低了性能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T06:28:12.017

在域模型和视图模型之间的映射确实会花费额外的时间，但是这个时间会非常小，绝对不会成为任何瓶颈。例如，在 C# 中调用属性设置器是一种非常快速的操作，与数据库调用相比绝对可以忽略不计。

因此，请继续使用视图模型，而不必担心这会以某种方式影响应用程序的性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T08:47:57.223

不同的视图会有不同的视图模型。如果视图不需要大量数据，则不应将其包含在该视图的视图模型中。

还要检查选择 N+1 问题，如果您还没有提高引用实体的检索效率，请考虑在类和集合上设置批量大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T18:11:16.890

由于 ViewModels，您不应该注意到任何瓶颈，而是听起来像是对数据库调用的性能问题，n+1 问题是 ORM 的一个非常常见的性能问题，您应该检查对数据库的调用次数。 [Entity Framework Profiler](http://efprof.com)是一个非常好的 EF 调试器，它会显示对数据库的调用次数，如果性能不好，它会建议你如何改进它。

# actionscript-3 - 如何在闪存数据网格（as3）中设置选定的行

> ID：10790846
> 
> 赞同：0
> 
> 时间：2012-05-28T22:01:15.873
> 
> 标签：actionscript-3, flash, datagrid

我想在 Flash as3 的 DataGrid 中选择当前结果集中的多行。我试着这样做：

```
this.dataGrid.selectedItems = _selectedElements[index]; 
```

where`_selectedElements`是一个数组，其中包含这样收集的结果页面上的 prevoius 选择结果：

```
_selectedElements[index] = this.dataGrid.selectedItems; 
```

**`_selectedElements`具有正确的值（`checked`），我确定问题出在 datagrid 组件上。**

有人知道如何使它工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T18:08:31.360

我首先误解了你的问题，所以我编辑了我的答案。您可以像这样设置选定的行：

myDataGrid.selectedIndices = [3,4,5,6];

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T12:38:49.850

要选择多行，您必须使用行和列在 for 循环中编写编码。通过给计数 eg.rows+1, rows-1 您可以访问行。列也相同。请试试这个，如果您有任何疑问，请告诉我。

# python - 使用json将变量从html传递到python

> ID：10790853
> 
> 赞同：-1
> 
> 时间：2012-05-28T22:02:16.563
> 
> 标签：python, html, django, json

一般来说，我是 html/javascript 和 Python 的新手，并且一直在为一个类开发一个 Django 项目。我应该创建一个 html 页面，允许用户选择要保留的属性，然后将这些变量传递给 python 程序，该程序将从文件中过滤掉相关属性。python工作已经完成，只需要完成html界面即可。我知道这将需要使用 json 将值传递到 .py 中，但一直无法弄清楚如何做到这一点。

我想我的确切问题是：给定一个允许您检查要保留的属性的页面，我如何将所述属性作为变量传递给 python 方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T03:46:21.510

您一直提到“在文件之间传递”，但我认为该术语令人困惑并且可能是错误的。各种组件的源代码的文件类型与您的问题无关。您要关注的是这个过程：

1.  创建一个包含表单的 html 网页，表示您正在使用的数据。
2.  提交表单后，表单内容将发送到您的服务器。
3.  您的服务器是 django，这意味着您的 html 页面是一个模板，这意味着该模板将从 django 视图方法提供。
4.  django view 方法既可以提供新的模板页面（当 request.method 不是“POST”时），也可以接受和处理表单（当 request.method 是“POST”时），并重新显示更新的表单内容。
5.  您的 django 表单将在会话或数据库中保留持久数据。模板的初始视图将显示对象的当前属性值。表单的结果将修改这些值，然后重新显示表单。

这个问题太宽泛了，无法为您提供比这更多的细节。但是，我建议阅读有关如何处理表单和模板的基本 django 教程。你真的只需要一个视图和一个模板文件。

老实说，除非您尝试制作更高级的 API，否则我认为在此过程中的任何地方都不需要 JSON。当您的表单可以提交普通的 www 表单编码格式时，没有理由提交 JSON。只有在编写 API 时才需要 JSON。如果是这种情况，那么您的 html 表单必须首先序列化为 json，然后通过 ajax 请求提交到您的 django 服务器，这将期待传入的 json 请求。

# objective-c - iOS - 具有两个不同图像的 UITableViewCell 子类

> ID：10790859
> 
> 赞同：0
> 
> 时间：2012-05-28T22:03:03.237
> 
> 标签：objective-c, ios, uitableview, subclass

我将 UITableViewCell 子类化为在最左边有一个图像，然后在中间有一些文本，然后在最右边有一些文本。

这个 UITableViewCell 子类将根据条件只有两个图像。我之前在 UITableViewCell 子类中使用图像时所做的事情，我已将它们声明为

```
static UIImage *image = nil; 
```

然后在`+(void)initialize`我分配给他们的方法中。这样做只是为了拥有图像的类实例，而不是用尽资源将这些图像分配给 UITableViewCell 的每个实例。

所以我现在的问题是，根据我的 UIViewController 中调用该`cellForRowAtIndexPath`方法的条件，我应该显示带有 imageA 或 imageB 的 UITableViewCell。所以在伪代码中它看起来像这样

```
if (conditionA) { 
    // Set image of cell to be imageA 
} else { 
    // Set image of cell to be imageB 
} 
```

那么如何使用子类 UITableViewCell 实现这一点呢？我在想一种方法是观察 UITableViewCell 中的一个属性，当该属性发生变化时，我会相应地设置单元格图像，但这对于应该很容易的东西来说似乎有点臃肿？

理想的方法是将它设置在 UITableViewCell 的 init 方法中，但是我将无法重用单元格，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:56:02.667

您不必担心会为每个实例创建冗余图像。该类`UIImage`已经有一个内置缓存，只要您使用`imageNamed:`选择器创建它们，它就不会创建新的图像实例。

从文档中的`imageNamed:`方法`UIImage`，

> 此方法在系统缓存中查找具有指定名称的图像对象，如果存在则返回该对象。如果匹配的图像对象尚未在缓存中，则此方法从指定文件加载图像数据，缓存它，然后返回结果对象。

如果这两个图像是预定义的并且不会更改，那么您可以简化子类单元格的界面。只允许这个子类的用户告诉它应该使用哪种类型的图像。你可以使用一个`enum`。

在 UITableViewCell 的子类标头中，创建枚举。使用适合您用例的任何名称。

```
typedef enum {
  ImageTypeOne,
  ImageTypeTwo
} ImageType;

@property (nonatomic) ImageType imageType; 
```

在实现内部，将生成的设置器覆盖为：

```
- (void)setImageType:(ImageType)newImageType {
    imageType = newImageType;

    if (imageType == ImageTypeOne) {
        theImageView.image = [UIImage imageNamed:@"one"];
    } 
    else if (imageType == ImageTypeOne) {
        theImageView.image = [UIImage imageNamed:@"two"];
    }
    // this will resize the image view to fit the image.
    [theImageView sizeToFit];
} 
```

在您的`cellForRowAtIndexPath:`方法中，只需根据条件设置此属性。

```
if (conditionA) { 
    myCustomCell.imageType = ImageTypeOne;
} else { 
    myCustomCell.imageType = ImageTypeTwo;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:11:13.297

> 理想的方法是将它设置在 UITableViewCell 的 init 方法中，但是我将无法重用单元格，对吗？

这是正确的，但在不远的地方有解决方案。对两个静态图像使用相同的技术，并`imageView`使用特殊方法更新 's 图像，例如`updateMyCellImage`取决于键属性值。

第二步是为该键属性准备这样一个设置器，它会在键属性的值更改后调用此方法。

然后，您只需`cellForRowAtIndexPath`在单元格出列/初始化后设置键属性值，并且`imageView`将为您更新图像，您将能够重用单元格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T22:15:11.113

我不明白使用`static UIImage`. 视图不应该拥有它的数据。

如果这是我，我将`UIImage`在 dataSource 中为每个属性设置一个仅实例化一次的属性，然后我只需通过让 dataSource 告诉它们要显示的内容来正常配置单元格。

看起来你为自己做了更多的工作并引入了一个非常严格的结构

# javascript - eval()'ing 对象时出现语法错误

> ID：10790861
> 
> 赞同：1
> 
> 时间：2012-05-28T22:03:12.633
> 
> 标签：javascript, node.js, object, eval

我正在尝试使用 nodejs 解析这样的对象：

```
{
  1: [a, b, c],
  2: [d, e, f],
  ...
} 
```

具有`a,b,c,d,e,f`定义值的变量。

我真的想要这样，这样对象才能真正可读（并且可以被人写）。

所以，我目前正在做的是打开一个包含前一个对象的文件，将数据放入一个变量`data`中，然后注入

```
var a=1,b=2,c=3,d=4,e=5,f=6,...; 
```

就在真实内容之前：

```
data = "var a=1,b=2,c=3,d=4,e=5,f=6,...;" + data; 
```

最后，我`eval()`用来获取一个可用的对象：

```
my_obj = eval(data); 
```

但是，这不起作用（至少使用 nodejs），`:`在对象的第二个元素之后的标记上出现 SyntaxError （因此`2`在上一个示例中的之后）。

为了解决这个问题，我现在用以下方法包围我的对象：

```
data = "var obj = " + data + "; obj";
data = "var a=1,b=2,c=3,d=4,e=5,f=6,...;" + data; 
```

有了它，它就可以工作了。

问题是`why ?`

可选的问题是：你有更好的方法来完成我想要的吗？

谢谢！

* * *

**eval() 调用之前的真实数据**

`data`带有语法错误：

```
var a='a',b='b',c='c',d='d',e='e',f='f';
{
  a: 
  [a, a, a],

  b:
  [b, b, b]

} 
```

节点错误：

```
undefined:6
  b:
   ^
SyntaxError: Unexpected token : 
```

工作`data`：

```
var a='a',b='b',c='c',d='d',e='e',f='f';
var obj = {
  a: 
  [a, a, a],

  b:
  [b, b, b]

}

; obj; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:40:35.603

当你第一次评估

```
{
 a: 
 [a, a, a],
 b:
 [b, b, b]
} 
```

括号实际上被视为分隔块的块分隔符（如 if () { ... }）

所以你正在尝试执行代码

```
 a: [a, a, a], b: [b, b, b]; 
```

这显然是一个语法错误 => 你得到“SyntaxError: Unexpected token :”

在第二种情况下，评估的代码是有效的 javascript，这就是它起作用的原因。

很难为您提供更好的替代方案。如果您的文件不可信，也许可以使用 JSON.parse 而不是直接评估。

# c# - 将 GridLength 转换为 Double

> ID：10790862
> 
> 赞同：3
> 
> 时间：2012-05-28T22:03:21.770
> 
> 标签：c#, xaml, windows-8, windows-runtime

我有一个名为的 TextBox `addTextBox`，它位于名为`addTextBoxRow`其高度的行内`500*`

每当布局更改时，我想将高度分配给`addTextBoxRow`。`addTextBox`

但是当我尝试使用时`addTextBox.Height = addTextBoxRow.Height`，它给了我一个错误，它无法将类型“Windows.UI.Xaml.GridLength”隐式转换为“double”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T22:07:19.790

[GridLength.Value 属性](http://msdn.microsoft.com/en-us/library/system.windows.gridlength.value)

```
 addTextBox.Height = addTextBoxRow.Height.Value 
```

还要检查`ActualHeight`随着您调整大小而改变的属性`Grid`：

```
 addTextBox.Height = addTextBoxRow.ActualHeight 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:00:17.523

您不需要绑定高度 - 只允许 TextBox 拉伸就足以让它变得与它所在的行一样高 - 请参阅：

```
<Grid
    Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
    <Grid.RowDefinitions>
        <RowDefinition
            Height="100*" />
        <RowDefinition
            Height="500*" />
        <RowDefinition
            Height="100" />
    </Grid.RowDefinitions>
    <TextBox
        Grid.Row="1" />
</Grid> 
```

# facebook - JSF Facebook 身份验证

> ID：10790863
> 
> 赞同：0
> 
> 时间：2012-05-28T22:03:38.637
> 
> 标签：facebook, jsf, authentication

我正在开发一个应用程序，我想让用户使用她的 Facebook 帐户登录。我正在使用 RestFB（restfb.com）。到目前为止，我可以使用下面的代码访问 Facebook 身份验证 API，该代码执行没有问题：

```
try {
 FacesContext.getCurrentInstance().getExternalContext().redirect(FB_URL);
 } catch (IOException e) {
// TODO Auto-generated catch block
e.printStackTrace();
 } 
```

FB_URL 包括我的redirect_url，它在用户身份验证后被正确重定向。身份验证返回一个代码。我想使用返回的代码发送对`ACCESS_TOKEN`. 我认为最好的方法是在返回 URL 中包含一个要执行的方法。只要对 facebook 的请求与代码响应一起返回，就会执行此方法。我还认为这只有在我可以从 URL 执行操作方法的情况下才有可能。我读过一些关于使用过滤器的东西，但还不清楚。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:51:11.183

我找到了一种方法来做到这一点。使用

```
<f:metadata>
    <f:viewParam name="code" value="#{loginBean.fbCode}" />
</f:metadata> 
```

LoginBean 的 setFbCode 被执行。然后，我将此代码合并到用于检索访问令牌的 URL 中，如下所示：

```
if(this.fbCode != "") {
        TOKEN_URL = TOKEN_URL + fbCode + "&access_token=";
        System.out.println("FB Code = " + fbCode);
        try {
                        FacesContext.getCurrentInstance().getExternalContext().redirect(TOKEN_URL);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    } 
```

并检索令牌：

```
URL url = new URL(TOKEN_URL);
String token = IOUtils.toString(url.openStream());
this.fbAccessToken = token; 
```

当然包围在一个 try-catch 块中。它使用 Apache 的 IOUtils 将令牌读入字符串。

# social-networking - 鼠标悬停后加载社交按钮？

> ID：10790868
> 
> 赞同：0
> 
> 时间：2012-05-28T22:04:13.267
> 
> 标签：social-networking, mouseover

这些天我访问了一些流行的博客，我看到他们实际上使用某种 JavaScript 代码或类似的东西`mouseover`会在鼠标通过按钮或悬停它们时加载社交按钮。

像这个例子。

这张图是鼠标悬停之前，

这个是之后

![在此处输入图像描述](../Images/75d9086cce5f66e6d7780e4c23255819.png)

这个是之后

![在此处输入图像描述](../Images/706ef0536c058e5097872e6c2b6ef29b.png)

所以很明显他们使用了某种代码，我想知道如何为我的 Wordpress 网站制作它。这将有助于提高网站性能，Google 会非常喜欢这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:09:04.847

Ajax 就是你要找的我的朋友。

[http://www.w3schools.com/ajax/default.asp](http://www.w3schools.com/ajax/default.asp)

# c++ - 高效函数调用匹配的数据结构

> ID：10790871
> 
> 赞同：4
> 
> 时间：2012-05-28T22:04:28.117
> 
> 标签：c++, algorithm, data-structures, stl-algorithm

我正在构建一个工具，除其他外，它必须衡量我们产品更改对性能相关的影响。

为了做到这一点，我实现了一个分析器，它跟踪函数何时被调用或返回并通知我。首先，我将输出转储到一个文件中，以了解我将使用的数据，这里或多或少是它们的样子：

```
FuncCall1
   FuncCall2
      FuncCall3
      FuncRet3
      FuncCall4
      FuncRet4
      FuncCall5
        FuncCall6
        FuncRet6
      FuncRet5
    FuncRet2
FuncRet1 
```

为了更好地了解这些数据的外观，这里是前 10000 个函数调用的图表：（x 轴：时间，y 轴：深度/嵌套）： [![函数调用/返回图](../Images/561240b3093fa4c275e9cc5d4bf4200e.png)](https://i.stack.imgur.com/LUwy9.gif)（[http://img444.imageshack.us /img444/4710/proflog.gif](http://img444.imageshack.us/img444/4710/proflog.gif) )

当一个函数开始执行时，我将记录它的名称/标识符和当前的高精度时间戳，当它返回时，我需要查找我存储开始时间的条目并添加一个新的时间戳来标记它返回。

总而言之，我将对这些数据执行的操作是：

1.  插入具有当前时间戳的新函数调用标记。
2.  查找某个 ID 的最近一次函数调用并存储返回时间戳。
3.  查看从某个函数中调用了哪些其他函数（并查看它在哪里花费时间） - 例如，如果我在前面的示例中查看 Function#2，我想知道它调用 Function#3、Function# 4、Function#5 和 Function#5 调用 Function#6 然后返回（标记所有调用/返回时间戳）。

现在，我对可能适用于这种情况的数据结构有几个想法：

1.  一个自动平衡树（即 AVL），其中每个节点的键是函数标识符，每个节点中的值是时间戳对的堆栈。这种方法将在标记函数时间戳时为我提供快速插入和查找，并且每个节点都是一个堆栈这一事实，它还将负责将正确的返回时间戳与开始时间戳相匹配 - 始终（我假设）a 的最新返回时间戳某些函数应该匹配最近的嵌套/最近的函数调用。在这种方法中，维护具有不同标识符的嵌套函数调用会有点麻烦，因为我必须遍历树并根据它们的时间戳匹配它们以找出它们的嵌套 - 这并不理想。

2.  维护一个尚未返回的函数列表（这将保留调用堆栈信息）并使用跳过列表，其中每个级别都等于函数调用嵌套级别。这种方法会使操作 #3 更容易，但查找速度会变慢，而且我可能必须维护很长的未返回函数列表 - 例如 main()，这将必须在我的应用程序的整个生命周期中维护。在这里，我还可以使用哈希表，以牺牲更多内存使用来提高查找速度。内存使用很关键——这个分析器很容易生成大约 20 MB / s。

我不使用简单堆栈来跟踪这些数据的原因是，我需要定期将部分结果同步到不同的机器，并且在一切返回之前至少有部分结果可用。

我查看了区间树、范围树和其他我知道的数据结构，但我找不到任何能有效满足我所有 3 个要求的数据结构。

也许有一种数据结构可以满足我不知道的所有需求？有任何想法吗？

## 更新：

那这个呢：

拥有一棵树，其中包含函数调用及其嵌套调用以及未返回的函数的单独堆栈。

现在堆栈上的每个元素都有一个指向它在树中的副本的指针，当一个新的函数调用到达时，我将查看堆栈上的顶部元素，跟踪它指向它在树中的表示的指针，添加新的函数调用作为该调用的子节点，并使用指向新创建的树节点的指针将其副本推送到堆栈上。

对于函数返回，它是类似的，对于每个函数返回，堆栈上的最新条目将始终是它的调用 - 跟踪调用指针，将返回时间保存在树中并弹出调用。

你看到我的想法有什么重大缺陷吗？

## 更新 2：

我的方法效果很好。我将等待 2 天并回答我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:54:15.980

您可以使用跟踪类。缺点：您必须在必须记录/测量的每个函数的开头声明此跟踪器的实例。它还为您的测量增加了大量的周期，因此只能使用这种方法正确跟踪巨大的函数。

实现这一目标的另一种方法是编写一个真正的分析器，但这样的工具已经存在（ gprof ），并为它编写一个解析器。您仍然可以编写自己的...一个非常长的任务。

我建议您在单元测试中分别测试每个功能或组，这是我们通常有效的方式。然后弹出一个分析器并尝试优化你在 90% 的时间内运行的 10% 的代码。你把注意力放在远处的小细节上。

这是我的一个工具的输出：

> 2010 年 7 月 9 日星期五 00:49:12 - [ 3799946229640 ] - D:\Code Project\include/design/BTL/algorithm/dispatch_policy.h::operator() # |...operator() ( ) {
> 
> 2010 年 7 月 9 日星期五 00:49:12 - [ 3799946246830 ] - D:\Code Project\include/design/BTL/algorithm/dispatch_policy.h::operator() # |...shape *, shape *
> 
> 2010 年 7 月 9 日星期五 00:49:12 - [ 3799946265738 ] - D:\Code Project\include/design/BTL/algorithm/dispatch_policy.h::operator() # |...} operator() : 46027 cpu_cycles

正如您在上面所说的，输出量很大，因此对于深度分析来说是不切实际的，由于 20Mb/s 的输出流，您既不能监视程序太长时间。只有当您已经知道在哪里进行调查时，它才有用。由于此类工具所需的理论带宽的另一个问题，您必须使用缓冲的 ostreams ... 使该工具对真实软件更具侵入性。我已经经历了 10 倍的减速！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:37:42.950

从一个线程的角度来看，我认为最有效的是拥有一个严重的侵入性数据结构——你**将**调用堆栈和 AVL-tree 结合起来，如下所示：

```
// one of these per call
struct {
    function *func; // func in the tree (or ID)
    timestamp time; // timestamp of call
    call *prev_call; // previous function call
    call *next_call; // next function call
} call;

// one of these per function
struct {
    call *last_call; // last call of this function
    your_type id; // identifier

    // insert tree-specifics here
} function; 
```

我还没有完全解决这个问题，但我认为这是要走的路。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-29T07:39:00.980

一棵树的想法似乎……很浪费。

您正在做的事情需要一个简单的堆栈。

*   记录 ID/条目时间戳对
*   执行子调用
*   使用退出时间戳修改栈顶条目

此外，所有子调用实际上都是同一父级的子级...

在你的位置，我会简单地使用：

*   用于自动退出时间戳记录的 RAII
*   `deque`用于快速记录追加的类似结构

记录结构如下：

```
struct Record {
    unsigned level;
    unsigned id;
    unsigned entry;
    unsigned exit;
}; 
```

然后，您保留两个线程局部结构：

```
extern thread_local unsigned CurrentLevel;
extern thread_local std::deque<Record> CallRecords; 
```

最后，您实现了一个简单的 RAII 类：

```
class CallRecorder: boost::noncopyable() {
public:
    CallRecord(unsigned id):
        record(*CallRecords.insert(CallRecords.end(),
                                   Record{CurrentLevel++, id, time(), 0}))
    {
    }

    ~CallRecord() { record.exit = time(); --CurrentLevel; }

private:
    Record& record;
}; 
```

您可以潜在地将父 ID 传递给每个子调用，但这似乎不值得。这是您在利用流时可以重建的信息（在旁边保留一个单独的堆栈）。

我只有两个笔记：

*   您可能希望创建自己的实现`deque`来分配更大的块（例如 4K 页面）并真正优化附加。
*   使用 RAII，我们可以处理常规退货和异常情况。只有`abort`不记录，因为程序终止。它可以被检测到，因为它留下了不完整的痕迹。

# javascript - jQuery卸载与之前卸载

> ID：10790873
> 
> 赞同：4
> 
> 时间：2012-05-28T22:05:04.813
> 
> 标签：javascript, jquery

你为什么要使用`$(window).unload(function(){});`over`$(window).bind('beforeunload', function(){});`

像上面那样使用jQuery绑定 beforeunload 和像这样直接分配它有区别吗：`window.onbeforeunload = function() { };`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T09:40:02.073

另请阅读：[http ://www.quirksmode.org/js/events_events.html#link5](http://www.quirksmode.org/js/events_events.html#link5)

jQuery 在使用“直接”方式（和 attachEvent）之前总是会尝试使用 addEventListener。addEventlistener 可以取消冒泡并且可以附加多个回调。

# javascript - 多重赋值 var a = b = b || {} 在 JavaScript 中

> ID：10790876
> 
> 赞同：7
> 
> 时间：2012-05-28T22:05:18.680
> 
> 标签：javascript, variable-assignment

阅读 Leaflet.js 的代码，我遇到了一个我不完全理解的方法：

```
var events = this._leaflet_events = this._leaflet_events || {}; 
```

可以简化为

```
var a = b = b || {}; 
```

据我了解，这条指令是一个多左手赋值，它是右关联的，这意味着首先，JavaScript 将运行

```
b = b || {} //if b exists, returns b, else return an empty object 
```

， 然后

```
a = b // returns the output of the preceding instruction 
```

这对我来说没有意义。为什么不写：

```
a = b || {}; 
```

完整的上下文：

```
addEventListener: function( /*string*/ type, /*function */ fn, /*(optional) object*/ context){
    var events = this._leaflet_events = this._leaflet_events || {};
        events[type] = events[type] || {};
        events[type].push({
        action: fn,
        context: context || this
        });
    return this;
} 
```

我怀疑参考技巧，因为我看不到`this._leaflet_events`该方法如何修改其他方法。

* * *

想一想，无论是否定义，写作`var a = b = b || {}`实际上都是分配`var a`引用的技巧。修改现在修改.`b``b``a``b`

回到传单。和

```
 var events = this._leaflet_events = this._leaflet_events || {}; 
```

`this._leaflet_events`要么存在，要么被初始化为`{}`. 通过引用`events`分配。`this._leaflet_events`引用的值可能是`{}`，但`this._leaflet_events`在修改`events`.

相反，写

```
 var events = this._leaflet_events || {}; 
```

将是一个错误，因为 if`this._leaflet_events`没有定义，`events`现在将指向一个新创建的对象，其值为`{}`. 修改`events`将更改新对象，但不会更改`this._leaflet_events`' 值。

相同的外观值，不同的参考。事情就是这样。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-28T22:07:47.383

该声明`var a = b = b || {};`做*了两*件事：

*   `{}`如果 b 未定义，则将其初始化为。
*   它将 a 设置为与 b 相同。

该表达式`a = b || {};`不修改 b 所以它不等价。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-28T22:10:02.313

较短的表达式不会将任何内容设置为 b 的值

```
a = b = b || {}; //set b's b value to {} if b is uncdefined, then set a's value to b

a = b || {}; //set a's value to b, or {} if b is undefined 
```

第一条语句实际上等价于

```
b = b || {};
a = b; 
```

# android - 切换Activity后如何保持Android Text-to-Speech对象绑定到TTS引擎？

> ID：10790877
> 
> 赞同：2
> 
> 时间：2012-05-28T22:05:31.193
> 
> 标签：android, android-activity, text-to-speech

我的活动中有 TTS 对象。它绑定到语音引擎并准备好说话。然后我开始其他活动（用于结果）。它进行一些用户交互并返回结果。但是当我尝试使用这个 TTS 时，它说

> “[*某些 TTS 方法名称*] 失败：未绑定到 TTS 引擎”

并且没有任何言语。有没有办法“重新连接到引擎”？

如果有人可以帮助我，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:45:36.603

I cannot think of an easy way.

I complicated way to do it would be to use a `Service` which holds the TTS instance.

Or just re-create a new `TextToSpeech` in the result `Activity`. Are you seeing significant slowness if you do this?

# hadoop - 没有 hadoop 但其他 MR 实现的 mahout

> ID：10790878
> 
> 赞同：1
> 
> 时间：2012-05-28T22:06:04.433
> 
> 标签：hadoop, mahout, in-memory

在 Mahout 中用不同的 map-reduce 实现（例如，内存中的 map-reduce 实现）替换 hadoop 是否容易？Mahout 并行 ML 实现是否与 Hadoop 紧密耦合且不可替代？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:22:02.490

（用 Java 命名另一个 MapReduce 实现？）不，它与 Hadoop 紧密相关。但是，Hadoop 可以在本地运行。在内存中不使用磁盘？这听起来甚至不是分布式的，那么为什么要使用 MapReduce？并非所有 Mahout 都使用 Hadoop。这真的是你所追求的吗？

# javascript - 关系优先查询

> ID：10790879
> 
> 赞同：0
> 
> 时间：2012-05-28T22:06:13.933
> 
> 标签：javascript, css, css-selectors

我目前正在为服务器端 JS 编写一个 CSS 选择器引擎（[看看](https://github.com/FB55/CSSselect/)！）。为了打下坚实的基础，我开始使用[Qwery](https://github.com/ded/qwery)（一个现有的选择器引擎）的测试。在那里，我发现[了一些](https://github.com/ded/qwery/blob/master/tests/tests.js#L211-230)“关系优先查询”的测试。显然，CSSselect（我的项目）没有显示预期的行为，但我不确定预期的结果。

我已经搜索了文档，但找不到任何有用的东西。我当前的实现将它们解释如下：

*   `>`相当于`:not(:root)`
*   `~`并且`+`等价于`:not(:first-child)`
*   开头的空格被忽略

Qwery 的解释似乎有所不同，但有什么官方的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:23:59.890

不，您可以查看[http://www.w3.org/TR/CSS21/selector.html](http://www.w3.org/TR/CSS21/selector.html)和[http://www.w3.org/TR/css3-selectors/](http://www.w3.org/TR/css3-selectors/) (CSS3)。

*   `>`≠ `:not(:root)`。`:root`表示文档根目录，因此您的“相等”对于除一个元素之外的每个元素都是正确的。相反，它是[[直接] 子组合子](http://www.w3.org/TR/selectors/#child-combinators)。
*   `~`≠ `:not(:first-child)`≠ `+`。主要是因为`~`和`+`彼此不同，并且等价是传递性的。两者都是兄弟组合子，一个是[通用](http://www.w3.org/TR/selectors/#general-sibling-combinators)的，另一个是[相邻](http://www.w3.org/TR/selectors/#adjacent-sibling-combinators)的。
*   我猜应该忽略空格。它还能代表什么？[后代组合](http://www.w3.org/TR/selectors/#descendant-combinators)器周围需要两个*简单*的选择器。您也可能对[Selectors 的语法](http://www.w3.org/TR/selectors/#w3cselgrammar)感兴趣。

当然，孩子组合器暗示孩子不是文档根，相邻组合器暗示兄弟姐妹不是第一个孩子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T08:30:38.443

这些“关系优先”选择器是非标准扩展，因此没有“官方”定义它们。根据您的描述`> foo`，`+ foo`和`~ foo`似乎分别相当于`* > foo`、`* + foo`和`* ~ foo`。

# javascript - resizeTo() 在 Firefox 中不起作用

> ID：10790880
> 
> 赞同：2
> 
> 时间：2012-05-28T22:06:17.303
> 
> 标签：javascript, jquery, firefox

运行 Firefox 12.0。我刚刚开始编写一个我想在 localhost 上运行的应用程序。我希望它在 (600,400) 窗口中打开它，但由于我将 Firefox 设置为在选项卡中打开所有内容，我想我可以将其添加为书签并右键单击以在新窗口中打开它。

```
$(document).ready(function() {
    window.resizeTo(600,400);
}); 
```

不工作。我正在尝试做的事情可能吗？

谢谢，吉姆

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T22:08:49.717

这是不可能的，除非窗口是通过 javascript 使用打开的`window.open`并且其中只有 1 个选项卡。

> 从 Firefox 7 开始，网站不再可能根据以下规则更改浏览器中窗口的默认大小：
> - 您不能调整不是由 window.open 创建的窗口或选项卡的大小。
> - 当窗口或选项卡位于具有多个选项卡的窗口中时，您无法调整其大小。

[**MDN 文档**](https://developer.mozilla.org/en/DOM/window.resizeTo)

# html - 创建电子邮件捕获登录页面

> ID：10790882
> 
> 赞同：1
> 
> 时间：2012-05-28T22:06:22.743
> 
> 标签：html, email, capture, mailchimp

拥有电子邮件捕获登录页面的最佳方法是什么？我有一个 wordpress 网站，并且想集成一个像 fab.com 这样的电子邮件捕获登陆页面。如果这很重要，客户希望使用 Mailchimp 来维护他们的列表。

我想具体来说，我想知道如何确保在输入字段中输入的姓名和电子邮件将被 Mailchimp 保存。

任何和所有的建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:35:37.390

我不太清楚你的意思，也许你正在寻找一个支持 MailChimp 的时事通讯注册插件？

在这里检查：[http ://wordpress.org/extend/plugins/newsletter-sign-up/](http://wordpress.org/extend/plugins/newsletter-sign-up/)

# php - PHP SPL ArrayIterator v 简单的 foreach

> ID：10790885
> 
> 赞同：5
> 
> 时间：2012-05-28T22:07:06.153
> 
> 标签：php, spl

好的，正如标题所说：在简单的 foreach 循环中使用 ArrayIterator 的主要好处是什么。

我有一个用作容器的对象，它的主要职责是存储对象数组。

有人建议我让我的类实现 IteratorAggregate 并返回一个 ArrayIterator 和我的对象数组：像这样：

```
 public function getIterator()
  {  
    return new ArrayIterator($this->_objs);  
  } 
```

与简单地返回数组然后使用标准 foreach 循环遍历它们相比，我看不到任何好处。

请有人能解释为什么这是个好主意吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-12-15T16:34:54.713

实现的好处`ArrayAccess`很简单：您可以访问整个对象或仅访问一个非常特定的，甚至`private`是数组的属性。

在这个非常简单的示例中，我们使用`Iterator`和`ArrayAccess`来访问名为 的特定属性`$array`。

```
class Foo implements \ArrayAccess, \Iterator
{
    public $pointer = 0;

    private $array = [
        'first value',
        'second value',
        'third value',
    ];

    public function __construct()
    {
        $this->pointer = 0;
    }

    public function current()
    {
        return $this->array[ $this->pointer ];
    }

    public function key()
    {
        return $this->pointer;
    }

    public function next()
    {
        ++$this->pointer;
    }

    public function rewind()
    {
        $this->pointer = 0;
    }

    public function valid()
    {
        return isset( $this->array[ $this->position ] );
    }
} 
```

我们现在可以像遍历每个数组一样遍历它：

```
$foo = new Foo();
foreach ( $foo as $key => $value )
{
    print "Index: {$key} - Value: {$value}".PHP_EOL;
} 
```

正如在前面的示例中所见，我们需要实现所有这些方法只是为了循环并访问已经存在的数据。为了实现`ArrayAccess`允许我们实际**设置**值的 ，我们必须实现另一组方法：

```
ArrayAccess {
    abstract public boolean offsetExists ( mixed $offset )
    abstract public mixed offsetGet ( mixed $offset )
    abstract public void offsetSet ( mixed $offset , mixed $value )
    abstract public void offsetUnset ( mixed $offset )
} 
```

现在我们可以完全不用编写和重复（当前/键/下一个/等）方法集，只需使用`IteratorAggregate`. 这将其总结**为一个单一的强制性方法**：`getIterator()`.

现在我们有一个这样的**类**：

```
class Bar implements \ArrayAccess, \IteratorAggregate
{
    private $array = [];

    public function getIterator()
    {
        return new ArrayIterator( $this->array );
    }
} 
```

`$array`我们拥有对 classes属性的完整数组访问权限。我们可以设置和取消设置值，检查它们是否返回`isset`，可以循环它们等等。更方便。它与**上述所有八种方法完全相同**，只是通过实现`IteratorAggregate`。

最后一点：您可能会多做一步并实施`Traversable`。这个接口非常好，因为它允许您在不明确说明实现开发人员需要使用哪一个的情况下实现其中一个`Iterator`或强制实现。`IteratorAggregate`它只是说明对象必须是可循环的是强制性的。

```
$foo = new IteratorContainerController();
$foo->addDependency( Traversable $bar ); 
```

这意味着 Dependency for`IteratorContainerController()`将始终是一个`Iterator`或已`IteratorAggregate`实现的对象。所以有人可以简单地投入`IteratorAggregate`，或者，如果他/她需要更细粒度的控制或在变量设置之前对变量进行预处理，他/她可以简单地使用`Iterator`.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-29T02:15:40.957

返回一个数组会暴露对象的内部结构。使用迭代器更抽象。

我不知道你的班级是做什么的，或者哪个更适合你的情况。但作为一般经验法则，如果唯一实际的用例是迭代数据，那么您应该返回一个迭代器。

# c# - Asp.Net MVC Ajax 表单未发布到操作

> ID：10790891
> 
> 赞同：2
> 
> 时间：2012-05-28T22:07:58.557
> 
> 标签：c#, asp.net-mvc, asp.net-ajax, ajaxform

我在使用 Ajax 表单时遇到了一些问题。毫无疑问，我可能做得有点倒退。基本上，当我点击表单中的提交按钮时，什么都没有发生。我已经调试过，但它似乎没有发布到 action 方法。它实际上什么也没做。

到目前为止，这是我的代码：

基本上，我使用DetailedBreakdownReportRequest 模型从表单发布信息。由于我的页面显示了初始未过滤结果的列表，因此该模型可以很好地通过。

详细的故障报告操作方法：

```
[HttpPost]
public ActionResult DetailedBreakdownReport(DetailedBreakdownReportRequest reportRequest, FormCollection formVariables)
{
    return View(reportRequest);
} 
```

详细分解报告视图

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Main.Master" Inherits="System.Web.Mvc.ViewPage<MyApp.Data.AdvancedReports.AdvancedReports.DetailedBreakdownReports.DetailedBreakdownReportRequest>" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
    Detailed Breakdown Report
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

<script language="javascript" type="text/javascript" src="<%= ResolveUrl("~/Scripts/jquery-1.4.1.min.js")%>"></script>
<script src="/Scripts/MicrosoftAjax.js" type="text/javascript"></script>
<script src="/Scripts/MicrosoftMvcAjax.js" type="text/javascript"></script>

 <% using (Ajax.BeginForm("DetailedList", "Reports",
        new AjaxOptions
        {
          UpdateTargetId = "panelBreakdownList",
          InsertionMode = InsertionMode.Replace
        },
        new { id = "SearchForm" })) %>
<% { %>

                <div style="position: absolute; top: 0px; height: 30px; right: -12px; margin-top: 8px;
    width: 250px; padding-left: 00px; vertical-align: middle; display: inline-block;">
        <input id="searchField" name="searchField" style="padding-left: 5px; position: relative;
        float: left; top: 3px; margin: 0px; border: 1px solid #DDDDDD; height: 19px;
        width: 200px;" />
        <%: Html.HiddenFor(m => m.ToDate) %>
        <%: Html.HiddenFor(m => m.FromDate) %>
        <%: Html.HiddenFor(m => m.Currency) %>
        <%: Html.HiddenFor(m => m.ReportType) %>
        <!--<input type="image" src="/Content/Images/search-form-submit.png" style="border: 0px;
        height: 27px; position: relative; left: -8px; margin: 0x; float: left;" />-->
        <input type="submit" value="Search" style="border: 0px;
        height: 27px; position: relative; left: -8px; margin: 0x; float: left;" />
    </div>
<% } %>

 <div id="panelBreakdownList" style="position: relative; z-index: 0;">
        <% Html.RenderAction("DetailedList", new { ToDate = Model.ToDate, FromDate = Model.FromDate, Currency = Model.Currency, ReportType = Model.ReportType }); %>
</div>

</asp:Content>

<asp:Content ID="Content4" ContentPlaceHolderID="Header" runat="server">
<h1>Detailed Breakdown Report</h1>
<h2><%: Model.ToDate.ToString("dd-MMM-yyyy") %> to <%: Model.FromDate.ToString("dd-MMM-yyyy")%></h2>
</asp:Content> 
```

这是从上述页面调用的详细列表操作，它是视图：

```
[HttpPost]
public ActionResult DetailedList(DateTime ToDate, DateTime FromDate, string Currency, string ReportType, FormCollection formVariables)
{
    DetailedBreakdownReportRequest reportRequest = new DetailedBreakdownReportRequest()
    {
        ToDate = ToDate,
        FromDate = FromDate,
        Currency = Currency,
        ReportType = ReportType,
        UserId = UserServices.CurrentUserId
    };

    DrilldownReportEngine re = new DrilldownReportEngine();
    DetailedBreakdownReport report = null;

    if (formVariables.HasKeys())
    {
        reportRequest.searchTerm = formVariables["searchField"];
        report = re.GetDetailedBreakdown(reportRequest);
    }
    else
    {
        report = re.GetDetailedBreakdown(reportRequest);
    }

    return PartialView(report);
}

<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<MyApp.Data.AdvancedReports.AdvancedReports.DetailedBreakdownReports.DetailedBreakdownReport>" %>

    <% if (Model.HasData)
       { %>

       <% if (Model.ShopBreakdown != null)
          { %>

          <h2>Shop Breakdown Report</h2>  
          <p>Click on a shop's name to see additional information.</p>
          <div id="shopGrid" style="float:left; width: 400px;">
              <table width="400px">
              <% foreach (var shop in Model.ShopBreakdown)
                 { %>
                <tr>
                    <td colspan="3"><h2><%: Html.ActionLink(shop.Shop.Name + " >>", "ShopDashboard", new { ShopId = shop.Shop.ShopID, Currency = Model.Currency, toDate = Model.ToDate.ToString(), fromDate = Model.FromDate.ToString(), percentageOfSales = shop.RevenuePercentageOfSales })%></h2></td>
                </tr>
                <tr>
                    <td><p class="labels">Units Sold:</p></td>
                    <td><b style="font-size:larger;"><%: shop.UnitsSoldPerShop%></b></td>
                    <td rowspan="2" align="center"><h2><%: String.Format("{0:0.0%}", shop.RevenuePercentageOfSales)%></h2> of Total Revenue</td>
                </tr>
                <tr>
                    <td><p class="labels">Revenue Earned:</p></td>
                    <td><b style="font-size:larger;"><%: String.Format("{0:0.00}", shop.TotalRevenuePerShop)%></b></td>
                </tr>
                <tr>
                    <td colspan="3">&nbsp;</td>
                </tr>
                <% } %>
              </table>
          </div>
       <% } %>

       <% if (Model.ProductBreakdown != null)
          { %>
              <% foreach (var product in Model.ProductBreakdown)
                 { %>
                       <div id="ProductGrid" style="float:left; width: 500px;">
                     <div>
                     <h3><%: Html.ActionLink(product.Product.Name + " >>", "ProductDashboard", new { ProductId = product.Product.ProductID, Currency = Model.Currency, toDate = Model.ToDate.ToString(), fromDate = Model.FromDate.ToString(), percentageOfSales = product.RevenuePercentageOfSales })%></h3>
                     </div>
                     <div style="float:left; width: 200px;">
                            <p class="labels">Units Sold: </p><b style="font-size:larger;"><%: product.TotalUnitsSoldPerProduct %></b>
                            <br />
                            <p class="labels">Revenue Earned: </p><b style="font-size:larger;"><%: String.Format("{0:0.00}", product.OverallTotalRevenuePerProduct)%></b>
                     </div>
                     <div style="float: left; text-align: center;">
                            <h2><%: String.Format("{0:0.0%}", product.RevenuePercentageOfSales)%></h2> of Total Revenue
                     </div>

                </div>

                <% } %>

                <div style="clear:both;" />
                <br />

     <% } %>
    <% } %> 
```

正如我上面所说，在第一次加载时，页面显示正常，它显示了未过滤的结果视图。当我在文本框中输入一个值并单击提交时，什么都没有发生，我发现这很难调试。至少如果它做了什么我会有一些工作。谁能看到我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:25:31.120

正如我所看到的，您希望在 action detailList 中有一些不可为空的变量，这些变量是表单所期望的。

```
[HttpPost]
public ActionResult DetailedList(DateTime ToDate, DateTime FromDate, string Currency, string ReportType, FormCollection formVariables)
{
    ......
} 
```

但是您只需在表单集合中发送搜索字段。ToDate、FromDate、Currency 变量在哪里？

我认为您应该例如创建一个表单模型

```
DetailedListSearchModel
    DateTime ToDate
    DateTime FromDate
    string Currency
    string ReportType
    string Searchfield 
```

并使搜索成为局部视图。只需在使用默认值呈现部分视图时传递默认值，然后在表单中执行。

然后，您将像 [HttpPost] 一样将这些值付诸实践

```
public ActionResult DetailedList(DetailedListSearchModel model)
{
    ......
} 
```

您可以使用此模型，例如

```
<%= Html.LabelFor(m => m.Searchfield) %>
<%= Html.TextBoxFor(m => m.Searchfield, new { @class = "css classes", maxlength = "1000" })%>
<%= Html.ValidationMessageFor(m => m.Searchfield) %>

$(function() {
      $('form#SearchForm').find('a.submit-link').click( function() {
           $('form#SearchForm').trigger('submit');
      }).show();
  } 
```

并将搜索按钮更改为 a。

```
<a href="#" class="submit-link">Search</a> 
```

# ios - ViewController 作为自定义视图的 tableview 的委托

> ID：10790899
> 
> 赞同：0
> 
> 时间：2012-05-28T22:09:05.203
> 
> 标签：ios, model-view-controller, uitableview, uiview, uiviewcontroller

我有一个自定义 UIView，MyView，其中有几个 tableviews - tv1 和 tv2 - 都以编程方式添加。

我有一个自定义的 UIViewController，MyController，它在 loadView 上创建了一个 MyView 的实例。

我的目标如下。myView 应该是 myView.tv1 的数据源和委托，因为它不会触及我的数据模型并且是静态的。

myController 应该是 myView.tv2 的委托，因为它的内容将取决于数据源。

我在每个标题中添加了以下内容：

```
@interface MyController : UIViewController <UITableViewDelegate, UITableViewDataSource>

@interface MyView : UIView <UITableViewDelegate, UITableViewDataSource> 
```

并添加到每个所需的委托方法。

在 MyView 的初始化中，我添加了该表视图，并将第一个的委托设置为 self：

```
tv1 = [[UITableView alloc] initWithFrame:frame1 style:UITableViewStyleGrouped];
tv1.delegate = self;
tv1.datasource = self;

tv2 = [[UITableView alloc] initWithFrame:frame2 style:UITableViewStyleGrouped]; 
```

在我的控制器中，我连接了第二个 tableview：

```
- (void)loadView{
self.view = [[MyView alloc] initWithFrame:myFrame];
[(MyView *)self.view tv2].delegate = self;
[(MyView *)self.view tv2].dataSource = self;
} 
```

当我运行它时，我得到了一大堆运行时错误。有时它抱怨分页控件，有时抱怨 NSCFArray，有时根本没有文本。它总是崩溃。

我已经确定是设置导致问题的数据源，而不是委托。如果我注释掉 laodView 中的数据源行，它运行良好（但当然没有内容）。

什么可能导致我每次都遇到不同的运行时错误，我可能在哪里出错？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:26:31.480

> myView 应该是 myView.tv1 的数据源和委托，因为它不会触及我的数据模型并且是静态的

那不是真正的 MVC，对吧？

如果您为每个表准备单独的组合委托和数据源类，我认为您将能够更快地跟踪问题（或轻松避免它）。数据源`table1`可能是.`MyView`

保留由表所有者保留的委托/数据源引用至关重要，因为表本身不会保留它（这对于将委托/数据源设置`self`为 table1（MyView）和 table2 的情况可能不是那么重要（ MyController），但如果您创建单独的委托和数据源类，则需要牢记这一点）。无论如何，您需要保留`array`您正在使用的数据源。

# jquery - 如何将链接配置为普通链接或 onclick 处理程序？

> ID：10790901
> 
> 赞同：0
> 
> 时间：2012-05-28T22:09:13.943
> 
> 标签：jquery, html

我想为用户提供将链接配置为普通链接或 onclick 事件的选项。在 onclick 事件的情况下，应禁用默认行为。目前我有这个链接：

```
 <a target="_blank" class="arrow" href="javascript:void();" onclick="f(\"value",\"value\");return false;"> 
```

这对于 onclick 事件非常有用。但是当我只需要href时，链接应该如何查看？

这个？：

```
<a target="_blank" class="arrow" href="http://www.xy.com" onclick="return false;"> 
```

或者最好完全删除onclick属性？或者这样更好：

```
 <a target="_blank" class="arrow" href="http://www.xy.com" onclick="javascript:void();"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:11:54.360

不要使用onclick。附加一个点击处理程序，其中一个布尔标志取决于用户的选择。

```
$('#yourLink').on('click', function(){
    //this value depends on the user's choice.
    var doesUserWantHref = true;

    if (doesUserWantHref) {
        //do nothing
        return true;
    } else {
        //you js logic goes here
        return false;
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:14:58.080

您也可以在页面加载后通过执行以下操作来执行此操作...

```
// for just the href
$("#yourLink").attr("href", "http://yourlink.com/").on("click", function() { }); 
```

或者

```
// for just the onclick
$("#yourLink").attr("href", "javascript: void()").on("click", function() { /* useful work */ }); 
```

# ruby-on-rails - 迁移列选项有什么意义？

> ID：10790902
> 
> 赞同：0
> 
> 时间：2012-05-28T22:09:21.163
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我试图理解为什么 Rails 选择在其迁移列选项中包含**:limit**、**:null**、**:default**等。

我的理解是 Rails 反对 DB 约束，而是通过 ActiveRecord 验证（如**validates_presence_of**和各种回调（如**before_save** ）来强制一致性和非空性（以及许多其他）） 。

假设我完全赞同“模型中的一切”理念，我不应该避免使用上述列选项吗？我在这里想念什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:46:13.637

默认值对于在 db 级别设置很有用，否则您将到处都有代码以确保布尔值默认设置为 false 而不是 nil。

# ruby-on-rails - Rails 的基本路由问题

> ID：10790903
> 
> 赞同：1
> 
> 时间：2012-05-28T22:09:29.727
> 
> 标签：ruby-on-rails, ruby

我从 2007 年的一本书中的 Rails 教程中制作了基本博客演示。我意识到它已经过时了，所以我删除了我制作的博客并开始从这里的教程中重做它：http: [//guides.rubyonrails.org/getting_started.html #创建博客应用程序](http://guides.rubyonrails.org/getting_started.html#creating-the-blog-application)

我从头开始，现在我在该链接的说明上停留在 4.3，因为当我输入时，`http://localhost:3000/`我不断得到 Rails 的默认屏幕，而不是“你好，Rails！” 就像我应该说的那样。

4.3的说明是输入

```
rm public/index.html 
```

然后访问 routes.rb 文件以取消注释 root to: 部分，以便它说

```
root :to => "welcome#index" 
```

我继续迁移和所有这些，但我仍然保持默认屏幕。

然后我输入

```
rails server -d 
```

看看这是否有效，但没有。它只是说这仅以第二个 => 结尾：

```
blog ❯ rails server -d
=> Booting WEBrick
=> Rails 3.2.3 application starting in development on http://0.0.0.0:3000 
```

如果我只是输入

```
rails server 
```

我在终端中收到一条错误消息，内容如下：

```
blog ❯ rails server

=> Booting WEBrick

=> Rails 3.2.3 application starting in development on http://0.0.0.0:3000

=> Call with -d to detach

=> Ctrl-C to shutdown server

[2012-05-28 17:42:34] INFO  WEBrick 1.3.1

[2012-05-28 17:42:34] INFO  ruby 1.9.3 (2012-02-16) [x86_64-darwin11.3.0]

[2012-05-28 17:42:34] WARN  TCPServer Error: Address already in use - bind(2)
Exiting

/Users/Nick/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/utils.rb:85:in     `initialize': Address already in use - bind(2) (Errno::EADDRINUSE)
from /Users/Nick/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/utils.rb:85:in `new' 
```

如果有人要我粘贴其余的错误，我会继续这样做。

我不知道该怎么做才能解决这个问题。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T22:13:37.043

> TCPServer 错误：地址已在使用中 - 绑定 (2)

正在发生两件事之一：

1.  您已经有一个 WEBrick 服务器在端口 3000 上的其他地方运行。在启动新服务器之前将其终止。
2.  其他一些进程正在侦听端口 3000

第一次这样做时`rails server -d`，您启动了一个正在占用端口 3000 的后台 WEBrick 服务。找到正在运行的进程并通过以下方式将其杀死：

```
ps aux | grep ruby
kill  [PID from above] 
```

然后重新启动您的 WEBrick，只需`rails server`. 此时，已经删除了 public/index.html，你的路由应该是活跃的并且可以工作的。

# c# - 尝试从 2D 图像准确测量 3D 距离

> ID：10790904
> 
> 赞同：4
> 
> 时间：2012-05-28T22:09:40.670
> 
> 标签：c#, math, graphics, xna, computer-vision

我正在尝试提取 2D 图像中两个已知点之间的 3D 距离（以 mm 为单位）。我正在使用方形 AR 标记来获取相对于场景中标记的相机坐标。这些点是这些标记的角。

**一个例子如下所示：**

![在此处输入图像描述](../Images/83ccf99d65c44adcda9a951493cc0514.png)

代码是用 C# 编写的，我使用的是 XNA。我将 AForge.net 用于 CoPlanar POSIT 我为计算距离而采取的步骤：

**1.**在屏幕上标记角落。角点以 2D 矢量形式表示，图像中心为 (0,0)。上为 Y 方向正，右为 X 方向正。

**2.**使用 AForge.net Co-Planar POSIT 算法得到每个标记的位姿：

```
 float focalLength = 640; //Needed for POSIT
    float halfCornerSize = 50; //Represents 1/2 an edge i.e. 50mm
    AVector[] modelPoints = new AVector3[]
    {
         new AVector3( -halfCornerSize, 0,  halfCornerSize ),
         new AVector3(  halfCornerSize, 0,  halfCornerSize ),
         new AVector3(  halfCornerSize, 0, -halfCornerSize ),
         new AVector3( -halfCornerSize, 0, -halfCornerSize ),
    };
    CoplanarPosit coPosit = new CoplanarPosit(modelPoints, focalLength);
    coPosit.EstimatePose(cornersToEstimate, out marker1Rot, out marker1Trans); 
```

**3**、转换为XNA旋转/平移矩阵（AForge使用OpenGL矩阵形式）：

```
 float yaw, pitch, roll;
    marker1Rot.ExtractYawPitchRoll(out yaw, out pitch, out roll);

    Matrix xnaRot = Matrix.CreateFromYawPitchRoll(-yaw, -pitch, roll);
    Matrix xnaTranslation = Matrix.CreateTranslation(marker1Trans.X, marker1Trans.Y, -marker1Trans.Z);
    Matrix transform = xnaRot * xnaTranslation; 
```

**4.**找到角的 3D 坐标：

```
 //Model corner points
    cornerModel = new Vector3[]
    {
        new Vector3(halfCornerSize,0,-halfCornerSize),
        new Vector3(-halfCornerSize,0,-halfCornerSize),

        new Vector3(halfCornerSize,0,halfCornerSize),
        new Vector3(-halfCornerSize,0,halfCornerSize)
    };

    Matrix markerTransform =  Matrix.CreateTranslation(cornerModel[i].X, cornerModel[i].Y, cornerModel[i].Z);
    cornerPositions3d1[i] = (markerTransform * transform).Translation;

    //DEBUG: project corner onto screen - represented by brown dots
    Vector3 t3 = viewPort.Project(markerTransform.Translation, projectionMatrix, viewMatrix, transform);
    cornersProjected1[i].X = t3.X; cornersProjected1[i].Y = t3.Y; 
```

**5.**查看标记上两个角之间的 3D 距离，这表示 100mm。找到将此 3D 距离转换为 100 毫米所需的比例因子。（我实际上得到了平均比例因子）：

```
 for (int i = 0; i < 4; i++)
    {
        //Distance scale;
        distanceScale1 += (halfCornerSize * 2) / Vector3.Distance(cornerPositions3d1[i], cornerPositions3d1[(i + 1) % 4]);
    }
    distanceScale1 /= 4; 
```

**6.**最后，我找到相关角之间的 3D 距离，并乘以比例因子得到距离（以 mm 为单位）：

```
 for(int i = 0; i < 4; i++)
    {
       distance[i] = Vector3.Distance(cornerPositions3d1[i], cornerPositions3d2[i]) * scalingFactor;
    } 
```

获得的距离从来都不是真正正确的。我使用了砧板，因为它可以让我轻松计算距离应该是多少。上图计算出角 1（红色到紫色）的距离为 147 毫米（预期为 150 毫米）。下图显示 188 毫米（预期 200 毫米）。

![在此处输入图像描述](../Images/76840e76fba9939bc78df6af7f13aca7.png)

同样令人担忧的是，在测量同一标记上共享一条边的标记角之间的距离时，获得的 3D 距离永远不会相同。我注意到的另一件事是棕色点似乎与彩色点不完全匹配。彩色点是用作 CoPlanar 位置输入的坐标。棕色圆点是通过 POSIT 计算的距标记中心的计算位置。

有谁知道这里可能出了什么问题？我正在拔头发试图弄清楚。代码应该很简单，我不认为我的代码有任何明显的错误。我数学不是很好，所以请指出我的基本数学也可能是错误的......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T07:01:00.273

您在问题中使用了许多黑匣子的方法。第二步的焦距是多少？为什么要在步骤 3 中通过 ypr？你如何校准？我建议从头开始，不要使用您不了解的库。

第 1 步：创建相机模型。了解错误，建立预测。如果需要，应用 2d 滤镜来处理镜头失真。这可能很难。

第 2 步：在消除镜头失真后，在 2d 中找到您的标记。确保你知道错误并且你得到了中心。也许超过多个帧。

第 3 步：取消投影到 3d。在 1 和 2 之后，这应该很容易。

第4步： ？？？

第 5 步：利润！（以 3d 测量距离并了解您的错误）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T15:57:50.560

我认为您需要有 3D 照片（一组距离的两张照片），这样您就可以从图像差异中获得视差距离

# algorithm - 向图的所有边添加权重 - 生成树和最短路径的变化

> ID：10790909
> 
> 赞同：7
> 
> 时间：2012-05-28T22:10:02.007
> 
> 标签：algorithm, graph

> (a) 令 T 为加权图 G 的最小生成树。通过向 G 的每条边添加 k 的权重来构造新图 G。T 的边是否形成 G 的最小生成树。证明陈述或举个反例。
> 
> (b) 令 P = {s, . . . , t} 描述加权图 G 的顶点 s 和 t 之间的最短加权路径。通过向 G 的每条边添加 k 的权重来构造新图 G。P 是否描述了 G 中从 s 到 t 的最短路径。证明陈述或举一个反例。

我的解决方案：

a) T 的边仍然形成 G 的最小生成树，因为所有边的权重都增加了相同的数量。

b) P 仍然描述了 G 中从 s 到 t 的最短路径（同理）

有人可以验证答案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T22:17:09.167

尽管我认为 SO 不是您提出问题的最佳地点，但您对问题 B 的回答绝对是错误的。

考虑一个具有 3 个顶点 (A,B,C) 的图，具有以下边：

```
A-B = 1
A-C = 0
C-B = 0 
```

A 和 B 之间的最短加权路径是 ACB。如果将所有权重加 2，则最短路径变为 AB。

（对不起，错过了问题的第一部分，现在已经有了答案。`a`正确但`b`错误的原因是生成树总是包含精确`n-1`的边，而最短加权路径中的边数可能会有所不同.)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-28T22:17:52.953

a) 正确。因为每个 MST 的成本增加了 (n-1)*k。

b) 错误。考虑具有 3 个顶点和边的图：1-2：3 2-3：3 1-3：10 现在从 1 到 3 的最短路径经过 2。现在，如果每条边都加上 10 的成本。现在最短路径直接从 1 到 3。

# javascript - Jquery 文本切换

> ID：10790911
> 
> 赞同：1
> 
> 时间：2012-05-28T22:10:18.477
> 
> 标签：javascript, jquery, html

我正在尝试进行 jquery 文本切换。如果您翻转元素，文本会出现在它旁边，反之亦然，当您离开元素区域时它会消失。

我的代码还不行。另外，我想为不同的链接包含不同的文本。如果有更简单的方法请建议。

**HTML**

```
<div id="container"></div>
<a href="#" id="ovr">clickclickclick</a> 
```

**JS**

```
$("#ovr").mouseenter(function() {
    $(#container).html("wazaap");
  }).mouseleave(function() {
    $(#container).html();
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:14:40.627

您忘记了 jQuery 选择器中的引号：

```
$("#ovr").mouseenter(function() {
    $("#container").html("wazaap");
}).mouseleave(function() {
    $("#container").html("");
}); 
```

# 编辑

如果你想要不同的句子，你可以这样做：

## JS

```
var description=new Array();
description["one"]="Here comes the first";
description["two"]="And here the second";
description["three"]="Now let's have the third";
description["four"]="Finally the last one, fourth";
$("a.link").mouseenter(function(){
    $("span#description").text(description[$(this).attr("id")]);
}).mouseleave(function(){
    $("span#description").text("");
})​ 
```

## HTML

```
<a href="#" class="link" id="one">one</a>
<a href="#" class="link" id="two">two</a>
<a href="#" class="link" id="three">three</a>
<a href="#" class="link" id="four">four</a>

<span id="description"></span>​ 
```

检查在这里工作 [http://jsfiddle.net/Wpe2B/](http://jsfiddle.net/Wpe2B/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:17:31.773

更新

基于 OP 的评论想要使用几个链接来显示文本我试过这个：

[http://jsfiddle.net/cZCRh/4/](http://jsfiddle.net/cZCRh/4/)

它不适用于类，因为所有链接都获得相同的文本

* * *

这工作[http://jsfiddle.net/cZCRh/1/](http://jsfiddle.net/cZCRh/1/)

```
<div id="container"></div>
<a href="#" id="ovr">clickclickclick</a>

$("#ovr").mouseenter(function() {
    $('#container").html("wazaap");
}).mouseleave(function() {
    $("#container").html("");
});
​ 
```

问题是 mouseleave 在错误的位置以及元素 ID 周围缺少引号

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T22:20:19.047

`hover()`试着用函数来做。代码会更干净。

**基本示例：**

**jQuery：**

```
$("#container").hover(
function() {
  $('.cText').text("click");
},
function() {
    $('.cText').text("");
}); 
```

**CSS：**

```
#container {
      position: relative;
      background-color: #EEEEEE;
      width: 100px;
      height: 100px;
      position: relative;
      display: block;
  } 
```

**HTML：**

```
div id="container"></div><span class="cText"></span> 
```

问候

# php - CakePHP 更改身份验证字段不起作用

> ID：10790918
> 
> 赞同：1
> 
> 时间：2012-05-28T22:11:28.497
> 
> 标签：php, cakephp, cakephp-2.0

我目前正在尝试将我的 cakephp 登录名从使用用户名字段更改为使用电子邮件字段。

使用用户名字段时，登录工作正常，这是使用用户名登录的代码：

登录.ctp

```
<?php
echo $this->Form->create('User');
echo $this->Form->input('username');
echo $this->Form->input('password');
echo $this->Form->end(__('Login'));
?> 
```

用户控制器.php

```
public function beforeFilter() {
    parent::beforeFilter();
    $this->Auth->allow('add', 'login'); // Letting users register themselves
    $this->Auth->fields = array('username' => 'username', 'password' => 'password');
}
public function login() {
    if ($this->request->is('post')) {
        if ($this->Auth->login()) {
            $this->Session->setFlash(__('worked'));
        } else {
            debug($this->data);
            $this->Session->setFlash(__('Invalid username or password, try again'));
        }
    }
} 
```

应用控制器

```
public $components = array('Session', 'Auth'); 
```

所以这一切都很好，我可以使用测试详细信息登录。

因此，要将其更改为使用电子邮件，我所做的只是：

*   将 login.ctp 中的输入从用户名更改为电子邮件

    ```
    echo $this->Form->input('email'); 
    ```

*   将用户控制器中的字段数组从用户名更改为电子邮件

    ```
    $this->Auth->fields = array('username' => 'email', 'password' => 'password'); 
    ```

*   将数据库字段从用户名更改为电子邮件

然后我尝试使用相同的测试详细信息登录，它告诉我它们不正确。

有谁知道为什么这不起作用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T22:56:13.990

在 Cake 2.x 中有点不同

```
$this->Auth->authenticate = array(
    'Form' => array(
        'fields' => array('username' => 'email', 'password' => 'password'),
    ),
); 
```

# java - Android - 在应用项目中拥有 Provider 权限

> ID：10790919
> 
> 赞同：17
> 
> 时间：2012-05-28T22:11:44.400
> 
> 标签：java, android, android-contentprovider, android-library, authority

一个 android 库项目包含一些提供者，它们的权限在合约类中定义如下：

```
public static final String CONTENT_AUTHORITY = "my.com.library.providers.tester";
private static final Uri BASE_CONTENT_URI = Uri.parse("content://" + CONTENT_AUTHORITY); 
```

现在有很多应用程序项目使用这个库项目。我目前遇到的问题是，对于每个应用程序项目，我需要在每个应用程序的库项目中都有一个单独的分支，只是为了拥有唯一的内容权限。这会产生一些版本管理问题（例如将功能/错误修复从一个分支传播到每个其他分支等）。相反，我想将定义内容权限的责任委托给应用程序项目。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-29T20:56:33.513

我知道这是一个老话题，但今天遇到了这个问题，我们已经开发了很长一段时间，所以还没有准备好检查我们的内容提供者合同中的所有静态并更改它们，也因为我们的内容提供者和数据库是由生成的Eclipse的[Mechanoid 插件](http://robotoworks.com/mechanoid-plugin/mechanoid-db/)（是的，我也是作者！:)）

我想出的解决方案是向我们生成的合约添加一个静态初始化程序，该合约使用反射来查找一个类，并在其存在时使用静态 CONTENT_AUTHORITY 字段，如果不回退到默认值：

```
public class QuxContract  {
    public static final String CONTENT_AUTHORITY = initAuthority();

    private static String initAuthority() {
        String authority = "com.example.app.data.qux";

        try {

            ClassLoader loader = QuxContract.class.getClassLoader();

            Class<?> clz = loader.loadClass("com.example.app.data.QuxContentProviderAuthority");
            Field declaredField = clz.getDeclaredField("CONTENT_AUTHORITY");

            authority = declaredField.get(null).toString();
        } catch (ClassNotFoundException e) {} 
        catch (NoSuchFieldException e) {} 
        catch (IllegalArgumentException e) {
        } catch (IllegalAccessException e) {
        }

        return authority;
    }

    private static final Uri BASE_CONTENT_URI = Uri.parse("content://" + CONTENT_AUTHORITY);
// ... 
```

现在在链接到库项目的每个项目中都可以提供自己的权限：

```
package com.example.app.data;

public class QuxContentProviderAuthority {
    public static final String CONTENT_AUTHORITY = "com.example.app.data.baz";
} 
```

另外，不要忘记更改清单中的权限

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-05-28T22:39:24.713

应用程序是唯一绝对需要了解权限的应用程序，因为它是`<provider>`在清单中使用`android:authorities`属性声明的应用程序。

因此，原则上，它应该“正常工作”，只要您从提供程序中删除所有特定于权限的逻辑，例如：

*   那些静态数据成员（现在移动到托管应用程序）
*   `UriMatcher`（自己滚动一些不检查权威，但专注于其余部分的东西`Uri`）

如果出于某种原因，您绝对确定您的提供者需要知道其权限，那么应用程序必须在提供者用于实际工作之前将其提供给提供者。可能的方法包括：

*   由于 a`ContentProvider`是一个自然单例，将它分配给一个静态数据成员，然后通过自定义`Application`类的自定义方法向它提供权限字符串（因为首先初始化提供程序，所以这应该有效）

*   如果您只支持 API 级别 11+，请`Application`使用自定义类`call()`来`ContentResolver`向`ContentProvider`

*   假设唯一真正的调用（例如 to `query()`, `insert()`）是有效的，并且只是根据你第一次`Uri`看到的内容来惰性初始化你的权限

# html - CSS3 后台查询

> ID：10790921
> 
> 赞同：0
> 
> 时间：2012-05-28T22:11:55.400
> 
> 标签：html, css

我有以下代码：我还想在该框的右侧添加一个图像。我会使用`background-image?` 有问题的图像是一个关闭图标。

**CSS：**

```
.scheduledCenter .alertMessage{
    width:100%;
    height:15px;
    color:#3385B2;
    background-color:#D1DEE8;
    border:3px solid #8099B4;
    border-radius:3px;
    padding:5px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:15:39.760

你可以加：

```
background: #D1DEE8 url('../images/icon.png') no-repeat 100% 0; 
```

您将获得图标和背景颜色。

# c - 从C中另一个类的方法中检索数据

> ID：10790924
> 
> 赞同：1
> 
> 时间：2012-05-28T22:12:40.027
> 
> 标签：c, list, printf

我正在为操作系统课程分配作业。我们得到了代码来帮助我们完成任务，但我对 C 语言的编程经验很少，而且我不知道如何使用它。我想要做的是打印列表头部的信息。该列表是定义为的结构列表

```
typedef struct 
{
    char name[NAME_MAX];
    int  lifetime;
} pcb_t;

int 
List_head_info ( List_t *list, void **data )
{
     int all_ok = 0;

     *data = NULL;
     if ((list != NULL) && (list->head != NULL)) {
         *data = list->head->data;
         all_ok = 1;
     }

     return all_ok;
} 
```

我试图用以下方式显示它们：

```
printf("test: %s", List_head_info(&processes, (void *)pcb)->name); 
```

但是`invalid type argument a->a`编译时出现错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:21:07.210

当你打电话时`List_head_info()`，你会得到两件事：

1.  `void *`指向头数据的指针 ( )，或 NULL。
2.  指示指针是否为非 NULL 的状态。

如果它成功返回，您可以将其转换（强制或强制转换）`void *`为 a `pcb_t *`，然后使用它来打印数据。

* * *

> 我将如何具体做到这一点？

可能有点像这样：

```
List_t list;

...code to initialize and maybe add things to the list...

void *head_data = 0;
if (List_head_info(&list, &head_data))
{
    pcb_t *item = (pcb_t *)head_data;
    printf("Lifetime: %.2d; Name: %s\n", item->lifetime, item->name);
} 
```

严格来说，初始化`head_data`是多余的；中的代码`List_head_info()`始终将值设置至少一次（为 NULL 或 0），有时设置两次（第二次设置为列表中头项的数据组件）。

这是“示例代码”，其中包含足够的信息进行编译。我已经对列表结构进行了足够的“逆向工程”以使其有意义；当然，实际的实现会有所不同。这在相当严格的 GCC 警告级别下干净地编译，在 Mac OS X 10.7.4 上使用 GCC 4.1.2 和 4.7.0。AFAICS，它避免了一些与“严格混叠”相关的复杂问题，在这个阶段你真的不想担心这些问题。

```
#include <stdio.h>

enum { NAME_MAX = 40 };

typedef struct Node Node;
struct Node
{
    void *data;
    Node *next;
};

typedef struct
{
    Node *head;
    Node *tail;
} List_t;

typedef struct 
{
    char name[NAME_MAX];
    int  lifetime;
} pcb_t;

extern int List_head_info(List_t *list, void **data);
extern void another_func(List_t processes);

void another_func(List_t list)
{
    void *head_data = 0;
    if (List_head_info(&list, &head_data))
    {
        pcb_t *item = (pcb_t *)head_data;
        printf("Lifetime: %.2d; Name: %s\n", item->lifetime, item->name);
    }
}

int 
List_head_info ( List_t *list, void **data )
{
    int all_ok = 0;

    *data = NULL;
    if ((list != NULL) && (list->head != NULL)) {
        *data = list->head->data;
        all_ok = 1;
    }

    return all_ok;
} 
```

# ios - Xcode iPhone SDK - 在开始时保持 NSInteger 为零

> ID：10790925
> 
> 赞同：2
> 
> 时间：2012-05-28T22:12:45.790
> 
> 标签：ios, xcode, nsinteger

我想在 my 的开头保留零`NSInteger`，但是当 i`NSLog`它时，零被删除。

```
NSInteger myInteger = 05;
NSLog("%d", myInteger); 
```

> 日志：5

我得到`5`而不是`05`. 我怎样才能保持`0`整数的开头？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-28T22:18:26.347

NSInteger 不做“前导”零。您正在考虑数字格式。

如果您只想通过“ `NSLog`”打印前导零，请尝试以下操作：

```
NSLog( "%02d", myInteger); 
```

它指示 NSLog 有两位数，如果没有达到两位数，则执行前导零。

看一下[printf 格式说明符](http://personal.ee.surrey.ac.uk/Personal/R.Bowden/C/printf.html)（NSLog 试图遵守），你会看到前导零是如何添加到那里的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T22:19:28.413

我不确定，但我认为这是你如何写你的`"%d"`标志的问题。所以你可以使用`NSLog(@"%03d", var);`.

它将打印 005。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-17T07:32:49.623

这是它对字符串的工作方式：

INT

String(format:"%05.2f", 5.0) 将输出：05.00

双倍的

String(format:"%02d", 5) 将输出：05

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T22:24:59.973

如果您只需要它来记录，请像这样尝试

```
NSLog(@"0%d" , 5) ; 
```

或者如果您需要在屏幕上打印它，请转换为格式为字符串：

```
NSString *result = [[NSString alloc]initWithFormat:@"0%d" , yourInteger] ; 
```

# ruby-on-rails - PayPal 自适应付款 - 在 PayPal 网站上失败

> ID：10790927
> 
> 赞同：2
> 
> 时间：2012-05-28T22:12:55.560
> 
> 标签：ruby-on-rails, ruby, paypal, activemerchant

我花了下午的大部分时间来处理这个问题，因此感谢您提供任何帮助。

我将 ActiveMerchant 与 active_paypal_adaptive_payment 网关一起使用，但遇到了一些问题。首先，我没有应用程序 ID，也不知道从哪里获得。我想知道这是否是我的问题。

我的目标是使用自适应 API 从一个用户的 PayPal 帐户向另一个用户汇款。我已经调试到可以确定 ActiveMerchant Gateway 正在生成正确的 XML 的程度：

```
<?xml version="1.0" encoding="UTF-8"?>
<PayRequest>
    <requestEnvelope>
        <detailLevel>ReturnAll</detailLevel>
        <errorLanguage>en_US</errorLanguage>
    </requestEnvelope>
    <actionType>PAY</actionType>
    <cancelUrl>http://localhost:3000/.../</cancelUrl>
    <returnUrl>http://localhost:3000/.../</returnUrl>
    <ipnNotificationUrl>http://localhost:3000/.../</ipnNotificationUrl>
    <currencyCode>USD</currencyCode>
    <receiverList>
        <receiver>
            <email>sandbox_account@gmail.com</email>
            <amount>100.0</amount>
        </receiver>
    </receiverList>
    <reverseAllParallelPaymentsOnError>false</reverseAllParallelPaymentsOnError>
</PayRequest> 
```

贝宝回应：

```
response_rash: !ruby/hash:Hashie::Rash
  response_envelope: !ruby/hash:Hashie::Rash
    timestamp: '2012-05-28T15:02:43.381-07:00'
    ack: Success
    correlation_id: 881baf8e93444
    build: '2945555'
  pay_key: AP-879734246V2339109
  payment_exec_status: CREATED 
```

然后我将用户重定向到正确的 PayPal 页面。用户登录，查看他们的信息，然后点击“支付”，此时他们会遇到以下错误：

> 您的付款无法完成。请返回参与网站并重试。

我什至上传到暂存环境以查看是否触发了 IPN，但没有触发，我认为这是因为付款从未真正完成。我希望我能看到 PayPal 到底发生了什么，但我认为他们没有提供任何工具来做到这一点。

有没有人见过类似的错误？关于下一步在哪里进行的任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T14:11:23.943

问题实际上是缺少 App ID。经过一番挖掘，我发现 Sandbox Global APP ID 是 APP-80W284485P519543T。在我获得真正的 App ID 之前，它现在可以正常工作。

# ios5 - 当用户下拉通知中心时，“应用程序试图以模态方式呈现活动控制器”

> ID：10790928
> 
> 赞同：2
> 
> 时间：2012-05-28T22:12:59.337
> 
> 标签：ios5, xamarin.ios

当用户将手机翻转到横向时，我有一个视图。它由位于导航控件堆栈顶部的 UIViewController 使用 PresentViewController() 呈现。

它工作正常，直到用户通过从手机屏幕顶部向下拖动来拉下通知中心，然后应用程序立即崩溃并出现 MonoTouchException 和消息：

“引发了 Objective-C 异常。名称：NSInvalidArgumentException 原因：应用程序试图以模态方式呈现活动控制器”

在任何其他视图中拉下通知中心时不会发生此崩溃，但所有其他视图都在导航控制器的堆栈上并且没有模态显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:29:19.953

通过更多的调试弄清楚了：

我订阅了 UIDeviceOrientationDidChangeNotification 以了解手机何时旋转并调用“DeviceRotated()”方法。

事实证明，当您拉下通知中心时，即使手机没有物理更改旋转，**此通知也会再次触发。**我的代码没有预料到这一点，所以它试图在它已经显示时再次呈现相同的景观视图，并引发了异常。

我在测试中添加`&& (this.PresentedViewController == null || this.PresentedViewController == this)`了`if-then`正确的环境来呈现景观视图并且崩溃消失了。

# git - 来自 gh-pages 分支上 master 分支的参考目录

> ID：10790932
> 
> 赞同：2
> 
> 时间：2012-05-28T22:13:49.253
> 
> 标签：git, github, github-pages

我按照[GitHub](http://help.github.com/pages/)的说明为 javascript 库创建了一个`gh-pages`分支。该库的构建脚本使用 JsDocs 创建一个`docs`目录——我希望我的 GitHub 页面能够引用这些文档。

我一直在手动将 docs 目录从`master`to复制`gh-pages`，但我认为更好的解决方案是：

*   设置我的`gh-pages`分支以引用 上的`docs`目录`master`，或
*   创建某种类型的钩子，当有人提交时只将`docs`目录复制到`gh-pages``master`

如何以最小的努力向用户提供此文档并减少不同步的机会？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:31:07.320

以下内容将使您不必签出其他分支来获取这些文件：

你可以得到另一个分支版本的目录

```
git checkout master -- path/to/my/docs/dir 
```

您可以列出另一个分支目录中的文件

```
git ls-files $(git rev-parse master) -- path/to/my/docs/dir 
```

您可以从另一个分支流式传输特定文件

```
git show master:path/to/my/docs/dir/somefile.txt 
```

希望这足以让您进入下一步。

# ios - 重大变化和方法称为

> ID：10790948
> 
> 赞同：0
> 
> 时间：2012-05-28T22:15:00.883
> 
> 标签：ios

我想知道除了“didUpdateToLocation”之外，Appdelgate 中的什么方法会被调用

例如，该方法是否：

didFinishLaunchingWithOptions applicationDidEnterBackground applicationDidBecomeActive

当发生重大更改位置更新事件时被调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:23:24.987

您正在考虑核心位置，您正在寻找的“重大更改位置更新事件”可以在[CLLocationManagerDelegate](http://developer.apple.com/library/ios/#documentation/CoreLocation/Reference/CLLocationManagerDelegate_Protocol/CLLocationManagerDelegate/CLLocationManagerDelegate.html)中找到。

也许[`locationManager:didUpdateToLocation:fromLocation:`](https://developer.apple.com/library/ios/documentation/CoreLocation/Reference/CLLocationManagerDelegate_Protocol/CLLocationManagerDelegate/CLLocationManagerDelegate.html#//apple_ref/occ/intfm/CLLocationManagerDelegate/locationManager%3adidUpdateToLocation%3afromLocation%3a)委托方法是您正在寻找的？

# javascript - JavaScript 中奇怪的算术行为

> ID：10790950
> 
> 赞同：0
> 
> 时间：2012-05-28T22:15:23.753
> 
> 标签：javascript

我正在尝试用 JavaScript 编写自己的幻灯片放映。我已经拥有的是在 Opera、Safari 和 Chrome 中工作的骨架：

```
var slideShow = (function() {
    var latestGames = document.getElementById('latestGames').getElementsByTagName('li');
    var displayedGame = 0;
    return {
        init: function() {
            latestGames[displayedGame].style.display = 'inline';
            setInterval(this.update, 3000);
        },
        update: function(gameToDisplay) {
            console.log("Displayed game: " + displayedGame);
            latestGames[displayedGame].style.display = 'none';
            gameToDisplay = gameToDisplay || (displayedGame === (latestGames.length - 1) ? 0 : ++displayedGame);
            console.log("Game to display: " + gameToDisplay);
            console.log('====================');
            latestGames[gameToDisplay].style.display = 'inline';
            displayedGame = (gameToDisplay == latestGames.length ? 0 : gameToDisplay);
        }
    }
})(); 
```

但是在 Firefox 中，当我记录 gameToDisplay 变量时，我只会得到随机数。我看不到错误在哪里。

预先感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T22:26:05.523

Firefox (pre-13) 将参数传递给您的间隔处理程序。参数给出函数调用的“迟到”；换句话说，它应该被调用的毫秒数。

[请参阅此处](https://developer.mozilla.org/en/DOM/window.setInterval)的黄色警告：

> 注意：在 Gecko 13 (Firefox 13.0 / Thunderbird 13.0) 之前，Gecko 向回调例程传递了一个额外的参数，以毫秒为单位指示超时的“实际延迟”。不再提供此非标准参数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-28T22:27:01.150

使用以下代码：

```
var self = this; // preserve this to be used inside the callback
setInterval(function() { self.update(); }, 3000) 
```

通常你所做的会起作用，但是一些（[基于 Gecko 的](https://developer.mozilla.org/en/DOM/window.setInterval)）浏览器将参数传递给计时器回调函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T22:28:42.280

setInterval 每 3 秒调用一次 this.update。update 将对对象有一个引用（this），但我看不出它会如何在 gameToDisplay 中传递。

要么删除 gameToDisplay，因为它看起来是多余的，要么将其设为像 displayGame 这样的实例变量，并独立于 update() 设置它。

在大多数情况下，它将为空，但 Firefox 显然传递了某种参数。

# php - 将 Mysql 转换为 Mysqli

> ID：10790951
> 
> 赞同：2
> 
> 时间：2012-05-28T22:15:26.613
> 
> 标签：php, mysqli

有人告诉我停止使用 MySQL，现在学习 MySQLi。但是我在使用 fetch 数组时遇到了问题，不知道我做错了什么。

```
//Connect to db
include "mysqli_connect.php";

// Construct our join query
$sql = "SELECT userID, username, lastlogin FROM users";

//Crate results
$result = mysqli_query($link, $sql);

// Print out the contents of each row into a table 
$row = mysqli_fetch_array($result, MYSQLI_BOTH);

// Free result set
mysqli_free_result($result);

// Close connection
mysqli_close($link); 
```

* * *

我看到的消息：

*   [连接成功] 主机信息：db413417616.db.1and1.com via TCP/IP
*   警告：mysqli_query() [function.mysqli-query]：无法在第 9 行的 /homepages/9/d413002686/htdocs/maintenance/testsession.php 中获取 mysqli
*   警告：mysqli_fetch_array() 期望参数 1 为 mysqli_result，在第 12 行的 /homepages/9/d413002686/htdocs/maintenance/testsession.php 中给出了 null
*   警告：mysqli_free_result() 期望参数 1 为 mysqli_result，在第 15 行的 /homepages/9/d413002686/htdocs/maintenance/testsession.php 中给出 null
*   警告：mysqli_close() [function.mysqli-close]: 无法在第 18 行的 /homepages/9/d413002686/htdocs/maintenance/testsession.php 中获取 mysqli ()

我将它用于 mysqli_connect.php：[http ://www.php.net/manual/en/mysqli.construct.php](http://www.php.net/manual/en/mysqli.construct.php)

```
<?php
// $link (host, username, password, database)
$link = mysqli_connect('host', 'username', 'password', 'database');

//If connection is successful, otherwise show error message. 
if (!$link) {
    die('[Connect Fail] Error: (' . mysqli_connect_errno() . ') '
            . mysqli_connect_error());
}
// Echo success message
echo '[Connection Successful] Host info: ' . mysqli_get_host_info($link) . "\n";

// Close the link
mysqli_close($link);
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:51:49.007

应删除包含文件中的这一行：

```
// Close the link
mysqli_close($link); 
```

您正在关闭`$link`，也就是您与数据库的连接，然后尝试在查询中使用它。您只想在完成所有操作后关闭它。

# python - django url 反向隐藏关键字参数

> ID：10790952
> 
> 赞同：1
> 
> 时间：2012-05-28T22:15:29.657
> 
> 标签：python, django, django-views

考虑来自此 url 的请求，其中接收者是用符号`/messages/compose/(?P<recipients>[\+\.\w]+)/`分隔的用户名。`+`成功后（成功发送给收件人的消息）我正在做：

```
#success_url = 'message_send_success'
recipients = '+'.join([obj.username for obj in recipients]) #converting them back to original string
reverse(success_url, kwargs={'recipients': recipients}) 
```

这是它匹配的 url：

```
url(r'^/messages/success/(?P<recipients>[\+\.\w]+)$', 'site.views.message_send_success', name='message_send_success') 
```

但它会在 url 中显示所有收件人，有什么办法可以隐藏这些收件人字符串以显示在 url 中并可以在请求中访问它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:28:26.583

也许你想使用 base64 库：

```
>>> base64.b64encode("what is that?")
'd2hhdCBpcyB0aGF0Pw=='
>>> base64.b64decode("d2hhdCBpcyB0aGF0Pw==")
'what is that?' 
```

注意：如果您想拥有更多安全网址，您应该对该字符串进行一些翻译（否则其他知道基本（编码）编码的用户将轻松解码您的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:28:35.740

如果您使用重定向，则不会。Django 有一个[“无共享”架构](http://en.wikipedia.org/wiki/Shared_nothing_architecture)，这意味着在一个请求和下一个请求之间，服务器上没有用户状态持续存在。出于这个原因，Django 不能（自动）“记住”重定向之前的收件人是什么，因此它可以在下一个 HTTP 请求中访问它们。

你想要隐藏它们的原因是什么？是否有您不能发回给客户的敏感信息，或者类似的东西？避免这种情况的一种选择是简单地重复客户端发送的信息（即原始`recipients`参数）并让`success`视图重做`compose`对它们执行的操作。

# c# - 单例和继承 C#

> ID：10790953
> 
> 赞同：1
> 
> 时间：2012-05-28T22:15:35.210
> 
> 标签：c#, inheritance, singleton

首先，我将声明我使用的单例实际上不会在整个应用程序生命周期中出现。它更像是一种封装用户正在发生的事情的方式。

我有几个 GameState，例如 InGame 或 MainMenu，它们有一些非常相似的函数调用，所以我想使用继承来停止复制/粘贴。以下代码是我所拥有的，但它不能按我的意愿工作。这里是：

BaseState.cs

```
abstract class BaseState
{
    protected static BaseState mHandle = null;

    protected static BaseState Handle
    {
        get
        {
            return mHandle;
        }
        set
        {
            mHandle = value;
        }
    }

    public static GameState UpdateState(GameTime gameTime)
    {
        GameState g = GameState.MainMenu;

        try
        {
            Handle.Update(gameTime);
        }
        catch (Exception e)
        {

        }

        return g;
    }

    public static void DrawState(GameTime gameTime, SpriteBatch spriteBatch)
    {
        Handle.Draw(gameTime, spriteBatch);
    }

    public static void Release()
    {
        mHandle = null;
    }

    protected abstract GameState Update(GameTime gameTime);
    protected abstract void Draw(GameTime gameTime, SpriteBatch spriteBatch);
} 
```

InGame.cs

```
class InGame : BaseState
{
    private InGame()
    {

    }

    protected static new BaseState Handle
    {
        get
        {
            if (mHandle == null)
            {
                mHandle = new InGame();
            }

            return mHandle;
        }
        set
        {
            mHandle = value;
        }
    }

    protected override GameState Update(GameTime gameTime)
    {
        return GameState.Quit;
    }

    protected override void Draw(GameTime gameTime, SpriteBatch spriteBatch)
    {

    }
} 
```

您可能会说我希望能够在其中使用and `get`of`set`所以我可以简单地调用 Handle.Update() 并且无论我是从 InGame 还是 Menu 或任何它知道要使用哪个代码的地方调用它。`InGame``BaseState`

显然，我需要提高我的 OO 技能。但是，如果有人能提出一种方法来让它做我想做的事情，或者提出一种不同的方法，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T22:31:05.550

您要实现的目标不需要单例，请参见下文：

```
public abstract class BaseState
{
    public GameState UpdateState(GameTime gameTime)
    {
        GameState g = GameState.MainMenu;

        try
        {
            g = Update(gameTime); // Update returns a new state
        }
        catch (Exception e)
        {

        }

        return g;
    }

    protected abstract GameState Update(GameTime gameTime);
    protected abstract void Draw(GameTime gameTime, SpriteBatch spriteBatch);
}

public class InGame : BaseState
{
    public InGame()
    {

    }

    protected override GameState Update(GameTime gameTime)
    {
        return GameState.Quit;
    }

    protected override void Draw(GameTime gameTime, SpriteBatch spriteBatch)
    {
        // Draw game
    }
}

public class InMenu : BaseState
{
    public InMenu()
    {

    }

    protected override GameState Update(GameTime gameTime)
    {
        return GameState.Pause;
    }

    protected override void Draw(GameTime gameTime, SpriteBatch spriteBatch)
    {
        // Draw menu
    }
}

public void Foo()
{
    List<BaseState> states = new List<BaseState>();
    states.Add(new InGame());
    states.Add(new InMenu());

    // Calls InGame.Update(...)
    states[0].UpdateState(...);

    // Calls InMenu.Update(...)
    states[1].UpdateState(...);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T22:29:26.657

好吧，你不能覆盖静态成员，所以我认为你的方法是错误的。您最好使用工厂或管理器类（如果需要，可以使用单例访问当前实例），这将使您能够访问当前游戏状态。

```
public class GameStateManager
{
    private static GameStateManager _instance = new GameStateManager();

    public static GameStateManager Instance { get { return _instance; } }

    public BaseState Current { get; private set; }

    public GameStateManager()
    {
         Current = new InGame();
    }

    public void ChangeState(GameState state, GameTime gameTime)
    {
         // change your current state here, I'm not really sure about your logic here
         Current.UpdateState(gameTime);

         switch(state)
         {
            case GameState.Menu:
              Current = new MainMenu();
            // etc.
            default:
               throw new NotImplementedException(string.Formatted("The state {0} is not implemented.", state));
         }
    }
} 
```

您可以使用 访问单例`GameStateManager.Instance`。

# php - 为什么告诉您的服务器将 HTML 解析为 PHP 是一个坏主意？

> ID：10790955
> 
> 赞同：12
> 
> 时间：2012-05-28T22:15:59.850
> 
> 标签：php, html, security, parsing, .htaccess

您知道您可以使用 .htaccess 使服务器将 HTML 页面解析为 PHP（在 HTML 文档中执行 PHP 代码）吗？

好吧，有些人说这样做不好。为什么？

有些人还说它会在您的应用程序中打开一个安全漏洞。如何？

在文档到达浏览器之前源代码仍然被删除，所以不会出现未经授权访问源代码的情况，对吧？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-28T22:27:18.760

让我从一个小故事开始：当我在一家 Linux 发行版供应商担任安全联系人时，PHP 安全团队请求 Linux 供应商停止调用解释器崩溃*安全漏洞*，即使 PHP 解释器在 Web 服务器中运行*（*例如，`mod_php`在 Apache 上）。（当时，每周大约会发现一次口译员崩溃。）

他们花了一点点谈话才真正说服我们，提供运行 PHP 代码的人是完全受信任的，任何试图控制脚本*可以*从解释器执行的操作都是错误的——如果有人想出了如何使解释器崩溃绕过它试图强加的限制（例如[整个愚蠢的安全模式一堆废话](http://php.net/manual/en/features.safe-mode.php)），这*不是*安全漏洞，因为脚本的安全执行*不是*PHP 解释器的目标——它从来没有，也从来没有将会。

实际上，我对讨论的最终结果非常满意——它清楚地定义了 PHP 的安全目标：您应该只允许执行您 100% 完全信任的 PHP 代码。如果您不信任它，就不要运行它。就是这么简单。

无论脚本是否利用了解释器中的错误或只是做了一些意想不到的事情，解释器可以使用的任何操作系统资源都是可用的*并且*是公平的游戏。

因此，请不要让随机代码在您的网络服务器的上下文中执行，除非那是您*真正*想要的。

请使用[最小权限原则](http://en.wikipedia.org/wiki/Principle_of_least_privilege)来指导每个程序可以使用哪些资源。

考虑使用[强制访问控制](http://en.wikipedia.org/wiki/Mandatory_access_control)工具，例如[AppArmor](http://wiki.ubuntu.com/AppArmor/)、[SELinux](http://en.wikipedia.org/wiki/Security-Enhanced_Linux)、[TOMOYO](http://tomoyo.sourceforge.jp/index.html.en)或[SMACK](http://schaufler-ca.com/)来进一步限制您的程序可以做什么和不能做什么。我从 2001 年左右开始从事 AppArmor 项目，并且相当有信心通过一天的努力，大多数系统管理员可以使用 AppArmor 以一种有意义的方式增强他们的站点安全性。请评估几个选项，因为不同的工具是围绕不同的安全模型设计的——一个或另一个可能更合适。

但是无论您做什么，请不要以不必要的方式运行您的服务器，从而通过额外的向量对其进行攻击。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-28T22:21:59.327

主要问题是如果您将代码移动到另一台服务器或让其他人使用您的代码、服务器设置或`.htaccess`文件，您的 html 页面可能会停止被 PHP 解释器解析。

在这种情况下，PHP 代码将提供给浏览器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-28T22:25:09.853

存在一个安全漏洞，如果您这样做，HTML 文件实际上是 PHP 文件，因此上传它们应该像上传 PHP 文件一样认真对待。人们通常不认为上传 HTML 文件有什么大不了的，正是因为他们不希望它们被设置为解析为 PHP（因此您公司中的其他人可能会无意中打开一个安全漏洞）。[PaulP.RO 的回答指出，安全问题也可能出现在相反的方向 - 由于 PHP 在稍后错误地删除此设置时被误认为是 HTML。]

还有一点性能问题，因为每个 HTML 文件都必须通过 PHP 解析器运行（即使它恰好不包含 PHP）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-28T22:25:34.137

出于速度和组织的原因，将 HTML 解析为 PHP 是不好的（ish）。

*   解析为 PHP 的 HTML 文件在技术上会加载较慢，因为您正在调用 PHP 引擎。
*   但大多数情况下，这对组织目的不利：随着项目的扩展，想象一下在 HTML 文件中寻找嵌入的 PHP 代码。浏览您的项目时，您的文件扩展名应该是该文件用途的真正指标。如果表单提交到“login.php”，您可以合理地确定它包含服务器代码。但“login.html”可能只是另一个 HTML 页面。

关于您的其余评论，我不确定安全方面，但我认为混合您的 HTML 和 PHP 输出可能会导致未被注意到的 XSS 漏洞？不过，这不是专家。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-28T23:38:50.580

这对速度不利，如果 PHP 解释器由于某种原因无法工作，PHP 代码将显示在页面源代码中。例如，如果您在 PHP 代码中有数据库用户名和密码，那么任何人都可以轻松连接和访问您的数据库。

正如 zed 所说，出于组织原因，这很糟糕。您需要更新站点上的所有文件以进行简单更改，而不是更新一个文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-28T22:31:43.497

允许服务器将 HTML 文件解析为 PHP 表明您没有使用适当的应用程序设计模式。也就是说，你是在开辟自己的道路，而不是按照推荐的方式做事。存在像 MVC（关注点分离）这样的设计是有原因的。

允许直接调用任意文档的一个问题是丢失了“前端控制器”（通常是 index.php），这有助于减少进入应用程序的入口数量。

您可以有许多进入应用程序的路径，但您必须在设计中涵盖更多可能的攻击路线。

# objective-c - 如何在没有手势的情况下以编程方式触发翻页转换？

> ID：10790956
> 
> 赞同：2
> 
> 时间：2012-05-28T22:16:10.150
> 
> 标签：objective-c, ios, uiviewcontroller, transition

我正在使用 iBook 之类的翻页转换 ( *UIPageViewControllerTransitionStylePageCurl* ) 来导航几个 UIViewController 页面。

因此我实现*了 UIPageViewControllerDataSource*委托函数

```
- (UIViewController *)pageViewController:
(UIPageViewController *)pageViewController viewControllerAfterViewController:(UIViewController *)viewController
{ 
```

和

```
- (UIViewController *)pageViewController:
(UIPageViewController *)pageViewController viewControllerBeforeViewController:
(UIViewController *)viewController 
```

当通过手势进行翻页时，这些会被正确调用。到目前为止，一切都很好。

除了这种默认行为之外，我还想在页面的两侧添加一个长按手势识别器，作为快速移动到最后一页或第一页的快捷方式。我已经设法将手势识别器添加到页面，但我不知道如何在没有内置滑动的情况下使页面移动。

如何以**编程**方式触发页面转向特定页面（UIViewController） ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T15:02:50.750

当用户执行长滑动时，您可以将所需的 viewController（在您的情况下为第一页或最后一页）发送到方法的 viewControllers 参数：

```
- (void) setViewControllers:(NSArray*)viewControllers
                  direction:(UIPageViewControllerNavigationDirection)direction
                   animated:(BOOL)animated
                 completion:(void (^)(BOOL finished))completion; 
```

有关更多详细信息，请参见 Graham 在以下位置的回答：

[是否可以在 UIPageViewController 中以编程方式翻页？](https://stackoverflow.com/questions/7208871/is-it-possible-to-turn-page-programmatically-in-uipageviewcontroller)

如果我没看错，正在显示的 UIViewControllers 包含按钮，并且您希望它们也能够调用此函数。

要从正在显示的 UIViewControllers 中以编程方式调用该方法，您可以使 UIPageViewController 成为正在显示的 UIViewControllers 的委托，然后在按下按钮时调用委托方法。

一个不好的方法是向 UIViewControllers 发送一个反向指针（存储为 WEAK 属性！）到你的 UIPageViewController 并调用 respondsToSelector: 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:27:05.897

看看这个`UIPageViewController`方法：

```
- (void)setViewControllers:(NSArray *)viewControllers 
                 direction:(UIPageViewControllerNavigationDirection)direction
                  animated:(BOOL)animated 
                completion:(void (^)(BOOL finished))completion; 
```

[UIPageViewController 类参考](https://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIPageViewControllerClassReferenceClassRef/UIPageViewControllerClassReference.html#//apple_ref/occ/instm/UIPageViewController/setViewControllers%3adirection%3aanimated%3acompletion%3a)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T08:15:53.823

确保您没有设置`self.pageViewController.datasource`为 self. 然后您可以将此`UIPageViewController`功能与手势识别器一起使用。

```
 -[self.pageViewController setViewControllers:viewControllers direction:UIPageViewControllerNavigationDirectionForward animated:YES completion:NULL]; 
```

1.  你可以设置一个手势识别器的委托并实现这个：

    ```
    - (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch 
    ```

2.  或者你可以添加一个手势识别器，比如[UISwipeGestureRecognizer](https://stackoverflow.com/questions/3319209/setting-direction-for-uiswipegesturerecognizer/12472784#12472784)

# java - 要在 CodePage 857 中编码的字符串

> ID：10790958
> 
> 赞同：0
> 
> 时间：2012-05-28T22:16:16.497
> 
> 标签：java

我需要一个可以打印土耳其语字符的功能。

```
public String convert(String input) {
    String output = new String(s.getBytes(input), "CodePage-857");
    return output;
} 
```

有没有人可以告诉我如何实现这一目标？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T15:35:42.497

这就是我实现它的方式。

```
System.Text.Encoding CP857 = System.Text.Encoding.GetEncoding(857);
return CP857.GetBytes("Text goes here"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:34:45.777

Java 字符串默认为 UTF-16，其中包括土耳其语字符集。您可以以 UTF-8、UTF-16 或 ISO-8859-3 显示字符串。

您正在使用哪种视图技术？它可能配置为不支持土耳其语的 ISO-8859-1。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-28T22:24:08.000

Java 字符串始终存储为 UTF-16，因此从输入字符串创建新字符串无济于事。如果你想以不同的编码打印字符串，那么你需要在实际显示时解决这个问题，例如：如果你想在 JSP 页面中显示它，那么 JSP 页面的编码必须设置为 CodePage-857

# objective-c - 在 getter 方法中设置属性是不是很糟糕？

> ID：10790959
> 
> 赞同：1
> 
> 时间：2012-05-28T22:16:31.093
> 
> 标签：objective-c, ios, getter, accessor

如果我有一个属性，比如说一个 NSArray，它只会为我的类的每个实例初始化一次，这有什么问题吗：

（在界面中）

```
@property(strong, nonatomic)NSArray *bubbleArr; 
```

（在实施中）

```
-(NSArray*)bubbleArr
{
    if(!bubbleArr)
    {
        NSMutableArray *tempBubbArr = [[NSMutableArray alloc] init];
        // get filepath for first speech bubble image for page
        NSString *speechBubbleImgPath = [[NSBundle mainBundle] pathForResource:
                                         [NSString stringWithFormat:@"speech_%i_0", pageIndex]
                                                                        ofType:@"png"];

        for(int i = 1; speechBubbleImgPath; i++)
        {
            UIImage *speechBubbleImg = [[UIImage alloc] initWithContentsOfFile:speechBubbleImgPath];
            UIImageView *speechBubbleImgView = [[UIImageView alloc] initWithImage:speechBubbleImg];

            [tempBubbArr addObject:speechBubbleImgView];

            speechBubbleImg = nil;
            speechBubbleImgView = nil;
            speechBubbleImgPath = nil;

            speechBubbleImgPath = [[NSBundle mainBundle] pathForResource:
                                   [NSString stringWithFormat:@"speech_%i_%i", pageIndex, i]
                                                                  ofType:@"png"];
        }

        bubbleArr = [[NSArray alloc] initWithArray:tempBubbArr];

        tempBubbArr = nil;
    }

    return bubbleArr;
} 
```

我从未使用过自定义访问器方法，但这似乎是一种干净的设置方法，因此我不必在我的`viewDidLoad`或其他地方设置每个属性，也不必担心它是`nil`. 我不记得曾经真正遇到过这样做的代码。这是推荐的方法吗？另外，我总是想用它`self.bubbleArr`来确保调用这个方法，对吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:25:50.227

这是设置您的财产的一种完全有效的方式。Apple 在他们的示例代码以及他们的项目模板中经常做这种事情。例如，查看新创建的核心数据 iOS 项目中的核心数据堆栈设置。正如@WendiKidd 所指出的，您必须始终通过访问器访问您的变量，以确保它运行良好（这可能是您无论如何都应该做的）。

特别是，这是实现类的属性的好方法，该属性实际上只能返回一件事（从您的评论来看，这听起来像是您正在尝试做的事情）。如果这是您的目标，请遵循以下准则：

1.  将您的财产声明为`readonly`
2.  如果它应该是可公开访问的，则在公共标头中声明它，如果它应该是“私有的”，则在 .m 文件的类扩展中声明它
3.  如果它可以/应该由变量支持，则合成 ivar 并按照您所做的那样覆盖 getter
4.  如果它不应该/不必由变量支持，请`@dynamic`在实现中声明该属性并覆盖 getter
5.  仅通过访问器访问您的 ivar

在第 4 点将变量声明为动态将向查看您的代码的任何人发出信号，表明您可能已经为该属性编写了自定义访问器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:22:03.990

等待直到您需要变量的内容来初始化它的技术称为“延迟加载”，并且是一种有效的技术。不过，我不确定在吸气剂内部做这件事。

我认为你的帖子的最后一行准确地描述了这个问题——是的，当你想引用对象时，你总是必须确保调用 getter 方法，即使在类本身内部也是如此。很容易犯错误并且不能正确地做到这一点，如果您的代码将来可以传递给另一个开发人员，这是一个特别糟糕的主意。他们绝对不会期望您以这种方式进行设置，并且当他们期望能够正常访问变量时可能会遇到问题。在 viewDidLoad 中初始化成员变量是一种常见且公认的做法。

所以是的——这在技术上是可行的，尽管从设计角度来说不是一个非常合理的设置。我强烈反对它。但如果你只是想知道它是否会起作用，答案是肯定的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T22:23:40.537

是的，如果您不使用 self.bubbleArray 或 [self bubbleArray] 您将不会调用该方法。

除此之外，这完全是管理属性实例化的好方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T22:23:48.323

这似乎是一个干净的解决方案，感觉有点像延迟加载。但我不确定我会这样做。

# asp.net - 在 Visual Studio C# ASP.NET 中，有没有办法自动生成事件处理程序？

> ID：10790965
> 
> 赞同：1
> 
> 时间：2012-05-28T22:17:42.567
> 
> 标签：asp.net

假设您想为按钮单击事件自动生成事件处理程序。如果您可以切换到 .aspx 设计视图，您可以在按钮的属性面板中找到一个小闪电符号，其中包含按钮的所有事件。您所要做的就是双击单击事件以自动生成单击事件处理程序。但问题是按钮通常包含在其他一些控件中，因此无法切换到设计视图并找到按钮。我不得不自己手写所有的事件处理程序，这真的很乏味。有什么好的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:23:38.633

在代码隐藏中编写代码总是更好，而且真的没那么难

```
protected void btn_Click(object sender, EventArgs e)
{

} 
```

您可以在 Visual Studio 中为其创建一个片段，这样您只需键入片段名称和双标签。

[在 Visual Studio 2008 中创建自定义代码片段](https://stackoverflow.com/questions/117508/create-custom-code-snippet-in-visual-studio-2008)

尝试双击设计器中的按钮。

# delphi - 如何在 FreePascal 中包含 ObjectiveC 文件以使用 Delphi XE2 进行 iPhone 开发

> ID：10790976
> 
> 赞同：3
> 
> 时间：2012-05-28T22:19:58.357
> 
> 标签：delphi, ios5, delphi-xe2, freepascal

我需要向 FreePascal 系统添加 2 个文件，一个 .h 和一个 .m 文件。我已阅读有关解析标头的文章，并下载了 parse-ios 工具。运行 parse-ios.sh 时，我不断收到“无法识别的框架”错误由于我是使用 Delphi XE2/FPC/XCode 组合的新手，任何帮助都是最有用的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:11:02.720

Free Pascal 不编译 C/C++/Objective C 或其头文件。尽管给出了正确的（Objective Pascal）标头，但它可以链接到 Objective C 代码。

因此，您需要使用 Objective C 编译器来编译 Objective C*代码*，并在 Objective pascal 中创建一个标头来描述您需要访问的位。

最好的起点可能是 Free Pascal/Lazarus wiki，并研究 Free Pascal 附带的 Cocoa 目标 Pascal 单元（以及它们各自的 Objective C 标头）。不过，我不确定 XE2 究竟从 FPC 标准发行版中打包了什么。

您也可能会冒险在[Mac-pascal](http://lists.sonic.net/mailman/listinfo/mac-pascal)列表上发布帖子，尽管它在过去两周似乎不活跃（主持人在度假的审核列表？），所以请耐心等待。

# mms - MMS MessageType 字段中的 chunkLen 是什么

> ID：10790983
> 
> 赞同：0
> 
> 时间：2012-05-28T22:21:41.310
> 
> 标签：mms

我正在开发`mms`完全实现协议的库。在[消息类型](http://msdn.microsoft.com/en-us/library/cc234813%28v=prot.10%29)中，我们知道所有消息都必须以`ChunckId`（即[LinkMacToViewerPing](http://msdn.microsoft.com/en-us/library/cc234785%28v=prot.10%29)）开头。谁能告诉我是什么`ChunckId`以及如何填写？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T17:14:28.867

您的主题说`chunkLen`，但在您说的消息正文中`chunckId`。你问的是哪一个？

如果是`chunkLen`，请查看[http://msdn.microsoft.com/en-us/library/cc234813.aspx](http://msdn.microsoft.com/en-us/library/cc234813.aspx)，了解它是什么以及如何设置它。

# android - 如何在单击时将图像设置为背景图像？

> ID：10790984
> 
> 赞同：0
> 
> 时间：2012-05-28T22:21:41.823
> 
> 标签：android, image, background

我有一个显示带有不同图像的网格视图的活动。单击其中一个图像时，我希望单击的图像成为另一个活动的背景图像。

我怎样才能做到这一点？

这是我显示网格视图的活动：

```
public class HelloGridViewActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    GridView gridView = (GridView) findViewById(R.id.gridview);

    // Instance of ImageAdapter Class
    gridView.setAdapter(new ImageAdapter(this));

    /**
     * On Click event for Single Gridview Item
     * */
    gridView.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View v, int position, long id) {

//WHAT SHALL I PUT HERE????
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T23:37:55.680

因此，张贴者（最初）并没有明确指定是否在点击时立即打开其他活动，或者是否只需要记录点击项目的图像以供以后使用。第一个问题对我来说似乎更常见，因为`GridView`它显示了一组图像缩略图。用户点击它，就会出现一个只显示该项目信息的新活动。该缩略图可能会全屏显示。无论如何，也许这不是发帖人的想法，但这是我的假设（可能有人最终会在考虑到这样一个用例的情况下找到这个答案）。

它也没有指定图像的存储方式，所以我会假设

1.  的`ImageAdapter`图像是这个应用程序的捆绑资源
2.  我们可以对`ImageAdapter`, 存储一些数据来解决这个问题

因此，我采用一个标准，并在 ImageView 的属性`ImageAdapter`中添加一行代码来记录每个 ImageView 的整数资源 ID 。`tag`有很多方法可以做到这一点，但这是我选择的方式。

```
public class ImageAdapter extends BaseAdapter {
   /* see code removed at 
       http://developer.android.com/resources/tutorials/views/hello-gridview.html 
    */

   // create a new ImageView for each item referenced by the Adapter
   public View getView(int position, View convertView, ViewGroup parent) {
      ImageView imageView;
      if (convertView == null) {  // if it's not recycled, initialize some attributes
         imageView = new ImageView(mContext);
         imageView.setLayoutParams(new GridView.LayoutParams(85, 85));
         imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
         imageView.setPadding(8, 8, 8, 8);
      } else {
         imageView = (ImageView) convertView;
      }

      imageView.setImageResource(mThumbIds[position]);
      // here we record the resource id of the image, for easy access later
      imageView.setTag(mThumbIds[position]);
      return imageView;
   }

   // references to our images
   private Integer[] mThumbIds = {
         R.drawable.pic1, 
         R.drawable.pic2, 
         R.drawable.pic3, 
         R.drawable.pic4, 
         R.drawable.pic5 
   };
} 
```

然后，当 Hello 活动单击了一个网格项目时，我检索图像的资源 id 并将其作为`Intent`额外的 (HelloGridViewActivity.java) 传递：

```
 public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      setContentView(R.layout.main);

      GridView gridView = (GridView) findViewById(R.id.gridview);

      // Instance of ImageAdapter Class
      gridView.setAdapter(new ImageAdapter(this));

      final Context activity = this;

      gridView.setOnItemClickListener(new OnItemClickListener() {

         public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
            Object tag = v.getTag();
            if (tag instanceof Integer) {
               // we stored a reference to the thumbnail image in the ImageView's tag property
               Intent i = new Intent(activity, AnotherActivity.class);
               Integer resourceId = (Integer)tag;
               i.putExtra("backgroundImage", resourceId);
               startActivity(i);
            }
         }
      });
   } 
```

最后，当新活动（`AnotherActivity`）打开时，我们额外检索该意图，并将其解码为整数资源 id，并将其设置为全屏背景图像`ImageView`（AnotherActivity.java）：

```
 protected void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      this.setContentView(R.layout.another);

      Intent i = getIntent();
      //String bgImage = i.getExtras().getString("backgroundImage");
      int resId = i.getExtras().getInt("backgroundImage");

      try {
         ImageView background = (ImageView) findViewById(R.id.bgImage);
         // Another alternative, if the intent extra stored the resource 'name',
         //   and not the integer resource id
         //Class<?> c = R.drawable.class;
         //background.setImageResource(c.getDeclaredField(bgImage).getInt(c));
         background.setImageResource(resId);
      } catch (Exception e) {
         e.printStackTrace();
      }
   } 
```

我还在上面显示了一些注释掉的代码，如果由于某种原因您需要传递图像资源的**字符串**名称，而不是**整数**资源代码。注释掉的代码会查找给定图像名称的资源 id。根据我的 ImageAdapter 中使用的资源名称，要传递的示例字符串名称可能是`"pic1"`. 如果这样做，当然，调用 Activity (HelloGridViewActivity) 需要将 Intent extra 编码为字符串，而不是整数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:37:12.857

获取您想要作为 BG 的图像的资源 ID 并将其保存到首选项中。

```
 public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
        saveImageId(position);
    }

private void saveImageId(int position) {
    int id = getImageId(); // get the R.drawable.* id of the image. You should be able to figure this out.
    Editor ed = PreferenceManager.getDefaultSharedPreferences(this).edit();
    ed.putInt("bg_image_id", id);
    ed.commit();
} 
```

现在在您的其他活动中，您可以获得图像 ID：

```
SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
int id = prefs.getInt("bg_image_id", R.drawable.default_background); //Get image id, use default background if there isn't one.
LinearLayout mLayout = (LinearLayout) findViewById(R.id.background_layout);
mLayout.setBackgroundResource(id); 
```

祝你好运

# symfony - symfony2中的学说2三级继承模型

> ID：10790990
> 
> 赞同：1
> 
> 时间：2012-05-28T22:22:13.707
> 
> 标签：symfony, doctrine-orm

我正在尝试使用学说 2 实现三级继承模型，如下例所示：

1 级实体：

```
/**
 * @ORM\Entity
 * @ORM\InheritanceType("JOINED")
 * @ORM\DiscriminatorColumn(name="discr", type="string", length=50)
 * @ORM\DiscriminatorMap({"Factura"="Factura", "NotaEntrega"="NotaEntrega", "Giro"="Giro", "FacturaNormal"="FacturaNormal", "FacturaPeriodica"="FacturaPeriodica"})
 */
class Cobro { ... } 
```

2 级实体：

```
/**
 * @ORM\Entity 
 */
class Factura extends Cobro { ... } 
```

3 级实体：

```
/**
 * @ORM\Entity 
 */
class FacturaNormal extends Factura { ... } 
```

但是当我尝试为实体“Factura”创建获取器和设置器时......

```
php app/console doctrine:generate:entities MiAlarma/FacturaBundle/Entity/Factura 
```

我收到以下错误：

```
Fatal error: Call to undefined method Doctrine\ORM\Mapping\MappingException::nameIsMandatoryForDiscriminatorColumns() in /var/www/sf5/vendor/doctrine/lib/Doctrine/ORM/Mapping/ClassMetadataInfo.php on line 1944 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T10:49:37.127

当我错过了注释中的`name=""`部分时，我遇到了这个错误。`@ORM\DiscriminatorColumn`我看不出你有任何问题，但这似乎是 Doctrine 所抱怨的。

尝试使用`var_dump()`in`ClassMetadataInfo::setDiscrimiatorColumn`查看从注释中传递的内容，看看有什么问题。

# google-bigquery - 有没有办法处理稳健且可扩展的不变性？

> ID：10790991
> 
> 赞同：0
> 
> 时间：2012-05-28T22:22:15.690
> 
> 标签：google-bigquery

由于 bigquery 是仅附加的，因此我正在考虑使用类似于 peoplesoft 的工作方式的“生效日期”标记我上传到它的每条记录，如果有人熟悉该模式的话。

然后，我可以发出选择语句并在最大生效日期加入

```
select UTC_USEC_TO_MONTH(timestamp) as month, sum(amt)/100 as sales
from foo.orders as all
join (select id, max(effdt) as max_effdt from foo.orders group by id) as latest
on all.effdt = latest.max_effdt and all.id = latest.id
group by month
order by month; 
```

不幸的是，由于大查询“小连接”的限制，我相信这不会扩展，所以我想看看其他人是否考虑过这个用例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T04:07:36.030

是的，为每条记录添加时间戳（或者在某些情况下，添加捕获特定记录状态的标志）是正确的方法。BigQuery“Small Join”的小边实际上可以返回*至少*8MB（这个值在我们端是压缩的，所以通常是2到10倍大），所以对于“lookup”表类型的子查询，这实际上可以提供很多的记录。

在您的情况下，我不清楚您要运行的确切查询是什么.. 看起来您正在尝试返回每个单独项目的最近销售时间 - 然后将此信息与销售量的总和一起加入每个项目每月？您能否提供有关查询的更多信息？

有可能在一个查询中完成所有这些操作。例如，在我们的维基百科数据集中，一个例子可能看起来像......

```
SELECT contributor_username,  UTC_USEC_TO_MONTH(timestamp * 1000000) as month, 
SUM(num_characters) as total_characters_used FROM 
[publicdata:samples.wikipedia] WHERE (contributor_username != '' or 
contributor_username IS NOT NULL) AND timestamp > 1133395200 
AND timestamp < 1157068800 GROUP BY contributor_username, month 
ORDER BY contributor_username DESC, month DESC; 
```

...为每个用户每月提供维基百科贡献（如每个项目每月的销售额）。这个结果实际上非常大，因此您必须按日期范围进行限制。

**更新**（基于下面的评论）一个类似的查询，该查询为特定时间后贡献者的最新维基百科修订找到“num_characters”......

```
SELECT current.contributor_username, current.num_characters
FROM
(SELECT contributor_username, num_characters, timestamp as time FROM [publicdata:samples.wikipedia] WHERE contributor_username != '' AND contributor_username IS NOT NULL)
AS current
JOIN
(SELECT contributor_username, MAX(timestamp) as time FROM [publicdata:samples.wikipedia] WHERE contributor_username != '' AND contributor_username  IS NOT NULL AND timestamp > 1265073722 GROUP BY contributor_username) AS latest
ON 
current.contributor_username = latest.contributor_username
AND
current.time = latest.time; 
```

如果您的查询要求您首先使用构建一个大型聚合（例如，您需要运行准确的 COUNT DISTINCT），另一种选择是将这个查询分成两个查询。第一个查询可以按月提供最大有效日期以及计数，并将此结果保存为新表。然后，可以对结果表运行求和查询。

您还可以将月度销售记录存储在单独的表中，并仅查询您感兴趣的月份的特定表，从而简化您的月度销售摘要（这也可能是 BigQuery 的一种更经济的使用方式）。当您需要在所有表中查找聚合时，您可以使用 FROM 子句后列出的多个表运行查询。

# java - Java：正则表达式 - 一般组

> ID：10790992
> 
> 赞同：0
> 
> 时间：2012-05-28T22:22:17.167
> 
> 标签：java, regex

可以说我有一些正则表达式 = "..(group1)..|..(group2).."

```
pattern.matcher(regex)
matcher.find()
// how can i access the result?? 
// i dont wanna use matcher.group(1) or matcher.group(2) 
// since i don't really know what will be the result. 
```

正如你所看到的，我不知道如何得到我的结果。我正在寻找类似 matcher.getResultedGroup 的东西。谁能解释一下我该怎么办？

*   如果你有其他建议来扩展我的知识，我很想听听..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:24:23.890

您可以使用单个捕获组，其中包含非捕获组：

```
((?:group1)|(?:group2)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:26:19.857

迭代[`Matcher.start(groupNum)`](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Matcher.html#start%28int%29)。`groupNum`那不是`0`，但从`0`你正在寻找的开始（假设它是你的整个表达）。

否则，将整个子表达式包含到捕获组中：`((group1)|(group2)...)`并将内部组的起始索引与外部组进行比较。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T00:19:41.030

如果您不想，则无需进入子组。实际匹配在组 0:`Matcher.group(0)`或等效的`Matcher.group()`. 请注意，您可能希望使用非捕获组来保护资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T22:24:59.947

请参阅 Javadoc [http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html)和[http://docs.oracle.com/javase/6/docs/api/java /util/regex/Matcher.html](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Matcher.html)

也许这样的事情会起作用：

```
while(matcher.find()) {
    String groupMatch = matcher.group(groupIndex)
} 
```

matcher.find 将尝试查找与您的正则表达式匹配的字符串的所有子序列（子字符串）。

# mysql - Django 中的原始 SQL

> ID：10790994
> 
> 赞同：0
> 
> 时间：2012-05-28T22:22:35.693
> 
> 标签：mysql, django, django-queryset

我正在尝试在 django 中执行 RAW SQL 查询。我在获取 fetchall 结果以输出列中不同项目的列表时遇到了一些麻烦。

所以我希望得到一个列中所有项目的列表。

```
class TableObject (object):

    def __init__ (self, Kingdom):
        SQL_str_Table = "SELECT DISTINCT column_title FROM sql_table"
        cursor.execute(SQL_str_Table, [])
        listOfReturns = cursor.fetchall()

        for each in listOfReturns:
            item = each 
```

当我尝试打印“项目”时，我得到：

“mysite.forms.veiws.TableObject 对象的绑定方法 TableObject.write 在 0x03E5EE70”

所以我的问题是如何将 fetchall 结果放入列表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T08:23:39.740

如果你想得到一个只有 column_title 的平面列表，那么你可以这样做：

```
listOfReturns = cursor.fetchall()
listOfReturns_flat  = [i for i in listOfReturns if i[0]] #remove empty results if any 
```