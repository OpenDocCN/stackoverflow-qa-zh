# StackOverflow 问答 12099000-12099999

# python - Django、mod_wsgi、Apache：内部服务器错误

> ID：12099004
> 
> 赞同：1
> 
> 时间：2012-08-23T19:53:38.797
> 
> 标签：python, django, apache, mod-wsgi

我已经在 Redhat 服务器中使用 mod_wsgi 2.0 和 apache 2.2.3 配置了 Django 1.4。但是当我尝试访问服务器时，我收到以下错误：“错误 500：内部服务器错误。”

```
[root@lts5srv1 hardi]# wget mritest.domain.ch
--2012-08-23 21:51:27--  http://mritest.domain.ch/
Resolving mritest.domain.ch... 127.0.0.1
Connecting to mritest.domain.ch|127.0.0.1|:80... connected.
HTTP request sent, awaiting response... 500 Internal Server Error
2012-08-23 21:51:27 ERROR 500: Internal Server Error. 
```

所以我有联系，但我没有得到任何有效的回应。它是否取决于 django 版本，我应该使用 Django 1.3 进行部署吗？

**编辑**

阿帕奇错误日志：

```
[Thu Aug 23 22:34:04 2012] [error] [client 127.0.0.1] mod_wsgi (pid=7835): Exception occurred processing WSGI script '/home/django_www/hello/apache/django.wsgi'.
[Thu Aug 23 22:34:04 2012] [error] Traceback (most recent call last):
[Thu Aug 23 22:34:04 2012] [error] File "/home/django_www/hello/apache/django.wsgi", line 1, in <module> [Thu Aug 23 22:34:04 2012] [error] import os
[Thu Aug 23 22:34:04 2012] [error] ImportError: No module named os" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T02:47:17.753

mod_wsgi.so 是为特定的 Python 版本编译的。如果您没有安装该版本或强制它使用不同的 Python 版本，您可能会遇到此问题，这是无法完成的。

找出编译 Python mod_wsgi.so 的版本。

[http://code.google.com/p/modwsgi/wiki/CheckingYourInstallation#Python_Shared_Library](http://code.google.com/p/modwsgi/wiki/CheckingYourInstallation#Python_Shared_Library) [http://code.google.com/p/modwsgi/wiki/CheckingYourInstallation#Python_Installation_In_Use](http://code.google.com/p/modwsgi/wiki/CheckingYourInstallation#Python_Installation_In_Use)

所以首先要做的是弄清楚 mod_wsgi.so 是针对什么编译的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:12:34.377

Web 服务器的文件描述符不足。在 httpd initscript 中使用`ulimit -n`以增加允许的文件描述符的数量。

# jakarta-ee - 如何将 .properties 文件中的值包含到 web.xml 中？

> ID：12099008
> 
> 赞同：8
> 
> 时间：2012-08-23T19:53:49.613
> 
> 标签：jakarta-ee, jboss, web.xml, java-ee-5

我需要将 a 中的一些值包含`file.properties`在`WEB-INF/web.xml`如下内容中：

```
<param-name>uploadDirectory</param-name>
<param-value>myFile.properties['keyForTheValue']</param-value> 
```

我目前正在处理这个：

*   老板
*   JEE5

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-23T20:37:02.950

您可以添加此类，将文件中的所有属性添加到 JVM。并将此类添加到上下文侦听器中`web.xml`

```
public class InitVariables implements ServletContextListener
{

   @Override
   public void contextDestroyed(final ServletContextEvent event)
   {
   }

   @Override
   public void contextInitialized(final ServletContextEvent event)
   {
      final String props = "/file.properties";
      final Properties propsFromFile = new Properties();
      try
      {
         propsFromFile.load(getClass().getResourceAsStream(props));
      }
      catch (final IOException e)
      {
          // can't get resource
      }
      for (String prop : propsFromFile.stringPropertyNames())
      {
         if (System.getProperty(prop) == null)
         {
             System.setProperty(prop, propsFromFile.getProperty(prop));
         }
      }
   }
} 
```

在 web.xml 中

```
 <listener>       
      <listener-class>
         com.company.InitVariables
      </listener-class>
   </listener> 
```

现在您可以使用获取项目中的所有属性

```
System.getProperty(...) 
```

或在 web.xml

```
<param-name>param-name</param-name>
<param-value>${param-name}</param-value> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T22:01:30.957

关于上述接受的解决方案，请注意。

我今天在 jboss 5 上对此进行了试验：在加载`contextInitialized()`之后才调用该方法，`web.xml`因此对系统属性的更改不会及时生效。奇怪的是，这意味着如果您重新部署 webapp（不重新启动 jboss），该属性将在上次部署时设置，因此它可能看起来可以工作。

我们将使用的解决方案是通过 java 命令行将参数传递给 jboss，例如`-Dparameter1=value1 -Dparameter2=value2`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T20:53:49.110

使用 Ant 的 replacetoken 任务。[https://blogs.oracle.com/rajeshthekkadath/entry/automation_using_ant_replace_function](https://blogs.oracle.com/rajeshthekkadath/entry/automation_using_ant_replace_function)

# android - 防止多个通知声音android

> ID：12099011
> 
> 赞同：7
> 
> 时间：2012-08-23T19:53:57.083
> 
> 标签：android, notifications

我正在使用 c2dm (gcm) 在 Android 中开发一个聊天应用程序。如果我的应用程序无法直接显示，每条收到的消息都会引发通知。问题是当用户离开网格时，在这种情况下，c2dm 消息会堆积起来，并在他重新上线时立即传递。在 1 秒内添加所有通知会产生不和谐的通知声音。如何防止这种情况？期望的行为是通知声音播放一次，而tickertext和通知内容与最后收到的消息是最新的

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T12:49:15.980

我最终使用了一个设置在未来 1 秒的闹钟。我以相同的意图设置了多个警报，较早的警报会被自动删除。因此，当第二个在 1 秒间隔内出现时，它会删除第一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:02:50.567

利用 collapse_key 只处理堆栈的最后一个“通知”

有关详细信息，请参阅[https://developers.google.com/cloud-messaging/concept-options#collapsible_and_non-collapsible_messages](https://developers.google.com/cloud-messaging/concept-options#collapsible_and_non-collapsible_messages)

# javascript - 获取特定视图的项目计数

> ID：12099012
> 
> 赞同：1
> 
> 时间：2012-08-23T19:53:59.517
> 
> 标签：javascript, jquery, sharepoint

是否有一段可以运行的 jQuery 或 JavaScript 允许我创建具有“这是列表项的数量：XYZed”的内容编辑器 Web 部件。

我已经尝试过了，但它不起作用：

[http://www.martinhatch.com/2010/09/how-to-achieve-count-on-large.html](http://www.martinhatch.com/2010/09/how-to-achieve-count-on-large.html)

我尝试的是第 4 次尝试。如果有人可以帮助我，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T20:14:14.897

它对我有用。我所要做的就是创建分组视图并将 url 放入代码中。我用引号

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){

//////////
// you will need to change this URL
var url = "http://sppos/Lists/Statistics/Grouped.aspx";
////////// 

var groupings = [];

$.get(url, function(data) {
$(data).find("tbody[id^=titl][groupString] > tr > td").each(

function(index, value){
groupings.push($(this).text());
}
);

$("#placeholder").append("<ul></ul>");

$.each(groupings, function(index, value){

$("#placeholder ul").append("<li>" + value + "</li>")
});
});
});

</script>
<div id="placeholder"></div> 
```

经过测试，没有引号不起作用，这可能是一些悲伤的原因

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T02:12:14.297

按给定顺序尝试这些解决方案/帖子。

[https://sharepoint.stackexchange.com/questions/5477/getting-a-count-of-list-items-in-a-list-via-ecmascript](https://sharepoint.stackexchange.com/questions/5477/getting-a-count-of-list-items-in-a-list-via-ecmascript) [https://sharepoint.stackexchange.com/questions/18050/how -do-i-get-the-number-of-items-in-a-list](https://sharepoint.stackexchange.com/questions/18050/how-do-i-get-the-number-of-items-in-a-list) [http://www.codeproject.com/Questions/266281/jQUERY-TO-GET-COUNT-OF-TOTAL-ITEMS-EXISTED- IN-SP-L](http://www.codeproject.com/Questions/266281/jQUERY-TO-GET-COUNT-OF-TOTAL-ITEMS-EXISTED-IN-SP-L)

# cloudbees - 我们可以让 Windows 中的 CloudBees SDK 敏感吗？

> ID：12099014
> 
> 赞同：1
> 
> 时间：2012-08-23T19:54:03.397
> 
> 标签：cloudbees

我们最近开始使用 CloudBees SDK 在本地进行开发和测试。然后我们使用 CloudBees 命令“bees deploy”将我们的应用程序发送到云端。

我们在 Windows 中运行 SDK，应用程序在 Linux 中部署（我们相信）。Linux 区分大小写，而 Windows 不区分大小写。

有没有办法在 CloudBees SDK 中强制区分大小写？我们确实需要在与以前相同的“环境”中进行开发，但到目前为止情况并非如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T08:26:40.937

SDK 不能使 windows 区分大小写。系统不是，没有其他选项可以在区分大小写的操作系统上运行，可能使用 virtualbox。

# css - Avoid word breaking on first line with CSS

> ID：12099022
> 
> 赞同：-1
> 
> 时间：2012-08-23T19:54:43.403
> 
> 标签：css, text, line, word-wrap

I have some trouble with a container that has comments of users.

What it looks like:

```
Firstname Lastname -
Aenean lacinia bibendum nulla sed consectetur.
Fusce dapibus, tellus ac cursus commod risus. 
```

What I want to change it to:

```
Firstname Lastname - Aenean lacinia bibendum
nulla sed consectetur. Fusce dapibus,
tellus ac cursus commod risus. 
```

So the text will continue on the first line until its out of space and then it will go on new line to continue.

jsFiddle: [jsfiddle.net/qhY34/7](http://jsfiddle.net/qhY34/7)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T00:13:16.873

Use `word-break: break-all;`

instead of `word-wrap: break-word;`

jsFiddle: [http://jsfiddle.net/qhY34/8/](http://jsfiddle.net/qhY34/8/)

# javascript - Javascript验证：页面仍在提交

> ID：12099029
> 
> 赞同：0
> 
> 时间：2012-08-23T19:55:18.753
> 
> 标签：javascript, html, forms, validation

我有一个验证一个字段的表单。警告框出现在错误和 div 更改，但页面继续提交。我需要帮助弄清楚为什么它仍在继续。

**Javascript：**

```
function validateFormOnSubmit(theForm) {
    var reason = '';

    reason += validateName(theForm.signature_name);

    if (reason != '') {
        document.getElementById('error').innerHTML = "<p>* All fields are required.<br><span style='color:red'><strong><u>Some fields need correction:</u></strong></span></p>" // + reason;    
        //alert("Some fields need correction:\n" + reason);
        return false;
    }
    return true;
}

function validateName(fld) {
    var error = '';
    var illegalChars = /\W\s/; // allow letters, numbers, and underscores

    if (fld.value == '') {
        error = document.getElementById('client_name').innerHTML = "<h2 id='client_name' style='color:red'>Client's Last Name:</h2><br>The required field has not been filled in.";
        alert("Do Not Continue");
    } else if ((fld.value.length < 2) || (fld.value.length > 15)) {
        error = document.getElementById('client_name').innerHTML = "<h2 id='client_name' style='color:red'>Client's Last Name:</h2><br>The name is not long enough.";
        alert("Do Not Continue");
    } else if (illegalChars.test(fld.value)) {
        error = document.getElementById('client_name').innerHTML = "<h2 id='client_name' style='color:red'>Client's Last Name:</h2><br>The name field contains illegal characters.";
        alert("Do Not Continue");
    }
    return error;
} 
```

**HTML**

```
<form enctype='multipart/form-data' name='finishJob' id='finishJob' action='finishJob.php' method='POST' onsubmit='return validateFormOnSubmit(this)'>
    <table width='95%' class='tablebox'>
        <tr><td name='error'></td><td><h2>Upload Signature:</h2></br><input name='uploadedfile' id='uploadedfile' type='file' /></td><td><h2 id='client_name'>Client's Last Name:</h2></br><input type='text' id='signature_name' name='signature_name'></td><td><input type='submit' value='Complete Job' class='link-button'></td></tr>
    </table>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:03:05.997

如果您在验证后在 javascript 中提交表单怎么办？像这样：

```
<form enctype='multipart/form-data' name='finishJob' id='finishJob' action='finishJob.php' method='POST' onsubmit='javascript:validateFormOnSubmit(this);return false;'>
    <table width='95%' class='tablebox'>
        <tr><td name='error'></td><td><h2>Upload Signature:</h2></br><input name='uploadedfile' id='uploadedfile' type='file' /></td><td><h2 id='client_name'>Client's Last Name:</h2></br><input type='text' id='signature_name' name='signature_name'></td><td><input type='submit' value='Complete Job' class='link-button'></td></tr>
    </table>
</form>

function validateFormOnSubmit(theForm) {
var reason = '';

  reason += validateName(theForm.signature_name);

  if (reason != '') {
document.getElementById('error').innerHTML="<p>* All fields are required.<br><span style='color:red'><strong><u>Some fields need correction:</u></strong></span></p>"// + reason;   
//alert("Some fields need correction:\n" + reason);
return false;
  } 
  document.finishJob.submit();
  return true; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:09:10.773

所以我通过[jsbeautifier](http://jsbeautifier.org/)运行代码它在你的代码中显示一个随机`0`的。另请查看您的错误消息。您在每一行都复制了相同的错误。您没有开始`<p>`标签。

表单提交的原因可能是代码中某处的 JS 错误。在 JavaScript 控制台上启用调试器。转到控制台并输入

```
validateFormOnSubmit(document.getElementById("finishJob")); 
```

控制台中是否出现错误？

当你这样做时，你会看到一个空错误。为什么？因为你有名字而不是身份证。

```
document.getElementById('error').innerHTML <--I am looking for an id
<td name='error'>  <-- I am not an id! 
```

# google-app-engine - Google AppEngine - 大数据存储读取

> ID：12099032
> 
> 赞同：4
> 
> 时间：2012-08-23T19:55:34.137
> 
> 标签：google-app-engine, google-cloud-datastore

我需要阅读 Google AppEngine 数据存储区中的所有条目来进行一些初始化工作。有很多实体（目前为 80k），而且还在继续增长。我开始达到 30 秒的数据存储查询超时限制。

对于如何在数据存储中对这些类型的大量读取进行分片，是否有任何最佳实践？有什么例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T06:56:43.950

您可以通过多种方式解决此问题：

1.  在具有 10 分钟超时而不是 30 秒（实际上更像 60 秒）的[任务队列](https://developers.google.com/appengine/docs/java/taskqueue/overview)上执行您的代码。最简单的方法是通过[`DeferredTask`](https://stackoverflow.com/questions/7505116/java-gae-deferredtask-example).

    **警告**：DeferredTask 必须是可序列化的，因此很难传递复杂的数据。也不要让它成为一个内部类。

2.  见[后端](https://developers.google.com/appengine/docs/java/backends/overview)。后端实例服务的请求没有时间限制。

3.  最后，如果您需要分解一个大任务并并行执行，那么请查看[mapreduce](http://code.google.com/p/appengine-mapreduce/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T20:56:26.807

StackExchange 上的这个答案对我很有帮助：

[过期查询和应用引擎](https://stackoverflow.com/questions/7456296/expired-queries-and-appengine)

我不得不稍微修改它来为我工作：

```
def loop_over_objects_in_batches(batch_size, object_class, callback):

    num_els = object_class.count() 
    num_loops = num_els / batch_size
    remainder = num_els - num_loops * batch_size
    logging.info("Calling batched loop with batch_size: %d, num_els: %s, num_loops: %s, remainder: %s, object_class: %s, callback: %s," % (batch_size, num_els, num_loops, remainder, object_class, callback))    
    offset = 0
    while offset < num_loops * batch_size:
        logging.info("Processing batch (%d:%d)" % (offset, offset+batch_size))
        query = object_class[offset:offset + batch_size]
        for q in query:
            callback(q)

        offset = offset + batch_size

    if remainder:
        logging.info("Processing remainder batch (%d:%d)" % (offset, num_els))
        query = object_class[offset:num_els]
        for q in query:
            callback(q) 
```

# flash - flash mysql和php的UTF-8编码问题

> ID：12099033
> 
> 赞同：3
> 
> 时间：2011-01-09T07:10:04.863
> 
> 标签：flash, php

我正在使用 Flash 编写在线游戏。我正在通过 PHP 将我的 flash8 电影与 MySQL 数据库连接起来。我在这方面做得很好，一切都很好。

当我尝试将（使用 INSERT SQL func）数据插入非英语的数据库时，问题就来了。换句话说，UTF-8 数据。

我翻了很多关于这些东西的文章并找到并应用了以下内容： 1\. 在 PHP4 中，您需要告诉 PHP 在使用 xml_parser_crater() 函数时使用 UTF-8，但是在 PHP5 中这是自动完成的。即使我在调用函数时告诉 PHP5 使用 UTF-8。

1.  将标头添加到从 flash 发送到 PHP 的 XML。

2.  在首选项中强制 FLASH 使用 UTF-8 编码。

3.  将 MySQL 中的编码设置为 UTF-8（带有 InnoDB 引擎的 utf8_unicode_ci）。我也可以在 phpadmin 中正确读取和插入其他语言数据。

我在编码中完成了所有这些，但我仍然无法插入此类数据。

更奇怪的事情是，当我使用相同的链接时，FLASH 使用 XML，FLASH 在浏览器（谷歌浏览器）上创建，我将数据插入到数据库中！！！！！！

我快要为那些东西发疯了，我错过了什么？是什么导致了问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-01-27T23:07:36.347

我认为你需要放弃这些`mysql_*`功能并切换到更好的东西，比如`mysqli_*`PDO。见[http://maurus.net/weblog/2006/07/28/typo3-php-mysql-connections-and-unicode/](http://maurus.net/weblog/2006/07/28/typo3-php-mysql-connections-and-unicode/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-22T16:44:43.180

在调用 mysql_connect/mysql_select_db 之后立即执行以下命令：

```
mysql_query('set character set utf8'); 
```

告诉 PHP-MySQL 驱动程序使用 UTF-8

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-25T22:56:56.610

[使用mysql_real_escape_string()](http://us2.php.net/manual/en/function.mysql-real-escape-string.php)转义数据

# paypal - 贝宝 ipn 和 mysql

> ID：12099042
> 
> 赞同：0
> 
> 时间：2012-08-23T19:55:48.693
> 
> 标签：paypal, sandbox, paypal-ipn

我在这个问题上苦苦挣扎了几天，但没有成功，我对 paypal ipn 比较陌生，但在过去几个月里成功使用了它，现在也许我犯了一些愚蠢的错误，或者 paypal 沙盒 ipn 服务器是不负责任。

**付款已正确处理，钱从买方账户转到卖方，但仍没有在数据库中输入任何详细信息。**

所以这是html表单代码：

```
<form action="https://www.sandbox.paypal.com/cgi-bin/webscr" method="POST">
  <input type="hidden" name="cmd" value="_xclick">
  <input type="hidden" name="business" value="sanboxselleremail">
  <input type="hidden" name="item_name" value="Product">
  <input type="hidden" name="item_number" value="1">
  <input type="hidden" name="amount" value="15">
  <input type="hidden" name="no_shipping" value="1">
  <input type="hidden" name="no_note" value="1">
  <input type="hidden" name="currency_code" value="USD">
  <input type="hidden" name="lc" value="EN">
  <input type="hidden" name="bn" value="PP-BuyNowBF">
  <input type="hidden" name="return" value="http://mysite.com/testipn/">
  <input type="hidden" name="cancel_return" value="http://mysite.com/testipn/">
  <input type="hidden" name="rm" value="2">
  <input type="hidden" name="notify_url" value="http://mysite.com/testipn/ipn.php" />
  <input type="submit" value="submit" />
</form> 
```

这是我在paypal找到的ipn代码：

```
include('db.php');

// read the post from PayPal system and add 'cmd'
$req = 'cmd=_notify-validate';

foreach ($_POST as $key => $value) {
$value = urlencode(stripslashes($value));
$req .= "&$key=$value";
}

// post back to PayPal system to validate
$header .= "POST /cgi-bin/webscr HTTP/1.0\r\n";
$header .= "Content-Type: application/x-www-form-urlencoded\r\n";
$header .= "Content-Length: " . strlen($req) . "\r\n\r\n";
$fp = fsockopen ('ssl://www.sandbox.paypal.com', 443, $errno, $errstr, 30);

// assign posted variables to local variables
$item_name = $_POST['item_name'];
$item_number = $_POST['item_number'];
$payment_status = $_POST['payment_status'];
$payment_amount = $_POST['mc_gross'];
$payment_currency = $_POST['mc_currency'];
$txn_id = $_POST['txn_id'];
$receiver_email = $_POST['receiver_email'];
$payer_email = $_POST['payer_email'];

if (!$fp) {
// HTTP ERROR
} else {
fputs ($fp, $header . $req);
while (!feof($fp)) {
$res = fgets ($fp, 1024);
if (strcmp ($res, "VERIFIED") == 0) {

if($payment_status=='Completed'){

 $paylog = $db->query("INSERT INTO....);

}
else if (strcmp ($res, "INVALID") == 0) {
// log for manual investigation
}
}
fclose ($fp);
} 
```

我已经仔细检查了所有内容，我知道您必须发回所有变量，所以我也检查了它们。sql 语法没有问题，因为我已经对其进行了测试，它会将值输入到我想要的数据库表中。

您能快速浏览一下并指出您可能发现的任何错误吗？

谢谢你。这个问题花费了我很多时间和压力...... :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:16:46.937

嗨，在我看来，它被阻止了，因为当它试图完成该过程时没有重新识别你，我读过很多人都遇到了沙箱问题，paypal 上有一个东西告诉你，brb 发现很容易解决，你需要一个买家沙箱帐户和卖家你都对我的拼写感到抱歉希望这有助于使用它来测试它 [https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_testing_SBAccessing](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_testing_SBAccessing)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T23:09:26.690

您的代码已过时，并且不包含（现在）需要的 HTTP 'Host' 标头。
因此，使用此代码，它永远不会返回“已验证”，而是从 PayPal 返回 HTTP/1.1 400“错误请求”。

要解决此问题，只需更改：
`$header .= "POST /cgi-bin/webscr HTTP/1.0\r\n";`

到：
`$header .= "POST /cgi-bin/webscr HTTP/1.1\r\n";`

并添加：
`$header .= "Host: www.sandbox.paypal.com\r\n";`

Should you just wish to use updated sample code, you can find this at [https://www.paypal.com/ipn/](https://www.paypal.com/ipn/)

# c# - 为什么响应式扩展在编译时向 Microsoft 发送 HTTP GET？

> ID：12099048
> 
> 赞同：11
> 
> 时间：2012-08-23T19:56:11.867
> 
> 标签：c#, system.reactive, linqpad

我从这个站点[http://msdn.microsoft.com/en-us/data/gg577610](http://msdn.microsoft.com/en-us/data/gg577610)下载了 Reactive Extensions v1.0 SP1 的稳定版本，我在 .Net Framework 3.5 环境中使用它（Visual Studio 2008）

我尝试在一个项目中使用 Reactive Extensions，发现它启动起来很慢。转到 LinqPad，我输入了以下“C# 表达式”：

```
(new int[0]).ToObservable() 
```

我还引用了 System.Reactive.dll 并导入了 System.Reactive.Linq 命名空间。当我运行它时，编译和运行需要**12 秒。**

我打开了进程监视器并监视了 LinqPad。我发现它正在向 124.155.222.226 或 124.155.22.59 发送 HTTP 请求。（仅供参考，当您打开 LinqPad 时，它本身也会给 157.55.161.150 打电话）。使用 WireShark，我注意到它正在向

```
http://crl.microsoft.com/pki/crl/products/MicCodSigPCA_08-31-2010.crl 
```

有谁知道当代码使用 Reactive.Extensions 编译时为什么会这样打电话回家？此外，有什么方法可以将其关闭，因为在开发应用程序（并在生产中运行）时，电话回家延迟 12 秒特别不方便。

注意：当您编译代码（或 JIT 在调试时编译它）时，它会像这样打电话回家。实际上看起来并不是运行时行为。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T02:06:54.067

听起来 Rx 程序集是经过 Authenticode 签名的。IMO，对为 Framework 3.5 或更早版本构建的 .NET 程序集进行 Authenticode 签名是错误的 - 因为 CLR 在读取程序集之前会检查证书吊销列表，最多会延迟几秒钟（如果您的 Internet 连接最坏则延迟 30 秒）超时）。

此错误功能已在 CLR 4 中修复：仅在需要时验证 Authenticode 签名，而不是在每次加载程序集时验证。

（正是由于这个原因，LINQPad 可执行文件的 Framework 3.5 版本没有经过 Authenticode 签名。）

也许您可以要求 Rx 团队考虑从反应式程序集的 3.5 版本中删除 Authenticode 签名（假设这确实是问题所在）。

# xcode - 推送通知 - registerForRemoteNotification 失败

> ID：12099055
> 
> 赞同：0
> 
> 时间：2012-08-23T19:56:52.703
> 
> 标签：xcode, push, registration

我试图让我的应用程序为推送通知做好准备，我在应用程序委托中插入了以下代码，但是当我在我的设备（iPhone 3Gs - iOS 5.1.1）上运行应用程序时，应用程序启动正常但“推送警报”如何要求用户允许通知！！！

有人可以帮忙吗？？

来自德国的问候！

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

    [application registerForRemoteNotificationTypes:UIRemoteNotificationTypeBadge|
     UIRemoteNotificationTypeAlert|
     UIRemoteNotificationTypeSound];

    // Override point for customization after application launch.
    return YES;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:06:22.673

您必须在 iOS 配置门户中创建一个新的 appID（不带通配符），例如

com.yourcompanyname.yourappname

并为此应用 ID 启用推送通知。然后创建一个用于构建应用程序的新配置文件。它应该工作！请务必在项目设置中更改捆绑 ID。

希望这可以帮助。

# sql-server-2008 - 如何在 T-SQL 中将 varchar 转换为 datetime？

> ID：12099059
> 
> 赞同：9
> 
> 时间：2012-08-23T19:57:12.983
> 
> 标签：sql-server-2008, datetime, varchar

我正在尝试从 to 填充数据`table1`，`table2`两者的列数相同。

中的所有列`table1`都是 type `varchar`。中的列`table2`可以是`varchar`、`int`或`datetime`等。

我的问题是如何在填充期间进行转换？

这是我编写的示例查询。我错过了进行转换的部分。我的格式`datetime`也是`mm/dd/yyyy hh:mm:ss`.

```
insert into table2
    select s.acty_id, s.notes_datetime, s.notes_data
    from table1 t right join table2 s 
    on (t.acty_id =s.acty_id and t.notes_datetime =s.notes_datetime)
    where t.acty_id is null 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-23T20:02:57.163

您将在您的领域使用[`CAST()`or ：`CONVERT()`](https://docs.microsoft.com/en-us/sql/t-sql/functions/cast-and-convert-transact-sql?view=sql-server-ver15)

```
Declare @dt varchar(20)
set @dt = '08-12-2012 10:15:10'
select convert(datetime, @dt, 101) 
```

对于您的查询，您将执行以下操作：

```
insert into table2
select s.acty_id, s.notes_datetime, s.notes_data
from table1 t 
right join table2 s 
    on t.acty_id =s.acty_id 
    and convert(datetime, t.notes_datetime, 101) = s.notes_datetime
where t.acty_id is null 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T20:05:18.337

正确的答案是更正 table1 以便它使用正确的数据类型。同时，假设您需要同时匹配日期和时间，您可以试试这个：

```
and CONVERT(DATETIME, t.notes_datetime, 101) = s.notes_datetime 
```

# entity-framework-4 - 包含中的 EF Where 子句

> ID：12099066
> 
> 赞同：2
> 
> 时间：2012-08-23T19:57:36.710
> 
> 标签：entity-framework-4

从我从网上偷来的这个例子中：

```
Company company = context.Companies
                     .Include("Employee.Employee_Car")
                     .Include("Employee.Employee_Country")
                     .FirstOrDefault(c => c.Id == companyID); 
```

例如，如果我想在 Employee_Car 的包含中使用 where 子句，我该怎么做？假设我只想让它检索蓝色汽车。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:53:15.833

简短的回答是你不能仅仅通过使用包含来做到这一点。你需要做一些加入。因此，采取这篇[技巧文章](http://blogs.msdn.com/b/alexj/archive/2009/10/13/tip-37-how-to-do-a-conditional-include.aspx)和[SO 答案](https://stackoverflow.com/a/1535618/560237)，您可以按照这些思路做一些事情。（注意不是您的返回类型，而是最接近的）

```
var companyBlueCars = from company in context.Companies
                      where company.Id == companyID 
                      select new 
                      {
                          company,
                          blueCars = from employee in company.Employees
                                     where employee.Employee_Car.Colour == "blue"
                                     select employee.Employee_Car
                      }; 
```

（我确实对数据结构做了一些猜测，但想法就在那里。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:48:49.057

您不会这样做，因为 include 不支持过滤或排序。您必须执行两个单独的查询来加载公司和汽车及其过滤器。

# java - 使用 Apache 的 HTTP 客户端时，将 HTTP 响应作为字符串获取的推荐方法是什么？

> ID：12099067
> 
> 赞同：17
> 
> 时间：2012-08-23T19:57:40.117
> 
> 标签：java, apache-commons-httpclient

我刚刚开始使用 Apache 的 HTTP 客户端库，并注意到没有将 HTTP 响应作为字符串获取的内置方法。我只是想把它作为字符串来获取，这样我就可以将它传递给我正在使用的任何解析库。

将 HTTP 响应作为字符串获取的推荐方法是什么？这是我提出请求的代码：

```
public String doGet(String strUrl, List<NameValuePair> lstParams) {

    String strResponse = null;

    try {

        HttpGet htpGet = new HttpGet(strUrl);
        htpGet.setEntity(new UrlEncodedFormEntity(lstParams));

        DefaultHttpClient dhcClient = new DefaultHttpClient();

        PersistentCookieStore pscStore = new PersistentCookieStore(this);
        dhcClient.setCookieStore(pscStore);

        HttpResponse resResponse = dhcClient.execute(htpGet);
        //strResponse = getResponse(resResponse);

    } catch (ClientProtocolException e) {
        throw e;
    } catch (IOException e) {
        throw e;
    }

    return strResponse;

} 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-08-23T20:04:23.297

你可以用[`EntityUtils#toString()`](http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/util/EntityUtils.html#toString%28org.apache.http.HttpEntity%29)这个。

```
// ...
HttpResponse response = client.execute(get);
String responseAsString = EntityUtils.toString(response.getEntity());
// ... 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T20:08:13.983

您需要使用响应正文并获取响应：

```
BufferedReader br = new BufferedReader(new InputStreamReader(httpresponse.getEntity().getContent())); 
```

然后阅读它：

```
String readLine;
String responseBody = "";
while (((readLine = br.readLine()) != null)) {
  responseBody += "\n" + readLine;
} 
```

responseBody 现在包含您作为字符串的响应。

（最后不要忘记关闭 BufferedReader `br.close()`：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T20:08:55.893

您可以执行以下操作：

```
Reader in = new BufferedReader(
        new InputStreamReader(response.getEntity().getContent(), "UTF-8")); 
```

使用阅读器，您将能够构建您的字符串。但是如果您使用的是 SAX，您可以直接将流提供给解析器。这样您就不必创建字符串，并且您的内存占用也会更低。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-25T20:47:53.393

就代码的简洁性而言，它可能使用这样的[Fluent API](https://hc.apache.org/httpcomponents-client-4.5.x/tutorial/html/fluent.html)：

```
import org.apache.http.client.fluent.Request;
[...]
String result = Request.Get(uri).execute().returnContent().asString(); 
```

尽管文档警告说，这种方法在内存消耗方面并不理想。

# gperf - 检查我当前的 gperf 版本

> ID：12099073
> 
> 赞同：0
> 
> 时间：2012-08-23T19:58:11.267
> 
> 标签：gperf

有没有办法检查我电脑上 gperf 的当前版本？我想使用 gperf3.0.3 而不是 gperf3.0.4 看起来现在检查它的唯一方法就是重新安装

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:44:55.367

正如@Sean Bright所说`gperf --version`

# php - 在成员页面上注销时未定义的索引

> ID：12099075
> 
> 赞同：-2
> 
> 时间：2012-08-23T19:58:17.310
> 
> 标签：php

在我的会员页面上注销时，我有一些未定义的索引，我希望非注册用户或偶然发现该页面的用户可以查看这些索引。

注意：未定义的变量：第 28 行 /home/fights7/public_html/rawfeeds.co.uk/members.php 中的 userblock

```
if($userblock==0) { } 
```

和

注意：未定义的索引：第 31 行 /home/fights7/public_html/rawfeeds.co.uk/members.php 中的 id

```
if($user2_id==$_SESSION['id']){ } 
```

我知道您可以使用 ISSET，但不知道将其放置在其中或周围的何处以使它们按预期工作。

会员.PHP

```
<?php
require_once"header.php";
require_once"include/load.php";

if(isset($_SESSION['id'])){
$user1_id=$_SESSION['id'];
}
if(isset($data['id'])){
$user2_id=$data['id'];
}
if(isset($user2_id,$user1_id)){
$userblock = user_core::check_block($user2_id, $user1_id);
}
switch($userblock){
case "1":
echo'<div class="userinfo"><hr>You Are Blocked From Viewing This Users Profile<hr></div>';
break;
}
?>   
<?
$Members = mysqli_query($mysqli,"SELECT * FROM `users` ORDER BY id");
$numRowsMembers = mysqli_num_rows($Members);
while($row = mysqli_fetch_array($Members)){

$members=user_core::getuser($row['id']);  

if($userblock==0){
$user1_id=(isset($_SESSION['id']));
$user2_id=$row['id'];

if(isset($_SESSION['id']) && $user2_id==$_SESSION['id']){
echo '';
}else{
echo'<div class="userinfo"><table border="0"><tr><td>';
echo '<img border=\'0\' src=\'imgs/cropped'.$user2_id.'.jpg\' onerror="this.src=\'img/no_profile_img.jpeg\'" width=\'40\' ><a href="profile.php?username=' .$row['username'] . '">' . $members['fullusersname'] .'</a></tr></td></table>';

?>
<?
$trimmed = trim($row['lives']);
if(!empty($row['lives']))
echo "<b>Lives In:</b> ".$row['lives'];
echo'</div>';
?>
&nbsp;
<?
$trimmed = trim(isset($data['work']));
if(!empty($data['work']))
 echo "<b>Works at:</b> ".$data['work'];
}
}
}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:58:57.660

试试这个：

```
if(isset($userblock) && $userblock==0) { }

if(isset($_SESSION['id']) && $user2_id==$_SESSION['id']){ } 
```

# tomcat - 在 Tomcat6 上使用带有虚拟主机的 Grails 时重定向主机不正确

> ID：12099079
> 
> 赞同：0
> 
> 时间：2012-08-23T19:58:41.113
> 
> 标签：tomcat, grails, redirect, virtualhost

我有一个运行两个虚拟主机的 tomcat 6 安装，有两个应用程序作为 root。不要管那个。这是一个非常基本的设置：

服务器.xml

```
 <Engine name="Catalina" defaultHost="hostA">
      <Realm className="org.apache.catalina.realm.UserDatabaseRealm"
             resourceName="UserDatabase"/>
      <Host name="hostA"  appBase="webapps"
            unpackWARs="true" autoDeploy="true"
            xmlValidation="false" xmlNamespaceAware="false">
  <Context path="" docBase="Invoices-0.1.war" reloadable="true" useHttpOnly="true"/>
      </Host>
      <Host name="hostB" appBase="webappsTwo" unpackWARs="true" autoDeploy="true" xmlValidation="false" xmlNamespaceAware="false">
        <Context path="" docBase="Engine-0.1.war" reloadable="true" useHttpOnly="true"/>
      </Host>
    </Engine> 
```

很难让它比这更简单。

我遇到的问题是，每当在 hostB 上的引擎应用程序上执行重定向时，它都会发送错误的 URL。它总是指向`http://hostA/Engine/controller/action`它应该指向的时间`http://hostB/controller/action`。

起初我以为是 Config.groovy 和服务器 URL 的问题。我仔细检查过，没问题。我试过删除配置选项，但仍然没有乐趣。hostA 上的第二个应用程序运行良好。

我还检查了代码以确保此处未提及 hostA，但一无所获。

我现在迷路了，有什么建议吗？

编辑：我尝试`grails.serverURL`再次设置指向正确的域并`absolute:true`在重定向中使用，但它仍然将我重定向到不正确的主机。我比以前更迷失了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T06:49:34.350

好吧，这经常发生。更改 grails 中的设置后，我在 tomcat 上错误地部署了我的 webapp，因此没有传播任何更改。该死。我忘了删除 webapps 目录中的旧目录。该死。

# ember.js - 带有项目容器视图的 Ember.js 集合视图

> ID：12099090
> 
> 赞同：1
> 
> 时间：2012-08-23T19:59:30.223
> 
> 标签：ember.js

我目前正在使用一个 ContainerView，它有一个 CollectionView，但想在 CollectionView 的 ItemView 中有另一个 View。我已将 ItemView 更改为 ContainerView，并附加了新的 View，但我无法将父 Collection -> Container 的内容绑定到子 View。

我可以传递值，但由于某种原因绑定只是 barf。

代码：

```
App.MainView = Ember.ContainerView.extend({
    header: Ember.View.create({
        templateName: "headerView"
    }),

    list: Ember.CollectionView.extend({
        contentBinding: "parentView.content",
        itemViewClass: "App.childContainer",
        tagName: "table"
    }),

    footer: Ember.View.create({
        templateName: "footerView"
    })
});

App.childContainer= Ember.ContainerView.extend({
    templateName: "childContainer",
    didInsertElement: function() {
        //NOTE:: THIS WORKS 
        var v = App.childContainerItem.create({"content":this.get('content')});
        //NOTE:: THIS DOESN'T WORK 
        var v = App.childContainerItem.create({"contentBinding":"this.content"});
        this.get('childViews').pushObject(v);    
    }
}); 

App.childContainerItem= Ember.View.extend({
    didInsertElement: function() {
        console.log(this.get('content').get('value'));    
    }   
}); 
```

我得到：`TypeError: this.get("content") is undefined`

我觉得我很亲密，但只是错过了一些愚蠢的事情。有人可以敲敲我的额头吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T10:09:23.483

可以通过添加这一行的didInsertElement函数来获取视图的html内容，

```
App.childContainerItem= Ember.View.extend({
    didInsertElement: function() {
        console.log(this.get('content').get('value'));    
    }   
}); 
```

# .net - 如何使用 .Net 在 Excel 中的合并单元格周围放置边框？

> ID：12099091
> 
> 赞同：1
> 
> 时间：2012-08-23T19:59:34.543
> 
> 标签：.net, excel-interop

如何在合并的单元格周围应用边框？（我不介意它是否在 VB、c# 中......）我的代码只在第一个单元格周围应用边框。

我的代码：

```
Range range = sheet.Cells[r,c]; // Select first cell in a group.
range.Borders = XlLineStyle.xlContinuous; 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T05:09:57.027

```
Range chartrange = worksheet.Range["a5", "d8"];
            chartrange.Merge();

            chartrange = worksheet.Range["a5", "d8"];
            chartrange.Borders.LineStyle = Microsoft.Office.Interop.Excel.XlLineStyle.xlDouble;
            chartrange.Borders.Color = System.Drawing.Color.Red; 
```

这也有效。因此，您可以再次选择合并的单元格范围并在其上应用边框。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T05:48:14.027

试试这个，

```
 Range chartrange = worksheet.Range["a5", "c8"];
  chartrange.Borders.LineStyle = Microsoft.Office.Interop.Excel.XlLineStyle.xlDot;
  chartrange.Borders.Color = System.Drawing.Color.Red;
  chartrange.Merge(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-18T05:18:07.090

在 Interop.Excel 中围绕多个单元格尝试此边框：

```
Excel.Range formatRange;
formatRange = xlWorkSheet.get_Range("b2", "e9");
formatRange.BorderAround(Excel.XlLineStyle.xlContinuous,
Excel.XlBorderWeight.xlMedium, Excel.XlColorIndex.xlColorIndexAutomatic,
Excel.XlColorIndex.xlColorIndexAutomatic); 
```

# php - Javascript：相当于 PHP 的 hash_hmac() 与 RAW BINARY 输出？

> ID：12099092
> 
> 赞同：15
> 
> 时间：2012-08-23T19:59:54.373
> 
> 标签：php, javascript, binary, base64, amazon-product-api

我正在连接到亚马逊产品广告 API，为了签署我的请求，我需要对 HMAC-SHA256 哈希的**原始二进制**输出进行 base64 编码。

在[hash_hmac 的 PHP 文档中](http://php.net/manual/en/function.hash-hmac.php)，第四个参数`bool $raw_output`控制输出是原始二进制数据 (true) 还是小写十六进制 (false)。我的程序只需将该参数设置为 true 即可在 PHP 中运行。

但是，我现在正在尝试将其移植到 Javascript。我尝试使用 CryptoJS.HmacSHA256() 函数，但它似乎返回了小写十六进制。如何将其转换为二进制？

我根据 CryptoJS 文档尝试了以下操作，但两个输出是相同的：

```
var hash = CryptoJS.HmacSHA256("hello", "key");
console.log(hash.toString());
console.log(hash.toString(CryptoJS.enc.Base64)); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-23T20:04:00.640

这在他们的[文档](http://code.google.com/p/crypto-js/#The_Hasher_Output)中进行了解释。试试这个：

```
var hash = CryptoJS.HmacSHA256("Message", "Secret Passphrase");

var base64 = hash.toString(CryptoJS.enc.Base64); 
```

为此，您需要包含[http://crypto-js.googlecode.com/svn/tags/3.0.2/build/components/enc-base64-min.js](http://crypto-js.googlecode.com/svn/tags/3.0.2/build/components/enc-base64-min.js)。如果你没有包括这个，`CryptoJS.enc.Base64`将是`undefined`并回退到默认值。

工作演示：http: [//jsfiddle.net/ak5Qm/](http://jsfiddle.net/ak5Qm/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-11-27T06:06:44.577

PHP：

```
base64_encode(hash_hmac('sha256', $value, $key, true)); 
```

Nodejs等效：

```
const crypto = require('crypto');
let token = crypto.createHmac("sha256", key).update(value).digest().toString('base64'); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-09-22T12:48:23.443

php代码

```
echo base64_encode(hash_hmac('SHA1', 'shanghai', '0', true).'beijing'); 
```

php输出

```
xvBv49PpaYvXAIfy3iOSDWNQj89iZWlqaW5n 
```

节点代码

```
var crypto = require('crypto');
var buf1 = crypto.createHmac("sha1", "0").update("shanghai").digest();
var buf2 = Buffer.from('beijing');
console.log(Buffer.concat([buf1, buf2]).toString('base64')); 
```

节点输出

```
xvBv49PpaYvXAIfy3iOSDWNQj89iZWlqaW5n 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-15T09:16:13.410

你也可以使用这个 npm 包在 Javascript 中做同样的事情。

```
var jsSHA = require('jssha');

hmac_sha1(string, key){
    let shaObj = new jsSHA("SHA-1", "TEXT");
    shaObj.setHMACKey(key, "TEXT");
    shaObj.update(string);
    let hmac = shaObj.getHMAC("B64");
    return hmac;
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-05T09:30:07.913

这对我有用：

```
var CryptoJS = require("crypto-js");
const raw_signature = hmacSHA1(baseString, signingKey);
const signature = raw_signature.toString(CryptoJS.enc.Base64); 
```

它给出的结果与 PHP 中的结果完全相同：

```
$rawSignature = hash_hmac("sha1", $baseString, $signingKey, true);
$signature    = base64_encode($rawSignature); 
```

# c# - TimeSpan如何保存和更新

> ID：12099096
> 
> 赞同：0
> 
> 时间：2012-08-23T20:00:22.153
> 
> 标签：c#

好的..这是我觉得有趣的一个。我正在使用数据表来保存一堆值。我需要存储一个时间跨度。我可以为 TimeSpan 数据类型创建一个列。我能够将数据插入列中。现在是有趣的部分......

我需要提取 TimeSpan 数据并向其添加另一个 TimeSpan 数据值并重新保存。我看到没有办法从字符串中“.toTimeSpan”。这就是我试图把它从桌子上拿回来的方式。

所以......那里的任何人都有答案吗？

代码在 C# 中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:01:58.647

如果你已经*把*它放在了`DataTable`，你不能只转换值吗？

```
TimeSpan span = (TimeSpan) row["foo"];
TimeSpan total = span + otherSpan;
row["foo"] = total; 
```

我希望更棘手的一点是将它存储在数据库中——如果你*不*将它存储在数据库中，我一开始就不会使用`DataTable`，我只是一个集合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:05:49.680

假设您只是将它们存储为字符串，这应该可以；

```
string dbSpanString = "03:50:03"; // From DB
TimeSpan span = TimeSpan.Parse(spanString); 
```

如果存储为时间数据类型，您也可以使用 SqlDataReader.GetTimeSpan() 。

TimeSpan 的运算符重载，因此您可以使用 +/- 或 TimeSpan.Add。

# qt - 带有 Qt 函数 cv::erode() 和 cv::dilate () 的 OpenCV 崩溃

> ID：12099097
> 
> 赞同：2
> 
> 时间：2012-08-23T20:00:31.950
> 
> 标签：qt, image-processing, opencv

```
#include <opencv2/core/core.hpp>
#include <opencv2/imgproc/imgproc.hpp>
#include <opencv2/highgui/highgui.hpp>

#include <QDebug>

int main()
{
    // Read input image
    cv::Mat img= cv::imread("D:\\extra\\Procesare de imagine\\altele\\images\\group.jpg");
    if (!img.data)
    {
        qDebug("no image");
        return 0;

    }

    // Display the image
    cv::namedWindow("Image");
    cv::imshow("Image",img);

    // Erode the image
    cv::Mat eroded;
    cv::erode(img,eroded,cv::Mat());

    cv::waitKey();
    return 0;
} 
```

嗨，我对 opencv（在 Qt 中）函数 erode() 和 dilate() 有以下问题。我使用 msvc10 编译器。我尝试运行一个简单的代码，但是在 cv::erode(img,eroded,cv::Mat()) 行它崩溃了。我没有收到任何错误消息，只是出现“program.exe 已停止工作”的对话框。我转到“调试程序”并得到调用堆栈 tbb.dll（[下面的帧可能不正确和/或丢失，没有为 tbb.dll 加载符号] : )。我提到从一开始我就遇到了在调试模式下构建的问题（imread 在调试中不起作用，只有 cvLoadImage），函数 cv::threshold() 以同样的方式崩溃，代码非常简单。我读到可以通过将 tbb.pdb 复制到 tbb.dll 旁边来解决，但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:36:28.293

只是为了补充 Kamyar 的评论：

如果您在调试配置中进行编译，您可能还必须使用名为 tbb_debug.dll 的 tbb 调试版本。对于适用于 Windows 的 OpenCV 2.4.1，它可以在您的 OpenCV 目录中的 build\common\tbb 下找到。

# networking - 为什么在 Haskell 中使用 Handle 而不是任何类型的网络？

> ID：12099103
> 
> 赞同：3
> 
> 时间：2012-08-23T20:01:11.553
> 
> 标签：networking, haskell, types

通过网络发送和接收的数据的类型是 String 或 Bytestring。我们不能发送任何其他类型，例如`Int`, 或`[Bool]`例如，因为所有内容都通过`Handle`. 我知道我们可以解析它，即使使用`read`，但我认为它并不漂亮，也不可靠，也不有效。

为什么做出这个选择？是因为它在技术上是“不可能的”，还是因为`Network`它只是对 C 库的绑定，因为延迟，还是因为其他原因？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T20:18:39.797

通过网络传输的数据只是一个字节流。您可以在任一端点为该字节流分配意义，但在网络上它没有意义。据我所知，每种语言都是如此，有些人只是选择在他们的标准库中抽象出来。

您可以使用[二进制](http://code.haskell.org/binary/)或[谷物](http://hackage.haskell.org/package/cereal)等包（使用`encode`and`decode`函数）对发送的数据进行编码/解码。对于许多标准类型，如、、和，两者都带有其序列化类的实例（分别为`Binary`和） 。`Serialize``Int``Double``Bool``[]`

# c# - 从 C# 转换后，难以保留通过委托引发事件的方法

> ID：12099105
> 
> 赞同：0
> 
> 时间：2012-08-23T20:01:28.257
> 
> 标签：c#, vb.net, events, delegates, callback

所以在过去的一两天里，我一直在研究[这篇文章](http://www.codeproject.com/Articles/85603/A-WPF-custom-control-for-zooming-and-panning?display=Print)，以便了解依赖属性和路由命令，并希望利用一些示例代码来解决另一个项目中的内容缩放问题。该项目恰好是用 vb.net 编写的，而这个示例代码是用 C# 编写的。

好的没问题。我看到的大多数教程和演示项目都使用 C#，并且我发现阅读代码并在 vb.net 中编写其等价物是了解实际发生的事情并更轻松地使用它们的一种非常好的方法。这很耗时，但在我的经验水平上是值得的 (#00FF00)

不久之后，我遇到了回调方法事件的问题。考虑这种方法：

```
public static class AnimationHelper
{

...

public static void StartAnimation(UIElement animatableElement,
                                  DependencyProperty dependencyProperty,
                                  double toValue,
                                  double animationDurationSeconds,
                                  EventHandler completedEvent)
{
    double fromValue = (double)animatableElement.GetValue(dependencyProperty);

    DoubleAnimation animation = new DoubleAnimation();
    animation.From = fromValue;
    animation.To = toValue;
    animation.Duration = TimeSpan.FromSeconds(animationDurationSeconds);

    animation.Completed += delegate(object sender, EventArgs e)
    {
        //
        // When the animation has completed bake final value of the animation
        // into the property.
        //
        animatableElement.SetValue(dependencyProperty, animatableElement.GetValue(dependencyProperty));
        CancelAnimation(animatableElement, dependencyProperty);

        if (completedEvent != null)
        {
            completedEvent(sender, e);
        }
    };

    animation.Freeze();

    animatableElement.BeginAnimation(dependencyProperty, animation);
} 
```

将此方法转录到 vb.net 很简单，除了正确处理 DoubleAnimation 的 Completed 事件和回调方法的方法。我最好的尝试如下：

```
Public NotInheritable Class AnimationHelper

...

Public Shared Sub StartAnimation(...)

...

animation.Completed += Function(sender As Object, e As EventArgs)

            animatableElement.SetValue(dependencyProperty, animatableElement.GetValue(dependencyProperty))
            CancelAnimation(animatableElement, dependencyProperty)
            RaiseEvent completedEvent(sender, e)
        End Function
...

End Sub 
```

这导致了两个投诉：

1.  'completedEvent' 不是 [namespace].AnimationHelper 的事件

2.  'Public Event Completed(...)' 是一个事件，不能直接调用。使用 RaiseEvent...

(1) 对我来说有点神秘，因为 completedEvent (As EventHandler) 是方法声明中的参数之一。从行首删除 RaiseEvent 并像普通方法一样调用它似乎满足了 Visual Studio，但我不知道这是否会在运行时工作，或者这样做是否有效。在 (2) 中，语法对我来说很可疑，将 RaiseEvent 添加到行首会导致类似于 (1) 的类似投诉。

我将继续在堆栈和更大的互联网上寻找关于 vb.net 中代表和事件的良好入门，因为显然是时候我停止避免学习它们是如何工作的了。同时，建议/建议是最受欢迎的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:05:25.833

1.  为什么要尝试引发该事件处理程序？An`EventHandler`只是一个代表。只需像在 C# 中一样执行它：

    ```
    if completedEvent IsNot Nothing then
        completedEvent(sender, e)
    end if 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:05:42.487

我相信这里的主要问题是您没有以 VB 方式添加处理程序[`AddHandler`](http://msdn.microsoft.com/en-us/library/6yyk8z93.aspx)。如果将代码重写为：

```
Dim handler As EventHandler = Sub(sender, e)
    x.SetValue(dependencyProperty, x.GetValue(dependencyProperty))
    CancelAnimation(x, dependencyProperty)
    ' See note below...
    RaiseEvent completedEvent(sender, e)
End Sub

AddHandler animation.Completed, handler 
```

...我相信它会奏效。目前尚不清楚该`RaiseEvent`部分是否仍会导致问题，但至少订阅`animation.Completed`应该没问题。如果该`RaiseEvent`部分导致问题，请按照 Daniel 的回答直接调用委托。

请注意使用`Sub`here 而不是`Function`，因为委托不返回任何内容。

# java - 无法使用 PhoneGap 插件启动条码扫描器

> ID：12099109
> 
> 赞同：0
> 
> 时间：2012-08-23T20:01:58.753
> 
> 标签：java, android, cordova, zxing, cordova-2.0.0

我正在尝试使用[PhoneGap 的条形码扫描仪插件](https://github.com/phonegap/phonegap-plugins/tree/master/Android/BarcodeScanner)。我已按照自述文件中的说明进行操作，但 PhoneGap 应用程序在我调用时会崩溃`window.plugins.barcodeScanner.scan()`：

```
E/AndroidRuntime(15842): java.lang.RuntimeException: Unable to instantiate
activity ComponentInfo{mypackage/com.google.zxing.client.android.CaptureActivity}:
java.lang.ClassNotFoundException: com.google.zxing.client.android.CaptureActivity 
```

我怀疑这与我添加对插件的 LibraryProject 的引用后，它实际上并没有坚持这一事实有关。当我转到我的项目属性 Android 时，我可以添加对 BarcodeScanner\LibraryProject 的引用：

![引用成功添加到项目](../Images/b346de13264ce32a6d98b742eb9a8fb2.png)

但是在我单击应用和确定然后重新打开项目的属性后，引用有一个红色的 X：

![参考错误！](../Images/88f9c4d3b9b858044c5c5c9d572f7231.png)

这里发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T19:35:58.577

您是否尝试过升级eclipse？我在 Eclipse 没有加载所有文件时遇到一些问题，我必须在 Windows 7 中以管理员身份运行 Eclipse 并升级，这解决了我的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T20:28:46.330

我已经解决了这个问题。不是将 BarCode Library 项目导入 Eclipse，而是创建新项目并手动添加包和类文件。然后无错误地构建库项目。之后，您可以将此库添加到您的项目中，扫描功能将正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T17:40:51.873

我最终只是调用了已安装的 Barcode Scanner 应用程序，而不是尝试将代码包含在我的项目中。

# php - 如何在magento中获得所有最后的订单状态？

> ID：12099113
> 
> 赞同：0
> 
> 时间：2012-08-23T20:02:24.617
> 
> 标签：php, magento, status, orders

如何在 Magento 中获取最后的订单状态？

例如，一个订单可能有多个状态，但我想获得最后一个状态订单的状态。1.待处理=>2.处理=>3\. **完全的**

```
$myOrder=Mage::getModel('sales/order'); 
$orders=Mage::getModel('sales/mysql4_order_collection');
$orders->addFieldToFilter('status',array('in'=> array('processing', 'processed', 'pending fullfilment'))); 

$orders->addFieldToFilter('store_id',array("in" => array('8', '9'))); 

$orders->addAttributeToSort('created_at', 'asc');

$allIds=$orders->getAllIds();

print_r($allIds).'</br></br>';

foreach($allIds as $thisId) {
...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T20:07:05.080

对您的收藏品进行排序的两个最明显的字段是`entity_id`或 c `reated_at`。不过，在几乎所有情况下，您都应该看到每个……的相同结果。

**通过 entity_id**

```
$status = Mage::getModel('sales/order')->getCollection()
    ->setOrder('entity_id', Varien_Data_Collection::SORT_ORDER_DESC)
    ->getFirstItem()
    ->getData('status')
; 
```

**通过 created_at**

```
$status = Mage::getModel('sales/order')->getCollection()
    ->setOrder('created_at', Varien_Data_Collection::SORT_ORDER_DESC)
    ->getFirstItem()
    ->getData('status')
; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T04:41:41.137

实际上应该很简单：

```
$status = Mage::getModel('sales/order')->getCollection()
    ->setOrder('entity_id', Varien_Data_Collection::SORT_ORDER_DESC)
    ->getFirstItem()
    ->getStatus(); 
```

请注意，`status`和`state`是两个略有不同的字段，您可能需要仔细检查并确保您选择了适合您需要的字段。

# mp3 - 使用 JLayer 解码 MP3 文件

> ID：12099114
> 
> 赞同：3
> 
> 时间：2012-08-23T20:02:28.353
> 
> 标签：mp3, decode, jlayer

我想使用 JLayer 来解码 MP3 文件。我已经搜索并搜索了有关如何执行此操作的文档和示例，但没有发现任何用处。我发现的所有内容都嵌入在其他示例或引用 JavaSound 中，这在我的情况下是不可接受的。

我觉得这非常容易，但我不知道该怎么做。不知道参数是干什么用的

```
Decoder decoder = new Decoder();
decoder.decodeFrame(Header header, Bitstream stream); 
```

或如何获得它们。

tl;dr 如何解码只有 JLayer 的 MP3 文件？没有 MP3 SPI、JavaSound、Tritonus——什么都没有。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-15T05:33:56.397

我自己想通了。

```
Bitstream bitStream = new Bitstream(new FileInputStream("path/to/audio.mp3"));

while(condition){
    Decoder decoder = new Decoder();
    int[] samples = decoder.decodeFrame(bitStream.readFrame(), bitStream); //returns the next 2304 samples
    bitStream.closeFrame();

    //do whatever with your samples
} 
```

# qt - win 7 x64 上的 32 位 Qt 应用程序无法运行，但在 Qt Creator 中运行良好？

> ID：12099117
> 
> 赞同：6
> 
> 时间：2012-08-23T20:02:37.197
> 
> 标签：qt, qt4, 32bit-64bit, qt4.7

我的开发箱是 Windows 7 x64。我在我的盒子上构建了 32 位和 64 位版本的 Qt 4.7.4。当我将我的应用程序配置为使用 32 位版本的 Qt 时，它在 Qt Creator (ctrl-R) 中运行良好，但是当我尝试在 Windows 资源管理器中双击 exe（或从 cmd 提示符运行）时，我得到：

```
--------------------------
RenameTemplatePreviewFiles_Qt_win.exe - 应用程序错误
--------------------------
应用程序无法正确启动 (0xc000007b)。
单击确定关闭应用程序。
--------------------------
好的   
--------------------------

```

如果我将我的配置切换到 64 位 Qt 并构建它，我可以双击 exe 并且它运行良好。

我需要做什么才能运行用 32 位 Qt 编译的 exe？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T20:49:10.117

我有根据的猜测是您的应用程序根本找不到所需的 DLL。可以肯定的是，您可以在[Dependency Walker](http://www.dependencywalker.com/)中打开您的 exe，看看它是否找到了所有必要的 DLL。如果一开始似乎没有任何问题，那么使用 Dependency Walker 来分析应用程序。这可能会揭示一些在运行时加载的缺失依赖项。

如果这与您的 Qt DLL 相关，请确保您的 PATH 环境变量中有适当的条目，或者所需的 DLL 包含在您的 EXE 目录中（尽管后者可能不是开发机器上的最佳选择）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-24T10:50:53.510

我遇到了同样的问题。首先，我在我的 .exe 文件所在的发布文件夹中复制了所需的 .dll 文件。然后我复制了额外的 libstdc++-6.dll 文件。程序在此之后开始工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-14T15:04:04.260

只需添加三个缺少的 dll 文件：

*   libwinpthread-1.dll
*   libstdc++-6.dll
*   libgcc_s_dw2-1.dll

到 appl.exe 的文件夹。对于我的系统，那将是目录`C:\Users\H\Documents\build-AQtest01v4-Desktop_Qt_5_11_0_MSVC2017_64bit-Debug`。复制这些库应该可以使您的应用程序正常工作。在我的系统上，这些 dll 可以在`C:\Qt\Tools\mingw492_32\bin`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-27T14:55:10.800

我确实遇到了同样的问题，并想分享我的解决方案。

当我尝试部署 32 位版本时，运行 windeployqt.exe 复制了 32 位可执行文件的错误文件，因为 PATH 设置为 64 位 bin 文件夹（D:\Qt\Qt5.14.2\5.14.2 \msvc2017_64\bin)。

当我将 PATH 设置为 32 位文件夹 (D:\Qt\Qt5.14.2\5.14.2\msvc2017\bin) 并再次运行 windeployqt.exe 时，复制了正确的文件以进行部署并且一切正常。

加里

# linker - 如何优雅地将 .c 文件包含在另一个 .c 中

> ID：12099129
> 
> 赞同：0
> 
> 时间：2012-08-23T20:03:20.827
> 
> 标签：linker, include, makefile, header-files

我有一个 subfolder1/Submain.c

```
{
  //initialize statements
    CallFunction1();
} 
```

子文件夹2/Submain.c

```
{
  //initialize statements
    CallFunction2();
} 
```

等等。

在其中`MainFolder`有一个`make`包含所有子文件夹的文件。像 subfolder1 子文件夹 2 等。主文件夹也有这个`mainfile.h`，它具有所有功能定义（如`CallFunction1`和`CallFunction2`）。我通过实践知道在`.h`文件中包含函数定义不是一个好主意。所以我想创建一个`.h`包含所有函数声明（如接口）的新文件，并将这个 .h 包含在子文件夹中。但我不知道该怎么做。有人可以帮忙吗。所以主要是我不知道如何链接新的 .h 和 .C

这是（BIGDIR/tests/Mainfolder/Subfolder1）中的make文件

* * *

```
include $(BIGDIR)/tests/make/Makefile.defs

TEST_NAME := test1

LCINCS += -I$(BIGDIR)/../tests/Mainfolder

C_FILES := SubMain.c

include $(BIGDIR)/tests/make/Makefile.rules 
```

* * *

这是 SubMain.c

```
#include "Main.h"
{

    // do things
    CallFunction1();  //this function is defined in Main.h which is in Mainfolder

} 
```

* * *

我想以这样的方式修改它，`subfolder1/submain.c` 我可以拥有

```
#include "NewMain.h" 
```

这样`NewMain.h`具有所有函数声明和

`main.c`仍然有所有的函数定义（太老了`Main.h`==> `NewMain.c`）。

Mainfolder 中 Makefile 的当前内容是：

```
include $(BIGDIR)/tests/make/Makefile.defs
SUBDIRS += subfolder1
SUBDIRS += subfolder2
include $(BIGDIR)/tests/make/Makefile.rules 
```

PS：我无权更改规则。但我可以在子文件夹中使用 Main Makefile 和 Makefile。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:13:40.673

每个文件（编译单元）都被单独编译（到 .o 文件中），然后它们被链接在一起。头文件 (new.h) 没有链接，它们用于原型检查。

生成文件：

```
sources=subfolder1/main.c subfolder2/main.c
objects=$(sources:.c=.o)

all:
   gcc $(objects) -o final_binary

%.o: %.c
   gcc -c $< -o $@ 
```

# c# - 由于 IOException，无法删除文件。它正被另一个进程使用

> ID：12099130
> 
> 赞同：1
> 
> 时间：2012-08-23T20:03:22.607
> 
> 标签：c#, using, ioexception

尝试删除文件时，我不断收到上述错误。请参阅代码注释以准确了解错误发生的位置。

```
foreach (string file in supportedFiles)
{
    if (file.EndsWith(".pdf"))
    {
        PDFImageExtractor.ExtractImagesFromPDF(
            file, 
            AppVars.TempFolder, 
            Path.GetFileNameWithoutExtension(file));
    }
}

foreach (string file in supportedFiles)
{
    if (file.EndsWith(".pdf"))
    {
        // I get the error here. 
        File.Delete(file);
    }
} 
```

这是错误之前的代码，在 PDFImageExtractor.ExtractImagesFromPDF 方法中：

```
public static void ExtractImagesFromPDF(
    string sourcePdf, 
    string outputPath, 
    string fileName)
{
    // NOTE: This will only get the first image it finds per page.
    PdfReader pdf = new PdfReader(sourcePdf);
    RandomAccessFileOrArray raf = 
        new iTextSharp.text.pdf.RandomAccessFileOrArray(sourcePdf);

    try
    {
        for (int pageNumber = 1; pageNumber <= pdf.NumberOfPages; pageNumber++)
        {
            PdfDictionary pg = pdf.GetPageN(pageNumber);
            PdfDictionary res = (PdfDictionary)PdfReader.GetPdfObject(pg.Get(PdfName.RESOURCES));
            PdfDictionary xobj = (PdfDictionary)PdfReader.GetPdfObject(res.Get(PdfName.XOBJECT));

            if (xobj != null)
            {
                foreach (PdfName name in xobj.Keys)
                {
                    PdfObject obj = xobj.Get(name);
                    if (obj.IsIndirect())
                    {
                        PdfDictionary tg = (PdfDictionary)PdfReader.GetPdfObject(obj);
                        PdfName type = 
                            (PdfName)PdfReader.GetPdfObject(tg.Get(PdfName.SUBTYPE));

                        if (PdfName.IMAGE.Equals(type))
                        {
                            int XrefIndex = Convert.ToInt32(((PRIndirectReference)obj).Number.ToString(CultureInfo.InvariantCulture));
                            PdfObject pdfObj = pdf.GetPdfObject(XrefIndex);
                            PdfStream pdfStrem = (PdfStream)pdfObj;
                            byte[] bytes = PdfReader.GetStreamBytesRaw((PRStream)pdfStrem);
                            if ((bytes != null))
                            {
                                using (MemoryStream memStream = new MemoryStream(bytes))
                                {
                                    memStream.Position = 0;
                                    System.Drawing.Image img = System.Drawing.Image.FromStream(memStream);
                                    // must save the file while stream is open.
                                    if (!Directory.Exists(outputPath))
                                        Directory.CreateDirectory(outputPath);

                                    string path = Path.Combine(outputPath, String.Format(@"{0}.jpg", fileName));

                                    using (EncoderParameters parms = new EncoderParameters(1))
                                    {
                                        parms.Param[0] = new System.Drawing.Imaging.EncoderParameter(System.Drawing.Imaging.Encoder.Compression, 0);
                                        // GetImageEncoder is found below this method
                                        ImageCodecInfo jpegEncoder = GetImageEncoder("JPEG");
                                        img.Save(path, jpegEncoder, parms);
                                    }

                                    //EncoderParameters parms = new EncoderParameters(1);

                                    break;
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
    }
    finally
    {
        pdf.Close();
    }
}

public static ImageCodecInfo GetImageEncoder(string imageType)
{
    imageType = imageType.ToUpperInvariant();

    foreach (ImageCodecInfo info in ImageCodecInfo.GetImageEncoders())
    {
        if (info.FormatDescription == imageType)
        {
            return info;
        }
    }
    return null;
} 
```

我错过了某处的使用！？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T20:29:43.177

“raf”变量未使用且未关闭。它正在锁定文件。

```
RandomAccessFileOrArray raf = 
        new iTextSharp.text.pdf.RandomAccessFileOrArray(sourcePdf); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T20:11:09.833

我认为你的：

```
System.Drawing.Image img = System.Drawing.Image.FromStream(memStream); 
```

缺少使用。

PdfReader 或 RandomAccessFileOrArray 是否实现 IDisposable？

可能很傻，但可能值得使用 Process Explorer 来查看是否有其他东西可以处理文件。

# python - 将不同大小的数据打包成一个无符号整数列表

> ID：12099131
> 
> 赞同：2
> 
> 时间：2012-08-23T20:03:30.640
> 
> 标签：python, memory, pack, unpack

我有一组数据代表我需要在 python 中操作的硬件结构。真正的结构大小为 4 KB……我将举一个简单的例子：

```
Byte(s)  Value  
0-1      0x0102
2-3      0x0304
4-23     "AStrWith20Characters"
24-63    "WoahThisStringHas40CharactersItIsHuge!!!"
64-71    "Only8Chr"
72-74    0x050607
74       0x08
75-127   0x00 (padding) 
```

我的想法是我将这个结构打包成一个 32 位 Int 列表，将列表传递给另一个函数，然后*该*函数将整个 shebang 写入内存。内存写入函数一次接受 64 个字节，所以我必须进行两次调用。

因此，对于上面的示例，我需要进行这些调用（为了便于阅读，我将使用大端序）：

```
WrToMemory([0x01020304, 0x41537472, 0x57697468, 0x3230436, 
            0x61726163, 0x74657273, 0x576F6168, 0x5468697, 
            0x53747269, 0x6E674861, 0x73343043, 0x6861726, 
            0x63746572, 0x73497449, 0x73487567, 0x65212121])

WrToMemory([0x4F6E6C79, 0x38436872, 0x05060708, 0x00000000,  
            0x00000000, 0x00000000, 0x00000000, 0x00000000,  
            0x00000000, 0x00000000, 0x00000000, 0x00000000,  
            0x00000000, 0x00000000, 0x00000000, 0x00000000]) 
```

问题是我不知道如何以任何有效的方式打包这些数据。我一直在努力使用`struct`and `array`，但要么我在概念上遗漏了一些东西，要么我只是使用了错误的工具来完成这项工作。

最终，我知道我可以编写一个毛茸茸的大函数来检查数据类型，执行一系列移位和屏蔽，将 ASCII 转换为十六进制，以及构造我需要的数据包。但这似乎……不优雅。

我认为必须有一种方法告诉 python“这是一个两个字节长的数字。打包它。另一个两个字节的数字，将它附加到最后一个。现在这是一个字符串，有 20 个字节。附加它. 继续直到我们有 64 字节。然后将我们刚刚制作的 64 字节列表转换为 16 个无符号整数的 lsit。

似乎`pack`and`unpack`函数是我应该使用的，但就像我上面所说的......我一定遗漏了一些东西。例如，如何`pack`处理 3 字节数？如果您使用类似 的格式字符串`HB`，则`pack`需要两个参数：

```
>>> pack('HB', 0x050607)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
struct.error: pack requires exactly 2 arguments 
```

而且我不能使用`unpack`，因为它需要一个字符串，而不是数字。

希望我已经把我的问题说清楚了。任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:07:28.897

您使用的是正确的工具，但您告诉 pack 编码 2 个参数，但只传递一个。

字符串的`HB`意思是：打包两个值，一个为无符号短，另一个为无符号字节。传入两个值，它可以工作：

```
>>> pack('HB', 0x0506, 0x07)
'\x06\x05\x07' 
```

只要不断尝试，你就会掌握它的窍门。以下是您示例中的第一组值，采用 Big Endian 表示法：

```
>>> pack('>2H20c40c', 0x0102, 0x0304)
'\x01\x02\x03\x04AStrWith20CharactersWoahThisStringHas40CharactersItIsHuge!!!' 
```

注意开头的“>”，这表示字节序。字符串被转换为序列并作为单独的变量应用。通常，尽管附加它们更容易：

```
>>> pack('>2H20c40c', 0x0102, 0x0304) + "AStrWith20Characters" + "WoahThisStringHas40CharactersItIsHuge!!!"
'\x01\x02\x03\x04AStrWith20CharactersWoahThisStringHas40CharactersItIsHuge!!!' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:16:49.417

您可以`pack`使用您的 struct 格式进行整个操作，并使用例如 32 位字格式对其进行解包：

```
>>> format="cchi"
>>> p=pack(format,"a","b",1,2)
>>> p
'ab\x01\x00\x02\x00\x00\x00'
>>> (z1,z2)=unpack("ii",p)
>>> (z1,z2)
(90721, 2) 
```

# vb6 - 如何使用 VB 6 读取硬盘卷序列号？

> ID：12099135
> 
> 赞同：2
> 
> 时间：2012-08-23T20:03:52.410
> 
> 标签：vb6, ntfs, partition, serial-number, fat

如何在不使用任何 ActiveX 控件或第三方插件的情况下使用 VB 6 读取 HDD 卷序列号？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T00:49:30.440

```
Private Declare Function GetVolumeInformation _
    Lib "kernel32" Alias "GetVolumeInformationA" _
    (ByVal lpRootPathName As String, _
    ByVal pVolumeNameBuffer As String, _
    ByVal nVolumeNameSize As Long, _
    lpVolumeSerialNumber As Long, _
    lpMaximumComponentLength As Long, _
    lpFileSystemFlags As Long, _
    ByVal lpFileSystemNameBuffer As String, _
    ByVal nFileSystemNameSize As Long) As Long

Public Function GetSerialNumber( _
    ByVal sDrive As String) As Long

    If Len(sDrive) Then
        If InStr(sDrive, "\\") = 1 Then
            ' Make sure we end in backslash for UNC
            If Right$(sDrive, 1) <> "\" Then
                sDrive = sDrive & "\"
            End If
        Else
            ' If not UNC, take first letter as drive
            sDrive = Left$(sDrive, 1) & ":\"
        End If
    Else
        ' Else just use current drive
        sDrive = vbNullString
    End If

    ' Grab S/N -- Most params can be NULL
    Call GetVolumeInformation( _
        sDrive, vbNullString, 0, GetSerialNumber, _
        ByVal 0&, ByVal 0&, vbNullString, 0)
End Function 
```

致电：

```
Dim Drive As String
Drive = InputBox("Enter drive for checking SN")
MsgBox Hex$(GetSerialNumber(Drive)) 
```

来源： http: [//www.devx.com/tips/Tip/15908](http://www.devx.com/tips/Tip/15908)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-28T12:53:09.960

以下示例提供了您的 EXE 所在的驱动器的序列号

```
'APi declaration
Declare Function GetVolumeInformation Lib "kernel32" Alias "GetVolumeInformationA" (ByVal lpRootPathName As String, ByVal lpVolumeNameBuffer As String, ByVal nVolumeNameSize As Long, lpVolumeSerialNumber As Long, lpMaximumComponentLength As Long, lpFileSystemFlags As Long, ByVal lpFileSystemNameBuffer As String, ByVal nFileSystemNameSize As Long) As Long

Sub subHDsn()
Dim TempAPi, VolumeSerial As Long
Dim strPATH As String

    On Error Resume Next

    TempAPi = 0
    VolumeSerial = 0
    If App.Path Like "*:*" Then
        'checking whether the drive is local or mapped
        strPATH = Left(App.Path, 3)
    Else
        'if it's a UNC
        strPATH = Left(App.Path, InStr((InStr(3, App.Path, "\") + 1), App.Path, "\"))
    End If
    'call API
    TempAPi = GetVolumeInformation(strPATH, VolumeName, 100, VolumeSerial, 100, FileSystemFlags, FileSystemName, 100)
    If TempAPi = 0 Then
        MsgBox "Error calling API!", 16
        End
    End If
    'convert from HeX
    HDsn = Hex(VolumeSerial)

End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-25T15:52:06.950

以下示例无需 API。

```
Public Function GetSerialNumber(ByVal sDrive As String) As String
   On Error Resume Next
   Open "Vol.bat" For Output As 1
      Print #1, "@vol %1%>DSN"
   Close
   Kill "DSN"
   Shell ("Vol.bat " + sDrive)
   Do
      Open "DSN" For Input As 1
      Input #1, GetSerialNumber
      Input #1, GetSerialNumber
      Close
   Loop While GetSerialNumber = ""
   GetSerialNumber = Right$(GetSerialNumber, 9)
   Kill "Vol.bat"
   Kill "DSN"
End Function 
```

# php - 使用 PHP 和 cURL 发布到 phpBB2 论坛

> ID：12099136
> 
> 赞同：0
> 
> 时间：2012-08-23T20:03:54.087
> 
> 标签：php, curl, phpbb

我正在尝试使用 PHP 和 cURL 发布到在 localhost 上运行的 phpBB2 论坛。我已经很好地处理了登录，这只是我无法理解的帖子。

这是我的代码：

```
<?php

$cookieFile = 'C:\xampp\htdocs\cookies\\' . uniqid(true) . '.txt';

// Login
$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, 'http://localhost/phpbb2/login.php');
curl_setopt($curl, CURLOPT_COOKIEJAR, $cookieFile);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl, CURLOPT_HEADER, true);
curl_setopt($curl, CURLOPT_POST, true);
$postVars = array('username' => 'admin', 'password' => 'password', 'autologin' => 'on', 'login' => 'Log in');
curl_setopt($curl, CURLOPT_POSTFIELDS, $postVars);
$resp = curl_exec($curl);
curl_close($curl);

// Parse sid from cookie file
preg_match('/phpbb2mysql_sid\t(.*)/', file_get_contents($cookieFile), $match);
$sId = $match[1];

// Post
$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, 'http://localhost/phpbb2/posting.php?mode=newtopic&f=1');
curl_setopt($curl, CURLOPT_COOKIEFILE, $cookieFile);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl, CURLOPT_HEADER, false);
curl_setopt($curl, CURLOPT_POST, true);
$postVars = array('subject' => 'Test post',
                  'message' => 'Test post, please ignore.',
                  'sid' => $sId,
                  'f' => 1,
                  'post' => 'Submit');
curl_setopt($curl, CURLOPT_POSTFIELDS, $postVars);
$resp = curl_exec($curl);
curl_close($curl);

echo $resp; 
```

cURL 很好地设置了 cookie，并且我知道`sid`我通过 POST 请求发送的参数是正确的，因为它与数据库中的参数相同。但是，当我运行这段代码时，phpBB 会吐出这个错误：`Invalid Session. Please resubmit the form.`.

我不明白。登录后我正在抓取 cookie，将其与 POST 请求一起发送以创建新主题，但它显示会话无效。

这里可能出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T09:04:30.493

我冒险猜测这是因为你执行

```
curl_close($curl); 
$curl = curl_init(); 
```

登录后，然后发布之前。您想删除这两行并继续使用相同的 curl 句柄。

顺便说一句：您的 phpbb 登录代码对我来说很好用... ;)

# java - Java 库文档许可证

> ID：12099139
> 
> 赞同：1
> 
> 时间：2012-08-23T20:04:00.873
> 
> 标签：java, documentation, licensing

我正在开发一个可以编译到 JVM 的开源编译器 (GPLv2)，我希望能够将 Java 的文档与编译器和 Java 外部类定义一起分发。Java的文档许可如何以这种方式？如果有限制，我可以使用 OpenJDK 的文档吗？

对于我在[http://www.oracle.com/technetwork/java/redist-137594.html](http://www.oracle.com/technetwork/java/redist-137594.html)上读到的内容，Oracle 似乎不允许我们重新分发 API 文档。但是 OpenJDK 呢？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T16:22:20.563

首先，我不是律师，这篇文章不应被视为法律建议。

其次，您正在寻求法律建议。你需要法律顾问。找个律师。不应该向互联网上的一群（半）匿名人士提供法律建议。法律通常是一个平行宇宙，有着复杂的规则，并不总是符合我们自己的规则，而且文字并不总是意味着你认为它们的意思。您需要一位专家来帮助您解决这个问题。

第三，您应该查看源提供的许可证。您已经为 Oracle 做到了这一点，但您似乎没有为 OpenJDK 做到这一点。他们的大部分许可都出现在[http://openjdk.java.net/legal/](http://openjdk.java.net/legal/)，尽管我没有看到任何关于文档的具体内容。JavaDoc 嵌入在源代码中，每个源文件都是单独许可的（根据他们的[FAQ](http://openjdk.java.net/faq/)）......可能有一些类似的东西，也可能没有。

# ios - 在 iOS 上，如果表格只有 20 或 25 行，是否有办法强制创建 UITableViewCell？

> ID：12099141
> 
> 赞同：4
> 
> 时间：2012-08-23T20:04:14.837
> 
> 标签：ios, uitableview

**简短的问题是：**我们是否可以强制`tableView:cellForRowAtIndexPath`调用“未显示的单元格”（例如，单元格 8 到 25），以便我们从服务器预获取图像，并且如果表格只有 20 或 25 行，则永远不会重用单元格?

* * *

**细节：**我认为 的机制`tableView:cellForRowAtIndexPath`主要是为了保留内存，尤其是在 iPhone 或 iPod Touch 上，这样如果一个表有 1000 行，就不会有 1000 个`UITableViewCell`对象（`UITableViewCell`是 的子类`UIView`），这会使用很多内存，但只有 10 个左右的对象，而且这些对象可以“重用”，因此内存使用可以保持在较小的大小。

但是，如果每一行都在服务器上获取了一张图片呢？与其用单独的线程构建单独的图像缓存，我们可以让我们`tableView:cellForRowAtIndexPath`获取前 7 个图像并显示表格，然后强制渲染单元格 8 到 25，并且从不调用`dequeueReusableCellWithIdentifier`（所以我们有 25 个这样的`UITableViewCell`对象和不要重复使用它们）。如何做到这一点，它实际上是一个实用且简单的解决方案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T20:20:02.863

缓存图像几乎不属于视图层；也不会从服务器检索这些图像。

您应该采用您在帖子中描述的方法 - 将图像与表分开缓存，然后从该图像缓存中检索这些图像。

您可以构建一个`ImageProvider`根据其键为您提供图像的类，并使用该提供程序来构建表格单元格。反过来，`ImageProvider`决定是从服务器加载图像还是从缓存加载它们，从表视图中隐藏细节。

这种方法为您提供了很大的灵活性：如果您决定通过在设备上本地缓存图像来节省网络流量，使用单独缓存的方法可以让您在不干扰视图层的情况下做到这一点。它还允许您通过将缓存的图像刷新到临时文件来节省内存，例如，在收到内存不足警告时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:08:45.800

你不能强迫`UITableView`to 打电话`tableView:cellForRowAtIndexPath`。

我能想到的解决方法是`UITableViewCell`提前创建实例，将它们存储在一个`NSArray`并`tableView:cellForRowAtIndexPath`返回您已经创建的实例，索引预先创建的行数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T03:09:14.050

与加载所有单元格相比，预取所需的所有图像要好。我建议为此目的使用[SDWebImage](https://github.com/rs/SDWebImage)。它还包括一个[图像预取](https://github.com/rs/SDWebImage/blob/master/SDWebImage/SDWebImagePrefetcher.h)器，您可以使用它在显示 UITableView 内容之前加载所有图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T21:26:08.930

虽然这是一个糟糕的想法，但可以通过创建一个与表格一样大的 UIScrollView，然后添加一个禁用滚动的 UITableView 来做到这一点。

```
CGSize tableSize = CGSizeMake(320, 1000);
UIScrollView* aScrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, tableSize.width, tableSize.height)];

UITableView* aTableView = [[UITableView alloc] initWithFrame:CGRectMake(0, 0, tableSize.width, tableSize.height)];
aTableView.scrollEnabled = NO;
[aScrollView addSubview:aTableView];
[aTableView release];

[self.view addSubview:aScrollView];
[aScrollView release]; 
```

# java - 我应该为 webapps 使用 StringBuilder 还是 StringBuffer？

> ID：12099149
> 
> 赞同：7
> 
> 时间：2012-08-23T20:05:21.537
> 
> 标签：java, thread-safety, stringbuilder, stringbuffer, java-6

我用 Java 1.6 编写了一个 webapp 并在 tomcat 中运行它。虽然我没有做任何显式线程，但我想知道 Spring 和 Tomcat 在幕后发生了什么。我会使用 StringBuilder 而不是 StringBuffer 遇到任何问题吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-23T20:08:14.593

如果您使用的是局部变量，则可以安全地使用`StringBuilder`. 每个线程都将获得自己的实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T20:11:21.447

通常 Java EE 组件在默认情况下不是线程安全的，因此除非您同步使用 . 的代码块，否则您`StringBuilder`将遇到竞争条件。因此，您要么必须处理同步，要么使用`StringBuffer`.

当然，如前所述，如果`StringBuilder`是局部变量，您不必担心。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-14T15:59:08.393

使用 StringBuilder 因为您的构建器是 doPost 或 doGet 或其他中的局部变量。确实，多个服务器线程使用相同的 servlet 实例，但事实上您的构建器是一个局部变量，没有理由担心！如果您的构建器是您的 servlet 类的成员，那么您肯定会遇到线程安全问题。我猜这不是你的情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T20:10:50.540

如果代码在 Servlet (doGet/doPost) 中，那么多个请求将导致 servlet 实例成为多线程。如果代码在 Spring bean 中，则取决于您将 bean 配置为单例还是原型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-16T12:31:05.437

Java 文档说关于 java.lang.StringBuffer：

> 每当发生涉及源序列的操作（例如从源序列追加或插入）时，此类仅在执行操作的字符串缓冲区上同步，而不在源上同步。

这意味着您对 StringBuffer 的操作将是安全的，即使您处于多线程环境 [如 web 应用程序]。StringBuffer 实例的安全性由变量的范围控制。

# python - 如何打印 QTableView

> ID：12099152
> 
> 赞同：5
> 
> 时间：2012-08-23T20:05:30.013
> 
> 标签：python, qt, printing, pyside, qtableview

我有一个 Python 和 PySide 应用程序，它连接到 mysql 数据库并在 QTableView 中显示查询结果。我需要打印表格视图的内容。这是一些代码：

```
 self.db_table = QtGui.QTableView(self)
    self.model =  QtSql.QSqlQueryModel()
    self.model.setQuery("SELECT * FROM simpsons")
    self.model.setHeaderData(1, QtCore.Qt.Horizontal, self.tr("First Name"))
    self.model.setHeaderData(2, QtCore.Qt.Horizontal, self.tr("Last Name"))
    self.db_table.setModel(self.model) 

    self.print_btn = QtGui.QPushButton("Print")
    self.print_btn.clicked.connect(self.print_btn_clicked)

    def print_btn_clicked(self):
        printDialog = QtGui.QPrintDialog(self.printer, self)
        if printDialog.exec_() == QtGui.QDialog.Accepted:
         #printing code 
```

我找不到这方面的例子，我对文档了解不多，所以我很感激一些帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T22:34:57.783

一种方法是将表格内容转储到 a`QTextDocument`中，然后打印出来。

以下演示使用了一个简单的文本表，但 html 可用于获得更复杂的格式：

```
from PyQt4 import QtGui, QtCore

class Window(QtGui.QWidget):
    def __init__(self, rows, columns):
        QtGui.QWidget.__init__(self)
        self.table = QtGui.QTableView(self)
        model =  QtGui.QStandardItemModel(rows, columns, self.table)
        for row in range(rows):
            for column in range(columns):
                item = QtGui.QStandardItem('(%d, %d)' % (row, column))
                item.setTextAlignment(QtCore.Qt.AlignCenter)
                model.setItem(row, column, item)
        self.table.setModel(model)
        self.buttonPrint = QtGui.QPushButton('Print', self)
        self.buttonPrint.clicked.connect(self.handlePrint)
        self.buttonPreview = QtGui.QPushButton('Preview', self)
        self.buttonPreview.clicked.connect(self.handlePreview)
        layout = QtGui.QGridLayout(self)
        layout.addWidget(self.table, 0, 0, 1, 2)
        layout.addWidget(self.buttonPrint, 1, 0)
        layout.addWidget(self.buttonPreview, 1, 1)

    def handlePrint(self):
        dialog = QtGui.QPrintDialog()
        if dialog.exec_() == QtGui.QDialog.Accepted:
            self.handlePaintRequest(dialog.printer())

    def handlePreview(self):
        dialog = QtGui.QPrintPreviewDialog()
        dialog.paintRequested.connect(self.handlePaintRequest)
        dialog.exec_()

    def handlePaintRequest(self, printer):
        document = QtGui.QTextDocument()
        cursor = QtGui.QTextCursor(document)
        model = self.table.model()
        table = cursor.insertTable(
            model.rowCount(), model.columnCount())
        for row in range(table.rows()):
            for column in range(table.columns()):
                cursor.insertText(model.item(row, column).text())
                cursor.movePosition(QtGui.QTextCursor.NextCell)
        document.print_(printer)

if __name__ == '__main__':

    import sys
    app = QtGui.QApplication(sys.argv)
    window = Window(25, 2)
    window.resize(300, 400)
    window.show()
    sys.exit(app.exec_()) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T22:43:52.450

在搜索打印多页 QTable 的方法时，您可能会发现有人说要像 @ekhumoro 的答案那样转储到 QTextDocument，或者自己手动管理页面大小，直接从表中打印。

这是一个粗略的示例，说明如何通过执行自定义打印方法直接从表中打印：

```
class Window(QtGui.QDialog):

    def __init__(self):
        ...
        self.db_table = TableView(self)         

    def print_table(self):
        dialog = QtGui.QPrintDialog(self)
        if dialog.exec_() == dialog.Accepted:
            self.db_table.print_(dialog.printer())

class TableView(QtGui.QTableView):

    def print_(self, printer):
        model = self.model()

        rows = model.rowCount()
        cols = model.columnCount()

        totalWidth = 0.0
        for i in xrange(cols):
            totalWidth += self.columnWidth(i)

        painter = QtGui.QPainter(printer)

        pageSize = printer.pageRect()
        pageHeight = pageSize.height()

        scaleX = pageSize.width() / totalWidth
        painter.scale(scaleX, 1.0)

        totalHeight = 0.0 

        newPage = False
        offsetY = 0
        for row in xrange(rows):

            height = self.rowHeight(row)
            totalHeight += height
            if totalHeight > pageHeight:
                totalHeight = height 
                printer.newPage()
                newPage = True 

            for col in xrange(cols):
                idx = model.index(row, col)
                option = self.viewOptions()
                option.rect = self.visualRect(idx)

                if newPage:
                    offsetY = option.rect.y()
                    newPage = False

                option.rect.moveTop(option.rect.y()-offsetY)
                self.itemDelegate().paint(painter, option, idx)

        painter.end() 
```

# ruby-on-rails - Rails.env 在测试中返回“开发”导致设计真实性令牌破坏测试？

> ID：12099154
> 
> 赞同：0
> 
> 时间：2012-08-23T20:05:33.367
> 
> 标签：ruby-on-rails, forms, authentication, testing, devise

我开始在我的测试套件中不断收到以下错误：

`NoMethodError: undefined method 'user' for nil:NilClass`

这似乎来自我在测试套件中发出的帖子请求。在堆栈跟踪的顶部附近是以下内容：

```
devise-2.1.2/lib/devise/controllers/helpers.rb:259:in 'handle_unverified_request'
actionpack-3.2.8/lib/action_controller/metal/request_forgery_protection.rb:78:in 'verify_authenticity_token' 
```

这是有道理的，因为我在发布请求中传递的只是一封电子邮件，而不是真实性令牌。但是，我觉得它们应该以某种方式通过设计来处理。我包括`Devise::TestHelpers`，并且不需要调用 sign_in 来执行此请求。

经过进一步检查，我发现如果我`raise Rails.env.inspect`，我收到了“发展”。这是设计期望有真实性令牌的原因吗？如何强制它在测试环境中运行（我猜测并尝试`$ rake test:functionals -e test`无济于事）？

造成这种情况的线路是

`post :forgot_password, {:user => { :email => users(:quentin).email }}`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T17:44:19.190

该错误是由于我在开发中运行的测试。当我让它在测试环境中运行时，错误就消失了。

它没有在测试环境中运行的原因是因为我一直在升级，并且我已经完成了“全部替换”`RAILS_ENV`并且`Rails.env`我已经`ENV["Rails.env"]`在我的测试助手中列出了。我猜 Rails 只是忽略了这一点并默认使用开发环境

# jquery - 在悬停的 td 上方的 td 上覆盖 div

> ID：12099161
> 
> 赞同：0
> 
> 时间：2012-08-23T20:06:04.687
> 
> 标签：jquery, html, html-table, overlay, shadowing

我有一个表，他由 3 列和 n 行组成。我想做的是这个。当您将鼠标悬停在 td 上时，上面所有的 td 都将被“着色”，我尝试仅使用 onmouseover 和 box-shadow 执行此操作，但文本会出现在阴影上方。于是我想，为什么不直接做一个透明背景的div，然后把盒子阴影放在那里呢？当我在萤火虫中插入 div 时，效果很好。所以我继续尝试使用 jQuery 动态创建 div。他是我的js文件中的相关代码，适用于盒子阴影的东西。

TL;DR：我需要在所有 td 上创建 div，直接在您悬停的上方并做一个 box-shadow 插图

所有这些都在 td 鼠标上

```
 var col , row, t=$(this);
    col = t.index();
    row= t.closest('tr').index();
    var end = 3 * row + col -1;

  while(end > 0){

      var i=1;
      var tdLeftPosition = $('td:eq('+ end-3 +')').offset().left;
      var tdTopPosition = $('td:eq('+ end-3 +')').offset().top;
      var tdWidth = $('td:eq(2)').css('width');
      var tdHeight = $('td:eq(2)').css('height');

      $("<div class = 'shadow-box' id='divTdOverlay"+i+"' style='height:"+ tdHeight+"px;width:"+ tdWidth +"px;top:"+ tdTopPosition +"px;left:"+ tdLeftPosition +"px;' />");
//This is the box shadowing that I have comented out
//    $('td').slice(end-3, end-2).stop().animate({boxShadow: '0 0 170px #000000 inset'}, 'fast');
      i++;
      // used to get the td's position in the array one row up 
      end -= 3;
  } 
```

所以当我在我的网站上尝试鼠标悬停时，我收到了这个错误

> 语法错误，无法识别的表达式：NaN)
> throw new Error("语法错误，无法识别的表达式：" +msg );

它位于未压缩的 jQuery 文件的第 4267 行

编辑：

弄清楚了。出于某种原因，end-3 部分导致了错误，所以我将它放在一个名为 prevrow 的变量中并用它替换了 end-3

```
 var i=1;
 var prevrow = end-3;
 var tdLeftPosition =  $('td:eq('+ prevrow +')').offset().left;
 var tdTopPosition = $('td:eq('+ prevrow +')').offset().top;
 var tdWidth = $('td:eq(2)').css('width');
 var tdHeight = $('td:eq(2)').css('height'); 
```

但是div仍然没有出现。关于那个问题：如果有人有任何建议，我仍然会很感激他们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T07:11:53.473

这是我的做法：

您可以通过将其保存为 HTML 页面并在浏览器中打开它来快速轻松地测试它！

```
<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js""></script>
    <style>
        td {
            padding: 5px;
        }
        .shadow-box {
            padding: 5px;
            display: none;
            position: absolute;
            background: rgba(0, 0, 0, 0.7); 
            z-index: 10;

        }
    </style>
    <script>
        var getRow = function(td) {
            var row = td.parent().parent().children().index(td.parent());
            return row;
        }
        var getCol = function(td) {
            var col = $(td).parent().children().index(td);
            return col;
        }

        $(function () {         

            $('td').each(function () {

                var $this = $(this);
                var pos = $this.position();
                var width = $this.width();
                var height = $this.height();

                $('body').append("<div class='shadow-box "+ getRow($this)  +getCol($this) +"' style='width:" + width + "px; height: " + height + "px; top: " + pos.top + "px; left: " + pos.left + "px;'></div>");       

            });

            $('.shadow-box').hover(function () {
                $(this).hide();
            });

            $('td').hover(function () {

                var col = getCol($(this));
                var row = getRow($(this));

                shadeCells(col, row);
            });

            function shadeCells(col, row) {

                $('td').each(function () {

                    var $this = $(this);
                    var thisRow = getRow($this);
                    var thisCol = getCol($this);

                    if ((thisCol == col) && (thisRow < row)) {

                        $('.' + thisRow + thisCol).show();
                    }

                    else{
                        $('.' + thisRow + thisCol).hide();
                    }

                });

            }
            $('table').mouseleave(function () {
                $('.shadow-box').hide();
            });
        });
    </script>
</head>
<body>

    <table>
        <tr>
            <td>Contents</td>   
            <td>Contents</td>
            <td>Contents</td>
        </tr>
        <tr>
            <td>Contents</td>   
            <td>Contents</td>
            <td>Contents</td>
        </tr>
        <tr>
            <td>Contents</td>   
            <td>Contents</td>
            <td>Contents</td>
        </tr>
        <tr>
            <td>Contents</td>   
            <td>Contents</td>
            <td>Contents</td>
        </tr>
        <tr>
            <td>Contents</td>   
            <td>Contents</td>
            <td>Contents</td>
        </tr>
        <tr>
            <td>Contents</td>   
            <td>Contents</td>
            <td>Contents</td>
        </tr>
        <tr>
            <td>Contents</td>   
            <td>Contents</td>
            <td>Contents</td>
        </tr>
    </table>

</body>
</html> 
```

# javascript - 在浏览器窗口中创建动态灵活的划分标签

> ID：12099162
> 
> 赞同：2
> 
> 时间：2012-08-23T20:06:16.130
> 
> 标签：javascript, jquery, html, css

**我的目标：**我想创建一个 HTML 分区，其样式设置为距浏览器窗口的每个边缘 35 像素。另外，即使用户在浏览器中放大和缩小，并且如果浏览器最大化并且实际监视器是全屏，我也希望这个分割标签在其自身和浏览器边缘之间保持 35px 空间或宽屏显示。

**视觉上：**随着浏览器尺寸的变化动态调整其尺寸的矩形形状，但始终在矩形形状边缘和浏览器窗口边缘之间保持固定空间。

任何有关如何实现此目的的见解将不胜感激。如果我找到了我正在寻找的答案，我将分享一个 JS Bin 示例。

**答案：http:** [//jsbin.com/uxomul/4/edit](http://jsbin.com/uxomul/4/edit)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:09:49.083

这可能不是最好的方法，但这是我脑海中浮现的第一件事。

```
.flex {
    position: absolute;
    right: 35px;
    left: 35px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:11:10.910

这里的 HTML 和 CSS 似乎可以满足您的需求：-

[http://jsbin.com/ifolif/1/edit](http://jsbin.com/ifolaf/1/edit)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T20:13:56.077

尝试使用 100% 宽度的嵌套 div 容器

```
<div class="container">
<div class="content">
 will have 35px
<div>
</div>

.container{
width: 100%;
padding: 35px;
}

.container .content{
width: 100%;
} 
```

# jquery - 带有 twitter 引导文本字段的 jQuery addClass

> ID：12099164
> 
> 赞同：1
> 
> 时间：2012-08-23T20:06:24.447
> 
> 标签：jquery, css, twitter-bootstrap, addclass

我和一个朋友正在构建一个 jQuery Form Creator/Validator 插件，我们也在使用 twitter bootstrap，因为它有漂亮的 css 元素！

**当用户单击提交按钮时，我们希望将一个类（使输入框阴影变为红色）应用于所需的表单元素。**

这适用于除文本之外的所有表单元素。显然 twitter bootstrap css 在某种程度上与类冲突。该类被添加到元素中，但没有任何反应。

如果有人可以给我们一个提示，我们将不胜感激！

这是我们正在构建的代码（当然这是一个简单的版本）：http: [//jsfiddle.net/rdenadai/Hr9Gj/5/](http://jsfiddle.net/rdenadai/Hr9Gj/5/)

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:11:27.260

Bootstrap 的 CSS 规则优先于您的，因为它们更具体，特别是[`input[type="text"]`](http://jsfiddle.net/hTjzh/1/)规则。要覆盖它们，请将`!important`声明添加到您的样式中：

```
.required {
    border:1px solid rgba(196, 39, 39, 0.3) !important;
    -webkit-box-shadow: 0px 0px 5px 2px rgba(196, 39, 39, 0.3) !important;
    box-shadow: 0px 0px 5px 2px rgba(196, 39, 39, 0.3) !important;
}
​ 
```

**[演示](http://jsfiddle.net/hTjzh/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T10:16:32.560

您的 CSS 没有足够具体地针对输入字段，导致 Bootstrap 覆盖它。试试这个：

```
input[type="text"].required {
    border:1px solid rgba(196, 39, 39, 0.3);
    -webkit-box-shadow: 0px 0px 5px 2px rgba(196, 39, 39, 0.3);
    box-shadow: 0px 0px 5px 2px rgba(196, 39, 39, 0.3);
} 
```

# php - 将会话/cookie 设置为 24 小时以每天仅向用户显示一次

> ID：12099170
> 
> 赞同：4
> 
> 时间：2012-08-23T20:06:51.700
> 
> 标签：php, session, cookies

我一直在寻找最后一个小时如何做到这一点......我认为这很容易，但无法让它发挥作用。

我想每天只显示一次（AdSense）。

如果使用 cookie 或 PHP 会话，我不知道最好的方法是什么。无论如何，你能帮助我并告诉我我该怎么做吗？

提前致谢！

圣地亚哥

编辑：我认为这样我可以创建会话，但我不知道如何每 24 小时“重新创建”一次，以及如何检查该会话以显示我想每天显示一次的内容。

```
if (!isset($_SESSION['adSense']) 
    $_SESSION['adSense'] = time();

if (time() - $_SESSION['adSense'] <= 60*60*24 ) {
   return true;
} else {
   return false;
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-23T20:12:16.983

当用户离开网站时，会话将过期，使用 cookie 是您想要的：

```
<? if (!isset($_COOKIE['showstuff'])): ?>

    <!-- replace this whatever you want to show -->

    <?
    setcookie('showstuff', true,  time()+86400); // 1 day
    ?>

<? endif; ?> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-03-21T06:50:03.233

你可以这样做。

1.

```
setcookie('showPopup','yes',time() + 24 * 3600); // 24 hours 
```

2.

```
setcookie('showPopup','yes',strtotime( '+1 days' )); // 24 hours 
```

3.

```
setcookie('showPopup','yes',time() + 86400); // 24 hours 
```

检查饼干

```
if(isset($_COOKIE['showPopup']))
{
     echo 'Not show pop';
}
else{           
    echo 'show popup and set cookie';
    setcookie('showPopup','yes', time() + 86400);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T20:14:43.923

换一种方式怎么样：

*   您检查 cookie 是否存在。
*   如果它在那里，什么也不做
*   如果它不存在，请每天执行一次您想做的事情，并创建一个 24 小时后过期的 cookie。

# javascript - 分页 与 javascript 不工作？

> ID：12099175
> 
> 赞同：1
> 
> 时间：2012-08-23T20:07:32.197
> 
> 标签：javascript, pagination, listjs

我试图让这个分页插件在我的网站上正确激活：http: [//listjs.com/examples/paging.html](http://listjs.com/examples/paging.html)。它处于活动状态但功能不正常，它只显示 3 个列表结果，没有导航到下一页。你可以在这里看到它：http: [//bluebeam.com/us/support/articles/list.asp](http://bluebeam.com/us/support/articles/list.asp)

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script type="text/javascript">

    /*
    * LOVELY THINGS
    */
    var options = {
        valueNames: [ 'name', 'description', 'category' ],
        page: 3,
        plugins: [ [ 'paging' , {
                innerWindow: 1,
                left: 2,
                right: 3} ] ]
    };

    var featureList = new List('support-articles', options);

    $('#filter-install').click(function() {
        featureList.filter(function(item) {
            if (item.values().category == "Common Solutions") {
                return true;
            } else {
                return false;
            }
        });
        return false;
    });

    $('#filter-revu').click(function() {
        featureList.filter(function(item) {
            if (item.values().category == "Revu") {
                return true;
            } else {
                return false;
            }
        });
        return false;
    });

    $('#filter-plugins').click(function() {
        featureList.filter(function(item) {
            if (item.values().category == "Plug-ins") {
                return true;
            } else {
                return false;
            }
        });
        return false;
    });

    $('#filter-printer').click(function() {
        featureList.filter(function(item) {
            if (item.values().category == "PDF Printer") {
                return true;
            } else {
                return false;
            }
        });
        return false;
    });

    $('#filter-admin').click(function() {
        featureList.filter(function(item) {
            if (item.values().category == "Administrator") {
                return true;
            } else {
                return false;
            }
        });
        return false;
    });
    $('#filter-3rd-party').click(function() {
        featureList.filter(function(item) {
            if (item.values().category == "3rd Party") {
                return true;
            } else {
                return false;
            }
        });
        return false;
    });
    $('#filter-video').click(function() {
        featureList.filter(function(item) {
            if (item.values().name == "Video") {
                return true;
            } else {
                return false;
            }
        });
        return false;
    });
    $('#filter-article').click(function() {
        featureList.filter(function(item) {
            if (item.values().name == "Article") {
                return true;
            } else {
                return false;
            }
        });
        return false;
    });
    $('#filter-none').click(function() {
        featureList.filter();
        return false;
    });

</script> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-21T18:18:49.287

`<ul class="paging"></ul>`我在我的容器 div中丢失了一个。

# php - 如何在 Yii 框架应用中实现 Nivo Slider？

> ID：12099178
> 
> 赞同：0
> 
> 时间：2012-08-23T20:07:59.320
> 
> 标签：php, yii, nivo-slider, yii-extensions

我已经下载了 Nivo Slider 并查看了它的自述文件和教程。但是，我在 Yii Frameowrk 中使用它并且不知道如何在其中渲染它。

到目前为止，我已将以下内容添加到我的视图中：

```
Yii::app()->clientScript->regiserPackage('nivo-slider');
Yii::app()->clientScript->render(); 
```

该包在 main.php 中注册为：

```
 'nivo-slider'=>array(
            'basePath'=>'/protected/exensions/nivo-slider',
            'css'=>array('nivo-slider.css'),
            'js'=>array('jquery.min.js'),
            'js'=>array('jquery.nivo-slider.js'),
            ), 
```

我的图像位于单独目录中的文档根目录之外。如何配置 Nivo 以从该目录中读取图像？我的视图中必须包含什么来模拟包含呈现滑块所需的 HTML 的 DIV？

# function - 如何检查停止的网站并使用 powershell 功能启动这些网站

> ID：12099179
> 
> 赞同：2
> 
> 时间：2012-08-23T20:07:59.497
> 
> 标签：function, iis, powershell, web

我目前用新的自给自足的 PowerShell 脚本更新和替换旧的过时的夜间计划批处理文件。

我遇到的问题是网站启动。我可以使用当前的测试代码来获取站点列表并显示它们，但如果它们停止，我无法找到正确启动它们的方法。

```
Set-ExecutionPolicy Unrestricted
start-transcript -path C:\TESTSTART.TXT
#function to get list of websites that are currently stopped
function Get-StoppedSites {
    Import-Module WebAdministration
    $website = Get-ChildItem IIS:\Sites | where {$_.State -eq 'Stopped'}
    write-host "$website is stopped"
    }
#function to start the stopped website
function StartSites {
    param(
    $websitename
    )
    start-website $websitename
    write-host "$website was started"
    }
$Script = Get-StoppedSites
$Script | ForEach-Object{StartSites -websitename $website} 
stop-transcript 
```

当我从 powershell 调用它时，它的行为就像它没有错误地完成，但是我已经停止的网站没有启动。Windows 2008 R2 服务器，PS 2.0。一旦它准备好推出，我将在 2003 服务器上运行它。

这是我的成绩单：

```
Transcript started, output file is C:\TESTSTART.TXT
 is stopped
Start-Website : Cannot validate argument on parameter 'Name'. The argument is null. Supply a non-null argument and try 
the command again.
At C:\Users\Administrator\Desktop\test.ps1:14 char:18
+     start-website <<<<  $websitename
    + CategoryInfo          : InvalidData: (:) [Start-Website], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationError,Microsoft.IIs.PowerShell.Provider.StartWebsiteCommand

 was started
**********************
Windows PowerShell Transcript End
End time: 20120823150248 
```

你们能帮我弄清楚我在这里做错了什么吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T20:29:50.713

试试这个：

```
Set-ExecutionPolicy Unrestricted

Import-Module WebAdministration

$sites = Get-Website | where {$_.State -eq 'Stopped'}

$sites | ForEach-Object {
    $sitename = $_.name
    IF ($sitename -ne $NULL)
    {  
        Write-Host "$sitename is stopped. Starting it..."
        Start-Website $sitename
    }
} 
```

您的代码有几个问题。最重要的`Get-StoppedSites`是，实际上并没有返回任何东西，只是打印出名称。此外，您可以使用现有的命令行开关`Get-Website`来获取网站。

# qt - QWebView 的严重限制

> ID：12099184
> 
> 赞同：1
> 
> 时间：2012-08-23T20:08:49.873
> 
> 标签：qt, qwebview

我在提交给 QWebView 的 HTML 中有一个表格。

该表在应用程序的生命周期中增长。

如果我在旁边管理 html QString 并且每次更新都只是“setHtml”，我会遇到性能问题，向表中添加 1000 行需要几分钟。

难道我没有办法直接在 QWebView 上访问 HTML 并每次都注入新的表格行，直接更新 html 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:55:41.183

我相信您想要的是与[QWebFrame](http://qt-project.org/doc/qt-4.8/qwebframe.html)进行交互，这是最低级别的对象。您可以通过以下方式访问它： `QWebView->page()->mainFrame()`

从 中`QWebFrame`，您可以使用[`evaluateJavaScript()`](http://qt-project.org/doc/qt-4.8/qwebframe.html#evaluateJavaScript)简单地将片段发送到页面以执行。

[`addToJavaScriptWindowObject`](http://qt-project.org/doc/qt-4.8/qwebframe.html#addToJavaScriptWindowObject)或者，您可以使用在 Qt 代码和 javascript 页面之间架起桥梁的框架注册 QObject 。您可以在此处阅读[更多详细信息](http://qt-project.org/doc/qt-4.8/qtwebkit-bridge.html)。但是这种方法会让 javascript 端将函数定义为“插槽”并连接到 QObject 上定义的信号，例如`updateTable()`. 然后，每当您在 Qt 端执行某些操作并使用该信号发出数据时，javascript 都会捕获并处理它。

**Qt**

```
 QWebFrame *frame = myWebPage->mainFrame();
 frame->addToJavaScriptWindowObject("tableHandler", tableHandlerObject); 
```

**Javascript**

```
 function handleTableUpdate() { ... }
 ...
 tableHandler.updateReady.connect(handleTableUpdate); 
```

# c++ - 在构造函数中调用虚函数

> ID：12099186
> 
> 赞同：-1
> 
> 时间：2012-08-23T20:08:53.693
> 
> 标签：c++, constructor, virtual

考虑以下程序：

```
class Base
{
private:
    int m_nID;
public:
    Base()
    {
        m_nID = ClassID();
    }

    // ClassID returns a class-specific ID number
    virtual int ClassID() { return 1; }

    int GetID() { return m_nID; }
};

class Derived: public Base
{
public:
    Derived()
    {
    }

    virtual int ClassID() { return 2; }
};

int main()
{
    Derived cDerived;
    cout << cDerived.GetID(); 
    return 0;
} 
```

在上面的例子中，派生的 id 是 1 而不是 2。我已经在[这里](https://stackoverflow.com/questions/962132/calling-virtual-functions-inside-constructors)找到了关于同一个问题的类似问题。但我不明白的是，如果这是错误的，那么我们应该如何识别一个（派生）类成员并使用它？我的意思是假设我想为每个类（基类，第一个派生类，第二个派生类，它是基类的派生或第二个派生类等等），在这方面我该如何继续行动？我认为正确的方法是在实例化任何类对象时在构造函数中分配一个 id/name，以便立即知道类型。上述方法失败了，在这方面我还有哪些其他选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T20:20:33.633

详细说明 Karoly 所说的，也许你可以避免在构造函数中使用类 ID，但是在构造之后你可以这样做：

```
cout << cDerived.ClassID(); 
```

没有理由让两个函数返回相同的东西，也没有理由将你的`int m_nID;`存储在每个对象中来浪费内存。

此外，您应该更改您的基类，使其显示：

```
virtual int ClassID() = 0; 
```

如果您尝试在 Base 构造函数中调用 ClassID，这*应该*会导致编译器错误，尽管我没有尝试过。此外，它将使 Base 成为一个抽象类，因此您不能创建它的新实例（这很好）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T20:26:16.870

答案很简单：在构造之前，您不能使用任何 C++ 对象。如果您仍在构建基类子对象的过程中，那么您不能使用派生类对象*，因为它还没有被构建。*（只要您在基类构造函数中，当前正在构建的对象的 vptr 仍然指向基类 vtable；在您到达派生类构造函数之前它不会更新。）

但是，基类构造函数如何确定它是为常规对象还是子对象调用呢？好吧，就像它告诉任何其他关于世界的随机信息一样：你必须明确地告诉它。例如：

```
struct Base {
    Base() { puts("I am a whole object!"); }
  protected:
    Base(bool is_subobject) { assert(is_subobject); puts("I'm only part of an object."); }
};

struct Derived : Base {
    Derived(): Base(/*is_subobject=*/true) { }
}; 
```

如果您想成为真正的聪明人，可以使用模板元编程：

```
struct Base {
    int m_nID;

    template<typename T>
    Base(T *)
    {
#ifdef UNSAFE
        // This breaks a lot of rules, but it will work in your case.
        // "this" is a Base, not a Derived, so the cast is undefined;
        // and if ClassID tried to use any non-static data members,
        // you'd be hosed anyway.
        m_nID = reinterpret_cast<T*>(this)->T::ClassID();
#else
        // This version is guaranteed to work in standard C++,
        // but you lose that nice virtual-ness that you worked
        // so hard for.
        m_nID = T::staticClassID();
#endif
    }

    virtual int ClassID() { return 1; }
    static int staticClassID() { return 1; }
    int GetID() { return m_nID; }
};

struct Derived : Base {
    Derived(): Base(this) { }
    virtual int ClassID() { return 2; }
    static int staticClassID() { return 2; }
};

int main() {
    Derived cDerived;
    std::cout << cDerived.GetID() << std::endl; // prints "2"
} 
```

但是正如 Dave S 在我撰写这个答案时所说的那样......如果您的示例就是您所做的一切，那么您可以只使用一个受保护的 Base 构造函数*作为*`int nID`参数，而完全忘记虚拟方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T20:31:20.963

一个`Derived`对象包含一个类型为 的子对象`Base`，该`Base`对象存在于对象“内部” `Derived`。字面意思是里面。如果您获取对象的地址及其`Base`子对象的地址，`Base`则将位于对象占用的内存区域内的某个位置`Derived`。

当你构造一个`Derived`它的构造函数运行时，首先发生的是它构造它的每个基类，然后构造它的每个成员。所以当`Derived::Derived()`开始执行时发生的第一件事就是`Base::Base()`执行。在构造函数期间，对象的*动态类型*还不是 a `Derived`，因为它还没有构造`Derived`部分。因此，当您在构造函数期间调用虚函数时，`Base`它会找到迄今为止已构造的唯一对象的*最终覆盖*`Base`器： part。

在幕后发生的是，当`Base`构造函数启动时，它将对象的 vptr 设置为指向 vtable for `Base`，因此它指向`Base`的虚函数。在完成并且`Derived`对象构造函数运行之后，它会更新 vptr 以指向的 vtable，因此它引用了覆盖`Derived`的函数。`Derived`因此，在`Base`构造函数完成之前，对象的 vptr 只会导致指向由`Base`.

一旦`Derived`构造函数更新了 vptr，调用虚函数将调用`Derived`覆盖，所以你的问题的答案是在派生构造函数中重新分配`m_nId`，当它将调用被覆盖的函数并给你派生类 ID。

# javascript - Javascript jScrollPane 渲染但不滚动？

> ID：12099188
> 
> 赞同：0
> 
> 时间：2012-08-23T20:09:05.593
> 
> 标签：javascript, ruby-on-rails, scroll, jscrollpane

我的网站一直在为我的 Rails 应用程序使用 jscrollpane [ [http://jscrollpane.kelvinluck.com/](http://jscrollpane.kelvinluck.com/) ]，一切都很好。

有人报告说滚动不再在应用程序中工作，我不确定这种情况何时开始发生，也无法追踪到令人沮丧的特定提交。

我做了一个演示页面来展示：[https ://www.vvx.io/scrollpane](https://www.vvx.io/scrollpane)

*   滚动窗格似乎已初始化，但如您所见，它是“不可滚动的” - 我认为/认为这可能是排序问题等或某种冲突，但尽管尝试了很多事情，但我无法弄清楚问题是什么。

有没有人遇到过这种问题和/或有任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T18:03:15.483

从 jquery 1.8 恢复到 1.7.2 解决了这个问题。

# javascript - js私有变量赋值

> ID：12099191
> 
> 赞同：0
> 
> 时间：2012-08-23T20:09:14.147
> 
> 标签：javascript, closures

我在理解 js 的工作原理方面遗漏了一些东西。这是问题所在：

我们声明一个这样的模块：

```
ns.obj = function() {
    // declare private variables
    var test = 1, test1 = 2;

    // declare some private function
    var myFunc=function(){test=2};

        return{test:test, myFunc:myFunc};
} 
```

每次`myFunc`调用，因为我们没有在函数内声明 test js 应该假设我们指的是私有变量。

如果我们有模块，返回的对象确保我们有 test 和 myFunc 可见。所以调用 ns.obj.test 应该首先给我们 1。在我们调用 myFunc 之后应该给我们 2。但它总是 1。为什么会发生这种情况？

这是jsfiddle：http: [//jsfiddle.net/aXuwB/1/](http://jsfiddle.net/aXuwB/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:13:59.370

在 JavaScript 中，覆盖变量不会在其他任何地方覆盖它。您在返回对象中有效地传递了数字 1；没有对`test`变量的引用。

你有一个选项是返回一个函数。函数保存代码，因此可以保存对变量的引用。调用它会给你变量：`test: function() { return test; }`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-02-12T15:27:08.323

```
var User = function () {
    var age = 0; // private
    this.incrementAge = function () { 
      return age++;
    }
    return this.incrementAge(); // closure
};

var firstUser = new User();
console.log('firstUser', firstUser.incrementAge());   // 1

var secondUser = new User();
console.log('secondUser', secondUser.incrementAge()); // 1
console.log('secondUser', secondUser.incrementAge()); // 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T20:24:41.050

`var test=1`我认为这与您每次执行函数时都声明一个新的事实有关。澄清一下，每次调用`ns.obj()`时，都会将新的测试变量重新分配给 1，然后将其返回到对象中。因此，该值始终为 1。

当您调用该`myFunc`函数时，它将根据需要修改您的私有变量，但是您没有一种干净的方式来访问私有变量（无需再次重置该值）。

看看这个，看看这是否表明你想要什么：

```
var ns = {};
ns.obj = function(){
    var test = 1;
    this.myFunc = function(){
        test=2
    };
    this.getTest = function(){
        return test;
    }
}

var testObj = new ns.obj();
console.log(testObj.getTest());
testObj.myFunc()
console.log(testObj.getTest()); 
```

# java - 如何编写 SQL 语句 - 休眠/持久性查询异常 - 无法解析属性

> ID：12099193
> 
> 赞同：1
> 
> 时间：2012-08-23T20:09:21.817
> 
> 标签：java, sql, hibernate, persistence, hql

我是 Hibernate 和 SQL 的新手，所以我可能做错了什么并且看不到它——即使现在已经花了第二天的时间：

在我的 PostgreSQL 数据库中，我有两个表：

```
PieChartResult
+---------+---------+--------------+-------+----------+----------+----------------+
| id      | answer  | approvalrate | input | worktime | workerid | piecharthit_id |
+---------+---------+--------------+-------+----------+----------+----------------+

PieChartHit
+---------+-----------+
| id      | truevalue |
+---------+-----------+ 
```

然后我在 pgAdmin 中编写以下 SQL 语句，效果很好：

```
 SELECT DISTINCT input, answer FROM piecharthit INNER JOIN piechartresult ON piecharthit.id=piechartresult_piecharthit_id; 
```

我得到一个结果表，我可以在其中看到每个输入的所有收集到的答案。

当我尝试在 java 中编写相同的语句时

```
Query q = em.createQuery(SELECT DISTINCT a FROM PieChartHit a INNER JOIN a.PiechartResult b WHERE a.id=b.piecharthit_id") 
```

我只是得到一个例外：

```
Exception in thread "main" java.lang.IllegalArgumentException: org.hibernate.QueryException: could not resolve property: PieChartResult of: PieChartHit [SELECT DISTINCT a FROM PieChartHit a INNER JOIN a.PieChartResult b WHERE a.id=b.piecharthit_id]
at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1364)
at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1300)
at org.hibernate.ejb.AbstractEntityManagerImpl.createQuery(AbstractEntityManagerImpl.java:294)
at Driver.main(Driver.java:37)
Caused by: org.hibernate.QueryException: could not resolve property: PieChartResult of: PieChartHit [SELECT DISTINCT a FROM PieChartHit a INNER JOIN a.PieChartResult b WHERE a.id=b.piecharthit_id] 
```

这两个类看起来像这样：

```
@Entity
@Table(name="PieChartResult")
public class PieChartResult {

@Id
@GeneratedValue
private Long id;

private String workerID;
private String approvalRate;
private String input;
private double answer;

@ManyToOne
private PieChartHit piecharthit; 
```

和

```
@Entity
@Table(name="PieChartHIT")
public class PieChartHit {

@Id
@GeneratedValue
private Long id;

private double trueValue; 
```

有人可以指导这个迷失的灵魂吗？:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:58:01.900

这是与原始评论的延续它显示了如何将结果抓取到列表中。我认为您需要更改您的类定义`PieChartResult`和`PieChartHit`以便休眠工作。

```
String hql = "from CrawlerElement e where request.id = :requestId";
Query q = getSession().createQuery(sql); //getSession is not the actual method.
q.setParameter("requestId", id);
elements = q.list(); //elements is a List<CrawlerElement> where CrawlerElement which is actual @Entity
return elements; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:12:51.190

对于初学者，您应该编写 HQL，而不是 SQL。这意味着您使用类/字段名称而不是表/列名称。请注意，异常显示“无法解析**属性**”。

此外，您在查询行中缺少 hql 字符串周围的引号。

编辑，根据您的代码，您从`PieChartHit`对 的引用中进行选择`PieChartResult`，但看起来关系不是双向的。还

`@Table(name="PieChartHIT")`

看起来你有大小写问题。

# java - 如果用户输入错误答案，如何跳回到 if 语句的开头

> ID：12099196
> 
> 赞同：3
> 
> 时间：2012-08-23T20:09:32.407
> 
> 标签：java, if-statement, input

这是代码：

```
if (g1 == 6) {
   System.out.println("Correct! Proceed to the next challenge");
} 
else {  
   System.out.println("That is incorrect, please try again");
} 
```

例如，如果他们输入“4”进行猜测，我该如何让他们再试一次？基本上，我如何回到`if`语句的开头？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:19:58.217

```
String g1 = "";
try {
    InputStreamReader converter = new InputStreamReader(System.in);
BufferedReader in = new BufferedReader(converter);
    do {
      g1 = in.readLine();
      if (g1 == 6) {
        System.out.println("Correct! Proceed to the next challenge");
      } else {
        System.out.println("That is incorrect, please try again");
      }
    } while(g1 != 6);
} catch (Exception e) {
System.out.println("Error! Exception: "+e); 
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T22:30:05.697

这就是`while`循环的设计目的。

在学习编程时，重点是思考`sequence`指令的通过`if`和`while`构造。如果您收到的建议可以提供一些详细信息，请阅读它。明白它。

想想它在做什么，你想让它做什么——以及你如何弥合这个差距。

如果您问为什么某些东西是“垃圾邮件”，您的想法应该转向导致垃圾邮件的循环*内部还需要发生什么。*

# php - 使用带有嵌套变量的 sprintft() - 如何？

> ID：12099203
> 
> 赞同：0
> 
> 时间：2012-08-23T20:10:04.630
> 
> 标签：php, string, function, printf

我正在尝试使用`gettext()`. 文档是这样说的：

> 使用格式字符串而不是字符串连接——<code>sprintf(__('Replace %1$s with %2$s'), $a, $b); 总是比`__('Replace').$a.__(' with ').$b;`

我想遵循这个建议，但问题来了：

```
<?php _e('You must be', 'textdomain'); ?> 
    <a href="<?php bloginfo('url'); ?>/wp-login.php?redirect_to=<?php the_permalink(); ?>">
        <?php _e('logged in', 'textdomain'); ?>
    </a> 
<?php _e('to post a comment.', 'textdomain'); ?> 
```

这要么需要一些嵌套`sprintf()`，要么我不得不这样 - 分成 3 个字符串（或至少 2 个）。我不是 PHP 专家，所以如果有人知道解决此问题的方法，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:25:06.010

```
<?php
sprintf(_e('You must be <a href="%s">logged in</a> to post a comment.', 'textdomain'), bloginfo('url') . '/wp-login.php?redirect_to=' . the_permalink()); 
```

# jquery - jQuery 将数据从对话框传递到窗口（仅限 IE）

> ID：12099205
> 
> 赞同：0
> 
> 时间：2012-08-23T20:10:33.437
> 
> 标签：jquery, asp.net, jquery-ui, internet-explorer

我正在开发一个系统，当用户在 gridview 中选择一行时，该系统将数据从 jquery-ui 对话框（asp.net 更新面板、搜索数据库和填充 gridview）传递到“主”页面。

一些代码：

JS大师：

```
 $(document).ready(function () {
          $('#PesquisaPessoas').dialog({
              autoOpen: false,
              draggable: false,
              modal: true,
              title: "Busca de pessoas na Base de Dados",
              closeOnEscape: true,
              width: 650,
              height: 350,
              open: function (type, data) {
                  $(this).parent().appendTo("form");
              }
          });
      });
      function showDialog(id) {
          $("#" + id).dialog("open");
      }
      function closeDialog(id) {
          $("#" + id).dialog("close");
      }
      var idCodigo, idNome;
      function armazenaIds(cod, nome) {
          //stores controls' IDs
          idCodigo = cod;
          idNome = nome;
      }
      function preencheTextBoxes(botao) {
          //gets fields 0 and 1 (Person's ID and name) from the selected line
          var codigo = botao.parent().siblings()[0].textContent;
          var nome = botao.parent().siblings()[1].textContent;
          $("#"+idCodigo).val(codigo);
          $("#"+idNome).val(nome);
          $("#CodigoPessoaHiddenField").val(codigo);
      } 
```

'主页：

```
<asp:FormView ID="ContratoFormView" ... et cetera ...>
    ...
    <InsertItemTemplate>
      Contratante:
      <asp:TextBox ID="PSS_COD_PESSOATextBox" runat="server" 
          Width="50px" 
          ReadOnly="True" /> 

      <asp:TextBox ID="PSS_NOMETextBox" runat="server" ReadOnly="True"></asp:TextBox>
      <%-- when user clicks the search button, a js function stores the ids of the two textboxes above --%>
      <input id="PesquisarButton" type="button" 
          style="border-style: none; background-image: url('Icons/Search24.png'); background-repeat: no-repeat; background-color: #FFFFFF; width: 24px; height: 24px;" 
          onclick="showDialog('PesquisaPessoas'); armazenaIds($(this).prev('input').prev('input').attr('id'),$(this).prev('input').attr('id'))" alt="Pesquisar" />
      <asp:HiddenField ID="CodigoPessoaHiddenField" runat="server" 
          ClientIDMode="Static" Value='<%# Bind("PSS_COD_PESSOA") %>' />
      <br />
      <asp:LinkButton ID="InsertButton" runat="server" CausesValidation="True" 
          CommandName="Insert" Text="Cadastrar" />
      &nbsp;<asp:LinkButton ID="InsertCancelButton" runat="server" 
          CausesValidation="False" CommandName="Cancel" Text="Cancelar" />
    </InsertItemTemplate>
    ...
</asp:FormView>

<div id="PesquisaPessoas">
    <uc1:PesquisaPessoas ID="PesquisaPessoas1" runat="server" />
</div> 
```

'PesquisaPessoas' 用户控件：

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
    <ContentTemplate>
        <h3>Escolha um dos campos para realizar a busca</h3>
        <div align="center">
        <asp:RadioButtonList ID="RadioButtonList1" runat="server" 
            RepeatDirection="Horizontal">
            <asp:ListItem Selected="True">Nome</asp:ListItem>
            <asp:ListItem>CPF</asp:ListItem>
            <asp:ListItem>Data Nascimento</asp:ListItem>
        </asp:RadioButtonList>
        <br />

            <asp:TextBox ID="BuscaTextBox" runat="server" AutoPostBack="True" 
                ontextchanged="BuscaTextBox_TextChanged" Width="250px"></asp:TextBox>
            <asp:ImageButton ID="ImageButton1" runat="server" Height="16px" 
                ImageUrl="~/Icons/Search24.png" onclick="ImageButton1_Click" 
                Width="16px" />
        </div>
        <br />
        <asp:GridView ID="BuscaPessoaGridView" runat="server" 
            AutoGenerateColumns="False" DataSourceID="PessoaDataSource" 
            Visible="False" HorizontalAlign="Center" CssClass="SemBordas" >
            <Columns>
                <asp:BoundField DataField="PSS_COD_PESSOA" HeaderText="Código" 
                    SortExpression="PSS_COD_PESSOA" />
                <asp:BoundField DataField="PSS_NOME" HeaderText="Nome" 
                    SortExpression="PSS_NOME" />
                <asp:BoundField DataField="PSS_NUM_CPF" HeaderText="CPF" 
                    SortExpression="PSS_NUM_CPF" />
                <asp:BoundField DataField="PSS_DT_NASCIMENTO" DataFormatString="{0:dd/MM/yyyy}" 
                    HeaderText="Data Nasc." SortExpression="PSS_DT_NASCIMENTO" />
                <asp:BoundField DataField="PSS_SEXO" HeaderText="Sexo" 
                    SortExpression="PSS_SEXO" />
                <asp:BoundField DataField="PSS_NOME_MAE" HeaderText="Nome Mãe" 
                    SortExpression="PSS_NOME_MAE" />
                <asp:TemplateField HeaderText="Escolher" ShowHeader="False">
                    <ItemTemplate>
                        <asp:ImageButton ID="ImageButton1" runat="server" CausesValidation="False" CommandName="Select" 
                            ImageUrl="~/Icons/Checkmark.png" Text="OK"  
                            onclientclick="closeDialog('PesquisaPessoas'); preencheTextBoxes($(this)); return false;" />
                    </ItemTemplate>
                    <ControlStyle Height="24px" Width="24px" />
                    <ItemStyle HorizontalAlign="Center" />
                </asp:TemplateField>
            </Columns>
            <EmptyDataTemplate>
                Nenhuma pessoa encontrada. Verifique se os dados foram digitados corretamente.
            </EmptyDataTemplate>
        </asp:GridView>
        <asp:ObjectDataSource ID="PessoaDataSource" runat="server" 
            SelectMethod="BuscaPessoaPorNome" TypeName="UniVendas.Controle.Fachada.Fachada">
            <SelectParameters>
                <asp:FormParameter FormField="BuscaTextBox" Name="nome" Type="String" />
            </SelectParameters>
        </asp:ObjectDataSource>
    </ContentTemplate>
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="ImageButton1" EventName="Click" />
    </Triggers>
</asp:UpdatePanel> 
```

ScriptManager 在页面的其他地方。此代码在 Firefox 和 Chrome 上运行良好（都是最新的）。

在 IE 中，'main' 中的文本框不是由 JS 填充的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T13:28:35.087

用 JS 控制台“玩”，我发现 IE 使用`innerText`而不是`textContent`.

因此，我创建了一个解决方法来正确获取值：

```
//if user uses IE:
if(navigator.userAgent.search("MSIE") != -1){
    codigo = botao.parent().siblings()[0].innerText;
    nome = botao.parent().siblings()[1].innerText;
}else{

    codigo = botao.parent().siblings()[0].textContent;
    nome = botao.parent().siblings()[1].textContent;
} 
```

# regex - .htaccess 重定向：捕获部分 URL

> ID：12099207
> 
> 赞同：1
> 
> 时间：2012-08-23T20:10:43.640
> 
> 标签：regex, .htaccess, redirect, capture

给定以下网址：

```
www.example.com/old/items/itemid/detail 
```

现在说我想将请求重定向到以下位置：

```
www.example.com/new/product/location/itemid 
```

...当然，“itemid”是动态的，但始终是正好四个数字的序列。

如何在 .htaccess 中创建一个重定向规则，该规则将从原始 URL“捕获”“itemid”并重定向到 URL 末尾具有相同 itemid 的新位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:16:44.970

```
RewriteRule ^old/items/(\d*)/detail$ /new/product/locations/$1 [L,R=301] 
```

应该可以，但我还没有尝试过。基本上，`(\d*)`匹配任意长度的数字，并且可以使用`$1`.

# ios5 - Ad Hoc 构建仅在设备上崩溃 - ASIHTTPRequest

> ID：12099211
> 
> 赞同：1
> 
> 时间：2012-08-23T20:10:58.727
> 
> 标签：ios5, xcode4.3, ad-hoc-distribution, testflight

编辑

此问题与 ASIHTTPRequest 有关。当我删除 ASIHTTPRequest 异步块时，应用程序不再在我的设备上崩溃。我可以在我的设备上运行从 Xcode 加载的 ASIHTTPRequest 代码。只是当我从 TestFlight 上传存档并尝试运行它时它崩溃了。设备崩溃日志显示：

异常类型：EXC_BAD_ACCESS (SIGSEGV) 异常代码：0x00000058 处的 KERN_INVALID_ADDRESS 线程崩溃：0

线程 0 名称：调度队列：com.apple.main-thread 线程 0 崩溃：

突然之间，今天，在通过 TestFlight 上传了 20 个成功的 ad hoc 构建和运行后，我最后的 3 个 AD Hoc 成功上传到了 TestFlight，但在我的测试设备上崩溃了。

从 Xcode 到设备上时，这些构建完美运行。事实上，我可以退出应用程序，断开我的设备与 Xcode 的连接，应用程序运行良好，就像我说的，我能够使用我的 AD Hoc 分发配置文件成功地将这些构建上传到 TestFlight。但是当我去安装和运行时，应用程序执行到启动图像然后崩溃。

Xcode 中的所有设置都保持不变，所以我想知道您是否知道可能导致这种情况的原因？

听起来确实像我的 AD Hoc 分发配置文件，因为这是我从 Xcode VS 从 TestFlight 构建和运行时的唯一区别，但奇怪的是它刚刚停止工作......

其他人有这个问题吗？

接下来我应该尝试什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T21:07:36.227

我遇到了同样的问题，直接从 XCode 构建时它可以完美运行，但是通过 AD Hoc 部署时，它每次都会崩溃。我不知道为什么，但事实证明问题在于`ASIHTTPRequest`完成和失败的块。这是我解决它的方法。

```
ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
        [request setDidFinishSelector:@selector(completedImg:)];
        [request setDidFailSelector:@selector(failedImg:)];
        [request setDelegate:self];
        [request startAsynchronous]; 
```

注意* 我只在下载视频时出现过这种崩溃（由于某种原因，它适用于文档和图像）。

# java - Hibernate 通用 DAO、通用服务和通用视图层？

> ID：12099213
> 
> 赞同：1
> 
> 时间：2012-08-23T20:11:00.307
> 
> 标签：java, spring, hibernate

我一直在尝试在休眠中完全理解和实现一个 GenericDAO 层。我对这个概念很陌生，并且一直在做一些阅读和研究。我在 GenericDAO 层的示例实现中找到了许多示例，这就是我最终得到的。

```
public class GenericDAOImpl<T, ID extends Serializable> implements GenericDAO<T, ID> {

    private static Logger log = Logger.getLogger(GenericDAOImpl.class.getName());

    private SessionFactory sessionFactory;

    @SuppressWarnings("unchecked")
    public T findById(long id, Class<T> objectClass) {
        log.info("Entered GenericDAOImpl findById(" + id +")");
        T result = (T) getSessionFactory().getCurrentSession().load(objectClass, id);
        if(result != null){
            Hibernate.initialize(result);
            return result;
        }else{ 
            return null;
        }
    }

    public boolean create(T newInstance) {
        log.info("Entered GenericDAOImpl create()");
        if(newInstance == null){
            return false;
        }
        getSessionFactory().getCurrentSession().saveOrUpdate(newInstance);
        return true;        
    }

    public boolean updpate(T updateInstance) {
        log.info("Entered GenericDAOImpl updpate()");
        if(updateInstance == null){
            return false;
        }
        getSessionFactory().getCurrentSession().update(updateInstance); 
        return true;
    }

    public boolean delete(T entity) {
        log.info("Entered GenericDAOImpl delete()");
        if(entity == null){
            return false;
        }
        getSessionFactory().getCurrentSession().delete(entity);
        return true;
    }

    @SuppressWarnings("unchecked")
    public List<T> findByExample(T exampleInstance, Class<T> objectClass){
        log.info("Entered GenericDAOImpl findByExample()");
        Criteria searchCriteria = getSessionFactory().getCurrentSession().createCriteria(objectClass);

        searchCriteria.add(Example.create(exampleInstance));

        return (List<T>)searchCriteria.list();          

    }

    public SessionFactory getSessionFactory() {
        return sessionFactory;
    }

    public void setSessionFactory(SessionFactory sessionFactory) {
        this.sessionFactory = sessionFactory;
    }       
} 
```

似乎这在理论上应该可行（可能需要一些调整）

我的问题是我可以使用通用`service`并`view layer`“通过”分层架构方法吗？我对休眠事务的了解不够充分，无法知道这样做是否安全，以及它对事务的处理等......

例如，对于服务层来说可能是这样的

```
public class GenericServiceImpl<T, ID extends Serializable> implements GenericService<T, ID>{

    private GenericDAO<T, ID> genericDao;

    @Override
    public T findById(long id, Class<T> objectClass) {
        return this.getGenericDao().findById(id, objectClass);
    }

    @Override
    public boolean create(T newInstance) {
        return this.getGenericDao().create(newInstance);
    }

    @Override
    public boolean updpate(T updateInstance) {
        return this.getGenericDao().updpate(updateInstance);
    }

    @Override
    public boolean delete(T entity) {
        return this.getGenericDao().delete(entity);
    }

    @SuppressWarnings({ "unchecked", "rawtypes" })
    @Override
    public List findByExample(T exampleInstance, Class<T> objectClass) {
        return this.getGenericDao().findByExample(exampleInstance, objectClass);
    }

    public GenericDAO<T, ID> getGenericDao() {
        return genericDao;
    }

    public void setGenericDao(GenericDAO<T, ID> genericDao) {
        this.genericDao = genericDao;
    }

} 
```

那么我可以继续做一个通用视图层吗？

Please let me know if this approach is acceptable or if there are any concerns with this approach.

Thanks in advance for your thoughts and responses!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-30T20:40:03.587

I have implemented a Generic Entity, Dao and Service for Hibernate

**BaseEntity**

```
@MappedSuperclass
public class BaseEntity implements Serializable {

    private static final long serialVersionUID = -932093556089251203L;

    @Id
    @GeneratedValue
    private Long id;

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

} 
```

**GenericDao**

```
public interface GenericDao<T, ID extends Serializable> {

    T save(T entity);
    T update(T entity);
    void delete(T entity);
    T findById(long id);
    List<T> findAll();
    void flush();
} 
```

**GenericJpaDao**

```
@Transactional
public abstract class GenericJpaDao<T, ID extends Serializable> implements GenericDao<T, ID> {

    private Class<T> persistentClass;

    @PersistenceContext
    private EntityManager entityManager;

    public GenericJpaDao(Class<T> persistentClass) {
        this.persistentClass = persistentClass;
    }

    protected EntityManager getEntityManager() {
        return entityManager;
    }

    @PersistenceContext
    public void setEntityManager(EntityManager entityManager) {
        this.entityManager = entityManager;
    }

    public Class<T> getPersistentClass() {
        return persistentClass;
    }

    @Transactional(readOnly=true)
    public T findById(long id) {
        T entity = (T) getEntityManager().find(getPersistentClass(), id);
        return entity;
    }

    @SuppressWarnings("unchecked")
    @Transactional(readOnly=true)
    public List<T> findAll() {
        return getEntityManager()
            .createQuery("select x from " + getPersistentClass().getSimpleName() + " x")
            .getResultList();
    }

    public T save(T entity) {
        getEntityManager().persist(entity);
        return entity;
    }

    public T update(T entity) {
        T mergedEntity = getEntityManager().merge(entity);
        return mergedEntity;
    }

    public void delete(T entity) {
        if (BaseEntity.class.isAssignableFrom(persistentClass)) {
            getEntityManager().remove(
                    getEntityManager().getReference(entity.getClass(), 
                            ((BaseEntity)entity).getId()));
        } else {
            entity = getEntityManager().merge(entity);
            getEntityManager().remove(entity);
        }
    }

    public void flush() {
        getEntityManager().flush();
    }

} 
```

**GenericService**

```
public class GenericService<T, ID extends Serializable> {
    @Autowired
    private GenericDao<T, ID> genericDao;

    public T find(long id) {
        return this.getGenericDao().findById(id);
    }

    public List<T> all() {
        return this.getGenericDao().findAll();
    }

    @Transactional
    public T create(T newInstance) {
        return (T) this.getGenericDao().save(newInstance);
    }

    @Transactional
    public T updpate(T updateInstance) {
        return (T) this.getGenericDao().update(updateInstance);
    }

    @Transactional
    public void delete(T entity) {
         this.getGenericDao().delete(entity);
    }

    public GenericDao<T, ID> getGenericDao() {
        return genericDao;
    }

    public void setGenericDao(GenericDao<T, ID> genericDao) {
        this.genericDao = genericDao;
    }

} 
```

**For Use :**

**User**

```
@Entity
@Table(name="USER")
public class User extends BaseEntity {

    private static final long serialVersionUID = -6189512849157712745L;

    @Column(name="username", nullable = false)
    private String username;

    @Column(name="name", nullable = false)
    private String name;

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
} 
```

**UserDAO**

```
public interface UserDAO extends GenericDao<User, Long> {

} 
```

**UserDAOImpl**

```
@Repository
public class UserDAOImpl extends GenericJpaDao<User, Long>  implements UserDAO {

    public UserDAOImpl() {
        super(User.class);
    }

    @PersistenceContext
    private EntityManager entityManager;

} 
```

**And Finally the Magic Service my Service Mysv**

```
@Service
public class Mysv extends GenericService<User, Long> {

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T20:32:09.640

Your service, as it stands, is simply delegating everything to the underlying DAO. This may be desired sometimes, but typically I put "business logic" in the service layer. Putting logic in the service layer will help keep your controller layer pretty light too.

A service can use one or more DAOs to accomplish the task it needs. So consider a simple bank system, where I have a AccountDao

```
public class AccountDao implements GenericDao<Account, Long> {
  // your save, insert, delete, find, etc
} 
```

Then in my service, I would put "makePayment" or something

```
@Service
public class AccountService {

   @Autowired
   private AccountDao dao;

   @Transactional
   public void makePayment(Long fromId, Long toId, double amount) {
      Account from = dao.find(fromId);
      from.withdrawl(amount);

      Account to = dao.find(toId);
      to.deposit(amount);

      dao.save(from);
      dao.save(to);
   }
} 
```

Use transactions on your service layer, to give you more control over which operations need to be in the same transaction.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-01T13:13:45.123

Just for your information, there exists a separate code library for GenericDAO [hibernate-generic-dao](https://code.google.com/p/hibernate-generic-dao/)! Its always good to write your own code for the purpose of learning, but I believe its also important to read code of standard libary and frameworks to learn standards that has been adopted there by experts. So, it is recommended to visit this library.

# html - 如何使某些班级不影响班级内部

> ID：12099214
> 
> 赞同：0
> 
> 时间：2012-08-23T20:11:01.690
> 
> 标签：html, css, drop-down-menu

所以我有一个像这样的下拉菜单：

[http://slypaste.org/KmsRuS4k](http://slypaste.org/KmsRuS4k)

对不起，链接，我只是从来没有运气与stackoverflow html系统..

因此，下拉菜单与下拉菜单中看起来很丑的按钮具有相同的样式。我尝试在其 li 样式中添加一个类，但它仍然忽略它

这就是使悬停颜色和下拉菜单的背景：

[http://slypaste.org/5Kxv43WS](http://slypaste.org/5Kxv43WS)

我已经尝试了我所知道的一切，但仍然无法正常工作。

目标：

使菜单下拉颜色和链接看起来与其他菜单完全不同。

现场演示：

[http://justxp.plutohost.net/testing/index.html](http://justxp.plutohost.net/testing/index.html)

如您所见，基本上它从菜单类中获取边框。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:49:15.453

你可以像上面评论中建议的 jzacharia 那样做：

**CSS**

在您的 CSS 文件中，更改以下内容：

```
.menu a
{
    ....
}

.menu a:hover
{
    ....
} 
```

对此：

```
.menu a.title
{
    ....
}

.menu a.title:hover
{
    ....
} 
```

**HTML**

然后你的 HTML 应该看起来像这样：

```
<ul class="menu">
    <li class="current"><span style="color:#bde2e1;">Home</li>
    <li class="dropdown">
        <a id="drop4" role="button" data-toggle="dropdown" href="#" class="dropdown-toggle title">Dropdown <b class="caret"></b></a>
        <ul id="menu1" class="dropdown-menu" role="menu" aria-labelledby="drop4">
            <li><a tabindex="-1" href="#">Action</a></li>
            <li><a tabindex="-1" href="#">Another action</a></li>
            <li><a tabindex="-1" href="#">Something else here</a></li>
            <li class="divider"></li>
            <li><a tabindex="-1" href="#">Separated link</a></li>
        </ul>
    </li>
    <li class="hovering"><a href="#" class="title">Portfolio</a></li>
    <li class="hovering"><a href="#" class="title">Releases</a></li>
    <li class="hovering"><a href="#" class="title">Contact</a></li>
</ul> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:48:50.163

.dropdown-menu a { 背景：无；}

```
.dropdown-menu{
    background-color: to what you want!
    padding:none;
}

.dropdown-menu a {
    color: to what you want!
}

.menu a {
    border-radius:none;
    box-shadow:none;
} 
```

这应该让你开始？

# android - 位图方向更改

> ID：12099218
> 
> 赞同：1
> 
> 时间：2012-08-23T20:11:13.190
> 
> 标签：android, android-camera

我制作了一个自定义相机应用程序，并在相机点击后在图像视图中显示我的图像。但是在这里我面临一个问题，即我捕获的图像总是以改变方向设置。

即，如果我在将相机作为人像时拍摄照片，它不会将图像设置为人像，它会改变方向。

这是相机点击代码：-

```
@Override
        public void onPictureTaken(byte[] data, Camera camera) {

            //here we write the code for saving the picture onto the sdCard

            File pictureFileDir = getDir();

            //to check whether directory exists or not!!
            if (!pictureFileDir.exists() && !pictureFileDir.mkdirs()) {

                //Log.d(Constants.DEBUG_TAG, "Can't create directory to save image.");
                Toast.makeText(Irant_Custom_cameraApplication.this, "Can't create directory to save image.",
                        Toast.LENGTH_LONG).show();
                return;

            }

            SimpleDateFormat dateFormat = new SimpleDateFormat("yyyymmddhhmmss");
            String date = dateFormat.format(new Date());
            photo_file="Picture_"+date+".jpg";

            photo_FileName = pictureFileDir.getPath()+File.separator+photo_file;

            picture_file = new File(photo_FileName);

            FileOutputStream outStream = null;
            try{
                Toast.makeText(getApplicationContext(), "Image captured!", Toast.LENGTH_LONG).show();
                outStream = new FileOutputStream(picture_file);
                outStream.write(data);
                outStream.close();

                String imgpath = photo_file;
                System.out.println("Path for the image*********************"+photo_file);
                SignupDetails.imagePath=imgpath;

            }

            catch (Exception e) {

                Log.d("Image save error :", e.getMessage());    
            }
        }
    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:45:31.330

每个设备的实现并不总是相同的，有些会自动旋转，有些则不会。我认为最好的方法是查看文件的[EXIF](http://developer.android.com/reference/android/media/ExifInterface.html)数据。那是你最好的选择。

# android - Eclipse 不再识别自定义属性？（安卓）

> ID：12099221
> 
> 赞同：1
> 
> 时间：2012-08-23T20:11:17.803
> 
> 标签：android, eclipse, android-resources, declare-styleable

昨天，我的项目正在构建和运行良好。今天，Eclipse 决定不再识别我的自定义属性。我想不出任何我改变的东西会导致这种情况。我有大约 2 打包含自定义属性的 XML 布局，但它无法识别其中的任何一个。这是其中一种布局（在 res/layout 中）：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"
                  xmlns:aes="http://schemas.android.com/apk/res/com.aes.androidapp"
                  android:title="@string/ffour_analog_in_1">
    <com.aes.androidapp.IntPref android:title="@string/ffour_calibration_offset"
                                android:summary="@string/ffour_calibration_offset_sum"
                                android:key="ffour_ain1_calibration_offset"
                                android:defaultValue="0"
                                android:digits="-1234567890"
                                android:gravity="right"
                                android:inputType="numberSigned"
                                aes:range="-19999:30000"/>

    <com.aes.androidapp.IntPref android:title="@string/ffour_filter_time"
                                android:summary="@string/ffour_filter_time_sum"
                                android:key="ffour_ain1_filter_time"
                                android:defaultValue="0"
                                android:digits="-1234567890"
                                android:gravity="right"
                                android:inputType="numberSigned"
                                aes:range="-600:600"/>
</PreferenceScreen> 
```

这是我的属性文件（res/values/attrs.xml）：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <declare-styleable name="IntPref">
        <attr name="range" format="string" />
        <attr name="condition" format="string" />
    </declare-styleable>
</resources> 
```

由于 XML 文件被视为有错误，因此不会生成 R，因此 IntPref.java 也有问题。在过去的 8 个小时里，我一直在为此扯头发，看不到我做错了什么。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:22:56.533

尝试重新启动 Eclipse 以查看是否可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:24:54.770

我遇到了类似的问题，eclipse 没有将它们视为 android xml 布局。我必须通过右键单击布局文件夹/new/other/Android Xml 布局文件来重新创建它们，然后将您的布局复制粘贴到新布局中。

删除或保存旧的并从项目菜单中清理项目。

此外，您应该在活动顶部仔细检查您的导入，如果您在导入中有一个对 android.R 的引用，它将假定其余部分来自 android 系统资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T14:17:31.800

花了将近整整一周的时间才找到问题所在，但我终于找到了：

不知何故，我无意中更改了清单中的包名称。

作为每个人的一般调试提示，我将说是什么帮助我找到了这个问题：我查看了在此问题发生当天/前后在提交中更改的文件（整个项目在 GitHub 上）。我注意到一个提交，其中一个类似项目的大部分清单被复制到这个项目中，包括类似包的包名。因此，该项目清单中的包名称是如何更改的，因此导致它的属性不再被识别的问题。似乎这是一种不太可能发生的问题，以至于没有人会遇到它，但万一它确实发生了，这就是我的问题的最终答案。

# java - 找不到元素“XMLTooling”的声明

> ID：12099224
> 
> 赞同：2
> 
> 时间：2012-08-23T20:11:25.860
> 
> 标签：java, xml, spring, weblogic, ejb-2.x

我们正在从 wls 9.2 升级到 wls 10.3，并且能够成功构建，但是在运行应用程序时出现运行时异常，如下所示：

org.springframework.beans.factory.xml.XmlBeanDefinitionStoreException：来自类路径资源 [common-config.xml] 的 XML 文档中的第 8 行无效；嵌套异常是 org.xml.sax.SAXParseException：cvc-elt.1：找不到元素“XMLTooling”的声明。原因：org.xml.sax.SAXParseException：cvc-elt.1：找不到元素“XMLTooling”的声明。

使用 spring 2.0.2 和 ejb 2.x。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:33:57.000

我不能给你细节，所以我不确定这有多大帮助。您有一个 XML 文档，可能嵌入在一个 jar 或 ear 中，称为 common-config.xml，它在第 8 行有一个 <XMLTooling> 元素，并且用于解析它的模式对那个元素名称一无所知。

# javascript - 在 Appcelerator ACS 中使用 ACL 时出错

> ID：12099226
> 
> 赞同：0
> 
> 时间：2012-08-23T20:11:29.327
> 
> 标签：javascript, mobile, appcelerator, acl

我正在尝试使用 ACL 功能来控制用户可以与他人分享的帖子。当我将 ACL（通过使用浏览器的 ACS 管理控制台）关联到帖子时，我收到以下错误：“[ERROR][TiJSError(629)] (main) [1,124536] - Message: Uncaught TypeError:无法读取未定义的属性“用户名””

基本上，如果附加了 ACL，该代码仅适用于 Post 内容和标题。但是，如果我删除 ACL，整个代码都可以正常工作。我错过了什么吗？这是我的代码的外观...

```
 app.Cloud.Posts.query(function (e) {
        if (e.success) {
            if (e.posts.length == 0) {
                //alert("There is no information to display. Please enter some data and try again.");

                table.setData([
                    { title: 'No Results!' }
                ]);
            }
            else {
                var data = [];
                for (var i = 0, l = e.posts.length; i < l; i++) {
                    data.push(Ti.UI.createTableViewRow({
                        id: e.posts[i].id,
                        title: e.posts[i].title,
                        content: e.posts[i].content,
                        username: e.posts[i].user.username,
                        userfirst_name: e.posts[i].user.first_name,
                        userlast_name: e.posts[i].user.last_name,
                        useremail: e.posts[i].user.email,
                        type: e.posts[i].custom_fields.type,
                        coordinates: e.posts[i].custom_fields.coordinates,
                        latitude : e.posts[i].custom_fields.coordinates[0][1],
                        longitude : e.posts[i].custom_fields.coordinates[0][0]                          
                    }));
                }
                table.setData(data);
            }
        }
        else {
            error(e);
        }
    }); 
```

任何有关如何解决此问题的指示将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:54:05.470

您是否调试并查看了响应数组中的每个“帖子”对象？使用 ACL 时，它通常仍会返回一个带有 id 的对象以表示不允许的帖子。例如：

```
{"posts":[{"id":"534dfgdfg44"},{"id":"5436rgdf345f3f3", "username":"meow", etc....}]} 
```

因此，您需要验证返回数组中的每个对象是否具有您要查找的数据。

希望这可以帮助。

# ruby-on-rails - 当我在rails中的测试数据库中放入一条记录时，它会持续多久？

> ID：12099227
> 
> 赞同：3
> 
> 时间：2012-08-23T20:11:33.253
> 
> 标签：ruby-on-rails, rspec, cucumber

如果作为 Rails 应用程序中的 RSpec 或 Cucumber 测试的一部分，我创建了一个模型并将其存储在测试数据库中，那么该记录将保留多长时间？

我很确定记录会在每个测试周期的最后（或开始？）被清除，因为它们似乎不会干扰我的测试套件的连续运行，但是不同黄瓜功能和场景之间的记录是否会持续存在，还是在不同的 RSpec 测试之间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T21:56:18.677

如果您正在使用事务，则更改将在每个示例之后回滚。

如果您不使用事务，则更改将持续存在，除非您使用其他技术将其清除。这是请求规范的典型案例；因此需要类似 database_cleaner 或手动方法来清除测试数据库。

RSpec 的默认 spec_helper 文件包含以下行：

```
 config.use_transactional_fixtures = true 
```

这意味着将使用交易。

# html - 打开从一个 iframe 到另一个 iframe 的链接

> ID：12099229
> 
> 赞同：0
> 
> 时间：2012-08-23T20:11:49.493
> 
> 标签：html, iframe, anchor

我正在尝试制作一个 4 节 iframe 页面。我已经想出了如何将网页嵌入到其中一个框架中。但是现在，我正在尝试找到一种方法来打开指向同一页面上不同 iframe 的链接。

例如，我们有管理部分，我们可以单击链接查看完整报告。我试图让这份报告显示在不同的 iframe 中，而不是通过链接将我发送到不同的页面。我知道有些东西叫做锚点，但我不确定如何使用它们。下面是我目前拥有的代码。提前感谢您的帮助。

```
<body>
<table width="547" height="397" border="1" cellpadding="2" cellspacing="1">
  <tr>
    <td><iframe height="410" width="100%" frameBorder="0" src="http://www.mypage.com" iframe name="topl_frame" id="topl_frame" target="bottoml_frame">your browser does not support IFRAMEs</iframe>   
</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><iframe height="410" width="100%" frameBorder="0" src=""     name="bottoml_frame">your browser does not support IFRAMEs</iframe></td>
    <td>&nbsp;</td>
  </tr>
</table>
</body>
</html> 
```

# mysql - 具有唯一约束的表具有重复记录（MySQL 5.1.57）

> ID：12099230
> 
> 赞同：1
> 
> 时间：2012-08-23T20:11:50.603
> 
> 标签：mysql, unique-constraint, duplicate-data

我最近遇到了一个非常令人费解的情况。在对 2 个字段设置唯一约束的表中**，**存在许多违反此约束的现有记录！

主要的问题是： **他们是如何在唯一约束已经到位的情况下首先到达那里的？**

架构：

```
CREATE TABLE `rest_service_mediafile` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `video_id` int(11) NOT NULL,
  `video_encoding_id` int(11) NOT NULL,
  `external_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `rest_service_mediafile_video_id_4a2efdd4_uniq` (`video_id`,`video_encoding_id`),
  KEY `rest_service_mediafile_5d9d774` (`video_id`),
  KEY `rest_service_mediafile_62de6709` (`video_encoding_id`),
  CONSTRAINT `video_encoding_id_refs_id_3122bd65` FOREIGN KEY (`video_encoding_id`) REFERENCES `rest_service_videoencoding` (`id`),
  CONSTRAINT `video_id_refs_id_567c8704` FOREIGN KEY (`video_id`) REFERENCES `rest_service_video` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=93154 DEFAULT CHARSET=utf8 
```

示例查询：（但这不是唯一的重复）

```
mysql> select id, video_id, video_encoding_id, external_id from rest_service_mediafile where video_id = 157165 and video_encoding_id=2;
+-------+----------+-------------------+-------------+
| id    | video_id | video_encoding_id | external_id |
+-------+----------+-------------------+-------------+
| 82416 |   157165 |                 2 |           0 | 
| 82424 |   157165 |                 2 |           0 | 
+-------+----------+-------------------+-------------+ 
```

如果我尝试对某些字段进行更改表查询，例如：

**ALTER TABLE `rest_service_mediafile`MODIFY `external_id`varchar(255) NULL;**

我**会**得到约束错误：错误是：（1062，“重复条目'157165-2'键'rest_service_mediafile_video_id_4a2efdd4_uniq'”）

此外，如果我尝试简单地插入重复值，它将正确失败！你们中的任何人都遇到过这种情况在 MySQL 中是可能的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:43:16.657

约束是*事后*添加的吗？

错误： [ALTER IGNORE TABLE t ADD UNIQUE INDEX 不会删除](http://bugs.mysql.com/bug.php?id=40344)MySQL 5.1 和 5.5 中的重复行。

这在 InnoDB 文档中被记录[为 Fast Index Creation 的限制](http://dev.mysql.com/doc/innodb/1.1/en/innodb-create-index-limitations.html)。

# c# - 如何强制任务开始？

> ID：12099233
> 
> 赞同：3
> 
> 时间：2012-08-23T20:11:58.053
> 
> 标签：c#, concurrency, task-parallel-library

我有一个扫描网络的程序，它通过使用大量等待数据从网络返回的任务（和并行 foreaches）来实现。问题是，虽然我知道这些任务几乎不使用任何 CPU 处理，但 CLR 没有，而且它坚持启动非常缓慢（特别是因为它运行在两核 CPU 上）。

如何强制 CLR 同时启动更多任务？目前程序正在等待很多，我怎样才能让它同时打开更多的连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:15:49.680

您可以使用不需要 TPL 启动新线程的异步 IO，也可以手动启动线程，也可以使用`ThreadPool.SetMinThreads`. 不要使用最后一个解决方案，因为这是一个进程范围的设置。不要为局部问题选择全局解决方案。

# python - 在python中动态派生一个类

> ID：12099237
> 
> 赞同：1
> 
> 时间：2012-08-23T20:12:15.983
> 
> 标签：python, inheritance

> **可能重复：**
> [Python 动态继承：如何在创建实例时选择基类？](https://stackoverflow.com/questions/7057019/python-dynamic-inheritance-how-to-choose-base-class-upon-instance-creation)

我希望一个类根据**init**方法中的参数动态选择一个基类。

```
Class A():
    #...
Class B():
    #...
Class C():
    def __init__(self, base_type):
        if parent_type == 'A':
            #TODO: make C derive A
        else:
            #TODO: make C derive B 
```

A 和 B 是派生相同基类的库类。

[类似问题](https://stackoverflow.com/questions/7057019/python-dynamic-inheritance-how-to-choose-base-class-upon-instance-creation)的答案似乎太难看了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T05:41:54.563

虽然您可以在 中更改课程`__init__`，但在 中进行更改更合适`__new__`。前者用于初始化，后者用于构造：

```
class A(object): pass
class B(object): pass

class C(object):
    def __new__(cls, base_type, *args, **kwargs):
        return super(C, cls).__new__(base_type, *args, **kwargs)

assert isinstance( C(A), A )
assert isinstance( C(B), B ) 
```

使用`__init__`，您将创建 C 的实例，然后修改其类型。使用`__new__`，您永远不会创建 C 的实例，只需创建所需的`base_type`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T20:54:35.403

我假设您的意思是 base_type 而不是父类型。但以下应该工作

```
Class C():
    def __init__(self, base_type):
        if base_type == 'A':
            self.__class__=A
        else:
            self.__class__=B 
```

可以在此处找到有关此方法的更多详细信息：http: [//harkablog.com/dynamic-state-machines.html](http://harkablog.com/dynamic-state-machines.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T20:40:46.537

我完全同意 cyroxx，你应该给我们一些关于你的问题的背景信息。就目前而言，`__init__`在创建类的实例以初始化其成员之后调用。改变遗产为时已晚。

一个简单的类工厂对你来说就足够了吗：

```
class MyA(ABMixin, A): pass

class MyB(ABMixin, B): pass

def factory(class_type):
    if class_type == 'A':
        return MyA()
    else:
        return MyB() 
```

我建议阅读[this SO answer](https://stackoverflow.com/questions/100003/what-is-a-metaclass-in-python/6581949#6581949) about dynamic class creation in python。

# php - 正则表达式匹配和替换 BB 代码报价

> ID：12099239
> 
> 赞同：0
> 
> 时间：2012-08-23T20:12:17.647
> 
> 标签：php, regex

我正在寻找匹配这样的字符串：

```
[quote12445555=Me]Some \n Quote[/quote12445555] 
```

并将其替换为：

```
<blockquote>Some \n Quote</blockquote> 
```

我有如下的正则表达式：

```
!\[quote(\d+)=(\w+)\](.*|\r\n|\n)\[\/quote(\d+)\]! 
```

取而代之：

```
<blockquote>$3</blockquote> 
```

但这似乎不起作用

任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:19:16.933

```
$quotes = preg_replace('%\[(quote\d+)=([^\]]+)\]([^[]+)\[/\1\]%', '<blockquote>$3</blockquote>', $quotes); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:25:44.560

这似乎在我的测试中起作用：

```
\[quote[0-9]+=[a-zA-Z0-9]+\]((.|\n)*)\[/quote[0-9]+\] 
```

尝试改变：`(.*|\r\n|\n)`到`(.|\r\n|\n)*`

是否需要转义正斜杠？`\/`

我的替换字符串是：`<blockquote>$1</blockquote>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:31:33.570

仅供参考，正确的正则表达式是：

```
'!\[quote(\d+)\=(\w+)\](.+?)\[\/quote(\d+)\]!is' 
```

# algorithm - 将线拟合到网格矩阵中 [竞争，不是硬件]

> ID：12099244
> 
> 赞同：2
> 
> 时间：2012-08-23T20:12:43.140
> 
> 标签：algorithm, matrix, 2d, dynamic-programming, knapsack-problem

在最近由“AmDocs”组织的比赛中，我遇到了以下问题：（问题的基本思想）

给定一个固定大小为 12x12 的矩阵。给你六个长度为 6,5,5,4,3,2 的线段。矩阵有空格和填充空格。您必须返回 "Yes" 或 "No" ，是否所有 6 条线段都可以同时适合矩阵。线条只能水平或垂直放置。

应该使用什么算法来解决这个问题？包装 ？背包？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T20:52:50.820

我会将问题映射到 SAT 并使用 SAT 求解器。有一个非常自然的映射。定义变量：

```
x_s_i_j_d = segment s starts at coordinates (i,j) and goes in direction d 
```

（d 是“右”或“下”）

首先，遍历所有的段和起始位置，看看在给定起始矩阵的情况下哪些是可行的。例如，米：

```
000000000000
111111111111
... 
```

如果段 1 的长度为 2，则`L_seg1_0_0_down = false`，因为它遇到了一个填充的空间。

然后，编写禁止两个交叉段的子句。如果段 1 和段 2 的长度都是 2，那么我们添加子句：

```
(!L_seg1_0_0_right || !L_seg2_1_0_right) 
```

因为如果段 1 使用坐标 (0,0) 和 (1,0)，则段 2 也不能使用 (1,0)。

最后，添加每个段必须至少使用一次的条件：

```
(L_seg1_0_0_right || L_seg1_0_1_right || ...) 
```

对于 seg1 可以去的所有位置。然后把你最​​喜欢的 SAT 求解器扔给它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:55:48.563

我会使用如下贪婪填充算法：

```
for largest_line to smallest_line do
  for first_empty_square_in_matrix to last_empty_square_in_matrix do
    if line_fits_horizontal then
      place_line
      break
    else if_line_fits_vertical then
      place_line
      break
if all_lines_placed then
  write('Yes')
else
  write('No') 
```

为了优化上述内容，您可能会注意到，如果长度为 n 的水平线无法适合位置 (i,j)，那么您将不需要测试它是否水平适合 (i+1,j),(i +2,j)...(i+n,j)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T22:39:34.613

只是一个想法：
遍历所有 2D 数组点并创建可用段的集合。在每个步骤中，您将分析 i-1 和 j-1 单元格，如果您有包含该单元格的段，您将增加它们的长度（显然您最多可以找到两个段）。
之后，您应该将数组放入可用的段中，因此在每次插入后，您应该分析所有剩余的段，如果它们中的任何一个与当前插入的段相交，您应该减小它们的大小或分成两个。

# python - python webcrawler 下载文件

> ID：12099250
> 
> 赞同：2
> 
> 时间：2012-08-23T20:13:11.213
> 
> 标签：python, selenium

我有一个搜索某些文件并下载它们的网络爬虫，但是当“另存为或打开”对话框提示时如何下载 pdf 文件。我目前正在使用 python selenium 进行爬网。这是我的代码。

```
from selenium import webdriver
import time

browser = webdriver.Firefox() # Get local session of firefox
browser.get("http://www.tda-sgft.com/TdaWeb/jsp/fondos/Fondos.tda") # Load page
link = browser.find_element_by_link_text("Mortgage Loan")
link.click()
link2 = browser.find_element_by_link_text("ABS")
link2.click()
link3 = browser.find_element_by_link_text("TDA 13 Mixto")
link3.click()
download = browser.find_element_by_link_text("General Fund Information")
download.click()

time.sleep(0.2) # Let the page load, will be added to the API
browser.close() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:26:10.043

您将需要修改 Firefox 配置文件的首选项。为了让它停止显示该对话框，您需要设置`browser.helperApps.neverAsk.saveToDisk`正在使用的配置文件的属性。为此，您可以这样做（请注意，这是针对 CSV/Excel 文件的 - 我相信您的类型是“应用程序/pdf”）：

```
profile = webdriver.firefox.firefox_profile.FirefoxProfile()
profile.set_preference('browser.helperApps.neverAsk.saveToDisk', ('text/csv,'
                                                                  'application/csv,'
                                                                  'application/msexcel')) 
```

对于您的情况（我没有使用 PDF 对此进行测试，因此请谨慎使用 :)），您可以尝试以下操作：

```
profile = webdriver.firefox.firefox_profile.FirefoxProfile()
profile.set_preference('browser.helperApps.neverAsk.saveToDisk', ('application/pdf')) 
```

第二个参数是一个元组，它包含永远不会触发`Save As`提示的文件类型。然后，您将此配置文件传递到您的`browser`：

```
browser = webdriver.Firefox(firefox_profile=profile) 
```

现在，当您下载该元组中的某个类型的文件时，它应该绕过提示并将其放在您的默认目录中。如果要更改文件下载的目录，可以使用相同的过程，只需更改一些内容（在将 附加`profile`到浏览器之前执行此操作）：

```
profile.set_preference('browser.download.folderList': 2)
profile.set_preference('browser.download.dir': '/path/to/your/dir') 
```

# iphone - 动画 viewForOverlay MKCircleView

> ID：12099256
> 
> 赞同：1
> 
> 时间：2012-08-23T20:13:33.840
> 
> 标签：iphone, delegates, mkmapview, mkoverlay

我想为添加为 MKOverLay 的圆圈设置动画。我希望它从屏幕顶部掉下来。如何通过委托方法制作动画？还是在叠加层的添加中？谁能指出我正确的方向？谢谢！

我在 mapView 委托方法中有这个

```
-(MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id<MKOverlay>)overlay
{

    if([overlay isKindOfClass:[MKCircle class]]) {
        // Create the view for the radius overlay.
        MKCircleView *circleView = [[MKCircleView alloc] initWithOverlay:overlay];
        circleView.strokeColor = [UIColor whiteColor];
        circleView.fillColor = [[UIColor blueColor] colorWithAlphaComponent:0.2];

        return circleView;
    }

    return nil;
} 
```

我像这样添加overLays：

```
 MKCircle *circle = [MKCircle circleWithCenterCoordinate:userCoord radius:200];
        [mainMapView addOverlay:circle]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T13:04:17.117

这是一些未经测试的代码。如果它确实有效，您可能需要更改动画。

```
- (void)mapView:(MKMapView *)mapView didAddOverlayViews:(NSArray *)overlayViews
{
    for (MKOverlayView *view in overlayViews) {

        CGRect endFrame = view.frame;
        view.frame = CGRectMake(endFrame.origin.x, endFrame.origin.y-500, 0, 0);

        [UIView animateWithDuration:1.0 animations:^{
            view.frame = endFrame;
        }];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T17:48:31.387

假设您想要放大+淡入动画，您可以这样做：

```
@interface MyMapOverlayView : UIView<CAAction>
@end

@implementation MyMapOverlayView

- (id<CAAction>)actionForLayer:(CALayer *)layer forKey:(NSString *)event
{
    if ( [ event isEqualToString:@"onOrderIn" ] )
    {
        return self ;
    }

    return [ super actionForLayer:layer forKey:event ] ;
}

- (void)runActionForKey:(NSString *)event object:(id)anObject arguments:(NSDictionary *)dict
{
    if ( [ event isEqualToString:@"onOrderIn" ] )
    {
        {
            CABasicAnimation * anim = [ CABasicAnimation animationWithKeyPath:@"transform" ] ;
            anim.fromValue = [ NSValue valueWithCATransform3D:CATransform3DMakeScale( 0.1f, 0.1f, 1.0f ) ] ;
            [ self.layer addAnimation:anim forKey:nil ] ;
        }

        {
            CABasicAnimation * anim = [ CABasicAnimation animationWithKeyPath:@"opacity" ] ;
            anim.fromValue = @0.0f ;
            [ self.layer addAnimation:anim forKey:nil ] ;
        }
    }
}

@end 
```

*注意：在将叠加层添加到地图视图*时，我猜测了如何添加这些动画，但我还没有测试过。您将需要进行实验。您也许可以在创建视图时设置它们。

**更新**：我测试了它，它似乎工作。

# html - 显示 HTML 内容的滚动框

> ID：12099259
> 
> 赞同：1
> 
> 时间：2012-08-23T20:13:39.260
> 
> 标签：html, css

所以我有一种情况，我想把一个很长的使用条款文件放在我公司网站的一个页面上，但是放在主要的“内容”区域太长了。我想使用滚动区域，以便用户可以看到最初呈现的使用条款。所以你可以明白我的意思，我需要苹果网页的整个 c 部分：

[http://www.apple.com/legal/itunes/us/terms.html#APPS](http://www.apple.com/legal/itunes/us/terms.html#APPS)

我考虑将使用条款中该部分的 HTML 代码放入`<textarea>`元素中，但显然`<textarea>`不会呈现 HTML 代码。有没有办法让我没有像 4000px 这样的网页？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T20:16:13.583

将内容放入固定高度的 div 中，并将 css 溢出属性设置为 'auto' 这将创建一个可滚动的 div

```
<div style='height:80px; overflow:auto;'>
content here
</div> 
```

当然，您应该使用单独的样式表，但那是另一回事

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T20:16:43.807

您可以创建一个 div 来包含内容并指定高度，然后在 CSS 中使用 user overflow: auto 使其可滚动。

像这样：-

[http://jsbin.com/ifolif/2/edit](http://jsbin.com/ifolaf/2/edit)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T20:16:06.570

您可以创建另一个 .html 文件并将其中的一个`<iframe>`嵌入设置的高度和宽度。

# objective-c - 如何将 NSString 转换为 @property 变量

> ID：12099261
> 
> 赞同：0
> 
> 时间：2012-08-23T20:13:41.197
> 
> 标签：objective-c

我想通过 , 等获取属性名称`self.label1`。`self.label2`你`self.label3`知道如何将 NSString 转换为 JS 或 Ruby 等方法吗？

我的标题是

```
@property(nonatomic,strong)CCLabelTTF *label1;
@property(nonatomic,strong)CCLabelTTf *label2;... 
```

### 实现

```
for (int i = 0; i < 10; ){

  NSString *str = [NSString stringWithFormat:@"self.label%i",i];
  // convert str to property
  converted_str = [CCLabelTTF labelWithString:%@"hello  below style is  not good... 
```

我想避免这种风格...

```
for(int i  = 0 ;i < 10;){
   if (i == 0){
   self.label1 = ...
   }else if(i == 1){
   self.label  = ...
} 
```

你有什么主意吗？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:17:47.130

为什么不将标签放入这样的数组中：

```
NSArray *myLabels = @[self.label1, self.label2...]; 
```

然后你可以：

```
for (CCLabelTTF *label in myLabels) {
    // Do something with the label
} 
```

或者，您可以使用 KVC。

```
for (int i = 1; i <= 10; i++) {
    NSString *labelName = [[NSString alloc] initWithFormat:@"label%d", i];
    CCLabelTTF *label = [self valueForKey:labelName];
    // Do something with the label
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T20:17:25.580

尝试使用 KVC：

```
NSString *keyPath = [NSString stringWithFormat:@"label%i", labelNumber];

id value = [CCLabelTTF ....];

[self setValue:value forKey:keyPath]; // use KVC to set the value for you 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T20:19:12.163

您可以使用[Key-Value Coding](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/KeyValueCoding.html)来做到这一点，但听起来您真正想要的是使用数组。如果您不使用数组的原因是因为这些是您需要连接的插座，您只需将数组声明为 an 即可`IBOutletCollection`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T20:31:19.863

好吧，KVC 角度的更原始形式是：

```
SEL sel = NSSelectorFromString(propertyName);
id leProperty = [object performSelector:sel]; 
```

但是，KVC 更彻底，如果使用此方法输入错误，则会引发异常。同样，`performSelector:`对 ARC 也不是很友好。

如果你想低于这个，你总是可以使用 objc 运行时来做到这一点。

# spring - JSF 2 + Spring 3 + Shiro - 会话超时不重定向到登录页面

> ID：12099262
> 
> 赞同：1
> 
> 时间：2012-08-23T20:13:42.007
> 
> 标签：spring, jsf-2, shiro

我有这个 JSF 2.0/Spring 应用程序，它添加了 Apache Shiro，并且当用户单击命令按钮或触发 AJAX 请求时，会话超时后不会发生重定向。当他们刷新浏览器时它确实有效。这发生在所有浏览器中。这是我的 applicationContext.xml：

```
<bean id="shiroFilter" class="org.apache.shiro.spring.web.ShiroFilterFactoryBean">
        <property name="securityManager" ref="securityManager" />
        <property name="loginUrl" value="/index.faces"/>
        <property name="filterChainDefinitions">
                <value>
                        /* = authc 
                </value>
        </property>
</bean>
<bean id="securityManager" class="org.apache.shiro.web.mgt.DefaultWebSecurityManager">
        <property name="realm" ref="opacsRealm" />
</bean>

<bean id="lifecycleBeanPostProcessor" class="org.apache.shiro.spring.LifecycleBeanPostProcessor" />

<bean id="sha512Matcher" class="org.apache.shiro.authc.credential.HashedCredentialsMatcher">

        <property name="hashAlgorithmName" value="SHA-256" />
        <property name="hashIterations" value="1024" />
</bean>

<bean id="opacsRealm" class="org.apache.shiro.realm.jdbc.JdbcRealm">
        <property name="dataSource" ref="dataSource" />
        <property name="authenticationQuery" 
                value="select PASSWORD, SALT from SEC_USERS where NAME = ?" />
        <property name="userRolesQuery" 
                value="SELECT ROLE_NAME FROM SEC_USERS_ROLES WHERE USER_NAME = ?" />
        <property name="permissionsQuery" 
                value="SELECT permission FROM SEC_ROLES_PERMISSIONS WHERE ROLE_NAME = ?" />
        <property name="permissionsLookupEnabled" value="true" />
        <property name="saltStyle" value="COLUMN" />
        <property name="credentialsMatcher" ref="sha512Matcher"/>
</bean> 
```

我在设置中做错了吗？web.xml 如下所示：

```
<filter>
    <filter-name>shiroFilter</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    <init-param>
        <param-name>targetFilterLifecycle</param-name>
        <param-value>true</param-value>
    </init-param>
</filter>
<filter-mapping>
    <filter-name>shiroFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
<session-config>
  <!-- web.xml expects the session timeout in minutes: -->
  <session-timeout>1</session-timeout>
</session-config> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T07:49:21.717

刚刚回复了你的邮件。发生的情况是，浏览器在您的 Ajax 调用中无缝处理重定向，因此 Shiro 确实重定向到登录页面，您的 Ajax 请求的最终结果是登录页面的 HTML 内容，这并不是您真正想要的！

如何解决这个问题的要点是向您的 Ajax Api url 添加一个（自定义）Shiro 过滤器，以检查主题是否经过身份验证，而不是重定向到登录返回您的 Ajax 请求理解的响应以指示用户不是登录。客户端处理此响应然后可以重定向到登录页面（或者可能是同一页面，因为 Shiro 将重定向到登录但可以配置为记住您尝试去的地方，从而将用户带回成功登录后的正确页面）。

我的过滤器实现返回 Http 代码 401 以及“WWW-Authentication”标头和自定义“挑战方案”（如果您进行了基本身份验证挑战，那么浏览器将弹出其基本身份验证对话框 - 已经有一个 Shiro 过滤器可以执行此操作）。

在您的 Ajax 调用中，您需要检测此响应，目前我有一个笨拙的错误回调，但我认为应该可以修改 JavaScript 库（JQuery 等）以无缝处理。

# python - 打印具有相同自定义设置间距的列，同时不让长字符串流过其他列。（也许使用 clint？）

> ID：12099265
> 
> 赞同：1
> 
> 时间：2012-08-23T20:13:58.623
> 
> 标签：python, pretty-print, word-wrap, clint

假设我有这两个列表：

```
column1 = ["Attribute:","Virtual machine:","Troll:"]
column2 = ["A value associated with an object which is referenced by name using dotted expressions. For example, if an object o has an attribute a it would be referenced as o.a.", 
           "A computer defined entirely in software. Python's virtual machine executes the bytecode emitted by the bytecode compiler.",
           "Someone who posts inflammatory, extraneous, or off-topic messages in an online community, such as a forum, chat room, or blog, with the primary intent of provoking readers into an emotional response or of otherwise disrupting normal on-topic discussion."] 
```

这段代码：

```
for c1, c2 in zip(column1, column2):
    print "%-16s %s" % (c1, c2) 
```

输出此文本：

```
Attribute:       A value associated with an object which is referenced by name u
sing dotted expressions. For example, if an object o has an attribute a it would
be referenced as o.a.
Virtual machine: A computer defined entirely in software. Python's virtual machi
ne executes the bytecode emitted by the bytecode compiler.
Troll:           Someone who posts inflammatory, extraneous, or off-topic messag
es in an online community, such as a forum, chat room, or blog, with the primary
 intent of provoking readers into an emotional response or of otherwise disrupti
ng normal on-topic discussion. 
```

虽然我想要这样：

```
Attribute:       A value associated with an object which is referenced by name 
                 using dotted expressions. For example, if an object o has an 
                 attribute a it would be referenced as o.a.
Virtual machine: A computer defined entirely in software. Python's virtual 
                 machine executes the bytecode emitted by the bytecode compiler.
Troll:           Someone who posts inflammatory, extraneous, or off-topic 
                 messages in an online community, such as a forum, chat room, or 
                 blog, with the primary intent of provoking readers into an 
                 emotional response or of otherwise disrupting normal on-topic
                 discussion. 
```

对于任何终端尺寸，我如何获得此结果？（有人告诉我，[克林特](https://github.com/kennethreitz/clint)可能很容易做到这一点，有人做过吗？）

注意：一个单词在行尾不被切碎的要求对我来说只是次要的。最重要的要求是让列表中的每个字符串元素以与该`column2`列表中每个元素的字符串开始处相同的水平间距继续。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T08:14:11.460

```
from clint.textui import puts, columns

width = 20

for term, definition in zip(column1, column2):
    puts(columns([term, width], [definition, None])) 
```

...前缀以根据内容选择列宽：

```
#derive 1st column width from longest term
width = 0
for s in column1:
    if len(s) > width :
        width = len(s) + 1 
```

改编自[clint\examples\text_width.py](https://github.com/kennethreitz/clint/blob/develop/examples/text_width.py)。感谢您的提问；我以前不知道如何做到这一点，这是我将使用的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T11:01:05.933

这对我有用：

```
import textwrap

for c1, c2 in zip(column1, column2):
    mc2 = "".join(textwrap.fill(c2, width=50, initial_indent="", subsequent_indent="\t\t ", break_long_words = False))
    print "%-16s %s" % (c1, mc2) 
```

获得相同结果的人将`Clint`获得投票而不是这个答案。

# language-agnostic - 详尽描述 cpu 架构以编写可重定向编译器的文件

> ID：12099268
> 
> 赞同：3
> 
> 时间：2012-08-23T20:14:09.613
> 
> 标签：language-agnostic, compiler-construction, compilation, cpu, cpu-architecture

我正在为每个 cpu 架构 A[i]（x86-32、x86-64、ARM、Itanium 等）寻找一个文件 F[i]。每个文件 F[i] 将提供关于架构 A[i] 的足够信息（寄存器、指令集、语义等），因此对于任何语言 L 来说，编写一个程序 P 接受任何 F[ i] 并为语言 L 生成编译器优化器 C[i] 到原生 A[i]。当然，P 关于 A[i] 的知识完全来自 F[i]。

每个 F[i] 都应该包含足够多的信息，以便对于语言 L 到本地 A[i] 的任何给定编译器 C'，我们可以编写一个 P 来生成 C[i] 的性能与 C' 一样好。理想情况下，F[i] 文件将使用能够描述未来 cpu 架构的相同语言 DescL 编写。

此类文件 F[i] 是否存在（至少对于最常见的 cpu 架构而言）？那么我在哪里可以下载它们呢？这样的 DescL 是否已经存在？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:41:21.237

Joao Dias 证明，至少对于代码生成来说，这个问题是不可判定的。也就是说，对于一般的机器架构，这样的程序 P 是不可能存在的。他还开发了对典型机器架构完全有效的启发式方法。我建议你阅读[他的论文](http://www.eecs.tufts.edu/~dias/dissertation/dissertation.pdf)，其中还回顾了在这个问题上已经完成的一些大型工作。

[您将找到一些与新泽西机器代码工具包](http://www.cs.tufts.edu/~nr/toolkit)和[Lambda-RTL](http://www.cs.tufts.edu/~nr/lrtl/download.html)规范语言相关的工具和描述。规范本身可能处于混乱状态，而迪亚斯博士更有可能拥有准确且最新的规范。

Zephyr 网页非常陈旧，绝对过时，不应链接到。但是你可以阅读[我们的论文](http://www.cs.tufts.edu/~nr/pubs/index.html):-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T16:53:24.807

我想你会对 Zephyr“国家编译器基础设施”项目感兴趣；请参阅 128.143.136.29/zephyr/ [我会输入一个真实的链接，但 StackOverflow 不允许我为此主机执行此操作。尽管 SO 有意见，但该链接仍然有效。不，我不明白为什么它没有一个好的象征性名称，但是嘿，它不是我的网站。]。

他们认真尝试定义机器描述形式，我相信他们编码了许多“通用”机器指令集。在做出任何选择之前，您应该阅读他们的论文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T18:54:15.477

我不知道这样的事情，我认为这对于可行的 P 来说太抽象和复杂了。

我相信任何有用的 F 都将有效地描述通用中间语言和单个 CPU 指令集之间的翻译（即使该语言是声明性的而不是传统的编译器）。看看[LLVM 的 TableGen](http://llvm.org/docs/WritingAnLLVMBackend.html)，它用于声明很多关于后端的信息。AFAIK 仍然不足以完整地描述架构，而且使用起来显然相当复杂。

我看不出 P 怎么会知道关于 L 的任何事情，但它需要这些知识来创建编译器 C[i]。当然，除非您专门创建 P 来了解 L，此时 P 变得特定于单个 L，并且实际上是传统的编译器前端，这并不是什么新鲜事。唯一的区别是您正在编写一个用于发出编译器的程序，但我看不出这如何为您节省任何东西，而不是`C''`像某人写的那样编写`C'`预先。（解析是一个更简单和更小的问题，因此在解析器生成方面取得了成功。尽管如此，解析器生成器在实现工作和质量方面最多可以与专家手写的解析器竞争。）或者，使 P 成为 AI并教它编译器构造，但这在 AI 的当前状态下是不可能的，然后你必须找到一种方法来教 P 语言（阅读：仍然没有免费的编译器适合你）。

除此之外，编译器必须知道**的**不仅仅是 CPU 指令。操作系统服务、ABI 和可执行格式只是他们面临的许多重要问题中的三个。对于对这些问题应用类似的解决方案，我也有类似的疑问。旧的“分离前端和后端”技巧在工作量方面几乎同样有效，显然更有可能，对我来说更有意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T15:29:09.220

*   我知道没有这样的数据库

*   我所知道的最近的公共此类数据库将是 GCC 使用的处理器描述。他们将处理器描述与一些代码混合在一起，以非数据驱动的方式处理代码生成的某些方面。

# raycasting - 是否可以将地形渲染算法从翻转码转换为“全 3d”渲染器？

> ID：12099269
> 
> 赞同：0
> 
> 时间：2012-08-23T20:14:24.073
> 
> 标签：raycasting, voxels

我找到了这个（http://www.flipcode.com/voxtut/）基于体素技术的地形渲染算法示例，并将其转换为“全3d”渲染器。我的意思是，在高度图中，一对 (x,y) 只有一个 z(up) 坐标，而在“真实 3d”中则有很多。

我通过向普通 x,y 地图添加新的“z”层来做到这一点。例如，我有一个数据集：

```
data[x][y][0] = 0;
data[x][y][1] = 10;
data[x][y][2] = 50;
data[x][y][3] = 100;
data[x][y][4] = -1; 
```

这意味着，坐标为 x、y、z 的可见体素，其中 0<=z<=10 或 50<=z<=100。因此，我以与 Flipcode 上描述的相似的方式绘制此数据集。

[这](http://pastebin.com/SLNpwHPy)是我的程序（很慢），[这](http://img827.imageshack.us/img827/5937/201208232322331280x1024.png)是最终渲染。

我对这种方法有一些问题。

1.  在该算法中，对象由平行于屏幕的长条纹绘制（因为我们通过将水平屏幕坐标加 1 并将相机与射线上的点之间的距离加常数 dd 来穿过屏幕）。我们在可绘制对象之间有空间的地方，也有这些丑陋的锯齿形。我可以用其他东西（例如立方体）而不是这些条纹轻松绘制对象吗？或者也许还有另一种方法可以提高质量？

2.  由于光线不会在屏幕上绘制列（而是绘制垂直线段），因此很难确定屏幕上哪些像素已经绘制，哪些尚未绘制。有什么关系吗？

有没有关于这个主题的论文或描述的任何现成算法？

# c# - 简化构建字典

> ID：12099271
> 
> 赞同：2
> 
> 时间：2012-08-23T20:14:28.030
> 
> 标签：c#, dictionary, refactoring

我正在尝试将 Dictionary 作为参数发送给方法。它有效，但它变得有点乏味。我做了一百万次，如果可能的话，我想做得更漂亮一点。现在，它是这样的：

```
MyMethod(new Dictionary<string, object> { { string1, value1 }, { string2, value2 } }); 
```

我想让它看起来更像这样：

```
MyMethod({ string1, value1 }, { string2, value2 }); 
```

这是白日梦吗？关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:24:41.323

我认为没有任何方法可以获得您正在寻找的语法类型。我能想到的最接近和最短的事情是定义如下：

```
using D = System.Collections.Generic.Dictionary<string, object>; 
```

然后你可以这样做：

```
MyMethod(new D {{string1, value1},{string2, value2}}); 
```

这有点短，但可能仍然不理想。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T20:20:51.273

这几乎是一个白日梦。您*可以*创建一个泛型`DictionaryBuilder`类，其中包含一个泛型方法的非泛型类`DictionaryBuilder.Start`，因此您可以编写：

```
MyMethod(DictionaryBuilder.Start(string1, value1).Add(string2, value2).Build()); 
```

...但这也不是很好。

要将集合初始化器用于新对象（而不是嵌入式初始化器），您*必须*调用构造函数，这意味着指定类型参数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T20:22:53.237

我不知道可以完全按照您的要求进行操作，但是您可以稍微作弊，并使用可变参数列表。你失去了一些类型检查，如果你不完全正确地调用它，你会得到一个异常，但它不那么罗嗦：

```
void MyMethod( params object[] arr ) {
    var d = new Dictionary<string,object>();
    for( int i=0; i<arr.Length; i+=2 ) {
        d.Add( (string)arr[i], arr[i+1] );
    }
} 
```

示例用法：

```
MyMethod( string1, value1, string2, value2 ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T20:38:55.367

如果您坚持将方法输入缩短到极致，我的想法与 Ethan Brown 相同。`params`这是一个用于输入字典元素的小程序。

```
class Program
{
    static void Main(string[] args)
    {
        MyMethod("Key1", 1, "Key2", 2, "Key3", 3);
    }

    static void MyMethod(params object[] alternatingKeysValues)
    {
        var dictionary = AlternatingKeysValuesToDictionary(alternatingKeysValues);
        // etc...
    }

    static Dictionary<string, object> AlternatingKeysValuesToDictionary(params object[] alternatingKeysValues)
    {
        if (alternatingKeysValues.Count() % 2 == 1)
            throw new ArgumentException("AlternatingKeysValues must contain an even number of items.");
        return Enumerable
            .Range(1, alternatingKeysValues.Count() / 2)
            .ToDictionary(
                i => (string)alternatingKeysValues.ElementAt(i * 2 - 2),
                i => alternatingKeysValues.ElementAt(i));
    }
} 
```

也就是说，我认为像 Eric 的答案实际上更好。为非常冗长的内容分配捷径可以`Dictionary<object, string>`让您非常接近您的理想，而不会牺牲清晰度或`Dictionary`内置集合初始化程序提供的自然错误检查。

但是，我会寻求更清晰的措辞：

```
using Dict = System.Collections.Generic.Dictionary<string, object>; 
```

用法：

```
MyMethod(new Dict {{string1, value1},{string2, value2}}); 
```

更好的是，替换`Dict`为实际描述您的字典包含的内容，例如，fruitPrices 如果您的键是`FruitName`并且您的值是`Price`。

# php - 如何排除未选择的项目 (PHP)

> ID：12099273
> 
> 赞同：0
> 
> 时间：2012-08-23T20:14:30.987
> 
> 标签：php

我目前正在处理此订单：[http ://www.libertydelimart.com/order](http://www.libertydelimart.com/order)

现在，所有项目都会发布到我的电子邮件中——无论天气如何，信息都已输入到“多少”文本框中。

排除在“多少”文本框中没有输入任何内容的项目的最佳方法是什么，以便只有输入了信息的项目才会通过电子邮件发送给我？

```
<?php
if(isset($_POST['submit'])) {

$to = "test@mywebsite.com"; 
$subject = "New Order";
$name_field = $_POST['name'];
$phone_field = $_POST['phone'];
$food = $_POST['food'];

$body = 'Name: ' . $name_field . PHP_EOL . 'Phone: ' . $phone_field . PHP_EOL;

//Check if any food items were set in order to prevent foreach error
if($food){
  foreach ($food as $key => $item) {
    $body .= $key . ' - ' . $item ['how_many'];
    if($item['customize']) $body .= ' ('.$item['customize'].')' . PHP_EOL;
  }  
}

echo "Your Order Will Be Ready In 30 Minutes!";
mail($to, $subject, $body,"FROM: Deli <$to>");
print '<pre>'.$body.'</pre>';
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:18:32.067

[`empty()`](http://php.net/manual/en/function.empty.php)在您的内部使用检查它是否为空`foreach`：

```
foreach ($food as $key => $item) {
    if (!empty($item['how_many'])) {
        // Add to body only if it isn't empty
        $body .= $key . ' - ' . $item ['how_many'];
        if($item['customize']) $body .= ' ('.$item['customize'].')' . PHP_EOL;
    }
} 
```

请记住，这并不能验证输入是否实际上是一个数字。或者，我建议实施[这个 SO answer](https://stackoverflow.com/questions/3377537/checking-if-a-string-holds-an-integer)，并检查它是否大于零。

```
if ((string)(int)$item['how_many'] == $item['how_many'] && (int)$item['how_many'] > 0) 
```

# silverlight - 将输入框（例如 AutoCompleteBox）添加到应用程序栏

> ID：12099279
> 
> 赞同：0
> 
> 时间：2012-08-23T20:14:56.280
> 
> 标签：silverlight, windows-phone-7, application-bar

如何将 Silverlight Toolkit 中的 AutoCompleteBox 等控件添加到应用程序栏？我想创建一个类似于 Internet Explorer 应用程序中的应用程序栏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T03:32:07.383

使用默认的 ApplicationBar 无法做到这一点。但是，您可以创建自己的用户 Control 并使其像现有的 ApplicationBar 一样运行。希望能帮助到你。

# c# - 为什么 ContextMenu（弹出菜单）不显示？

> ID：12099282
> 
> 赞同：2
> 
> 时间：2012-08-23T20:15:20.360
> 
> 标签：c#, wpf, user-interface, contextmenu, popupmenu

以下类派生自`System.Windows.Controls.UserControl`. 在所述类中，我调用`OpenFileDialog`以打开 XAML 文件（工作流文件）。接下来，我在鼠标右键单击时实现了一个动态菜单。菜单不显示。这是线程问题还是 UI 问题？在我的研究中，我一直无法找到解决方案。

提前致谢。

```
private void File_Open_Click(object sender, RoutedEventArgs e)
{
    var fileDialog = new OpenFileDialog();

    fileDialog.Title  = "Open Workflow";
    fileDialog.Filter = "Workflow| *.xaml";

    if (fileDialog.ShowDialog() == DialogResult.OK)
    {
        LoadWorkflow(fileDialog.FileName);
        MouseDown += new System.Windows.Input.MouseButtonEventHandler(mouseClickedResponse);
     }
}

private void mouseClickedResponse(object sender, System.Windows.Input.MouseEventArgs e)
{
    if (e.RightButton == MouseButtonState.Pressed)
    {
         LoadMenuItems();
    }
}

private void LoadMenuItems()
{
    System.Windows.Controls.ContextMenu contextmenu = new System.Windows.Controls.ContextMenu();   
    System.Windows.Controls.MenuItem item1 = new System.Windows.Controls.MenuItem();
    item1.Header = "A new Test";
    contextmenu.Items.Add(item1);
    this.ContextMenu = contextmenu;
    this.ContextMenu.Visibility = Visibility.Visible;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-19T03:25:29.430

我自己遇到了这个问题，我用这个：

```
ContextMenu.IsOpen = true; 
```

[ContextMenu 上的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.windows.controls.contextmenu%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:41:40.920

您必须调用 ContextMenu 的[Show(Control, Point)](http://msdn.microsoft.com/de-de/library/s00cc2f3.aspx)方法。此外，每次单击控件时，我都不会实例化新的上下文菜单，而是会执行以下操作：

```
MyClass()
{
     // create the context menu in the constructor:

     this.ContextMenu = new System.Windows.Forms.ContextMenu();   
     System.Windows.Forms.MenuItem item1 = new System.Windows.Forms.MenuItem();
     item1.Text = "A new Test";
     this.ContextMenu.Items.Add(item1);
}

private void mouseClickedResponse(object sender, System.Windows.Input.MouseEventArgs e)
{
    if (e.RightButton == MouseButtonState.Pressed)
    {
          // show the context menu as soon as the right mouse button is pressed
          this.ContextMenu.Show(this, e.Location);
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-23T20:27:18.407

我想你需要打电话`contextMenu.Show`

# php - 在使用本机查询和结果集映射时告诉学说如何格式化 DateTime

> ID：12099286
> 
> 赞同：0
> 
> 时间：2012-08-23T20:15:51.553
> 
> 标签：php, doctrine, doctrine-orm

我使用以下代码使用学说本机查询一些数据：

```
 $sql = "SELECT count(type) AS notifications, 
                count(DISTINCT subject) AS users, 
                count(DISTINCT object_activity) AS activities,
                count(DISTINCT object_activity_relationship) AS relationships,  
                type,
                min(created) as oldest, 
                max(created) as latest "
        ."FROM notification n "
        ."WHERE target_user='".$user->id."' AND notification_read=0 "
        ."GROUP BY type "
        ."ORDER BY latest ";

    $rsm = new \Doctrine\ORM\Query\ResultSetMapping;
    $rsm->addScalarResult('type', 'type');
    $rsm->addScalarResult('oldest', 'oldest');
    $rsm->addScalarResult('latest', 'latest');
    $rsm->addScalarResult('users', 'users');
    $rsm->addScalarResult('notifications', 'notifications');
    $rsm->addScalarResult('activities', 'activities');
    $rsm->addScalarResult('relationships', 'relationships');
    $query = $this->_em->createNativeQuery($sql, $rsm);
    return $query->getResult(); 
```

创建的字段是数据库中的 DateTime 字段，目前，它给了我这样的日期：

```
2012-08-22 14:45:37 
```

我想更改格式，有没有办法告诉教义如何使用结果集映射对其进行格式化？我知道我可以用 php 做到这一点，但我想先看看我是否可以这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T10:55:13.990

假设您使用的是 MySQL，您可以在查询中使用[DATE_FORMAT() ，如下所示：](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-format)

```
DATE_FORMAT(MIN(created), '%d-%m-%Y')) AS oldest 
```

我还建议您为 user_id 使用 $query->setParameter()

```
$sql = "SELECT
            COUNT(type) AS notifications, 
            COUNT(DISTINCT subject) AS users, 
            COUNT(DISTINCT object_activity) AS activities,
            COUNT(DISTINCT object_activity_relationship) AS relationships,  
            type,
            DATE_FORMAT(MIN(created), '%d-%m-%Y') AS oldest, 
            DATE_FORMAT(MAX(created), '%d-%m-%Y') AS latest
        FROM
            notification n
        WHERE
            target_user = ':user_id'
        AND
            notification_read = 0
        GROUP BY
            type
        ORDER BY
            latest";

$rsm = new \Doctrine\ORM\Query\ResultSetMapping;
$rsm->addScalarResult('type', 'type');
$rsm->addScalarResult('oldest', 'oldest');
$rsm->addScalarResult('latest', 'latest');
$rsm->addScalarResult('users', 'users');
$rsm->addScalarResult('notifications', 'notifications');
$rsm->addScalarResult('activities', 'activities');
$rsm->addScalarResult('relationships', 'relationships');
$query = $this->_em->createNativeQuery($sql, $rsm);
$query->setParameter('user_id', $user->id);
return $query->getResult(); 
```

如果您不想在 SQL 中固定格式，您也可以将其设为参数

# jquery - 如何使用 jquery 获取从 get Ajax 请求返回的数据值？

> ID：12099288
> 
> 赞同：0
> 
> 时间：2012-08-23T20:16:00.680
> 
> 标签：jquery

如何使用 jquery 获取从获取 Ajax 请求返回的某个数据值？

level_1_File 内容示例

```
<p data-test_name="level_1"> Level 1 test results have passed </p> 
```

这是获取 test_name 的数据属性但不起作用的 jquery 代码。没有显示警报消息。

```
 $.get(level_1_File, function(data)
                {
                      if($(data).data("test_name") === "level_1")
                      {
                            alert($(this).text());
                      }

                }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:17:54.503

$(data) 处于状态，但 $(this) 处于警报状态。

# php - 网络抓取删除没有为 php 附加 id/类的链接

> ID：12099289
> 
> 赞同：-1
> 
> 时间：2012-08-23T20:16:03.130
> 
> 标签：php

嗨，我使用网络抓取网站，但它包含太多我不需要的信息。这是我的代码：

```
<?php
require('phpQuery.php');
$url = 'http://www.nasdaq.com/screening/companies-by-name.aspx?letter=A';
$html = file_get_contents($url);
$pq = phpQuery::newDocumentHTML($html);
echo $pq['#CompanylistResults'];
?> 
```

结果是：

```
<table id="CompanylistResults">
<tbody>
<tr>
<tr>
<td>
<a target="_blank" rel="nofollow" href="http://www.1800flowers.com">1-800 FLOWERS.COM, Inc.</a>
</td>
<td>
<td style="">$100.55M</td>
<td style="display:none"></td>
<td>United States</td>
<td>1999</td>
<td style="width:105px">Other Specialty Stores</td> 
```

我需要的是“1-800 FLOWERS.COM, Inc.” 和文本中的“$ 100.55M”，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-23T12:53:57.797

试试这个代码：

```
//the url you need to scrape
$uri = ('http://www.nasdaq.com/screening/companies-by-name.aspx?letter=A');
//extracts HTML from the url
$get = file_get_contents($uri);

//Finding what you want removed
$pos1 = strpos($get, "<a target=\"_blank\" rel=\"nofollow\" href=\"http://www.1800flowers.com\">");
$pos2 = strpos($get, "</a>", $pos1);

$pos3 = strpos($get, "<td style=\"\">");
$pos4 = strpos($get, "</td>", $pos3);

//Removing the parts that are not needed
$text = substr($get,$pos1,$pos2-$pos1);
$test3 = substr($get,$pos3,$pos4-$pos3);

//Removing tags from is left after the above code, you should now have only the values that you are looking for
$text1 = strip_tags($text);
$text2 = strip tags($text3); 
```

# java - 如何使 android 复选框禁用布局中的某些内容？

> ID：12099291
> 
> 赞同：0
> 
> 时间：2012-08-23T20:16:08.073
> 
> 标签：java, android

现在我有 4 个复选框，我需要检查它们是否未被点击。如果它们是，那么下一个活动的布局需要更改。现在我有活动 1 上的复选框。活动 2 从活动 1 获取一个字符串变量并将其解析为一个 int 并检查它是否被传递为零或 1。现在在活动 2 上有一个按钮可以向该活动添加内容拉出一个弹出窗口。

```
public void newUserInput(View view){
        LayoutInflater inflater = (LayoutInflater)
                Launch.this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        PopupWindow pw = new PopupWindow(inflater.inflate(R.layout.popup_layout,null,false),300,400,true);

        pw.showAtLocation(findViewById(R.id.button1), Gravity.CENTER, 0, 0); 
```

所以......弹出的弹出窗口需要受到活动1中单击/未单击内容的影响。我的想法是检查它是否为零，然后隐藏该条目的文本和文本框。我只是不太确定我是否能做到这一点？此外，我的弹出窗口是绝对的，我认为如果我隐藏一个其他窗口就不会被向上推以使其看起来更干净，对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:26:44.133

您绝对可以根据您的选择隐藏布局中的项目。我不确定你的变量叫什么来保存选项，但你可以做类似下面的事情。

```
public void newUserInput(View view) {
    LayoutInflater inflater = (LayoutInflater)
        Launch.this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    View inflatedView = inflater.inflate(R.layout.popup_layout,null,false);

    if (myOption == 0) {
        TextView tv = (TextView) inflatedView.findViewById(R.id.my_text_view);
        tv.setVisibility(TextView.INVISIBLE);
    }

    PopupWindow pw = new PopupWindow(inflatedView,300,400,true);

    pw.showAtLocation(findViewById(R.id.button1), Gravity.CENTER, 0, 0);
} 
```

重要的是要注意 TextView.INVISIBLE 只会使 TextView 不可见......它不会将其从布局中删除，因此您的样式应该看起来与可见一样。如果您想完全从布局中删除 TextView，那么您可以使用 TextView.GONE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:19:32.913

几个想法：

Activity 2 可以有条件地加载不同的布局。或者，您可以使用 View.setVisibility(View.GONE); 从布局中隐藏视图（或 ViewGroup）。

因此，例如，如果您有一堆堆叠的相对布局（layout1、layout2、layout3），如果您执行 layout2.setVisibility(View.GONE)，则布局将像不存在一样绘制。

# postgresql - PostgreSQL 合并

> ID：12099296
> 
> 赞同：1
> 
> 时间：2012-08-23T20:16:29.993
> 
> 标签：postgresql

谁能说出为什么这个选择返回 3.0 而不是 3.5：

```
SELECT coalesce(1.0*(7/2),0) as foo 
```

这个返回 3：

```
SELECT coalesce(7/2,0) as foo 
```

我只是想将 SUM 除以 COUNT 以找到平均值。如果我有结果，我需要它 0 如果 null 和 1 以 1 位小数四舍五入。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:20:13.273

嗯，[`7/2`是整数](http://www.postgresql.org/docs/9.1/static/functions-math.html)，[`1.0`是数字](http://www.postgresql.org/docs/9.1/static/datatype-numeric.html)，等等`1.0*(7/2)==1.0 * 3 == 3.0`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T20:28:59.043

您需要执行以下操作：

```
SELECT COALESCE((1.0 * 7)/2, 0) AS foo; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-05T02:35:24.783

这感觉更好：

```
select 7.0/2.0;
--------------------
 3.5000000000000000 
```

# php - JQuery $.get() 中函数（数据）{} 的用途

> ID：12099305
> 
> 赞同：0
> 
> 时间：2012-08-23T20:17:10.367
> 
> 标签：php, javascript, jquery, ajax

在我的 MySQL 数据库中有一个 VideoID 和 VideoCode 列

我在**backend.php**中有一个 PHP 函数，旨在选择列表中的下一个视频，如下所示：

```
$VideoID = 0;

function nextvideo(){
    global $VideoID;
    $VideoID = $VideoID + 1;
    $sql = mysql_query("SELECT * FROM Videos WHERE VideoID = '".$VideoID."'");
    $result = mysql_fetch_array($sql);
    return $result[2];
}

$VideoCode = nextvideo(); 
```

然后，我的前端文件中的`$VideoCode`变量位于提供嵌入视频的 url 中。`echo`

这一切都很好，它可以工作，每次`nextvideo()`调用该函数时，它都会`$VideoCode`正确选择下一个。但是我想实现一个“下一个”按钮，允许用户有效地调用该`nextvideo()`函数，从而加载下一个视频。所以我知道我需要使用 AJAX 和该`.get()`功能，但我不知道如何使用它并尝试阅读它。到目前为止，我有这个：

```
<script type="text/javascript">
  function next() {
      $.get("backend.php", *1*, *2*);
      return false;
  }
</script>

<a href="#" onclick="next();">Next</a> 
```

我知道在函数中的**backend.php**`$.get()`之后我需要更多信息，`*1*`作为要发送到后端文件的内容，以及`*2*`在返回结果后如何处理结果。这就是我卡住的地方。

是否`*1*`需要是`nextvideo()`因为那是我希望调用的 PHP 函数，然后`*2*`是刷新页面以便`$VideoCode`更新变量并更新下一个视频的东西？阅读文档我知道它需要看起来像：

```
$.get("test.php", function(data){
    alert("Data Loaded: " + data);
}); 
```

但什么是`function(data)`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T20:31:53.960

`function(data)`是一个javascript函数，在请求完成时调用，传入变量`data`，即从服务器返回的页面。换句话说，当请求完成时，该函数中的代码将被执行，并且该变量`data`将包含服务器从您的请求返回的任何内容。

你想做的是这样的

```
<script type="text/javascript">
  function next() {
     var currentVideoId = $('#videoId').val();
     $.get("backend.php", { videoId: currentVideoId }, function(data) {
        $('#video').html(data); 
        $('#videoId').val($('#videoId').val() + 1);
     });
     return false;
  }
</script>

<a href="#" onclick="next();">Next</a> 
```

您有一个带有 id 的隐藏输入字段，`videoId`该字段具有当前视频 id 的值，以及一个带有 id 的元素，`video`该元素是要使用新视频更新的元素。

你的 PHP 脚本看起来像这样：

```
$VideoID = intval($_GET['videoId']) + 1;
$sql = mysql_query("SELECT * FROM Videos WHERE VideoID = '".$VideoID."'");
$result = mysql_fetch_array($sql);
echo $result[2]; 
```

这接受由 AJAX 函数传入的 $_GET 变量，并打印出发送到`data`javascript 中的变量的视频代码。

希望这会有所帮助，如果您仍然不确定任何事情，请询问！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:54:24.843

函数签名是：

```
jQuery.get( url [, data] [, success(data, textStatus, jqXHR)] [, dataType] ) 
```

`url`：您要向其发出“get”http 请求的 url。它可以是 html 文件、纯文本文件、图像等。在您的情况下，它是一个 php 文件，每次调用它时都会完全执行。

`[data]`: 可选参数，您要随请求发送的数据，以键值对的形式。例如，您可以发送您的请求：{ id : 1 }，您的服务器（在这种情况下为 php 脚本）将接收并可以用来为您的客户端（在这种情况下为您的 javascript）提供适当的响应

`[success]`: 可选参数，服务器应答后执行的回调函数。它是一个可选参数，但是一旦服务器完成它的工作并为您提供响应，您很可能总是想要做某事。

在您提供的示例中：

```
function(data){
   alert("Data Loaded: " + data)
}; 
```

是一个匿名函数（未命名）。执行时，该函数将接收最多 3 个参数： `success(data, textStatus, jqXHR)`. 我们对从服务器发回的数据感兴趣。它可以是任何东西：文本、xml、html、json 等。由于它只是 jquery 文档网站上的一个示例，因此该函数仅警告（来自浏览器的烦人消息框）它接收到的数据，实际上并没有什么用处. 我不确定我是否了解您在特定情况下想要做什么，但我希望我的一般回答会对您有所帮助。

# php - 使用 PHP 添加到数组

> ID：12099312
> 
> 赞同：0
> 
> 时间：2012-08-23T20:17:26.757
> 
> 标签：php, arrays, multidimensional-array

我正在研究将商品添加到购物车的功能。如果购物车中已经存在该商品，则将其数量增加 1。如果不存在，我想将商品数组添加到购物车数组的下一个位置。这是我正在使用的代码，其中 $add_to_cart 是项目 ID：

```
if ($add_to_cart){
$added = false;
foreach ($cart as &$item){
    if ($item['id'] == $add_to_cart){
        $item['qty'] += 1;
        $added = true;
    }
}
if (!$added){
    $cart[count($cart)]['id'] = $add_to_cart;
    $cart[count($cart)]['qty'] = 1;
}
$_SESSION[$session_id]['cart'] = $cart;
} 
```

当我使用此代码时，它不会将项目的 ID 添加到数组中。我怎样才能使这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:22:42.630

您的问题是当您向购物车添加新元素时：

```
if (!$added){
    $cart[count($cart)]['id'] = $add_to_cart;
    $cart[count($cart)]['qty'] = 1;
} 
```

你在每一行都打电话`count($cart)`。第1行调用后，计数不同，所以第2行添加了不同的元素。你想要的是将一个数组推到数组上。尝试这个：

```
if (!$added){
    $cart[] = array(
        'id' => $add_to_cart,
        'qty' => 1
    );
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T20:21:55.190

将您的购物车数组重组为如下所示：

```
array(
    'id' => 'qty',
    .
    .
    .
); 
```

我的意思是你不必像你那样循环遍历数组。

您可以检查是否`key`设置了索引，然后增加该索引处的值。

```
if (isset($item[$add_to_cart])) { // formerly if(array_key_exists($add_to_cart, $item)) {
    $item[$add_to_cart]++;
} else {
    $item[$add_to_cart] = 1;
} 
```

**通过这样做，您的性能将从 O(n) 变为 O(1)，并且您从 11 行代码变为 5 行。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T20:32:44.880

正如@Matt 所说，您可能会重组您的购物车阵列。但是，如果您真的想使用当前的购物车结构：

```
$cart = array();

function add_item($cart, $item_id)
{
    if(is_array($cart))
    {
        $added = false;

        for($i=0; $i<count($cart); $i++)
        {
            if($cart[$i]['id'] == $item_id)
            {
                $cart[$i]['qty'] ++;
                $added = true;
                break;
            }
        }

        if($added == false)
        {
            $i = count($cart);

            $cart[$i]['id'] = $item_id;
            $cart[$i]['qty'] = 1;
        }
    }

    return $cart;
}

$cart = add_item($cart, 50);
$cart = add_item($cart, 50);
$cart = add_item($cart, 50);

$cart = add_item($cart, 25);
$cart = add_item($cart, 25);

$cart = add_item($cart, 10);

var_dump($cart); 
```

它打印：

```
array
  0 => 
    array
      'id' => int 50
      'qty' => int 3
  1 => 
    array
      'id' => int 25
      'qty' => int 2
  2 => 
    array
      'id' => int 10
      'qty' => int 1 
```

**编辑：结构更好**

```
$cart = array();

function add_item($cart, $item_id)
{
    if(is_array($cart))
    {
        if(array_key_exists($item_id, $cart))
        {
            $cart[$item_id]++;
        }
        else
        {
            $cart[$item_id] = 1;
        }
    }

    return $cart;
}

$cart = add_item($cart, 50);
$cart = add_item($cart, 50);
$cart = add_item($cart, 50);

$cart = add_item($cart, 25);
$cart = add_item($cart, 25);

$cart = add_item($cart, 10);

var_dump($cart); 
```

它打印：

```
array
  50 => int 3
  25 => int 2
  10 => int 1 
```

# sql-server - 为与 SQL Server 的 1 到 (0..1) 关系设计 1 或 2 个表

> ID：12099315
> 
> 赞同：1
> 
> 时间：2012-08-23T20:17:41.040
> 
> 标签：sql-server, database-design, one-to-one

我已经阅读了几篇关于创建一对一关系的帖子：

[如何在 sql server 中创建真正的一对一关系](https://stackoverflow.com/questions/10292355/how-do-i-create-a-real-one-to-one-relationship-in-sql-server)

[是否曾经有过使用数据库 11 关系有意义的时候？](https://stackoverflow.com/questions/517417/is-there-ever-a-time-where-using-a-database-11-relationship-makes-sense?rq=1)

[数据库设计1对1关系](https://stackoverflow.com/questions/2786250/database-design-1-to-1-relationship)

但我很乐意听取您对这个基本案例的建议：我有一个 USER 和一个 COMPANY 表。每个用户可以有 0 或 1 个公司。

使用具有以下关系的两个表是否更好：

![USER_COMPANY](../Images/f35639aa9b8c7078b00567966f2041c3.png)

![关系](../Images/3e1b91d812366fd81eef4483294583fa.png)

还是我只需要使用一个包含所有所需字段的表：

![用户](../Images/0db6b7531b1ad2e714188726ea3b7f17.png)

谢谢你的解释。

注意：我正在使用 SQL Server（使用 Manager Studio 进行设置）并计划使用 EF。

更新：为了更明确，我想要实现的是：用户可以拥有或不拥有公司。如果他拥有一家公司，他是唯一为该公司工作的人。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:31:55.320

由于用户可能**不**拥有公司，因此这不是真正的“一对一”关系。

实际上，这是“1 到 0..1”，您可以通过以下两种方式之一对其进行建模：

1.  把所有东西都放在一张桌子上：

    ![在此处输入图像描述](../Images/fd3e5f85188e86f6887c4be8e17627d2.png)

    请注意 COMPANY_ID 如何既是 UNIQUE（防止多个用户拥有同一家公司）又是 NULL-able（允许不拥有公司的用户）。USER_ID 和 COMPANY_ID 的分离允许公司级外键（即允许子表引用公司，同时防止它们引用无公司用户）。

    如果没有公司级 FK，则可以完全省略 COMPANY_ID。

    您还需要一个 CHECK 以确保不能设置其他公司字段，除非设置了 COMPANY_ID（或至少公司字段的正确子集不为 NULL）。

2.  有两张桌子：

    ![在此处输入图像描述](../Images/63a797f91dba6e90d0da4b007eeceed5.png)

    我们不能只让这两个表的 PK 也成为 FK（在两个方向上），因为 MS SQL Server 不支持在插入新数据时解决鸡与蛋问题所需的延迟约束，它也不支持正确建模“1 到 0..1”关系（它将建模“1 到 1”并且不允许无公司用户）。

您应该选择这两种策略中的哪一种，很大程度上取决于与用户相比的公司数量：

*   如果大多数用户拥有一家公司，请选择 (1)。
*   如果用户多于公司，请选择 (2)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:25:15.653

这对我来说实际上听起来像是多对多的关系：

*   多个用户可以为一个公司工作
*   一个用户可以为多家公司工作

也许你不想考虑后一种情况，但我不会受伤。在这种情况下，您将有一个`user`表、一个`user_company`表（n 到 n 映射）和一个`company`表。如果要将用户限制为一家公司，请使表`user_id`中的列`user_company`唯一。

希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T20:24:57.390

这取决于您将拥有哪些其他数据。如果这是唯一使用公司的地方，那么就在一张桌子上找它。如果公司在其他几个表中使用，那么您希望它是一个单独的表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T20:29:54.247

你的第一个选择是最好的。

*   索引...性能...
*   如果用户不是公司...
*   如果您想在不带回公司的情况下查询用户...
*   ...或相反亦然
*   如果您有其他需要链接到用户而不是公司的表...
*   如果您希望能够以不同的方式保护表格（也许您的采购部门需要对公司的 SELECT 访问权限，而不是用户；您的人力资源部门需要对用户而不是公司的访问权限）......

有一百万个理由……但这里有 5 或 6 个需要考虑/让你开始。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T21:45:12.220

嗯，如果您可能没有要求每个用户拥有一家以上的公司，并且大部分用户都会拥有一家公司，并且没有那么多领域来描述一家公司，那么我会保持简单并使用一张表. 您以后可以随时改变主意。

如果您想要更多的范围 1 到多个，那么您将 userid 放入 company 或 companyid 放入 user，您所拥有的选项 1 将不起作用，并且还会导致令人难以置信的混乱代码。

```
Select Company From Companies Where CompanyID = @UserID;// huh eh? What!! 
```

正如其他人所说，如果您想要更大的范围以便可以进行多对多操作，则需要包含 CompanyID 和 UserID 的第三张表。

# ruby - 如何让 Twitter Bootstrap 的 Less 文件与 Sinatra AssetPack 一起使用？

> ID：12099319
> 
> 赞同：3
> 
> 时间：2012-08-23T20:17:56.920
> 
> 标签：ruby, twitter-bootstrap, sinatra, less, sinatra-assetpack

我正在尝试让 Bootstrap 的 Less 文件与[Sinatra AssetPack](http://ricostacruz.com/sinatra-assetpack/)一起使用，但我遇到了 Less 解析器错误。这些错误让我相信通过 bootstrap.less 导入的较少文件彼此不知道。

我有一个 app.rb 文件：

```
require 'sinatra/base'
require 'sinatra/assetpack'

class App < Sinatra::Base
  set :root, File.dirname(__FILE__)
  register Sinatra::AssetPack

  assets do
    css :bootstrap, [
      '/css/bootstrap.css'
    ]

  end

  get '/' do
    erb :index
  end

  # start the server if ruby file executed directly
  run! if app_file == $0
end 
```

我已将所有 Bootstrap less 文件复制到`/app/css`目录中并修改了 bootstrap.less 以便每个 @import 语句以 .css 而不是 .less 结尾（但实际文件扩展名并未更改）。我还将所有内容都放在了 Github 上：[https ://github.com/elevine/sinatra-assetpack-bootstrap](https://github.com/elevine/sinatra-assetpack-bootstrap)

这是我遇到的一个错误的堆栈跟踪的前半部分：

```
 Less::ParseError - .tab-focus is undefined:
        at /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/less-2.2.1/lib/less/js/lib/less/parser.js:385:31
        /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/less-2.2.1/lib/less/parser.rb:57:in `block in to_css'
        /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/less-2.2.1/lib/less/java_script/v8_context.rb:90:in `block in do_lock'
        /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/less-2.2.1/lib/less/java_script/v8_context.rb:88:in `do_lock'
        /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/less-2.2.1/lib/less/java_script/v8_context.rb:60:in `lock'
        /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/less-2.2.1/lib/less/java_script/v8_context.rb:30:in `exec'
        /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/less-2.2.1/lib/less/java_script.rb:26:in `exec'
        /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/less-2.2.1/lib/less/parser.rb:57:in `to_css'
        /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/tilt-1.3.3/lib/tilt/css.rb:68:in `evaluate'
        /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/tilt-1.3.3/lib/tilt/template.rb:76:in `render'
        /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:686:in `render'
        /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/sinatra-assetpack-0.0.11/lib/sinatra/assetpack/class_methods.rb:71:in `block (3 levels) in add_individual_routes!'
        /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/tilt-1.3.3/lib/tilt.rb:127:in `fetch'
        /users/elevine/.rbenv/versions/1.9.2-p320/lib/ruby/gems/1.9.1/gems/sinatra-assetpack-0.0.11/lib/sinatra/assetpack/class_methods.rb:70:in `block (2 levels) in add_individual_routes!' 
```

`.tab-focus`在 mixins.less 中定义，此错误源自 reset.less，它是 bootstrap.less 中的第一个导入。我尝试重新排列导入的顺序，但并没有解决问题。

*是否可以让 bootstrap.less 中的 @import 语句在此设置中正常工作？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T04:16:07.230

最近有很多关于 AssetPack gem 的工作（现在内置的支持较少）。如果您更新到最新的 gem，就很容易让 Less 工作。这个要点有一个完整的例子：[https](https://gist.github.com/4652773) ://gist.github.com/4652773 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:32:02.323

我发现的最佳解决方案是简单地将较少文件的路径添加到`Less.path`数组中。无需更改任何原始的less文件。

例如：

```
require 'sinatra/base'
require 'sinatra/assetpack'

class App < Sinatra::Base
  set :root, File.dirname(__FILE__)
  Less.paths <<  "#{App.root}/app/css" 

  register Sinatra::AssetPack

  assets do
    css :bootstrap, [
      '/css/bootstrap.css'
    ]

  end

  get '/' do
    erb :index
  end

  # start the server if ruby file executed directly
  run! if app_file == $0
end 
```

# android - 带有自定义拇指的 Android 搜索栏

> ID：12099321
> 
> 赞同：3
> 
> 时间：2012-08-23T20:18:11.217
> 
> 标签：android, seekbar

我想创建一个如下图所示的搜索栏：

[![搜索栏](../Images/ffb816338ba7877110849d042f64a26a.png)](https://i.stack.imgur.com/f8FF7.jpg)

问题是，如何将拇指放在进度线上方？

这条线

```
android:thumb="@drawable/thumb" 
```

将拇指放在线条的中心。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T14:25:11.020

您可以假设整个栏和上面的拇指作为一个搜索栏，您所要做的只是包括正在进行的栏和背景图像上方的空白区域，并将拇指下方的空白区域包含在图像中作为拇指。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-16T12:25:42.260

我也面临同样的问题..并找出以下解决方案，

解决方案 - 调整你的拇指与图层列表..

创建**custom_thumb.xml**（在您的可绘制文件夹中）

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
<item
android:width="50dp"
android:height="50dp"
android:top="35dp"
android:bottom="35dp"
android:drawable="@drawable/thumb"/>

</layer-list> 
```

根据需要调整宽度、高度、顶部、底部。

并使用以下代码设置拇指

```
android:thumb="@drawable/custom_thumb" 
```

# python - 在 Python 中启动一个外部程序并立即返回

> ID：12099322
> 
> 赞同：2
> 
> 时间：2012-08-23T20:18:13.020
> 
> 标签：python, qt, pyqt

> **可能重复：**
> [如何从 python 调用程序而不等待它返回](https://stackoverflow.com/questions/2602052/how-to-call-a-program-from-python-without-waiting-for-it-to-return)

我正在编写一个需要启动外部 Windows 可执行文件的 PyQt 程序。此时 Python 程序应该继续运行，不需要与它启动的 exe 文件有任何联系。

我尝试了几种变体，例如：

```
process = subprocess.Popen(["vncviewer.exe"]); process.communicate()
subprocess.call("vncviewer.exe")
os.system("vncviewer.exe")
os.system("vncviewer.exe&")
os.system("start vncviewer.exe") 
```

等等

使用几乎任何策略，我都可以成功运行程序，但是 Python 脚本随后会被阻止，直到程序完成。GUI 被冻结且无法使用。

如何让 Python 启动一个完全独立且不相关的任务，然后继续运行，以便我可以打开其他程序，甚至结束 Python 脚本而不影响它启动的程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T21:09:40.040

[`PyQt4.QtCore.QProcess.startDetached()`](http://qt-project.org/doc/qt-4.8/qprocess.html#startDetached-3)在后台独立执行程序：

```
QProcess.startDetached('vncviewer.exe') 
```

[与Dougal 建议的](https://stackoverflow.com/a/12099908/355252)单独`subprocess.Popen()`对象不同，使用此方法启动的进程即使在调用进程终止后仍继续运行。

在 PyQt4 程序中，更`QProcess`喜欢`subprocess`. 前者集成到 Qt 事件循环中，并允许通过 Qt 信号与子进程进行异步通信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:01:15.150

的文档[`subprocess.Popen.communicate()`](http://docs.python.org/library/subprocess.html#subprocess.Popen.communicate)包括“等待进程终止”这一短语，因此它被阻塞也就不足为奇了。

如果您只是创建`Popen`对象然后不理会它，它应该异步运行。然后你可以打电话`process.poll()`或者`process.wait()`如果你想检查一下。请注意，您应该确保在让脚本终止之前完成它，否则子进程将被毫不客气地杀死。要让脚本退出而不杀死子进程，请参阅评论中[@aleks_misyuk 链接的问题](https://stackoverflow.com/questions/2602052/how-to-call-a-program-from-python-without-waiting-for-it-to-return)。

# java - mysql for java中的语句

> ID：12099323
> 
> 赞同：0
> 
> 时间：2012-08-23T20:18:13.440
> 
> 标签：java, mysql, sql, database

我猜错误是在 sentenciaSQL 中，但我不知道如何修复它 =

```
public long guardar(PedidoDTO obj) throws SQLException {

PedidoDTO dto = new PedidoDTO();
String url="jdbc:mysql://127.0.0.1:3306/capacitacion?user=capacitacion&password=password";

try {
    Connection con = DriverManager.getConnection(url);
    String sentenciaSQL = "INSERT INTO capacitacion.pedido (id, fecha, total, folio) VALUES(NULL,'" +  obj.getId() + "," +  obj.getFecha() + ","+ obj.getTotal() + "," + obj.getFolio() + "')";
        PreparedStatement s =  con.prepareStatement(sentenciaSQL);
        s.executeUpdate();
        for(PedidoDetalleDTO detalle:obj.getPedidoDetalle()){
            dto.getId();
            dto.getFecha();
            dto.getTotal();
            dto.getFolio();
        }con.close();
} catch (SQLException e) {
    System.out.println(e);
}
return dto.getId();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:24:56.683

这不是 PreparedStatement 的好用法，应该是这样的：

```
String sentenciaSQL = "INSERT INTO capacitacion.pedido (id, fecha, total, folio) VALUES(?, ?, ?, ?)";
PreparedStatement s =  con.prepareStatement(sentenciaSQL);
s.setInt(1, obj.getId());
s.setDate(2, obj.getFecha());
s.setDouble(3, obj.getTotal());
s.setString(4, obj.getFolio()); 
```

顺便说一句，你为什么使用这个块代码：

```
for(PedidoDetalleDTO detalle:obj.getPedidoDetalle()){
    dto.getId();
    dto.getFecha();
    dto.getTotal();
    dto.getFolio();
} 
```

看起来您想使用相同的方法在表中添加订单详细信息 (detalles de la orden/pedido)，但不会以这种方式工作。如果您发布功能需求以帮助您解决实际问题，那就太好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:26:56.690

仔细看。您犯的错误是您在 sentenciaSQL 中的第一个和最后一个变量都有单独的、未闭合的刻度线（在 ID 和作品集中）：

```
VALUES(NULL,'" +  obj.getId() 
```

和...

```
obj.getFolio() + "')"; 
```

由于您已经在使用准备好的语句，因此最好的方法是将您的值添加为参数，如下所示：

```
String sentenciaSQL = "INSERT INTO capacitacion.pedido (id, fecha, total, folio) VALUES(?,?,?,?)";
PreparedStatement s =  con.prepareStatement(sentenciaSQL);
s.setInt(1,obj.getId());
s.setDate(2,obj.getFecha());
s.setInt(3,obj.getTotal());
s.setString(4,obj.getFolio().toString());
s.execute(); 
```

请注意，我假设您的 Id 和 Total 是整数。您将需要替换为实际的数据类型。

此外，如果您不关心更新了多少行，则可以使用 execute() 而不是 executeUpdate()。任何一个都可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T20:22:06.847

您正试图将五段数据插入四个字段。您的查询将尝试插入`NULL`into `id`、`obj.getId()`into`fecha`等。看起来删除`NULL`值列表中的 将是一个很好的第一步。

# jquery - 自定义 jQuery 伪选择器接收未定义的参数

> ID：12099325
> 
> 赞同：3
> 
> 时间：2012-08-23T20:18:23.960
> 
> 标签：jquery, jquery-selectors

我正在尝试根据我找到的一些不同的教程向 jQuery 添加一个自定义的伪选择器，目前使用的是 v1.8.0。我实际上是在尝试实现不区分大小写的 :contains 选择器。

我现在的化身是这样的

```
$.expr[':'].icontains = function(obj, index, meta, stack){
     return (obj.textContent || obj.innerText || jQuery(obj).text() || '').toLowerCase().indexOf(meta[3].toLowerCase()) >= 0;
}; 
```

来自[这篇文章](https://stackoverflow.com/a/3968100/173390)。似乎选择器正在正确初始化，但是当 jQuery 调用该函数时，只定义了 obj 参数。其余 3 个参数未定义。

当我将参数记录到控制台时，我看到一个包含 2 项的数组，第一项是我的选择器在 :icontains 调用之前返回的 DOM 对象，第二项是未定义的。

有谁知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T20:26:50.847

他们在 1.8 中对 Sizzle 进行了重写。目前[定义伪的方式](http://blog.jquery.com/2012/07/04/the-new-sizzle/)如下：http: [//jsfiddle.net/bazWj/](http://jsfiddle.net/bazWj/)。

```
$.expr.pseudos.icontains = $.expr.createPseudo(function(arg) {
    return function(elem) {
         return (elem.textContent
                  || elem.innerText
                  || jQuery(elem).text()
                  || '')
        .toLowerCase()
        .indexOf(arg.toLowerCase()) >= 0;

    };
}); 
```

# html - Webkit 背景图片被剪裁

> ID：12099326
> 
> 赞同：2
> 
> 时间：2012-08-23T20:18:26.693
> 
> 标签：html, css, webkit

我有一个有趣的小问题。

我的`body`元素上有一个背景图像，它在 Webkit 浏览器（特别是 Chrome）中像这样加载。

![坏的！](../Images/77f73395fb59fd3a651aa6a474c0839a.png)

调整窗口大小似乎可以解决这个问题......

以下是它的预期外观：

![好的！](../Images/00f711a7c2440742275d5c85dc7d7d21.png)

CSS：

```
body {
padding-top: 360px;
font-family:Helvetica, Helvetica Neue, Arial, sans-serif;

background: url('images/page-bg2.jpg') no-repeat left center fixed; 
-webkit-background-size: cover;
-moz-background-size: cover;
-o-background-size: cover;
background-size: cover;
} 
```

为什么会发生这种情况，我该如何解决？

现场直播：[http ://www.healthfair.biz/](http://www.healthfair.biz/)

多谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:12:59.507

我建议删除 body padding-top（设置 th，而是在 div.wrapper 上使用相同的 padding-top。这应该会有所帮助。

# python - Python：如何在对象列表上链接方法？

> ID：12099327
> 
> 赞同：1
> 
> 时间：2012-08-23T20:18:30.353
> 
> 标签：python, list, python-2.7

我希望能够在具有子节点和孙节点的节点实例上链接方法。当我在该顶部节点上调用方法时，我希望能够返回该对象的子孙。我还希望能够从最顶层节点获取这些子孙的属性。我有以下数据模型：

```
class GrandParent(object):
    def __init__(self,name='',age=0,is_retired=True,children=[]):
        self.name = name
        self.age = age
        self.is_retired = is_retired

        if children:
            self.children = children

    def print_mychildren(self):
       for child in self.children:
            print "Child: ",child

    def mychildren(self):
        return self.children

    def __str__(self):
        return "name: %s age: %s is_retired:%s" %(self.name,self.age,self.is_retired)

class Parent(object):
    def __init__(self,name='',age=0,has_mortgage=True,children=[]):
        self.name = name
        self.age = age
        self.has_mortgage = has_mortgage

        if children:
            self.children = children

    def print_mychildren(self):
       for child in self.children:
            print "Child: ",child

    def __str__(self):
        return "name: %s age: %s has_mortgage: %s" %(self.name,self.age,self.has_mortgage)

class Child(object):
    def __init__(self,name='',age=0,has_toys=True):

        self.name = name
        self.age = age
        self.has_toys = has_toys

    def __str__(self):
        return "name: %s age: %s has_toys:%s" %(self.name,self.age,self.has_toys)

if __name__ == '__main__':

    beaver = Child('Beaver',12,True)
    ward = Child('Ward',16,False)

    june = Parent('June',38,True,[beaver,ward])

    grandpa = GrandParent('Grandpa',61,True,[june])

    print grandpa

    grandpa.print_mychildren() # print June

    # Doesn't work
    grandpa.mychildren().print_mychildren() #  I want it to print Ward and Beaver
    # Doesn't work
    print grandpa.mychildren().mychild('Beaver').age # I want it to return an age 
```

请注意，我想将 GrandParent、Parent 和 Child 类分开，因为我想为每个类赋予不同的属性，例如 has_mortgage 或 is_retired。

从上面的数据模型中，我希望能够链接方法以遍历顶部节点的子节点。它看起来像这样：

```
grandpa.children # returns a list of children
print grandpa.mychild('June').has_mortgage # returns the value
grandpa.mychildren().mychildren() # prints a list of grandchildren
print grandpa.mychildren().mychild('Ward').has_toys # return the value 
```

换句话说，我可以发表声明吗：

```
print grandpa.mychildren().mychildren() 
```

表现得像：

```
for child in grandpa.children:
        for grandchild in child.children:
            print grandchild 
```

我将不胜感激您对此的回答。谢谢你。

伊利诺伊州保罗
芝加哥

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T02:21:30.903

你可以做你想做的事，但这需要一些工作。您需要使`children`您的值`Parent`和`Grandparent`类的值成为一个自定义容器，它将对方法和成员变量的访问映射到其内容。

这是一个可能的实现。它可能有一些我没有整理出来的奇怪的极端情况，但它适用于我尝试过的基本内容：

```
from operator import attrgetter

class mappingContainer(object):
    def __init__(self, contents):
        self.contents = contents

    # sequence protocol methods    
    def __getitem__(self, index):
        return self.contents[index]

    def __setitem__(self, index, value):
        self.contents[index] = value

    def __iter__(self):
        return iter(self.contents)

    def __contains__(self, o):
        return o in self.contents

    def __len__(self):
        return len(self.contents)

    # map attribute access and method calls
    def __getattr__(self, name):
        return mappingContainer(map(attrgetter(name), self.contents))

    def __call__(self, *args, **kwargs):
        return mappingContainer([o(*args, **kwargs) for o in self.contents])

    # string conversions
    def __repr__(self):
        return "mappingContainer(%s)" % repr(self.contents) 
```

这是一个简单的“Person”类，我用来测试它。每个人都有一个名字，零个或多个孩子在一个`mappingContainer`和一个任意命名的方法，打印一些东西并返回一个值。

```
class Person(object):
    def __init__(self, name, children = None):
        self.name = name
        if not children:
            children = []
        self.children = mappingContainer(children)

    def __repr__(self):
        return self.name

    def someMethod(self):
        print "%s's someMethod()" % str(self)
        return "%s's return value" % str(self) 
```

这是我测试它的方法（用长线包裹，在这里显示）：

```
>>> c1 = Person("Adam")
>>> c2 = Person("Albert")
>>> c3 = Person("Alice")
>>> c4 = Person("Agnes")
>>> p1 = Person("Bob", [c1, c2])
>>> p2 = Person("Betty", [c3,c4])
>>> gp = Person("Charles", [p1, p2])
>>> gp
Charles
>>> gp.children
mappingContainer([Bob, Betty])
>>> gp.children.children
mappingContainer([mappingContainer([Adam, Albert]),
                  mappingContainer([Alice, Agnes])])
>>> gp.children.children.someMethod()
Adam's someMethod()
Albert's someMethod()
Alice's someMethod()
Agnes's someMethod()
mappingContainer([mappingContainer(["Adam's return value",
                                    "Albert's return value"]),
                  mappingContainer(["Alice's return value",
                                    "Agnes's return value"])]) 
```

现在这可能不是你想要的，因为你不能直接遍历孙子 via `gp.children.children`（虽然函数调用会一直冒泡，但它们的结果仍将嵌套在两层容器中）。我认为mappingContainer 可能会以某种方式进行调整来解决这个问题，但我不确定它是否值得。

如果出现任何问题，这种链式调用将成为调试的噩梦（除非您是超人，否则代码中的某些内容在开发的某个时刻总是会出错）。如果您明确地迭代或递归您拥有的关系层次结构，您的代码将更容易编写和理解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T02:20:25.520

一种方法是为列表集合创建一个包装器（有点类似于 jQuery 处理方法链接的方式）

代码：

```
class ChainList(list):
    def __getattribute__(self, name):
        try:
            return object.__getattribute__(self, name)
        except:
            pass

        return ChainList([getattr(child, name) 
            for child in self if name in dir(child)])

    def __call__(self, *args, **kwargs):       
        return ChainList([child(*args, **kwargs)
            for child in self if callable(child)])

class GrandParent(object):
    def __init__(self,name='',age=0,is_retired=True,children=[]):
        self.name = name
        self.age = age
        self.is_retired = is_retired

        if children:
            self.children = ChainList(children)

    def print_mychildren(self):
       for child in self.children:
            print "Child: ",child

    def mychildren(self):
        return self.children

    def __str__(self):
        return "name: %s age: %s is_retired:%s" %(self.name,self.age,self.is_retired)

class Parent(object):
    def __init__(self,name='',age=0,has_mortgage=True,children=[]):
        self.name = name
        self.age = age
        self.has_mortgage = has_mortgage

        if children:
            self.children = ChainList(children)

    def print_mychildren(self):
       for child in self.children:
            print "Child: ",child

    def __str__(self):
        return "name: %s age: %s has_mortgage: %s" %(self.name,self.age,self.has_mortgage)

    def mychild(self, name):
        for child in self.children:
            if child.name == name:
                return child

class Child(object):
    def __init__(self,name='',age=0,has_toys=True):

        self.name = name
        self.age = age
        self.has_toys = has_toys

    def __str__(self):
        return "name: %s age: %s has_toys:%s" %(self.name,self.age,self.has_toys)

if __name__ == '__main__':

    beaver = Child('Beaver',12,True)
    ward = Child('Ward',16,False)

    june = Parent('June',38,True,[beaver,ward])

    grandpa = GrandParent('Grandpa',61,True,[june])

    print grandpa

    grandpa.print_mychildren() # print June

    # Doesn't work
    grandpa.mychildren().print_mychildren() #  I want it to print Ward and Beaver
    # Doesn't work
    print grandpa.mychildren().mychild('Beaver').age # I want it to return an age 
```

主要思想是 ChainList 类，并覆盖`__getattribute__`和`__call__`包装所有需要与此类链接的列表。

我还将 mychild() 添加到 Parent 以使示例正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T20:55:53.780

对我来说，这听起来很像你在谈论模型和模型关系。看看 Django。[Django 模型](https://docs.djangoproject.com/en/1.4/topics/db/models/)将完全按照您的意愿进行操作，您可以定义模型之间的关系并[跨这些关系进行查询](https://docs.djangoproject.com/en/1.4/topics/db/queries/)。

# clojure - 在 Clojure 函数中重新绑定 var 的具体缺点是什么？

> ID：12099329
> 
> 赞同：3
> 
> 时间：2012-08-23T20:18:33.317
> 
> 标签：clojure

在探索 Clojure 中计算阶乘的各种方法时，我想出了以下（非惯用的）函数：

```
(defn factorial-using-do-dotimes [x]
  (do
    (def a 1)
    (dotimes [i x]
      (def a (* a (inc i)))))
  a) 
```

回复：

```
user=> (factorial-using-do-dotimes 5)
120 
```

这有什么具体的缺点（除了“非惯用的”）？表现？正确性（即可能的缺陷）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T22:41:53.297

如果您尝试并行运行此代码，那么竞争条件可能会
导致它**默默地产生错误的答案**

首先自己运行它：

```
core> (factorial-using-do-dotimes 10)
3628800 
```

然后运行两份，但让快速的一份提前完成：

```
core> (do (future (do (java.lang.Thread/sleep 5) 
                      (factorial-using-do-dotimes  1200))) 
          (factorial-using-do-dotimes 10))
3628800 
```

然后将它们靠得更近：

```
core> (do (future (do (java.lang.Thread/sleep 1) 
                      (factorial-using-do-dotimes 1200))) 
          (factorial-using-do-dotimes 10))
3628800 
```

然后同时运行它们：

```
core> (do (future (do (java.lang.Thread/sleep 0) 
                      (factorial-using-do-dotimes 1200))) 
          (factorial-using-do-dotimes 10))
54698277723986154311681531904000000N 
```

这不是正在运行的任何一个阶乘的答案。
(factorial-using-do-dotimes 1200) 长度为 3176 位

答案是错误的。

注意：我将 factorial-using-do-dotimes 函数更改为 use`*'`而不是，`*`因此我可以在更大的示例上运行它，以使示例中的时间更容易命中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T20:55:43.047

在函数体内使用 def 不是惯用的，排序但不是明确未定义的行为，并且考虑到 vars 的实现方式， using`(dotimes .. (def ..))`很可能比 using 慢`(loop ... (recur ...))`，尤其是当您使用基本类型时，例如数字，和类型提示。

不对变量进行这种“动态”修改的主要原因是它无缘无故地使您的代码复杂化。在正常情况下，循环/递归和瞬态的一些更惯用的组合应该可以让您获得与 clojure 一样好的性能。它仍然是线程安全的、可预测的和可读的。

编辑：作为一个具体的缺陷：当从多个线程同时调用时，您的示例代码无法正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T20:55:44.570

在需要同步的环境中，重新绑定 def 可能会产生不可预知的结果。如果需要修改状态，请考虑使用 refs、atoms 或 agent。

您可以像这样在 for 循环中累积值

```
(defn chk-key-present-in-sos
  ""
  [mapped-sos cmp-key cmp-seq-vals]
  (if (seq-of-maps? mapped-sos)
    (for [mapped-row mapped-sos
        :let [matched-rows mapped-row]
        :when (chk-one-val-present mapped-row cmp-key cmp-seq-vals)]
      matched-rows)
    nil)) 
```

您可以使用 reduce 来产生最终结果。

```
(defn key-pres?
"This function accepts a value (cmp-val) and a vector of vectors
(parsed output from clojure-csv) and returns the match value
back if found and nil if not found.

Using reduce, the function searches every vector row to see
if cmp-val is at the col-idx location in the vector."

[cmp-val cmp-idx csv-data]
   (reduce
       (fn [ret-rc csv-row]
          (if (= cmp-val (nth csv-row col-idx nil))
            (conj ret-rc cmp-val)))
       []
       csv-data)) 
```

并且可以`into`用来积累。

最后，您始终可以使用递归并让终止步骤返回累积的斐波那契值。

# php - 以mktime格式从mysql中分别获取日、月、年

> ID：12099331
> 
> 赞同：0
> 
> 时间：2012-08-23T20:18:41.850
> 
> 标签：php, mysql, date, mktime

我有一个用于将日期添加到数据库中的 mktime 代码。此代码以 mktime 格式分别显示当前日期。

```
<?php function drawDateTimePicker() { ?>
<select name="day">
    <?php for($x=1;$x<=31;$x++) { ?>
        <option value="<?= $x ?>"<?= (date("j") == $x ? ' selected="selected"' : '') ?>><?= $x ?></option>  
    <?php } ?>
</select>
<select name="month">
    <?php for($x=1;$x<=12;$x++) { ?>
        <option value="<?= $x ?>"<?= (date("n") == $x ? ' selected="selected"' : '') ?>><?= date('m', mktime(0,0,0,$x)) ?></option> 
    <?php } ?>
</select>
<select name="year">
    <?php for($x=2009;$x<=2015;$x++) { ?>
        <option value="<?= $x ?>"<?= (date("Y") == $x ? ' selected="selected"' : '') ?>><?= $x ?></option>  
    <?php } ?>      
</select> / 
<select name="hour">
    <?php for($x=1;$x<=12;$x++) { ?>
        <option value="<?= $x ?>"<?= (date("H") == $x ? ' selected="selected"' : '') ?>><?= $x ?></option>  
    <?php } ?>
</select> 
```

此代码将日期插入数据库字段 $row['birthdate']

我想在修改页面时显示日期形式 $row['birthdate'] 数据。在此代码中每次显示当前日期，与数据库中的数据不匹配

如何从数据库中检索数据并将其显示在修改页面中？

谢谢

分辨率是

```
<?php function drawDateTimePicker($mktimedata) { ?>

<select name="day">

    <?php for($x=1;$x<=31;$x++) { ?>

        <option value="<?= $x ?>"<?= (date("j",$mktimedata) == $x ? ' selected="selected"' : '') ?>><?= $x ?></option>    

    <?php } ?>

</select>

<select name="month">

    <?php for($x=1;$x<=12;$x++) { ?>

        <option value="<?= $x ?>"<?= (date("n",$mktimedata) == $x ? ' selected="selected"' : '') ?>><?= date('m', mktime(0,0,0,$x)) ?></option>    

    <?php } ?>

</select>

<select name="year">

    <?php for($x=2009;$x<=2015;$x++) { ?>

        <option value="<?= $x ?>"<?= (date("Y",$mktimedata) == $x ? ' selected="selected"' : '') ?>><?= $x ?></option>    

    <?php } ?>        

</select> 
```

drawDateTimePicker($date_in_database);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:28:30.683

date([format]) 为您提供实际的日期。如果你想要一个未来或过去的日期，你可以用 date([format], "time() of past Date"); 例如：

```
date("Y", mktime(0, 0, 0, 12, 32, 1997)); 
```

要从数据库中拆分日期，您可以使用以下内容：

```
$mydate = explode("-", $row["birthdate"]);
date("Y", mktime(0, 0, 0, $mydate[1], $mydate[2], $mydate[0]); 
```

更多示例：[http ://de2.php.net/manual/de/function.mktime.php](http://de2.php.net/manual/de/function.mktime.php)

或者你用 MySQL 拆分它：

```
select YEAR(birthday) as y, MONTH(birthday) as m, DAY(birthday) as d FROM table 
```

并使用 $row["y"]、$row["m"] 和 $row["d"]

```
<select name="day">
    <?php for($x=1;$x<=31;$x++) { ?>
        <option value="<?= $x ?>"<?= (date("j", mktime(0, 0, 0, $mydate[1], $mydate[2], $mydate[0]) == $x) ? ' selected="selected"' : '') ?>><?= $x ?></option>  
    <?php } ?>
</select> 
```

或者

```
<select name="day">
    <?php for($x=1;$x<=31;$x++) { ?>
        <option value="<?= $x ?>"<?= ($row["d"] == $x) ? ' selected="selected"' : '') ?>><?= $x ?></option>  
    <?php } ?>
</select> 
```

# mysql - 为什么 column = upper(column) 在 Oracle 中有效，而在 MySQL 中无效？

> ID：12099333
> 
> 赞同：2
> 
> 时间：2012-08-23T20:18:47.407
> 
> 标签：mysql, sql, oracle

在 mySQL 中我必须使用`WHERE BINARY UPPER(col1) = col1`，但在 Oracle 中它可以正常工作。有人可以向我解释这是为什么吗？我是 mySQL 的新手。

所以用下面的语句来看它

```
select upper(col1),col1
from mytable
where upper(col1) = col1; 
```

甲骨文的结果：

```
UPPER(COL1)          COL1               
-------------------- --------------------
JÜRGEN               JÜRGEN               
RENÉ                 RENÉ                 
CARL                 CARL 
```

结果在 MySQL

```
UPPER(COL1)          COL1               
-------------------- --------------------
JÜRGEN               JÜRGEN               
JÜRGEN               Jürgen               
RENÉ                 René                 
RENÉ                 RENÉ                 
CARL                 Carl                 
CARL                 CARL 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:21:11.280

默认情况下，字符串比较在 MySQL 和 SQLServer 中不区分大小写。

[如何在 MySQL 上进行 SQL 区分大小写的字符串比较？](https://stackoverflow.com/questions/5629111/mysql-case-sensitive-string-comparison)

[http://dev.mysql.com/doc/refman/5.0/en/case-sensitive.html](http://dev.mysql.com/doc/refman/5.0/en/case-sensitivity.html)

[为什么 SQL Server '=' 比较器不区分大小写？](https://stackoverflow.com/questions/4938924/why-is-sql-server-comparator-case-insensitive)

[http://msdn.microsoft.com/en-us/library/aa174903%28SQL.80%29.aspx](http://msdn.microsoft.com/en-us/library/aa174903%28SQL.80%29.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T20:21:27.513

您的 MySQL 排序规则不区分大小写......`'CARL' = 'Carl'`确实如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T20:57:21.463

将单词 BINARY 放在 WHERE 和 UPPER 之间。这将强制进行区分大小写的比较

# xml - 基于特征属性的 XSLT 嵌套菜单转换

> ID：12099335
> 
> 赞同：1
> 
> 时间：2012-08-23T20:19:01.387
> 
> 标签：xml, xslt

我正在编写一个将修改现有菜单输出的应用程序。我有很多方法可以做到这一点，我认为其中之一是 XSLT，但我是此类转换的完全初学者。

我希望更改以下内容：

```
<ul>
  <li><a href="#">Item1</a>
    <ul>
      <li class="featured"><a href="#">Item 1.1</a></li>
      <li><a href="#">Item 1.2</a></li>
      <li class="featured"><a href="">Item 1.3</a></li>
      <li><a href="#">Item 1.4</a></li>
    </ul>
  </li>
</ul> 
```

给新的：

```
<ul>
  <li><a href="#">Item1</a>
    <ul>
      <li>
        <ul>
          <li><a href="#">Item 1.1</a></li>
          <li><a href="#">Item 1.2</a></li>
          <li><a href="#">Item 1.3</a></li>
          <li><a href="#">Item 1.4</a></li>
        </ul>
      </li>
      <li>
        <ul class="featured">
           <li><a href="#">Item 1.1</a></li>
           <li><a href="#">Item 1.3</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul> 
```

我有以下问题：

对于上述情况，我需要什么转换？

我将如何限制只有 n 级深度（在这种情况下，我们不希望包含项目的子`ul.ul.ul.li`项，即项目 xx）？

如果我只想将此变换应用于顶部`<ul>`具有属性的样式`class="style1"`，并且如果将其设置`"style2"`为应用不同的变换怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T04:11:31.337

我不是 100% 确定您为什么要添加额外的级别，`ul`并且我不确定“n 级别”深度要求（更好的示例会有所帮助），但这应该可以帮助您入门：

**XSLT 1.0**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="ul[@class='style1']/li">
        <xsl:copy>
            <xsl:apply-templates select="@*|*[not(self::ul)]"/>
            <ul>
                <li>
                    <xsl:apply-templates select="ul"/>
                </li>
                <li>
                    <ul class="featured">
                        <xsl:apply-templates select="ul/li[@class='featured']"/>
                    </ul>
                </li>
            </ul>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="li">
        <xsl:copy>
            <xsl:apply-templates/>
        </xsl:copy>
    </xsl:template>

</xsl:stylesheet> 
```

**输出**

```
<ul class="style1">
   <li>
      <a href="#">Item1</a>
      <ul>
         <li>
            <ul>
               <li>
                  <a href="#">Item 1.1</a>
               </li>
               <li>
                  <a href="#">Item 1.2</a>
               </li>
               <li>
                  <a href="">Item 1.3</a>
               </li>
               <li>
                  <a href="#">Item 1.4</a>
               </li>
            </ul>
         </li>
         <li>
            <ul class="featured">
               <li>
                  <a href="#">Item 1.1</a>
               </li>
               <li>
                  <a href="">Item 1.3</a>
               </li>
            </ul>
         </li>
      </ul>
   </li>
</ul> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T03:13:55.570

你可以试试这个 XSLT

```
<?xml version="1.0" encoding="UTF-8"?>

<xsl:stylesheet
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:php="http://php.net/xsl"  exclude-result-prefixes="php" version="1.0">
  <xsl:output method="html" version="1.0" encoding="utf-8" indent="yes"  omit-xml-declaration="no"/>

  <xsl:template match="/">
    <div id="menu">
      <ul id="mega">
        <xsl:for-each select="//Menu/MainMenu">
          <xsl:choose>
            <xsl:when  test="@isdisplay=1 and @iscategory=1">
              <xsl:element name="li">
                <xsl:attribute name="style">
                  border-left:#ffffff 1px solid;
                </xsl:attribute>
                <xsl:attribute name="class">
                  <xsl:value-of select="@class"/>
                </xsl:attribute>
                <xsl:variable name="name">
                  <xsl:value-of select="@name"/>
                </xsl:variable>
                <xsl:element name="a">
                  <xsl:attribute name="href">
                    <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php',$name,'','','')"/>
                  </xsl:attribute>
                  <xsl:value-of select="@displayname"/>
                </xsl:element>
                <xsl:if test="count(SubMenu) > 0">
                  <xsl:choose>
                    <xsl:when test="@name='Outdoor Gear'">
                      <div>
                        <xsl:apply-templates select="//Menu/MainMenu[@name='Outdoor Gear']">
                        </xsl:apply-templates>
                      </div>
                    </xsl:when>
                    <xsl:when test="@name='Clothing / Footwear'">
                      <div style="width:490px !important;">
                        <xsl:apply-templates select="//Menu/MainMenu[@name='Clothing / Footwear']"></xsl:apply-templates>
                      </div>
                    </xsl:when>
                    <xsl:when test="@name='Electronics'">
                      <div style="width:200px !important;">
                        <xsl:apply-templates select="//Menu/MainMenu[@name='Electronics']"></xsl:apply-templates>
                      </div>
                    </xsl:when>
                    <xsl:when test="@name='Gifts'">
                      <div style="width:200px !important;">
                        <xsl:apply-templates select="//Menu/MainMenu[@name='Gifts']"></xsl:apply-templates>
                      </div>
                    </xsl:when>
                    <xsl:when test="@name='Petzl'">
                      <div style="width:200px !important;">
                        <xsl:apply-templates select="//Menu/MainMenu[@name='Petzl']"></xsl:apply-templates>
                      </div>
                    </xsl:when>
                  </xsl:choose>
                </xsl:if>
              </xsl:element>
            </xsl:when>
            <xsl:when  test="@isdisplay=1 and @iscategory=0">
              <xsl:element name="li">
                <xsl:attribute name="style">
                  border-left:#ffffff 1px solid;
                </xsl:attribute>
                <xsl:attribute name="class">
                  <xsl:value-of select="@class"/>
                </xsl:attribute>
                <xsl:variable name="name">
                  <xsl:value-of select="@name"/>
                </xsl:variable>
                <xsl:element name="a">
                  <xsl:attribute name="href">
                    <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','',$name,'','','')"/>
                  </xsl:attribute>
                  <xsl:value-of select="@displayname"/>
                </xsl:element>
              </xsl:element>
            </xsl:when>
          </xsl:choose>
        </xsl:for-each>
      </ul>
    </div>
  </xsl:template>

  <xsl:template match="//Menu/MainMenu[@name='Outdoor Gear']">
    <span class="main">
      <h2>
        <xsl:variable name="name">
          <xsl:value-of select="SubMenu[@name='Water Sport']/@name"/>
        </xsl:variable>
        <xsl:element name="a">
          <xsl:attribute name="href">
            <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,'','')"/>
          </xsl:attribute>
          <xsl:value-of select="SubMenu[@name='Water Sport']/@displayname" disable-output-escaping="yes"/>
        </xsl:element>
      </h2>
      <xsl:for-each select="SubMenu[@name='Water Sport']/SubSubMenu">
        <xsl:if test="@isdisplay=1">
          <span class="inner">
            <xsl:variable name="name">
              <xsl:value-of select="//Menu/MainMenu[@name='Outdoor Gear']/SubMenu[@name='Water Sport']/@name"/>
            </xsl:variable>
            <xsl:variable name="name1">
              <xsl:value-of select="@name"/>
            </xsl:variable>
            <xsl:element name="a">
              <xsl:attribute name="href">
                <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,$name1,'')"/>
              </xsl:attribute>
              <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
            </xsl:element>
          </span>
        </xsl:if>
        <xsl:for-each select="ChildMenu">
          <xsl:if test="@isdisplay=1">
            <span class="inner">
              <xsl:variable name="name">
                <xsl:value-of select="../../@name"/>
              </xsl:variable>
              <xsl:variable name="name1">
                <xsl:value-of select="../@name"/>
              </xsl:variable>
              <xsl:variable name="name2">
                <xsl:value-of select="@name"/>
              </xsl:variable>
              <xsl:element name="a">
                <xsl:attribute name="href">
                  <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,$name1,$name2)"/>
                </xsl:attribute>
                <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
              </xsl:element>
            </span>
          </xsl:if>
        </xsl:for-each>
      </xsl:for-each>

      <br clear="all"  />
      <h2>
        <xsl:variable name="name">
          <xsl:value-of select="SubMenu[@name='Archery']/@name"/>
        </xsl:variable>
        <xsl:element name="a">
          <xsl:attribute name="href">
            <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,'','')"/>
          </xsl:attribute>
          <xsl:value-of select="SubMenu[@name='Archery']/@displayname" disable-output-escaping="yes"/>
        </xsl:element>
      </h2>
      <xsl:for-each select="SubMenu[@name='Archery']/SubSubMenu">
        <xsl:if test="@isdisplay=1">
          <span class="inner">
            <xsl:variable name="name">
              <xsl:value-of select="//Menu/MainMenu[@name='Outdoor Gear']/SubMenu[@name='Archery']/@name"/>
            </xsl:variable>
            <xsl:variable name="name1">
              <xsl:value-of select="@name"/>
            </xsl:variable>
            <xsl:element name="a">
              <xsl:attribute name="href">
                <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,$name1,'')"/>
              </xsl:attribute>
              <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
            </xsl:element>
          </span>
        </xsl:if>
        <xsl:for-each select="ChildMenu">
          <xsl:if test="@isdisplay=1">
            <span class="inner">
              <xsl:variable name="name">
                <xsl:value-of select="../../@name"/>
              </xsl:variable>
              <xsl:variable name="name1">
                <xsl:value-of select="../@name"/>
              </xsl:variable>
              <xsl:variable name="name2">
                <xsl:value-of select="@name"/>
              </xsl:variable>
              <xsl:element name="a">
                <xsl:attribute name="href">
                  <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,$name1,$name2)"/>
                </xsl:attribute>
                <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
              </xsl:element>
            </span>
          </xsl:if>
        </xsl:for-each>
      </xsl:for-each>

      <h2>
        <xsl:variable name="name">
          <xsl:value-of select="SubMenu[@name='Climbing']/@name"/>
        </xsl:variable>
        <xsl:element name="a">
          <xsl:attribute name="href">
            <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,'','')"/>
          </xsl:attribute>
          <xsl:value-of select="SubMenu[@name='Climbing']/@displayname" disable-output-escaping="yes"/>
        </xsl:element>
      </h2>
      <xsl:for-each select="SubMenu[@name='Climbing']/SubSubMenu">
        <xsl:if test="@isdisplay=1">
          <span class="inner">
            <xsl:variable name="name">
              <xsl:value-of select="//Menu/MainMenu[@name='Outdoor Gear']/SubMenu[@name='Climbing']/@name"/>
            </xsl:variable>
            <xsl:variable name="name1">
              <xsl:value-of select="@name"/>
            </xsl:variable>
            <xsl:element name="a">
              <xsl:attribute name="href">
                <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,$name1,'')"/>
              </xsl:attribute>
              <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
            </xsl:element>
          </span>
        </xsl:if>
        <xsl:for-each select="ChildMenu">
          <xsl:if test="@isdisplay=1">
            <span class="inner">
              <xsl:variable name="name">
                <xsl:value-of select="../../@name"/>
              </xsl:variable>
              <xsl:variable name="name1">
                <xsl:value-of select="../@name"/>
              </xsl:variable>
              <xsl:variable name="name2">
                <xsl:value-of select="@name"/>
              </xsl:variable>
              <xsl:element name="a">
                <xsl:attribute name="href">
                  <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,$name1,$name2)"/>
                </xsl:attribute>
                <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
              </xsl:element>
            </span>
          </xsl:if>
        </xsl:for-each>
      </xsl:for-each>

      <br clear="all"  />
      <h2>
        <xsl:variable name="name">
          <xsl:value-of select="SubMenu[@name='Fishing']/@name"/>
        </xsl:variable>
        <xsl:element name="a">
          <xsl:attribute name="href">
            <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,'','')"/>
          </xsl:attribute>
          <xsl:value-of select="SubMenu[@name='Fishing']/@displayname" disable-output-escaping="yes"/>
        </xsl:element>
      </h2>
      <xsl:for-each select="SubMenu[@name='Fishing']/SubSubMenu">
        <xsl:if test="@isdisplay=1">
          <span class="inner">
            <xsl:variable name="name">
              <xsl:value-of select="//Menu/MainMenu[@name='Outdoor Gear']/SubMenu[@name='Fishing']/@name"/>
            </xsl:variable>
            <xsl:variable name="name1">
              <xsl:value-of select="@name"/>
            </xsl:variable>
            <xsl:element name="a">
              <xsl:attribute name="href">
                <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,$name1,'')"/>
              </xsl:attribute>
              <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
            </xsl:element>
          </span>
        </xsl:if>
        <xsl:for-each select="ChildMenu">
          <xsl:if test="@isdisplay=1">
            <span class="inner">
              <xsl:variable name="name">
                <xsl:value-of select="../../@name"/>
              </xsl:variable>
              <xsl:variable name="name1">
                <xsl:value-of select="../@name"/>
              </xsl:variable>
              <xsl:variable name="name2">
                <xsl:value-of select="@name"/>
              </xsl:variable>
              <xsl:element name="a">
                <xsl:attribute name="href">
                  <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,$name1,$name2)"/>
                </xsl:attribute>
                <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
              </xsl:element>
            </span>
          </xsl:if>
        </xsl:for-each>
      </xsl:for-each>
    </span>

    <span class="main">
      <h2>
        <xsl:variable name="name">
          <xsl:value-of select="SubMenu[@name='Track / Field / Court / Indoors']/@name"/>
        </xsl:variable>
        <xsl:element name="a">
          <xsl:attribute name="href">
            <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,'','')"/>
          </xsl:attribute>
          <xsl:value-of select="SubMenu[@name='Track / Field / Court / Indoors']/@displayname" disable-output-escaping="yes"/>
        </xsl:element>
      </h2>
      <xsl:for-each select="SubMenu[@name='Track / Field / Court / Indoors']/SubSubMenu">
        <xsl:if test="@isdisplay=1">
          <span class="inner">
            <xsl:variable name="name">
              <xsl:value-of select="//Menu/MainMenu[@name='Outdoor Gear']/SubMenu[@name='Track / Field / Court / Indoors']/@name"/>
            </xsl:variable>
            <xsl:variable name="name1">
              <xsl:value-of select="@name"/>
            </xsl:variable>
            <xsl:element name="a">
              <xsl:attribute name="href">
                <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,$name1,'')"/>
              </xsl:attribute>
              <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
            </xsl:element>
          </span>
        </xsl:if>
        <xsl:for-each select="ChildMenu">
          <xsl:if test="@isdisplay=1">
            <span class="inner">
              <xsl:variable name="name">
                <xsl:value-of select="../../@name"/>
              </xsl:variable>
              <xsl:variable name="name1">
                <xsl:value-of select="../@name"/>
              </xsl:variable>
              <xsl:variable name="name2">
                <xsl:value-of select="@name"/>
              </xsl:variable>
              <xsl:element name="a">
                <xsl:attribute name="href">
                  <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,$name1,$name2)"/>
                </xsl:attribute>
                <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
              </xsl:element>
            </span>
          </xsl:if>
        </xsl:for-each>
      </xsl:for-each>

      <br clear="all"  />
      <h2>
        <xsl:variable name="name">
          <xsl:value-of select="SubMenu[@name='Hiking and Camping']/@name"/>
        </xsl:variable>
        <xsl:element name="a">
          <xsl:attribute name="href">
            <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,'','')"/>
          </xsl:attribute>
          <xsl:value-of select="SubMenu[@name='Hiking and Camping']/@displayname" disable-output-escaping="yes"/>
        </xsl:element>
      </h2>
      <xsl:for-each select="SubMenu[@name='Hiking and Camping']/SubSubMenu">
        <xsl:if test="@isdisplay=1">
          <span class="inner">
            <xsl:variable name="name">
              <xsl:value-of select="//Menu/MainMenu[@name='Outdoor Gear']/SubMenu[@name='Hiking and Camping']/@name"/>
            </xsl:variable>
            <xsl:variable name="name1">
              <xsl:value-of select="@name"/>
            </xsl:variable>
            <xsl:element name="a">
              <xsl:attribute name="href">
                <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,$name1,'')"/>
              </xsl:attribute>
              <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
            </xsl:element>
          </span>
        </xsl:if>
        <xsl:for-each select="ChildMenu">
          <xsl:if test="@isdisplay=1">
            <span class="inner">
              <xsl:variable name="name">
                <xsl:value-of select="../../@name"/>
              </xsl:variable>
              <xsl:variable name="name1">
                <xsl:value-of select="../@name"/>
              </xsl:variable>
              <xsl:variable name="name2">
                <xsl:value-of select="@name"/>
              </xsl:variable>
              <xsl:element name="a">
                <xsl:attribute name="href">
                  <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Outdoor Gear',$name,$name1,$name2)"/>
                </xsl:attribute>
                <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
              </xsl:element>
            </span>
          </xsl:if>
        </xsl:for-each>
      </xsl:for-each>
    </span>
  </xsl:template>

  <xsl:template match="//Menu/MainMenu[@name='Clothing / Footwear']">
    <span class="main">
      <h2>
        <xsl:variable name="name">
          <xsl:value-of select="SubMenu[@name='Mountain Running']/@name"/>
        </xsl:variable>
        <xsl:element name="a">
          <xsl:attribute name="href">
            <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Clothing / Footwear',$name,'','')"/>
          </xsl:attribute>
          <xsl:value-of select="SubMenu[@name='Mountain Running']/@displayname" disable-output-escaping="yes"/>
        </xsl:element>
      </h2>
      <xsl:for-each select="SubMenu[@name='Mountain Running']/SubSubMenu">
        <xsl:if test="@isdisplay=1">
          <span class="inner">
            <xsl:variable name="name">
              <xsl:value-of select="../@name"/>
            </xsl:variable>
            <xsl:variable name="name1">
              <xsl:value-of select="@name"/>
            </xsl:variable>
            <xsl:element name="a">
              <xsl:attribute name="href">
                <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Clothing / Footwear',$name,$name1,'')"/>
              </xsl:attribute>
              <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
            </xsl:element>
          </span>
        </xsl:if>
        <xsl:for-each select="ChildMenu">
          <xsl:if test="@isdisplay=1">
            <span class="inner">
              <xsl:variable name="name">
                <xsl:value-of select="../../@name"/>
              </xsl:variable>
              <xsl:variable name="name1">
                <xsl:value-of select="../@name"/>
              </xsl:variable>
              <xsl:variable name="name2">
                <xsl:value-of select="@name"/>
              </xsl:variable>
              <xsl:element name="a">
                <xsl:attribute name="href">
                  <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Clothing / Footwear',$name,$name1,$name2)"/>
                </xsl:attribute>
                <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
              </xsl:element>
            </span>
          </xsl:if>
        </xsl:for-each>
      </xsl:for-each>
    </span>
  </xsl:template>

  <xsl:template match="//Menu/MainMenu[@name='Electronics']">
    <table width="100%" border="0" cellspacing="2" cellpadding="2">
      <tr>
        <td height="5"></td>
      </tr>
      <xsl:for-each select="SubMenu">
        <tr>
          <td class="">
            <xsl:variable name="name">
              <xsl:value-of select="@name"/>
            </xsl:variable>
            <xsl:element name="a">
              <xsl:attribute name="href">
                <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Electronics',$name,'','')"/>
              </xsl:attribute>
              <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
            </xsl:element>
          </td>
        </tr>
      </xsl:for-each>
    </table>
  </xsl:template>

  <xsl:template match="//Menu/MainMenu[@name='Gifts']">
    <table width="100%" border="0" cellspacing="2" cellpadding="2">
      <tr>
        <td height="5"></td>
      </tr>
      <xsl:for-each select="SubMenu">
        <tr>
          <td class="">
            <xsl:variable name="name">
              <xsl:value-of select="@name"/>
            </xsl:variable>
            <xsl:element name="a">
              <xsl:attribute name="href">
                <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Gifts',$name,'','')"/>
              </xsl:attribute>
              <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
            </xsl:element>
          </td>
        </tr>
      </xsl:for-each>
    </table>
  </xsl:template>

  <xsl:template match="//Menu/MainMenu[@name='Petzl']">
    <table width="100%" border="0" cellspacing="2" cellpadding="2">
      <tr>
        <td height="5"></td>
      </tr>
      <xsl:for-each select="SubMenu">
        <tr>
          <td class="">
            <xsl:variable name="name">
              <xsl:value-of select="@name"/>
            </xsl:variable>
            <xsl:element name="a">
              <xsl:attribute name="href">
                <xsl:value-of select="php:function('ClsXSLTFunction::makeFriendlyURL','Category.php','Petzl',$name,'','')"/>
              </xsl:attribute>
              <xsl:value-of select="@displayname" disable-output-escaping="yes"/>
            </xsl:element>
          </td>
        </tr>
      </xsl:for-each>
    </table>
  </xsl:template>
</xsl:stylesheet> 
```

如果您遇到任何问题，请告诉我。

# actionscript-3 - 使用 Actionscript 3 突出显示 TextField 中的文本

> ID：12099336
> 
> 赞同：1
> 
> 时间：2012-08-23T20:19:09.790
> 
> 标签：actionscript-3, flash, actionscript

我试图弄清楚如何创建一个函数来“突出显示”给定字符串的子字符串。理想情况下，该函数将采用 3 个参数：Haystack String、Search/Needle String 和 New Format。

这是我到目前为止所拥有的：

```
/* 
 * Replaces all occurances of one series of characters with another series of characters in correct TextFormat
 *
 * @param The haystack: TextField you are invoking the replace on.
 * @param The needle: Series of characters which you plan on replacing
 * @param The new format of the sub-string.
 * @return null
 * 
 * @usage <pre>StringUtility.highlight("Hello World", "World", "Michael");</pre>
 */ 
public static function highlight( block:TextField, search:String, appliedFormat:TextFormat ) {
    var original:String = block.text;
    var positions:Object = StringUtility.getPostitions( original, search );
    block.setTextFormat( value.appliedFormat, positions.posStart, positions.posEnd );
}

/* 
 * Replaces all occurances of one series of characters with another series of characters
 *
 * @param The haystack: string you are invoking the getPostitions on.
 * @param The needle: series of characters which you plan on measuring
 * @return The object with position values
 * 
 * @usage <pre>StringUtility.getPostitions("Hello World", "World", "Michael");</pre>
 */
public static function getPostitions(original:String, search:String) : String {
    var return_string  : String = "";
    var start_position : Number = 0;
    var end_position   : Number = 0;

    while (true) {
        start_position = original.indexOf( search, end_position );

        if ( -1 == start_position ) break;

        return_string += original.substring( end_position, start_position );
        return_string += search;

        end_position = start_position + search.length;
    }

    return var positions:Object = {posStart:start_position, posEnd:end_position};
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:32:17.550

有趣的是，我正要深入研究这个，因为我需要它来做一个即将到来的项目。感谢分享。我对它进行了一些修改，所以它可以拾取所有出现的情况。

StringUtils.as

```
package  {

    import flash.text.*;

    public class StringUtils {

        public function StringUtils() {}

        public static function highlight(block:TextField, search:String, appliedFormat:TextFormat) {

            var positions:Array = getPositions(block.text, search);
            var len:uint = positions.length;

            for(var i:int = 0; i<len; i++){
                block.setTextFormat(appliedFormat, positions[i].posStart, positions[i].posEnd);
            }
        }

        public static function getPositions(original:String, search:String):Array {

            var positions:Array = [];
            var startPosition:Number;
            var endPosition:Number;

            while (startPosition != -1) {
                startPosition = original.indexOf(search, endPosition);
                endPosition = startPosition + search.length;
                if(startPosition > -1) positions.push({posStart:startPosition, posEnd:endPosition});
            }

            return positions;
        }
    }
} 
```

StringUtils.fla 有一个名为 'txt' 的文本字段和文本 'Yo check out dude，checkcheck!!' 在它的舞台上

```
import StringUtils;
import flash.text.TextFormat;

var tf:TextFormat = new TextFormat();
tf.color = 0xFF0000;

StringUtils.highlight(txt, "check", tf); 
```

# css - 前页脚固定在位于页脚的底部

> ID：12099343
> 
> 赞同：0
> 
> 时间：2012-08-23T20:19:27.703
> 
> 标签：css, css-position

我有2页脚。一个普通的灰色页脚和一个固定在窗口底部的蓝色页脚。

我希望当用户向下滚动时，蓝色页脚位于灰色页脚的顶部，而不是留在窗口底部。

这是我得到的一个例子：

[http://jsfiddle.net/fV3Tz/](http://jsfiddle.net/fV3Tz/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:39:21.107

我认为您将不得不求助于js来实现这一目标。我很想知道是否有一个纯 CSS 解决方案，但我对此表示怀疑。我用一个小的 js 示例更新了你的小提琴：http: [//jsfiddle.net/fV3Tz/1/](http://jsfiddle.net/fV3Tz/1/)

正如你所看到的，我所做的只是添加了几行 jQuery：

```
$(window).scroll(function() {  // when scrolled
    footTop = $('#footer').offset().top;  // check top off footer
    windowBottom = $(this).scrollTop() + $(this).height()  // check bottom of viewport
    if (footTop <= windowBottom) { // if top of footer in view
       $("#footer-azul").css('bottom', windowBottom - footTop); // move the azul up with the amount of footer that is in view
    } else {  // if top of footer not in view
          $("#footer-azul").css('bottom', 0);    // move the azul all the way down        
    }             
});​ 
```

# glassfish - 您可以在 glassfish 容器中运行 netty 服务器（或使用 netty 客户端）吗？

> ID：12099345
> 
> 赞同：0
> 
> 时间：2012-08-23T20:19:29.243
> 
> 标签：glassfish, netty, akka

看起来[这个netty doc文章](http://docs.jboss.org/netty/3.2/api/org/jboss/netty/channel/socket/http/package-summary.html)有一个关于如何做到这一点的建议......但是有人可以指出一些实现它的代码吗？顺便说一句，我的最终目标是支持能够在基于 glassfish 3.1.x 的应用程序中使用 Akka 2.x 远程处理。

使用 glassfish 3.1.x 中的 netty 客户端也有同样的问题。希望有例子人们可以指出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T11:28:53.577

[Akka](http://akka.io/) （我使用的是 2.0.3）框架正是这样做的！所以有一个存在证明可以做到。

在 Akka 的案例中，他们做得很好，使得使用 netty 的功能变得很容易，并在其之上提供了一个很棒的 protobuf 序列化方案和 actor（适用于 Java 和 Scala）。

# salesforce - SalesForce - 包装按钮覆盖

> ID：12099347
> 
> 赞同：2
> 
> 时间：2012-08-23T20:19:36.593
> 
> 标签：salesforce, apex-code, visualforce, force.com

根据这个（封闭的）讨论：

[http://success.salesforce.com/ideaView?id=08730000000BrpJ](http://success.salesforce.com/ideaView?id=08730000000BrpJ)

SalesForce 的 Spring '10 Release 应该允许打包标准按钮覆盖。

就我而言，它是我正在覆盖的“新”机会按钮，它加载了一个自定义的“机会”视觉力量页面。在我的开发环境中，一切都完全按照我想要的方式工作。

但是，我的销售团队“专家”告诉我，尽管 Spring '10 发行说明说了什么，但当组织安装我们的应用程序时，不能打包和自动安装标准按钮覆盖。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T07:12:35.167

来自 Spring 10 发行说明 -[可打包的标准操作覆盖](http://na2.salesforce.com/help/doc/en/salesforce_spring10_release_notes.pdf#rn_164_platform_minors__SAOPackage)

> 按钮和链接上的标准操作覆盖现在可以为自定义对象打包。开发人员还可以使用元数据 API 创建操作覆盖。通过这种方式，可以在您的应用程序中包含自定义 UI。**订阅者可以在已安装的包中接受这些覆盖、创建自己的包或恢复到标准的 Salesforce.com 行为。**

但是，在[“覆盖标准按钮的考虑”中](http://login.salesforce.com/help/doc/en/links_override_considerations.htm)它说：

> 您不能将按钮覆盖添加到 Force.com AppExchange 包。

此外，在将组件添加到受管软件包时，没有组件类型可让您选择标准按钮覆盖。

您可以将自定义 Visualforce 页面添加到包中，但需要手动将其配置为目标组织中的覆盖。

# c# - 如何在列表框上为不同颜色的列表框设置标准渐变？

> ID：12099349
> 
> 赞同：0
> 
> 时间：2012-08-23T20:19:45.300
> 
> 标签：c#, wpf, listbox, gradient, listboxitem

我有一个包含不同颜色列表框项目的列表框，每个列表框都包含文本。我想在它们中的每一个上应用从上到下从浅到深的标准渐变图案。

通过将样式应用于包含 GradientStops 的列表框，我可以在 C# 中使用特定颜色来执行此操作。但是我不希望将单个颜色渐变应用于整个列表框。我正在寻找类似于“开始比声明的颜色轻 X% 并最终以声明的颜色结束”的东西。

我还考虑过使用自己的颜色渐变单独设置每个列表框项的样式，但无法找到一种方法来做到这一点。

列表框是在 xaml 中定义的，因此解决方案可以是 xaml 或 C#。有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:56:19.487

这是你想要的？

```
<ListBox.ItemTemplate>
            <DataTemplate>
                    <Border Margin="5,5,7,7" Background="WhiteSmoke" 
                            BorderBrush="#FF444444" BorderThickness="1" Padding="5">
                    <TextBlock Text="{Binding}" Width="150">
                      <TextBlock.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                          <GradientStop Color="Yellow" Offset="0.0" />
                          <GradientStop Color="Red" Offset="0.25" />
                          <GradientStop Color="Blue" Offset="0.75" />
                          <GradientStop Color="LimeGreen" Offset="1.0" />
                        </LinearGradientBrush>
                      </TextBlock.Background>
                    </TextBlock>
                </Border>
            </DataTemplate> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:22:49.633

我记得我做过这样的事情...

1.  拥有明亮的背景。
2.  将基色绑定到两个站点。
3.  通过[转换器](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)更改 Alpha 通道来降低第一站的不透明度。

要将这种样式应用于每个单独的项目，请使用[`ItemContainerStyle`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemcontainerstyle.aspx).

# jquery - InfoWindows 不是唯一的，google maps API v3，jquery mobile

> ID：12099351
> 
> 赞同：0
> 
> 时间：2012-08-23T20:19:51.337
> 
> 标签：jquery, jquery-mobile, google-maps-api-3, infowindow, jquery-ui-map

我有一个简单的程序，我希望在其中发生以下情况：

1.  单击“Add Some Markers to Map”，将显示 4 个标记，其中包含`cityList`数组中指定的位置。
2.  单击一个标记，它将打开 infoWindow 并显示`cityList`数组中的相应索引。因此，如果您单击与 对应的标记`cityList[0]`，它将在 infoWindow 中显示“0”。

我可以添加标记并添加 infoWindows，但 infoWindows 中的内容不正确。首先，它们都是相同的，其次它们`i`在循环结束时显示迭代器的值。

我的问题是

1.  我怎样才能解决这个问题？
2.  我尝试使用地图的全局变量来实现相同的代码，但它不起作用。为什么不？例如，如果我替换

```
function initialize()
{
    $('#map_canvas').gmap({ 'center': city0, 'zoom': 7, 'disableDefaultUI':false });
} 
```

和

```
var map;
function initialize()
{
    map = new google.maps.Map(document.getElementById("map_canvas"), {'center': city0, 'zoom': 7, 'disableDefaultUI':false } );
} 
```

那么当我加载页面时，地图甚至都不会出现。

这是我的代码：

```
<!doctype html>
<html lang="en">
<head>
    <title>jQuery mobile with Google maps - Google maps jQuery plugin</title>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3&sensor=false&language=en"> </script>
    <script type="text/javascript" src="http://jquery-ui-map.googlecode.com/svn/trunk/ui/min/jquery.ui.map.min.js"></script>
    <script type="text/javascript">

    var city0 = new google.maps.LatLng(41.850033,-87.6500523);
    var city1 = new google.maps.LatLng(41,-87);
    var city2 = new google.maps.LatLng(41.5,-87.5);
    var city3 =  new google.maps.LatLng(41.4,-87.2);
    var cityList = [city0, city1, city2, city3];

    function initialize()
    {
        $('#map_canvas').gmap({ 'center': city0, 'zoom': 7, 'disableDefaultUI':false });
    }

    $(document).ready(function()
    {
        initialize();
        $('.add-markers').click(function() {
            for(var i=0; i<cityList.length; i++){
                $('#map_canvas').gmap('addMarker', { 'position': cityList[i] } ).click(function() {
                    $('#map_canvas').gmap('openInfoWindow', {'content': i.toString()}, this);
                });
            }
        });
    });
    </script>
</head>
<body>
    <div id="basic-map" data-role="page">
        <div data-role="header">
            <h1><a data-ajax="false" href="/">jQuery mobile with Google maps v3</a> examples</h1>
            <a data-rel="back">Back</a>
        </div>
        <div data-role="content">
            <div class="ui-bar-c ui-corner-all ui-shadow" style="padding:1em;">
                <div id="map_canvas" style="height:350px;"></div>
            </div>
            <a href="#" class="add-markers" data-role="button" data-theme="b">Add Some More Markers</a>
        </div>
    </div>
    <div id="info-page" data-role="page">
        <div data-role="header">
            <h1><a data-ajax="false" href="/">more info v3</a> examples</h1>
            <a data-rel="back">Back</a>
        </div>
        <div data-role="content">
            <div class="ui-bar-c ui-corner-all ui-shadow" style="padding:1em;">
                <div id="info_page" style="height:350px;"></div>
            </div>
            <div id="moreInfo"></div>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T22:19:54.463

我明白你的意思了。您在使用 jquery-ui-maps 插件创建具有唯一 infoWindows 的标记列表时遇到的问题是正确的。

为了克服这些问题，我在每个 $marker 定义中创建了一个唯一的 id (id: i)，并且该 id 等于名为 i 的 for 循环索引。在单击事件中，我从标记的 id 中知道正确的索引，并且我正在使用它来检索正确的 cityList 值。

```
<!doctype html>
<html lang="en">
   <head>
        <title>jQuery mobile with Google maps - Google maps jQuery plugin</title>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3&sensor=false&language=en"> </script>
        <script type="text/javascript" src="http://jquery-ui-map.googlecode.com/svn/trunk/ui/min/jquery.ui.map.min.js"></script>
        <script type="text/javascript">

            var chicago = new google.maps.LatLng(41.850033,-87.6500523),
                mobileDemo = { 'center': '41,-87', 'zoom': 7 },
                cityList = [
                    ['Chicago', 41.850033, -87.6500523, 1],
                    ['Illinois', 40.797177,-89.406738, 2]
                ];

            function initialize()
            {
                $('#map_canvas').gmap({ 'center': mobileDemo.center, 'zoom': mobileDemo.zoom, 'disableDefaultUI':false });
            }

            function addMarkers()
            {
                for (var i = 0; i < cityList.length; i++) 
                {
                    var $marker = $('#map_canvas').gmap('addMarker', {id: i, 'position': new google.maps.LatLng(cityList[i][1], cityList[i][2]), title: cityList[i][0]});
                    $marker.click(function() {
                        $('#map_canvas').gmap('openInfoWindow', {'content': cityList[this.id][0]}, this);
                    });
                }
            }

            $(document).on("pageinit", "#basic-map", function() {
                initialize();
            });

            $(document).on('click', '.add-markers', function(e) {
                e.preventDefault();
                addMarkers();
            });

        </script>
    </head>
    <body>
        <div id="basic-map" data-role="page">
            <div data-role="header">
                <h1><a data-ajax="false" href="/">jQuery mobile with Google maps v3</a> examples</h1>
                <a data-rel="back">Back</a>
            </div>
            <div data-role="content">   
                <div class="ui-bar-c ui-corner-all ui-shadow" style="padding:1em;">
                    <div id="map_canvas" style="height:350px;"></div>
                </div>
                <a href="#" class="add-markers" data-role="button" data-theme="b">Add Some More Markers</a>
            </div>
        </div>      
    </body>
</html> 
```

# mysql - Datamapper 是否支持“On Duplicate Key Update”或其他用于 upserts 的技术？

> ID：12099356
> 
> 赞同：1
> 
> 时间：2012-08-23T20:20:06.933
> 
> 标签：mysql, ruby, datamapper

我正在使用 Ruby 和 Datamapper 将大量记录加载到 MySQL 数据库中。这些记录主要是插入，但有相当数量的更新。我基本上想“更新”数据库中这些记录的所有列。我能找到的唯一选择是：

1) 查询记录。如果存在，请更新它。如果没有，请创建一个记录。（总是一个额外的查询） 2）尝试创建一个新记录。捕获重复的键错误。查询现有记录。更新这些记录。（当有更新时，2 个额外的查询）

我想使用 MySQL `On Duplicate Key Update`，因为它看起来效率更高。有没有办法在 Datamapper 中做到这一点？还有其他建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:14:46.900

您应该可以使用`first_or_create`它。从[文档](http://datamapper.org/docs/create_and_destroy.html)：

```
zoo = Zoo.first_or_create(:name => 'The Glue Factory') 
```

我没有通过`On Duplicate Key Update`在[`do/do_mysql`](https://github.com/datamapper/do/tree/master/do_mysql)or[`dm-mysql-adapter`](https://github.com/datamapper/dm-mysql-adapter)源中 grepping 得到任何匹配，所以它可能不支持它。如果效率对于需要此功能非常重要，您可能需要求助于普通 SQL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:37:58.520

这不是开箱即用的受支持功能，但如果您正在执行批量插入，请在事务中执行，即使使用额外的查询也会更有效。并使用`first_or_new`这样您就不会对新记录进行多次插入。

```
DataMapper.respository.transaction.commit do
  Zoo.raise_on_save_failure = true
  bunch_of_updates.each do |key, new_attributes|
    zoo = Zoo.first_or_new(the_key: key)
    zoo.attributes = new_attributes
    zoo.save
  end
end 
```

# perl - perl 的数据库句柄始终未定义

> ID：12099359
> 
> 赞同：1
> 
> 时间：2012-08-23T20:20:20.307
> 
> 标签：perl, cgi, dbi

我在使用 perl 获得简单的 DBI 连接时遇到问题。

我放置了一个位置检查器来查看数据库句柄是否未定义并且它总是未定义。有没有明显的错误？我确信我输入的信息是正确的，因为我在 php 脚本中使用它。

```
#!/usr/bin/perl -w
use warnings;
print "Content-Type: text/html\n\n";

use DBI;

# Connecting to the database
# Replace DATABASENAME with the name of the database,
# HOSTNAME with the hostname/ip address of the MySQL server.
$drh = DBI->install_driver("mysql");
$dsn =   "DBI:mysql:database=db_name;host=host_name";
$dbh = DBI->connect($dsn,"username","password");
if(defined $dbh)
{
    print "Yes<br />";
}
else
{
    print "No<br />";
 }

 # Select the data and display to the browser

   $sth = $dbh->prepare("SELECT * FROM customer");
   $sth->execute();
   while (my $ref = $sth->fetchrow_hashref()) {
   print "Found a row: id = $ref->{'cid'}";
}

$sth->finish();

# Disconnect from the database.

$dbh->disconnect(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T20:23:54.397

`connect`如果返回 undef，则会发生错误。在那里抛出一些错误处理。它可能会给你一些有用的信息。

```
$dbh = DBI->connect($dsn, $user, $pw)
   or die "Unable to connect: $DBI::errstr\n"; 
```

# javascript - 简单的身体加载功能不会触发我的功能

> ID：12099370
> 
> 赞同：1
> 
> 时间：2012-08-23T20:21:32.490
> 
> 标签：javascript, css

我有这个javascript函数可以用body onload函数触发，但我无法让它工作。我在这里做错了什么？这是我的[小提琴](http://jsfiddle.net/3pDsJ/26/)和下面的代码：

HTML：

```
<body onload="loading()">
    <div id="container">
    </div>
</body> 
```

JS：

```
function loading(){   
  document.getElementById('container').css("background-image", "none");
} 
```

也试过

```
function loading(){   
  document.getElementById('container').cssText = "background-image: none";
} 
```

CSS：

```
body{
  background: #000;
}
#container {
width: 600px;
height: 500px;
margin:0 auto;
background-image: url("http://lamininbeauty.co.za/images/gallery/loading.png");
background-repeat: no-repeat;
background-position: 50% 50%;
}​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:26:05.573

尝试：

```
function loading(){   
  document.getElementById('container').style.backgroundImage= "none";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T20:26:34.833

`css`你混淆了原生 javascript 和 jQuery，原生 DOM 元素上没有方法：

```
function loading(){   
  document.getElementById('container').style.backgroundImage = "none";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T20:25:13.530

```
function loading(){   
  document.getElementById('container').style.backgroundImage = "none";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T20:27:24.490

确保您的 js 已加载到页面的部分中。

或者，您只能添加

```
$(function() {
$('#container').css("background-image", "none");
} 
```

在您的 js 中并从正文中删除 onload

我假设您使用的是 jquery，否则上面的解决方案就是要走的路

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T20:28:48.143

`getElementById`返回一个没有方法的 html 元素`.css()`。它的 jQuery 有那个方法，你也有你的函数 onload 所以它包装在一个函数中，你希望它没有包装头。

[http://jsfiddle.net/3pDsJ/35/](http://jsfiddle.net/3pDsJ/35/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-23T20:31:21.010

问题是 jsfiddle 设置为运行您定义的 javascript `onLoad`，所以我怀疑正在发生的事情是它在定义方法`onload=`之前遇到了您的属性`loading()`。如果你打开一个控制台，你会看到一个错误“Uncaught ReferenceError: loading is not defined”（或类似的东西）。

您可以将其更改为“无包装（头部）”，它应该可以正常工作。尽管如上所述，您需要将`css`方法更改为实际有效的方法。

我想说一个更简单的解决方案是只使用 jquery。使用元素的 onload 处理程序不再被认为是好的做法（我认为它们现在实际上已被弃用？）。最好的解决方案是一种称为“unobtrusive javascript”的解决方案，您执行的任何 js 都不需要从您的 html 代码中调用额外的 javascript 或方法。我已经修改了小提琴来举个例子：

[http://jsfiddle.net/3pDsJ/38/](http://jsfiddle.net/3pDsJ/38/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-23T20:32:48.863

我还没有看到的答案是您的脚本标签必须在您的正文标签内。这是因为脚本标签必须在正文加载之前加载，否则您将收到一条错误消息，指出未定义加载函数。

```
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="YourCSS.css" />
</head>
<body onload="loading()">
    <div id="container">
    </div>
    <script type="text/javascript">
        function loading(){   
            $("#container").attr("style", "background-image: none;");
        };
    </script>
</body>
</html> 
```

# opencv - cvQueryFrame 令人着迷

> ID：12099374
> 
> 赞同：3
> 
> 时间：2012-08-23T20:21:46.637
> 
> 标签：opencv

我有个问题。cvQueryFrame 到底是做什么的？据我了解，它从缓冲区中的“已经捕获的帧”中选择一个帧，对吗？

在我的应用程序中，每帧的处理需要 1 秒，但我的相机的 fps 是 30fps。如何在 1 秒结束后/当前帧的相关进程的处理结束时拍摄下一个快照？我不想要旧框架！

现在，正如我在第二次循环运行中看到的那样（当我再次调用 cvQueryFrame 时，它​​会从缓冲区检索近 1 秒前捕获的​​帧。

我怎样才能实时完成所有事情？非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T21:10:27.657

它基本上会按顺序给你帧，所以无论处理多长时间，它都不会丢帧。请记住，API 也用于从视频中读取，在这种情况下它是有意义的。

您可以连续调用 cvQueryFrame 并在单独的线程上进行处理。或者，您可以使用系统 API（例如 DirectShow）或相机的 API 进行读取，这通常会使丢帧变得更容易。

# heroku - 硬盘配额——Cedar Stack (Heroku)

> ID：12099378
> 
> 赞同：16
> 
> 时间：2012-08-23T20:22:20.700
> 
> 标签：heroku, cedar

我知道允许的最大 slug 大小是 200 MB。但是每个实例可以使用的最大磁盘空间是多少？假设我在节点进程运行时下载了几个文件。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-06-05T11:38:19.360

```
heroku run bash
~ $ df -h /tmp
Filesystem            Size  Used Avail Use% Mounted on
-                     620G  6.1G  583G   2% /tmp 
```

/tmp 文件夹中有大约 620Gb。
任何其他文件夹都无关紧要，因为它们无论如何都是只读的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-11T17:00:50.797

当我刚才在我`df`的一个实例（Cedar 14）上运行时，我总共得到 304G，240G 可用。仍然很多，但比上面的响应者少。仅供参考，以检查您的特定实例。

`~ $ df -h /tmp Filesystem Size Used Avail Use% Mounted on /dev/mapper/evg0-evol0 304G 49G 240G 17% /tmp`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-21T23:03:02.057

我认为整个服务器的总大小是 620GB。你可以运行 df -k 。在免费帐户中，我得到了 394267100 字节.. 400mb

> /tmp 文件夹中有大约 620Gb。任何其他文件夹都无关紧要，因为它们无论如何都是只读的。

# c# - 这种对泛型的滥用如何不模棱两可/在编译器中触发错误

> ID：12099380
> 
> 赞同：4
> 
> 时间：2012-08-23T20:22:28.377
> 
> 标签：c#, .net, generics, compiler-errors, specifications

我一直在 C# 编译器中摸索它的“继承的实例化泛型类”的限制。

无论如何，这是我的测试用例：

```
class Program
{
    static void Main(string[] args)
    {
        var x = new InClass();
        Console.WriteLine(x.Test(10)); //prints foo
        Console.ReadLine();
    }
}
class BaseClass<Foo, Bar>
{
    public virtual Foo Test(Bar b)
    {
        return default(Foo);
    }
    public virtual string Test(int b)
    {
        return "foo"; ;
    }
}
class InClass : BaseClass<string, int>
{
    /*public override string Test(int b)
    {
        return "bar";
    }*/
} 
```

我认为 InClass 的这个声明会引发编译器错误，因为它会产生`Test`歧义。这也使得非泛型`Test`无法在`InClass`. 请注意，我也注释掉了一些代码`InClass`。如果我取消注释该代码，我会收到编译器错误。

在 C# 规范中是否完全提到了这种行为，或者这是闻所未闻的边缘情况？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T20:29:20.513

> 我认为 InClass 的这个声明会引发编译器错误，因为它会使 Test 模棱两可。

没有。规范在第 7.5.3.6 节中明确指出了这种事情：

> 虽然声明的签名必须是唯一的，但类型参数的替换可能会导致相同的签名。在这种情况下，上述重载决议的平局规则将选择最具体的成员。
> 
> 以下示例显示根据此规则有效和无效的重载。

（显然，示例如下。）

所以语言设计者已经考虑过了，但可能替代方案会更糟。（例如，`InClass`即使您不想调用`Test`，也无法创建类会很烦人。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:29:25.960

请参阅此相关问题：

[为什么泛型类型约束不可继承/分层强制执行](https://stackoverflow.com/questions/8606390/why-arent-generic-type-constraints-inheritable-hierarchically-enforced)

Eric Lippert 对潜在影响进行了彻底的探索。

编译器不会强制执行继承的泛型类型，因为他们的开发团队认为这是一个不值得去的兔子洞。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T20:30:41.907

我的猜测是带有签名的方法比在这种特殊情况下碰巧具有泛型类型的方法`(int x)`更适合参数。`int``Bar``int`

# android - 加载图像时 ListView 非常慢（使用通用图像加载器）

> ID：12099383
> 
> 赞同：3
> 
> 时间：2012-08-23T20:22:40.497
> 
> 标签：android, performance, listview, image-loading

我的 listView 仅使用文本运行非常流畅 - 但是一旦我尝试加载缩略图（即使从缓存中），它的运行速度就会非常不稳定。

我正在使用[通用图像加载器脚本](https://github.com/nostra13/Android-Universal-Image-Loader)

我的 ArticleEntryAdapter`public View getView(...)`方法中的代码：

```
/**
     * PHOTOS
     */
    ImageLoaderConfiguration config = new ImageLoaderConfiguration.Builder(this.mContext)
        .enableLogging()
        .memoryCacheSize(41943040)
        .discCacheSize(104857600)
        .threadPoolSize(10)
        .build();

    DisplayImageOptions imgDisplayOptions = new DisplayImageOptions.Builder()
        //.showStubImage(R.drawable.stub_image)
        .cacheInMemory() 
        .cacheOnDisc() 
        //.imageScaleType(ImageScaleType.EXACT) 
        .build();

    ImageLoader imageLoader = ImageLoader.getInstance();
    imageLoader.init(config);

    //loads image (or hides image area)
    imageLoader.displayImage("", viewHolder.thumbView); //clears previous one
    if(article.photopath != null && article.photopath.length() != 0)
    {
        imageLoader.displayImage(
            "http://img.mysite.com/processes/resize_android.php?image=" + article.photopath + "&size=150&quality=80",
            viewHolder.thumbView,
            imgDisplayOptions
            );
        viewHolder.thumbView.setVisibility(View.VISIBLE);
    }
    else
    {
        viewHolder.thumbView.setVisibility(View.GONE); //hide image
        viewHolder.thumbView.invalidate(); //should call after changing to GONE
    } 
```

Logcat 显示它正在从缓存中加载图像（我认为）：

```
ImageLoader    Load image from memory cache [http://img.mysite.com/processes/... 
```

我正在我的三星 Galaxy Nexus 上测试它并运行 Android 4.0.4（虽然我的 minSdkVersion="8"）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T20:27:44.870

将**ImageLoaderConfiguration config、DisplayImageOptions imgDisplayOptions、ImageLoader imageLoader**的实例化作为适配器类的私有字段/成员放在 getView 方法之外。您应该只创建一次这些东西，而不是每次调用 getView。

编辑：没有看到你的整个适配器类，这里是我在说什么。我希望它接近你所拥有的，并且你可以解决它。无论哪种方式，我都知道。

```
public class MyAdapterClass extends BaseAdapter {
    /**
     * PHOTOS
     */
    static ImageLoaderConfiguration config = new ImageLoaderConfiguration.Builder(this.mContext)
        .enableLogging()
        .memoryCacheSize(41943040)
        .discCacheSize(104857600)
        .threadPoolSize(10)
        .build();

    static DisplayImageOptions imgDisplayOptions = new DisplayImageOptions.Builder()
        //.showStubImage(R.drawable.stub_image)
        .cacheInMemory() 
        .cacheOnDisc() 
        //.imageScaleType(ImageScaleType.EXACT) 
        .build();

    static ImageLoader imageLoader = ImageLoader.getInstance();
    /**
     * 
     */
    public MyAdapterClass() {
        // TODO Auto-generated constructor stub
        imageLoader.init(config);           
    }

    /* (non-Javadoc)
     * @see android.widget.Adapter#getCount()
     */
    public int getCount() {
        // TODO Auto-generated method stub
        return 0;
    }

    /* (non-Javadoc)
     * @see android.widget.Adapter#getItem(int)
     */
    public Object getItem(int position) {
        // TODO Auto-generated method stub
        return null;
    }

    /* (non-Javadoc)
     * @see android.widget.Adapter#getItemId(int)
     */
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return 0;
    }

    /* (non-Javadoc)
     * @see android.widget.Adapter#getView(int, android.view.View, android.view.ViewGroup)
     */
    public View getView(int position, View convertView, ViewGroup parent) {
        //loads image (or hides image area)
        imageLoader.displayImage("", viewHolder.thumbView); //clears previous one
        if(article.photopath != null && article.photopath.length() != 0)
        {
            imageLoader.displayImage(
                "http://img.mysite.com/processes/resize_android.php?image=" + article.photopath + "&size=150&quality=80",
                viewHolder.thumbView,
                imgDisplayOptions
                );
            viewHolder.thumbView.setVisibility(View.VISIBLE);
        }
        else
        {
            viewHolder.thumbView.setVisibility(View.GONE); //hide image
            viewHolder.thumbView.invalidate(); //should call after changing to GONE
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-11T17:47:03.847

我可能错了，但是当我遇到这个问题时，我观察到使用较小尺寸的图像极大地提高了速度。早些时候我使用超过 150KB 的图像，我将它们切换到每张 10 个左右，效果非常好。只是添加到上述思路，可能会在以后的优化中派上用场。

# blackberry - 黑莓 OS5 phonegap 应用程序的 Ajax 调用失败

> ID：12099391
> 
> 赞同：4
> 
> 时间：2012-08-23T20:23:18.140
> 
> 标签：blackberry, jquery-mobile, blackberry-os5

为什么这个 ajax 调用在我的 BB OS5 上不起作用而在 BB OS6+ 上不起作用

```
 $("#HomePg").on('pageinit', function(event) {
   $.ajax({
        dataType:'json',
            url: serviceURL+'linka',
            error: function(xhr, status, error) {
                  alert("Cannot Connect to the Specified URL : "+status);
             },
       success: function(json) {
                $.each(json, function(i, object) {
            var cr = "<li id='menuList'><a id="+object.id+"  
                   data-transition='slide' class='menuClass' ><img src=css/images
                   /"+object.id+".png /> <h3> "+object.menuname+" </h3></a></li>";
               $("#mainMenu").append(cr);
               $("ul").listview("refresh");
               mainloaded = true;

        });

       },
      timeout:60000,
      retryMax: 10
  });

 }); 
```

....config.xml

```
<access subdomains="true" uri="*"/>

<rim:connection timeout="60000">
<id>TCP_WIFI</id>
<id>TCP_CELLULAR</id>
<id>BIS-B</id>   
<id>MDS</id>
<id>WAP2</id>
<id>WAP</id>
</rim:connection> 
```

…………

我 在 BB 上使用这个`jqm 1.1.1`版本`jquery 1.7.2``OS6+`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T07:04:33.510

排序：

看起来 BB OS5 有问题`jQuery-Ajax`.. 对于尝试相同的人，请尝试使用 XMLHttpRequest。

```
$("#homePg").on('pageinit', function(event) {   
var url = serviceURL+'testgroups'
http.open("GET", url, true);
http.onreadystatechange = function() {//Call a function when the state changes.
    if(http.readyState == 4 && http.status == 200) {
        //alert(http.responseText);
        var json = JSON.parse(http.responseText);
        $.each(json, function(i, object) {
            var cr = "<li id='menuList'><a id="+object.id+"  data-transition='slide' class='menuClass' ><img src=css/images/"+object.id+".png /> <h3> "+object.menuname+" </h3></a></li>";
            $("#mainMenu").append(cr);
            $("ul").listview("refresh");
            $.mobile.hidePageLoadingMsg();
            mainloaded = true;

        });
    }
}
http.send(null);

 }); 
```

# iphone - 无法使用 MPMoviePlayerViewController 播放视频

> ID：12099393
> 
> 赞同：8
> 
> 时间：2012-08-23T20:23:30.840
> 
> 标签：iphone, ios, video

我使用以下 ViewController.m 创建了一个新项目。当我运行该应用程序时，我可以看到一个预期原点/大小（38、100、250、163）的框，但它是黑色的并且没有视频播放。Xcode中有一个奇怪的输出：

```
2012-08-23 15:36:45.559 VideoTest1[11398:c07] [MPAVController] Autoplay: Disabling autoplay for pause
2012-08-23 15:36:45.560 VideoTest1[11398:c07] [MPAVController] Autoplay: Disabling autoplay
2012-08-23 15:37:18.186 VideoTest1[11398:c07] [MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 1, on player: 0) 
```

请注意，视频是使用 Videora iPhone Converter 转换的，并且在 Xcode 中可以正常播放（所以这不是视频问题）；视频的路径没问题，因为当我指定 demo-iPhone1 （不存在）时，我得到一个 nil 异常。我在模拟器和 iPhone 上试过：总是黑匣子。有任何想法吗？

```
#import "ViewController.h"
#import <MediaPlayer/MediaPlayer.h>  

@interface ViewController ()

@end

@implementation ViewController
- (void)moviePlaybackComplete:(NSNotification *)notification
{
    MPMoviePlayerController *moviePlayerController = [notification object];
    [[NSNotificationCenter defaultCenter] removeObserver:self
                                                    name:MPMoviePlayerPlaybackDidFinishNotification
                                                  object:moviePlayerController];

    [moviePlayerController.view removeFromSuperview];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    NSString *filepath   =   [[NSBundle mainBundle] pathForResource:@"demo-iPhone" ofType:@"mp4"];
    NSURL    *fileURL    =   [NSURL fileURLWithPath:filepath];
    MPMoviePlayerController *moviePlayerController = [[MPMoviePlayerController alloc] initWithContentURL:fileURL];
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(moviePlaybackComplete:)
                                                 name:MPMoviePlayerPlaybackDidFinishNotification
                                               object:moviePlayerController];
    [moviePlayerController.view setFrame:CGRectMake(38,
                                                    100,
                                                    250,
                                                    163)];
    [self.view addSubview:moviePlayerController.view];
    [moviePlayerController play];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

@end 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-01T21:55:58.777

我刚刚用这行代码解决了一个类似的问题。播放器控制器现在显示并且视频播放完美：

```
@property (nonatomic, strong) MPMoviePlayerController *moviePlayer;
//
@synthesize moviePlayer = _moviePlayer;
//
[self.moviePlayer prepareToPlay]; 
```

修改以适应您的环境。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T08:07:07.540

我通过添加解决了类似的问题`playercontroller.moviePlayer.movieSourceType = MPMovieSourceTypeFile;`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-26T09:34:46.827

你用ARC吗？如果是这样，您必须保留 MPMoviePlayerController！

将此添加到您的界面

```
@property (nonatomic, strong) MPMoviePlayerController *controller; 
```

检查最后一行 viewDidLoad

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    NSString *filepath   =   [[NSBundle mainBundle] pathForResource:@"demo-iPhone" ofType:@"mp4"];
    NSURL    *fileURL    =   [NSURL fileURLWithPath:filepath];
    MPMoviePlayerController *moviePlayerController = [[MPMoviePlayerController alloc] initWithContentURL:fileURL];
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(moviePlaybackComplete:)
                                           name:MPMoviePlayerPlaybackDidFinishNotification
                                           object:moviePlayerController];
    [moviePlayerController.view setFrame:CGRectMake(38,
                                                100,
                                                250,
                                                163)];
    [self.view addSubview:moviePlayerController.view];
    [moviePlayerController play];
    [self setController:moviePlayerController];
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-01-22T20:50:22.853

另请查看视频格式。我的示例视频`.m4v`（我从 Apple 的网站上下载的）不断收到此错误。最终，我尝试了一个不同的视频剪辑，`.mp4`并且效果很好。许多错误仍然出现在我的控制台上。

```
2013-01-22 15:44:04.850 VideoTesting[4497:c07] [MPAVController] Autoplay: Likely to keep up or full buffer: 0
2013-01-22 15:44:04.851 VideoTesting[4497:c07] [MPAVController] Autoplay: Skipping autoplay, not enough buffered to keep up.
2013-01-22 15:44:04.853 VideoTesting[4497:c07] [MPAVController] Autoplay: Disabling autoplay for pause
2013-01-22 15:44:04.853 VideoTesting[4497:c07] [MPAVController] Autoplay: Disabling autoplay
2013-01-22 15:44:04.861 VideoTesting[4497:c07] [MPAVController] Autoplay: Enabling autoplay 
```

然而，视频仍然播放。

# entity-framework - 实体框架在测试服务器上执行迁移

> ID：12099394
> 
> 赞同：1
> 
> 时间：2012-08-23T20:23:33.520
> 
> 标签：entity-framework, entity-framework-migrations

部署时需要更新测试服务器数据库，但我没有找到方法。我们没有使用自动迁移，所以我们手动进行。

我可以直接在测试服务器上执行吗？也许是一个控制台程序？

我正在使用 NuGet 调用进行本地开发：**Update-Database** 我知道我们可以生成脚本文件，我必须手动执行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T06:28:59.060

您可以使用 MigrateDatabaseToLatestVersion 数据库初始化程序通过代码或配置执行迁移。在应用程序启动时，您将在代码中执行以下操作：

```
Database.SetInitializer<MyContext>(
    new MigrateDatabaseToLatestVersion<MyContext, MyMigrationConfig>()
); 
```

或者在您应用的 .config 文件中：

```
<entityFramework>
    <contexts>
      <context type="MyContext">
        <databaseInitializer
          type="System.Data.Entity.MigrateDatabaseToLatestVersion`2[
              [MyContext], [MyMigrationConfig]
         ], EntityFramework" />
      </context>
    </contexts>
</entityFramework> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T23:41:14.157

如果您使用 Visual Studio，则可以使用发布功能来执行脚本。在这里查看更多详细信息：

[http://learn.iis.net/page.aspx/1081/building-a-web-deploy-package-from-visual-studio-2010/](http://learn.iis.net/page.aspx/1081/building-a-web-deploy-package-from-visual-studio-2010/)

如果您使用团队基金会服务器，您甚至可以将其自动化：

[http://weblogs.asp.net/jdanforth/archive/2010/04/24/package-and-publish-web-sites-with-tfs-2010-build-server.aspx](http://weblogs.asp.net/jdanforth/archive/2010/04/24/package-and-publish-web-sites-with-tfs-2010-build-server.aspx)

另外要生成脚本，也许您可​​以使用 migrate.exe （我认为在获取 nuget 包时它带有 ef 4.3）并在构建后事件中运行它......

# silverlight - Silverlight 在达到一定数量的字符后停止显示文本

> ID：12099395
> 
> 赞同：0
> 
> 时间：2012-08-23T20:23:33.813
> 
> 标签：silverlight, textbox

所以我并没有真正接触或接触过silverlight编程，但我的公司内置了这个应用程序，我有一个他们希望我修复的错误。问题是我的文本框最多可以容纳大约 778 个字符或 16 行，但是您无法再查看您所写的内容。如果您复制所有内容，即使您可能只看到其中的 3/4，也会得到您编写的所有内容。我不确定我需要做什么，如果我需要为溢出创建控制面板或设置最大长度等。我最好的步骤是什么？有什么好主意吗？

代码：

```
<TextBox HorizontalAlignment="Left" Name="txtDesc"  Width="300" Height="80" Grid.Column="1" Grid.Row="0" TextWrapping="Wrap" Text="{Binding Path=ExcursionDescription, Mode=TwoWay, Converter={StaticResource StripNonAsciilCharacters1}}" VerticalScrollBarVisibility="Auto" Margin="0,0,5,0"/> 
```

# jquery - 水平网页显示的最佳方法？

> ID：12099396
> 
> 赞同：1
> 
> 时间：2012-08-23T20:23:35.377
> 
> 标签：jquery, css, html, horizontal-scrolling, horizontalscrollview

我面前有一个新项目，我必须创建一个 7 页的水平显示。中间页面将是主页，左侧和右侧将有 3 个其他页面。这是我第一次使用水平显示器。

什么方法是最好最直接的方法？！人们对此有想法吗？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:44:03.290

也许这会让你开始：

**CSS**

```
html,
body
{
    height:100%;
}
body
{
    margin:0;
    padding:0;
    overflow:auto;
}
ul
{
    margin:0;
    padding:0;
}
ul li
{
    margin:0;
    padding:0;
    list-style-type:none;
    float:left;
}
ul li.page-1,
ul li.page-3,
ul li.page-5,
ul li.page-7
{
    background-color:#655;
}
ul li.page-2,
ul li.page-4,
ul li.page-6
{
    background-color:#855;
}
.clearfix:after
{
    clear:both;
    content:'.';
    display:block;
    font-size:0;
    height:0;
    line-height:0;
    visibility:hidden
}
.clearfix
{
    display:block;
    zoom:1
}​ 
```

**jQuery**

```
var width=$(window).width();

$('body').css('width',(width*7)+'px').scrollLeft((width*3));

$('ul li').css({'width':width+'px','height':$(document).height()+'px'}); 
```

**​HTML**

 **```
<ul class="clearfix">
    <li class="page-1">
        page 1
    </li><li class="page-2">
        page 2
    </li><li class="page-3">
        page 3
    </li><li class="page-4">
        page 4 (current)
    </li><li class="page-5">
        page 5
    </li><li class="page-6">
        page 6
    </li><li class="page-7">
        page 7
    </li>
</ul>​ 
```

**[演示](http://jsfiddle.net/vkqDm/)**

## 编辑：

为了导航到上一页/下一页添加：

**jQuery**

```
$('.prev').click(function()
{
    i=$(this).parent('li').index()-1;

    $('body').animate({scrollLeft:(width * i)});

    return false;
});

$('.next').click(function()
{
    i=$(this).parent('li').index()+1;

    $('body').animate({scrollLeft:(width * i)});

    return false;
}); 
```

**HTML**

```
<ul class="clearfix">
    <li class="page-1">
        page 1
        <a href="#" class="next">Next</a>
    </li><li class="page-2">
        page 2
        <a href="#" class="prev">Prev</a> &middot; <a href="#" class="next">Next</a>    
    </li>
    ....
    <li class="page-7">
        page 7
        <a href="#" class="prev">Prev</a>
    </li>
</ul>​ 
```

**[演示 2](http://jsfiddle.net/vkqDm/1/)****

# javascript - 是否可以从弹出窗口触发内容脚本中的行为？

> ID：12099405
> 
> 赞同：1
> 
> 时间：2012-08-23T20:24:10.480
> 
> 标签：javascript, google-chrome-extension

目前，我正在使用消息传递从我的 contentscript 发送对 localStorage 中数据的请求，我对此没有任何问题，内容脚本按预期工作。

你能在另一个方向做到这一点吗？

我有一个存在于内容脚本中的对象，它有一个名为“.apply()”的方法，我想在用户单击选项时运行它。

我试图在内容脚本中创建一个监听器，如下所示：

```
var myLinker = new Linker();
chrome.extension.onRequest.addListener(function(request) {
    if (request.method == "apply")
{
        myLinker.apply("nothing");
        alert("applied");

}
    else
      ; //Do nothing 
```

并像这样向它发送请求：

```
chrome.extension.sendRequest({method: "apply"}, function(){
    alert("Tried to request");
}); 
```

我知道这有点像黑客，但这是我唯一能想到的，而且它甚至不起作用=/

有没有办法做到这一点？

我很确定我可以从弹出窗口中将新代码注入页面（我想我看到了一个 api 函数），然后运行一些东西，但这会占用更多内存，而且感觉是一种不好的方法，因为你基本上会有两次完全相同的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T23:21:14.507

要将消息从扩展程序发送到内容脚本，请使用`chrome.tabs.sendMessage`而不是`chrome.extension.sendRequest`.

因为[`sendRequest`已经`onMessage`在 Chrome 20](https://stackoverflow.com/a/11811936)中被取代，所以没有官方文档了`sendRequest`。`chrome.tabs.sendMessage`可在[此处](http://developer.chrome.com/extensions/tabs.html#method-sendMessage)找到文档。请注意，这些事件不能混合使用，请使用`*Request` *或* `*Message`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T23:58:12.830

是的，你会使用这个：http: [//developer.chrome.com/extensions/tabs.html#method-sendMessage](http://developer.chrome.com/extensions/tabs.html#method-sendMessage)

内容脚本存在于页面的 DOM 中。在 Chrome 中打开的每个页面都有一个与之关联的标签 ID—— http: [//developer.chrome.com/extensions/tabs.html#type-tabs.Tab](http://developer.chrome.com/extensions/tabs.html#type-tabs.Tab)

假设您要将 {method: "apply"} 发送到刚刚在新标签页中打开的页面：

```
chrome.tabs.onCreated.addListener(function(tab) {
    chrome.tabs.sendMessage(tab.id, { method: "apply" });
}); 
```

还有其他事件/方法可以获取您要将消息发送到的特定选项卡。我认为有一个名为 getCurrent 的发送到当前选定的选项卡，请查看文档。

# hadoop - Hadoop分布式缓存 - 修改文件

> ID：12099412
> 
> 赞同：0
> 
> 时间：2012-08-23T20:24:45.997
> 
> 标签：hadoop, diff, distributed-caching, distributed-cache

我在分布式缓存中有一个文件。驱动程序类根据作业的输出更新此文件并启动新作业。新工作需要这些更新。

我目前这样做的方式是用新的（更新的）替换旧的分布式缓存文件。

有没有办法将差异（旧文件和新文件之间）广播到所有需要该文件的任务跟踪器？

或者是这样的情况，在一项工作（在我的情况下是第一个）完成后，所有特定于该工作的目录/文件都被删除，因此朝这个方向思考甚至没有意义？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:09:30.993

我认为分布式缓存不是在考虑这种情况的情况下构建的。它只是将文件放在本地。
在您的情况下，我建议将文件放入 HDFS 并让所有感兴趣的各方从那里获取它
作为一种优化，您可以为该文件提供高复制因子，并且它将是大多数任务的本地文件。

# java - SWT - 标题区域对话框

> ID：12099420
> 
> 赞同：3
> 
> 时间：2012-08-23T20:25:09.653
> 
> 标签：java, swt, jface

我正在尝试使用 SWT 和 JFace 创建一个基本对话框类：

```
 public class AplotBaseDialog extends TitleAreaDialog 
```

我对如何布局对话框感到困惑？

在 Swing 中做这件事我会有一个`createDialog`方法。然后在该方法中，我将添加 JPanel 方法的组件。然后将组件添加到我的 centerPanel。这是基本对话框。每个 Panel 方法都有自己的布局。

这是一个非常简单的例子（伪代码）

```
public void createDialog() {
   Component selectionsPanel = createTableArea();
   Component buttonPanel = OKCancelButtons();
   JPanel centerPanel = new JPanel();
   centerPanel.setLayout(new BoxLayout(centerPanel, BoxLayout.PAGE_AXIS));
   centerPanel.add(selectionsPanel);
   centerPanel.add(buttonPanel);
   getContentPane().add(centerPanel);
   this.pack();
   centerPanel.setVisible(true); 
}

private JPanel OKCancelButtons() {

  submitButton = new JButton("Send");
  etc... etc..
  JPanel p = new JPanel();
  p.setLayout(new BoxLayout(p, BoxLayout.LINE_AXIS));
  p.add(submitButton);
  return p;
}

private JPanel createTableArea() {
  JPanel p = new JPanel();
  similar to above but a Table;
  return p;
} 
```

您可以看到我是如何在方法中创建面板的，而不是将它们作为组件添加到基本面板中。

你会怎么做`TitleAreaDialog`呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:33:31.077

我还没用过`TitleAreaDialog`，这里简单`Dialog`介绍一下我自己用的。它应该让您了解对话框的内部工作原理。它基本上只是一个带有一些错误消息和一个复选框的对话框：

```
public class CheckboxDialog extends Dialog {

    private String message = "";
    private String checkboxMessage = "";
    private boolean checkValue;

    private Button checkButton;

    /* Constructor, set shell style and set block on open (rest of gui is blocked until closed) */
    public CheckboxDialog(Shell parentShell) {
        super(parentShell);
        setShellStyle(SWT.CLOSE | SWT.TITLE | SWT.BORDER | SWT.OK | SWT.APPLICATION_MODAL);
        setBlockOnOpen(true);
    }

    /* creates the content of the dialog */
    protected Control createDialogArea(Composite parent) {
        Composite composite = (Composite) super.createDialogArea(parent);

        /* set the layout for the content (gridlayout with 1 column)*/
        GridLayout layout = new GridLayout(1, false);
        layout.marginHeight = 15;
        layout.marginWidth = 30;
        composite.setLayout(layout);

        /* add a label with some text */
        final Label content = new Label(composite, SWT.NONE);
        content.setLayoutData(new GridData(SWT.FILL, SWT.TOP, true, false));
        content.setText(message);

        /* add a checkbox button */
        checkButton = new Button(composite, SWT.CHECK);
        checkButton.setText(checkboxMessage);
        checkButton.setSelection(true);
        checkButton.setLayoutData(new GridData(SWT.FILL, SWT.TOP, true, false));

        return composite;
    }

    /* create the dialog buttons (in this case, only an OK button) */
    protected void createButtonsForButtonBar(Composite parent)
    {
        createButton(parent, IDialogConstants.OK_ID, "OK", true);
    }

    /* configure the dialog's shell (set title) */
    protected void configureShell(Shell newShell) {
        super.configureShell(newShell);
        newShell.setText("Error");
    }

    /* this method is executed if the OK button is pressed */
    public void okPressed()
    {
        checkValue = checkButton.getSelection();
        close();
    }

    /* getter and setter methods */
    public void setMessage(String message) {
        this.message = message;
    }

    public void setCheckboxMessage(String checkboxMessage) {
        this.checkboxMessage = checkboxMessage;
    }

    public boolean getCheckBoxValue()
    {
        return checkValue;
    }
} 
```

如您所见，`add`SWT 中没有方法。您只需在每个小部件的构造函数中指定父级。

此外，[这里](http://www.vogella.com/articles/EclipseDialogs/article.html)是 Vogella 的一个非常好的教程，详细解释了如何创建 JFace 对话框。[这](http://www.java2s.com/Code/Java/SWT-JFace-Eclipse/JFacesTitleAreaDialog.htm)是另一个关于如何使用`TitleAreaDialog`.

# php - 如何设置 30 天的电子邮件验证以由用户重新发送？

> ID：12099421
> 
> 赞同：-4
> 
> 时间：2012-08-23T20:25:11.383
> 
> 标签：php, javascript, jquery, mysql, wordpress

我想在我的网页上设置一个计时器，如果用户填写联系我们页面。在接下来的 30 天内，他无法重新发送电子邮件或填写管理员联系页面。

之后，他可以填写联系我们页面。

可能是电子邮件可能是唯一的。通过电子邮件验证，我们可以将该特定用户保留 30 天。

请帮我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T20:41:57.550

您可以创建一个如下所示的数据库表：

```
CREATE TABLE contact_flood
(
   `email_address` TEXT NOT NULL,
   `time` INT NOT NULL,
) 
```

当用户使用如下查询提交联系表单时，他们的电子邮件地址和表单保存到此表的时间：

```
"INSERT INTO contact_flood (email_address, time) VALUES ('".$escapedEmailAddress."', '".time()."')" 
```

然后，您可以对表单提交设置检查，以检查电子邮件是否在表格中：

```
"DELETE FROM contact_flood WHERE time < (".time()." - 2592000)"
"SELECT COUNT(*) as count FROM contact_flood WHERE email_address = '".$escapedEmailAddress 
```

第一个查询删除表中超过 30 天的所有条目，第二个查询返回具有指定电子邮件地址的所有剩余行。如果`count`查询产生的变量不为零，则不要发送电子邮件并给用户适当的消息。如果它为零，请继续发送电子邮件，然后从之前运行插入查询。

另一种方法是每 30 天只允许每个 IP 地址提交一个表单。在这种情况下，您只需将 email_address 替换为 ip_address 即可。`count`在这种情况下，您还可以在加载表单之前运行检查，如果表单返回非零变量，甚至不加载表单。

# php - 包含标签的全文搜索

> ID：12099425
> 
> 赞同：0
> 
> 时间：2012-08-23T20:25:24.817
> 
> 标签：php, mysql, sql, cakephp, search

这并不完全是 cakephp 独有的，但那是我正在使用的框架，所以 thateans 的任何帮助都会很棒..！

我有一个帖子、标签和 post_tags 的 MySQL 表将两者关联在一起。

我已经将我的帖子表上的全文字段设置为正文和标题，但我也想将关联的标签包含在我的搜索中，并根据搜索查询对分配给帖子的任何标签的位置进行排序.

我可能需要为此构建一个庞大的 SQL 查询吗？此外，如果有人可以提供 cakephp 特定的解决方案，我也想使用内置的缓存方法缓存搜索......

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T23:44:22.590

在 CakePHP 中使用“查找”函数：

```
$result = $this->Post->find('all', array('conditions' => array('Post.body LIKE' => '%search_text%'))); 
```

如果您想从查询中获取更多信息，请将此行放在“查找”函数之前：

```
$this->Post->recursive = 2; //or 1 
```

在 $result 中，您应该获得属于已创建帖子的所有标签。

# syntax - vbscript 如何导入函数而不自动运行该函数？

> ID：12099426
> 
> 赞同：0
> 
> 时间：2012-08-23T20:25:25.653
> 
> 标签：syntax, vbscript, structure

我有两个 vbscript 文件，file1.vbs 和 file2.vbs 在 a.vbs 中，我有以下代码：

暗淡 a : a = 1

```
function myFunction(k)
...
end function

call myFunction(a) 
```

所以 file1.vbs 实际上可以独立运行。现在在file2.vbs 中，我想调用位于file1.vbs 中的myFunction(k)。但是，当我在file2.vbs中导入file1.vbs时，调用的myFunction也被导入，导致myFunction自动运行参数“a”......这不是我想要的，因为我可能会给myFunction一个不同的参数，说“b”。

我应该如何构建程序以使 file1.vbs 可以独立运行，而 file2.vbs 也可以在 file1.vbs 中调用 myFunction 但输入参数不同？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T11:08:23.593

在我看来，最好的方法是让库/模块`.vbs`文件只包含可重用的子/函数/类，但不包含顶级（立即执行）代码。用户文件通过[ExecuteGlobal](http://msdn.microsoft.com/en-us/library/342311f1%28v=VS.84%29.aspx)`.vbs`导入库，如[Microsoft TechNet 帖子](http://social.technet.microsoft.com/Forums/en/ITCG/thread/e5b50398-d12a-4e93-ae33-d3929228eddb)所示。`.ReadAll()`

（另请参阅具有类似功能但也可以定义具有*本地*范围的对象和变量的[Execute 。）](http://msdn.microsoft.com/en-us/library/03t418d2%28v=vs.84%29)

 *如果您坚持混合模块和顶级代码，您可以使用 Pythonic 习语并将当前`WScript.ScriptName`与字符串文字进行比较，并仅在它们匹配时调用适当的“顶级代码”。*

# c# - mvc中的复选框值

> ID：12099427
> 
> 赞同：2
> 
> 时间：2012-08-23T20:25:28.797
> 
> 标签：c#, asp.net-mvc, razor

我试图弄清楚如何正确表示值、选择的过程以及稍后在编辑表单中将选中的项目显示为已选中，而将其他可能的值显示为未选中。

我已经尝试了一些东西，但我不确定我是否走在正确的轨道上。使用这些解决方案编辑表单仅显示选中的项目，而不显示其他未选中的项目。

**如果您有更好的解决方案，请分享，因为我试图弄清楚这些是如何工作的。**

这里是：假设有可能属于一个或多个角色的用户。所以我将通过两个视图模型 UserViewModel 和 RoleViewModel 来表示这些

```
**UserViewModel.cs**

public int id {get; set;}
public string username {get; set;}

public UserViewModel()
{
   Roles = new List<RoleViewModel>();
}

public void SendToDomain(User user, ISession nhibSession)
{
   if(user.Roles != null)
   {
      user.Roles.Clear();//Clear previous selected items
      foreach(Role role in Roles)
      {
        if(role.IsInRole)
          user.Role.Add(nhibSession.Load<Role>(user.RoleId)); 
      }
   }
}

**RoleViewModel**
public bool IsInRole {get; set;}

[HiddenInput(displayValue = false)]
public int RoleId {get; set;}

[HiddenInput(displayValue = true)]
public string RoleName {get; set;} 
```

在 EditorTemplates 我有 RoleViewModel.cs

```
@model Models.RoleViewModel

@Html.CheckBoxFor(m=>m.IsInRole)
@Html.HiddenFor(m=>m.RoleId)
@Html.LabelFor(m=>m.IsInRole, Model.RoleName) 
```

最后在创建视图中，我像这些@model Models.UserViewModel 一样显示这些

```
<div> User roles </div> <div> @Html.EditorFor(m => m.Roles) </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:25:04.603

这是如何做到的：

**用户视图模型**

```
public int id {get; set;}
public string username {get; set;}
public int[] RoleIdsSelected { get; set; } 
```

**窗体视图**

您需要循环访问应用程序中存在的**所有角色。**然后，创建一个将链接到您的 UserViewModel.RolesIdsSelected 的复选框，并将值与打印的当前 role.RoleId 进行比较。如果有比赛，就会有支票。

```
@model UserViewModel

@{
    foreach (var role in (IEnumerable<Role>)ViewBag.AllRoles)
    {
        <label>
            @Html.CheckBoxFor(x => x.RoleIdsSelected, role.RoleId)
            @role.RoleName
        </label>
    }
} 
```

**复选框扩展**

```
public static class InputExtensions
{
    public static MvcHtmlString CheckBoxFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression, object value)
    {
        return htmlHelper.CheckBoxFor<TModel, TProperty>(expression, value, null);
    }

    public static MvcHtmlString CheckBoxFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression, object value, object htmlAttributes)
    {
        return htmlHelper.CheckBoxFor<TModel, TProperty>(expression, value, HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes));
    }

    public static MvcHtmlString CheckBoxFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression, object value, IDictionary<string, object> htmlAttributes)
    {
        ModelMetadata modelMetadata = ModelMetadata.FromLambdaExpression<TModel, TProperty>(expression, htmlHelper.ViewData);
        return CheckBoxHelper<TModel, TProperty>(htmlHelper, modelMetadata, modelMetadata.Model, ExpressionHelper.GetExpressionText(expression), value, htmlAttributes);
    }

    private static MvcHtmlString CheckBoxHelper<TModel, TProperty>(HtmlHelper htmlHelper, ModelMetadata metadata, object model, string name, object value, IDictionary<string, object> htmlAttributes)
    {
        if (value == null)
        {
            throw new ArgumentNullException("value");
        }

        RouteValueDictionary routeValueDictionary = htmlAttributes != null ? new RouteValueDictionary(htmlAttributes) : new RouteValueDictionary();

        string fullHtmlFieldName = htmlHelper.ViewContext.ViewData.TemplateInfo.GetFullHtmlFieldName(name);

        if (string.IsNullOrEmpty(fullHtmlFieldName))
        {
            throw new ArgumentException("Le nom du control doit être fourni", "name");
        }

        TagBuilder tagBuilder = new TagBuilder("input");

        tagBuilder.MergeAttributes<string, object>(htmlAttributes);
        tagBuilder.MergeAttribute("type", HtmlHelper.GetInputTypeString(InputType.CheckBox));
        tagBuilder.MergeAttribute("name", fullHtmlFieldName, true);

        string text = Convert.ToString(value, CultureInfo.CurrentCulture);

        tagBuilder.MergeAttribute("value", text);

        if (metadata.Model != null)
        {
            foreach (var item in metadata.Model as System.Collections.IEnumerable)
            {
                if (Convert.ToString(item, CultureInfo.CurrentCulture).Equals(text))
                {
                    tagBuilder.Attributes.Add("checked", "checked");
                    break;
                }
            }
        }

        return MvcHtmlString.Create(tagBuilder.ToString(TagRenderMode.SelfClosing));
    }
} 
```

当您发布数据时，您将在 UserViewModel.RolesIdsSelected 中拥有用户已检查的 ID。然后，保存更改！

# javascript - 如何将点击事件绑定到不同的类？

> ID：12099431
> 
> 赞同：2
> 
> 时间：2012-08-23T20:25:57.073
> 
> 标签：javascript, jquery, bind

所以我有两个“按钮打开”和“按钮关闭”的点击事件。我有一个按钮可以在单击时从“按钮打开”切换到“按钮关闭”。因此，当我再次单击它时，它应该触发“按钮关闭”事件，但它会再次触发“按钮打开”事件。演示：[jsFidde](http://jsfiddle.net/UhVuq/ "jsFiddle")

这是我的代码：

```
<a href="#" class="button-open">Button</a>​

<script>
$(document).ready(function() {
   $(".button-open").click(function() {
      $(this).removeClass("button-open").addClass("button-close");
      alert("Open Was Clicked");
   });

   $(".button-close").click(function() {
      $(this).removeClass("button-close").addClass("button-open");
      alert("Close Was Clicked");
   });
});
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T20:28:59.360

使用[`on()`](http://api.jquery.com/on/)而不是`click()`，因为您需要绑定到最初绑定时尚不存在的元素。

```
$(document).on('click', '.button-open', function() {
    $(this).removeClass("button-open").addClass("button-close");
    alert("Open Was Clicked");
});

$(document).on('click', '.button-close', function() {
    $(this).removeClass("button-close").addClass("button-open");
    alert("Close Was Clicked");
}); 
```

**[演示](http://jsfiddle.net/UhVuq/3/)**。

# javascript - Dojo 菜单栏选中状态

> ID：12099432
> 
> 赞同：0
> 
> 时间：2012-08-23T20:25:57.797
> 
> 标签：javascript, dojo

我的菜单栏项目在错误的统计信息中堆积有问题。所以我试图手动设置状态取决于鼠标事件。但是我尝试过的东西不起作用：

```
dijit.byId("someDiv")._setStateClass(this.selected=false);
dijit.byId("someDiv")._set(“selected”, false);
dijit.byId("someDiv")._set(“active”, false); 
```

网址：[http](http://dojotoolkit.org/api/) ://dojotoolkit.org/api/在 dijit.MenuBarItem

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:02:23.520

查看[_MenuBase](https://github.com/dojo/dijit/blob/master/_MenuBase.js)和[MenuBar](https://github.com/dojo/dijit/blob/master/MenuBar.js)的源代码，您想模拟它们从中获得的行为：

`menuBar.focusChild`设置焦点，然后结合`closeChild()`和`onItemUnhover()`删除它。

从`closeChild()`你可以试试

```
item._setSelected(false); 
```

并从`onItemUnhover()`尝试

```
item._set("hovering", false); 
```

# python - 根据列值过滤numpy ndarray（矩阵）

> ID：12099433
> 
> 赞同：6
> 
> 时间：2012-08-23T20:25:58.070
> 
> 标签：python, matrix, numpy

`NumPy` `ndarray`这个问题是关于根据某些列值过滤 a 。

我有一个相当大的`NumPy` `ndarray`（300000、50），我正在根据某些特定列中的值对其进行过滤。我有`ndtypes`，所以我可以按名称访问每一列。

第一列已命名`category_code`，我需要过滤矩阵以仅返回`category_code`in 中的行`("A", "B", "C")`。

结果将需要是另一个`NumPy` `ndarray`其列仍可通过`dtype`名称访问的列。

这是我现在要做的：

```
index = numpy.asarray([row['category_code'] in ('A', 'B', 'C') for row in data])
filtered_data = data[index] 
```

列表理解如：

```
list = [row for row in data if row['category_code'] in ('A', 'B', 'C')]
filtered_data = numpy.asarray(list) 
```

行不通，因为`dtypes`我原来拥有的不再可访问。

**有没有更好/更 Pythonic 的方式来实现相同的结果？**

可能看起来像：

```
filtered_data = data.where({'category_code': ('A', 'B','C'}) 
```

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T20:57:55.450

您可以使用基于***NumPy***的库[Pandas](http://pandas.pydata.org)，它具有更普遍有用的*ndarrays*实现：

```
>>> # import the library
>>> import pandas as PD 
```

创建一些示例*数据*作为*python 字典*，其*键*是列名，其*值*是作为 python 列表的列值；每列一个键/值对

```
>>> data = {'category_code': ['D', 'A', 'B', 'C', 'D', 'A', 'C', 'A'], 
            'value':[4, 2, 6, 3, 8, 4, 3, 9]}

>>> # convert to a Pandas 'DataFrame'
>>> D = PD.DataFrame(data) 
```

要仅返回 category_code 为 B 或 C 的行，从概念上讲需要两个步骤，但可以在一行中轻松完成：

```
>>> # step 1: create the index 
>>> idx = (D.category_code== 'B') | (D.category_code == 'C')

>>> # then filter the data against that index:
>>> D.ix[idx]

        category_code  value
   2             B      6
   3             C      3
   6             C      3 
```

*请注意Pandas*中的索引与构建 Pandas 的库*NumPy*之间的区别。在 NumPy 中，您只需将索引放在括号内，用“，”指示要索引的维度，并使用“：”表示您想要另一个维度中的所有值（列）：

```
>>>  D[idx,:] 
```

在 Pandas 中，您调用数据框的***ix***方法，并且*仅*将索引放在括号内：

```
>>> D.loc[idx] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T20:32:01.703

如果可以选择，我强烈推荐[pandas](http://pandas.pydata.org)：它[内置了“列索引”](http://pandas.pydata.org/pandas-docs/stable/indexing.html#additional-column-access)以及许多其他功能。它建立在 numpy 之上。

# cakephp - 我们如何使用 Netbeans 调试 cakephp？

> ID：12099434
> 
> 赞同：1
> 
> 时间：2012-08-23T20:25:58.187
> 
> 标签：cakephp, netbeans

我是 cakephp 的初学者。我正在使用 netbeans IDE。是否有任何用于调试 cakephp 脚本的 netbeans 插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T23:50:50.560

我只会使用 XDebug。这是有关如何使用 NetBeans 设置 XDebug 的链接[http://wiki.netbeans.org/HowToConfigureXDebug](http://wiki.netbeans.org/HowToConfigureXDebug)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T23:48:29.050

你总是可以把

```
debug($variable);
die; //if you want to stop the program 
```

你会得到变量的值。这就像 printf(); 如果您不使用调试器，则适用于 C。:D

# java - 在 Java 7 中播放声音

> ID：12099435
> 
> 赞同：2
> 
> 时间：2012-08-23T20:26:05.003
> 
> 标签：java, fedora, javasound

我正在尝试用 Java 播放声音文件。我写了这段代码：

```
import java.io.File;
import java.io.IOException;

import javax.sound.sampled.AudioInputStream;
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.Clip;
import javax.sound.sampled.LineUnavailableException;
import javax.sound.sampled.UnsupportedAudioFileException;

public class SoundBang
{
    private File _file;
    private AudioInputStream _audio;
    private Clip _clip;

    public SoundBang( )
    {
        _file = new File( "file/sound/bang.wav" );

        try
        {
            _audio = AudioSystem.getAudioInputStream( _file );
            _clip = AudioSystem.getClip( );
            _clip.open( _audio );
            _clip.start( );
        }
        catch ( LineUnavailableException e )
        {
            e.printStackTrace( );
        }
        catch ( IOException e )
        {
            e.printStackTrace( );
        }
        catch ( UnsupportedAudioFileException e )
        {
            e.printStackTrace( );
        }
    }

    public static void main ( String[ ] args )
    {
        new SoundBang( );
    }
} 
```

问题是当我运行这段代码时我什么也没听到。

声音文件的 URL 是正确的（我通过打印绝对 URL 对其进行了测试，它很好）。我正在使用带有 KDE 的 Eclipse Juno、openjdk-7 和 Fedora 17。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:42:16.130

几件事：

1.  clip.start 产生一个新线程在后台执行，当应用程序死掉时它就会死掉。开始剪辑后尝试睡觉。
2.  开始后有必要向前寻求吗？这似乎只是一个额外的行。

尝试制作你的主要方法：

```
public static void main ( String[ ] args )
{
    new SoundBang( );
    Thread.sleep(2000); // Sleep 2 seconds
} 
```

# php - 重定向而不离开当前页面

> ID：12099441
> 
> 赞同：-4
> 
> 时间：2012-08-23T20:26:22.463
> 
> 标签：php, redirect

是否可以在不离开当前页面的情况下使用 php 重定向请求的页面，或者它需要 javascript？我需要这个在后台获取 cookie，或者从第三方获取 cookie 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:30:20.700

可以使用 JavaScript/jQuery 将内容动态加载到页面中。使用 获取内容，[`$.ajax()`](http://api.jquery.com/jQuery.ajax/)然后使用 将数据加载到选定的`div`（或其他选择器）中[`html()`](http://api.jquery.com/html/)。这样，页面保持不变（您保留 cookie），但您可以加载其他内容（而不是重定向）。

# vim - vim - 将“read”命令的输出作为 Ex 模式下的范围处理

> ID：12099444
> 
> 赞同：2
> 
> 时间：2012-08-23T20:26:34.403
> 
> 标签：vim

**背景：**

在 vim（Ex 模式）中，可以运行外部命令并将该命令的输出自动插入当前缓冲区。

在示例 001 中，我们看到如何 cd 到当前目录，获取那里的文件列表并自动将其插入当前缓冲区

**示例 001：**

```
 :cd . | :r ! dir /w/s/b 
```

**问题：**

1) 是否可以自动指定或捕获 Vim {range} 以反映最近插入文件的行？

2) 使用问题 1) 中获得的范围是否可以链接 Ex 模式命令以自动处理插入到文件中的行？

3) 如果无法执行上述 1) 或 2)，Vim 是否有另一种方法可以识别最近插入缓冲区的行并对其运行任意命令？

4) 什么是可用于此目的的相关 :help 交叉引用？

**目标：**

目标是能够将多个 Ex 模式命令链接在一起，以轻松运行处理最近添加到文件的行，而无需明确识别行号或使用可视模式或类似方式手动选择它们。

目标是做类似于示例 002 中的（伪代码）的事情

**示例 002：**

```
 :cd . | :r ! dir /w/s/b | :{auto-range}s/^/    / 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T07:16:02.630

Vim 设置更改标记`'[`和`']`插入的范围；您可以使用这些来定义后续 Ex 命令的范围：

```
:cd . | execute 'r ! dir /w/s/b' | '[,']s/^/    / 
```

您需要`:execute`，否则将`|`被解释为属于该`:r`命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:44:14.263

在将它们插入 Vim*之前*处理这些行怎么样？

```
:r!dir /w/s/b | sed -e "s/^/    /" 
```

# java - Java NIO 选择器最小可能延迟

> ID：12099446
> 
> 赞同：9
> 
> 时间：2012-08-23T20:26:37.143
> 
> 标签：java, real-time, messaging, nio, zeromq

我正在通过环回 (127.0.0.1) 在 Linux 上使用优化的 Java NIO 选择器进行一些基准测试。

我的测试很简单：

*   一个程序将 UDP 数据包发送到另一个程序，该程序将其回显给发送者，并计算往返时间。下一个数据包仅在前一个数据包被确认（返回时）时发送。在执行基准测试之前，会使用数百万条消息进行适当的预热。该消息有 13 个字节（不包括 UDP 标头）。

对于往返时间，我得到以下结果：

*   最短时间：13 微
*   平均时间：19 微
*   75% 百分位数：18,567 毫微
*   90% 百分位数：18,789 毫微
*   99% 百分位数：19,184 毫微
*   99.9% 百分位数：19,264 毫微
*   99.99% 百分位数：19,310 毫微
*   99.999% 百分位数：19,322 毫微

但这里的问题是我正在旋转 100 万条消息。

如果我只旋转 10 条消息，我会得到非常不同的结果：

*   最短时间：41 微
*   平均时间：160 微
*   75% 百分位：150,701 毫微
*   90% 百分位数：155,274 毫微
*   99% 百分位数：159,995 纳秒
*   99.9% 百分位数：159,995 毫微
*   99.99% 百分位数：159,995 毫微
*   99.999% 百分位数：159,995 纳秒

如果我错了，请纠正我，但我怀疑一旦我们让 NIO 选择器旋转，响应时间就会变得最佳。但是，如果我们发送消息之间的间隔足够大，我们就要付出唤醒选择器的代价。

如果我只发送一条消息，我会收到 150 到 250 微秒之间的不同时间。

所以我对社区的问题是：

1 - 对于此往返数据包测试，我的最短时间为 13 微秒，平均为 19 微秒。到目前为止，我似乎击败了[ZeroMQ](http://www.zeromq.org/)，所以我可能在这里遗漏了一些东西。从这个基准来看，ZeroMQ 在标准内核上的平均时间为 49 微秒（99% 百分位数）=> [http://www.zeromq.org/results:rt-tests-v031](http://www.zeromq.org/results:rt-tests-v031)

2 - 当我旋转一条或很少的消息时，我可以做些什么来改善选择器的反应时间？150微不好看。或者我应该假设在 prod 环境中选择器不会完全正确？

* * *

通过忙于在 selectNow() 周围旋转，我可以获得更好的结果。发送少量数据包仍然比发送很多数据包更糟糕，但我认为我现在达到了选择器性能限制。我的结果：

*   发送单个数据包我得到一致的 65 微秒往返时间。
*   发送两个数据包我平均得到大约 39 微秒的往返时间。
*   发送 10 个数据包，平均往返时间约为 17 微秒。
*   发送 10,000 个数据包，我平均获得大约 10,098 纳纳的往返时间。
*   发送 100 万个数据包，我平均获得 9,977 纳秒的往返时间。

**结论**

*   所以看起来 UDP 数据包往返的物理障碍平均为 10 微秒，尽管我有一些数据包在 8 微秒（最小时间）内完成了行程。

*   在忙碌的旋转中（感谢彼得），我能够从平均 200 微秒增加到单个数据包的平均 65 微秒。

*   不知道为什么 ZeroMQ比这[慢 5 倍](http://www.zeromq.org/results:rt-tests-v031)。（**编辑：**也许是因为我通过环回在同一台机器上测试这个并且ZeroMQ使用了两台不同的机器？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T09:39:57.967

您经常看到唤醒线程的情况可能非常昂贵，这不仅是因为线程唤醒需要时间，而且线程在之后的数十微秒内运行速度慢 2-5 倍，因为缓存和

我过去避免这种情况的方法是忙着等待。不幸的是 selectNow 每次调用它都会创建一个新集合，即使它是一个空集合。这会产生如此多的垃圾，不值得使用。

解决此问题的一种方法是忙于等待非阻塞套接字。这不能很好地扩展，但可以为您提供最低的延迟，因为线程不需要唤醒并且您在此之后运行的代码更有可能在缓存中。如果你也使用线程关联，它可以减少你的线程干扰。

我还建议尝试减少代码锁定和垃圾。如果您这样做，您可以在 Java 中创建一个进程，该进程在 90% 的时间里在 100 微秒内发送对传入数据包的响应。这将允许您在每个数据包到达时以 100 Mb 的速度处理它们（由于带宽限制，最多相隔 145 微秒）对于 1 Gb 连接，您可以非常接近。

* * *

如果你想在 Java 中的同一个盒子上进行快速的进程间通信，你可以考虑像[https://github.com/peter-lawrey/Java-Chronicle](https://github.com/peter-lawrey/Java-Chronicle) 这使用共享内存来传递具有往返延迟的消息（这很难做到有效地使用套接字）小于 200**纳秒**。它还可以保留数据，如果您只是想要一种快速生成日志文件的方法，它会很有用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-16T01:36:15.763

如果您正确调整选择器，您可以在不到 2 微秒的时间内获得 Java 中的套接字间通信。这是我对 256 字节 UDP 数据包的单向结果：

```
Iterations: 1,000,000
Message Size: 256 bytes
Avg Time: 1,680 nanos
Min Time: 1379 nanos
Max Time: 7020 nanos
75%: avg=1618 max=1782 nanos
90%: avg=1653 max=1869 nanos
99%: avg=1675 max=1964 nanos
99.9%: avg=1678 max=2166 nanos
99.99%: avg=1679 max=5094 nanos
99.999%: avg=1680 max=5638 nanos 
```

我在我的文章[Inter-socket communication with less than 2 microseconds latency](http://mentablog.soliveirajr.com/2013/02/inter-socket-communication-with-less-than-2-microseconds-latency/)中详细讨论了 Java NIO 和反应器模式。

# javascript - 为图表中的所有 d3.js 数据点添加唯一链接

> ID：12099448
> 
> 赞同：10
> 
> 时间：2012-08-23T20:26:51.440
> 
> 标签：javascript, svg, d3.js, nvd3.js

我正在使用[nvd3.js](http://nvd3.com/)创建一个折线图，显示我随时间计算的评分。我对每个单独的数据点（评级）都有更多信息，并希望图表上的每个数据点链接到一个独特的页面，其中包含有关该特定数据点的更多信息。

*例如：*我希望能够将鼠标悬停在图表上的第一个数据点（x：1345457533，y：-0.0126262626263）并单击它以转到特定页面（http://www.example.com/ info?id=1) 提供有关该评级或数据点的更多信息。每个数据点都有一个我想链接到的唯一 id 和唯一 url。

这是我用来生成图表的代码：

```
nv.addGraph(function() {
  var chart = nv.models.lineChart();

  chart.xAxis
      .axisLabel('Time')
      .tickFormat(d3.format('r'));

  chart.yAxis
      .axisLabel('Rating')
      .tickFormat(d3.format('.2f'));

  d3.select('#chart svg')
      .datum(data())
      .transition().duration(500)
      .call(chart);

  nv.utils.windowResize(chart.update);

  return chart;
});

function data() {
  var data = [ { x: 1345457533, y: -0.0126262626263 },
               { x: 1345457409, y: 0.0224089635854 },
               { x: 1345457288, y: 0.0270935960591 },
               { x: 1345457168, y: -0.0378151260504 },
               { x: 1345457046, y: -0.115789473684 } ]

  return [
    {
      values: data,
      key: "Sample1",
      color: "#232066"
    }
  ];
} 
```

的HTML：

```
<div id="chart">
  <svg></svg>
</div> 
```

这是一个[工作示例](http://jsfiddle.net/66hAj/)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T08:03:08.800

这是一个可行的解决方案[http://jsfiddle.net/66hAj/7/](http://jsfiddle.net/66hAj/7/)

```
$('#chart svg').on('click', function(e){
    var elem = $(e.target),
        currentItem, currentUrl;

    if(elem.parent('.nv-point-paths').length) {
        currentItem = e.target.getAttribute('class').match(/\d+/)[0];
        currentUrl = _data[0].urls[ currentItem ];

        $('#log').text(currentUrl);
        //window.location = currentUrl
    }
}) 
```

我使用 jQuery 在画布上绑定了一个点击处理程序，然后根据在图表上点击的元素获取数据。

`currentItem`为您提供您单击的当前项目的 ID

`currentUrl`给出与当前点击的项目相关的 url。

当您单击图表上的每个点时，您可以在图表下方的 div 中看到 url 的变化。

# html - 第一个孩子没有被触发

> ID：12099452
> 
> 赞同：2
> 
> 时间：2012-08-23T20:27:00.863
> 
> 标签：html, css, sass

我有一些在 HTML 中看起来像这样的帖子：

```
<article class="post">
  <h3>Lorem ipsum adipisicing do sed laboris</h3>
  <p>
    Lorem ipsum cillum reprehenderit consequat veniam dolore non minim in dolore commodo labore ex veniam sed aliqua amet incididunt ea ut occaecat cupidatat ex Duis Excepteur exercitation enim tempor deserunt eiusmod deserunt Ut culpa magna culpa.
  </p>
  <p>
    Lorem ipsum quis laboris ex cillum ex do ullamco amet sint commodo reprehenderit id tempor reprehenderit do dolore esse ut qui esse laboris reprehenderit voluptate elit consequat incididunt ut anim nulla cupidatat aliquip est ut elit eiusmod Duis nulla ad ut. 
  </p>
  <p class="read-more">
    <a href="#">Read more »</a>
  </p>
</article> 
```

然后我有一些设置顶部和底部边框的 CSS。问题是我不希望第**一个**帖子有上边框，**最后**一个帖子有下边框。

我的 CSS（实际上是 SASS）：

```
 .post {
    border-bottom: 1px solid darken($lightestBlue, 5%);
    border-top: 1px solid darken(#FFFFFF, 5%);

    &:first-child {
      border-top: none;
    }
    &:last-child {
      border-bottom: none;
    }
  } 
```

**这里的问题是最后一个**帖子的底部边框被删除了，但**第一个**没有被触及。第一个孩子没有被触发！

这是为什么？第一个孩子和最后一个孩子的工作方式不一样吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:28:17.500

您可能在第一个之前有一些其他元素`<article>`。
`:first-child`如果它有一个不匹配的较早同级，则不适用。

# asp.net-mvc - 该字段必须是数字。如何将此消息更改为另一种语言？

> ID：12099466
> 
> 赞同：39
> 
> 时间：2012-08-23T20:27:54.583
> 
> 标签：asp.net-mvc, validation, localization, numbers, data-annotations

如何更改所有`int`字段的消息，而不是说：

`The field must be a number`在英语中，它显示：

`El campo tiene que ser numerico`在西班牙语中。

有没有办法？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-08-22T23:37:28.207

如果您碰巧使用的是 ASP.NET MVC 4 以后的版本，请查看这篇文章：

[在 ASP.NET MVC 和 WebForms 中本地化默认错误消息](http://weblogs.asp.net/imranbaloch/archive/2013/03/31/localizing-default-error-messages-in-asp-net-mvc-and-web-form.aspx)

`Application_Start()`基本上你必须在你的方法中添加以下代码`Global.asax`：

```
 ClientDataTypeModelValidatorProvider.ResourceClassKey = "Messages";
 DefaultModelBinder.ResourceClassKey = "Messages"; 
```

在 Visual Studio 的解决方案资源管理器中右键单击您的 ASP.NET MVC 项目，然后选择`Add => Add ASP.NET Folder => App_GlobalResources`.

现在`.resx`在这个文件夹中添加一个名为`Messages.resx`.

`.resx`最后在该文件中添加以下字符串资源：

```
Name                   Value
====                   =====
FieldMustBeDate        The field {0} must be a date.
FieldMustBeNumeric     The field {0} must be a number.
PropertyValueInvalid   The value '{0}' is not valid for {1}.
PropertyValueRequired  A value is required. 
```

你应该很高兴。

请注意，您感兴趣的值是`FieldMustBeNumeric`. 要将其本地化为*西班牙语*，您必须添加另一个名为`Messages.es.resx`. 在此特定`.resx`文件中，将资源值替换为：

```
Name                Value
====                =====
FieldMustBeNumeric  El campo {0} tiene que ser numerico. 
```

* * *

如果您碰巧向下使用 ASP.NET MVC 3，此解决方案可以帮助您达到相同的结果：[https ://stackoverflow.com/a/2551481/114029](https://stackoverflow.com/a/2551481/114029)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-23T20:47:53.217

您可以设置自定义消息以进行验证。

```
 [RegularExpression("\d{9}",ErrorMessage="El campo tiene que ser numerico")]
 public decimal UnitPrice { get; set; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-24T07:50:59.470

如果要为每个 Integer 、 double 和 float 指定自定义消息。您可以将范围属性与字符串一起使用，如下所示。

```
 [Required(ErrorMessageResourceType = typeof(Global), ErrorMessageResourceName = "YearOfEstablishmentRequired")]
    [Range(0, int.MaxValue, ErrorMessageResourceType = typeof(Global), ErrorMessageResourceName = "ValidYearOfEstablishment")]
    [Display(Name = "Year Of Establishment")]
    public string YearOfEstablishment { get; set; } 
```

现在如上所述，您可以为每个属性指定自定义消息。

# json - 在 Go 中解码可变模式 JSON

> ID：12099470
> 
> 赞同：10
> 
> 时间：2012-08-23T20:28:16.237
> 
> 标签：json, go

我问这个关于 Go 的问题`encoding/json`，但我想它也适用于任何其他将 JSON blob 映射到任何语言的对象的 JSON 库。

这是一个例子。如果您想使用[goo.gl URL 缩短 API](https://developers.google.com/url-shortener/v1/getting_started)来缩短 URL ，您会得到一个成功的响应：

```
{
 "kind": "urlshortener#url",
 "id": "http://goo.gl/fbsS",
 "longUrl": "http://www.google.com/"
} 
```

或错误响应：

```
{
 "error": {
  "errors": [
   {
    "domain": "global",
    "reason": "required",
    "message": "Required",
    "locationType": "parameter",
    "location": "resource.longUrl"
   }
  ],
  "code": 400,
  "message": "Required"
 }
} 
```

有没有一种惯用的方法来处理这个问题——一种可以遵循两种完全不同模式的响应？

通常我使用地图/列表来处理 JSON；我知道这在 Go 中是可能的。我可以解组到 a`map[string]interface{}`然后检查地图是否`"error"`作为键。但是，我认为我必须再次解码为适当的`struct`。（我错了吗？）

我正在做这样的事情。对于每种响应，我都有一种类型：

```
type successResponse struct {
    Kind string
    Id string
    LongUrl string
}

type errorResponse struct {
    Error struct {
        Errors []struct {
            Domain string
            Reason string
            Message string
            LocationType string
            Location string
        }
        Code int
        Message string
    }
} 
```

解码看起来像这样：

```
s := new(successResponse)
err := json.Unmarshal(blob, s)
if err == nil {
    // handle success
} else {
    e := new(errorResponse)
    err = json.Unmarshal(blob, e)
    if err == nil {
        // handle error response
    } else {
        // handle actual error
    }
} 
```

但这似乎有点丑陋。我应该如何处理这个？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T06:22:35.437

由于您的 json 响应中的字段彼此不同，您只需创建一个包含所有字段并集的结构。json 解码器将忽略 json 字符串中不存在的字段，您可以测试字段的存在以了解您返回的响应类型。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-26T08:02:26.403

我也对此感到困惑，并认为我必须再次对其进行解码。不过，你不知道。您只需要将 interface{} 数据类型转换为适当的结构。

例如，如果 json 包已将值放入泛型`interface{}`中，您可以将其类型转换为`ErrorType`with `error := val.(ErrorType)`。

如果您根据值的类型进行解析，则可以`foo.(type)`在语句中使用“做正确的事情”。`switch`

我这周才开始学习 Go，所以它不是最漂亮的代码，但在[geodns JSON 配置解析](https://github.com/abh/geodns/blob/master/zones.go#L267)中有一些示例。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-24T07:37:17.180

你试过[Go-SimpleJSON](https://github.com/bitly/go-simplejson)吗？我认为这可能会解决您的问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-24T10:48:00.233

```
type Response struct {
    Kind    string
    Id      string
    LongUrl string
    Error   struct {
        Errors []struct {
            Domain       string
            Reason       string
            Message      string
            LocationType string
            Location     string
        }
        Code    int
        Message string
    }
}

s := Response{}
if err := json.Unmarshal(blob, &s); err == nil {
    if s.Error == nil {
        // success
    } else {
        // error
    }
} else {
    // something went wrong
} 
```

# javascript - 覆盖/重写一个javascript库函数

> ID：12099471
> 
> 赞同：7
> 
> 时间：2012-08-23T20:28:16.697
> 
> 标签：javascript, inheritance, prototype

我正在使用开源 javascript 库[timeline.verite.co](http://timeline.verite.co) 这是一个时间线库，在页面加载时效果很好。但是当我尝试在某些条件下重新绘制时间线时，它开始发出奇怪的错误

我想修改库中的init函数。但是，我不想在原始库本身中更改它，而是想在另一个单独的 .js 文件中重写/覆盖此函数，以便在调用此函数时，它必须使用我修改后的函数，而不是转到原始函数。

我不确定是否使用原型/继承以及如何使用它来解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T20:35:31.613

您只需为其分配新值。这是一个例子：

```
obj = {
        myFunction : function() {
            alert('originalValue');
        }
    }

    obj.myFunction();
    obj.myFunction = function() {
        alert('newValue');
    }
    obj.myFunction(); 
```

# github-for-windows - 在 GitHub for Windows 中，为什么我在当前分支的历史记录中看不到我对当前分支的所有提交？

> ID：12099473
> 
> 赞同：0
> 
> 时间：2012-08-23T20:28:20.690
> 
> 标签：github-for-windows

我正在使用官方的 GitHub for Windows 客户端 (http://windows.github.com/)。我一直在稳定地对分支“建模用户”进行更改，但是我无法看到我最近在当前分支的历史记录中所做的许多更改。我可以通过在命令提示符下输入“git log”来查看这些提交。我还在 GitHub 网站上查看了这个分支的提交历史。它显示了相同的不完整提交历史。为什么它没有显示我所有的提交？

图片在这里：[http ://tinypic.com/r/maza7o/6](http://tinypic.com/r/maza7o/6)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T22:06:37.200

正如匿名用户[评论](https://stackoverflow.com/questions/12099473/in-github-for-windows-why-cant-i-see-all-of-my-commits-to-the-current-branch-i#comment16170622_12099473)的那样，适用于 Windows 的 GitHub 可能需要一些时间来反映对存储库的更新。提交最终将出现在 GitHub for Windows 中。

# html - 相同的标记和 css 在 ie8 不同的页面上看起来不同

> ID：12099479
> 
> 赞同：0
> 
> 时间：2012-08-23T20:28:51.423
> 
> 标签：html, css, wordpress, css-float

我必须构建一个 WordPress 主题作为个人项目。在 IE8 中对其进行测试后，页脚似乎并未在所有页面上显示正确的方式。这很奇怪，因为所有页面页脚都具有相同的样式。

我什至停用了 IE8 开发人员工具中的所有样式，但问题仍然存在。

在联系页面中，页脚似乎位于最左边的角落，使得只有一半的页脚可见。

在博客页面上，页脚似乎得到了 960 像素的宽度并且居中。

在其余页面上，页脚看起来不错。

正如我上面提到的，所有页脚页面都具有相同的样式，所以我不知道为什么在不同的页面上页脚的显示方式不同

这是网站： [网站](http://key4dd.netne.net/)

我发布了整个页脚标记和 CSS，因为我不知道哪种 CSS 错误会使 IE8 在不同页面上以不同方式显示相同的标记和 CSS：

html:

```
<footer>
    <div class="center">
          <?php if (!function_exists('dynamic_sidebar') || !dynamic_sidebar('Footer Sidebar') ) : ?>  
          <h2 class="widget-title">No Widgets added</h2>  
          <p>Please login and add some widgets to this sidebar</p>  
          <?php endif ?>     
     </div>
        <div id="copyright">
            <p>&copy; Copyright <?=date('Y');?> <?php bloginfo('name'); ?> by <a href="<?php echo AUTHOR_URL ?>"><?php echo AUTHOR ?></a> All Rights Reserved.</p>
        </div>
       <?php wp_footer(); ?>
</footer> 
```

CSS：

```
 footer{
        background:url(img/footer.png) repeat-x #1a1a1a;
        padding:33px 0;
    }
    footer div.center{
        overflow:hidden;
    }
    footer div.center div.boxFooter{
        display: inline-block;
        float:left;
        width:210px;
        margin-left: 40px;
    }
    footer div.center div.boxFooter:first-child{
        margin-left: 0;
    }
    footer div.center div h2{
        color:#cccccc;
        font-size: 20px;
        padding-bottom: 12px;
        border-bottom: 1px solid #ccc;
    }
    footer div.center div li{
        padding:10px 0;
        border-bottom:1px solid #b6b6b6;
    }footer div.center div li:last-child{
        border:none;
    }
    footer div.center div li a{
        text-decoration: none;
        color:#b6b6b6;
    }
    footer div.center div li a:hover{
        text-decoration: underline;
    }
    footer div.center div p{
        margin-top: 10px;
        text-align: justify;
        color:#b6b6b6;
    }
    footer form#searchform input{
        border-radius:5px;
        margin-top: 15px;
    }
    div#copyright{
        width:960px;
        margin:0 auto;
        border-top:1px solid #b6b6b6;
        margin-top:25px;
        color:#b6b6b6;
    }
    div#copyright p{
        margin-top:30px;
        text-align: center;
    }
    div#copyright p a{
        color:#1fa2e1;
        text-decoration: none;
    }
    div#copyright p a:hover{
        text-decoration:underline;
    }
    footer div.tagcloud{
        padding-top: 15px;

    }
    footer div.tagcloud a{
        color:#B6B6B6;
        text-decoration: none;
    }
    footer div.tagcloud a:hover{
        text-decoration: underline;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:35:31.777

我认为您应该在 style.css 文件的顶部包含重置 CSS：

[重置 CSS](http://meyerweb.com/eric/tools/css/reset/)

此外[，网站需要在每个浏览器中看起来完全相同](http://dowebsitesneedtolookexactlythesameineverybrowser.com/)。

# r - 如何确保 R / Rcpp 代码可重现（“可分发”）？

> ID：12099481
> 
> 赞同：6
> 
> 时间：2012-08-23T20:28:54.590
> 
> 标签：r, rcpp, future-proof

我已经为一篇论文写了一些 R 代码，依赖于一些外部包（例如`plyr`and ）并使用and`reshape`编写了几个相对简单的内联 C++ 函数。`inline``RcppArmadillo`

为了研究可重复性的目的，我想确保它可以在我自己的计算机（Win64）以外的计算机上“按原样”执行。

我的问题：假设我包含了用于安装所需软件包的代码，`RcppArmadillo`（和`Rcpp`和`inline`）软件包是否足以编译用 编写的函数`RcppArmadillo`，或者最终用户是否需要更改系统路径以在他的 Windows 机器上进行编译？如果没有，是否有可能/建议从我端保存已编译的函数并包含在我要运送的 R 代码中？

此外，在不太可能的情况下，代码应该在一段时间后（比如几年）运行，是否足以在当前版本中包含完整的 R 安装和相关软件包以使代码“面向未来” ?

我希望这个问题很清楚。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T20:34:17.083

我认为您的意思是您的代码是“可分发的”和“可由其他人执行的”，这是一个更宽松的要求。“可重现”意味着前面的问题是正确的，并增加了结果相同的限制（直到您选择的 epsilon）。

对于“我怎样才能让其他人运行我的 R 代码”的通常答案是创建一个包。

对于与 Rcpp 相关的代码，我们有一个完整的小插图专门用于使用您的 Rcpp 使用 cod 构建您自己的包。小插图称为“Rcpp-package”。

# asp.net-mvc - ASP 成员表 -> 向用户添加新属性？

> ID：12099482
> 
> 赞同：0
> 
> 时间：2012-08-23T20:28:56.017
> 
> 标签：asp.net-mvc, asp.net-membership

我想在我正在构建的新 MVC4 项目中开始使用 ASP.NET 的成员资格类和表。

例如，假设我想跟踪用户的生日。创建帐户时，如何添加生日？这是我通过个人资料跟踪的吗？我对为用户添加新的数据“列”的正确方法有点困惑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:15:36.870

为了具体回答您的问题，以下是 Microsoft 建议创建额外表以存储其他用户信息的方式：[存储其他用户信息](http://www.asp.net/web-forms/tutorials/security/membership/storing-additional-user-information-cs)

这是另一个帖子（我会采用这种方法），它实现了您自己的配置文件提供程序，而不是使用默认的，因此您可以完全控制正在发生的事情、它的存储方式等：[在 ASP.NET MVC 中实现配置文件提供程序](https://stackoverflow.com/questions/79129/implementing-profile-provider-in-asp-net-mvc) 另一个微软关于相同的伟大文章是[使用自定义配置文件提供程序管理 Web 用户](http://msdn.microsoft.com/en-us/magazine/cc163457.aspx)

这完全取决于实用性和用途。你可以

1.  使用默认配置文件提供程序（锻炼）
2.  使用自定义配置文件提供程序（小型站点）
3.  使用您自己的表来存储用户信息（企业级）。

在后一种情况下，您可以通过在表中包含 user.Guid 来链接默认成员资格（假设您使用默认成员资格提供程序）和您的自定义个人资料信息，默认情况下将成员资格用作唯一标识符。

希望这些信息对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:34:38.107

Profiles 是正确的方法，尽管它有它的缺点。数据库中的数据不是可读的，而是特殊的字符串，每次回发时都会加载配置文件。

看这里： http: [//msdn.microsoft.com/en-us/library/z1hkazw7 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/z1hkazw7(v=vs.100).aspx)

# android - 有电话号码的联系人的意图

> ID：12099492
> 
> 赞同：5
> 
> 时间：2012-08-23T20:29:22.573
> 
> 标签：android, android-intent, contacts, android-contacts

请问，是否可以使用意图和默认联系人应用程序仅从带有电话号码的联系人中进行选择？

也许对此进行一些修改（显示所有联系人的选择）：

```
Intent intent = new Intent(Intent.ACTION_PICK, ContactsContract.Contacts.CONTENT_URI);
startActivityForResult(intent, CONTACT_PICKER_ID); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T13:43:23.877

```
Intent intent = new Intent(Intent.ACTION_PICK, Contacts.CONTENT_URI);
intent.setType(ContactsContract.CommonDataKinds.Phone.CONTENT_TYPE);
startActivityForResult(intent, 1); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T20:37:44.920

您可以在联系人上打开光标并运行通过电话号码获取联系人。您可以使用此光标重新创建从您提到的意图中显示的联系人选择器活动（将它们扔到列表视图中进行选择）

```
 ContentResolver cr = getContentResolver();
        Cursor phoneCur = cr.query( 
                ContactsContract.CommonDataKinds.Phone.CONTENT_URI, 
                null,
                null, 
                null, 
                null); 
        while (phoneCur.moveToNext()) { 
            String phone = phoneCur.getString(
                      phoneCur.getColumnIndex(
                              ContactsContract.CommonDataKinds.Phone.DATA));
            //do something, check if empty...
        } 
        phoneCur.close(); 
```

使用这种方法，您还需要清单中的读取联系人权限

```
<uses-permission android:name="android.permission.READ_CONTACTS"/> 
```

# sas - 有没有办法根据组内的值来命名 proc 等级组？

> ID：12099494
> 
> 赞同：0
> 
> 时间：2012-08-23T20:29:32.350
> 
> 标签：sas, rank, proc

所以我有多个连续变量，我曾经`proc rank`将它们分成 10 个组，即对于每个观察，现在有一个`"GPA"`和一个`"GRP_GPA"`值，Hmwrk_Hrs 和 GRP_Hmwrk_Hrs 也是如此。但是对于每个新的组列，值都在 1 - 10 之间。有没有办法改变这个值，例如，如果这些是组内的最小值和最大值，而不是 1，它将是 1.2-2.8？我知道我可以使用 proc 格式或 if then 或 case in sql 手动完成，但因为我有 40 个不同的列，这将非常耗时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T08:28:53.710

从您的问题中不清楚您是想存储最小值-最大值还是只是用它们格式化排名列。我下面的解决方案对排名列进行格式化，并利用 SAS 从数据集创建格式的能力。我显然只使用了 1 个变量进行排名，对于您的数据，将宏包装在代码周围并为您的 40 个左右变量中的每一个运行将是一件简单的事情。希望这可以帮助。

```
/* create ranked dataset */
proc rank data=sashelp.steel groups=10 out=want;
var steel;
ranks steel_rank;
run;

/* calculate minimum and maximum values per rank */
proc summary data=want nway;
class steel_rank;
var steel;
output out=want_min_max (drop=_:) min= max= / autoname;
run;

/* create dataset with formatted values */
data steel_rank_fmt;
set want_min_max (rename=(steel_rank=start));
retain fmtname 'stl_fmt' type 'N';
label=catx('-',steel_min,steel_max);
run;

/* create format from previous dataset */
proc format cntlin=steel_rank_fmt;
run;

/* apply formatted value to rank column */
proc datasets lib=work nodetails nolist;
modify want;
format steel_rank stl_fmt10.;
quit; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T11:16:45.167

除了基思的好答案，您还可以执行以下操作：

```
proc rank data = sashelp.cars groups = 10 out = test;
var enginesize;
ranks es;
run;

proc sql ;
 select *, catx('-',min(enginesize), max(enginesize)) as esrange, es from test
 group by es
 order by make, model
;
quit; 
```

# perl - Perl 程序跳过 csv 文件中的第一行

> ID：12099501
> 
> 赞同：0
> 
> 时间：2012-08-23T20:30:01.700
> 
> 标签：perl

我试图了解 PERL 程序的错误。我有一个逗号分隔的文件，我想将每行的内容提取到一个单独的文本文件中，使用每行中第一个字段的内容作为文件名。

下面的程序正是这样做的，除了它跳过了 csv 文件的第一行。我试图通过添加几个打印命令来确定错误的来源。第 22 行的打印命令显示第一行是由第 21 行的命令读取的。但是，一旦 foreach 循环开始，第一行就不会打印。

我不太确定这个问题。我很感激任何帮助！

```
#!/usr/bin/perl
# script that takes a .csv file (such as that exported from Excel) and 
# extracts the contents of each row into a separate text file, using the first column as the filename
# original source: http://www.tek-tips.com/viewthread.cfm?qid=1516940
# modified 3/14/12
# usage = ./export_rows.pl <yourfilename>.csv

use warnings;
use strict;
use Text::CSV_XS;
use Tie::Handle::CSV;

unless(@ARGV) {
    print "Please supply a .csv file at the command line! For example, export_rows.pl myfile.csv\n";
    exit;
}

my $fh = Tie::Handle::CSV->new(file => $ARGV[0],
                           header => 0);

my @headers = @{scalar <$fh>};
print "$headers[0]\n\n";

foreach my $csv_line (<$fh>) {
    print "$csv_line->[0]\n";
    open OUT, "> $csv_line->[0].txt" or die "Could not open file $csv_line->[0].txt for output.\n$!";
    for my $i (1..$#headers) {
         print OUT "$csv_line->[$i]\n";
    }
    close OUT;
 }

 close $fh; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T20:37:24.337

尝试在 for 循环中从 0 开始：

```
for my $i (1..$#headers) 
```

应该：

```
for my $i (0..$#headers) 
```

**编辑：**

要获取文件的第一行，您可以使用[Tie::File](http://perldoc.perl.org/Tie/File.html)

这是示例代码：

```
my @arr;
tie @arr, 'Tie::File', 'a.txt' or die $!;
my $first = $arr[0];
untie @arr;

print "$first\n"; 
```

这个模块很酷，因为它允许您通过访问数组中的索引来访问文件的行。如果你的文件很大，它的效率不是很高，但我认为你绝对可以在这里使用它。

# python - 在python中查找字典

> ID：12099503
> 
> 赞同：1
> 
> 时间：2012-08-23T20:30:19.427
> 
> 标签：python

所以我有一个看起来像这样的多行文件（空格分隔符文件）：

```
A1BG      P04217     VAR_018369  p.His52Arg     Polymorphism  rs893184    -
A1BG      P04217     VAR_018370  p.His395Arg    Polymorphism  rs2241788   -
AAAS      Q9NRG9     VAR_012804  p.Gln15Lys     Disease       -           Achalasia 
```

如何制作字典以在第二列中查找 id 并将数字（单词之间）存储在第四列。

我试过了，但它给了我超出范围的索引

```
lookup = defaultdict(list)
with open ('humsavar.txt', 'r') as humsavarTxt:
    for line in csv.reader(humsavarTxt):
        code = re.match('[a-z](\d+)[a-z]', line[1], re.I)
        if code: 
            lookup[line[-2]].append(code.group(1))

print lookup['P04217'] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:17:25.627

这是原始代码的变体：

```
import csv, re
from collections import defaultdict

lookup = defaultdict(list)
with open('humsavar.txt', 'rb') as humsavarTxt:
    reader = csv.reader(humsavarTxt, delimiter=" ", skipinitialspace=True)
    for line in reader:
        code = re.search(r'(\d+)', line[3])
        lookup[line[1]].append(int(code.group(1))) 
```

产生

```
>>> lookup
defaultdict(<type 'list'>, {'P04217': [52, 395], 'Q9NRG9': [15]})
>>> lookup['P04217']
[52, 395] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:33:39.780

如果 id 和数字总是在第二列和第四列，并且总是用空格分隔，则不需要使用正则表达式。您可以改为拆分空格：

```
lookup = defaultdict(list)
with open ('humsavar.txt', 'r') as humsavarTxt:
    for line in humsavarTxt:
         lookup[line.split(' ')[1]].append(line.split(' ')[3]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T23:48:48.053

如果您想要一个纯字典，则可以使用：

```
d={}
with open(your_file,'rb') as f:
    for line in f:
        l=line.split()
        num=int(re.search(r'(\d+)',l[3]).group(1))
        d.setdefault(l[1],[]).append(num) 
```

印刷：

```
{'P04217': [52, 395], 'Q9NRG9': [15]} 
```

对于非正则表达式解决方案，您也可以这样做：

```
d={}
with open(your_file,'rb') as f:
    for line in f:
        els=line.split()
        num=int(''.join(c for c in els[3] if c.isdigit()))
        d.setdefault(els[1],[]).append(num) 
```

# ruby-on-rails - Factory_girl：一个属性的定义依赖于另一个

> ID：12099504
> 
> 赞同：0
> 
> 时间：2012-08-23T20:30:19.520
> 
> 标签：ruby-on-rails, ruby-on-rails-3, factory-bot

如何建立一个属性依赖于另一个属性的工厂？

```
 factory :event do
    sequence(:title) { |n| "Event #{n}" }
    sequence(:description) { |n| "More detailed info about event #{n}" }
    start_at { rand(1..100).days.from_now }
    end_at { start_at + rand(1..5).hours }   # <=== referencing start_at
  end 
```

使用它给出了`NameError: uninitialized constant Event`我的规格，我假设它是因为试图设置`end_at`一个取决于`start_at`. 这个怎么做？试图实例化几十个有效的“事件”。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:13:59.040

我认为你想要做的是这样的：

```
factory :event do
  title 'foo'
  description "bar"
  other_attributes "baz"

  factory :dynamic_event do
    sequence(:title) { |n| "Event #{n}" }
  end

end 
```

`:dynamic_event`工厂将从事件工厂继承所有属性，但会覆盖在其块中给出的那些。（本`title`例中的顺序）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:54:38.767

由于您的工厂块内部出现问题，因此不会发生错误。事件类未正确定义。

你能展示你的事件模型吗？

也许它嵌套在一个模块中？然后你可以这样做：

```
factory :event, :class => 'ModuleName::Event' do
  ...
end 
```

# fluent-assertions - 如何测试 XELement 及其子元素？

> ID：12099510
> 
> 赞同：0
> 
> 时间：2012-08-23T20:30:59.347
> 
> 标签：fluent-assertions

我有一个示例 Xml 代码片段

```
<modification name="givenName" operation="add" xmlns="urn:oasis:names:tc:DSML:2:0:core">
    <value>Changed name</value>
</modification> 
```

xml 被加载到我的 XElement 中，我使用了

```
 XElement xml = ...to load xml above...;
        xml.Should().HaveAttribute("name", "givenName")
            .And.HaveAttribute("operation", "add")
            .And.HaveAttribute("xmlns", "urn:oasis:names:tc:DSML:2:0:core")
            .And.HaveElement("value"); 
```

测试我的代码，属性测试都通过了，但是元素测试（最后一个条件）失败了。

任何人都可以指出我的代码有什么问题？

我如何测试 Xml 有一个名为“value”的元素，它的值是“Changed name”？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:37:58.970

我怀疑问题在于`XName`元素的不只是`value`- 它`value` *带有命名空间*。大概`HaveElement`是命名空间感知的。试试这个：

```
XElement xml = ...to load xml above...;
XNamespace ns = "urn:oasis:names:tc:DSML:2:0:core";
xml.Should().HaveAttribute("name", "givenName")
    .And.HaveAttribute("operation", "add")
    .And.HaveAttribute("xmlns", "urn:oasis:names:tc:DSML:2:0:core")
    .And.HaveElement(ns + "value"); 
```

最后一行检查它是否有*命名空间限定的*元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T15:12:41.980

它将成为 Fluent Assertions 2.1 的一部分。如果你等不及，你可以通过 Git 存储库获得它

# expressionengine - 表达式引擎 - 如何在类别存档列表中显示外部链接？

> ID：12099511
> 
> 赞同：0
> 
> 时间：2012-08-23T20:31:01.730
> 
> 标签：expressionengine

我有一系列条目需要作为类别存档的一部分显示。

我是这样编写代码的：

```
{exp:channel:category_archive channel="botanical_gardens" style="linear"}
    {categories}
        <h3>{category_name}</h3>
        {if category_description}
            <p>{category_description}</p>
        {/if}
    {/categories}
    {entry_titles}
        <a href="{garden_url}">{title}</a><br />
    {/entry_titles}
{/exp:channel:category_archive} 
```

这适用于与站点 URL 相关联的 URL 的例外。由于这些条目中的每一个都链接到外部站点，我如何编写代码来获取正确的 URL？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:52:43.233

自定义字段不能显示在分类存档标签中。相反，您必须使用 Channel Categories 标签，并在其中放置 Channel Entries 标签。

```
{exp:channel:categories channel="botanical_gardens" style="linear" disable="category_fields"}
     <h3>{category_name}</h3>
     {if category_description}
         <p>{category_description}</p>
     {/if}
    {exp:channel:entries channel="botanical_gardens" category="{category_id}" disable="member_data|pagination|categories"}
        <a href="{garden_url}">{title}</a><br />
    {/exp:channel:entries}
{/exp:channel:categories} 
```

# php - PHP 应该在所有面向对象的代码中使用 SplFileObject

> ID：12099514
> 
> 赞同：2
> 
> 时间：2012-08-23T20:31:18.000
> 
> 标签：php

在 php 中写入文件时，在 OOP 样式编码时是否应该使用 SplFileObject？以及用于程序样式的普通文件句柄。

或者，每个实际上都适合不同的目的而不是代码风格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:40:28.833

好吧，SPLFileObject 在处理二进制文件时用处不大，因此无论您的编码风格是程序式还是 OOP，读取 Excel 工作簿或图像文件都没有多大用处。对于这样的事情，我会坚持使用 PHP 的标准文件函数。

它对于处理任何类型的文本文件很有用，它提供了许多有用的功能来使文件易于迭代（遗憾的是它不能处理 prev 和 next），无论您的编码风格是程序式还是 OOP，都值得使用。

所以基本上，在最合适的时候使用它并提供你需要的功能，而不仅仅是为了适应你的编码风格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:40:44.727

PHP 中的所有 SPL 类都旨在提供额外的功能或易用性，超出了普通语言函数绑定所提供的功能。如果您想严格遵守在 OOP 模型中使用它，这是个人选择，反之亦然。

换句话说，我认为（这是我个人的观点）编写 OOP 代码是非常好的，我使用 PHP 中的 array_* 函数来处理我的数组，而不必依赖 Array_Object 或迭代器，如果它适合我​​的目的当时。这同样适用于任何其他 SPL 类。

# java - 设置 Java DNS 缓存 TTL

> ID：12099526
> 
> 赞同：5
> 
> 时间：2012-08-23T20:31:53.183
> 
> 标签：java, dns

我正在尝试更改 Java 1.6 中的 DNS 缓存超时。我[在这里](http://javaeesupportpatterns.blogspot.co.uk/2011/03/java-dns-cache-reference-guide.html)看到使用类似以下内容的讨论：

```
java.security.Security.setProperty ("networkaddress.cache.ttl" , TTL_SECS); 
```

但我已经在 Win 7 中尝试过这个简单的测试......

```
System.out.println("DEFAULT DNS TTL: "+sun.net.InetAddressCachePolicy.get());
java.security.Security.setProperty ("networkaddress.cache.ttl" , "123");    
System.out.println("DEFAULT DNS TTL: "+sun.net.InetAddressCachePolicy.get()); 
```

...并且输出不会改变。似乎这可以在 Java 安装的安全属性中进行更改，但我更愿意将其保留在代码中以保持整洁。任何想法如何实现这一目标？

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-11T10:34:39.447

试试这个，看看你得到的输出。加载类时需要设置该属性。

```
static {
    java.security.Security.setProperty ("networkaddress.cache.ttl" , "12");    
}
public static void main(String[] args) {
    System.out.println("DEFAULT DNS TTL: "+sun.net.InetAddressCachePolicy.get());
    java.security.Security.setProperty ("networkaddress.cache.ttl" , "123");    
    System.out.println("DEFAULT DNS TTL: "+sun.net.InetAddressCachePolicy.get());
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T05:15:28.357

这些不是系统属性：它们是在 java.security 文件中设置的。有关非首选的相应系统属性，请参阅[网络属性](http://docs.oracle.com/javase/6/docs/technotes/guides/net/properties.html)中的“Sun implementation-specific properties” 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-16T10:30:19.900

在 Android 4.0 (Ice Cream Sandwich) 及更早版本中，DNS 缓存由 InetAddress 和 C 库执行，这意味着 DNS TTL 无法正确处理。在以后的版本中，缓存仅由 C 库完成，并且支持 DNS TTL。

[谷歌描述](https://developer.android.com/reference/java/net/InetAddress.html)

# .net - 如何使用正确的剪辑和偏移可靠地调用 Control.InvokePaint？

> ID：12099534
> 
> 赞同：2
> 
> 时间：2012-08-23T20:32:29.657
> 
> 标签：.net, winforms, gdi, paint, clipping

我试图强制绘制由具有更高 z 顺序的其他控件引起的控件的隐藏区域，这些控件属于公共父控件的同一 ControlCollection。这个想法是，对于两个重叠的控件，在绘制两个控件中较高的控件时，它会在较低的控件上调用自己的 InvokePaint 和 InvokePaintBackground 方法，同时传入自己的图形，为相交的绘制操作做好准备。

*要求澄清问题：*更一般地说，我试图根据第二个控件与第一个控件的重叠方式将一个控件的子集绘制到另一个控件的图形表面。

![问题的可视化，从左到右，从上到下](../Images/dfb2cfeb20fe8af11a7168e2b5042139.png)

我似乎找不到将绘制我感兴趣的区域的变换和剪切区域的排列。我怀疑问题出在 VisibleClippingBounds 似乎在内部引用原始大小或进行一些无法访问的调用以建立可见性并声明基础区域hidden 因此不需要绘制，将 VisibleClipBounds 折叠成一个边长为零的矩形。

这是我觉得应该可以正常工作的代码，但不能：

```
Dim translation As Point = Control.RelationTo(Me)
Dim intersectionClip As New Region(Control.RelativeClientRectangle(Me))
intersectionClip.Intersect(siblingClip)
pevent.Graphics.Transform = New Drawing2D.Matrix(1, 0, 0, 1, translation.X, translation.Y)
pevent.Graphics.Clip = intersectionClip

InvokePaintBackground(Control, pevent)
InvokePaint(Control, pevent) 'controlPaintEventArgs) 
```

理论：

1）建立下级控制（Control）到这个控制（Me）的相对位置。该点表示一个向量，该向量在此控件上的 (0, 0) 处开始，在下控件上的 (0, 0) 处结束，给出相对位置。

```
 Dim translation As Point = Control.RelationTo(Me) 
```

2) 从该控件坐标系中下控件矩形的一个区域开始。返回的矩形位于从 RelationTo 调用返回的点处，并且具有下部控件的大小。

```
Dim intersectionClip As New Region(Control.RelativeClientRectangle(Me)) 
```

3) 将该区域与当时已知的底层控件总面积的预先建立的区域相交，以在该控件的坐标中找到该控件的相关绘图区域。

```
intersectionClip.Intersect(siblingClip) 
```

4) 在相对控制偏移的方向上对图形对象应用平移变换。

```
pevent.Graphics.Transform = New Drawing2D.Matrix(1, 0, 0, 1, translation.X, translation.Y) 
```

5）应用之前建立的剪辑区域，重要的是在设置变换之后，以确保在变换变换时它不会被修改。

```
pevent.Graphics.Clip = intersectionClip 
```

6) 使用此控件的 PaintEventArgs 对象在下部控件上引发绘制事件，其中保存的 Graphics 已准备好进行绘制。

```
InvokePaintBackground(Control, pevent)
InvokePaint(Control, pevent) 'controlPaintEventArgs) 
```

结果是一个黑色的空洞，没有任何东西被绘制，暗示 VisibleClipBounds 已经塌陷到零区域。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T03:16:53.683

似乎解决方案是更仔细地查看事件序列并更密切地关注变换对象的设置和重置。

在序列方面，这个策略是完美的，除了在变换之前设置剪辑是解决方案，只要初始变换是正确的。

该解决方案的应用与此论坛上的另一个问题有关，并附有一些上下文的答案：[创建透明控件的一般解决方案是什么？](https://stackoverflow.com/questions/11971267/what-is-a-general-solution-to-creating-a-transparent-control).

# javascript - mediaelement.js 视频无法在 IE8 中播放

> ID：12099535
> 
> 赞同：3
> 
> 时间：2012-08-23T20:32:35.363
> 
> 标签：javascript, jquery, html, internet-explorer-8, mediaelement.js

我已经浏览了这里提出的所有其他问题，但没有什么能真正解决我的问题。

目前视频将在 Chrome、Safari、FF 和 IE9 中加载和播放，但不是 IE8，这是我需要支持的最后一个浏览器。[您可以在此处](http://2013.gradientsummit.com)查看该页面。

我一直在尝试使用 Debug 选项，但也没有得到任何帮助。这是调试器告诉我的：

```
Initializing...
stage: 0x560
file: path/to/video.mp4
autoplay:true
preload:true
isvideo:true
smoothing:false
timerrate:250
displayState:true
ExternalInterface.available:true
ExternalInterface.objectID: me_flash_0
Adding callbacks...
Success...
METADATA RECEIVED:900x560
positioning video
seek:0
play 
```

这是我的代码：

```
<video id="player1" width="900" height="560" loop="true" autoplay="true" preload="none" >
  <source type="video/mp4" src="<?php echo get_template_directory_uri(); ?>/images/curtainLoop.mp4" />
  <source type="video/webm" src="<?php echo get_template_directory_uri(); ?>/images/curtainLoop.webm" />
    <object width="900" height="560" type="application/x-shockwave-flash" data="<?php echo get_template_directory_uri(); ?>/js/flashmediaelement.swf"> 
        <param name="movie" value="<?php echo get_template_directory_uri(); ?>/js/flashmediaelement.swf" /> 
        <param name="flashvars" value="autoplay=true&amp;controls=true&amp;file=<?php echo get_template_directory_uri(); ?>/images/echo-hereweare.mp4" />                       
    </object></video>

<span id="player1-mode"></span>
 <script>
    jQuery(document).ready(function($) {
    var player = new MediaElementPlayer('#player1', {
        enablePluginDebug: true,
        enableAutosize: true,
        success: function(media, node, player) {  
            $('#' + node.id + '-mode').html('mode: ' + player.pluginType);  
        }  
        });
    });
</script> 
```

在 MediaElement 网站之后，我添加了跨度以输出模式，该模式返回为“未定义”而不是“本机”或“闪存”。不确定这是否是问题所在，但此时我只是不知道在哪里寻找。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T20:57:55.390

我以前遇到过这个问题，花了一段时间才找出导致它的原因。我已经对此进行了测试，它似乎也适用于您的情况：

在 MediaElement 创建的 .me-plugin div 上，`position: absolute;`CSS 中有一个引用。当我将它设置为`position:static;`All 时，在 IE8 中运行良好。

我通常最终会这样做：

```
.ie8 .me-plugin { position: static; } 
```

# c# - 使用带有 htmlagilitypack 的代理

> ID：12099538
> 
> 赞同：1
> 
> 时间：2012-08-23T20:32:44.773
> 
> 标签：c#, html-agility-pack

我搜索了这个问题，但没有找到任何我想要的东西，基本上我想使用带有 htmlagilitypack 的代理，我之前有代码可以做到但丢失了，这是我到目前为止的代码，它正在工作. 但是我在我正在制作的程序上让自己超时，需要启用代理。

```
 private void button1_Click(object sender, EventArgs e)
    {
        StringBuilder output = new StringBuilder();
        string raw = "http://www.google.com";
        HtmlWeb webGet = new HtmlWeb();
        webGet.UserAgent = "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2) Gecko/20100115 Firefox/3.6";
        var document = webGet.Load(raw);

    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-12-01T00:08:27.450

在我们的公司设置中，将其添加到 app.config 对我来说有效，无需任何代码更改

```
<system.net>
   <defaultProxy useDefaultCredentials="true" />
</system.net> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T20:40:54.993

`HtmlWeb.Load()`使用使用代理的重载。有两个重载签名：

```
HtmlDocument Load(string url, string method, WebProxy proxy, NetworkCredential credentials);
HtmlDocument Load(string url, string proxyHost, int proxyPort, string userId, string password); 
```

我没有在我的代码中使用代理的任何第一手经验，但我希望这能奏效。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-23T20:38:24.047

HtmlAgilityPack 不会从 url 下载数据。使用类下载支持Proxy的页面。

例如

```
WebClient wc = new WebClient();
wc.Proxy = new WebProxy(host,port);
var page = wc.DownloadString(url);

HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
doc.LoadHtml(page); 
```

**编辑**

假设您`11.22.33.44:5678` 从文本文件中读取类似的内容，也可以将代理创建为

```
wc.Proxy = new WebProxy("11.22.33.44:5678"); 
```

# python - Selenium 无法在 Internet Explorer 9 中切换到 TinyMCE iframe

> ID：12099541
> 
> 赞同：2
> 
> 时间：2012-08-23T20:32:51.313
> 
> 标签：python, internet-explorer-9, tinymce, selenium-webdriver

我正在尝试在 IE9 中切换到 iframe，以便可以`send_keys()`切换到文本区域。当我切换时，我可以告诉 webdriver 认为它已切换（当我 print 时`page_source`，它是正确的）但光标仍在另一个文本字段（不是 TinyMCE）上闪烁，此时，如果我发送键，键会附加到另一个文本字段，而不是 TinyMCE。

所以我一直在尝试解决方法，如果我选择 tinyMCE iframe 和`click()`，光标在正确的位置，我可以发送密钥但我无法返回（切换回原始框架/窗口）提交输入.

有没有其他人在 IE9 中遇到过这个问题，有解决方法吗？

这适用于 Firefox 和 Chrome，但不适用于 IE9。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T20:55:23.780

我曾经遇到过这样的问题，由于 TinyMCE 会生成一些动态内容，因此解决它非常复杂。我最终操作 TinyMCE 编辑器的内容是通过直接调用 API `page.execute_script`并在 JavaScript 上完成所有操作。

我的 JS 代码示例是：

```
 jQuery('textarea.tinymce').tinymce().setContent('test text in editor');   
    jQuery('textarea.tinymce').tinymce().selection.select(jQuery('textarea.tinymce').tinymce().dom.select('p')[0]);
    jQuery('textarea.tinymce').tinymce().execCommand('Italic','true');
    jQuery('textarea.tinymce').tinymce().execCommand('Underline','true');  
    jQuery('textarea.tinymce').tinymce().execCommand('Bold','true'); 
```

第一行在 TinyMCE 的 textarea 中添加文本，第二行选择它（模拟用户光标选择），第三、第四和第五行只是操作控件。

`.execCommand()`对于激活不同的扩展特别有用。之后，我只是验证了我使用的表单字段设置了预期的 HTML 标记，并称之为一天。

我希望它有帮助！

# integration - BizTalk 是正确的解决方案吗？

> ID：12099553
> 
> 赞同：0
> 
> 时间：2012-08-23T20:33:46.817
> 
> 标签：integration, biztalk

我们有大约六个系统（它们都是内部系统）需要在它们之间发送数据。目前我们没有一致的方法来做到这一点。我们使用 SSIS、SQL Server 链接服务器直接更新数据库，ODBC 连接直接更新数据库、文本文件等。

我们的目标是：

> 1) 有一致的方式连接应用程序。
> 2) 有一个集中的方式来监控和记录应用程序之间的连接。
> 3) 对于提供 Web 服务的应用程序，我们希望开始使用它们，而不是直接与数据库连接。

无论我们使用什么，都需要能够连接到 Web 服务、数据库、平面文件，并且还应该能够通过 tcp 连接接受数据。

Biztalk 是一个很好的解决方案，还是矫枉过正？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:15:28.460

这真的取决于。对于您所描述的架构，它似乎很合适。但是，您需要验证 biztalk 是否可以与您尝试集成的系统进行通信。例如; 当这些系统使用 web 服务、消息队列或基于文件的通信时，这可能是一个很好的选择。

当您开始使用 biztalk 时，您必须愿意投资硬件、软件，尤其是学习使用它。

关于您的观点：1）是的，如果您确保正确封装系统连接器 2）是的，biztalk 通过 BAM 支持这一点 3）是的，这将完美匹配

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T05:07:14.433

根据您所描述的（6 个系统），现在绝对是研究更正式的集成方法的好时机，因为您毫无疑问地发现，点对点/直接集成方法将导致大量随着每个新系统的添加，排列/意大利面。

BizTalk 支持[中心辐射型和总线型拓扑](http://en.wikipedia.org/wiki/Enterprise_application_integration#Topologies)（使用 ESB 工具包），其中任何一种都将减少系统之间的互连数量。

添加到 oɔɯǝɹ：

1.  是的 - 最终 BizTalk 在内部将所有内容都转换为 XML，您将使用可视映射或 xslt 在消息类型之间进行转换。
2.  是的。开箱即用有很多 WMI 和 Perfmon 计数器可供您使用，此外 BizTalk 有一个 SCOM 管理包来监控 BizTalk 的运行状况。对于您的应用程序，BAM（用于简单监控的 TPE，但可以使用 BAM API 完成更高级的工作）。
3.  是 - BizTalk 支持所有常见的 WCF 绑定类型和基本的 SOAP Web 服务。BizTalk 的消息框可以用作发布/子引擎，它可以让您在稍后阶段将其他进程“挂钩”到消息中。

一些警告：

. BizTalk 应该用于消息（例如整个组织的电子文档），但不能用于批量数据同步。对于真正的大数据传输/数据迁移/数据同步模式，SSIS 是一个更好的选择。

. 正如 David 所指出的，BizTalk 的学习曲线很陡峭，而且该工具本身不是免费的（需要 SQL 和 BizTalk 许可证，通常您还需要使用像 SCOM 这样的监控工具。）。要快速跟踪这一点，您需要派遣开发人员进行 BizTalk 培训，或聘请 BizTalk 顾问。

. 微软似乎专注于[Azure Service Bus](http://msdn.microsoft.com/en-us/library/windowsazure/ee732537.aspx)，并且有人[猜测](http://www.infoq.com/news/2012/08/Service-Bus)BizTalk 将在未来某个时候合并到 Azure Service Bus。如果您的企业战略不完全是 Microsoft，您可能还需要考虑用于 ESB 的NServiceBus 和[FUSE等产品。](http://fusesource.com/open_source/enterprise-service-bus/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T15:03:00.813

你的问题是典型的企业问题。多年来，公司开始构建独立的应用程序，如人力资源、网络、供应链、库存、客户管理等，一旦达到一定程度，这些应用程序就不能单独存在，他们需要相互交谈，通常他们会启动一些黑客解决方案比如数据库级别的数据迁移。

但很快他们就意识到没有清晰的可见性、管理不善、没有标准等问题，他们创造了一个真正的意大利面条。最大的威胁是应用程序将变得相互依赖，您将失去更改任何内容的敏捷性。对系统的任何更改都需要大量测试和较长的发布周期。

这是像 BizTalk Server 这样的中间件平台将为您解决的问题。线程中的很多回复都集中在 BizTalk 服务器的成本上（其中一些提到的成本是不正确的 BTW）。它不是一个便宜的产品，但如果你把它作为一个将所有应用程序连接在一起的中央中间件平台在你的组织中所扮演的角色以及你开箱即用的非功能性好处的数量，比如大多数第三方产品的适配器像 SAP、Oracle、FTP、FILE、Web 服务等，轻松扩展平台的能力、性能、长期运行的工作流程、持久性、长期运行的工作流程的补偿逻辑、限制您的环境等，很快成本因素就会减少。

我的建议是看看 BizTalk，如果您是新手，请与当地的 Microsoft 办公室联系。他们可以帮助或推荐一个可以来分析您的情况的合作伙伴。

# javascript - 拖动 div 时，将另一个 div 与拖动的 div 一起移动

> ID：12099554
> 
> 赞同：4
> 
> 时间：2012-08-23T20:33:52.413
> 
> 标签：javascript, jquery, css, jquery-ui, jquery-ui-draggable

两个 div 存在于不同的容器中。我想在**container2**中拖动**div2时移动****div1**中的**container1**。（div1 和 div2 的 'left' 属性应始终保持不变）

 ******我可以通过应用“**可拖动**”功能单独拖动它们中的每一个。我还可以通过在调用“可拖动停止”函数时将**div1**的**left**属性分配给**div2的****left**属性来移动**div2**而电影**div1 。**但这仅在拖动事件完成后才会发生。

 ******有没有办法让 div2 在拖动 div1 时始终与 div1 一起移动？

**请参阅 JSFiddle 链接以了解我想要做什么：http:** [//jsfiddle.net/37Wkd/16/](http://jsfiddle.net/37Wkd/16/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T20:38:28.150

```
$('#block1').draggable({
    axis: 'x',
    containment: '#container1',
    drag: function(){
        $('#block2').css('left',$(this).position().left);  
    }

});​ 
```

这不行吗？使用`drag`事件：http: [//jqueryui.com/demos/draggable/](http://jqueryui.com/demos/draggable/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:38:38.993

尝试这个：

[http://jsfiddle.net/37Wkd/17/](http://jsfiddle.net/37Wkd/17/)************

# php - 如何在页面上的所有链接标签之间抓取内容，例如SCRAPE THIS？

> ID：12099556
> 
> 赞同：-3
> 
> 时间：2012-08-23T20:33:56.570
> 
> 标签：php, xpath, screen-scraping

我正在尝试抓取网站的链接文本，即 SCRAPE THIS。我想对页面上的所有链接执行此操作。到目前为止，我有这个：

```
<?php

$target_url = "SITE I WANT TO SCRAPE";

// make the cURL request to $target_url
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,$target_url);
curl_setopt($ch, CURLOPT_FAILONERROR, true);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_AUTOREFERER, true);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,true);
curl_setopt($ch, CURLOPT_TIMEOUT, 10);
$html= curl_exec($ch);
if (!$html) {
    echo "<br />cURL error number:" .curl_errno($ch);
    echo "<br />cURL error:" . curl_error($ch);
    exit;
}

// parse the html into a DOMDocument
$dom = new DOMDocument();
@$dom->loadHTML($html);

// grab all the on the page
$xpath = new DOMXPath($dom);
$hrefs = $xpath->evaluate("/html/body//a/text()");

for ($i = 0; $i < $hrefs->length; $i++) {
    $href = $hrefs->item($i);
    echo "<br />Link stored: $href";
}
?> 
```

我对这些东西很陌生，无法弄清楚我做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:41:06.040

在您的 for 循环中，`$href`不是字符串。它实际上是一个 DOMText 节点。为了将其用作字符串，您需要访问其`nodeValue`属性。

```
for ($i = 0; $i < $hrefs->length; $i++) {
    $href = $hrefs->item($i);
    echo "<br />Link stored: $href->nodeValue";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:43:12.263

尝试：

```
$xpath = new DOMXPath($dom);
$hrefs = $xpath->evaluate("/html/body//a/text()");

for ($i = 0; $i < $hrefs->length; $i++) {
    $href = $hrefs->item($i)->textContent;
    echo "<br />Link stored: $href";
} 
```

# asp.net - Asp.net 页面加载后向下移动

> ID：12099558
> 
> 赞同：2
> 
> 时间：2012-08-23T20:34:07.240
> 
> 标签：asp.net

我注意到在使用`<asp:panel>`或`<asp:UpdatePanel>`页面完成渲染后我的页面正在跳转/向下滚动。同样在异步回发之后，页面会移动到同一个地方，而不是停留在原来的位置。我的页面后面的代码中没有设置任何焦点。

可能值得一提的是，在页面加载时，我正在更新`<asp:UpdatePanel>`. 主要是数据库驱动的下拉菜单。

我想知道是否有人知道页面会跳下的任何原因。某些asp.net控件是否有一些默认焦点或发生了什么？

在此先感谢您的帮助，

我尝试过的事情：

[异步回发后如何保持整个页面滚动位置](https://stackoverflow.com/questions/3948417/how-to-keep-whole-page-scroll-position-after-asynchronous-postback)

Update1：​​我使用**David Stratton**脚本来获得正确的位置。但是页面仍然跳下然后跳回到正确的位置。我的目标是让页面完全不跳转。

这是我页面的标记，这些之间有控制。

```
<asp:UpdatePanel ID="UpdatePanel9" runat="server">

    <asp:Panel ID="tagpanel" runat="server" DefaultButton="btnAddTag">
    </asp:Panel>

</asp:UpdatePanel>
<asp:UpdatePanel ID="UpdatePanel5" runat="server">

    <asp:Panel ID="pnlIncidentInfo" runat="server">
    </asp:Panel>

</asp:UpdatePanel> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:39:07.253

***注意***此处描述的问题***与MaintainScrollPositionOnPostback***无关。我自己也遇到过这个问题，它与 UpdatePanel 控件有关。

来自 [http://weblogs.asp.net/andrewfrederick/archive/2008/03/04/maintain-scroll-position-after-asynchronous-postback.aspx](http://weblogs.asp.net/andrewfrederick/archive/2008/03/04/maintain-scroll-position-after-asynchronous-postback.aspx)

首先，在 ContentTemplate 中设置一个名为“scrollDiv”的 div。

```
 <asp:UpdatePanel ID="UpdatePanel1" runat="server">
     <ContentTemplate>
       <div id="scrollDiv">
          The rest of your page content goes here.
       </div>
     </ContentTemplate>
  <asp:UpdatePanel> 
```

然后，正如文章所说，JavaScript 在您页面上的 ScriptManager 之后运行

```
<script type="text/javascript">
    var xPos, yPos;
    var prm = Sys.WebForms.PageRequestManager.getInstance();
    prm.add_beginRequest(BeginRequestHandler);
    prm.add_endRequest(EndRequestHandler);
    function BeginRequestHandler(sender, args) {
        xPos = $get('scrollDiv').scrollLeft;
        yPos = $get('scrollDiv').scrollTop;
    }
    function EndRequestHandler(sender, args) {
        $get('scrollDiv').scrollLeft = xPos;
        $get('scrollDiv').scrollTop = yPos;
    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:38:15.373

也许您正在使用[MaintainScrollPositionOnPostBack](http://msdn.microsoft.com/en-us/library/system.web.ui.page.maintainscrollpositiononpostback.aspx)？

# java - 使用 Google Geocoding API 将地址转换为纬度/经度时出现问题。

> ID：12099561
> 
> 赞同：1
> 
> 时间：2012-08-23T20:34:14.667
> 
> 标签：java, geocoding

我有一个应用程序，它将读取一个包含大量姓名和地址（800+）的 Excel 电子表格，使用 Google 地理编码 API 将地址转换为纬度/经度，并生成一个带有关联航点的 .kml 文档。

当转换大量地址时，.kml 文件将最终得到为不同地址分配相同纬度/经度的小组。我想知道是否需要处理小批量、暂停程序并处理另一批？

```
public void GeocodingSample() throws IOException, XPathExpressionException, ParserConfigurationException, SAXException
{

    l1 = new String[lineCount];
    l2 = new String[lineCount];
    //address2 = add;
    //city2 = city;

    bxg.UpdateTA("Converting address to lat/long...");

    ProgressBar progress = new ProgressBar();

    // URL prefix to the geocoder
    String GEOCODER_REQUEST_PREFIX_FOR_XML = "http://maps.google.com/maps/api/geocode/xml";

    // query address
    address = new String[lineCount];

    int x = 0;

    //System.out.println("Im about to enter the loop and the count is: "+lineCount);

    while(x < lineCount)
    {
        pbarvalue = x + 1;

        address[x] = (sheet[x][a2]+", "+sheet[x][s2]);

        progress.PbarValue(pbarvalue, lineCount, address[x]);

        url = new URL(GEOCODER_REQUEST_PREFIX_FOR_XML + "?address=" + URLEncoder.encode(address[x], "UTF-8") + "&sensor=false");

        // prepare a URL to the geocoder
        //URL url = new URL(GEOCODER_REQUEST_PREFIX_FOR_XML + "?address=" + URLEncoder.encode(address, "UTF-8") + "&sensor=false");

        // prepare an HTTP connection to the geocoder
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();

        Document geocoderResultDocument = null;
        try 
        {
          // open the connection and get results as InputSource.
          conn.connect();
          InputSource geocoderResultInputSource = new InputSource(conn.getInputStream());

          // read result and parse into XML Document
          geocoderResultDocument = DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(geocoderResultInputSource);
        } finally {
          conn.disconnect();
        }

        // prepare XPath
        XPath xpath = XPathFactory.newInstance().newXPath();

        // extract the result
        NodeList resultNodeList = null;

        // a) obtain the formatted_address field for every result
        resultNodeList = (NodeList) xpath.evaluate("/GeocodeResponse/result/formatted_address", geocoderResultDocument, XPathConstants.NODESET);
        for(int i=0; i<resultNodeList.getLength(); ++i) {
          //System.out.println(resultNodeList.item(i).getTextContent());
        }

        // b) extract the locality for the first result
        resultNodeList = (NodeList) xpath.evaluate("/GeocodeResponse/result[1]/address_component[type/text()='locality']/long_name", geocoderResultDocument, XPathConstants.NODESET);
        for(int i=0; i<resultNodeList.getLength(); ++i) {
          //System.out.println(resultNodeList.item(i).getTextContent());
        }

        // c) extract the coordinates of the first result
        resultNodeList = (NodeList) xpath.evaluate("/GeocodeResponse/result[1]/geometry/location/*", geocoderResultDocument, XPathConstants.NODESET);

        for(int i=0; i<resultNodeList.getLength(); ++i) {
          Node node = resultNodeList.item(i);
          if("lat".equals(node.getNodeName())) lat = Float.parseFloat(node.getTextContent());
          if("lng".equals(node.getNodeName())) lng = Float.parseFloat(node.getTextContent());
        }
        //System.out.println("lat/lng=" + lat + "," + lng);
        l1[x] = (""+lat);
        l2[x] = (""+lng);

        // c) extract the coordinates of the first result
        resultNodeList = (NodeList) xpath.evaluate("/GeocodeResponse/result[1]/address_component[type/text() = 'administrative_area_level_1']/country[short_name/text() = 'US']/*", geocoderResultDocument, XPathConstants.NODESET);
        for(int i=0; i<resultNodeList.getLength(); ++i) {
          Node node = resultNodeList.item(i);
          if("lat".equals(node.getNodeName())) lat = Float.parseFloat(node.getTextContent());
          if("lng".equals(node.getNodeName())) lng = Float.parseFloat(node.getTextContent());
        }
        //System.out.println("lat/lng=" + lat + "," + lng);

        x++;
    }//end While

    //System.out.println("The output is ready");

    progress.ShowFrame(false);
    OutputKML();

}// end GeoCoding Sample 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T08:02:43.530

首先，服务条款禁止您使用 Google Maps API：

[https://developers.google.com/maps/terms](https://developers.google.com/maps/terms)

> 禁止大量下载或批量提供内容：(...) 例如，您不得提供使用 Maps API 中包含的内容的批量地理编码服务。

还：

> (g) 不得使用没有 Google 地图的内容。如果没有相应的 Google 地图，您不得使用或显示内容

您有一些选择：

[http://developer.mapquest.com/web/products/open](http://developer.mapquest.com/web/products/open)

[http://services.gisgraphy.com/public/geocoding.html](http://services.gisgraphy.com/public/geocoding.html)

关于您的具体地理编码问题，结果是否会随时间变化？如果不是这种情况，则可能存在解析错误 - 或者只是地址无法精确定位在相同坐标上。另一方面，在每个请求之后延迟可能会有所帮助。

# hibernate - Hibernate 中的 SQLQuery 是否使用会话缓存？

> ID：12099563
> 
> 赞同：1
> 
> 时间：2012-08-23T20:34:25.773
> 
> 标签：hibernate, caching

[这篇博文（](http://i-proving.com/2006/08/29/sql-vs-hql-with-the-session-cache/)[在此处](https://stackoverflow.com/questions/4500221/hibernate-sqlquery-bypasses-hibernate-session-cache)引用）说 SQLQuery 不使用 Hibernate 会话缓存。但是，a) 没有证据，b) 他们不使用 SQLQuery.addEntity，这可能会提供允许 Hibernate 使用其缓存的信息。

[文档](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/querysql.html#d0e17428)没有提到以一种或另一种方式缓存。

如果我使用 addEntity，SQLQuery 是否使用会话缓存？

**编辑**：文档的[这一部分说：](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/performance.html#performance-sessioncache)

> 每当您将对象传递给 save()、update() 或 saveOrUpdate()，以及每当您使用 load()、get()、list()、iterate() 或 scroll() 检索对象时，该对象都会添加到Session 的内部缓存。

由于 addEntity() 允许 list() 返回对象，这意味着它正在使用缓存。我该如何检查？那些相同的文档说缓存有一种“包含”方法，可以浏览二级缓存，但不能浏览会话缓存。

**编辑#2**：通过打开 Hibernate 查询的日志记录，它似乎没有被缓存，但也许某些情况会使其缓存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:04:52.610

我不认为 beny23 的回答是正确的。我相信`setCacheable`指的是二级缓存而不是会话缓存。

要检查实体是否在会话缓存中，您可以使用`Session.contains()`. 你也可以做一个快速测试：获取实体，修改它，关闭会话，看看 mod 是否在数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:57:57.590

根据[SQLQuery](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/SQLQuery.html)的 javadocs ，它扩展了`Query`接口，该接口提供了[setCacheable](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/Query.html#setCacheable%28boolean%29)方法（默认为 false），因此您应该能够执行以下操作：

```
Query query = session.createSQLQuery(
  "select * from my_table e")
  .addEntity(MyEntityClass.class)
  .setCacheable(true); 
```

此外，您可能希望通过使用 [setCacheMode](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/internal/AbstractQueryImpl.html#setCacheMode%28org.hibernate.CacheMode%29)和[setCacheRegion](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/internal/AbstractQueryImpl.html#setCacheRegion%28java.lang.String%29)方法来设置缓存区域。

# iphone - NSFetchRequest，查询多个属性？

> ID：12099565
> 
> 赞同：2
> 
> 时间：2012-08-23T20:34:38.120
> 
> 标签：iphone, cocoa-touch, core-data, nsfetchedresultscontroller

使用 NSFetchedResultsController 和 NSFetchRequest 可以设置一个返回每个属性中最高值的查询。

例如：

```
Entity_001 A=F B=27 C=57
Entity_002 A=G B=23 C=98
Entity_003 A=X B=21 C=54
Entity_004 A=K B=11 C=27
Entity_005 A=R B=16 C=15 
```

结果：

```
Entity_003 A=X B=21 C=54 // Biggest A
Entity_001 A=F B=27 C=57 // Biggest B
Entity_002 A=G B=23 C=98 // Biggest C 
```

基本上我有一个数据集，我需要选择“最小的”、“最快的”和“最重的”我可以在不使用 NSFetchedResultsController 的情况下手动完成，或者我想我可以使用 3 个 NSFetchedResultsController 并尝试将结果网格化到一个单一的数据源。任何想法将不胜感激...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T13:43:50.100

我会执行 3 个不同的获取请求以返回每个特定请求的最大值，然后将每个特定获取请求结果的对象 ID 合并到一个数组中，并使用一个获取请求执行 NSFetchedResultsController 获取（以获取来自更改的通知）查找数组内对象的 ID。基本上，它是 4 次抓取。三个可以在后台完成，一个用于 NSFetchedResultsController 实例，它将在主线程中完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:42:02.293

您是否尝试过查看[KeyValue 编码](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/KeyValueCoding/Articles/CollectionOperators.html)？

# java - Java DNS 缓存大小

> ID：12099567
> 
> 赞同：0
> 
> 时间：2012-08-23T20:34:53.340
> 
> 标签：java, dns

我正在编写一个应用程序，它将定期联系很多网站（应其所有者的要求）。为此，我希望能够调整 Java 的 DNS 缓存。我似乎找不到任何地方：

1.  默认最大缓存大小

2.  如何改变这个

有任何想法吗？

谢谢。

**编辑**：我担心缓存变大并且内存不足

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:53:48.393

您将需要使用安装在某些服务器上的具有缓存功能的 DNS 服务器。

[http://tldp.org/HOWTO/DNS-HOWTO-3.html](http://tldp.org/HOWTO/DNS-HOWTO-3.html)

[https://superuser.com/questions/129484/what-is-a-good-local-windows-dns-caching-server-service](https://superuser.com/questions/129484/what-is-a-good-local-windows-dns-caching-server-service)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:46:30.190

Java 只是委托给操作系统。您使用的是什么操作系统？

更新：这实际上并不完全正确。Sun JVM 维护自己的已解析主机名缓存。默认情况下，缓存中的项目永远存在，但您可以向下调整[TTL 。](http://docs.oracle.com/javase/1.4.2/docs/guide/net/properties.html)当然，这个缓存不会在 JVM 调用中持续存在；在这种情况下，我的第一句话成立。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T12:57:59.703

我已经完成了InetAddress 中缓存的[实现](http://www.docjar.com/html/api/java/net/InetAddress.java.html)，我很确定实际上没有缓存限制。我猜设计者从来没有想过客户端可以访问这么多主机，这会导致我们内存不足。

# perl - 如何运行由 Module::Starter 构建的新 Perl 程序？

> ID：12099569
> 
> 赞同：3
> 
> 时间：2012-08-23T20:35:02.527
> 
> 标签：perl

我为自己构建了一个新的 Perl 模块[`Module::Starter`](https://metacpan.org/module/Module%3a%3aStarter)，它在 lib/ 中有以下源代码文件：

```
Foo/Bar.pm
Spam.pm 
```

我在`t/Bar.t`那次测试中做了两个测试用例`Foo/Bar.pm`。我跑了：

```
perl Makefile.PL && make && make test 
```

它表明我的 2 个测试用例通过了。

Bar.pm 定义：

```
package Foo::Bar; 
```

Spam.pm 以这种方式使用它：

```
use Foo::Bar qw(fun); 
```

尽管测试用例可以找到 Foo::Bar 没有问题，但是当我单独运行 Spam.pm 时`perl Spam.pm`，它报告在 @INC 中找不到 Foo::Bar。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T20:40:39.283

`<project root>/lib`通常不在您的包含路径（您的`@INC`设置）中。`make test`将包含它（实际上`blib/lib`），但是要在模块开发期间将其包含在独立程序中，您必须执行以下操作之一

```
perl -Ilib lib/Spam.pm
PERL5LIB=lib perl lib/Spam.pm 
```

或者安装它（使用`make install`），这将使文件在包含路径中的目录下可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:38:16.257

你从来没有安装过它。通过运行来做到这一点

```
make install 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T20:39:41.917

测试程序在一个特殊的环境下运行，该环境在不同的地方寻找被测模块。要在普通程序中使用该模块，您应该使用`make install`.

但是模块并不意味着直接运行。您没有说出您的内容，`Spam.pm`但如果您只是将其作为程序运行，则不太可能做任何有用的事情。

# java - 在类中创建类的实例

> ID：12099570
> 
> 赞同：2
> 
> 时间：2012-08-23T20:35:20.343
> 
> 标签：java, oop, class

考虑到我有以下两个嵌套类：

```
public class Foo {

    public class Bar {

    }

} 
```

我的目标是创建一个 class 实例`Bar`。我尝试通过以下方式做到这一点：

```
// Method one
Foo fooInstance = new Foo();
Foo.Bar barInstance = new fooInstance.Bar // fooInstance cannot be resolved to a type

// Method two
Foo.Bar barInstance = new Foo.Bar(); // No enclosing instance of type Foo is accessible 
```

任何帮助将不胜感激，我被困住了。您可能会注意到，我是一名 Java 初学者：这不会自动将其作为家庭作业问题（事实上 - 它不是）。

**如何创建`Bar`类的实例？最好是同一个`Foo`实例。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:36:21.840

关。而是写：

```
Foo.Bar barInstance = fooInstance.new Bar(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T20:41:37.720

这里：

```
Foo.Bar barInstance = new fooInstance.Bar // fooInstance cannot be resolved to a type 
```

您尝试实例化一个不存在的类型（fooInstance 只是一个变量）

正确的做法是，正如解释的那样：

```
Foo.Bar barInstance = new Foo().new Bar() 
```

这里：

```
Foo.Bar barInstance = new Foo.Bar(); // No enclosing instance of type Foo is accessible 
```

这仅对 Foo 的静态内部类有效。因此，如果这符合您的需要，请将 Boo 设为 Foo 的静态内部类

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T20:37:09.703

您必须创建内部类的对象，例如：

```
Foo.Bar barObj = new Foo().new Bar(); 
```

如果内部类是静态的，那么您可以直接将它们创建为：

```
public class Foo {    
    static public class Bar {    
    }    
} 
```

```
Foo.Bar b = new Foo.Bar(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T20:38:14.280

它应该是

```
Foo.Bar barInstance = new Foo().new Bar(); 
```

# android - Android.jar 在 R 文件中缺少动画值

> ID：12099571
> 
> 赞同：0
> 
> 时间：2012-08-23T20:35:26.303
> 
> 标签：android, jar, android-animation, android-resources

我试图`android.R.anim.slide_out_left`在我的代码中引用（我在 Android 3.0+ 上构建），而 IntelliJ 告诉我它丢失了。我试图编译，它不会编译。我认为这可能是我的模块设置，所以我尝试用 ANT 编译而不用 dice。所以我戳到了 android.jar 并且`slide_out_left`丢失了（以及一堆其他动画值）。在这一点上我很困惑，因为当我浏览 SDK 源代码时会出现这个动画。为什么不在罐子里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:17:57.930

slide_out_left 尚未向应用程序开发人员公开。对于要公开的 slide_out_left，它需要存在于框架的 public.xml 中。

# asp.net - 如何使用asp.net从每一页读取pdf文档的标题

> ID：12099572
> 
> 赞同：0
> 
> 时间：2012-08-23T20:35:26.733
> 
> 标签：asp.net, pdf

使用 ASP.NET，是否可以从多页 pdf 文档中获取每一页的标题？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:47:17.577

要使用 iTextSharp 读取元数据：

您可以使用 读取元数据`PdfReader`。

```
PdfReader reader = new PdfReader("SomeFile.pdf");
string s = reader.Info["Author"]; 
```

在渲染/保存输出期间写入元数据：

[http://milan.kupcevic.net/ghostscript-ps-pdf/](http://milan.kupcevic.net/ghostscript-ps-pdf/)

```
 /Title (Document title)
  /Author (Author name)
  /Subject (Subject description)
  /Keywords (comma, separated, keywords)
  /ModDate (D:20061204092842)
  /CreationDate (D:20061204092842)
  /Creator (application name or creator note)
  /Producer (PDF producer name or note)
  /DOCINFO pdfmark 
```

# javascript - Javascript/jQuery 在可编辑的 DIV 中设置光标

> ID：12099575
> 
> 赞同：3
> 
> 时间：2012-08-23T20:35:35.210
> 
> 标签：javascript, jquery, html, cursor, contenteditable

看了一些移动光标的方法，似乎无法提出一种优雅/有效的方式。

我基本上是想调用一行代码来做下面的伪代码。

1.  获取可编辑 div 中的文本长度
2.  将光标设置到最后一个字母

例如

这是示例文本|

光标设置在哪里 | 是

这有多简单？

JsFiddle：http://jsfiddle.net/v8agZ/5/

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-23T13:59:45.050

这是一种可以将光标放在**可编辑*div***末尾的方法（改编自[这个问题](https://stackoverflow.com/questions/13513329/set-cursor-to-the-end-of-contenteditable-div)）。

**HTML**

```
<div id="mydiv">
    Lorem ipsum dolor sit amet,
    <br />
    <br />
    consectetur adipisicing elit
</div> 
```

**Javascript**

```
function setCursorToEnd(ele) {
    var range = document.createRange();
    var sel = window.getSelection();
    range.setStart(ele, ele.childNodes.length - 1);
    range.collapse(true);
    sel.removeAllRanges();
    sel.addRange(range);
    ele.focus();
}

var mydiv = document.getElementById("mydiv");
setCursorToEnd(mydiv); 
```

如果你想使用**jQuery**（在这种情况下没用），你可以简单地使用and方法获取`mydiv`元素，如下所示：`$()``get()`

```
var mydiv = $("#mydiv").get(0);
setCursorToEnd(mydiv); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:46:45.937

我认为您可以使用[jCaret 插件](http://www.jquery-plugin.buss.hk/my-plugins/jquery-caret-plugin)

一个[演示](http://examplet.buss.hk/trycode/index.php?file=jQuery-jCaret-Detect-Start-Position)，不是我的

# java - 在 java 中的 XML 数据上应用一个或多个 XSLT 样式表

> ID：12099576
> 
> 赞同：0
> 
> 时间：2012-08-23T20:35:36.100
> 
> 标签：java, xml, xslt

我希望能够在 xml 数据上应用一个或多个样式表。我有这段代码，我想知道如何修改它，以便我可以在单个 xml 数据上应用尽可能多的样式表，并将结果打印在 GUI 的文本区域（因为我假设 settext() 只接受字符串）和同时保存在一个文件中。这些是我的代码..谢谢

```
 /**
   * Constructor for objects of class Simple
   */
    public Simple(String xmlFile, String xslFile,String outputFile)
   {
   this.xmlFile = xmlFile;
   this.xslFile = xslFile;
   this.outputFile= outputFile;
   }

  public String SimpleTransform() throws   

 TransformerException,TransformerConfigurationException,FileNotFoundException,
 IOException

  {String mystring = "";

 TransformerFactory tFactory = TransformerFactory.newInstance();
Transformer transformer = tFactory.newTransformer(new StreamSource(xslFile)); 
 transformer.transform(new StreamSource(xmlFile), new StreamResult(new   
 FileOutputStream(outputFile)));
  return mystring = "***The result is in birds.out *****";
 } 
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:45:04.910

您需要转换过滤器链：阅读[Concatenating Transformations with a Filter Chain](http://docs.oracle.com/javaee/1.4/tutorial/doc/JAXPXSLT8.html)

# php - 检测字符串中 + - " * 的使用

> ID：12099577
> 
> 赞同：0
> 
> 时间：2012-08-23T20:35:48.050
> 
> 标签：php, strpos

这是我的测试查询：

```
if (strpos($q, '+') > 0 || strpos($q, '-') > 0 || strpos($q, '"') > 0 || strpos($q, '*') > 0) {

    print ("Advanced search operators are being used");

} else {

    print ("Advanced search operators are NOT being used"); 
}

$q = '-lavender' fails
$q = 'burn -lavender' passes 
```

我究竟做错了什么？我想让它在任何时候都通过 + 或 - 在字符串中。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T20:37:35.230

`strpos()``false`如果没有找到值则返回，否则返回从 开始的位置`0`。

您的比较应该检查返回值是否`!== false`：

```
if (strpos($q, '+') !== false || strpos($q, '-') !== false || strpos($q, '"') !== false || strpos($q, '*') !== false) 
```

**或者**

您可以使用`regular expression`：

```
preg_match('/[-+*"]+/', $q); 
```

**更新**

NikiC 刚刚引起[`strpbrk()`](http://php.net/manual/en/function.strpbrk.php)了我的注意，它将非常适合您：

```
if (strpbrk ( $q, '-+*"') !== false) 
```

它相当于`if`上面那个长语句。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T20:37:35.833

```
strpos($q, '+') !== false 
```

`0`是一个有效的位置，第一个。

**在与下面的 SO 同志愉快交谈后编辑。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T20:49:54.260

`strpos``false`如果没有找到匹配项，或者`0`在开始时找到匹配项，则返回。要区分两者，请使用`===`.

但是，它可以变得更容易：

```
if( preg_match('/[-+"*]/',$q)) {
    echo "Advanced search";
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-23T20:37:42.993

In `-lavender`， strpos 正在返回`0`，因为它在字符串（或 index ）`-`的开头找到。`0`

尝试这个：

```
strpos($q, '-') !== false 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-23T20:39:08.937

```
<?php
$mystring = 'abc';
$findme   = 'a';
$pos = strpos($mystring, $findme);

// Note our use of ===.  Simply == would not work as expected
// because the position of 'a' was the 0th (first) character.
if ($pos === false) {
    echo "The string '$findme' was not found in the string '$mystring'";
} else {
    echo "The string '$findme' was found in the string '$mystring'";
    echo " and exists at position $pos";
}
?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T20:38:53.523

strpos 返回字符在字符串中的位置；在第一个测试字符串中，`'-lavender`字符是第一个。

在这种情况下， strpos 返回 0，即第一个字符。即使找到了字符串，它的评估结果也为假。

您需要进行布尔比较：

```
if (strpos($q, '-') !== false ... 
```

# c++ - 提升wserialization和序列化的区别

> ID：12099578
> 
> 赞同：4
> 
> 时间：2012-08-23T20:35:50.867
> 
> 标签：c++, serialization, boost

我已经搜索了互联网和 Boost 序列化文档，但我找不到任何解释为什么有两个不同的带有 boost 序列化的库。

到目前为止，我发现 wserialization 依赖于序列化，但它到底做了什么？为什么这两个库是分开的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T20:53:27.853

`boost::wserialization`只是一个面向宽字符的版本`boost::serialization`

# android - Android 无法使用 VideoView 播放 mp4 视频？

> ID：12099579
> 
> 赞同：0
> 
> 时间：2012-08-23T20:35:54.580
> 
> 标签：android, video, mp4, codec

我正在尝试使用仅包含 videoview 的全屏活动流式传输 mp4 视频。但即使它很容易在我的 galaxt s3 上播放，它也不能播放大多数设备。我怀疑它与视频编码有关（顺便说一句，您必须成为编解码器大师才能知道哪个视频播放哪个不播放）。

这是我正在使用的代码。

```
 //make screen full with video
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFormat(PixelFormat.TRANSLUCENT);
    setContentView(R.layout.full_screen_video);

    //get extra video source string
    Intent intent = getIntent();
    if(intent != null){
        videoSrc = intent.getStringExtra(TefalTvApp.RECIPE_VIDEO_SOURCE);
        if (DEBUG) {
            Log.d(TAG, "Recipe title : " + videoSrc);   
        }
    }

    video = (VideoView) findViewById(R.id.recipeVideo);
    controller = new MediaController(FullScreenVideoActivity.this);
    controller.setMediaPlayer(video);
    video.setMediaController(controller);
    video.setVideoPath(videoSrc);
    video.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View arg0) {
            // TODO Auto-generated method stub
            if (DEBUG) {
                Log.d(TAG, "Hello wworld");
            }
        }
    });

    video.setOnPreparedListener(new OnPreparedListener() {

        @Override
        public void onPrepared(MediaPlayer mp) {
            video.requestFocus();
            video.start();  
        }
    }); 
```

这是调试结果。您在调试中有视频网址。

```
08-23 23:25:53.349: D/RecipeDetailActivity(18179): Video src : http://www.tefaltv.com/Upload/Video/acticook_kiymalifasulye.mp4
08-23 23:25:53.379: I/ApplicationPackageManager(18179): cscCountry is not German : TUR
08-23 23:25:53.389: D/FullScreenVideoActivity(18179): Recipe title : http://www.tefaltv.com/Upload/Video/acticook_kiymalifasulye.mp4
08-23 23:25:53.399: D/VideoView(18179): onMeasure()
08-23 23:25:53.399: I/VideoView(18179):     Setting size: 480x295
08-23 23:25:53.439: I/MediaPlayer(18179): uri is:http://www.tefaltv.com/Upload/Video/acticook_kiymalifasulye.mp4
08-23 23:25:53.439: I/MediaPlayer(18179): path is null
08-23 23:25:53.439: D/MediaPlayer(18179): Couldn't open file on client side, trying server side
08-23 23:25:53.519: D/VideoView(18179): onMeasure()
08-23 23:25:53.519: I/VideoView(18179):     Setting size: 480x295
08-23 23:25:57.689: I/VideoView(18179): start()
08-23 23:25:57.739: D/VideoView(18179): onMeasure()
08-23 23:25:57.739: I/VideoView(18179):     Setting size: 480x270
08-23 23:25:57.759: E/MediaPlayer(18179): error (1, -2147483648)
08-23 23:25:57.769: I/VideoView(18179): start()
08-23 23:25:57.779: E/MediaPlayer(18179): start called in state 0
08-23 23:25:57.779: E/MediaPlayer(18179): error (-38, 0)
08-23 23:25:57.799: E/MediaPlayer(18179): Error (1,-2147483648)
08-23 23:25:57.799: D/VideoView(18179): Error: 1,-2147483648
08-23 23:25:57.799: E/MediaPlayer(18179): Error (-38,0)
08-23 23:25:57.799: D/VideoView(18179): Error: -38,0 
```

更新：视频编码细节：格式：H.264、624 x 351 AAC、44100 Hz、立体声 (LR) FPS：25 数据速率：2.23mbit/s 当前大小：实际 624x351 像素

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:02:22.563

这主要是因为编码。我看到您的视频文件分辨率是 624x351，这不是标准的，所以这可能是一个原因。还要检查最大比特率和 fps，因为所有移动设备都有一些上限，比如大多数 android 手机的 30fps。您应该参考本文档以使您的文件与所有 android 手机兼容。[Android 媒体格式](http://developer.android.com/guide/appendix/media-formats.html)

此外，如果您可以共享编码命令（如果您正在执行一个），则很容易跟踪问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-19T15:30:31.800

我建议您使用以下代码，其中我正在成功运行我的应用程序

代码如下：

XML 文件：

```
 <?xml version="1.0" encoding="utf-8"?>
    <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="#f0f0f0" >

        <Button
            android:id="@+id/btnVideoGallery"
            android:layout_width="75dp"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="15dp"
            android:text="@string/gallery" />

        <Button
            android:id="@+id/btnCancel"
            android:layout_width="120dp"
            android:layout_height="wrap_content"
            android:layout_below="@+id/btnVideoGallery"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="22dp"
            android:text="@string/cancel" />

        <TextView
            android:id="@+id/lblDisplayImage"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@+id/btnCancel"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="10dp"
            android:text="@string/below_this_text_video_will_be_displayed"
            android:textAppearance="?android:attr/textAppearanceMedium"
            android:textColor="#000000"
            android:textSize="13dp" />

        <VideoView
            android:id="@+id/vvDisplayVideo"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_below="@+id/lblDisplayImage"
            android:layout_marginTop="15dp" />

    </RelativeLayout> 
```

Java 文件：

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.KeyEvent;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.MediaController;
import android.widget.VideoView;

public class VideoActivity extends Activity {

    private Button btnVideoGallery,btnCancel;
    private VideoView vvDisplayVideo;
    /** The Constant PICK_VIDEO. */
    private static final int PICK_VIDEO=1;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_video_options);

        btnVideoGallery=(Button)findViewById(R.id.btnVideoGallery);
        vvDisplayVideo=(VideoView)findViewById(R.id.vvDisplayVideo);
        btnCancel=(Button)findViewById(R.id.btnCancel);
        vvDisplayVideo.setVisibility(View.GONE);

        btnVideoGallery.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {

                Intent video=new Intent();
                video.setAction(Intent.ACTION_PICK);
                video.setType("video/*");
                startActivityForResult(video, PICK_VIDEO);

            }
        });

        btnCancel.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {

                Intent goStartUp=new Intent(VideoActivity.this, StartUpActivity.class);
                goStartUp.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivity(goStartUp);
                finish();
            }
        });
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        // TODO Auto-generated method stub
        if (resultCode==Activity.RESULT_OK && requestCode == PICK_VIDEO) {

            vvDisplayVideo.setVisibility(View.VISIBLE);
            vvDisplayVideo.setVideoURI(data.getData());
            vvDisplayVideo.setFocusable(true);
            MediaController mc=new MediaController(this);
            vvDisplayVideo.setMediaController(mc);
            Log.i("True", "Executed");
        }
    }

    @Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {
        // TODO Auto-generated method stub

        Intent goStartUp=new Intent(VideoActivity.this, StartUpActivity.class);
        goStartUp.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(goStartUp);
        finish();
        return super.onKeyDown(keyCode, event);
    }
} 
```

您还可以根据您的使用修改清单文件：

```
<manifest ...
<uses-sdk...  />
<uses-permission android:name="android.permission.CAMERA" />
    <uses-permission android:name="android.permission.RECORD_VIDEO" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />

    <uses-feature
        android:name="android.hardware.camera"
        android:required="false" />

<application .....
</application>

</manifest> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-05-27T14:08:49.133

您正在流式传输的视频大小与您的视频视图大小不同

# javascript - 如何将事件侦听器添加到跨域 iframe 内的元素

> ID：12099580
> 
> 赞同：0
> 
> 时间：2012-08-23T20:35:57.823
> 
> 标签：javascript, iframe, javascript-events

我正在尝试检测每个链接何时被点击以及每个表单何时在 iframe 中提交。iframe 的内容位于网页的不同域中。

我搜索了很多，所有解决方案都失败了。如果 iframe 来自同一个域，它可以正常工作。但是，当 iframe 离开域时，该函数不会触发。

是否有使用外部库的解决方法？

谢谢阿扎姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:38:57.173

你试过[EasyXDM](http://easyxdm.net/wp/)吗？不过，您需要将跨域允许策略添加到其他域。如果您无法控制其他域的内容，我认为您不能这样做，因为这是浏览器的安全功能。

# java - WebView - 每次我旋转屏幕时，网站都会返回原始页面？

> ID：12099581
> 
> 赞同：-2
> 
> 时间：2012-08-23T20:36:08.307
> 
> 标签：java, android, webview

有没有办法阻止这种情况？我尝试了以下方法：

```
//Adding this to the Manifest for the activity:
android:configChanges="orientation" 
```

和

```
//Adding this to the MainActivity
@Override
    public void onConfigurationChanged(Configuration newConfig){        
        super.onConfigurationChanged(newConfig);
    } 
```

它不起作用，但有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:57:03.547

这只是一个建议，但你可以试试 :-)

```
 android:configChanges="keyboardHidden|orientation" 
```

我使用它，但不与 webview 结合使用。但是，在我用我的活动进行测试的每一种情况下，它都会停止构建新的活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:48:30.790

方向改变实际上重新启动了整个活动。这意味着 onDestroy() 被调用，然后 onCreate() 被再次调用......

它是按设计完成的，因为活动最终将需要加载不同的布局、不同的配置等等......

您应该使用 onSaveInstanceState() 方法保存活动状态，并重用作为参数传递给 onCreate() 方法的 Bundle 对象。

阅读[http://developer.android.com/guide/topics/resources/runtime-changes.html](http://developer.android.com/guide/topics/resources/runtime-changes.html)，其中解释了所有这些过程（以及可选的附加优化）

# java - android，检查gps位置是否接近/接近某个位置

> ID：12099589
> 
> 赞同：1
> 
> 时间：2012-08-23T20:36:56.537
> 
> 标签：java, android, gps

我有带有 gps 位置（纬度和经度）的 sqlite 数据库/表。

现在我需要 gps 每隔几秒钟检查一次我是否在附近，如此接近我数据库中的一个位置。

最好/最简单的方法是什么？任何人都可以提供一些关于如何做到这一点的公会或示例/turturial 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T20:48:34.370

使用[位置管理器接近警报](http://developer.android.com/reference/android/location/LocationManager.html#addProximityAlert%28double,%20double,%20float,%20long,%20android.app.PendingIntent%29)将是您最好的选择，您可以为表中的每个位置设置警报，然后在它们被触发时捕捉到意​​图。

这些比在某个时间间隔手动点击 gps 更省电。

[这](http://developer.android.com/reference/android/location/LocationManager.html)是一个例子。

# java - 确定 Java Swing 中的重叠组件

> ID：12099591
> 
> 赞同：3
> 
> 时间：2012-08-23T20:37:04.833
> 
> 标签：java, swing

我在 JXTreeTable 上加载了一个 JPanel。我想确定 JPanel 是否与 JXTreeTable 的特定单元格重叠。我尝试检索 X 和 Y 组件并比较它们。但是，当我检查 JPanel 的最小 X 和 Y 坐标时，它们始终为 0.0。我无法弄清楚。除了比较坐标值之外，还有其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:00:00.743

您应该能够用来`Rectangle`帮助确定组件是否重叠。

IE

```
Rectangle panelBounds = panel.getBounds();
Rectangle cellBounds = getRowBounds(row); // getPathBounds(path);
if (panelBounds.intersects(cellBounds)) {
    // We have a collision
} 
```

现在，更大的问题是，X/Y 返回值始终为 0。这意味着该方法的`Rectangle`返回`getBounds`也将返回 0 的 x/y。

您将需要共享一些代码来向我们展示您如何布置此组件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:54:07.343

只有在以下情况下，您才能确定`JComponents`坐标：

*   已经在屏幕上可见

*   调用方法后`pack()`

尽快发布[SSCCE以获得更好的帮助](http://sscce.org/)

# entity-framework - 使用带有可编辑网格面板的实体数据源

> ID：12099592
> 
> 赞同：0
> 
> 时间：2012-08-23T20:37:07.277
> 
> 标签：entity-framework, extjs, ext.net, entitydatasource

我是 ext.net 的新手。我正在尝试使用 entitydatasource 制作可编辑的网格

这是代码：

```
<asp:EntityDataSource ID="EntityDataSource1" runat="server"
            AutoGenerateOrderByClause="True" 
            ConnectionString="name=Sample1Entities" 
            DefaultContainerName="Sample1Entities" 
            EnableDelete="True" 
            EnableFlattening="False" 
            EnableInsert="True" 
            EnableUpdate="True" 
            EntitySetName="Customer" 
            EntityTypeFilter="Customer"
            OnUpdating="EntityDataSource1_OnUpdating"
        >
<ext:GridPanel 
            runat="server" 
            ID="GridPanel1" 
            Height="570" 
            Title="Customers" 
            Frame="true">
            <Store>
                <ext:Store ID="Store1" runat="server" DataSourceID="EntityDataSource1" AutoSync="true"
                    IDMode="Client">
                    <Model>
                        <ext:Model ID="Model1" runat="server">
                            <Fields>
                                <ext:ModelField  Name="CustomerId" Mapping="CustomerId"  />
                                <ext:ModelField Name="Name" />
                                <ext:ModelField Name="Surname" />
                            </Fields>
                        </ext:Model>
                    </Model>
                </ext:Store>
            </Store>
            <ColumnModel ID="ColumnModel1" runat="server">
                <Columns>
                    <ext:Column ID="Column1" runat="server" DataIndex="CustomerId" Text="CustomerId"  Width="150"  />
                    <ext:Column ID="Column2" runat="server" DataIndex="Name" Text="Name"  Width="150">
                        <Editor>
                            <ext:TextField runat="server" ></ext:TextField>
                        </Editor>
                    </ext:Column>
                    <ext:Column ID="Column3" runat="server" DataIndex="Surname" Text="Surname"  Width="150" />
                </Columns>
            </ColumnModel>    
            <SelectionModel>
                <ext:RowSelectionModel ID="RowSelectionModel1" runat="server" Mode="Multi" /> 
            </SelectionModel>
            <Plugins>
                <ext:CellEditing ID="CellEditing1" runat="server" />
            </Plugins>
        </ext:GridPanel> 
```

实体类没有问题。我从 db 自动生成它并进行了测试。当我编辑名称列时，它会出现以下错误：

```
System.Exception: The key-value pairs that define an EntityKey cannot be null or empty.\r\n
Parameter name: record ---> System.ArgumentException: The key-value pairs that define an EntityKey cannot be null or empty.\r\n
Parameter name: record\r\n 
at System.Data.EntityKey.CheckValue(String argumentName, String keyFieldName, Object value, PrimitiveType expectedType)\r\n 
at System.Data.EntityKey.CheckKeyValues(EntitySet entitySet, IExtendedDataRecord record, String[]& keyNames, Object& singletonKeyValue, Object[]& compositeKeyValues)\r\n 
at System.Data.EntityKey..ctor(EntitySet entitySet, IExtendedDataRecord record)\r\n at System.Data.Objects.ObjectStateManager.FixupKey(EntityEntry entry)\r\n at System.Data.Objects.EntityEntry.AcceptChanges()\r\n at System.Data.Objects.ObjectContext.AcceptAllChanges()\r\n at System.Web.UI.WebControls.EntityDataSourceView.ExecuteUpdate(IDictionary keys, IDictionary values, IDictionary oldValues)\r\n at System.Web.UI.DataSourceView.Update(IDictionary keys, IDictionary values, IDictionary oldValues, DataSourceViewOperationCallback callback)\r\n at Ext.Net.Store.MakeUpdates(IDataSource ds, JArray data) in C:\\Users\\Geoffrey McGill\\Documents\\Visual Studio 2010\\Projects\\Ext.NET\\v2\\Ext.Net\\Ext\\Data\\Store.cs:line 890\r\n at Ext.Net.Store.MakeChanges() in C:\\Users\\Geoffrey McGill\\Documents\\Visual Studio 2010\\Projects\\Ext.NET\\v2\\Ext.Net\\Ext\\Data\\Store.cs:line 829\r\n at Ext.Net.Store.DoSaving(String action, String jsonData, JToken parameters) in C:\\Users\\Geoffrey McGill\\Documents\\Visual Studio 2010\\Projects\\Ext.NET\\v2\\Ext.Net\\Ext\\Data\\Store.cs:line 793\r\n --- End of inner exception stack trace ---\r\n at Ext.Net.Store.DoSaving(String action, String jsonData, JToken parameters) in C:\\Users\\Geoffrey McGill\\Documents\\Visual Studio 2010\\Projects\\Ext.NET\\v2\\Ext.Net\\Ext\\Data\\Store.cs:line 806\r\n at Ext.Net.Store.RaiseAjaxPostBackEvent(String eventArgument) in C:\\Users\\Geoffrey McGill\\Documents\\Visual Studio 2010\\Projects\\Ext.NET\\v2\\Ext.Net\\Ext\\Data\\Store.cs:line 1131 
```

当我编辑 gridpanel 的单元存储时，发送以下 ajax 请求；

```
submitDirectEventConfig:{"config":{"serviceParams":"[{\"CustomerId\":\"3         \",\"Name\":\"e\",\"Surname\":\"soyad1    \",\"id\":null}]"}}
RowSelectionModel1:[{"RecordID":null,"RowIndex":2}]
__EVENTTARGET:ResourceManager1
__EVENTARGUMENT:Store1|postback|updat 
```

e

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T08:21:38.493

另一个步骤，发现标签的“IdPropery”属性并为其分配“CompanyId”值

```
 <ext:Model ID="Model1" runat="server" IDPropery="CompanyId"> 
```

然后通过前面的异常。现在它在下面给出了这个例外；

```
System.Exception: Error while setting property 'id': 'Object of type 'System.Int32' cannot be converted to type 'System.String'.'. ---> System.Web.UI.WebControls.EntityDataSourceValidationException: Error while setting property 'id': 'Object of type 'System.Int32' cannot be converted to type 'System.String'.'.\r\n 
at System.Web.UI.WebControls.EntityDataSourceUtil.SetAllPropertiesWithVerification(EntityDataSourceWrapper entityWrapper, Dictionary`2 changedProperties, Boolean overwrite)\r\n 
at System.Web.UI.WebControls.EntityDataSourceView.ExecuteUpdate(IDictionary keys, IDictionary values, IDictionary oldValues)\r\n 
at 
.... 
```

有没有办法在模型中使用字符串 id 字段？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T18:32:41.797

最后我修改了 ext.net 源代码并且错误消失了。在 store.cs 中更改了下面的代码

```
 if (id.IsNotEmpty())
        {
            string idStr = token.Value<string>(id);

            int idInt;

            if (int.TryParse(idStr, out idInt) && 1==0) // disable this logic
            {
                keys[id] = idInt;
            }
            else
            {
                keys[id] = idStr;
            }
        } 
```

我希望这个解决方案对您有所帮助。

# javascript - 单击事件忽略 Jquery 中的 if/else

> ID：12099596
> 
> 赞同：2
> 
> 时间：2012-08-23T20:37:33.977
> 
> 标签：javascript, jquery

我认为这很简单：我想要的只是让 JS 检测点击链接的子 img 是否具有某个 src 属性。如果是，做一件事。如果没有，请执行其他操作。但由于某种原因，点击事件完全忽略了 if/else 条件。`.children()`如果选择器和事件仍然会像条件为真一样执行，我可以放任何我想要的废话。我不太了解Jquery，所以我很茫然。任何帮助，将不胜感激。

```
$('.addcomp').click(function(){
                if($(this).children('img[src="add.png"]')){
                    $(this).parents("tr").find('.compcost').addClass('cost').end().find('td:last-child,td:nth-child(3)').addClass('addcompbg');
                    $(this).children("img").attr("src","forbidden.png");
                }
                else if ($(this).children('img[src="forbidden.png"]'))
                {$(this).parents("tr").find('.compcost').removeClass('cost').end().find('td:last-child,td:nth-child(3)').removeClass('addcompbg');
                    $(this).children("img").attr("src","add.png");
                    }
            }); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T20:38:39.927

改为使用`$(this).children('img[src="add.png"]').length`。[`$()`](http://api.jquery.com/jQuery/)将*始终*返回一个 jQuery 对象，无论是否匹配，因此它将始终像`true`在`if`.

# drupal - 你能为 Drupal 推荐一个响应式主题吗

> ID：12099599
> 
> 赞同：-4
> 
> 时间：2012-08-23T20:37:38.987
> 
> 标签：drupal, mobile

你能为 Drupal 推荐一个响应式主题吗？我见过的一些选项包括 Omega、Zen 和 Bootstrap。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T11:16:44.940

对于响应式主题，您应该选择 Omega 主题 - [http://drupal.org/project/omega](http://drupal.org/project/omega) 这是迄今为止最适合计算机、平板电脑或移动设备的响应式主题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T13:46:52.097

查看自适应主题，它是具有大量设置的基本主题，开箱即用，可用于移动[http://drupal.org/project/adaptivetheme](http://drupal.org/project/adaptivetheme)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-11T22:51:52.963

我个人喜欢 Twitter Bootstrap。有一个 Drupal 项目有一个 Drupal 的引导主题（[https://drupal.org/project/bootstrap](https://drupal.org/project/bootstrap)）。

# mysql - mysql过程 - 在第二个查询中使用重新格式化日期的结果

> ID：12099600
> 
> 赞同：0
> 
> 时间：2012-08-23T20:37:40.927
> 
> 标签：mysql, variables, date, format, procedure

我需要创建一个过程： 1）从表中的字段中选择一些文本并将其存储在变量中 2）更新相同的记录字段，仅添加 yyyymmdd 格式的日期以及额外的文本输入到过程中......像这样...

```
delimiter //
create procedure table1.sp_updateComment (IN inputIP varchar(15), IN inputAccount varchar(10))
begin
start transaction;
select comment from table1 where ip = inputIP;
update table1 set comment = '<comment from above> + yyyymmdd + inputAccount', status = 'u' where ip = inputIP;
commit;
end;
//
delimiter ;
; 
```

提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:47:29.383

使用[SELECT...INTO](http://dev.mysql.com/doc/refman/5.5/en/select-into.html)选择一些值并将其存储在变量中：

```
SELECT comment INTO @my_comment_variable FROM table1 WHERE ip = inputIP; 
```

但是，在您的情况下似乎没有必要。尝试使用[CONCAT](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_concat)：

```
UPDATE table1
SET comment = CONCAT(comment, DATE_FORMAT(CURDATE(), "%Y%m%d"), inputAccount'), status = 'u'
WHERE ip = inputIP; 
```

# c# - C#在扩展方法中替换原始字符串的值

> ID：12099605
> 
> 赞同：12
> 
> 时间：2012-08-23T20:38:00.927
> 
> 标签：c#

我正在尝试为带有一个参数的字符串编写扩展方法，并将参数附加到字符串的值。这是我想要的行为：

```
 public static void AddNumber(this string originalValue, string id)
    {
        List<string> ids = originalValue.Split(new char[] { ',' }, StringSplitOptions.RemoveEmptyEntries).ToString();
        ids.Add(id);
        string newValue = string.Join(",", ids);
        originalValue = newValue;
    } 
```

然后我想按如下方式使用它：

```
 string testing = "";
        testing.AddNumber("1"); // value should be 1
        testing.AddNumber("2"); // value should be 1,2
        testing.AddNumber("3"); // value should be 1,2,3 
```

问题是我看到了这个：

```
 string testing = "";
        testing.AddNumber("1"); // value is ""
        testing.AddNumber("2"); // value is ""
        testing.AddNumber("3"); // value is "" 
```

现在我已经阅读了[这个](https://stackoverflow.com/questions/2326734/how-can-i-get-an-extension-method-to-change-the-original-object)！StackOverflow 上的问题，我知道我正在做类似的事情。我无法替换字符串的整个值，我必须修改通过发送的字符串的内容......我只是找不到修改它的方法。我试过修改字符数组并且没有运气。有任何想法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-23T20:38:59.680

字符串是**不可变**的。
这是根本不可能的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-23T20:39:30.577

要实现这一点，您必须通过`this string originalValue`as `ref`，但这是不可能的。但是，您可以使用普通方法执行此操作：

```
public static void AddNumber(ref string originalValue, string id) 
```

但它必须像这样调用：

```
AddNumber(ref testing, "1"); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-23T20:41:37.370

您必须像这样使用此方法：

```
public static string AddNumber(this string originalValue, string id)
    {
        List<string> ids = originalValue.Split(new char[] { ',' }, StringSplitOptions.RemoveEmptyEntries).ToString();
        ids.Add(id);
        string newValue = string.Join(",", ids);
        return newValue;
    }

testing = testing.AddNumber("1"); 
```

但是您可以使用以下命令执行此操作`StringBuilder`：

```
public static void AddNumber(this StringBuilder builder, string id)
{
    var originalValue = builder.ToString();
    if (originalValue.EndsWith(",") || string.IsNullOrEmpty(originalValue))
         builder.Append(id);
    else
         builder.Append("," + id);
}

var testing = new StringBuilder();
testing.AddNumber("1");
testing.AddNumber("2");
testing.AddNumber("3"); 
```

我也改变了算法。看起来效率不高。

# mysql-python - mysqldb-python 中的一个检查答案方法

> ID：12099606
> 
> 赞同：0
> 
> 时间：2012-08-23T20:38:10.733
> 
> 标签：mysql-python

我想根据 mysqld 值检查用户对输入框小部件的输入，并在消息框中发出一条消息，说明他的答案是正确还是错误。一个例子可以是包含姓名和电话号码的数据库；如果用户输入给定名称的正确电话号码，则消息框会显示“您是对的”。否则“你错了”。姓名和电话号码在 mysqld 数据库中。因此，用户只能在其中一个输入框中看到姓名，而另一个输入框将是空的，供他输入电话号码。你能帮我么。

```
# prepare a cursor object using cursor() method
cursor = db.cursor()

# Execute the SQL command
cursor.execute("SELECT * FROM PHONES")

# Fetch all the rows in a list of lists
row0 = cursor.fetchone()[0]
row1 = cursor.fetchone()[1]
row2 = cursor.fetchone()[2]

#checking the values in a single row
if row1 == nameVar.get() and row2 == phoneVar.get():

    tkMessageBox.showinfo("MCPHS Alpha Brand & Generic","You are right.") 

elif row1 != nameVar.get() and row2 != phoneVar.get():

    tkMessageBox.showerror("Check answer","Wrong answer")
else:

    tkMessageBox.showerror("Check answer","Enter an answer")

# disconnect from server
db.close() 
```

然后我会调用这样的方法

```
 b7 = Button(frame2,text="Check Answer",command=checkAnswer) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T20:47:31.213

您似乎使用`cursor.fetchone()`不正确。它返回单行，即列值的元组，但`None`如果结果集中没有更多行，它将返回。您似乎正在尝试获取列值，但您`fetchone()`多次调用，因此您从每一行获取不同的列。

您的 SQL 查询`SELECT * FROM PHONES`有缺陷：没有 WHERE 子句，因此这会选择表中的每一行，这可能不是您想要的。通过使用该`*`符号，读者无法确切知道返回了哪些列；并且它们可能会以意想不到的顺序被退回。我猜你想要这样的东西：

```
name = nameVar.get()
cursor.execute("SELECT phone from PHONES WHERE name=%s", (name,))
row = cursor.fetchone()
if not row:
    # row matching name not found
    break
phone = row[0]
# compare to submitted values 
```

或者，您可以使用 SQL`COUNT()`函数：

```
name = nameVar.get()
phone = phoneVar.get()
cursor.execute("SELECT COUNT(*) FROM PHONES WHERE name=%s and phone=%s", (name, phone))
count = cursor.fetchone()[0] # this query should always return exactly one row
if count:
    # data matched
else: 
    # it didn't match 
```

# xml - 使用 Perl 的 LibXML 解析带有换行符/换行符的 XML

> ID：12099614
> 
> 赞同：1
> 
> 时间：2012-08-23T20:38:35.587
> 
> 标签：xml, perl, libxml2

[`XML::LibXML`](https://metacpan.org/module/XML%3a%3aLibXML)我正在尝试使用 Perl 的模块解析一系列 XML 文件。

```
<log date="2012-08-07 18:05:44.0" level="unit" label="2G-or-3G-server" name="unitnote" value="# Firmware level after downgrade
#
-&amp;gt; show /HOST

 /HOST
    Targets:
        bootmode
        diag
        domain ...." 
```

其中一些值包含脚本执行的输出。当我尝试解析这些值时，我最终得到如下内容：

```
my $value  = $log->findvalue('@value');
print "value: $value\n"; 
```

输出：

```
# Firmware level after downgrade    #   -&amp;gt; show /HOST  /HOST  Targets:      bootmode        diag        domain .... 
```

我似乎找不到任何方法让 LibXML 尊重换行符。任何的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:59:23.077

[XML 1.0 规范](http://www.w3.org/TR/2008/REC-xml-20081126/#AVNormalize)规定属性值（空格、CR、LF、制表符）中的任何空白字符必须在处理之前转换为空格

不幸的是，任何正常工作的 XML 处理器都会给你同样的问题

这是非常奇怪的 XML。它从哪里来的？该`value`属性实际上应该显示为 PCDATA，以便可以正确处理它。有什么办法可以改变你得到的数据？

If there is any way you could preprocess the data so that your newlines are replaced with character references `&#xA;` then they will be translated to LF characters when the data is processed. This really should be done by whatever is generating the XML

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T20:51:33.550

[XML 规范](http://www.w3.org/TR/REC-xml/)的[Attribute-Value Normalization](http://www.w3.org/TR/REC-xml/#AVNormalize)部分*需要*[XML::LibXML](http://search.cpan.org/perldoc?XML%3a%3aLibXML)展示的行为。

 *> 对于空格字符（#x20、#xD、#xA、#x9），将空格字符（#x20）附加到标准化值。

没有[记录](http://search.cpan.org/perldoc?XML%3a%3aLibXML%3a%3aParser)的选项可以更改此行为。

如果假设属性值包含换行符，`&#x0A;`或者必须使用类似的值而不是实际的换行符。*

# xml - JSON 和 XML 的 WCF 文档

> ID：12099621
> 
> 赞同：1
> 
> 时间：2012-08-23T20:38:59.117
> 
> 标签：xml, json, wcf, documentation-generation

我正在 为 WCF 文档使用[Sandcastle 帮助文件生成器。](http://shfb.codeplex.com/releases/view/81770)它正在为 SOAP 和 C# 创建完美的文档。我还有 2 个其他端点，它们是 JSON 和 XML。有没有办法为这些端点生成文档？比如获取请求样品等？

谢谢。

# python - 使用python替换xml文件中的兄弟姐妹

> ID：12099628
> 
> 赞同：0
> 
> 时间：2012-08-23T20:39:25.197
> 
> 标签：python, xml, replace, find, siblings

我想要一种在 YAMJ 的 xml 文件中更改已观看电影状态的方法。我可以提供 baseFilenameBase、fileLocation 和 fileURL。我需要将这两个被监视的元素更改为 true。

```
<library count="1">
   <category count="1" current="true" name="Other">
      <index </index>
   </category>
   <movies cols="18" count="18" indexCount="673" totalCount="737">
      <movie isExtra="false" isSet="false" isTV="false">
         <baseFilenameBase>FILE NAME</baseFilenameBase>
         <watched>false</watched>
         <files>
            <file firstPart="1" lastPart="1" season="-1" size="0" subtitlesExchange="NO"
                  title="UNKNOWN"
                  watched="false"
                  zcd="2">
               <fileLocation>PATH TO FILE</fileLocation>
               <fileURL>PATH TO FILE</fileURL>
            </file>
         </files>
      </movie>
      <movie

      And repeats .....
    </movies>
</library> 
```

我已经设法替换了在其他 xml 文件中观看的内容

```
 doc = parse(file)
                node = doc.getElementsByTagName('watched')
                node[0].firstChild.nodeValue = 'true' 
```

与试图与兄弟姐妹/邻居相处相比，这非常简单

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:56:34.137

```
 msg = 'Starting xml update in '.format(updatexmlwatched)
            Debug(msg)
            pchtrakt.logger.info(msg)
            if pchtrakt.isMovie:
                xmlpath = updatexmlwatched + "Other*.xml"
                for name in glob.glob(xmlpath):
                    if myMedia.oStatus.fileName[:-4] in open(name).read():#gets xml file name as name
                        tree = ElementTree.parse(name)
                        for movie in tree.findall('movies/movie'):
                            if movie.find('baseFilenameBase').text == myMedia.oStatus.fileName[:-4]:#for  content in penContents:
                                movie.find('watched').text = 'true'
                                for mfile in movie.findall('files/file'):
                                    mfile.set('watched', 'true')
                                    bak_name = name[:-4]+'.bak'
                                    tree.write(bak_name)
                                    os.rename(bak_name, name)
                                    txt = name.replace(updatexmlwatched, '') + ' has been modified as watched for ' + myMedia.oStatus.fileName
                                    Debug(txt)
                                    pchtrakt.logger.info(txt)
                                    break
            elif pchtrakt.isTvShow:
                a = re.split("([-|.]*[Ss]\\d\\d[Ee]\\d\\d.)", myMedia.oStatus.fileName)
                ep_name = a[2][:-4].replace(".", " ").replace("- ", "")
                season_xml = a[0][:-3].replace(".", " ").replace(" - ", "")
                f_size = str(os.path.getsize(myMedia.oStatus.fullPath))
                ep_no = '01'
                fileinfo = updatexmlwatched + "Set_" + season_xml + "*.xml"
                for name in glob.glob(fileinfo):
                    if myMedia.oStatus.fileName in open(name).read():
                        tree = ElementTree.parse(name)
                        for movie in tree.findall('*/movie/files/file'):
                            if movie.get('firstPart') == str(myMedia.parsedInfo.episode_numbers[myMedia.idxEpisode]) and movie.get('season') == str(myMedia.parsedInfo.season_number):
                                movie.set('watched', 'true')
                                bak_name = name[:-4]+'.bak'
                                tree.write(bak_name)
                                os.rename(bak_name, name)
                                txt = name.replace(updatexmlwatched, '') + ' has been modified as watched for ' + myMedia.oStatus.fileName
                                Debug(txt)
                                pchtrakt.logger.info(txt)
                                break
                fileinfo = updatexmlwatched + "Other*.xml"
                for name in glob.glob(fileinfo):
                    if myMedia.oStatus.fileName in open(name).read():
                        tree = ElementTree.parse(name)
                        for movie in tree.findall('*/movie/files/file'):
                            if movie.get('size') == f_size and movie.get('firstPart') == str(myMedia.parsedInfo.episode_numbers[myMedia.idxEpisode]) and movie.get('season') == str(myMedia.parsedInfo.season_number):
                                movie.set('watched', 'true')
                                bak_name = name[:-4]+'.bak'
                                tree.write(bak_name)
                                os.rename(bak_name, name)
                                txt = name.replace(updatexmlwatched, '') + ' has been modified as watched for ' + myMedia.oStatus.fileName
                                Debug(txt)
                                pchtrakt.logger.info(txt)
                                break 
```

这就是我最终的结果。它确实有效，但如果 xml 在网络共享上，有时会导致正在播放的媒体卡顿。我相信它正在搜索包含变量的 xml 时发生。在低功耗媒体播放器上运行时，是否有一种不那么耗费系统的方式来执行此操作。

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:49:40.877

以下将在所有电影和文件中设置为 true，您应该对其进行调整以仅更改您想要的内容，并将 movies.xml 更改为您的文件名。

```
from xml.etree import ElementTree

tree = ElementTree.parse('movies.xml')

for movie in tree.findall('movies/movie'):
    movie.find('watched').text = 'true'
    for mfile in movie.findall('files/file'):
        mfile.set('watched', 'true')

tree.write('movies.xml') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-23T05:22:54.747

如果你在一个应该有`sed`它的小型媒体服务器上运行，也许 python 不是答案。

```
sed -i 's/<watched>false/<watched>true/g' movies.xml 
```

只需检查`sed`您拥有的版本，`sed -h`以便了解可用的选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-17T11:03:28.640

假设您的 baseFilenameBase 是唯一的，一个简单的方法如下：我不能评论，所以我不能将它添加到 sp 的答案中。

神奇的是 xpath 表达式 "//movie[baseFilenameBase/text() = 'PATHHERE']" 这是一个 xpath 表达式，它表示：

*   //movie -- 查找所有电影节点
*   [CONDITION] -- 条件为真
*   baseFilenameBase/text() = 'PATHHERE' -- 表示它必须有一个 baseFilenameBase 节点的条件，包含文本 'PATHHERE'

然后我使用格式将路径变量的内容放入其中。XPath 是引用 xml 节点的绝佳语法，[请查看此处以获取更多信息](http://www.w3schools.com/xsl/xpath_syntax.asp)

ps 我必须承认我没有运行这个。但我认为没有任何语法错误，它应该可以工作。

```
from xml.etree import ElementTree

tree = ElementTree.parse('movies.xml')
movie = tree.find("//movie[baseFilenameBase/text() = '{}']".format(path))
movie.find('watched').text = 'true'
for file in movie.find('files').findall('file')
    file.set("watched", 'true')

tree.write('movies.xml') 
```

# java - 为什么我会收到“错误：预期；” 在访问字符串时？

> ID：12099635
> 
> 赞同：1
> 
> 时间：2012-08-23T20:40:01.683
> 
> 标签：java, javascript, jsp

我正在访问 Javascript 中的 JSP 变量并打印它（这是我代码中的确切上下文）。但是，它显示“例外；” 在第 9 行（第 9 行代码是 document.write(na);)..

有没有办法在 javascript 中访问以下格式的 JSP 字符串？

```
<%
String name = "Java Beans  \"is\" a reusable component";
%>

<html>
<head>
<script>
var na = "<%=name%>";

document.write(na);
</script>
</head>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:45:13.803

您需要使用单引号来包装变量 - 该值*包含*双引号，这会破坏输出，正如 JavaScript 将看到的那样：

```
var na = "Java Beans "is" a reusable component";
                    ^^^^^^ 
```

而是这样做：

```
document.write('<%=name%>'); 
```

...注意单引号。

干杯

# c# - 将 WM 消息发送到 Web 浏览器输入

> ID：12099637
> 
> 赞同：0
> 
> 时间：2012-08-23T20:40:11.717
> 
> 标签：c#, forms, input, browser, windows-messages

我这里有一个用于聊天室的网络浏览器 (OpenWebKitSharp)。我正在编写一个与 IRC 机器人非常相似的机器人。但是，输入字段没有提交表单或按钮。文本只能通过按 enter 发送，并且 Javascript 非常模糊。

我如何 a) 以编程方式获取该输入字段的焦点（如果不需要，可选），以及 b) 如何向该输入字段发送输入键 c) 在不激活窗口的情况下执行所有这些操作？

通过 Javascript 或 C#。如果我不能，我有什么选择？

（我也试过查看 HTTP，但这个聊天似乎没有使用它。）

# xcode - 调度全局队列崩溃

> ID：12099640
> 
> 赞同：0
> 
> 时间：2012-08-23T20:40:35.523
> 
> 标签：xcode, multithreading, queue

因此，我有一个应用程序可以进行大量数学运算，但仅当我使用全局调度队列进行多线程时它才会崩溃。我想我可能做错了。谁能解释为什么这会导致崩溃？或者至少我可以如何尝试调试它。

如果我这样做，它会很好地打印出答案。我用仪器查看了代码，它没有泄漏或任何东西。

```
NSStringEncoding encoding;
NSError *error;

//Read in data file
NSString *Data1FileContent = [NSString stringWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"data1" ofType:@"txt"] usedEncoding:&encoding error:&error];
NSMutableArray *strides = [[Data1FileContent componentsSeparatedByString:@"\n"] mutableCopy];

//Read in data file
NSString *Data2FileContent = [NSString stringWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"data2" ofType:@"txt"] usedEncoding:&encoding error:&error];
NSMutableArray *gaitTimes = [[Data2FileContent componentsSeparatedByString:@"\n"] mutableCopy];

//Math
NSMutableArray *result = [gaitlyapunov gaitlyapunov:strides withTimeSteps:gaitTimes withFreq:150 withSegmentApproach:@"strides"];

NSLog(@"result = %@", result);

[gaitTimes release];
[strides release];

}); 
```

但是，当我尝试在代码中更新 UILabel 时，会导致崩溃。

错误：

```
(lldb) //Thrown randomly in the math 
```

导致问题的代码：

```
//Create a queue
dispatch_async(dispatch_get_global_queue(0, 0), ^{

    //This prints out fine
    dispatch_async(dispatch_get_main_queue(), ^{
        statusText.text = [NSString stringWithFormat:@"processing..."];
    });

NSStringEncoding encoding;
NSError *error;

//Read data
NSString *Data1FileContent = [NSString stringWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"data1" ofType:@"txt"] usedEncoding:&encoding error:&error];
NSMutableArray *strides = [[Data1FileContent componentsSeparatedByString:@"\n"] mutableCopy];

//Read data
NSString *Data2FileContent = [NSString stringWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"data2" ofType:@"txt"] usedEncoding:&encoding error:&error];
NSMutableArray *gaitTimes = [[Data2FileContent componentsSeparatedByString:@"\n"] mutableCopy];

//Math, that causes crash in this code only
NSMutableArray *result = [gaitlyapunov gaitlyapunov:strides withTimeSteps:gaitTimes withFreq:150 withSegmentApproach:@"strides"];

    //This should print the result into the label
    dispatch_async(dispatch_get_main_queue(), ^{
            statusText.text = [NSString stringWithFormat: @"result: %@", result];
    });

[gaitTimes release];
[strides release];

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T22:00:59.550

我将我的问题归结为一个非线程安全的编程问题。有关更多信息，请参见此处：[https](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Multithreading/ThreadSafetySummary/ThreadSafetySummary.html) ://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Multithreading/ThreadSafetySummary/ThreadSafetySummary.html 。

# mysql - 为什么这个查询使用索引？

> ID：12099643
> 
> 赞同：1
> 
> 时间：2012-08-23T20:40:39.920
> 
> 标签：mysql, sql

我有一张包含销售信息的表格。其中一列称为`royalty_currency`，我需要从该表中提取所有不同的货币。这样做的查询是：

```
SELECT distinct `royalty_currency` FROM `sales_raw` 
```

当我在此列上没有索引时，解释语句给了我：

```
id  select_type table   type    possible_keys   key key_len ref rows    Extra
1   SIMPLE  sales_raw   ALL NULL    NULL    NULL    NULL    195121  Using temporary 
```

添加索引后，解释语句给了我：

```
id  select_type table       type    possible_keys key              key_len  ref rows    Extra
1   SIMPLE      sales_raw   range   NULL          royalty_currency92        NULL    211 Using index for group-by 
```

我的问题是，为什么 SELECT 语句需要使用索引？我以为索引是针对`WHERE`子句的？如果只选择一列，为什么需要使用索引？最后，这是我使用的一个常见查询——我应该在这个表上添加一个索引`royalty_currency`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:50:42.177

查询优化器似乎将您的`distinct royalty_currency`需求转换为`group by royalty_currency`. 直观地说，应该清楚两者是相同的。

group-by 使用索引是因为在该列的索引中找到具有相同 'royalty_currency' 的记录比在表本身中更有效（在索引中，这些记录都按顺序存储在 B+ 的叶节点中树索引 - 假设 B+ 树索引）

为了给你更多的技术细节，我可以告诉你 B+ 树的叶子节点是连接在一个链表中的。查询引擎所做的是转到 B+ 树的最右边的叶子（索引）并开始读取每个叶子中的所有值，每次找到一个新值时它都会返回它并忽略其余相同的值价值观。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:50:37.200

索引不仅用于条件，还可以用于连接表之类的事情，在你的情况下，还可以用于分组。

查询被解释为：

```
select royalty_currency from sales_raw group by royaly_currency 
```

索引用于分组，它非常适合索引已经分组。如您所见，使用索引时引用的行数大大减少，从而使查询使用的资源少得多。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-23T20:47:11.627

它在那里说，正在使用`GROUP BY`. 我知道您没有使用显式`GROUP BY`，但这就是它对您的`DISTINCT`. 因此，优化器认为最好使用索引（我假设该列作为他的键的一部分）来获取该列的不同值。

# c# - 如何将 HtmlAgilityPack 添加到 Visual Studio 2010 项目

> ID：12099648
> 
> 赞同：2
> 
> 时间：2012-08-23T20:41:03.590
> 
> 标签：c#, visual-studio-2010, html-agility-pack

我已经下载了最新版本的 HtmlAgilityPack，在其中找到了几个文件夹，如 Net20、Net40 等。我创建了一个新项目并通过添加参考添加了 HtmlAgilityPack。（我从 Net20 文件夹中选择了 .dll），然后编写了一个简单的代码在哪里添加`using HtmlAgilityPack;`。所以现在我有一个错误，即符号不能在使用声明中使用。

怎么了？我想我在图书馆做错了什么。

```
using HtmlAgilityPack;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

int main()
{
HtmlAgilityPack.HtmlDocument htmlDoc = new HtmlAgilityPack.HtmlDocument();

    // There are various options, set as needed
    htmlDoc.OptionFixNestedTags=true;

    // filePath is a path to a file containing the html
    htmlDoc.Load(filePath);

    // Use:  htmlDoc.LoadXML(xmlString);  to load from a string

   // ParseErrors is an ArrayList containing any errors from the Load statement
   if (htmlDoc.ParseErrors!=null && htmlDoc.ParseErrors.Count>0)
   {
       // Handle any parse errors as required

   }
   else
   {

        if (htmlDoc.DocumentNode != null)
        {
            HtmlNode bodyNode = htmlDoc.DocumentNode.SelectSingleNode("//body");

            if (bodyNode != null)
            {
                // Do something with bodyNode
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T22:19:08.217

通过在项目解决方案中右键单击参考文件夹/bin 添加参考

# objective-c - iOS：plist 数据不持久/无法找到文件

> ID：12099654
> 
> 赞同：0
> 
> 时间：2012-08-23T20:41:37.157
> 
> 标签：objective-c, ios, plist, data-storage

我已经对其他有类似问题的人进行了大量研究，为他们提供的解决方案未能解决我的问题，所以我认为它缺少一些明显的东西，或者我正在验证错误和不恰当地试图识别我的错误。

我的问题是，当我尝试以编程方式保存/加载时，找不到我添加的 .plist 文件，以便为我的应用程序提供持久数据存储。

我有：

*   验证它是否列在我项目的“构建阶段”选项卡中的“复制捆绑资源”下。
*   验证该文件正在被复制到我的 /Users/Me/Library/Application Support/iPhone Simulator/5.1/Applications/Unique App ID/myapp.app 文件夹，如果删除并重新运行，它会再次出现。
*   清理并重建我的项目

我的代码被组织成保存和加载发生在两个不同的位置。当调出模态视图并且用户能够选择各种数据集时，就会发生加载。保存发生在应用程序委托`- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`函数中。我已经验证了这两个函数都被调用了，尽管这种行为让我完全被难住了。

根据开发人员资源 plist 文章，相当样板的保存和加载代码：

```
- (void)applicationDidEnterBackground:(UIApplication *)application
{    
    NSDictionary *someDataToSave = [NSDictionary dictionaryWithObject:self.viewController.dataStorage forKey:@"myData"];

    NSString *error;
    NSString *rootPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
    NSString *plistPath = [rootPath stringByAppendingPathComponent:@"someData.plist"];
    plistPath = [rootPath stringByAppendingPathComponent:@"someData.plist"];
    if (![[NSFileManager defaultManager] fileExistsAtPath:plistPath]) {
        plistPath = [[NSBundle mainBundle] pathForResource:@"someData.plist" ofType:@"plist"];
    }

    NSString *generatedName = [NSString stringWithFormat:@"DataSet - %s", [NSDate date]];

    NSDictionary *plistDict = [NSDictionary dictionaryWithObject:someDataToSave forKey:generatedName];
    NSData *plistData = [NSPropertyListSerialization dataFromPropertyList:plistDict format:NSPropertyListXMLFormat_v1_0 errorDescription:&error];

    if(plistData)
        [plistData writeToFile:plistPath atomically:YES];
    else {
        NSLog(error);
    }
}

-(void)loadRecordsFromPList
{

    NSString *errorDesc = nil;
    NSPropertyListFormat format;
    NSString *plistPath;
    NSString *rootPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];

    plistPath = [rootPath stringByAppendingPathComponent:@"someData.plist"];
    if (![[NSFileManager defaultManager] fileExistsAtPath:plistPath]) {
        plistPath = [[NSBundle mainBundle] pathForResource:@"someData.plist" ofType:@"plist"];
    }

    NSData *plistXML = [[NSFileManager defaultManager] contentsAtPath:plistPath];
    NSDictionary *temp = (NSDictionary *)[NSPropertyListSerialization propertyListFromData:plistXML mutabilityOption:NSPropertyListMutableContainersAndLeaves format:&format errorDescription:&errorDesc];

    if (!temp) {
        NSLog(@"Error reading plist: %@, format: %d", errorDesc, format);
    }

    self.myRecordsList = [NSMutableDictionary dictionaryWithDictionary:temp];    
} 
```

我在调试器中花了几个小时尝试各种事情，但我所做的任何调整都没有让我到任何地方。fileExistsAtPath 始终无缘无故地返回 null，尽管我在文件夹中看到了该文件，但仍找不到该文件。此外，我创建了一个仅包含一个 plist 文件的单一视图应用程序，以及一个视图控制器，其中我使用了与上面相同的 99% 的代码，并且它可以正常工作。

任何人都可以提供的任何帮助将不胜感激。在这一点上，我已经尝试了我能想到的一切，然后是一些。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:53:30.583

在`applicationDidEnterBackground`中，`plistPath`如果 Documents 目录中没有 plist 文件，则设置为主包内的路径。然后您*使用相同的路径*来编写 plist 文件。换句话说，您尝试将字典写入应用程序主包中的 plist 文件。

只有`loadRecordsFromPList`先查看 Documents 文件夹，然后再查看主包才有意义。保存数据时，必须始终保存到 Documents 文件夹。

# php - 使用 iframe 或 javascript 将内容加载到 div

> ID：12099656
> 
> 赞同：0
> 
> 时间：2012-08-23T20:41:39.110
> 
> 标签：php, javascript, html, css, iframe

我正在为我的乐队建立一个网站。我已经完成了主页。我想将其他页面加载到中心 div 中，#center_content 而不更改/重新加载页面上的任何其他内容。我应该使用 iframe 执行此操作吗？JavaScript？php？我在这些方面都没有经验，但它们似乎是我的选择。哪一个是最好的，有人可以提供一个起点或链接到一个适合我想要做的教程吗？

到目前为止，这是我的网站：http: [//img.photobucket.com/albums/v410/justice4all_quiet/ScreenShot2012-08-23at22259PM.png](http://img.photobucket.com/albums/v410/justice4all_quiet/ScreenShot2012-08-23at22259PM.png)

这是一个 jsFiddle：http: [//jsfiddle.net/BRPNM/](http://jsfiddle.net/BRPNM/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:13:51.747

如果中心内容很小，那么您可以在一个页面中加载所有内容，然后使用内联导航来显示/隐藏相关部分。这就是我在这个基本网站上的做法（查看右侧按钮）： [http ://usermanagedsolutions.com](http://usermanagedsolutions.com)

如果中心内容很重要，那为什么不加载整页呢？一个好的设计，所有页面共有的部分都会被缓存，加载一个新页面不会比仅仅加载中心内容花费更多的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T23:57:29.663

如果“加载页面”是指加载某些内容（如“关于”、“照片”），您可以加载所有内容但不可见（在 div 中设置为`display:none;`）并使用 jQuery 显示这些 div `.show()`。

您可以在此处查看 .show 的工作原理 - 参见演示 -：http://api.jquery.com/show/ [（](http://api.jquery.com/show/)您也可以使用`.animate()`给内容一些效果）。

这样，您的信息将被搜索引擎索引。你也可以只使用 CSS，但在这种情况下，JS 会更快更干净。

# c# - 当我的应用程序指向其他地方时，如何使用 Url.Action 和 Html.ActionLink？

> ID：12099658
> 
> 赞同：1
> 
> 时间：2012-08-23T20:41:44.450
> 
> 标签：c#, asp.net-mvc

我在apps.server.com/appname 上托管了一个C# MVC 应用程序，但我在公司的F5 上进行了URL 重写，这使得该应用程序对www.server.com/apps/appname 可见。现在，当我导航到该 url 时，没有图像或链接起作用，因为在使用 @Url.Content("~/URL") 时它们都指向 www.server.com/appname。我需要做什么才能让我的所有帮助程序类知道我在一个别名 URL 下，而不是它认为的位置（即，apps.server.com URL）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T07:48:55.690

如果您在 IIS 7 集成管道模式下运行，请尝试将以下内容放入您的`Global.asax`：

```
protected void Application_BeginRequest(object sender, EventArgs e)
{
    Request.ServerVariables.Remove("IIS_WasUrlRewritten");
} 
```

# sql - 从右表返回一行包含许多记录

> ID：12099659
> 
> 赞同：2
> 
> 时间：2012-08-23T20:41:45.277
> 
> 标签：sql, postgresql

我有两张桌子。一个是产品列表，一个是其许多属性的列表。（这已经从我的原始模型中简化了。;））

表`prods`有两列：`id`和`name`。
表`taxons`包含三列：`id`、`name`和`prod_id`。

`Prods`有四个记录：

```
编号 | 姓名
= = = = = =
 1 | 船
 2 | 树
 3 | 灯
 4 | 苏打
```

`Taxons`有十五条记录：

```
编号 | 姓名 | prod_id
= = = = = = = = = = = = = =
 1 | 明亮 | 3
 2 | 微风 | 1
 3 | 绿色 | 2
 4 | 湿 | 1
 5 | 坚固 | 2
 6 | 阴暗 | 2
 7 | 古董| 3
 8 | 落叶 | 2
 9 | 浮力 | 1
 10 | 起泡 | 4
 11 | 平静| 2
 12 | 无忧无虑 | 1
 13 | 大| 1
 14 | 甜 | 4
 15 | 黄铜 | 3
```

我想要的是一个使用and加入的`taxons`查询，但只返回 4 行，所以是这样的：`prods``prods.id``taxons.prod_id`

（所需）结果：

```
1 | 船| 高分辨率照片| CLIPARTO 微风 | 湿 | 浮力 | 无忧无虑 | 大的
2 | 树 | 绿色 | 坚固 | 阴暗 | 落叶 | 镇定
3 | 灯| 明亮 | 古董| 黄铜
4 | 苏打水| 起泡 | 甜的
```

我不知道该去哪里，我尝试了各种联合和连接的组合，但没有找到任何有效的方法。我们正在使用 postgres。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:08:51.553

要在一列中获取所有值，您可以使用`array_agg()`：

```
select p.id, array_agg(t.name) list
from prods p
inner join taxons t
   on p.id = t.prod_id
group by p.id 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!1/e6ed0/6)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T20:46:38.287

应该能够适应`GROUP_CONCAT`本文中的等价物：

[Postgresql GROUP_CONCAT 等效？](https://stackoverflow.com/questions/2560946/postgresql-group-concat-equivalent)

# c# - 如何在不下载文件的情况下使用在线 CSV 文件数据作为值

> ID：12099662
> 
> 赞同：0
> 
> 时间：2012-08-23T20:42:01.420
> 
> 标签：c#, php

您好我有一个下载 CSV 文件的链接，我想使用里面的数据来建立我的网站，但我不会下载文件，有什么办法吗？链接是：[http ://www.nasdaq.com/screening/companies-by-name.aspx?letter=0&exchange=nasdaq&render=download](http://www.nasdaq.com/screening/companies-by-name.aspx?letter=0&exchange=nasdaq&render=download)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:43:48.053

您需要获取文件以获取其中的数据。

之后让您的服务器将其删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:46:11.280

您可以在运行时使用 cURL 获取文件的内容。

```
$url = "http://www.nasdaq.com/screening/companies-by-name.aspx?letter=0&exchange=nasdaq&render=download";
$ch = curl_init(); 
curl_setopt($ch, CURLOPT_URL, $url); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE); 
$data = curl_exec($ch); 
curl_close($ch); 
```

`$data`现在将包含该文件的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T20:43:57.507

使用 fopen() 或 PHP cURL 库：

fopen() （通常这不如 cURL 安全，当 PHP 设置文件中不允许使用 fopen 时，您可能会遇到问题，但这是一种快速而肮脏的方法）：

```
// Load file into resource from URL.
$fileHandle = fopen("http://www.nasdaq.com/screening/companies-by-name.aspx?letter=0&exchange=nasdaq&render=download", "r");
// Edit: Load file resource into string.
$fileContents = fread($fileHandle);
echo $fileContents; 
```

cURL（首选方式。在此处阅读 cURL：http: [//php.net/manual/en/book.curl.php](http://php.net/manual/en/book.curl.php)）：

```
$curl = curl_init(); // Open a cURL library resource.

// Set the resource option for the URL.
curl_setopt($curl, CURLOPT_URL, "http://www.nasdaq.com/screening/companies-by-name.aspx?letter=0&exchange=nasdaq&render=download");
// Set the resource option to let it return a value from the execution function.
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);

$file = curl_exec($curl); // Execute cURL, load the result into variable $file.
curl_close($curl); // Close the cURL resource.

print_r($file); // The file should now be a string, exactly the CSV string that was scraped. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T20:47:34.330

您使用的是 C# 还是 PHP？我的解决方案是 C#。

```
HttpWebRequest req = (HttpWebRequest)WebRequest.Create("http://www.nasdaq.com/screening/companies-by-name.aspx?letter=0&exchange=nasdaq&render=download");
HttpWebResponse resp = (HttpWebResponse)req.GetResponse();
StreamReader reader = new StreamReader(resp.GetResponseStream());

string CSVContents = reader.ReadToEnd(); 
```

CSVContents 现在包含文件的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T20:52:04.760

这是一种通过 Stream 读取数据的方法，而不是将数据内容下载到物理磁盘。这是在 C# 中（无法判断您想要 PHP 还是 C#，因为您的标签包含两者）

```
string uriString = @"http://www.nasdaq.com/screening/companies-by-name.aspx?letter=0&exchange=nasdaq&render=download";
WebClient myWebClient = new WebClient();
Stream myStream = myWebClient.OpenRead(uriString);    //open a stream to the resource
StreamReader sr = new StreamReader(myStream);
Console.WriteLine(sr.ReadToEnd());                    //print contents of stream

myStream.Close(); 
```

# jquery - 插件上的 jquery 在第一个触发后禁用第二个

> ID：12099664
> 
> 赞同：0
> 
> 时间：2012-08-23T20:42:14.650
> 
> 标签：jquery, jquery-ui

我正在使用一个插件`$(".multiselect").twosidedmultiselect();`，它需要一个选择列表并创建第二个“列表”，以便我可以将选定的项目从一个拖到另一个。我还使用 JQuery UI 组件调整大小以允许用户在希望查看更多选择时使选择列表更大。

```
 $(function () {
         $(".rcTestx").resizable({
            maxWidth: 250,
            minWidth: 200,
            minHeight: 75
        }); }); 
```

如果我首先调整选择列表的大小，一切正常，但如果我在触发第一个插件后尝试调整选择列表的大小，则调整大小不再有效。

有任何想法吗？解决此问题的最佳方法可能是什么？

# c# - 从 System.Data.ODBC.ODBCException 中查找 SQL 语法错误的位置？

> ID：12099666
> 
> 赞同：2
> 
> 时间：2012-08-23T20:42:16.247
> 
> 标签：c#, sql, visual-studio-2010, exception-handling, odbc

我的程序的目标是让我们的支持技术人员在以具有有限权限的用户身份登录时，在 Faircom、c-tree Plus 数据库上运行查询。

我有程序在运行，只要他们的脚本很好，就可以了。

但是当他们有错误的表、列或者更糟糕的语法错误时；System.Data.ODBC.ODBCException 中提供的信息似乎无法让我告诉用户他们需要集中注意力在脚本中的哪一行/位置。

引发错误的行：

```
OdbcDataReader reader = command.ExecuteReader(); 
```

异常消息：

```
ERROR [2a504] [FairCom][ODBC FairCom Driver 9.3.55632(Build-110208_120517)][ctreeSQL] -20003 Syntax error 
```

异常。来源：

```
CTODBC9.DLL 
```

异常堆栈跟踪：

```
at System.Data.Odbc.OdbcConnection.HandleError(OdbcHandle hrHandle, RetCode retcode)
   at System.Data.Odbc.OdbcCommand.ExecuteReaderObject(CommandBehavior behavior, String method, Boolean needReader, Object[] methodArguments, SQL_API odbcApiMethod)
   at System.Data.Odbc.OdbcCommand.ExecuteReaderObject(CommandBehavior behavior, String method, Boolean needReader)
   at System.Data.Odbc.OdbcCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Odbc.OdbcCommand.ExecuteReader()
   at QueryDentrixDatabase.Form1.RunQuery(String query) in C:\Users\caanderson\Documents\Visual Studio 2010\Projects\...\Form1.cs:line 193 
```

我真的很想提供比“语法错误”更多的信息

# ms-access - 在 MS Access 中同时导出报告

> ID：12099667
> 
> 赞同：0
> 
> 时间：2012-08-23T20:42:21.607
> 
> 标签：ms-access, ms-access-2007, vba

是否可以同时将多个报告导出为 PDF。如果是，任何人都可以让我知道该怎么做吗？我在网上搜索了很多，但找不到答案。感谢您花时间回答我的问题。

努普尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:55:43.417

“同时”是不可能的，因为 VBA 本身不是多线程的。必须连续运行和导出每个报告。整个过程可以使用 VBA 自动化以使其更容易。

如何以自动化方式完成此操作的一个示例是为首先运行它的每个报告创建一个宏，然后导出结果。使用 VBA 模块依次调用每个宏。您可能需要在每次调用宏之间实现 WAIT 以允许它们有时间执行。

完成后，用户所要做的就是启动 VBA 模块（最简单的按钮单击），然后等待……报告将自动一次吐出一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-30T18:16:13.673

我正在做类似的事情；我有一个季度销售报告，我需要根据该季度每个月的 3 个报告运行。

我找到了一个名为 PDFTK 的实用程序

[https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/](https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/)

这似乎是我想要的，在报告运行后，它将它们合并为一个报告。

我的问题是从子目录深处的 DOS 运行它。我创建了一个批处理文件，它运行该实用程序并将 M1、M2 和 M3 报告连接到一个文件中，但是让 MSFT Access 打开，然后更改到正确的目录，并调用批处理文件并以某种方式让它知道我' m 试图连接这个特定子目录中的文件是有问题的。

这是我到目前为止得到的批处理文件：

```
pdftk m1.pdf m2.pdf m3.pdf cat output salesreportqtr.pdf 
del m1.pdf
del m2.pdf
del m3.pdf 
```

但是，因为目录每次都在变化，我无法让程序正确调用它。如果 USER 弹出到 DOS（对我的用户来说不可能，他们甚至拒绝查看 DOS）并运行程序，一切都会正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T20:47:05.900

您可以使用 DoCmd 对象的 SendObject 方法：

[http://msdn.microsoft.com/en-us/library/bb214075(v=office.12).aspx](http://msdn.microsoft.com/en-us/library/bb214075(v=office.12).aspx)

```
DoCmd.SendObject acSendReport, "Employees", acFormatPDF, _
    "Nancy Davolio; Andrew Fuller", "Joan Weber", , _
    "Current Spreadsheet of Employees", , False 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T21:17:42.057

为您要导出的每个报表创建一个宏，然后使用 Shell 命令调用多个 Access 实例（VBA 不会等待这个完成）。

例如，如果您有一个名为 的报表`Report1`，请创建一个名为的宏`PrintReport1`来导出 PDF，然后关闭数据库。

然后在您的 VBA 代码中运行：

```
Shell("msaccess ""C:\DatabasePath\Database.accdb"" /x PrintReport1")
Shell("msaccess ""C:\DatabasePath\Database.accdb"" /x PrintReport2") 
```

没有评论这方面的表现如何，但它会起作用。

# windows-phone-7 - 混合应用 WP7：广告不可见，但可点击

> ID：12099669
> 
> 赞同：0
> 
> 时间：2012-08-23T20:42:30.807
> 
> 标签：windows-phone-7, xna, ads

我按照 Microsoft 的文档将 Microsoft 广告包含在我的混合游戏中。一切正常，但“测试广告”不可见！但是，如果我点击它应该在的位置，它会打开 bing。这是我的画：

```
private void OnDraw(object sender, GameTimerEventArgs e)
    {
        SharedGraphicsDeviceManager.Current.GraphicsDevice.Clear(Color.CornflowerBlue);

        spriteBatch.Begin();
        background.Draw(spriteBatch);

        // Draw the Enemies
        for (int i = 0; i < Plattforms.Count; i++)
        {
            Plattforms[i].Draw(spriteBatch);
        }

        powerbar.DrawPower(spriteBatch);
        player.Draw(spriteBatch);
        particleComponent.Draw(spriteBatch);
        particleComponentfinal.Draw(spriteBatch);

        spriteBatch.DrawString(font, level.score.ToString(), new Vector2(20, 20), Color.White);

        if (bg.donebook == true) { spriteBatch.Draw(bg.done, new Vector2(0, 0), Color.White); }

        if (countdown == true) { spriteBatch.DrawString(countfont, countdowntime.ToString(), new Vector2(360, 200), Color.White); }

        // draw the ad control
        AdComponent.Current.Draw();

        spriteBatch.End();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:00:04.657

[您是否遵循本](http://msdn.microsoft.com/en-us/library/hh873087%28v=msads.20%29.aspx)指南中的所有步骤，包括设置正确的矩形（为广告控件保留 80x480）以及连接更新和渲染方法？您描述的行为似乎布局系统希望将广告控件放在正确的位置，但您的帧缓冲区不包含它的视觉数据。

# .net - 我在哪里可以找到 System.Web.Optimization 的源代码？

> ID：12099670
> 
> 赞同：15
> 
> 时间：2012-08-23T20:42:39.410
> 
> 标签：.net, asp.net-mvc-4, asp.net-optimization

我试图弄清楚为什么当我创建一个引用主站点应用程序文件夹下 IIS VirtualDirectory 中的文件的脚本包时，为什么它不会输出任何内容。

我找到了这篇文章：

[为什么 ResolveBundleUrl 不适用于自定义文件夹？（MVC 测试版 4）](https://stackoverflow.com/questions/9647585/why-does-resolvebundleurl-not-work-for-custom-folders)

但它似乎不再适用于 System.Web.Optimization 的最新 beta 版本。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-07-17T08:59:34.293

对于任何偶然发现这个问题的人，现在可以在[https://aspnetoptimization.codeplex.com/SourceControl/latest#src/System.Web.Optimization/](https://aspnetoptimization.codeplex.com/SourceControl/latest#src/System.Web.Optimization/)找到源代码。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-27T17:30:29.090

它目前仍然不可用，但最终将托管在[ASP.NET 优化 CodePlex 站点上](http://aspnetoptimization.codeplex.com/SourceControl/BrowseLatest)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-23T21:18:09.513

`System.Web.Optimization`还在转开源的过程中，暂时找不到官方的源码。

# java - 实现 OAUTH 提供程序 Java - 生成使用者密钥和秘密

> ID：12099672
> 
> 赞同：4
> 
> 时间：2012-08-23T20:42:45.677
> 
> 标签：java, oauth

我的应用程序是一个 oauth 提供者。当我使用预先生成的消费者密钥和秘密时，它工作正常。我想知道在 java 中生成 Consumer Key 和 Secret 的最佳方法是什么。有没有我可以用来执行此操作的库。基本上我想创建一个应用程序注册页面，在其他应用程序中可以注册。我打算询问详细信息，例如回调 URL 和应用程序名称。我只想根据这些细节生成随机的消费者密钥和秘密。我打算使用 HMACSHA1。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:01:02.953

您需要生成一个 20-40 字符长的加密安全随机字符字符串。为此，您需要使用 CSRNG。java实现如下所示。

```
public final class KeyGenerator
{
  private static final String symbols = "abcdefghijklmnopqrstuvwxyzABCDEFGJKLMNPRSTUVWXYZ0123456789-_"; 
  private final Random secureRandomProvider = new SecureRandom();
  private final char[] buffer;

  public KeyGenerator(int length)
  {
    if (length < 1)
      throw new IllegalArgumentException("length < 1: " + length);
    buffer = new char[length];
  }

  public String CreateKey()
  {
    for (int idx = 0; idx < buffer.length; ++idx) 
      buffer[idx] = symbols.charAt(secureRandomProvider.nextInt(symbols.length()));
    return new String(buffer);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:19:53.350

感谢大家的及时回复。我最终使用“javax.crypto”包根据应用注册时输入的输入字符串生成“HmacSHA1”密钥。

# iphone - cocos2d如何逐步画线？

> ID：12099673
> 
> 赞同：0
> 
> 时间：2012-08-23T20:42:46.720
> 
> 标签：iphone, objective-c, ios, user-interface, cocos2d-iphone

Konami 为他们的 Bemani 系列开发了一些真正漂亮的 UI。他们使用的技巧之一是逐步绘制线条，在这些线条中，UI 元素会在它们实际出现之前的一瞬间出现。您可以在此视频中非常清楚地看到它：[http ://www.youtube.com/watch?v=J4aLmrwWEUk&feature=related](http://www.youtube.com/watch?v=J4aLmrwWEUk&feature=related)

用 cocos2D 做到这一点的最佳方法是什么？作为奖励，在 iOS 上使用非 cocos2d 游戏执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:05:49.307

最好的方法应该是覆盖您想要的每个节点中的 draw 方法。

您可以获得节点的尺寸（查看 texture2d），然后您可以创建一个边界框。

然后在draw方法中你可以使用一个内部变量并增加它。

*   虽然它超过了您使用 [super draw] 绘制的值
*   当它较少时，您使用 glDrawLines 函数（检查绘制图元示例）并使用变量设置线的长度。

# java - 将对象传递给另一个控制器

> ID：12099674
> 
> 赞同：1
> 
> 时间：2012-08-23T20:42:50.563
> 
> 标签：java, scala, playframework, playframework-2.0

我是游戏框架的新手。

所以我有一个带有对象的类 User ，`user`它存储在另一个名为 的对象中`userInfo`，我想将它传递给控制器​​。

```
UserInfo userInfo = new UserInfo(user);
return redirect(routes.UserInfos.index(userInfo)); 
```

在我的`routes`档案中，我显然有

```
GET     /saveUserInfo      controllers.UserInfos.index(theUserInfo: UserInfo) 
```

我不断收到错误消息`no type UserInfo`。这`routes`似乎是一个简单的文本文件。如何添加 UserInfo 作为该 controller.index 的依赖项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T05:37:25.037

嗯..我明白你的意思，但这应该是不可能的，因为路由动作

```
`GET     /saveUserInfo      controllers.UserInfos.index(theUserInfo: UserInfo)` 
```

是否意味着您正在使用具有 java 对象作为参数的 url 呈现页面？这应该是 JSON 或类似 Long 类型的东西：

```
`GET     /saveUserInfo/:user_info_id      controllers.UserInfos.index(user_info_id: Long)` 
```

但是使用这种 Long 它需要它已经持久化到数据库中，因此您可以在后台使用 Ebean 或 JPA 将其加载到视图中。

知道了？:)

# mysql - 如何连接和更改/更新表

> ID：12099682
> 
> 赞同：0
> 
> 时间：2012-08-23T20:43:30.200
> 
> 标签：mysql, sql

> **可能重复：**
> [如何将下一个最高数字插入数据库](https://stackoverflow.com/questions/12096642/how-to-insert-the-next-highest-number-into-the-database)

我正在使用 MYSQL

我有一个名为 TeacherId 的列，它是自动递增的，如下所示：

```
TeacherId

1
2
3
4 
```

我想要做的是在数字前面添加字母“T”，这样它就变成了：

```
TeacherId

T1
T2
T3
T4 
```

我怎样才能更新或改变表来做到这一点？

以下是我的尝试，但没有奏效：

```
UPDATE Teacher SET TeacherId = CONCAT('T',TeacherId) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T20:50:44.727

我强烈建议您考虑在查询时将 T 附加到*显示*上，而不是尝试在每一行上存储一个 T。我不明白以这种方式存储数据的目的，特别是如果您有其他表以本机形式使用 TeacherId 值。

如果您需要区分教师和管理员，那么有两个想法：

1.  该表应称为人员，而不是教师。
2.  这仍然可以存储为单独的列，例如 PersonnelType。

我知道您可能被告知它应该显示为 T3 等，但他们肯定没有明确告诉您“我们希望您将 T 和 3 一起存储在同一列中，否则。” 您可以向他们展示 T3，而无需以糟糕且无法使用的设计将它们硬塞在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:03:40.673

选择数据并自动在 TeacherId 前添加字母 T：

```
SELECT *, CONCAT('T', TeacherId) AS TeacherId2 FROM Teacher 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:12:48.757

如果您必须在表中使用它，请在表中创建第二列，这样您的创建将如下所示：

```
CREATE TABLE  `teacher` (

`teacherId` INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`t` CHAR( 10 ) NOT NULL DEFAULT ''
) 
```

然后创建一个触发器，将您的第二列设置为与您的 id 连接的“T”。

```
delimiter |

CREATE TRIGGER teacherInsert after INSERT ON teacher
  FOR EACH ROW BEGIN
    UPDATE teacher SET `t` = concat('T', teacherId);
  END;
|

delimiter ; 
```

或者，您也可以按照 Aaron 的建议进行操作，并在查询时获取它：

```
select teacherId, concat('T', teacherId) from teacher 
```

# python - django 动态模型表单无法验证

> ID：12099683
> 
> 赞同：0
> 
> 时间：2012-08-23T20:43:39.843
> 
> 标签：python, django, dynamic, django-forms

> **可能重复：**
> [使用重载的*init验证表单*](https://stackoverflow.com/questions/12081628/validating-a-form-with-overloaded-init)

我花了整个下午试图找出我在这里做错了什么，而且我知道这将是一些令人讨厌的愚蠢行为。当用户填写表格时，位置选择框取决于用户所在的国家，并相应地列出不同的城市。

模型和模型形式

```
class Cars(models.Model):
    owner = models.ForeignKey(User)
    name = models.CharField(max_length=25)
    location = models.PositiveIntegerField(default=1)
    created = models.DateTimeField(default=utc_time)

class CarsForm(ModelForm):
    def __init__(self, country, *args, **kwargs):
        super(CarsForm, self).__init__(*args, **kwargs)
        self.fields['location'] = forms.ModelChoiceField(queryset=Cities.objects.filter(country=country))

    class Meta:
        model = Cars
        exclude = ('owner', 'created',) 
```

看法

```
def new_car(request):
    if request.method == u'POST' and request.is_ajax():
        form = CarsForm(request.POST)
        if form.is_valid():
                      etc... 
```

根据 stackoverflow 的建议，我编辑了 modelform **init**以允许传递 country 变量。表单创建和 html 显示正常，一切正常，只是现在表单无法验证。

更新：好的，看起来我（意思是“你”）让它工作了。有几件事很丑陋，一旦修复它就可以了：

*   位置字段类型更改为外键，纠正数据不匹配问题
*   init 被修改为接受 country 作为 kwarg
*   表单验证现在将变量作为 kwarg CarsForm(request.POST, country=country) 传递

成功！不到一个小时。非常感谢大家！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:48:52.160

您的更改是`country`第一个参数，但您将`POST`数据作为第一个参数传递。`form = CarsForm(request.POST)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:49:05.977

要么这是解决方案，要么你的复制粘贴有问题`;)`

您已经正确定义了被覆盖的`__init__`方法，但实际上并没有传递`country`参数；这样做看起来像这样：

```
form = CarsForm(country, request.POST) 
```

这意味着它`request.POST`总是被存储在`country`并且永远不会传递给父类的`__init__`方法。

如果表单没有数据，`is_valid()`将始终返回`False`。

旁注：`SkillForm`从哪里来？应该是`CarsForm`。

# cuda - 用clang编译CUDA

> ID：12099684
> 
> 赞同：3
> 
> 时间：2012-08-23T20:43:47.767
> 
> 标签：cuda, clang, llvm-clang

我是 LLVM 新手。听说clang支持CUDA。如何使用 clang 编译 CUDA？我是否必须进行一些配置更改或包含任何特定的头文件？我在网上找不到有关此的任何信息。有可能吗？

现在，当我尝试使用 clang 编译一个虚拟 cuda 程序时

```
clang -I /usr/local/cuda/include filename.cu 
```

我收到以下错误

```
 unknown type name '__global__'

 __global__ void nothing(int *A) 
```

任何帮助表示赞赏！顺便说一句，我在 Mac 上运行它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-03-26T20:35:00.893

感谢 Google 和其他人的贡献，Clang 现在支持构建 CUDA。不过，命令行参数与 略有不同`nvcc`。根据[官方文档](http://llvm.org/docs/CompileCudaWithLLVM.html)，假设你的文件名为`axpy.cu`，基本用法是：

```
$ clang++ axpy.cu -o axpy --cuda-gpu-arch=<GPU arch>  \
    -L<CUDA install path>/<lib64 or lib>              \
    -lcudart_static -ldl -lrt -pthread 
```

请注意，使用 Clang 编译 CUDA 仍然需要您安装[NVIDIA CUDA 工具包](https://developer.nvidia.com/cuda-toolkit)中的专有 CUDA 运行时。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T22:51:53.330

**2016-05-01 更新：clang 现在支持 CUDA。请参阅@rivanvx 的答案。**

CUDA 编译器基于 LLVM。Clang 虽然也是基于 LLVM，但不支持 CUDA。

# selenium-ide - 使用 selenium 在更改 ID 的文本字段中输入日期

> ID：12099689
> 
> 赞同：0
> 
> 时间：2012-08-23T20:44:17.657
> 
> 标签：selenium-ide

我有 2 个日期输入文本字段，其 ID 不断变化。现在您看到 1c 和 1d，但也可以是 4 和 5，或 8 和 9。我需要在 Selenium 中输入什么值才能忽略该变化的字段，但找到 2 个框？

```
<div class="dateInputField" style="z-index: 980;">
<input id="id1c" type="text" name="dateFrom:date" value="" size="8">
<span class="yui-skin-sam">`

<div class="rowElem required" style="z-index: 990;">
<div class="dateInputField" style="z-index: 1000;">
<input id="id1d" type="text" name="dateTill:date" value="" size="8">
<span class="yui-skin-sam">` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T15:53:48.220

使用 NAME 作为这种
类型的元素标识符 | 名称=日期从：日期 | 01/01/2001

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T10:02:27.817

使用名称（我假设名称不会改变？）或 XPath。

# c# - 在 Windows Phone 中关闭应用程序后如何保持应用程序运行？

> ID：12099693
> 
> 赞同：1
> 
> 时间：2012-08-23T20:44:26.503
> 
> 标签：c#, windows-phone-7.1

我不确定标题是否足够主动地描述这个问题，所以我们开始吧。

我对 Windows Phone 上的默认警报应用程序有点不满意，所以我决定自己制作（也是我在 Windows Phone 开发上的第一个项目）。但是，正如我从市场上可用的其他应用程序中注意到的那样，一旦您关闭应用程序，警报实际上并不会继续运行，而默认情况并非如此。

有没有人想出如何编写代码——即使在应用程序退出之后——应用程序仍会像它正在运行一样运行，例如闹钟？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:49:51.560

您的应用程序关闭后无法继续运行。这是操作系统强加的规则之一。但是，您可以使用其他一些操作系统功能来触发某种警报......

[后台代理允许您](http://msdn.microsoft.com/en-us/library/hh202942%28v=VS.92%29.aspx)每隔几分钟运行一段逻辑来检查警报是否到期。

您还可以在应用程序未运行时从服务器向手机发送[通知。](http://msdn.microsoft.com/en-us/library/ff431744%28v=vs.92%29.aspx)

# java - 如何在 Java 中压缩对象流？

> ID：12099697
> 
> 赞同：2
> 
> 时间：2012-08-23T20:44:55.493
> 
> 标签：java, jaxb

我有`Object`一个

```
private String name;
private int age;
private String country;
// getters and setters 
```

我将此对象转换为`XML`使用`JAXB`如下

```
OutputStream stream = new ObjectOutputStream(new FileOutputStream(getOutputFilePath(document.getUniqueId())));
write(proposal, stream); 
```

和

```
protected void write(@Nonnull final Document document, @Nonnull final OutputStream stream) throws PersistenceException {
        try {
            jaxbContext.createMarshaller().marshal(document, stream);
        } catch (final JAXBException e) {
            LOGGER.error(e.getMessage(), e);
            throw new PersistenceException("Failed to marshall document " + docment.getUniqueId() + ": " + e.getMessage(), e);
        }
    } 
```

如何将其转换`stream`为磁盘上的 Zip 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T20:48:13.793

Java 有许多用于以各种方式处理压缩的类。这是一个有用的链接：[使用 Java API 压缩和解压缩数据](http://java.sun.com/developer/technicalArticles/Programming/compression/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:01:44.407

正如已经建议的那样，将你`ObjectStream`的`ZipOutStream`

```
OutputStream stream = new ZipOutputStream(new ObjectOutputStream(new FileOutputStream(getOutputFilePath(document.getUniqueId())))); 
```

# wpf - ListBox ItemTemplate Hit Test

> ID：12099708
> 
> 赞同：1
> 
> 时间：2012-08-23T20:45:48.497
> 
> 标签：wpf, mvvm

I have the following ListBox with an ItemTemplate

```
<ListBox SelectionMode="Multiple" ItemsSource="{Binding MyItems}" DisplayMemberPath="Name">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Grid VerticalAlignment="Stretch" Height="{Binding ActualHeight, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}">
                <ContentControl VerticalAlignment="Center" VerticalContentAlignment="Center" Content="{Binding}" />
            </Grid>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

This displays all well and good, but the hit test on the ContentControl isn't right...if I click above or below the "actual" content (if the item has more Height than the ContentControl, then the item isn't selected.

If I change the ControlControl VerticalAlignment to Stretch, that resolves the problem and all clicks correctly highlight items...but then my Content is top-aligned within each item...

How can I get items to select correctly?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T20:52:04.003

Make the `Grid` hit-test for example

```
<Grid Background="Transparent" ...> 
```

# c# - 多语言 C# 用户界面，阿拉伯语

> ID：12099709
> 
> 赞同：0
> 
> 时间：2012-08-23T20:45:56.453
> 
> 标签：c#, user-interface, arabic, multilingual, revert

我正在用 C# 开发多语言用户界面，但遇到了阿拉伯语问题：

我反转了 UI 的所有组件，但我无法从右到左书写文本。我不确定是否有可能，或者是否有与操作系统相关的东西允许这样做。

我正在使用一些带有字符串表的 .resx 文件来存储不同语言的文本。

有没有办法在非阿拉伯语 PC 上编写 RIGHT-TO-LEFT 文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:53:19.987

问题是你的操作系统。您应该在系统上安装阿拉伯语，然后将其添加到控制面板中的键盘/屏幕语言中。

如何执行此操作取决于您的操作系统版本：

如果您使用**Windows 7**或**Vista**：
[http ://answers.microsoft.com/en-us/windows/forum/windows_7-desktop/install-arabic-language-on-to-windows-7/6c6ab876-4679-488e- b72b-94e603a35333](http://answers.microsoft.com/en-us/windows/forum/windows_7-desktop/install-arabic-language-on-to-windows-7/6c6ab876-4679-488e-b72b-94e603a35333)

如果您使用**Windows XP**：http:
[//support.microsoft.com/kb/821080](http://support.microsoft.com/kb/821080)

对于任何旧版本，只需在 Google 上进行快速搜索。

希望能有所帮助

# c# - VisualStateManager 在捕捉视图中打开页面

> ID：12099717
> 
> 赞同：0
> 
> 时间：2012-08-23T20:46:36.767
> 
> 标签：c#, styles, microsoft-metro

我正在使用 C# 和 Xaml 开发一个 Windows 8 Metro 风格的应用程序。我得到了一个以联合项目作为数据源的联合新闻提要网格。当我单击一个项目时，我希望捕捉页面的视图状态并使浏览器控件处于填充视图状态，以便我的应用程序捕捉到 320 宽度并且网站在浏览器控件中打开 1024 填充视图。

我正在使用以下代码块。页面已正确捕捉，但应用程序未捕捉。我可以做些什么来实现我的目标，即应用程序捕捉和浏览器控件填充的填充 + 捕捉组合。

这是我正在使用的代码：

```
 private async void ItemView_ItemClick(object sender, ItemClickEventArgs e)
    {
        FeedItem feedItem = (FeedItem)e.ClickedItem;
        feedItem.Read = true;
        ListView lv = e.OriginalSource as ListView;

        if (lv.SelectedItem != null)
        {
            ListViewItem li = lv.SelectedItem as ListViewItem;
            if (li != null) li.Template = Application.Current.Resources["ReadStandard80ItemTemplate"] as ControlTemplate;
        }

        //this.ApplicationViewStates.
        this.Width = 320;

        this.HorizontalAlignment = Windows.UI.Xaml.HorizontalAlignment.Right;
        var CurrentViewState = Windows.UI.ViewManagement.ApplicationView.Value;

        this.MainFramne.Width = 320;

        VisualStateManager.GoToState(this.MainFramne, "Snapped", false);
        Snapped.Storyboard.Begin();

        await Windows.System.Launcher.LaunchUriAsync(new Uri(feedItem.Link.ToString()));
        var test = Windows.UI.ViewManagement.ApplicationView.Value;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:26:50.710

您无法以编程方式更改任何 Windows 应用商店应用程序的捕捉/填充/最大化状态。它只能响应用户发起的请求来完成。（这样做是为了防止应用程序进行欺骗或以其他方式进行恶意行为。）

如果您的应用程序处于最大化视图中，并且如果您已经处于快照视图中，那么您可能需要考虑在您的应用程序中托管一个浏览器实例 (WebView)，然后您启动到外部浏览器（希望它应该被填满）。

# c - 什么时候在 C 中未定义指针减法？

> ID：12099719
> 
> 赞同：11
> 
> 时间：2012-08-23T20:46:42.093
> 
> 标签：c, arrays, pointers, undefined-behavior, pointer-arithmetic

```
char *buf = malloc(bufsize)
char *ptr = buf;
…
while(condition) {
    ptrdiff_t offset = ptr - buf;    // <========== THIS LINE

    // offset will never be negative because we only ever *increase* ptr
    if ((size_t)offset > bufsize) {
        // we need more room
        bufsize += 128;
        buf = realloc(buf, bufsize);
        ptr = buf + offset;  // buf might be in a completely new location
    }
    *ptr++ = …  // write this byte
} 
```

这是**有效**的还是**未定义**的？

我会假设它是有效的，但我读到了一些关于它未定义的内容，所以我用谷歌搜索了它。这些链接似乎不可避免地声称它是未定义的：

*   [安全编码](https://www.securecoding.cert.org/confluence/display/seccode/ARR36-)
*   [指针的减法不指向同一数组的不同元素在C中是否有效？](https://stackoverflow.com/questions/9673084/is-subtraction-of-pointers-not-pointing-to-different-elements-of-same-array-vali)

但是，在这些 SO 问题中没有提到它：

*   [指针减法混淆](https://stackoverflow.com/questions/3238482/pointer-subtraction-confusion)
*   [size_t 返回指针减法](https://stackoverflow.com/questions/11697547/size-t-return-pointer-subtraction)
*   [C中的指针算术](https://stackoverflow.com/questions/759663/pointer-arithmetic-in-c)

这些都在谈论不是两个指针在同一个“数组”中。这实际上是否意味着堆栈上有一个普通的旧 C 数组？

如果它是未定义的，对我来说似乎很奇怪……当我可以访问一个常量指针和一个移动指针时，为什么要强制我携带一个计数器变量？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T20:50:47.210

`malloc`count 返回的指向同一数组的内存块的指针：

> [c11](/questions/tagged/c11 "显示标记为“c11”的问题")
> 
> ### 7.22.3 内存管理功能
> 
> 1 -`malloc`如果分配成功 [...] 返回的指针 [...] 可以分配给指向任何类型对象 [...] 的指针，然后用于访问空间中的此类对象或此类对象的数组分配（直到空间被显式释放）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T20:55:23.157

```
ptrdiff_t offset = ptr - buf;    // <========== THIS LINE 
```

这是完全定义的行为。

> （C99，6.5.6p9）“当减去两个指针时，两者都应指向同一数组对象的元素 [...]”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T21:12:50.437

这是定义的行为，只要您不超过数组末尾的一个元素。C99 §6.5.6/8 说这个关于添加一个指针和一个整数：

> [...] 如果指针操作数和结果都指向同一个数组对象的元素，或者超过数组对象的最后一个元素，则评估不应产生溢出；否则，行为是未定义的。[...]

第 9 段，关于减法：

> 9) 当两个指针相减时，都应指向同一个数组对象的元素，或者指向数组对象的最后一个元素；[...]

从 §7.20.3/1 开始：

> 如果分配成功，则返回的指针经过适当对齐，以便可以将其分配给指向任何类型对象的指针，然后用于访问已分配空间中的此类对象或此类对象的数组（直到空间被显式释放） .

因此，一旦您`ptr`指向最后一个数组元素之后的元素，执行指针减法是未定义的行为。

我确实相信有些系统会在这段代码中表现得很糟糕，尽管我不能说出任何一个名字。理论上，`malloc()`可以在可寻址内存结束之前返回一个指针，例如，如果您要求 255 个字节，它可以在 32 位系统上返回 0xFFFFFF00，因此创建超出结尾的指针将导致溢出。指针表示上的整数溢出也可能触发某种陷阱（例如，如果指针存储在特殊寄存器中）。虽然我不知道任何具有这些属性的系统，但 C 标准肯定允许它们存在。

# java - 如何使用 subList()

> ID：12099721
> 
> 赞同：82
> 
> 时间：2012-08-23T20:46:46.623
> 
> 标签：java

我有一个显示 Glassfish 日志文件列表的 JSF 页面。我使用延迟加载进行分页。我将日志文件名列表保存到 Java`List`中。

```
private List<directoryListObj> dataList = new ArrayList<>();

dataList = dataList.subList(firstRow, lastRow); 
```

这就是问题所在。例如，我在目录中有 35 个文件。当我这样做时

```
dataList = dataList.subList(5, 15); 
```

它工作正常。但是当我这样做时：

```
dataList = dataList.subList(30, 38); 
```

我得到错误的索引，因为我想在列表之外获取索引。例如，我如何返回从 30 到 35 的列表元素？如果我想获得从 30 到 40 的索引，但如果只有 35 个索引只能获得 5，我想要。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2012-08-23T20:49:03.713

使用`subList(30, 38);`将失败，因为最大索引 38 在列表中不可用，因此不可能。

唯一的方法可能是在请求子列表之前，您使用列表 size() 方法显式确定最大索引。

例如，检查大小，它返回 35，所以调用`sublist(30, size());`

或者

**复制自 pb2q 评论**

```
dataList = dataList.subList(30, 38 > dataList.size() ? dataList.size() : 38); 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2015-06-23T12:57:32.380

我已经实现并测试了这个；它应该涵盖大多数基础：

```
public static <T> List<T> safeSubList(List<T> list, int fromIndex, int toIndex) {
    int size = list.size();
    if (fromIndex >= size || toIndex <= 0 || fromIndex >= toIndex) {
        return Collections.emptyList();
    }

    fromIndex = Math.max(0, fromIndex);
    toIndex = Math.min(size, toIndex);

    return list.subList(fromIndex, toIndex);
} 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2012-08-23T20:52:33.353

要获取最后一个元素，只需使用列表的大小作为第二个参数。因此，例如，如果您有 35 个文件，并且想要最后五个文件，您可以：

```
dataList.subList(30, 35); 
```

保证安全的方法是：

```
dataList.subList(Math.max(0, first), Math.min(dataList.size(), last) ); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2019-04-02T09:32:58.847

您可以在 Java 8 中使用流。要始终最多获得 10 个条目，您可以执行以下操作：

```
dataList.stream().skip(5).limit(10).collect(Collectors.toList());
dataList.stream().skip(30).limit(10).collect(Collectors.toList()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-28T10:41:27.097

虽然可能为时已晚，但我建议在 Java 8 中使用流以避免手动处理越界异常。

这段代码

```
dataList = dataList.stream().skip(30).limit(8).collect(Collectors.toList()); 
```

工作方式相同

```
dataList = dataList.subList(30, 38); 
```

如果出现索引错误，dataList 将是空列表，而不是抛出任何异常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-09T19:45:21.187

对于 kotlin，您可以使用： `myList.subList(min, max.coerceAtMost(myList.size)`

或者就上述问题而言：`myList.subList(30, 38.coerceAtMost(myList.size)`

# c# - 从 C# 调用 x64 .asm 文件？

> ID：12099726
> 
> 赞同：3
> 
> 时间：2012-08-23T20:47:11.173
> 
> 标签：c#, assembly

我已经看到从 C++ Visual Studio 2010 调用的内联 32 位 .asm，使用 Microsoft 的 __fastcall 协议和整个“extern C”头文件从 C++ 项目调用 x64 手写 .asm 文件，但我没有看到等效于 C#（我的首选语言）。

从 C# 文件，有没有办法在 C# Winforms 应用程序中调用手写的 64 位 .asm 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:50:32.280

尝试查看[此代码项目](http://www.codeproject.com/Articles/1392/Using-Unmanaged-code-and-assembler-in-C)。它描述了将程序集混合到 c++ 中然后在 C# 中调用 c++ 程序集的技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:55:24.920

如果您确实需要从 C# 执行汇编代码，请参见[此处](http://www.conic.se/blog/posts/12/)的示例- 使用`unsafe`代码、指针、未损坏的委托和包含二进制形式的汇编程序的字节数组...

# xcode - Xcode无法验证服务器“github.com”的身份，Xcode

> ID：12099727
> 
> 赞同：22
> 
> 时间：2012-08-23T20:47:12.240
> 
> 标签：xcode, git

![在此处输入图像描述](../Images/c646370b0e2924cb908b7a8a5c41756d.png)

抱歉这个愚蠢的问题，但我一直在 Xcode 上得到这个。我不确定是不是因为我更新到了山狮。每次单击继续时，我都会收到相同的消息，并且永远不会继续。但是，我可以从命令行拉或推。有谁知道如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-01T14:57:28.903

只需单击“显示证书”，展开披露箭头并将“信任”下拉选项菜单设置为“始终信任”。如果询问，请接受并重新输入您的密码。现在应该没问题了。（抱歉没有更准确，但我现在没有证书窗口。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T05:50:16.580

GitHub 的 CA 链中的所有证书似乎都没有刚刚过期或被关闭过期。

这篇[文章](http://railsapps.github.com/openssl-certificate-verify-failed.html)（在铁路应用程序上，但在这里也相关）建议：

*   [安装 MacPorts](http://www.macports.org/install.php)
*   使用 OpenSSL
*   如果有目录`/opt/local/etc/openssl`：

```
$ cd /opt/local/etc/openssl
$ sudo curl -O http://curl.haxx.se/ca/cacert.pem
$ sudo mv cacert.pem cert.pem
$ setenv SSL_CERT_FILE /opt/local/etc/openssl/cacert.pem

```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-04-06T16:53:29.787

遇到此问题的任何人，请退出您的代理并重试。

# websphere-mq-fte - 除非文件准备好传输，否则 FTE 不应选择文件

> ID：12099734
> 
> 赞同：0
> 
> 时间：2012-08-23T20:47:44.457
> 
> 标签：websphere-mq-fte

我遇到了 FTE 在文件准备好之前传输文件的情况。基本上问题是 MQ 正在写入文件，而 FTE 在其间选择文件并在文件完成之前传输文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T04:07:31.073

我认为正在写入文件的 MQ/应用程序必须已释放文件上的锁定，这表明文件写入已完成。所以 FTE 可能已经拿起了文件进行传输。

# python - 如何为 WTForms SelectField 设置默认值？

> ID：12099741
> 
> 赞同：63
> 
> 时间：2012-08-23T20:48:18.503
> 
> 标签：python, flask, wtforms

当尝试使用 WTForms 设置 SelectField 的默认值时，我将值传递给 'default' 参数，如下所示。

```
class TestForm(Form):
  test_field = SelectField("Test: ", choices=[(1, "Abc"), (2, "Def")], default=2) 
```

我也尝试过以下方法。

```
class TestForm(Form):
  test_field = SelectField("Test: ", choices=[(1, "Abc"), (2, "Def")], default=(2, "Def")) 
```

既不将默认选定字段设置为“Def”。这适用于其他类型的字段，例如 TextField。如何设置 SelectField 的默认值？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-06-10T08:32:40.540

我相信这个问题是由`Field`' 的`data`属性`default`用 WTForms 不理解的东西覆盖的（例如，一个 DB 模型对象——它需要一个`int`）引起的。如果您像这样在构造函数中填充了表单，则会发生这种情况：

```
form = PostForm(obj=post) 
```

`data`解决方案是在填充表单后手动设置属性：

```
form = PostForm(obj=post)
form.category.data = (post.category.id
                      if page.category
                      else 0) # I make 0 my default 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-08-23T21:25:59.297

您发布的第一种方式是正确的，它对我有用。它不起作用的唯一解释可能是您正在运行旧版本的 WTForms，它在 1.0.1 上对我有用

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2017-04-07T14:10:27.930

`Flask-WTF 0.14.2`用户在这里。因此，此答案适用于与我有类似问题的任何人。

基本上，以前的解决方案都不能与`form.validate_on_submit()`.

设置`form.test_field.data`确实会在页面加载时更改默认值，但之后数据*保持不变*`validate_on_submit`（用户在浏览器中更改没有效果）。

设置`form.test_field.default`then call`form.process()`也会在页面加载时更改值，但`validate_on_submit`会失败。

这是执行此操作的新方法：

```
class TestForm(Form):
    test_field = SelectField("Test", choices=[(0, "test0"), (1, "test1")])

@app.route("/test")
def view_function():
    form = TestForm(test_field=1)
    if form.validate_on_submit():
        ... 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2015-02-24T00:52:52.650

有几种方法可以做到这一点。您的第一个代码段确实是正确的。

如果您想在视图中动态执行此操作，您也可以执行以下操作：

```
form = TestForm()
form.test_field.default = some_default_id
form.process() 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2016-09-08T03:30:18.470

这是使用时的`choices`设置，它的工作原理如下：`SelectField``int`

```
test_select = SelectField("Test", coerce=int, choices=[(0, "test0"), (1, "test1")], default=1) 
```

或者：

```
class TestForm(Form):
    test_select = SelectField("Test", coerce=int)

@app.route("/test")
def view_function():
    form = TestForm()
    form.test_select.choices = [(0, "test0"), (1, "test1")]
    form.test_select.default = 1
    form.process() 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-01-29T11:08:39.790

如果您正在使用 flask_wtf 并希望为嵌套在 FieldList 中的不同 SelectFields 设置默认值，如下所示

```
from flask_wtf import FlaskForm

class FormWithSelect(FlaskForm):
    my_select_field = SelectField(validators=[DataRequired()], coerce=int)

class FormWithMultipleSelects(FlaskForm):
    select_fields = FieldList(FormField(FormWithSelect), min_entries=1)
    submit = SubmitField(label="save all the select field values") 
```

解决方案是覆盖`data`，而不是`default`您期望的那样。

```
def generate_my_form(my_data, overwrite_data=True):
    form = FormWithMultipleSelects(select_fields=[{
        "my_select_field": {
             "name": d["name"],
             # ...
        }
    } for d in my_data]))
    for n range(len(form.select_fields)):
        form.select_fields[n].my_select_field.choices = [(1,'foo'), (2,'bar')]
        # I wan't 'bar' to be the option selected by default
        # form.select_fields[n].my_select_field.default = 2  # has no effect!
        if overwrite_data:
            form.select_fields[n].my_select_field.data = 2 #  works 
```

基本上这个解决方案类似于上面的[Elliots 回答](https://stackoverflow.com/a/17019796/10009545)；我只是想为更复杂的 FieldList 案例提供解决方案。[nikitz](https://stackoverflow.com/users/3294900/nikitz)在评论中提到，有一个副作用：`form.validate_on_submit()`如果你覆盖它就不起作用`data`！`data`您可以构建一个简单的解决方法，在其中禁用调用时的覆盖`validate_on_submit()`。

```
 form_for_validation = generate_my_form(my_data, False)
 if form_for_validation.validate_on_submit():
      # do something with form_for_validation.data
 else:
     form_with_default_data = generate_my_form(my_data, True)
     render_template(..., form=form_with_default_data) 
```

它不是超级优雅，但它确实有效。

*PS：我的声誉太低，无法直接评论Elliot的正确答案。*

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-19T18:12:49.327

我对动态设置默认选择字段有一些问题，我认为这很有用。模型是这样的：

```
class State(db.Model):
    __tablename__ = 'states'
    id = db.Column(db.Integer, primary_key=True)   
    name = db.Column(db.String(128), nullable=False)

class City(db.Model):
    __tablename__ = 'cities'
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(64))
    state_id = db.Column(db.Integer, db.ForeignKey('states.id'))   
    state = db.relationship(State, backref='state')

class User(UserMixin, db.Model):
    ...
    city_id = db.Column(db.Integer, db.ForeignKey('cities.id'))
    city = db.relationship('City', backref='city') 
```

表格是这样的：

```
class UserEditForm(FlaskForm):
    ...
    state = SelectField("state", coerce=int)
    city = SelectField("city", coerce=int)
    ....

  def __init__(self, state_id, *args, **kwargs):
       super(UserEditForm, self).__init__(*args, **kwargs)
       self.state.choices =  [(state.id, state.name)
                        for state in State.query.order_by('name').all()]
       self.city.choices = [(city.id, city.name)
                            for city in   City.query.filter_by(state_id=state_id).order_by('name').all()] 
```

视图是这样的：

```
@dashboard.route('/useredit', methods=['GET', 'POST'])
@login_required
def useredit():
    ....
    user = current_user._get_current_object()       
    form = OrganEditForm(state_id=user.city.state_id, state=user.city.state_id, city=user.city_id)
     .... 
```

它运行良好并正确设置 Selectfield 默认值。但我改变了这样的代码：

**鉴于：**

```
@dashboard.route('/useredit', methods=['GET', 'POST'])
    @login_required
    def useredit():
        ....
        user = current_user._get_current_object()       
        form = OrganEditForm(obj=user)
         .... 
```

**在表格中**

```
def __init__(self, *args, **kwargs):
       super(UserEditForm, self).__init__(*args, **kwargs)
       self.state.choices =  [(state.id, state.name)
                        for state in State.query.order_by('name').all()]
       self.city.choices = [(city.id, city.name)
                            for city in   City.query.filter_by(state_id=kwargs['obj'].city.state_id).order_by('name').all()] 
```

但是这次没有设置城市默认值。我改变了这样的形式：

```
def __init__(self, *args, **kwargs):
           kwargs['city'] = kwargs['obj'].city_id
           super(UserEditForm, self).__init__(*args, **kwargs)
           self.state.choices =  [(state.id, state.name)
                            for state in State.query.order_by('name').all()]
           self.city.choices = [(city.id, city.name)
                                for city in   City.query.filter_by(state_id=kwargs['obj'].city.state_id).order_by('name').all()] 
```

但它没有用。我尝试了很多解决方案，最后我将城市变量名称更改为 usercity：

```
usercity= SelectField("city", coerce=int) 
```

和`kwargs['city'] = kwargs['obj'].city_id`到`kwargs['usercity'] = kwargs['obj'].city_id`。之后它工作正常。

问题是，当我设置时，城市选择字段的默认值从我在模型中定义的`obj=user`读取。`kwargs['obj'].city``user`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-19T02:46:15.570

```
Python Flask SelectField choices 

    # method 1 - routes.py
     form.proj_cat_id.default    = table1.proj_cat_id
     form.process()  # for preset 

    # method 2 - routes.py
    form.proj_cat_id.process_formdata([table1.proj_cat_id])

# method 3  - routes.py
      proj_cat_id_default    = table1.proj_cat_id
      return render_template('abc.html',proj_cat_id_default=proj_cat_id_default)

# method 3 - abc.html
        {% set z = form.proj_cat_id.process_data(proj_cat_id_default) %}
        {{ form.proj_cat_id(class="form-control form-control-lg") }} 
```

# apache-flex - Flex 组件未显示（有时） - 奇怪的行为 - flex 3 updateCompletePendingFlag

> ID：12099747
> 
> 赞同：1
> 
> 时间：2012-08-23T20:48:39.980
> 
> 标签：apache-flex, custom-component, flex-mx

我有一个小问题。

## 环境

环境：Flex 3（实际上更新到 Flex 4 SDK，但仍然使用*mx*而不是*spark*）

IDE：Flash Builder 4.6。

浏览器：火狐14.0.1

Flash 播放器版本：FP 11 调试器 - 11.2.202.235

状态语法：Flex 3 风格的语法。

## 应用程序

我有一个应用程序。

此应用程序有几个状态。

其中一个状态依次具有`wrapperComponent`具有三种不同状态的“”：基本状态（即“”）、“ `firstState`”和“ `secondState`”。

稍微简化一下，几乎每个状态都包含一个不同的自定义组件，如下所示：

*   “ `wrapperComponent`”->“ `base comp.`”
*   “ `firstState`”->“ `first comp.`”
*   “ `secondState`”和“ `second comp.`”

下图更清楚地显示了这种情况：

![应用程序组件和状态的层次结构](../Images/aa76ce0491c6d412cb7a1b51d2222b42.png)

然后，当用户使用“ `wrapperComponent`”时，它首先到达“ `firstState`”，然后他使用“ ”，然后再`base state`转到“ `secondState`”，如下图所示：

![包装器组件中的状态流](../Images/fe8856786d4e98f3d3b440cb8e2496d6.png)

## 所以，问题是...

所以，问题是当用户到达流程中的第三步时，即当他到达“ `secondState`”的“”时，“ ”`wrapperComponent`有时*会*`second comp.`出现，*有时不会出现*。

## 目前的调查结果...

Adobe 论坛中的讨论：[http ://forums.adobe.com/message/4621058](http://forums.adobe.com/message/4621058) [3](http://forums.adobe.com/message/4621058)

在为此苦苦挣扎了大约两周后，我得出了一个半结论，即不知何故，ActionScript 中的内部事件流已停止。

这意味着，当我的名为“ `second comp.`”的自定义组件没有出现在屏幕上时：

*   从“ `base state`”到“ `secondState`”的转换被停止/暂停/暂停，
*   只有“ `second comp.`”的一些事件被调度（“ `preinitialize`”、“ `initialize`”、“ `add`”、“ `added`”被调度），但其他一些事件没有被调度：“ `addedToStage`”和“ `creationComplete`”未被调度。
*   `activeEffects`" `base comp.`" 和 " "的变量 " `second comp.`" 包含未播放的效果 (如 "RemoveChildActionInstance" 或 "AddChildActionInstance") 和
*   这些相同组件的变量“ `updateCompletePendingFlag`”变量的值为“ `true`”，表示它们还没有完成更新。

## *丑陋*的黑客

我发现了一个非常可怕的方法来规避这个问题，这个解决方法：

*   我设置了一个 500 毫秒计时器，当状态必须从“ `baseState`”变为“ `secondState`”时开始计数（即上图中从第 2 步到第 3 步）
*   当这个定时器启动时，我检查组件（即“ `base comp.`”或“ `second comp.`”）是否有任何未决的效果，或者它们的“ `updateCompletePendingFlag`== `true`”。
*   如果检查结果为真，那么我会强制调用`validateDisplayList()`该特定组件上的方法。

代码看起来与此类似：

```
...
if ( toState == STATE_SECOND ) {
var theTimer    : Timer = new Timer(500,1);
theTimer.stop();
theTimer.addEventListener(
TimerEvent.TIMER_COMPLETE, 
theTimer_complete_Hdl, 
false, 0, true
);
theTimer.start();

currentState = STATE_SECOND ;
}
... 
```

计时器调用此函数：

```
private function theTimer_complete_Hdl(event:TimerEvent):void
{
if (secondComp.updateCompletePendingFlag)
{

secondComp.invalidateDisplayList();
secondComp.validateDisplayList();
secondComp.validateNow();
this.invalidateDisplayList();
this.validateDisplayList();

}
...
} 
```

## 问题...

这真的是肮脏、不雅的代码。另外，它给我的用户体验很差，因为刷新屏幕需要超过一秒钟，而且动作并不迅速。

我的猜测是它在某种程度上对性能产生了负面影响。

****关于可能发生的事情或强制 FlashPlayer 继续播放效果而不是杀死它们并强制更新显示列表的更好方法的任何想法？****

**感谢你们！！！:-)**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T21:06:06.257

我认真地认为这是 FlashPlayer 的错误。

显然，最有可能的答案是这是我的错误，事实上确实如此。

我在这上面花了很多时间，不是因为它很困难，而是因为项目很复杂，而且问题出在一个与有问题的班级没有直接关系的班级中。

在查明原点后，这是一个相当容易的修复。

## 是什么导致了问题？

除了 myCustomComponent 之外，我还使用了另一个处于先前状态的自定义类（即在“ `base comp.`”中的“ `base state`”中）。

这`customClass`扩展了 flex mx`Label`类。在`commitProperties()`被覆盖的方法中，它没有将标志设置为 false，而是`invalidateProperties()`再次调用。当然，这是一个错误，并且在这个类中引发了一个无限循环（在 " `base comp.`" 组件中有五个实例。

这并没有阻止应用程序继续运行。它并没有阻止它。但它阻止了过渡中定义的效果运行和`myCustomComponent`实例完成创建。

" " 中出现小错误的伪代码`base comp.`是这样的：

```
override protected function commitProperties():void
{
    super.commitProperties();
    if (somethingChanged)
    {
        //1: I wasn't setting somethingChanged=false

        //2: I needed to call invalidateProperties() again, like this:
        invalidateProperties();     
    }
} 
```

正确的版本是：

```
override protected function commitProperties():void
{
    super.commitProperties();
    if (somethingChanged)
    {
        //1: I added this line:
        somethingChanged=false;

        //2: I still need to call invalidateProperties() again, like this:
        invalidateProperties();     
    }
} 
```

甚至更好：

```
override protected function commitProperties():void
{
    if (somethingChanged)
    {
        //1: I added this line:
        somethingChanged=false;

        //2: Instead of invalidating the properties, doing some  
        //  processing and calling super.commitProperties()
        ...; //  (some processing)
    }
    super.commitProperties();       
} 
```

# ruby-on-rails - 仅当主对象需要其存在时才验证嵌套对象

> ID：12099748
> 
> 赞同：2
> 
> 时间：2012-08-23T20:48:40.283
> 
> 标签：ruby-on-rails, ruby-on-rails-3, validation, nested-attributes

这是我的模型层次结构：

*   `Page`
    *   has_many :media (媒体可以是`TextMedium`, `ImageMedium`, `VideoMedium`... (STI))
        *   每个媒体 has_one :attachment ( `ImageAttachment`, `VideoAttachment`... (不同的表))

* * *

我想要一个表单来创建一个页面：

*   一个`ImageMedium`（非必需）
*   一个`VideoMedium`（不需要）
*   其他属性...

* * *

An`ImageMedium`验证其附件的存在。对于一个`VideoMedium`.

但是该页面不验证一个`ImageMedium`或`VideoMedium`媒体的存在。

* * *

我的表单看起来像这样（“伪代码”）：

```
form_for page
     fields_for :image_media
         fields_for :attachement
             image_field
     fields_for :video_media
         fields_for :attachement
             video_field 
```

* * *

**问题**：

*   如果我完整填写表格，它会很好用，我可以创建包含媒体和附件的页面。

*   但是如果我不填写视频字段，我仍然希望创建我的页面（因为页面不需要视频媒体）。但它不会，因为视频媒体需要其附件的存在，所以它是无效的，所以页面是无效的......

**问题**：

如何忽略视频媒体验证失败并仍然创建页面的事实？

* * *

**编辑**：

我找到了答案：

```
class Page < ActiveRecord::Base
    accepts_nested_attributes_for :video_media, reject_if: ->(attributes) { attributes["attachment_attributes"]["video"].blank? }
end 
```

如果你有更好的，请分享。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:07:31.810

我找到了答案：

```
class Page < ActiveRecord::Base
    accepts_nested_attributes_for :video_media, reject_if: ->(attributes) { attributes["attachment_attributes"]["video"].blank? }
end 
```

如果你有更好的，请分享。

# c# - 使用 Rock Ridge 扩展将文件添加到 ISO

> ID：12099755
> 
> 赞同：3
> 
> 时间：2012-08-23T20:48:54.970
> 
> 标签：c#, linux, windows, iso, live-cd

我在 linux 上创建了一个 ISO，其中包含可引导 livecd 系统的文件。ISO 使用 Rock Ridge 来保留 linux 权限。

我需要在 Windows 系统上修改这个 ISO 文件（不启动 linux VM），如何在不丢失 linux 符号链接和 linux 权限的情况下将文件添加到 ISO？

这是一个更大的 .NET 应用程序的一部分，所以我正在寻找一个控制台工具或一个 .NET 库来促进对 iso 的修改。

我已经尝试了以下方法：

*   使用来自 cygwin 的 mkisofs 手动提取并重新创建 iso。（问题：岩脊信息丢失）
*   使用 C# 和[DiscUtils 库](http://discutils.codeplex.com/)修改 ISO 。（问题：DistUtils 只支持读取 Rock Ridge - 不支持写入）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-27T18:39:21.647

使用 java 你可以使用 JIIC(Java ISO Image Creator) [JIIC](http://jiic.berlios.de/)
这里你必须使用 jiic api jiic jar 和 saber jar 文件你可以获取示例[程序来创建 iso 文件](https://github.com/stephenc/java-iso-tools/blob/master/iso9660-writer/ISOtest.java)

# emacs - Emacs 增量搜索 - 自动从搜索字符串中删除找不到的字符

> ID：12099760
> 
> 赞同：7
> 
> 时间：2012-08-23T20:49:03.323
> 
> 标签：emacs

当您在增量搜索期间打错字并且搜索字符串接收到错误输入的字符时，这并不方便。有没有办法防止这种情况。好像在出错时自动按下了 control-g。

例如，我们有以下文本：

```
keywords
keys 
```

**默认 emacs 行为：**

*   我们开始增量搜索并搜索“keyz”
*   搜索回显区显示“keyz”，“keywords”中的“key”部分高亮显示
*   我们按 s
*   找不到“keys”，光标停留在“keywords”行，搜索回显区显示“keyzs”，不方便

**需要的行为：**

*   我们开始增量搜索并搜索“keyz”
*   搜索回显区域显示“key”，“keywords”中的“key”部分高亮显示
*   我们按 s
*   找到并突出显示“键”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T01:56:11.930

你可以尝试类似的东西

```
(defadvice isearch-printing-char (before drop-mismatches-on-next-char activate)
  (while (or (not isearch-success) isearch-error)
    (isearch-pop-state))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T18:40:05.947

Emacs 保留了不正确的部分，因为您搜索一个字符串而没有找到它的情况经常发生，但不是因为它不正确，只是在光标之前找到了搜索字符串。在这种情况下，您可以按 Cs 并从文件开头开始搜索，非常方便。

这是非常有用的行为，而且它比错误输入搜索字符串更经常发生在我身上。如果搜索字符串中确实存在错误，那么您只需按 Cg 即可返回上一个正确的搜索字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T04:29:15.277

我认为问题在于您没有考虑以与 isearch 设计工作方式一致的方式进行搜索，因此您的问题在 isearch 目前存在的上下文中并没有真正意义。

Isearch 确实已经为您提供了您想要的功能，但是您必须通过键入您似乎强烈反对键入的 Cg 来告诉它您希望它发生。如果你不告诉 isearch 你想做什么，当你想让它做什么时，它怎么知道要做什么？

正如@Tom 试图解释的那样，默认方式 isearch 从缓冲区中的当前位置开始，如果您输入了一些失败的字符然后按 Cs，则可以在缓冲区的开头重新启动，这是一个非常有价值的功能。我相信很多人都依赖这种行为。您使用宏始终在缓冲区开头启动 isearch 的方法会使我们许多人感到困惑和困惑，尽管对于像您这样习惯于它的人来说，这当然不是一件坏事。这确实意味着我们其他人对您不喜欢按 Cg 删除不匹配的文本感到非常困惑。

还想一想如果您在启动 isearch 后立即按下第二个 Cs 会做什么（除了会话中的第一次之外的任何时间）（即在您键入任何其他字符之前）。特别注意如果您之前的搜索字符串仅部分匹配当前缓冲区中的某些内容，然后您按 Cg 会发生什么（并注意失败的搜索字符串是如何显示的，无论它是否会部分匹配当前缓冲区中的某些内容或不是）。

还要考虑一下您的功能如何对 multi-isearch-next-buffer-function 的使用产生不利影响。

声称其他编辑器可以做你想让 isearch 在 emacs 中做的事情并不能真正帮助你。

我认为你真正想要的是一些稍微不同类型的搜索功能，它只允许你搜索可以在当前缓冲区中找到的文本，而不是 isearch 搜索任何内容是否该文本恰好存在于当前缓冲与否。

也许 isearch-mode 可以适应你想要它做的事情，但我认为你必须以一种或另一种方式编写一些 elisp 代码。也许您可以将新的搜索模式作为 isearch-mode 中的一个选项来实现，可以像打开和关闭区分大小写的方式一样打开和关闭它；并且可以默认设置，同样可以默认打开或关闭区分大小写。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T21:58:26.280

如果您在增量搜索过程中出现拼写错误，您只需按退格键即可更正拼写错误。

*   我们开始增量搜索并搜索“keyz”
*   搜索回显区显示“keyz”，“keywords”中的“key”部分高亮显示
*   ***我们按退格键***
*   我们按 s
*   找到并突出显示“键”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T11:22:01.383

与大多数其他答案一样，我只是指出另一个有助于缓解所描述问题的功能。如果您在坏字符之后继续键入几个本来不错的字符，则此字符特别有用。

`M-e`是用于编辑 isearch 字符串的绑定，在当前字符串没有匹配项的情况下，它很有帮助地将点放置在第一个不匹配的字符上。

因此，如果您犯了一个小错字，您可以快速键入`M-e`，修复错误，然后`RET`使用更正的搜索字符串键入以返回 isearch。

# jquery - 始终向上标题和滑动 div

> ID：12099763
> 
> 赞同：0
> 
> 时间：2012-08-23T20:49:05.983
> 
> 标签：jquery, html, css

假设有一个始终可见的标题（即当页面向下滚动时）。

```
<div id="header">
    <div id="logindiv">
        Something to show for login purpose
    </div>
    My title etc.
</div>
<div id="pagecontent">
    page content and also a <button id="btn">Button</button>
</div> 
```

CSS 是类似的东西：

```
 #logindiv{
    width: 100%;  
    display:none;
 }
 #header{
    display:block;
    z-index: 1000;
    height:50px;
    position: fixed;
    top: 0;
    width: 100%  
 }
 #pagecontent{
    z-index: 0;
    margin-top:50px;
    width: 100%  
 } 
```

当单击这样的按钮时，div **logindiv与 jQuery 一起显示：** **slideDown()**函数用于装饰目的。

我怎样才能将**pagecontent** div*向下滑动相同的***logindiv**高度？当然，我还得在隐藏div上*滑后重新设置一切。*

 *****请参阅我的工作[JSFiddle](http://jsfiddle.net/ds6qT/)。此外，请参阅[此站点](http://www.yoox.com)以获取所需输出的示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:56:16.417

做一些更简单的事情 - 将两个 div 放入容器 div 中，然后滑动容器：

```
<div id="slide-me-instead">  <!-- Work with this -->
    <div id="header">
        <div id="logindiv">
            Someting to show for login purpose
        </div>
        My title etc.
    </div>
    <div id="pagecontent">
        page content and also a <button id="btn">Button</button>
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:28:39.920

测量可见#logindiv 的高度，当#btn 被点击时，动画#pagecontent margin-top 加上它的原始边距顶部，连同logindiv .slidedown()

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:35:25.963

[工作演示](http://jsfiddle.net/P8LRT/)

**代码**

```
$(function () {
    $('#btn').click(function(){
        var div =  $('#logindiv')
            var div2=$('#pagecontent')
            var div3=$('#header')
        if(div.is(':hidden'))
            {  div.slideDown();
        div2.css('margin-top',parseInt(div2.css('margin-top'))+ $('#header').height()+'px').hide().show('slow')} 
            else {
          div.slideUp();
        div2.css('margin-top',parseInt(div2.css('margin-top'))- $('#header').height()+'px').hide().show('slow')
    }

    });
});​ 
```

**编辑**

没有动画

```
$(function () {
    $('#btn').click(function(){
        var div =  $('#logindiv')
            var div2=$('#pagecontent')
            var div3=$('#header')
        if(div.is(':hidden'))
            {  div.slideDown();
        div2.css('margin-top',parseInt(div2.css('margin-top'))+ $('#header').height()+'px')} 
            else {
          div.slideUp();
        div2.css('margin-top',parseInt(div2.css('margin-top'))- $('#header').height()+'px')
    }

    });
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T07:34:55.077

我找到**了**解决方案。在这里您可以找到[JSFiddle](http://jsfiddle.net/ds6qT/15/)。

1）我在页面内容之前**添加了一个空 div**。

```
<div id="header">
    <div id="logindiv">
        Someting to show for login purpose
    </div>
    My title etc.
</div>
<div id="forsliding"></div>
<div id="pagecontent">
    page content and also a <button id="btn">Button</button>
</div> 
```

2）我通过添加新div的CSS来修改CSS，这等于滑动div的CSS。当然，**我必须将高度设置为固定**。

```
 #logindiv, #forsliding{
    width: 100%;
    height:40px;   
    display:none;
 } 
```

3) 我**对 Javascript**代码做了一个小改动。

```
$(function () {
   $('#btn').click(function(){
       var div =  $('#logindiv');
       if(div.is(':hidden'))
         div.add('#forsliding').slideDown();
       else
         div.add('#forsliding').slideUp();

    });
}); 
```*****

# junit - 如何模拟决赛

> ID：12099764
> 
> 赞同：7
> 
> 时间：2012-08-09T09:22:20.457
> 
> 标签：junit

我试图在 Eclipse 中使用 JDave 在 junit 中模拟最终类（AnyFinalClass.java）。

```
public void setUp() throws Exception {
    Mockery mockery = new Mockery() {{
        setImposteriser(ClassImposteriser.INSTANCE);
    }};

    AnyFinalClass any = mockery.mock(AnyFinalClass.class);
} 
```

我正在尝试使用 jdave-unfinalizer-1.1.jar 作为 javaagent 但没有任何成功。我尝试了多种方法，但出现以下异常

java.lang.IllegalArgumentException：不能在 net.sf.cglib.core.DefaultGeneratorStrategy.generate(DefaultGeneratorStrategy.java:25) 的 net.sf.cglib.proxy.Enhancer.generateClass(Enhancer.java:446) 子类化最终类类 AnyFinalClass

已经尝试过 jdave unfinalizer 的人可以告诉我如何使其在 eclipse 上工作的确切步骤。

我在 eclipse.ini 文件中设置了以下内容，但遇到了问题 -Xbootclasspath/a:lC:\WS\JunitTesting\jars\asm-3.0.jar -javaagent:C:\WS\JunitTesting\jars\jdave-unfinalizer-1.1.jar

在运行执行 junit 时，我将 vm 参数设为 javaagent:C:\WS\JunitTesting\jars\jdave-unfinalizer-1.1.jar

我不确定代码是什么。jdave 没有代码，它的站点指向其他一些不工作的站点。请更正我的代码或提供相同的工作代码。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T09:58:54.340

来自 Enhancer.java 第 446 行：

```
if (TypeUtils.isFinal(sc.getModifiers()))
   throw new IllegalArgumentException("Cannot subclass final class " + sc); 
```

我没有使用过 JDave，而是使用过另一个模拟框架，唯一允许模拟最终类的框架是[powermock](http://code.google.com/p/powermock/) 也在[这里](https://stackoverflow.com/questions/11575641/powermock-mockito-and-mocking-final-class-from-the-reflection-api)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T01:12:00.197

为了让 unfinalizer 运行，您必须`-javaagent:path_to_unfinalizer/jdave-unfinalizer-1.1.jar`输入测试运行配置的 VM 参数。

我还必须在启动测试的项目的类路径中包含 jdave-unfinalizer 的几个依赖项。这些取自 jdave 的 maven 定义：

```
jdave-core 1.1
cglib-nodep 2.1_3
objenesis 1.0
asm 3.0
asm-commons 3.0
asm-tree 3.0 
```

# ruby-on-rails - Rails / Ruby - 地图id：没有内部大括号的值对输出？

> ID：12099766
> 
> 赞同：0
> 
> 时间：2012-08-23T20:49:07.153
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

一个非常简单的问题 - 我目前有以下代码：

```
render :json => @items.map { |item| {item.id => item.value} } 
```

这以以下格式输出：

```
[{"12":"1.6 5d"},{"13":"1.7 16V 5d"},{"14":"1.6 L 5d"}] 
```

如何重新格式化代码以使其在没有内部大括号的情况下输出？（像这样）：

```
{"12":"1.6 5d","13":"1.7 16V 5d","14":"1.6 L 5d"} 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:58:01.447

你可以使用reduce方法

```
@items.reduce({}) do |hash, kv| 
  hash[kv.first] = kv.last
  hash
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T03:03:45.873

我看到的另一个常见技巧，如果我能做对的话：

```
Hash[*@items.map { |item| [item.id,item.value] }.flatten] 
```

*编辑*根据其他人的说法，这是 ruby​​ 1.8.6 或更低版本，但较新的 rubies 可以简单地：

```
Hash[@items.map { |item| [item.id,item.value] }] 
```

# objective-c - 加载和保存 NSMutableArray 不起作用

> ID：12099772
> 
> 赞同：0
> 
> 时间：2012-08-23T20:49:26.467
> 
> 标签：objective-c, ios, file

首先，我有一个管理 NSMutableArray 的类。当类被实例化时，它应该查看是否已经保存了一个数组并加载它，或者创建一个新数组。

每次添加项目时都应保存。但是：什么也没发生。

```
#import "NEList.h"

@interface NEList()

@end

@implementation NEList
@synthesize theInternArray;

-(id) initWithArray {
    self = [super init];

    if(self != nil) {
             NSLog(@"build");

        theInternArray = [[NSMutableArray alloc] initWithCapacity:20];

        return self;
    }
    return nil;
}

-(id) initWithContent {
    self = [super init];

    if(self != nil) {
        NSLog(@"load");

        NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        NSString *documentsDirectory = [paths objectAtIndex:0];
        NSString *filePath = [documentsDirectory stringByAppendingPathComponent:@"theFiles"];

        theInternArray = [NSMutableArray arrayWithContentsOfFile:filePath];

        if(theInternArray == nil) {
            theInternArray = [[NSMutableArray alloc] initWithCapacity:200];
        }
               NSLog(@"second %@", theInternArray);
        return self;
    }
    return nil;
}

-(BOOL) save {

   NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
  NSString *documentsDirectory = [paths objectAtIndex:0];
   NSString *filePath = [documentsDirectory stringByAppendingPathComponent:@"theFiles"];

    return [self.theInternArray writeToFile:filePath atomically:NO];
}

-(BOOL) addObject:(NEListItem *)theItem {

    [theInternArray addObject:theItem];    [self save];

    UILocalNotification *localNotif = [[UILocalNotification alloc] init];

    localNotif.fireDate = theItem.theBestBeforeDate;
    localNotif.timeZone = [NSTimeZone defaultTimeZone];

    localNotif.alertBody = [theItem.theName stringByAppendingString:@" expires!"];
    localNotif.alertAction = NSLocalizedString(@"View Details", nil);

    localNotif.soundName = UILocalNotificationDefaultSoundName;
    localNotif.applicationIconBadgeNumber = 1;

    [[UIApplication sharedApplication] scheduleLocalNotification:localNotif];

    return true;
}

-(NEListItem *) getElementAtIndex:(NSUInteger)theIndex {
    return [theInternArray objectAtIndex:theIndex];
}

-(BOOL)removeObjectByName:(NSString *)theName {

    for (NEListItem *tempItem in theInternArray) {

        if([tempItem.theName isEqualToString:theName]) {
            [theInternArray removeObject:tempItem];
            break;
            return true;
            }
    }

            NSLog(@"Nicht gefunden");
            return false;
        }

@end 
```

在另一个拥有 NEList 实例的类中调用 save 方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:30:03.110

好的，我改变的只是“initWithContent”方法和保存方法。我已经注释掉了您的代码，并在它下面进行了更改以使用 NSUserDefaults。NSUserDefaults 应该保存 Array 的二进制文件，然后将其取回并将其转换回 NSArray。如果这不起作用，请告诉我您遇到了什么错误。

```
-(id) initWithContent {
    self = [super init];

    if(self != nil) {
        NSLog(@"load");
        /*
        NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        NSString *documentsDirectory = [paths objectAtIndex:0];
        NSString *filePath = [documentsDirectory stringByAppendingPathComponent:@"theFiles"];

        theInternArray = [NSMutableArray arrayWithContentsOfFile:filePath];

        if(theInternArray == nil) {
            theInternArray = [[NSMutableArray alloc] initWithCapacity:200];
        }
        NSLog(@"second %@", theInternArray);*/
        NSUserDefaults *uDefaults = [NSUserDefaults standardUserDefaults];
        theInternArray = [uDefaults objectForKey:@"internArray"];
        if (!theInternArray)
        {
            theInternArray = [[NSMutableArray alloc] initWithCapacity:200];
        }
        NSLog(@"%@", theInternArray);

        return self;
    }
    return nil;
}

-(BOOL) save {

    /*NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *filePath = [documentsDirectory stringByAppendingPathComponent:@"theFiles"];*/

    NSUserDefaults *uDefaults = [NSUserDefaults standardUserDefaults];
    [uDefaults setObject:theInternArray forKey:@"internArray"];

    //return [self.theInternArray writeToFile:filePath atomically:NO];
    return [uDefaults objectForKey:@"internArray"];
} 
```

哦，您的方法不起作用的原因是保存文件然后将其取回并不是那么简单。您需要将数组中的数据（如“item1、item2、item3 等”打印到文件中，然后解析它并稍后使用该数据创建一个 NSArray。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T01:10:14.057

所以，这是对我有用的解决方案。首先，这是我存储在数组中的自定义类：

```
#import <Foundation/Foundation.h>

@interface NEListItem : NSObject <NSCoding>

@property (nonatomic, strong) NSString *theName;
@property (nonatomic, strong) NSString *theBestBeforeDate;
@property (nonatomic, strong) NSDate *theInternDate;

-(id) initWithName:(NSString *) theInitName;
 @end 
```

和实施

```
#import "NEListItem.h"

@implementation NEListItem
@synthesize theName = _theName;
@synthesize theBestBeforeDate = _theBestBeforeDate;
@synthesize theInternDate = _theInternDate;

-(id)initWithName:(NSString *)theInitName {
    self = [super init];
    if(self != nil) {
        self.theName = theInitName;

        return self;
    }
    return nil;
}

- (void)encodeWithCoder:(NSCoder *)coder;
{
    [coder encodeObject:self.theName forKey:@"theName"];
    [coder encodeObject:self.theBestBeforeDate forKey:@"theBBDate"];
    [coder encodeObject:self.theInternDate forKey:@"theInternDate"];
}

- (id)initWithCoder:(NSCoder *)coder;
{
    self = [[NEListItem alloc] init];
    if (self != nil)
    {
        self.theName = [coder decodeObjectForKey:@"theName"];
        self.theInternDate = [coder decodeObjectForKey:@"theInternDate"];
        self.theBestBeforeDate = [coder decodeObjectForKey:@"theBBDate"];
    }
    return self;
}

@end 
```

因此，这是保存自定义值所必需的。

保存方法：

```
-(BOOL) save {

    NSLog(@"save called");
    [[NSUserDefaults standardUserDefaults] setObject:[NSKeyedArchiver archivedDataWithRootObject:theInternArray] forKey:@"savedArray"];
    return true;
    } 
```

以及作为 init 方法一部分的加载

```
 NSUserDefaults *currentDefaults = [NSUserDefaults standardUserDefaults];
        NSData *dataRepresentingSavedArray = [currentDefaults objectForKey:@"savedArray"];

            NSArray *oldSavedArray = [NSKeyedUnarchiver unarchiveObjectWithData:dataRepresentingSavedArray];

        if (oldSavedArray != nil) {
                theInternArray = [[NSMutableArray alloc] initWithArray:oldSavedArray];
            return self;
        }
            else
                          theInternArray = [[NSMutableArray alloc] initWithCapacity:200];
        return self;
        } 
```

非常感谢 ManOx，它帮了我很多

# javascript - 如何使用 javascript 更改背景图像 ondragenter 或 ondragover

> ID：12099773
> 
> 赞同：2
> 
> 时间：2012-08-23T20:49:26.337
> 
> 标签：javascript, html, background, drag-and-drop, background-image

我有一个带有 ondragenter 事件的 div。当鼠标进入 div 时，我希望背景更改为特定图像，但直到我松开鼠标按钮，图像才会更改。

如果我尝试更改为背景颜色，它可以正常工作！我还尝试使用背景图像更改 css 类并且它可以工作，但在我的情况下我不能这样做，因为我不知道从 css 中显示哪个图像。

**HTML**

```
<div id="test" ondrop="drop(event)" ondragenter="enter(event)"></div> 
```

**JavaScript**

```
function enter(event) {
    $('#test').css('background', '#333 url("test.png")');
    event.preventDefault();
} 
```

在我的代码示例中，当鼠标进入时，div 将获得颜色#333，然后在我松开鼠标按钮时获得背景图像。

我正在基于 webkit 的 spotify 中开发它。有谁知道我该如何解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T23:50:47.933

在[http://musicmachinery.com/2011/12/02/building-a-spotify-app/](http://musicmachinery.com/2011/12/02/building-a-spotify-app/)上，它说：

> > 开发 Spotify 应用就像开发现代 HTML5 应用一样。你有一个丰富的工具包：CSS、HTML 和 Javascript。您可以使用 jQuery，也可以使用许多 Javascript 库。您的应用可以连接到第 3 方网络服务，例如 The Echo Nest。Spotify 应用程序几乎支持您的 Chrome 浏览器支持的所有内容，但有一些例外：没有网络音频、没有视频、没有地理定位和 Flash（谢天谢地）。

话虽如此，我建议您使用 Jquery。它不仅易于学习，而且您可以访问 JQuery UI（访问[http://jqueryui.com/demos/](http://jqueryui.com/demos/)以获取演示）。

至于您的拖放问题，我已经为您提供了一个使用 jquery 的示例。该演示可以在[HERE](http://jsfiddle.net/H8fPL/12/)或[http://jsfiddle.net/H8fPL/12/](http://jsfiddle.net/H8fPL/12/)上找到。我还提供了我在下面使用的代码。需要帮助请叫我！快乐编码！

CSS：

```
div{
 width:200px;
 height:220px;
 border:1px solid black;    
}

#div1{
 background-color:orange;
 margin-left:20px;
}

.NC{
 background:url("http://www.dreadcentral.com/img/news/jun11/niccage.jpg") no-repeat;   
}

.surprised{
background:url('http://rlv.zcache.ca/smiley_oh_sticker-p217194901605792400envb3_400.jpg');
background-size:80px 60px;
background-repeat:no-repeat;
background-position:center;
} 
```

JAVASCRIPT：

```
//needed for jquery, 
//CALL THIS SCRIPT BEFORE USING $ syntax
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script> 
//query UI script
<script type="text/javascript" src="http://code.jquery.com/ui/1.8.18/jquery-ui.min.js"></script> 
```

HTML：

```
<div id='div1'>
Come Hither...
</div>

<div id="dropme">
DRAG ME OVER AND WATCH ME CHANGE
</div> 
```

重要参考：

*   [http://docs.jquery.com/Main_Page](http://docs.jquery.com/Main_Page)（显然）
*   [http://jqueryui.com/demos/](http://jqueryui.com/demos/) (UI DEMOS)
*   [http://jqueryui.com/demos/droppable/](http://jqueryui.com/demos/droppable/)（方法/事件/选项必不可少！）
*   [http://jqueryui.com/demos/draggable/#event-drag](http://jqueryui.com/demos/draggable/#event-drag)（方法/事件/选项必不可少！）
*   [http://oscarotero.com/jquery/（jquery](http://oscarotero.com/jquery/)备忘单）

# silverlight - Lightswitch 中的类库

> ID：12099774
> 
> 赞同：0
> 
> 时间：2012-08-23T20:49:27.307
> 
> 标签：silverlight, rabbitmq, visual-studio-lightswitch

我正在使用 Microsoft 的这款新 Lightswitch 开发应用程序。

设计屏幕并将它们与数据库连接非常好，但此时我必须向我们的 RabbitMQ 队列发送一些消息，为此我需要能够添加一些 C# 类库（如 protobuf、rabbitmq、log4net 等) 来创建订阅者和共享的类和对象。

到目前为止，我了解 Lightswitch 是基于 Silverlight 的，它只有 20% 的实际 .NET 框架，还有其他引擎，然后是 CLR 和有限的功能。

但我真的被困在这里，我会很感激一些想法。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T10:06:28.293

虽然您想要做的事情是可能的，但它肯定不像*“您需要做的就是在**LS 客户端项目**中添加对您的程序集的引用，然后使用您在这些引用的程序集中定义的任何类型，您就像黄金一样好”* .

您不能在客户端中使用 .NET 程序集（正如您所指出的，客户端目前基于 Silverlight）。LightSwitch 没有让Silverlight 客户端*直接*访问 .NET 程序集的方法，但它们可以在*服务器*项目中使用。

有一种技术，我们中的许多人将其称为“命令表模式”（尽管它本身不是官方模式）。这涉及到有一个“命令”表（或一个“动作”表，或一个“虚拟”表，不管它叫什么），您可以以编程方式向其中添加和保存来自*客户端层*的记录，然后拦截*服务器层*中“虚拟”记录的保存，允许您“触发”您可能需要使用的任何 .NET 代码的使用。

它当然不像它可能的那样简单（希望这将在未来的版本中得到解决），但它确实允许您绕过 Silverlight 可能给您带来的任何限制。我很想知道你从哪里得到 20% 的数字，我以前从未听说过，而且我怀疑 Silvelight 的功能与 .NET 相比是否那么低。

# c# - Excel公式到伪代码

> ID：12099777
> 
> 赞同：6
> 
> 时间：2012-08-23T20:49:56.367
> 
> 标签：c#, excel, parsing, pseudocode

是否有任何工具可以格式化excel公式，使其更容易破译？

我需要将人们制作的一些复杂的 excel 电子表格转换为 C# 应用程序，而坐在那里看一行 excel 公式是比较麻烦的。首先，我正在寻找可以将它们重写为伪代码或更易读的编程语言的东西。

我能找到的最接近的东西是[http://ewbi.blogs.com/develops/2004/12/excel_formula_p.html](http://ewbi.blogs.com/develops/2004/12/excel_formula_p.html)但这仍然没有太大帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T21:45:13.047

Sean Cheshire 的评论可能是您将得到的最佳答案：

[Excel 公式美化器](http://excelformulabeautifier.com/)

它具有允许您转换为 javascript 的功能。

它似乎缺少的一件事是一次执行一批公式的功能（如果在打开“显示公式”的情况下转换整个工作表，这将节省大量时间）。我[为此添加了一个请求](https://github.com/joshatjben/excelFormulaUtilitiesJS/issues/11)。

鉴于应用程序现在的工作方式，如果您尝试将批处理粘贴到单行输入字段中，您可能仍然会得到至少有点有用的结果。我建议试一试。

# ios - 在选择器视图中更改行颜色

> ID：12099779
> 
> 赞同：0
> 
> 时间：2012-08-23T20:50:03.037
> 
> 标签：ios, uipickerview

有没有办法在行中更改选择器视图对象颜色？

例如，您有`addobject:@"black"`但如何将字体颜色更改为红色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:43:34.717

您可以使用 UIView 方法，而不是使用“title”委托方法，然后创建和填充您自己的视图。所以你创建一个 320 宽 x 44 高的 UIView，在里面放一个标签，设置标签文本和颜色，现在你就得到了你想要的。

编辑：

```
#define PICKER_VIEW_SIZE CGSize(300, 40)

- (CGFloat)pickerView:(UIPickerView *)pickerView rowHeightForComponent:(NSInteger)component
{
    return PICKER_VIEW_SIZE.height;
}

- (CGFloat)pickerView:(UIPickerView *)pickerView widthForComponent:(NSInteger)component
{
    return PICKER_VIEW_SIZE.width;
}

- (UIView *)pickerView:(UIPickerView *)pickerView viewForRow:(NSInteger)row forComponent:(NSInteger)component reusingView:(UIView *)view
{
    // assume one component, but this solutions works for multiple
    // lets do red, green, and blue alternating backgrounds with alternating black and white text

    UIColor *backgroundColor;
    switch(row % 3) {
    case 0:
    default:
        backgroundColor = [UICOlor redColor];
        break;
    case 1:
        backgroundColor = [UIColor blueColor];
        break;
    case 2:
        backgroundColor = [UIColor greenColor];
        break;
    }
    UIColor *textColor = (row % 2) ? [UIColor blackColor] : [UIColor whiteColor];

    UIView *view = [[UIView alloc] initWithFrame:(CGRect){ {0,0}, PICKER_VIEW_SIZE}];
    view.backgroundColor = backgroundColor;

    UILabel *label = [UILabel alloc] initWithFrame:CGRectMake(10, 10, 200, 20)];
    // configure the label
    label.text = text appropriate for this row;

    [view addSubview:label];

    return view;
} 
```

# c# - linq to sql 不在的地方

> ID：12099780
> 
> 赞同：0
> 
> 时间：2012-08-23T20:50:11.180
> 
> 标签：c#, linq-to-sql

我正在尝试使用 linq to sql 查找不在朋友用户朋友列表中的所有用户。现在我正在将好友列表与系统中的所有用户进行比较。使用 linq to sql 必须有更好的方法。谢谢你的帮助

```
// Comparing this to list to see who does not exist.
// What I would like to do is just use one statement
// to get the list of non friend users
var friends = (from x in db.FriendsLists
               where
                   (x.TheUser == GlobalVariables.User.ID) ||
                   (x.TheFriend == GlobalVariables.User.ID)
               select x).ToList();

var allUsersInSystem = (from x in db.Users select x).ToList(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:19:12.243

```
 var friends = (from x in db.FriendsLists
                                   where
                                       (x.TheUser == GlobalVariables.User.ID) ||
                                       (x.TheFriend == GlobalVariables.User.ID)
                                   select x.UserID).ToList();

     var notInFriendList = from nf in db.Users
                where !friends.Contains(nf.UserID)
                select nf; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:53:14.590

您可以使用[IEnumerable.Except](http://msdn.microsoft.com/en-us/library/bb300779.aspx)。

例子：

`var notIn = allUsersInSystem.Except(friends);`

# php - 创建命中计数器

> ID：12099788
> 
> 赞同：0
> 
> 时间：2012-08-23T20:50:46.570
> 
> 标签：php, codeigniter, codeigniter-2

我正在尝试为我的网站创建一个计数器，我已经为它开发了以下代码。我只在我的主页的 Codeigniter 的主控制器中包含了以下代码。

起初我认为代码工作正常，但我发现如果我不继续浏览页面然后再次转到主页它不会更新数据。我的意思是：如果我第一次访问我的主页，它会更新数据，但如果我刷新页面 10 秒后它不会更新数据。但如果我继续刷新它 10 秒，它就会起作用。

那么你能告诉我如何让它更新数据而不必继续浏览页面或刷新主页吗？

谢谢 ：）

```
function __construct() {

    parent::__construct();

    // Visitor Counter
    if (!$this->session->userdata('timeout')) {

        $out = time() + 10; // I will change it to $out = time() + 60*60; later 
        $this->session->set_userdata('timeout', $out);
        mysql_query("UPDATE cane_visitor_counter SET visitor_stat = visitor_stat+1 
              WHERE id = '1'");
    } else {
        $timeout_time = $this->session->userdata('timeout');
        if (time() > $timeout_time) {

            $this->session->set_userdata(array('timeout' => ''));
            $this->session->sess_destroy();
        }
    }
} 
```

## 编辑

我想要实现的是当用户第一次访问网页时，我想更新我的数据库。在 10 秒内（例如目的），如果访问者再次访问主页，则不会更新数据库。但是10秒后如果他再次访问主页，我想更新我的数据库。

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:03:02.450

您的代码显示“如果会话中没有超时，请更新计数”。你想让它说“如果会话中没有超时，或者有但它是旧的，更新计数”。

```
function __construct() {

    parent::__construct();

    // Visitor Counter
    if (!$this->session->userdata('timeout') || $this->session->userdata('timeout') < time()) {
        $this->session->set_userdata('timeout', time() + 10);
        mysql_query("UPDATE cane_visitor_counter SET visitor_stat = visitor_stat + 1 WHERE id = 1");
    }

} 
```

我不是 CodeIgniter 用户，所以我假设您正确使用了它的会话功能；我只是以同样的方式使用它们。

# python - 异步查询第一次抛出 AssertionError (AppEngine, NDB)

> ID：12099790
> 
> 赞同：0
> 
> 时间：2012-08-23T20:50:46.930
> 
> 标签：python, google-app-engine, app-engine-ndb

当我在查询上使用 fetch_async() 时，它在第一次运行时会因 AssertionError 而崩溃。如果我立即再次运行它，那很好。

例如。

带型号：

```
class User(ndb.Model):
    user = ndb.UserProperty()
    name = ndb.StringProperty()
    penname = ndb.StringProperty()
    first_login = ndb.DateTimeProperty(auto_now_add=True)
    contact = ndb.BooleanProperty() 
```

以下立即起作用，返回一个空列表：

```
users = User.query(User.penname == "asdf").fetch() 
```

但这会崩溃：

```
future = User.query(User.penname == "asdf").fetch_async()
users = future.get_result() 
```

和：

```
Traceback (most recent call last):
  File "/opt/google-appengine-python/google/appengine/ext/admin/__init__.py", line 320, in post
    exec(compiled_code, globals())
  File "<string>", line 6, in <module>
  File "/opt/google-appengine-python/google/appengine/ext/ndb/tasklets.py", line 320, in get_result
    self.check_success()
  File "/opt/google-appengine-python/google/appengine/ext/ndb/tasklets.py", line 357, in _help_tasklet_along
    value = gen.throw(exc.__class__, exc, tb)
  File "/opt/google-appengine-python/google/appengine/ext/ndb/query.py", line 887, in _run_to_list
    batch = yield rpc
  File "/opt/google-appengine-python/google/appengine/ext/ndb/tasklets.py", line 435, in _on_rpc_completion
    result = rpc.get_result()
  File "/opt/google-appengine-python/google/appengine/api/apiproxy_stub_map.py", line 592, in get_result
    return self.__get_result_hook(self)
  File "/opt/google-appengine-python/google/appengine/datastore/datastore_query.py", line 2386, in __query_result_hook
    self._batch_shared.conn.check_rpc_success(rpc)
  File "/opt/google-appengine-python/google/appengine/datastore/datastore_rpc.py", line 1191, in check_rpc_success
    rpc.check_success()
  File "/opt/google-appengine-python/google/appengine/api/apiproxy_stub_map.py", line 558, in check_success
    self.__rpc.CheckSuccess()
  File "/opt/google-appengine-python/google/appengine/api/apiproxy_rpc.py", line 156, in _WaitImpl
    self.request, self.response)
  File "/opt/google-appengine-python/google/appengine/api/datastore_file_stub.py", line 568, in MakeSyncCall
    response)
  File "/opt/google-appengine-python/google/appengine/api/apiproxy_stub.py", line 87, in MakeSyncCall
    method(request, response)
  File "/opt/google-appengine-python/google/appengine/datastore/datastore_stub_util.py", line 2367, in UpdateIndexesWrapper
    self._UpdateIndexes()
  File "/opt/google-appengine-python/google/appengine/datastore/datastore_stub_util.py", line 2656, in _UpdateIndexes
    self._index_yaml_updater.UpdateIndexYaml()
  File "/opt/google-appengine-python/google/appengine/datastore/datastore_stub_index.py", line 244, in UpdateIndexYaml
    all_indexes, manual_indexes)
  File "/opt/google-appengine-python/google/appengine/datastore/datastore_stub_index.py", line 85, in GenerateIndexFromHistory
    required, kind, ancestor, props, num_eq_filters = datastore_index.CompositeIndexForQuery(query)
  File "/opt/google-appengine-python/google/appengine/datastore/datastore_index.py", line 424, in CompositeIndexForQuery
    assert filter.property(0).name() == ineq_property
AssertionError 
```

但是，如果我立即再次运行它，例如通过执行以下操作：

```
future = User.query(User.penname == "asdf").fetch_async()

try:
    users = future.get_result()
except:
    users = future.get_result() 
```

有用。

这种情况到处都在出现，我正在努力找出根本原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T15:46:04.120

解决方案是升级到 1.7.1 SDK。

# c++ - 解释复制构造函数示例

> ID：12099792
> 
> 赞同：5
> 
> 时间：2012-08-23T20:51:04.433
> 
> 标签：c++, oop, copy-constructor

复制构造函数用于许多事情，例如当我需要使用指针或为对象动态分配内存时。但是看这个例子`tutorialpoint.com`：

```
#include <iostream>

using namespace std;

class Line
{
public:
  int getLength( void );
  Line( int len );             // simple constructor
  Line( const Line &obj);  // copy constructor
  ~Line();                     // destructor

private:
  int *ptr;
};

// Member functions definitions including constructor
Line::Line(int len)
{
cout << "Normal constructor allocating ptr" << endl;
// allocate memory for the pointer;
ptr = new int;
*ptr = len;
}

Line::Line(const Line &obj)
{
cout << "Copy constructor allocating ptr." << endl;
ptr = new int;
*ptr = *obj.ptr; // copy the value
}

Line::~Line(void)
{
cout << "Freeing memory!" << endl;
delete ptr;
}
int Line::getLength( void )
{
return *ptr;
}

void display(Line obj)
{
   cout << "Length of line : " << obj.getLength() <<endl;
}

// Main function for the program
int main( )
{
   Line line(10);

   display(line);

  return 0;
} 
```

结果是：

```
Normal constructor allocating ptr
Copy constructor allocating ptr.
Length of line : 10
Freeing memory!
Freeing memory! 
```

当我注释掉（复制构造函数）和析构函数中的代码时，我得到了相同的结果：

```
Normal constructor allocating ptr
Length of line : 10 
```

那么在这里使用复制构造函数有什么区别呢？还有为什么“释放内存！” 发生两次？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:54:39.320

打印正在释放的内存的地址。

我相信你会发现编译器为你生成了构造函数，做了一个内容的值副本，包括指针，你正在双重释放指针，幸运的是运行时没有抱怨它。

编译器生成的复制构造函数仍在被调用——在这方面没有任何改变，你只是没有从它打印任何东西，因为你没有写它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T21:10:07.853

函数的参数`display()`是按值传递的，因此编译器调用复制构造函数来创建它。当类定义其复制构造函数时，您将获得正确的语义：复制构造函数生成一个副本，并且该副本有自己的内存来保存长度。当您删除复制构造函数时，编译器会为您生成一个，并且传递给的副本`display()`具有与原始相同的指针。当该副本被破坏时，它会删除 ptr 指向的内存。当原件被破坏时，它会再次删除相同的内存（这恰好在这里没有可见的影响）。这绝对不是您想要发生的事情，这就是您需要定义复制构造函数的原因。正如@Joe 所说：在析构函数中，打印 `ptr' 的值以更清楚地看到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-16T10:34:56.633

如果我们不定义自己的复制构造函数，C++ 编译器会为每个类创建一个默认的复制构造函数，它会在对象之间进行成员明智的复制。编译器创建的复制构造函数通常可以正常工作。仅当对象具有指针或任何运行时资源分配（如文件句柄、网络连接）时，我们才需要定义自己的复制构造函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-15T09:37:40.703

某种类型 T 的构造函数，形式为

```
T (const & T); 
```

单个参数必须是对相同类型的现有对象的 const 引用 创建现有对象的副本 每当需要对象的副本时使用 包括函数的参数、函数返回的结果 C++ 中基于指针的数组的问题：–没有范围检查。无法与 == 进行有意义的比较 没有数组赋值（数组名称是 const 指针）。如果数组传递给函数，大小必须作为单独的参数传递。

# objective-c - @selector - 如何从另一个类调用方法？

> ID：12099796
> 
> 赞同：2
> 
> 时间：2012-08-23T20:51:23.123
> 
> 标签：objective-c, cocoa

我通过 Interface Builder 创建了一个 NSMenu。菜单项之一称为 showPreferencesPanel 方法，在 KBAppController.m 中定义：

```
-(void)showPreferencesPanel {
    //something
} 
```

现在，我必须在没有 IB 的情况下重新构建菜单......全部以编程方式。StatusMenu.m 是处理所有这些的类，我无法确定应该设置的目标，以便从另一个类调用方法。

创建该类的实例不起作用！菜单项显示为灰色。

**状态菜单.m**

```
KBAppController *kbAppController = [[KBAppController alloc]init];
NSMenuItem* preferencesItem;
[preferencesItem setTarget:kbAppController];
preferencesItem = [[NSMenuItem alloc] initWithTitle:@"Preferences…" action:@selector(showPreferencesPanel) keyEquivalent:@""]; 
```

**编辑：--------------------------------------------------------**

这是使用 KBAppController 类对象的更新代码。好消息是启用了首选项菜单项，但它仍然没有调用 KBAppController.m 中的方法:(

**KBStatusMenu.m**

```
@synthesize kbAppController = _kbAppController;

someMethod {   
NSMenuItem* preferencesItem;
preferencesItem = [[NSMenuItem alloc] initWithTitle:@"Preferences…" action:@selector(showPreferencesPanel) keyEquivalent:@""];
[preferencesItem setTarget:self];
}

- (void)showPreferencesPanel {
NSLog(@"in 1");
[_kbAppController showPreferencesPanel];
} 
```

**KBAppController.m**

```
-(void)showPreferencesPanel {
    NSLog(@"in 2");
    //something
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:55:14.433

NSMenuItem 有一个`- (void)setTarget:(id)anObject`并且`- (void)setAction:(SEL)aSelector`应该可以做到这一点。

只需确保首先设置并初始化 NSMenuItem。现在你正在调用`-setAction`一个未初始化的对象。

```
preferencesItem = [[NSMenuItem alloc] initWithTitle:@"Preferences…" action:@selector(showPreferencesPanel) keyEquivalent:@""];
[preferencesItem setTarget:kbAppController] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:55:16.870

从你`selector`的班级调用方法。在该方法中，`showPreferencePanel()`使用`KBAPPController`.

确保将 KBAppController 的对象设置为 StatusMenu 的属性。

# database - 订购一个装满物品的“包包”的数据建模

> ID：12099801
> 
> 赞同：0
> 
> 时间：2012-08-23T20:51:54.403
> 
> 标签：database, database-design, data-modeling

想象一个电子商务平台，其工作方式如下：

*   A `Package`, 由`Items`和 其他的混合物组成`Packages`。
*   An`Order`由 和 的混合物`Items`组成`Packages`。
*   用户可以选择一些物品和一些包裹来订购，但也可以继续从包裹中删除一些物品作为该订单的一部分，这不会影响原始包裹。
*   A`Package`将来可能会更改，但`Order`必须显示当时作为包裹的一部分实际订购的内容。

这是一个例子：

```
Package_A: [Large_Knife, Cutting_Board]
Package_B: [Cheese, Package_A]

Order_1: [Wine, Small_Knife, (Package_B - Large_Knife)] 
```

现在让我们说`Package_A`更改：

```
Package_A: [Large_Knife, Cork_Screw] 
```

这意味着新的`Package_B`有一个`Cork_Screw`而不是`Cutting_Board`。

当用户查看他的旧订单时，他应该看到他实际订购的内容。

```
Order_1: [Wine, Small_Knife, Package_B([Cheese, Cutting_Board])] 
```

`Large_Knife`如果这样更容易建模，则无需存储/显示已删除的内容。

很想听听关于如何建模的想法。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:38:20.250

一个项目可以在许多包中。

一个包可以包含许多项。

一个订单可以有很多商品和包裹。

一个包裹或项目可以在多个订单中。

一个用户可以下许多订单。

一个用户下的订单。

包裹的物品可能会随着时间而变化，但无需跟踪这种变化。

如果包裹发生变化，包含该包裹的订单不应受到影响，其内容应保持原样。

建议型号：

用户：用户 ID（PK）、姓氏、名字、电子邮件

项目：ItemId（PK），描述

包：PackageId(PK)，描述

PackageDetail：PackageId（FK），ItemId（FK）

订单：OrderId(PK)、UserId(FK)、DateOrdered

OrderDetail: OrderId(FK), ItemId(FK, not null), PackageId(FK, "0" if it's an Item)

如果 Order 包含一个 Item，OrderDetail 表中的 ItemId 字段必须包含它的 PK，并且 PackageId 必须设置为“0”。

如果 Order 包含一个 Package，在放置时包含 3 个项目，则必须在表 OrderDetails 上插入 3 行，所有行具有相同的 PackageId 但具有不同的 ItemdId。

# python - SQLite DROP TABLE 语句的问题

> ID：12099802
> 
> 赞同：4
> 
> 时间：2012-08-23T20:52:00.253
> 
> 标签：python, sql, sqlite, pysqlite

编辑：此时，我发现了错误的错字，我的问题变成了“我犯的错字是如何导致我收到错误的”和“我以后如何更好地调试它？”

我已经为 SQLite（通过 pysqlite）设置了一个数据库脚本，如下所示：

```
DROP TABLE IF EXISTS LandTerritory;
CREATE TABLE LandTerritory (
  name   varchar(50) PRIMARY KEY NOT NULL UNIQUE, 
  hasSC  boolean NOT NULL DEFAULT 0
);
```

我希望它始终运行没有错误。但是，如果我运行这个脚本两次，（使用`sqlite.Connection.executescript`方法）我得到这个错误：
`OperationalError:table LandTerritory already exists`

试图自己调试这个，我自己运行`DROP TABLE LandTerritory`并得到： `sqlite3.OperationalError: no such table: main.LandTerrito`

我猜这与“主要”有关。部分，但我不确定是什么。

编辑：好的`PRAGMA foreign_keys=ON`，这里也肯定涉及。当我创建连接时，我打开了 foreign_keys。如果我不打开它，我似乎不会收到此错误。

而且我应该提到脚本还有更多内容，但我假设错误发生在前 2 个语句中。脚本的其余部分只是做同样的事情，删除表，定义表。一些表具有对`LandTerritory`.

有没有办法获取有关 sqlite 错误的行号信息？那真的很有帮助。

编辑 2：好的，这是脚本中引用第一个表的另一个表。

```
DROP TABLE IF EXISTS LandAdjacent;
CREATE TABLE LandAdjacent (
  tname1 varchar(50) NOT NULL,
  tname2 varchar(50) NOT NULL,
  PRIMARY KEY (tname1, tname2),
  /* Foreign keys */
  FOREIGN KEY (tname1)
    REFERENCES LandTerrito
    ON DELETE CASCADE
    ON UPDATE CASCADE, 
  FOREIGN KEY (tname2)
    REFERENCES LandTerritory(name)
    ON DELETE CASCADE
    ON UPDATE CASCADE
); 
```

看着这个，我发现是“LandTerrito”来自，不知何故有几个字符被切断了。我猜想解决这个问题可能会解决我的问题。

但是我真的很困惑这个表中的虚线如何导致脚本第一次正确运行，然后在我第二次运行时给我一个与不同表相关的错误，以及外键如何发挥作用。

我想，从上面重申，有没有更好的方法来调试这种事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-21T12:55:16.740

错误的根源是您的错字

```
REFERENCES LandTerrito 
```

在脚本的第 8 行。这导致语句中的“缺失”`LandTerrito`表`CREATE TABLE LandAdjacent`。

如果你运行你的两条`CREATE TABLE`语句，Sqlite 不会抱怨。但是，如果您有`PRAGMA foreign_keys=ON;`并尝试在表上运行`INSERT`or`DELETE`语句`LandAdjacent`，您将得到错误`no such table: main.LandTerrito`。

然而由于外键约束会导致在表上`DROP TABLE`出现a ，从而触发错误。`LandTerritory``DELETE``LandAdjacent`

以下事情将避免错误

1.  `PRAGMA foreign_keys=ON;`在放下桌子之前设置（经过测试）或
2.  添加一个虚拟表`LandTerrito`（经过测试）或
3.  先下降`LandAdjacent`，然后`LandTerritory`（测试）或
4.  不要使用`ON DELETE CASCADE`（未测试）
5.  当然更正原来的错字。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-23T23:00:58.533

放置一个“GO”（或 SQLlite 中使用的任何等效项）以终止 drop table 语句和 create 语句之间的批处理

# objective-c - 为什么 UIInterfaceOrientation 总是回到右边？

> ID：12099807
> 
> 赞同：0
> 
> 时间：2012-08-23T20:52:31.420
> 
> 标签：objective-c, uiinterfaceorientation

为什么 UIInterfaceOrientation 总是回到右边？
当我完成旋转时，总是在右边结束，为什么？
PS：我只想风景

这里是代码

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    switch (interfaceOrientation)
    {
       case UIInterfaceOrientationLandscapeLeft:
          NSLog(@"Is Left");
       case UIInterfaceOrientationLandscapeRight:
          NSLog(@"Is Right");
       default: ;
    }

    return UIInterfaceOrientationIsLandscape(interfaceOrientation);
}

- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation
{
    switch (fromInterfaceOrientation)
    {
        case UIInterfaceOrientationLandscapeLeft:
          NSLog(@"From Left");
        case UIInterfaceOrientationLandscapeRight:
          NSLog(@"From Right");
        default: ;
    }
} 
```

这是日志

```
2012-08-23 17:45:28.074 Simulador 360[323:707] Is Right
2012-08-23 17:45:28.126 Simulador 360[323:707] Is Right
2012-08-23 17:45:28.131 Simulador 360[323:707] Is Left
2012-08-23 17:45:28.132 Simulador 360[323:707] Is Right
2012-08-23 17:45:28.138 Simulador 360[323:707] Is Left
2012-08-23 17:45:28.140 Simulador 360[323:707] Is Right
2012-08-23 17:45:31.160 Simulador 360[323:707] Is Right
2012-08-23 17:45:31.167 Simulador 360[323:707] Is Right
2012-08-23 17:45:31.977 Simulador 360[323:707] From Left
2012-08-23 17:45:31.980 Simulador 360[323:707] From Right
2012-08-23 17:45:35.684 Simulador 360[323:707] Is Left
2012-08-23 17:45:35.687 Simulador 360[323:707] Is Right
2012-08-23 17:45:35.691 Simulador 360[323:707] Is Left
2012-08-23 17:45:35.693 Simulador 360[323:707] Is Right
2012-08-23 17:45:36.502 Simulador 360[323:707] From Right 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:14:54.083

您的陈述中缺少`break`s 。`switch`如果不调用`break`，执行将继续到下一个案例，因此如果您的案例如果界面方向评估为左，则将执行左和右案例块。

`break`通过在每个案例的末尾插入来解决此问题：

```
switch (interfaceOrientation)
{
   case UIInterfaceOrientationLandscapeLeft:
      NSLog(@"Is Left");
      break;
   case UIInterfaceOrientationLandscapeRight:
      NSLog(@"Is Right");
      break;
   default: ;
} 
```

# php - 在 Wordpress 中删除/编辑 Img 类

> ID：12099810
> 
> 赞同：0
> 
> 时间：2012-08-23T20:52:35.980
> 
> 标签：php, image, wordpress, class

所以 Wordpress 正在输出这个

```
<img src="http://site.com/path/to/image.png"; alt="Text"  width="600" height="100" class="alignnone size-full wp-image-168" /> 
```

但是，我希望它输出这个

```
<img src="http://site.com/path/to/image.png"; alt="Text"  width="600" height="100" class="full wp-image-168" /> 
```

移除 align 类并移除 size- 部分。

我怎样才能通过functions.php文件中的过滤器来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T23:13:52.367

所以这里有几个过滤器可以满足你的需要。

```
add_filter( 'post_thumbnail_html', 'remove_image_classes', 10 );
add_filter( 'image_send_to_editor', 'remove_image_classes', 10 );

function remove_image_classes( $html ) {
    $html = preg_replace( '/(size-|alignnone)/', "", $html );
    return $html;
} 
```

我不知道我的 preg_replace 是否正确。试试看它是否会修改您的代码。

# osx-lion - Xcode 4.3.3 缺少 SenTestingKet.framework 导致未定义符号“_OBJC_METACLASS_$_SenTestCase”

> ID：12099811
> 
> 赞同：0
> 
> 时间：2012-08-23T20:52:43.113
> 
> 标签：osx-snow-leopard, xcode4.1 上，, osx-lion, xcode4.3, sentestingkit, sentestingkit, 由于此链接错误undefined-symbol, osx-lion, xcode4.3, sentestingkit

在我的 MAC mini [osx-snow-leopard](/questions/tagged/osx-snow-leopard "显示标记为“osx-snow-leopard”的问题") [xcode4.1 上，](/questions/tagged/xcode4.1 "显示标记为“xcode4.1”的问题")我的项目可以运行 SenTestingKit.framework 测试。得到了带有[osx-lion](/questions/tagged/osx-lion "显示标记为“osx-lion”的问题") 10.7.4和[xcode4.3](/questions/tagged/xcode4.3 "显示标记为“xcode4.3”的问题")的 MACBook Pro 。对于同一个项目，我无法运行单元测试，因为找不到 SenTestingKit.framework。我将[sentestingkit](/questions/tagged/sentestingkit "显示标记为“sentestingkit”的问题")从 Mac mini 复制到“/Applications/Xcode.app/Contents/Developer/Library/Frameworks”。添加到每个目标框架搜索路径：
$(inherited)
"$(DEVELOPER_LIBRARY_DIR)/Frameworks"

这解析为“/Applications/Xcode.app/Contents/Developer/Library/Frameworks”。

我可以将[sentestingkit](/questions/tagged/sentestingkit "显示标记为“sentestingkit”的问题")添加到项目中以便编译。[由于此链接错误undefined-symbol](/questions/tagged/undefined-symbol "显示标记为“未定义符号”的问题")，我无法运行 Product > Test ：

```
Undefined symbols for architecture i386:
  "_OBJC_METACLASS_$_SenTestCase", referenced from:
      _OBJC_METACLASS_$_Field_MobileApplicationTests in Field_MobileApplicationTests.o
  "_OBJC_CLASS_$_SenTestCase", referenced from:
      _OBJC_CLASS_$_Field_MobileApplicationTests in Field_MobileApplicationTests.o
ld: symbol(s) not found for architecture i386
collect2: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T13:44:08.190

通过使用我想要测试的类，我遇到了同样的问题。我收到了这个错误：

```
Undefined symbols for architecture i386:
"_OBJC_METACLASS_$_JsonDictParser", referenced from:
   _OBJC_METACLASS_$_MainData in MainData.o
   _OBJC_METACLASS_$_JsonObjectClass in JsonObjectClass.o
"_OBJC_CLASS_$_JsonDictParser", referenced from:
   _OBJC_CLASS_$_MainData in MainData.o
   _OBJC_CLASS_$_JsonObjectClass in JsonObjectClass.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我从我的班级创建了一个我想测试的对象，但忘记告诉“目标成员资格”。所以我确保我检查了测试类。

例如，我想在课堂上使用`JsonDictParser`类进行测试`JsonTestLogicTest`。所以我关注`JsonDictParser.m`文件，单击`File Inspector`主窗口右侧的 ，选择`Target Membership`并检查我的测试用例所在的类`JsonTestLogicTest`。

或者`.xcodeproject`在 Project Navigator 中打开文件，使用测试方法 > Build Phases > Compile Sources 选择目标，然后添加`.m`包含要测试的类的文件。

# cocos2d-iphone - 在 kobold2d 中注册 NSUserDefaults 的位置

> ID：12099813
> 
> 赞同：0
> 
> 时间：2012-08-23T20:52:45.793
> 
> 标签：cocos2d-iphone, kobold2d

我正在尝试跟踪我的应用程序何时首次在设备上运行，因此它将播放一个短视频，然后在使视频可跳过之后从那里播放。所以我使用 NSUserDefaults 执行此操作，但我使用的是 Kobold2d 并使用 lua 设置事情起来了。我想知道我应该在哪里注册 NSUserDfaults。据我了解，这通常是在应用程序委托中完成的，但看起来它在 kobold2d 中被覆盖了。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T12:04:01.570

Kobold2D AppDelegate 具有在加载第一个场景之前运行的initializationComplete 方法。你可以在那里添加这样的初始化代码。或者简单地将它添加到您的第一个场景的 init 方法中。它实际上只取决于您第一次开始使用 NSUserDefaults 变量的位置，但很可能不是在第一个场景的 init 方法运行之前。

# ruby-on-rails - rails 3：在 Class 方法中 self.do_something() 我如何访问 ApplicationHelper 方法？

> ID：12099814
> 
> 赞同：0
> 
> 时间：2012-08-23T20:52:47.290
> 
> 标签：ruby-on-rails, helper

我的模型 Widget.rb 具有`include ApplicationHelper`并且我的实例方法使用 application_helper.rb 中定义的任何方法都没有问题

但是，当我尝试在我的任何类方法中使用其中一个辅助方法时，例如

```
def self.send_broadcast(guid)
   track_guids(guid) # defined in application_helper.rb
end 
```

我得到没有方法错误。

是否有一些秘密握手允许在类方法中使用 ApplicationHelper 方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:16:02.377

`ApplicationHelper`只是一个模块：

```
module ApplicationHelper
  def track_guids(something)

  end
end

class Widget
  extend ApplicationHelper

  def self.send_broadcast(guid)
    track_guids(guid)
  end
end 
```

现在您应该可以从类方法访问模块方法。我不确定您是否可以同时扩展和包含相同的模块...不太确定那会做什么。

编辑添加：

我不确定如果您尝试将相同的模块扩展和包含到类中会发生什么。随着`extend`您将模块包含在类级别，`include`它包含在实例级别。如果你两者都做，它可能会给你类和实例的方法……或者它可能会死得很惨。试试看？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-23T21:03:06.637

我不认为你可以访问实例方法，除非 self 是一个实例。您可以创建一个 Widget 实例并从中调用类方法，或者您可以尝试直接从模块中调用方法。

# facebook - 在 fb 粉丝页面上获得喜欢，但推荐到网站

> ID：12099822
> 
> 赞同：0
> 
> 时间：2012-08-23T20:53:20.300
> 
> 标签：facebook

理想情况下，这就是我想要的：

*   我有一个大约有 2000 个赞的 fb 粉丝页面。我还有一个 fb 应用程序，我可以通过它在我的网站上运行社交插件。我在我的网站上使用以下代码设置了一个赞按钮：`{fb:like href="http://facebook.com/traveltriangle"}`

*   我想在我的网站上显示喜欢按钮，这样如果用户点击它，我的粉丝页面的“喜欢”就会增加。但是，我也希望用户时间轴上的帖子链接到我的网站，而不是我的粉丝页面。

我如何实现这一目标？

如果我更改代码以将其指向我的网站，`href`我也很好。`fb:like`然而，推荐链接很好，但我不能用那些喜欢的东西来发布我的用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:43:08.767

我不认为你可以使用merge tam。Fb粉丝页面是一回事，Fb App是另一回事。FB App 可以帮助您从我所知道的数据库中获取用户数据，而粉丝页面可以帮助您推广您的业务。为什么需要合并它们？

# oracle - 如何列出用户的所有选择、插入、删除或更新授权

> ID：12099832
> 
> 赞同：1
> 
> 时间：2012-08-23T20:54:13.883
> 
> 标签：oracle, grant

数据库：甲骨文 10g

我可以为某些表向用户授予 DML 命令：

```
GRANT SELECT, UPDATE, DELETE, INSERT ON USER_A.TABLE_1 TO USER_B; 
```

如何列出 USER_B 收到的所有授权（关于选择、更新、插入、删除）以及哪些表？

我检查了表“all_tab_privs_recd”，但没有我要找的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T00:14:55.563

Oracle 安全专家 Pete Finnegan 提供了几种不同的工具来帮助您回答这些类型的问题。

见： [http ://www.petefinnigan.com/tools.htm](http://www.petefinnigan.com/tools.htm)

特别是，对于上面的问题，请参阅 find_all_privs.sql

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:08:10.900

我不知道如何使用您建议的那些视图来列出 USER_B 收到的所有赠款。

将 USER_A.TABLE_1 上的 SELECT、UPDATE、DELETE、INSERT 授予 USER_B；

我查询：

```
select * from all_tables where owner='USER_A'
shows 16 rows

Select * from all_tab_privs_recd  where grantor = 'USER_A'
shows 0 rows

Select * from all_tab_privs_recd  where grantee = 'USER_A'
shows 0 rows

Select * from all_tab_privs_recd  where grantee = 'USER_B'
shows 0 rows

Select * from all_tab_privs_recd  where grantor = 'USER_B'
shows 129 rows, but USER_A is not in grantee, nor in grantor nor in owner 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:33:02.580

(`all_tab_privs_recd`和`all_tab_privs`) 视图仅显示具有显式授权的表，它们不显示 USER_B 拥有的表。（除非授予其他用户。也就是说，GRANTEE 和 OWNER 相同。）为此，您必须`all_tables`查看他们拥有哪些表，因此可以完全访问。

# jquery - 如何修改jQuery选择的文本

> ID：12099838
> 
> 赞同：0
> 
> 时间：2012-08-23T20:54:30.983
> 
> 标签：jquery, jquery-chosen

我目前有一个`select`显示选项为

```
<option>{{ tag.name }} ({{ tag.count }})</option> 
```

但是，我希望当用户选择选项时，在选定的选项中，只有`name`是可见的，而不是最后一部分。想想 stack* 如何显示标签计数，但在您选择它时将其隐藏。

想法？谢谢。

编辑：抱歉不清楚。在selected 中，当您[选择](http://harvesthq.github.com/chosen/)一个选项时，一个文本框会填满所选数据。我希望修改**该**文本，而不是`<select>`!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:14:41.853

编辑：对于*您的*编辑，如果选项元素的`value`属性设置为您要使用的文本，请尝试：

```
$(document).ready(function() {
    $("select").change(function() {
        $("input").val( $(this).val() );
    }).change();
});​ 
```

演示：http: [//jsfiddle.net/CdKGT/2/](http://jsfiddle.net/CdKGT/2/)

或者，如果您由于某种原因不能使用该`value`属性并想从显示的内容中提取文本：

```
$("select").change(function() {
    $("input").val( $("option:selected",this).text().replace(/ \(\d+\)$/,"") );
}).change(); 
```

演示：http: [//jsfiddle.net/CdKGT/3/](http://jsfiddle.net/CdKGT/3/)

显然，您将使用 id 或 class 来标识选择和输入，而不仅仅是`$("select")`and `$("input")`，但您明白了。

我的原始答案（我对您原始问题的解释）：

你可以这样做：

```
​&lt;select>
<option value="css" data-count="1">css 1</option>
<option value="html" data-count="55">html 55</option>
<option value="java" data-count="37">java 37</option>
<option value="javascript" data-count="20">javascript 20</option>
<option value="jquery" data-count="12">jquery 12</option>
</select> 
```

进而：

```
​$(document).ready(function() {
    $("select").change(function() {
        $(this).find("option").html(function(){ return this.value + " " +
                                                       $(this).attr("data-count"); });
        $("option:selected",this).html(this.value);
    }).change();
});​​​ 
```

演示：http: [//jsfiddle.net/CdKGT/1/](http://jsfiddle.net/CdKGT/1/)

（显然，您可以通过缓存 jQuery 对象等来稍微优化函数，但为了概念证明，我保持简单。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:10:06.857

**Chosen 不支持你想要的功能**

Kinda sorta 有一个解决方法......但是它并不能始终如一地工作，因为 selected 在内部是如何做的。 [http://jsfiddle.net/2hHYh/](http://jsfiddle.net/2hHYh/)

选择在选择选项时，选择并不总是触发更改事件，但它仍将将显示文本设置为单击的任何内容。:O 这在再次单击相同选项时尤其明显。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:12:04.857

试试这个代码：

```
$("select").change(
function()
{
    var value = $("option:selected").html()
    var new_value = value.replace(/\s*\([0-9]+\)/, "");
    $("option:selected").html(new_value);
} ); 
```

[http://jsfiddle.net/fdrGV/](http://jsfiddle.net/fdrGV/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T21:12:27.623

```
$('select').on('change', function () {
    var _selected = $(this).find('option:selected'),
        _orig = _selected.text();

    var _index = _orig.indexOf(' (');
    _selected.text(_orig.substring(_index, ''));

}); 
```

[**jsFiddle**](http://jsfiddle.net/8dD9j/)

# java - 将新对象存储为哈希图的值？

> ID：12099843
> 
> 赞同：16
> 
> 时间：2012-08-23T20:55:12.313
> 
> 标签：java, hashmap

我正在尝试找到一种方法将类的新实例存储为 Java 哈希图中的值。这个想法是由一位 Java 讲师给我的，目的是创建一个可用于我正在开发的程序的数据存储结构。

他向我推荐的想法是使用存储计算机名称作为键的哈希图，值将是类 InfoStor.class 的新实例。InfoStor 包含 getName()、setName()、getMemory() 等方法...

我已经为基本测试设置了类和方法，以查看它是否有效。我遇到的问题是，一旦我在哈希图中创建了一个新条目，我就无法弄清楚如何使用 InfoStor 中的方法。

这是我到目前为止的代码；

**VMware.class**

```
import java.util.HashMap;

public class VMware {

    public static void main(String[] args) {                       
        HashMap <String, Object> mapper = new HashMap();            
        mapper.put("NS01", new InfoStor("NS01"));            
        //mapper.get("NS01").            
    }            
} 
```

**信息存储类**

```
public class InfoStor {

    private String vmName;
    private String platform;
    private Integer memory;

    public InfoStor (String name) {
        vmName = name;
    }

    String getName(){
        return vmName;
    }

    void setPlatform(String p){
        platform = p;
    }

    String getPlatform(){
        return platform;
    }

    void setMemory(Integer m){
        memory = m;
    }

    Integer getMemory(){
        return memory;
    }
} 
```

我想要完成的是这样的（基本想法）。

```
Object var = mapper.get("NS01");    
System.out.println(var.getMemory()); 
```

我会以错误的方式解决这个问题吗？感谢任何帮助。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-23T21:00:44.623

问题是您的代码仅指定地图中的值是`Object`. 你知道的远不止这些，所以告诉编译器这些信息：

```
HashMap<String, InfoStor> mapper = new HashMap<String, InfoStor>();
mapper.put("NS01", new InfoStor("NS01"));
...

InfoStor value = mapper.get("NS01");
Integer memory = value.getMemory(); 
```

请注意，对变量类型使用接口*通常*虽然并不总是更好 - 您可以使用菱形运算符进行构造函数调用，让编译器使用类型推断来填充类型参数：

```
Map<String, InfoStor> mapper = new HashMap<>();
mapper.put("NS01", new InfoStor("NS01"));
...

InfoStor value = mapper.get("NS01");
Integer memory = value.getMemory(); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-23T21:00:19.927

如果您像这样声明您的哈希图：

```
HashMap<String, InfoStor> mapper = new HashMap<String, InfoStor>(); 
```

然后，当您从映射器中获取一个对象时，它将是一个实例`InfoStor`（您不需要转换它或担心类转换异常，因为它不是 rist 类。）

所以：

```
InfoStor myStor = mapper.get("somekey");
myStor.getMemory(); // this will work 
```

否则，如果您坚持`HashMap<String, Object>`使用原始代码中使用的方法，则需要在调用方法之前对其进行转换：

```
Object obj = mapper.get("somekey");
((InfoStor)obj).getMemory(); // cast is required
obj.getMemory(); // this will not compile 
```

您应该阅读 Java 泛型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T20:59:33.047

使用添加到 java.util 中的泛型。它们有助于编译时类型检查，并使强制转换变得不必要。

```
 HashMap <String, Object> mapper = new HashMap();
  //you will be able to retrieve an object and then cast it to your InfoStore
  InforStore isN01 = (InfoStore)mapper.get("N01");

  //this will unfortunately be accepted, even thought it's a bug
  mapper.put("N02", new Integer(0));

  ________________________

  HashMap <String, InfoStore> mapper = new HashMap();
  //you will be able to retrieve an object and then cast it to your InfoStore
  InforStore isN01 = mapper.get("N01"); //no cast 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T21:02:51.427

你在正确的轨道上...

将地图初始化为：

```
HashMap <String, InfoStor> mapper = new HashMap<String, InfoStor>(); 
```

然后在将对象添加到地图后检索它们：

```
InfoStor var = mapper.get("NS01");
System.out.println(var.getMemory()); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-10-02T17:11:18.820

你可以通过使用数组来做一些事情......例如，如果你可以将对象存储在数组中，然后使用这个想法在哈希映射中实现它......我不知道你是如何设计的，但我曾经陷入困境并像这样完成

例子...

公主班{

```
int age;

public princess(int age){
    this.age=age;
}
public int getAge(){
    return this.age;
} 
```

}

公共类 hashmaptest {

```
public static void main(String[] args) {
  princess[] p=new princess[10];
  HashMap scores = new HashMap();
  scores.put("a",new princess(6));
  scores.put("b",new princess(7));

  p[0]=(princess)scores.get("a");
   System.out.println(p[0].getAge());
  p[0]=null;
   p[0]=(princess)scores.get("b");

  System.out.println(p[0].getAge());

} 
```

}

# android - 录制视频时，光线不足会导致 fps 低

> ID：12099845
> 
> 赞同：5
> 
> 时间：2012-08-23T20:55:16.147
> 
> 标签：android, video-capture

我正在编写一个具有视频录制功能的应用程序。在光线充足的正常白天，我能够录制 30fps 的视频。

但是，当光线较少时，帧速率会下降到 7.5fps 左右（代码完全相同）。我的猜测是，android 在幕后利用曝光时间做一些事情，以确保生成的视频具有最佳图像质量。

但是，我更喜欢更高的 fps 而不是质量更好的图像。假设曝光是问题，有没有办法控制曝光时间以确保体面的 fps (15fps+)。有这些功能`setExposureCompensation()`，`setAutoExposureLock()`但它们似乎什么也没做。

以前有人遇到过这个问题吗？是不是曝光导致了我的问题？

任何点击/建议都会很棒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-04-08T14:27:03.927

我很抱歉，但接受的答案是完全错误的。事实上，我创建了一个帐户只是为了纠正这个问题。

无论如何，噪声信息会根据比特率被丢弃，我不明白为什么有人会认为这根本会给 CPU 带来额外的负载。

事实上，移动设备上的视频帧率与曝光有很大关系。在光线不足的情况下，曝光会自动增加，这也意味着快门将保持打开更长时间以让更多光线进入。这将减少您在一秒钟内可以捕获的帧数，并在顶部添加一些运动模糊。使用 DSLR 相机，您可以在不影响快门速度的情况下更改光圈以获得更多光线，但在移动设备上，您的光圈是固定的。

您可以使用曝光补偿来获得更高的 fps，但我认为超暗视频不是您想要的。

* * *

**更多信息;** [https://anyline.com/news/low-end-android-devices-exposure-triangle/](https://anyline.com/news/low-end-android-devices-exposure-triangle/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-26T18:48:19.707

这里有一个简单的解释。较低的光线意味着视频中有更多的噪点。随着噪音的增加，编码引擎必须付出更多的努力才能获得所需的压缩。除非编码器有降噪器，否则编码引擎要处理的噪声要比正常情况多得多。

如果你想要一个更技术性的答案：更多的噪音意味着编码器的运动估计引擎被扔掉了。这是消耗最大 CPU 周期的部分。噪音越大，压缩越差，因此甚至编码器的其他部分基本上都在嘎吱作响。生成的位更多，这意味着编码和熵引擎也处理得更多，因此性能更差。

通常在高端相机中，传感器中的成像管道会去除大量噪声。但是不要指望在手机传感器中会出现这种情况。[这是您在 DSLR 中看到的 ISO 性能]。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-18T17:16:32.003

我在使用 Android 4.2 Galaxy S III 时遇到了这个问题。在对参数进行试验后，发现一个开始工作的调用。

查看 Camera.Parameters，如果将它们打印出来，您会看到：

```
preview-fps-range=15000,30000;
preview-fps-range-values=(8000,8000),(10000,10000),(15000,15000),(15000,30000),(30000,30000); 
```

允许fps “`range`放慢速度”。

该调用`setPreviewFpsRange(30000, 30000);`强制 fps 保持在 30 左右。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-03T12:39:05.167

这是正确的，您应该调用`setPreviewFpsRange()`以获得恒定的fps。由于 CCD，您看到的帧速率正在下降，当光线不足时，fps 会下降，因此它可以产生更好的图像（在静止模式下）。

此外，为了获得更高的帧速率，您应该使用：

```
Camera.Parameters parameters=camera.getParameters();
parameters.setFocusMode(Camera.Parameters.FOCUS_MODE_CONTINUOUS_VIDEO);
parameters.setRecordingHint(true); 
```

camera.setParameters(参数);

# javascript - 这些javascript对象有什么区别，以及如何循环

> ID：12099850
> 
> 赞同：1
> 
> 时间：2012-08-23T20:55:24.483
> 
> 标签：javascript, jquery

我有这个工作：

```
 cars={
        ford:{
            ford_car_one:'Ford Car One',
            ford_car_two:'Ford Car Two'
        },
        toyota:{
            toyota_car_one:'Toyota Car One',
            toyota_car_two:'Toyota Car Two'
        }
    };

    $('#cars_company').on('change', function(){
        $('#cars').html('');
        $.each(cars[$(this).val()], function(k, v){
            $('<option></option>').val(k).text(v)
            .appendTo($('#cars'));
        });
    }); 
```

`$.each(cars[$.....`现在，如果我的 javascript 对象如下所示，我将如何执行代码块：

```
cars = [
  { name : 'ford', types: { name : 'ford car one', name : 'ford car 2'},
  { name : 'toyota', types: { name : 'toyota car one', name : 'toyota car 2'},
]; 
```

**两个汽车对象有什么区别？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:26:28.977

## 问题 1

> 两个汽车对象有什么区别？

如果我没记错的话，这两个对象之间的区别在于，第一个对象是一个对象，其中包含其他对象作为属性，而第二个对象（暂时忽略无效语法）是一个包含 2 个元素的数组，每个元素包含 2 个属性.

**对象 1**

```
cars={
    ford:{
        ford_car_one:'Ford Car One',
        ford_car_two:'Ford Car Two'
    },
    toyota:{
        toyota_car_one:'Toyota Car One',
        toyota_car_two:'Toyota Car Two'
    }
}; 
```

这是一个名为 cars 的对象，它有 2 个属性`ford`和`toyota`. 每个属性都是另一个对象，每个对象有 2 个属性。这个对象在 chrome 的控制台输出中看起来像这样：

![在此处输入图像描述](../Images/7b409d0234ca806fcc54f457f6427862.png)

**对象 2**

```
cars = [
  { name : 'ford', types: { name : 'ford car one', name : 'ford car 2'},
  { name : 'toyota', types: { name : 'toyota car one', name : 'toyota car 2'},
]; 
```

这个实例的语法搞砸了，应该是（假设它的当前形式是有意的，但我不推荐它！）

```
var cars = [
    {
    name: 'ford',
    types: {
        name: 'ford car one',
        name: 'ford car 2'
    }},
    {
    name: 'toyota',
    types: {
        name: 'toyota car one',
        name: 'toyota car 2'
    }}]; 
```

在本例`cars`中是一个包含 2 个元素的数组。每个元素都是具有 和 属性的匿名`name`对象`types`。`types`有 2 个同名的属性，即`name`，这意味着最后指定`name`的将覆盖第一个`name`。导致：

![在此处输入图像描述](../Images/a8b23680d4444fb11b21aa2d64233d93.png)

正如您仅在上面的结果中看到的那样`ford car 2`，`toyota car 2`它们保留在内部`name`属性中。

### [演示](http://jsfiddle.net/SzZqR/)- 显示两个`current`对象的输出。

## 问题2

> 现在，如果我的 javascript 对象看起来像上面的对象 2，我将如何执行 $.each(cars[$..... 代码块。

首先，您必须修复语法错误，然后很可能重新考虑如何填充对象，看到 name 属性会被下一个属性覆盖。

假设您的对象现在有效：

```
var cars = [
    {
    name: 'ford',
    types: [
        'ford car one',
        'ford car 2'
        ]},
    {
    name: 'toyota',
    types: [
        'toyota car one',
        'toyota car 2'
    ]}]; 
```

导致：

![在此处输入图像描述](../Images/fa58f1e7040abd65633c8420ad448153.png)

您现在可以执行以下操作：

```
$(cars).each(function(){
    // only declared for clarity, not needed, using this is fine.
    var car = this;

    $result.append("- " + car.name + "<br />");

    $(this.types).each(function(){
        // only declared for clarity, not needed, using this is fine.
        var type = this;

        $result.append("-- " + type + "<br />");
    });

    $result.append("<br />");
}); 
```

### [演示](http://jsfiddle.net/Cd5BS/)`.each()`-使用`suggested`对象迭代汽车和类型

关于性能的旁注。虽然`.each()`很好，但您会发现使用嵌套标准`for(i=0; i < cars.length; i++)`等会执行得更快。但是`.each()`非常好并且运行速度足够快，差异很小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T21:15:25.817

您定义的以下结构无效，

**汽车对象（来自您的代码）：**

```
cars={
    ford:{
        ford_car_one:'Ford Car One',
        ford_car_two:'Ford Car Two'
    },
    toyota:{
        toyota_car_one:'Toyota Car One',
        toyota_car_two:'Toyota Car Two'
    }
}; 
```

**汽车对象：（无效语法）**

```
cars = [
  //                         v--- duplicate keys ---v       missing }--v  
  { name : 'ford', types: { name : 'ford car one', name : 'ford car 2'} ,
  { name : 'toyota', types: { name : 'toyota car one', name : 'toyota car 2'} ,
]; 
```

**两个汽车对象之间的差异**

1.  第二个结构在语法上是错误的。

    一种。中的重复键`types`。（键名在类型对象内重复）

    湾。失踪`}`

2.  您缺少`ford_car_one`第二个结构中的信息（来自第一个结构：）`ford_car_one:'Ford Car One'`此键用作脚本中设置的值。( `$('<option></option>').val(k)`)

**如果您打算更改，请尝试以下建议的更简单的结构：**

```
cars = {
  'ford': ['ford car one', 'ford car 2'],
  'toyota': ['toyota car one', 'toyota car 2'],
}; 
```

假设上述建议的结构，您需要更改方法如下，

```
$('#cars_company').on('change', function(){
   $('#cars').html('');
   var selVal = $(this).val();

   $.each(cars[selVal ], function(idx, val){
      $('<option></option>')
        .val(idx) //Change val as you want ex: selVal + '_car_' + idx => ford_car_1
        .text(val)
        .appendTo($('#cars'));
   });
}); 
```

对原始脚本的更改...

原始函数中的选项值使用对象中的键（例如：ford_car_one:'Ford Car One'），但您的结构没有信息，因此您需要构建信息。请参阅上面代码中的注释。

```
.val(idx) //Change val as you want ex: selVal + '_car_' + idx => ford_car_1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:03:07.730

```
jQuery.each(cars,function(key,val){
        jQuery.each(val,function(ke2,va2)
           {console.log(va2);
        });
}); 
```

这就是如何循环它们都返回。

你的对象没有正确形成它应该像..

```
var cars = [
    {
        "name": "ford",
        "types": {
            "name": "fordcar2"
        }
    },
    {
        "name": "toyota",
        "types": {
            "name": "toyotacar2"
        }
    }
]; 
```

或者

```
[
        {
            "name": "ford",
            "types": ["fordcar2","fordcar4","fordcar3"]

        },
        {
            "name": "toyota",
            "types": ["fordcar2","fordcar4","fordcar3"]
        }
    ]; 
```

我会做这样的事情，这段代码只是一个帮助你的示例，而不是为你做的工作！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T21:15:54.980

好吧，如果你想用普通的 ole javascript 方式来做，那就是：

对于第一个，

```
for(var i = 0; i < cars.length(); i++)  //loops through car companies
{
    alert(cars[i] + ":");
    for(var j = 0; i < cars[i].length(); i++)  //loops through models
    {
        alert(cars[i][j]);  //alerts the each *property* of each model, which will be the name of each model
    }
} 
```

第二，你会这样做：

```
for(var i = 0; i< cars.length(); i++)  //loops through car companies
{
    alert(cars[i].name);
    for(var j = 0; j < cars[i].types.length(); j++)  //loops through car models, but has to use the correct property to do so
    {
        alert(cars[i].types[j]);
    }
} 
```

但请注意，这将是一个非常烦人的警报数量。

# mysql - 1005 mysql 无法创建表外键 erno 150

> ID：12099856
> 
> 赞同：1
> 
> 时间：2012-08-23T20:55:45.543
> 
> 标签：mysql, magento, create-table

我正在尝试基于 Magento 数据库结构创建一个表。我在安装过程中不断收到错误，因此我正在尝试创建与该问题相关的三个表。我不断收到 OAuth 安装错误。新版本的 Magento 在 MySQL 中将进程划分为 3 个表。所以已经创建了三个表中的两个，这是第三个表的 MySQL 脚本 - 这是运行错误的表。

```
DROP TABLE IF EXISTS `oauth_token`;
/*!40101 SET @saved_cs_client = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `oauth_token` (
`entity_id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Entity ID',
`consumer_id` int(10) unsigned NOT NULL COMMENT 'Consumer ID',
`admin_id` int(10) unsigned DEFAULT NULL COMMENT 'Admin user ID',
`customer_id` int(10) unsigned DEFAULT NULL COMMENT 'Customer user ID',
`type` varchar(16) NOT NULL COMMENT 'Token Type',
`token` varchar(32) NOT NULL COMMENT 'Token',
`secret` varchar(32) NOT NULL COMMENT 'Token Secret',
`verifier` varchar(32) DEFAULT NULL COMMENT 'Token Verifier',
`callback_url` varchar(255) NOT NULL COMMENT 'Token Callback URL',
`revoked` smallint(5) unsigned NOT NULL DEFAULT '0' COMMENT 'Is Token revoked',
`authorized` smallint(5) unsigned NOT NULL DEFAULT '0' COMMENT 'Is Token authorized',
`created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Token creation         timestamp',
PRIMARY KEY (`entity_id`),
UNIQUE KEY `UNQ_OAUTH_TOKEN_TOKEN` (`token`),
KEY `IDX_OAUTH_TOKEN_CONSUMER_ID` (`consumer_id`),
KEY `FK_OAUTH_TOKEN_ADMIN_ID_ADMIN_USER_USER_ID` (`admin_id`),
KEY `FK_OAUTH_TOKEN_CUSTOMER_ID_CUSTOMER_ENTITY_ENTITY_ID` (`customer_id`),
CONSTRAINT `FK_OAUTH_TOKEN_ADMIN_ID_ADMIN_USER_USER_ID` FOREIGN KEY (`admin_id`)         REFERENCES `admin_user` (`user_id`) ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT `FK_OAUTH_TOKEN_CONSUMER_ID_OAUTH_CONSUMER_ENTITY_ID` FOREIGN KEY     (`consumer_id`) REFERENCES `oauth_consumer` (`entity_id`) ON DELETE CASCADE ON UPDATE     CASCADE,
CONSTRAINT `FK_OAUTH_TOKEN_CUSTOMER_ID_CUSTOMER_ENTITY_ENTITY_ID` FOREIGN KEY (`customer_id`) REFERENCES `customer_entity` (`entity_id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='OAuth Tokens';
/*!40101 SET character_set_client = @saved_cs_client */; 
```

那么我应该怎么做或如何更改 MySQL 脚本以使其正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:06:51.490

最常见的原因是您引用的表是 MyISAM，您不能在 FK 关系中使用它们。

也可能是您的 FK 没有唯一的名称，但考虑到您的命名约定，这看起来不太可能。

If neither of those, check the columns you are referencing and make sure they have an index on them, either primary key or unique.

Finally check your data type, it must be exactly the same between both columns in the FK relationship. even differing lengths (int(10), int(11)), or signed vs unsigned will not allow you to make an FK relationship.

# asp.net - MVC 4 没有重定向到 Android v4+ 的移动设备？

> ID：12099860
> 
> 赞同：0
> 
> 时间：2012-08-23T20:56:01.917
> 
> 标签：asp.net, .net, c#-4.0, mobile, asp.net-mvc-4

我发现某些设备没有自动重定向到 .Mobile.cshtml 对应项。有没有办法通过 HttpContext.GetOverriddenBrowser 方法解决这个问题或根据屏幕分辨率强制移动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T18:07:15.120

你可以尝试添加一小段 Javascript 来创建一个带有 Javascript 的 cookie

```
 window.screen.availHeight
 window.screen.availWidth 
```

然后在服务器端检查 _PageStart.cshtml 中的 cookie（在返回每个页面之前运行），如果它满足您的要求，请使用

```
HttpContext.SetOverriddenBrowser(BrowserOverride.Mobile) 
```

# objective-c - 在 NSArray 中搜索对象属性的快速方法

> ID：12099867
> 
> 赞同：1
> 
> 时间：2012-08-23T20:57:20.460
> 
> 标签：objective-c, algorithm

我有一个`NSArray`自定义对象，它们都有一个 @property`name`类型`NSString`。如何快速枚举数组并创建一个新数组，该数组仅包含`name`属性中具有特定单词的对象？

例如：

```
CustomObject *firstObject = [[CustomObject alloc] init];
firstObject.name = @"dog";

CustomObject *secondObject = [[CustomObject alloc] init];
secondObject.name = @"cat";

CustomObject *thirdObject = [[CustomObject alloc] init];
thirdObject.name = @"dogs are fun";

NSMutableArray *testArray = [NSMutableArray arrayWithObjects:firstObject,
                                                             secondObject,
                                                             thirdObject, 
                                                             nil];

// I want to create a new array that contains all objects that have the word 
// "dog" in their name property. 
```

我知道我可以像这样使用 for 循环：

```
NSMutableArray *newArray = [NSMutableArray array];
for (CustomObject *obj in testArray)
{
    if ([obj.name rangeOfString:@"dog"].location == NSNotFound) {
        //string wasn't found
    }

    else {
        [newArray addObject:obj];
    }
} 
```

但是有没有更有效的方法？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T21:01:56.107

```
NSString *searchString = @"dog";
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SELF.name contains %@", searchString];
NSArray *filteredArray = [testArray filteredArrayUsingPredicate:predicate]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:59:59.193

请看一下`NSPredicates`！当您搜索/过滤数组结果时，它们非常高效。这是[文档！](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/Articles/pUsing.html)

# css-position - 网站的主要部分是在固定导航栏上吗？

> ID：12099871
> 
> 赞同：0
> 
> 时间：2012-08-23T20:57:54.313
> 
> 标签：css-position, navbar

我的网站顶部有一个导航栏，它的位置是固定的。但是，每当您在页面上向下滚动时，所有内容都会在导航栏上方而不是在导航栏下方......我该如何解决这个问题？我认为显示我的代码无济于事，因为如果您知道如何修复它，您可能只需解释一下，但如果您想查看我的代码，请询问。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:34:06.287

我认为您应该发布一些代码或网址。`z-index: -1`如果页面的主要部分是导航栏的同级元素，这可以像设置一样简单。由于[z-index](http://www.w3schools.com/cssref/pr_pos_z-index.asp)计算依赖于 DOM 的父子关系，因此了解元素的关系对于回答问题是必要的。

# vba - VBA 单元格突出显示

> ID：12099878
> 
> 赞同：1
> 
> 时间：2012-08-23T20:58:16.043
> 
> 标签：vba, excel

我需要突出显示单元格：如果已经突出显示，则在另一个单元格中找到数字并突出显示

这是我非常基本的代码。

它有效，但我发现如果我有相同数量的复数，它仍然只会突出显示第一个找到的。我需要它能够告诉它已经突出显示并移动到下一个并突出显示那个。

```
Sub Find_FirstmanUALDar()
    Dim FindString8 As String
    Dim Rng8 As Range
    FindString8 = Sheets("DAR").Range("D12").Value
    If Trim(FindString1) <> "" Then
        With Sheets("GL").Range("AC:AC")
            Set Rng8 = .Find(What:=FindString8, _
                        After:=.Cells(.Cells.Count), _
                        LookIn:=xlValues, _
                        LookAt:=xlWhole, _
                        SearchOrder:=xlByRows, _
                        SearchDirection:=xlNext, _
                        MatchCase:=False)
             If Not Rng8 Is Nothing Then
                 Application.Goto Rng8, True
                 With Selection.Interior
                     .Pattern = xlSolid
                     .PatternColorIndex = xlAutomatic
                     .Color = 65535
                     .TintAndShade = 0
                     .PatternTintAndShade = 0
                 End With
             End If
        End With 
```

我知道它很丑，但请帮忙。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T21:54:09.760

```
Sub Tester()
    Dim rng As Range

    Set rng = FindAll(Sheets("GL").Range("AC:AC"), "test")

    If Not rng Is Nothing Then
        rng.Interior.Color = 65535
    End If

End Sub

Public Function FindAll(rng As Range, val As String) As Range
    Dim rv As Range, f As Range
    Dim addr As String

    Set f = rng.Find(what:=val, after:=rng.Cells(rng.Cells.Count), _
        LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, _
        SearchDirection:=xlNext, MatchCase:=False)
    If Not f Is Nothing Then addr = f.Address()

    Do Until f Is Nothing
        If rv Is Nothing Then
            Set rv = f
        Else
            Set rv = Application.Union(rv, f)
        End If
        Set f = rng.FindNext(after:=f)
        If f.Address() = addr Then Exit Do
    Loop

    Set FindAll = rv
End Function 
```

# perl - 如何调试由 Module::Starter 制作的模块？

> ID：12099879
> 
> 赞同：5
> 
> 时间：2012-08-23T20:58:18.290
> 
> 标签：perl, testing

我正在练习使用 Module::Starter 制作一个新模块。我已经为一个包编写了一些测试用例，它们有时运行良好。

但是我注意到有两个问题：

*   当测试用例失败时，我想在被测试的函数中放入一些打印语句。我跑了`make test`，它只告诉我我的测试用例失败了，它没有显示我的打印输出，尽管我真的很确定打印语句已经到达。

*   假设我有三个测试用例来测试一个函数，我在函数内部放了一条打印语句，当测试用例运行时，它报告三个测试用例中只有一个运行了。如果我删除打印语句，所有三个测试用例都会运行。这是为什么？

这是我的代码：

```
# package declaration and stuff...
sub get_in {
  my ( $hash, @path ) = @_;
  my $ref = $hash;
  print 'lol'; # This is the troublesome print statement. Remove this statement and all three test cases will run and pass
  foreach (@path) {
    if ( ref($ref) eq 'HASH' && exists $ref->{$_} ) {
      $ref = $ref->{$_};
    } else {
      return undef;
    }
  }
  return $ref;
} 
```

这是测试用例：

```
use Test::More tests => 3;
use strict;
use warnings;
use diagnostics;
require_ok('Foo::Doc');
ok( Foo::Doc::get_in( { 'a' => { 'b' => { 'c' => 101 } } }, 'a', 'b', 'c' ) == 101 );
ok( @{ Foo::Doc::get_in( { 'a' => { 'b' => { 'c' => [ 1, 2, 3 ] } } }, 'a', 'b', 'c' ) } == @{ [ 1, 2, 3 ] } ); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T21:10:43.207

您的测试以及您的问题本身都有一些问题需要解决。首先你的问题：

如果您希望输出显示在测试中，则需要显式打印到标准错误。作为最佳实践，您还需要以`#`. [Test::More](https://metacpan.org/module/Test%3a%3aMore)模块提供了可以用来轻松完成此任务的工具。

```
my $got = Foo::Doc::get_in( { 'a' => { 'b' => { 'c' => 101 } } }, 'a', 'b', 'c' );
ok($got == 101); # you probably want is() instead, see below
diag("GOT $got"); # outputs "# GOT 101" or whatever to STDERR 
```

如果您不想每次都打印该输出，但仅在请求详细日志记录时，您可以使用`note`：

```
note("GOT $got"); 
```

`prove -v`这在您用于运行测试时很有用：

```
prove -l -v t/test.t 
```

还有一个`explain`函数可以输出复杂的输出以供查看：

```
diag explain $got;
# OR
note explain $got; 
```

至于你的其他问题。通常最好`is()`用于`ok()`：

```
is($got, 101); # gives slightly more readable output on error 
```

此外，在测试复杂的数据结构时，您需要使用它`is_deeply()`来进行完整的比较：

```
is_deeply($got, [1, 2, 3]); 
```

你绝对应该看一下[Test::More](https://metacpan.org/module/Test%3a%3aMore)的文档，因为那里有很多有用的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T21:59:14.570

为了解决您的第二个问题，您需要小心地在测试脚本中写入标准输出。`Test::More`扫描标准输出，寻找像`ok 5`和一样的测试输出`not ok 6 - disgronificator enabled`。当您写入`"lol"`标准输出但不附加换行符时，测试模块将设置`"lolok 9 - it works"`并且不会将其识别为测试结果。（为了更有趣，`print "not ";`在所有测试之前放置语句）。

更好的做法就像 zostay 说的那样，写入标准错误，使用`diag`和提供的其他输出功能`Test::More`。

# http - 是什么导致我的 HTTP 服务器因“退出状态 -1073741819”而失败？

> ID：12099880
> 
> 赞同：0
> 
> 时间：2012-08-23T20:58:30.490
> 
> 标签：http, windows-7, go, windows-7-x64

作为练习，我创建了一个小型 HTTP 服务器，它生成随机游戏机制，类似于[这个](http://inventwithpython.com/randommechanic.html)。我是在 Windows 7（32 位）系统上编写的，它运行良好。但是，当我在家用计算机 Windows 7（64 位）上运行它时，它总是失败并显示相同的消息： `exit status -1073741819`. 我还没有设法在网上找到任何引用该状态代码的东西，所以我不知道它有多重要。

这是服务器的代码，省略了冗余：

```
package main

import (
    "fmt"
    "math/rand"
    "time"
    "net/http"
    "html/template"
)

// Info about a game mechanic
type MechanicInfo struct { Name, Desc string }

// Print a mechanic as a string
func (m MechanicInfo) String() string {
    return fmt.Sprintf("%s: %s", m.Name, m.Desc)
}

// A possible game mechanic
var (
    UnkillableObjects = &MechanicInfo{"Avoiding Unkillable Objects",
                                      "There are objects that the player cannot touch. These are different from normal enemies because they cannot be destroyed or moved."}
    //...
    Race              = &MechanicInfo{"Race",
                                      "The player must reach a place before the opponent does. Like \"Timed\" except the enemy as a \"timer\" can be slowed down by the player's actions, or there may be multiple enemies being raced against."}
)

// Slice containing all game mechanics
var GameMechanics []*MechanicInfo

// Pseudorandom number generator
var prng *rand.Rand

// Get a random mechanic
func RandMechanic() *MechanicInfo {
    i := prng.Intn(len(GameMechanics))
    return GameMechanics[i]
}

// Initialize the package
func init() {
    prng = rand.New(rand.NewSource(time.Now().Unix()))

    GameMechanics = make([]*MechanicInfo, 34)
    GameMechanics[0] = UnkillableObjects
    //...
    GameMechanics[33] = Race
}

// serving

var index = template.Must(template.ParseFiles(
    "templates/_base.html",
    "templates/index.html",
))

func randMechHandler(w http.ResponseWriter, req *http.Request) {
    mechanics := [3]*MechanicInfo{RandMechanic(), RandMechanic(), RandMechanic()}
    if err := index.Execute(w, mechanics); err != nil {
        http.Error(w, err.Error(), http.StatusInternalServerError)
    }
}

func main() {
    http.HandleFunc("/", randMechHandler)
    if err := http.ListenAndServe(":80", nil); err != nil {
        panic(err)
    }
} 
```

此外，[未删节的代码](http://pastebin.com/naxzbxPc)、[_base.html 模板](http://pastebin.com/c069YJjp)和[index.html 模板](http://pastebin.com/d87Hd0WZ)。

什么可能导致此问题？是否有调试这样的神秘退出状态的过程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:36:23.523

当我运行它时，我收到以下两个错误：

```
template: content:6: nil pointer evaluating *main.MechanicInfo.Name
http: multiple response.WriteHeader calls 
```

前者在网络浏览器中，后者在我启动服务器的控制台窗口中。

nil 指针问题是因为您的删节程序将 GameMechanics[1:32] 设置为 nil。

第二个错误很有趣。在您的程序中，您的 http.ResponseWriter 上的任何方法都被调用的唯一位置是 index.Execute 内部，这不是您的代码——这意味着可能在 html/template 中发生了错误。我正在使用 Go 1.0.2 对此进行测试。

我将 _base.html 放在 index.html 的顶部，然后将 index 更改为：

```
var index = template.Must(template.ParseFiles("templates/index.html")) 
```

并且 http.WriteHeaders 警告消失了。

不是真正的答案，而是您可以探索的方向。

作为奖励，这是编写程序的更多“Go方式”。请注意，我简化了 PRNG 的使用（您不需要实例化，除非您想要几个并行）并简化了结构初始化程序：

```
package main

import (
    "fmt"
    "html/template"
    "math/rand"
    "net/http"
)

// Info about a game mechanic
type MechanicInfo struct{ Name, Desc string }

// Print a mechanic as a string
func (m MechanicInfo) String() string {
    return fmt.Sprintf("%s: %s", m.Name, m.Desc)
}

// The game mechanics
var GameMechanics = [...]*MechanicInfo{
    {"Avoiding Unkillable Objects",
        "There are objects that the player cannot touch. These are different from normal enemies because they cannot be destroyed or moved."},
    {"Race",
        "The player must reach a place before the opponent does. Like \"Timed\" except the enemy as a \"timer\" can be slowed down by the player's actions, or there may be multiple enemies being raced against."},
}

// Get a random mechanic
func RandMechanic() *MechanicInfo {
    i := rand.Intn(len(GameMechanics))
    return GameMechanics[i]
}

var index = template.Must(template.ParseFiles("templates/index.html"))

func randMechHandler(w http.ResponseWriter, req *http.Request) {
    mechanics := [3]*MechanicInfo{RandMechanic(), RandMechanic(), RandMechanic()}
    if err := index.Execute(w, mechanics); err != nil {
        http.Error(w, err.Error(), http.StatusInternalServerError)
    }
}

func main() {
    http.HandleFunc("/", randMechHandler)
    if err := http.ListenAndServe(":80", nil); err != nil {
        panic(err)
    }
} 
```

# visual-studio-2010 - Visual Studio 2010 - 自动 git 提交，保存文件时推送

> ID：12099883
> 
> 赞同：1
> 
> 时间：2012-08-23T20:58:38.493
> 
> 标签：visual-studio-2010, git

有没有办法让 Visual Studio 2010 在保存文件时自动提交文件并将其推送到 git 存储库？

我希望能够出现一个弹出框，以允许我在保存时编写提交消息。我觉得这会迫使我养成一些好习惯，因为遗憾的是我有时会错过一天或十次提交，而且我是唯一的开发人员，这不是这里的工作要求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:07:44.860

从配置管理器的角度来看，我完全不同意您的“始终提交”政策。

Insted，我不知道您是否尝试过[Visual Local History 2005](http://vlh2005.codeplex.com/)。我在 2005 和 2008 版本中使用过它，但我从未尝试过使用 2010 版本。它只是创建一个子目录并在每次保存时保存一个本地副本。因此，您可以查看每个文件的历史记录。

**那么**你可以在正确的时候提交（当它真的有意义的时候）。

让我知道它是否可以正常工作。

# bash - 将 nohup 的输出错误发送到 syslog

> ID：12099885
> 
> 赞同：3
> 
> 时间：2012-08-23T20:58:55.433
> 
> 标签：bash, nohup, rsyslog

我正在尝试编写一个使用 nohup 并将错误传递给 rsyslog 的 bash 脚本。

我已经尝试过使用 log 变量的不同变体（见下文）的这个命令，但除了 std txt 文件之外，无法将输出传递给任何东西。我不能让它管。

```
nohup imageprocessor.sh > "$LOG" & 
```

是否可以管道 nohup 输出或者我需要不同的命令。

我尝试过的几种日志变体

```
LOG="|/usr/bin/logger -t workspaceworker -p LOCAL5.info &2" 
```

或者

```
LOG="|logtosyslog.sh" 
```

或者

```
LOG="logtosyslog.sh" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T21:16:43.943

`bash`将输出重定向到 syslog 的一种方法是：

```
exec > >(logger -t myscript) 
```

`stdout`然后被发送到`logger`命令

```
exec 2> >(logger -t myscript) 
```

为了`stderr`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:47:20.440

不是直接的。nohup 将分离子进程，因此管道 nohup 命令的输出没有帮助。这就是你想要的：

```
nohup sh -c 'imageprocessor.sh | logger' 
```

# asp-classic - 如何在没有 Visual Studio（或任何其他 3rd 方工具）的情况下进行经典 ASP 调试？

> ID：12099886
> 
> 赞同：3
> 
> 时间：2012-08-23T20:59:01.837
> 
> 标签：asp-classic, vbscript, iis-6

我支持在 Windows Server 2003 上使用带有 IIS 6.0 的经典 ASP 编写的应用程序。我没有特权在这个纯粹的开发使用服务器上添加或配置任何软件，因此我无法安装任何第 3 方工具。我已经请求并请求了 Visual Studio，但系统管理员是老派，并说我们不需要它来进行经典的 ASP 开发。所以......我们被记事本和 IE 7 困住了。

系统管理员说在 IIS 中打开了客户端和服务器端调试，并且 IIS 在更改后重新启动。但是，当我插入停止语句或 1/0 表达式时，我无法从脚本调试器中得到任何响应。（我确实在页面上收到了适当的错误消息 - 只是没有调试器。）

我在 Internet 选项/高级中清除了两个复选框，因此允许 IE 和其他调试。

我还需要什么？我错过了什么？也许没有安装脚本调试器？我怎么知道？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:35:42.467

您将不得不修改脚本以将您自己的调试信息输出到浏览器。

您无法使用此技术停止服务器端代码，但您可以将任何数据的值吐出到您认为与解决问题相关的变量中。如果您担心用户看到调试代码，您可以将输出包装在 HTML 注释中`<!-- ... -->`并查看页面资源。

# php - 使用页面 URL 向管理员发送电子邮件的 OnClick 事件

> ID：12099887
> 
> 赞同：0
> 
> 时间：2012-08-23T20:59:03.523
> 
> 标签：php, ajax, email

我是这个网站的新手，期待着一次美妙的体验。

我有一个分类广告网站，我需要一个新功能来将广告报告为“垃圾邮件”。这些基本上是带有可疑/非法内容的广告。我想在广告页面上放置一个按钮，它简单地说：报告为垃圾邮件。每当任何用户单击该按钮时，都会向站点管理员发送一封包含页面 URL 的电子邮件。而已。如何在 PHP 中实现它？此外，我想确保页面不会重新加载，因此首选 Ajax 解决方案。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:58:49.633

您可以使用 jQuery、YUI 或 ExtJS 等 JavaScript 框架将 AJAX 请求发送到向您发送电子邮件的 php 页面

您的代码将是这样的：

**Javascript**

```
function reportAbuse() {
       var page = '<?php echo base64_encode($_SERVER['REQUEST_URI']);?>';
       //jQuery like $('#hiddenDiv').load('report.php?page=' + page);
    } 
```

**PHP**

```
<?php
$page = base64_decode($_GET['page']);
//use PHP mail() function to mail the page to your e-mail
?> 
```

上面的例子没有保存你应该阻止用户访问report.php太多（或者你收到垃圾邮件）如果你读到jQuery我建议通过$_POST而不是$_GET发送信息。但这应该让你开始。

# process - 是否可以使用来自不同进程的 cudaHostAllocPortable 标志访问由 cudaHostAlloc 分配的内存块？

> ID：12099896
> 
> 赞同：0
> 
> 时间：2012-08-23T20:59:59.510
> 
> 标签：process, cuda

CUDA 文档说可以从所有上下文访问可移植内存块，这是否意味着我们可以跨进程使用这些块？具体来说，我想将此主机指针传递给将复制到设备的不同进程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T09:16:50.257

不，它只能在同一进程中访问。使用你应该使用 cudaIpc... 或操作系统的 IPC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T03:35:26.130

可移植内存可以被许多主机线程使用，而不是进程。实际上，固定内存仅对线程 malloc 可用，如果不可移植的话。

您应该使用 IPC 在进程之间共享内存。

# java - 使用 SLF4J LevelChangePropagator 将 JUL 的日志重定向到 logback 失败

> ID：12099901
> 
> 赞同：2
> 
> 时间：2012-08-23T21:00:42.343
> 
> 标签：java, logging, slf4j, logback

我正在将所有用于 JUL 的日志重定向到使用`jul-to-slf4j`. 但是，如果我使用该方法，它会起作用， 但是当我通过在配置文件（ & ）中添加以下行来`SLF4JBridgeHandler`使用更高性能的方法时，我看不到日志被写入：`LevelChangePropagator``logback.xml``logback-test.xml`

```
<configuration debug="true">
      <contextListener class="ch.qos.logback.classic.jul.LevelChangePropagator"/>
      .......
</configuration> 
```

没有日志被写入。

## 编辑：

这是我的完整配置文件的样子：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration debug="true">
  <contextListener class="ch.qos.logback.classic.jul.LevelChangePropagator"/>

    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} -> %msg%n</pattern>
        </encoder>
    </appender>

    <appender name="FILE" class="ch.qos.logback.core.FileAppender">
        <file>c:/dev/logs_test/log_01.log</file>
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} -> %msg%n</pattern>
        </encoder>
    </appender>

    <logger name="px10" level="TRACE"/>

    <root level="debug">
        <appender-ref ref="STDOUT" />
        <appender-ref ref="FILE" />
    </root>   
</configuration> 
```

* * *

在 Glassfish 3.1.1 上尝试使用 JSF(Myfaces 2.1.8) 应用程序

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T21:06:32.077

您是否尝试在 logback.xml 配置中设置 JSF (MyFaces) 记录器的级别？

```
<configuration debug="false">
  <contextListener class="ch.qos.logback.classic.jul.LevelChangePropagator"/>

  <logger name="org.apache.myfaces" level="DEBUG"/>    
</configuration> 
```

LevelChangePropagator 不会做任何事情，除非有级别更改要传播。登录应用程序的其他部分按预期工作的事实仅意味着这些部分已为 logback 正确配置，但不一定是 jul 对于您希望通过 LevelChangePropagator 传播 logback 配置来配置 jul 的 MyFaces。

# java - 这是一个好的 IF 块吗？

> ID：12099904
> 
> 赞同：3
> 
> 时间：2012-08-23T21:00:48.463
> 
> 标签：java, conditional-statements

这些比较是否总是可以避免创建 NullPointer Exception ？

```
if( myObject == null || myObject.someMethod() == someValue )
{
    if( myObject == null && myObject.getAlwaysTrue() )
       {

       }
} 
```

除了短路之外，Java 中是否有一些条件评估的方向优先级？

**更新：**我知道`myObject.anything()`会抛出一个 NullPointer。只是我遇到了其他程序员这样的代码，我想知道是否有一种安全的方法可以在单个条件下压缩多个检查以及空检查。我正在寻找一个可以坚持的好规则。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T21:03:11.427

不，这条线不安全：

```
if( myObject == null && myObject.getAlwaysTrue() ) 
```

如果你知道那`myObject`是 null 那么你不应该尝试取消引用它。但是，如果您这样写：

```
if( myObject != null && myObject.getAlwaysTrue() ) 
```

那么就安全了。这是因为`&&`（并且`||`就此而言）具有[短路评估](http://en.wikipedia.org/wiki/Short-circuit_evaluation)。如果您编写`a && b`并且表达式的`a`计算结果为 false，则表达式`b`不会被计算，因此它不会引发异常。总是首先计算左操作数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T21:06:09.680

为什么不把门控问题分开呢？

```
if (myObject != null) {
    if ((myObject.someMethod() == someValue) && myObject.getAlwaysTrue()) {

    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T21:03:26.493

```
if( myObject == null && myObject.getAlwaysTrue() ) 
```

`NullPointerException`这会导致`myObject`你`null`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T21:07:11.700

如果`myObject`是`null`，则`myObject.getAlwaysTrue()`在第二`if`条语句中将始终导致`NullPointerException`.

在表达式的情况下，`||`计算`if`布尔表达式，直到找到第一个`true`.

使用表达式计算布尔表达式`&&`，`if`直到找到第一个`false`.

因此，在您的情况下 when `myObject`is `null`，您将获得以下评估：

首先`if`：

```
myObject == null -> true 
```

第二`if`：

```
myObject == null -> true
myObject.getAlwaysTrue() -> NullPointerException 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T21:18:54.973

尽我所能，我努力减少缩进和复杂的“ifology”。在你的情况下，我会写

```
if (myObject == null) return;
... go on knowing that myObject is not null... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T21:02:37.603

这不是 ：

```
if( myObject == null && myObject.getAlwaysTrue() ) 
```

`&&`将检查这两个条件，`myObject.getAlwaysTrue()`如果 myObject 为空，将抛出 NullPointerException。

# asp.net - .net 4.5 和服务器 2007

> ID：12099910
> 
> 赞同：1
> 
> 时间：2012-08-23T21:01:40.657
> 
> 标签：asp.net

是否可以在服务器上运行此框架。我知道人们已经从我在博客中看到的内容中做到了这一点，但微软的网站声明了 2008 年的服务器。据我了解，这只是框架的一个小更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:32:24.873

4.5 版本的框架使用 4.0 运行时，就像 3.0 和 3.5 版本使用 2.0 运行时一样。

这意味着对于 IIS 应用程序池，您不会看到 4.5 版本选项 - 选择 4.0

# xcode - WebView 的 COMBINE_HIDPI_IMAGES 和 Retina 图形

> ID：12099912
> 
> 赞同：5
> 
> 时间：2012-08-23T21:01:45.697
> 
> 标签：xcode, macos, retina-display, appkit

我们有一个 Xcode 项目，其中包括用于基于 NIB 的 UI 和 WebView UI 的 Retina 图形。这个项目为 Mac 构建了一个应用程序。

该项目使用两个单独的构建阶段将这些图形移动到最终应用程序中。第一个是传统的 Copy Bundle Resource，它将 1x 和 2x 图形都放入应用程序包中。第二个是复制文件构建阶段，它将 Web 图形复制到具有“图形”子路径的单独资源目标中。

（这避免了一些命名冲突，并让网页设计师使用熟悉的“graphics/whatever.png”路径。）

在构建这个项目时，我们得到一个依赖分析错误，上面写着：

> 复制文件构建阶段无法处理多表示图像“whatever@2x.png” - 尝试复制资源构建阶段，或禁用 COMBINE_HIDPI_IMAGES。

关闭名为“Combine High Resolution Artwork”的部署构建设置很容易，但这会影响基于 NIB 的 UI 以及 WebView UI 中使用的图形。打开该选项，`button.png`并`button@2x.png`合并到`button.tiff`应用程序包的 Resource 文件夹中。没有它，将使用原始名称。

据我所知，应用程序运行正常，但由于默认情况下设置了 COMBINE_HIDPI_IMAGES，我怀疑将图形部署为单个文件有一些好处（可能更快地加载和缓存。）

理想情况下，我只想在 Copy Files 构建阶段禁用 COMBINE_HIDPI_IMAGES。我想不出办法做到这一点，希望这里的其他人可以......

**2012 年 8 月 27 日更新**

对于这个特定的应用程序，解决问题的最简单方法是将所有 HTML 图像替换为 2x 版本。由于标签指定了宽度和高度，因此图像在非 Retina 设备上缩小了 50%。质量很好，因为它们是从本地文件系统加载的，所以对性能没有明显的影响。

**2012 年 8 月 28 日更新**

我们采用的另一种方法是使用命名约定。一些 HTML 图像是使用 CSS 指定的（通过媒体查询选择 Retina 或非 Retina 版本。）为了避免将这些图像组合成单个 HiDPI 图像时出现问题，我们使用了whatever.png 和whatever_retina.png。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:47:39.963

我能想到的唯一方法是有点破解，但没有其他人回答，因为它应该适合你。

我建议您在目标 (target.xcconfig) 上使用 xcconfig 文件来指定要更改的设置，然后在将当前 xcconfig 替换为两个版本之一的阶段之前/之后构建脚本 (target-on.xcconfig, target -off.xcconfig）。这应该可以，但是 Xcode 可能要等到以后才更新 xcconfig 文件（我现在无法检查），你必须检查一下。

我会留给你来弄清楚细节。有关此方法（一种不那么骇人听闻的变体）以及如何设置它的更多详细信息，可以在我的[博客](http://therealbnut.wordpress.com/2012/01/01/setting-xcode-4-0-environment-variables-from-a-script/ "从脚本设置 XCode 4.0 环境变量")中找到。

# visual-studio-2010 - 如何解决 Visual Studio 2010 中的“Validation (): Element 'x' is not supported”警告

> ID：12099916
> 
> 赞同：4
> 
> 时间：2012-08-23T21:02:04.993
> 
> 标签：visual-studio-2010

我一直收到所有这些“验证（）：不支持元素'x'”警告，我似乎无法找到摆脱它们的方法。这里有两个例子：

*   验证（XHTML 1.0 过渡）：属性“名称”不是元素“ul”的有效属性。
*   验证 (CSS 2.1)：'border-radius' 不是已知的 CSS 属性名称。

我在网上搜索过，所有解决方案都指向删除以下文件夹：

```
C:\Users\{username}\AppData\Roaming \Microsoft\VisualStudio\10.0\ReflectedSchemas 
```

这似乎解决了 90% 的人的问题，但是我的电脑上没有那个文件夹！

我正在使用 Visual Studio 10 SP1，这个项目是一个使用 Razor 和 HTML5 的 MVC 3 项目。

那么其他人可以提出其他可能导致问题的原因吗？

非常感谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-10-31T15:07:40.420

我遇到了同样的问题，每个页面中的所有经典 html 元素（div、a、p、table..）都有绿色下划线。Intellisense 没有对这些元素提供任何帮助，就好像它们不存在一样。但是所有的asp控件都很好并且有效。

![绿色下划线](../Images/de8a726acb2e9b16aabe48237673fa1b.png)

错误出现在我的母版页`xmlns="https://www.w3.org/1999/xhtml"`的`html`标签中。Html 5 似乎与`xmlns`声明不能很好地协同工作，所以我删除了它，瞧——一切又神奇地起作用了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:07:44.080

这些是有效的警告，而不是错误或其他类型的“问题”。的有效属性列表在[W3C 标准](http://www.w3.org/TR/html401/struct/lists.html#h-10.2)`<ul>`中给出，但不包括. 同时，它是在 CSS 3 中引入的，这意味着如果您针对 CSS 2.1 进行验证，它将无法正常工作。`name``border-radius`

您可以忽略它们或弄清楚如何在 VS2010 中抑制这些特定警告（我知道如何为 VC++ 执行此操作，但我之前没有使用 VS 处理 HTML；属性窗口中应该有一些部分）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-13T09:54:50.903

首先你要知道这不是错误！

解决元素警告消息的步骤。

1.  右键单击警告区域，您将看到一个上下文菜单。
2.  单击“格式化和验证...”，基本上它位于菜单的底部。
3.  转到“HTML 或 HTML（Web 表单）”部分中的“验证”。您会看到带有“显示错误”的复选框被选中，标题为“选项”。只需取消选中它。

[在此处输入图像描述](https://i.stack.imgur.com/VNp6O.png)

[在此处输入图像描述](https://i.stack.imgur.com/nacQu.png)

就是这样，你完成了......

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-04-01T12:02:22.047

你必须删除

```
xmlns="https://www.w3.org/1999/xhtml" 
```

让它保持

```
<!DocType Html> 
```

仅以上

# c# - 在 WindowsFormsHost 内用鼠标移动 WPF 窗口

> ID：12099917
> 
> 赞同：2
> 
> 时间：2012-08-23T21:02:10.457
> 
> 标签：c#, .net, wpf

我在网格中有一个 mainWindow，在这个网格中有几个 wpf UserControl。我还有三种方法可以通过鼠标控制网格内的移动。 `MouseDown`，`MouseMove`并且`MouseUp`它工作正常。

当我`WindowsFormsHost`在其中一个 UserControl 中添加一个时，它就不再起作用了。我可以移动窗口，但`WindowsFormsHost`停留在同一个地方。

我想知道当我有`WindowsFormsHost`内部时如何使用鼠标事件在网格内移动窗口。

提前致谢。

问候，费利佩。

PS。这些是我用来在网格内移动我的 UserControl 的方法。

```
public void Control_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
{
    isDragging = true;
    var draggableControl = sender as UserControl;
    clickPosition = e.GetPosition(this);
    draggableControl.CaptureMouse();
}

public void Control_MouseLeftButtonUp(object sender, MouseButtonEventArgs e)
{
    isDragging = false;
    var draggable = sender as UserControl;
    draggable.ReleaseMouseCapture();
}

public void Control_MouseMove(object sender, MouseEventArgs e)
{
    var draggableControl = sender as UserControl;

    if (isDragging && draggableControl != null)
    {
        Point currentPosition = e.GetPosition(this.Parent as UIElement);

        var transform = draggableControl.RenderTransform as TranslateTransform;
        if (transform == null)
        {
            transform = new TranslateTransform();
            draggableControl.RenderTransform = transform;
        }

        transform.X = currentPosition.X - clickPosition.X;
        transform.Y = currentPosition.Y - clickPosition.Y;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:16:45.643

也许尝试将 translateTransform 直接应用于 WindowsFormHost 或者看看如果在 mousemove 之后使用 WindowsFormHost.InvalidateVisual() 会发生什么

# ios - 在 UINavigationBar 中插入图像而不是文本

> ID：12099919
> 
> 赞同：-1
> 
> 时间：2012-08-23T21:02:19.850
> 
> 标签：ios, uibarbuttonitem

我有这段代码允许我在应用程序的 UIbar 上插入一个标题（如果我没记错的话）。

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(ApplicationDidBecomeActive:) name:UIApplicationDidBecomeActiveNotification object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(goToAlbum) name:@"GetAlbumNotif" object:nil];
self.title = @"Events List"; 
```

你能给我一个方向吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:32:08.410

```
UIImageView *imageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"yourImage"]];
self.navigationItem.titleView = imageView; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:27:16.870

UIBarButton 位于 NavigationBar 内。最简单的方法是在 Interface Builder 中将 UIBarButton 添加到 NavigationBar。之后，您可以使用以下方法更改背景：

```
[barButton setBackgroundImage:[UIImage imageNamed:@"image.png"] forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

如果您的部署目标是 iOS 5.0 或更高版本，您可以更改导航栏的外观：

```
[UINavigationBar appearance] setBackgroundImage: 
```

或者使用继承 UINavigationBar 并覆盖 drawInRect 的旧方式。如何做到这一点可以在这里找到： [如何在 iphone 导航栏上添加背景图像？](https://stackoverflow.com/questions/1692487/how-to-add-background-image-on-iphone-navigation-bar)

# asp.net - 不使用 .Net MVC 会犯错吗？

> ID：12099920
> 
> 赞同：5
> 
> 时间：2012-08-23T21:02:21.363
> 
> 标签：asp.net, asp.net-mvc, webforms

微软网络应用架构相关...

想知道我没有为我的新 Web 应用程序使用 .Net 的 MVC 是否犯了一个错误？我开始在 ASP Classic 中进行 Web 开发，并随着 ASP.net 的每次迭代而前进。在过去的几个月里，我一直在玩弄 ASP.net MVC，只是不喜欢它的某些部分。我喜欢路由、剃刀和查看特定模型的想法。但是，在添加了一些功能之后，我的应用程序似乎变得过于复杂——当我查看 nopCommerce 和 Umbraco 等应用程序的 MVC 版本与之前的版本相比时，我觉得也是如此。

我回去基本上开始编写一个 .Net 网站/MVC 混合体。我为实现数据注释验证的“视图模型”创建了自己的基类；一个简单的映射器，用于将表单提交绑定到模型并将实体属性映射到模型属性，反之亦然；为分页、检查、选择和偶数/奇数等内容创建了扩展方法和助手；`runat="server"`使用不需要视图状态的重复器、文字和标准 HTML 标记等控件。

这种方法似乎让我可以两全其美，让我的“控制器”代码接近“视图”，并且一切都在中等信任下工作。

这是一些示例代码：

```
public partial class Admin_Users_RoleAdd : System.Web.UI.Page
{
    protected class RoleAddModel : BaseModel
    {
        [Required, StringLength(100)]
        public string Name { get; set; }
        [StringLength(250)]
        public string Description { get; set; }

        public override bool Validate()
        {
            if (base.Validate() && Cortex.DB.Roles.Any(r => r.Name == Name))
                Errors["Name"] = "Already in use";
            return Errors.Count == 0;
        }
    }
    protected RoleAddModel model = new RoleAddModel();
    protected override void OnInit(EventArgs e)
    {
        if (Request.Form["Submit"].HasValue())
        {
            SimpleMapper.FormMap<RoleAddModel>(model);
            if (model.Validate())
            {
                var entity = new Role();
                SimpleMapper.Map<RoleAddModel, Role>(model, entity);
                Cortex.DB.Roles.AddObject(entity);
                Cortex.DB.SaveChanges();
                Response.Redirect("Roles.aspx");
            }
        }
        base.OnInit(e);
    }
} 
```

和“视图”：

```
<h1>Add Role</h1>

    <div id="MainForm" class="form">
        <%= model.GetErrorMessage("Error") %>
        <form action="<%= Request.RawUrl %>" method="post">
            <div class="formField">
                <label for="Name">Name</label> <%= model.GetErrorMessage("Name") %><br />
                <input type="text" name="Name" value="<%: model.Name %>" class="required" maxlength="100" />                
            </div>
            <div class="formField">
                <label for="Description">Description</label> <%= model.GetErrorMessage("Description") %><br />
                <textarea rows="8" cols="40" name="Description" maxlength="250"><%: model.Description %></textarea>             
            </div>
            <div class="buttons">
                <input type="submit" name="Submit" value="Create" class="primary" />
                <a href="Roles.aspx">Back</a>
            </div>
        </form>
    </div> 
```

以后我会对这种方法感到遗憾吗？目前我能想到的主要是测试能力，但 VWD Express 无论如何都不支持它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:49:42.163

我不喜欢微软在 MVC 上的实现；魔术字符串的使用，说动作然后说控制器似乎有点落后，这就像必须学习一打新语言，因为它充满了微解决方案（路由，剃刀）。

我非常不喜欢它，所以我开始自己写，但我写得越多，我就越意识到它不灵活，我越修复它，它看起来就越像微软的实现。

经过几个小时和几个小时的开发，基本上是一个垃圾版本的 MVC，我放弃了它。我已经开始回顾设计文档和代码并重写（或在）它们的顶部

**少写代码**

我在大约八小时内将我糟糕的 MVC 应用程序的 UI 层重写为 MS MVC。在那之前，我已经为此工作了大约八周。当然，大部分想法已经完成，因此从头开始编写 MVC 可能不会那么快。

我使用的几乎所有东西都是开箱即用的，除了 AuthorizeAttribute 类，它只是没有做我想要它做的事情。

为什么这与您的问题有关？

在不需要的时候编写代码是错误的。如果您已经尝试并测试过库，请重用它们，如果没有，请在编写自己的库之前从可信赖的来源中寻找它们。我的问题都不是新问题，我怀疑你的问题是否也是。那些拥有比我们大多数人更多的资源的人都已经解决了这些问题。

我应该停止重新发明轮子，只对没有预先打包的东西进行编码，部分原因是我正在工作中进行迁移项目，律师讨论与某些加密例程相关的 IP 的更精细点。我们将需要花费数周时间编写一些代码来将数据转换为另一种格式，因为我们不能“泄露”用于保护数据的 IP。如果该应用程序只是用罐装库编写的，那将只是我们需要交出的数据和加密密钥。它现在就完成了，而不是让律师们讨论的第十稿。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T21:20:38.467

一个好的、编写良好的、可维护的和可靠的应用程序是这样的，无论用于开发它的技术是什么。您可以使用任何语言或框架编写好代码和坏代码。随着时间的推移，我们获得了使我们作为开发人员的生活变得更轻松的工具，但是如果您一开始就是一个优秀的开发人员，那么您碰巧使用哪种 MVC 框架或 XML 解析器并不重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T22:29:03.200

这个没有正确答案。

唯一能想到的答案是这样的：*合适的工具做合适的工作*。

虽然我个人的看法是经典的 ASP.NET 是非常前天的。是的，他们从你那里抽象出 HTML，但是，嘿，他们开始所有这个 MVC 项目是有原因的——人们（专业人士）不满足于将 web 编写为经典应用程序，无法控制渲染，没有结构。此外，MVC 考虑了经典 ASP.NET 之后出现的所有现代 Web 技术。Ruby on Rails 就是一个很好的例子——DRY & COC 原则。MVC 模式还使您的应用程序更加结构化，并提供了很好的关注点分离......

**适合工作的正确工具**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T21:13:17.857

你可以做任何对你有用的事情。如果您是唯一的开发人员，并且永远都是，并且您深刻理解您进行开发的方式，那么就去做吧。

大多数方法都是关于改善长期维护的。维护占程序生命周期内总成本的 95% 之多。

但是通过混合架构，您可能会为自己设置不兼容，这些不兼容可能由于架构之间的阻抗不匹配而难以修复。

当 MVC 的模型绑定工作得很好时，我对你为什么编写自己的模型绑定器感到有点困惑。或者为什么您觉得需要进行自己的数据注释验证。但无论如何，这是您的代码。

如果你不喜欢 MVC，你可以考虑使用 fubumvc 或 spring.net 之类的东西

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T21:15:43.063

我参与过或有同事的一些公司的趋势是，他们都从经典的 ASP 转向至少编写 .Net WebForms，而从事 .Net WebForms 的公司现在正在转向 MVC！

# c# - UnitOfWork 会话中的 NHibernate 事务

> ID：12099923
> 
> 赞同：1
> 
> 时间：2012-08-23T21:02:38.000
> 
> 标签：c#, asp.net-mvc, nhibernate, transactions, unit-of-work

我正在处理的项目为整个会话定义了一个 UnitOfWork（这似乎是 MVC + NHibernate 站点的标准做法）

不过，我需要做的是能够遍历一组项目并在他们自己的“本地”事务中一个一个地处理它们。

像这样的东西：

```
foreach(var item in CollectionOfItems)
 {
      using (ITransaction transaction = UnitOfWork.CurrentSession.BeginTransaction())
      {
         //do work on item. rollback on failure, 
         //but it should not affect the other items
      }
 } 
```

但这不起作用，因为 BeginTransaction 行正在使用相同的“外部”会话。如何获得一个独立的“本地”会话来对一小段代码执行事务？我认为会话正在以下代码中注入工作单元。不过，我不知道具体如何：

UnitOfWOrk 类具有以下构造函数

```
 private readonly ISessionFactory _sessionFactory;
    private readonly ITransaction _transaction;

    public UnitOfWork(ISessionFactory sessionFactory)
    {
        _sessionFactory = sessionFactory;
        CurrentSession = _sessionFactory.OpenSession();
        _transaction = CurrentSession.BeginTransaction();
    } 
```

它通过以下方式注册：

```
For<IUnitOfWork>().LifecycleIs(new HybridLifecycle())
            .Use<UnitOfWork>(); 
```

因此，每当控制器返回响应时，会话就会被刷新。这就是我感到困惑的地方。我并不总是希望一切都是全有或全无。

编辑：

这是NHibernate注册过程的所有代码

```
 public NHibernateRegistry()
    {
        FluentConfiguration fluentConfig = Fluently.Configure()
            .Database(
                MsSqlConfiguration.MsSql2008.ShowSql().ConnectionString(x => x.FromConnectionStringWithKey("conn")))
            .ProxyFactoryFactory(typeof (ProxyFactoryFactory).AssemblyQualifiedName)
            .Mappings(m => m.FluentMappings.AddFromAssemblyOf<CustomerMap>());

        Configuration configuration = fluentConfig.BuildConfiguration();

        ConfigureNhibernateValidator(configuration);

        ISessionFactory sessionFactory = fluentConfig.BuildSessionFactory();

        For<Configuration>().LifecycleIs(new HybridLifecycle()).Singleton().Use(configuration);

        For<ISessionFactory>().LifecycleIs(new HybridLifecycle()).Singleton().Use(sessionFactory);

        For<ISession>().LifecycleIs(new HybridLifecycle())
            .Use(x => x.GetInstance<ISessionFactory>().OpenSession());

        For<IUnitOfWork>().LifecycleIs(new HybridLifecycle())
            .Use<UnitOfWork>();

        For<ITssPrincipal>().HybridHttpOrThreadLocalScoped().Use(container => BuildUserInstanceFromThreadCurrentPrincipal());

        Scan(x =>
        {
            x.TheCallingAssembly();
            x.WithDefaultConventions();
        });
    } 
```

编辑：DI 问题示例 在下面的示例中，您会看到 RepoA 与 RepoB 一起 DI，并且都获得了由 StructureMap 提供的 UnitOfWork。

```
public RepoA(IUnitOfWork unitOfWork, ITssPrincipal principal,
     IRepoB repoB)
{
}

public RepoB(IUnitOfWork unitOfWork, ITssPrincipal principal)
{
} 
```

即使我在 RepoA 的函数中创建新会话，repoB 仍将使用原始的 UnitOfWork 会话

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T00:30:27.800

看起来你的 MVC 网站正在使用 StructureMap 作为它的依赖注入容器，这使得做你想做的事情变得非常容易。

您有几个选项，但最简单的方法是从 StructureMap 请求一个新的 ISession 实例。这将为您返回一个新的和不同的 ISession，而不是 UnitOfWork 使用的 ISession。

这是一个例子：

```
var session = StructureMap.ObjectFactory.GetInstance<ISession>();

using ( var tx = session.BeginTransaction() )
{
    try
    {
        // Do your work here

        tx.Commit();
    }
    catch ( Exception )
    {
        tx.Rollback();

        throw;
    }
} 
```

因为您使用的是 DI 容器，所以您还可以利用 StructureMap 的依赖注入并将新的 ISession 注入到您的控制器/类/存储库等的构造函数中，这样您就不必调用 StructureMap 的 ObjectFactory.GetInstance<>( ） 方法。

# frameworks - Entity Framework 5 Release Candidate：未正确处理可为空的字段

> ID：12099926
> 
> 赞同：0
> 
> 时间：2012-08-23T21:02:52.747
> 
> 标签：frameworks, entity, entity-framework-5

带有 ASP.NET MVC 4 的实体框架 5RC

我有一个表，其中包含以下字段：

编辑器 nvarchar(200) 可为空

我在我的应用程序中生成了一个新的 EF 模型，并使用模型图上的“添加代码生成项...”生成了 POCO 实体。我保存了更改，清理了我的解决方案，并重建了整个解决方案。当我运行我的应用程序并尝试添加或编辑这种实体时，EF5RC 报告说

“无法将值 NULL 插入到列 'Editor'、表 '@T'；列不允许空值。INSERT 失败。语句已终止。”

数据库表字段可以为空。我回到模型并检查了实体中的这个字段。它的“Nullable”设置为“(None)”，这很奇怪。我本来希望它是真的。我将其设置为 True，保存模型的更改，清理解决方案并重建整个解决方案。当我运行应用程序时，我收到了同样的错误。我似乎可以解决这个问题的唯一方法是在我的 MVC 控制器中将此字段设置为一些垃圾值。

在我的 ViewModel 中，此字段未传递给 Create 或 Edit 操作。

在我的 EF 项目中，该字段注释如下...请注意，它未设置为必填项。

* * *

```
[Display(Name = "Title_Editor", ResourceType = typeof(Resources))]
[StringLength(200, ErrorMessageResourceName = "Error_200CharactersOrLess", ErrorMessageResourceType = typeof(Resources))]
public string Editor { get; set; } 
```

* * *

我试图从模型中删除我的实体，清理解决方案，重新创建实体和 POCO 类，但这个问题仍然存在。

对我来说，这看起来像是一个 EF5RC 错误……还有其他人遇到过吗？如何向 EF 开发团队报告？

谢谢，

麦克风

****** *** ** *** ** *** ****异常消息***** ** *** ** *** ** *** ******

 **```
System.Data.Entity.Infrastructure.DbUpdateException was caught   Message=An error occurred while updating the entries. See the inner exception for details.   Source=EntityFramework   StackTrace:
       at System.Data.Entity.Internal.InternalContext.SaveChanges()
       at System.Data.Entity.Internal.LazyInternalContext.SaveChanges()
       at System.Data.Entity.DbContext.SaveChanges()
       at ExpirationTrax.Domain.Repositories.EFCustomerRepository.Update(BaseCustomer customer) in C:\PROJECTS\ExpirationTraxMVC\ExpirationTrax.Domain\Repositories\EFCustomerRepository.cs:line 49   InnerException: System.Data.UpdateException
       Message=An error occurred while updating the entries. See the inner exception for details.
       Source=System.Data.Entity
       StackTrace:
            at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
            at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
            at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
            at System.Data.Entity.Internal.InternalContext.SaveChanges()
       InnerException: System.Data.SqlClient.SqlException
            Message=Cannot insert the value NULL into column 'Editor', table '@T'; column does not allow nulls. INSERT fails. The statement has been terminated.
            Source=.Net SqlClient Data Provider
            ErrorCode=-2146232060
            Class=16
            LineNumber=42
            Number=515
            Procedure=CustomersHistoryTrigger
            Server=DevPC\SqlExpress
            State=2
            StackTrace:
                 at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
                 at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
                 at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
                 at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
                 at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
                 at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
                 at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
                 at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
                 at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
                 at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
                 at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
            InnerException: 
```**

# python - 在多个类中使用 1 个 QProcess 实例 (PyQt)

> ID：12099932
> 
> 赞同：0
> 
> 时间：2012-08-23T21:03:15.900
> 
> 标签：python, pyqt4, qprocess

我有一个主窗口包装类（比如 A）和包装中使用的另一个类（比如 B）。B 有一个方法，该方法反过来有一个 subprocess.check_call(command) 调用。我将其更改为使用 QProcess，以便能够与此进程通信并在主窗口 QTextEdit 中显示 Qprocess stdout 和 stderr，并将数据从主窗口 QLineEdit 发送回 Qprocess stdin。

为此我有：

```
class A(....):
   def __init__(self):
      ....
      QtCore.QObject.connect(self.ui.actionNew, QtCore.SIGNAL("triggered()", self.selectedNew)
      self.qprocess = QtCore.QProcess()
      self.connect(self.qprocess, QtCore.SIGNAL("readyReadStandardOutput()", self.readStdOut)
      self.connect(self.qprocess, QtCore.SIGNAL("readyReadStandardError()", self.readStdErr)

    def readStdOut(self):
        self.ui.text_edit.append(QtCore.QString(self.qprocess.readAllStandardOutput()))

    def readStdErr(self):
        self.ui.text_edit.append(QtCore.QString(self.qprocess.readAllStandardError()))

    def selectedNew(self:)
        ...
        newB = B(self.qprocess)
        newB.doWork(params)

 class B():
     def __init__(self, qprocess):
         self.qp = qprocess

     def doWork(params):
         ...
         # creating a thread to not block the main thread
         class ConsoleThread(threading.Thread):

             def __init__(self, qprocess):
                self.tqp = qprocess
                threading.Thread.__init__(self)

             def run(self):
                 self.qtp.execute("script_that_waits_for_user_input_during_execution")

          # starting the thread and passing it the QProcess instance from B
          ConsoleThread(self.qp).start()
          print(self.qp.state()) # this returns 0, when I expected 2, obviously something wrong 
```

最后，“script_that_waits_for_user_input_during_execution”的输出没有显示在 QTextEdit 中，但仍打印在控制台中。似乎我在 A 中没有收到任何信号，而且我没有达到 A.readStdOut() 方法。一般的想法是让一个 GUI 应用程序包装不同的命令行脚本。所以我需要一种方法来正确地从 QProcess 获取输出，并能够通过从 GUI 写入它来进行通信。当然，如果我将函数从 B 移动到 A（将消除不必要的步骤），它可能会不那么复杂，但同时 GUI 包装器应该与我认为的逻辑分开。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T23:47:23.870

我想你可能误解了 a 的使用`QProcess`，因为这个例子做了很多奇怪的事情：

1.  类 A 的一个实例获得一个创建为成员的 QProcess，并发出连接的信号
2.  每次`selectedNew()`调用时，它都会创建一个 B 的新实例，每次都传递相同的 QProcess 实例。
3.  `doWork`然后调用它，它每次都会创建一个本地类定义，只是为了创建一个实例并丢弃该类。该线程在 QProcess 实例上调用一个静态方法，该方法创建一个可以自由运行的新 QProcess。
4.  在`doWork`中，您在启动 asych 线程后立即检查`QProcess`右侧的状态，就好像 QProcess 实例一直发生任何事情一样。

主要是，您有一个线程每次都启动一个**新**进程，然后您检查一个不会更改原始值的值，因为它从未启动过。并且信号永远不会被调用，因为它们附加到那个原始过程。为了简化整个情况，您只需在每次要运行时创建一个新的 QProcess。

首先，让我们将该类清理`A`成可以正常工作的东西：

```
class A():
    def __init__(self):
      ...
      self.ui.actionNew.triggered.connect(self.selectedNew)

    def readStdOut(self):
        self.ui.text_edit.append(str(self.qprocess.readAllStandardOutput()))

    def readStdErr(self):
        self.ui.text_edit.append(str(self.qprocess.readAllStandardError()))

    def selectedNew(self):
        ...
        qprocess = QtCore.QProcess(self)
        qprocess.readyReadStandardOutput.connect(self.readStdOut)
        qprocess.readyReadStandardError.connect(self.readStdErr)

        qprocess.start("script_that_waits_for_user_input", params)

        print qprocess.state() == qprocess.Running 
```

不是在 init 中创建 QProcess，而是在您想要运行某些东西时按需创建它。然后你将该实例的信号连接到你的插槽，并在 QProcess 上调用 start。这实际上将启动该过程，并调用您的插槽。

我不知道您打算使用 class 做什么`B`，除非您想将命令行脚本包装到不同的类中，在这种情况下，您会将 QProcess 创建完全移至 class `B`，然后将您的类`A`信号连接到`b_instance.qprocess`成员。

**更新**

为了将此 QProcess 责任下移到`B`类中，以便您可以拥有许多不同的类类型来执行不同类型的工作，它可能如下所示：

```
class A(QtGui.QMainWindow):
    ...

    def readStdOut(self):
        qprocess = self.sender()
        self.ui.text_edit.append(QtCore.QString(qprocess.readAllStandardOutput()))

    def readStdErr(self):
        qprocess = self.sender()
        self.ui.text_edit.append(QtCore.QString(qprocess.readAllStandardError()))

    def selectedNew(self):
        ...
        b = B()
        b.qprocess.readyReadStandardOutput.connect(self.readStdOut)
        b.qprocess.readyReadStandardError.connect(self.readStdErr)

        b.doWork(params)

        print b.qprocess.state() == qprocess.Running

class B(QtCore.QObject):
    def __init__(self):
        ...
        self.qprocess = QtCore.QProcess(self)

    def doWork(params):
        ...
        self.qprocess.start("script_that_waits_for_user_input", params) 
```

类`A`创建 的一个新实例`B`，并将`B`的进程的信号连接到它自己的槽。然后它`doWork`使用命令的参数调用 。`B`实际上启动线程并拥有它。

# forms - Access 2010 - 从 excel 导入数据 - 将两列合并为一个子表单列

> ID：12099939
> 
> 赞同：1
> 
> 时间：2012-08-23T21:04:00.993
> 
> 标签：forms, ms-access, subform, subforms

我对 Access 完全陌生，所以我不确定我是否以正确的方式进行此操作，但我被卡住了。

我有一个包含大约 5000 条记录的 excel 文件。此文件中的数据中有用于跟踪就业历史的列。目前有两组栏目，“Job Title 1”和“Employer 1”和“Job Title 2”和“Employer 2”

我想使用 Access 让用户添加额外的就业记录。理想情况下，我希望能够根据需要添加 Job 3、Job 4 等。

我在 Access 中创建了一个表单，在我看来，子表单是插入工作经历的最佳方式。所以，我创建了一个导入 Job 数据的子表单，但是我在格式化它时遇到了问题。

现在，我可以将职称 1 和职称 2 放在同一行的不同列中，但我想将它们组合成一个“职称”字段，并创建多行。

如果我走在正确的轨道上，我可以使用一些帮助来完成子表单格式，或者如果有完全不同的方法可以做到这一点，我也对此持开放态度。

## 这是一个简化的示例记录：

姓名：约翰·史密斯

职位名称1：记者

雇主1：多伦多之星

职位名称2：专栏作家

雇主 2：多伦多太阳报

## 我想要的是一个看起来像这样的表，可以选择添加额外的行：

姓名：约翰·史密斯

职位/雇主

记者/多伦多星报

专栏作家/多伦多太阳报

提前感谢您的帮助，我希望我的解释很清楚，但请告诉我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:06:28.293

不要尝试在 MS Access 中重现 Excel 表单。您需要一个包含以下内容的表：

```
PersonID
JobTitle
JobDetails
JobDate 
```

用户将不断向子表单中的表格添加记录，日期将告诉您是作业 1 还是作业 n。当您输出到 Excel 时，交叉表查询会将记录排成一行，如果您需要的话。如果您还没有阅读过类似的内容，您可能想阅读[http://r937.com/relational.html 。](http://r937.com/relational.html)

要将现有数据更改为这种格式，可以使用联合查询：

```
 INSERT INTO NewTable (PersonID, JobTitle, Employer)
 SELECT PersonID, JobTitle, Employer FROM
 (SELECT PersonID1 As PersonID, JobTitle1 As JobTitle, Employer1 As Employer
 FROM Table
 UNION ALL
 SELECT PersonID2 As PersonID, JobTitle2 As JobTitle, Employer2 As Employer
 FROM Table) 
```

# objective-c - 在 Objective C 中拥有私有成员的不同方法的比较

> ID：12099940
> 
> 赞同：12
> 
> 时间：2012-08-23T21:04:16.803
> 
> 标签：objective-c, private-members

我来自 C++/Java 世界，在那里创建私有成员非常明显。但是，我在 Objective C 中看到了几种方法，我想听听利弊

1) 在 .h 文件中将它们声明为 @private

```
@interface MyClass : NSObject
{
    @private
    int someMember;  
}
@end 
```

2) 在 .m 文件中的接口中声明它们

```
@interface MyClass() {
    int someMember;  
}
@end

@implementation MyClass
@end 
```

3）在实施中声明它们

```
@implementation MyClass {
     int someMember;  
}
@end 
```

首选方法是什么，为什么？我错过了任何其他方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T21:19:21.730

我的偏好是#3：

```
// MyClass.m
...
@implementation MyClass {
     int someMember;
}
@end 
```

它允许您干净地抽象并最大限度地减少依赖关系。

由于每个 objc 对象都是动态分配的并且几乎没有物理依赖，因此您可以拥有最快的构建时间和最丰富的对象表示最小的编译开销（例如最小`#import`的 s 和物理依赖）。

抽象也是一个巨大的优势——私有是默认设置，你没有理由偏离它，也没有理由将内部结构暴露给其他人。这很好地隐藏了这一切，同时确保不损害类型安全。大优点：您还可以轻松地在对象中声明 C++ 值，而无需将每个人都暴露给所有 C++ 库的依赖项——不是 PIMPL，不是全局范围内的结构，不是 *void**，而是正确的*值*。这是一个很棒的编译防火墙。如果您曾参与过大型 C 或 C++ 项目，您可能会很高兴。

当然，在选项 #2 中声明 ivars 会带来所有这些。因此，这在很大程度上取决于您希望在何处以及如何查看变量。ivar 声明是具体的，而属性可能是抽象的——所以我倾向于将具体与具体和接口与接口分组，但无论哪种方式；#2 或 #3 是理想的，除非您需要向后兼容。

如果您想要（伪）私有属性，我建议您在类延续中声明它们：

```
// MyClass.m
...
@interface MONClass ()
@property (nonatomic, copy) NSString * string;
@end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T21:20:42.197

您几乎按照添加到 Objective-C 的时间顺序方便地列出了它们。

我认为这主要是一个风格问题，但我会说 99% 的时间：

(1) 不要将它们放在 .h 文件中，因为 .h 文件实际上是发布的接口，没有理由发布实现细节；

(2)以避免无关语法为由，将它们放在类扩展中`@implementation`而不是类扩展中。`@interface`你总是会有一个实现，你可能没有类扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:32:33.170

如果有人想在不编辑的情况下使用 MyClass，他们会快速阅读头文件以了解它是如何工作的。由于它们不关心您的私有变量，因此最好将它们放在标题之外。

如果您想要私有属性或私有实现的协议，则需要在`.m`文件中使用类延续。

```
@interface MyClass () <SomeKindOfDelegate>
@property id someProperty;
@end

@implementation MyClass
@synthesize someProperty;
- (void)someKindOfDelegateMessage:(id)sender { }
@end 
```

当你这样做的时候，你也可以把你的成员变量也放在延续中。

```
@interface MyClass () <SomeKindOfDelegate>
{
    int someMember;
}
@property id someProperty;
@end

@implementation MyClass
@synthesize someProperty;
- (void)someKindOfDelegateMessage:(id)sender { }
@end 
```

# r - RCurl 相当于这个...

> ID：12099949
> 
> 赞同：5
> 
> 时间：2012-08-23T21:04:47.450
> 
> 标签：r, rcurl

我目前正在使用这个 R 代码在 Ubuntu 机器上完成我想做的事情......

```
jsontext <- '{"text": "its really cold in here"}'
a <- paste('curl -H "Content-Type: application/json" -d ', " '", jsontext, "'", ' -X POST http://urlhere', sep="")
response <- system(a) 
```

这给了我在命令提示符下输入时我会得到的东西......

```
curl -H "Content-Type: application/json" -d '{"text": "its really cold in here"}' -X POST http://urlhere 
```

我已经尝试使用 RCurl postForm(uri="http://urlhere", with various options...) 并且没有任何结果。这样做更快还是值得弄清楚？

谢谢

# java - 对于 Windows 7 或 XP 上已签名的 Java 小程序，什么会导致 Desktop.isDesktopSupported()=true 但 desktop.isSupported(Desktop.Action.OPEN)=false？

> ID：12099952
> 
> 赞同：0
> 
> 时间：2012-08-23T21:05:03.787
> 
> 标签：java, file, applet, launch, signed

我有一大群用户无法从签名的小程序中启动本地创建的文件（PDF、Word 等）。在 Windows 资源管理器中双击文件会启动它，因此与启动应用程序的文件关联是已知的。技术支持在启用了 UAC 的机器上远程登录，发现加载小程序没有问题，并且可以毫无问题地启动本地文件。这让我觉得这个大群体有一个共同的本地环境。用户在 Windows XP（或 7，不确定）上运行 Java 1.6u31。java控制台中没有显示任何错误，也没有任何内容（所有传闻，因为我没有看到问题）。有关可能导致此行为的本地 PC 设置的任何建议？根据代码，问题似乎是支持 Desktop，但 Desktop.Action.OPEN 不支持。任何建议为什么？谢谢。
我正在使用以下内容来启动文件：

```
 /*
            //old way that would work for Windows prior to Java 1.6
            //cmd = System.getenv("windir") +"\\system32\\"+"rundll32 SHELL32.DLL,ShellExec_RunDLL " + cmd;
            //cmd = "open "+cmd;  // Mac for PDF only?
            //try{
            //  Runtime.getRuntime().exec(cmd);
            //} catch (Exception e) {
            //  //handle error
            //}
            */
            Desktop desktop = null;
            if (Desktop.isDesktopSupported()) {
                desktop = Desktop.getDesktop();
                if (desktop.isSupported(Desktop.Action.OPEN)) {
                    try {
                        desktop.open(new File(file));
                        return;
                    } catch (IOException e) {
                        //Error launching the file
                        e.printStackTrace();
                        JOptionPane.showMessageDialog(theFrame,
                            "Unable to launch the file.",
                            "Document Error", JOptionPane.ERROR_MESSAGE);
                        return;
                    }
                }
            } else {
                //This OS cannot launch the file
                JOptionPane.showMessageDialog(theFrame,
                        "This operating system is unable" +
                        "\nto launch external files" +
                        "\nfrom within this application.",
                        "Document Error", JOptionPane.ERROR_MESSAGE);
                    return;
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:41:31.970

纯猜测：

1) 受影响的用户都在 Windows 7 上

2）Vista/Win 7“UAC”在咬你：

建议（仅用于诊断）：

*   [在 Java 中使用 Desktop 打开文件时出错（Windows 7）](https://stackoverflow.com/questions/6219359/error-opening-files-with-desktop-in-java-windows-7)

找到一个受影响的用户，尝试禁用 UAC，看看它是否“突然开始工作”

```
Control Panel->User Accounts->Turn User Account Control off 
```

==================================================== =================================

2012 年 8 月 24 日附录：

1）我从您随后的注释中了解到，您不仅仅是在尝试执行程序 - 您实际上是在尝试调用 Windows 文件关联（即“shell open”a .pdf 应该触发“AcroReader”的实例） .

2）看这个链接：

*   [https://forums.oracle.com/forums/thread.jspa?messageID=5485431](https://forums.oracle.com/forums/thread.jspa?messageID=5485431)

3) 更新您的 JDIC（如有必要）

4) 在您的小程序中添加几个测试按钮：

a）“打开”notepad.exe（看看是否可以直接按名称调用.exe）

b）“打开” somefile.txt（看看您是否可以调用任何文件关联 - 例如“.txt”的“记事本”）

5) 如果以上都没有导致解决方案，请直接访问其中一台“失败的 PC”，以便您可以“动手”调试。

'希望有帮助！

# c++ - 如何将相同的签名分配给具有不同签名的函数？

> ID：12099956
> 
> 赞同：0
> 
> 时间：2012-08-23T21:05:53.910
> 
> 标签：c++, function, pointers, boost, functor

在我的 C++ 应用程序中，我有 2 个线程：（i）主线程，（ii）后台线程。我有一个类定义为：

```
class helper
{
 public:
     bool login(const string& username, const string& password);
     void logout();

 private:
     bool loginInternal(const string& username, const string& password);
     void logoutInternal();
} 
```

在主线程上调用 helper::login() 和 helper::logout() 函数（以及具有各种返回类型和 # of params 和 param 类型的其他几个成员函数）。在这些函数的实现中，对应的内部函数要入队，后台线程按照入队的顺序调用这些内部函数。所以是这样的：

```
bool helper::login(const string& username, const string& password)
{
    queue.push_back(boost::bind(&helper::loginInternal, this, username, password));
}

void helper::logout()
{
    queue.push_back(boost::bind(&helper::logoutInternal, this));
} 
```

后台线程一直在运行，等待队列填满，一旦填满，这个后台线程就会开始调用队列中的函数：

```
queue.front()();
queue.pop_front(); 
```

那么问题来了，我该如何定义这样的队列呢？

```
deque<???> queue; 
```

该队列的数据类型可能是什么，以便它可以在同一个队列中保存具有不同签名的回调函数？

编辑：这是解决方案（感谢 J. Calleja）：

```
typedef boost::function<void ()> Command;
deque<Command> queue; 
```

然后像这样调用仿函数：

```
// Execute the command at the front
Command cmd = queue.front();
cmd();

// remove the executed command from the queue
queue.pop_front(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:01:28.153

如果您规范化返回类型或忽略它，您可以使用[boost::function 。](http://www.boost.org/libs/function/)该库定义了一个包装器，可以存储任何与您的签名（函数或仿函数）匹配的元素。

使用您的示例：

```
#include <boost/function.hpp>

class helper 
{  
public:      
  bool login(const std::string& username, const std::string& password);
  void logout();
private:      
  bool loginInternal(const std::string& username, const std::string& password);
  void logoutInternal();
private:
  typedef boost::function<void ()> Command;
  std::deque<Command> queue;
}; 
```

此示例忽略返回类型，因为它声明了返回 void 的函数。如果你想知道返回值，你必须让 logout 返回一个 bool 并将声明更改为：

```
 typedef boost::function<bool ()> Command; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:16:41.447

我相信第一个的类型是`bind<bool>`，第二个的类型是`bind<void>`。由于这是两种不同的类型，您不能将它们放在一个队列中。使`logout`return 成为一种`bool`（即使它总是返回`true`或其他东西）将是解决此问题的一种（可能相对无痛）的方法。

tl;dr：更改`logout`为返回 a `bool`，然后将您的队列声明为`deque< bind<bool> >`。

编辑：考虑到多种类型，我建议您为自己创建某种特殊的容器类。像这样的东西：

```
class EnqueuedFunc
{
    virtual void operator()() = 0;
};

class LoginFunc : public EnqueuedFunc
{
    bind<bool> func;

    LoginFunc(bind<bool> fn)
    {
        func = fn;
    }
    void operator()()
    {
        fn();
    }
};

class LogoutFunc : public EnqueuedFunc
{
    bind<void> func;

    LoginFunc(bind<void> fn)
    {
        func = fn;
    }
    void operator()()
    {
        fn();
    }
}; 
```

然后你的队列是`deque<EnqueuedFunc>`.

# c++ - 如何将击键发送到其他进程（例如记事本）？

> ID：12099957
> 
> 赞同：5
> 
> 时间：2012-08-23T21:05:55.700
> 
> 标签：c++, windows, winapi, sendmessage, sendkeys

我有一个 PID：2860 的记事本

```
#include <iostream>
#include <windows.h>
#include <psapi.h>
using namespace std;
HWND SendIt (DWORD dwProcessID){
    HWND hwnd = NULL;
    do {
         hwnd = FindWindowEx(NULL, hwnd, NULL, NULL);
         DWORD dwPID = 0;
         GetWindowThreadProcessId(hwnd, &dwPID);
         if (dwPID == dwProcessID) {
            cout<<"yay:"<<hwnd<<":pid:"<<dwPID<<endl;//debug
            PostMessage(hwnd,WM_KEYDOWN,'A',1); //send
         }
    } while (hwnd != 0);
    return hwnd; //Ignore that

}
int main()
{
    SendIt(2680); //notepad ID
    return 0;
} 
```

和记事本应该写入`A`它但没有任何反应。
我尝试`WM_DESTROY`了关于它的消息，它正在工作但`WM_KEYDOWN`不工作。
我也做了`GetLastError()`，它打印错误 2 `ERROR_FILE_NOT_FOUND`。

为什么这不起作用，是否可以修复它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:44:17.430

应该使用 PostThreadMessage。

```
hThread = GetWindowThreadProcessId(hwnd,&dwPID);  
if (dwPID == dwProcessID && hThread!= NULL ) {
   PostThreadMessage( hThread, WM_KEYDOWN,'A',1);
} 
```

两个进程必须由同一用户创建。否则，函数将失败并返回 ERROR_INVALID_THREAD_ID。

如果其他进程是正在捕获键盘输入的活动窗口，则 SendInput 或 keybd_event 也可用于发送击键事件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-08T11:57:02.863

> 我有一个 PID：2860 的记事本

忍不住注意到你说的是 2860 并拨打了 2680

> 发送它（2680）；//记事本ID

# iphone - ios通用应用程序xib文件名

> ID：12099958
> 
> 赞同：2
> 
> 时间：2012-08-23T21:05:58.930
> 
> 标签：iphone, ios, xcode, ipad

当我创建一个新的通用应用程序时，我看到初始控制器 xib 文件具有“_iPad”和“_iPhone”的后缀。

这很好，我知道应用程序委托通过 userInterfaceIdiom 选择了正确的文件

但是，我读到我可以使用“〜iPad”和“〜iPhone”的后缀自动达到相同的效果

我对此非常好奇。如果可以通过添加波浪号 (~) 符号来完成此选择，为什么默认的通用应用程序文件结构不使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T05:51:11.567

是的你是对的。我正在使用 ~ipad 和 ~iphone 从应用程序包中加载图像，它就像一个魅力。它为我节省了很多工作，因为这种方法非常简单。正如蒂尔所说，人们是不同的，有些人喜欢控制一切，有些人则不：）

# regex - 匹配多个文件中的一行并修改

> ID：12099963
> 
> 赞同：2
> 
> 时间：2012-08-23T21:06:13.293
> 
> 标签：regex, bash, sed

如果有人擅长正则表达式模式，替换字符串和 bash - 你可以帮我一个大忙：

我在一个目录中有一堆源文件，这些文件在不同的地方都有这一行。该行之前可能有空格。

> RELEASE_AND_NIL(_theNameOfAVariable);

我想转换所有出现，覆盖文件：

> [_theNameOfAVariable release];

..请指点？我认为之前有人向我展示了如何使用 sed 执行此操作，但我忘了那是很久以前的事了。

谢谢

编辑

我最后使用的实际命令是：（感谢@fardjad）

```
 find . -name '*.m' -print0 | xargs -0 sed -i "" "s/RELEASE_AND_NIL(\(.*\))/[\1 release\]/g" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:12:33.773

您可以`sed -i`用来执行就地替换，正则表达式替换模式将是：

```
s/RELEASE_AND_NIL\((.*?)\)/\[\1 release\]/g 
```

所以你可以这样做：

```
sed -ie "s/RELEASE_AND_NIL(\(.*\))/[\1 release\]/g" /path/to/your/file 
```

如果你有一堆源文件，你可以使用`find`and `xargs`：

```
find . -type f -print0 | xargs -0 sed -ie "s/RELEASE_AND_NIL(\(.*\))/[\1 release\]/g" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:12:08.027

```
sed -r 'RELEASE_AND_NIL\(([^(]+)\)/[\1 release]/' your_file.txt > target_file.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:12:15.513

如果我正确理解 _theNameOfAVariable 可能是任何东西，那么这应该可以满足您的需要：

```
sed -e 's/ *RELEASE_AND_NIL(\(.*\));/[\1 release];/' 
```

# jquery - ruby on rails + jquery datepicker

> ID：12099964
> 
> 赞同：0
> 
> 时间：2012-08-23T21:06:21.630
> 
> 标签：jquery, ruby-on-rails, jquery-ui

1.  我有一个重复事件的事件日历。站点管理员选择开始和结束日期以及重复间隔。所以，这个周末从周五到周日每天重复的艺术节有三个事件实例。公园音乐会从 5 月初到 9 月底的每个星期四举行，大约有 20 场左右的活动实例。

我使用了 Ryan Bates 的技术来管理具有一个表单的多个模型，并添加了“添加另一个”`link_to_new_fields`方法，该方法会弹出一个新的子表单，用户可以在其中添加另一个日期。这确实很好用，但事件实例部分使用`date_select`而不是性感的 jquery datepicker。所以，我的问题是如何在我的 .coffee.js 文件中解释无数事件实例？他们都有一个独特的ID。如果我在表单加载后检查它们，它们会以可预测的方式递增，例如`calendar_event_calendar_event_instances_attributes_0_starts_at`，然后 ...1...，然后 ....2... 等等。那么，我如何`.coffee.js`在调用时将它们全部计入文件中`datepicker()`? 制作 100 种相同的方法来解释所有这些方法似乎很荒谬，这甚至可能还不够。我尝试动态生成函数，但无济于事，我假设在模型或 Ruby 助手中可能有一种非常聪明的方法来做到这一点。

1.  与此相关的是，一旦您单击“添加另一个日期”，ID 就会与时间戳绑定以生成唯一 ID。我明白了，但我无法预加载 jQuery 来知道这些未来的 id 可能是什么。那么，我该如何编写一个 jquery 方法来处理这个问题呢？

任何见解都会非常有帮助。日期选择器在整个站点中运行良好，但现在客户对它上瘾了，如果可能的话，也希望在这里使用它。

谢谢，

史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T19:45:48.757

我认为您想选择正确的 jQuery 选择器：[jQuery Selectors](http://api.jquery.com/category/selectors/)
这个看起来可能有用：[Attribute Starts With Selector](http://api.jquery.com/attribute-starts-with-selector/)
然后您可以在您的咖啡脚本中尝试这样的操作：

```
jQuery("select[id^=calendar_event_calendar_event_instances_attributes]").datepicker(...) 
```

假设您所有的日历 ID 都以 calendar_event_calendar_event_instances_attributes 开头并且在 select 标签内。

# php - 如何递归迭代和编辑包含数组、类和对象的混合变量？

> ID：12099965
> 
> 赞同：0
> 
> 时间：2012-08-23T21:06:24.847
> 
> 标签：php, recursion, multidimensional-array, iterator

我正在尝试使用 RecursiveIteratorIterator 类并遍历每个子对象，以查看某些键是否与我拥有的特定列列表匹配。一旦键/列匹配，我将更改文本。但是，我想确保我可以访问每个元素中包含对象的多维数组。

我正在寻找一种方法来遍历数组和对象，然后遍历较低的子级别并检查键名。如果键名匹配，我可能想在其上运行回调函数或某种正则表达式/替换函数。

数据如下所示：

```
 [0] => Array
        (
            [01__BLAH_A] => 1
            [01__BLAH_B] => 0
            [01__BLAH_C] => 1
            [01__BLAH_D] => 1
            [01__BLAH_E] => 1
            [01__BLAH_F] => 1
            [01__BLAH_G] => 0
            [01__BLAH_H] => 3
            [01__BLAH_I] => 0
            [01__BLAH_J] => 1
            [01__BLAH_K] => 1
            [01__BLAH_L] => 1
            [01__BLAH_M] => 3
            [SOME_OBJECT] => some_object Object
            (
                    [variable_1:some_type:private] => 
                    [variable_2:some_type:private] => 
                    [my_data:protected] => Array
                    (
                            [BLAH_1_A] => nAME
                            [BLAH_1_B] => blahblah
                            [BLAH_1_C] => other_dude
                            [BLAH_1_D] => 1
                            [BLAH_1_E] => 55
                            [BLAH_1_F] => 1
                            [BLAH_1_G] => null
                            [BLAH_1_H] => 1234567989
                    )

            )
        [SOME_OTHER_OBJECT] => some_other_object Object
            (
                    [variable_1:some_type:private] => 
                    [variable_2:some_type:private] => 
                    [my_data:protected] => Array
                    (
                            [BLAH_2_A] => nAME of another
                            [BLAH_2_B] => fofofofo
                            [BLAH_2_C] => right_dude
                            [BLAH_2_D] => 1
                            [BLAH_2_E] => 33
                            [BLAH_2_F] => 2
                            [BLAH_2_G] => 0
                            [BLAH_2_H] => 987654321
                    )
            )
        )
[1] => Array
        (
            [02__BLAH_A] => 1
            [02__BLAH_B] => 0
            [02__BLAH_C] => 1
            [02__BLAH_D] => 1
            [02__BLAH_E] => 1
            [02__BLAH_F] => 1
            [02__BLAH_G] => 0
            [02__BLAH_H] => 3
            [02__BLAH_I] => 0
            [02__BLAH_J] => 1
            [02__BLAH_K] => 1
            [02__BLAH_L] => 1
            [02__BLAH_M] => 3
            [SOME_OTHER_OBJECT] => some_other_object Object
            (
                    [variable_1:some_type:private] => 
                    [variable_2:some_type:private] => 
                    [my_data:protected] => Array
                    (
                            [BLAH_2_A] => nAME of another
                            [BLAH_2_B] => fofofofo
                            [BLAH_2_C] => right_dude
                            [BLAH_2_D] => 1
                            [BLAH_2_E] => 33
                            [BLAH_2_F] => 2
                            [BLAH_2_G] => 0
                            [BLAH_2_H] => 987654321
                    )
            )
        ) 
```

请注意，数据有一个基本的对象数组以及一些元素和嵌套对象。每个数组元素中可能有不同的对象类型。我想要一个对所有这些元素都不可知的迭代器。

我以为我正在使用 RecursiveIteratorIterator 走在正确的道路上，但是当它到达这些对象时遇到了障碍。

```
class Modifiable_Iterator
extends RecursiveIteratorIterator
{
    private $char_set;
    private $columns_to_check = array();

    static function make($mixed_array_data)
    {
        return new self($mixed_array_data); 
    }

    function __construct($data)
    {
        parent::__construct(
            new RecursiveArrayIterator($data), 
            RecursiveIteratorIterator::SELF_FIRST, 
            null);

        $this->columns_to_check = array('BLAH_2_A', 'BLAH_1_A');        
    }

    final public function current($parent_key_name = null)
    {
        // Retrieves the current value
        $current    = parent::current();

        if (in_array($this->key(), $this->columns_to_check))
        {
            // If the column name matches the list of columns in the private
            // variable, then edit the column value

            return _some_function_that_edits_this_value($current);
        }

        return $current;
    }

    final public function exec() 
    {
        $this->_loop_check($this);

        return $this;
    }

    final private function _loop_check($iterator)
    {
        while ($iterator->valid())
        {
            if ($iterator->hasChildren())
            {
                $this->_loop_check($iterator->getChildren());
            }

            $this->offsetSet($iterator->key(), $this->current());

            $iterator->next();
        }
    }    

    final private function _some_function_that_edits_this_value($value)
    {
        // Do something to the value and return it.

        return $value;
    }
} 
```

我希望能够获取混合数据对象，然后尝试像这样执行此代码：

```
$new_text = Modifiable_Iterator::make($mixed_bag_of_data)->exec(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:33:48.473

尝试使用[ArrayIterator](http://php.net/manual/en/class.arrayiterator.php)：

```
class YourClass extends ArrayIterator{

    public function __construct($data)
    {

        parent::__construct($data);

        // your further logic

    }

} 
```

让我们提供一个填充数据的实例：

```
$family = new YourClass(array(

        'name' => 'John',
        'surname' => 'Doe',
        'myAwesomeFriend' => new YourClass(array(

            'name' => 'Jane',
            'surname' => 'Doe'          

        ))

)); 
```

现在找到一种方法来抓取这些数据：

```
// we search the $element for keys in $keyList, then call the $callback eventually
function map($callback, $element, $keyList){

    foreach($element as $key => &$value)
    {

        //if we need to iterate on the field, we do again
        if($value instanceof ArrayIterator)
            map($callback, $value, $keyList);

        // else if key is in given keylist, we apply callback
        else if( in_array( $key, $keyList) )
            $value = call_user_func($callback, $value);

    }

} 
```

使用此函数 over `$family`，搜索命名的键`name`并将值转换为小写：

```
map(function($element){

    return strtolower($element);

}, $family, array('name')); 
```

让我们看一下`var_dump($family)`打印出来的内容：

```
object(YourClass)#1 (1) {
  ["storage":"ArrayIterator":private]=>
  array(3) {
    ["name"]=>
    string(4) "john"
    ["surname"]=>
    string(3) "Doe"
    ["myAwesomeFriend"]=>
    object(YourClass)#2 (1) {
      ["storage":"ArrayIterator":private]=>
      array(2) {
        ["name"]=>
        string(4) "jane"
        ["surname"]=>
        string(3) "Doe"
      }
    }
  }
} 
```

机箱放下，任务完成。

警告：您的对象/子对象需要扩展`ArrayIterator`- 如果您不喜欢那样，您必须手动实现它的许多接口 [ `Iterator`, `ArrayAccess`, 等等]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T13:59:00.233

到目前为止，这是我想出的，它适用于所有对象，但不适用于单个数组元素。当我使用反射修改对象时，数据被保留。

我当前执行此操作的代码片段仍然类似于我原来的概念：

```
Replacer::make($mixed_data_array)->exec(); 
```

我写的代码如下。在大多数情况下，我的所有嵌套对象都按预期更改并返回到 $mixed_datay_array 变量。我使用迭代器的 offsetSet() 方法更改的所有其他数组元素都没有存储。不确定我是否需要使用“魔法&”，这似乎不适合这种情况......还是我需要做另一个反射？帮助！

（下面的代码）

```
class Replacer
extends RecursiveIteratorIterator 
{
    private $char_set;
    private $char_set_exclude = array();
    private $columns_to_check = array();
    private $columns_with_titles = array();
    private $data;
    private $title_prefix;

    static function make($mixed_array_data)
    {
        return new self(
            is_null($mixed_array_data) ? array() : $mixed_array_data);
    }

    function __construct($data)
    {
        parent::__construct(new RecursiveArrayIterator($data),
                            RecursiveIteratorIterator::SELF_FIRST,
                            null);

        $this->char_set = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
                          . 'abcdefghijklmnopqrstuvwxyz';

        $this->char_set_exclude =
            array('@',
                  ' ',
                  '.');

        $this->columns_to_check =
            array('email_address',
                  'member_name');

        $this->data = $data;
    }

    final public function replace_text($key, $value)
    {
        if (is_array($value))
            {
            return $value;
        }

        $new_text = null;

        if (in_array(strtolower($key), $this->columns_to_check))
        {
            $cypher = str_shuffle($this->char_set);

            // Each character in the string is replaced with shuffled text.
            for ($i = 0; $i < strlen($value); $i += 1)
            {
                if (in_array($value[ $i ], $this->char_set_exclude))
                {
                    $new_text .= $value[ $i ];
                }
                else
                {
                    $new_text .=
                        $cypher[strpos($this->char_set, $value[$i])];
                }
            }
        }
        else
        {
            $new_text = $value;
        }

        return $new_text;
    }

    final public function exec()
    {
        $this->rewind();

        if (!$this->valid())
        {
            return $this->process_child_object($this->data);
        }

        return $this->begin_replace($this)->get_data();
    }

    final public function get_data()
    {
        return $this->data;
    }

    final public function set_columns_to_check($columns_array)
    {
        if (!is_array($columns_array) && !empty($columns_array)
        {
            $columns_array = array($columns_array);
        }

        $this->columns_to_check = $columns_array;

        return $this;
    }

    final private function begin_replace($data)
    {
        while ($data->valid())
        {
            // If there are any child elements, repeat procedure for subobjects.
            if ($data->hasChildren())
            {
                $this->begin_replace($data->getChildren());
            }

            if (is_object($data->current()))
            {
            // If the current element is an object, process it 
                // differently: using Refelection

                $this->process_child_object($data->current());
            }
            else
            {
                // Used built-in offsetSet method to update the data keys if
                // the array element isn't in a private/protected object and
                // the key name is also in the columns_to_check array.

                $data->offsetSet(
                    $data->key(),
                    $this->replace_text($data->key(), $data->current()));
            }
            $data->next();
        }

        return $data;
    }

    final private function process_child_object($object)
    {
        if (!is_object($object))
        {
            return $object;
        }

        // Used Reflection Object and Property to make the data object
        // accessible for reading and updating.
        $ref_object = new ReflectionObject($object);

        foreach ($ref_object->getProperties(
                    ReflectionProperty::IS_PROTECTED) as
                        $protected_property)
        {
            $data_array = array();

            $ref_prop = $ref_object->getProperty(
                            $protected_property->name);
            $ref_prop->setAccessible('true');

            foreach ($ref_prop->getValue($object) as
                         $key => $value)
            {
                $data_array[$key] = $this->replace_text($key, $value);
            }
            $ref_prop->setValue($object, $data_array);
        }

        return $object;
    }
} 
```

# windows - 正在运行的 Windows 服务阻止文件下载的防病毒软件

> ID：12099969
> 
> 赞同：0
> 
> 时间：2012-08-23T21:06:33.200
> 
> 标签：windows, windows-services, antivirus

我有一个正在运行的 winservice，它将一个 exe 下载到磁盘并从该二进制文件运行逻辑。

每次下载时，AVG 防病毒软件都会提示用户验证它是否可以运行或将其移至保管库。

我会在没有任何用户干预的服务器上运行它。我怎样才能解决这个问题？

例如 Firefox/Windows 自动更新程序，即使安装了防病毒软件，它似乎也能无缝地自动升级。它是如何工作的 ？

被列入白名单是解决这个问题的唯一方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:09:23.540

如果 AVG 防病毒软件声称某个文件是病毒，而您**确定**它不是病毒，您可以向他们[提交误报报告](http://samplesubmit.avg.com/us-en/false-detection)。

他们将检查文件（包含在您的报告中），通常会在 1-2 周内更新病毒定义以排除该文件。

如果您不能等待那么久，您可以安装不同的防病毒解决方案。

如果您从**不受信任的来源**下载文件（从 Windows 的角度来看，例如不是从您的 Intranet），则该文件可能会被标记为此类。AVG 可能会对此做出回应。通过使用 Windows 资源管理器右键单击该文件并选择“属性”来检查该文件。如果有一个*取消阻止*按钮，那就是问题所在。将下载文件的位置添加到受信任位置列表中。

或者，您可以使用 PowerShell 取消阻止文件

[使用 PowerShell 取消阻止文件？](https://stackoverflow.com/questions/1617509/unblock-a-file-with-powershell)

# php - 在 PHP 中回显一个复杂的表单数组

> ID：12099977
> 
> 赞同：0
> 
> 时间：2012-08-23T21:07:04.150
> 
> 标签：php, html, arrays, forms

我需要结合一些 php 和 html 技巧来使表单的典型选择选项段为每个表单保存多个值。产品的 id、标记的 id 和标记的“名称”。这允许管理用户根据利润率选择产品价格。提交表单会为选择中的三个值生成空白值。

```
<?php

    $factor_grab = "
    SELECT * FROM product_latest_price_factor AS t1
    WHERE product_id = '".$product_id."'";
    //echo $factor_grab.'<br>';
    $factor_result = mysql_query($factor_grab) or die (mysql_error());
    while($frow=mysql_fetch_array($factor_result))
    {
        $level = $frow['level'];
        $percentage = $frow['percentage'];
        $value = $frow['value'];
        $price_level_id = $frow['price_level_id'];

//This piece does not work
        echo '<option value="{level:\''.$level.'\', price_level_id:\''.$price_level_id.'\', percentage:\''.$percentage.'\'}">'.$level.' - %'.number_format($percentage,2).' - $'.$value.'</option>';

    }
      ?> 
```

我以为这次我成功了，因为我可以看到表格中的值，并通过使用 Google Chrome 检查选项，但我认为这是因为我的报价失控了。您可以看到每个选项值应该存储三个变量。级别、Price_level 和 Price_level_id。（价值只是为了让用户明确地看到最终的价格是多少。）我如何回应一个适用于所有三个选项的选项？这对我来说将是一个非常强大的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:14:03.360

正确逃避事情，避免问题：

```
echo '<option value="', 
    htmlspecialchars(
        json_encode(
            array(
                'level'=>$level,
                'price_level_id'=>$price_level_id,
                'percentage'=>$percentage
            )
        )
    ),
    '">',
    htmlspecialchars($level . ' - %' . number_format($percentage,2)),
    htmlspecialchars(' - $' . $value),
    '</option>'; 
```

这很混乱......只是想在这里向您展示这个想法。你应该把这些东西清理一下。最好只在该选项值中保留一个 ID，并将这些其他内容从 JavaScript 数组或对象中或以后保留的任何位置中提取出来。

此外，请确保您正在转义查询中的数据。就目前而言，您可能会受到 SQL 注入的影响。学习使用 PDO 和准备好的查询来避免这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:15:48.710

您如何检索这些值？你在用`json_decode`吗？因为如果你是，那么你首先需要确保你的 JSON 是有效的。尝试这个：

```
echo '<option value="'.htmlspecialchars(json_encode(compact("level","price_level_id","percentage"))).'">'.$level.' - %'.number_format($percentage,2).' - $'.$value.'</option>'; 
```

然后用于`json_decode`将值放入数组中。

# java - 我可以使用 java.awt.FileDialog 只允许用户选择文件夹吗

> ID：12099980
> 
> 赞同：2
> 
> 时间：2012-08-23T21:07:25.883
> 
> 标签：java, macos, awt, jfilechooser

我正在尝试使用 FileDialog 而不是 JFileChooser 在 OSX 上获得更自然的行为，特别重要的是收藏列，其中包含指向使用 JFileChooser 隐藏在 /Volumes 下的共享文件夹的清晰链接。

我正在使用 Java 7，因此我没有使用 Quaqua JFileChooser，因为它已经有一年没有更新了，而且我不确定它是否与 Oracles Java 7 兼容。

但是我遇到了一个问题，有没有办法让 FileDialog 只允许打开一个文件夹而不是一个文件，我设置了一个文件名过滤器，但它似乎没有效果，也没有

```
.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY); 
```

就像 JFileChooser 一样。

```
public void actionPerformed(ActionEvent e)
{
    FileDialog chooser = new FileDialog(SongKong.mainWindow.frame);
    chooser.setFilenameFilter(new FolderFilter());
    chooser.setMode(FileDialog.LOAD);
    chooser.setVisible(true);
    String folderSelected = chooser.getDirectory();
    File folder = new File(folderSelected) ;
    if(folder.exists() && folder.isDirectory())
    {
        //Do something with selected folder
    }
}

class FolderFilter implements FilenameFilter
{
    public boolean accept(File dir, String name)
    {
        return new File(dir,name).isDirectory();
    }
} 
```

（顺便说一句，也尝试了 WINdows 7 上的代码，但即使是本机对话框，它仍然看起来像 Windows XP 对话框，怎么会？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:15:17.430

至于您的第一个问题，请查看我评论中的链接

至于第二个，我建议归结为他们链接到哪些库以提供功能。仅仅因为操作系统已更新并不意味着旧库已被删除。为了保持与旧版本应用程序的兼容性，这些库通常会维护一段时间。

你可以看看[xFileDialog](http://code.google.com/p/xfiledialog/)（通过这篇文章[Alternative to JFileChooser](https://stackoverflow.com/questions/759376/alternative-to-jfilechooser)）

# java - Android SMS 应用程序在单击按钮时意外地从消息应用程序调用默认的“新消息”布局

> ID：12099986
> 
> 赞同：0
> 
> 时间：2012-08-23T21:08:05.070
> 
> 标签：java, android, xml, sms, android-activity

制作一个短信应用程序，到目前为止进展顺利，但昨晚在尝试实施新活动后遇到了问题。

当我单击布局上的“发送”按钮时，它会发送 SMS，并触发 Toast 通知我已发送 SMS。直到我尝试将 onClick 属性添加到 XML 导致开始新活动的意图之前，这一直运行良好......这就是开始发生的时候：

它没有启动我创建的新活动，而是将我发送到手机随附的默认“消息”应用程序的“新消息”布局/活动。我不明白这一点，所以拿走了（除非我一遍又一遍地错过了一些东西）我在工作时所做的一切改变。

YET：当我单击此按钮时，它仍在将我发送到那个新消息活动......

有人可以告诉我在我的代码中我告诉应用程序启动该活动的位置吗？谢谢！

文本活动.java

```
import android.app.Activity;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.ContactsContract.Contacts;
import android.provider.ContactsContract.CommonDataKinds.Phone;
import android.telephony.SmsManager;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

public class TextActivity extends Activity {

Button buttonSend;
EditText textPhoneNo;
EditText textSMS;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.text_field);

    buttonSend = (Button) findViewById(R.id.bSendText);
    textPhoneNo = (EditText) findViewById(R.id.etPhoneNumber);
    textSMS = (EditText) findViewById(R.id.etTypeMessage);

    buttonSend.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {

            String phoneNo = textPhoneNo.getText().toString();
            String sms = textSMS.getText().toString();

            Intent sendIntent = new Intent(Intent.ACTION_VIEW);
            sendIntent.putExtra("SMS Body", sms);
            sendIntent.setType("vnd.android-dir/mms-sms");
            startActivity(sendIntent);

            try {
                SmsManager smsManager = SmsManager.getDefault();
                smsManager.sendTextMessage(phoneNo, null, sms, null, null);
                Toast.makeText(getApplicationContext(), "SMS Sent!",
                        Toast.LENGTH_LONG).show();

            } catch (Exception e) {
                Toast.makeText(getApplicationContext(),
                        "SMS failed, please try again later!",
                        Toast.LENGTH_LONG).show();
                e.printStackTrace();
            }
        }
    });
}

// STARTING The Contact Selection Process
private static final int CONTACT_PICKER_RESULT = 1001;

// References the Select Contact Button with onClick="clickHandle"
public void clickHandle(View view) {
    Intent contactPickerIntent = new Intent(Intent.ACTION_PICK,
            Contacts.CONTENT_URI);
    startActivityForResult(contactPickerIntent, CONTACT_PICKER_RESULT);
}

// Interpreting the results from the Contact_picker
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (resultCode == RESULT_OK) {
        switch (requestCode) {
        case CONTACT_PICKER_RESULT:
            Cursor cursor = null;
            String phone = "";
            String name = "";
            try {
                Uri result = data.getData();

                // get the contact id from the Uri
                String id = result.getLastPathSegment();

                // query for everything phone
                cursor = getContentResolver().query(Phone.CONTENT_URI,
                        null, Phone.CONTACT_ID + "=?", new String[] { id },
                        null);

                int phoneIdx = cursor.getColumnIndex(Phone.DATA);
                int nameIdx = cursor.getColumnIndex(Phone.DISPLAY_NAME);

                // let's just get the first phone
                if (cursor.moveToFirst()) {
                    phone = cursor.getString(phoneIdx);
                    name = cursor.getString(nameIdx);

                } else {

                }
            } catch (Exception e) {

            } finally {
                if (cursor != null) {
                    cursor.close();
                }
                EditText phoneEntry = (EditText) findViewById(R.id.etPhoneNumber);
                phoneEntry.setText(phone);

                TextView nameEntry = (TextView) findViewById(R.id.tvContactSelected);
                nameEntry.setText(name);

                if (phone.length() == 0) {
                    Toast.makeText(this, "No phone found for contact.",
                            Toast.LENGTH_LONG).show();
                }
            }
            break;
        }

    } else {

    }
}
} 
```

我的 XML，text_field.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:background="@color/burntorange" >

    <Button
        android:id="@+id/bSelectContact"
        android:layout_width="50dp"
        android:layout_height="45dp"
        android:layout_gravity="center"
        android:layout_margin="4dp"
        android:background="@color/gray"
        android:inputType="phone"
        android:onClick="clickHandle"
        android:text="+"
        android:textColor="@color/white"
        android:textSize="35dp" />

    <TextView
        android:id="@+id/tvContactSelected"
        android:layout_width="290dp"
        android:layout_height="45dp"
        android:layout_gravity="top"
        android:layout_margin="4dp"
        android:background="@color/gray"
        android:gravity="center"
        android:padding="10dp"
        android:text="No Contact Selected"
        android:textSize="20dp" />
</LinearLayout>

<EditText
    android:id="@+id/etPhoneNumber"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginTop="2dp"
    android:gravity="center"
    android:hint="Person&apos;s Phone Number"
    android:padding="10dp" >
</EditText>

<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/linLayout"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_margin="1dp"
        android:background="@color/burntorange"
        android:descendantFocusability="beforeDescendants"
        android:focusable="true"
        android:focusableInTouchMode="true"
        android:gravity="center"
        android:orientation="horizontal"
        android:padding="1dp" >

        <ScrollView
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/svEnterMessage"
            android:layout_width="269dp"
            android:layout_height="wrap_content"
            android:paddingBottom="4dp" >

            <EditText
                android:id="@+id/etTypeMessage"
                android:layout_width="260dp"
                android:layout_height="wrap_content"
                android:layout_marginBottom="2dp"
                android:layout_marginRight="4dp"
                android:layout_marginTop="4dp"
                android:background="@drawable/outline"
                android:hint="Type Message Here"
                android:minHeight="35dp"
                android:padding="6dp"
                android:textColor="@color/white"
                android:inputType="textMultiLine" >"
            </EditText>
        </ScrollView>

        <Button
            android:id="@+id/bSendText"
            android:layout_width="75dp"
            android:layout_height="36dp"
            android:layout_marginBottom="2dp"
            android:layout_marginLeft="2dp"
            android:background="@color/gray"
            android:text="Send"
            android:layout_gravity="bottom"
            android:textColor="@color/white" />

    </LinearLayout>

  </RelativeLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:19:51.383

> 有人可以告诉我在我的代码中我告诉应用程序启动该活动的位置吗？

这看起来像是启动了默认的消息传递应用程序：

```
Intent sendIntent = new Intent(Intent.ACTION_VIEW);
sendIntent.putExtra("SMS Body", sms);
sendIntent.setType("vnd.android-dir/mms-sms");
startActivity(sendIntent); 
```

如果您不想加载默认应用程序，您想在这里做什么？

# c++ - 打印指针值

> ID：12099989
> 
> 赞同：1
> 
> 时间：2012-08-23T21:08:48.300
> 
> 标签：c++, pointers

我编写了以下程序来了解将整数值添加到指针值。在我的例子中，指针指向整数。我知道如果 p 是一个指向整数的指针，那么 p+2 是存储“前面两个整数”的整数的地址（或 2*4 字节 = 8 字节）。下面的程序按我对整数数组的预期工作，但对于 char 数组，它只打印空行。有人可以向我解释为什么吗？

```
#include <iostream>

int main() {

    int* v = new int[10];

    std::cout << "addresses of ints:" << std::endl;

    // works as expected
    for (size_t i = 0; i < 10; i++) {
        std::cout << v+i << std::endl;
    }

    char* u = new char[10];

    std::cout << "addresses of chars:" << std::endl;

    // prints a bunch of empty lines
    for (size_t i = 0; i < 10; i++) {
        std::cout << u+i << std::endl;
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T21:10:01.530

这是因为`char *`具有特殊意义（C 字符串），所以它尝试将其打印为字符串。投射指针以`cout`告知您想要什么：

```
std::cout << (void *)(u+i) << std::endl; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:11:42.130

当您打印 a 时，`char*`您正在打印字符串。所以，你得到垃圾值。您可以将其转换为 int 以打印它。

```
std::cout << (int)(u+i) << std::endl; 
```

**从评论**编辑：****

 **正如已经指出的那样，`void*`演员阵容更好。用于打印`int`的 AFAIK 很好，但`void*`它是正确的方法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T21:14:23.577

当我将指针值转换为 long long 时，它对我有用。

```
 std::cout << (long long)(u+i) << std::endl; 
```

如果您有大内存（> 2 GB），您应该使用 long long 而不是 int**

# c - 非线程安全性会增加乘以进位伪随机数生成器的随机性吗？

> ID：12099992
> 
> 赞同：2
> 
> 时间：2012-08-23T21:08:57.987
> 
> 标签：c, algorithm, random

我正在阅读[本节](http://en.wikipedia.org/wiki/Random_number_generation#Computational_methods)，最后一段指出示例代码不是线程安全的。我的问题是：这不会有助于增加它的随机性（即如果多个线程要同时执行这些行）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T21:16:22.407

PRNG 是经过精心设计的（好吧，也许不是 RANDU），以产生可预测且足够随机分布的结果。它们不必是真正随机的，它们只需要满足统计质量测试，产生足够大的周期并且对相同的种子具有确定性。

如果您碰巧同时从多个线程使用生成器，那么所有这些保证都会付诸东流。最重要的是，您无法获得可重现的结果（这在模拟中极为重要）。然后状态可能会改变，或者你可能在不同的线程中两次获得相同的数字，那些事情。

你绝对不想去那里。每个线程创建一个 PRNG（最好使用线性独立的种子）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T21:17:07.673

非线程安全随机数生成器的一个可能副作用是您可以以某种方式破坏内部状态。例如，如果您`Random`从两个不同的线程访问同一个 .NET 实例，则可以将其置于不断重复返回 0 的状态。

在您链接的 RNG 中，看起来不会发生特定问题，但某些退化的并发访问模式可能会设置`m_z`或设置`m_w`为 0，根据评论，这也很糟糕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T22:48:04.560

代码有多种方式是非线程安全的。

一种方法是线程无法看到其他线程对内存的写入。

然后我们可能会发现生成全零的随机数，因为它永远不会“看到”其他线程所做的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T22:45:13.363

您绝对可以从线程计时生成中获得熵，但是将熵收集和伪随机数生成混合在一起是一个非常糟糕的主意，因为前者可能会干扰后者的其他可证明的特性——就像 Joey 所说的那样。我添加新答案的原因是您可能会考虑将真实熵与您的 PRNG 混合（作为种子，或定期引入更多），并从不同线程收集真实时间信息是熵的一种可能来源。然而，它应该严格地完成（使用适当的锁定或无锁原子操作来存储结果），而不是通过调用未定义的行为并希望得到熵。

# mysql - 如何将索引从一个相同的表复制到另一个现有的相同表

> ID：12099997
> 
> 赞同：4
> 
> 时间：2012-08-23T21:09:37.433
> 
> 标签：mysql, indexing, copy, structure

我有 250 个左右的表 (mysql)，它们都共享完全相同的结构，除了索引。其中一个表具有所有正确、当前和最新的索引，我想将该索引结构传播到其他 249 个表。

我发现搜索的所有内容都是关于复制具有其内容和索引结构的表，我不想这样做（每个表中的数据不同，只有结构相同），或者创建一个具有相同内容的新表结构，我也不想这样做。

我希望有一种方法可以使用 ALTER TABLE 告诉 mysql 模仿正确表的表结构并将其应用于另一个表，优化表，然后通过 php 脚本运行这些命令以应用于所有 249 个表，但我不知道是否有一个 ALTER TABLE 命令可以做到这一点。

有小费吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T21:17:19.527

在“好”表上运行`SHOW CREATE TABLE [table_name]`。复制索引行并在脚本中使用它们`ALTER TABLE CREATE INDEX`为每个其他表运行等效项。

如果您希望整个事情完全自动化，则必须从`SHOW INDEXES`or`SHOW CREATE TABLE`调用中解析索引定义。但我假设你只需要运行一次，因为这是一个奇怪的情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-05-07T22:57:28.287

您可以使用`CREATE TABLE LIKE`命令创建具有正确结构+索引但没有数据的新表，然后`INSERT`使用语句复制旧数据。

例如，假设我们有`users_master`作为具有正确索引的表，并且我们想为表提供正确的索引`users_n`。我们可以这样做：

```
CREATE TABLE users_n_indexed LIKE users_master;
INSERT users_n_indexed SELECT * FROM users_n;
DROP TABLE users_n;
RENAME TABLE users_n_indexed users_n; 
```

当然，在运行任何 DROP 语句之前创建备份。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-22T06:28:26.607

杰里米的回答很好。以防万一你的mysql抱怨，

```
CREATE TABLE users_n_indexed LIKE users_master;
INSERT users_n_indexed SELECT * FROM users_master;
DROP TABLE users_n;
RENAME TABLE users_n_indexed TO users_n; 
```

您需要将 TO 添加到 REMOVE TABLE 语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-03T12:13:27.170

我花了一些时间为此创造了一些东西。我的要求最后发生了变化，所以我不能很好地测试它。但我相信这不会有太大变化。我不喜欢编辑“SHOW CREATE”的输出——太脏了。所以我转而使用“SHOW INDEX”创建的数据库字段：

```
$res = mysqli_query($conn,"SHOW INDEX FROM tableA");
$indexes = array();
$nonuniques = array();
while($row = mysqli_fetch_assoc($res))
{ if(!isset($indexes[$row['Key_name']]))
    $indexes[$row['Key_name']] = array();
  $indexes[$row['Key_name']][] = $row['Column_name'];
  $nonuniques[$row['Key_name']] = $row['Non_unique'];
}
foreach($indexes AS $index => $fields)
{ $prefix = "";
  $indexname = "`".$index."`";
  if($index == "PRIMARY")
  { $indexname = "";
    $prefix = "PRIMARY";
  }
  else if($nonuniques[$index] == 0)
    $prefix = "UNIQUE";
  mysqli_query($conn,"ALTER TABLE tableB ADD ".$prefix." INDEX ".$indexname." ("`".implode("`,`", $fields)."`");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-11T13:59:47.487

这是旧帖子，但我想我可以帮助别人。你可以这样做：

```
SELECT concat("ALTER TABLE ",trim(TABLE_NAME)),group_concat(IF(INDEX_NAME="PRIMARY", 
"ADD PRIMARY KEY "," ADD INDEX `"),INDEX_NAME,"` (`",column_name,"` ASC) "), ";" 
FROM INFORMATION_SCHEMA.STATISTICS WHERE TABLE_SCHEMA = 'SCHEMA' and table_name like "TABLE_NAME%" 
and seq_in_index=1 group by table_name;` 
```

或者将索引复制到一个表到具有相同字段的其他表：

```
SELECT concat("ALTER TABLE ",trim(b.TABLE_NAME)),
group_concat(IF(a.INDEX_NAME="PRIMARY","ADD PRIMARY KEY "," ADD INDEX `"),
a.INDEX_NAME,"` (`",a.column_name,"` ASC) "), ";" FROM INFORMATION_SCHEMA.STATISTICS a 
join INFORMATION_SCHEMA.STATISTICS b  WHERE a.TABLE_SCHEMA = 'SCHEMA' and  
a.table_name ="INDEX_TABLE" and b.table_name like "TABLES_TO_INDEX%" and 
a.seq_in_index=1 group by b.table_name; 
```

然后复制粘贴到查询窗口。