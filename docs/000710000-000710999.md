# StackOverflow 问答 000710000-000710999

# c# - 以编程方式确定是否安装了 COM 库 (.DLL)

> ID：710000
> 
> 赞同：6
> 
> 时间：2009-04-02T14:46:29.617
> 
> 标签：c#, com, dll, installation

C# 中是否有一种编程方式来确定是否已安装特定的 COM DLL？或者这是扫描注册表以获取 classId 的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T14:51:07.033

我通常所做的（如果我再次需要，也会这样做）是尝试创建一个您知道在 COM 库中的类的对象实例 - 通过 ProgID 或 GUID - 并检查失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T14:52:27.310

尝试创建它，如果没有则处理错误。

在 Win32 下，如果未安装`CoCreateInstance`将返回`REGDB_E_CLASSNOTREG`（包括 IIRC，如果已注册但实现它的 dll/exe 将被删除）。

在 .NET 下生成的 COM 互操作程序集会抛出一些错误（需要检查这一点，没有方便的代码来测试哪种异常类型）。笔记。如果缺少互操作程序集，则将被视为缺少程序集，可能导致应用程序加载错误。

# asp-classic - Strange caching with #include in ASP.NET on IIS6

> ID：710014
> 
> 赞同：0
> 
> 时间：2009-04-02T14:49:42.887
> 
> 标签：asp-classic, iis-6, asp.net-3.5

I have a classic ASP style #include from a ASP.NET file as: (!-- #include file= "../../maininc.aspxinc" --)

(Guess it is actually an IIS server-side include?)

It is some strange caching going on. It seems like the original file is cached so that changes in maininc.aspxinc has no effect.

1.  IIS6
2.  Expiration headers off as far as i can see
3.  Asp.NET 3.5 (plain, not Web Form).

What is going on? What can i do? Should a dynamic type be different? (I know that in ASP.NET this would normally be a control :-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T18:52:28.863

Consider using a Web Server control instead of an #include. See [http://msdn.microsoft.com/en-us/library/3207d0e3.aspx](http://msdn.microsoft.com/en-us/library/3207d0e3.aspx)

There isn't any strange caching going on but there is compilation going on. A page is only compiled once when it is first accessed and the resulting assembly is stored in temporary folder. Subsquent requests for the same page are simply passed to the HttpHandler in the assembly.

If you modify the page then ASP.NET detects that the existing assembly no longer matches and rebuilds. I strongly suspect the #includes are not taken into account in this mechanism.

You would be better off with one of:-

*   a UserControl (an file with then .ascx extension) if the include represents a set of HTML controls.
*   Use a master page if the include is for common navigation markup for use by many pages
*   A source code file (.vb or .cs) in the App_Code if you want to include some common classes.
*   A separate library project that builds a dll for the bin folder.

# .net - 从 ASP.NET 切换到面包和黄油 HTML/jQuery 的优势

> ID：710016
> 
> 赞同：7
> 
> 时间：2009-04-02T14:50:00.810
> 
> 标签：.net, asp.net, jquery, web-services

我越来越厌倦关于控件 ID 的所有怪癖，试图在服务器端获取您的数据（基于客户端事件）。我似乎花更多的时间与 asp.net 中的控件作斗争，我认为这花费的时间比使用它获得的时间要多。

我正在考虑将纯 html/javascript 与 jQuery 和一个返回 json 数据的 Web 服务一起使用。

我认为我会从 webforms 中错过的唯一一件事是 MasterPages、会话管理、基于 Windows 登录的身份验证以及可能的验证器（尽管它们也有一些怪癖）。（其实可能不针对session和auth，但是我从来没有开发过webservices）

*   我思考这个问题的方式有什么问题，或者我没有想到什么？
*   asp.net 中是否有您认为我会想念的东西？
*   有没有人这样做过并想分享经验？

另请注意，我只有 Framework 2.0 可用于开发。

* * *

**编辑：**在 asp.net 中给我带来麻烦的事情让我想知道切换：

这是一个给我带来问题的页面示例。

有一个树表（master/details）

您可以编辑每个子行上的字段。

当您按下保存按钮时，必须更新组行中的数据（只是选择中的数据，数据库中没有修改），作为子行中的数据。

我不想刷新整个页面，因为显示的记录是基于搜索条件的。

主/详细信息是使用中继器生成的

尝试从后面的代码更新记录真的很古怪，而且仍然不知道更新显示。

使用 jQuery 和 Web 服务，我的猜测是我可以直接更新到数据库，请求我想要显示的内容，然后更新该记录。这就是让我想知道 asp.net 是否妨碍我的事情。

```
 ________________________________________________________________________
| - 关于集团的一些细节|
|________________________________________________________________________|
    |¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ˉ ¯¯¯¯¯¯|
    | ChildRecord 一些可编辑的字段
    | ChildRecord 一些可编辑的字段
    | ChildRecord 一些可编辑的字段
    | ChildRecord 一些可编辑的字段
    |_______________________________________________________|
 ________________________________________________________________________
| + 关于集团的一些细节 |
|________________________________________________________________________|
 ________________________________________________________________________
| + 关于集团的一些细节 |
|________________________________________________________________________|

```

* * *

**Edit2：** 我对 ASP.NET 的问题与 ajax 无关。是的，我使用 jQuery 使界面更加动态，例如在不需要时显示/隐藏搜索部分并从树中折叠细节，但这就是我所做的一切。

困扰我的是，如果我想检查在这个例子中点击了哪个按钮，我不得不使用一些感觉有点笨拙的技巧。

如果要在转发器中使用数据绑定组合框，则必须使用代码隐藏来设置选定的值，检索选定的数据会很痛苦。

接下来，如果要检查修改了哪些数据，则必须将数据表保存在视图状态中，从转发器中的所有控件中读取数据，然后与数据表进行比较以进行更新。这是用asp.net困扰我的这类事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T15:38:04.417

如果使用得当，ASP.NET 和 JavaScript/jQuery Web 应用程序真的可以相互补充。我现在已经在 3 个不同的 Web 应用程序中实现了 jQuery，并且喜欢它的每一分钟。只要您充分利用每个组件，您最终会对项目感到满意。

您特别提到控制 ID 引起了问题，但实际上并没有那么大的问题。

**JavaScript**

```
document.getElementById("<%=this.MyObject.ClientID %>"); 
```

**jQuery**

```
$("#<%=this.MyObject.ClientID %>").... 
```

在您的父子关系示例中，您可以非常轻松地准确处理您使用 ASP.NET 讨论的内容以及使用 UpdatePanels 讨论的 AJAX 框架。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-02T15:23:59.927

您不必放弃一切，例如 MasterPages。您可以尝试关闭 ViewState，关闭 EventValidation 并尽可能少地使用 ASP.NET 控件（基本上 - 如果使用 XHTML 可以轻松实现某些功能，请将其编写为 XHTML）。您仍然可以在需要的地方使用 ASP.NET 控件。

我认为你并不孤单。在使用了两年的 WebForms 之后，我也厌倦了它们，在我发现 jQuery 有多棒以及它与 Web 服务的配合有多好之后，我极大地改变了我的开发模型。我现在正在慢慢转向 MVC，因为我发现它是最终的解决方案，但是对于其他一些应用程序（小型和/或针对 2.0），我只是尝试使用更少的服务器控件，摆脱 ViewState，使用更多的 AJAX（网络服务）。它工作正常。我推荐 Dave Ward 的[Encosia](http://encosia.com/) - 从[这篇文章](http://encosia.com/2008/05/29/using-jquery-to-directly-call-aspnet-ajax-page-methods/)开始。我承认它让我看到了使用 .NET Framework 开发 Web 应用程序的其他一些方法。祝你好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-02T15:06:07.107

我认为要问自己的基本问题是：

```
我是否将控件用于它们的设计目的？
```

在 2.0 框架中单独使用 ASP.NET，我发现我不必处理您所描述的问题。是的，ASP.NET 可能很古怪，但主要是当您将它用于其他目的时。在这种情况下，自定义滚动控件很容易填补利基市场。

**编辑：**

您的麻烦听起来像是您正在尝试实现 AJAX 技术，但是在您的问题中您没有提到使用[AJAX 框架](http://www.asp.net/ajax/)。看看它，因为它可能能够填补你的利基。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T15:24:20.347

在 JavaScript/JQuery 中创建表也不是最优雅的代码。所以我会想念Repeater控件。

此外，还有针对 ClientId 问题的解决方法。

我的页面中有很多代码，如下所示：

var myTextBoxId = '<%=MyTextBox.ClientID %>';

如果有一堆控件，我需要客户端 ID，因为我会将它们放在一个对象中

var myControlIds = { MyTextBoxID: '<%=MyTextBox.ClientID %>' };

另一种解决方法是将特定的 css 类放在您的控件或自定义属性名称/值上。

所以你的文本框可能是：

我的最后一个技巧是使用“Ends With”属性查找器。

所以你的 JQuery，而不是

$("#MyTextBox") // 由于客户端 id 损坏而无法工作

改为： $("[id $=MyTextBox]")

这将搜索所有控件的 'id' 属性以找到一个以“MyTextBox”结尾的值

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T15:31:15.883

这可能是一种范式转变，但是如果您正在寻找更多的“面包和黄油”并且在没有 asp.net 服务器控件的情况下工作起来很舒服，那么[Monorail](http://www.castleproject.org/MonoRail/)可能只是您的一个不错的选择。它允许你在寻找你想要的东西，同时重量更轻，也是一个基于 MVC 的架构。如果不是因为您的 .net 2.0 限制，我会推荐 asp.net mvc。由于您受到限制，[单轨列车](http://www.castleproject.org/MonoRail/)可能只是一个可行的选择。

# .net - Handle .net exceptions at application level

> ID：710021
> 
> 赞同：2
> 
> 时间：2009-04-02T14:50:56.610
> 
> 标签：.net, vb.net, exception

I was reading a couple of articles a while back which I think described a behaviour where you can, in a .net application (specifically VB.net), allow an exception to occur, and then handle it in some kind of application-level exception handler, as opposed to within a Try/Catch block. My google-fu is weak at the moment, so I'm not having much luck guessing what this feature is called in order to find information about it.

If this rings a bell for any of you, can you point me in the right direction on what exactly the feature is called so that I can search for it?

Sample code is always welcome, of course, but this is mostly just a case of me forgetting the name of the feature and being unable to search for it.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T14:55:04.277

I believe you are looking for the AppDomain.UnhandledException event. This will allow you to handle any exception that is unhandled in the AppDomain of your choice. Most applications only have a single AppDomain so this code should do the trick

```
AddHandler AppDomain.CurrentDomain.UnhandledException, AddressOf MyHandler 
```

However, actually attempting to handle the event here is not the best idea. This will fire for any exception thrown from any part of the code. This could very easily be an exception that is fatal to some component you depend on and handling it could lead to further, worse errors down the road.

I usually use this event purely logging and error reporting scenarios.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T15:04:20.573

This link [http://msdn.microsoft.com/en-us/library/3a02k5s0(VS.80).aspx](http://msdn.microsoft.com/en-us/library/3a02k5s0(VS.80).aspx) will show you how to add the handler. I agree that it is not a good idea to handle exceptions this way. IMHO it is the handler of last resort.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-05T16:19:42.327

Jeff Atwood wrote a great CodeProject article entitled 'User Friendly Exception Handling' [http://www.codeproject.com/KB/exception/ExceptionHandling.aspx](http://www.codeproject.com/KB/exception/ExceptionHandling.aspx) which I found really useful as the basis for building a custom handler of last resort. It's in VB.Net but has a C# translation in the comments.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T14:58:21.447

For web applications you can handle it in the Global.asax.cs in the Application_Error method. Here's our code:

```
protected void Application_Error(object sender, EventArgs e)
    {
        Exception ex = HttpContext.Current.Server.GetLastError();

        if (ex is HttpUnhandledException && ex.InnerException != null)
            ex = ex.InnerException;

        SendErrorMail(ex);  //Or log in database or whatever you want to do with it
    } 
```

# java - mysql监控管理

> ID：710022
> 
> 赞同：0
> 
> 时间：2009-04-02T14:51:01.477
> 
> 标签：java

我想用 jmx 监控和管理 mysql 数据库服务器。当我点击谷歌时，它显示连接器/mxj。我得到它并执行 MysqldHtmlAdaptor 文件。它显示 mysql 服务器变量。但我不能将该实例铆接到其他服务器上运行的原始 mysql 服务器。

请帮忙。

有没有关于 mysql 的 JMX 的好教程...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T14:56:59.373

MySQL 服务器本身不支持 JMX，因此您需要自己编写一些东西来充当 JMX 和 MySQL 管理工具之间的桥梁；[MySQL 服务器状态变量](http://dev.mysql.com/doc/refman/6.0/en/server-status-variables.html)可能是一个不错的起点。

# c# - 什么时候是使用 C# 类库 (.dll) 的合适时机？

> ID：710027
> 
> 赞同：17
> 
> 时间：2009-04-02T14:51:56.000
> 
> 标签：c#, class, dll, class-library

我是一个从未真正使用过 .dll 文件的程序员。当然，当我需要 3rd 方软件时，例如图形库、帮助我创建图形的库等。我确实将引用/ddl 文件添加到我的程序中并在我的代码中使用它们。

此外，您似乎可以将 .dll 用于许多不同的事情，因此我希望将主题集中在 C# 上。

现在我正在开发一个清理库（？）（我认为这是正确的术语），其中充满了可以以各种不同方式清理变量的相关方法。

**我想知道的是：**

有什么好处：

**1）**将方法写入类库->编译/构建它->将库添加为程序的引用-这需要清理一些变量吗？

或者如果我在哪里：

**2）**在程序中创建一个新的SanitizeClass -> 添加所有的sanitize方法 -> 在程序中需要清理变量的不同类中调用SanitizeClass中的方法

一般来说，我也想知道什么时候使用已编译的类库是一个优势。我正在考虑速度，安全性，所有这些。

任何人都可以启发我吗？:)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-02T14:55:45.960

关键问题是：多个应用程序使用该类型是否有意义？如果是这样，它应该在类库中。如果没有，您可能*仍*想将它放在类库中，只是为了分离（例如，在 n 层解决方案中每层有一个程序集），但您*可以*将它放在您的应用程序中。

如果您的清理是通用的，那么将其放入类库肯定是正确的举措。

我知道有人在可执行应用程序中几乎不编写任何代码，几乎*所有东西都*放在类库中——所以应用程序基本上只是包装类库。我自己不会走那么远...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T14:55:23.370

想到的第一个想法是可重用性。这个清理库是否会在您当前正在处理的应用程序之外使用？如果你是，那么你不想在将来引用一个 exe，因为你想构建一个 DLL 文件（甚至可能是强名称和 GAC 它），然后只是在将来引用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T14:56:49.030

当您想在多个程序之间共享代码时，使用库非常有用。

如果您认为您将需要您的类来清理多个程序中的数据，那么将它们放入库中是个好主意。

将应用程序的层放在不同的库中也是一个好主意（检查 n 层架构）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T14:57:24.880

额外的程序集会增加一点加载时间和内存开销，但不会影响性能。

仅当您需要不同的代码访问安全性 (CAS) 并使用 CAS 时，安全性才会有所作为。

一般有以下三个原因：

1.  它使事情变得更简单。将所有内容放在一个程序集中变得笨拙（这可能包括组织/团队问题）。

2.  重复使用。

3.  您需要单独的程序集。例如，在不同的程序集中拥有接口和实现，以允许卸载 AppDomains（例如插件）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T14:58:47.730

我认为最简单的方法是将 SanitizeLibrary 项目作为库类项目添加到您的解决方案中，并在您的应用程序中引用该项目。如果您发现它有用，您可以从当前项目中提取库并在其他项目中将其作为 dll 引用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T14:59:43.813

如果您要在不同的应用程序中重用此代码 - 即：这将是某种共享库 - 然后将其编译为 dll

reg 性能，请注意针对外部程序集执行的任何代码总是比在同一程序集中执行代码慢一点

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-20T05:47:30.623

**什么是类库？**

我们可以在所有 .Net 应用程序（C#.Net、Asp.net、Asp.net MVC）中创建类文件

在Java中它被称为包！...

在 .Net 中，我们将其称为 DLL（动态链接库）

如果您在应用程序中创建类，则只能在此应用程序中使用这些类，而不能在其他应用程序中使用它。

如果您创建了类库，您可以在所有应用程序中使用它。

**何时必须创建和使用 Class Lib？**

当我们在不同的应用程序中编写相同的代码时，我们可以创建类库并在所有应用程序中使用它。

例子 ：

如果您在多个应用程序中具有导出 excel 选项，您可以在类库中编写导出代码，您可以在多个应用程序中使用它。

**实时示例：**

**班级**就像房间里的垃圾箱，只有房间成员可以访问它。

**类库**就像一个公共场所（大学、火车站）的垃圾箱，任何人都可以访问和使用它。

# c# - LINQ to SQL 预加载条件

> ID：710029
> 
> 赞同：6
> 
> 时间：2009-04-02T14:52:19.527
> 
> 标签：c#, .net, linq-to-sql, eager-loading

我正在尝试学习 LINQ to SQL，并且我发现了 LoadWith 函数。我找到的所有示例都会从您在 LoadWith 函数中指定的表中加载所有记录，例如

```
var dlo = new DataLoadOptions();
dlo.LoadWith<Blog>(b => b.Posts);
this.LoadOptions = dlo; 
```

我想知道的是，在这个例子中是否可以只加载最后一篇博文？

我试过了

```
dlo.LoadWith<Blog>(b => b.Posts.Max()); 
```

但它不喜欢这种语法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T17:02:40.173

您可以使用 AssociateWith 来完成。这将起作用：

```
var options = new DataLoadOptions();
options.AssociateWith<Blog>(b => 
    b.Posts.Where(
        p1 => p1.SomeColumn == b.Posts.Max(p2 => p2\. SomeColumn)
    )); 
```

此外，如果您要将信息加载到单独的类中或可以使用匿名类，您可以将查询执行为：

```
var query = from b in context.Blogs
            //probably some where you already have
            select new MyBlogs // or with no type in case it is anonymous
            {
                AColumn = b.AColumn, //map any other values
                LatestPost = b.Posts.Where(
                      p1 => p1.SomeColumn == b.Posts.Max(p2 => p2\. SomeColumn)
                  )).ToList()
            } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T14:58:10.150

如果您只想要最后一篇文章，那么我怀疑使用延迟加载比以这种方式强制“急切”加载更有效地专门查询该帖子。

# objective-c - 这是什么 Objective-C 语法，椭圆样式的点表示法？“……”

> ID：710033
> 
> 赞同：18
> 
> 时间：2009-04-02T14:53:39.723
> 
> 标签：objective-c, cocoa, syntax

我在 Joe Hewitt 的 Three20 源代码中注意到了这一点，而且我以前从未在 Objective-C 中看到过这种特殊语法。甚至不确定如何在适当的 Google 搜索中引用它。

来自 TTTableViewDataSource：

```
+ (TTSectionedDataSource*)dataSourceWithObjects:(id)object,... { 
```

“......”是让我失望的原因。我假设它是一种枚举形式，可以提供可变数量的参数。如果是，该运营商的正式名称是什么？我在哪里可以参考它的文档？

非常感谢你。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-02T14:58:07.547

这是一种可变参数方法，这意味着它需要可变数量的参数。 [这个页面](http://developer.apple.com/qa/qa2005/qa1405.html)很好地演示了如何使用它：

```
#import <Cocoa/Cocoa.h>

@interface NSMutableArray (variadicMethodExample)

- (void) appendObjects:(id) firstObject, ...;  // This method takes a nil-terminated list of objects.

@end

@implementation NSMutableArray (variadicMethodExample)

- (void) appendObjects:(id) firstObject, ...
{
id eachObject;
va_list argumentList;
if (firstObject)                      // The first argument isn't part of the varargs list,
  {                                   // so we'll handle it separately.
  [self addObject: firstObject];
  va_start(argumentList, firstObject);          // Start scanning for arguments after firstObject.
  while (eachObject = va_arg(argumentList, id)) // As many times as we can get an argument of type "id"
    [self addObject: eachObject];               // that isn't nil, add it to self's contents.
  va_end(argumentList);
  }
} 
```

# .net - 如何从 WPF 中的另一个线程读取 textbox.Text 值？

> ID：710034
> 
> 赞同：10
> 
> 时间：2009-04-02T14:53:41.503
> 
> 标签：.net, wpf, multithreading

在我的 WPF 表单中，我有一个文本框。
当计时器经过时，需要获取文本框的内容。
经过的计时器在与 UI 不同的线程中工作。

这个问题有点双重：

*   从 GUI 线程跨线程读取值的最简单、最易读的方法是什么（我发现了几个，它们看起来太冗长了，不应该是真正基本的东西）？
*   我不能以非阻塞方式阅读文本吗？在这种情况下，我不关心线程安全。

**--EDIT--**
我使用了 Dispatcher，但是调用了比[John](https://stackoverflow.com/questions/710034/how-to-read-textbox-text-value-from-another-thread-in-wpf/710244#710244)更详细的调用：

```
originalTextBox.Dispatcher.Invoke(
    DispatcherPriority.Normal, 
    (ThreadStart) delegate{text=originalTextBox.Text;}
); 
```

不介意更简洁。访问文本属性应该是非常基本的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T15:32:52.930

Oisin 是对的，您需要查看[Dispatcher](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.aspx)。像这样的东西应该可以工作，并且不太冗长：

```
System.Windows.Application.Current.Dispatcher.Invoke(
DispatcherPriority.Normal,
(ThreadStart)delegate { text = MyTextBox.Text; }); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T15:50:07.680

您可以：

*   使用[`Dispatcher`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.aspx)来安排消息从后台线程在 UI 线程上执行。A [`DispatcherPriority`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherpriority.aspx)of`Send`将为您提供最快的响应。
*   使用 a[`DispatcherTimer`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx)在 UI 线程上定期执行消息。
*   使用`OneWayToSource`绑定将`Text`属性连接到背景组件上的属性。这样，您就不必做任何工作来获取属性值 - 它已经提供给您的组件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-07T09:20:47.527

我使用以下扩展方法来解决这个问题：

```
 public static string GetTextThreadSafely(this TextBoxBase source)
    {
        if (source.InvokeRequired)
        {
            var text = String.Empty;
            source.Invoke((Action)(() => { text = source.GetTextThreadSafely(); }));
            return text;
        }
        else
        {
            return source.Text;
        }
    } 
```

当然，这个方法必须添加到一个单独的静态类中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-16T21:00:20.900

刚好碰巧来到这里。不久前，我刚刚开始构建一个静态类，我可以将其添加到我的项目中，以便快速访问一些常见的控件属性。它随着时间的推移变得臃肿，但在隐藏大量调度程序代码的同时使事情变得非常容易。粗鲁但有效。可能会给你一些想法。我基本上可以做这样的事情：

```
string temp = SafeGuiWpf.GetText(originalTextBox); 
```

这是 SafeGuiWpf 最后的样子，如果您觉得它有帮助的话。（认为​​它适用于 NET 3 及更高版本，但已经有一段时间了）

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.ComponentModel;

public class SafeGuiWpf
{
    public static object GetTag(Control C)
    {
        if (C.Dispatcher.CheckAccess()) return C.Tag;
        else return C.Dispatcher.Invoke(new Func<Control, object>(GetTag), C);
    }
    public static string GetText(TextBox TB)
    {
        if (TB.Dispatcher.CheckAccess()) return TB.Text;
        else return (string)TB.Dispatcher.Invoke(new Func<TextBox,string>(GetText), TB);
    }
    public static string GetText(ComboBox TB)
    {
        if (TB.Dispatcher.CheckAccess()) return TB.Text;
        else return (string)TB.Dispatcher.Invoke(new Func<ComboBox,string>(GetText), TB);
    }

    public static string GetText(PasswordBox TB)
    {
        if (TB.Dispatcher.CheckAccess()) return TB.Password;
        else return (string)TB.Dispatcher.Invoke(new Func<PasswordBox, string>(GetText), TB);
    }

    public static void SetText(TextBlock TB, string Str)
    {
        if (TB.Dispatcher.CheckAccess()) TB.Text = Str;
        else TB.Dispatcher.Invoke(new Action<TextBlock,string>(SetText), TB, Str);
    }
    public static void SetText(TextBox TB, string Str)
    {
        if (TB.Dispatcher.CheckAccess()) TB.Text = Str;
        else TB.Dispatcher.Invoke(new Action<TextBox, string>(SetText), TB, Str);
    }
    public static void AppendText(TextBox TB, string Str)
    {
        if (TB.Dispatcher.CheckAccess())
        {
            TB.AppendText(Str);
            TB.ScrollToEnd(); // scroll to end?
        }
        else TB.Dispatcher.Invoke(new Action<TextBox, string>(AppendText), TB, Str);
    }
    public static bool? GetChecked(CheckBox Ck)
    {
        if (Ck.Dispatcher.CheckAccess()) return Ck.IsChecked;
        else return (bool?)Ck.Dispatcher.Invoke(new Func<CheckBox,bool?>(GetChecked), Ck);
    }
    public static void SetChecked(CheckBox Ck, bool? V)
    {
        if (Ck.Dispatcher.CheckAccess()) Ck.IsChecked = V;
        else Ck.Dispatcher.Invoke(new Action<CheckBox, bool?>(SetChecked), Ck, V);
    }
    public static bool GetChecked(MenuItem Ck)
    {
        if (Ck.Dispatcher.CheckAccess()) return Ck.IsChecked;
        else return (bool)Ck.Dispatcher.Invoke(new Func<MenuItem, bool>(GetChecked), Ck);
    }
    public static void SetChecked(MenuItem Ck, bool V)
    {
        if (Ck.Dispatcher.CheckAccess()) Ck.IsChecked = V;
        else Ck.Dispatcher.Invoke(new Action<MenuItem, bool>(SetChecked), Ck, V);
    }
    public static bool? GetChecked(RadioButton Ck)
    {
        if (Ck.Dispatcher.CheckAccess()) return Ck.IsChecked;
        else return (bool?)Ck.Dispatcher.Invoke(new Func<RadioButton, bool?>(GetChecked), Ck);
    }
    public static void SetChecked(RadioButton Ck, bool? V)
    {
        if (Ck.Dispatcher.CheckAccess()) Ck.IsChecked = V;
        else Ck.Dispatcher.Invoke(new Action<RadioButton, bool?>(SetChecked), Ck, V);
    }

    public static void SetVisible(UIElement Emt, Visibility V)
    {
        if (Emt.Dispatcher.CheckAccess()) Emt.Visibility = V;
        else Emt.Dispatcher.Invoke(new Action<UIElement, Visibility>(SetVisible), Emt, V);
    }
    public static Visibility GetVisible(UIElement Emt)
    {
        if (Emt.Dispatcher.CheckAccess()) return Emt.Visibility;
        else return (Visibility)Emt.Dispatcher.Invoke(new Func<UIElement, Visibility>(GetVisible), Emt);
    }
    public static bool GetEnabled(UIElement Emt)
    {
        if (Emt.Dispatcher.CheckAccess()) return Emt.IsEnabled;
        else return (bool)Emt.Dispatcher.Invoke(new Func<UIElement, bool>(GetEnabled), Emt);
    }
    public static void SetEnabled(UIElement Emt, bool V)
    {
        if (Emt.Dispatcher.CheckAccess()) Emt.IsEnabled = V;
        else Emt.Dispatcher.Invoke(new Action<UIElement, bool>(SetEnabled), Emt, V);
    }

    public static void SetSelectedItem(Selector Ic, object Selected)
    {
        if (Ic.Dispatcher.CheckAccess()) Ic.SelectedItem = Selected;
        else Ic.Dispatcher.Invoke(new Action<Selector, object>(SetSelectedItem), Ic, Selected);
    }
    public static object GetSelectedItem(Selector Ic)
    {
        if (Ic.Dispatcher.CheckAccess()) return Ic.SelectedItem;
        else return Ic.Dispatcher.Invoke(new Func<Selector, object>(GetSelectedItem), Ic);
    }
    public static int GetSelectedIndex(Selector Ic)
    {
        if (Ic.Dispatcher.CheckAccess()) return Ic.SelectedIndex;
        else return (int)Ic.Dispatcher.Invoke(new Func<Selector, int>(GetSelectedIndex), Ic);
    }

    delegate MessageBoxResult MsgBoxDelegate(Window owner, string text, string caption, MessageBoxButton button, MessageBoxImage icon);
    public static MessageBoxResult MsgBox(Window owner, string text, string caption, MessageBoxButton button, MessageBoxImage icon)
    {
        if (owner.Dispatcher.CheckAccess()) return MessageBox.Show(owner, text, caption, button, icon);
        else return (MessageBoxResult)owner.Dispatcher.Invoke(new MsgBoxDelegate(MsgBox), owner, text, caption, button, icon);
    }

    public static double GetRangeValue(RangeBase RngBse)
    {
        if (RngBse.Dispatcher.CheckAccess()) return RngBse.Value;
        else return (double)RngBse.Dispatcher.Invoke(new Func<RangeBase, double>(GetRangeValue), RngBse);
    }
    public static void SetRangeValue(RangeBase RngBse, double V)
    {
        if (RngBse.Dispatcher.CheckAccess()) RngBse.Value = V;
        else RngBse.Dispatcher.Invoke(new Action<RangeBase, double>(SetRangeValue), RngBse, V);
    }

    public static T CreateWindow<T>(Window Owner) where T : Window, new()
    {
        if (Owner.Dispatcher.CheckAccess())
        {
            var Win = new T(); // Window created on GUI thread
            Win.Owner = Owner;
            return Win;
        }
        else return (T)Owner.Dispatcher.Invoke(new Func<Window, T>(CreateWindow<T>), Owner);
    }

    public static bool? ShowDialog(Window Dialog)
    {
        if (Dialog.Dispatcher.CheckAccess()) return Dialog.ShowDialog();
        else return (bool?)Dialog.Dispatcher.Invoke(new Func<Window, bool?>(ShowDialog), Dialog);
    }

    public static void SetDialogResult(Window Dialog, bool? Result)
    {
        if (Dialog.Dispatcher.CheckAccess()) Dialog.DialogResult = Result;
        else Dialog.Dispatcher.Invoke(new Action<Window, bool?>(SetDialogResult), Dialog, Result);
    }

    public static Window GetWindowOwner(Window window)
    {
        if (window.Dispatcher.CheckAccess()) return window.Owner;
        else return (Window)window.Dispatcher.Invoke(new Func<Window, Window>(GetWindowOwner), window);
    }

} // END CLASS: SafeGuiWpf 
```

回想起来，如果我将这些作为类扩展来做，可能会让它们更加流畅。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T15:01:35.180

从与创建它的线程不同的线程中读取 GUI 对象的值没有“快速技巧”。WPF 只是不允许你做这一切。Windows 窗体偶尔会抱怨，但 WPF 更严格。

您需要了解 Dispatcher。它可能看起来很冗长，但实际上并不难理解。您将委托传递给调度程序，该委托指向您希望在 GUI 线程上调用的方法，它就会执行此操作。

这是一个很好的简单示例：

[http://www.switchonthecode.com/tutorials/working-with-the-wpf-dispatcher](http://www.switchonthecode.com/tutorials/working-with-the-wpf-dispatcher)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-03T22:04:42.597

另一个答案是使用 Jeff Wilcox 的 SmartDispatcher 类。

在构造函数或 Load 事件的某处执行 SmartDispatcher.Initialize() （设置 UI 调度程序）

然后在任何需要设置属性或调用方法的地方：

```
Action a = delegate { <statements> };
SmartDispatcher.BeginInvoke(a); 
```

这样做的好处是您不需要知道它是否在 UI 线程上（并且您可能需要从两者都这样做）。如有必要，SmartDispatcher 负责线程切换。

以上是异步的，但如果需要同步，只需添加另一个方法来调用Invoke，而不是BeginInvoke。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-05-16T12:54:44.600

由于问题没有指定 C#，我想为 VB.NET 展示一个简单的解决方案：

```
text = originalTextBox.Dispatcher.Invoke(Function() As String
    Return originalTextBox.Text
  End Function) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-09-27T14:56:39.383

我的解决方案... XAML：

```
<Window x:Class="WpfApplication1.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1" Height="300" Width="300">
<Grid>
    <TextBox Height="23" Margin="28,27,130,0" Name="textBox1" VerticalAlignment="Top" />
    <Button Height="23" HorizontalAlignment="Left" Margin="28,56,0,0" Name="button1" VerticalAlignment="Top" Width="75" Click="button1_Click">Button</Button>
    <TextBox Margin="34,85,12,54" Name="textBox2" />
</Grid> 
```

和cs文件：

```
public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        new System.Threading.Thread(this.Cuenta).Start();
    }

    private void Cuenta()
    {
        for (int i = 0; i < 100000; i++)
            this.SetValues(string.Format("Counting... {0} ", i));
    }

    private void SetValues(string str)
    {
        System.Windows.Application.Current.Dispatcher.Invoke(
            System.Windows.Threading.DispatcherPriority.Normal,
            (System.Threading.ThreadStart)delegate { textBox1.Text = str; });
    }

} 
```

第二个文本框用于线程运行时的类型测试

# sql-server-2005 - 复合外键问题

> ID：710038
> 
> 赞同：1
> 
> 时间：2009-04-02T14:54:22.203
> 
> 标签：sql-server-2005, entity-framework

我试图弄清楚是否可以以这种方式创建外键。

首先在这个场景中有两个父表。

表 1 有一个 PK int 和另一个 int 列。两者结合起来是独一无二的。

表 2 有一个 PK int 和另一个 int 列。两者结合起来是独一无二的。

两个整数之间的配对值是我们当前为任一表选择子记录的方式。

表 3 具有来自前两个表之一的 PK 和其他 int 列的值。它是可靠地可选择的，因为在搜索中使用的两个字段对于上述表格之一是唯一的。

所以我希望为这种情况创建一个 FK 或两个 FK。我希望能够从第一个表中的任何一个到第三个表中进行级联删除，并且还希望将其用于实体框架中的实体关系。

如果这没有意义，请告诉我。我已经读了好几遍了，它几乎是我所能理解的。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T15:05:16.217

如果我理解正确，您有 3 个表格，其结构如下：

```
TABLE_A:
    PK_FIELD int NOT NULL
    OTHER_FIELD int NOT NULL, NOT IN TABLE_B.OTHER_FIELD

TABLE_B:
    PK_FIELD int NOT NULL
    OTHER_FIELD int NOT NULL, NOT IN TABLE_A.OTHER_FIELD

TABLE_C:
    PK_FIELD int NOT NULL
    OTHER_FIELD int NOT NULL IN (TABLE_A.OTHER_FIELD OR TABLE_B.OTHER_FIELD 
```

您要做的是定义 TABLE_C 以便您可以在表之间级联更新和删除。由于`TABLE_A.OTHER_FIELD`和`TABLE_B.OTHER_FIELD`的定义方式，您将保证它们之间没有重叠。问题在于找出哪个表引用了`TABLE_C`.

你可以用这个定义做的是从`TABLE_A`或`TABLE_B`到的级联，`TABLE_C`因为在那个方向上关系很清楚。但是，从上级联`TABLE_C`更复杂，因为您不知道要级联到哪个表。要么在一个中定义两个字段`TABLE_C`以引用其他表中的每一个，然后您就可以定义所有三个表之间的关系，因为知道对于任何给定的记录，只会涉及一两个表，而不是全部三个表。或者，您可以使用代码来确定将此特定行与哪个表相关联并相应地级联。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T15:07:44.090

我不知道您使用的是哪个 dbms，但我不知道任何接受多父母的数据库。您可以做的是在 table3 上定义一个索引（只是为了更快）并在您的应用程序中实现级联删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T15:30:05.090

如果 Table3 包含 Table1 UNION Table2 中的所有值，那么您有一个[继承方案](http://www.sqlteam.com/article/implementing-table-inheritance-in-sql-server)：

```
Table3 { (int id, int type) PK }
Table1 { (int id, int type [CHECK type = 1]) FK Table3 }
Table2 { (int id, int type [CHECK type = 2]) FK Table3 } 
```

这样，从 Table3 中删除将适当地级联到 Table1 或 Table2。

否则，如果 Table3 只是 Table1 UNION Table2 的一个子集，那么将 Table4 作为完整集引入就可以了。

```
Table4 { (int id, int type [CHECK type IN (1,2)]) PK }
Table1 { (int id, int type [CHECK type = 1]) FK Table4 }
Table2 { (int id, int type [CHECK type = 2]) FK Table4 }
Table3 { (int id, int type) FK Table4 } 
```

但是，要处理级联删除，您需要从 Table4 中删除（尽管您可以在 Table3 上执行触发器来为您处理）。

编辑（因为我认为这是应该看到的重要一点，与评论分开）：

> 是的，问题在于一和二是父母。它们在 3 中都有相关记录，这将是 FK，而不是该表的 PK。使用 FK 约束似乎几乎是不可能的。感谢您的回复！– 克里斯布（一小时前）

IMO - 你的数据模型被打破了。表 1 和表 2 不相关，但您试图将它们填充到表 3 中的同一列中。如果 Table1 和 Table2 以某种方式相关，那么您需要对其进行建模。

如果它们相关，则引入父表（Table4），或者如果它们不相关，则引入 Table3 中的第二列（Table1 FK，Table2 FK）或 2 个连接表。不要试图将圆钉插入方孔 - 也不要试图用扳机弥补它。;)

# asp.net-mvc - ASP.NET MVC

> ID：710042
> 
> 赞同：3
> 
> 时间：2009-04-02T14:54:59.427
> 
> 标签：asp.net-mvc, amf

我想知道是否有可能在 ASP.net MVC 的控制操作中返回一个序列化的 AMF 对象，任何人都尝试过这个？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T11:41:52.647

我几乎没有使用 MVC 的经验，但我已经完成了一些将 AMF 数据写入 Flash 客户端的测试。我所做的是构建一个在 FluorineFX 中使用 ByteArray 类的通用处理程序。我创建了一个对象实例并使用 WriteObject() 将其写入 ByteArray。然后我将 ByteArray 的数据写入响应流。然后在 Flash 中，我使用了标准 URLLoader 并使用了 (URLLoader.data as ByteArray) 中的 ReadObject()，我将对象反序列化并准备就绪。（当然我必须先完成所有的 RemoteClass 和 registerClassAlias）

我的猜测是 MVC 操作也允许您访问响应流，因此您应该进行设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T12:02:58.587

我不知道 AMF 对象是什么（是的，我可以用谷歌搜索它，但我不会）。但是，你可以序列化 ASP.MVC 中的任何对象。例如，返回 JSON 对象是使用内置序列化的一个示例。

[检查这个以前的SO问题](https://stackoverflow.com/questions/101162/json-and-asp-net-mvc)：

```
public ActionResult MyAction()
{    
    ... 
    // Populate myObject    
    return new JsonResult{ Data = myObject };
} 
```

所以这里的诀窍是，您需要确保这些 AMF 对象之一中的所有对象都可以序列化。如果没有，那么不要忘记您可以返回一个序列化的匿名对象。

例如。

```
public ActionResult MyAction()
{    
    ... 
    // Populate myObject    
    return new JsonResult
        { 
            Data = new
            {
                Id = object.Id,
                Name = object.FirstName + ' ' object.Surname,
                .... etc ....
            }
        };
} 
```

hth。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T17:43:43.350

如果现有的 ActionResult 类不允许您发出所需的格式，您还可以创建自己的 ActionResult 类。

该站点包含有关创建自定义 ActionResults 的信息：http: [//blogs.msdn.com/jowardel/archive/2009/03/11/asp-net-rss-actionresult.aspx](http://blogs.msdn.com/jowardel/archive/2009/03/11/asp-net-rss-actionresult.aspx)

# xml - 从 xsl 创建的 xml 文件中检索数据

> ID：710048
> 
> 赞同：1
> 
> 时间：2009-04-02T14:56:10.157
> 
> 标签：xml, xslt, vbscript

不确定标题是否有意义，但我需要阅读 XML 文档并检索由 XSL XPath 查询创建的数据。

XML 位于[此处](http://reports.ieso.ca/public/GenOutputCapability/PUB_GenOutputCapability.xml)，XSL位于[此处](http://reports.ieso.ca/docrefs/stylesheet/GenOutputCapability_HTML_t1-1.xsl)。如果这不可能，我假设我必须手动编写 XPath 查询。所以我的问题是，既然 XSL 已经生成了总数，那么有什么方法可以将它从 XML 文件中解析出来？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-12-14T09:21:36.407

如果我正确理解您的问题，您是在询问如何获取 XSLT 生成的总数。

我看到 2 个选项：

1.  对 XSLT 进行逆向工程 - 尝试理解它并生成您自己的 XSLT 来计算您想要的总数。从现有 XSLT 复制逻辑
2.  对现有 XSLT 进行第二次 XSLT 转换 - 获取当前 XSLT 的结果并编写您自己的 XSLT，从中获取有趣的部分。为此，您需要 XSLT 命令行工具。

# ruby-on-rails - 使用 VPIM 和存储联系人

> ID：710049
> 
> 赞同：0
> 
> 时间：2009-04-02T14:56:18.127
> 
> 标签：ruby-on-rails, contacts

我正在使用 rails 创建一个邮件列表管理器。

我玩弄了生成自己的数据库的想法；一位联系人将有许多详细信息（电话号码、电子邮件、地址等）。

但这让我开始思考其他人会如何做到这一点，然后为什么不将联系人作为 vCard 存储在数据库中。另外，甚至还有一个可以帮助解决这个问题的宝石：[VPIM](http://vpim.rubyforge.org/)。

但是，可能存在某些缺陷，尤其是使用导轨时。它可能会导致处理表单的额外代码，因为 VPIM vCard 不是 ActiveRecord 对象，它也不是很像 rails。

我想知道在 Rails 应用程序中存储联系人的优雅解决方案是什么？自己滚还是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T19:35:46.450

为了实现与 Rails 的最佳兼容性，使用 ActiveRecord 与之通信的标准数据库后端可能会省去很多麻烦。然后在您的模型对象上，您应该能够轻松实现返回 vCard 格式或您需要的任何其他格式的方法。希望这可以帮助！

# sql-server - 为 SQL Server 2005 安装了 Service Pack 3，但在选择 @@version 时未显示

> ID：710051
> 
> 赞同：3
> 
> 时间：2009-04-02T14:56:33.680
> 
> 标签：sql-server, sql-server-2005

我们为 SQL Server 2005 标准版（64 位）安装了 Service Pack 3。在添加或删除程序菜单中，我们在*Microsoft SQL Server 2005 (64-bit)*下有以下条目：

*   适用于 SQL Server Integration Services 64 位的 Service Pack 3）ENU (KB955706)
*   适用于 SQL Server Notification Services 2005（64 位）ENU 的 Service Pack 3 (KB955706)
*   适用于 SQL Server 数据库服务 2005（64 位）ENU 的 Service Pack 3 (KB955706)
*   适用于 SQL Server 工具和工作站组件的 Service Pack 3 2005（64 位）ENU (KB955706)

但是当我在服务器上运行以下查询时：

```
select @@version 
```

我得到这个结果：

Microsoft SQL Server 2005 - 9.00.4035.00 (X64)
2008 年 11 月 24 日 16:17:31
版权所有 (c) 1988-2005
Windows NT 5.2 上的 Microsoft Corporation 标准版（64 位）（内部版本 3790：Service Pack 2）

为什么它不显示它正在运行 Service Pack 3？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T15:01:36.413

版本 9.00.4035 唯一标识 SP3，尽管它没有明确说明 SP3。您看到的那个 SP2 是指操作系统，而不是 SQL Server。请参阅Microsoft关于 SQL 版本[的知识库文章。](http://support.microsoft.com/kb/321185)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-01T22:57:51.657

您可能正在查看 Windows NT Service Pack 2。使用 Ctrl-T 然后运行您的选择，它会将 SQL 和 Windows 放在不同的行上。

# sql-server - CLR SQL Server UDF 问题

> ID：710057
> 
> 赞同：2
> 
> 时间：2009-04-02T14:57:56.487
> 
> 标签：sql-server, sqlclr

我正在尝试创建一个 CLR UDF，它接受一个字符串值，如“Mike|John|Smith”。在 UDF 中，我解析出值并在 DataTable 中返回它们。C# 代码构建良好，我可以毫无问题地在 SQL 中创建指向 DLL 的程序集。

根据此消息来源，当我尝试告诉 SQL Server 如何将 Transact SQL 请求与 CLR 函数匹配时，问题就出现了。[http://www.setfocus.com/technicalarticles/clrfunctionforsqlserver_2.aspx](http://www.setfocus.com/technicalarticles/clrfunctionforsqlserver_2.aspx)

或者我什至必须这样做？基本上我想接受一个字符串，解析出分隔值并将它们放入一个具有 3 个不同列 FN、MN、LN 的 DB 表中。使用 CLR UDF。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T21:07:03.260

您需要有一个调用程序集的 SQL 存储过程或函数。SQL 存储过程和 .NET 函数的参数需要匹配。例如，如果您的 .NET 程序集具有以下功能：

```
[SqlProcedure]
public static void ProcessData(string myString_)
{
} 
```

您的 SQL 存储过程或函数必须如下所示：

```
CREATE PROCEDURE dbo.ProcessMyData (@InputText AS NVARCHAR(MAX))
AS EXTERNAL NAME SqlAssemblyName.ClassName.ProcessData
GO 
```

# php - 使用 mod_rewrite 将文件夹转换为查询字符串

> ID：710062
> 
> 赞同：2
> 
> 时间：2009-04-02T14:58:14.330
> 
> 标签：php, .htaccess, mod-rewrite

转换这些请求的最简单方法是什么：

```
http://www.example.com/en/
http://www.example.com/en/index.php 
```

到：

```
http://www.example.com/index.php?language_id=en 
```

有各种 PHP 文件，所以规则也需要映射

```
http://www.example.com/en/anyfile.php 
```

到：

```
http://www.example.com/anyfile.php?language_id=en 
```

语言 ID 可以是任意两个字母代码（在 PHP 脚本中检查，以确保其有效）。

据推测，我需要使用 .htaccess，任何有关如何实现上述内容的建议都将不胜感激。谢谢。

**更新**

以下对我有用。

```
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ([a-z]+)/(css|js|images)/(.+) /$2/$3 [L]
  RewriteRule ([a-z]+)/(.+).php /$2.php?language_id=$1 [QSA,L]
  RewriteRule ([a-z]+)/$ /index.php?language_id=$1 [QSA,L]
</IfModule> 
```

这还会将对 css、js 和 images 文件夹的请求重新路由回根文件夹。如果没有输入文件名，它也可以工作，自动重定向到 index.php。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T00:00:29.903

您可能希望将`QSA`标志添加到重写规则中，这会将查询字符串上的任何附加位附加到重写的请求中，例如

```
RewriteRule magic here [PT,QSA] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T15:01:50.390

```
RewriteRule /([^/]+)/(.*) /$2?language_id=$1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T15:00:27.773

```
RewriteRule /en/(.*) /$1?language_id=en 
```

它未经测试，但理论上它应该将 en 之后的任何内容映射为 ?language_id=en 之后的变量

你也可以做

```
RewriteRule /([a-zA-Z0-9+])/(.*) /$2?language_id=$1 
```

这也应该映射

> [http://www.example.com/is/index.php](http://www.example.com/is/index.php)

到

> [http://www.example.com/index.php?language_id=is](http://www.example.com/index.php?language_id=is)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-13T14:13:01.940

我正在为友好的 URL 使用以下构造：

```
RewriteRule ^([^/]+)[/]{0,1}(.*)$ index.php?q=$2&language=$1 [L,QSA,NC] 
```

# c# - 将文本添加到 DataGridView 行标题

> ID：710064
> 
> 赞同：27
> 
> 时间：2009-04-02T14:58:35.733
> 
> 标签：c#, .net, winforms, datagridview

C# 是否允许您将字符串添加到 DataGridView 中的 RowHeader？如果是这样，它是如何实现的？

到目前为止，我正在编写一个 Windows 表单来显示今年的客户付款数据。

ColumnHeaders 显示 1 月、2 月、3 月等......而不是有一个带有 DateTime.Now.Year 的空白列，我想将它放在 RowHeader 中以使其从实际付款数据中脱颖而出。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-07-15T06:10:10.930

```
private void dtgworkingdays_DataBindingComplete(object sender, DataGridViewBindingCompleteEventArgs e)
{
    this.FillRecordNo();
}

private void FillRecordNo()
{
    for (int i = 0; i < this.dtworkingdays.Rows.Count; i++)
    {
        this.dtgworkingdays.Rows[i].HeaderCell.Value = (i + 1).ToString();
    }
} 
```

另请参阅[在 DataGridView 的行标题中显示行号](https://stackoverflow.com/questions/9581626/show-row-number-in-row-header-of-a-datagridview)。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-04-16T07:36:05.903

```
datagridview1.Rows[0].HeaderCell.Value = "Your text"; 
```

有用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-03T14:17:20.157

您不必使用 RowValidated 事件，这只是我用于一个小测试应用程序以确保它有效的事件，但这会将行（而不是列）标题文本设置为您指定的任何年份。

实际上，它在 CellFormatting 事件中可能会更好。

```
 private void dataGridView_RowValidated(object sender, DataGridViewCellEventArgs e)
    {
        DataGridView gridView = sender as DataGridView;

        if (null != gridView)
        {
            gridView.Rows[e.RowIndex].HeaderCell.Value = "2009";
        }
    } 
```

**编辑**：这是我使用的整个 TestForm，尽可能简单地演示解决方案。确保您的**RowHeadersWidth**足够宽以显示文本。

```
#region

using System.ComponentModel;
using System.Windows.Forms;

#endregion

namespace DataGridViewTest
{
    public class GridTest : Form
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private IContainer components;

        private DataGridView dataGridView1;
        private DataGridViewTextBoxColumn Month;

        public GridTest()
        {
            InitializeComponent();
        }

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        private void dataGridView_RowValidated(object sender, DataGridViewCellEventArgs e)
        {
            DataGridView gridView = sender as DataGridView;

            if (null != gridView)
            {
                gridView.Rows[e.RowIndex].HeaderCell.Value = "2009";
            }
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.dataGridView1 = new System.Windows.Forms.DataGridView();
            this.Month = new System.Windows.Forms.DataGridViewTextBoxColumn();
            ((System.ComponentModel.ISupportInitialize) (this.dataGridView1)).BeginInit();
            this.SuspendLayout();
            // 
            // dataGridView1
            // 
            this.dataGridView1.AutoSizeColumnsMode = System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill;
            this.dataGridView1.ColumnHeadersHeightSizeMode =
                System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
            this.dataGridView1.Columns.AddRange(new System.Windows.Forms.DataGridViewColumn[]
                                                    {
                                                        this.Month
                                                    });
            this.dataGridView1.Dock = System.Windows.Forms.DockStyle.Fill;
            this.dataGridView1.Location = new System.Drawing.Point(0, 0);
            this.dataGridView1.Name = "dataGridView1";
            this.dataGridView1.RowHeadersWidth = 100;
            this.dataGridView1.Size = new System.Drawing.Size(745, 532);
            this.dataGridView1.TabIndex = 0;
            this.dataGridView1.RowValidated +=
                new System.Windows.Forms.DataGridViewCellEventHandler(this.dataGridView_RowValidated);
            // 
            // Month
            // 
            this.Month.HeaderText = "Month";
            this.Month.Name = "Month";
            // 
            // Form1
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(745, 532);
            this.Controls.Add(this.dataGridView1);
            this.Name = "Form1";
            this.Text = "Form1";
            ((System.ComponentModel.ISupportInitialize) (this.dataGridView1)).EndInit();
            this.ResumeLayout(false);
        }

        #endregion
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-03-23T14:16:59.447

这是因为您的第一列（行标题列）宽度！增加它的宽度然后你可以看到它的价值！你可以使用这个命令：

```
dgv1.RowHeadersWidthSizeMode = DataGridViewRowHeadersWidthSizeMode.AutoSizeToAllHeaders; 
```

（注意：必须先设置`dgv1.RowHeadersVisible = true;`）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-06-16T15:30:13.417

我遇到了同样的问题，但我注意到我的数据网格在`datagrid.visible`属性更改后丢失了行的标题。

尝试使用`Datagrid.visiblechanged`事件更新行的标题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-07-09T16:22:16.717

是的你可以

```
DataGridView1.Rows[0].HeaderCell.Value = "my text"; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-05-17T13:14:26.930

我有同样的问题。无法使用我的数据绑定网格获取标题列以显示行标题数据（简单的行号）。一旦我将代码移动到事件“DataBindingComplete”，它就起作用了。

对不起，额外的代码。我想提供一个工作示例，但没有时间将其全部删除，因此只需剪切并粘贴我的一些应用程序并修复它以供您运行。干得好：

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Windows.Forms;
using System.Windows.Forms.DataVisualization.Charting;

namespace WindowsFormsApplication3
{
    public partial class Form1 : Form
    {
        private List<DataPoint> pts = new List<DataPoint>();

        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            InsertPoint(10, 20);
            InsertPoint(12, 40);
            InsertPoint(16, 60);
            InsertPoint(20, 77);
            InsertPoint(92, 80);

            MakeGrid();
        }

        public void InsertPoint(int parameterValue, int commandValue)
        {
            DataPoint pt = new DataPoint();
            pt.XValue = commandValue;
            pt.YValues[0] = parameterValue;
            pts.Add(pt);
        }

        private void MakeGrid()
        {
            dgv1.SuspendLayout();
            DataTable dt = new DataTable();
            dt.Columns.Clear();
            dt.Columns.Add("Parameter");
            dt.Columns.Add("Command");

            //*** Add Data to DataTable
            for (int i = 0; i <= pts.Count - 1; i++)
            {
                dt.Rows.Add(pts[i].XValue, pts[i].YValues[0]);
            }
            dgv1.DataSource = dt;

            //*** Formatting for the grid is performed in event dgv1_DataBindingComplete.
            //*** If its performed here, the changes appear to get wiped in the grid control.
        }

        private void dgv1_DataBindingComplete(object sender, DataGridViewBindingCompleteEventArgs e)
        {
            DataGridViewCellStyle style = new DataGridViewCellStyle();
            style.Alignment = DataGridViewContentAlignment.MiddleRight;

            //*** Add row number to each row
            foreach (DataGridViewRow row in dgv1.Rows)
            {
                row.HeaderCell.Value = (row.Index + 1).ToString();
                row.HeaderCell.Style = style;
                row.Resizable = DataGridViewTriState.False;
            }
            dgv1.ClearSelection();
            dgv1.CurrentCell = null;
            dgv1.ResumeLayout();
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-08-04T06:19:22.227

我认为应该是：

```
dataGridView1.Columns[0].HeaderCell.Value = "my text"; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-09-02T22:45:58.240

```
foreach (DataGridViewRow row in datagrid.Rows)
                        row.HeaderCell.Value = String.Format("{0}", row.Index + 1); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-31T06:37:23.027

这是一个小“致命一击”

```
Public Class DataGridViewRHEx
Inherits DataGridView

Protected Overrides Function CreateRowsInstance() As System.Windows.Forms.DataGridViewRowCollection
    Dim dgvRowCollec As DataGridViewRowCollection = MyBase.CreateRowsInstance()
    AddHandler dgvRowCollec.CollectionChanged, AddressOf dvgRCChanged
    Return dgvRowCollec
End Function

Private Sub dvgRCChanged(sender As Object, e As System.ComponentModel.CollectionChangeEventArgs)
    If e.Action = System.ComponentModel.CollectionChangeAction.Add Then
        Dim dgvRow As DataGridViewRow = e.Element
        dgvRow.DefaultHeaderCellType = GetType(DataGridViewRowHeaderCellEx)
    End If
End Sub
End Class 
```

```
Public Class DataGridViewRowHeaderCellEx
Inherits DataGridViewRowHeaderCell

Protected Overrides Sub Paint(graphics As System.Drawing.Graphics, clipBounds As System.Drawing.Rectangle, cellBounds As System.Drawing.Rectangle, rowIndex As Integer, dataGridViewElementState As System.Windows.Forms.DataGridViewElementStates, value As Object, formattedValue As Object, errorText As String, cellStyle As System.Windows.Forms.DataGridViewCellStyle, advancedBorderStyle As System.Windows.Forms.DataGridViewAdvancedBorderStyle, paintParts As System.Windows.Forms.DataGridViewPaintParts)
    If Not Me.OwningRow.DataBoundItem Is Nothing Then
        If TypeOf Me.OwningRow.DataBoundItem Is DataRowView Then

        End If
    End If
'HERE YOU CAN USE DATAGRIDROW TAG TO PAINT STRING

    formattedValue = CStr(Me.DataGridView.Rows(rowIndex).Tag)
    MyBase.Paint(graphics, clipBounds, cellBounds, rowIndex, dataGridViewElementState, value, formattedValue, errorText, cellStyle, advancedBorderStyle, paintParts)
End Sub
End Class 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-01-28T23:06:20.410

和内置方法一样，应该有一种`OnCellToolTipTextNeeded(...)`方法，但没有。`OnRowErrorTextNeeded(...);``OnRowHeaderCellValueNeeded(...);`

有两种受保护的方法`OnRowErrorTextNeeded(...)`或`OnRowPrePaint(...)`看起来很有希望，但是尝试使用它们会产生副作用，即“rowIndex out of bounds”。此外，如果`DoubleBuffered`为 false，则结果是进程崩溃。

似乎没有副作用的方法就是`OnCellErrorTextNeeded(...)`方法。查看堆栈跟踪，该方法是在私有`PaintWork(...)`方法内部调用的，而该`OnRowErrorTextNeeded(...)`方法不是。

此外，一个要求似乎是行标题单元格值必须是一个`String`对象，否则它不会被绘制。

```
public class MyDGV : DataGridView {

    // only set the HeaderCell.Value if the row is different than before
    private int onCellErrorTextNeededRowIndexPrevious = -1;

    public MyDGV() {
        this.Dock = DockStyle.Fill;
        this.AllowUserToAddRows = false;
        this.AllowUserToResizeRows = false;
        this.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.DisplayedCells;
        this.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.None;
        this.RowHeadersWidthSizeMode = DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders;
        this.ColumnHeadersDefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter;
        this.DoubleBuffered = true;

        DataTable dt = new DataTable();
        dt.Columns.Add("A");
        dt.Columns.Add("B", typeof(DateTime));
        dt.Columns.Add("C", typeof(int));
        int x = 1;
        DateTime date = DateTime.Today.AddDays(-52);
        for (char c = 'A'; c <= 'Z'; c++) {
            dt.Rows.Add(c.ToString().ToLower(), date, x++);
            dt.Rows.Add(c.ToString(), date, x++);
            date = date.AddDays(1);
        }
        this.DataSource = dt;
    }

    protected override void OnCellErrorTextNeeded(DataGridViewCellErrorTextNeededEventArgs e) {
        base.OnCellErrorTextNeeded(e);
        e.ErrorText = "Cell(" + e.ColumnIndex + ", " + e.RowIndex + ")";

        if (e.RowIndex != onCellErrorTextNeededRowIndexPrevious) {
            onCellErrorTextNeededRowIndexPrevious = e.RowIndex;
            DataGridViewRow rs = this.Rows[e.RowIndex]; // HeaderCell requires unshared row
            rs.HeaderCell.Value = (e.RowIndex + 1).ToString();
            //Debug.WriteLine("getting: " + e.ErrorText); // testing only
        }
        else {
            //Debug.WriteLine("skipping"); // testing only
        }
    }

    protected override void OnRowErrorTextNeeded(DataGridViewRowErrorTextNeededEventArgs e) {
        base.OnRowErrorTextNeeded(e);
        e.ErrorText = "Cell(-1, " + e.RowIndex + ")";
    }
} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-04-02T15:07:50.907

是的。首先，钩入列添加事件：

```
this.dataGridView1.ColumnAdded += new DataGridViewColumnEventHandler(dataGridView1_ColumnAdded); 
```

然后，在您的事件处理程序中，只需附加您想要的文本：

```
private void dataGridView1_ColumnAdded(object sender, DataGridViewColumnEventArgs e)
{
    e.Column.HeaderText += additionalHeaderText;
} 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2010-10-27T19:00:28.830

确保`Enable Column Recording`已检查。

# c# - 使用反射处理通用列表/集合中的项目

> ID：710065
> 
> 赞同：1
> 
> 时间：2009-04-02T14:58:45.703
> 
> 标签：c#, .net, generics, reflection

我有一个泛型类，我正在使用反射来提取泛型类型的属性并寻找属性。我正在递归到每个属性以对它们的每个属性执行相同的操作。我的问题是当我遇到某种集合属性（作为集合的属性）或 ICollection 属性时。我将无法将从 GetValue 返回的值转换为特定类型（尝试转换为 IEnumerable 但不适用于通用 IEnumerables）。

这里有一些代码可以帮助理解更多：

```
 public class NotificationMessageProcessor<T> : INotificationProcessor<T>
    {
          IList<string> availableTags = new List<string>();

          public string ReplaceNotificationTags<T>(string message, T instance)
          {

             LoadTagValues(instance);
             return ReplaceTags(message);

          }

          private string ReplaceTags(string message)
          {
             foreach (KeyValuePair<string, string> tagVal in tagValues)
             {
                 message = message.Replace(string.Format("<{0}>", tagVal.Key),     tagVal.Value);
             }
             return message;
          }

          private void LoadTagValues(object val)
          {
              Type elementType = val.GetType();
              PropertyInfo[] typeProperties = elementType.GetProperties();
              foreach (PropertyInfo prop in typeProperties)
              {

                 NotificationTag[] tags =      (NotificationTag[])prop.GetCustomAttributes(typeof(NotificationTag), false);
                if (tags != null && tags.Length > 0)
                {
                    string tagName = tags[0].TagName;
                    object propValue = prop.GetValue(val, null);
                    string propTypeString = prop.PropertyType.FullName;
                    tagName = prop.ReflectedType.Name + "." + tagName;
                    if (propValue != null)
                    {
                      tagValues.Add(tagName, propValue.ToString());
                    }

                    if (propValue != null)
                    {
                       if (!prop.PropertyType.IsPrimitive)
                       {
                         LoadTagValues(propValue);
                       }
                    }
                }
                else
                {
                   if (!prop.PropertyType.IsPrimitive)
                   {
                     object propValue = null;

                        if (prop.GetGetMethod().GetParameters().Count() == 0)
                        {
                            propValue = prop.GetValue(val, null);
                        }
                        else
                        {
                           //have a collection...need to process but do not know how many in collection....
                                propValue = prop.GetValue(val, new object[] { 0 });

                        }
                    if (propValue != null)
                    {
                        LoadTagValues(propValue);
                    }
                }
            }
        }
    }

 NotificationMessageProcessor<User> userProcessor = new NotificationMessageProcessor();
    userProcessor.ReplaceNotificationTags<User>(someMessage, instanceOfUser); 
```

User 对象具有适当的属性

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T15:01:12.890

据我了解，非泛型`IEnumerable`会做，因为无论如何您都不需要类型信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T15:20:44.990

您可以尝试将属性的集合类型转换为实际的集合类型吗？

您是否正在执行以下操作：

```
List<OfObject> myCollection = new List<OfObject>;
myCollection = (List<OfObject>)objPropertyInfo.GetValue(List<ObjectHere>, Nothing); 
```

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T17:31:00.480

我正在对 IEnumerable 进行强制转换，当我遇到问题时，我试图强制转换错误的对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T01:23:55.590

最后的答案（安东·戈戈列夫）是最好的之一；例如：

我有这个通用功能：

```
var fieldFetchedData = fieldQueryHandler.GetType().GetMethod("GetFilter").MakeGenericMethod(selectedParameter.ParameterType).Invoke(fieldQueryHandler,fieldParameters.ToArray()); 
```

它本身也返回了一个通用列表（`List<[Unknown Model Type]>`...）

我到处查看以从中获得一个结果，但在这样做之前我必须以任何方式强制转换它，并且无法定义用户或任何其他模型类（我不知道它应该是哪一个）甚至通过***泛型***。看到之后，我就对自己说，我试过很多方法，也试试这个，于是我就这样做了：

```
IEnumerator enumeratorFetchedData = ((IEnumerable) fieldFetchedData).GetEnumerator();
object obj = enumeratorFetchedData.MoveNext()? enumeratorFetchedData.Current:null; 
```

它可以正常工作！

# asp.net - 子域指向主站点的子目录？

> ID：710067
> 
> 赞同：2
> 
> 时间：2009-04-02T14:59:28.213
> 
> 标签：asp.net, iis, dns, subdomain

我的网站运行在：

> www.example.com

我也有这个其他域：

> www.example.net

是否可以将“www.example.net”指向“www.example.com”的子目录？例如：

> www.example.net-> www.example.com/other

?

这不仅仅是重定向，我需要提供页面并在用户浏览器中查看“www.example.net”。

你怎么看？

我们使用 IIS7，一切都是 ASP.NET（aspx 页面、ascx 控件等）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T15:04:03.227

您正在为此寻找两种方法：

*   URL 重写器
*   Server.Execute 方法

第一个是一个 httpmodule，它在不更改地址栏中的 url 的情况下静默重定向请求，第二个是您可以在 aspx 代码中调用的方法。我认为后者只有在您在同一个应用程序中工作时才有用，所以我会使用 URL 重写器。

www.iis.net afaik 上有一个官方的 iis7 URL 重写器。

-Oisin

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T15:13:08.210

使用[ISAPI 重写](http://www.isapirewrite.com/)

```
[ISAPI_Rewrite]

RewriteCond  Host:  (?:www\.)?other\.com
RewriteRule  (.*)   http://www.domain.com/other$1 [I,L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T15:17:50.457

给你两个问题：

1.  您可以在 IIS 中将它们设置为两个不同的网站吗？
2.  如果有人访问了 example.net/page.htm，那会和 example.com/other/page.htm 一样吗？

如果这两个答案都是肯定的，为什么不在 IIS 中设置一个新网站并将其指向“其他”文件路径。

# c# - 超时模式 - Thread.Abort 到底有多糟糕？

> ID：710070
> 
> 赞同：5
> 
> 时间：2009-04-02T14:59:45.513
> 
> 标签：c#, multithreading, extension-methods

我在各种网站上读到 Thread.Abort 不太好用。在这种情况下，如何实现超时模式？例如，我读到 MS 在整个框架中使用下面的模式（我已将其包装在扩展方法中）。就个人而言，我认为这是一个非常酷的扩展，但我担心 Thread.Abort。有没有人有更好的方法？

```
 public static bool CallandWait(this Action action, int timeout)
    {
        Thread subThread = null;
        Action wrappedAction = () =>
        {
            subThread = Thread.CurrentThread;
            action();
        };

        IAsyncResult result = wrappedAction.BeginInvoke(null, null);

        if (((timeout != -1) && !result.IsCompleted) && (!result.AsyncWaitHandle.WaitOne(timeout, false) || !result.IsCompleted))
        {
            if (subThread != null)
            {
                subThread.Abort();
            }

            return false;
        }
        else
        {
            wrappedAction.EndInvoke(result);
            return true;
        }
    } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-02T15:03:04.897

基本上你说的是中止一个（据我们所知）没有优雅的中止方式的动作。

这意味着将没有*安全*的方法来中止它。`Thread.Abort`这不是一件好事 - 你可以进入各种比赛条件和丑陋的情况（请参阅[理查德答案](https://stackoverflow.com/questions/710070/timeout-pattern-how-bad-is-thread-abort-really/710094#710094)中的链接）。我会竭尽全力避免想要取消不知道取消的操作 - 如果您绝对*必须*这样做，请考虑在之后重新启动整个应用程序，因为您可能不再处于理智状态。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-02T15:04:24.253

*可能*非常糟糕。

中止的线程可能会使共享状态损坏，可能会使异步操作继续运行，...

请参阅 Joe Duffy 的博客：[“托管代码和异步异常强化”](http://www.bluebytesoftware.com/blog/2009/03/13/ManagedCodeAndAsynchronousExceptionHardening.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T15:02:54.150

这很糟糕，因为线程可能处于不一致的状态或正在进行某些工作，并且没有机会自行清理。

要正确关闭它，您可以通过调用方法或设置属性来指示它停止正在执行的操作，然后执行 Thread.Join 以等待它关闭，然后再关闭您的应用程序或继续执行其他任务。

# asp.net - 如何在 ASP.NET 中的 Web 应用程序之间共享用户控件？

> ID：710076
> 
> 赞同：12
> 
> 时间：2009-04-02T15:00:24.233
> 
> 标签：asp.net, visual-studio-2008, web-applications, user-controls, resources

[这个问题是我关于在 web 应用程序之间共享资源](https://stackoverflow.com/questions/688784/how-do-i-share-common-web-resources-between-web-applications-in-visual-studio)的问题的后续问题，因为我还没有找到一个好的解决方案。

我有一个 Web 应用程序，其中包含由其他三个 Web 应用程序共享的用户控件和资源。

```
解决方案
|
+-CommonControlsWebApp
| +- 资源
| | +- 图片
| | +- 脚本
| | +- 样式表
| +- 用户控件
|
+-WebApp1
|
+-WebApp2
|
+-WebApp3

```

这是我到目前为止所知道的：

*   我无法将 CommonControlsWebApp 编译成单个 dll，因为我正在创建用户控件。这仅适用于自定义服务器控件，其中所有内容都在代码隐藏文件中。所以我需要一种在四个项目之间共享 ascx 文件的方法。
*   将文件从 CommonControlsWebApp 复制到其他三个项目不会在解决方案资源管理器中更新它们的文件。当在 CommonControls 中添加或重命名文件时，我必须在所有三个 WebApps 中都“添加扩展项”。
*   更改为网站模型可以解决这个问题，但如果我这样做，我担心 WebApp1-3 的编译时间。
*   “添加为链接”不适用于目录。
*   我可以使用 Subversion 在项目之间共享文件，但我相信如果我正在开发一个必须通过其中一个 WebApp 进行测试的用户控件，这将需要我一直重新签入和签出文件。

**ASP.NET 真的没有一个好的解决方案吗？你们是如何组织大型 Web 应用程序的？**

编辑：非常感谢所有的答案。我现在将使用构建事件复制我的用户控件，然后看看我们是否有时间将它们重构为服务器控件。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-02T15:13:54.513

在我现在的公司，我们这样做的方式是确保 CommonControlsWebApp 是一个 WebApplication，而不是一个网站。然后，您为文件夹使用名称，以帮助将其识别为与单个 Web 应用程序不同的常见文件夹。（CommonUserControls 而不仅仅是 UserControls）

在您的其他 Web 应用程序中，您为 CommonUserControls 等创建一个虚拟目录，并添加一个基于文件的对 CommonControlsWebApp.dll 的引用

这需要您使用 IIS 进行开发（而不是 casini），Visual Studio 不会相信控件确实存在，但它会在运行时工作，并且您可以构建得很好，只需要关于 blahblah.ascx 或 blahblah.master 的警告路径无效。

如果您确实使用通用母版页和 Visual Studio 2008，则需要 SP1 for 2008 并在各个 Web 项目的根目录中使用 __fallback.master 以进入设计模式。

但是，我在另一个线程上看到了这个，我打算做更多这样的事情： [http ://webproject.scottgu.com/CSharp/UserControls/UserControls.aspx](http://webproject.scottgu.com/CSharp/UserControls/UserControls.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-11T17:10:24.820

你可以把它编译成一个dll

[将 .ascx 用户控件转换为可再发行的自定义控件](http://msdn.microsoft.com/en-us/library/aa479318.aspx)

> 步骤概要
> 
> 实现这一点的基本步骤如下：
> 
> 1.  像往常一样编写用户控件，通常使用 Visual Studio 设计器。
> 2.  在尝试部署之前使用一个简单的页面对其进行测试。
> 3.  部署应用程序以预编译它。
> 4.  获取部署步骤生成的用户控件程序集，您基本上就完成了：您拥有了自定义控件。
> 5.  最后，在其他应用程序中使用您的自定义控件

更多信息在这里[http://www.nathanblevins.com/Articles/Compile-a-Web-User-Control-into-a-DLL-.Net-c-.aspx](http://www.nathanblevins.com/Articles/Compile-a-Web-User-Control-into-a-DLL-.Net-c-.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T15:12:23.423

为了在 Web 应用程序之间共享控件，我发现的唯一方法是将它们重写为服务器控件或使用虚拟目录使用户控件实际上在文件夹中位于每个项目中。

不幸的是，asp.net 并没有很好的解决方案。共享母版页也是如此。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T15:16:24.070

您可能会考虑使用源代码控制并在该级别共享您的控制。我们为一个相当大的用户控件库这样做，它工作得很好。

使用 SourceGear Vault，但您应该能够使用任何源代码控制产品执行此操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T16:14:30.943

查看[这篇](https://stackoverflow.com/questions/709617/using-user-controls-from-other-projects-in-asp)文章以了解如何解决此问题。

基本思想是更改您的项目，使其具有一个预构建步骤，将 .ascx 文件复制到 Web 应用程序的子目录中。然后在使用它们时参考这些副本。当然，您还需要引用 UserControls 程序集。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T15:05:05.203

一种选择是尝试“添加现有”，然后在出现的对话框中，“确定”按钮旁边有一个下拉箭头，将其更改为带有链接的添加。

如果这不起作用，请将您的控件重写为自定义控件。

这将需要一点时间，但将来会使其更易于维护。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T15:13:05.730

嘿，这不是最好的做事方式，但我曾经在我的 asp.net 1.1 天这样做 - 你可以试试这个 - 将你的用户控件转移到一个单独的项目中，并将这个项目发布为 iis 下的虚拟目录

只要您不使用代码隐藏 - 您的更新会很酷（仅更新共享用户控制文件夹）

如果您确实使用代码隐藏 - 将用户控件 dll 重新部署到不同的项目中

* * *

完成此操作后 - 使用它们的虚拟路径将这些用户控件映射到所有项目中

检查这些链接 - [http://aspadvice.com/blogs/ssmith/archive/2006/10/05/Tip_3A00_-Share-User-Controls-Between-Applications-in-ASP.NET.aspx](http://aspadvice.com/blogs/ssmith/archive/2006/10/05/Tip_3A00_-Share-User-Controls-Between-Applications-in-ASP.NET.aspx)

和

[http://www.123aspx.com/redir.aspx?res=30887](http://www.123aspx.com/redir.aspx?res=30887)

# css - 如何使 html 链接看起来像一个按钮？

> ID：710089
> 
> 赞同：186
> 
> 时间：2009-04-02T15:03:09.513
> 
> 标签：css

我正在使用 ASP.NET，我的一些按钮只是做重定向。我宁愿它们是普通的链接，但我不希望我的用户注意到外观上有很大的不同。我考虑过由锚（即标签）包裹的图像，但我不想每次更改按钮上的文本时都必须启动图像编辑器。

* * *

## 回答 #1

> 赞同：247
> 
> 时间：2009-04-02T15:06:48.273

应用这个类

```
.button {
  font: bold 11px Arial;
  text-decoration: none;
  background-color: #EEEEEE;
  color: #333333;
  padding: 2px 6px 2px 6px;
  border-top: 1px solid #CCCCCC;
  border-right: 1px solid #333333;
  border-bottom: 1px solid #333333;
  border-left: 1px solid #CCCCCC;
}
```

```
<a href="#" class="button">Example</a>
```

* * *

## 回答 #2

> 赞同：148
> 
> 时间：2011-02-25T14:05:47.020

为什么不只是在按钮元素周围包裹一个锚标记。

```
<a href="somepage.html"><button type="button">Text of Some Page</button></a> 
```

这适用于 IE9+、Chrome、Safari、Firefox，可能还有 Opera。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2012-10-06T17:05:00.547

恕我直言，有一个更好，更优雅的解决方案。如果您的链接是这样的：

```
<a href="http://www.example.com">Click me!!!</a> 
```

对应的按钮应该是这样的：

```
<form method="GET" action="http://www.example.com">
<input type="submit" value="Click me!!!">
</form> 
```

这种方法更简单，因为它使用简单的 html 元素，因此它可以*在所有浏览器中*工作而无需更改任何内容。此外，如果您的按钮有样式，此解决方案将免费为您的新按钮应用相同的样式。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2016-02-26T17:07:36.763

CSS3`appearance`属性提供了一种使用浏览器内置样式设置任何元素（包括锚点）的简单方法`<button>`：

```
a.btn {
  -webkit-appearance: button;
  -moz-appearance: button;
  appearance: button;
}
```

```
<body>
  <a class="btn">CSS Button</a>
</body>
```

[CSS Tricks](https://css-tricks.com/almanac/properties/a/appearance/)有一个很好的大纲，其中包含更多细节。**请记住，[根据 caniuse.com，](http://caniuse.com/#search=appearance)目前没有任何 Internet Explorer 版本支持此功能。**

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2013-12-03T09:40:41.407

如果您想要带有圆角的漂亮按钮，请使用此类：

```
.link_button {
    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    border-radius: 4px;
    border: solid 1px #20538D;
    text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.4);
    -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4), 0 1px 1px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4), 0 1px 1px rgba(0, 0, 0, 0.2);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4), 0 1px 1px rgba(0, 0, 0, 0.2);
    background: #4479BA;
    color: #FFF;
    padding: 8px 12px;
    text-decoration: none;
}
```

```
<a href="#" class="link_button">Example</a>
```

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2009-04-02T15:06:11.987

```
a {
    display: block;
    height: 20px;
    width: auto;
    border: 1px solid #000;
} 
```

`<a>`如果你给他们一个块显示，你可以玩这样的标签。您可以调整边框以提供类似阴影的效果和该按钮感觉的背景颜色:)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-09-11T05:26:17.953

正如 TStamper 所说，您可以将 CSS 类应用于它并以这种方式进行设计。随着 CSS 的改进，您可以使用链接做的事情变得非同寻常，并且现在有一些设计小组只专注于为主题创建令人惊叹的 CSS 按钮等等。

例如，您可以使用 -webkit-transition 属性和 pseduo-classes 使用背景颜色进行过渡。其中一些设计可能会变得非常疯狂，但它提供了一个绝妙的替代方案，可以替代过去可能不得不使用闪存来完成的工作。

例如（我认为这些令人兴奋）， [http](http://tympanus.net/Development/CreativeButtons/) ://tympanus.net/Development/CreativeButtons/ （这是一系列完全开箱即用的按钮动画，源代码在原始页面上）。 [http://www.commentredirect.com/make-awesome-flat-buttons-css/](http://www.commentredirect.com/make-awesome-flat-buttons-css/)（同理，这些按钮具有漂亮但简约的过渡效果，它们利用了新的“扁平”设计风格。）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-12-06T09:40:41.553

你可以用 JavaScript 来做：

1.  使用 .获取真实按钮的 CSS 样式`getComputedStyle(realButton)`。
2.  将样式应用于所有链接。

```
/* javascript, after body is loaded */
'use strict';

{ // Namespace starts (to avoid polluting root namespace).

  const btnCssText = window.getComputedStyle(
    document.querySelector('.used-for-btn-css-class')
  ).cssText;
  document.querySelectorAll('.btn').forEach(
    (btn) => {

      const _d = btn.style.display; // Hidden buttons should stay hidden.
      btn.style.cssText = btnCssText;
      btn.style.display = _d;

    }
  );

} // Namespace ends.
```

```
<body>
  <h3>Button Styled Links</h3>
  <button class="used-for-btn-css-class" style="display: none"></button>
  <a href="//github.io" class="btn">first</a>
  <a href="//github.io" class="btn">second</a>
  <button>real button</button>
  <script>/* You may put JS here. */</script>
</body>
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-02T15:09:18.017

您可以创建一个标准按钮，然后将其用作链接的背景图像。然后您可以在不更改图像的情况下设置链接中的文本。

如果您没有特殊的渲染按钮，最好的解决方案是 TStamper 和 Ólafur Waage 已经给出的两个。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-02T15:10:06.923

这也更深入地介绍了 css 的细节，并为您提供了一些图像：

[http://www.dynamicdrive.com/style/csslibrary/item/css_square_buttons/](http://www.dynamicdrive.com/style/csslibrary/item/css_square_buttons/)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-02-28T15:52:05.680

> 使用 asp:LinkBut​​ton 怎么样？

你可以这样做 - 我使用 TStamper 的条目使链接按钮看起来像一个标准按钮。尽管进行了`text-decoration: none`设置，但当我悬停时，下划线显示在文本下方。

我可以通过在链接按钮中添加来停止悬停下划线`style="text-decoration: none"`：

```
<asp:LinkButton 
id="btnUpdate" 
CssClass="btnStyleTStamper" 
style="text-decoration: none" 
Text="Update Items"   
Onclick="UpdateGrid"  
runat="server"
/> 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-03-14T13:51:32.037

迟来的答案：

自从我第一次开始在 ASP 中工作以来，我一直在为此苦苦挣扎。这是我想出的最好的：

概念：我创建了一个具有标签的自定义控件。然后在按钮中放置一个 onclick 事件，使用 JavaScript 将 document.location 设置为所需的值。

我将控件称为 ButtonLink，以便在与 LinkBut​​ton 混淆时很容易理解。

aspx：

```
<%@ Control Language="VB" AutoEventWireup="false" CodeFile="ButtonLink.ascx.vb" Inherits="controls_ButtonLink" %>

<asp:Button runat="server" ID="button"/> 
```

后面的代码：

```
Partial Class controls_ButtonLink
Inherits System.Web.UI.UserControl

Dim _url As String
Dim _confirm As String

Public Property NavigateUrl As String
    Get
        Return _url
    End Get
    Set(value As String)
        _url = value
        BuildJs()
    End Set
End Property
Public Property confirm As String
    Get
        Return _confirm
    End Get
    Set(value As String)
        _confirm = value
        BuildJs()
    End Set
End Property
Public Property Text As String
    Get
        Return button.Text
    End Get
    Set(value As String)
        button.Text = value
    End Set
End Property
Public Property enabled As Boolean
    Get
        Return button.Enabled
    End Get
    Set(value As Boolean)
        button.Enabled = value
    End Set
End Property
Public Property CssClass As String
    Get
        Return button.CssClass
    End Get
    Set(value As String)
        button.CssClass = value
    End Set
End Property

Sub BuildJs()
    ' This is a little kludgey in that if the user gives a url and a confirm message, we'll build the onclick string twice.
    ' But it's not that big a deal.
    If String.IsNullOrEmpty(_url) Then
        button.OnClientClick = Nothing
    ElseIf String.IsNullOrEmpty(_confirm) Then
        button.OnClientClick = String.Format("document.location='{0}';return false;", ResolveClientUrl(_url))
    Else
        button.OnClientClick = String.Format("if (confirm('{0}')) {{document.location='{1}';}} return false;", _confirm, ResolveClientUrl(_url))
    End If
End Sub
End Class 
```

该方案的优点：看起来像一个控件。你为它写一个标签，<ButtonLink id="mybutton" navigateurl="blahblah"/>

生成的按钮是一个“真正的”HTML 按钮，因此看起来就像一个真正的按钮。您不必尝试使用 CSS 模拟按钮的外观，然后在不同的浏览器上使用不同的外观。

虽然能力有限，但您可以通过添加更多属性轻松扩展它。很可能大多数属性只需要“通过”到底层按钮，就像我对文本、启用和 cssclass 所做的那样。

如果有人有更简单、更清洁或更好的解决方案，我很乐意听到。这是一种痛苦，但它有效。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-08-21T01:54:24.833

这是我用的。链接按钮是

```
<div class="link-button"><a href="/">Example</a></div> 
```

CSS

```
/* body is sans-serif */ 

.link-button {
    margin-top:15px;
    max-width:90px;
    background-color:#eee;
    border-color:#888888;
    color:#333;
    display:inline-block;
    vertical-align:middle;
    text-align:center;
    text-decoration:none;
    align-items:flex-start;
    cursor:default;
    -webkit-appearence: push-button;
    border-style: solid;
    border-width: 1px;
    border-radius: 5px;
    font-size: 1em;
    font-family: inherit;
    border-color: #000;
    padding-left: 5px;
    padding-right: 5px;
    width: 100%;
    min-height: 30px;
}

.link-button a {
    margin-top:4px;
    display:inline-block;
    text-decoration:none;
    color:#333;
}

.link-button:hover {
    background-color:#888;
}

.link-button:active {
    background-color:#333;
}

.link-button:hover a, .link-button:active a {
    color:#fff;
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-10-04T04:09:46.820

使用[这个类](http://jsfiddle.net/ydebmpwz/2/)。当使用标签`button`上的类应用时，它会使您的链接看起来与按钮相同。`a`

或者

[这是另一个演示 JSFIDDLE](http://jsfiddle.net/ydebmpwz/)

```
.button {
    display: inline-block;
    outline: none;
    cursor: pointer;
    border: solid 1px #da7c0c;
    background: #478dad;
    text-align: center;
    text-decoration: none;
    font: 14px/100% Arial, Helvetica, sans-serif;
    padding: .5em 2em .55em;
    text-shadow: 0 1px 1px rgba(0,0,0,.3);
    -webkit-border-radius: .5em; 
    -moz-border-radius: .5em;
    border-radius: .3em;
    -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.2);
    -moz-box-shadow: 0 1px 2px rgba(0,0,0,.2);
    box-shadow: 0 1px 2px rgba(0,0,0,.2);
}
.button:hover {
    background: #f47c20;
    background: -webkit-gradient(linear, left top, left bottom, from(#f88e11), to(#f06015));
    background: -moz-linear-gradient(top,  #f88e11,  #f06015);
    filter:  progid:DXImageTransform.Microsoft.gradient(startColorstr='#f88e11', endColorstr='#f06015');
}
.button:active {
    position: relative;
    top: 1px;
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-04-16T13:41:13.797

通过使用边框、颜色和背景颜色属性，您可以创建一个类似按钮的 html 链接！

```
a {
background-color: white;
color: black;
padding: 5px;
text-decoration: none;
border: 1px solid black;
}
a:hover {
background-color: black;
color: white;

}
```

```
<a href="https://stackoverflow.com/

">Open StackOverflow</a>
```

希望这可以帮助 ：]

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-06-29T13:43:54.427

**HTML**

```
<a class="btn">Button</a> 
```

**CSS**

```
 background-color: #4CAF50; /* Green */
  border: none;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px; 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-04-27T17:37:16.427

我使用`asp:Button`：

```
<asp:Button runat="server"
            OnClientClick="return location='targetPage', true;"
            UseSubmitBehavior="False"
            Text="Button Text Here"
/> 
```

这样，按钮的操作完全是客户端的，并且按钮的作用就像指向`targetPage`.

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-02-28T18:23:43.857

```
.button {
  font: bold 11px Arial;
  text-decoration: none;
  background-color: #EEEEEE;
  color: #333333;
  padding: 2px 6px 2px 6px;
  border-top: 1px solid #CCCCCC;
  border-right: 1px solid #333333;
  border-bottom: 1px solid #333333;
  border-left: 1px solid #CCCCCC;
}
```

```
<a href="#" class="button">Example</a>
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-04-05T13:39:54.403

使用下面的代码片段。

```
 .a{
  color: $brn-acc-clr;
  background-color: transparent;
  border-color: #888888;

  &:hover:active{
    outline: none;
    color: #888888;
    border-color: #888888;
  }
  &:fill{
    background-color: #888888;
    color: #fff;
    box-shadow: 0 3px 10px rgba(#888888, 0.5);
    &:hover:active{
      color: #fff;
    }
    &:hover:not(:disabled){
      transform: translateY(-2px);
      background-color: darken(#888888, 4);
    }
  }
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-04-16T14:12:12.817

简单的按钮 css 现在你可以用你的编辑器来玩了

```
a {
  display: inline-block;
  background: #000000c9;
  color: #000;
  padding: 12px 24px;
  text-align: center;
  text-decoration: none;
  font-size: 16px;
  cursor: pointer;
}
a:hover {
  background:#000
  cursor: pointer;
  transition: 0.3s ease-in;
} 
```

链接标签

```
<a href="#">Hover me<a> 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-09-13T01:35:42.147

如果你需要一些很酷的效果，悬停和阴影；你可以使用这个：

```
 .button {
        text-decoration: none;
        padding: 15px 25px;
        font-size: 24px;
        cursor: pointer;
        text-align: center;
        text-decoration: none;
        outline: none;
        color: #fff;
        background-color: #450775;
        border: none;
        border-radius: 15px;
        box-shadow: 0 9px #e1d5ed;

    }

    .button:hover {background-color: #220440}

    .button:active {
        background-color: #230545;
        box-shadow: 0 5px #e1d5ed;
        transform: translateY(4px);
    } 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2014-07-10T18:43:48.000

这对我有用。它看起来像一个按钮，行为像一个链接。例如，您可以为它添加书签。

```
<a href="mypage.aspx?param1=1" style="text-decoration:none;">
    <asp:Button PostBackUrl="mypage.aspx?param1=1" Text="my button-like link" runat="server" />
</a> 
```

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2011-08-01T09:12:03.630

使用[asp:LinkBut​​ton](http://web.archive.org/web/20110902052707/https://www.w3schools.com/aspnet/showasp.asp?filename=demo_linkbutton)怎么样？

# database - 如何经常/自动比较同一数据库的结构？

> ID：710091
> 
> 赞同：2
> 
> 时间：2009-04-02T15:03:58.763
> 
> 标签：database, comparison, cruisecontrol

有谁知道自动比较数据库结构并报告更改内容的工具？如果它可以集成到 CruiseControl 中，那就更好了。

我所说的结构也指函数和存储过程。乍一看可能不清楚;-)

想法是将其集成到巡航控制服务器中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T15:05:27.777

[据称 Redgate 的SQL Compare](http://www.red-gate.com/products/SQL_Compare/index.htm)擅长于此。

如果您无法通过比较查询结果来更好地了解模式比较：

```
select * from information_schema.columns
select * from information_schema.tables 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T22:46:02.673

[ApexSQL](http://www.apexsql.com/sql_tools_diff.asp)差异和[ApexSql 数据差异](http://www.apexsql.com/sql_tools_datadiff.asp)。他们对我很有用。此外，我过去曾成功使用过 Redgate 工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T22:31:05.267

我使用 Redgate SQL 比较（[链接](http://www.Red-Gate.com/SQL_Compare)）。每个座位大约 400 美元，但物有所值

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T15:06:40.520

[SQL Effects Clarity](http://www.google.com/url?sa=t&source=web&ct=res&cd=2&url=http%3A%2F%2Fwww.sqleffects.com%2Fforum%2Fforum_posts.asp%3FTID%3D93&ei=VdTUSbC9HYrAM63ArOoO&usg=AFQjCNGSOlInQDXsRidYCubNosFypgsrvQ&sig2=o2tzbhEG-UMu7bDX1R1USw)非常擅长比较两个数据库，而且它是免费的（它有一个付费版本，可以让你做更多的事情）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T15:43:54.667

如果工具的输出是纯文本，则要集成到 CC 中，您可以将其作为工件发布。如果输出是 .xml，您可以将其合并到日志中并编写一个 xsl，将其包含在电子邮件和网页中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-24T09:38:15.620

如果您使用 MSSQL，我肯定会选择 AdeptSQL。这是我尝试过的最不好看但最有才华的数据库比较工具。它可以比较结构和数据。它告诉您哪些表存在于一个 db 上但不存在于另一个，比较常见的结构和数据，它可以生成脚本来同步两者。它不是免费的，但有 30 天的试用期（据我所知）

# python - 'for' 遍历表单字段并排除带有 'if' 的字段之一

> ID：710100
> 
> 赞同：4
> 
> 时间：2009-04-02T15:05:31.367
> 
> 标签：python, django-templates

我正在努力解决的问题如下：

我有：

```
{% for field in form %}
    {{ field }}
{% end for %} 
```

我想要的是放置一个“if”语句来排除 .label 或提供的任何内容的字段。像：

```
{% for field in form%}
    {% if field == title %}
    {% else %}
        {{ field }}
    {% endif %}
{% endfor %} 
```

是否可以？我有很多字段要一个一个地写出来，只有一两个要排除。

谢谢你的任何提示。

BR，Czlowiekwidmo。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-02T15:14:10.487

是的，这应该是可能的：

```
{% for field in form %}
    {% ifnotequal field.label title %}
        {{ field }}
    {% endifnotequal %}
{% endfor %} 
```

Django 的[模板标签](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#ref-templates-builtins)提供`ifequal`和`ifnotequal`变体，您可以针对上下文变量或字符串测试 field.label。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-02T15:52:51.043

您可能会更乐意创建表单的子类，不包括违规字段。请参阅[http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#form-inheritance](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#form-inheritance)

```
class SmallerForm( MyForm ):
    class Meta(MyForm.Meta):
        exclude = [ title ] 
```

# sharepoint - MOSS 2007 能否与多个 LDAP/AD 存储集成？

> ID：710107
> 
> 赞同：4
> 
> 时间：2009-04-02T15:06:44.123
> 
> 标签：sharepoint, active-directory, ldap, moss, ldap-client

MOSS 能否集成并从多个 Active Directory 和/或 LDAP 存储中获取用户配置文件？

我从[Integrating Microsoft SharePoint Server With Oracle Virtual Directory](http://www.oracle.com/technology/products/id_mgmt/ovds/pdf/ovd-sharepoint-wp-v3.pdf)中看到，可能有中间产品可以帮助解决这个问题。

看起来[Rohati](http://www.rohati.com/solutions/microsoft-sharepoint.php)也有解决方案，但开箱即用是否没有第三方产品？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T11:53:00.533

无法回答非 AD LDAP，但是对于您信任的多个森林，单向可行，这不是什么大问题。您需要做两件事，将人员添加到人员选择器[http://technet.microsoft.com/en-us/library/cc262051.aspx](http://technet.microsoft.com/en-us/library/cc262051.aspx)，然后运行命令导入用户配置文件信息，链接在上面关联。确保也在您的 MySites 上运行该命令，以便配置文件正确。

通过搜索共享点和多个森林可以找到更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T09:55:06.980

这是一种解决方案[SharePoint AD Information Sync](http://www.boostsolutions.com/ad-sync.html)，它可以让您将 AD 用户文件导出到列表中。但是，问题是您需要知道它只能从 Active Directory 获取用户配置文件，但不能从 LDAP 存储中获取，而且我不确定它是否可以从多个 Active Directory 中获取。

无论如何，这是一个丑陋的解决方案。也许对你有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T15:27:17.017

一种方法是扩展您的网站应用程序并将不同的提供商附加到不同的区域。我认为应该有类似[LDAP Membership Provider](http://blogs.msdn.com/carloshm/archive/2007/07/22/configuring-ldap-provider-with-moss-2007.aspx)你可以使用的东西。但我想这不是你要找的。

另一种方法是构建您自己的[Membership Provider](http://blogs.msdn.com/kalleb/archive/2008/07/24/building-your-own-membershipprovider-in-asp-net-and-use-it-in-sharepoint.aspx)，它在内部从多个来源检索用户、组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T13:53:13.833

我们的客户从 CodePlex 找到了一个[SharePoint 2007 共享服务提供商用户配置文件导入器](http://wiki.threewill.com/display/enterprise/SharePoint+2007+Shared+Services+Provider+User+Profile+Importer+-+Codeplex+Project)，它也可能有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T14:29:08.413

由于 web.config 条目只有一个用于主机名、端口、userContainer 等的条目，因此很难看出如何在不使用第三方虚拟目录产品的情况下做到这一点。Oracle 可以做到这一点，但 Symlabs 或 OptimalId 以及市场上可能的任何其他 VD 也可以。那些不是免费的。但是 Penrose 是一个免费的 LDAP 代理，我猜你应该也可以使用 Penrose 来做到这一点。

# unix - 如何从 root su 到 db2inst1 并在一行中调用 SQL 脚本？

> ID：710110
> 
> 赞同：2
> 
> 时间：2009-04-02T15:07:08.693
> 
> 标签：unix, db2, sql-scripts, su

我怎样才能在 1 行`su`中`root`执行`db2inst1`和调用 SQL 脚本？我正在考虑这样的事情：

```
su db2inst1 | db2 CONNECT TO myDatabase USER db2inst1 USING mypw; db2 -c -i -w -td@ -f /tmp/deploy/sql/My.sql | exit; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T15:10:47.717

您可以使用`-c`or`--command=<command>`选项来执行带有 的命令`su`。在你的情况下，是这样的：

```
su -c 'db2 CONNECT TO myDatabase USER db2inst1 USING mypw; db2 -c -i -w -td@ -f /tmp/deploy/sql/My.sql' db2inst1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T22:45:27.370

如果使用 Solaris 并且您不想/可以输入密码，请检查 pfexec。

# c# - c# - 将泛型类转换为其基非泛型类

> ID：710116
> 
> 赞同：7
> 
> 时间：2009-04-02T15:08:16.070
> 
> 标签：c#, generics

我有以下课程：

```
public abstract class CustomerBase
{
    public long CustomerNumber { get; set; }
    public string Name { get; set; }
}

public abstract class CustomerWithChildern<T> : CustomerBase
    where T: CustomerBase
{
    public IList<T> Childern { get; private set; }

    public CustomerWithChildern()
    {
        Childern = new List<T>();
    }
}

public class SalesOffice : CustomerWithChildern<NationalNegotiation>
{
} 
```

SalesOffice 只是代表不同级别客户层次结构的少数类之一。现在我需要从某个点（CustomerBase）遍历这个层次结构。我不知道如何在不使用反射的情况下实现。我想实现类似的东西：

```
 public void WalkHierarchy(CustomerBase start)
    {
        Print(start.CustomerNumber);
        if (start is CustomerWithChildern<>)
        {
            foreach(ch in start.Childern)
            {
                WalkHierarchy(ch);
            }
        }
    } 
```

我有没有机会得到这样的工作？

* * *

基于我实现的建议的 has-childern 接口的解决方案：

```
public interface ICustomerWithChildern
{
    IEnumerable ChildernEnum { get; }
}

public abstract class CustomerWithChildern<T> : CustomerBase, ICustomerWithChildern
    where T: CustomerBase
{
    public IEnumerable ChildernEnum { get { return Childern; } }

    public IList<T> Childern { get; private set; }

    public CustomerWithChildern()
    {
        Childern = new List<T>();
    }
}

    public void WalkHierarchy(CustomerBase start)
    {
        var x = start.CustomerNumber;
        var c = start as ICustomerWithChildern;
        if (c != null)
        {
            foreach(var ch in c.ChildernEnum)
            {
                WalkHierarchy((CustomerBase)ch);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T15:11:53.003

您可以将 WalkHierarchy 方法移至基类并使其变为虚拟。基类实现只会处理当前节点。对于`CustomerWithChildern<T>`班级，覆盖将进行实际步行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T15:18:47.600

试试这个：

```
if(start.GetType().GetGenericTypeDefinition() == typeof(CustomerWithChildern<>)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T15:11:12.227

“Is”和“As”仅适用于完全限定的泛型类型。

有关包括变通方法在内的详细信息，请参阅[此 MSDN 讨论](http://code.msdn.microsoft.com/vslangfutures/Thread/View.aspx?ThreadId=696)。

我见过的最常见的解决方法是在您的 CustomerWithChildren 可以实现的组合中添加一个接口，并检查该接口。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T15:14:11.330

我相信您要查找是否要对 walk 接口进行确定。

因此，也许可以添加一个“IWalkable”接口来公开行走所需的信息，然后您可以创建您的方法来检查传递的对象是否实现了该接口。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T15:18:15.603

我认为每个人在第一次使用泛型类时都会遇到这个“问题”。

您的问题措辞暗示了您的第一个问题：开放泛型类型不是封闭泛型的基类。这里根本没有OO关系。真正的基类是 CustomerBase。一个“开放”的泛型类型就像一个半完成的类；指定类型参数“关闭”它，使其完整。

虽然你可以这样做：

```
Type t = typeof(CustomerWithChildern<>) 
```

条件

```
typeof(CustomerWithChildern<>).IsAssignableFrom(CustomerWithChildern<Foo>) 
```

永远是假的。

-Oisin

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T15:12:54.827

明确地使用该方法，不。但是，您可以使用接口实现相同的功能。事实上，你可以让你的泛型类实现 IEnumerable。还值得注意的是，您的类还应该具有“where T : CustomerBase”以确保类型安全。

# asp.net - ASP.NET 中这个 CRUD 搜索页面的最佳方法是什么

> ID：710121
> 
> 赞同：0
> 
> 时间：2009-04-02T15:08:55.880
> 
> 标签：asp.net, dynamic, crud

我正在构建一个基于 CRUD 的 ASP.NET 网站，我已经进入了项目的阶段，我正在尝试构建一个搜索网页，根据用户输入的参数向用户显示某个重要表的不同子集，例如作为日期和不同的文本字段。

我不能使用固定的 SQL 语句，因为根据他们是按日期搜索还是按其他方式搜索，SQL 会有所不同，所以我一直使用表格 Web 控件生成结果列表，该控件开始时是不可见的，然后是一旦用户确定他们想要进行的搜索，就会填充并设置为可见。我使用了表控件，因为它易于在后面的代码中创建和修改，并且我能够对数据库进行所需的调用并根据需要填充该表。

但是，我需要此搜索页面的第二件事是允许用户从结果中选择一条记录，然后使用站点上基于 CRUD 的其余页面对其进行编辑。为此，我在表中创建了 asp:buttons 并为它们提供了所有不同的 id 和相同的事件处理程序。但由于我动态创建了按钮，似乎事件在回调时消失了，我的方案失败了，所以我再看看如何做到这一点。

我当前的事件代码如下所示：

```
 tempcell = new TableCell();
 Button tempbutton = new Button();
 tempbutton.Text = "Go";
 tempbutton.ID = "gobutton" + rowN;
 tempbutton.Visible = true;
 tempbutton.Click += new EventHandler(tempbutton_Click);
 tempcell.Controls.Add(tempbutton);
 temprow.Cells.Add(tempcell); 
```

我的结果表声明如下：

```
<asp:Table ID="ResultTable" visible="false" runat="server" 
GridLines="Both" CellSpacing="8">
</asp:Table> 
```

我希望能够识别用户选择的记录，以便我可以将该信息发送到另一个页面。当然，我仍然需要能够为几个不同的搜索条件生成结果。目前我有基于日期、模板和代码的搜索，这些搜索会根据用户输入的内容导致不同的存储过程和不同的参数。

对此有何建议？似乎数据网格和转发器需要提前 SQL 语句才能正常工作，所以我不确定如何使用它们，但如果可以的话，项目命令方法将与按钮一起使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T15:11:34.847

如果在页面加载事件中重新创建按钮，您的事件将成功连接。

否则，请使用 GridView。它是简单 CRUD 的完美解决方案，您可以根据需要对其进行控制。

# usability - 我们让它可靠。下一步是什么？可用性？

> ID：710122
> 
> 赞同：4
> 
> 时间：2009-04-02T15:08:59.610
> 
> 标签：usability

我在一个小型开发小组工作。我们正在构建和改进我们的产品。

半年前，我们无法考虑更高的特性，比如可用性，因为我们的产品有很多问题。许多错误、高额技术债务、低性能和其他问题使我们无法专注于可用性。

随着时间的推移，我们已经大大改进了我们的流程。我们做了什么：

*   真正的敏捷迭代
*   持续集成
*   测试（单元测试、功能冒烟测试、性能）
*   代码质量“好”
*   无痛部署过程

所以我们现在正在生产稳定、可靠的版本。以下引用（转述）描述了我们目前的情况：

> 首先 - 让它工作；之后，使其可靠；之后，使其可用

我们是极客，所以我们不能靠自己“制作”出出色的 UI。那么我们应该怎么做呢？你能推荐什么方向？也许我们应该聘请兼职或全职的可用性专家？我们如何向利益相关者解释可用性的重要性？我们如何让他们相信这是有用的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-02T15:14:57.553

你的业务人员说什么会让你赚到最多的钱？去做。也许可用性是接下来要做的事情，也许是更多功能，也许是不同的产品。这不是“极客”一定能够猜到的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-02T15:19:59.297

我和你在同一条船上 - 我基本上生活在命令行上，我完全脱离了现代 UI（Web 和桌面应用程序）。

对我来说，解决方案是为我的所有 GUI 使用真正的 UI 开发人员，而我只是住在后端。

这种安排有很多好处：

*   您**不必再调试自己糟糕的 UI**了 :) 那是他们的工作，而且他们比您更擅长，所以不用担心。
*   您的**代码自然会倾向于使用 MVC**或至少是分层的 API 方法，这对于所有相关方来说都更容易编写代码。
*   优秀的 UI 人员**知道要问最终用户什么问题**，并且知道这些用户何时不知道他们在说什么。我当然没有这个技能。
*   你可以**做你最擅长**的事情，他们做他们最擅长的事情，从而使整个团队变得更强大。

缺点很明显 - 你不仅需要为有才华的 UI 开发人员找到钱，还需要找到有才华的 UI 开发人员！

现在，我不能代表你和你的公司在你的市场中的地位等等（我也不做商务演讲 :)）但是如果你能负担得起另一个雇佣，它会给团队带来更多的回报而不是成本位置。它对我有用！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-06T08:52:52.377

你问，“我们如何向利益相关者解释可用性的重要性？” 但我不确定你们自己是否明白！

完成“重要”事情后，交互设计 (iD) 和可用性并不是您可以附加到现有产品上的事情。他们应该从一开始就在那里，最好是在小迭代中进行小测试和研究。我说的是廉价和肮脏的 iD/可用性，诸如 lo-fi 原型设计之类的东西，只有四个人的用户测试，有足够的统计数据来检测用户错误等等。

如果您从一开始就没有考虑 iD/可用性，那么您可能最终会得到与竞争对手相同的蹩脚产品和/或在用户需要手术时为他们提供创可贴。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-02T15:12:20.227

你的用户想要什么？他们可能是最适合识别需求的人。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-02T15:27:10.853

你是了解和理解产品的人，所以不要认为仅仅因为其他人的头衔中有“可用性专家”，雇佣他们就会以某种方式使你的产品可用。

另外，不要削弱自己对可用性的直觉。作为程序员，您一直在使用软件，您认为哪些产品最有用？想想你喜欢它们的什么，并将它们与你的产品进行比较。

想想你的产品做了什么，想象你是必须使用该产品的人，想象*你*希望它如何工作。想想用户想要使用你的产品完成什么，并想象他们必须经历的步骤。似乎很容易理解该怎么做？可以用更少的步骤完成吗？

最重要的是，与您的客户交谈。找出他们觉得困惑或难以完成的事情。看看他们是否想出了自己的解决方法，以您最初没有想到的方式使用您的产品。

如果您在可用性方面投入的思考、计划和努力与提高可靠性和部署方面的投入一样多，那么您最终会得到一个更好的产品。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-02T15:25:49.627

在分析下一步时，这一切都归结为业务需求和目标。

高层管理人员是什么样的？他们精通技术吗？他们对新想法持开放态度吗？他们是否认为目前的产品需要调整、改进等？该产品的需求量仍然很大吗？市场是否正在发生变化，以至于产品/服务很快就会过时？等等等等等等

如果有真正的商业原因花费 $/时间/资源，那么您可以开始探索产品改进。此时，请考虑以前发布者关于用户意见的意见。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-02T15:15:41.107

我认识很多极客，包括我自己，他们都知道可用性，所以一种方法是学习它。另一种方法是让可以做 UI 设计和可用性的人进来。

让他们相信可用性很重要： **如果你不能使用它，那就没用了！**

我不知道你开发了什么样的产品，但你总是有客户，而且客户总是喜欢可用的应用程序。这将增加销售额、满意的客户数量并减少技术支持。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-02T15:18:41.000

它对您的用户有什么作用？他们如何看待可用性？也许这对他们来说不是问题。

让它对您的用户更有价值。提供更多商业价值。帮助您的客户获得更好的投资回报。通过让它做更多他们需要做的事情、做得更好（更准确、更快速、更可靠、更有用）或以更低的成本来做（运行它所需的基础设施更少，降低维护成本）来做到这一点因为你提高了可靠性），更灵活（处理他们的业务变化）......

许多维度确实与您所指的技术维度相关（可用性、可靠性、稳定性等）。但是付费客户通常关心他们的业务需求/功能，而不是提供它们的技术需求。

与您的用户（或潜在用户）交谈

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-02T15:32:05.990

我关于可用性重要性的单线：

*   一个不可用的可靠系统有什么用？

如果您有现有用户的现有产品，那么是什么让您认为您当前的 UI 不可用？

您是否怀疑您可以进行一些微小的更改来极大地提高可用性，或者需要一些更具革命性的东西？如果是后者，那么你现有用户的需求呢，他们是否愿意重新学习一个全新的 UI？

## 编辑

由于各种原因，用户界面可以被认为是“差”...

*   它只是普通的丑陋/老式/不“看起来像 Windows 应用程序”
*   它使用与用户理解或想做的事情无关的隐喻或工作流程

其中第一个相对容易修复，尤其是如果您聘请了一位出色的设计师。解决方法相当于重新装修您的休息室并购买新的沙发和电视。一样的房间，不一样的体验。您现有的用户仍然可以使用此应用程序。

修复其中的第二个会变得更加复杂和复杂，并且可能会真正影响您的代码库。如果不了解有关您的应用程序的更多信息，很难进一步发表评论。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-07T10:32:11.567

我认为答案是按顺序排列的，你说：

“首先 - 让它工作；然后，让它可靠；然后，让它可用​​”

但这里最重要的是“让它发挥作用”。功能“工作”的接受标准是它实际上是可用的。如果没有，则不会执行。那么它只是一个死代码块。死代码首先不应该在系统中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-02T15:18:24.480

制作用户界面。

然后把它扔掉，在你尝试使用第一个之后再做一个。然后尽可能简化。只要您可以通过编程方式确定用户想要从输入中得到什么，而不是多个显式选择，就这样做。按钮太多会导致瘫痪。

# .net - 如何在 ASP.NET 中的代码后面创建文件夹？

> ID：710123
> 
> 赞同：-4
> 
> 时间：2009-04-02T15:09:11.543
> 
> 标签：.net, asp.net, directory

我想在运行时创建动态文件夹。通过 TextBox 输入和输出的文件夹名称将显示在 TreeView 中。

如果我在 textbox1 中输入第一个文件夹名称并单击“添加文件夹”按钮，该表单将提交。当我提交多个同名文件夹时，输出应该是名称的索引增量。例如。FooFolder、FooFolder(2)、FooFolder(3) 等

如果我删除 FooFolder(2)，然后重新创建一个名为 FooFolder 的文件夹，该文件夹应该是 FooFolder(2)，如果我再创建一个文件夹，那么它应该是 FooFolder(4)。

对于删除，可以从将显示在 TextBox2 中的 TreeView 中选择特定文件夹，然后单击“删除文件夹”按钮。

这是我的演示代码：

```
<asp:Button ID="btnAddFolder" runat="server" Height="24px" Text="Add Folder" 
        Width="148px" onclick="btnAddFolder_Click" />
    <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
    <br />
    <asp:Button ID="btnRemoveFolder" runat="server" Text="Remove Folder" />
    <asp:TextBox ID="TextBox2" runat="server"></asp:TextBox>
    <br />
    <br />
    <asp:TreeView ID="TreeView1" runat="server" ImageSet="XPFileExplorer" 
        NodeIndent="15">
        <ParentNodeStyle Font-Bold="False" />
        <HoverNodeStyle Font-Underline="True" ForeColor="#6666AA" />
        <SelectedNodeStyle BackColor="#B5B5B5" Font-Underline="False" 
            HorizontalPadding="0px" VerticalPadding="0px" />
        <NodeStyle Font-Names="Tahoma" Font-Size="8pt" ForeColor="Black" 
            HorizontalPadding="2px" NodeSpacing="0px" VerticalPadding="2px" />
    </asp:TreeView> 
```

现在我该如何编写代码来完成这项工作？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-02T15:21:08.297

你的问题有点不清楚，但无论如何我都会试着让你有一些方法。

首先确保您正在导入/使用（取决于语言）System.IO 命名空间以使其正常工作。但是你能做的就是这样。

```
string pathToCreate = "~/UserFolders/" + TextBox1.Text;
if(Directory.Exists(Server.MapPath(pathToCreate))
{
   //In here, start looping and modify the path to create to add a number
   //until you get the value needed
}

//Now you know it is ok, create it
Directory.CreateDirectory(Server.MapPath(pathToCreate)); 
```

无论如何，这应该可以帮助您创建文件夹。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-02T15:19:11.577

您可以读取子目录的目录，将目录名称与给定名称（在文本框中输入）进行比较。如果找到，您可以附加计数器值。如果文件夹名称类似于“()”，则需要增加此计数器。获得正确的名称后，即附加计数器值后，您可以调用 win32 API 来创建目录

```
int SHCreateDirectory(HWND hwnd, LPCWSTR pszPath); 
```

编辑：您可以根据操作系统、技术调用特定的 API 来创建目录。以上是针对Win32的。

# objective-c - 观察派生属性的变化：CALayer KVO 示例

> ID：710127
> 
> 赞同：1
> 
> 时间：2009-04-02T15:09:58.250
> 
> 标签：objective-c, cocoa

有没有办法观察派生属性的变化？例如，我想知道何时将 CALayer 添加为子图层，以便我可以相对于其（新）父图层调整其几何形状。

所以，我有一个子类 CALayer，比如 CustomLayer，我想我可以在 init 中为该属性注册一个观察者：

```
[self addObserver:self forKeyPath:@"superlayer" options:0 context:nil] 
```

并实施`observeValueForKeyPath:ofObject:change:context`。什么都没有发生，因为大概 superlayer 是一个派生属性（attr 字典为父级存储了一个不透明的 ID）。同样，我不能子类化`setSuperlayer:`，因为它永远不会被调用。事实上，据我所知，当父级调用时，子层上没有调用实例方法或设置公共属性`[self addSublayer:aCustomLayer]`。

然后我想，好吧，我会像这样子类 addSublayer：

```
- (void)addSublayer:(CALayer *)aLayer {
    [aLayer willChangeValueForKey:@"superlayer"];
    [super addSublayer:aLayer];
    [aLayer didChangeValueForKey:@"superlayer"];
} 
```

但仍然没有！（也许这是一个线索，当我制作一个简单的独立测试类并使用`will[did]ChangeValueForKey:`它时它可以工作。）这可能是一个更一般的 Cocoa KVO 问题。我应该做什么？提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-02T15:34:29.917

好吧，`superlayer`被定义为一个`readonly`属性，这意味着没有`setSuperlayer:`方法。（如果有，它将是私有的，您可能不应该使用它。）如果我不得不猜测，那就是该`superlayer`属性不符合 KVO。而且，除此之外，我通常认为让班级观察自己并不是一个好主意。

也许还有另一种方法可以做到这一点。当一个层被添加到一个超层时，`onOrderIn`动作就会发生。现在，`actionForKey:`是一个实例方法，它为层提供了为某些属性自定义默认动画的机会。您可以覆盖`actionForKey:`以检测`onOrderIn`操作何时发生，做您的事情，然后调用`super`'s implementation。

不过，我也认为这是一个非常混乱的黑客行为。但它应该比必须对所有内容都使用自定义层和弄乱 KVO 消息更“独立”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T15:30:45.543

> ```
> [self addObserver:self forKeyPath:@"superlayer" options:0 context:nil] 
> ```

不要通过 KVO 观察自己。改为更改您的访问器。

> 同样，我不能继承 setSuperlayer: 因为它永远不会被调用。

我认为你尝试了这个并添加了 NSLog 并发现它没有被调用？

> 然后我想，好吧，我会像这样子类 addSublayer：
> 
> ```
> - (void)addSublayer:(CALayer *)aLayer {
>     [aLayer willChangeValueForKey:@"superlayer"];
>     [super addSublayer:aLayer];
>     [aLayer didChangeValueForKey:@"superlayer"];
> } 
> ```

而且父层也是CustomLayer吧？如果父层是一个普通的 CALayer，那么您在 CustomLayer 中所做的任何事情都将无效。

# apache - htaccess 显示持有页面

> ID：710145
> 
> 赞同：0
> 
> 时间：2009-04-02T15:14:07.897
> 
> 标签：apache, .htaccess

嗨，我想向外部用户显示一个保留页面，但可以从我的机器上访问该站点。我可以用 htaccess 做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T15:18:38.287

```
RewriteEngine On 
RewriteCond !REMOTE_ADDR=127.0.0.1
RewriteRule .* /holdingPage.html [R,L] 
```

替换`127.0.0.1`为您机器的 IP。

[http://httpd.apache.org/docs/2.2/howto/access.html](http://httpd.apache.org/docs/2.2/howto/access.html)

[http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)

# sql-server - 截断错误 SQL server 2005 删除/插入

> ID：710148
> 
> 赞同：0
> 
> 时间：2009-04-02T15:14:13.030
> 
> 标签：sql-server, ssis, bulkinsert, truncation

所以我正在尝试使用 SSIS 进行批量插入并不断获得：

“Microsoft SQL Native Client”Hresult：0x80004005 描述：“字符串或二进制数据将被截断。”

即使我已经将每一列的数据转换为与插入行的表完全相同的类型。我使用了一个视图，数据看起来就像它应该在数据库插入步骤之前一样。仍然得到错误。

接下来，我进入 sql server management studio 并在该该死的表中设置了一个插入查询，但仍然得到相同的截断错误。然后我设置了 ANSI_WARNINGS OFF 并且插入的工作数据在表中看起来不错。现在，当我尝试删除此行时，出现截断错误。

除了对这种情况的任何基本输入之外，我的问题是如何关闭 SSIS 中的 ANSI_WARNINGS 以便批量加载可以继续？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T15:19:46.363

听起来您的列太窄而无法接受您提交的数据。

你能验证这是否是这种情况吗？

当我们与第三方确定架构时，我经常遇到一个非常类似的问题。

您可以选择视图中所有列的 LEN 吗？这可以帮助找到问题。

除此之外，我发现的唯一方法是打印出源数据列实际长度的报告。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T15:21:01.993

听起来您有一行（可能更多，但只需要一行！）其中您的数据值超过了表列的长度。将数据转换为较短的类型会将错误移动到从目标进行转换的任何转换。我建议创建一个平面文件目标，并将转换的错误输出绑定到它。将错误结果更改为“重定向行”。这将允许所有有效行通过，并为您提供被截断的行的副本供您手动处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T15:16:09.703

您要插入的表上是否有触发器？那么错误可能来自触发器执行的操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T16:25:19.030

事实证明，在 SSIS 中，您可以使用“数据访问模式 > 表或视图：快速模式”设置 OLE DB 目标。当我选择此设置时，批量插入没有任何警告或错误，并且数据库中的数据看起来很完美。不确定此更改到底做了什么，但它起作用了，在一个 SSIS 插入 16 小时后，我对结果感到满意。

感谢您的建议。

# asp.net - How to skin all ASP.Net validators?

> ID：710154
> 
> 赞同：2
> 
> 时间：2009-04-02T15:16:21.993
> 
> 标签：asp.net, themes, skin

I want all of the validators in an ASP.Net 3.5 website to have a CssClass value of "error". My initial thought was to do this in a theme skin like so:

```
<asp:CompareValidator runat="server" 
    CssClass="error" />
<asp:CustomValidator runat="server" 
    CssClass="error" />
<asp:RequiredFieldValidator runat="server" 
    CssClass="error" />
<belCommon:ZipCodeValidator runat="server" 
    CssClass="error" />
<belCommon:PhoneNumberValidator runat="server" 
    CssClass="error" /> 
```

This is only a partial listing of validators that I use. Ideally, I would like to do something like this:

```
<asp:BaseValidator runat="server" 
    CssClass="error" /> 
```

And because all validators inherit from BaseValidator, I would expect that this would work, but it doesn't. Is there a way to accomplish this without adding every single validator control to the skin explicitly?

**Update:**

I found a different approach using javascript:

```
Sys.Application.add_init(function(sender, args)
{
    if (Page_Validators != null)
    {
        for (i = 0; i < Page_Validators.length; i++)
        {
            Page_Validators[i].className = "error";
        }
    }
}); 
```

ASP.Net generates a javascript variable called Page_Validators, which is an array of the validation spans. This script checks to see if it exists and then loops through and sets the class name. I added this to the master page and its working so far.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T15:25:34.150

Not that I am aware of, when defining a skin you are specifically working with individual controls and you don't have a way of specifying it any other way, as it matches based on the tags used.

From the looks of it though, you are creating your own custom validators as well, you might modify your controls to have a default cssclass of error to save a bit of time.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T15:28:59.040

I'd be tempted to iterate over the controls of the page in the server pageload method and to apply the css class there:

```
foreach (object obj in this.Controls)
{
  if (obj is BaseValidator)
  {
     ((BaseValidator)obj).CssClass = "error";
  }
} 
```

This may not be the best way to do this and I've not had the opportunity to test it but hopefully it might help you along the way.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T13:09:30.497

I found a different approach using javascript:

```
Sys.Application.add_init(function(sender, args)
{
    if (Page_Validators != null)
    {
        for (i = 0; i < Page_Validators.length; i++)
        {
            Page_Validators[i].className = "error";
        }
    }
}); 
```

ASP.Net generates a javascript variable called Page_Validators, which is an array of the validation spans. This script checks to see if it exists and then loops through and sets the class name. I added this to the master page and its working so far.

# html - 为什么我的列表项项目符号与浮动元素重叠

> ID：710158
> 
> 赞同：171
> 
> 时间：2009-04-02T15:17:53.763
> 
> 标签：html, css

我有一个（XHTML Strict）页面，在该页面中，我将图像与常规文本段落一起浮动。一切顺利，除非使用列表而不是段落。列表的项目符号与浮动图像重叠。

更改列表或列表项的边距没有帮助。边距是从页面左侧计算的，但浮动将列表项推到自身*内部*的右侧`li`。因此，仅当我使其比图像更宽时，边距才有帮助。

浮动图像旁边的列表也可以，但我不知道列表何时在浮动旁边。我不想为了解决这个问题而浮动我的内容中的每个列表。*此外，当图像浮动到列表的右侧*而不是左侧时，向左浮动会弄乱布局。

设置`li { list-style-position: inside }`确实会随着内容移动项目符号，但它也会导致换行开始与项目符号对齐，而不是与上面的行对齐。

问题显然是由于子弹被渲染在盒子外面，浮动将盒子的内容推到了右边（而不是盒子本身）。这就是 IE 和 FF 处理这种情况的方式，据我所知，根据规范并没有错。问题是，我该如何预防呢？

* * *

## 回答 #1

> 赞同：289
> 
> 时间：2009-04-02T15:37:23.873

我找到了解决这个问题的方法。将 an`ul { overflow: hidden; }`应用于`ul`确保盒子本身被浮动推到一边，而不是盒子的内容。

只有 IE6 需要`ul { zoom: 1; }`在我们的条件注释中添加一个来确保`ul`有布局。

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2012-08-10T14:48:48.537

对[Glen E. Ivey 的解决方案](https://stackoverflow.com/a/2344795/901048)进行改进：

```
ul {
    list-style: outside disc;
    margin-left: 1em;
}
ul li {
    position: relative;
    left: 1em;
    padding-right: 1em;    
}​ 
```

[http://jsfiddle.net/mblase75/TJELt/](http://jsfiddle.net/mblase75/TJELt/)

我更喜欢这种技术，因为当列表需要围绕浮动图像流动时它可以工作，而该`overflow: hidden`技术不会。但是，还需要添加`padding-right: 1em`以`li`防止它们溢出容器。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2012-07-02T11:56:45.130

这就是“显示”属性发挥作用的地方。设置下面的 CSS 以使列表与浮动内容一起工作。

显示：表格；与浮动内容一起工作（填补空白），但不隐藏内容。就像一张桌子一样:-)

```
.img {
  float: left;
}

.table {
  display: table;
}
```

```
<img class="img" src="https://via.placeholder.com/350x350" alt="">
<ul>
  <li>Test content</li>
  <li>Test content</li>
  <li>Test content</li>
</ul>
<ul class="table">
  <li>Test content</li>
  <li>Test content</li>
  <li>Test content</li>
</ul>
```

编辑：请记住添加一个类来隔离您希望为其执行此操作的列表。例如“ul.in-content”或更一般的“.content ul”

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2009-04-02T15:26:52.493

尝试[list-style-position: inside](http://www.w3schools.com/CSS/pr_list-style-position.asp)更改项目符号的布局。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2014-08-06T14:14:57.397

# 为什么`overflow: hidden`有效

解决方案很简单：

```
ul {overflow: hidden;} 
```

一个块框，`overflow:`除了为它的内容`visible` **建立一个新的块格式化上下文**。W3C 推荐：[http ://www.w3.org/TR/CSS2/visuren.html#block-formatting](http://www.w3.org/TR/CSS2/visuren.html#block-formatting)

## 例子

[我网站](https://hamwaves.com/solar.wind/en/index.html)上`<li>`伪装的按钮是这样制作的。缩小浏览器的视口（窗口）以[查看实际的**缩进**](https://hamwaves.com/solar.wind/en/index.html)。

![以我的网站为例](https://i.imgur.com/zYx6Jty.png)

## 相关答案

*   [https://stackoverflow.com/a/710264/2192488](https://stackoverflow.com/a/710264/2192488)
*   [https://stackoverflow.com/a/16041390/2192488](https://stackoverflow.com/a/16041390/2192488)

## 带有示例的文章

*   [溢出——一个秘密的好处](http://www.stubbornella.org/content/2009/07/23/overflow-a-secret-benefit/)

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2010-02-26T20:57:44.277

在[http://archivist.incutio.com/viewlist/css-discuss/106382](http://archivist.incutio.com/viewlist/css-discuss/106382)我发现了一个对我有用的建议：用以下方式设置“li”元素的样式：

```
position: relative;
left: 1em; 
```

如果浮动不存在，则将“1em”替换为列表项将具有的左侧填充/边距的宽度。这在我的应用程序中效果很好，甚至可以处理浮动底部出现在列表中间的情况——项目符号正好移回（本地）左边距。

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2012-04-30T08:10:18.510

至少为我添加`overflow: auto;`你的作品。`ul`

**更新**

我已经更新[了我的 jsfiddle](http://jsfiddle.net/1jgfkh6c/)以可视化正在发生的事情。在`ul`浮动旁边时，浮动`img`的内容`ul`将被浮动推送，而不是实际的容器。通过添加`overflow: auto`整个`ul`-box 将被浮动推送，而不仅仅是内容。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2010-05-03T17:13:58.847

您可以分配`position: relative; left: 10px;`给`li`. （您可能还想给它一个`margin-right: 10px;`，否则它可能会在右侧变得太宽。）

或者，如果你想使用`float`-`ul`正如其他人所建议的那样 - 你可以通过在 ul 后面`clear: left`的元素上使用来阻止其余部分在 ul 的右侧浮动。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2015-02-26T20:20:05.833

### 免责声明

浮动元素旁边的列表会导致问题。在我看来，防止此类浮动问题的最佳方法是避免与内容相交的浮动图像。当您必须支持响应式设计时，它也会有所帮助。

段落之间居中图像的简单设计看起来非常有吸引力，并且比试图变得过于花哨更容易支持。这也离a一步之遥`<figure>`。

## 但我真的想要浮动图像！

好的，因此，如果您足够~~坚持不懈~~地沿着这条道路继续前进，那么可以使用几种技术。

最简单的方法是使列表使用`overflow: hidden`或`overflow: scroll`使列表本质上是收缩包装，从而将填充拉回到有用的位置：

```
img {
  float: left;
}
.wrapping-list {
  overflow: hidden;
  padding-left: 40px;
}
```

```
<img src="http://placehold.it/100x100"/>
<ul class="wrapping-list">
  <li>lorem</li>
  <li>ipsum</li>
  <li>dolor</li>
  <li>sit</li>
  <li>amet</li>
</ul>
```

这种技术虽然有一些问题。如果列表变长，它实际上并没有环绕图像，这几乎违背了`float`在图像上使用的整个目的。

```
img {
  float: left;
}
.wrapping-list {
  overflow: hidden;
  padding-left: 40px;
}
```

```
<img src="http://placehold.it/100x100"/>
<ul class="wrapping-list">
  <li>lorem</li>
  <li>ipsum</li>
  <li>dolor</li>
  <li>sit</li>
  <li>amet</li>
  <li>lorem</li>
  <li>ipsum</li>
  <li>dolor</li>
  <li>sit</li>
  <li>amet</li>
  <li>lorem</li>
  <li>ipsum</li>
  <li>dolor</li>
  <li>sit</li>
  <li>amet</li>
</ul>
```

## 但我真的想要包装清单！

好的，所以如果你更~~疯狂~~更持久，并且你**绝对必须**沿着这条路继续下去，还有另一种技术可以用来包装列表项和维护项目符号。

与其填充 the`<ul>`并试图让它与子弹表现得很好（它似乎永远不想这样做），不如将这些子弹从 s 中拿走`<ul>`并将它们交给`<li>`s。子弹是危险的，`<ul>`只是没有足够的责任来正确处理它们。

```
img {
  float: left;
}
.wrapping-list {
  padding: 0;
  list-style-position: inside;
}
.wrapping-list li {
  overflow: hidden;
  padding-left: 25px;
}
```

```
<img src="http://placehold.it/100x100"/>
<ul class="wrapping-list">
  <li>lorem</li>
  <li>ipsum</li>
  <li>dolor</li>
  <li>sit</li>
  <li>amet</li>
  <li>lorem</li>
  <li>ipsum</li>
  <li>dolor</li>
  <li>sit</li>
  <li>amet</li>
  <li>lorem</li>
  <li>ipsum</li>
  <li>dolor</li>
  <li>sit</li>
  <li>amet</li>
</ul>
```

这种包装行为可以对复杂的内容做一些奇怪的事情，所以我不建议默认添加它。将其设置为可以选择的东西而不是必须被覆盖的东西要容易得多。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2013-09-02T11:51:28.923

我正在使用它来解决这个问题：

```
ul {
   display: table;
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-03-13T19:09:31.680

在您的 UL 标签上尝试以下操作。这应该照顾覆盖您图像的子弹，并且您不必弄乱由`list-position: inside`.

```
overflow: hidden; 
padding-left: 2em; 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2011-04-29T19:17:42.553

我自己也在为此苦苦挣扎。我管理过的最好的情况如下：

```
ul {
    list-style-position: inside;
    padding-left: 1em;
    text-indent: -1em;
} 
```

文本实际上没有缩进，但项目符号显示。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2015-02-04T10:52:21.717

在几个项目中解决了这个有趣的问题并调查了它发生的原因之后，我终于相信我找到了两者：一个**有效的和“响应式”的**解决方案。

这是魔术，现场示例：http: [//jsfiddle.net/superKalo/phabbtnx/](http://jsfiddle.net/superKalo/phabbtnx/)

```
ul {
    list-style: none;
    position: relative;
    padding-left: 0; /* remove any left padding */
    margin-left: 0; /* remove any left margin */
    left: 35px;
}
li {
    padding-left: 0; /* remove any left padding */
    margin-left: 0; /* remove any left margin */
    text-indent: -19px; /* adjust as much as needed */
}
li:before {
    content: '•\00a0\00a0\00a0';
    color: #000; /* bonus: you can customize the bullet color */
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-05-03T16:07:29.807

根据OP的评论编辑更新

好的，然后将其分解为嵌套在一起的 2 个 div

```
ul  {background: blue; position:static;}
.therest {position:relative; width:100%}
.indent {float:left; }

<div class="therest">
<p>
Est tincidunt doming iis nobis nibh. Ullamcorper eorum elit lius me delenit. 
</p>
<hr />
<h3>Lorem</h3>
<div class="indent">
<ul>
<li>list element</li>
<li>list element</li>
<li>list element</li>
</ul> 
<div>
the rest now under the UL
</div> 
```

尝试将 ul li css 更改为

ul {浮动：左；背景：蓝色；}

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-09-07T22:10:41.523

在 LMS 中工作而无需访问文档负责人，发现它更容易`margin-right: 20px`作为图像的内联样式使用。我欠这个[网站](http://www.velocityreviews.com/forums/t164786-bullets-overlapping-image-aligned-to-left.html)的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-05-03T16:11:14.070

试试这个：

```
li{
    margin-left:5px;
} 
```

如果您希望它们向左移动，只需输入 -##px 值。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-05-03T16:55:56.403

或者你可以这样做：

```
 #content ul {
        background:none repeat scroll 0 0 #AACCDD;
        float:left;
        margin-right:10px;
        padding:10px; 
```

然后从 li 中删除所有样式

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-02-11T20:20:51.443

```
width: 300px;
height: 30px;
margin-left: auto;
right: 10px; 
```

margin-left: auto 将导致元素本身右对齐。设置您想要的元素的高度和宽度 - 在我的它是一个 div 里面的背景图像

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-04-29T19:26:10.560

这个怎么样？

```
ul{float:left; clear:right} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-04-30T08:07:44.763

您也可以尝试将 浮动`ul`到左侧，并`width`为它定义一个合适的，以便它浮动在图像旁边。

有点像[这个 jsfiddle](http://jsfiddle.net/CEWsT/2/)的东西？

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-01-29T20:09:29.203

我用

```
div.class-name ul {
  clear: both;
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-06-01T14:23:06.957

```
width: auto; overflow: hidden; 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2015-06-01T14:39:07.140

添加`display:table;` 到`ul`：

```
ul{display:table;} 
```

# django - 基于第三模型的多对多关系的django模型结构

> ID：710171
> 
> 赞同：1
> 
> 时间：2009-04-02T15:19:52.447
> 
> 标签：django, django-models

我目前有三个模型：

```
class Request(models.Model):
    requester=models.CharField()
    dateRequested = models.DateField(auto_now=True)
    title= models.CharField(max_length=255)
    description = models.TextField()

class RequestType(models.Model):
    requestType=models.CharField('Request Type', max_length=256)

class RequestTypeInfo(models.Model):
    requestType=models.ForeignKey('RequestType', verbose_name='Request Type')
    title = models.CharField('title', max_length=256)
    info = models.CharField(max_length=256, blank=True) 
```

这个想法是每个请求都显示所有类型的请求共有的信息，并且根据选择的请求类型向用户提供要填写的附加字段。

我将如何更改模型以允许这样做，以及我将如何编写视图以向用户显示表单，以便附加信息与基本请求一致显示。最好有第二个视图来询问更多信息。

最终目标是管理员可以创建新的请求类型，而无需在 python 中创建模型，只需添加新请求并添加任何其他信息字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T16:54:28.663

那么您是说您想使用 RequestType 作为中间模型来创建从 Request 到 RequestTypeInfo 的多对多关系吗？

```
class Request(models.Model):
    requester=models.CharField()
    dateRequested = models.DateField(auto_now=True)
    title= models.CharField(max_length=255)
    description = models.TextField()
    request_type = models.ManyToManyField(RequestType, through='RequestTypeInfo')

class RequestType(models.Model):
    requestType=models.CharField('Request Type', max_length=256)

class RequestTypeInfo(models.Model):
    requestType=models.ForeignKey('RequestType', verbose_name='Request Type')
    title = models.CharField('title', max_length=256)
    info = models.CharField(max_length=256, blank=True) 
```

在澄清这一点后，我们可以讨论内联管理模型。

# php - phpmyadmin 安全

> ID：710176
> 
> 赞同：3
> 
> 时间：2009-04-02T15:20:53.833
> 
> 标签：php, apache2, phpmyadmin

我有一个带有 apache2、php、mysql 的生产服务器。我现在只有一个站点（mysite.com）作为虚拟主机。我想把 phpmyadmin、webalizer 和 webmin 放在那里。到目前为止，我安装了 phpmyadmin，它可以工作，但整个互联网都可以访问 mysite.com/phpmyadmin

如何将可见性降低到 192.168.0.0/16，以便防火墙后面的机器可以访问它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T15:28:47.497

**1）您可以在 Web 服务器级别执行此操作。**

对 apache 使用允许/拒绝规则。如果您无法直接访问 apache 配置文件，则可以使用 .htaccess 文件。

```
<Directory /docroot>
    Order Deny,Allow
    Deny from all
    Allow from 10.1.2.3
</Directory> 
```

**2) 您可以使用 phpmyadmin 配置文件在应用程序级别执行此操作。**

配置参数为：`$cfg['Servers'][$i]['AllowDeny']['rules']`

规则示例如下：

```
'all' -> 0.0.0.0/0
'localhost' -> 127.0.0.1/8
'localnetA' -> SERVER_ADDRESS/8
'localnetB' -> SERVER_ADDRESS/16
'localnetC' -> SERVER_ADDRESS/24 
```

您可以在官方 phpMyAdmin 配置文档中看到这一点。

[http://www.phpmyadmin.net/documentation/#servers_allowdeny_order](http://www.phpmyadmin.net/documentation/#servers_allowdeny_order)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T15:28:27.577

您将在 Apache 中使用一个名为[mod_access的模块](http://httpd.apache.org/docs/2.0/mod/mod_access.html)

您可以在 apache 配置文件或目录根目录的 .htaccess 文件中对其进行配置。

这是一个简短的例子

```
<Directory /your_folder/location>
    Order Deny,Allow
    Deny from all
   Allow from 123.123.123.123
</Directory> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T15:28:31.320

使用[<Location>](http://httpd.apache.org/docs/2.2/mod/core.html#location)指令（在服务器配置中，或者如果允许，在 .htaccess 中）。在那里，您可以使用拒绝访问*除*某些特定来源之外`Allow from`的其他所有人。

 *# sql - 当文本字段是 MS SQL Server 2000 中返回字段的一部分时，如何选择不同的行？

> ID：710179
> 
> 赞同：1
> 
> 时间：2009-04-02T15:21:12.053
> 
> 标签：sql, sql-server, sql-server-2000

我有一个数据库驱动的常见问题解答，它被组织成几个部分，我试图只为那些有问题/答案的部分获取部分数据。

这是架构：

```
|---------------------|      |----------------------|
|       Section       |      |       Quest-Ans      |
|---------------------|      |----------------------|
| PK | id(int)        |<--|  | PK     | id(int)     |
|    | title(varchar) |   |--| FK     | Sec_id(int) |
|    | desc(text)     |      |        | body(text)  |
|---------------------|      |----------------------| 
```

当我尝试这个查询时：

```
SELECT DISTINCT s.id, s.title, s.desc
FROM Section as s INNER JOIN Quest-Ans as q ON s.id = q.Sec_id 
```

我收到一条错误消息，说 DISCRETE 不能应用于文本字段。我怎样才能得到我想要的数据？

如果重要的话，这是一个 SQL2000 数据库。

编辑：

* * *

好的，所以似乎有两种方法可以解决这个问题。在 where 子句中使用 EXISTS 和子查询，或者使用内部联接中的子查询。哪个更快？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T15:22:48.963

这应该这样做：

```
SELECT s.id, s.title, s.desc
FROM Section as s 
WHERE EXISTS (SELECT * FROM Quest-Ans as q where q.Sec_id = s.id) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T15:41:29.370

```
select s.id, s.title, s.desc
from Section s 
inner join (select distinct sec_id from Quest-Ans) dqa on s.id = dqa.sec_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T15:24:27.413

尝试一下：

```
SELECT s.Title, s.Desc
FROM Section as s
INNER JOIN (
  SELECT DISTINCT s.id
  FROM Section as s 
  INNER JOIN Quest-Ans as q ON s.id = q.Sec_id
) q ON s.Id = q.Id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-05T16:24:00.280

尝试 CONVERT ， DISTINCT CONVERT(VARCHAR(500), "text field")

# c# - 从 DataReader 访问 DateTime 字段时出现 MySqlConversionException

> ID：710182
> 
> 赞同：5
> 
> 时间：2009-04-02T15:21:50.367
> 
> 标签：c#, mysql, datetime, idatareader

我在 MySql 上有一个 C# 应用程序，使用[MySQL Connector](http://www.mysql.com)；我正在尝试发出 DataReader 请求，查询执行良好，但是，当尝试访问 DateTime 字段时，我得到 MySqlConversionException {"Unable to convert MySQL date/time value to System.DateTime"}

这是原型

```
if (dr != null && !dr.Read()) return;

sesion.Id = Convert.ToInt32(dr["id"]);
sesion.Usuario = Convert.ToInt32(dr["usuario"]);
sesion.Estado = Convert.ToByte(dr["estado"]);
// doesn't work
sesion.FchCreacion = Convert.ToDateTime(dr["fch_creacion"]); 
```

有什么建议么？提前致谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-02T15:25:15.383

如果您的 MySQL 数据库中的日期时间值为零 (00/00/0000 00:00)，则有时会发生此错误。尝试将其添加到连接字符串的末尾：

```
Allow Zero Datetime=true 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T15:35:21.897

There are a few potential gotchas when converting between MySQL dates/times and .NET DateTimes, but there's a [useful section in the MySQL documentation](http://dev.mysql.com/doc/connector-net/en/connector-net-programming-datetime.html) with advice on how to handle the issues.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T15:24:07.057

我建议这可能是特定于文化的错误 - 应用程序是否与数据库位于同一服务器上，它们是否具有相同的文化设置？

另外，该列绝对是 MySQL 中的日期时间吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T15:25:04.043

它也可以是一个 DBNull 值。

# jakarta-ee - 如何强制用户在 Jboss/J2EE 中只登录一次？

> ID：710183
> 
> 赞同：0
> 
> 时间：2009-04-02T15:21:54.440
> 
> 标签：jakarta-ee, jboss

我需要强制某些用户（具有 true 标志的用户）只能有 1 个活动会话。我的意思是，用户登录 1 个浏览器，但无法登录另一个浏览器/计算机。

我尝试使用自己的登录模块，但第二次登录（在另一个浏览器中）时，没有使用登录模块，似乎有些东西正在被缓存......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T15:30:57.243

如果您使用[Spring Security](http://static.springsource.org/spring-security/site/index.html)，则有一个用于[并发会话控制](http://static.springsource.org/spring-security/site/reference/html/ns-config.html#ns-concurrent-session)的选项。您只需要 1 个会话。有一个关于[将 Spring Security 与 JBoss 集成](http://static.springsource.org/spring-security/site/reference/html/ca.html#ca-jboss)的解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T18:42:03.513

您只需要在有人登录时检查登录用户的应用程序范围映射。存储会话 ID 和用户 ID。

你在使用框架吗？如果有，是哪一个？

# vb.net - 具有不同凭据的 VB.Net File.Copy/File.Move

> ID：710186
> 
> 赞同：2
> 
> 时间：2009-04-02T15:22:41.100
> 
> 标签：vb.net, impersonation, .net

理想情况下，我希望能够在本地驱动器上的可访问文件夹和我无权访问（但应用程序会）的网络共享之间复制/移动。

我正在使用模拟来访问网络共享中的文件，但使用 System.IO File.Move 或 File.Copy 会强制我对每个位置使用相同的凭据。有没有解决的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T15:27:45.610

我相信你可以做的是这样的事情。

1.  进行模拟以允许选择文件。将文件复制到应用程序可以到达的位置。
2.  停止模拟，然后让应用程序将文件从临时位置复制到所需的最终结果。

我们以前在我们的应用程序中做过这个，它并不优雅，但它工作得很好！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T21:12:21.683

我们做了类似于 Mitchel Sellers 正在做的事情，只是我们没有两个身份都可以读取的位置。我们正在使用本地上下文将数据块读入内存并在模拟远程用户时将它们写出。

# c# - 在 for 循环中构建 linq to sql 谓词

> ID：710188
> 
> 赞同：0
> 
> 时间：2009-04-02T15:22:54.327
> 
> 标签：c#, linq, linq-to-sql

我正在使用一个循环构建一个 LINQ 查询，该循环使用一个数组附加谓词：

```
foreach (string tag in tags)
{
    result = result.Where(p => (p.TagsDelimited).Contains("," + tag + ","));
} 
```

这将创建所有必要的子句，但每个子句仅比较 tags 数组中的最后一个元素，生成 sql

```
(((',' + [t0].[TagsDelimited]) + ',') LIKE '%,taglast,%') AND (((',' + [t0].[TagsDelimited]) + ',') LIKE '%,taglast,%') 
```

而不是每个标签一个子句。

我可以通过添加来解决这个问题

```
string temp = tag; 
```

在 for 循环内并使用 temp 而不是标记。

**问题是：这怎么可能！？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T15:26:30.107

lambda 捕获变量，而不是值。

有关更多解释，您可能想阅读我对[这个问题的回答](https://stackoverflow.com/questions/658818/linqtosql-strange-behaviour/658840#658840)

# c# - 如何在运行时将方法附加到动态创建的 C# 类型？

> ID：710189
> 
> 赞同：7
> 
> 时间：2009-04-02T15:23:47.820
> 
> 标签：c#, reflection, dynamic-languages

我一直在使用一个内部数据访问库，该库有效地将 XML 传递给一个存储过程，该存储过程返回 XML。我对此无能为力。我试图让 ActiveRecord 获得批准，但我的请求被拒绝了。但是，使用[http://blog.bodurov.com/Post.aspx?postID=27](http://blog.bodurov.com/Post.aspx?postID=27)提供的出色代码，我向 IEnumerable 添加了一个扩展方法，它将我从不规则的 XML 中返回的键值对转换为强类型对象，带有属性名称！

这：

```
dict["keyName1"] 
```

变成

```
MyObject.keyName1 
```

现在接口支持数据绑定！很酷！不过，我想更进一步。我希望发出的对象也具有 Save() 方法，这样我就可以模仿 ActiveRecord 模式并为我的 web 人员提供一个直观的对象层，以便从 ASP.net 使用。

如何在 Visual Studio 中的源代码中编写方法，并在运行时将其附加到发出的对象？我对编写汇编或 IL 不感兴趣（或没有资格）。我想在 C# 中执行此操作。这是我的第一个 StackOverflow 问题，我使用公司规定的 IE6 发布此问题，所以请保持温和。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T15:34:35.440

根据我在那篇文章中收集到的信息，它正在为您创建匿名类型，并且您正在使用它来获取值。如果是这种情况，就没有简单的方法可以向这些对象添加方法。但是，如果每次 SP 执行时 XML 结构都相同，为什么不创建一个具有您需要的所有属性的具体类，并使用 XML 自己填充这些对象的集合。这样，您可以轻松地将所需的任何方法直接添加到类中......

编辑：根据我们在评论中的讨论，这里有一个想法：

在那里的代码中，当您构建类型时，您正在使用：ModuleBuilder.DefineType。DefineType 有一个重载，它需要一个类型来扩展。[关联。](http://msdn.microsoft.com/en-us/library/4zfbcfc1.aspx). 因此，创建一个接口（事件中不必包含任何方法），当您动态构建类型时，使用我链接到的重载扩展该接口。然后在该接口上创建一个执行 Save() 的扩展方法。

还有另一个可能感兴趣的重载需要扩展类型和接口：

[http://msdn.microsoft.com/en-us/library/f53tx4x8.aspx](http://msdn.microsoft.com/en-us/library/f53tx4x8.aspx)

EDIT2：代码示例：

首先，创建一个接口：

```
public interface ISaveExtentable //I suck at naming stuff :-p
{

} 
```

然后，在您喜欢的那个站点的代码中，您会找到一个名为：GetTypeBuilder 的方法。将其更改为：

```
 private static TypeBuilder GetTypeBuilder(string typeSigniture)
        {
            AssemblyName an = new AssemblyName("TempAssembly" + typeSigniture);
            AssemblyBuilder assemblyBuilder =
                AppDomain.CurrentDomain.DefineDynamicAssembly(
                    an, AssemblyBuilderAccess.Run);
            ModuleBuilder moduleBuilder = assemblyBuilder.DefineDynamicModule("MainModule");

            TypeBuilder tb = moduleBuilder.DefineType("TempType" + typeSigniture
                                , TypeAttributes.Public |
                                TypeAttributes.Class |
                                TypeAttributes.AutoClass |
                                TypeAttributes.AnsiClass |
                                TypeAttributes.BeforeFieldInit |
                                TypeAttributes.AutoLayout
                                , typeof(object), new Type[] {typeof(ISaveExtentable)});
            return tb;
        } 
```

然后，在该接口上创建一个扩展方法来进行保存：

```
 public static class SaveExtendableExtensions
    {
          public static void Save(this ISaveExtentable ise)
          {
              //implement save functionality. 
          }
    } 
```

由于类型是动态创建的，因此您很可能需要在 Save 方法中使用反射来获取所有属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-19T17:34:02.453

我认为这被称为混入，在.net 中不能直接或容易获得。[然而据我了解，这是设计LinFu](http://www.codeproject.com/KB/cs/LinFuPart1.aspx)框架的主要原因之一。

# c# - 数据上下文。有没有一种方法可以让我添加额外的 WHERE？

> ID：710195
> 
> 赞同：2
> 
> 时间：2009-04-02T15:24:41.627
> 
> 标签：c#, asp.net, linq, linq-to-sql

所以基本上我有一个只适用于一个用户的应用程序，但我想让它成为多用户。这将涉及我登录用户，并在会话中保持用户 ID，以及将用户 ID 列添加到我的数据库表中。没什么大不了的。

我想更改我的 dbml，或者使用它的部分，以便我通过它抛出的任何查询也得到

```
.WHERE(user=>user.id=MYPARAM) 
```

添加到它，只返回登录用户的记录。

有没有快速的胜利？我可以在 .dbml 中指定的一个地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T15:54:11.587

我可能会动态地创建一个 lambda 表达式。

Where 子句采用 Expression> 类型的对象

然后，您可以使用以下内容创建表达式。

```
Expression<Func<User,bool>> func = null; 
```

然后

```
ParameterExpression xParam = Expression.Parameter(typeof(User), "u"); 
```

然后，您将使用二进制表达式为 u.i​​d = "test" 创建一个表达式。

```
BinaryExpression uidTest = Expression.Equal(Expression.Property(xParam, "id"),
                                                               Expression.Constant("test"); 
```

然后将其附加到表达式，如下所示：

```
func = Expression.Lambda<Func<User, bool>>(uidTest, xParam) 
```

实际上，这是在构建一个 lambda 表达式 u=> u.id = "test"

然后可以在 .Where 中使用 func 对象，如下所示： .Where(func)

显然，您可以在应用程序中随时根据您需要的任何标准动态地构建它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T16:30:15.087

我不确定是否有类似的东西。

如果没有，您可以为部分类中的所有表公开已过滤的属性。然后，您将接收用户 ID 作为数据上下文的参数。

您可以将其与动态表达式结合使用，以便尽可能简单地定义这些属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T22:56:50.070

如果您仍然无法使用 LINQ to SQL 实现此功能，那么您可能希望使用行级安全性在数据库级别解决问题。本质上，您可以使用实现动态谓词的视图来包装每个表：

WHERE user_id = SUSER_SNAME()

这要求您在连接到数据库之前动态设置每个用户的连接属性（即每个数据库用户都有一个特定的 SQL 用户名和密码）。如果这不是一个可行的解决方案，您可能需要考虑围绕 L2S 上下文构建一个框架，以便您可以注入自己的逻辑。如果您想获得更多灵感，请在此处阅读：[http ://www.west-wind.com/WebLog/posts/160237.aspx](http://www.west-wind.com/WebLog/posts/160237.aspx)

# sql-server-2005 - Sql 查询获取数据

> ID：710200
> 
> 赞同：0
> 
> 时间：2009-04-02T15:25:41.763
> 
> 标签：sql-server-2005

我有一张名为 DrTimings 的表格，其中医生每天的时间是这样的。

```
DrID(int identity)  StartTime(DateTime)             EndTime(DateTime)
    1                3/31/2009 8:00:00 AM   3/31/2009 10:30:00 AM 
```

我有另一个名为 TimeList 的表，其中包含 3 个字段

```
SlotID   SlotStartTime(varchar)   SlotEndTime(varchar)
1         8:00AM                      8:15AM
2         8:15AM                      8:30AM
3         8:30AM                     8:45AM 
```

一直持续到晚上 7:00

我有另一个表 DrDutyDetails，其中 DrTiming 设置为这样的整个月。

```
DrID    StartTime             EndTime              DateOfAllocation
1       4/5/2009 8:00:00 AM   4/5/2009 9:30:00 AM   4/5/2009 12:00:00 AM
2       4/12/2009 8:00:00 AM  4/12/2009 9:30:00 AM  4/12/2009 12:00:00 AM
likewise 
```

我有另一个名为 AppointmentSchedule 的表，当患者请求预约时它会被填满

```
AppointmentID    SlotID  AppointmentDate
1                1        4/5/2009 
2                3        4/12/2009 
```

我有一个约会时间表表格，我在其中选择 DrID 和约会日期。然后与尚未出现在 Appointmentschedule 中的日期相对应的时段，但时段应该在开始时间和结束时间之间，在 DrTimings 和 TimeSlots 中应该填写下拉列表。我需要一个查询来实现这一点。例如：如果患者输入“2009 年 4 月 5 日”，那么除了 1 和 3 之外的插槽，但我想获得的 biw DrTimings。

同样，我想按时间搜索。意味着如果患者输入任何时间 b/w DrTimings 例如：8:30AM，那么可用的第一个日期必须显示在文本框中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T15:37:50.377

您将需要考虑对日期值进行一些转换/转换。这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms187928.aspx)为您提供了一些关于您需要使用什么的信息。

有很多方法可以做到这一点，但理想情况下，你可以做一些事情，比如`CONVERT(VARCHAR(50), StartTime)`获得完全格式化的时间。然后，由于您知道它的结束格式是 08:00AM，您可以执行 a `RIGHT(CONVERT(VARCHAR(50), StartTime), 7)`，这将为您提供时间值。

现在，您知道如何将日期分成多个部分，您可以从这里执行查询项目所需的各种操作。

为了比较起见，我会将“TimeList”数据存储为 DateTime 值，这样您就可以使用标准时间比较来实际允许您使用“Between”等函数。您可以将它们存储为 1/1/1900 08:00AM 或类似名称。但这需要更改数据模型。如果你想要一些有用的 SQL 来处理这类事情，这里有一篇关于“[基本 SQL Server 日期、时间和日期时间函数](http://weblogs.sqlteam.com/jeffs/archive/2007/01/02/56079.aspx)”的精彩文章。

# c# - ASP.NET / MVC 1.0 组件和 Ajax 控件 - 网格 - 日历 - 搜索？

> ID：710202
> 
> 赞同：2
> 
> 时间：2009-04-02T15:26:05.443
> 
> 标签：c#, asp.net-mvc, components

您好，我对使用 MVC 进行开发相当陌生，我希望找到尽可能多的 Ajax 控件，这些控件可以无缝集成到我的新 MVC 1.0 ASP.Net 应用程序中。具体来说，树控件、搜索、Outlook 日历样式和内联更新。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T15:29:42.847

您应该看到 jQuery 插件。

其中一些在[这里](http://www.reynoldsftw.com/2009/01/top-10-jquery-plugins-for-form-usability/)被评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T15:30:02.703

我相信所有控件在 MVC 下都应该可以正常工作，归根结底它仍然是 ASP.NET。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T15:30:23.280

Telerik 在[http://www.telerik.com](http://www.telerik.com)上做了一些出色的控制。他们的支持非常好。

# .net - 从 .NET 到 DB2 的分布式事务

> ID：710211
> 
> 赞同：0
> 
> 时间：2009-04-02T15:28:02.427
> 
> 标签：.net, db2, ibm-midrange, com+

我有一个问题，我必须调用 AS400 db2 从我的 .net 调用一系列插入/更新存储过程，然后如果 AS400 db 中的一切正常，则更新一些 SQL2005 表。我使用的驱动程序没有分布式事务，所以我想知道您是否可以使用任何 IBM iSeries Drivers for DB2 来创建一个参与分布式事务的 COM+/.NET 组件。请让我知道是否有人以前做过类似的事情，或者任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T16:17:56.410

您使用的是哪个驱动程序？

IBM 的 DB2 Connect 支持由 Windows DTC 管理的分布式事务。

来自 Microsoft 的 DB2 驱动程序（打包在 Microsoft Host Integration Server 中）也进行事务处理。

我从你那里听到两件不同的事情。您想做一个跨越 SQL 和 DB2 的事务。并且您还想构建一个参与分布式事务的组件。这些可以一起完成，但前者不需要后者。

使用 .NET 2.0 中的 System.Transactions 类，您可以执行以下操作：

```
 TransactionOptions options = new TransactionOptions();
  options.IsolationLevel = IsolationLevel.Serializable;
  options.Timeout = TransactionManager.DefaultTimeout;
  using(var scope = new TransactionScope(TransactionScopeOption.Required, 
                          options, 
                          EnterpriseServicesInteropOption.Full) )
  {
      TransactionalWorkinDb2();
      TransactionalWorkinSql();
      scope.Complete();
  } 
```

结果将是一个跨越 DB2 和 SQL 的分布式事务，但它不是参与分布式事务的组件，如果您明白我的意思的话。

另一种选择是使用 EnterpriseServices/COM+ 模型来定义一个执行*某些*操作的组件，并将该组件标记为事务性的。这也有效，但不需要在 .NET 中执行分布式事务。

# sql - 有没有办法访问 SELECT 语句中的“上一行”值？

> ID：710212
> 
> 赞同：120
> 
> 时间：2009-04-02T15:28:12.850
> 
> 标签：sql, sql-server, sql-server-2008

我需要计算表格两行之间一列的差异。有什么方法可以直接在 SQL 中执行此操作吗？我正在使用 Microsoft SQL Server 2008。

我正在寻找这样的东西：

```
SELECT value - (previous.value) FROM table 
```

想象一下“previous”变量引用了最新选择的行。当然，通过这样的选择，我最终会在一个有 n 行的表中选择 n-1 行，这不是可能的，实际上正是我需要的。

这在某种程度上可能吗？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2015-07-02T07:15:06.510

使用[滞后](http://www.postgresql.org/docs/current/static/functions-window.html)功能：

```
SELECT value - lag(value) OVER (ORDER BY Id) FROM table 
```

用于 Id 的序列可以跳过值，因此 Id-1 并不总是有效。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2009-04-02T15:29:36.467

SQL 没有内置的顺序概念，因此您需要按某个列进行排序才能有意义。像这样的东西：

```
select t1.value - t2.value from table t1, table t2 
where t1.primaryKey = t2.primaryKey - 1 
```

如果您知道如何排序，但不知道如何在给定当前值的情况下获取前一个值（EG，您想按字母顺序排序），那么我不知道在标准 SQL 中这样做的方法，但大多数 SQL 实现都会有扩展来做到这一点。

如果您可以对行进行排序以使每个行都不同，那么这是一种适用于 SQL Server 的方法：

```
select  rank() OVER (ORDER BY id) as 'Rank', value into temp1 from t

select t1.value - t2.value from temp1 t1, temp1 t2 
where t1.Rank = t2.Rank - 1

drop table temp1 
```

如果您需要打破平局，您可以根据需要向 ORDER BY 添加尽可能多的列。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-04-02T15:43:42.873

Oracle、PostgreSQL、SQL Server 和更多的 RDBMS 引擎都有调用的分析函数`LAG`，`LEAD`它们就是这样做的。

在 2012 之前的 SQL Server 中，您需要执行以下操作：

```
SELECT  value - (
        SELECT  TOP 1 value
        FROM    mytable m2
        WHERE   m2.col1 < m1.col1 OR (m2.col1 = m1.col1 AND m2.pk < m1.pk)
        ORDER BY 
                col1, pk
        )
FROM mytable m1
ORDER BY
      col1, pk 
```

，`COL1`您订购的列在哪里。

启用索引`(COL1, PK)`将大大改善此查询。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2011-12-29T20:37:33.683

```
WITH CTE AS (
  SELECT
    rownum = ROW_NUMBER() OVER (ORDER BY columns_to_order_by),
    value
  FROM table
)
SELECT
  curr.value - prev.value
FROM CTE cur
INNER JOIN CTE prev on prev.rownum = cur.rownum - 1 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-04-02T15:30:01.190

LEFT JOIN 将表连接到自身，并计算出连接条件，因此在表的连接版本中匹配的行是前一行，用于您对“上一个”的特定定义。

更新：起初我想你会想要保留所有行，在没有前一行的情况下使用 NULL。再次阅读它，您只希望剔除那些行，因此您应该使用内连接而不是左连接。

* * *

**更新：**

较新版本的 Sql Server 也具有可用于此目的的 LAG 和 LEAD Windowing 函数。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-01-06T07:17:16.797

```
select t2.col from (
select col,MAX(ID) id from 
(
select ROW_NUMBER() over(PARTITION by col order by col) id ,col from testtab t1) as t1
group by col) as t2 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-02T18:51:50.207

仅当序列中没有间隙时，所选答案才有效。但是，如果您使用的是自动生成的 id，则由于插入回滚，序列中可能会出现间隙。

如果您有差距，此方法应该有效

```
declare @temp (value int, primaryKey int, tempid int identity)
insert value, primarykey from mytable order by  primarykey

select t1.value - t2.value from @temp  t1
join @temp  t2 
on t1.tempid = t2.tempid - 1 
```

# java - 如何使用 iBatis for Java 实现继承？

> ID：710221
> 
> 赞同：2
> 
> 时间：2009-04-02T15:29:26.107
> 
> 标签：java, inheritance, ibatis

**请**给我举个例子！iBatis 文档没有涵盖这一点。我整个早上都在努力让我的鉴别器和 subMap 工作！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-07T22:44:17.540

有趣的是，我刚刚写了一篇[关于使用 Ibatis 继承的教程](http://www.cforcoding.com/2009/06/ibatis-tutorial-inheritance-strategies.html)。希望能帮助到你。

# sharepoint - 错误页面的 SharePoint 品牌

> ID：710235
> 
> 赞同：2
> 
> 时间：2009-04-02T15:30:42.327
> 
> 标签：sharepoint, branding

我们如何在 SharePoint 中为以下内容自定义错误页面：

> 错误请求 400
> 
> 未经授权的401
> 
> 禁止403
> 
> 未找到 404（通过[SharePoint 404](https://stackoverflow.com/questions/502336/sharepoint-404-page)解决）
> 
> 内部错误 500
> 
> 未实施 501
> 
> 服务不可用 503

虽然我知道如何自定义 404 页面，但如何以及如何自定义列出的其他错误页面的最佳方式是什么？

通过web.config？单独的控制台应用程序？Stsadm 命令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T13:15:32.357

对于**SharePoint 2010**，以下博客文章提供了一些创建自定义错误页面的解决方案：

*   [映射 SharePoint 2010 网站的自定义错误页面](http://www.spdeveloper.co.in/articles/pages/custom-error-pages-for-sharepoint2010-sites.aspx)
*   [发生了预期的错误](http://www.todd-carter.com/post/2010/04/07/an-expected-error-has-occurred/)

可以通过具有以下代码片段的功能激活自定义错误页面：

```
public override void FeatureActivated(SPFeatureReceiverProperties properties)
    {
        SPWebApplication webApp = properties.Feature.Parent as SPWebApplication;
        if (null != webApp)
        {
            if(!webApp.UpdateMappedPage(SPWebApplication.SPCustomPage.Error, CustomErrorPage))
            {
                throw new ApplicationException("Cannot create new error page mapping !!");
            }
            webApp.Update(true);
        }
    }

    public override void FeatureDeactivating(SPFeatureReceiverProperties properties)
    {
        SPWebApplication webApp = properties.Feature.Parent as SPWebApplication;
        if (null != webApp)
        {
            if (!webApp.UpdateMappedPage(SPWebApplication.SPCustomPage.Error, null))
            {
                throw new ApplicationException("Cannot reset error page mapping");
            }
            webApp.Update(true);
        }
    } 
```

对于**SharePoint Server 2007**，推荐的方法是创建自定义 HttpModule，如以下博客文章中所述：

*   [MOSS 2007 应用程序中的错误处理](http://blogs.msdn.com/b/jjameson/archive/2010/03/20/error-handling-in-moss-2007-applications.aspx)

# html - 复杂的 HTML/CSS 布局

> ID：710239
> 
> 赞同：1
> 
> 时间：2009-04-02T15:31:22.250
> 
> 标签：html, css

我已经做了很长一段时间的网络开发人员，但这是我从未真正做过的事情，到目前为止我的进步使用了一些非常复杂的方法。以下是我想要的布局，不过这个布局有一些*规则*，我稍后会解释。

```
 ----------------------------------------------------
    |                      HEADER                      |
    ----------------------------------------------------
     ________   _______________________________________
    |        | |                                       |
    |        | |                                       |
    |        | |                                       |
    |        | |                                       |
    |        | |                                       |
    |        | |                                       |
    |        | |                                       |
    |        | |                                       |
    |________| |                                       |
               |                                       |
               |                                       |
               |                                       |
               |                                       |
               |                                       |
               |_______________________________________| 
```

侧边栏和标题是*静态*的，正文也是如此，但是您可以滚动正文。在 body 部分的容器上使用 CSS 属性 overflow:scroll 不是一种选择。原因是它是一个 ASP.NET 应用程序，它利用了维护位置滚动条，这意味着*浏览器*滚动条——而不是包含滚动条——是用来记录 x 和 y 位置的。我已经实现了这一点，但使用了一些不太漂亮的复杂布局技术。

所以我的 HTML 如下所示：

```
<div id="header">
  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="#">Telephone</a></li>
    <li><a href="#">My Department</a></li>
    <li><a href="#">My Profile</a></li>
  </ul>
</div>

<div id="sidebar-container">
  <div id="sidebar">
    <!-- sidebar code using ul's and li's -->
  </div>
</div>

<div id="content-top-border"></div>
<div id="content-left-border"></div>

<div id="content-wrap">
  <div id="content">
    <asp:ContentPlaceHolder ID="MainContent" runat="server" />
  </div>
</div>

<div id="content-right-border"></div>
<div id="content-bottom-border"></div>
<div id="bottom-block"></div> 
```

因此，我出于特定原因使用所有这些 div，因此我可以绝对在内容区域上放置边框。其余的 div 实际上通过更改它们的背景颜色来阻止内容，因此您在滚动时看不到内容。

我的 CSS 文件太大，无法在此处发布，但总体思路如下：

```
div#header {
    height:30px;
    background-color:#d7d7d7;
    position:fixed;
    top:0;
    left:0;
    right:0;
}

div#sidebar {
    position:fixed;
    top:30px;
    left:0;
    overflow:auto;
    bottom:4px;
    width:148px;
    background-color:#d7d7d7;
}

div#sidebar ul {
    border:1px solid #9a9a9a;
    border-bottom:0;
    font-family:Tahoma;
    margin:0 0 0 4px;
    padding:0;
    list-style-type:none;
    font-size:0.75em;
    width:137px;
    clear:both;
    background-color:white;
} 
```

从侧边栏可以看出，我设置了一个固定宽度，制作它`position:fixed`，然后设置背景。包含`<ul>`具有固定宽度，因此会导致块。当您水平滚动页面时，当它碰到侧边栏时内容将被隐藏。这会产生类似于任何客户端应用程序的效果。

```
#content-wrap {
    position: absolute;
    top: 30px;
    bottom: 15px;
    left: 147px;
    right:0;
    background-color:#d7d7d7;
    z-index:-998;
}

#content {
    z-index:-995;
    position:absolute;
    top:0;
    bottom:0;
    right:0;
    left:0;
    padding:10px 10px 20px 10px;
    background-color:#FFF;
    color:#292929;
} 
```

因此，您可以看到#content 具有绝对定位，将其保持在该内容框中。即使您水平或垂直滚动​​，内容框之外的任何内容都*不会显示。*

有没有更好的方法来做到这一点？做一些非常简单的事情似乎需要大量的 HTML/CSS。

**编辑**：这种布局无论如何都不是问题。这部分甚至不难。困难的是用复杂的布局维护简单的 HTML/CSS，而复杂的意思并不是我无法实现的。我已经达到了预期的效果，我只是在寻找更好的方法。

**编辑**：这是基于业务需求，我没有选择:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T15:36:22.207

[您可以在这里](http://www.456bereastreet.com/lab/developing_with_web_standards/csslayout/2-col/)使用标记和 css并稍微调整它以适应您的需要吗？

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T16:02:12.113

固定位置元素对我来说通常是一个警告信号——通过将内容从文档流中取出，您将失去 CSS 的主要优点之一，即它的灵活性。同样，通过混合 px 和 em 测量，您正在创建一个稍微混合的样式表堵塞，不允许轻松调整页面大小。

然而，中心问题似乎是一个问题，即你是否在方法和结果方面都在寻找正确的树。您*是否*必须使用 ASP.NET 中的维护位置滚动回选项？实现一点轻量级的 javascript 以在溢出的 div 上创建等效效果并不难。如果您被 asp.net 代码卡住了，您*是否*必须将文本放在这样的小框中，或者您可以让页面与内容一样长吗？

如果您*必须*使用maintainpositionscrollback并且您*必须*将内容放在一个小盒子里，那么您最好使用一些对标准不太友好的代码进行标记 - 也许将内容放在iFrame中会给您带来您正在寻找的行为. 如果您为了实现您想要的设计而失去了语义 html 和 css 的大部分好处，那么您不会因为采用不同的设计方法而牺牲更多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T15:38:54.867

我会用`position:fixed`适当的边距和宽度/高度来做到这一点

# delphi - 如何在 Delphi 的 TListView 子项上绘制 bmp/图标？

> ID：710242
> 
> 赞同：1
> 
> 时间：2009-04-02T15:31:54.477
> 
> 标签：delphi, listview

我想使用 delphi 将图标/bmp 绘制到 TListView 的子项中。但我不知道如何做到这一点。它适用于列表中的第一项，但子项有问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T18:09:30.653

您可以使用 CustomDrawSubItem 事件。

下面的示例忽略文本并绘制​​矩形。不幸的是，为右列获取矩形有点麻烦，但这种方法有效：

```
procedure TForm.ListViewCustomDrawSubItem(Sender: TCustomListView;
  Item: TListItem; SubItem: Integer; State: TCustomDrawState;
  var DefaultDraw: Boolean);
var
  r : TRect;
  i : Integer;
begin
  r := Item.DisplayRect(drBounds);
  for i := 0 to SubItem-1 do begin
    r.Left := r.Left + ListView.Columns.Items[i].Width;
    r.Right := r.Left  + ListView.Columns.Items[i+1].Width;
  end;
  case SubItem of
     1 : ListView.Canvas.Pen.Color := clRed;
  else
    ListView.Canvas.Pen.Color := clBlue;
  end;

  ListView.Canvas.Rectangle(r.Left, r.Top, r.Right, r.Bottom);
  DefaultDraw := False;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T15:41:33.083

使用 TImageList 组件来保存您的图像，将其分配给列表视图的 SmallImages 属性并设置子项的 ImageIndex。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T10:06:51.713

在尝试了 Gamecat 提出的解决方案后，在调整组件大小后处理重绘事件存在严重问题，所以最后我想出了 2 个可能的解决方法：

1.  由于子项是字符串，我处理了更改字体系列并使用 Wingdings 我使用了类似三角形的字符，然后我只是更改了字体颜色以使其看起来像字形。（我知道，它不是很干净，但从时间和精力的角度来看它对我有用）

2.  从一开始就使用 TDataGrid，它知道单元格的概念，我们几乎可以添加任何东西，而无需担心重绘事件。（对我来说没用，因为现有组件已经构建了很多功能）。

# visual-studio - 进行 XAML 数据绑定时如何获得智能感知？

> ID：710246
> 
> 赞同：4
> 
> 时间：2009-04-02T15:34:00.090
> 
> 标签：visual-studio, visual-studio-2008, data-binding, xaml, intellisense

如果在 XAML 中定义 ItemsControl/ItemsSource="{Binding AvailableContracts}" 时，Visual Studio 会足够聪明，可以在 DataContext 绑定到的 ModelView 上找到属性 AvailableContracts，反映它，然后当我类型：

```
<TextBlock Text="{Binding Path= 
```

它会在我的 ContractModelView**中弹出对我可用的可绑定属性的智能感知，**因为 AvailableContracts 是一个列表集合。

**我不明白为什么 Visual Studio 不能遵循这条逻辑路径并为我提供所需的智能感知。谁能解释这里的断开连接是什么？**或者肯定有某种方法可以“给它一些帮助”，以便它可以提供智能感知。任何第三方工具可以做到这一点？也许在VS2010中？我听说 MEF 将在 VS2010 中使智能感知更好，希望如此。

在编写我的 XAML 视图时缺少数据绑定智能感知就像记事本一样。:-(

```
<UserControl 
    x:Class="TestMvvmWpf8898.Views.CustomerView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid>
        <StackPanel>
            <TextBlock Text="{Binding Path=FullName}"/>
            <ItemsControl ItemsSource="{Binding Path=AvailableContracts}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Path=NEED_INTELLISENSE_HERE
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </StackPanel>
    </Grid>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-02T08:56:50.453

您的问题只有一个很好的解决方案：Resharper

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-25T18:40:20.393

可以从 Visual Studio 2013 [http://blogs.msdn.com/b/visualstudio/archive/2013/08/09/xaml-editor-improvements-in-visual-studio-2013.aspx](http://blogs.msdn.com/b/visualstudio/archive/2013/08/09/xaml-editor-improvements-in-visual-studio-2013.aspx)

# c# - 托管代码（特别是 .NET）会变成“非托管”吗？

> ID：710247
> 
> 赞同：3
> 
> 时间：2009-04-02T15:34:03.083
> 
> 标签：c#, .net, windows

最近我和我的一个朋友聊天，他几个月前开始上 C++ 课（他第一次接触编程）。我们大致谈到了 C# 和 .NET 的话题，他向我指出，他认为所有常见问题（低速、易破坏的字节码等）都“注定”要解决。我在所有这些问题上都同意他的观点，但我没有说它注定要失败，只是因为我觉得，随着时间的推移，像 C# 这样的语言可以转而成为本机代码（如果微软选择将 .NET 的实现从字节码，JIT 运行时环境，可以像 C++ 程序一样直接编译为本机代码）。

我的问题是，我要在这里吃午饭吗？我的意思是，这可能需要做很多工作（并且可能会破坏太多东西），但是没有某种魔法屏障可以阻止 C# 代码被本地编译（如果有人想这样做的话），对吧？曾经有一段时间，C++ 被认为是一种非常高级的语言（现在仍然是，但不像过去那样多），但现在它是微软原生 API 的基石（与 C 一起）。.NET 有朝一日可能在这方面与 C++ 处于同一水平的想法对我来说似乎只是时间和精力的问题，而不是语言设计中的一些根本缺陷。

**编辑**：我应该补充一点，如果.NET 的本地编译是可能的，为什么微软选择不走那条路？他们为什么选择 JIT 字节码路径？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-02T15:38:34.853

Java 使用字节码。C# 虽然使用 IL 作为中间步骤，但*始终*编译为本机代码。IL 永远不会像 Java 字节码那样直接解释执行。如果您真的想要，您甚至可以在分发之前预编译 IL（提示：如果您不这样做*，从长远来看，性能通常会更好）。*

C# 很慢的想法是可笑的。一些*winforms 组件*很慢，但如果您知道自己在做什么，C# 本身就是一种非常快速的语言。在这个时代，无论如何，它通常归结为算法。如果您实施了错误的冒泡排序，语言选择将无济于事。如果 C# 帮助您从更高级别使用更有效的算法（根据我的经验，它通常会这样做），这将胜过任何其他速度问题。

* * *

根据您的编辑，我还想再次解释（典型）编译路径。

C# 编译为 IL。此 IL 分发到本地机器。用户运行该程序，然后该程序被 JIT 编译为该机器的本地代码*一次*。下次用户在该机器上运行程序时，他们正在运行一个完全原生的应用程序。还有一个 JIT 优化器可以让事情变得有点混乱，但这是一般情况。

这样做的原因是允许单个机器进行适合该机器的编译时优化。平均而言，与将相同的完全编译的应用程序分发给每个人相比，您最终会得到更快的代码。

* * *

关于反编译：

首先要注意的是，如果您真的愿意，您可以在分发之前预编译为本机代码。在这一点上，您已接近与分发本机应用程序相同的级别。然而，这不会阻止一个坚定的人。

它在很大程度上也误解了起作用的经济学。是的，有人可能会对你的工作进行逆向工程。但这假设应用程序的所有价值都在于技术。*程序员高估代码而低估产品*的执行是很常见的：界面设计、营销、与用户的联系以及持续的创新。如果你做对了这一切，那么一点点额外的竞争就会对你有很大的帮助，因为它会增加你的市场需求。如果你做错了，隐藏你的算法不会拯救你。

如果您更担心自己的应用会出现在warez 网站上，那您就更加误入歧途了。无论如何它都会出现在那里。一个更好的策略是[吸引这些用户](https://stackoverflow.com/questions/651291/securing-a-net-application)。

* * *

目前，采用 (imo) 的最大障碍是可再发行框架的规模已变得庞大。希望他们能在一个相对接近的版本中解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T15:38:19.517

您是否暗示 C# 是托管代码这一事实是一个设计缺陷？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T15:46:26.767

C# 可以使用 NGEN 等工具进行本地编译，MONO（开源 .net 框架）团队开发了完整的 AOT（提前）编译，允许 c# 在 iPhone 上运行。但是，完全编译很麻烦，因为它破坏了跨平台兼容性，并且无法进行一些特定于机器的优化。然而，同样重要的是要注意 .net 不是一种解释性语言，而是一种 JIT（即时）编译语言，这意味着它可以在机器上本地运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T16:01:58.337

伙计，仅供参考，您始终可以使用 ngen.exe 将您的 c# 程序集编译为本机映像

你是在暗示.net 是有缺陷的设计吗？正是 .net 让 ms 从他们糟糕的 vb 5、vb 6、com 时代重新回到了游戏中。这是他们最大的赌注之一

java 做同样的事情 - 所以你是在暗示 java 也是一个错误吗？

注册 大供应商——请注意，.net 在各种规模的公司中都取得了巨大的成功（除了那些开源的家伙——这没有错）。所有这些公司都对 .net 框架进行了大量投资。

在我看来，将 c# 速度与 c++ 进行比较是一个疯狂的想法。c++ 是否为您提供托管环境以及世界级的强大框架？

如果你对反编译如此偏执，你总是可以混淆你的程序集

它与 c++ v/sc#、托管 v/s 非托管无关。两者在各自领域都同样出色且同样强大

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T15:37:11.953

C# 可以被本地编译，但基类库不太可能去那里。另一方面，我真的认为超越 JIT 并没有太大的优势。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T15:46:07.860

当然可以，但真正的问题是为什么？我的意思是，当然，它可能会很慢（呃），但大多数时候性能上的任何主要差异都归结为设计问题（错误的算法、线程争用、占用资源等），而不是语言问题。至于“易碎”字节码，考虑到采用率，它似乎并不是大多数公司真正关心的问题。

真正归结为，最适合这项工作的工具是什么？对于某些人来说，它是 C++；对于其他人，Java；对于其他人，C#、Python 或 Erlang。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T19:34:50.727

注定？因为所谓的性能问题？如何比较价格：

*   程序员的时间
*   硬件部件

如果您在应用程序方面遇到性能问题，与从高级抽象语言切换到低级语言所带来的好处相比，为自己购买更好的硬件**要**便宜得多（而且我对 C++ 没有任何反对意见，我已经长期以来一直是 C++ 开发人员）。

与垃圾收集的 C# 代码相比，在尝试查找 C++ 代码中的内存泄漏时比较维护问题如何？

“硬件很便宜，程序员很贵”： http: [//www.codinghorror.com/blog/archives/001198.html](http://www.codinghorror.com/blog/archives/001198.html)

# bug-tracking - 通过电子邮件注册错误

> ID：710250
> 
> 赞同：0
> 
> 时间：2009-04-02T15:34:56.670
> 
> 标签：bug-tracking

什么是解析带有错误描述的电子邮件的最佳方法。一位客户最近决定，如果用户能够向已知邮箱发送电子邮件并且错误将在错误跟踪器中注册（不完全关闭），这将是一件好事。

问题是错误描述有很多字段，如日期、时间、描述、评论、丢失、附件等。依靠用户使用某些特定的邮件格式并不是最明智的做法。

问题是如何解析电子邮件以获取所有需要的信息。格式不应该太严格，但足以猜测哪些字段是什么意思。我也有兴趣听到正确和最简单的解决方案。

PS 实际上这个功能是银行要求的。他们有一个公共邮箱，客户可以在其中发送发现的问题。问题是在银行员工真正看到之前从这些信件中获取尽可能多的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T01:06:13.107

[FogBugz](http://www.fogcreek.com/FogBUGZ/)能够监控电子邮件地址并将发送到该地址的电子邮件添加为新的 FogBugz 案例。

还有一个称为[ScoutSubmit](http://www.fogcreek.com/FogBugz/docs/60/topics/customers/BugzScout.html)的功能，它接受 HTTP GET 参数并使用这些参数提交新案例。让应用程序自动从现场提交错误报告非常方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T15:56:48.397

我们用 RT 做类似的事情，但是电子邮件并没有真正被解析。所有电子邮件都进入一个队列，由我们的 IT 人员进行评估。基本上，解析是由人工完成的——他们修改票证以获取尽可能多的信息，因为他们可以从电子邮件中收集到。

您不太可能让用户（正确地）遵守您提出的任何特殊语法或格式 - 除非他们是员工、训练有素或有一定的动机遵守您的规则。

另一种选择是让初始电子邮件回复格式为问卷的电子邮件。换句话说，用户写了一份初始的错误报告，并立即（或在您的电子邮件服务器可以响应时）收到一条“谢谢您-您能提供更多信息”的消息，并提示您提供更多信息。然后，您可以解析该电子邮件并让它在您的错误跟踪系统中填充更准确的信息，

祝你好运！听起来是个很酷的主意！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T01:00:08.627

根据自由格式文本对错误进行分类是一个困难的提议。除了缺陷提交者的姓名和报告错误的日期外，几乎没有什么可以从电子邮件中轻松收集到。您是否有理由限制自己使用电子邮件？如果您提供通过网页提交错误的表单，您可以根据您提供给用户的下拉菜单项对缺陷/错误进行分类。此外，您可以在页面的动态信息部分将它们指向常见答案。查看[Apple iTunes 支持请求页面](http://www.apple.com/support/itunes/store/browser/)，了解一种稍微烦人但有效的方法来强制用户向您提供体面的信息。银行应用程序不是允许歧义的好领域，也不是进行多轮通信的好领域。

# sql-server - 将 XML 数据导入 SQL Server 2008 Express 是否有灵丹妙药？

> ID：710251
> 
> 赞同：2
> 
> 时间：2009-04-02T15:34:57.777
> 
> 标签：sql-server, xml, sql-server-2008

我尝试了导入/导出向导，但数据源下拉菜单下没有 XML 驱动程序。有没有一种方法可以将 XML 数据导入 SQL Express，而无需编写应用程序来显式执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T15:45:42.887

请参阅[OPENXML](http://msdn.microsoft.com/en-us/library/ms175160.aspx)。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-04-06T08:30:05.987

请参阅我写的关于[使用 T/SQL 将 XML 导入数据库](http://searchsqlserver.techtarget.com/tip/0,289483,sid87_gci1347994_mem1,00.html)的文章。

# c++ - 如何从目录加载所有文件？

> ID：710253
> 
> 赞同：2
> 
> 时间：2009-04-02T15:35:21.427
> 
> 标签：c++, file, input, lua, io

就像标题所说的那样；如何加载目录中的每个文件？我对 c++ 和 lua 都感兴趣。

编辑：对于windows，我会很高兴有一些真正的工作代码，尤其是lua。我可以用 c++ 的 boost::filesystem 来做。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T20:27:38.277

对于 Lua，您需要模块[Lua Filesystem](http://www.keplerproject.org/luafilesystem/)。

正如 Nick 所观察到的，访问文件系统本身（而不是单个文件）超出了 C 和 C++ 标准的范围。由于 Lua 本身（除了用于为 C 模块实现 require() 的动态加载器除外）是用标准 C 编写的，因此核心语言缺乏许多文件系统功能。

但是，扩展 Lua 核心很容易，因为（几乎）任何具有文件系统的平台也支持 DLL 或共享库。Lua 文件系统是一个可移植的库，增加了对目录迭代、文件属性发现等的支持。

使用 lfs，在 Lua 中模拟 DIR 的一些功能本质上很简单：

```
require "lfs"
dot = arg[1] or "."
for name in lfs.dir(dot) do
    local fqn = dot.."/"..name
    local attr = lfs.attributes(fqn)
    print(name, attr.mode, os.date("%Y-%m-%d %H:%M",attr.modification), attr.size)
end 
```

这会产生如下所示的输出：

```
E:...>t-lfs.lua
.       directory       2009-04-02 13:23        0
..      directory       2009-04-02 13:18        0
foo.txt file    2009-02-23 01:56        0
t-lfs.lua       file    2009-04-02 13:18        241

E:...> 
```

如果您的 Lua 副本来自[Lua for Windows](http://www.keplerproject.org/luafilesystem/)，那么您已经安装了 lfs，并且上面的示例将开箱即用。

**编辑：**顺便说一句，Lua 解决方案也可能是一个明智的 C 或 C++ 解决方案。Lua 核心并不大，它提供了一种动态的、垃圾收集的语言，并且很容易与 C 进行交互，无论是作为托管应用程序还是作为扩展模块。要在 C 应用程序中使用 lfs，您将链接到 Lua DLL，初始化 Lua 状态，并`require"lfs"`通过`luaL_dostring()`或使用 C API`require()`从全局表中检索函数、推送字符串`"lfs"`和获取状态以执行用类似的东西调用 Lua 函数`lua_pcall(L,1,1,0)`，这会将`lfs`表留在 Lua 堆栈的顶部。

如果您已经需要嵌入式脚本语言，并且 Lua 满足您的要求，这种方法可能最有意义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-02T15:43:14.357

对于 C++ 解决方案，请查看[Boost.Filesystem](http://www.boost.org/doc/libs/release/libs/filesystem/index.html)库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T15:40:57.983

目录中的列表文件由平台定义，因此您必须使用平台相关库。对于 c++ 和 Lua（仅实现 ansi c 功能）也是如此。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-07T12:24:24.493

```
require "lfs"

function loadall(dir)
  for file in lfs.dir(dir) do
    if string.find(file, ".lua$") then
      dofile(dir .. "/".. file)     
    end
  end
end 
```

# sql - 如何在 SQL 中编写 where 子句以按时间过滤 DATETIME 列？

> ID：710255
> 
> 赞同：2
> 
> 时间：2009-04-02T15:35:22.817
> 
> 标签：sql, sql-server

我有带有 DATETIME 列时间戳的数据，我想将其过滤到 DATETIME 在任何一天的上午 9:30 到下午 5:30 之间的记录集。最好的方法是什么？

更新：改变是因为我需要精确到分钟，而不仅仅是小时。对于那个很抱歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T15:41:40.430

您始终可以将其编写为用户定义的函数，特别是如果您需要定期执行此操作

```
CREATE function  dbo.timepart (@date as SMALLDATETIME)
RETURNS SMALLDATETIME
AS
BEGIN
    RETURN @date - DATEADD(d, DATEDIFF(d,0,@date), 0)
END 
```

然后像这样使用

```
SELECT * FROM table
WHERE dbo.timepart(date_field) BETWEEN '9:30' AND '17:30' 
```

在 SQL Server 2005 中使用以下测试

```
DECLARE @dates TABLE (date DATETIME)

DECLARE @date DATETIME
SET @date = '20 MAR 2009'

WHILE @date < '22 MAR 2009'
    BEGIN
        INSERT INTO @dates VALUES(@date)
        SET @date = DATEADD(hour, 1, @date)
    END

SELECT * 
FROM
    @dates
WHERE
    dbo.timepart(date) BETWEEN '9:30' AND '17:30' 
```

结果是

```
date
-----------------------
2009-03-20 10:00:00.000
2009-03-20 11:00:00.000
2009-03-20 12:00:00.000
2009-03-20 13:00:00.000
2009-03-20 14:00:00.000
2009-03-20 15:00:00.000
2009-03-20 16:00:00.000
2009-03-20 17:00:00.000
2009-03-21 10:00:00.000
2009-03-21 11:00:00.000
2009-03-21 12:00:00.000
2009-03-21 13:00:00.000
2009-03-21 14:00:00.000
2009-03-21 15:00:00.000
2009-03-21 16:00:00.000
2009-03-21 17:00:00.000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T15:44:48.643

与上面的代码类似，只需为您的 MINUTE 要求添加 DATEPART(mi, column)

但是，请注意，这会影响性能，因为列上的函数将避免使用索引（不可分割）

如果您使用的是 SQL 2008，则它们具有可用于比较的 DATE 和 TIME 新数据类型。如果没有，在 SQL 2005 中，也许您可​​以为 TIME 部分创建计算列并使用它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T16:28:27.323

连接小时和分钟并比较范围。

```
with Result as (
    select  [Time] = cast(cast(datepart(hh, AuditDate) as varchar) + 
            cast(datepart(mi, AuditDate) as varchar) as int), *
    from    AuditTable
)
select  *
from    Result
where   [Time] between 930 and 1730 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T16:41:38.773

```
Select * from tbl 
where ts between 
convert(datetime,convert(varchar,ts, 101)) + convert(datetime,'9:30 am') 
And Convert(datetime,convert(varchar,ts,101)) + convert(datetime,'5:30 pm') 
```

我相信这将使用索引。我无法测试，我用 ipod 发布这个

[从我的电脑编辑]

```
create function  dbo.DaysTime(@date as datetime, @time datetime) 
returns datetime 
as
begin

   /* datediff approach on scraping the 
   time part of datetime: inspired by Russ Cam */

   return dateadd(d, datediff(d, 0, @d), 0)/*the date's day*/ + @time

end

select * from tbl where ts 
between dbo.DaysTime(ts, '9:30 AM') and dbo.DaysTime(ts, '5:30 PM') 
```

这仍将使用索引，因为我们没有在 where 条件的左侧放置表达式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T16:08:42.877

要么是这样的：

```
 ...
WHERE
  (DATEPART(hh, some_date) BETWEEN 10 AND 16)
  OR
  (DATEPART(hh, some_date) = 9 AND DATEPART(mi, some_date) >= 30)
  OR
  (DATEPART(hh, some_date) = 17 AND DATEPART(mi, some_date) <= 30) 
```

或者：

```
 ...
WHERE
  LEFT(CONVERT(VARCHAR, some_date, 8), 5) >= '09:30' AND
  LEFT(CONVERT(VARCHAR, some_date, 8), 5) <= '17:30' 
```

甚至：

```
 ...
WHERE
  LEFT(CONVERT(VARCHAR, some_date, 8), 5) BETWEEN '09:30' AND '17:30' 
```

这些查询中的任何一个都不能使用索引。要使用索引，请以某种方式预先计算值并将它们存储在索引列中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T15:39:14.943

```
SELECT * 
FROM table1 
WHERE 
    (DatePart(hh, DateColumn) >= 9 and DatePart(mm, DateColumn) >= 30)
        AND (DatePart(hh, DateColumn) <= 17 AND DatePart(mm, DateColumn) <= 30) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T15:39:57.127

```
SELECT
     *
FROM
     My_Table
WHERE
     DATEPART(hh, some_date) BETWEEN 9 AND 16 OR
     (DATEPART(hh, some_date) = 17 AND DATEPART(mm, some_date) = 0...) 
```

或者：

```
SELECT
     *
FROM
     My_Table
WHERE
     DATEADD(dd, 1-DATEPART(dd, some_date),
          DATEADD(mm, 1-DATEPART(mm, some_date),
               DATEADD(yy, 1900-DATEPART(yy, some_date), some_date)))
     BETWEEN @start_time AND @end_time 
```

只需将您的@start_time 和@end_time 设置为1900-01-01 所需的时间。

这将排除 05:00:00.000 PM，但您应该能够根据需要进行调整。另请记住，它不能有效地使用索引进行此搜索。如果一天中的时间经常用于搜索或计算，您可以考虑将其分开并将 DATE 和 TIME 保留为两列。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-02T15:45:02.870

```
SELECT *
FROM your_table
WHERE (DATEPART(hh, date_column) = 9 AND DATEPART(mi, date_column) >= 30)
    OR (DATEPART(hh, date_column) = 17 AND DATEPART(mi, date_column) <= 30)
    OR DATEPART(hh, date_column) BETWEEN 10 AND 16 
```

# c# - 我应该如何记录我的 C# 代码？

> ID：710257
> 
> 赞同：5
> 
> 时间：2009-04-02T15:36:21.533
> 
> 标签：c#, .net, documentation, sandcastle

我正在为我们的 C# API 构建文档，其中包含：

1.  当前状态的一般概述和描述为 doc/pdf 文件。
2.  使用 Sandcastle 的 .chm 文件中的类库 API。

### 问题：

1.  我应该将这两个合并到同一个 .chm 文件中吗？合并它们的好方法是什么？
2.  我需要排除某些类/包。我如何在 SandCastle 中指定它？
3.  它为 VB 代码和 Visual C++ 代码生成文档。我怎样才能改变这个？还是应该离开它，知道我只使用安全代码？
4.  在我的系统上哪里可以找到 HTML Help 2.x Viewer Path？

### 编辑：

我在方法、字段和类上所做的注释未在文档中生成。

我该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T15:45:35.087

我建议您使用Codeplex 的[Sandcastle Help File Builder](http://www.codeplex.com/SHFB)。您可以轻松地包含和排除命名空间，但我不确定如何排除单个类。您可以将选项设置为仅生成公共/受保护类的文档，但我不知道这是否适合您的场景。

关于第二个问题，您还可以针对 SHFB 中的特定语言。

此外，您可以在 SHFB 中使用 MAML 来获取概念文档，例如您在 doc/pdf 文件中提到的。您应该能够使用[Doc2Maml](http://www.codeplex.com/DocProject/Release/ProjectReleases.aspx?ReleaseId=12723)来迁移您现有的文档。Doc2Maml 是 DocProject 的一部分，但您似乎可以独立运行它。

**编辑以回应评论：**

说明适用于 SHFB 1.8.0.1。我不记得在 1.7 中执行此操作的确切方法，但我相信它是相似的：

1.  在 Project Properties 选项卡的“Comments”组下，单击“NamespaceSummaries”右侧的省略号。
2.  在左上角的复选框列表中，取消选中您要排除的任何命名空间。

这也是您放入命名空间摘要的屏幕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T16:15:45.323

除了上面提到的 Sand Castle，我还建议您查看[FxCop](http://msdn.microsoft.com/en-us/library/bb429476.aspx)和[StyleCop](http://code.msdn.microsoft.com/sourceanalysis)，以帮助确保您的代码和文档符合 CLS 合规标准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T15:54:15.860

Sandcastle 帮助文件生成器 (SHFB) 本身有一个 .chm 文件，您可以在其中找到诸如“如何从生成的文档中排除某些命名空间或类？”等问题的答案。

你可能认为我知道答案，而我不告诉你是在刻薄。不对。但是我昨晚浏览了文档，看到了关于这个主题的条目。

我不知道你为什么不直接离开 VB 和 C++ 的东西；将来可能会有人在您的库中使用一种（令人震惊的）*不是 C#的语言。*该语言通常可由帮助查看器设置，因此 C# 开发人员可以忽略 VB 语法。

至于合并，SHFB 具有在任意层次结构中添加任意 HTML 的机制。在 GUI 中，它位于此处：

[http://www.freeimagehosting.net/uploads/7de19ea568.jpg](http://www.freeimagehosting.net/uploads/7de19ea568.jpg)

使用它，您可以将 PDF/DOC 转换为 HTML，然后将其嵌入到 .chm 中。

# python - 嵌套列表的不区分大小写的字母排序

> ID：710262
> 
> 赞同：1
> 
> 时间：2009-04-02T15:37:15.760
> 
> 标签：python

我正在尝试按内部列表的第一个元素对这个嵌套列表进行排序：

```
ak = [ ['a',1],['E',2],['C',13],['A',11],['b',9] ]
ak.sort(cmp=lambda x, y: cmp(x[0], y[0]))
for i in ak: {
    print i
} 
```

默认情况下，python 认为 A > a，因此我得到的输出是：

```
['A', 11] ['C', 13] ['E', 2] ['a', 1] ['b', 9] 
```

在比较期间，我尝试通过添加 x[0].lower 等将所有列表值转换为大小写，但没有用。我如何强制 python（我正在使用 2.4 版本）进行不区分大小写的字母排序？

**编辑：**

> Jarret 和 Brian，您对括号的假设是正确的！我确实忘记把它们放进去！还有 Jarret，你关于不使用“cmp”的建议很有魅力！非常感谢你们！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-02T15:39:06.800

尝试：

```
ak.sort(key=lambda x:x[0].lower()) 
```

我建议您避免使用`cmp`它，因为它在 Python 2.6 中已被弃用，并在 3.0 中被删除。我知道您使用的是 2.4，但原因`cmp`是它的排序非常慢。

不过，我不确定为什么您的努力`lower`失败了……也许您忘记使用函数调用而不是仅使用函数名称？（即：`cmp(x[0].lower(), y[0].lower())`对`cmp(x[0].lower, y[0].lower)`）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T15:42:26.637

```
ak.sort(cmp=lambda x, y: cmp(x[0].lower(), y[0].lower())) 
```

你忘了里面的括号了`x[0].lower()`吗？

# optimization - 优化有多重要？

> ID：710263
> 
> 赞同：9
> 
> 时间：2009-04-02T15:37:16.993
> 
> 标签：optimization

昨天我和我的老板就构建软件时优化的适当角色进行了一些辩论。从本质上讲，他的立场是优化需要成为整个开发过程中的首要关注点。

我的观点是，你需要在开发过程中做出正确的算法决策，但你永远不应该在开发过程中计算周期。事实上，我对此感觉非常强烈，我不得不离开谈话。我见过太多以“优化”为名的糟糕编程决策，以及太多以“这种方式更快”为借口的糟糕代码。

StackOverflow.com 社区是怎么想的？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-02T15:40:54.380

> “我们应该忘记小的效率，比如大约 97% 的时间：过早的优化是万恶之源。但我们不应该放弃关键的 3% 的机会。”

——唐纳德·克努斯

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-02T18:01:03.403

我认为过早的优化引用被太多人使用，以避免考虑有关应用程序运行情况的难题。我保证用户希望您考虑如何设计它，以便它尽可能快地运行。

这并不是说您应该为所有事情计时，但设计阶段是最容易优化的地方，而且以后不会花费大量时间。

通常有几种方法可以做任何事情，您应该在设计阶段选择最有可能表现最好的一种（如果结果证明它不是最好的，然后再优化）。这应该胜过易于阅读代码的需求。

如果您在设计阶段不考虑性能，那么您将不会拥有一个设计良好的系统。这并不意味着它应该是唯一的问题（尽管在数据库中我认为它的重要性排在第三位，仅次于数据完整性和安全性），而是试图修复一个系统，因为开发人员始终使用性能不佳的技术以为他们更容易理解是一场噩梦。作为这样一个系统的用户，每次你想从一个屏幕移动到另一个屏幕时都必须等待几分钟，这对每个使用他们的系统的人来说都是一场噩梦（开发人员真的应该每天花一整天时间至少一周，使用他们的系统！）坚持设计糟糕的系统。与以后修复相比，正确设计的成本更低，并且考虑性能对于正确设计至关重要。

我工作的地方是原始开发人员喝了关于过早优化的 koolaid，并按照他们认为最简单的方式做所有事情（但从性能角度来看，这几乎在所有情况下都是错误的选择）。现在我们的规模是三年前的 10 倍，每个网站上的每个屏幕都需要 30 秒左右的时间来加载（或者更糟糕的超时），因此我们正在失去客户。但是改变它太难了，因为他们在设计数据库时根本没有考虑它的性能，并且将具有许多千兆字节数据的数据库重新设计成一个新的结构太耗时且成本高昂。如果它从一开始就被设计为执行，那么对于客户来说，维护起来会更容易，而且速度会更快。我们不是在这里讨论需要对前 10 个最慢的查询进行性能调整，

是的，在您需要之前不要进行微观优化，但请做宏观的事情。在您承诺该路径之前，请考虑这是否是最佳方式。当基于集合的语句可以使用时，不要编写游标来命中具有数百万条记录的表。不要尝试使用尽可能少的表，因为当表存储不同的项目（例如人、地点和车辆）时，这似乎是一个更优雅的解决方案，导致每个查询都命中同一个表并导致每次删除检查各种外键表，这些表永远不会有该类型实体的记录（从我们数据库的主表中删除一条记录需要几分钟，当导入出现问题时真的很高兴（坏数据通常来自客户），我们必须删除 200,000 让我告诉你）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-02T15:51:53.010

优化几乎是重言式的权衡：您以牺牲其他东西（可读性、可维护性、灵活性、编译时间等）为代价获得运行时效率。因此，除非您知道权衡是什么以及为什么值得这样做，否则这样做真的不是一个好主意。

更糟糕的是，思考“我如何快速完成 X”可能会让人分心。朝那个方向投入过多的精力很容易导致您错过更好的方法 Y（而且通常更快——这就是“优化”如何使您的代码变慢）。特别是如果你从一开始就在一个大项目上做太多这样的事情，它代表了很大的动力。如果你无法克服这种势头，你很容易陷入糟糕的设计，因为你没有时间去重构它。这条路躺着龙

你的老板可能想的更多是通过不适当的表示和算法编写糟糕的代码的问题。这与优化并不是一回事，但是如果您不注意适当的数据结构等的方法可能会导致代码库到处都很慢，并且（很像上面的“锁定”）需要付出巨大的努力来修复.

但总的来说，过早的优化确实是一个糟糕的主意。特别是当你最终得到一段复杂的、经过微调的、有据可查的（因为这是你理解它的唯一方法）时，你最终还是不会使用它。这甚至还没有涉及“优化”时经常引入的细微错误问题

[编辑：pshaw，当然，Knuth 的引用很好地概括了这一点。这就是我打字太多的结果]

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-02T15:40:02.913

全程工程师，最后优化。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-02T15:42:28.307

既然与精髓一起去，我会说优化与不这样做的影响一样重要。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-02T17:32:33.097

我认为“过早的优化是万恶之源”必须从字面上理解——它没有说什么时候为时过早，也没有说你应该只在最后进行优化。简直不要太早。此外，“使用正确的算法，O(n^2) vs O(N)”如果从字面上理解有点危险——因为对于许多问题，N 实际上很小，等等......

我认为这取决于您正在做的软件类型：有些软件例如每个部分都非常独立，并且可以单独优化。但情况并非总是如此。对于许多（大多数？）应用程序，速度根本不重要，蛮力但显然正确的方法是最好的方法。但是对于速度很重要的项目，通常必须尽早考虑——也许这是对 Knuth 所说的另一种可能的解释：许多应用程序根本不需要优化，只需知道哪些应用程序需要并提前计划即可。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-02T20:39:21.790

当您有充分的理由预期如果优化是次要问题，那么优化是开发过程中的主要问题。

这在很大程度上取决于您正在编写什么样的代码，但通常有更好的理由相信您的代码将难以使用；或维持；或充满错误；或迟到；如果所有这些事情都成为调整性能的次要因素。

糟糕的管理者会说，“所有这些都是我们最关心的问题”。优秀的管理者会努力找出对这个项目有哪些危险。

当然，好的设计确实必须考虑所有这些事情，并且越早对其中的任何一个进行粗略估计越好。如果您的经理所说的只是，如果您从不考虑您的代码将运行多快，那么您的太多代码将变得非常慢，那么他是对的。我只是不会说这会使优化成为您的“主要”关注点。

如果您的软件的 USP 是它比您的竞争对手更快，那么优化是首要考虑的问题。凭借经验，您通常可以预测什么样的操作将成为瓶颈，从一开始就在设计时考虑到优化，而或多或少地忽略其他地方的优化。许多项目甚至不需要这个：只要您使用合理的算法并且不做任何愚蠢的事情，它们就会足够快而无需付出太多努力。“不要做任何愚蠢的事情”始终是首要关注点，无需特别提及性能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-02T16:29:21.097

我认为代码首先需要可读和可理解。因此，已完成的优化不应以牺牲可读性为代价。然而，优化通常是一种权衡。

您是否应该优化您的代码取决于您的应用程序域。如果您正在使用只有 8Mb 内存的嵌入式处理器，那么优化可能是每个团队成员在编写代码时都需要牢记的事情——优化空间与速度。

但是，除非您的系统已被明确指定和理解，否则过早的优化是没有用的。这是因为大多数程序员不会做出好的优化决策，除非他们能够考虑到整个系统的影响因素，包括高速缓存、硬件线程、管道等处理器架构因素。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-02T17:21:03.017

从 2 年构建高度优化的 Java 代码（*需要*以这种方式优化）开始，我会说有一个管理优化的时间花费规则：

*   现场优化：5%-10% 的开发时间，因为你必须做无数次（每次你都必须修改你的设计）
*   只在你让它工作时进行优化：2% 的开发时间（你只做一次）
*   回到它并在它太慢时进行优化：30% 的开发时间，因为你必须让自己重新投入到系统中

所以我得出的结论是，有一个正确的时间和正确的方法来优化：逐个实体进行（逐个类，如果你的类有一个单一的、明确定义的工作要做，并且可以测试和优化），测试良好，确保逻辑正常工作，然后优化，永远忘记该实体的实现细节。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-03T20:09:28.250

1.  开发时，*保持简单*。恕我直言，大多数性能问题都是由过度设计引起的——通常是因为想要“正确的算法”。

2.  定期使用大数据集、分析或（我最喜欢的技术）手动随机抽样进行压力测试。你发现一个问题，你解决它。你找到另一个，你修复它。

这样你就可以避免产生蛞蝓（缓慢的虫子），当它们出现时，你就杀死它们。

补充：如果我能详细说明第 1 点。OO 似乎是土地的法律，它背后肯定有充分的理由。不幸的是，它使许多年轻的程序员觉得编程就是拥有大量的数据结构，以及一层又一层的抽象。并不是说这些本质上是不好的，而是将其与假设某事物所花费的时间大致与您必须键入的字符数以调用它的自然趋势相结合，并且这种趋势会在各个层上成倍增加（此外，机器真的很快），很容易创造出完美的循环浪费风暴。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-09-05T17:10:26.250

引用朋友的话：“使工作系统高效比使高效系统工作更容易”。

我认为从一开始就使用智能实践和模式很重要，但是让系统实际运行小型测试用例，然后进行性能分析。通常一开始并没有预料到性能较差的代码区域，因此获取一些真实数据，然后优化瓶颈 3%（或 20%，或其他）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-03-07T09:15:34.220

我认为你的老板比你更正确。

很多时候，用户体验会在性能活动成本高昂且效率低下的最后时刻被“重新发现”而丢失。或者当发现将处理今天的事务的批处理程序需要运行四十个小时时。

诸如数据库组织、何时以及何时不做哪些 SELECT 是可以成就或破坏应用程序的设计决策的示例。您仍然冒着单个程序员决定以其他方式误解或根本不了解该做什么的风险。在整个项目期间跟踪绩效可以降低发生此类事情的风险。它还允许在需要时更改设计决策，而不会使整个项目处于危险之中。

“您需要在开发过程中做出正确的算法决策”当然是正确的，但有多少主流程序员能够做到这一点？浏览网络获取信息并不能保证找到高质量的解决方案。“正确”可以解释为意味着可以选择一个差的算法，因为它比更复杂的算法（= 更多的开发时间，更高的成本）更容易理解和实现（= 更少的开发时间，更低的成本）。

数量与质量的钟摆几乎总是在数量方面，因为每小时更多的代码或更快的开发时间在短期内意味着金钱。从长远来看，质量方面意味着金钱。

**编辑**

[本文](http://ubiquity.acm.org/article.cfm?id=1147993)非常彻底地讨论了性能和优化。

表演传教士里科·马里亚纳（Rico Mariana ）在简短的声明中[总结](http://msdn.microsoft.com/en-us/library/ff649527.aspx)道：“永远不要意外放弃你的表演。”

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-02T15:42:34.733

过早的优化是万恶之源……两者之间有一个很好的平衡，但我想说95%的时间你需要在最后进行优化；但是，您可以及早做出一些决定来帮助预防问题。例如，假设我们正在谈论一个电子商务网站。您需要显示目录。现在您可以获取所有 100,000 个项目并显示其中的 50 个，或者您可以从数据库中仅获取 50 个。这些类型的决定应该预先做出。

只有在发现问题后才应进行周期盘点。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-03T21:29:55.297

您的老板说对了一部分，在整个开发生命周期中确实需要考虑优化，但这很少是主要关注点。此外，“优化”这个词是模糊的——它是一个形容词，“优化……”可以是“内存”、“速度”、“可用性”、“可维护性”等等。

但是，OP 是正确的，对于许多项目来说，计算周期是没有意义的。对于大多数 PC 应用程序来说，CPU 从来都不是瓶颈。此外，IA32 并不一致——在一种架构上运行良好，在另一种架构上表现不佳。周期计数应该只在它真正产生影响时才进行 - 通常在 CPU 受限代码或具有非常特定时序需求的代码中。

任何形式的优化都必须始终由确凿的证据驱动。永远不要对系统或代码的行为方式做出任何假设。在理想情况下，应用程序性能/约束将在初始产品设计中指定，并且在开发阶段的早期添加用于监控应用程序性能的工具，以在产品制造时指导程序员。

# java - 为什么 Java 7 中没有原生属性？

> ID：710266
> 
> 赞同：19
> 
> 时间：2009-04-02T15:37:25.510
> 
> 标签：java, properties, java-7

有什么合理的理由，为什么[原生属性](http://tech.puredanger.com/java7#property)不会成为 Java 7 的一部分？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-02T17:49:04.867

当然，还有一些与日程安排和资源有关的高级原因。属性的实现以及理解与其他语言特性的所有分支和交叉点是一项大型任务，类似于各种 Java 5 语言更改的规模。

但我认为 Sun 不推动属性的真正原因与闭包相同：

1）对于实现应该是什么样子没有达成共识。或者更确切地说，有许多相互竞争的替代方案，而对属性充满热情的人对实施的关键部分意见不一。

2）也许更重要的是，对于是否需要该功能缺乏共识。虽然很多人想要属性，但也有很多人认为它没有必要或有用（特别是，我认为服务器端的人认为属性对他们日常生活的重要性远没有摇摆程序员那么重要）。

这里的属性历史：

*   [http://tech.puredanger.com/java7#property](http://tech.puredanger.com/java7#property)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-02T17:10:37.657

在 Java 中做“正确”的属性并不容易。Rémi Forax 的工作在弄清楚这可能是什么样子以及发现许多必须处理的“陷阱”方面尤其有价值。

同时，Java 7 已经花费了太长时间。闭包辩论是一个巨大的、有争议的分心，它浪费了很多本可以用来开发具有广泛支持共识的功能（如属性）的脑力。最终，决定限制对模块化的重大更改（Project Jigsaw）。该语言只考虑了“小改动”（在 Project Coin 下）。

JavaFX 拥有漂亮的属性支持，因此 Sun 清楚地了解属性的价值并知道如何实现它们。但是被 JavaFX 属性宠坏了，开发人员不太可能满足于 Java 中半生不熟的实现。如果它们值得做，那么它们就值得做对。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-07-07T18:03:54.127

默认情况下，任何给定的事情都是“未完成”，因此不需要特别的理由来保持未完成的事情。相反，需要一些令人信服的理由才能将某件事从“未完成”转移到“计划”或“完成”。这种语言特征还没有足够令人信服的理由。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-10-05T18:27:23.870

避免使用任何语言的属性还有两个原因：

*   属性不是非常面向对象的。使它们易于编写鼓励了对象仅提供其内部状态并且调用者对其进行操作的模式。该对象应提供更高级别的方法并保持其内部私有。下次您繁琐地实现 getter 时，请考虑调用者将如何处理数据以及您是否可以直接提供该功能。

*   属性鼓励可变状态（通过设置器），这使程序的可并行性降低。随着核心数量的增加，我们都应该努力使我们的对象不可变，以使并发推理更容易。下次您繁琐地实现 setter 时，请考虑将其删除并使对象不可变。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-02T15:42:01.990

*   不够时间？
*   尚未正确指定？
*   由于java的实现难以添加到java？
*   认为不够重要，即其他事情被优先考虑？

# javascript - 如何使用 JavaScript 向 HTML 元素添加/更新属性？

> ID：710275
> 
> 赞同：130
> 
> 时间：2009-04-02T15:39:08.127
> 
> 标签：javascript, html, cross-browser

我正在尝试找到一种使用 JavaScript 添加/更新属性的方法。我知道我可以用`setAttribute()`函数来做到这一点，但这在 IE 中不起作用。

* * *

## 回答 #1

> 赞同：164
> 
> 时间：2009-04-02T15:52:01.123

您可以[在此处](http://www.quirksmode.org/dom/w3c_core.html#attributes)阅读有关许多不同浏览器（包括 IE）中属性行为的信息。

`element.setAttribute()`应该做的伎俩，即使在 IE 中。你试过了吗？如果它不起作用，那么可能 `element.attributeName = 'value'`会起作用。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2011-01-24T02:41:29.973

如果您想完全兼容，看起来容易的事情实际上很棘手。

```
var e = document.createElement('div');
```

假设您要添加一个 'div1' 的 id。

```
e['id'] = 'div1';
e.id = 'div1';
e.attributes['id'] = 'div1';
e.createAttribute('id','div1')
```

除了 IE 5.5 中的最后一个（此时这是古老的历史，但仍然是 XP 的默认设置，没有更新），这些都可以工作。

但当然也有偶然性。在 8 之前的 IE 中不起作用：`e.attributes['style']` 不会出错但不会实际设置类，它必须是 className: `e['class']`。
但是，如果您使用的是属性，那么这将起作用：`e.attributes['class']`

总之，将属性视为文字和面向对象。

从字面上看，您只是希望它吐出 x='y' 而不要考虑它。这就是attributes、setAttribute、createAttribute的作用（除了IE的style例外）。但是因为这些确实是对象，所以事情会变得混乱。

由于您会遇到正确创建 DOM 元素而不是 jQuery innerHTML slop 的麻烦，因此我会将其视为一个并坚持使用 e.className = 'fooClass' 和 e.id = 'fooID'。这是一个设计偏好，但在这种情况下，试图将其视为对象以外的任何东西都对您不利。

它永远不会像其他方法那样适得其反，只要注意类是类名，样式是一个对象，所以它是 style.width 而不是 style="width:50px"。还要记住 tagName ，但这已经由 createElement 设置，因此您不必担心它。

这比我想要的要长，但是 JS 中的 CSS 操作是一件棘手的事情。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-04-02T15:50:36.320

强制性[jQuery 解决方案](http://docs.jquery.com/Attributes)。查找`title`属性并将其设置为`foo`。请注意，这会选择单个元素，因为我是通过 id 进行的，但是您可以通过更改选择器轻松地在集合上设置相同的属性。

```
$('#element').attr( 'title', 'foo' ); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-02T15:43:16.573

你想对属性做什么？它是 html 属性还是您自己的东西？

大多数时候，您可以简单地将其作为一个属性来处理：想要在元素上设置标题？`element.title = "foo"`会做的。

对于您自己的自定义 JS 属性，DOM 自然是可扩展的（又名 expando=true），其简单的结果是您可以做到`element.myCustomFlag = foo`并随后毫无问题地读取它。

# python - Python 3.0 Windows/COM

> ID：710278
> 
> 赞同：3
> 
> 时间：2009-04-02T15:39:19.280
> 
> 标签：python, com, python-3.x

如何使用 python 3.0 从 python 文件访问 COM 对象。

而且，是的，我知道使用 Python 3.0 的人并不多。切换回 2.6 对我来说是一个*巨大*的麻烦，所以我不想这样做，除非我绝对必须这样做。

感谢您的宝贵时间和任何帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T15:42:49.677

安装[pywin32](https://github.com/mhammond/pywin32/releases)，然后使用它的 progid 创建对象：

```
import win32com.client
object = win32com.client.Dispatch("Outlook.Application") 
```

另请参阅[Python 和 COM 教程](http://www.boddie.org.uk/python/COM.html)。

编辑：嗯...看起来他们可能还没有 python 3.0 版本。

# mercurial - 善变的过去分支

> ID：710280
> 
> 赞同：3
> 
> 时间：2009-04-02T15:39:46.817
> 
> 标签：mercurial, branch

我是使用 Mercurial 创建程序的单一开发人员。到目前为止，我一直致力于开发的每一步，我把事情搞砸了，想要做点别的事情。

我应该如何进入先前的状态（即回滚），然后创建一个分支，保持较新的状态？

回滚是否会删除任何内容？我应该只做这些吗？只是回滚，直到我在我想要的地方，编辑，然后提交？我以后可以合并变更集，或者至少看看它们吗？当然我可以只保存这个存储库，回滚，然后创建新的变更集，然后合并两个存储库？

我是 SCM 的新手，当然还有 DSCM，所以要温柔:)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-02T15:55:23.923

您不想使用`hg rollback`，它只会删除**一个**更改（最近的）。请参阅hg 书中的[您只能回滚一次。](http://hgbook.red-bean.com/read/finding-and-fixing-mistakes.html#id519728)

要从较早的版本创建分支，您需要找到要从中分支的版本号并运行：

```
hg clone -r <revnum> <source repository> <destination repository> 
```

然后，您可以在新克隆的存储库中进行更改（其中不包含您指定的修订号之后的任何历史记录），然后如果您愿意，稍后将这些更改合并回原始存储库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-28T11:45:50.153

[另一个答案](https://stackoverflow.com/a/710361/3195477)会起作用，但它是过度的。您需要做的就是：

```
hg up <revnum> 
```

并且您的本地工作文件夹将更新为指定修订的文件状态。你可以从那里工作。

一旦您提交，它将自动创建一个匿名分支。您的原始提交仍然保留，但不会影响您。

这是我建议从最简单的方法（恕我直言）开始。

# iphone - iPhone内存管理的最佳解释在哪里？

> ID：710288
> 
> 赞同：2
> 
> 时间：2009-04-02T15:41:10.900
> 
> 标签：iphone, memory-management

我正在寻找很好的解释。我有一本关于 Objective-c 的 1000 页书，但不幸的是，关于内存管理、保留计数的部分描述得非常糟糕且难以理解。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T15:53:38.373

一个简单的解释：任何你**alloc**，**new**，**retain**或**copy**你也必须**release**。此外，如果您计划在当前消息循环之外继续保留它（或者您冒着被自动释放并成为无效引用的风险），您应该保留任何您不分配或复制的内容。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T15:50:35.337

这是我发现的最简洁的解释之一：

[http://www.dikant.de/2007/08/23/cocoa-memory-management-101](http://www.dikant.de/2007/08/23/cocoa-memory-management-101)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T16:43:30.657

[CocoaDev](http://www.cocoadev.com/index.pl?RetainingAndReleasing)总是有很好的资源，他们对内存管理的介绍也不例外。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T18:59:33.620

当然，有很多免费资源可用于学习内存管理，但如果您对这个主题真的很陌生并且更喜欢可视化方法，Steve Scott（运行 Mac 开发者网络的人）有一个很棒的汤底- 一套培训视频，只需 10 美元即可下载：http: [//www.mac-developer-network.com/videotraining/beginner/vid001/](http://www.mac-developer-network.com/videotraining/beginner/vid001/)。它基本上是一个超越“使用释放和自动释放”的讲座，并讨论了操作系统如何管理内存。如果您在 Comp 中错过了这些内容，将非常有帮助。科学。101.

FWIW，我使用了一组三个“如果”条件，这些条件在我开始时很有帮助（例如，“如果我分配或复制对象，那么......”）。对我来说，一开始记住这三个条件比记住一套完整的规则更容易。我写了一个简短的教程，使用这些“大脑触发器”来解释规则，以防它对其他人有帮助。[http://www.clintharris.net/2009/three-brain-triggers-for-objc-memory-mgmt/](http://www.clintharris.net/2009/three-brain-triggers-for-objc-memory-mgmt/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T15:50:35.493

[Objective-C 中](https://stackoverflow.com/questions/106627/memory-management-in-objective-c) [的内存管理 学习 Obj-C 内存管理](https://stackoverflow.com/questions/370427/learn-obj-c-memory-management)

他们有一些简单的答案，但也有指向 Apple 文档的链接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T19:15:21.850

专门针对使用 NIB 和 IBOutlet 的内存管理，这是我见过的最短和最清晰的描述：

[http://blog.airsource.co.uk/index.php/2008/12/23/memory-management-and-nibs/](http://blog.airsource.co.uk/index.php/2008/12/23/memory-management-and-nibs/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-13T13:48:12.097

有趣的文章：http: [//interfacelab.com/objective-c-memory-management-for-lazy-people/](http://interfacelab.com/objective-c-memory-management-for-lazy-people/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-07T15:35:33.877

对我来说，[Apple 的内存管理编程指南](http://developer.apple.com/mac/library/documentation/cocoa/conceptual/MemoryMgmt/MemoryMgmt.html)效果很好。

它在一开始就解释了基础知识，因此您可以开始工作。但如果您有兴趣，它也会涉及更高级的主题。

# oracle - ORACLE - 将程序/包导出到文件

> ID：710290
> 
> 赞同：3
> 
> 时间：2009-04-02T15:41:28.153
> 
> 标签：oracle, file, export, database, procedure

我想以编程方式将我的过程/函数和包导出到单个文件（作为备份）并使用 Oracle 9.2。

我找到的最接近的解决方案是使用 DBMS_METADATA.GET_DDL ，但是我如何将 CLOB 输出到文本文件而不丢失任何部分（由于长度或缩进）？

或者您是否有其他解决方案来单独备份包或其他功能（只有我想要的一个，而不是全部）？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T19:38:06.103

尝试从 SQL*Plus 等命令行实用程序获取 CLOBS（和 LONGS）似乎总是给我带来格式化/截断问题。我的解决方案是用非类型检查语言 (Perl) 编写一个简单的实用程序，用于`DBMS_METADATA`将 CLOB 带回字符串。

片段：

...

```
$sthRef = $dbhRef->prepare("select dbms_metadata.get_ddl(?,?) from dual");

$sthRef->execute('PACKAGE', $thisName);

while (($thisDDL) = $sthRef->fetchrow()) {

  print $thisDDL;

}

$sthRef->finish; 
```

...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T15:45:27.083

`DBMS_METADATA`如果你想获得 DDL，除了你已经说过的，真的没有办法。

通常，这种备份是使用`exp`(or `expdp`) 完成的，尽管这不会像大多数其他 DBMS 系统那样创建 SQL 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-28T09:53:15.733

```
SET pages 0
spool proclist.sql
SELECT
CASE line
WHEN 1 THEN
'CREATE OR REPLACE ' || TYPE || ' ' || NAME || CHR(10) || text
ELSE
text
END
FROM user_source
WHERE TYPE IN ( 'PROCEDURE','FUNCTION')
ORDER BY name, line;
spool OFF
exit 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-17T13:00:57.117

感谢RAS，客人的回答，我只需要获取一些程序的代码，所以我尝试了代码，发现该代码在代码的第一行中截断了程序名称后的代码并将其替换为三个点' ...'

所以我将代码更改为以下内容：

```
 SELECT CASE line
      WHEN 1 THEN 'CREATE OR REPLACE ' -- || TYPE || ' ' || NAME || --CHR(10) || ' (' 
            || text
   ELSE
      text
   END
   FROM user_source
   WHERE TYPE IN ( 'PROCEDURE') and name like 'SomeThing%'
   ORDER BY name, line; 
```

这个页面 [导出程序和触发器](http://www.dba-oracle.com/t_export_stored_procedures_triggers.htm) 有一个非常有用的代码：

```
 connect fred/flintstone;

   spool procedures_punch.lst

   select
      dbms_metadata.GET_DDL('PROCEDURE',u.object_name)
      from
      user_objects u
   where
      object_type = 'PROCEDURE';

   spool off; 
```

最后一种方法是使用 Toad Schema Browser ，然后选择所有需要的程序并单击鼠标右键，然后从菜单中选择导出。

# vbscript - .WSC 无法识别代码更改

> ID：710295
> 
> 赞同：0
> 
> 时间：2009-04-02T15:41:38.887
> 
> 标签：vbscript

我以前遇到过这个问题，解决方案通常是重新启动 IIS。基本上，我对我们服务器上的 .wsc 文件进行了许多更改。但是当它运行时，它不会运行我所做的新代码更改。我已经通过文件开头的事件日志验证了这一点，但它没有显示出来。

我的问题是，显然在我们的生产服务器上重新启动 IIS 是我不愿意做的事情，但我们今天需要它运行。我尝试重新注册文件，但无济于事。

服务器是 32 位 Server 2008 操作系统。并且代码正在运行，它仍然会生成它应该生成的文件，但就像我说的那样，它没有使用最新的更改。

我可以提供的任何其他信息，请发表评论，我将进行编辑。

谢谢你，杰夫

编辑：Oisin，感谢您的回复，是的，我知道我讨厌 VBScript，以及与它相关的任何东西，包括这些窗口脚本组件。我已经向我的经理表达了这样的感受，但这是一项肮脏的工作，必须有人去做！

是的，它使用 Server.CreateObject 来调用组件。

**回答**：我已经意识到我的错误。我只是一遍又一遍地“注册”它，而我应该首先“取消注册”它“注册”它。伙计，我觉得自己很愚蠢，但正如他们所说，匆忙会浪费。

感谢您的回复和链接！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T15:51:05.367

哎呀，你的意思是 WSC 在 Windows 脚本组件中？自 2000 年以来，我没有写过其中之一。

您是使用 CreateObject 加载它（例如，它通过 regsvr32 注册为 COM 对象），还是使用基于文件的名字对象来加载它？（没有注册）。

如果它已注册，它可能会被缓存，直到应用重新启动。如果您切换到基于文件的名字对象，例如：Set o = GetObject("script:c:\path\obj.wsc")，您可能会在运行时更改 .wsc 文件。

（伙计，我怎么记得这个）

更多信息在这里 - 在存档之前快速！:D [http://www.microsoft.com/technet/scriptcenter/resources/scriptshop/default.mspx](http://www.microsoft.com/technet/scriptcenter/resources/scriptshop/default.mspx)

-Oisin

# perl - 是否有一个 Perl 模块来监控电子邮件队列？

> ID：710304
> 
> 赞同：6
> 
> 时间：2009-04-02T15:42:46.013
> 
> 标签：perl, email, exchange-server, cpan

我正在开发一个问题跟踪系统，并希望该应用程序能够处理电子邮件回复。也就是说，我想要一个可以监控电子邮件队列并根据电子邮件内容执行某些操作的脚本。然后它应该能够删除电子邮件等。

我目前使用 MIME::Lite 发送电子邮件，并且我可以处理编写脚本等（阅读：我对 Perl 并不陌生）。但是，我不知道哪些模块适合执行此特定任务。我想尽快开始这方面的工作，所以我希望缩小我对可能模块的搜索空间。

如果您需要知道，该应用程序将运行在标准的 linux、Perl、MySQL 堆栈上，并以 Exchange 作为邮件服务器。

任何人都可以建议一个 Perl 模块来帮助我吗？与此相关的任何教程或最佳实践也会有所帮助。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T15:47:19.153

[您是否可以通过IMAP](http://IMAP)或[WebDAV](http://en.wikipedia.org/wiki/Webdav)访问[Exchange](http://en.wikipedia.org/wiki/Microsoft_Exchange_Server)服务器？

对于 IMAP：

*   [邮件::IMAPClient](http://search.cpan.org/perldoc?Mail::IMAPClient)
*   [IMAP::客户端](http://search.cpan.org/perldoc?IMAP::Client)
*   [网络::IMAP::客户端](http://search.cpan.org/perldoc?Net::IMAP::Client)
*   [电子邮件::文件夹::IMAP](http://search.cpan.org/perldoc?Email::Folder::IMAP)

对于 WebDAV：

*   [电子邮件::文件夹::Exchange](http://search.cpan.org/perldoc?Email::Folder::Exchange)

如果在服务器上启用了 POP3，它也是一个选项。如果你有 IMAP，它可能是你要走的路。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T16:19:11.680

我使用[Mail::POP3Client做了类似的事情](http://search.cpan.org/perldoc?Mail::POP3Client)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T14:58:30.993

Perl 电子邮件项目 @ [http://emailproject.perl.org/mediawiki/index.php/Main_Page](http://emailproject.perl.org/mediawiki/index.php/Main_Page)提供了有关 perl 的面向邮件的模块的建议和其他信息。

# wpf - 使用 LoadComponent 加载外部 XAML 文件

> ID：710329
> 
> 赞同：2
> 
> 时间：2009-04-02T15:47:25.550
> 
> 标签：wpf

我发现了一些[证据](http://www.google.com/codesearch/p?hl=ru#tCmzmCmTMPc/samples/python/bubbles/app/app.xaml&q=Application.LoadComponent%20absolute%20path)表明这是可能的，

```
self.scene = Canvas()
Application.LoadComponent(self.scene, Uri('app.xaml', UriKind.Relative)) 
```

但我的代码失败了：

```
class Program
{
    [STAThread]
    static void Main(string[] args)
    {
        Canvas scene = new Canvas();
        Application.LoadComponent(scene, new Uri("app.xaml", UriKind.Relative));
    }
} 
```

我正在使用与“构建操作：无”和“始终复制”相同的 app.xaml。

```
<Canvas
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    x:Class="System.Windows.Controls.Canvas"
    x:Name="ball_design" >

    <Canvas x:Name="workaround_canvas" >

        <TextBlock x:Name="fps" Canvas.Left="10" Canvas.Top="10" Height="40" Canvas.ZIndex="10000" Text="-- fps" />
    <Canvas x:Name="wpfe_ball_0" Width="52" Height="52" Canvas.Left="0" Canvas.Top="30">
      <!-- Layer 3/<Group>/<Path> -->
      <Path Opacity="0.900000" StrokeThickness="2.000000" Stroke="#ffa6d000" StrokeMiterLimit="1.000000" Fill="#ffcbff00" Data="F1 M 51.000000,26.000000 C 51.000000,39.806641 39.807129,51.000000 26.000000,51.000000 C 12.192871,51.000000 1.000000,39.806641 1.000000,26.000000 C 1.000000,12.193359 12.192871,1.000000 26.000000,1.000000 C 39.807129,1.000000 51.000000,12.193359 51.000000,26.000000 Z"/>

      <!-- Layer 3/<Group>/<Path> -->
      <Path Opacity="0.740000" Data="F1 M 43.143066,13.087891 C 50.602051,22.888672 49.009766,36.642578 39.590332,43.812500 C 30.170898,50.980469 16.489258,48.842773 9.032715,39.042969 C 1.573242,29.240234 3.166016,15.486328 12.584961,8.316406 C 22.003906,1.149414 35.685547,3.285156 43.143066,13.087891 Z">
        <Path.Fill>
          <RadialGradientBrush MappingMode="Absolute" GradientOrigin="156.791016,170.453125" Center="156.791016,170.453125" RadiusX="53.626404" RadiusY="53.626404">
            <RadialGradientBrush.GradientStops>
              <GradientStop Offset="0.000000" Color="#ffffffff"/>
              <GradientStop Offset="0.361685" Color="#fff5f7dd"/>
              <GradientStop Offset="0.415730" Color="#ffebf0bc"/>
              <GradientStop Offset="1.000000" Color="#ffcbff00"/>
            </RadialGradientBrush.GradientStops>
            <RadialGradientBrush.Transform>
              <MatrixTransform Matrix="1.190000,0.165000,-0.165000,-1.281300,-113.414185,241.757843" />
            </RadialGradientBrush.Transform>
          </RadialGradientBrush>
        </Path.Fill>
      </Path>

      <!-- Layer 3/<Group>/<Path> -->
      <Path Fill="#ffffffff" Data="F1 M 23.100586,9.477539 C 24.741699,11.634766 23.116211,15.630859 19.470703,18.404297 C 15.825684,21.178711 11.540039,21.678711 9.899414,19.522461 C 8.258301,17.365234 9.883789,13.369141 13.529297,10.594727 C 17.174316,7.821289 21.459961,7.321289 23.100586,9.477539 Z"/>
    </Canvas>
    <TextBlock x:Name="dbgwin" FontSize="10" Canvas.Top="10" Canvas.Left="250" Height="500" Width="200" Text="IronPython DLR" />

  </Canvas>
</Canvas> 
```

我得到 IOException：找不到资源“app.xaml”。

什么是解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-23T21:08:42.703

我得到了这个工作。我的具体目标是将 ResourceDictionary 加载到 App 类中，这样我就可以从原始 XAML 文件加载自定义皮肤。就是这样。首先，在 App.xaml 中，添加以下内容：

```
 protected override void OnStartup(StartupEventArgs e) {
        base.OnStartup(e);
        LoadSkin("Skins/Skin1.xaml");

    }

    private void LoadSkin(string FilePath) {
        XmlReader XmlRead = XmlReader.Create(FilePath);
        Application.Current.Resources = 
            (ResourceDictionary)XamlReader.Load(XmlRead);
        XmlRead.Close();
    } 
```

创建一个“bin\Debug\Skins”文件夹并添加一个“Skin1.xaml”，内容如下：

```
<ResourceDictionary 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
>
    <Style x:Key="ButtonAStyle" TargetType="{x:Type Button}">
        <Setter Property="Control.Background" Value="Green" />
        <Setter Property="Control.Foreground" Value="White" />
    </Style>
</ResourceDictionary> 
```

* * *

**特定于皮肤**

在这种特殊情况下，您必须确保在各个窗口中正确使用样式资源。这是一个例子：

```
<Button 
    Name="button1" 
    Style="{DynamicResource ButtonAStyle}" 
    Click="button1_Click"
>Button</Button> 
```

这是一个尝试的巧妙技巧。在 button1_Click() 中，尝试添加与上述 App.OnStartUp() 中相同的代码，但将“Skin2.xaml”和“Red”作为按钮的背景颜色。皮肤会立即改变，无需重新加载应用程序或窗口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T20:13:24.863

LoadComponent 似乎无法加载外部 XAML 文件。

我检查了源代码：

```
 public static void LoadComponent(Object component, Uri resourceLocator) 
    {
        ...

        // Passed a relative Uri here.
        // needs to resolve it to Pack://Application.
        //..\..\ in the relative Uri will get stripped when creating the new Uri and resolving to the 
        //PackAppBaseUri, i.e. only relative Uri within the appbase are created here
        Uri currentUri = new Uri(BaseUriHelper.PackAppBaseUri, resourceLocator); 

        ...
    } 
```

所以 resourceLocator 应该是一个相对路径。并且会在 application:/// 权限下处理。

[MSDN](http://msdn.microsoft.com/en-us/library/aa970069.aspx#The_Pack_URI_Scheme)

> WPF 支持两种权限：application:/// 和 siteoforigin:///。application:/// 权限标识在编译时已知的应用程序数据文件，包括资源和内容文件。siteoforigin:/// 权限标识原始文件的站点。

可能的数据文件有：

*   包和部分类似于应用程序和文件，其中一个应用程序（包）可以包含一个或多个文件（部分），包括：

*   编译到本地程序集中的资源文件。

*   编译成引用程序集的资源文件。

*   编译成引用程序集的资源文件。

*   内容文件。

*   原始文件的站点。

前 4 个文件可通过 application:// 访问，但我正在寻找外部文件，因此唯一的选项是“内容文件”。

所以我把 app.xaml 变成了内容文件（细节在[这里](http://msdn.microsoft.com/en-us/library/aa970494.aspx#Content_Files)）

1.  为内容构建行动
2.  复制到输出目录以始终复制
3.  [程序集：AssemblyAssociatedContentFile("app.xaml")]

结果引发了这样的异常：'application/xaml+xml' ContentType 无效。

```
 public static void LoadComponent(Object component, Uri resourceLocator) 
    {
        ...

            if (!MimeTypeMapper.BamlMime.AreTypeAndSubTypeEqual(contentType)) 
            {
                throw new Exception(SR.Get(SRID.ContentTypeNotSupported, contentType)); 
            }
        ...
    } 
```

所以 LoadComponent 需要 'application/baml+xml' 而不是 'application/xaml+xml'。

我不知道将 xaml 作为外部文件存储在“application/baml+xml”中的方法，因此假设该任务没有解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T16:00:29.307

您将需要绝对文件 URI，包括整个 file://c:/ 等。因为相对仅在应用程序的资源中使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-28T15:57:19.820

为了使 LoadComponent 在 XAML 资源上工作，它需要具有“页面”的构建操作。然后 LoadComponent 工作，即使在控制台应用程序中。

当想要在服务器应用程序中访问从 Blend 生成的示例数据时，这可能很有用。

# iphone - 如何更改 UIImageView 的内部图像位置？

> ID：710332
> 
> 赞同：0
> 
> 时间：2009-04-02T15:48:22.007
> 
> 标签：iphone, animation, uiimageview

我在我的笔尖中定义了一个 UIImageView。应用程序启动后，我在该 UIImageView 中显示图像。也许我走错了路，但我想做的是以下几点：

我加载到视图中的图像比视图本身大。我希望它以原始大小显示并隐藏覆盖。然后我想在该视图内以随机方向缓慢移动该图像。

也许您知道带有背景图像的 html div 容器。在那里，您可以设置该背景图像的位置并使用 JavaScript 更改该位置。我在 iPhone 上需要类似的东西。

也许 UIImageView 不适合这样做？或者我必须将 UIImageView 设置为该图像的完整大小，然后慢慢移动 UIImageView 吗？它会比 iPhone 的屏幕还大吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T04:27:46.907

这是我对几乎相同问题的回答的要点：

没有一个简单的类方法可以做到这一点，但有一个函数可以用来获得所需的结果：CGImageCreateWithImageInRect(CGImageRef, CGRect) 会帮助你。

这是一个使用它的简短示例：

```
CGImageRef imageRef = CGImageCreateWithImageInRect([largeImage CGImage], cropRect);
[UIImageView setImage:[UIImage imageWithCGImage:imageRef]];
CGImageRelease(imageRef); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T16:03:25.837

您需要裁剪图像。请参阅[Lounges](https://stackoverflow.com/questions/158914/cropping-a-uiimage/276933#276933)对此[问题](https://stackoverflow.com/questions/158914/cropping-a-uiimage)的回答。

# javascript - 如何获取表单的 onSubmit 事件？

> ID：710333
> 
> 赞同：8
> 
> 时间：2009-04-02T15:49:05.233
> 
> 标签：javascript, html, forms

我想知道如何`onsubmit`从表单中获取事件以进行表单验证，因为我无法直接访问它。（我正在编写一个用于评论的 Wordpress 插件，因此无法直接访问表单标签或提交按钮。）

尝试为我的插件执行此操作感到非常沮丧，以至于我在下面编写了一个 Hello World 版本。我希望它在加载页面时显示“Hello World”警报，并在单击提交按钮时显示“表单提交”警报。相反，它会在页面加载时显示两个弹出窗口。

这是我的代码：

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
    <html>
    <head>
    <title>Hello World</title>
    </head>
    <body>
    <h2>Test</h2>
    <form action="#" method="post" id="commentform">

    <p><input type="text" name="author" id="author" size="22" tabindex="1" />
    <label for="author"><small>Name (required)</small></label></p>

    <p><input name="submit" type="submit" id="submit" tabindex="5" value="Submit Comment" />

    </form>

    <script type="text/JavaScript">
    <!--
    alert("Hello world");

    var formCheck = document.getElementById("commentform");

    formCheck.onSubmit = doMapping(); 

    function doMapping() {
        alert("form submitted");
        return false;
    }

    -->
    </script>     

    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-02T15:51:19.987

改变这个：

```
formCheck.onSubmit = doMapping() 
```

对此：

```
formCheck.onSubmit = doMapping 
```

当您将括号添加到函数的末尾时，您将执行该函数。当您分配一个函数（或将其作为参数传递给另一个函数）时，您需要省略括号，因为这是在 JavaScript 中检索函数指针的方法。

* * *

**编辑：**您还需要将函数的声明移到该`doMapping`函数的分配上方的 onsubmit 事件中，如下所示（很好的捕捉 tvanfosson！）：

```
function doMapping() {
        alert("form submitted");
        return false;
    }

formCheck.onSubmit = doMapping(); 
```

但是，如果该`doMapping`函数未在其他地方使用，您可以将`doMapping`函数声明为匿名函数，如下所示：

```
formCheck.onSubmit = function() {
        alert("form submitted");
        return false;
    } 
```

这对我来说似乎更干净。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-02T15:54:31.693

使用 jQuery。

```
$(document).ready( function() {
    $('#commentform').submit( function() {
        alert('form submitted');
        return false;
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T16:07:44.690

谢谢！实际上，我使用 Andrew 的建议和 window.onload 事件以另一种方式解决了它——我认为问题的部分原因是该元素实际上并未加载。

```
window.onload = function(){
    if (document.getElementById("commentform")){
        document.getElementById("commentform").onsubmit = doMapping;
    }
}

function doMapping(){
            alert("form submitted");
            return false;
} 
```

# eclipse - 使用 Eclipse TableViewer，如何使用箭头键导航和编辑单元格？

> ID：710341
> 
> 赞同：13
> 
> 时间：2009-04-02T15:51:09.033
> 
> 标签：eclipse, jface, tableviewer

我将 a`TableViewer`与内容提供程序、标签提供程序、a`ICellModifier`和`TextCellEditors`用于每一列一起使用。

当用户选择单元格时，如何添加箭头键导航和单元格编辑？我希望这是一种尽可能自然的行为。

看了一些网上的例子后，似乎有一种旧的方式（与 a `TableCursor`）和一种新的方式（`TableCursor`不与`CellEditors`?? 混合）。

目前，`TableViewer`没有光标的 my 只会在第一列中滚动。底层 SWT 表显示游标为空。

有没有通过键盘`TableViewer`使用和单元格导航的好例子？`CellEditors`

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-09-01T13:18:40.263

不知道有没有*好的*例子。我使用一组自定义代码来获取我认为是我的应用程序在`TableViewer`. （请注意，此时我们仍以 3.2.2 为目标，因此情况可能已经好转或发生了其他变化。）一些亮点：

*   我`setCellEditors()`在我的`TableViewer`.
*   在每个`CellEditor`人的控制下，我建立了我认为合适的`TraverseListener`. 例如，对于文本单元格：

    ```
    cellEditor = new TextCellEditor(table, SWT.SINGLE | getAlignment());
    cellEditor.getControl().addTraverseListener(new TraverseListener() {
        public void keyTraversed(TraverseEvent e) {
            switch (e.detail) {
            case SWT.TRAVERSE_TAB_NEXT:
                // edit next column
                e.doit = true;
                e.detail = SWT.TRAVERSE_NONE;
                break;

            case SWT.TRAVERSE_TAB_PREVIOUS:
                // edit previous column
                e.doit = true;
                e.detail = SWT.TRAVERSE_NONE;
                break;

            case SWT.TRAVERSE_ARROW_NEXT:
                // Differentiate arrow right from down (they both produce the same traversal @*$&#%^)
                if (e.keyCode == SWT.ARROW_DOWN) {
                    // edit same column next row
                    e.doit = true;
                    e.detail = SWT.TRAVERSE_NONE;
                }
                break;

            case SWT.TRAVERSE_ARROW_PREVIOUS:
                // Differentiate arrow left from up (they both produce the same traversal @*$&#%^)
                if (e.keyCode == SWT.ARROW_UP) {
                    // edit same column previous row
                    e.doit = true;
                    e.detail = SWT.TRAVERSE_NONE;
                }
                break;
            }
        }
    }); 
    ```

（对于下拉表格单元格，我抓住左右箭头而不是上下箭头。）

*   我还在 's 控件中添加了一个`TraverseListener`，`TableViewer`如果有人在选择整行时点击“return”，则该控件的工作是开始单元格编辑。

    ```
    // This really just gets the traverse events for the TABLE itself.  If there is an active cell editor, this doesn't see anything.
    tableViewer.getControl().addTraverseListener(new TraverseListener() {
        public void keyTraversed(TraverseEvent e) {
            if (e.detail == SWT.TRAVERSE_RETURN) {
                // edit first column of selected row
            }
        }
    }); 
    ```

*   现在，我*如何*控制编辑是另一回事。就我而言，我的整体`TableViewer`（以及其中每一列的表示）被松散地包裹在一个自定义对象中，该对象具有执行上述评论所说的方法。这些方法的实现最终会调用`tableViewer.editElement()`然后检查`tableViewer.isCellEditorActive()`单元格是否实际上是可编辑的（如果不是，我们可以跳到下一个可编辑的）。

*   我还发现能够以编程方式“放弃编辑”很有用（例如，当跳出一行中的最后一个单元格时）。不幸的是，我能想出的唯一方法是一个可怕的 hack，它决定与我的特定版本一起工作，方法是深入研究会产生所需“副作用”的东西的源代码：

    ```
     private void relinquishEditing() {
            // OMG this is the only way I could find to relinquish editing without aborting.
            tableViewer.refresh("some element you don't have", false);
        } 
    ```

抱歉，我不能给出更完整的代码块，但实际上，我必须发布一个完整的迷你项目，而我现在不准备这样做。希望这足以让您继续前进。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T18:58:36.447

这对我有用：

```
TableViewerFocusCellManager focusCellManager = new TableViewerFocusCellManager(tableViewer,new FocusCellOwnerDrawHighlighter(tableViewer));
ColumnViewerEditorActivationStrategy actSupport = new ColumnViewerEditorActivationStrategy(tableViewer) {
    protected boolean isEditorActivationEvent(ColumnViewerEditorActivationEvent event) {
        return event.eventType == ColumnViewerEditorActivationEvent.TRAVERSAL 
            || event.eventType == ColumnViewerEditorActivationEvent.MOUSE_DOUBLE_CLICK_SELECTION                                   
            || (event.eventType == ColumnViewerEditorActivationEvent.KEY_PRESSED && event.keyCode == SWT.CR) 
            || event.eventType == ColumnViewerEditorActivationEvent.PROGRAMMATIC;
       }
}; 
```

我可以在编辑时使用选项卡在各个方向导航，而在不处于编辑模式时可以使用箭头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-01T16:26:25.927

我让它基于这个[JFace Snippet](http://wiki.eclipse.org/index.php/JFaceSnippets#Snippet035TableCursorCellHighlighter)工作，但我还必须复制几个相关的类：

*   org.eclipse.jface.snippets.viewers.TableCursor
*   org.eclipse.jface.snippets.viewers.CursorCellHighlighter
*   org.eclipse.jface.snippets.viewers.AbstractCellCursor

我不记得我在哪里找到它们了。这也是一个 org.eclipse.swt.custom.TableCursor，但我无法让它工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-24T21:01:18.880

查看在 [双击时启用编辑器激活的示例。](http://dev.eclipse.org/viewcvs/viewvc.cgi/org.eclipse.jface.snippets/Eclipse%20JFace%20Snippets/org/eclipse/jface/snippets/viewers/Snippet052DouleClickCellEditor.java?view=markup)

行 [110 - 128] 之间的内容添加了 ColumnViewerEditorActivationStrategy 和 TableViewerEditor。在我的情况下，我想要单击开始编辑，所以我将第 115 行从：ColumnViewerEditorActivationEvent.MOUSE_DOUBLE_CLICK_SELECTION 更改为 ColumnViewerEditorActivationEvent.MOUSE_CLICK_SELECTION。将此添加到我的 TableViewer 后，tab 键将在启用编辑器的情况下从一个字段转到另一个字段。

# wix - 安装我的 msi 后如何确保 devenv.exe 未运行

> ID：710353
> 
> 赞同：2
> 
> 时间：2009-04-02T15:53:35.580
> 
> 标签：wix, windows-installer, vsx

我正在为 Visual Studio 2008 编写一个 VSPackage，并使用 WiX 生成的 Msi 部署它。在安装结束时，我正在运行“devenv.exe /setup”，以让 VS 注意到我的包。但是，如果有任何 Visual Studio 副本正在运行，此命令将不会成功。

目前，我告诉人们他们必须在安装之前关闭 Visual Studio 的所有副本，但我希望它是万无一失的。如果 Visual Studio (devenv.exe) 的任何副本正在运行，我如何检查某人何时运行我的 .msi，并阻止他们安装我的项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-05T15:40:22.907

```
while(devenvIsRunning()) {} //in main routine of Installer class

static bool devenvIsRunning() //uses this subroutine
        {
            Process[] procList = Process.GetProcesses();
            foreach (Process p in procList)
            {
                if (p.ProcessName == "devenv")
                {
                    MessageBox.Show("An instance of Visual Studio is still running.\nPlease close all open instances of Visual Studio before continuing.");
                    return true;
                }
            }
            return false;
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T20:23:54.807

WiX 工具集有一个 CloseApps CustomAction 可以为您关闭窗口。不幸的是，它没有提示关闭所有应用程序的列表，但代码将是一个合理的起点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T22:51:05.030

您最好的选择是遵循 Rob 的建议，并组合一个自定义操作来检查进程是否正在运行。我可能会做一些事情，例如查看它是否正在运行，尝试关闭，如果它仍在运行，然后安排重新启动并通过 RunOnce 注册表项进行 devenv 设置。

如果这工作量太大，那么使用 windows 命令`TASKKILL`退出应用程序就是一个丑陋的 hack。不是万无一失，但总比没有好。

```
TASKKILL /IM devenv.exe 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T16:02:39.647

您可以在项目中创建一个安装程序类并让它枚举正在运行的进程

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-11T06:27:08.263

我必须使用 TASKKILL /IM devenv.exe -F 来终止进程，并且 cmd 必须以管理员身份运行

# java - Java：Object 类未声明为抽象的基本原理

> ID：710362
> 
> 赞同：21
> 
> 时间：2009-04-02T15:55:26.420
> 
> 标签：java, object, specifications

为什么这个`java.lang.Object`类没有被声明为 abstract ？

当然，要使 Object 有用，它需要添加状态或行为，Object 类是一种抽象，因此它应该被声明为抽象...... **为什么他们选择不这样做？**

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-02T16:01:26.450

即使An`Object`没有任何特定于它的状态或行为，它也是有用的。

一个例子是将其用作用于同步的通用防护：

```
public class Example {
    private final Object o = new Object();

    public void doSomething() {
        synchronized (o) {
            // do possibly dangerous stuff
        }
    }
} 
```

虽然这个类的实现有点简单（这里不清楚为什么有一个显式对象很有用，你可以只声明方法`synchronized`），但在很多情况下它*确实*很有用。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-03T19:47:54.620

Ande，我认为你正在处理这个——双关语不是故意的——带有不必要的抽象程度。我认为这个（恕我直言）不必要的抽象级别是造成“问题”的原因。您可能是从数学理论方法来处理这个问题，而我们中的许多人是从“程序员试图解决问题”的方法来处理这个问题的。我相信这种方法上的差异导致了分歧。

当程序员着眼于实用性以及如何实际*实现*某些东西时，很多时候您需要一些完全任意的对象，其实际实例完全不相关。它不能为空。我在另一篇文章的评论中给出的示例是`*Set`（`*`==`Hash`或`Concurrent`或选择类型）的实现，这通常通过使用支持`*Map`并将`Map`键用作 Set 来完成。你经常不能使用`null`作为`Map`值，所以通常的做法是使用静态`Object`实例作为值，它会被忽略并且永远不会使用。但是，需要一些非空占位符。

另一个常见的用途是`synchronized`关键字*需要* `Object`同步，并且您希望确保您的同步项是完全私有的，以避免不同类无意地在同一个锁上同步的死锁。一个非常常见的习惯用法是分配一个`private final Object`在类中使用的锁。公平地说，从 Java 5 和`java.util.concurrent.locks.Lock`相关的新增内容开始，这个习语明显不太适用。

`Object`从历史上看，可实例化在 Java 中非常有用。您可以提出一个很好的观点，即只要对设计进行微小的更改或对 API 进行少量更改，就不再需要这样做了。你可能是正确的。

是的，API 可以提供一个`Placeholder`扩展类`Object`而不添加任何东西，用作上述目的的占位符。但是——如果你在扩展`Object`但什么都不添加，那么除了允许`Object`抽象之外，类中的价值是什么？在数学上，理论上，也许人们可以找到一个价值，但从实用上讲，这样做会增加什么价值？

在编程中，有时您需要一个对象、*某个*对象、*任何*非空的具体对象，您可以通过`==`and/or进行比较`.equals()`，但您不需要该对象的任何其他功能。它的存在只是作为一个唯一的标识符，否则绝对什么都不做。 `Object`完美地满足了这个角色，并且（恕我直言）非常干净。

我猜**这**就是为什么`Object`没有被声明为抽象的部分原因：它不被声明是直接有用的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-02T16:01:50.867

Object 是否指定了扩展它的类必须实现的方法才能有用？不，因此它不必是抽象的。

抽象类的概念具有明确定义的含义，不适用于 Object。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-02T16:11:24.587

您可以实例化`Object`同步锁：

```
Object lock = new Object();

void someMethod() {
  //safe stuff
  synchronized(lock) {
     //some code avoiding race condition
  }
}

void someOtherMethod() {
  //safe code
  synchronized(lock) {
    //some other stuff avoiding race condition
  }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-02T16:02:27.837

我不确定这是不是原因，但它允许（或允许，因为现在有更好的方法可以做到这一点）将对象用作锁：

```
Object lock = new Object();

....

synchronized(lock)
{
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-02T16:48:17.820

Object 如何比 null 更令人反感？

它是一个很好的位置标记（无论如何都和 null 一样好）。

另外，我不认为在没有抽象方法的情况下将对象抽象化不是一个好的设计。

我并不是说 null 是自切片面包以来最好的东西——前几天我读了一篇“发明家”的文章，讨论了拥有 null 概念的成本/价值……（我什至不认为 null 是可发明！我猜某个地方的某个人可能会声称他发明了零……）只是能够实例化 Object 并不比能够传递 null 更糟糕。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-02T16:05:52.417

你永远不知道什么时候你可能想使用一个简单的对象作为占位符。把它想象成在数字系统中有一个零（而 null 对此不起作用，因为 null 表示没有数据）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-07T03:37:24.397

将类抽象化*应该*是有原因的。一种是防止客户端实例化类并强制他们只使用子类（无论出于何种原因）。另一个是如果您希望通过提供抽象方法将其用作接口，子类*必须*实现这些方法。也许，Java 的设计者没有看到这样的原因，所以`java.lang.Object`仍然是具体的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-03T13:36:34.133

与往常一样，Guava 提供帮助：使用[http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Optional.html](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Optional.html) 这里的东西可以用来杀死空值/对象实例代码中的“非空占位符”。

这里有完全独立的问题：

*   他们为什么不把对象抽象化？
*   如果他们决定在未来的版本中将其抽象化，会带来多少灾难？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-07-04T21:44:48.223

我将提出另一个原因，即我发现 Object 对于自己实例化很有用。我创建了一个包含多个插槽的对象池。这些槽可以包含许多对象中的任何一个，所有对象都继承自抽象类。但是我在池中放什么来代表“空”。我可以使用`null`，但出于我的目的，确保每个插槽中始终有一些对象更有意义。我无法实例化要放入其中的抽象类，我也不想这样做。所以我可以创建我的抽象类的一个具体子类来表示“不是一个有用的 foo”，但是当使用 Object 的实例时这似乎是不必要的......实际上更好，因为它清楚地说明了插槽中的内容没有功能。因此，当我初始化我的池时，我通过创建一个对象来分配给每个插槽作为池的初始条件。

`Placeholder`我同意最初的 Java 工作人员将对象定义为 的具体子类`Object`，然后将其抽象化，这可能是有道理的`Object`，但他们的做法并没有让我感到错误。然后我会用`Placeholder`它来代替`Object`.

# visual-studio - 有人愿意向刚接触单元测试的程序员解释国际象棋吗？

> ID：710369
> 
> 赞同：2
> 
> 时间：2009-04-02T15:57:15.587
> 
> 标签：visual-studio, unit-testing

我最近才开始使用单元测试，并且我了解单元测试未涵盖的一些主要问题是并发和复杂的跨对象交互（无论如何，大多数现代的完全 OOP 语言完全消除了这些问题。）我的理解是[CHESS](http://research.microsoft.com/en-us/projects/chess/)解决了某种程度上的并发问题？有人可以告诉我国际象棋是什么，它是如何工作的，以及有什么缺点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T16:04:03.450

基本思想是竞争条件（当输出取决于两个或多个进程中的哪一个“首先到达那里”以定义“那里”）只有有限数量的可能排序。

因此，如果您可以控制顺序，则可以系统地测试它们。

如果您的代码对所有可能的排序都按预期工作，那么它就通过了。如果没有，则失败。

# java - Tiles 不会解析 Struts 标签

> ID：710370
> 
> 赞同：0
> 
> 时间：2009-04-02T15:57:20.907
> 
> 标签：java, jakarta-ee, struts, tiles

我尝试使用瓷砖，但似乎它没有解析 Struts 标签，它直接输出它们，例如而不是... 似乎是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T16:02:31.893

您需要在每个 JSP 文件中包含 taglib 库头，无论它是否是 tile：

```
<%@ taglib uri="/WEB-INF/struts-bean.tld" prefix="bean" %>
<%@ taglib uri="/WEB-INF/struts-html.tld" prefix="html" %>
<%@ taglib uri="/WEB-INF/struts-logic.tld" prefix="logic" %> 
```

ETC...

没有这个标签将不会被解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T18:15:09.937

I've seen evaluation-order things with netsed tags in jsp's - you're likely to run into problems with things like

```
 <t:x name="<c:out ... 
```

Can you post code and output? (I'm guessing you're code got parsed out because you didn't use the nice binary-logo button)

# php - 如何运行存储在我的应用程序目录而不是 PHP 目录中的单元测试？

> ID：710372
> 
> 赞同：1
> 
> 时间：2009-04-02T15:57:43.747
> 
> 标签：php, windows, unit-testing, windows-vista

我刚刚安装了 PHPUnit 并编写了一个快速类，我将其保存到 C:\PHP 中，它运行良好。但是，如果我将包含测试类的 php 文件移动到我的应用程序的测试目录，它会返回错误 Class firstTest could not be found in ..

如何解决问题，使其可以在应用程序测试目录中看到该类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T16:10:19.300

检查您的配置文件并确保给出了测试目录的正确路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T14:17:26.037

感谢您的回复-这不是我使用的解决方案，但它使我进行了研究，产生了替代方案。

我所做的是将我的 PHP 目录 (C:\PHP) 添加到 PATH 环境变量中。这允许我从我的应用程序的测试目录中调用 phpunit。

# c# - 是否应该使用业务逻辑编译内部 C# 应用程序？

> ID：710378
> 
> 赞同：2
> 
> 时间：2009-04-02T15:58:41.200
> 
> 标签：c#, automation, business-logic

**[背景]**

所以，我有一个 C# 应用程序，它是在我来到这里之前编写的。目前，我不在开发组织中，但我是网络营销组织中我的子组的技术负责人。我的职责是流程自动化、最少的桌面支持和定制应用程序，让我们的生活更轻松。

**[/背景]**

**[应用详情]**

我们有一个从 URL 列表创建自定义数据库文件的应用程序。它被设计为有一个输入文件和两个输出文件，用于使用这些类型的 db 文件的两个应用程序。两个输出文件之间的差异规则被编译到代码中。

**[/应用详情]**

内部 C# 应用程序是否应该使用在不重新构建的情况下无法更改的业务逻辑进行编译？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T16:03:02.453

内部应用程序有一个目标：支持流程。

如果创建输出的规则很简单，每天都在更改并且由用户输入，那么将其编译成二进制文件是完全错误的，投资于 GUI 和一组新的程序员可能会大有裨益。如果规则很复杂，每年更改一次并由管理层强制执行，那么将它们编译到二进制文件中是一种简单且经济高效的方式来维护它们并防止用户摆弄内部结构。

与往常一样，答案必须是“视情况而定”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T16:02:42.877

如果定期更改逻辑，则应避免将其构建到程序中。另一方面，由于它是内部的，我猜测重建应用程序所需的过程很少或不存在，所以它可能没有太大的区别。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T16:04:04.900

*   更改业务逻辑然后重新编译需要多长时间？
*   在不重新编译新版本的情况下更改业务逻辑需要多长时间？
*   重新编码需要多长时间？
*   就未来花费的额外时间而言，这将如何影响维护？
*   是否有任何需要该应用程序的人因为它是代码形式而无法更改业务逻辑？

回答这 5 个问题就会得到答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T16:03:47.523

如果不需要更改逻辑，那么是的，它可能应该与代码一起编译。

另一方面，如果某些因素可能会改变此业务逻辑的行为，那么您可能应该提供一种改变它的方法，例如改变其行为的 xml 配置文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T16:04:13.807

当然，如果您知道该实用程序将仅在您的组织内使用并且用于单一目的，那么将您的业务规则与逻辑混合并没有错。过度设计（在这种情况下，在永远不会被重用的情况下使代码可重用）不会有效地利用资源。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-26T15:31:07.820

我通常根据变化的概率采用多种配置策略。

首先，**永远不要**在没有以某种方式记录的情况下将业务规则放入代码中。代码有很多变量，只有其中一些可以安全地更改，同时仍保持正确的行为。我通常在课程开始时放置一个常量来确定可以更改哪些行为，即

```
// Prefer this
const int AllowDownloadAttempts = 2;
if (AttemptDownload() > AllowDownloadAttempts) RegisterAndAllowDownload();

// Over this
if (AttemptDownload() > 2) RegisterAndAllowDownload(); 
```

我遵循的基本规则是必须记录除 [-1, 0, 1] 以外的任何内容。

如果它不重要并且不太可能经常更改，那么我会将它放在应用程序配置文件（例如 App.config）中并通过强类型配置类访问它，这样您就可以跟踪它的用法以了解何时安全删除或更改。

如果需要频繁更改或由业务用户更改，那么我会将其存储在数据库中并提供简单的 GUI 进行编辑，然后在应用程序加载时将其加载到强类型配置类中。

# c# - C# 中的 HTTP 代理服务器

> ID：710379
> 
> 赞同：7
> 
> 时间：2009-04-02T15:59:28.873
> 
> 标签：c#, proxy, httplistener

我的公司正在尝试使用 .NET Fx 3.5 和 C# 编写代理服务器。从我们的[研究](http://bytes.com/groups/net-web-services/510683-proxy-server-httplistener)中，我了解到 HttpListener 不是代理服务器的理想选择，尽管我不确定为什么。

我们目前正在使用[Mentalis 代理示例源代码](http://www.mentalis.org/soft/projects/proxy/)，尽管这将涉及实现我们自己的日志记录和性能计数器等。使用 HttpListener 将包装 Http.sys，这将为我们提供一些开箱即用的性能统计信息。

那么为什么 HttpListener 不适合 HTTP 代理工作呢？

（是的，我们也在通过编写或配置 ICAP 服务器来考虑 Squid 3.1。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T17:12:04.520

HttpListener 在 .NET 中为*简单*的HTTP 服务器提供主要构建块。简单包括不支持高操作率。

通常，HTTP 代理需要非常低的开销来支持许多并发连接以及提供代理的功能（这取决于代理的类型）。

[代理在RFC 2616 §8.1.3](https://www.rfc-editor.org/rfc/rfc2616#section-8.1.3 "IETF")中有详细说明）并且立即提供了一项（如果我正确理解 HttpListener）是不可能的：

> 代理服务器必须分别与它的客户端和它连接的源服务器（或其他代理服务器）发出持久连接信号。每个持久连接仅适用于一个传输链路。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T09:46:13.283

你可能还认为 nginx 的 windows 端口是前几天发布的。许多有squid 和varnish 经验的站点在转换为nginx 后都非常高兴。然后，这些天总是有任何 MS 调用 ISA 服务器。

现在去看看 Mentalis 代码：D

# unit-testing - 模拟实体框架上下文

> ID：710383
> 
> 赞同：19
> 
> 时间：2009-04-02T16:01:06.420
> 
> 标签：unit-testing, entity-framework, mocking

我正在使用实体框架来访问我的数据库，并且我想在我的单元测试中模拟数据库上下文，以便我可以测试我的中间层类而不依赖于真实数据。我知道我不是第一个提出这个问题的人[（Mocking an Entity Framework Model）](https://stackoverflow.com/questions/604191/mocking-an-entity-framework-model)，但经过一番谷歌搜索后，我有一种直觉，可能仅基于模型的元数据来实例化上下文。

有没有人能够做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T16:58:21.837

一种众所周知的方法是使用[存储库模式](http://msdn.microsoft.com/en-us/library/ff649690.aspx)。这充当了具体数据访问实现的一层，并提供了一个注入测试替身的地方。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-02T16:15:54.437

您可以只使用元数据，有一篇关于它的好文章，以及一般的单元测试 EF，[在这里](http://blogs.msdn.com/diego/archive/2008/03/03/unit-testing-your-entity-framework-domain-classes.aspx)。

# c# - 如何以二进制格式向端口发送数据

> ID：710384
> 
> 赞同：0
> 
> 时间：2009-04-02T16:01:22.193
> 
> 标签：c#, .net, binary-data

我是低级编程的新手。在我的项目（C#.NET）中，我们使用 EDBS 协议（7 位格式）进行通信，我有位格式的数据要发送，如 00101010，所以我们请指导我如何将这些发送到端口。我知道串行端口类接受二进制格式的数据，但不知道如何将位格式转换为字节。

提前致谢

前置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T16:06:12.680

使用 BitConverter 类从字节创建基本类型（如字节或整数）。

[http://msdn.microsoft.com/en-us/library/system.bitconverter.aspx](http://msdn.microsoft.com/en-us/library/system.bitconverter.aspx)

还有一个名为 BitArray 的类可用于存储位表示：

[从位数组转换为字节](https://stackoverflow.com/questions/560123/convert-from-bitarray-to-byte)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T16:08:13.720

.Net 只接收字节（最小单位）的数据，您可以使用 BitConverter 将各种值类型转换为数组的字节，反之亦然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T18:03:45.797

有一个名为 BitVector32 的类可让您将位值封装为 32 位数字。对不起昨天的答案，我今天才发现这个。

# vb.net - 如何解决 VB.NET 部署的 LINQ 依赖问题？

> ID：710389
> 
> 赞同：0
> 
> 时间：2009-04-02T16:02:06.980
> 
> 标签：vb.net, deployment, installation

我有一个包含 .dbml 文件的程序。我用服务器资源管理器创建了这个文件。

我想在其他计算机上执行这个程序，但我似乎遇到了依赖问题，因为我使用的是 LINQ。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-13T00:50:13.653

你可以说得更详细点吗？你遇到什么错误？您是否使用了 SQL 密码或网络身份验证？您的用户是否将网络帐户添加到 SQL 中？这是基于权限的错误吗？

只是另一种可能性：您的用户应该在他们的系统上安装 .NET 3.51，否则他们将无法获得最好的 Linq 支持。他们可能根本没有 Linq 程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T01:03:22.013

是的，我们需要更多信息，但我猜你的 ConnectionString 有问题？如，您的 DBML 设计器文件中有一个连接字符串，它与您的生产数据库连接字符串不匹配？

如果是这种情况，那么也许编写一个类来处理代码中 DataContext 的所有实例化。

然后，在该类中，无论何时创建新的数据上下文，您都可以用当前的连接字符串覆盖 DBML 连接字符串，可能来自您的 web.config。这可确保您的 LINQ 内容在运行时始终连接到正确的数据库。

也许是这样的（属性名称可能不同）：

```
Public Shared Function GetNewContext() As YourDataContext
   Dim dContext As YourDataContext

   dContext = New YourDataContext()
   dContext.Connection.ConnectionString = MyConnectionStringFromTheWebConfig()

   Return dContext 
```

结束功能

# java - 使用 Spring IoC 设置枚举值

> ID：710392
> 
> 赞同：32
> 
> 时间：2009-04-02T16:02:31.893
> 
> 标签：java, enums, spring

有没有办法在构建时通过 Spring IoC 设置这样的枚举值？

我想做的是在类加载时注入在下面的代码片段中硬编码的值：

```
public enum Car
{
        NANO ("Very Cheap", "India"),
        MERCEDES ("Expensive", "Germany"),
        FERRARI ("Very Expensive", "Italy");

        public final String cost;
        public final String madeIn;

        Car(String cost, String madeIn)
        {
                this.cost= cost;
                this.madeIn= madeIn;
        }

} 
```

假设该应用程序必须部署在 Nanos“几乎免费”的德国，或 Ferraris“买不起”的印度。在这两个国家，只有三辆汽车（确定性集），不多不少，因此是一个枚举，但它们的“内部”值可能不同。因此，这是不可变对象的上下文**初始化**的情况。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-02T16:18:07.940

你的意思是设置`enum`自己？

我不认为这是可能的。您不能实例化枚举，因为它们具有`static`性质。所以我认为 Spring IoC 也不能*创建* `enums`。

另一方面，如果您需要使用 a 设置初始化某些内容，`enum`请查看[Spring IoC 章节](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html)。（搜索枚举）您可以使用一个简单的示例。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-02T18:30:08.403

我不认为它可以从 Spring 的`ApplicationContext`配置中完成。但是，你真的需要 Spring 来完成它，还是你可以满足于使用[ResourceBundle](http://java.sun.com/j2se/1.4.2/docs/api/java/util/ResourceBundle.html)进行简单的外部化；像这样：

```
public enum Car
{
    NANO,
    MERCEDES,
    FERRARI;

    public final String cost;
    public final String madeIn;

    Car()
    {
            this.cost = BUNDLE.getString("Car." + name() + ".cost");
            this.madeIn = BUNDLE.getString("Car." + name() + ".madeIn");
    }

    private static final ResourceBundle BUNDLE = ResourceBundle.getBundle(...);

} 
```

在属性文件中，每个特定区域设置一个，输入描述可能的内部枚举值的键：

```
Car.NANO.cost=Very cheap
Car.NANO.madeIn=India
Car.MERCEDES.cost=Expensive
... 
```

这种方法的唯一缺点是必须在 Java 代码中将枚举字段的名称（cost、madeIn）重复为字符串。**编辑**：从好的方面来说，您可以将所有枚举的所有属性堆叠到每种语言/区域设置的一个属性文件中。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-05-24T16:28:17.773

好的，这很繁琐，但可以做到。

Spring 确实不能实例化枚举。但这不是问题——Spring 也可以使用工厂方法。

这是关键组件：

```
public class EnumAutowiringBeanFactoryPostProcessor implements BeanFactoryPostProcessor {

    private final List<Class<? extends Enum>> enumClasses = new ArrayList<>();

    public EnumAutowiringBeanFactoryPostProcessor(Class<? extends Enum>... enumClasses) {
        Collections.addAll(this.enumClasses, enumClasses);
    }

    @Override
    public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException {
        for (Class<? extends Enum> enumClass : enumClasses) {
            for (Enum enumVal : enumClass.getEnumConstants()) {
                BeanDefinition def = new AnnotatedGenericBeanDefinition(enumClass);
                def.setBeanClassName(enumClass.getName());
                def.setFactoryMethodName("valueOf");
                def.getConstructorArgumentValues().addGenericArgumentValue(enumVal.name());
                ((BeanDefinitionRegistry) beanFactory).registerBeanDefinition(enumClass.getName() + "." + enumVal.name(), def);
            }
        }
    }
} 
```

然后下面的测试类表明它可以工作：

```
@Test
public class AutowiringEnumTest {

    public void shouldAutowireEnum() {
        new AnnotationConfigApplicationContext(MyConig.class);

        assertEquals(AutowiredEnum.ONE.myClass.field, "fooBar");
        assertEquals(AutowiredEnum.TWO.myClass.field, "fooBar");
        assertEquals(AutowiredEnum.THREE.myClass.field, "fooBar");
    }

    @Configuration
    public static class MyConig {

        @Bean
        public MyClass myObject() {
            return new MyClass("fooBar");
        }

        @Bean
        public BeanFactoryPostProcessor postProcessor() {
            return new EnumAutowiringBeanFactoryPostProcessor(AutowiredEnum.class);
        }
    }

    public enum AutowiredEnum {
        ONE,
        TWO,
        THREE;

        @Resource
        private MyClass myClass;

    }

    public static class MyClass {

        private final String field;

        public MyClass(String field) {
            this.field = field;
        }
   }

} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-02T17:22:05.243

为什么不提供一个接受 String 的 setter（或构造函数参数），并简单地调用[Enum.valueOf(String s)](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Enum.html#valueOf%28java.lang.Class,%20java.lang.String%29)从 String 转换为 enum。请注意，如果失败将引发异常，并且您的 Spring 初始化将退出。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-08-05T16:51:29.350

您不能通过 Spring 创建新的枚举值，它们必须在类中声明。但是，由于枚举值无论如何都是单例的（由 JVM 创建），因此应该设置的任何配置或要注入的服务都可以通过调用枚举类中的静态方法来完成：

[http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/beans/factory/config/MethodInvokingFactoryBean.html](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/beans/factory/config/MethodInvokingFactoryBean.html)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-03-19T11:10:51.820

我通过以下方式完成了它：

```
@Component
public class MessageSourceHelper {
    @Inject
    public MessageSource injectedMessageSource;

    public static MessageSource messageSource;

    public static String getMessage(String messageKey, Object[] arguments, Locale locale) {
        return messageSource.getMessage(messageKey, arguments, locale);
    }

    @PostConstruct
    public void postConstruct() {
        messageSource = injectedMessageSource;
    } 
```

}

这样，您可以轻松地在枚举中使用它来通过以下方式获取消息：

```
MessageSourceHelper.getMessage(key, arguments, locale); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-02T16:17:54.103

你需要设置什么？这些值是在类加载时创建的，因为它是一个枚举，所以不能创建其他值（除非您将它们添加到源代码并重新编译）。

这就是枚举的重点，能够将类型限制为明确范围的常量、不可变值。现在，在您的代码中的任何位置，您都可以引用 Car 类型或其值、Car.NANO、Car.MERCEDES 等。

另一方面，如果您有一组不是显式范围的值，并且您希望能够创建这种类型的任意对象，您将使用与您的帖子中相同的 ctor，但作为常规，而不是枚举类。然后 Spring 提供了各种帮助类来从某个源（XML 文件、配置文件等）读取值并创建该类型的列表。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-02T18:11:40.537

```
<bean id="car" class="Foo">
    <property name="carString" value="NANO" />
</bean> 
```

然后在你的 Foo 类中，你会有这个 setter：

```
public void setCar(String carString) {
    this.carString = Car.valueOf(carString);
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-09-05T08:42:23.210

尝试对 Enum 进行变异是非常愚蠢的，并且完全违背了他们的设计目标。根据定义，枚举表示组内的不同值。如果您需要更多/更少的值，则需要更新源。虽然您可以通过添加设置器（毕竟它们只是对象）来更改枚举状态，但您可以入侵系统。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-11-21T20:00:15.923

当我在不同的语言环境中本地化我的枚举标签时，我遇到了同样的问题。

**枚举代​​码：**

```
public enum Type {
   SINGLE("type.single_entry"),
   MULTIPLE("type.multiple_entry"),
   String label;

   Type(String label) {
     this.label = label;
   }

   public String getLabel() {
     String translatedString = I18NTranslator.getI18NValue(getLocale(), label);
     return StringUtils.isEmpty(translatedString) ? label : translatedString;
   }
} 
```

我的 I18NTranslator 类基本上加载消息源以获取本地化内容。`I18Ntransalator`类取决于`springContext`如果你不写你可能会遇到一个特殊的错误。有时可能会面临导致空指针异常的依赖关系。为了解决这个问题，我付出了很多努力。

```
@Component
@DependsOn({"springContext"})
public class I18NTranslator {

    private static MessageSource i18nMessageSource;

    public static String getI18NValue(Locale locale, String key) {
        if (i18nMessageSource != null)
            return i18nMessageSource.getMessage(key, null, locale);
        return key;
    }

    @PostConstruct
    public void initialize() {
        i18nMessageSource = SpringContext.getBean("i18nMessageSource", MessageSource.class);
    }
} 
```

我们必须设置弹簧上下文

```
@Component
@Slf4j
public class SpringContext implements ApplicationContextAware {

    private static ApplicationContext context;

    public static <T extends Object> T getBean(Class<T> beanClass) {
        return context.getBean(beanClass);
    }

    public static <T extends Object> T getBean(String beanClassName, Class<T> beanClass) {
        return context.getBean(beanClassName, beanClass);
    }

    @Override
    public void setApplicationContext(ApplicationContext context) throws BeansException {
        SpringContext.context = context;
    }
} 
```

现在是时候为 I18NMessageSource 定义 bean。

```
@Configuration
public class LocaleConfiguration implements WebMvcConfigurer {

    @Bean(name = "i18nMessageSource")
    public MessageSource getMessageResource() {
        ReloadableResourceBundleMessageSource messageResource = new ReloadableResourceBundleMessageSource();
        messageResource.setBasename("classpath:i18n/messages");
        messageResource.setCacheSeconds(3600);
        messageResource.setDefaultEncoding("UTF-8");
        return messageResource;
    }

    @Bean(name = "localeResolver")
    public LocaleResolver getLocaleResolver() {
        return new UrlLocaleResolver();
    }

    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        //UrlLocalInterceptor is custom locale resolver based on header paramter.
        UrlLocaleInterceptor localeInterceptor = new UrlLocaleInterceptor();
        registry.addInterceptor(localeInterceptor);
    }
} 
```

PS：如果您需要自定义拦截器代码，我可以在评论中分享。在 resources/i18n 文件夹中定义所有本地属性文件，并带有消息前缀，例如`messages_en.properties`英语和`messages_fr.properties`法语。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-02T18:23:11.227

好吧，这有点复杂，但你可能会找到一种方法来集成它。枚举并不意味着在运行时改变，所以这是一个反射黑客。抱歉，我没有 Spring 实现部分，但您可以构建一个 bean 来接收枚举类或对象，以及另一个字段，该字段将是一个或多个新值。

```
Constructor con = MyEnum.class.getDeclaredConstructors()[0];
Method[] methods = con.getClass().getDeclaredMethods();
for (Method m : methods) {
  if (m.getName().equals("acquireConstructorAccessor")) {
    m.setAccessible(true);
    m.invoke(con, new Object[0]);
  }
}
Field[] fields = con.getClass().getDeclaredFields();
Object ca = null;
for (Field f : fields) {
  if (f.getName().equals("constructorAccessor")) {
    f.setAccessible(true);
    ca = f.get(con);
  }
}
Method m = ca.getClass().getMethod(
  "newInstance", new Class[] { Object[].class });
m.setAccessible(true);
MyEnum v = (MyEnum) m.invoke(ca, new Object[] { 
  new Object[] { "MY_NEW_ENUM_VALUE", Integer.MAX_VALUE } });
  System.out.println(v.getClass() + ":" + v.name() + ":" + v.ordinal()); 
```

这是取自[这个网站](http://www.theserverside.com/news/thread.tss?thread_id=50190)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-08T10:13:09.653

这是我找到的解决方案（感谢 Javashlook，他的回答让我走上了正轨）。它有效，但它很可能不是生产级的方式。

不过总比一千字好，这里是代码，我让你自己判断。

让我们看一下修改后的`Car`enum ：

```
public enum Car {
    NANO(CarEnumerationInitializer.getNANO()), MERCEDES(
            CarEnumerationInitializer.getMERCEDES()), FERRARI(
            CarEnumerationInitializer.getFERRARI());

    public final String cost;
    public final String madeIn;

    Car(ICarProperties properties) {
        this.cost = properties.getCost();
        this.madeIn = properties.getMadeIn();
    }
} 
```

这里是“管道”类：

```
//Car's properties placeholder interface ...
public interface ICarProperties {
    public String getMadeIn();
    public String getCost();
}
//... and its implementation
public class CarProperties implements ICarProperties {
    public final String cost;
    public final String madeIn;

    public CarProperties(String cost, String madeIn) {
        this.cost = cost;
        this.madeIn = madeIn;
    }
    @Override
    public String getCost() {
        return this.cost;
    }
    @Override
    public String getMadeIn() {
        return this.madeIn;
    }
}

//Singleton that will be provide Car's properties, that will be defined at applicationContext loading.
public final class CarEnumerationInitializer {
    private static CarEnumerationInitializer INSTANCE;
    private static ICarProperties NANO;
    private static ICarProperties MERCEDES;
    private static ICarProperties FERRARI;

    private CarEnumerationInitializer(ICarProperties nano,
            ICarProperties mercedes, ICarProperties ferrari) {
        CarEnumerationInitializer.NANO = nano;
        CarEnumerationInitializer.MERCEDES = mercedes;
        CarEnumerationInitializer.FERRARI = ferrari;
    }

    public static void forbidInvocationOnUnsetInitializer() {
        if (CarEnumerationInitializer.INSTANCE == null) {
            throw new IllegalStateException(CarEnumerationInitializer.class
                    .getName()
                    + " unset.");
        }
    }

    public static CarEnumerationInitializer build(CarProperties nano,
            CarProperties mercedes, CarProperties ferrari) {
        if (CarEnumerationInitializer.INSTANCE == null) {
            CarEnumerationInitializer.INSTANCE = new CarEnumerationInitializer(
                    nano, mercedes, ferrari);
        }
        return CarEnumerationInitializer.INSTANCE;
    }

    public static ICarProperties getNANO() {
            forbidInvocationOnUnsetInitializer();
        return NANO;
    }

    public static ICarProperties getMERCEDES() {
            forbidInvocationOnUnsetInitializer();
        return MERCEDES;
    }

    public static ICarProperties getFERRARI() {
            forbidInvocationOnUnsetInitializer();
        return FERRARI;
    }
} 
```

最后，applicationContext 定义：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans>
    <bean id="nano" class="be.vinkolat.poc.core.car.CarProperties">
        <constructor-arg type="java.lang.String" value="Cheap"></constructor-arg>
        <constructor-arg type="java.lang.String" value="India"></constructor-arg>
    </bean>
    <bean id="mercedes"
        class="be.vinkolat.poc.core.car.CarProperties">
        <constructor-arg type="java.lang.String" value="Expensive"></constructor-arg>
        <constructor-arg type="java.lang.String" value="Germany"></constructor-arg>
    </bean>
    <bean id="ferrari" class="be.vinkolat.poc.core.car.CarProperties">
        <constructor-arg type="java.lang.String"
            value="Very Expensive">
        </constructor-arg>
        <constructor-arg type="java.lang.String" value="Italy"></constructor-arg>
    </bean>
    <bean id="carInitializer"
        class="be.vinkolat.poc.core.car.CarEnumerationInitializer"
        factory-method="build" lazy-init="false">
        <constructor-arg type="be.vinkolat.poc.core.car.CarProperties"
            ref="nano" />
        <constructor-arg type="be.vinkolat.poc.core.car.CarProperties"
            ref="mercedes" />
        <constructor-arg type="be.vinkolat.poc.core.car.CarProperties"
            ref="ferrari" />
    </bean>
</beans> 
```

它有效，但有一个主要弱点：`CarEnumerationInitializer`必须在对`Car`枚举进行任何引用之前实例化，否则 CarProperties 为空，这意味着 Car 的属性在加载时无法设置`Car`（因此`IllegalStateException`抛出，至少使其崩溃一种可预测的和记录在案的方式）。`carInitializer`bean 的属性`lazy-init`设置为显式`false`，以强调需要尽快加载它。我想说它在一个简单的应用程序中可能很有用，您可以轻松猜测第一次调用`Car`将在哪里进行。对于一个更大的，它可能会很混乱，我不鼓励你使用它。

希望这个帮助、评论和投票（上下）非常受欢迎:) 我会等几天让这个答案成为公认的答案，让你做出反应。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-05-18T07:29:34.900

您可以将**Enum**类用作**工厂 bean**。示例：使用枚举值设置*serializationInclusion*字段：

```
 <property name="serializationInclusion">
                <bean class="org.codehaus.jackson.map.annotate.JsonSerialize.Inclusion" factory-method="valueOf">
                    <constructor-arg>   
                        <value>NON_NULL</value>
                    </constructor-arg>
                </bean>
            </property> 
```

但实际上（Spring 3.1）一个更简单的解决方案是可行的：您只需编写枚举值，Spring 就会识别出要做什么：

```
<property name="serializationInclusion" value="NON_NULL"/> 
```

# .net - 基于 WPF 矢量的界面

> ID：710394
> 
> 赞同：1
> 
> 时间：2009-04-02T16:02:40.130
> 
> 标签：.net, wpf

我正在使用 WPF 开发一个新的 C# 应用程序。我的印象是 WPF 是基于矢量的，并且文本/按钮将以独立于分辨率的方式绘制。运行我的应用程序时，很明显我的应用程序不是使用矢量绘制的。一些文本变得相当块状，使用 windows 放大镜时，您可以看到所有内容的粗糙边缘。

在我的应用程序中我需要做一些特别的事情来打开矢量绘图吗？还是我的特定机器有问题？（我正在使用最新的图形驱动程序运行 Windows Vista x64）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-01T17:22:49.327

我打算将此添加为评论，但我希望它被正确引用和脚注。

Windows Vista 中的 Mangifier 辅助工具***曾经***支持 WPF。如果您缩放 WPF 内容，您会看到应用程序的清晰放大版本 - 证明 WPF 确实是基于矢量的。

Tim Sneath 是 Microsoft 的一名技术传播者，[他在 2006 年发表了一篇关于此的博文](http://blogs.msdn.com/tims/archive/2006/04/04/568648.aspx)：

![在此处输入图像描述](https://i.stack.imgur.com/rmOto.jpg)

**2011 年 6 月 25 日：**原始图像消失了。替换为显示相同效果的另一张图片。

Greg Schechter[在这个博客上回答了一些评论](http://blogs.msdn.com/greg_schechter/archive/2008/05/12/gpu-accelerated-custom-effects-for-wpf.aspx)者，解释说放大镜不再有这个技巧。放大镜会专门检测 WPF 应用程序，并知道如何要求它们进行缩放。他们消除了放大镜中对 WPF 的依赖。放大镜似乎依赖于他们想要删除或贬低的 WPF 中的某些内容：

> “bp”和“Joseph Cooney”都注意到，使用内置 OS 放大镜放大 WPF 内容不再对内容进行独立于分辨率的缩放。
> 
> 这种观察是正确的。
> 
> 由于一系列太多无法在此处描述的更改，OS 放大镜不再“支持 WPF”，并且像处理其他内容一样进行位图缩放。尽管我们确实失去了此功能，但我们相信，如果没有使 Magnifier 能够以特定于 WPF 的方式工作的依赖项，我们可以更加敏捷地为 WPF 客户提供的东西向前发展。
> 
> 请注意，以上*只是*关于进程外放大。当您在自己的 WPF 应用程序中进行缩放（通过缩放）时，渲染会继续以更高的比例重新光栅化，因此在最常见的情况下一切都保持平滑。这种变化严格来说是关于使用外部放大镜。

所以放大镜曾经有它，但现在没有了。

* * *

在第 9 频道的视频“ [Greg Schechter：Windows Presentation Foundation(WPF) 架构](http://channel9.msdn.com/Shows/Going+Deep/Greg-Schechter-Windows-Presentation-FoundationWPF-Architecture)”中，Greg Schechter 谈到了 Magnifier 是如何提供此功能的。

放大镜和 DWM 一起工作。放大镜修改了 DWM 场景图，使其客户区实际指向场景图的桌面根。DWM 然后知道放大镜就在那里，并且知道如何避免那种可怕的“将摄像机指向显示摄像机的电视”效果。

* * *

**编辑**：2018 年 9 月 7 日。来自[伊恩格里菲斯的回答：](https://stackoverflow.com/a/4300228/12597)

> 回到 Vista 首次发布时，以及 WPF 版本 3.0 上，使用内置放大镜进行缩放实际上会进行基于矢量的缩放。
> 
> 这在 WPF 3.5 服务包 1 发布时停止工作。（它在 sp1 之前的 3.5 中工作。）在此之前它工作的原因是 DWM（桌面窗口管理器） - 负责呈现您在屏幕上看到的所有内容的 Windows 部分 - 使用 MILCORE.DLL 进行渲染。WPF 3.0 和 3.5 版也使用相同的组件进行渲染 - 这意味着所有 WPF 内容都是本机内容，可以这么说。（事实上​​，在没有 DWM 的 Windows XP 上，MILCORE.DLL 是 WPF 为自己的利益而放在您的系统上的东西。但它内置在 Vista 和 Windows 7 中。）当 WPF 使用 MILCORE.DLL在 Vista 上渲染时，DWM 应用的任何效果（例如缩放）也将以您希望 WPF 的方式应用 - 它确实在没有像素化的情况下进行缩放。
> 
> 不幸的是，情况已不再如此。原因是 WPF 开始添加新的渲染功能。在 3.5 sp1 中，有问题的新功能是支持自定义像素着色器。为此，微软必须发布 MIL 的更新。（媒体集成层 - 进行实际渲染的位。）但是，他们并不能真正更新 MILCORE.DLL，因为这是 Windows 的一部分 - 这是您在屏幕上看到的所有内容的方式。发布 MILCORE.DLL 的新版本实际上意味着推出对 Windows 的更新。Windows 的发布时间表独立于 .NET 的发布时间表，因此 WPF 团队可以合理添加新功能的唯一方法是发布新的 MIL。（理论上他们可以通过 Windows Update 完成，
> 
> 从 .NET 3.5 sp1 开始，MIL 位于名为 wpf_gfx_vXXXX.dll 的不同 DLL 中，其中 vXXXX 是版本号。在 .NET 4.0 中，它是 wpf_gfx_v0400.dll。
> 
> 好处是 WPF 可以在每个新版本中添加新的渲染功能，而无需更新 Windows 本身。缺点是 WPF 的渲染不再像 Vista 发布时那样与 Windows 紧密集成。结果是，正如你所见，放大不再像以前那么有趣了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T16:09:45.200

Vista中的放大镜并不是特别聪明。它只会炸毁屏幕上已经光栅化的图像。要查看文本框实际上是基于矢量的，请尝试[调整 DPI 设置](http://www.lawfirmsoftware.com/support/change_dpi_settings_vista.htm)。

**编辑：**从评论看来，Vista 中的放大镜毕竟应该进行矢量缩放。这台计算机（Vista 32 位）上肯定没有，所以我可能遇到了同样的问题。DPI 缩放工作，但...

# c# - 无法动态向页面添加控件

> ID：710396
> 
> 赞同：2
> 
> 时间：2009-04-02T16:02:47.103
> 
> 标签：c#, asp.net, user-controls

我正在为数据阅读器中提取的每条记录添加一个用户控件，这是基本循环：

```
while (dr.Read())
{
     ImageSelect imgSel = new ImageSelect(dr["Name"].ToString());
     myPanel.Controls.Add(imgSel);
} 
```

问题是页面中没有添加任何控件，我检查了 html 输出并且有我的面板，其中没有任何内容。

我什至在调试器中单步执行了代码，并验证了 myPanel.Controls 在每个循环中添加了一个控件，计数为 6，没有错误，但随后它们不会显示在页面上。

我在 Page_Init 和 Page_Load 事件中运行了上面的代码，两者的结果相同。

**编辑：** 好的，所以我已经切换到使用 LoadControl("..ascx") 来获取我的控件实例，该实例现在正在工作。但最初我也通过控件构造函数传递数据。这仍然可能还是我只需要通过 get/sets 设置它们？

**编辑 2：** 感谢 Freddy 指出 LoadControl 有一个重载，您可以在其中传递构造函数参数，请参阅接受的答案。

**编辑 3：** 在有和没有构造函数的情况下尝试此方法后。我发现只对我希望控件具有的任何属性使用设置器而不是尝试为我的构造函数使用传入的对象数组更好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T16:07:04.533

**更新：**正如史蒂夫指出的那样，使用该类型的 LoadControl 的重载不会考虑 ascx 中的控件。这个答案中也提到了这一点：[Dynamically Loading a UserControl with LoadControl Method (Type, object[])](https://stackoverflow.com/questions/450431/dynamically-loading-a-usercontrol-with-loadcontrol-method-type-object/450449#450449)。

正如我之前提到的，get/set 更符合 asp.net 模型，因此我建议将其与接收用户控制路径的 LoadControl 变体一起使用。也就是说，史蒂夫的版本是一个有趣的选择：[http](http://www.grumpydev.com/2009/01/05/passing-parameters-using-loadcontrol/) ://www.grumpydev.com/2009/01/05/passing-parameters-using-loadcontrol/ 。

我的看法是带类型的 LoadControl 旨在与 Web 自定义控件一起使用。

* * *

如果它是一个用户控件，您应该使用 LoadControl(usercontrolpath) 来获取用户控件的实例。

您可以通过执行以下操作来使用构造函数：

```
var name = dr["Name"].ToString();
var imgSel = LoadControl(typeof(ImageSelect), new object[]{ name });
myPanel.Controls.Add(imgSel); 
```

请注意，根据您使用的项目模型，您需要添加对 aspx 的引用以将其与 typeof 变体一起使用：

```
<%@ Reference Control="~/somepath/myusercontrol.ascx" %> 
```

附言。我通常使用 set/get 进行控件，因为我发现它们更符合 asp.net 模型

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T16:10:42.997

要添加用户控件，您必须调用传递到 .ascx 文件的路径的 LoadControl 方法。您不能仅通过实例化 .ascx 文件继承的对象来创建它们。

UserControl 由后面代码中的标记和类组成。标记包含指向后面类的链接，但后面的类不知道标记所在的位置，因此不能自行创建。

# security - Apache：如何将虚拟目录限制为本地网络

> ID：710402
> 
> 赞同：4
> 
> 时间：2009-04-02T16:03:47.413
> 
> 标签：security, apache, access-control, apache-config, lan

在家里的 Apache 2.x 服务器上，我有许多虚拟目录。我已经设置了我的路由器，以便我可以从 Internet 访问 Apache。我需要防止这些虚拟目录（/私有）之一在我的家庭网络 LAN 之外被访问。所以给定 /private，我如何配置 Apache 只为来自 192.168.4.x 的 /private 提供请求？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-02T16:10:11.437

```
<Directory /users/me/private>
    Order deny,allow
    Allow from 192.168.4
    Deny from all
</Directory> 
```

# c# - 如何处理一个字段的多个输入实例

> ID：710404
> 
> 赞同：0
> 
> 时间：2009-04-02T16:03:52.607
> 
> 标签：c#, winforms

我想在用户在 Windows 窗体中的 TextBox 中输入的每个信息之后在多行文本框中添加一行。我将无法确定画线的点，因为我不知道用户将输入信息多长时间。所以我正在考虑在代码中单击按钮后添加一个字符串“_______”。有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T17:09:53.090

如果需要用户单击按钮来确认单个条目，那么我认为您不应该继续将信息存储在同一个文本框中并用一堆破折号提供视觉分隔，而是移动文本从输入输入到更格式化的显示（一组控件）。然后显示将与输入分离。您可以允许用户在显示中选择单个输入来修改条目，从而提供良好的用户体验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T16:26:54.393

您可能会考虑编写自定义控件。

您可以自己绘制控件，也可以使用自动调整大小的标签和控件的滑动条。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T16:20:05.657

如果您打算使用常规的多行文本框，最好打印一行“-”字符。当然，您可以打印一行“─”字符以使该行成为实线。另一种选择是使用[WebBrowser](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)控件，并将其[DocumentText](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.documenttext.aspx)属性设置为您想要显示的 HTML。这将允许您`<hr/>`在需要分割线时追加。

# iis - MSI 升级期间的潜在停机时间

> ID：710408
> 
> 赞同：0
> 
> 时间：2009-04-02T16:04:24.243
> 
> 标签：iis, deployment, windows-installer

我正在考虑使用用 WiX 构建的 MSI 将网站部署到 Win2k3/IIS6 机器。

相关网站包含 .html、.jpg、.js、.swf 和 .asp 文件（无 ASP.NET）

在安装 MSI 时，我正在执行“重大升级”（即，它首先卸载旧的 MSI，然后安装新的 MSI）。这是我能想到让 MSI 删除冗余文件的唯一方法。

我的问题是；在卸载/重新安装过程中，网站访问者是否会有停机时间？

或者 IIS 是否缓存当前打开的连接正在使用的文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T17:23:30.123

不，你肯定会停电。它不会缓存该信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T03:14:52.197

如果您担心停机时间，您应该考虑负载平衡和冗余网络服务器。

# version-control - 有什么办法可以做一个本地 CVS 代理/服务器？

> ID：710409
> 
> 赞同：0
> 
> 时间：2009-04-02T16:05:08.313
> 
> 标签：version-control, cvs

我有一个需要将代码签入的在线 CVS 存储库。但是，服务器不在我的控制范围内，而且经常停机。

那么，有没有办法设置某种本地 CVS 服务器/代理，以便我可以定期将我的代码检查到本地 CVS 服务器中，并让本地 CVS 服务器定期批量提交对在线 CVS 存储库的更改？

如果有必要防止与 CVS 发生冲突，本地存储库可能会运行其他一些 SCM 系统。在线提交可以手动完成，也可以通过 cron 完成。我愿意接受建议。

我想我主要关心的是在尝试建立某种存储库“层次结构”时面临的问题。

PS：我一直在“层次结构”上运行 Linux。

**编辑：**[在这里](https://stackoverflow.com/questions/584522/how-to-export-revision-history-from-mercurial-or-git-to-cvs/584567)找到一个类似的项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T16:11:30.110

我建议您在本地运行 git，同时在您连接到它时继续使用您的 CVS 服务器。这是一篇写得很好的文章，解释了如何：

[http://www.kernel.org/pub/software/scm/git/docs/v1.4.4.4/cvs-migration.html](http://www.kernel.org/pub/software/scm/git/docs/v1.4.4.4/cvs-migration.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T16:26:02.477

在本地使用 git，然后 git-cvsexportcommit 将是我的建议。[在http://issaris.blogspot.com/2005/11/cvs-to-git-and-back.html](http://issaris.blogspot.com/2005/11/cvs-to-git-and-back.html)有一篇博客文章讨论了这个问题，尽管我会第一个承认导出过程不是尽可能容易使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-24T15:36:06.707

您可以使用 git 作为 CVS 的“前端”，这将允许您在本地（离线）签入您的更改，然后在您的连接可用时将它们同步到 CVS 服务器。设置环境有一些任务，但是一旦你开始工作，工作流程就会非常好。

请参阅[如何将修订历史从 mercurial 或 git 导出到 cvs？](https://stackoverflow.com/questions/584522/how-to-export-revision-history-from-mercurial-or-git-to-cvs/586225)用于设置和工作流程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T16:09:21.207

这并不能真正回答问题，但听起来您需要一个[分布式](http://en.wikipedia.org/wiki/Distributed_revision_control) [VCS 系统](http://en.wikipedia.org/wiki/List_of_revision_control_software#Distributed_model)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T16:09:46.323

我认为您应该考虑使用支持这种分散式源代码控制的分布式源代码管理系统，例如[git](http://git-scm.com/ "混帐")或[mercurial 。](http://www.selenic.com/mercurial/wiki/ "善变的")

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T16:20:04.940

我从未使用过它，但[CVSup](http://www.cvsup.org/)可能会满足您的需求。不过，正如其他人所提到的，像[git](http://git-scm.com/)或[mercurial](http://www.selenic.com/mercurial/wiki/)这样的分布式 VCS 系统可能会更好。

# language-agnostic - 什么是影子记忆？

> ID：710428
> 
> 赞同：1
> 
> 时间：2009-04-02T16:10:57.503
> 
> 标签：language-agnostic

什么是影子记忆？SO能否简要说明内存分析工具如何使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T16:16:51.203

您的意思是通用术语：[http ://en.wikipedia.org/wiki/Shadow_memory](http://en.wikipedia.org/wiki/Shadow_memory)

或在 PC 中使用的特定功能，即众所周知的“影子 RAM”：[http ://en.wikipedia.org/wiki/RAM#Shadow_RAM](http://en.wikipedia.org/wiki/RAM#Shadow_RAM)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T16:17:53.510

影子内存是与 ROM 位于同一地址的 RAM。使用它是因为它更快，也因为它可以修改（例如设置断点）。

# c++ - Visual C++ 中的“没有适当的默认构造函数可用”错误

> ID：710432
> 
> 赞同：15
> 
> 时间：2009-04-02T16:12:13.040
> 
> 标签：c++, constructor

我不明白。我一直盯着代码三个小时，我看不出问题。

我正在创建的名为 TwoDayPackage 的类派生自一个名为 Package 的类。

这就是我定义构造函数的方式：

```
 TwoDayPackage(string, string, string, string, int, string, string, string, string, int, float, float, float); 
```

这就是我实现构造函数的方式：

```
TwoDayPackage::TwoDayPackage(string sName, string sAddress, string sState, string sCountry, int sZIP, string rName, string rAddress, string rState, string rCountry, int rZIP, float weight, float cost, float flat)
{
Package::Package(sName, sAddress, sState, sCountry, sZIP, rName, rAddress, rState, rCountry, rZIP, weight, cost);
flatRate = flat;
} 
```

这就是我在主要功能中使用它的方式。

```
TwoDayPackage pack2(senderName, senderAddress, senderState, senderCountry, senderZIP, receipientName, receipientAddress, receipientState, receipientCountry, receipientZIP, weight, cost, flat); 
```

我知道我的论点列表很长，这是有原因的。谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-02T16:16:04.497

应该使用：

```
TwoDayPackage::TwoDayPackage(string sName, string sAddress, string sState, string  sCountry, int sZIP, string rName, string rAddress, string rState, string rCountry, int rZIP, float weight, float cost, float flat)
 :Package(sName, sAddress, sState, sCountry, sZIP, rName, rAddress, rState, rCountry, rZIP, weight, cost)
  {
    flatRate = flat;
   } 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-02T16:42:34.137

默认 ctor 是可以不带参数调用的。至少使用此代码，您没有：默认 ctor 要么具有签名

```
ClassName::ClassName(); 
```

或者每个参数都必须有一个默认值。

也就是说，Dirk 关于语法的观点是正确的。如果你想调用父类ctor，你应该在冒号之后进行。

* * *

@dirkgently 的答案显示了正确的语法，但让我们稍微扩展一下。你有两个班

```
public class Package {
    // ...
    Package( /* that horrible ctor arg list */){/*...*/}
    // ...
}

public class TwoDayPackage : public Package {
    // ...
    TwoDayPackage(/* another horrible ctor */);  // declaration only
    // ...
} 
```

然后你来定义它

```
TwoDayPackage::TwoDayPackage(string sName, string sAddress, 
                             string sState, string sCountry, 
                             int sZIP, string rName, 
                             string rAddress, string rState, 
                             string rCountry, int rZIP, 
                             float weight, float cost, float flat)
{

     Package::Package(sName, sAddress, sState, sCountry, sZIP, 
                      rName, rAddress, rState, rCountry, rZIP, 
                      weight, cost);
     flatRate = flat;
} 
```

......但这不起作用？为什么？基本上，因为您告诉 C++ 的内容没有意义：`Package::Package`只是命名超类的 ctor 而对它不做任何事情。*您可以使用new*运算符创建类 Package 的新对象，

```
 Package foo = new
         Package::Package(sName, sAddress, sState, sCountry, sZIP, 
                          rName, rAddress, rState, rCountry, rZIP, 
                          weight, cost); 
```

但这仍然不是您想要做的；您*想要*的是告诉 C++ 使用该 arg 列表构造 TwoDayPackage 的 Package 部分。您不需要具有完全限定的名称，因为编译器已经知道父类是什么。

您也可以只在子 ctor 中分​​配值，但这效率低下，因为它使编译器为“多次前往井”生成代码。所以 C++ 有一个特殊的语法，初始化器放在冒号之后，正如 Dirk 所示。

还有一件事：既然你只是给 flat 分配了一个参数，你可以说

```
TwoDayPackage::TwoDayPackage(string sName, string sAddress, 
                             string sState, string sCountry, 
                             int sZIP, string rName, 
                             string rAddress, string rState, 
                             string rCountry, int rZIP, 
                             float weight, float cost, float flat) :
    Package(sName, sAddress, sState, sCountry, sZIP, 
            rName, rAddress, rState, rCountry, rZIP, weight, cost),
    flatRate(flat) 
{
} 
```

查看C++ FAQ Lite 的[这一部分了解更多信息。](http://www.parashift.com/c++-faq-lite/ctors.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-02T16:42:00.723

答案是[dirkgently](https://stackoverflow.com/questions/710432/no-appropriate-default-constructor-available-error-in-visual-c/710447#710447)。解释是 C++ 中的初始化序列。

构造类时，首先构造所有基类。如果您在初始化列表中提供对构造函数的调用，那么它将调用适当的构造函数。如果基类没有出现在初始化列表中，那么它将被默认构造。所有这些都发生*在*进入构造函数块（花括号）之前。

# c# - while-header 中的 Linq 问题

> ID：710433
> 
> 赞同：0
> 
> 时间：2009-04-02T16:12:22.370
> 
> 标签：c#, linq

我正在尝试在我的项目中找到下一个可用的 Groupname。我希望组名看起来像“Gruppe 1”、“Gruppe 2”等等。所以这就是我到目前为止得到的：

```
int i = 0;
while ((from GroupViewModel g in _groups
        where g.GroupName == ("Gruppe " + (++i).ToString())
        select g).Any());
Group group = new Group() { Name = string.Format("Gruppe {0}", i) };
_groups.Add(new GroupViewModel(group)); 
```

我认为这对我的问题来说是一个很酷的解决方案，但是我开始测试代码。
如果`_groups`为空，则第一组为“Gruppe 0”。
如果`_groups`包含 1 个组（名为“Gruppe 1”），则生成的组名是“Gruppe 2”。
如果`_groups`包含 1 个组（名为“Gruppe 2”），则生成的组名为“Gruppe 1”，但如果我添加另一个组，则生成的名称也是“Gruppe 2”。我做了很多测试用例，结果总是很奇怪。

```
initial Groupnames             | Resulting names
-empty-                        | "Gruppe 0", "Gruppe 1", "Gruppe 2", ...
"Gruppe 1"                     | "Gruppe 2", "Gruppe 3", "Gruppe 4", ...
"Gruppe 2"                     | "Gruppe 1", "Gruppe 2", "Gruppe 3", ...
"Gruppe 1", "Gruppe 2"         | "Gruppe 3", "Gruppe 4", "Gruppe 5", ...
"Gruppe 1", "Gruppe 3"         | "Gruppe 5", "Gruppe 6", "Gruppe 7", ...
"Gruppe 1", "Gruppe 4"         | "Gruppe 3", "Gruppe 4", "Gruppe 5", ...
"Gruppe 2", "Gruppe 1"         | "Gruppe 2", "Gruppe 3", "Gruppe 4", ... 
```

那么，有什么线索吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T16:21:25.047

好吧，*每个*`i++`条目都被调用，无论它是否匹配。

 *我建议按组名创建一个查找，然后只使用循环来提取结果。但是，我真的不清楚你首先想要什么。您是否只是想找到第一个“可用”组 ID 并`GroupViewModel`为其添加一个新 ID？如果是这样，我会做类似的事情：

```
var lookup = _groups.ToLookup(group => group.GroupName);

for (int i=0; i < int.MaxValue; i++)
{
    string candidateName = "Gruppe " + i;
    if (!lookup.Contains(candidateName)
    {
        Group group = new Group { Name = candidateName };
        _groups.Add(new GroupViewModel(group));
        break;
    }
} 
```

# excel - 如何将单元格的内容复制到剪贴板

> ID：710435
> 
> 赞同：2
> 
> 时间：2009-04-02T16:12:34.723
> 
> 标签：excel, vba

我正在尝试将单元格内容复制到剪贴板中。

我已经阅读并尝试了 Excel 2007 帮助文件中提供的确切示例。但是由于某种原因，DataObject 对象无效。所以这个例子：

```
Dim MyData As DataObject

Private Sub CommandButton1_Click()
    Set MyData = New DataObject

    MyData.SetText TextBox1.Text
    MyData.PutInClipboard

    TextBox2.Paste
End Sub

Private Sub UserForm_Initialize()
    TextBox1.Text = "Move this data to a " _
        & "DataObject, to the Clipboard, then to " _
        & "TextBox2!"
End Sub 
```

在我的情况下不起作用。我已经搜索了很长时间，但找不到 DataObject 对象不可用的答案。

这是我的代码：

```
Dim MyData As DataObject

Private Sub Worksheet_Change(ByVal Target As Range)
    If ActiveCell.Column = 3 Then
        Set MyData = New DataObject
        MyData.SetText ActiveCell.Offset(-1, -1).Text
        MyData.PutInclipboard
    End If    
End Sub 
```

编译错误是：“未定义用户定义类型”，它突出显示“MyData As DataObject”行。

**是否有另一种方法可以简单地将单元格中的文本复制到剪贴板？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T17:34:20.643

好的，有几件事：

首先您需要添加对“Microsoft Forms 2.0 Object Library”的引用，如果您不想搜索，只需将用户表单添加到项目中然后立即将其删除，引用将保留。您需要该引用才能使用 DataObject

我将附上一些我必须工作的代码，我更改了偏移量，但可以根据需要制作它们......

```
Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)
Set MyData = New DataObject
    If ActiveCell.Column = 3 Then
        MyData.SetText ActiveCell.Offset(-1, 0).Text
        MyData.PutInClipboard
    End If
End Sub 
```

# sql-server - 当我使用可变参数而不是常量参数时，为什么我的内联表 UDF 慢得多？

> ID：710439
> 
> 赞同：3
> 
> 时间：2009-04-02T16:13:57.747
> 
> 标签：sql-server, performance, sql-server-2008, user-defined-functions

我有一个表值的内联 UDF。我想过滤该 UDF 的结果以获得一个特定的值。当我使用常量参数指定过滤器时，一切都很好，性能几乎是瞬时的。当我使用可变参数指定过滤器时，它需要大量的时间，逻辑读取量增加 500 倍，持续时间增加 20 倍。

执行计划表明，在可变参数情况下，直到过程的很晚才应用过滤器，导致多次索引扫描，而不是在常量情况下执行的查找。

我想我的问题是：为什么，因为我指定了一个对索引字段具有高度选择性的单个过滤器参数，当该参数在变量中时，我的性能会变得杂草吗？对此我能做些什么吗？

它与查询中的分析功能有关吗？

这是我的查询：

```
CREATE FUNCTION fn_test()
RETURNS TABLE
WITH SCHEMABINDING
AS
    RETURN
    SELECT DISTINCT GCN_SEQNO, Drug_package_version_ID
    FROM
    (
        SELECT COALESCE(ndctbla.GCN_SEQNO, ndctblb.GCN_SEQNO) AS GCN_SEQNO,
            dpv.Drug_package_version_ID, ROW_NUMBER() OVER (PARTITION BY dpv.Drug_package_version_id ORDER BY 
                ndctbla.GCN_SEQNO DESC) AS Predicate
        FROM dbo.Drug_Package_Version dpv
            LEFT JOIN dbo.NDC ndctbla ON ndctbla.NDC = dpv.Sp_package_code
            LEFT JOIN dbo.NDC ndctblb ON ndctblb.SPC_NDC = dpv.Sp_package_code
    ) iq
    WHERE Predicate = 1
GO

GRANT SELECT ON fn_test TO public
GO

-- very fast
SELECT GCN_SEQNO
FROM dbo.fn_test()
WHERE Drug_package_version_id = 10000

GO

-- comparatively slow
DECLARE @dpvid int
SET @dpvid = 10000
SELECT GCN_SEQNO
FROM dbo.fn_test()
WHERE Drug_package_version_id = @dpvid 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T16:18:30.293

通过 UDF 创建新投影后，不能期望您的索引仍将应用于在原始表上编制索引并包含在投影中的列。当您过滤投影（而不是在 UDF 中针对具有索引的原始表）时，索引不再适用。

你想要做的是参数化函数以接受参数。

如果您发现要设置参数的字段太多，那么您可能需要查看索引视图，因为您可以创建投影并对其进行索引，然后对其运行查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T20:04:28.517

简单地说，常数很容易在计划中评估。局部变量不是。尤其是排序功能和过滤器`Predicate = 1`

解释 casparOne，您需要将过滤器尽可能向内推，以便`dpv.Drug_package_version_id`在 iq 派生表内部进行过滤。

如果你这样做，那么你也不需要 ，`PARTITION BY`因为你只有一个`dpv.Drug_package_version_id`. 然后你可以做一个清洁工`...TOP 1 ... ORDER BY ndctbla.GCN_SEQNO DESC`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T15:05:31.160

我得到的回答很好，我也从中学习，但我想我找到了一个让我满意的答案。

我确实认为是使用 PARTITION BY 子句导致了这里的问题。我使用自连接习语的变体重新表述了 UDF：

```
SELECT t1.A, t1.B, t1.C
FROM T t1
    INNER JOIN
    (
        SELECT A, MAX(C) AS C
        FROM T
        GROUP BY A
    ) t2 ON t1.A = t2.A AND t1.C = t2.C 
```

具有讽刺意味的是，这比使用特定于 SQL 2008 的查询的性能更高，而且优化器在使用变量而不是常量连接这个版本的查询时没有问题。在这一点上，我的结论是优化器只是不处理较新的 SQL 扩展以及较旧的东西。作为奖励，我现在可以在预升级的 SQL 2000 平台中使用 UDF。

谢谢大家的帮助！

# css - 如何摆脱 Visual Studio 中的未知属性名称错误？

> ID：710440
> 
> 赞同：2
> 
> 时间：2009-04-02T16:14:06.763
> 
> 标签：css, visual-studio

使用 jQuery UI 和 ThemeRoller 时，创建的 CSS 文件包含几个 Visual Studio 不知道的 CSS 属性，例如`zoom`和`opacity`. 当 CSS 文件在编辑器窗格中打开时，如何防止这些在错误列表中显示为错误？

本着 SO 的精神，我将添加我找到的解决方案作为回应。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T16:15:05.467

转到工具 --> 选项 --> 文本编辑器 --> CSS --> CSS 特定（或验证）并取消选中该`Detect unknown properties`复选框。

# algorithm - 扫描算法

> ID：710446
> 
> 赞同：0
> 
> 时间：2009-04-02T16:15:56.650
> 
> 标签：algorithm, geometry

谁能给我推荐一个对双数据有很好结果的扫描算法？一些文档，方法，任何东西。

这是一种扫描算法，用于检测二维空间中图形的交点。图表总是关闭的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T16:58:02.477

[http://www.amazon.com/Computational-Geometry-Algorithms-Applications-Second/dp/3540656200](https://rads.stackoverflow.com/amzn/click/com/3540656200)中的那个非常好。

不过，测试交叉点的扫描线非常简单。这是一篇让您入门的论文：[http](http://www.cs.umd.edu/~mount/Papers/crc-intersect.pdf) ://www.cs.umd.edu/~mount/Papers/crc-intersect.pdf 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T17:14:51.937

到目前为止，我已经为扫描算法实现了 3 个变体，用于检测平面闭合图的交集。我有代表图形的大数据（比如 200 条或更多边。顶点是 2D 中的点对，边是一对两个顶点 - 一个是源，另一个是目标），它是从另一个实现的函数中读取的用于其他目的的 C++ 库。

问题是这 3 个实现在整数或双精度数据上工作得很好，但是当我尝试这 3 个实现中的任何一个时，我每次都得到不同的结果，甚至不是好的结果。

*   我是否有我想要的所有交叉点，但图表中的其他一些点（不是交叉点）

*   我是否有图表中的一些点作为结果，但计算结果中缺少一些我需要的交叉点

*   我是否只有需要的十字路口

这一切都取决于我看到的排序功能，也可能取决于其他东西，但我无法弄清楚。sort 函数按如下方式对图的边进行排序：

给定两条边为`E1(Vstart,Vend), E2(Vstart,Vend)`：

```
x.E1.Vstart<x.E2.Vstart or
x.E1.Vstart==x.E2.Vstart and y.E1.Vstart<y.E2.Vstart or 
x.E1.Vstart==x.E2.Vstart and y.E1.Vstart==y.E2.Vstart and slope(E1)<slope(E2) 
```

我认为这种排序功能适用于单调性和其他情况，但显然它仅适用于某些情况，除了常规交叉点之外，它还检测到其他一些交叉点；在某些情况下，它确实有效，因为它不会计算所有交点，而只是计算图中的某个点。

# reflection - 使用 Powershell 进行反射

> ID：710448
> 
> 赞同：5
> 
> 时间：2009-04-02T16:16:39.800
> 
> 标签：reflection, powershell, assemblies

我有一组 .NET 程序集（都在同一个目录下），其中一些包含实现抽象类的类。我想要一个 Powershell 脚本来查找所有实现我的抽象类的类，并在每个类上执行一个方法。

有人知道如何做到这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-18T14:21:47.790

Here's a little function you might want to try.. (I haven't tested it yet, as I don't have any criteria to test this with easily..)

It can be used by supplying the paths (one or more full or relative paths separated by commas) on the command line like this

```
CheckForAbstractClassInheritance -Abstract System.Object -Assembly c:\assemblies\assemblytotest.dll, assemblytotest2.dll 
```

or from the pipeline

```
'c:\assemblies\assemblytotest.dll','assemblytotest2.dll' | CheckForAbstractClassInheritance -Abstract System.Object 
```

or with fileinfo objects from Get-Childitem (dir)

```
dir c:\assemblies *.dll | CheckForAbstractClassInheritance -Abstract System.Object 
```

Tweak as needed..

```
function CheckForAbstractClassInheritance()
{
    param ([string]$AbstractClassName, [string[]]$AssemblyPath = $null)
    BEGIN
    {
        if ($AssemblyPath -ne $null)
        {
            $AssemblyPath | Load-AssemblyForReflection
        }
    }
    PROCESS
    {
        if ($_ -ne $null)
        {
            if ($_ -is [FileInfo])
            {
                $path = $_.fullname
            }
            else
            {
                $path = (resolve-path $_).path
            }
            $types = ([system.reflection.assembly]::ReflectionOnlyLoadFrom($path)).GetTypes()
            foreach ($type in $types)
            {
                if ($type.IsSubClassOf($AbstractClassName))
                {
                    #If the type is a subclass of the requested type, 
                    #write it to the pipeline
                    $type
                }
            }

        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T18:31:59.943

与使用 c# 的方法相同，但使用 PowerShell 语法。
看看[Assembly.GetTypes](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.gettypes.aspx)和[Type.IsSubclassOf](http://msdn.microsoft.com/en-us/library/system.type.issubclassof.aspx)。

# vb.net - 访问 .Net 中的自定义配置部分

> ID：710449
> 
> 赞同：7
> 
> 时间：2009-04-02T16:16:46.400
> 
> 标签：vb.net, configuration

我正在尝试访问我的配置文件中的设置，这是一系列 xml 元素，如下所示：

```
<databases>
<database name="DatabaseOne" Value="[value]" />
<database name="DatabaseTwo" Value="[value]" />
</databases> 
```

现在我想访问它。我已经设置了这样的课程：

```
Public Class DatabaseConfigurationHandler
    Inherits ConfigurationSection

    <ConfigurationProperty("Databases", IsDefaultCollection:=True)> _
   Public ReadOnly Property Databases() As DatabaseCollection
        Get
            Return CType(Me("Databases"), DatabaseCollection)
        End Get
    End Property
End Class

Public Class DatabaseCollection
    Inherits ConfigurationElementCollection

    Protected Overloads Overrides Function CreateNewElement() As ConfigurationElement
        Return (New Database())
    End Function

    Protected Overloads Overrides Function GetElementKey(ByVal element As ConfigurationElement) As Object
        Return (CType(element, Database).DatabaseName)
    End Function

End Class

Public Class Database
    Inherits ConfigurationElement

    <ConfigurationProperty("name", IsKey:=True, IsRequired:=True)> _
       Public Property DatabaseName() As String
        Get
            Return Me("name").ToString()
        End Get
        Set(ByVal Value As String)
            Me("name") = Value
        End Set
    End Property

    <ConfigurationProperty("value", IsRequired:=True)> _
Public Property DatabaseValue() As String
        Get
            Return Me("value").ToString()
        End Get
        Set(ByVal Value As String)
            Me("value") = Value
        End Set
    End Property

End Class 
```

我希望能够通过它的名称获取元素并返回值，但我看不到这样做：

```
Dim config As New DatabaseConfigurationHandler
                config = System.Configuration.ConfigurationManager.GetSection("databases/database")
                Return config.Databases("DatabaseOne") 
```

我错过了一些代码，我做错了什么？以上还有其他错误吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T16:21:01.927

没有任何充分的理由来手工设计这种东西了。相反，您应该在 CodePlex 上使用配置部分设计器：

[http://csd.codeplex.com/](http://csd.codeplex.com/)

安装后，您只需将一个新项目添加到您的项目（配置部分设计器），然后添加元素和约束。我发现它非常易于使用，而且我可能再也不会为配置文件编写一段代码了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-02T16:24:49.873

这是我几天前做的非常相似的事情的剪切和粘贴。

配置：

```
 <ListConfigurations>
    <lists>
      <add Name="blah" EndpointConfigurationName="blah" ListName="blah" ConnectionString="blah" TableName="blah" FieldsCsv="blah" DbFieldsCsv="blah"/>
      <add Name="blah2" EndpointConfigurationName="blah" ListName="blah" ConnectionString="blah" TableName="blah" FieldsCsv="blah" DbFieldsCsv="blah"/>
    </lists>
  </ListConfigurations> 
```

配置部分 C#：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Configuration;

namespace App
{
    /// <summary>
    /// Individual list configuration
    /// </summary>
    class ListConfiguration : ConfigurationElement
    {
        [ConfigurationProperty("Name", IsKey = true, IsRequired = true)]
        public string Name
        {
            get { return (string)this["Name"]; }
        }

        [ConfigurationProperty("EndpointConfigurationName", IsRequired = true)]
        public string EndpointConfigurationName
        {
            get { return (string)this["EndpointConfigurationName"]; }
        }

        [ConfigurationProperty("ListName", IsRequired = true)]
        public string ListName
        {
            get { return (string)this["ListName"]; }
        }

        [ConfigurationProperty("ConnectionString", IsRequired = true)]
        public string ConnectionString
        {
            get { return (string)this["ConnectionString"]; }
        }

        [ConfigurationProperty("TableName", IsRequired = true)]
        public string TableName
        {
            get { return (string)this["TableName"]; }
        }

        [ConfigurationProperty("FieldsCsv", IsRequired = true)]
        public string FieldsCsv
        {
            get { return (string)this["FieldsCsv"]; }
        }

        [ConfigurationProperty("DbFieldsCsv", IsRequired = true)]
        public string DbFieldsCsv
        {
            get { return (string)this["DbFieldsCsv"]; }
        }
    }

    /// <summary>
    /// Collection of list configs
    /// </summary>
    class ListConfigurationCollection : ConfigurationElementCollection
    {
        protected override ConfigurationElement CreateNewElement()
        {
            return new ListConfiguration();
        }

        protected override object GetElementKey(ConfigurationElement element)
        {
            return ((ListConfiguration)element).Name;
        }
    }

    /// <summary>
    /// Config section
    /// </summary>
    class ListConfigurationSection : ConfigurationSection
    {
        [ConfigurationProperty("lists")]
        public ListConfigurationCollection Lists
        {
            get { return (ListConfigurationCollection)this["lists"]; }
        }
    }
} 
```

以及从主应用程序中获取它的代码：

```
ListConfigurationSection configSection = null;
try
{
    configSection = ConfigurationManager.GetSection("ListConfigurations") as ListConfigurationSection;
}
catch (System.Configuration.ConfigurationErrorsException)
{
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T16:26:49.777

您可以改用此配置处理程序。它适用于所有自定义配置部分

```
 public class XmlConfigurator : IConfigurationSectionHandler
    {
        public object Create(object parent, 
                   object configContext, XmlNode section)
        {
            if (section == null) 
                throw new ArgumentNullException("section",
                    "Invalid or missing configuration section " + 
                    "provided to XmlConfigurator");
            XPathNavigator xNav = section.CreateNavigator();
            if (xNav == null) 
                throw new ApplicationException(
                    "Unable to create XPath Navigator"); 
            Type sectionType = Type.GetType((string)
                (xNav).Evaluate("string(@configType)"));
            XmlSerializer xs = new XmlSerializer(sectionType);
            return xs.Deserialize(new XmlNodeReader(section));
        }
    } 
```

然后，您的配置文件必须包含对表示根元素的类型的引用

```
<ConnectionConfig 
   configType="MyNamespace.ConnectionConfig, MyNamespace.AssmblyName" > 
```

示例配置文件可能如下所示：

```
<?xml version="1.0" encoding="utf-8" ?>

<ConnectionConfig 
   configType="MyNamespace.ConnectionConfig, MyNamespace.AssmblyName" >

  <ConnCompanys>
    <ConnCompany companyName="CompanyNameHere">
      <ConnApps>
        <ConnApp applicationName="Athena" vendorName="Oracle" >
          <ConnSpecs>
            <ConnSpec environments="DEV"
              serverName="Athena"
              port="1521"
              catalog="DatabaseName"
              logon="MyUserName"
              password="%%552355%8234^kNfllceHGp55X5g==" />
     <!--  etc... 
```

您需要定义每个 xml 元素映射到的类...使用适当的 XmlSerialization 属性...

```
[XmlRoot("ConnectionConfig")]
public class ConnectionConfig
{
    private ConnCompanys comps;

    [XmlArrayItem(ElementName = "ConnCompany")]
    public ConnCompanys ConnCompanys
    {
        get { return comps; }
        set { comps = value; }
    }
    public ConnApp this[string CompanyName, string AppName]
    { get { return ConnCompanys[CompanyName][AppName]; } }

    public ConnSpec this[string CompanyName, string AppName, APPENV env]
    {
        get
        {
            return ConnCompanys[CompanyName][AppName, env];
        }
    }
}

public class ConnCompanys : List<ConnCompany>
{
    public ConnCompany this[string companyName]
    {
        get
        {
            foreach (ConnCompany comp in this)
                if (comp.CompanyName == companyName)
                    return comp;
            return null;
        }
    }
    public bool Contains(string companyName)
    {
        foreach (ConnCompany comp in this)
            if (comp.CompanyName == companyName)
                return true;
        return false;
    }
}

public class ConnCompany
{
    #region private state fields
    private string compNm;
    private ConnApps apps;
    #endregion private state fields

    #region public properties
    [XmlAttribute(DataType = "string", AttributeName = "companyName")]
    public string CompanyName
    {
        get { return compNm; }
        set { compNm = value; }
    }

    [XmlArrayItem(ElementName = "ConnApp")]
    public ConnApps ConnApps
    {
        get { return apps; }
        set { apps = value; }
    }
    #endregion public properties

    #region indexers
    public ConnApp this[string applicationName]
    { get { return ConnApps[applicationName]; } }
    public ConnSpec this[string applicationName, APPENV environment]
    {
        get
        {
            foreach (ConnSpec con in this[applicationName].ConnSpecs)
                if (con.Environment == environment)
                    return con;
            return null;
        }
    }
    #endregion indexers
} 
```

ETC...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T16:27:29.400

我的 VB 不太抱歉，但这是你在 C# 中的做法。

C＃

```
public class AppState : IConfigurationSectionHandler
{
    static AppState()
    {
        xmlNode myConfigNode = (XmlNode)ConfigurationManager.GetSection("databases");
    }

    public object Create(object parent, object context, XmlNode configSection) {
        return configSection;
    }
} 
```

应用程序配置

```
<configuration>
  <configSections>
    <section name="databases" type="MyAssembly.AppState, MyAssembly" />
  </configSections>
  <databases>
    <database name="DatabaseOne" Value="[value]" />
    <database name="DatabaseTwo" Value="[value]" />
  </databases>
</configuration> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-28T19:46:30.620

You might be interested in using a ConfigurationElementCollection where T is the type of the child ConfigurationElements. You can find sample code in C# at [http://devpinoy.org/blogs/jakelite/archive/2009/01/10/iconfigurationsectionhandler-is-dead-long-live-iconfigurationsectionhandler.aspx](http://devpinoy.org/blogs/jakelite/archive/2009/01/10/iconfigurationsectionhandler-is-dead-long-live-iconfigurationsectionhandler.aspx)

Cheers!

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-29T16:36:59.073

There's a nice simple way of doing this demonstrated here also:

[codeproject.com/KB/XML/xml_config_section.aspx](http://www.codeproject.com/KB/XML/xml_config_section.aspx)

# c# - 方法隐藏如何在 C# 中工作？（第二部分）

> ID：710459
> 
> 赞同：13
> 
> 时间：2009-04-02T16:18:12.010
> 
> 标签：c#, inheritance, compiler-construction, method-hiding

以下程序打印

```
A:C(A,B)
B:C(A,B) 
```

（正如它应该）

```
public interface I
{
    string A();
}

public class C : I
{
    public string A()
    {
        return "A";
    }

    public string B()
    {
        return "B";
    }
}

public class A
{
    public virtual void Print(C c)
    {
        Console.WriteLine("A:C(" + c.A() + "," + c.B() + ")");
    }
}

public class B : A
{
    public new void Print(C c)
    {
        Console.WriteLine("B:C(" + c.A() + "," + c.B() + ")");
    }

    public void Print(I i)
    {
        Console.WriteLine("B:I(" + i.A() + ")");
    }
}

class Program
{
    public static void Main(string[] args)
    {
        A a = new A();
        B b = new B();
        C c = new C();
        a.Print(c);
        b.Print(c);
    }
} 
```

但是，如果我在 B 类中将关键字“new”更改为“override”，如下所示：

```
 public override void Print(C c) 
```

突然程序开始打印：

```
A:C(A,B)
B:I(A) 
```

为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T16:27:04.643

这与如何解决重载方法有关。

实际上（有些简化），在这种情况下，编译器首先查看表达式 (B) 的声明类型，然后查找*首先在该类型中声明*的候选方法。如果有任何合适的方法（即所有参数都可以转换为方法的参数类型），那么它*不会*查看任何父类型。这意味着，如果派生类型中有任何“新声明”的适当方法，则初始声明位于父类型中的重写方法不会查看。

这是一个稍微简单的例子：

```
using System;

class Base
{
    public virtual void Foo(int x)
    {
        Console.WriteLine("Base.Foo(int)");
    }
}

class Derived : Base
{
    public override void Foo(int x)
    {
        Console.WriteLine("Derived.Foo(int)");
    }

    public void Foo(double d)
    {
        Console.WriteLine("Derived.Foo(double)");
    }
}

class Test
{
    static void Main()
    {
        Derived d = new Derived();
        d.Foo(10);
    }
} 
```

这会打印`Derived.Foo(double)`- 即使编译器知道有一个参数为 type 的匹配方法`int`，并且参数是 type `int`，并且从 to 的转换比从 to`int`的`int`转换“更好” ，事实上只有方法最初*是*在表示编译器忽略.`int``double``Foo(double)`*`Derived``Foo(int)`*

 *这是非常令人惊讶的 IMO。我可以理解为什么如果`Derived`不覆盖会出现这种情况`Foo`- 否则在基类中引入一个新的、更具体的方法可能会意外地改变行为 - 但显然这里`Derived`知道*它*`Base.Foo(int)`正在覆盖它。这是我认为 C# 设计者做出错误决定的（相对少数）点之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T16:26:51.927

好的，所以

```
 public new void Print(C c)
    {
        Console.WriteLine("B:C(" + c.A() + "," + c.B() + ")");
    }

    public void Print(I i)
    {
        Console.WriteLine("B:I(" + i.A() + ")");
    } 
```

这为打印声明了一个新方法。现在因为 B 继承自 A，所以您只需调用新方法两次。当您覆盖该方法时，这会在您调用 A 时更改方法签名，但是当您调用 B 签名时，它有自己的方法签名。

我不确定我是否在解释清楚但很好的问题。

使用新的：

A 和 B 获得相同的 Print Method 实现。

使用覆盖：

A 与 B 具有不同的方法签名，因为您没有仅在 A 中更改 B 中的方法签名。

使用新的它基本上忽略了这一点：

```
 public void Print(I i)
    {
        Console.WriteLine("B:I(" + i.A() + ")");
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T16:36:07.193

这是一个很好的问题。
所有答案都可以在这里找到：http: [//msdn.microsoft.com/en-us/library/6fawty39 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/6fawty39(VS.80).aspx)

它的要点是这样的：

> ... C# 编译器将首先尝试使调用与最初在 [派生类] 上声明的 [functionName] 版本兼容。覆盖方法不被视为在类上声明，它们是在基类上声明的方法的新实现。只有当 C# 编译器无法将方法调用匹配到 [派生类] 上的原始方法时，它才会尝试将调用匹配到具有相同名称和兼容参数的重写方法。

因此，因为您在派生类上有一个与参数“c”匹配的新方法 Print(I i)（因为 c 实现了 I），所以该方法优先于“覆盖”方法。

当您将该方法标记为“新”时，它们都被认为是在派生类上实现的，并且 Print(C c) 方法与参数“c”更匹配，因此具有优先权。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T16:37:36.660

这至少是一个关于方法*重载*如何在 C# 中工作的问题。我想你在这里强调了一个有趣的情况......

在第一种情况下（`new`在方法上使用关键字），编译器决定使用`Print`带有 C 类型参数的方法重载，因为它的类型与传递的参数的类型完全相同（即不需要隐式转换），而隐式如果编译器要选择采用 I 类型参数的方法，则需要转换为接口 I `Print`- 换句话说，它选择更“明显”的方法重载。

在第二种情况下（`override`在方法上使用关键字），编译器决定使用`Print`类型 I 参数的重载，因为尽管您`Print(C c)`在 B 类中重写了方法重载，但它实际上是在父类 A 中定义的，使得`Print(I i)`方法重载实际上是最高级别的重载，因此是最直接的重载，即编译器找到的第一个重载。

希望这能帮助你理解。让我知道是否需要进一步澄清任何要点...

注意：如果我说编译器做这些事情是错误的，那么请纠正我，尽管为了争论，无论是编译器还是 CLR/JIT，看起来都没有什么区别。

# asp.net-3.5 - ASP.NET 存储全局变量 - 可从每个页面访问

> ID：710463
> 
> 赞同：3
> 
> 时间：2009-04-02T16:19:23.803
> 
> 标签：asp.net-3.5

我正在构建一个大型应用程序，我通常使用一个简单的会话来存储私有全局信息，但是由于应用程序可能相当大，我相信这可能是一个问题，因为它可能具有大量的内存会话。

有没有更好的方法来存储这些变量？

例如，当用户登录时，我想存储有关该用户的数据并将其显示在需要的地方，而不必每次都查询数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T16:20:18.077

使用 cookie - 无论您的负载平衡环境如何，它们都可以工作

其他选项包括：

1）将您的会话值写入 sql 数据库-您可以配置您的 asp.net 应用程序以配置会话状态以使用 sql 服务器-但这有其自身的问题，因为会话永远不会超时（因此您需要通过代码显式处理此问题）

2）如果不使用 sql server - 基本上，当您有太多用户并且您在 Web 服务器上实现负载平衡时，您会遇到问题 - 因此用户可以在同一个会话中转到不同的 Web 服务器（它不会工作)

也有一个解决方法 - 它称为 STICKY SESSIONS - 您的 Web 服务器可以保证您的用户在会话中始终访问同一个 Web 服务器

3) 使用 .net 2.0 提供程序模型，您甚至可以通过实现他们的委托来编写自己的会话存储提供程序 - 因此您可以在您的 Web 服务器/共享服务器上创建自己的 xml 文件以在那里读取/写入会话数据:-)

所以有很多方法可以解决这个问题。然而，最简单且具有成本效益的解决方案是使用 cookie

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T16:25:13.850

会话是这里的方式，它们旨在跨请求保留有关当前会话的信息。ASP.NET 框架中没有其他对象具有此意图。

您可以使用缓存，或存储在应用程序集合中，但唯一标识单个会话数据的责任取决于您。

还取决于您处理会话何时终止，并释放存储在这些集合（缓存或应用程序）中的实例。

根据您可能“认为”会发生的事情开始提出这些问题确实是个坏主意。这是过早优化的一种形式，您应该避免它。相反，使用会话，因为它们是为此目的而设计的，然后测量瓶颈所在并解决它们，如果性能是测试时的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T16:20:49.913

您可能会使用缓存。它具有内置机制，可在内存耗尽时释放...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T16:25:30.387

绝对为此使用cookie。最好的方法是让自己成为一个 cookie 包装类，它将为您完成所有繁重的工作 - 检查 cookie 是否为空，访问 httpcontext 等。无需将您的代码搞砸；只需将其全部抽象为 cookies.cs 或 .vb。

```
SetCookieValue(someValue, cookieName); //there will be some expiration concerns here as well

myValue = GetCookieValue(cookieName); 
```

[Christian Weiss 有一个很好的策略](http://chwe.at/blog/post/2009/01/27/Use-wrappers-to-access-your-cookies-sessions-e280a6.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T16:22:54.527

如果您认为您的数据对于 Session 来说太大了，我会考虑使用缓存的某种数据库，这样您就不会进行不必要的调用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T16:23:40.657

如果您要存储的是每用户会话数据，那么使用 ASP.NET 会话绝对是您的最佳选择。如果您最担心内存使用情况，那么您可以使用 MSSQL 模式。数据必须存在于某个地方，并且选择使用哪种会话模式取决于您的环境和用户的使用模式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T16:25:13.460

在您看到这样的问题并尝试解决之前，不要假设会话状态的大小会出现问题。例如，尽管整个应用程序可能使用大量会话状态，但任何给定用户在会话过程中可能不会使用那么多。

我也有可能从默认会话状态提供程序更改为 SQL 提供程序或状态服务器提供程序会缓解内存问题。

您可以使用缓存，但缓存是应用程序范围的。您需要使用用户 id 或会话 id: 来限定缓存条目`Cache[userID + ".MyCacheEntry"]`。

在任何情况下都不要使用静态变量来存储这些数据。正如您的主题行所建议的，它们是应用程序范围的，而不是每个用户的。

# .net - 为什么我的提交事件没有被 ASP.NET 中的 jQuery 捕获？

> ID：710475
> 
> 赞同：1
> 
> 时间：2009-04-02T16:23:22.403
> 
> 标签：.net, asp.net, javascript, jquery

我在一个简单的 ASP.NET 页面上写了这个：

```
jQuery(document).ready(function() {
 jQuery("form").submit(function() {
   alert("kikoo");
   return false
  });
}); 
```

当我提交时（通过单击按钮、链接......），我从来没有看到警报框。

asp.net 页面中是否有“绕过”提交的内容（我想到了 dopostback javascript 方法）

谁能告诉我为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T17:19:09.243

您是否可能对[jQuery submit()](http://docs.jquery.com/Events/submit)函数的使用感到困惑？

听起来您希望在页面加载时出现警报对话框，因为您认为提交功能实际上是在提交您的表单。但是根据您使用它的方式，submit() 函数只是将一个事件附加到您的表单，这样当您实际**提交**它时，您的函数就会运行。

要从您的代码中实际触发提交，您必须使用不带任何参数的 submit()，如下所示：

```
$("form").submit(); 
```

这是一个扩展示例，以 Mike C 的答案为基础：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Title</title>
    <script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
    <script type="text/javascript">
    $(function() {
        $("form").submit(function() {
            alert("kikoo"); return false
        });
        // you could also chain this onto the end of the previous function
        $("form").submit();
    });
    </script>
</head>
<body>
    <form><input type="submit" /></form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-11T10:22:42.917

最后我发现 do postback 方法覆盖了我的处理程序（仍然不明白为什么）。

所以这就是我所做的： 1\. 我在 JS 函数中声明我的行为

```
function MyBehaviour()
{...} 
```

2\. 然后我做了一个“经典”的 jQuery 绑定

```
jQuery(document).ready(function() {
    jQuery("form").submit(EncodeAllTxtControl);
}); 
```

3\. 然后在每个表格上，我都有 myu 行为，但保留已经声明的行为

```
jQuery("form").each(function() {
        var oldonSubmit = this.onsubmit;
        if (typeof oldonSubmit != 'function') {
            this.onsubmit = function() {
                MyBehaviour();
                return true;
            };
        }
        else
            this.onsubmit = function() {
                MyBehaviour();
                oldonSubmit();
                return true;
            };
    }); 
```

这似乎有效。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-03T09:30:30.453

我发现了问题。

当我单击某个按钮时，他们会调用一个执行 form.submit 的所有 javascript 方法。jQuery 没有捕捉到这一点。

我会纠正我的按钮的行为，它会正常工作。

谢谢大家的帮助。

# perl - 如何在 DBM 数据库中存储时间戳？

> ID：710479
> 
> 赞同：0
> 
> 时间：2009-04-02T16:24:11.887
> 
> 标签：perl, timestamp, dbm

我正在实施简单的文件共享服务。目前我使用基于文件的数据库（因为它适合我的需要）。

```
 # somewhere in my cgi script
   sub first_run
    {
      my $dbh = DBI->connect('dbi:DBM:');
      $dbh = DBI->connect("dbi:DBM:", "", "",{ AutoCommit => 1, RaiseError => 1, f_dir=>$DATABASE_DIR} );
      unless ($dbh)
      {
        print "<br>Cannot connect: $DBI::errstr";
        return undef;
      }
      $dbh->do("CREATE TABLE uploads( user_name TEXT,
        file_name TEXT, 
        upload_date TEXT ) ");
      $dbh->disconnect( );
    } 
```

如您所见，我建议将上传时间戳存储为字符串，因为目前我只需要显示它（假设使用 localtime() 来获取人类可读格式的时间戳）。但这在我看来有些糟糕。如果稍后我想显示某个时期的上传内容，等等。

在不使用第三方 CPAN 模块的情况下，在 DBM 数据库中存储时间戳的常用方法是什么？我以后如何将它们拉出来并显示给用户（在我的情况下，转换回字符串）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T16:33:57.620

考虑到存储 UTC 时间比存储本地时间更明确。如果您在伦敦的计算机上节省时间并在香港将文件发送给我，当我在您的程序中加载文件时，我会看到您实际节省的时间吗？

考虑到在存储 UTC 时间时，您（至少）有两种选择：格式化的时间字符串，或自特定时间（“纪元”）以来的（秒/毫秒/其他）的计数。据推测，任何一种格式都与另一种同构，因为从一种格式到另一种格式都有明确定义的双向转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T17:34:37.053

我只是存储时代，然后很容易用 *localtime* 或 *strftime* 显示它。

如果您真的希望能够浏览数据库的内容而不必转换回纪元，您可以存储数值和 *localtime* 字符串（“ `1238693517 - Thu Apr 2 19:31:57 2009` ”）。这使得数据冗余和非规范化，但也使其易于检查，同时仍然能够处理数值。你的来电。

# c# - 动态创建的表达式

> ID：710480
> 
> 赞同：3
> 
> 时间：2009-04-02T16:24:27.050
> 
> 标签：c#, lambda

我正在创建一个动态表达式，它将按照某些规则（lambda exp.）对列表中的项目进行排序。这是代码：

```
Expression<Func<String, String>> exp = o => o;

MethodCallExpression orderByExp = Expression.Call(typeof(Enumerable), "OrderBy",
    new Type[] { typeof(String), exp.Body.Type }, Expression.Parameter(typeof(IEnumerable<String>), "list"), exp); 
```

现在我想对特定数据执行先前创建的表达式以对其进行排序，但由于一些奇怪的异常，例如“Lambda 参数不在范围内”或“参数表达式无效”，它失败了。

```
var data = new String[] { "asdasdasd", "asdads", "123", "xcvxcvs", "ASDSD" };

// one of attempts: doesn't work
var result = data.AsQueryable().Provider.CreateQuery<String>(orderByExp); 
```

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T14:44:11.900

通过属性订购任何可枚举（无反射）：

```
public static IOrderedEnumerable<T> OrderBy<T>(this IEnumerable<T> items, string property, bool ascending)
        {
            var MyObject = Expression.Parameter(typeof (T), "MyObject");
            var MyEnumeratedObject = Expression.Parameter(typeof (IEnumerable<T>), "MyEnumeratedObject");
            var MyProperty = Expression.Property(MyObject, property);
            var MyLamda = Expression.Lambda(MyProperty, MyObject);
            var MyMethod = Expression.Call(typeof(Enumerable), ascending ? "OrderBy" : "OrderByDescending", new[] { typeof(T), MyLamda.Body.Type }, MyEnumeratedObject, MyLamda);
            var MySortedLamda = Expression.Lambda<Func<IEnumerable<T>, IOrderedEnumerable<T>>>(MyMethod, MyEnumeratedObject).Compile();
            return MySortedLamda(items);
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T21:12:16.630

这是工作代码：

```
Expression<Func<String, String>> exp = o => o;
var list = Expression.Parameter(typeof(IEnumerable<String>), "list");

MethodCallExpression orderByExp = Expression.Call(typeof(Enumerable), "OrderBy",
    new Type[] { typeof(String), exp.Body.Type }, list, exp);

var lambda = Expression.Lambda<Func<IEnumerable<String>, IEnumerable<String>>>(orderByExp, list);
var data = new String[] { "asdasdasd", "asdads", "123", "xcvxcvs", "ASDSD" };
var result = lambda.Compile()(data); 
```

1.  要执行 MethodCallExpression，您应该将其包装在 lambda 表达式中。
2.  确保在创建 MethodCallExpression 和 LambdaExpression 时使用相同的参数表达式（'list'）实例，而不是使用相同名称的两个单独实例，否则您将得到：“Lambda Parameter not in scope”异常解释。

感谢专家

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-15T20:59:19.130

我在使用 Linq 时遇到了几乎相同的问题，我决定编写一个扩展函数，其中一些想法来自这个问题的答案：

```
<Extension()> _
Public Function OrderBy(Of T)(ByVal query As IEnumerable(Of T), ByVal sortColumn As String, ByVal direction As String) As IEnumerable(Of T)
        Dim methodName As String = String.Format("OrderBy{0}", If(direction.ToLower() = "asc", "", "Descending"))
        Dim parameter As ParameterExpression = Expression.Parameter(GetType(T), "p")
        Dim memberAccess As MemberExpression = Nothing

        For Each _property As Object In sortColumn.Split(".")
            memberAccess = MemberExpression.Property(If(memberAccess, CType(parameter, Expression)), _property)
        Next

        Dim orderByLambda As LambdaExpression = Expression.Lambda(memberAccess, parameter)
        '
        Dim myEnumeratedObject As ParameterExpression = Expression.Parameter(GetType(IEnumerable(Of T)), "MyEnumeratedObject")

        Dim result As MethodCallExpression = Expression.Call(GetType(Enumerable), _
                  methodName, _
                  New System.Type() {GetType(T), memberAccess.Type}, _
                  myEnumeratedObject, _
                  orderByLambda)

        Dim lambda = Expression.Lambda(Of Func(Of IEnumerable(Of T), IEnumerable(Of T)))(result, myEnumeratedObject)
        Return lambda.Compile()(query)
    End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T16:46:57.963

有什么特别的原因你不只是打电话：

```
data.AsQueryable().OrderBy(exp); 
```

你甚至需要在这里使用`IQueryable`吗？我觉得我错过了一些大局。你真的要把它作为 LINQ to SQL（或 LINQ to Entities）的一部分来调用吗？如果它只是在 LINQ to Objects 中，你不能只使用`data.OrderBy(exp)`吗？

基本上，更多的解释会有所帮助:)

# wcf - 我可以在传出的 MSMQ 上重定向地址错误的消息吗？

> ID：710489
> 
> 赞同：3
> 
> 时间：2009-04-02T16:26:43.927
> 
> 标签：wcf, msmq

我在传出的 MSMQ 上有一堆由于拼写错误而被错误处理的消息。他们被困在传出队列上，因为他们所指向的盒子不存在。

队列名称的形式为

DIRECT=OS:foo\private$\MyQueue 并处于等待连接状态

我想寄给

DIRECT=OS:bar\private$\MyQueue

主机文件中的条目是否足够，或者如果没有，我可以这样做吗？如果可能的话，我不想创建一个名为的服务器和一个接收消息并将它们转发到正确的服务器的进程

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T08:51:07.053

我尝试了上面建议的想法，即使用正确的 IP 地址将不正确的条目添加到 Hosts 文件中。这导致消息被发送到远程计算机，但我认为 WCF 丢弃了它们，因为它们没有正确的端点地址。

如果您不想丢失消息，不推荐！对我来说幸运的是，这些并不重要，所以值得一试。

那好吧

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T19:10:45.340

莫丹，

几年前我经历过类似的事情，我能找到的唯一方法是设置盒子和 Q（在 VM 中）并将它们转发到正确的队列。也许您可以删除并重新发送带有修复程序的消息？那可能吗？不幸的是，不认为有解决这个问题的好方法。

-布莱恩

# asp.net-mvc - ASP.NET MVC 将强类型数据传递到母版页

> ID：710499
> 
> 赞同：6
> 
> 时间：2009-04-02T16:28:28.820
> 
> 标签：asp.net-mvc

## 复制

> [在 ASP.NET MVC 中将数据传递到母版页](https://stackoverflow.com/questions/78548/passing-data-to-master-page-in-asp-net-mvc)
> 
> [ASP.NET 母版页是否应该从视图中获取数据？](https://stackoverflow.com/questions/467855/should-an-asp-net-masterpage-get-its-data-from-the-view)

我一直在按照这种方法将公共数据传递给 site.master。但是，这确实需要对 ViewData 进行特定转换，而且我不喜欢到处使用字符串标识符。这是最好的方法还是有其他方法？

[http://www.asp.net/learn/MVC/tutorial-13-cs.aspx](http://www.asp.net/learn/MVC/tutorial-13-cs.aspx)

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T17:32:50.133

您可以创建一个所有模型都继承自的基类：

```
class MasterModel {
     // common info, used in master page.
}

class Page1Model : MasterModel {
     // page 1 model
} 
```

然后您的母版页将继承自`ViewMasterPage<MasterModel>`并且您`Page1.aspx`将继承自`ViewPage<Page1Model>`并设置`Site.master`为其母版页。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-27T16:45:09.677

当我有点挣扎时，这是我的贡献：

```
class ModelBase {
     // common info, used in master page.
}

class Page1Model : ModelBase {
     // page 1 model
}

public class ControllerBase : Controller
{
    protected override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        var model = ViewData.Model as ModelBase;

        // set common data here

        base.OnActionExecuted(filterContext);
    }
} 
```

# ruby - 需要简单解释一下inject方法

> ID：710501
> 
> 赞同：148
> 
> 时间：2009-04-02T16:28:51.173
> 
> 标签：ruby, syntax

```
[1, 2, 3, 4].inject(0) { |result, element| result + element } # => 10 
```

我正在查看这段代码，但我的大脑没有记录数字 10 如何成为结果。有人介意解释这里发生了什么吗？

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2009-04-02T16:31:55.287

您可以将第一个块参数视为累加器：块的每次运行的结果都存储在累加器中，然后传递给块的下一次执行。在上面显示的代码的情况下，您将累加器结果默认为 0。该块的每次运行都会将给定的数字添加到当前总数中，然后将结果存储回累加器中。下一个块调用具有这个新值，添加到它，再次存储它，然后重复。

在进程结束时，inject 返回累加器，在本例中是数组中所有值的总和，即 10。

下面是另一个从对象数组创建散列的简单示例，以字符串表示为键：

```
[1,"a",Object.new,:hi].inject({}) do |hash, item|
  hash[item.to_s] = item
  hash
end 
```

在这种情况下，我们将累加器默认为空哈希，然后在每次块执行时填充它。请注意，我们必须将哈希值作为块的最后一行返回，因为块的结果将存储回累加器中。

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2009-04-02T16:39:04.583

`inject`以一个值开头（`0`在您的示例中）和一个块，它为列表的每个元素运行该块一次。

1.  在第一次迭代中，它传入您提供的值作为起始值和列表的第一个元素，并保存您的块返回的值（在本例中`result + element`）。
2.  然后它再次运行该块，将第一次迭代的结果作为第一个参数传递，并将列表中的第二个元素作为第二个参数传递，再次保存结果。
3.  它继续这种方式，直到它消耗完列表的所有元素。

以您为例，解释这一点的最简单方法可能是展示每个步骤的工作原理；这是一组假想的步骤，显示如何评估此结果：

```
[1, 2, 3, 4].inject(0) { |result, element| result + element }
[2, 3, 4].inject(0 + 1) { |result, element| result + element }
[3, 4].inject((0 + 1) + 2) { |result, element| result + element }
[4].inject(((0 + 1) + 2) + 3) { |result, element| result + element }
[].inject((((0 + 1) + 2) + 3) + 4) { |result, element| result + element }
(((0 + 1) + 2) + 3) + 4
10 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2016-07-13T12:04:24.187

注入方法的语法如下：

`inject (value_initial) { |result_memo, object| block }`

让我们解决上面的例子，即

`[1, 2, 3, 4].inject(0) { |result, element| result + element }`

这给出了*10*作为输出。

因此，在开始之前，让我们看看每个变量中存储的值是什么：

*结果 = 0*零来自*注入（值），即 0*

*element = 1*它是数组的第一个元素。

好的！！！那么，让我们开始理解上面的例子

第1步`[***1***, 2, 3, 4].inject(**0**) { |**0**, ***1***| **0** + ***1*** }`

第2步`[1, ***2***, 3, 4].inject(0) { |**1**, ***2***| **1** + ***2*** }`

步骤：3`[1, 2, ***3***, 4].inject(0) { |**3**, ***3***| **3** + ***3*** }`

第4步`[1, 2, 3, ***4***].inject(0) { |**6**, ***4***| **6** + ***4*** }`

步骤：5`[1, 2, 3, 4].inject(0) { |**10**, ***Now no elements left in the array, so it'll return 10 from this step***| }`

这里***粗斜体***值是从数组中获取的元素，简单**粗体**值是结果值。

我希望您`#inject`了解`#ruby`.

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-04-02T16:32:12.150

代码遍历数组中的四个元素，并将先前的结果添加到当前元素：

*   1 + 2 = 3
*   3 + 3 = 6
*   6 + 4 = 10

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-04-02T19:09:43.690

他们所说的，但也请注意，您并不总是需要提供“起始值”：

```
[1, 2, 3, 4].inject(0) { |result, element| result + element } # => 10 
```

是相同的

```
[1, 2, 3, 4].inject { |result, element| result + element } # => 10 
```

试试看，我等。

当没有参数传递给注入时，前*两个*元素被传递到第一次迭代中。在上面的示例中，第一次结果为 1，元素为 2，因此对块的调用减少了一次。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2014-04-09T19:18:17.983

你在注入的 () 中输入的数字代表一个起始位置，它可以是 0 或 1000。在管道内你有两个占位符 |x,y|。x = 你在 .inject('x') 中的任何数字，第二个代表你的对象的每次迭代。

`[1, 2, 3, 4].inject(5) { |result, element| result + element } # => 15`

> `1 + 5 = 6 2 + 6 = 8 3 + 8 = 11 11 + 4 = 15`

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-04-02T16:33:58.603

注入应用块

```
result + element 
```

到数组中的每个项目。对于下一项（“元素”），从块返回的值是“结果”。您调用它的方式（带有参数），“结果”从该参数的值开始。所以效果是添加元素。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-03-21T17:52:19.537

**tldr;** `inject`不同之处`map`在于一个重要的方面：`inject`返回块的最后一次执行的值，而`map`返回它迭代的数组。

**不仅如此**，每个块执行的值通过第一个参数（`result`在这种情况下）传递给下一个执行，您可以初始化该值（`(0)`部分）。

你上面的例子可以这样写`map`：

```
result = 0 # initialize result
[1, 2, 3, 4].map { |element| result += element }
# result => 10 
```

效果相同，但`inject`这里更简洁。

您经常会发现赋值发生在`map`块中，而评估发生在`inject`块中。

您选择哪种方法取决于您想要的范围`result`。什么时候*不*使用它会是这样的：

```
result = [1, 2, 3, 4].inject(0) { |x, element| x + element } 
```

您可能像所有人一样，“看我，我只是将所有内容合并到一行中”，但是您还临时分配了内存`x`作为临时变量，因为您已经不得不使用它，所以这不是必需`result`的。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-01-09T00:59:02.173

```
[1, 2, 3, 4].inject(0) { |result, element| result + element } # => 10 
```

等效于以下内容：

```
def my_function(r, e)
  r+e
end

a = [1, 2, 3, 4]
result = 0

a.each do |value|
  result = my_function(result, value)
end 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-03-02T16:04:10.353

`[1, 2, 3, 4].inject(0) { |result, element| result + element } # => 10`

用简单的英语来说，你正在（迭代）这个数组（`[1,2,3,4]`）。您将遍历此数组 4 次，因为有 4 个元素（1、2、3 和 4）。注入方法有 1 个参数（数字 0），您将该参数添加到第一个元素（0 + 1。这等于 1）。1 保存在“结果”中。然后将该结果（即 1）添加到下一个元素（1 + 2。这是 3）。*现在*将保存为结果。继续：3 + 3 等于 6。最后，6 + 4 等于 10。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-02T23:47:32.493

此代码不允许不传递起始值，但可能有助于解释发生了什么。

```
def incomplete_inject(enumerable, result)
  enumerable.each do |item|
    result = yield(result, item)
  end
  result
end

incomplete_inject([1,2,3,4], 0) {|result, item| result + item} # => 10 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-08-18T06:07:56.387

这是一个简单且相当容易理解的解释：

忘记“初始值”，因为它在开始时有些混乱。

```
> [1,2,3,4].inject{|a,b| a+b}
=> 10 
```

以上可以理解为：我在1、2、3、4之间注入了一个“加法机”。意思是 1 ♫ 2 ♫ 3 ♫ 4 ♫ 是加法机，所以和 1 + 2 + 3 + 4 一样，都是 10。

您实际上可以`+`在它们之间注入一个：

```
> [1,2,3,4].inject(:+)
=> 10 
```

就像，`+`在 1,2,3,4 之间注入 a，使其成为 1 + 2 + 3 + 4，它是 10。这`:+`是 Ruby`+`以符号形式指定的方式。

这很容易理解和直观。而如果你要一步一步分析它是如何工作的，那就是：取1和2，现在相加，当你有结果时，首先存储它（也就是3），现在，next是存储的值3和数组元素3经过a + b过程，即6，现在存储这个值，现在6和4经过a + b过程，为10。你本质上是在做

```
((1 + 2) + 3) + 4 
```

并且是 10。“初始值”`0`只是一个“基数”。在许多情况下，您不需要它。想象一下，如果你需要 1 * 2 * 3 * 4 它是

```
[1,2,3,4].inject(:*)
=> 24 
```

它完成了。你不需要一个“初始值”`1`来将整个东西乘以`1`. 这一次，它在做

```
(((1 * 2) * 3) * 4) 
```

你得到相同的结果

```
1 * 2 * 3 * 4 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-11-19T18:39:57.427

从这里开始，然后查看所有采用块的方法。 [http://ruby-doc.org/core-2.3.3/Enumerable.html#method-i-inject](http://ruby-doc.org/core-2.3.3/Enumerable.html#method-i-inject)

是让你感到困惑的块还是为什么你在方法中有一个价值？不过是个好问题。那里的操作员方法是什么？

```
result.+ 
```

它开始是什么？

```
#inject(0) 
```

我们可以这样做吗？

```
[1, 2, 3, 4].inject(0) { |result, element| result.+ element } 
```

这行得通吗？

```
[1, 2, 3, 4].inject() { |result = 0, element| result.+ element } 
```

您会看到我正在建立这样一个想法，即它只是简单地将数组的所有元素相加并在您在文档中看到的备忘录中产生一个数字。

你总是可以这样做

```
 [1, 2, 3, 4].each { |element| p element } 
```

看到数组的可枚举被迭代。这是基本的想法。

只是注入或减少会给你一个备忘录或一个被发送出去的累加器。

我们可以尝试得到一个结果

```
[1, 2, 3, 4].each { |result = 0, element| result + element } 
```

但什么都没有回来所以这只是和以前一样

```
[1, 2, 3, 4].each { |result = 0, element| p result + element } 
```

在元素检查器块中。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-02-15T19:21:34.597

有一天，我也对 Ruby 注入/减少方法中的默认值进行了猛烈抨击，因此我尝试将[我的问题可视化](https://richstone.io/ruby-inject-and-ruby-reduce-2/)：

[![默认值可视化](https://i.stack.imgur.com/FdPVH.png)](https://i.stack.imgur.com/FdPVH.png)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-03-31T16:17:41.213

还有另一种形式的 .inject() 方法，非常有帮助 [4,5].inject(&:+) 可以将区域的所有元素加起来

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-02-03T08:52:56.287

使用任何类型的集合时出现的常见情况是对所有元素执行单一类型的操作并收集结果。

例如，一个 sum(array) 函数可能希望将作为数组传递的所有元素相加并返回结果。

Ruby 中以 reduce 的名义提供了相同功能的通用抽象（inject 是一个别名）。也就是说，这些方法遍历集合并使用运算符累积对基值中元素的操作值，并最终返回该基值。

让我们举一个例子来更好地理解。

```
>>> (5..10).inject(1) {|product, n| product * n }
=> 151200 
```

在上面的示例中，我们有以下元素：一个基值 1、一个可枚举 (5..10) 和一个带有表达式的块，该块指示如何将计算的值与基值相加（即，将数组元素乘以乘积，其中产品用基值初始化）

所以执行如下：

```
# loop 1
n = 1
product = 1
return value = 1*1

# loop 2
n = 2
product = 1
return value = 1*2

n = 3
product = 2
return value = 2*3 
```

.. 如您所见，当表达式循环遍历容器的元素时，基值会不断更新，从而返回基值的最终值作为结果。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2014-10-17T00:56:36.600

与此相同：

```
[1,2,3,4].inject(:+)
=> 10 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2017-09-04T11:23:02.087

如果您熟悉其他语言，它只是`reduce`or 。`fold`

# cakephp - 确定用户是否是 facebook 应用程序的开发者

> ID：710502
> 
> 赞同：1
> 
> 时间：2009-04-02T16:28:53.810
> 
> 标签：cakephp, facebook

我正在寻找保护我的（cakephp 支持的）Facebook 应用程序的管理部分的方法。为了避免重复功能，我认为允许访问在应用程序设置中被标记为开发人员的人会很好。

那么问题可能是：如何确定我的 Facebook 应用程序的用户是否是开发人员？

或者：如何为我的 Facebook 应用获取一组开发者用户 ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T03:07:13.853

我尝试自己寻找您的答案，我发现您唯一可以做的就是将一个组设为私有且仅限开发人员邀请，然后使用 fb:if-is-group-member 标签。[http://wiki.developers.facebook.com/index.php/Fb:if-is-group-member](http://wiki.developers.facebook.com/index.php/Fb:if-is-group-member)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T15:13:07.790

好的，所以我发现了如何自己做。塞缪尔给我这个想法的道具。

基本上，执行此操作的方法是运行 FQL 查询，以确定用户是否是应用程序页面 ( [page_admin](http://wiki.developers.facebook.com/index.php/Page_admin_(FQL)) ) 的管理员。

```
SELECT uid FROM page_admin WHERE uid = 286302657 AND page_id = 31290624157 
```

在 PHP 客户端中，这将为开发人员返回一个数组，为其他任何人返回一个空字符串。

我决定使用 FQL 而不是 API 调用，因为可以[预加载 FQL](http://wiki.developers.facebook.com/index.php/Preload_FQL)以减少对 Facebook 服务器的调用。

希望这对某人有用。

# c# - StringBuilder.Append 与 StringBuilder.AppendFormat

> ID：710504
> 
> 赞同：39
> 
> 时间：2009-04-02T16:29:02.827
> 
> 标签：c#, string, stringbuilder

我想知道 StringBuilder 并且我有一个问题希望社区能够解释。

让我们忘记代码可读性，其中哪个**更快**，为什么？

### `StringBuilder.Append`：

```
StringBuilder sb = new StringBuilder();
sb.Append(string1);
sb.Append("----");
sb.Append(string2); 
```

### `StringBuilder.AppendFormat`：

```
StringBuilder sb = new StringBuilder();
sb.AppendFormat("{0}----{1}",string1,string2); 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-04-02T16:32:58.730

不可能说，不知道 和 的`string1`大小`string2`。

通过调用[`AppendFormat`](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.appendformat.aspx)，它会在给定格式字符串的长度和将要插入的字符串的情况下预分配一次缓冲区，然后将所有内容连接起来并将其插入缓冲区。对于非常大的字符串，这将优于[`Append`](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.append.aspx)可能导致缓冲区多次扩展的单独调用。

但是，三个调用`Append`可能会或可能不会触发缓冲区的增长，并且每次调用都会执行该检查。如果字符串足够小并且没有触发缓冲区扩展，那么它将比调用更快，`AppendFormat`因为它不必解析格式字符串来确定在哪里进行替换。

**需要更多数据才能确定答案**

应该注意的是，几乎没有讨论在[类](http://msdn.microsoft.com/en-us/library/system.string.concat.aspx)上使用静态[`Concat`方法`String`](http://msdn.microsoft.com/en-us/library/system.string.concat.aspx)（[乔恩的回答](https://stackoverflow.com/questions/710504/stringbuilder-append-vs-stringbuilder-appendformat/710659#710659)`AppendWithCapacity`让我想起了这一点）。他的测试结果表明这是最好的情况（假设您不必利用特定的格式说明符）。 `String.Concat`做同样的事情，它会预先确定要连接和预分配缓冲区的字符串的长度（由于通过参数循环构造，开销会稍多一些）。它的性能将与 Jon 的`AppendWithCapacity`方法相媲美。

或者，只是普通的加法运算符，因为它编译为`String.Concat`无论如何调用，但需要注意的是所有加法都在同一个表达式中：

```
// One call to String.Concat.
string result = a + b + c; 
```

**不是**

```
// Two calls to String.Concat.
string result = a + b;
result = result + c; 
```

* * *

**对于所有提交测试代码的人**

*您需要在单独*的运行中运行您的测试用例（或者至少，在单独的测试运行的测量之间执行一次 GC）。这样做的原因是，如果你确实说，1,000,000 次运行，[`StringBuilder`](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)在循环的每次迭代中为一个测试创建一个新的，然后你运行下一个循环相同次数的测试，创建*额外*的1,000,000个`StringBuilder`实例，GC很可能会在第二次测试期间介入并阻碍其时间安排。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-02T16:46:05.253

[casperOne 是正确的](https://stackoverflow.com/questions/710504/stringbuilder-append-vs-stringbuilder-appendformat/710522#710522)。一旦达到某个阈值，该`Append()`方法就会变得比`AppendFormat()`. 以下是每种方法 100,000 次迭代的不同长度和经过的刻度：

## 长度：1

```
Append()       - 50900
AppendFormat() - 126826 
```

## 长度：1000

```
Append()       - 1241938
AppendFormat() - 1337396 
```

## 长度：10,000

```
Append()       - 12482051
AppendFormat() - 12740862 
```

## 长度：20,000

```
Append()       - 61029875
AppendFormat() - 60483914 
```

当引入长度接近 20,000 的字符串时，该函数`AppendFormat()`将*略胜一筹*`Append()`。

为什么会这样？请参阅[casperOne 的回答](https://stackoverflow.com/questions/710504/stringbuilder-append-vs-stringbuilder-appendformat/710522#710522)。

**编辑：**

我在发布配置下单独重新运行每个测试并更新了结果。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-04-02T17:05:19.217

[casperOne 完全准确，这取决于数据](https://stackoverflow.com/questions/710504/stringbuilder-append-vs-stringbuilder-appendformat/710522#710522)。但是，假设您将其作为类库编写以供第 3 方使用 - 您会使用哪个？

一种选择是两全其美 - 计算出您实际上需要附加多少数据，然后使用[StringBuilder.EnsureCapacity](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.ensurecapacity.aspx)确保我们只需要调整单个缓冲区大小。

如果我*不太*介意的话，我会使用`Append`x3 - 似乎“更有可能”更快，因为在每次调用时解析字符串格式标记显然是制作工作。

请注意，我已经向 BCL 团队询问了一种“缓存格式化程序”，我们可以使用格式字符串创建它，然后重复使用。框架每次使用时都必须解析格式字符串，这太疯狂了。

编辑：好的，为了灵活性，我对 John 的代码进行了一些编辑，并添加了一个“AppendWithCapacity”，它首先计算出必要的容量。以下是不同长度的结果 - 对于长度 1，我使用了 1,000,000 次迭代；对于所有其他长度，我使用了 100,000。（这只是为了获得合理的运行时间。）所有时间都以毫秒为单位。

不幸的是，表格在 SO 中并没有真正起作用。长度分别为 1、1000、10000、20000

时间：

*   追加：162、475、7997、17970
*   附加格式：392、499、8541、18993
*   附加容量：139、189、1558、3085

事情发生了，我从未见过 AppendFormat 击败 Append - 但我*确实*看到 AppendWithCapacity 以非常可观的优势获胜。

这是完整的代码：

```
using System;
using System.Diagnostics;
using System.Text;

public class StringBuilderTest
{            
    static void Append(string string1, string string2)
    {
        StringBuilder sb = new StringBuilder();
        sb.Append(string1);
        sb.Append("----");
        sb.Append(string2);
    }

    static void AppendWithCapacity(string string1, string string2)
    {
        int capacity = string1.Length + string2.Length + 4;
        StringBuilder sb = new StringBuilder(capacity);
        sb.Append(string1);
        sb.Append("----");
        sb.Append(string2);
    }

    static void AppendFormat(string string1, string string2)
    {
        StringBuilder sb = new StringBuilder();
        sb.AppendFormat("{0}----{1}", string1, string2);
    }

    static void Main(string[] args)
    {
        int size = int.Parse(args[0]);
        int iterations = int.Parse(args[1]);
        string method = args[2];

        Action<string,string> action;
        switch (method)
        {
            case "Append": action = Append; break;
            case "AppendWithCapacity": action = AppendWithCapacity; break;
            case "AppendFormat": action = AppendFormat; break;
            default: throw new ArgumentException();
        }

        string string1 = new string('x', size);
        string string2 = new string('y', size);

        // Make sure it's JITted
        action(string1, string2);
        GC.Collect();

        Stopwatch sw = Stopwatch.StartNew();
        for (int i=0; i < iterations; i++)
        {
            action(string1, string2);
        }
        sw.Stop();
        Console.WriteLine("Time: {0}ms", (int) sw.ElapsedMilliseconds);
    }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-02T16:32:40.930

[`Append`](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.append.aspx)在大多数情况下会更快，因为该方法有许多重载，允许编译器调用正确的方法。由于您使用`Strings`的是`StringBuilder`可以将`String`重载用于`Append`.

[`AppendFormat`](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.appendformat.aspx)接受 a`String`然后是 an `Object[]`，这意味着必须解析格式，并且`Object`数组中的每个都必须`ToString'd`在它可以添加到`StringBuilder's`内部数组之前。

**注意：**就 casperOne 而言 - 如果没有更多数据，很难给出准确的答案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-02T17:14:59.770

`StringBuilder`也有级联附加：`Append()`返回`StringBuilder`本身，所以你可以这样写你的代码：

```
StringBuilder sb = new StringBuilder();
sb.Append(string1)
  .Append("----")
  .Append(string2); 
```

干净，并且它生成的 IL 代码更少（尽管这实际上是一个微优化）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T16:31:15.193

当然轮廓在每种情况下都可以肯定地知道。

也就是说，我认为通常会是前者，因为您不会重复解析格式字符串。

但是，差异会非常小。无论如何，您确实应该考虑`AppendFormat`在大多数情况下使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T16:31:30.200

我认为这是做最少工作量的电话。Append 只是连接字符串，其中 AppendFormat 正在执行字符串替换。当然，这些天，你永远无法告诉......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-02T16:31:50.963

1 应该更快，因为它只是附加字符串，而 2 必须根据格式创建一个字符串，然后附加字符串。所以那里有一个额外的步骤。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-02T16:35:34.293

在您的情况下，更快是 1，但这不是一个公平的比较。您应该问`StringBuilder.AppendFormat()`vs `StringBuilder.Append(string.Format())`- 由于内部使用 char 数组，第一个更快。

不过，您的第二个选项更具可读性。

# c# - 如何最好地使用 C# DbDataReader 循环一批结果

> ID：710508
> 
> 赞同：0
> 
> 时间：2009-04-02T16:30:49.813
> 
> 标签：c#, dbdatareader

我正在批量执行一些 SQL 查询，然后将所有结果集批量取回。我的代码当前放在一起的方式，第一个结果集被跳过。既然我知道了这一点，我可以简单地在我的循环之外添加另一个语句来获取第一个结果，但是我想知道是否有更优雅的解决方案来解决这个问题。

这是发生了什么的一些 sudo 代码：

```
DbDataReader reader= /*some stuff that returns a batch of results...*/;

while (reader.NextResult())
{
   while (reader.Read())
   {
       if (!reader.IsDBNull(0))
       {
           //do things with the data....
       }
   }
} 
```

现在我本来希望 NextResult() 在您第一次调用它时将您推进到第一个结果，这就是 Read() 似乎所做的。然而，它实际上似乎做的是在第一次通话时将您带到第二个结果。我是否误解了您应该如何使用此方法，或者您是否真的希望执行以下操作：

```
DbDataReader reader= /*some stuff that returns a batch of results...*/;

//this deals with the row in the the very first result
while (reader.Read())
{
    if (!reader.IsDBNull(0))
    {
        //do things with the data....
    }
}

//this deals with the rest of the rows...
while (reader.NextResult())
{
   while (reader.Read())
   {
       if (!reader.IsDBNull(0))
       {
           //do exact same things with the data....
           //is this not pretty klugey?
       }
   }
} 
```

这让我觉得编程风格很烂，但我看不出有什么办法。有谁知道对此有更优雅的解决方案？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-02T16:36:10.407

只需将 NextResult 放在循环的末尾而不是开头：

```
do {
   while (reader.Read()) {
      if (!reader.IsDBNull(0)) {
         //do things with the data....
      }
   }
} while (reader.NextResult()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T16:35:04.373

在绝大多数情况下，您将只返回一个带有任何给定调用的结果集，因此设计人员每次使用阅读器时都要求“NextResultSet”是没有意义的。

*因此，如果*您要提取多个结果集，您的第二个示例确实成立。但是，您的帖子让我想知道的另一件事是，如果您要检索多个结果集，为什么要对数据执行“完全相同的操作”-数据的结构不会有足够的不同，以至于您*不会'*不做完全相同的事情？

也就是说，您的示例让我想知道您是否在考虑数据管理功能的工作方式时没有某种错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T16:37:16.973

我通常这样做：

```
if(reader.HasRows)
    {
      while(reader.Read())
       {

          // Do Stuff
       }
    } 
```

希望能帮助到你

# c# - 如何从文档中隐藏 C# 代码中的方法？

> ID：710511
> 
> 赞同：0
> 
> 时间：2009-04-02T16:31:29.407
> 
> 标签：c#, .net

我有一堆以下格式的类，位于各种命名空间中。这些类的实例是网络上的序列化和反序列化对象。

```
public class Foo:INetSerializable
{

    public void ReadObjectData(Streamer stream)
    {

    }

    public void WriteObjectData(Streamer stream)
    {

   }
} 
```

在不同的命名空间中，我有一个 Dispatcher 类，它使用一些标准来序列化/反序列化这些实例。

但是，我不希望用户在我的文档中看到这些方法。我不能让这些人成为内部人员，因为这样 Dispatcher 将无法访问他们。

我使用 Visual Studio 2005，因此无法利用 C# 3.0。

我怎样才能做到这一点？

* * *

***另一个错误：***

例如，如何处理从 Foo 继承并覆盖 Read 和 WriteObjectData 的类，以下是给我这个错误： **类型不实现接口 INetSerializable**

```
public class Bar:Foo
    {

        public void ReadObjectData(Streamer stream)
        {

        }

        public void WriteObjectData(Streamer stream)
        {

       }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T16:38:55.283

您可以使用显式接口实现。我相信语法是

```
void INetSerializable.ReadObjectData(Streamer stream) 
```

请注意，它没有说“公开”，所以它不是公开的。它只能通过接口访问。

# .net - 人们期待 .Net 4.0 - 4.1 中的哪些功能

> ID：710516
> 
> 赞同：2
> 
> 时间：2009-04-02T16:32:16.470
> 
> 标签：.net, visual-studio-2010, .net-4.0

我非常有兴趣了解人们对即将推出的 .net 框架感兴趣的功能？

无论这些是新课程还是新控件，我都很想知道人们的看法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T16:42:03.873

代码契约和并行扩展。语言特性也不是（这主要是我通常感兴趣的），但两者都有可能显着改变我们编写代码的方式。

DLR 听起来确实很酷也很有趣，但我不确定我最终会不会经常使用它，至少在与 IronRuby/IronPython 的互操作方面是这样。能够使用后期绑定来减少反射样板代码会很好

就 C# 4 语言特性而言，协变和逆变将更像是一种“呸，减少了烦恼”，而不是“哇，酷的东西！” 但可选/命名参数可能非常方便。它将使编写/使用不可变类型*稍微*容易一些，尽管我仍然希望内置支持构建器模式:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-03T08:43:28.273

主要是并行扩展和'variance。当然还有：[`System.Reactive`/Rx 框架/“LINQ to Events”](http://themechanicalbride.blogspot.com/2009/07/introducing-rx-linq-to-events.html)，我认为它可能（来）*非常*大。

但是还有其他一些我在这里没有提到的东西——虽然在某种程度上“很高兴”——当新版本终于出现时可能会派上用场。像：

*   `BigInteger`（糟糕的是，a 之类的东西`INumber`还没有进入......）
*   `ISet<T>`和`SortedSet<T>`（框架中的自平衡树）
*   将文件系统枚举 API 从返回数组（仅？）更改为返回 IEnumerable（以及？）
*   对 F# 语言的默认支持
*   轻微的压缩改进

我认为`dynamic`可选/命名参数只是为了与使用/需要/需要这些概念的语言实现更好/更轻松的互操作。所以他们很高兴有空。但肯定仅此而已。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-02T16:37:20.810

我期待新的 WPF 控件。我相信现在的 WPF Toolkit 将作为控件合并到框架中。将它们作为 Visual Studio 中的库存控件并使用 .NET 框架对其进行修补会好得多，而不是每次必须修复错误时都必须下载新的集合。

此外，我期待着 Visual Studio 2010 的 WPF 荣耀！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T16:40:12.067

*   C# 中的可选参数

比起.NET 4.0，我真的很期待Visual Studio 2010，就像jirwin 的回应一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T16:37:04.713

DLR 和 Parallel Extensions，虽然我不能说我完全了解发货时包装盒中的内容。

编辑：根据 Jon Skeet，代码合同看起来也不错。不是开创性的，但从我看到的样本来看，它们看起来是一种很好的表现方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T16:46:53.347

很多更好的 Sharepoint 开发人员工具和支持的承诺，因为当你现在必须使用它时，这有点痛苦。

他们计划拥有的部署选项将省去一些麻烦。

所以我很乐观，他们已经听取了开发者社区的抱怨。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-03T08:11:30.520

我做了很多工作`Expression`，所以我期待[额外的表达式类型](http://marcgravell.blogspot.com/2008/11/future-expressions.html)。

我也喜欢可选/命名参数——但主要是为了[让不变性更简单](http://marcgravell.blogspot.com/2008/11/immutability-and-optional-parameters.html)；不知道我会用它很多，否则......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-31T09:52:12.690

对我来说，最重要的是**VB.NET 和 C# 之间的融合**，现在它们终于共享了在 3.0/3.5 中被破坏的相同功能。

我也有兴趣：

*   新的[元组](http://msdn.microsoft.com/en-us/magazine/dd942829.aspx)类型
*   [协变和逆变](http://blogs.msdn.com/ericlippert/archive/2007/10/16/covariance-and-contravariance-in-c-part-one.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-02T16:49:53.450

一个框架元组类和 C#4 'dynamic'，我将在任何地方使用它来了解到处使用 'var' 的人。（我知道“动态”不是纯粹的框架功能——但它是部分框架）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-02T17:20:56.463

嗯……`StringOr`上课不是愚人节玩笑吗？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-07-31T10:03:49.890

Visual Studio 2010 代码编辑器是纯 WPF 并且能够停靠在任一监视器上，并且插件不使用讨厌的 Office COM 对象模型 (EnvDTE)。

*我知道这不是框架，但问题已被标记为 VS2010*

# mysql - 为sql中的每个唯一值插入增量

> ID：710519
> 
> 赞同：2
> 
> 时间：2009-04-02T16:32:37.717
> 
> 标签：mysql, increment, group-by

我的任务是处理超出我有限的 sql 知识范围的 SQL 问题。我有以下问题。

我有一个目前看起来像这样的表：

```
 widgets
---------
    a
    a
    a
    b
    b
    c
    d
    d
    d 
```

我想有另一个表，每个唯一值递增编号......就像这样：

```
widgets  | widget_id
--------- ----------
    a    |    1
    a    |    1
    a    |    1
    b    |    2
    b    |    2
    c    |    3
    d    |    4
    d    |    4
    d    |    4 
```

我不确定如何使用插入语句来完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T16:39:04.957

创建一个带有 IDENTITY 列的表：

像这样的东西：

```
CREATE TABLE widget_ids (
  widget_id INT AUTO_INCREMENT PRIMARY KEY,
  widget varchar(5)
) 
```

并运行此命令：

```
INSERT INTO
  widget_ids (widget)
SELECT DISTINCT
  widget
FROM
  widgets 
```

* * *

现在，这只是一个例子。如果您想要一个长期解决方案，您可能希望在 widget_ids 表中为您的“小部件”字段编制索引，并且您希望确保为每个新小部件输入了一个值。

* * *

编辑：哦，另外，要获得第二个列出的确切表，您可以将 widgets 表连接到 widget_ids 表：

```
SELECT
    w.widget,
    wi.widget_id
FROM
    widgets w
LEFT JOIN
    widget_ids wi
  ON
    w.widget = wi.widget 
```

当然，在这里，索引是您的朋友。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T16:47:14.110

我认为服务器端游标可能是您最好的选择。我相信以下方法会起作用：

```
DECLARE @widgets varchar(20)
DECLARE @widget_id int
DECLARE @widget_count int
DECLARE @index int

DECLARE widgets_cursor CURSOR FOR
SELECT [widgets], COUNT(*)
FROM [original_widgets_table]
GROUP BY [widgets]

SET @widget_id = 0

OPEN widgets_cursor

FETCH NEXT FROM widgets_cursor INTO @widget, @widget_count
WHILE @@FETCH_STATUS = 0
BEGIN
  SET @widget_id = @widget_id + 1
  SET @index = 0

  WHILE @index < @widget_count
  BEGIN
    INSERT [new_widgets_table]
    (
    widget
    , widget_id
    )
    SELECT
    @widget
    , @widget_id

    SET @index = @index + 1
  END

  FETCH NEXT FROM widgets_cursor INTO @widget, @widget_count
END

CLOSE widgets_cursor

DEALLOCATE widgets_cursor 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T16:50:01.483

好吧，它不会通过插入语句来完成。

创建一个带有 auto_increment id 和 distinct 小部件的临时表。

然后将小部件表加入临时表，并使用临时表的 id 更新小部件。

您在这里所做的是规范化您的数据。一旦你有一个 (distinct widget, id) 的表，你就会有任何其他需要引用一个小部件的表，而不是引用这个生成的小部件 id。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T16:55:00.737

我的 MySQL 语法不是很好，但是假设您已经在上面创建了新表，这样的东西不会起作用吗？

```
set @i = 0; 

create temporary table t_widget_id
as 
    select distinct widgets, @i:=@i+1 as widget_id from widgets

insert into widget_new
    select widgets.widgets,
            t_widget_id.widget_id
        from
            widgets inner join
                t_widget_id 
                    on widgets.widgets = t_widget_id.widgets

drop table t_widget_id 
```

# sharepoint-2007 - 通过自定义文档库 DispForm.aspx 在 Word 中编辑 .doc

> ID：710524
> 
> 赞同：1
> 
> 时间：2009-04-02T16:33:13.053
> 
> 标签：sharepoint-2007, document

我有一个带有工作流的文档库，当满足某些条件时，它会动态设置用户编辑这些文档的权限。需要编辑这些项目的用户不是最聪明的用户，因此为了让他们安全且简单，我将 DispForm.aspx 自定义为仅在文档库中显示 2 个字段。

1.  “文档” - 文档的名称，它是在 MS Word 中打开文档的链接。
2.  “完毕？” - 是/否复选框。

用户在分配任务时会收到一封电子邮件；电子邮件包含指向自定义 DispForm.aspx 的 URL，用户单击链接，瞧，他们看到自定义的 DispForm.aspx 只有 2 个字段，他们知道该怎么做，因为他们不会被信息分心-过量，用户唯一要做的就是单击文档，以便在 Word 中打开，用户对文档进行更改，保存，在“完成？”中勾选“是” 复选框并开始下一个工作流程。

现在我遇到了这个特殊问题，当我在 Sharepoint Designer 中自定义文档库的 DispForm.aspx 并添加自定义 Sharepoint 控件（自定义文档库列表表单）时，它不包含名称字段（包含 URL）。我可以在 Sharepoint Designer 中手动添加该链接，但随后文档会在 Web 版本的 Word 中打开，如果用户想要保存它，它会保存到本地硬盘驱动器，而不是文档库。

我究竟做错了什么？如何在文档库的自定义 DispForm 中包含文档的正确 URL，在 Word 中打开文档并保存到文档库并创建草稿版本？

非常欢迎提出建议、提示或其他解决方案！

埃里克

目前使用：MOSS 2007、Nintex、Sharepoint Designer

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T17:56:13.117

我写了一篇关于如何获取[用于编辑 SharePoint 文档的外部链接](http://wiki.threewill.com/display/is/2007/10/14/External+Link+for+Editing+a+SharePoint+Document)的博客。也许这会有所帮助。

# django - mod_wsgi（守护进程）站点是否将内容移交给 apache 以提供给客户端？

> ID：710535
> 
> 赞同：0
> 
> 时间：2009-04-02T16:36:19.753
> 
> 标签：django, optimization, apache2, mod-wsgi

我在 apache2.2 的守护进程模式下使用 mod_wsgi 部署了 Django。因此，在 Django 生成内容之后，它是否将所有内容都从那里移交给 apache 以使其以其优化的荣耀提供服务，或者 Django 在此服务步骤中是否仍以某种方式征税？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-24T12:19:36.750

FWIW，在 mod_wsgi 1.X 中，允许 Apache 执行输出缓冲默认是关闭的。这是因为 WSGI 规范有效地禁止了底层 Web 服务器的输出缓冲。这是因为 WSGI 规范要求在从可迭代/生成器返回的每个字符串之后将数据刷新回浏览器。

换句话说，启用输出缓冲是可选的，并且比其他任何事情都更像是一个实验。它被删除是因为 WSGI 禁止它，并且因为它实际上使 mod_wsgi 代码复杂化，因为当需要为某些 Apache 版本中的不正确行为实施一些变通方法时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T16:44:41.620

WSGI 接口表明（[http://www.python.org/dev/peps/pep-0333/](http://www.python.org/dev/peps/pep-0333/)）调用了您的 WSGI 应用程序（在本例中为 Django），并且必须返回内容。

Django 调用了你的视图函数。您的视图函数返回了一个渲染的模板。Django 返回渲染模板的结果。并且，它代表您调用了`start_response`可调用对象。

向后工作另一个步骤，Apache 调用了 mod_wsgi。`start_response`mod_wsgi（遵循 WSGI 规则）创建环境并将其与Django 可以使用的可调用对象一起交给 Django 。

当 Django 调用`start_response`时，mod_wsgi 有义务收集该响应并对其进行处理。它把它交给 Apache 来反馈给浏览器。

请注意，Django 可能会非常匆忙地完成。然而，Apache 却卡住了将初始页面向下传递到浏览器。然后，浏览器开始请求 .JS 库、.CSS 文件和所有这些图像。理想情况下，Apache 会处理所有其余的后续请求。

* * *

您可能会问“mod_wsgi 是否为我缓冲？” 答案因版本而异。Pre 2.0 mod_wsgi 可以为你积累一个缓冲区。mod_wsgi 2.0 及更高版本不缓冲，它假定应用程序能够缓冲，或者包含用于缓冲的中间件。

[http://code.google.com/p/modwsgi/wiki/ChangesInVersion0200](http://code.google.com/p/modwsgi/wiki/ChangesInVersion0200)

通常，您的 Django 模板在一个缓冲区中呈现，并被一次性交给 mod_wsgi，供 Apache 应用输出过滤器并将其滴入浏览器。

# visual-studio - Visual Studio 类/文件模板：有没有办法根据项目/解决方案自动更改其内容？

> ID：710536
> 
> 赞同：1
> 
> 时间：2009-04-02T16:37:03.200
> 
> 标签：visual-studio, templates

我在 Visual Studio 中为类、接口、代码文件等更新了默认模板。我删除了默认命名空间并添加了版权标题简介。

有没有办法在模板中使用变量或其他东西，这样我就不必压缩/解压缩并重新运行 vs 安装程序来更改版权标题？（我是一名顾问，代码所有者并不总是我或我的公司）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T16:41:10.007

是的你可以。这类东西的文档是 Visual Studio SDK 的一部分。您已经可以使用许多变量。

如果您发现自己想变得花哨，请查看 Guidance Automation Toolkit。使用 GAT 的模板可以接受用户输入以及来自项目和环境的信息，可以展开一个或多个模板，用收集的数据填充占位符，然后可以对展开的模板、项目或其他内容执行各种操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-18T20:13:32.257

您可以在此处获得完整的示例：[带向导的多项目模板：Visual Studio 2010 示例](http://vsix.codeplex.com/)

# javascript - jQuery/JavaScript“this”指针混淆

> ID：710542
> 
> 赞同：25
> 
> 时间：2009-04-02T16:38:33.897
> 
> 标签：javascript, jquery, this

调用函数时“this”的行为`bar`让我感到困惑。请参阅下面的代码。当从点击处理程序调用 bar 时，有没有办法将“this”安排为普通的旧 js 对象实例，而不是作为 html 元素？

```
// a class with a method

function foo() {

    this.bar();  // when called here, "this" is the foo instance

    var barf = this.bar;
    barf();   // when called here, "this" is the global object

    // when called from a click, "this" is the html element
    $("#thing").after($("<div>click me</div>").click(barf));
}

foo.prototype.bar = function() {
    alert(this);
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-02T16:55:37.507

欢迎来到 javascript 的世界！:D

您已经进入了 javascript 范围和闭包的领域。

**对于简短的回答：**

```
this.bar() 
```

*在foo*的范围内执行，（因为*this*指的是*foo*）

```
var barf = this.bar;
barf(); 
```

在全局范围内执行。

this.bar 基本上意味着：

*在this* (foo)的范围内执行 this.bar 指向的函数。当您将 this.bar 复制到 barf 时，然后运行 ​​barf。Javascript 理解为，运行 barf 指向的函数，由于没有*this*，它只是在全局范围内运行。

要更正此问题，您可以更改

```
barf(); 
```

像这样：

```
barf.apply(this); 
```

*这告诉 Javascript 在执行它之前将this*的范围绑定到 barf。

对于 jquery 事件，您将需要使用匿名函数，或者在原型中扩展绑定函数以支持范围。

欲了解更多信息：

*   [关于范围界定的好解释](http://ryanmorr.com/understanding-scope-and-context-in-javascript/)
*   [将 jQuery 绑定扩展到支持范围](http://www.sanghvilabs.com/?p=12)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T16:58:10.450

[QuirksMode](http://www.quirksmode.org/js/this.html)`this`对 JavaScript 中的关键字有很好的解释。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-02T16:59:40.477

你可能会发现：

[在 jQuery 事件中控制“this”的值](https://stackoverflow.com/questions/520019/controlling-the-value-of-this-in-a-jquery-event)

或这个：

[http://www.learningjquery.com/2007/08/what-is-this](http://www.learningjquery.com/2007/08/what-is-this)

有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T16:46:05.313

您可以使用`Function.apply`函数来设置`this`应该引用的内容：

```
$("#thing").after($("<div>click me</div>").click(function() {
    barf.apply(document); // now this refers to the document
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-02T17:10:04.553

获取这本书：JavaScript：好的部分。

另外，尽可能多地阅读 Douglas Crockford [http://www.crockford.com/javascript/](http://www.crockford.com/javascript/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T16:41:47.320

这是因为*this*始终是函数附加到的实例。在 EventHandler 的情况下，它是触发事件的类。

您可以使用这样的匿名函数来帮助自己：

```
function foo() {
  var obj = this;
  $("#thing").after($("<div>click me</div>").click(function(){obj.bar();}));
}

foo.prototype.bar = function() {
  alert(this);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-01T03:00:18.127

```
this.bar();  // when called here, "this" is the foo instance 
```

当 foo 用作普通函数而不是构造函数时，此注释是错误的。这里：

```
foo();//this stands for window 
```

# sql - 在同一个 SQL 字段中存储数字和文本的理论

> ID：710546
> 
> 赞同：1
> 
> 时间：2009-04-02T16:39:06.750
> 
> 标签：sql, types, field

我有一个三张桌子

**结果：** TestID TestCode 值

**测试：** TestID TestType SysCodeID

**SystemCodes** SysCodeID ParentSysCodeID 说明

我的问题是用户何时将数据输入**结果**表。

如果 testCode 的类型为 SystemList，则行获得焦点时的格式代码会将值字段更改为下拉组合框。下拉列表包含所有具有 test.SysCodeID 的 parentsyscodeID 的系统代码。当用户在列表中选择一个值时，它会转换为一个进入值字段的数字。

Results.Value 字段的数据类型是整数。我将其设为整数而不是字符串，因为在报告时，如果它是数字，则更容易进行计算和排序。如果您将整数/十进制值放入字符串字段，则会出现问题。同样，在设计系统时，他们只需要数字。

用户现在想要将字符串放入值字段以及列表中的数字/值，我想知道最好的方法是什么。

* * *

将字段转换为字符串然后将字符串和整数存储在同一个字段中会是不好的做法吗？有与此相关的不同问题，但我不确定是否有什么大不了的。

我是否应该在字符串数据类型表中添加另一列，如果测试是字符串类型，则将用户输入的数据放入不同的字段中。

另一种选择是创建与另一个表的 1-1 关系，如果用户在 value 字段中键入字符串，它会将其添加到带有数字键的新表中。

有人有什么有趣的想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T18:08:32.760

你是说他们想做自由格式的文本输入吗？如果是这样，他们将破坏在现场进行有意义的报告的能力，因为我可以保证他们不会始终如一地输入字符串。

如果他们要输入几个预设字符串之一（例如，A、B、C 等的等级），则为这些字符串创建一个查找表，该表映射到用于排序、评估、平均等的数值。

如果他们真的希望能够开始输入自由格式的文本并且您无法劝阻他们，请沿 other_entry 行添加另一列。有一个预定义的值，意思是“其他”放入你的值列。这样，当您进行报告时，您可以汇总所有这些随机的“其他”值，也可以简单地忽略它们。确保将“其他”添加到 SystemCodes 表中，以便在该表和结果表之间保留一个外键。如果您还没有，那么您绝对应该考虑添加一个。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T00:42:58.077

如果将 Results.Value 视为一个数字 ValueCode 并成为引用另一个表的外键，该表包含一个 ValueCode 和一个与之匹配的字符串。

```
CREATE TABLE ValueCodes
(
    Value     INTEGER NOT NULL PRIMARY KEY,
    Meaning   VARCHAR(32) NOT NULL UNIQUE
);

CREATE TABLE Results
(
   TestID     ...,
   TestCode   ...,
   Value      INTEGER NOT NULL FOREIGN KEY REFERENCES ValueCodes
); 
```

您继续像现在一样存储整数，但它们是对 ValueCodes 表中一组有限值的引用。大多数现有值显示为整数，例如 100，字符串表示相同的值“100”。可以根据需要添加新代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T23:26:38.027

> 用户现在想要将字符串放入值字段以及列表中的数字/值，我想知道最好的方法是什么。

听起来用户想要添加新的“testCodes”。如果是这种情况，为什么不将它们添加到您现有的测试代码表中并保留您现有的格式。

> 将字段转换为字符串然后将字符串和整数存储在同一个字段中会是不好的做法吗？有与此相关的不同问题，但我不确定是否有什么大不了的。

不，这没什么大不了的。通常 PO 编号或 Invoice 编号具有数字或字母和数字的组合。但是，关于数据库在数字字段而不是字符串上的性能，您是对的，但是如果您索引字符串字段，那么最终数据库会在数字索引上进行扫描。

您可能在将小数作为字符串时遇到的问题可能与浮点数据类型有关，在这些数据类型中，服务器基本上估计字段的值并且只保留一定数量的数字的准确性。如果您担心数字，这可能会导致大量舍入错误。您可以通过使用具有小数静态精度的货币字段等来避免该问题。大声笑我很难学到这一点。

Tom H. 在解决其他所有问题方面做得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T16:46:31.583

我认为最简单的方法是将 Results.Value 转换为“字符串”（char、varchar 等）。是的，这破坏了进行数字排序的能力（并且您将无法再对列进行强制转换或转换，因为文本将与整数值混合），但我认为任何其他方法都太复杂了保养得当。（例如，在您提到的 1-1 情况下，该整数值是实际值还是字符串表的外键？现在我们需要另一列来确定。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T16:47:08.760

我会为字符串值创建额外的列。这不是真正的规范化，但它是最容易实现和使用的。

只要你不打算对数字做任何事情，比如求和或排序，对数字和字符串使用相同的字段就可以了。

从规范化的角度来看，额外表格方法虽然很好，但可能过于复杂。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T16:51:27.937

我会将值字段转换为字符串并添加一列，指示应将数据类型视为后处理和报告的数据类型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T16:55:30.847

Sql Server 至少有一个 IsNumeric 函数可以使用：

```
ORDER BY IsNumeric(Results.Value) DESC, 
         CASE WHEN IsNumeric(Results.Value) = 1 THEN Len(Results.Value) ELSE 99 END,
         Results.Value 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-02T18:10:34.567

想到了两种解决方案之一。这有点取决于您对数字的处理方式。如果它们只是代表某种选择，那么选择一个。如果您需要对其进行数学运算（排序、转换等），请选择另一个。

1.  将列更改为 varchar，然后将数字或文本放入其中。按数字排序会很糟糕，但是，嘿，它是一列。

2.  既有文本的 varchar 列，又有数字的 int 列。使用视图隐藏差异，并在必要时控制排序。如果您不关心查看的是数字还是文本，可以将这两列合并在一起。

# powershell - 使用 Powershell 生成 C# 类与方法和属性的报告

> ID：710548
> 
> 赞同：0
> 
> 时间：2009-04-02T16:39:59.870
> 
> 标签：powershell

有没有人使用 Powershell 生成 C# 类与方法和属性的报告？我先承认我并没有尝试自己先写这篇文章，但那里的某个人可能已经这样做了，或者会非常喜欢这样做。挑战将是识别跨多行的方法签名之类的东西。您可以加入 gc 返回的字符串数组并对其进行搜索以使其更容易。如果没有人回答，我最终会发布一个解决方案，但可能在数周后。

更新：我正在寻找一个 Powershell 解决方案，因为这已经是我的主要脚本语言，我希望能够随着时间的推移进行更改，也许可以将其扩展为涵盖 JavaScript，或者更改报告格式，我希望它可以与任何版本的 Visual Studio 和 C# 一起使用。我也在寻找一个文本报告，没有图形，以便它更易于搜索和操作。我喜欢没有限制的简单的完全可编程的免费东西。:)

谢谢，
迈克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T16:43:26.350

我确定您可以通过 PowerShell 访问 Reflection。

您还应该查看[NDepend](http://ndepend.com/)，它可以做很多此类事情。

# python - 使用“导入模块”还是“从模块导入”？

> ID：710551
> 
> 赞同：526
> 
> 时间：2009-04-02T16:40:49.210
> 
> 标签：python, python-import

我试图找到一个关于它是否最好使用`import module`或`from module import`. 我刚刚开始使用 Python，并且正在尝试从最佳实践入手。

基本上，我希望是否有人可以分享他们的经验，其他开发人员有什么偏好以及避免任何问题的最佳方法是*什么*？

* * *

## 回答 #1

> 赞同：573
> 
> 时间：2009-04-02T16:52:11.633

`import module`和之间的区别`from module import foo`主要是主观的。选择您最喜欢的一个，并在使用时保持一致。这里有一些要点可以帮助您做出决定。

`import module`

*   **优点：**
    *   减少对`import`报表的维护。不需要添加任何额外的导入来开始使用模块中的另一个项目
*   **缺点：**
    *   输入`module.foo`代码可能很乏味和冗余（可以通过使用`import module as mo`then typing来最小化乏味`mo.foo`）

`from module import foo`

*   **优点：**
    *   少打字使用`foo`
    *   更好地控制可以访问模块的哪些项目
*   **缺点：**
    *   要使用模块中的新项目，您必须更新您的`import`声明
    *   你失去了关于`foo`. 例如，`ceil()`与`math.ceil()`

任何一种方法都可以接受，但**不要**使用`from module import *`.

对于任何合理的大型代码集，如果您`import *`可能会将其固定到模块中，则无法删除。这是因为很难确定代码中使用的哪些项目来自“模块”，因此很容易达到您认为不再使用`import`但很难确定的地步。

* * *

## 回答 #2

> 赞同：233
> 
> 时间：2013-10-04T16:10:12.673

这里还有一个未提及的细节，与写入模块有关。当然，这可能不是很常见，但我不时需要它。

由于引用和名称绑定在 Python 中的工作方式，如果您想从该模块外部更新模块中的某些符号，例如 foo.bar，并让其他导入代码“看到”该更改，则必须导入 foo a某种方式。例如：

模块 foo：

```
bar = "apples" 
```

模块一：

```
import foo
foo.bar = "oranges"   # update bar inside foo module object 
```

模块 b：

```
import foo           
print foo.bar        # if executed after a's "foo.bar" assignment, will print "oranges" 
```

但是，如果您导入符号名称而不是模块名称，这将不起作用。

例如，如果我在模块 a 中执行此操作：

```
from foo import bar
bar = "oranges" 
```

外部的任何代码都`a`不会`bar`被视为“橙子”，因为我的设置`bar`仅影响了模块内部的名称“bar” `a`，它没有“进入”`foo`模块对象并更新其`bar`.

* * *

## 回答 #3

> 赞同：105
> 
> 时间：2014-02-04T08:40:54.420

尽管很多人已经解释了`import`vs `import from`，但我想尝试更多地解释一下幕后发生的事情，以及它改变的所有地方。

* * *

## `import foo`：

导入`foo`，并在当前命名空间中创建对该模块的引用。然后，您需要定义完整的模块路径以从模块内部访问特定的属性或方法。

例如`foo.bar`但不是`bar`

## `from foo import bar`：

导入`foo`，并创建对列出的所有成员 ( `bar`) 的引用。不设置变量`foo`。

例如`bar`但不是`baz`或`foo.baz`

## `from foo import *`：

导入`foo`，并创建对当前命名空间中该模块定义的所有公共对象的引用（`__all__`如果`__all__`存在，则列出的所有内容，否则不以 开头的所有内容`_`）。不设置变量`foo`。

例如`bar`and`baz`但不是`_qux`or `foo._qux`。

* * *

现在让我们看看我们什么时候做`import X.Y`：

```
>>> import sys
>>> import os.path 
```

检查`sys.modules`名称`os`和`os.path`：

```
>>> sys.modules['os']
<module 'os' from '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/os.pyc'>
>>> sys.modules['os.path']
<module 'posixpath' from '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/posixpath.pyc'> 
```

使用and来检查`globals()`和`locals()`命名空间字典：`os``os.path`

```
>>> globals()['os']
<module 'os' from '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/os.pyc'>
>>> locals()['os']
<module 'os' from '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/os.pyc'>
>>> globals()['os.path']
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 'os.path'
>>> 
```

从上面的例子中我们发现只有`os`在局部和全局命名空间中被插入。所以，我们应该可以使用：

```
>>> os
<module 'os' from
  '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/os.pyc'>
>>> os.path
<module 'posixpath' from
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/posixpath.pyc'>
>>> 
```

但不是`path`。

```
>>> path
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'path' is not defined
>>> 
```

一旦你从 locals() 命名空间中删除`os`，你将无法访问`os`，`os.path`即使它们存在于 sys.modules 中：

```
>>> del locals()['os']
>>> os
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'os' is not defined
>>> os.path
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'os' is not defined
>>> 
```

# 现在让我们谈谈`import from`：

## `from`：

```
>>> import sys
>>> from os import path 
```

## 检查`sys.modules`和：`os`_`os.path`

```
>>> sys.modules['os']
<module 'os' from '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/os.pyc'>
>>> sys.modules['os.path']
<module 'posixpath' from '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/posixpath.pyc'> 
```

我们发现在`sys.modules`我们发现和我们之前一样通过使用`import name`

`locals()`好的，让我们看看它在命名空间字典中的样子`globals()`：

```
>>> globals()['path']
<module 'posixpath' from '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/posixpath.pyc'>
>>> locals()['path']
<module 'posixpath' from '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/posixpath.pyc'>
>>> globals()['os']
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 'os'
>>> 
```

您可以使用 name`path`而不是 by访问`os.path`：

```
>>> path
<module 'posixpath' from '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/posixpath.pyc'>
>>> os.path
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'os' is not defined
>>> 
```

让我们从以下位置删除“路径” `locals()`：

```
>>> del locals()['path']
>>> path
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'path' is not defined
>>> 
```

最后一个使用别名的示例：

```
>>> from os import path as HELL_BOY
>>> locals()['HELL_BOY']
<module 'posixpath' from '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/posixpath.pyc'>
>>> globals()['HELL_BOY']
<module 'posixpath' from /System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/posixpath.pyc'>
>>> 
```

并且没有定义路径：

```
>>> globals()['path']
Traceback (most recent call last):
 File "<stdin>", line 1, in <module>
KeyError: 'path'
>>> 
```

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2009-04-02T16:50:35.100

两种方式都得到支持是有原因的：有时一种方式比另一种更合适。

*   `import module`：当您使用模块中的许多位时很好。缺点是您需要使用模块名称限定每个引用。

*   `from module import ...`：很好，导入的项目无需模块名称前缀即可直接使用。缺点是你必须列出你使用的每一个东西，而且在代码中并不清楚某些东西是从哪里来的。

使用哪个取决于哪个使代码清晰易读，并且与个人喜好有很大关系。我倾向于`import module`一般，因为在代码中非常清楚对象或函数的来源。当我在代码中*大量*`from module import ...`使用某些对象/函数时，我会使用它。

 ** * *

## 回答 #5

> 赞同：36
> 
> 时间：2009-04-02T17:03:54.257

我个人总是使用

```
from package.subpackage.subsubpackage import module 
```

然后访问所有内容

```
module.function
module.modulevar 
```

等等。原因是同时您的调用时间很短，并且您清楚地定义了每个例程的模块名称空间，如果您必须在源代码中搜索给定模块的用法，这将非常有用。

不用说，不要使用 import *，因为它会污染你的命名空间，并且它不会告诉你给定函数来自哪里（来自哪个模块）

当然，如果两个不同包中的两个不同模块的模块名称相同，则可能会遇到麻烦，例如

```
from package1.subpackage import module
from package2.subpackage import module 
```

在这种情况下，你当然会遇到麻烦，但是强烈暗示你的包布局有缺陷，你必须重新考虑它。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2009-04-02T16:52:49.837

```
import module 
```

当您将使用模块中的许多功能时最好。

```
from module import function 
```

当您希望避免在只需要`function`.

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2013-05-22T09:56:25.207

我刚刚发现了这两种方法之间的另一个细微差别。

如果模块`foo`使用以下导入：

```
from itertools import count 
```

然后模块`bar`可以错误地使用`count`，就好像它是在 中定义的`foo`，而不是在`itertools`：

```
import foo
foo.count() 
```

如果`foo`使用：

```
import itertools 
```

错误仍然是可能的，但不太可能发生。`bar`需要：

```
import foo
foo.itertools.count() 
```

这给我带来了一些麻烦。我有一个模块错误地从一个没有定义它的模块导入了一个异常，只从其他模块导入了它（使用`from module import SomeException`）。当不再需要并删除导入时，有问题的模块被破坏了。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2014-01-16T19:05:39.693

这是另一个没有提到的区别。[这是从http://docs.python.org/2/tutorial/modules.html](http://docs.python.org/2/tutorial/modules.html)逐字复制的

请注意，使用时

```
from package import item 
```

item 可以是包的子模块（或子包），也可以是包中定义的其他名称，如函数、类或变量。import 语句首先测试该项目是否在包中定义；如果不是，它假定它是一个模块并尝试加载它。如果找不到它，则会引发 ImportError 异常。

相反，当使用类似的语法时

```
import item.subitem.subsubitem 
```

除最后一项外，每一项都必须是一个包裹；最后一项可以是模块或包，但不能是前一项中定义的类或函数或变量。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2018-05-05T12:59:06.703

由于我也是初学者，我将尝试以一种简单的方式来解释这一点：在 Python 中，我们有三种类型的`import`语句，它们是：

**1\. 通用进口：**

```
import math 
```

*这种类型的导入是我个人最喜欢的，这种导入技术的唯一缺点是，如果您需要使用任何模块的功能，您必须使用以下语法：*

```
math.sqrt(4) 
```

*当然，它会增加打字工作量，但作为初学者，它将帮助您跟踪与之相关的模块和功能，（一个好的文本编辑器会显着减少打字工作量，推荐）。*

***使用以下 import 语句可以进一步减少打字工作：***

```
import math as m 
```

*现在，`math.sqrt()`您可以使用`m.sqrt()`.*

**2.函数导入：**

```
from math import sqrt 
```

*如果您的代码只需要访问模块中的单个或几个函数，则这种类型的导入最适合，但是对于使用模块中的任何新项目，您必须更新导入语句。*

**3.通用进口：**

```
from math import * 
```

*虽然它显着减少了输入工作，但不推荐使用，因为它会使用模块中的各种函数填充您的代码，并且它们的名称可能与用户定义函数的名称冲突。* **例子：**

### 如果你有一个名为 sqrt 的函数并导入 math，你的函数是安全的：有你的 sqrt 和 math.sqrt。但是，如果您使用 from math import *，则会出现问题：即，两个不同的函数具有完全相同的名称。资料来源：[Codecademy](https://www.codecademy.com)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2015-02-22T05:37:51.653

```
import package
import module 
```

使用`import`时，令牌必须是模块（包含 Python 命令的文件）或包（包含文件中的`sys.path`文件夹`__init__.py`。）

当有子包时：

```
import package1.package2.package
import package1.package2.module 
```

对文件夹（包）或文件（模块）的要求是一样的，但文件夹或文件必须在里面`package2`，里面必须在里面`package1`，并且两者都`package1`必须`package2`包含`__init__.py`文件。[https://docs.python.org/2/tutorial/modules.html](https://docs.python.org/2/tutorial/modules.html)

使用`from`导入样式：

```
from package1.package2 import package
from package1.package2 import module 
```

包或模块进入包含`import`语句的文件的命名空间 as `module`(or `package`) 而不是`package1.package2.module`. 您始终可以绑定到更方便的名称：

```
a = big_package_name.subpackage.even_longer_subpackage_name.function 
```

只有`from`导入样式允许您命名特定的函数或变量：

```
from package3.module import some_function 
```

是允许的，但是

```
import package3.module.some_function 
```

不允许。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-04-02T17:46:08.400

补充一下人们所说的`from x import *`：除了让人们更难以分辨名字的来源之外，这还会引发像 Pylint 这样的代码检查器。他们会将这些名称报告为未定义的变量。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2020-04-10T04:02:47.123

这是我当前目录的目录结构：

> ```
> .  
> └─a  
>    └─b  
>      └─c 
> ```

1.  该`import`语句会记住**所有中间名称**。
    这些名称**必须是**合格的：

    ```
    In[1]: import a.b.c

    In[2]: a
    Out[2]: <module 'a' (namespace)>

    In[3]: a.b
    Out[3]: <module 'a.b' (namespace)>

    In[4]: a.b.c
    Out[4]: <module 'a.b.c' (namespace)> 
    ```

2.  该`from ... import ...`语句**只记住导入的名称**。
    此名称**不得**限定：

    ```
    In[1]: from a.b import c

    In[2]: a
    NameError: name 'a' is not defined

    In[2]: a.b
    NameError: name 'a' is not defined

    In[3]: a.b.c
    NameError: name 'a' is not defined

    In[4]: c
    Out[4]: <module 'a.b.c' (namespace)> 
    ```

* * *

*   *注意：*当然，我在第 1 步和第 2 步之间重新启动了 Python 控制台。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-04-02T17:53:14.763

我自己对此的回答主要取决于首先，我将使用多少个不同的模块。如果我只打算使用一两个，我会经常使用**`from`**...**`import`**因为它可以减少文件其余部分的击键次数，但如果我要使用许多不同的模块，我更喜欢**`import`**因为这意味着每个模块引用都是自记录的。我可以看到每个符号的来源，而无需四处寻找。

通常我更喜欢普通导入的自我记录风格，并且只有在我必须输入模块名称的次数超过 10 到 20 时才更改为 from.. import，即使只有一个模块被导入。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2019-08-07T12:23:11.560

我发现的显着差异之一*令人惊讶*的是没有人谈论过，使用普通*导入*可以访问`private variable`和从导入的模块，而使用*from-import*语句`private functions`是不可能的。

 *[![在此处输入图像描述](https://i.stack.imgur.com/1fqOd.png)](https://i.stack.imgur.com/1fqOd.png)

图片中的代码：

# 设置.py

```
public_variable = 42
_private_variable = 141
def public_function():
    print("I'm a public function! yay!")
def _private_function():
    print("Ain't nobody accessing me from another module...usually") 
```

# plain_importer.py

```
import settings
print (settings._private_variable)
print (settings.public_variable)
settings.public_function()
settings._private_function()

# Prints:
# 141
# 42
# I'm a public function! yay!
# Ain't nobody accessing me from another module...usually 
```

# from_importer.py

```
from settings import *
#print (_private_variable) #doesn't work
print (public_variable)
public_function()
#_private_function()   #doesn't work 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2019-08-23T15:39:06.337

我想补充一点。如果遇到循环导入，了解 Python 如何将导入的模块作为属性处理会很有用。

我有以下结构：

```
mod/
    __init__.py
    main.py
    a.py
    b.py
    c.py
    d.py 
```

从 main.py 我将使用不同的导入方法导入其他模块

主要.py：

```
import mod.a
import mod.b as b
from mod import c
import d 
```

dis.dis 显示了差异（注意模块名称，abcd）：

```
 1           0 LOAD_CONST               0 (-1)
              3 LOAD_CONST               1 (None)
              6 IMPORT_NAME              0 (mod.a)
              9 STORE_NAME               1 (mod)

  2          12 LOAD_CONST               0 (-1)
             15 LOAD_CONST               1 (None)
             18 IMPORT_NAME              2 (b)
             21 STORE_NAME               2 (b)

  3          24 LOAD_CONST               0 (-1)
             27 LOAD_CONST               2 (('c',))
             30 IMPORT_NAME              1 (mod)
             33 IMPORT_FROM              3 (c)
             36 STORE_NAME               3 (c)
             39 POP_TOP

  4          40 LOAD_CONST               0 (-1)
             43 LOAD_CONST               1 (None)
             46 IMPORT_NAME              4 (mod.d)
             49 LOAD_ATTR                5 (d)
             52 STORE_NAME               5 (d)
             55 LOAD_CONST               1 (None) 
```

最后它们看起来是一样的（STORE_NAME 是每个示例中的结果），但是如果您需要考虑以下四个循环导入，请注意这一点：

## 示例1

```
foo/
   __init__.py
   a.py
   b.py 
```

```
a.py:
import foo.b 
```

```
b.py:
import foo.a 
```

```
>>> import foo.a
>>> 
```

这有效

## 示例2

```
bar/
   __init__.py
   a.py
   b.py 
```

```
a.py:
import bar.b as b 
```

```
b.py:
import bar.a as a 
```

```
>>> import bar.a
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "bar\a.py", line 1, in <module>
    import bar.b as b
  File "bar\b.py", line 1, in <module>
    import bar.a as a
AttributeError: 'module' object has no attribute 'a' 
```

没有骰子

## 示例3

```
baz/
   __init__.py
   a.py
   b.py 
```

```
a.py:
from baz import b 
```

```
b.py:
from baz import a 
```

```
>>> import baz.a
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "baz\a.py", line 1, in <module>
    from baz import b
  File "baz\b.py", line 1, in <module>
    from baz import a
ImportError: cannot import name a 
```

类似的问题......但显然 from x import y 与 import import xy as y 不同

## 例子4

```
qux/
   __init__.py
   a.py
   b.py 
```

```
a.py:
import b 
```

```
b.py:
import a 
```

```
>>> import qux.a
>>> 
```

这个也有效

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2020-04-13T04:22:53.100

正如*Jan Wrobel*所提到的，不同进口的一个方面是进口的披露方式。

模块**之谜**

```
from math import gcd
... 
```

使用**mymath**：

```
import mymath
mymath.gcd(30, 42)  # will work though maybe not expected 
```

如果我只导入`gcd`供内部使用，不向用户透露`mymath`，这可能会很不方便。我经常遇到这种情况，在大多数情况下，我想“保持我的模块干净”。

除了*Jan Wrobel*的提议通过使用来掩盖这一点之外`import math`，我已经开始通过使用前导下划线来隐藏导入：

```
# for instance...
from math import gcd as _gcd
# or...
import math as _math 
```

在较大的项目中，这种“最佳实践”允许我准确控制向后续导入披露的内容和不披露的内容。这使我的模块保持清洁并在一定规模的项目中得到回报。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2020-07-08T13:34:51.647

因为很多人在这里回答，但我只是尽力而为:)

1.  `import module`当您不知道必须从哪个项目导入时最好`module`。这样在出现问题时可能很难调试，因为您不知道哪个项目有问题。

2.  `form module import <foo>`当您知道需要导入哪个项目并且根据您的需要使用导入特定项目来帮助进行更多控制时，这是最好的选择。使用这种方式调试可能很容易，因为您知道您导入了哪个项目。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-01-20T05:51:40.553

导入模块 - 您不需要额外的努力来从模块中获取另一个东西。它有诸如冗余打字等缺点

模块导入自 - 更少输入和更多控制可以访问模块的哪些项目。要使用模块中的新项目，您必须更新导入语句。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-07-17T12:23:28.527

有一些内置模块主要包含裸函数（[base64](https://docs.python.org/3/library/base64.html)，[math](https://docs.python.org/3/library/math.html)，[os](https://docs.python.org/3/library/os.html)，[shutil](https://docs.python.org/3/library/shutil.html)，[sys](https://docs.python.org/3/library/sys.html)，[time ，...），将这些裸函数](https://docs.python.org/3/library/time.html)*绑定*到某个命名空间绝对是一个好习惯，从而提高您的可读性代码。考虑一下在没有命名空间的情况下理解这些函数的含义是多么困难：

```
copysign(foo, bar)
monotonic()
copystat(foo, bar) 
```

比它们绑定到某个模块时：

```
math.copysign(foo, bar)
time.monotonic()
shutil.copystat(foo, bar) 
```

有时您甚至需要命名空间来避免不同模块之间的冲突（[json.load](https://docs.python.org/3/library/json.html#json.load)与[pickle.load](https://docs.python.org/3/library/pickle.html#pickle.load)）

* * *

另一方面，有些模块主要包含类（[configparser](https://docs.python.org/3/library/configparser.html)，[datetime](https://docs.python.org/3/library/datetime.html)，[tempfile](https://docs.python.org/3/library/tempfile.html)，[zipfile](https://docs.python.org/3/library/zipfile.html)，...），其中许多模块的类名足以不言自明：

```
configparser.RawConfigParser()
datetime.DateTime()
email.message.EmailMessage()
tempfile.NamedTemporaryFile()
zipfile.ZipFile() 
```

因此，在代码中使用这些带有附加模块命名空间的类是否会添加一些新信息或只是延长代码可能会存在争议。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2021-02-03T22:25:15.347

我正在回答一个类似的问题帖子，但在我发布之前，海报将其删除。这里有一个例子来说明差异。

Python 库可能有一个或多个文件（模块）。例如，

```
package1
  |-- __init__.py 
```

或者

```
package2
  |-- __init__.py
  |-- module1.py
  |-- module2.py 
```

我们可以在*任何*基于设计要求的文件中定义 python 函数或类。

让我们定义

1.  `func1()`在下 `__init__.py`，`mylibrary1`并且
2.  `foo()`在下。`module2.py`_`mylibrary2`

我们可以`func1()`使用这些方法之一访问

```
import package1

package1.func1() 
```

或者

```
import package1 as my

my.func1() 
```

或者

```
from package1 import func1

func1() 
```

或者

```
from package1 import *

func1() 
```

我们可以使用其中一种方法来访问`foo()`：

```
import package2.module2

package2.module2.foo() 
```

或者

```
import package2.module2 as mod2

mod2.foo() 
```

或者

```
from package2 import module2

module2.foo() 
```

或者

```
from package2 import module2 as mod2

mod2.foo() 
```

或者

```
from package2.module2 import *

foo() 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2021-06-14T17:59:23.573

有很多答案，但没有一个提到测试（使用`unittest`or `pytest`）。

# tl;博士

用于`import foo`外部模块以简化测试。

# 艰难的道路

从模块中单独导入类/函数 ( `from foo import bar`) 会使红绿重构周期变得乏味。例如，如果我的文件看起来像

```
# my_module.py

from foo import bar

class Thing:
    def do_thing(self):
        bar('do a thing') 
```

我的测试是

```
# test_my_module.py

from unittest.mock import patch
import my_module

patch.object(my_module, 'bar')
def test_do_thing(mock_bar):
    my_module.Thing().do_thing()
    mock_bar.assert_called_with('do a thing') 
```

乍一看，这似乎很棒。但是如果我想`Thing`在不同的文件中实现类会发生什么？我的结构必须像这样改变......

```
# my_module.py

from tools import Thing

def do_thing():
    Thing().do_thing()

# tools.py

from foo import bar

class Thing:
    def do_thing(self):
        bar('do a thing')

# test_my_module.py

from unittest.mock import patch
import my_module
import tools  # Had to import implementation file...

patch.object(tools, 'bar')  # Changed patch
def test_do_thing(mock_bar):
    my_module.do_thing()  # Changed test (expected)
    mock_bar.assert_called_with('do a thing') 
```

不幸的是，由于我使用`from foo import bar`了 ，我需要更新我的补丁以引用该`tools`模块。本质上，由于我的测试对实现了解太多，因此需要进行比预期更多的更改才能进行此重构。

# 更好的方法

使用`import foo`，我的测试可以忽略模块的实现方式并简单地修补整个模块。

```
# my_module.py

from tools import Thing

def do_thing():
    Thing().do_thing()

# tools.py

import foo

class Thing:
    def do_thing(self):
        foo.bar('do a thing')  # Specify 'bar' is from 'foo' module

# test_my_module.py

from unittest.mock import patch
import my_module

patch('foo')  # Patch entire foo module
def test_do_thing(mock_foo):
    my_module.do_thing()  # Changed test (expected)
    mock_foo.bar.assert_called_with('do a thing') 
```

你的测试知道的实现细节越少越好。这样，如果你想出一个更好的解决方案（使用类而不是函数，使用额外的文件来分离想法等），你的测试中需要更改的内容更少以适应重构。

# web-services - 从 C++ 调用 web 方法

> ID：710552
> 
> 赞同：0
> 
> 时间：2009-04-02T16:40:53.190
> 
> 标签：web-services, httprequest, wininet

我正在从 C++ 调用网络方法。[webmthod] 定义如下

```
[WebMethod]
public string UploadFile(byte[] data) 
```

这是我在 C++ 中的调用方式

```
 static TCHAR hdrs[] = "Content-Type: application/x-www-form-urlencoded";
     static TCHAR frmdata[] = "data=temp.txt";
  HINTERNET hSession = InternetOpen("MyAgent",INTERNET_OPEN_TYPE_PRECONFIG, NULL, NULL, 0);
  HINTERNET hConnect = InternetConnect(hSession, "localhost",
      INTERNET_DEFAULT_HTTP_PORT, NULL, NULL, INTERNET_SERVICE_HTTP, 0, 1);
  HINTERNET hRequest = HttpOpenRequest(hConnect, "POST", "my/WebService.asmx/UploadFile", NULL, NULL, 0, 0, 1);
  HttpSendRequest(hRequest, hdrs, strlen(hdrs), frmdata, strlen(frmdata)); 
```

有了这个; 我收到以下错误。

System.ArgumentException：无法将 temp.txt 转换为 System.Byte。

那么如何传入 frmdata[] 以便将其转换为 Web 服务上的 System.byte 呢？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T21:03:48.013

我最终从 C++ 进行 HTTP UPLOAD ..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-01T00:00:18.977

供将来参考：考虑使用 ATL Server。您可以在 www.codeplex.com/AtlServer（Microsoft 将 ATL Server 从最新的 ATL 9.0 SDK 中移除并将其移至 codeplex）和 MSDN 上找到最新信息和更多信息：msdn.microsoft.com/en-us/library/exb5b09w (VS.80).aspx

对于 C++，您可以生成一个代理头文件，该文件巧妙地包装了使用 ATL soap 调用 Web 方法所需的所有内容，以及您希望处理所有网络调用的任何 ATL Soap 客户端（WinInet、WinHTTP、Soap Socket 等）。要生成此文件，您可以使用 sproxy.exe 工具。那么web方法调用就变成了简单的类方法调用。

参考：msdn.microsoft.com/en-us/library/994721ak(VS.80).aspx Sproxy 工具：msdn.microsoft.com/en-us/library/ztta389h(VS.80).aspx WS 调用示例：msdn .microsoft.com/en-us/library/ftdya1d6(VS.80).aspx

# visual-studio - 我应该如何在我的项目中设置运行时外部资源？

> ID：710555
> 
> 赞同：1
> 
> 时间：2009-04-02T16:41:45.713
> 
> 标签：visual-studio, project

我正在创建一个命令行程序，它在运行时使用一组定义的外部文件（.txts 等）。我需要它在运行时将这些放在其工作目录中。目前，我将它们放在 solutiondir 的一个文件夹中，并将 xcopy 作为预构建事件放入 projectdir 中。设置这种情况的“公认”方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T18:28:07.160

如果它是一个 .net 项目，那么您可以将这些文件标记为复制到输出目录。
在 c++ 土地（vcproj）中，您需要使用 Pre/Post 构建步骤并将它们复制到 $(TargetDir)/$(ProjectDir)

# mysql - g++/mysql/redhat 中的 int 问题

> ID：710564
> 
> 赞同：0
> 
> 时间：2009-04-02T16:43:32.700
> 
> 标签：mysql, c, api, initialization

我已经有一段时间没有写过 C 语言了，我正在使用 MySQL C API 编写一个应用程序，在 redhat 上用 g++ 编译。

所以我开始用 printfs 输出一些字段......使用我曾经使用过的（在 suse 上，几年前）使用 oracle api 和 PRO*C，我可以选择一个 int 并将其输出为：

```
int some_int;
printf("%i",some_int);

```

我尝试使用 mysql ints 来执行此操作，但显示了 8 个随机数......我认为这是一个 mysql api 问题和我的服务器的一些配置问题，我浪费了几个小时试图修复它，但不能，并发现我可以这样做：

```
int some_int;
printf("%s",some_int);

```

它会正确打印出整数。因为我没有对我提取的值进行计算，所以我认为这是一个不错的解决方案。

直到我试图计算一些东西......

我做了一个简单的：

```
整数行数；
对于（[stmt]）{
行数++；
}
printf("%i",rowcount);

```

我又得到了一个 8 位随机数……我不知道这台机器上的整数是怎么回事。

然后我意识到，如果我将 int 初始化为零，那么我会得到一个正确的数字。

有人可以向我解释一下在什么条件下需要将 int 变量初始化为零？我不记得每次在我的旧代码库中都这样做，而且我在示例中没有看到它，我正在建模我的 mysql_stmt 代码......

有什么我想念的吗？另外，我完全有可能忘记了每次都是必需的

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T16:45:45.300

如果您不初始化变量，则无法保证默认的 0/NULL/任何值。一些编译器可能会为您将其初始化为 0（IIRC、MSVC++ 6.0 会很好地这样做），而其他编译器可能不会。所以不要依赖它。永远不要在没有先给它某种理智值的情况下使用变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T16:48:32.577

只有全局和静态值将被初始化为零。如果未初始化，堆栈上的变量将始终包含垃圾值。

```
int g_var; //This is a global varibale. So, initialized to zero
int main()
{

int s_var = 0; //This is on stack. So, you need to explicitly initialize
static int stat_var;  //This is a static variable,  So, initialized to zero
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T16:56:24.447

你总是需要初始化你的变量。要捕获此类错误，您可能应该编译`-Wall`为给您所有`g++`可以提供的警告。我也更喜欢用它`-Werror`来制造所有警告错误，因为警告几乎总是指示错误或潜在错误，并且清理代码比保持原样更好。

此外，在您的第二个 printf 中，您使用`%s`的是用于打印字符串，而不是整数。

```
int i = 0;
printf("%d\n", i);
// or
printf("%i\n", i); 
```

是你想要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T16:46:26.250

变量不会在 c 中自动初始化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T16:46:59.383

你确实忘记了。在 C 和 C++ 中，您不会得到任何自动初始化；`c`after的内容`int c;`是当时所指的地址中的任何内容`c`。

最佳实践：在定义处初始化：`int c = 0;`.

哦，PS，请注意 MySQL int 类型与 C int 类型匹配；我认为确实如此，但我并不积极。但是，它对架构和编译器都敏感，因为`sizeof(int)`在所有 C 环境中都不相同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T16:50:37.800

未初始化的变量。

```
int some_int = 0; 
```

# sql - 使用存储过程查找“翻转”序列中的最后一个值？

> ID：710566
> 
> 赞同：0
> 
> 时间：2009-04-02T16:45:17.267
> 
> 标签：sql, string, series

假设我有一组固定长度的字母字符标识符，例如总是五个字母，并且它们的分配方式总是按顺序递增（GGGGZ --> GGGHA 等）。现在，如果我到达 ZZZZZ，由于长度是固定的，我必须“翻转”到 AAAAA。我可能有一个从 ZZZAA 到 AAAAM 的连续街区。我想写一个存储过程，它会给我“下一个”标识符，在这种情况下是 AAAAN。

如果我没有这个“翻转”问题，当然，我只会按 DESC 排序并获得最佳结果。但是我现在有点不知所措——SQL 不是我最擅长的语言，这根本没有帮助。

如果*必须*，我可以将其移至我的 C# 调用代码，但存储过程会更合适。

ETA：我想避免更改架构（新列*或*新表）；我宁愿只是能够“弄清楚”。我什至可能更喜欢蛮力（例如从最低值开始并增加直到我找到一个“洞”），即使这可能会变得昂贵。如果您有一个不修改架构的答案，那将是满足我需求的更好解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T21:08:46.477

这是我认为可以为您提供 Next 价值的代码。我创建了 3 个函数。该表只是我使用您的 alpha id 对 table.column 的模拟（我使用了 MyTable.AlphaID）。我假设它正如您所暗示的那样，并且有一个由五个字符的大写字母字符串 (AlphaID) 组成的连续块：

```
IF OBJECT_ID('dbo.MyTable','U') IS NOT NULL
    DROP TABLE dbo.MyTable
GO
CREATE TABLE dbo.MyTable (AlphaID char(5) PRIMARY KEY)
GO
-- Play with different population scenarios for testing
INSERT dbo.MyTable VALUES ('ZZZZY')
INSERT dbo.MyTable VALUES ('ZZZZZ')
INSERT dbo.MyTable VALUES ('AAAAA')
INSERT dbo.MyTable VALUES ('AAAAB')
GO
IF OBJECT_ID('dbo.ConvertAlphaIDToInt','FN') IS NOT NULL
    DROP FUNCTION dbo.ConvertAlphaIDToInt
GO
CREATE FUNCTION dbo.ConvertAlphaIDToInt (@AlphaID char(5))
RETURNS int
AS
BEGIN
RETURN 1+ ASCII(SUBSTRING(@AlphaID,5,1))-65
              + ((ASCII(SUBSTRING(@AlphaID,4,1))-65) * 26)
              + ((ASCII(SUBSTRING(@AlphaID,3,1))-65) * POWER(26,2))
              + ((ASCII(SUBSTRING(@AlphaID,2,1))-65) * POWER(26,3))
              + ((ASCII(SUBSTRING(@AlphaID,1,1))-65) * POWER(26,4))
END
GO 

IF OBJECT_ID('dbo.ConvertIntToAlphaID','FN') IS NOT NULL
    DROP FUNCTION dbo.ConvertIntToAlphaID
GO
CREATE FUNCTION dbo.ConvertIntToAlphaID (@ID int)
RETURNS char(5)
AS
BEGIN
RETURN CHAR((@ID-1) / POWER(26,4) + 65)
      + CHAR ((@ID-1) % POWER(26,4) / POWER(26,3) + 65)
      + CHAR ((@ID-1) % POWER(26,3) / POWER(26,2) + 65)
      + CHAR ((@ID-1) % POWER(26,2) / 26 + 65)
      + CHAR ((@ID-1) % 26 + 65)

END
GO 
IF OBJECT_ID('dbo.GetNextAlphaID','FN') IS NOT NULL
    DROP FUNCTION dbo.GetNextAlphaID
GO
CREATE FUNCTION dbo.GetNextAlphaID ()
RETURNS char(5)
AS
BEGIN
    DECLARE @MaxID char(5), @ReturnVal char(5)
    SELECT @MaxID = MAX(AlphaID) FROM dbo.MyTable
    IF @MaxID < 'ZZZZZ'
        RETURN dbo.ConvertIntToAlphaID(dbo.ConvertAlphaIDToInt(@MaxID)+1)
    IF @MaxID IS NULL
        RETURN 'AAAAA'
    SELECT @MaxID = MAX(AlphaID) 
    FROM dbo.MyTable 
    WHERE AlphaID < dbo.ConvertIntToAlphaID((SELECT COUNT(*) FROM dbo.MyTable))
    IF @MaxID IS NULL
        RETURN 'AAAAA'
    RETURN dbo.ConvertIntToAlphaID(dbo.ConvertAlphaIDToInt(@MaxID)+1)
END
GO

SELECT * FROM dbo.MyTable ORDER BY dbo.ConvertAlphaIDToInt(AlphaID)
GO
SELECT  dbo.GetNextAlphaID () AS 'NextAlphaID' 
```

顺便说一句，如果您不想假设连续，您可以按照您的建议进行操作，并且（如果有“ZZZZZ”行）使用序列中的第一个间隙。用这个替换最后一个函数：

```
IF OBJECT_ID('dbo.GetNextAlphaID_2','FN') IS NOT NULL
    DROP FUNCTION dbo.GetNextAlphaID_2
GO
CREATE FUNCTION dbo.GetNextAlphaID_2 ()
RETURNS char(5)
AS
BEGIN
    DECLARE @MaxID char(5), @ReturnVal char(5)
    SELECT @MaxID = MAX(AlphaID) FROM dbo.MyTable
    IF @MaxID < 'ZZZZZ'
        RETURN dbo.ConvertIntToAlphaID(dbo.ConvertAlphaIDToInt(@MaxID)+1)
    IF @MaxID IS NULL
        RETURN 'AAAAA'
    SELECT TOP 1 @MaxID=M1.AlphaID
    FROM dbo.Mytable M1
    WHERE NOT EXISTS (SELECT 1 FROM dbo.MyTable M2 
                      WHERE AlphaID = dbo.ConvertIntToAlphaID(dbo.ConvertAlphaIDToInt(M1.AlphaID) + 1 )
                     )
    ORDER BY M1.AlphaID
    IF @MaxID IS NULL
        RETURN 'AAAAA'
    RETURN dbo.ConvertIntToAlphaID(dbo.ConvertAlphaIDToInt(@MaxID)+1)
END
GO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T16:52:59.260

您必须在序列中存储最后分配的标识符。

例如，将其存储在另一个具有一列一行的表中。

```
CREATE TABLE CurrentMaxId (
    Id CHAR(6) NOT NULL
);

INSERT INTO CurrentMaxId (Id) VALUES ('AAAAAA'); 
```

每次你分配一个新的标识符时，你都会在那个小表中获取值，增加它，然后将该值存储在你的主表中，并更新`CurrentMaxId`.

通常的警告适用于并发、表锁定等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T16:53:25.467

我想我会尝试将序列存储为整数，然后将其转换为字符串。或者存储一个与 alpha 值同时递增的并行整数列。无论哪种方式，您都可以对整数列进行排序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T17:16:52.620

这里的一个问题是，除非有更多关于如何删除旧条目的详细信息，否则您无法从数据中真正分辨出“最后一个”条目在哪里。

如果我理解正确，您将在序列结束时回绕，这意味着您必须删除一些旧数据以腾出空间。但是，如果数据没有以完全统一的方式删除，您最终会得到片段，如下所示：

```
ABCD   HIJKL NOPQRS   WXYZ 
```

您会注意到没有明显的下一个值...D 可能是最后创建的值，但也可能是 L 或 S。

充其量您可以查找第一个或最后一个缺失元素（使用存储过程执行 x+1 检查，就像在整数序列中查找缺失元素一样），但它不会为rolled 提供任何特殊结果-over 列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T18:23:40.913

因为我不想编写代码来增加字母，所以我会创建一个包含所有有效 ID（AAAAAA 到 ZZZZZZ）的表，其中这些 ID 的整数从 1 到 X。然后，您可以使用以下内容：

```
SELECT @max_id = MAX(id) FROM Possible_Silly_IDs

SELECT
    COALESCE(MAX(PSI2.silly_id), 'AAAAAA')
FROM
    My_Table T1
INNER JOIN Possible_Silly_IDs PSI1 ON
    PSI1.silly_id = T1.silly_id
INNER JOIN Possible_Silly_IDs PSI2 ON
    PSI2.id = CASE WHEN PSI1.id = @max_id THEN 1 ELSE PSI1.id + 1 END
LEFT OUTER JOIN My_Table T2 ON
    T2.silly_id = PSI2.silly_id
WHERE
    T2.silly_id IS NULL 
```

如果表为空，则 COALESCE 就在那里。为了真正强大，您应该计算 'AAAAAA' (SELECT @min_silly_id = silly_id WHERE id = 1)，以防您的“编号”算法发生变化。

如果你真的想把事情做对，你会按照建议重做数据库设计。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T17:53:15.910

要返回`ID`给定的下一个`ID`（带有翻转），请使用：

```
SELECT  COALESCE
        (
        (
        SELECT  TOP 1 id
        FROM    mytable
        WHERE   id > @id
        ORDER BY
                id
        ),
        (
        SELECT  TOP 1 id
        FROM    mytable
        ORDER BY
                id
        )
        ) AS nextid 
```

此查询搜索`ID`给定的下一个。如果没有`ID`，则返回第一个`ID`。

结果如下：

```
WITH mytable AS
        (
        SELECT  'AAA' AS id
        UNION ALL
        SELECT  'BBB' AS id
        UNION ALL
        SELECT  'CCC' AS id
        UNION ALL
        SELECT  'DDD' AS id
        UNION ALL
        SELECT  'EEE' AS id
        )
SELECT  mo.id,
        COALESCE
        (
        (
        SELECT  TOP 1 id
        FROM    mytable mi
        WHERE   mi.id > mo.id
        ORDER BY
                id
        ),
        (
        SELECT  TOP 1 id
        FROM    mytable mi
        ORDER BY
                id
        )
        ) AS nextid
FROM    mytable mo

id      nextid
-----   ------
AAA     BBB
BBB     CCC
CCC     DDD
DDD     EEE
EEE     AAA 
```

, 即它返回`BBB`for `AAA`, `CCC`for`BBB`等, 最后, `AAA`for`EEE`是表中的最后一个。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T13:18:25.723

我认为对我的需求影响最小的解决方案是添加一个标识列。我可以保证的一件事是，排序将首先添加应该“首先出现”的条目——我永远不会添加带有标识符 BBBB 的条目，然后再返回并稍后添加 BBBA。如果我没有那个约束，显然它不会起作用，但就目前而言，我可以按标识列排序并获得我想要的排序。

我会继续考虑其他建议——也许如果它们在我脑海中“点击”，它们看起来会是一个更好的选择。

# objective-c - 一些初学者的 Objective-C/iPhone 问题

> ID：710568
> 
> 赞同：7
> 
> 时间：2009-04-02T16:45:20.200
> 
> 标签：objective-c, iphone

我刚刚开始（过去几天读了很多书）。这是我收集的一些问题，希望有人能回答。

**1.** (self != nil) 签入初始化代码。为什么这样做？为了防止意外访问包含在其中的一些“只运行一次”代码？这种意外访问是从哪里来的？进行此类检查表明我无法控制正在发生的事情。

```
`- (id)init {
    self = [super init]
    if (self != nil) {
    // Code..
    }
    return self;
}` 
```

`**2.**你如何不必释放静态方法返回的任何东西？（或者这就是我的想法）`

 `**3.** str = @"Hi there!" 怎么样？不同于

```
`str = [[NSString alloc] initWithString:@"Hi there!"];`
```

`据我了解，您必须使用第二种方法释放 str ，而不是第一种？如果是这样，第一个什么时候发布？哪一个更可取（不介意打字长度）？`

 `**4.**什么是autorelease，如果iphone没有垃圾回收？我注意到在 main.m 中创建了一个叫做“自动释放池”的东西。是 [myObject 自动释放]; 一种将 myObject 添加到最近的包装“自动释放池”的方法，它将释放它？基本上，有一些魔法可以避免自己释放它？为什么要使用它？

嗯，这就是现在。感谢您的任何回答！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T19:32:44.197

1.  在 Objective-C 中，可以从`-init`. 例如，类执行此操作以强制执行单例实例，或者在类集群的情况下。`NSNumber`例如，根据传递给其初始化程序的值的类型返回一个子类。因此，当您调用 时`[[NSNumber alloc] initWithLong:long_value]`，会在's之后调用`NSNumber`'s`-initWithLong:`初始化程序，但可能会将 的子类返回给原始调用者。因此模式`NSNumber``+alloc``NSNumber`

    self = [超级初始化];

    它重新分配`self`给的值，`[super init]`以便`self`指向`[super init]`返回的实际实例。如果`+alloc`或 super 的`init`方法失败，结果`[super init]`可能是`nil`. 为了避免在初始化失败的情况下产生副作用，模式就变成了

    > ```
    > - (id) init {
    >   if(self = [super init]) {
    >     // do initialization of instance variables etc.
    >   }
    > 
    >   return self;
    > } 
    > ```

    请注意，您必须从该方法返回`self`（或`nil`其他实例） 。`init`您*应该*将 self 分配给，并且您可以在做更多工作之前进行`[super init]`检查。`nil`

2.  您可能必须释放静态方法的返回值。您应该阅读 Cocoa 内存管理[指南](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)。规则通常很简单：如果您调用的方法在其签名中包含“new”、“alloc”或“copy”，则结果属于调用者，调用者必须调用`-release`该实例，否则将出现内存泄漏. 当然，您应该调用`-retain`您想要保留引用的其他任何内容（即不是来自“alloc”、“new”或“copy”方法），然后调用`-release`或`-autorelease`在完成该实例时调用。

3.  `str = @"Hi there!"`，假设`str`被声明为`NSString *str;`分配字符串常量的地址`@"Hi there!" to the value of the`str `variable. You do not need to retain or release string constants.`str = [[NSString alloc] initWithString:@"Hi there!"]; `allocates a new string instance. The value of`str `will be the address of this instance. Each call of`str = [[NSString alloc] initWithString:@"你好！"]; `again will allocate a new instance. So after`str2 = [[NSString alloc] initWithString:@"你好！"]; `,`str != str2 `, while after`str2 = @"你好！", `str==str2`. 也请参阅[此](https://stackoverflow.com/questions/706519/is-an-nsmutablestring-in-this-case-more-efficient-than-nsstring/706610#706610)答案。

4.  `-autorelease`将接收器添加到当前`NSAutoreleasPool`. 当池被耗尽时（通常在当前运行循环迭代结束时，或者当池被手动耗尽时），池调用池中`-release`的所有实例。如果这`-release`将保留计数降至 0，则该对象将被释放（并`-dealloc`调用），就像任何其他`-release`. 在 iPhone 上使用自动释放池通常是不受欢迎的，因为它可能会导致您在池中积累许多未使用的实例，然后在运行循环迭代结束时将其耗尽。如果您可以使用`-release`代替`-autorelease`，则通常应该使用。再次，请参阅 Cocoa 内存管理[指南](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)以获取更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T18:23:11.633

1.  有一种观点认为，在大多数情况下，分配`self`指针是系统应该做的事情，而不是程序员。

此外，许多人更喜欢保持程序流的主线尽可能不缩进。在这种情况下，初始化代码可以重写为：

```
- (id)init {
    if (![super init]) {
        return nil; // There is a problem so bail early.
    }
    // Initialisation code here.
    return self
} 
```

[Will Shipley](http://www.wilshipley.com/blog/2005/07/self-stupid-init.html)比我更好地解释了这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T16:56:41.047

1：这个检查是为了确保超级构造函数返回一个新对象。

2：静态方法不引用实例

3：

`str = @"Hi there!"`

这将分配常量字符串“Hi there!”的地址。到指针 str

`str = [[NSString alloc] initWithString:@"Hi there!"];`

这会分配一个字符串并复制“Hi There!” 给它。这意味着 a) str 是可修改的，并且 b) 需要在完成后释放它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T16:58:12.337

打电话

```
self = [super init]; 
```

如果超类由于某种原因（包括内存不可用或某些先决条件未满足）无法初始化自身，则可能返回 nil。如果是这种情况，您不想尝试设置 self 的变量，或者将 self 设置为委托，或者如果 self 为 nil，则将 self 添加到数组中。

自动释放池是在 iPhone 向您的应用程序发送的每个事件时创建的。它在任何代码运行之前创建，并在所有代码完成后针对每个事件发布。您调用的任何对象都`autorelease`将被放入当前的自动释放池中。代码完成后，自动释放池中的任何对象将被释放的次数与添加的次数相同。这样，您就不必担心谁负责释放由一种方法创建的对象并返回给另一种方法。

您可以根据需要创建自己的自动释放池。

```
str = [[NSString alloc] initWithString:@"Hi there!"]; 
```

此行创建了一个不在自动释放池中的字符串，因此您必须手动释放它。简单地写

```
@"Hi there!"; 
```

返回一个您不必担心释放的字符串。扩展您之前的示例：

```
str = [[[NSString alloc] initWithString:@"Hi there!"] autorelease]; 
```

将是另一种创建字符串的方法，您无需担心释放。

垃圾收集和自动释放池之间的一个区别是垃圾收集使用循环引用。使用自动释放池，您不希望有两个相互保留的对象，并希望一旦没有其他对象引用它们，它们就会消失；他们不会。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T17:54:49.160

1.  如果在超级初始化之后*self*为零*，*那么你可能内存不足。你唯一合理的做法是返回 nil 并希望事情能在堆栈中更进一步得到优雅的处理。

2.  静态方法不允许在堆上分配，因此没有什么可以释放的。

3.  在第一种情况下，字符串被编译到你的应用程序的数据段中并且不能被释放。在第二种情况下，您从堆中分配内存并将静态字符串（从数据段）复制到其中。

4.  这是简单的垃圾收集。至于为什么要使用它，简单的答案是不要。由于资源有限，不建议在 iPhone 上使用 autorelease。

# jquery - 使用 Html、CSS 和 JQuery 自动调整出发板大小

> ID：710570
> 
> 赞同：2
> 
> 时间：2009-04-02T16:46:04.737
> 
> 标签：jquery, css, xhtml

我必须在工作中开发一个自动缩放到达和离开板。

我创建了一个基于百分比的列宽（并且整个表格为 100% 宽度）的表格，这很容易开始。

现在，我有一小段 JQuery 可以让我更改文本的比例，但这只是为了证明这个概念。

我真的很想根据可用的屏幕宽度和高度自动缩放字体和表格单元格的大小。我确实知道每个列单元格允许的最大字符串长度，因此我可能会根据一些计算自动设置 em/px 大小。

但是，我有点不知道从哪里开始。我现在正在积极开发这个，但我最初的想法是：

scale = maxstringwidth_inpx / currentcellwidth_inpx

我将通过查找表和屏幕上大小为 1em 的字符的字体度量来计算 maxstringwidth。

这些单元格都分配了屏幕百分比，所以我应该能够直接阅读这些。

然后我可以设置字体大小，即：

```
$("body").css("font-size", currentfontsize_px * scale); 
```

这听起来是一种可行的方法吗？它还提出了有关每个单元格中每个字符串上方和下方的填充的问题，但我相信我也可以在那里做一些类似的事情。

要符合我被困的地方：

1.  在野外有这种事情的例子吗（我找不到）
2.  我的方法有缺陷吗？
3.  你以前做过并且可以分享智慧/技术吗？
4.  我是否已经在自己的脚下开枪了，应该考虑另一种方法吗？

我已经提到使用 Flash 到 PM 作为自动缩放文本的一种方式，因为我们可以在 ActionScript 中执行很多字体度量。但是，我只是刚开始使用 .NET flash IDE，所以我仅限于作为开发平台。

感谢您提供任何提示、示例和建议！

西蒙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T15:17:25.037

当涉及到这类事情时，CSS 和 HTML 可能会非常挑剔，尤其是因为字体大小在不同的计算机上可能会有很大的不同。举个例子，如果您使用的是字体，比如 Verdana。这是一种很常见的字体。不幸的是，Mac、Windows 和 Linux 呈现它的方式略有不同。真的没有办法保证“漂亮”（非等宽）字体的宽度/高度，除非应用程序将在非常严格控制的环境中使用。

我通常不支持使用 Flash，但是，如果这是一个选项，那么它确实是保证某些东西看起来符合预期的唯一方法，因为你可以嵌入字体，而且，就像你提到的那样，对排版有更多的控制Flash 比 CSS 中的要好。您将在 CSS 和 jQuery 中进行一些相当繁重的开发以实现相同的效果——即使如此，您仍然会在浏览器和操作系统之间遇到困难。

但是，如果您决定在 CSS/jQuery/HTML 中执行此操作，请确保您在任何地方都使用 em——没有像素。

祝你好运，让我们知道你最终决定做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T11:36:16.040

为了避免在不同操作系统/浏览器上出现不同字体大小的任何问题，您可以[使用 Javascript 计算文本宽度，](https://stackoverflow.com/questions/118241/calculate-text-width-with-javascript)以确保您开始缩放的基本大小是正确的。

# c# - 数据视图排序 - C#/ASP.NET

> ID：710573
> 
> 赞同：1
> 
> 时间：2009-04-02T16:46:14.330
> 
> 标签：c#, asp.net

我正在使用 DataView.Sort 对数据集中的列进行排序。默认情况下，这是否假定数据在进行排序时是字符串类型。如果是这样，我如何让它成为数据类型感知的？

**编辑：它如何推断数据类型？我正在从头开始创建数据集**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T16:49:21.767

`.Sort`将尊重列的数据类型。现在，如果您已经将该列转换为字符串类型以进行显示，那么您就有问题了。但如果它仍然是一个日期时间，那么你就可以了。

# php - 支持 ASP.NET 的 IIS 和支持 PHP 的 WAMP 可以在同一台服务器上共存吗？

> ID：710576
> 
> 赞同：2
> 
> 时间：2009-04-02T16:46:31.927
> 
> 标签：php, asp.net, apache, iis, wamp

支持 ASP.NET 的 IIS 和支持 PHP 的 WAMP 可以在同一台服务器上共存吗？

我们已经在 Windows Server 2003 机器上设置了 WAMP 堆栈以支持一些内部 PHP 应用程序，我还想在该机器上设置 CI 工厂，它将尝试配置 IIS 以支持其基于 ASP.NET 的仪表板。我想确保没有很大的机会破坏已经存在的 WAMP 堆栈。通过 Apache 处理 *.PHP 和通过 IIS 处理 *.aspx 是否足够聪明？

编辑：有没有办法让它在同一个端口上工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T16:49:44.603

是的。两者都将在 Windows 服务器的 IIS 下运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T16:51:05.380

这当然是可能的。我在我的开发机器上安装了 IIS+ASP+MSSQL 和 XAMPP (apache+PHP+MySQL)，它们都不会中断另一个人的工作。至少在使用不同的端口时

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-02T17:10:22.167

例如，非标准端口（例如 8080）上的 IIS 和 Apache 通过[mod_proxy](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)将流量重定向到 IIS 。

单独的虚拟主机：

```
<VirtualHost lamp.example.com>
  # standard vhost configuration
</VirtualHost>

<VirtualHost aspx.example.com>
  ProxyPass / aspx.example.com:8080
</VirtualHost> 
```

一个虚拟主机：

```
<VirtualHost www.example.com>
  ProxyPassMatch ^/(.*\.aspx) www.example.com:8080/$1

  # ... standard vhost configuration for LAMP
</VirtualHost> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T16:52:36.233

如前所述，是的。如果它有助于提供“真实世界的示例”，那么我目前托管我的网站的 GoDaddy 帐户为我提供了两个堆栈。我有几个基于 PHP/MySQL 的 SMF 论坛，我有一个基于 .NET 3.5/SQL Server 2005 的 Web 应用程序，它们运行良好。

# ruby-on-rails - 关闭 ActiveRecord 后如何进行单元测试？

> ID：710584
> 
> 赞同：2
> 
> 时间：2009-04-02T16:47:19.430
> 
> 标签：ruby-on-rails, unit-testing

我在环境配置中的 Rails 应用程序中关闭了 ActiveRecord：

```
Rails::Initializer.run do |config|
  config.frameworks -= [:active_record]
end 
```

我有不扩展 ActiveRecord::Base 的模型，我想对这些模型进行单元测试。当我运行测试时，我得到了`uninitialized constant ActiveRecord::Base`错误。

当我没有活动记录时，如何测试我的模型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T16:51:24.927

你可以作弊。将以下内容添加到您的测试中：

```
class ActiveRecord
    class Base
        end
    end 
```

但首先我建议追踪 ActiveRecord::Base 所指的内容。你认为你没有使用它，但你可能错了。

# javascript - JSON.stringify() 数组的怪异与 Prototype.js

> ID：710586
> 
> 赞同：89
> 
> 时间：2009-04-02T16:48:12.050
> 
> 标签：javascript, json, prototypejs

我试图弄清楚我的 json 序列化出了什么问题，让我的应用程序的当前版本与旧版本一起使用，并发现 JSON.stringify() 的工作方式存在一些令人惊讶的差异（使用来自 json.org 的 JSON 库）。

在我的应用程序的旧版本中：

```
 JSON.stringify({"a":[1,2]}) 
```

给我这个；

```
"{\"a\":[1,2]}" 
```

在新版本中，

```
 JSON.stringify({"a":[1,2]}) 
```

给我这个；

```
"{\"a\":\"[1, 2]\"}" 
```

知道什么可以改变以使相同的库在新版本中的数组括号周围加上引号？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2010-06-30T10:44:51.123

由于 JSON.stringify 最近已经与一些浏览器一起发布，我建议使用它而不是 Prototype 的 toJSON。然后，您将检查 window.JSON && window.JSON.stringify 并仅包含 json.org 库，否则（通过`document.createElement('script')`...）。要解决不兼容问题，请使用：

```
if(window.Prototype) {
    delete Object.prototype.toJSON;
    delete Array.prototype.toJSON;
    delete Hash.prototype.toJSON;
    delete String.prototype.toJSON;
} 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2011-07-07T13:10:42.750

[在ECMAScript 5 及更高版本（第 201 页 - JSON 对象，伪代码第 205 页](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-262%20edition%205.1,%20June%202011.pdf)）中定义的函数 JSON.stringify() 在对象上可用时使用函数 toJSON()。

因为 Prototype.js（或您正在使用的另一个库）定义了一个 Array.prototype.toJSON() 函数，所以首先使用 Array.prototype.toJSON() 将数组转换为字符串，然后使用 JSON.stringify() 引用字符串，因此数组周围的额外引号不正确。

因此，解决方案简单明了（这是 Raphael Schweikert 答案的简化版本）：

```
delete Array.prototype.toJSON 
```

这当然会对依赖于数组的 toJSON() 函数属性的库产生副作用。但考虑到与 ECMAScript 5 的不兼容，我发现这有点不便。

必须注意的是，ECMAScript 5 中定义的 JSON 对象在现代浏览器中得到了有效实现，因此最好的解决方案是符合标准并修改现有库。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-12-12T21:17:56.623

不会影响其他原型依赖项的可能解决方案是：

```
var _json_stringify = JSON.stringify;
JSON.stringify = function(value) {
    var _array_tojson = Array.prototype.toJSON;
    delete Array.prototype.toJSON;
    var r=_json_stringify(value);
    Array.prototype.toJSON = _array_tojson;
    return r;
}; 
```

这解决了 Array toJSON 与 JSON.stringify 的不兼容问题，并且还保留了 toJSON 功能，因为其他 Prototype 库可能依赖于它。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-02-10T18:32:20.467

编辑以使其更准确：

问题的关键代码位在 JSON.org 的 JSON 库中（以及 ECMAScript 5 的 JSON 对象的其他实现）：

```
if (value && typeof value === 'object' &&
  typeof value.toJSON === 'function') {
  value = value.toJSON(key);
} 
```

问题是原型库扩展了 Array 以包含一个 toJSON 方法，JSON 对象将在上面的代码中调用该方法。当 JSON 对象命中数组值时，它会在 Prototype 中定义的数组上调用 toJSON，并且该方法返回数组的字符串版本。因此，数组括号周围的引号。

如果您从 Array 对象中删除 toJSON，则 JSON 库应该可以正常工作。或者，只使用 JSON 库。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-08-25T10:25:34.197

我认为更好的解决方案是在原型加载后包含它

```
JSON = JSON || {};

JSON.stringify = function(value) { return value.toJSON(); };

JSON.parse = JSON.parse || function(jsonsring) { return jsonsring.evalJSON(true); }; 
```

这使得原型函数可作为标准 JSON.stringify() 和 JSON.parse() 使用，但如果可用，则保留本机 JSON.parse()，因此这使得它与旧浏览器更兼容。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-02T17:58:00.367

我对 Prototype 不是很流利，但我在它的[文档](http://www.prototypejs.org/api/object/toJSON)中看到了这一点：

```
Object.toJSON({"a":[1,2]}) 
```

不过，我不确定这是否会出现与当前编码相同的问题。

还有一个更长的[教程](http://www.prototypejs.org/learn/json)关于使用 JSON 和 Prototype。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-10-15T13:51:22.367

这是我用于同一问题的代码：

```
function stringify(object){
      var Prototype = window.Prototype
      if (Prototype && Prototype.Version < '1.7' &&
          Array.prototype.toJSON && Object.toJSON){
              return Object.toJSON(object)
      }
      return JSON.stringify(object)
} 
```

检查原型是否存在，然后检查版本。如果旧版本在所有其他情况下使用 Object.toJSON（如果已定义）则回退到 JSON.stringify()

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-02T17:36:49.530

这就是我的处理方式。

```
var methodCallString =  Object.toJSON? Object.toJSON(options.jsonMethodCall) :  JSON.stringify(options.jsonMethodCall); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-02-02T10:37:30.243

我的宽容解决方案检查 Array.prototype.toJSON 是否对 JSON stringify 有害，并在可能的情况下保留它，以让周围的代码按预期工作：

```
var dummy = { data: [{hello: 'world'}] }, test = {};

if(Array.prototype.toJSON) {
    try {
        test = JSON.parse(JSON.stringify(dummy));
        if(!test || dummy.data !== test.data) {
            delete Array.prototype.toJSON;
        }
    } catch(e) {
        // there only hope
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-11-08T07:50:22.870

正如人们所指出的，这是由于 Prototype.js - 特别是 1.7 之前的版本。我也遇到过类似的情况，但无论 Prototype.js 是否存在，我都必须编写运行代码；这意味着我不能只删除 Array.prototype.toJSON，因为我不确定它依赖于什么。对于这种情况，这是我想出的最佳解决方案：

```
function safeToJSON(item){ 
    if ([1,2,3] === JSON.parse(JSON.stringify([1,2,3]))){
        return JSON.stringify(item); //sane behavior
    } else { 
        return item.toJSON(); // Prototype.js nonsense
    }
} 
```

希望它会帮助某人。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-04-21T17:36:55.390

如果你不想杀死所有东西，并且有一个在大多数浏览器上都可以的代码，你可以这样做：

```
(function (undefined) { // This is just to limit _json_stringify to this scope and to redefine undefined in case it was
  if (true ||typeof (Prototype) !== 'undefined') {
    // First, ensure we can access the prototype of an object.
    // See http://stackoverflow.com/questions/7662147/how-to-access-object-prototype-in-javascript
    if(typeof (Object.getPrototypeOf) === 'undefined') {
      if(({}).__proto__ === Object.prototype && ([]).__proto__ === Array.prototype) {
        Object.getPrototypeOf = function getPrototypeOf (object) {
          return object.__proto__;
        };
      } else {
        Object.getPrototypeOf = function getPrototypeOf (object) {
          // May break if the constructor has been changed or removed
          return object.constructor ? object.constructor.prototype : undefined;
        }
      }
    }

    var _json_stringify = JSON.stringify; // We save the actual JSON.stringify
    JSON.stringify = function stringify (obj) {
      var obj_prototype = Object.getPrototypeOf(obj),
          old_json = obj_prototype.toJSON, // We save the toJSON of the object
          res = null;
      if (old_json) { // If toJSON exists on the object
        obj_prototype.toJSON = undefined;
      }
      res = _json_stringify.apply(this, arguments);
      if (old_json)
        obj_prototype.toJSON = old_json;
      return res;
    };
  }
}.call(this)); 
```

这看起来很复杂，但这仅在处理大多数用例时才复杂。主要思想是从作为参数传递的对象`JSON.stringify`中删除，然后调用 old ，最后恢复它。`toJSON``JSON.stringify`

# cvs - 如何在 CVS 中的文件已签入后添加执行权限？

> ID：710592
> 
> 赞同：14
> 
> 时间：2009-04-02T16:49:27.130
> 
> 标签：cvs

我们在 Linux 上使用 CVS 进行软件开发。

我注意到我正在处理的脚本之一缺少 CVS 存储库中设置的执行位。

有没有办法将执行位添加回文件？

我认为它涉及直接修改存储库，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-02T18:14:30.437

`,v`修改仓库中相关文件的权限。根据[本文](http://i-proving.com/space/Technologies/CVS/CVSROOT+and+file+permissions)`,v`，该文件以与CVSROOT中的文件相同的权限签出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-16T09:41:32.520

cvs 命令选项 watch 也阻止文件权限被恢复。如果观看，当文件被签出时，它将是只读的。从 cvs 手册页：

```
$ cvs watch --help_options

Usage: cvs watch {on|off|add|remove} [-lR] [-a <action>]... [<path>]...

on/off: turn on/off read-only checkouts of files 
```

因此，用于`cvs watch off filename`从存储库中删除签出，使其每次都只读。

# maven-2 - 如何备份 nexus 存储库管理器

> ID：710596
> 
> 赞同：24
> 
> 时间：2009-04-02T16:50:01.497
> 
> 标签：maven-2, backup, nexus

联系书： http: [//www.sonatype.com/books/nexus-book/reference/](http://www.sonatype.com/books/nexus-book/reference/)。似乎没有花任何时间在应该如何备份一个 nexus 存储库上。如果我将我的快照和版本安装到这个本地存储库中，我似乎应该备份它。但是，我对备份任何可以从远程存储库轻松下载的内容并不感兴趣。

一些谷歌搜索似乎也没有揭示规范的答案，因此也许可以将其记录在这里。

谢谢，内森

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-04-02T19:18:12.703

当你安装 Nexus 时，你会得到两个目录：

```
nexus-webapp-1.3.1.1/
sonatype-work/ 
```

我们已经将应用程序与数据和配置分开。Nexus 应用程序在`nexus-webapp-1.3.1.1/`，数据和配置在`sonatype-work/nexus`. 这样做主要是为了方便升级，但它也有一个副作用，就是让备份 Nexus 安装变得非常容易。

**简单的答案**

Nexus 不会将存储库存储在数据库中，也不会做任何会妨碍在`sonatype-work/nexus`. 如果您需要创建完整的备份，只需将`sonatype-work/nexus`.

**更好的答案**

如果您想要一种更智能的方法来备份 Nexus 安装，您肯定会想要备份`sonatype-work/nexus/conf`、`sonatype-work/nexus/storage`、 . 下的所有内容`sonatype-work/nexus/template-store`。如果要备份 Nexus 为代理存储库保留的元数据和文件属性，请备份`sonatype-work/nexus/proxy`，尽管这不是必需的，因为有关代理存储库的信息将在请求属性时按需生成。

您不需要备份`sonatype-work/nexus/logs`，也不需要将 Lucene 索引备份到`sonatype-work/nexus/indexer`.

**Nexus Pro 答案**

有一个 Nexus Professional 插件可以自动创建 Nexus 配置数据的备份。这个插件将解决`sonatype-work/nexus/conf`目录的内容。如果需要备份`sonatype-work/nexus/storage`目录，则需要配置一些备份系统来备份该文件系统的内容。再一次，与 Nexus Open Source 一样，目前备份`sonatype-work/nexus/indexer`or的内容并没有真正的好处`sonatype-work/nexus/logs`。

**排除远程存储库的存储**

在您的问题中，您提到要排除专门用于远程存储库的本地缓存的存储。如果您有兴趣这样做，您将不得不采取更高级别的粒度，并仅排除与`sonatype-work/nexus/storage`远程存储库相对应的目录。

**您是否需要关闭 Nexus 进行备份？**

Brian Fox 告诉我不，文件争用的唯一真正机会是目录中的文件`indexer/`。使用正在运行的 Nexus 实例备份 sonatype-work 文件系统应该没有问题。

顺便说一句，谢谢你的问题，这个答案可能会被纳入下一版本的 Nexus 书。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T19:07:50.277

afaik nexus（免费版）没有任何备份功能，但它应该很简单，就像知道您的公司 groupId 并从 nexus 的存储目录中获取它一样

但我也会安排完整的存储库备份，您永远不知道远程存储库何时关闭，何时最需要它们

# c++ - 如何在不读取格式化输入的情况下在 istream 上设置 EOF？

> ID：710604
> 
> 赞同：1
> 
> 时间：2009-04-02T16:52:14.940
> 
> 标签：c++

我正在使用 istream::get() 逐个字符地读取文件。我如何用一些东西来结束这个函数，以检查文件中是否没有任何东西可以读取（例如，只有空格）并设置相应的标志（EOF、坏等）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T17:45:23.410

`istream::sentry`在流上构造一个。这会有[一些副作用](http://www.cplusplus.com/reference/istream/istream/sentry/)，我们关心的是：

> 如果`skipws`设置了它的格式标志，并且构造函数没有`true`作为第二个参数 ( *noskipws* ) 传递，则所有前导*空白字符*（特定于语言环境的）都将被提取并丢弃。如果此操作耗尽了字符源，则该函数同时设置状态标志`failbit`和`eofbit` *内部状态标志*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-12T06:00:55.853

您可以随时通过读取到[`std::ws`](http://en.cppreference.com/w/cpp/io/manip/ws). 例如，如果我们从 STDIN 读取文件，我们会这样做：

```
std::cin >> std::ws 
```

四年后提出的这个问题的另一个版本的评论归功于[此评论。](https://stackoverflow.com/questions/15674177/remove-whitespace-from-input-stream-by-only-means-of-istream-functions#comment31958751_15741326)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-02T16:56:06.040

> 我如何用一些东西来结束这个函数，以检查文件中是否没有任何东西可以读取（例如，只有空格）？

空白字符是流中的字符。您不能假设流会为您进行智能处理。直到和除非，您编写自己的过滤流。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-03T02:27:28.490

默认情况下，所有格式化的提取操作（的重载）在提取项目*之前*`operator>>()`都会跳过空格——您确定要与这种方法分道扬镳吗？

 *如果是，那么您可能可以通过派生一个新类`my_istream`, from`istream`并覆盖每个类`operator>>()`以在最后调用以下方法来实现您想要的：

```
void skip_whitespace() {
    char ch;
    ios_base old_flags = flags(ios_base::skipws);
    *this >> ch;    // Skips over whitespace to read a character
    flags(old_flags);

    if (*this) {    // I.e. not at end of file and no errors occurred
        unget();
    }
} 
```

这是相当多的工作。我在这里省略了一些细节（例如更通用的解决方案是覆盖类模板这一事实`basic_istream<CharT, Traits>`）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-06T07:55:07.273

istream 不会有太大帮助 - 它按设计运行。但是，它将实际读取委托给流缓冲区。如果您的 streambuf 包装器修剪尾随空格，则从该 streambuf 读取的 istream 不会注意到它。

# c++ - Why do I get a segmentation fault when calling a virtual method in this code?

> ID：710607
> 
> 赞同：1
> 
> 时间：2009-04-02T16:52:54.970
> 
> 标签：c++, inheritance, polymorphism, segmentation-fault

I'm still learning C++; I was trying out how polymorphism works and I got a segmentation fault when calling a virtual method.

(Note: I didn't mark the destructor as virtual, I was just trying out to see what happens.) Here's the code:

```
#include <iostream>

using namespace std;

class Base
{
protected:
  char *name;

public:
  Base(char *name)
  {
    cout << name << ": Base class cons" << endl;
  }

  ~Base()
  {
    cout << name << ": Base class des" << endl;
  }

  virtual void disp();
};

void Base::disp()
{
  cout << name << ": Base disp()" << endl;
}

class Child : public Base
{
public:
  Child(char *name):
    Base(name)
  {
    cout << name << ": Child class cons" << endl;
  }

  ~Child()
  {
    cout << name << ": Child class des" << endl;
  }

  virtual void disp()
  {
    cout << name << ": Child disp()" << endl;
  }
};

int main()
{
  //Base b;
  //b.disp();
  Base c = Child("2");
  c.disp();
} 
```

Also, if you've any other tips regarding the usage of inheritance and polymorphism in general for someone who knows these concepts in Java, please let me know. Thank you!

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T16:56:45.180

name - is unintialized in Base

also you have another problem:

```
 Base c = Child("2"); 
```

I don't think it's what you want. Your code will create an instance of Base from casted Child. But I think you want work with Child instance based on Base interface; you should instead write:

```
 Base *c = new Child("2"); 
```

also, to avoid future bugs, declare destructor in base as virtual.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-02T16:57:28.423

You never initialise the base nenber variable - your base constructor should be:

```
Base(char * aname) : name( aname )
  {
    cout << name << ": Base class cons" << endl;
  } 
```

As well as that, when you say

```
Base b = Child( "xxx" ); 
```

then the Child instance will be sliced down to a Base, which is probably not what you want.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T16:54:51.220

I don't think you're assigning the member char * name to anything in your ctors.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T16:56:32.060

Whoa there.

There's a few problems, ~~but your segfault is probably because you're passing a `char*` -- which is just a pointer, and then trying to `cout` it in `disp()`. Problem is, that pointer does not live in `disp()`, it lives in `main()`. You probably want to either deep-copy the `char*`, or use `std::string`. Doing it this way will not work.~~

**EDIT**:

*See EDIT 2*

You can not just assign name to the class's `name` variable. If you do that, you'll get unpredictable results - and you'll probably STILL segfault. Remember: in C/C++, objects are locally scoped unless allocated on the heap. In this case, in your ctor, you'd want to do something like:

```
this->name = new char[ strlen( name ) + 1 ];
strcpy( this->name, name ); 
```

And in the destructor, you'll want to do something like:

```
delete [] this->name; 
```

Note: my syntax may be completely wrong, and I realize the above code is inherently unsafe as you're not checking the `char*` to make sure it's not NULL, and you're not checking the return value of `new.` Nevertheless, this should get you started.

**EDIT 2:** I stand corrected. String literals are treated as constant storage and thus live on for the duration of the program. *Nevertheless*, the lesson, I believe, is important: **in general, when not dealing with string literals**, passing a pointer (or array, etc.), you need to allocate storage for it and deep-copy. You also need to de-allocate appropriately when destroying said object.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T16:59:29.277

The Child::disp() method will never be called - c is a variable of type Base, and not a pointer or reference, so it won't check for virtual methods.

```
Base * c = new Child("1");
c->disp();
delete c; 
```

would call Child::disp().

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T17:06:33.643

There are few problems here. The first thing is your base class destructor has to be virtual. Otherwise your base class destructor will always be called even if it points to derived object. Second is you should not assign derived class object to base class object. This is called object slicing. So, assignment should be done through pointer or reference.

The segmentation problem is happening because it contains garbage value. You need to initialize it in the constructor.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T17:26:17.543

You have a couple of problems with your code.

First, and the reason why your getting a segfault, is the implementation of the Base ctor takes a parameter of the same name as one of the class' member variables:

```
class Base
{
protected:
  char *name;

public:
  Base(char ***name**)
  {
    cout << name << ": Base class cons" << endl;
  } 
```

The ctor's parameter 'name' [hides](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=/com.ibm.xlcpp8l.doc/language/ref/name_hiding.htm) the class' member variable of the same, erm... name.

Second, you are [slicing](https://stackoverflow.com/questions/274626/what-is-the-slicing-problem-in-c) your object here:

```
int main()
{
  //Base b;
  //b.disp();
  Base c = Child("2");
  c.disp();
} 
```

'c' is of type Base, and you are trying to assign a Child to it. All of the stuff that is unique to Child will be sliced off when you assign the ogbject to the base class.

Here is code that fixes both these problems:

```
#include <iostream>
#include <string>

using namespace std;

class Base
{
protected:
    std::string name_;

public:
  Base(char *name)
      : name_(name) {
    cout << name_ << ": Base class cons" << endl;
  }

  ~Base()
  {
    cout << name_ << ": Base class des" << endl;
  }

  virtual void disp();
};

void Base::disp()
{
  cout << name_ << ": Base disp()" << endl;
}

class Child : public Base
{
public:
  Child(char *name):
    Base(name)
  {
    cout << name_ << ": Child class cons" << endl;
  }

  ~Child()
  {
    cout << name_ << ": Child class des" << endl;
  }

  virtual void disp()
  {
    cout << name_ << ": Child disp()" << endl;
  }
};

int main()
{
  //Base b;
  //b.disp();
  Base * c = new Child("2");
  c->disp();
  delete c;
} 
```

# python - 在运行时检查 Python 模块版本

> ID：710609
> 
> 赞同：134
> 
> 时间：2009-04-02T16:53:08.387
> 
> 标签：python, module, version

许多第三方 Python 模块都有一个保存模块版本信息的属性（通常类似于`module.VERSION`or `module.__version__`），但有些没有。

此类模块的特定示例是 libxslt 和 libxml2。

我需要检查这些模块的正确版本是否在运行时使用。有没有办法做到这一点？

一个潜在的解决方案是在运行时读取源代码，对其进行哈希处理，然后将其与已知版本的哈希值进行比较，但这很讨厌。

有没有更好的解决方案？

* * *

## 回答 #1

> 赞同：258
> 
> 时间：2011-02-08T22:54:17.217

使用[pkg_resources](https://pythonhosted.org/setuptools/pkg_resources.html)。从 PyPI 安装的任何东西至少应该有一个版本号。

```
>>> import pkg_resources
>>> pkg_resources.get_distribution("blogofile").version
'0.7.1' 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2019-02-25T15:37:07.457

如果您使用的是 python `>=3.8`，则可以使用内置库中的模块。要检查包的版本（在此示例中`lxml`），请运行：

```
>>> from importlib.metadata import version
>>> version('lxml')
'4.3.1' 
```

此功能也已移植到旧版本的 python ( `<3.8`) 中，但您需要先安装一个单独的库：

```
pip install importlib_metadata 
```

然后检查一个包的版本（在这个例子中`lxml`）运行：

```
>>> from importlib_metadata import version
>>> version('lxml')
'4.3.1' 
```

请记住，这只适用于从 PyPI 安装的包。此外，您必须将包名称作为参数传递给`version`方法，而不是该包提供的模块名称（尽管它们通常相同）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-02T17:02:16.617

我会远离散列。正在使用的 libxslt 版本可能包含不影响您使用它的某种类型的补丁。

作为替代方案，我建议您不要在运行时检查（不知道这是否是硬性要求）。对于我编写的具有外部依赖项（第 3 方库）的 python 内容，我编写了一个脚本，用户可以运行该脚本来检查他们的 python 安装，以查看是否安装了适当版本的模块。

对于没有定义“版本”属性的模块，您可以检查它包含的接口（类和方法）并查看它们是否与预期的接口匹配。然后在您正在处理的实际代码中，假设第 3 方模块具有您期望的接口。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-02T16:58:33.053

一些想法：

1.  尝试检查所需版本中存在或不存在的功能。
2.  如果没有函数差异，请检查函数参数和签名。
3.  如果您无法从函数签名中弄清楚，请在导入时设置一些存根调用并检查它们的行为。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-09-23T03:18:03.333

您可以使用

```
pip freeze 
```

以需求格式查看已安装的软件包。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-07-06T00:43:48.310

[我发现使用各种可用的工具（包括这个其他答案](https://stackoverflow.com/a/4939465/7262247)`pkg_resources`提到的最好的工具）非常不可靠，因为它们中的大多数并不涵盖所有情况。例如

*   内置模块
*   模块未安装但只是添加到 python 路径（例如通过您的 IDE）
*   相同模块的两个版本可用（一个在 python 路径中取代已安装的一个）

由于我们需要一种可靠的方法来获取*任何*包、模块或子模块的版本，因此我最终编写了[getversion](https://smarie.github.io/python-getversion/)。使用起来非常简单：

```
from getversion import get_module_version
import foo
version, details = get_module_version(foo) 
```

有关详细信息，请参阅[文档](https://smarie.github.io/python-getversion/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-26T20:27:21.043

对于不提供`__version__`以下内容的模块是丑陋但有效的：

```
#!/usr/bin/env python3.6
import sys
import os
import subprocess
import re

sp = subprocess.run(["pip3", "show", "numpy"], stdout=subprocess.PIPE)
ver = sp.stdout.decode('utf-8').strip().split('\n')[1]
res = re.search('^Version:\ (.*)$', ver)
print(res.group(1)) 
```

或者

```
#!/usr/bin/env python3.7
import sys
import os
import subprocess
import re

sp = subprocess.run(["pip3", "show", "numpy"], capture_output=True)
ver = sp.stdout.decode('utf-8').strip().split('\n')[1]
res = re.search('^Version:\ (.*)$', ver)
print(res.group(1)) 
```

# c - 将字符串转换为字符 c

> ID：710613
> 
> 赞同：1
> 
> 时间：2009-04-02T16:54:34.467
> 
> 标签：c, string, char

我正在做一个可以将 api 数字转换为字符的项目。我使用了一个字符串指针数组来进行转换。但是，我只想返回一个 ch，因为我使用的 api 将只接受一个字符。所以 ap_five 将返回“5”。但我希望五个成为单个字符'5'。

我想也许我可以在返回时转换成一个字符。但是，我只是垃圾。

我相信还有其他方法可以解决这个问题，我只是想知道如何用我现在的程序来解决。

```
char *digits_conversion[][2]=
{
    {"ap_zero", "0"},
    {"ap_one", "1"},
    {"ap_two", "2"},
    {"ap_three", "3"},
    {"ap_four", "4"},
    {"ap_five", "5"},
    {"ap_six", "6"},
    {"ap_seven", "7"},
    {"ap_eight", "8"},
    {"ap_nine", "9"},
    {"ap_star", "*"},
    {"ap_hash", "#"},
    {NULL, NULL}
};

char convert_to_char(const char *digit)
{
    int i = 0;
    for(i = 0; *digits_conversion[i][1]; i++)
    {
        if(strcmp(digits_conversion[i][0], digit) == 0)
        {
            return (char) digits_conversion[i][1];
        }
    }

    return '\0';
}

int main(void)
{
    char ch;

    ch = convert_to_char("ap_five");

    printf("Converted digit: %c\n", ch);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T16:58:08.593

对现有代码的最简单修复就是更改：

```
return (char) digits_conversion[i][1]; 
```

进入

```
return digits_conversion[i][1][0]; 
```

但是，您可能会发现更改`digits_conversion`为结构数组将使您的代码更易于理解和维护。例如：

```
struct digit_mapping {
    char *api_name;
    char digit;
};
struct digit_mapping conversion_table[] = {
    { "ap_zero", '0' },
    {"ap_one", '1'},
    {"ap_two", '2'},
    {"ap_three", '3'},
    {"ap_four", '4'},
    {"ap_five", '5'},
    {"ap_six", '6'},
    {"ap_seven", '7'},
    {"ap_eight", '8'},
    {"ap_nine", '9'},
    {"ap_star", '*'},
    {"ap_hash", '#'},
    {NULL, '\0'}
};

char convert_to_char(const char *digit)
{
    int i = 0;
    for(i = 0; conversion_table[i].digit; i++)
    {
            if(strcmp(conversion_table[i].api_name, digit) == 0)
            {
                    return conversion_table[i].digit;
            }
    }

    return '\0';
}

int main(void)
{
    char ch;

    ch = convert_to_char("ap_five");

    printf("Converted digit: %c\n", ch);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T16:57:45.177

```
digits_conversion[i][1] 
```

是 C 风格的字符串。采用：

```
digits_conversion[ i ][ 1 ][ 0 ] // if you want the character 

char convert_to_char(const char *digit)
{
    int i = 0;
    for(i = 0; *digits_conversion[i][1]; i++)
    {
            if(strcmp(digits_conversion[i][0], digit) == 0)
            {
                    return digits_conversion[i][1][0];
            }
    }

    return '\0';
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T16:58:31.930

```
return digits_conversion[i][1][0]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T17:18:09.917

'for' 循环的终止看起来不正确：

```
//...
    {"NULL", "NULL"}
//...
//...
for(i = 0; *digits_conversion[i][1]; i++)
//... 
```

数组末尾的“NULL”字面意思是字符串“NULL”。如果您通过“ap_hash”传递一个不匹配任何“ap_zero”的字符串，您的程序可能会崩溃，因为循环开始取消引用超出数组末尾的垃圾。

埃里克在他的例子中解决了这个问题，但我想我会特别指出这一点。

# c# - DataGridViewComboBox - 在 DataGridView 中显示“InActive”值

> ID：710617
> 
> 赞同：0
> 
> 时间：2009-04-02T16:55:17.617
> 
> 标签：c#, .net, winforms, datagridview, datagridviewcombobox

我有一个包含组合框 (DataGridViewComboBoxColumn) 的 DataGridView。该组合框填充了一组设置值。可以禁用这些设置值，以便在组合框中仅显示活动值，但是，仍然必须显示使用非活动值的现有条目（记录）。

我可以成功地遍历网格中的项目，如果记录的值不再处于活动状态（即 DataGridViewComboBoxCell 项目的一部分），我只需将其添加到该 DataGridViewComboBoxCell 的项目中。

**问题：**

我找不到放置此代码的地方，因此我不会得到可怕的“DataGridViewComboBoxCell 值无效”。

比如我可以把这段代码放到DataGridView的Paint事件中，网格功能就完美了。编辑/更新值没有问题，在显示方面也没有任何问题（始终显示非活动值）......但是，它仍然抛出“DataGridViewComboBoxCell 值无效。” 错误。

**问题：**

在将活动值添加到组合框 (DataGridViewComboBoxColumn) 之后，但在绑定记录以避免出现此错误之前，我可以在哪里添加代码（或如何）来添加“非活动”值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T22:34:26.753

只是捕获 datagridview 错误并且什么都不做呢？

```
void dataGridView1_DataError(object sender, DataGridViewDataErrorEventArgs e)
{
   e.Cancel = true;
}

// Add code in user interface
dataGridView1.DataError += 
    new DataGridViewDataErrorEventHandler(dataGridView1_DataError); 
```

# c++ - 简单的电子邮件程序/库推荐

> ID：710638
> 
> 赞同：0
> 
> 时间：2009-04-02T16:58:17.343
> 
> 标签：c++, email

我需要为 C++ 项目实现电子邮件通知。基本上，用户为其电子邮件帐户提供所有相关信息，并且在某些事件中，该组件会触发电子邮件。理想情况下，我想找到一个小型跨平台开源命令行项目，我可以从我的项目中执行并解析输出。类似于[blat](http://sourceforge.net/projects/blat/)，但它也支持 SSL 连接，并且可以在 Windows（XP 和 2003）和 Linux（Ubuntu 6.06 和 8.04）中使用

如果它足够简单并且在商业友好许可下获得许可，我也可以使用图书馆，但愿意听取所有建议。

非常感谢您的任何建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T04:15:39.993

( **A** ) 一种选择是使用 XMail：

[http://www.xmailserver.org/](http://www.xmailserver.org/)

自述文件包含如何在 Linux 和 Windows 中构建它的说明：

[http://www.xmailserver.org/Readme.html](http://www.xmailserver.org/Readme.html)

如果你看论坛：

[http://xmailforum.homelinux.net/](http://xmailforum.homelinux.net/)

或者做一些谷歌搜索，你应该能够找到更多关于如何使用它的信息。

* * *

( **B** ) 另一个可能更简单的选择是让您的应用程序连接到并使用外部 SMTP 服务器来发送您的通知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T23:56:31.277

编写电子邮件 libmime ( [http://www.mozilla.org/mailnews/arch/libmime-description.html](http://www.mozilla.org/mailnews/arch/libmime-description.html) ) 会很有帮助。

可以使用libsmtp ( [http://libsmtp.berlios.de/ ) 发送邮件。](http://libsmtp.berlios.de/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T01:41:42.760

我的电子邮件客户端的所有协议和 SSL 代码都在 Lgi 中可用： [http ://www.memecode.com/lgi.php](http://www.memecode.com/lgi.php)

它是 LGPL，因此您可以将其用作 DLL/SO。但是它没有打包好使用二进制文件，你必须自己构建它并使用 SMTP 和 MIME 代码编写一些胶水。SSL 套接字使用 OpenSSL 并在 Linux 和 Windows 上运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-11T21:58:52.897

我最终使用了 Perl 脚本[sendEmail](http://caspian.dotconf.net/menu/Software/SendEmail/)。有一个 windows 二进制文件可用，并且在修改 Perl 脚本后构建一个新的二进制文件一点也不难。安装所需的 Debian 软件包后，该脚本在 LTE Ubuntu 环境中运行也没有问题。

# iphone - 重新加载 UITableViewController

> ID：710640
> 
> 赞同：20
> 
> 时间：2009-04-02T16:58:26.220
> 
> 标签：iphone, uitableview

我正在尝试在`UITableViewController`找到位置后重新加载数据。这也意味着在`viewDidLoad`方法之后。`UITableViewController`我的班级正在使用此接口扩展 a ：

```
@interface RootViewController : UITableViewController <UITableViewDelegate, UITableViewDataSource, CLLocationManagerDelegate> 
```

在实现中，我尝试使用重新加载数据

```
[self.view reloadData]; 
```

`reloadData`似乎不是 UITableViewController 或视图的方法，因为我收到错误：

```
Messages without a matching method signature will be assumed to return 'id' and accept '...' as arguments 
```

有人可以发布一些如何重新加载扩展的表格视图的代码吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-04-02T18:27:33.980

你必须`UITableView`从头再来`[self.tableView reloadData];`

# apache-flex - 个别日子的 Flex DateChooser 事件？

> ID：710646
> 
> 赞同：0
> 
> 时间：2009-04-02T17:00:01.567
> 
> 标签：apache-flex, components, datechooser

我正在使用 DateChooser，并且希望在用户每天滚动时在工具提示中显示不同的信息。当我在日历中滚动时，是否有一个事件会告诉我我现在结束的那一天？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T17:30:58.233

这有点复杂。您将需要使用 mx_internal 命名空间。DateChooser 组件的网格部分是 DateChooser.as 中的 CalenderLayout 组件。

```
mx_internal var dataGrid:CalenderLayout; 
```

CalenderLayout.as 有 mouseMoveHandler。在处理程序中，我们有：

```
var selCell:IUITextField = dayBlocksArray[colIndex][rowIndex]; 
```

这为您提供了有关鼠标在哪一天结束的必要信息。您将需要扩展 DateChooser 以使用公开 selectedCell 的扩展 CalendarLayout。

也许：

```
private function mouseMoveHandler(event:MouseEvent):void
{
    ...
    dispatchEvent(new DayHoverEvent(selCell.text));
} 
```

我想我想说的是它有点棘手，它使用 mx_internal，这意味着变量在更高版本的 Flex 中可能会发生变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-28T06:12:10.293

您可能想查看我的博客文章：http: [//flexmonkey.blogspot.com/2010/06/displaying-color-coded-events-in-flex.html](http://flexmonkey.blogspot.com/2010/06/displaying-color-coded-events-in-flex.html)

我基于 Kevin Brammer 以前的一些工作（[http://www.cyberslingers.com/weblog/post/Adding-Calendar-Event-Entries-to-the-Flex-DateChooser-Component.aspx](http://www.cyberslingers.com/weblog/post/Adding-Calendar-Event-Entries-to-the-Flex-DateChooser-Component.aspx)） - 它允许您将工具提示添加到各个日期并对其进行颜色编码

希望能帮助到你，

西蒙

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T17:15:54.557

怎么样[`change`](http://livedocs.adobe.com/flex/3/langref/mx/controls/DateChooser.html#event:change)？

# wix - 在卸载期间提示用户关闭应用程序（在 WiX 中）

> ID：710647
> 
> 赞同：7
> 
> 时间：2009-04-02T17:00:06.763
> 
> 标签：wix, uninstallation

我正在使用 Windows Installer XML 3.0 (WIX3) 安装一些软件。

一切正常，但是，我很难处理以下用例：安装的软件**仍在运行**，当用户尝试**卸载**它时。默认行为似乎删除了所有文件，但允许应用程序运行（在我的情况下很难看到，因为它位于任务托盘中）。

我在我的`installer.wxs`文件中添加了以下代码：

```
<InstallExecuteSequence>
  <Custom Action="WixCloseApplications" Before="RemoveFiles" />
</InstallExecuteSequence>

<util:CloseApplication Id="CloseFoobar"
                       CloseMessage="no"
                       Description="FooBar is still running!"
                       ElevatedCloseMessage="no"
                       RebootPrompt="no"
                       Target="foobar.exe" /> 
```

但这不起作用 - 更糟糕的是，它会显示一个对话框，要求在**安装**过程中重新启动！

正确的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T17:12:07.593

据我所知，将以下引用添加到您的 UI 中就足够了：

```
<DialogRef Id="FilesInUse" />
<DialogRef Id="MsiRMFilesInUse" /> 
```

CloseApplication 的东西仅用于在安装期间关闭应用程序，但它有问题（至少当我几个月前尝试过时，也许现在已经修复了？）

不幸的是，这又是一个非常糟糕的 WiX 文档示例，甚至没有记录像这样的标准安装/卸载场景。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T22:39:26.853

几天前在 wix-users 邮件列表上也有人问过类似的问题。那里给出的答案是：

> 这是 Windows 在 Vista 和重新启动管理器之前的工作方式。必须有一个可用的顶级窗口。托盘中的应用程序不算数。

[wix-users 存档](http://windows-installer-xml-wix-toolset.687559.n2.nabble.com/Application-is-not-closing-on-uninstall-when-minimized-to-system-tray-td2538303.html)中也有一些关于该主题的主题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T06:39:44.547

你能检查卸载日志吗（[这里是如何启用它们](http://support.microsoft.com/kb/223300)），据我所知，Windows Installer 会将你的文件置于删除挂起状态并在最后要求重新启动。
您还可以编写一个简单的自定义操作来终止您的进程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-31T08:26:04.780

有关如何使用 closeapplication 的示例，请点击此链接：wix [github 项目，单元测试](https://github.com/wixtoolset/wix3/blob/ecfe55eb0654758427dc196f1d98ef4cb3d16f29/test/data/Extensions/UtilExtension/WixCloseApplicationTests/product.wxs "点击这里")

要显示提示对话框，您可以使用： `<util:CloseApplication Id="CloseIE" Target="iexplore.exe" PromptToContinue="yes" Description="Test" />`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-20T17:18:22.837

谢伊的回答是正确的。最新版本的 Windows Installer 就是这样运行的。Windows Installer 费了很大的力气来确保您可以通过重新映射正在使用的 Dll 等来避免在卸载时重新启动。通常，正在运行的应用程序可以在卸载后继续运行，并且在应用程序时会进行一些清理关机，下次重启后剩下的。关键是，如果 Windows Installer 可以将正在使用的二进制文件移动到另一个位置，保持任何应用程序运行，并替换正在使用的应用程序（但重新映射内存支持），那么所需要做的就是删除一些非必要的垃圾在下次重新启动时，为什么要强制重新启动？无需显示正在使用的文件对话框，因此不会出现这种情况。

如果应用程序尝试访问已卸载的文件，这可能会导致问题，但我认为风险被视为低。如果应用程序需要知道正在进行卸载，那么与重新启动管理器集成应该可以工作 - Windows 会告诉它正在进行卸载。否则，Shay 是正确的。如有必要，编写卸载自定义操作以告知应用关闭。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-30T14:58:14.287

我也遇到过这个问题。将 Before 属性更改为“InstallValidate”对我有用。

```
<Custom Before="InstallValidate" Action="WixCloseApplications"/> 
```

# c++ - C++ 和 STL 进修课程

> ID：710648
> 
> 赞同：13
> 
> 时间：2009-04-02T17:01:28.367
> 
> 标签：c++, stl

我非常了解 C 和 C++。我对指针有很多详细的了解，并且精通指针算法，并且在我的大学时代也曾研究过 Win32 API 和一点 MFC。在我以前的工作中，我没有机会看到这些事情，而是在其他领域工作。现在我想要的是一个速成或进修课程：

*   C++
*   STL

我不想阅读 500 多页的书籍，因为我也了解 C#、Java、Ruby、Python 甚至 x86 汇编。我想要的是涵盖 C++ 和中级 STL 的高级和黑暗角落。

谁能指出关于它的好链接？我知道谷歌！;-) 但是智能人工推荐是其他东西，但谷歌尚未实施。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T17:06:24.720

[SGI](http://www.sgi.com/tech/stl/)对 STL 有很好的参考。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T15:13:10.100

作为深入了解 STL 的一种途径，您可能需要花时间观看[http://www.stepanovpapers.com/](http://www.stepanovpapers.com/)上的一些视频。此外，“编程笔记” [http://www.stepanovpapers.com/notes.pdf](http://www.stepanovpapers.com/notes.pdf)也将帮助您了解 STL 设计背后的“原因”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T19:26:00.390

[www.cplusplus.com](http://www.cplusplus.com)我非常喜欢这个网站

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T17:12:22.100

我不太确定您所说的高级 C++ 和中级 STL 到底是什么意思。

当我第一次开始使用 C++ 时， [C++ FAQ Lite](http://www.parashift.com/c%2B%2B-faq-lite/&ei=k_HUSaeQKZiGkQXVidmHDw&usg=AFQjCNGsGMgQilYmFP6e88k5nD-Ha3GR-Q)帮助了我很多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T04:46:23.337

一些刷新记忆的YouTube视频：

[STL 矢量第 1 部分](http://www.youtube.com/watch?v=7UuPYxfJuB8&feature=related)

[STL 列表第 1 部分](http://www.youtube.com/watch?v=5z8q6rDvzNo&feature=related)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T17:08:09.457

阅读 STL - stackoverflow 上的 C++ 提要 =)

comp.lang.c++
comp.lang.c++.moderated 新闻组

Herb Sutter 的“本周大师” - [http://gotw.ca/gotw/index.htm](http://gotw.ca/gotw/index.htm)

开始学习 boost (boost.org)，这将是刷新 c++ 和 stl 的好方法。

C++ Coding Standards : 101 Rules, Guidelines, and Best Practices (C++ in Depth Series) - 小巧易读的地铁书籍。它可以帮助您更新知识。
“深度 C++ 系列”的其他书籍也不错。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T17:42:19.437

快速通读一本或多本 Meyers 的“有效”书籍和/或 Sutter 的“卓越”书籍将是一门不错的进修课程。对于不是新手的人来说，它们很短而且通常很容易阅读，但它们会刷新你对一些你需要了解的边缘情况的记忆。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T03:54:55.627

对我来说，关于 STL 的最好的书是 Matthew H. Austern 的“通用编程和 STL”。它从概念的角度很好地解释了 STL，而不是作为如何使用它的参考或教程。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-03T15:07:08.243

大约 4 年前，我遇到了完全相同的问题。从 java 角色回到 c++。

我发现的最有用的书是“Effective STL”——Scott Meyers。这解释了如何正确使用 stl，一旦你的头脑明白这一点，你的其他 C++ 知识就会泛滥成灾。

如果您在阅读同一作者的“Effective C++”和“More Effective C++”之后还在苦苦挣扎或仍然不确定 c++ 的所有复杂性。所有有效的书籍都简短而简洁。

此外，我的办公桌上总是放着 Stroustrup 的书，而且我会根据需要查阅它。

# c++builder - 如何将 Borland C++ builder 的代码移植到 Linux？

> ID：710649
> 
> 赞同：6
> 
> 时间：2009-04-02T17:01:33.687
> 
> 标签：c++builder, vcl, tthread

我有一个用 C++ 编写并使用 Visual Component Library 的 Windows DLL 的源代码。现在我的任务是将它移植到 Linux，但我没有 VCL 本身的源代码或任何类型的文档（而且我从未使用过 Borland C++；在我的 Windows 时代，我使用 MFC）。

这应该不是那么难，因为我的 DLL 没有任何 GUI：据我所知，它主要使用 VCL 进行多线程处理。我遇到了一个继承自 TThread 的类，这就是我卡住的地方。我在互联网上进行了一些搜索，但到目前为止没有找到 VCL 的文档。我想避免购买有关 Borland C++ Builder 的书，因为我没有时间等待它从亚马逊上来。我不能考虑购买适用于 Windows 的软件包，因为在工作中我只有一个 Linux 机器。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T17:04:30.123

Boost 库和 wxWidgets 将提供 VCL 类的类似物。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T17:56:12.260

您应该知道 C++ Builder 使用的 VCL 完全是用 Delphi/ObjectPascal 编写的。c++ builder 应用程序都涉及使用基于 delphi 的库的 c++。

FreePascal/Lazarus 开源项目对大部分 VCL（几乎所有非可视内容和大部分可视内容）进行了逆向工程，并在 Linux 上本地运行。非可视 VCL 兼容的东西被称为“免费组件库”（“FCL”） [http://www.freepascal.org/](http://www.freepascal.org/) [http://www.freepascal.org/fcl/fcl.var](http://www.freepascal.org/fcl/fcl.var)

FCL 中 TThread 实现的源代码应该很容易找到。

一种选择是在 FreePascal 中重写，其中语言将更改为 ObjectPascal，但对 VCL 的调用和 VCL 组件的使用几乎相同。

另一种选择可能是在 Linux 上移植到 c++，并以某种方式从 c++ 使用 FreePascal 的 VCL。我不确定它的实用性/可行性。FreePascal 论坛上的某个人应该能够帮助回答这个问题。

所以有人提到的另一个选择就是使用其他线程库重写。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-02T17:18:43.427

VCL 记录在[CodeGear 的网站上](http://docs.codegear.com/products/rad_studio/)。[这里](http://docs.codegear.com/products/rad_studio/radstudio2007/RS2007_helpupdates/HUpdate4/EN/html/delphivclwin32/Classes_TThread.html)特别描述了 TThread 。

我发现有关 VCL 的线程相关组件的文档相当稀少。 [这个站点](http://www.eonclash.com/Tutorials/Multithreading/MartinHarvey1.1/ToC.html)对 Delphi/VCL 线程方法有更好的描述。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T17:08:34.760

您可以下载他们的[免费编译器](http://www.codegear.com/downloads/free/cppbuilder)并尝试使用它。至少应该可以在 WINE 下运行它。甚至可能在 FreeDOS 下。

它应该与 Delphi/Kylix 中的 TThread 类有关。这是探索它的另一种选择。我确实相信最重要的方法是 run() 和 sync() 但自从我使用它以来已经很久了。

但是，如果您打算将代码干净地移植到 Linux，则使用一些 boost 库或其他东西自己重新实现 TThread 类可能会有所帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-02T17:34:07.743

许多年前，Borland 发布了他们的 Linux IDE 版本，以[Kylix](http://info.borland.com/devsupport/kylix/downloads/)的名义销售。我不确定它是否仍受支持，但这对您来说可能是阻力最小的路径。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-06T02:47:52.767

有几个库提供诸如线程之类的框架，例如 Boost (www.boost.org) 或 ACE ( [http://www.cs.wustl.edu/~schmidt/ACE.html](http://www.cs.wustl.edu/~schmidt/ACE.html) )

移植代码以使用这些线程基础结构之一应该相当容易。

# .net - WinMM 库问题

> ID：710650
> 
> 赞同：0
> 
> 时间：2009-04-02T17:01:35.107
> 
> 标签：.net, interop, .net-2.0, winmm

我编写了一个 WinMM 库包装库，它公开 WaveOut 和 WaveIn 类，用于录制和播放原始音频流。

一切都很好，但是为了遵循操作系统规范关于如何处理完成的缓冲区，我添加了一个线程来取消准备缓冲区并释放内存。我也把所有的同步都关闭了，这样这些类是可靠的和线程安全的。

但是，似乎有一个罕见的问题，即我向 WaveOut 设备添加缓冲区并且操作系统返回成功代码，但如果设备随后立即重置，操作系统不会将缓冲区标记为已完成并将其返回给应用。

似乎它正在失去缓冲区。所以，问题是，我正在跟踪发送到设备的单个缓冲区的计数，并阻止将 Close() 函数连接到清理它们的线程。

有什么想法或已知的错误吗？

PS：这似乎不会发生在 Vista 的四核上，但发生在我的 XP pro 的双核上。

**EDIT1：我完全愿意公开完整的源代码，一旦我上传它并在codeplex上获得适当的许可，如果这对任何人都有帮助的话。**

**EDIT2：将库发布到 CodePlex：[http ://winmm.codeplex.com/](http://winmm.codeplex.com/)**

这是导致问题的原因的想法：

```
public partial class MainView : Form
{
    private WaveIn waveIn = new WaveIn(WaveIn.WaveInMapperDeviceId);
    private WaveOut waveOut = new WaveOut(WaveOut.WaveOutMapperDeviceId);

    public MainView()
    {
        InitializeComponent();

        WaveFormat format = WaveFormat.Pcm44Khz16BitMono;

        waveOut.Open(format);

        waveIn.DataReady += new EventHandler<DataReadyEventArgs>(WaveIn_DataReady);

        // Tweaking these values affects the internal buffering thread.
        // Setting too small of a QueueSize with too small of a BufferSize
        //  will cause buffer underruns, which will sound like choppy audio.
        waveIn.BufferQueueSize = 200;
        waveIn.BufferSize = 64;

        waveIn.Open(format);

        waveIn.Start();
    }

    void WaveIn_DataReady(object sender, DataReadyEventArgs e)
    {
        if (waveOut != null)
        {
            lock (waveOut)
            {
                // We have to check for null after the lock,
                //  because waveOut may have been disposed
                //  inside another lock.
                if (waveOut != null)
                {
                    waveOut.Write(e.Data);
                }
            }
        }
    }

    private void MainView_FormClosed(object sender, FormClosedEventArgs e)
    {
        if (waveIn != null)
        {
            lock (waveIn)
            {
                waveIn.Dispose();
                waveIn = null;
            }
        }

        if (waveOut != null)
        {
            lock (waveOut)
            {
                waveOut.Dispose();
                waveOut = null;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T19:17:28.620

我将首先创建一个单独`object`的锁定。这应该可以简化很多空值检查逻辑（因为您在锁定之前和之后检查了大约一半）。

其次，`Dispose`不会将您的变量设置为`null`，因此您的其他检查仍将通过，因为该对象不为空，仅被处置。所以我会做

```
waveOut.Dispose();
waveout = null; 
```

以确保它被明确设置为空。

# asp.net - Visual Studio Asp.net 网站编译错误：不允许子节点

> ID：710651
> 
> 赞同：1
> 
> 时间：2009-04-02T17:01:47.320
> 
> 标签：asp.net, visual-studio-2008

如果您进行谷歌搜索， “**不允许子节点**”似乎是 Asp.net 网站上臭名昭著的编译错误。

**环境**：WinXp、VS2008 和 VS2008 SP1、.NET 3.5 SP1

**行为**：创建一个全新的 Asp.net 网站（不是 Web 应用程序），然后构建它，在 Web.config 上出现编译错误“不允许子节点”，其中显示 providerOption name="CompilerVersion" value=" v3.5"/>

我重新安装vs2008后遇到了这个问题。现在，很多人都在建议修复，但没有一个对我们有用。只有一个人提到他通过重新安装 Windows 成功地解决了这个问题，但如果我们不需要，我们不想走那么远。还有一个人向 MS 开了一张票，但还没有得到回复。

如果有谁和我们有类似的环境并且知道如何解决这个问题，我们将不胜感激！！！

**编辑** 所有这一切中最奇怪的部分是我不知道我是如何得到它的。这是一个全新的盒子和全新的安装。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T18:20:45.977

我的同事刚刚找到了解决这个可怕问题的方法，它是一个 .NET Framework Cleanup Utility，位于[http://cid-27e6a35d1a492af7.skydrive.live.com/self.aspx/Blog|_Tools/dotnetfx20|_cleanup|_tool.zip](http://cid-27e6a35d1a492af7.skydrive.live.com/self.aspx/Blog|_Tools/dotnetfx20|_cleanup|_tool.zip)

只需下载、运行并重新启动您的机器并重新安装 .NET Framework 3.5 SP1（因为清理工具会为您删除所有 .NET Frameworks）！真的希望这可以帮助其他有同样问题的人，这个问题已经解决了 4 天，感谢微软！

非常感谢你们的意见，我为你们投票，谢谢！

射线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T17:20:57.460

您可能需要重新安装 Visual Studio 2008 SP1。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T17:23:25.927

我没有遇到那个特定的错误，但请尝试以下操作（如果您还没有）：

*   由于您重新安装了vs 2008，请尝试重新应用SP1
*   清除它为网站生成的所有 asp.net 临时文件夹。

# .net - Visual Studio 2008 单元测试和 nunit

> ID：710665
> 
> 赞同：8
> 
> 时间：2009-04-02T17:06:44.907
> 
> 标签：.net, visual-studio, visual-studio-2008, unit-testing, nunit

当您在 Visual Studio 2008 中的代码文件中右键单击一个方法时，您会得到它
![替代文字](https://lh4.ggpht.com/_UhTaY5FX8Kk/SdTt375M-PI/AAAAAAAAGSA/QTSWdORoK9c/Clipboard01.jpg)
，它会为该方法创建单元测试框架。

有没有办法（通过模板更改或一些漂亮的 hack）我可以更改它以创建基于[Nunit](http://www.nunit.org/index.php)而不是[Visual Studio 单元测试工具](http://msdn.microsoft.com/en-us/library/ms379625.aspx)的单元测试？
像这样的东西……

```
using System.Collections;
using NUnit.Framework;

    namespace Domain.UnitTest
    {
      [TestFixture]
      public class ManagerTest
      {
        [Test]
        public void SomethingTest()
        {
          string expected = null;
          string acutal = Something.Create();
          Assert.AreEqual(expected, acutal);
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T17:52:54.890

尝试修改文件`C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplatesCache\CSharp\1033\SimpleUnitTest.zip\SimpleUnitTest.cs`（当然是在进行备份之后）。在别处保留更新版本的副本，因为这可能会被更新覆盖。

FWIW——我通过搜索`using Microsoft.VisualStudio.TestTools.UnitTesting;`从 VS 应用程序目录的顶级目录开始的文件中的字符串找到了这一点。

# wpf - FlowDocument 中的 WPF 句柄链接

> ID：710667
> 
> 赞同：1
> 
> 时间：2009-04-02T17:07:13.377
> 
> 标签：wpf, data-binding, mvvm, flowdocument

我正在使用 WPF 构建简单的字典应用程序。

我正在使用 MVVM 模式、数据绑定和 FlowDocument 向用户显示单词。

UI 由 2 个控件组成：ListBox 和 FlowDocumentScrollViewer。

字典数据来自 XML 文件，该字符串的格式可能如下所示

```
<b>Word</b> - Some description. Another <i>description</i>. Reference <ref id="123">related word</ref> 
```

HTML 和参考元素的顺序没有定义。

我解析 HTML 字符串，将其转换为 XAML，然后从 XAML 创建 FlowDocument 对象并将其绑定到 FlowDocumentScrollViewer 控件的 Document 属性。

当我需要链接参考时出现问题。元素。（我的要求是当用户点击引用链接时，在 ListBox 控件中选择引用的单词并显示在 FlowDocumentScrollViewer 中）

我的问题是有一种方法可以动态创建“超链接”样式的控件（附带事件或命令），它将用户带到字典中引用的单词。

有可能完全解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T21:23:50.857

有一个具有 Command 属性和 Click 事件的超链接文本元素。它的行为很像一个按钮，但它在 FlowDocuments 中使用。你可以使用任何一种方法来实现你所追求的，但我更喜欢命令。特别是如果您使用已标记的 MVVM 模式来实现这一点...

# c# - 数组列表数组的C#排列？

> ID：710670
> 
> 赞同：11
> 
> 时间：2009-04-02T17:07:29.583
> 
> 标签：c#, arrays, arraylist, permutation

我有一个 ArrayList[] myList 并且我正在尝试创建数组中所有值排列的列表。

示例：（所有值都是字符串）

```
myList[0] = { "1", "5", "3", "9" };
myList[1] = { "2", "3" };
myList[2] = { "93" }; 
```

myList 的计数可以变化，因此事先不知道其长度。

我希望能够生成类似于以下所有排列的列表（但有一些额外的格式）。

```
1 2 93
1 3 93
5 2 93
5 3 93
3 2 93
3 3 93
9 2 93
9 3 93 
```

这对我想要完成的事情有意义吗？我似乎无法想出一个好的方法来做到这一点，（如果有的话）。

编辑：
我不确定递归是否会干扰我以自己的方式格式化输出的愿望。抱歉，我之前没有提到我的格式是什么。

我想最终构建一个 string[] 数组，其中包含以下格式的所有组合：

对于“1 2 93”排列

我希望输出为“val0=1;val1=2;val2=93;”

我现在将尝试递归。谢谢Jokepu博士

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-01-02T13:32:05.427

我很惊讶没有人发布 LINQ 解决方案。

```
from val0 in new []{ "1", "5", "3", "9" }
from val1 in new []{ "2", "3" }
from val2 in new []{ "93" }
select String.Format("val0={0};val1={1};val2={2}", val0, val1, val2) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-02T17:20:09.350

递归解决方案

```
 static List<string> foo(int a, List<Array> x)
    {
        List<string> retval= new List<string>();
        if (a == x.Count)
        {
            retval.Add("");
            return retval;
        }
        foreach (Object y in x[a])
        {
            foreach (string x2 in foo(a + 1, x))
            {
                retval.Add(y.ToString() + " " + x2.ToString());
            }

        }
        return retval;
    }
    static void Main(string[] args)
    {
        List<Array> myList = new List<Array>();
        myList.Add(new string[0]);
        myList.Add(new string[0]);
        myList.Add(new string[0]);
        myList[0] = new string[]{ "1", "5", "3", "9" };
        myList[1] = new string[] { "2", "3" };
        myList[2] = new string[] { "93" };
        foreach (string x in foo(0, myList))
        {
            Console.WriteLine(x);
        }

        Console.ReadKey();
    } 
```

请注意，通过将返回更改为字符串列表的列表并将 retval.add 调用更改为使用列表而不是使用连接来返回列表或数组而不是字符串将非常容易。

这个怎么运作：

这是一个经典的递归算法。基本情况是`foo(myList.Count, myList)`，它返回一个包含一个元素的列表，即空字符串。n 个字符串数组 s1, s2, ..., sN 的列表的排列等于 sA1 的每个成员都以 n-1 个字符串数组 s2, ..., sN 的排列为前缀。基本情况只是为要连接的 sN 的每个元素提供一些东西。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-06-04T19:47:20.937

我最近在我的一个项目中遇到了类似的问题，偶然发现了这个问题。我需要一个可以处理任意对象列表的非递归解决方案。这就是我想出的。基本上我正在为每个子列表形成一个枚举器列表并迭代地递增它们。

```
public static IEnumerable<IEnumerable<T>> GetPermutations<T>(IEnumerable<IEnumerable<T>> lists)
{
    // Check against an empty list.
    if (!lists.Any())
    {
        yield break;
    }

    // Create a list of iterators into each of the sub-lists.
    List<IEnumerator<T>> iterators = new List<IEnumerator<T>>();
    foreach (var list in lists)
    {
        var it = list.GetEnumerator();
        // Ensure empty sub-lists are excluded.
        if (!it.MoveNext())
        {
            continue;
        }
        iterators.Add(it);
    }

    bool done = false;
    while (!done)
    {
        // Return the current state of all the iterator, this permutation.
        yield return from it in iterators select it.Current;

        // Move to the next permutation.
        bool recurse = false;
        var mainIt = iterators.GetEnumerator();
        mainIt.MoveNext(); // Move to the first, succeeds; the main list is not empty.
        do
        {
            recurse = false;
            var subIt = mainIt.Current;
            if (!subIt.MoveNext())
            {
                subIt.Reset(); // Note the sub-list must be a reset-able IEnumerable!
                subIt.MoveNext(); // Move to the first, succeeds; each sub-list is not empty.

                if (!mainIt.MoveNext())
                {
                    done = true;
                }
                else
                {
                    recurse = true;
                }
            }
        }
        while (recurse);
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-02T17:45:01.693

您可以使用[factoradics](http://en.wikipedia.org/wiki/Factoradic)来生成排列的枚举。试试[MSDN 上的这篇文章以](http://msdn.microsoft.com/en-us/library/aa302371.aspx)在 C# 中实现。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-02T17:26:44.797

无论您将多少个数组添加到 myList 中，这都会起作用：

```
 static void Main(string[] args)
        {
            string[][] myList = new string[3][];
            myList[0] = new string[] { "1", "5", "3", "9" };
            myList[1] = new string[] { "2", "3" };
            myList[2] = new string[] { "93" };

            List<string> permutations = new List<string>(myList[0]);

            for (int i = 1; i < myList.Length; ++i)
            {
                permutations = RecursiveAppend(permutations, myList[i]);
            }

            //at this point the permutations variable contains all permutations

        }

        static List<string> RecursiveAppend(List<string> priorPermutations, string[] additions)
        {
            List<string> newPermutationsResult = new List<string>();
            foreach (string priorPermutation in priorPermutations)
            {
                foreach (string addition in additions)
                {
                    newPermutationsResult.Add(priorPermutation + ":" + addition);
                }
            }
            return newPermutationsResult;
        } 
```

请注意，它并不是真正的递归。可能是一个误导性的函数名称。

这是一个符合您的新要求的版本。请注意我输出到控制台的部分，您可以在此处进行自己的格式化：

```
static void Main(string[] args)
        {
            string[][] myList = new string[3][];
            myList[0] = new string[] { "1", "5", "3", "9" };
            myList[1] = new string[] { "2", "3" };
            myList[2] = new string[] { "93" };

            List<List<string>> permutations = new List<List<string>>();

            foreach (string init in myList[0])
            {
                List<string> temp = new List<string>();
                temp.Add(init);
                permutations.Add(temp);
            }

            for (int i = 1; i < myList.Length; ++i)
            {
                permutations = RecursiveAppend(permutations, myList[i]);
            }

            //at this point the permutations variable contains all permutations

            foreach (List<string> list in permutations)
            {
                foreach (string item in list)
                {
                    Console.Write(item + ":");
                }
                Console.WriteLine();
            }

        }

        static List<List<string>> RecursiveAppend(List<List<string>> priorPermutations, string[] additions)
        {
            List<List<string>> newPermutationsResult = new List<List<string>>();
            foreach (List<string> priorPermutation in priorPermutations)
            {
                foreach (string addition in additions)
                {
                    List<string> priorWithAddition = new List<string>(priorPermutation);
                    priorWithAddition.Add(addition);
                    newPermutationsResult.Add(priorWithAddition);
                }
            }
            return newPermutationsResult;
        } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-12-30T09:30:27.370

您所要求的称为笛卡尔积。一旦你知道它叫什么，Stack Overflow 上有几个类似的问题。他们似乎最终都指向了一个最终写成博客文章的答案：

[http://blogs.msdn.com/b/ericlippert/archive/2010/06/28/computing-a-cartesian-product-with-linq.aspx](http://blogs.msdn.com/b/ericlippert/archive/2010/06/28/computing-a-cartesian-product-with-linq.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-02T17:14:10.677

非递归解决方案：

```
foreach (String s1 in array1) {
    foreach (String s2 in array2) {
        foreach (String s3 in array3) {
            String result = s1 + " " + s2 + " " + s3;
            //do something with the result
        }
    }
} 
```

递归解决方案：

```
private ArrayList<String> permute(ArrayList<ArrayList<String>> ar, int startIndex) {
    if (ar.Count == 1) {
        foreach(String s in ar.Value(0)) {
            ar.Value(0) = "val" + startIndex + "=" + ar.Value(0);
        return ar.Value(0);
    }
    ArrayList<String> ret = new ArrayList<String>();
    ArrayList<String> tmp1 ar.Value(0);
    ar.remove(0);
    ArrayList<String> tmp2 = permute(ar, startIndex+1);
    foreach (String s in tmp1) {
        foreach (String s2 in tmp2) {
            ret.Add("val" + startIndex + "=" + s + " " + s2);
        }
    }
    return ret;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-01T14:16:02.777

```
class Program
{
    static void Main(string[] args)
    {
        var listofInts = new List<List<int>>(3);
        listofInts.Add(new List<int>{1, 2, 3});
        listofInts.Add(new List<int> { 4,5,6 });
        listofInts.Add(new List<int> { 7,8,9,10 });

        var temp = CrossJoinLists(listofInts);
        foreach (var l in temp)
        {
            foreach (var i in l)
                Console.Write(i + ",");
            Console.WriteLine();
        }
    }

    private static IEnumerable<List<T>> CrossJoinLists<T>(IEnumerable<List<T>> listofObjects)
    {
        var result = from obj in listofObjects.First()
                     select new List<T> {obj};

        for (var i = 1; i < listofObjects.Count(); i++)
        {
            var iLocal = i;
            result = from obj  in result
                     from obj2 in listofObjects.ElementAt(iLocal)
                     select new List<T>(obj){ obj2 };
        }

        return result;
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-08-22T21:12:34.633

这是一个使用很少代码的版本，并且完全是声明性的

```
 public static IEnumerable<IEnumerable<T>> GetPermutations<T>(IEnumerable<T> collection) where T : IComparable
    {
        if (!collection.Any())
        {
            return new List<IEnumerable<T>>() {Enumerable.Empty<T>() };
        }
        var sequence = collection.OrderBy(s => s).ToArray();
        return sequence.SelectMany(s => GetPermutations(sequence.Where(s2 => !s2.Equals(s))).Select(sq => (new T[] {s}).Concat(sq)));
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-02-08T10:56:29.977

当我为大量代码执行此操作时遇到的一个问题是，在给出的示例 brian 中，我实际上内存不足。为了解决这个问题，我使用了以下代码。

```
static void foo(string s, List<Array> x, int a)
    {
        if (a == x.Count)
        {
            // output here
            Console.WriteLine(s);
        }
        else
        {
            foreach (object y in x[a])
            {
                foo(s + y.ToString(), x, a + 1);
            }
        }
    }

static void Main(string[] args)
    {
        List<Array> a = new List<Array>();
        a.Add(new string[0]);
        a.Add(new string[0]);
        a.Add(new string[0]);
        a[0] = new string[] { "T", "Z" };
        a[1] = new string[] { "N", "Z" };
        a[2] = new string[] { "3", "2", "Z" };

        foo("", a, 0);
        Console.Read();
    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-12-14T03:46:39.447

这是我编写的通用递归函数（以及可能方便调用的重载）：

```
Public Shared Function GetCombinationsFromIEnumerables(ByRef chain() As Object, ByRef IEnumerables As IEnumerable(Of IEnumerable(Of Object))) As List(Of Object())
    Dim Combinations As New List(Of Object())
    If IEnumerables.Any Then
        For Each v In IEnumerables.First
            Combinations.AddRange(GetCombinationsFromIEnumerables(chain.Concat(New Object() {v}).ToArray, IEnumerables.Skip(1)).ToArray)
        Next
    Else
        Combinations.Add(chain)
    End If
    Return Combinations
End Function

Public Shared Function GetCombinationsFromIEnumerables(ByVal ParamArray IEnumerables() As IEnumerable(Of Object)) As List(Of Object())
    Return GetCombinationsFromIEnumerables(chain:=New Object() {}, IEnumerables:=IEnumerables.AsEnumerable)
End Function 
```

和 C# 中的等价物：

```
public static List<object[]> GetCombinationsFromIEnumerables(ref object[] chain, ref IEnumerable<IEnumerable<object>> IEnumerables)
{
List<object[]> Combinations = new List<object[]>();
if (IEnumerables.Any) {
    foreach ( v in IEnumerables.First) {
        Combinations.AddRange(GetCombinationsFromIEnumerables(chain.Concat(new object[] { v }).ToArray, IEnumerables.Skip(1)).ToArray);
    }
} else {
    Combinations.Add(chain);
}
return Combinations;
}

public static List<object[]> GetCombinationsFromIEnumerables(params IEnumerable<object>[] IEnumerables)
{
return GetCombinationsFromIEnumerables(chain = new object[], IEnumerables = IEnumerables.AsEnumerable);
} 
```

便于使用：

```
Dim list1 = New String() {"hello", "bonjour", "hallo", "hola"}
Dim list2 = New String() {"Erwin", "Larry", "Bill"}
Dim list3 = New String() {"!", ".."}
Dim result = MyLib.GetCombinationsFromIEnumerables(list1, list2, list3)
For Each r In result
    Debug.Print(String.Join(" "c, r))
Next 
```

或在 C# 中：

```
object list1 = new string[] {"hello","bonjour","hallo","hola"};
object list2 = new string[] {"Erwin", "Larry", "Bill"};
object list3 = new string[] {"!",".."};
object result = MyLib.GetCombinationsFromIEnumerables(list1, list2, list3);
foreach (r in result) {
Debug.Print(string.Join(' ', r));
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-01-20T20:11:20.273

这是一个非递归、非 Linq 的解决方案。我不禁觉得我可以减少循环并用除法和模数计算位置，但不能完全理解这一点。

```
static void Main(string[] args)
    {
        //build test list
        List<string[]> myList = new List<string[]>();
        myList.Add(new string[0]);
        myList.Add(new string[0]);
        myList.Add(new string[0]);
        myList[0] = new string[] { "1", "2", "3"};
        myList[1] = new string[] { "4", "5" };
        myList[2] = new string[] { "7", "8", "9" };

        object[][] xProds = GetProducts(myList.ToArray());
        foreach(object[] os in xProds)
        {
            foreach(object o in os)
            {
                Console.Write(o.ToString() + " ");
            }
            Console.WriteLine();
        }
        Console.ReadKey();
    }

    static object[][] GetProducts(object[][] jaggedArray){
        int numLists = jaggedArray.Length;
        int nProducts = 1;
        foreach (object[] oArray in jaggedArray)
        {
            nProducts *= oArray.Length;
        }
        object[][] productAry = new object[nProducts][];//holds the results
        int[] listIdxArray = new int[numLists];
        listIdxArray.Initialize();
        int listPtr = 0;//point to current list

        for(int rowcounter = 0; rowcounter < nProducts; rowcounter++)
        {
            //create a result row
            object[] prodRow = new object[numLists];
            //get values for each column
            for(int i=0;i<numLists;i++)
            {
                prodRow[i] = jaggedArray[i][listIdxArray[i]];
            }
            productAry[rowcounter] = prodRow;
            //move the list pointer
            //possible states
            // 1) in a list, has room to move down
            // 2) at bottom of list, can move to next list
            // 3) at bottom of list, no more lists left
            //in a list, can move down
            if (listIdxArray[listPtr] < (jaggedArray[listPtr].Length - 1))
            {
                listIdxArray[listPtr]++;
            }
            else
            {
                //can move to next column?
                //move the pointer over until we find a list, or run out of room
                while (listPtr < numLists && listIdxArray[listPtr] >= (jaggedArray[listPtr].Length - 1))
                {
                    listPtr++;
                }
                if (listPtr < listIdxArray.Length && listIdxArray[listPtr] < (jaggedArray[listPtr].Length - 1))
                {
                    //zero out the previous stuff
                    for (int k = 0; k < listPtr; k++)
                    {
                        listIdxArray[k] = 0;
                    }
                    listIdxArray[listPtr]++;
                    listPtr = 0;
                }
            }
        }
        return productAry;
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-08-30T23:18:47.153

```
private static void GetP(List<List<string>> conditions, List<List<string>> combinations, List<string> conditionCombo, List<string> previousT, int selectCnt)
{
    for (int i = 0; i < conditions.Count(); i++)
    {
        List<string> oneField = conditions[i];
        for (int k = 0; k < oneField.Count(); k++)
        {
            List<string> t = new List<string>(conditionCombo);
            t.AddRange(previousT);
            t.Add(oneField[k]);

            if (selectCnt == t.Count )
            {
                combinations.Add(t);
                continue;
            }
            GetP(conditions.GetRange(i + 1, conditions.Count - 1 - i), combinations, conditionCombo, t, selectCnt);
        }

    }
}

List<List<string>> a = new List<List<string>>();
a.Add(new List<string> { "1", "5", "3", "9" });
a.Add(new List<string> { "2", "3" });
a.Add(new List<string> { "93" });
List<List<string>> result = new List<List<string>>();
GetP(a, result, new List<string>(), new List<string>(), a.Count); 
```

另一个递归函数。

# iphone - 是否可以设置 UIImageView 图像的位置？

> ID：710675
> 
> 赞同：17
> 
> 时间：2009-04-02T17:09:57.520
> 
> 标签：iphone, image, uiimageview

我有一个`UIImageView`显示更大图像的。它似乎居中，但我想将该图像移到`UIImageView`. 我查看了来自 Apple 的[MoveMe](https://developer.apple.com/LIBRARY/IOS/samplecode/MoveMe/Introduction/Intro.html)示例，但我无法弄清楚他们是如何做到的。似乎他们甚至没有 UIImageView 。有任何想法吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-04-08T00:22:51.873

您需要的是类似的东西（例如显示原始图像左上角的 30% x 30%）：

```
imageView.layer.contentsRect = CGRectMake(0.0, 0.0, 0.3, 0.3); 
```

“contentsRect”的描述：单位坐标空间中的矩形，它定义了应该使用的图层内容部分。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-02T19:23:23.813

原始答案已被 iOS4 中的 CoreAnimation 取代。

所以正如 Gold Thumb 所说：你可以通过访问 UIView 的 CALayer 来做到这一点。特别是它的contentRect：

来自[Apple Docs](https://developer.apple.com/library/ios/documentation/graphicsimaging/reference/CALayer_class/Introduction/Introduction.html)：单位坐标空间中的矩形，它定义了应该使用的图层内容部分。动画。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-03T07:39:20.177

您想**显示图像以使其包含在 UIImageView 中**吗？在这种情况下，只需将 UIImageView 的 contectMode 更改为 UIViewContentModeScaleToFill （如果纵横比无关紧要）或 UIViewContentModeScaleAspectFit （如果您想保持纵横比）

在 IB 中，这可以通过在 Inspector 中设置 Mode 来完成。

在代码中，它可以完成为

```
yourImageView.contentMode = UIViewContentModeScaleToFill; 
```

**如果您想在 UIImageView 中显示大图像**，最好和最简单的方法是将图像视图放在 UIScrollView 中。这样您就可以放大和缩小图像并四处移动。

希望有帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-03T04:25:14.853

听起来 MoveMe 示例并没有像您想要的那样做任何事情。其中的 PlacardView 与使用的图像大小相同。对其进行的唯一大小更改是视图变换，它不会影响图像的视口。据我了解，您有一张大图片，并希望在其中显示一个小视口。没有一个简单的类方法可以做到这一点，但有一个函数可以用来获得所需的结果：CGImageCreateWithImageInRect(CGImageRef, CGRect) 会帮助你。

这是一个使用它的简短示例：

```
CGImageRef imageRef = CGImageCreateWithImageInRect([largeImage CGImage], cropRect);
[UIImageView setImage:[UIImage imageWithCGImage:imageRef]];
CGImageRelease(imageRef); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-03T13:48:16.887

非常感谢。我找到了一个非常简单的解决方案，如下所示：

```
CGRect frameRect = myImage.frame;
CGPoint rectPoint = frameRect.origin;
CGFloat newXPos = rectPoint.x - 0.5f;
myImage.frame = CGRectMake(newXPos, 0.0f, myImage.frame.size.width, myImage.frame.size.height); 
```

我只是移动框架。碰巧该帧的某些部分超出了 iPhone 的视口，但我希望这不会有太大影响。它上面有一个面具，所以它看起来并不奇怪。用户不知道它是如何完成的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-10T05:32:55.683

您可以通过以下方式完成相同的操作：

```
UIImageView *imgVw=[[UIImageView alloc]initwithFrame:CGRectMake(x,y,height,width)];     
imgVw.image=[UIImage imageNamed:@""];
[self.view addSubView imgVw];
imgVw.contentMode = UIViewContentModeScaleToFill; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-12T07:43:28.973

您可以使用`NSLayoutConstraint`来设置 的位置`UIImageView`，它可以相对于其他元素或相对于框架。这是一个示例片段：

```
let logo = UIImage(imageLiteralResourceName: "img")
        let logoImage = UIImageView(image: logo)
        logoImage.translatesAutoresizingMaskIntoConstraints = false
        self.view.addSubview(logoImage)
        NSLayoutConstraint.activate([logoImage.topAnchor.constraint(equalTo: view.topAnchor,constant: 30),
                                     logoImage.centerXAnchor.constraint(equalTo: view.centerXAnchor),logoImage.widthAnchor.constraint(equalToConstant: 100),logoImage.heightAnchor.constraint(equalToConstant: 100)
                                     ]) 
```

这样，您还可以轻松调整图像大小。常量参数表示，某个锚点相对于指定锚点应该定位多远。
考虑到这一点，
`logoImage.topAnchor.constraint(equalTo: view.topAnchor,constant: 30)` 上面的行将实例的顶部锚点设置`logoImage`为父视图下方的 30（常量）。负值表示相反的方向。

# html - 如何解析格式不佳的 HTML 文件？

> ID：710677
> 
> 赞同：5
> 
> 时间：2009-04-02T17:10:12.650
> 
> 标签：html, parsing, text, html-content-extraction

我必须解析一系列网页才能将数据导入应用程序。每种类型的网页都提供相同类型的数据。问题是每个页面的HTML不同，所以数据的位置也不同。另一个问题是 HTML 代码的格式很差，无法使用类似 XML 的解析器。

到目前为止，我能想到的最佳策略是为每种页面定义一个模板，例如：

模板 A：

```
<html>
...
  <tr><td>Table column that is missing a td 
      <td> Another table column</td></tr>
  <tr><td>$data_item_1$</td>
...
</html> 
```

模板 B：

```
<html>
...
  <ul><li>Yet another poorly formatted page <li>$data_item_1$</td></tr>
...
</html> 
```

这样，我只需要一个解析器来处理所有页面，它将每个页面与其模板进行比较并检索`$data_item_1$`,`$data_item_2$`等。不过，这将是很多工作。你能想出更简单的解决方案吗？任何可以提供帮助的图书馆？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T17:13:15.873

您可以通过 tidy 传递页面的源以获得有效页面。[你可以在这里](http://tidy.sourceforge.net)找到整洁 。Tidy 有很多编程语言的绑定。完成此操作后，您可以使用自己喜欢的解析器/内容提取技术。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T17:14:08.820

我推荐[Html Agility Pack](http://www.codeplex.com/htmlagilitypack)。它能够处理结构不佳的 HTML，同时使用 Xpath 为您提供类似 Xml 的选择。您仍然需要模板项目或使用不同的选择和分析进行选择，但它会让您摆脱糟糕的结构驼峰。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T17:21:12.267

[正如这里](https://stackoverflow.com/questions/2861/options-for-html-scraping)和之前的其他 SO 答案所提到的， [Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)可以解析奇怪的 HTML。

> Beautiful Soup 是一个 Python HTML/XML 解析器，专为屏幕抓取等快速周转项目而设计。三个功能使其功能强大：
> 
> 1.  如果你给它错误的标记，Beautiful Soup 不会窒息。它会生成一个解析树，其意义与您的原始文档大致相同。这通常足以收集您需要的数据并逃跑。
> 2.  Beautiful Soup 提供了一些用于导航、搜索和修改解析树的简单方法和 Pythonic 习惯用法：用于剖析文档和提取所需内容的工具包。您不必为每个应用程序创建自定义解析器。
> 3.  Beautiful Soup 自动将传入文档转换为 Unicode，将传出文档自动转换为 UTF-8。您不必考虑编码，除非文档未指定编码并且 Beautiful Soup 无法自动检测编码。然后你只需要指定原始编码。
> 
> Beautiful Soup 解析你给它的任何东西，并为你做树遍历的东西。您可以告诉它“查找所有链接”，或“查找类 externalLink 的所有链接”，或“查找所有 url 匹配“foo.com”的链接，或“查找带有粗体文本的表格标题，然后给出我那条短信。”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T18:13:20.767

[使用像html5lib](http://code.google.com/p/html5lib/)这样的HTML5 解析器。

与 HTML Tidy 不同，这将为您提供非常接近浏览器所做的错误处理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T22:05:07.340

有几个 C# 特定的线程，比如[寻找 C# HTML 解析器](https://stackoverflow.com/questions/100358/looking-for-c-html-parser/624410#624410)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T22:09:20.403

根据您需要提取正则表达式的数据，可能是一种选择。我知道很多人一想到在结构化数据上使用 RegExes 就会不寒而栗，但显而易见的事实是（正如您所发现的）许多 HTML 实际上的结构并不好，而且很难解析。

我遇到了类似的问题，但在我的情况下，我只想要页面中的一个特定数据，无需解析 HTML 即可轻松识别，因此 RegEx 工作得非常好。

# sql-server - 什么时候应该在 SQL Server 中使用分号？

> ID：710683
> 
> 赞同：250
> 
> 时间：2009-04-02T17:11:38.700
> 
> 标签：sql-server, tsql

在检查 Web 上的一些代码和 SQL Server Management Studio 生成的脚本时，我注意到一些语句以分号结尾。

那么我应该什么时候使用它呢？

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2009-04-02T17:14:36.697

来自 Ken Powers 的 SQLServerCentral.Com[文章](http://www.sqlservercentral.com/articles/SQL+Puzzles/thegocommandandthesemicolonterminator/2200/)：

**分号**

分号字符是语句终止符。它是 ANSI SQL-92 标准的一部分，但从未在 Transact-SQL 中使用。确实，有可能在不遇到分号的情况下编写 T-SQL 多年。

**用法**

有两种情况必须使用分号。第一种情况是您使用公用表表达式 (CTE)，而 CTE 不是批处理中的第一个语句。第二个是您发出 Service Broker 语句并且 Service Broker 语句不是批处理中的第一个语句。

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2009-04-02T17:15:13.950

默认情况下，SQL 语句以分号结束。您使用分号来终止语句，除非您（很少）设置了新的语句终止符。

如果您只发送一个语句，从技术上讲，您可以省去语句终止符；在脚本中，当您发送多个语句时，您需要它。

在实践中，即使您只是向数据库发送一条语句，也要始终包含终止符。

编辑：为了回应那些说[特定RDBMS]不需要语句终止符的说法，虽然这可能是真的，但ANSI SQL标准需要它们。在所有编程中，如果我们能够在不损失功能的情况下遵守标准，我们应该这样做，因为这样我们的代码或习惯都不会与某个专有供应商绑定。

使用某些 C 编译器，可能有 main 返回 void，即使标准要求 main 返回 int。但是这样做会使我们的代码和我们自己的可移植性降低。

有效编程的最大困难不是学习新事物，而是改掉坏习惯。在某种程度上，我们可以从一开始就避免养成坏习惯，这对我们、对我们的代码以及对任何阅读或使用我们代码的人来说都是一种胜利。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2014-10-14T08:35:24.320

你**必须**使用它。

> 使用分号终止语句的做法是标准的，实际上是其他几个数据库平台的要求。SQL Server 仅在特定情况下需要分号，但在不需要分号的情况下，使用分号不会导致问题。我强烈建议您采用以分号结束所有语句的做法。这样做不仅可以提高代码的可读性，而且在某些情况下还可以为您省去一些麻烦。（当需要分号但未指定分号时，SQL Server 产生的错误消息并不总是很清楚。）

最重要的是：

> SQL Server 文档指出不使用分号终止 T-SQL 语句是一项已弃用的功能。这意味着长期目标是在产品的未来版本中强制使用分号。这是养成终止所有语句的习惯的另一个原因，即使目前不需要它。

资料来源： Itzik Ben-Gan*的 Microsoft SQL Server 2012 T-SQL 基础* 。

* * *

为什么你总是必须使用的一个例子`;`是以下两个查询（从这篇[文章](http://www.dbdelta.com/always-use-semicolon-statement-terminators/)复制）：

```
BEGIN TRY
    BEGIN TRAN
    SELECT 1/0 AS CauseAnException
    COMMIT
END TRY
BEGIN CATCH
    SELECT ERROR_MESSAGE()
    THROW
END CATCH 
```

![在此处输入图像描述](https://i.stack.imgur.com/B1WAA.png)

```
BEGIN TRY
    BEGIN TRAN
    SELECT 1/0 AS CauseAnException;
    COMMIT
END TRY
BEGIN CATCH
    SELECT ERROR_MESSAGE();
    THROW
END CATCH 
```

![在此处输入图像描述](https://i.stack.imgur.com/74OTM.png)

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-04-02T18:09:49.060

在 SQL2008 BOL 中，他们说在下一个版本中将需要分号。因此，请始终使用它。

参考：

*   [Transact-SQL 语法约定 (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms177563(v=sql.105).aspx)
*   [SQL Server 2008 R2 中已弃用的数据库引擎功能](http://msdn.microsoft.com/en-us/library/ms143729(v=sql.105).aspx)（“SQL Server 的未来版本不支持的功能”部分，“Transact-SQL”区域）

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2013-08-13T14:01:39.353

如果我没看错的话，需要使用分号来结束 TSQL 语句。 [http://msdn.microsoft.com/en-us/library/ms143729%28v=sql.120%29.aspx](http://msdn.microsoft.com/en-us/library/ms143729%28v=sql.120%29.aspx)

编辑：我找到了一个用于 SSMS 2008R2 的插件，它将格式化您的脚本并添加分号。我认为它仍处于测试阶段...

[http://www.tsqltidy.com/tsqltidySSMSAddin.aspx](http://www.tsqltidy.com/tsqltidySSMSAddin.aspx)

编辑：我发现了一个更好的免费工具/插件，称为 ApexSQL ... [http://www.apexsql.com/](http://www.apexsql.com/)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-04-02T17:27:01.190

**个人意见：**仅在需要的地方使用它们。（有关所需列表，请参阅上面的 TheTXI 答案。）

由于编译器不需要它们，你*可以*把它们全部放回去，但为什么呢？编译器不会告诉你忘记在哪里，所以你最终会得到不一致的使用。

[此意见特定于 SQL Server。其他数据库可能有更严格的要求。如果您正在编写 SQL 以在多个数据库上运行，您的要求可能会有所不同。]

tpdi 上面说，“在脚本中，当您发送多个语句时，您需要它。” 这实际上是不正确的。你不需要它们。

```
PRINT 'Semicolons are optional'
PRINT 'Semicolons are optional'
PRINT 'Semicolons are optional';
PRINT 'Semicolons are optional'; 
```

输出：

```
Semicolons are optional
Semicolons are optional
Semicolons are optional
Semicolons are optional 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-06-11T19:57:52.933

关于 T-SQL，我还有很多东西要学习，但是在为事务处理一些代码（以及基于 stackoverflow 和其他站点的示例的代码）时，我发现了一个似乎需要分号并且如果缺少分号的情况，该语句似乎根本没有执行，也没有引发错误。上述任何答案似乎都没有涵盖这一点。（这是使用 MS SQL Server 2012。）

一旦我让事务按照我想要的方式工作，我决定在它周围放置一个 try-catch，这样如果有任何错误，它就会回滚。仅在执行此操作后，事务才被提交（SSMS 在尝试关闭窗口时确认这一点，并发出一条很好的消息，提醒您有一个未提交的事务。

所以这

```
COMMIT TRANSACTION 
```

在 BEGIN TRY/END TRY 块之外可以正常提交事务，但必须在块内

```
COMMIT TRANSACTION; 
```

请注意，在尝试关闭查询选项卡之前，没有提供错误或警告，也没有任何迹象表明事务仍未提交。

幸运的是，这会导致如此巨大的问题，以至于很明显存在问题。不幸的是，由于没有报告错误（语法或其他），因此问题所在并不立即显而易见。

相反，ROLLBACK TRANSACTION 在带或不带分号的 BEGIN CATCH 块中似乎同样有效。

这可能有一些逻辑，但它给人的感觉是随意的和爱丽丝梦游仙境的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-09-23T06:37:09.477

分号似乎不应该与光标操作一起使用：`OPEN`、、`FETCH`和。我只是浪费了几个小时。我仔细查看了 BOL 并注意到 [;] 没有显示在这些游标语句的语法中！`CLOSE``DEALLOCATE`

所以我有：

```
OPEN mycursor; 
```

这给了我错误 16916。

但：

```
OPEN mycursor 
```

工作。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-08-26T08:12:57.787

根据[Transact-SQL 语法约定 (Transact-SQL)](https://msdn.microsoft.com/library/ms177563.aspx) (MSDN)

> Transact-SQL 语句终止符。尽管此版本的 SQL Server 中的大多数语句不需要分号，但在将来的版本中将需要它。

（另见@gerryLowry 的评论）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-18T19:53:26.210

在包含其他语句的批处理中使用 DISABLE 或 ENABLE TRIGGER 语句时，它之前的语句必须以分号结尾。否则，您将收到语法错误。我用这个把我的头发扯掉了......之后，我偶然发现了这个 MS Connect 项目关于同样的事情。它已关闭，无法修复。

看[这里](http://connect.microsoft.com/SQLServer/feedback/details/307937/msft-mso-disable-trigger-statement-not-compiling-within-a-sp-however-it-executes-just-fine-outside)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-10-04T03:11:08.327

如果你喜欢在 SQLServer 中得到随机的*命令超时*错误，那么在你的 CommandText 字符串的末尾去掉分号。

我不知道这是否记录在任何地方，或者它是否是一个错误，但它确实发生了，我从痛苦的经历中学到了这一点。

我有使用 SQLServer 2008 的可验证和可重现的示例。

aka ->*在实践中，即使您只是向数据库发送一条语句，也始终包含终止符。*

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2015-07-31T09:11:37.477

*注意：这回答了书面问题，但没有回答所述问题。在这里添加它，因为人们会搜索它*

`WITH`递归 CTE 语句之前也使用了分号：

```
;WITH Numbers AS
(
    SELECT n = 1
    UNION ALL
    SELECT n + 1
    FROM Numbers
    WHERE n+1 <= 10
)
SELECT n
FROM Numbers 
```

此查询将生成一个名为 Numbers 的 CTE，它由整数 [1..10] 组成。它是通过创建一个只有值 1 的表来完成的，然后递归直到达到 10。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2014-10-03T06:26:28.060

分号在复合 SELECT 语句中并不总是有效。

比较这两个不同版本的普通复合 SELECT 语句。

编码

```
DECLARE @Test varchar(35); 
SELECT @Test=
    (SELECT 
        (SELECT 
            (SELECT 'Semicolons do not always work fine.';););); 
SELECT @Test Test; 
```

返回

```
Msg 102, Level 15, State 1, Line 5
Incorrect syntax near ';'. 
```

然而，代码

```
DECLARE @Test varchar(35)
SELECT @Test=
    (SELECT 
        (SELECT 
            (SELECT 'Semicolons do not always work fine.'))) 
SELECT @Test Test 
```

返回

```
Test
-----------------------------------
Semicolons do not always work fine.

(1 row(s) affected) 
```

# msbuild - 基于要在 MSBUILD 中使用的用户定义目录创建 wix 片段文件的最佳方法

> ID：710687
> 
> 赞同：10
> 
> 时间：2009-04-02T17:12:57.153
> 
> 标签：msbuild, wix, wix3

本着 Si 提出的这个问题的精神：[WiX 技巧和技巧](https://stackoverflow.com/questions/471424/wix-tricks-and-best-practices)。我正在尝试确定基于目录创建 wix 片段的最佳方法。文件收割，可以这么说。例如，在 bin\release 文件夹下，我可以有许多不同的文件夹以及我想在片段中轻松捕获的文件。我一直在通过键入它们或使用 wixedit 来做到这一点。

请注意，我没有尝试任何只是在这里进行研究的东西：A）我读了一点关于热量的东西。（[http://installing.blogspot.com/2006/04/heatexe-making-setup-easier.html](http://installing.blogspot.com/2006/04/heatexe-making-setup-easier.html)）我不确定是否从 msbuild 运行它？B）我从 Newagesolution 找到了这篇讨论使用 t4 脚本的博客文章：http: [//blog.newagesolution.net/2008/06/how-to-use-msbuild-and-wix-to-msi.html](http://blog.newagesolution.net/2008/06/how-to-use-msbuild-and-wix-to-msi.html)

我想知道其他人正在做什么来解决这个问题。

问候，布赖恩

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-28T11:39:54.260

好的，丹尼尔我绝对同意使用加热，但我认为 Rob 为我最终使用的东西指明了正确的方向。

我最终使用的是 HeatDirectory。（请注意，我不打算打补丁。如果你想打补丁，你可能想看看另一个解决方案，但是 heat/heat 目录可以用于打补丁。）不幸的是，Rob 的回答是非常有限，所以我不会说他真的回答了我的问题。只是为我指明了正确的方向。感谢 Rob 和 Daniel 的帮助。

因此，我自己回来回答了这个问题。

障碍...

**我遇到的障碍 1** 是网络上几乎没有关于如何从 Visual Studio 中实现热任务/热目录（热包装在 msbuild 中）的文档。请注意，从 msbuild 运行的包装器似乎很新，我拒绝使用您自担风险等。由于缺乏文档，我向 wix 用户列表发送了一封电子邮件。我得到了布赖恩·罗杰斯的帮助。谢谢布赖恩，这为我解决了一切。在这里查看他的精彩博客文章，以更好地了解热量如何帮助您实现自动化： http://icumove.spaces.live.com/blog/cns!FB93073C6534B681! [461.entry](http://icumove.spaces.live.com/blog/cns!FB93073C6534B681!461.entry)

**障碍 2** 使用热量后，我发现我没有按照推荐的方式使用组件，但我不得不拼凑所有的推理。如果您没有 Windows 安装程序的先验知识，我认为很多人在使用 Wix 时会遇到这种情况。因此，我建议您阅读：如果您是像我一样使用 Windows Installer 的新手，请确保您也阅读组件规则。来自 MS 的组件规则：http: [//msdn.microsoft.com/en-us/library/aa370561.aspx](http://msdn.microsoft.com/en-us/library/aa370561.aspx) . 阅读 Rob Mensching 的这些内容，以更好地理解组件：[http ://robmensching.com/blog/posts/2003/10/4/Windows-Installer-Components-Introduction](http://robmensching.com/blog/posts/2003/10/4/Windows-Installer-Components-Introduction) [http://robmensching.com/blog/posts/2003 /10/18/组件-规则-101](http://robmensching.com/blog/posts/2003/10/18/Component-Rules-101) 有关 Windows 安装程序的额外阅读，请检查 Windows 安装程序团队的这些规则（规则 16：遵循组件规则）：http: [//blogs.msdn.com/windows_installer_team/archive/2006/05/12/595950.aspx](http://blogs.msdn.com/windows_installer_team/archive/2006/05/12/595950.aspx)

**障碍 3** 每次安装新版本时，您必须决定是否要修补文件或升级。幸运的是我不需要打补丁，因此每次升级我都会像这样卸载以前的版本：[如何实现 WiX 安装程序升级？](https://stackoverflow.com/questions/114165/how-to-implement-wix-installer-upgrade/724098#724098). 这大大简化了事情。修补时，您将需要完全控制事物。当您希望许多除了 wix 构建 msi 字段之外对 wix 一无所知的开发人员想要自动化/自动构建时，这会更加困难。似乎这可以使用热量，但我不确定。

**障碍 4** 对我来说，我花了一点时间来弄清楚为什么包含我的预处理器变量的包含文件不起作用。我终于弄明白了。您必须将文件包含在您的 .wxs 文件中，如下所示：有关详细信息，请参见此处： [将文本文件内容包含到 WiX 脚本中](https://stackoverflow.com/questions/395922/include-a-text-file-content-into-a-wix-script)

[http://wix.sourceforge.net/manual-wix2/preprocessor.htm](http://wix.sourceforge.net/manual-wix2/preprocessor.htm)

**障碍 5** 由于我正在使用 mix 的主要升级，并且我想将颠覆挂钩到我的产品编号中。我认为这很简单，如果你知道怎么做。我在这里遇到了麻烦，也不得不为此寻求帮助。

**障碍 6** 通过基于 bin 文件夹的热更新文件，一切正常。好吧，几乎是自动的，如果 dll 引用等有任何冲突，那么文件将不会包含在安装程序中，因此可能无法正常运行。您需要有一个测试过程，以便在安装后测试您的程序。如果您错过了一个 dll，这可能很关键。我还建议您跟踪程序使用的 dll 并与 msi 文件进行比较。

现在使用 HeatDirectory 的解决方案（在 Brian Rogers（wix 团队）的帮助下）：

```
 <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == ''">Debug</Configuration>
   <OutputName>msbuild.heatfile</OutputName>
   <OutputType>Package</OutputType>
   <WixToolPath>..\..\YourHeatDir</WixToolPath>
   <WixToolPath>$(WixToolPath)</WixToolPath>
   <Cultures>en-us</Cultures>
   <LinkerBaseInputPaths>..\..\data\HeatDir</LinkerBaseInputPaths>
 </PropertyGroup>
 <ItemGroup>
   <Compile Include="product.wxs" />
   <Compile Include="TestDir.wxs" />
 </ItemGroup>
 <Import Project="$(WixToolPath)\Wix.targets" />
 <UsingTask TaskName="HeatDirectory"
   AssemblyFile="$(WixToolPath)WixUtilExtension.dll" />
 <Target Name="BeforeBuild">
   <HeatDirectory
      Directory="..\..\data\HeatDir"
      DirectoryRefId="DataDir"
      OutputFile="TestDir.wxs"
      AutogenerateGuids="true"
      ToolPath="$(WixToolPath)" />
 </Target> 
```

这需要粘贴到您的项目文件中，并且需要更改适当的设置/路径。这将执行您指定路径中的所有文件并创建一个 TestDir.wxs 文件，然后您可以按组件组引用该文件。有几个 Heatdirectory 选项，您需要查看 heat 源代码以了解详细信息。

*仅供参考：在发布我的问题后，我在 stackoverflow 上找到了这篇文章：[如何将整个目录或项目输出添加到 WiX 包](https://stackoverflow.com/questions/414685/how-to-add-a-whole-directory-or-project-output-to-wix-package/629039) 另外作为参考我刚刚在这里看到了这篇文章： [Harvesting a .csproj with heat.exe in Visual Studio 2008和 WiX(v3)](https://stackoverflow.com/questions/745267/wixv3-harvesting-a-csproj-with-heat-exe-in-vs2008)。同样，这可以使用热任务来完成。
两者都讨论了使用第三方工具。一个叫Mallow，另一个叫Paraffin。我认为石蜡看起来很受支持，并且几乎可以做热所做的事情。添加一些内容：有关详细信息，请参见此处：http: [//www.wintellect.com/cs/blogs/jrobbins/archive/2007/10/18/wix-hints-for-new-users-part-1-of- 3.aspx](http://www.wintellect.com/cs/blogs/jrobbins/archive/2007/10/18/wix-hints-for-new-users-part-1-of-3.aspx)*

无论如何希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T20:29:05.153

新的 HeatTasks 在这里可能非常适合您。他们可以从 Visual Studio 中的其他项目中提取项目输出组。它在最新版本中的表现比旧版本好得多，因此请务必每周阅读一次[http://wixtoolset.org/releases/](http://wixtoolset.org/releases/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T17:39:58.070

事实上，我们正在使用 msbuild 中的 heat.exe。如果您像我一样挑剔，那么 heat 的输出可能并不是您想要的，但这很容易通过 XSL 转换来纠正（我相信 heat.exe 有一个专门用于此目的的命令行参数）。

# jsp - 如何在jsp中的ac：if语句中执行OR

> ID：710688
> 
> 赞同：2
> 
> 时间：2009-04-02T17:13:02.363
> 
> 标签：jsp, jstl

如何正确声明 or 声明我尝试这个但没有成功：

<c:forEach var="route" items="${map.street}"> <c:if test="${route.value.type == 'road' || route.value.type == 'street '}">

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T17:17:27.500

按位包含 OR --> |

逻辑或 --> ||

所以...

```
if ( true || false )
{
    /* the first expression is evaluated, it is true, we enter the 'if' block */
}

int i = 1 | 0;  /* i == 1 */ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T18:30:15.830

根据[http://java.sun.com/j2ee/1.4/docs/tutorial/doc/JSIntro7.html](http://java.sun.com/j2ee/1.4/docs/tutorial/doc/JSPIntro7.html) || 应该管用。使用el时，我一般用'or'代替'||' 但我不确定我为什么要这样做。

# function - 没有副作用的确定性函数的术语？

> ID：710692
> 
> 赞同：4
> 
> 时间：2009-04-02T17:14:01.330
> 
> 标签：function, computer-science, idempotent

对于特定类型的功能，我需要适当的术语。

假设您在 SQL 数据库中编写了一个函数，其输入和输出包含在数据库事务的范围内。

也就是说，如果您在数据库事务的范围内调用此函数，则该函数使用的所有数据在同一范围内都是可用的。它可以查询数据库表，但不能从文件系统读取文件，或 ping 网站等。如果您在单个事务中`REPEATABLE READ`隔离调用该函数两次，您应该得到相同的结果，即使其他客户端正在对数据库进行更改。

同样，该函数没有副作用，除非在相同的事务范围内。不允许在数据库事务范围之外更改状态。该函数不应该发送电子邮件，也不应该写入文件系统，也不应该在 中存储值`memcached`等。如果该函数更改数据库中的数据，那没关系，因为如果调用事务回滚，那么该函数的效果也是如此.

函数的参数没问题，因为它们基本上用作常量。

这种类型的功能的正确术语是什么？“确定性”似乎还不够具体。您如何描述此类功能？

* * *

感谢您的回答，但它们都不是我的想法。幂等最接近，所以我将其标记为已接受的答案。但是无论如何，你们每个人都得到了我的支持。

*   **纯函数**没有副作用，它们的结果完全基于它们的参数。给定相同参数的结果总是相同的。这不行，因为我想到的数据库函数可以基于数据的状态，函数也可以影响数据的状态。

*   **幂等函数**可以根据数据的状态返回一个结果，并且给定相同的数据状态，结果总是相同的。但这并不完全符合我的想法。无论调用多少次，幂等函数的效果都必须导致结果不变。但是在事务隔离内所做的更改和在该范围之外所做的更改之间没有区别。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T17:22:04.917

您也可以调用这些[纯函数](http://en.wikipedia.org/wiki/Pure_function)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T17:20:23.517

你在问[幂等](http://en.wikipedia.org/wiki/Idempotent)吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T17:21:20.517

直到第四段，我认为它只是一个纯函数，事务作为隐式参数。但是当你说：

> 该函数没有副作用，除非在相同的事务范围内。不允许在数据库事务范围之外更改状态。

我不确定。您的意思是它可以*在*交易中进行更改，但在未来的通话中无法识别它们吗？你如何把它与：

> 如果在单个事务中使用 REPEATABLE READ 隔离调用该函数两次，则应该得到相同的结果

换句话说，您是否将事务中的副作用限制为多次执行时具有相同效果的赋值（例如将标志设置为 true）？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-11T00:52:52.767

这里有两个不同的概念，因此您可能需要组合多个术语，原因相同，没有一个形容词可以描述“红色圆形房屋”。

> > 不允许在数据库事务范围之外更改状态。
> 
> > 如果函数改变了数据库中的数据，那没关系，因为如果调用事务被回滚，那么函数的效果也是如此。

只有“数据库范围”和“会话范围”。函数没有“事务范围”的概念。函数可以在事务内部或事务外部使用*，*但从函数的角度来看没有区别。

在函数的眼中，“事务范围”就是**“**数据库范围”。未提交事务中的事物不应该被提交，并且由于这适用于所有事务，因此没有什么特别之处：

> 如果您在具有 REPEATABLE READ 隔离的单个事务中调用该函数两次，您应该得到相同的结果，即使其他客户端正在数据库中进行更改。

因为那是描述交易，而不是功能。我们可以放心地忽略任何与“交易”有关的描述。

> > 它可以查询数据库表，但它不能从文件系统中读取文件，或 ping 网站等。
> 
> >不允许在数据库~~事务~~范围之外更改状态。该函数不应发送电子邮件，也不应写入文件系统，也不应在 中存储值`memcached`等。
> 
> > 如果函数改变了数据库中的数据，那没关系，~~因为如果调用事务被回滚，那么函数的效果也是如此~~。
> 
> ~~> 但是在事务~~[数据库] 隔离内所做的更改和在该范围之外所做的更改之间没有区别。

最接近的术语可能是“本地数据库”。

> > 同样，该函数没有副作用，**除非**在同一~~事务~~[数据库] 范围内。

这意味着它**有**副作用。

> > 我心目中的数据库函数可以基于数据的状态，函数也可以影响数据的状态。

最接近的术语是 "non-nullipotent" 或*"possibly-stateful"*。

所以结论是“A db-local non-nullipotent function”。

# c - 当我应该和不应该在 C 中使用“const”时感到困惑

> ID：710695
> 
> 赞同：6
> 
> 时间：2009-04-02T17:14:22.143
> 
> 标签：c, pointers, constants

我有一本这样的字典：

```
typedef struct dictNode {
    int key;
    char *value;
    struct dictNode *next;
} Dict; 
```

还有一个**get()**函数，如下所示：

```
char *get(const Dict *dict, int key) {
    if(!dict) return NULL;

    Dict *currPtr = dict;

    while(currPtr) {
        if(currPtr->key == key) {
            return currPtr->value;
        }

        currPtr = currPtr->next;
    }
} 
```

编译此代码会产生以下错误：
**dict.c:85: 警告：初始化丢弃来自指针目标类型的限定符**

此警告指的是以下行：

```
Dict *currPtr = dict; 
```

如果我在该行之前添加一个“const”，如下所示：

```
const Dict *currPtr = dict; 
```

警告消失...

**1）**我不明白的第一件事是：我在**get()的****dict 参数**中添加了“const”，以便编译器在我尝试更改 dict 指向的地址时警告我，否则我将无法在主程序中访问字典导致我丢失了我指向的地址。现在，我正在创建一个新指针**currPtr ，它指向与****dict**相同的位置。这样，我改用这个指针来遍历字典并保持**dict**指针不变。为什么我还需要**const**用于**currPtr**？

 ********2）**我不明白的第二件事是：行**currPtr = currPtr->next;** 正在更改**currPtr**指针，那么，如果我在**currPtr中添加了一个****const**，为什么编译器不会警告我呢？

 **然后我有一个**del()**函数，如下所示：

```
Dict *del(const Dict *dict, int key) {
    if(!dict) return NULL;

    Dict *currPtr = dict;
    Dict *prevPtr = dict;

    while(currPtr) {
        if(currPtr->key == key) {
            prevPtr->next = currPtr->next;
            free(currPtr);
        }

        prevPtr = currPtr;
        currPtr = currPtr->next;
    }

    return dict;
} 
```

*请注意，我知道此删除功能代码不完整，例如，如果我想删除第一个元素，它就无法正常工作。没关系，我晚点说完，证明我的问题就够了……*

**3)**那么，在**get()**函数中我需要将**const**添加到**currPtr**但在这个**del()**函数中，我不需要将**const**添加到**currPtr**或**prevPtr**吗？在这两个函数中，我都在更改**currPtr**指针，在**del()**函数的情况下，我也在更改**prevPtr**指针。为什么**get()**函数需要我在**currPtr**之前添加一个**const**而**del()**函数不需要我在**currPtr**之前添加一个**const**和**********上一页**_********

 ****我基本上可以将整篇文章恢复到：我应该在**get()**和**del()**函数中的确切时间和位置使用**const**以及为什么，以及何时何地不应该使用？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-02T17:32:45.530

如果没有指针，您将拥有

```
const Dict currPtr 
```

这是一个常数字典。现在，如果你把它变成一个指针，你就有

```
const Dict *currPtr 
```

这是一个指向常量字典的指针。这并不意味着指针是恒定的。但这确实意味着指向的 Dict 被视为常量

```
currPtr->key = 10; // error, dict is treated as constant. 
```

但是指针不是

```
currPtr = otherPtr; // possible: the pointer is not constant 
```

如果将指针设为常量，则第二种情况会出错。也保持指向的 dict 不变，这看起来像这样

```
const Dict * const currPtr = init; 
```

现在你不能将 currPtr 设置为指向不同的东西，因为指针现在是常量，而不仅仅是指针指向的东西被这样对待。如果 const 总是对它所产生的东西是正确的，那么有些人喜欢这种外观。这看起来像这样

```
Dict const * const currPtr = init; 
```

这与上一个片段相同。如果您然后从右到左阅读它，它会告诉您它是什么“指向 const Dict 的 const 指针”。如果你有一个类型，那么你如何订购说明符并不重要

```
int const a = 10;
const int b = 10; 
```

两者都是常数整数。这就是为什么我们可以把 c​​onst 放在 Dict 类型说明符的右边。

现在，如果你有一个指针，你总是可以假装你指向一个常量对象，即使这个对象没有被声明为 const。但是，如果您指向的是 const 对象，则不能假装使用非常量对象：

```
int const *p = NULL;
// doesn't work without a cast. Will at least provoke a warning
int *pn = p;

int *p = NULL;
// always works: pretending to point to something const doesn't harm.
int const *pc = p; 
```

请注意，如果您将指针本身设为 const，则规则与此不同。它们类似于应用于其他类型的 const：

```
int const i = 0;
int j = i; // works. we only read the value of i. its const doesn't matter. 

int * const p = NULL;
int * q = p; // works: we only read the value of p (a null pointer). 
```

将值复制到新变量（无论是否为指针）后，新变量不会以任何方式连接到另一个变量，因为读取的值与最初创建值的方式没有关联。其他变量的 const 无关紧要。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-02T17:21:26.883

*“我在 get() 中的 dict 参数中添加了“const”，这样如果我尝试更改 dict 指向的地址，编译器就会警告我”*

在那种情况下，你的意思是`Dict *const dict`，不是`const Dict *dict`。您已将结构声明为 const，而不是指向它的指针。

*“为什么我还需要 const for currPtr”*

因为否则你可以使用 currPtr 来修改字典结构本身，在这个函数中它应该是 const 。

*“行 currPtr = currPtr->next; 正在更改 currPtr 指针，所以，如果我向 currPtr 添加了一个 const，为什么编译器不会警告我”*

相同的原因：如果 const 在您放置的位置，这不是错误。如果 const 位于 currPtr 的另一个位置，那将是。

*否则我将无法访问主程序中的字典，因为我丢失了我指向的地址*

否 - 当主程序调用 get 时，它会将一个指针值传递给例程，这将成为 get 函数中 dict 的值。但是 get 有自己的指针变量，与主程序中的指针变量分开。即使它们恰好都被称为“dict”，改变一个指针也不会改变另一个。

两个变量都指向同一个结构，因此如果您使用该变量来修改结构中的任何字段，那么结果当然会影响这两个代码位。通常，一个名为“get”的函数将是一个只读操作，所以你可以设置参数`const Dict *`。但我认为这是正确的原因，与您的想法略有不同。这是为了保护字典的内容不被更改，而不是为了保护你对它的地址的记录。

但是，对于像这样的链表，const-safety 有点尴尬。即使你有一个 const Dict，它的“next”字段仍然不指向 const。因此，尽管您不能修改第一个节点，但 const-system 不会保护您免于修改列表中的其他节点。C++ 通过函数重载解决了这个问题，因此您可以使用“getnext”函数，如果输入为 const，则返回 const 输出，但如果输入为非常量，则返回非常量输出。您可以使用“getnext”和“getnext_c”在 C 中实现类似的功能，后者具有 const 参数并返回。但是大多数人都不会打扰，包括像 strchr 这样的标准库函数，它在 C 中接受 const char* 但返回 non-const char*。因此，strchr 可能会意外地在 C 中用于将 const 字符串转换为非 const 字符串，而不会发出任何警告。或者故意，在这种情况下，这有点像通过“合法”业务洗钱;-)

*del() 函数不需要我在 currPtr 和 prevPtr 之前添加 const 吗？*

我承认我被难住了。我希望得到与“get”中相同的警告 - 你确定它不存在吗？但是 del 的参数无论如何都不应该是 const ，因为您可能会修改字段。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-02T17:21:46.913

const Dict *dict 表示这是一个指向常量 Dict 值的指针

您可以修改指针，但不能修改值；

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T17:23:22.900

我认为您的主要困惑来自误解

```
const char* p; 
```

这定义了一个指向常量字符的指针。p 中的地址可以改变，但值指针不能。编译器禁止更改 *p，而不是 p。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-02T17:24:32.820

向后阅读指针声明可能会有所帮助：

```
const Dict *dict 
```

方法

'dict' 是一个指向常量的 Dict 的指针。

您可以移动它指向的地址，但它指向的结构被视为常量。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T17:19:51.053

A`const`是一种程序员文档。它告诉自己，你不会尝试修改任何通过`const`合格的东西。

您的`get`功能应该采取，`const Dict *`而您的`del`功能不应该。这`currPtr`是一个walker——它不会改变`Dict`你的对象的逻辑状态，`get`所以它也应该是`const`合格的。但是，在您的`del`情况下，它会改变结构 - 不在`const`这里。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-02T17:23:36.160

广告 1 & 2：`const`原型中的 应用于`Dict`，这意味着

```
char *get(const Dict *dict, int key) 
```

读取为 ... 函数，其类型为指向常量 Dict ... 的指针的（非常量）参数，这意味着您可以更改`dict`，但不能更改。`dict->next`.

如果您想获得您可能想要的效果，请像这样声明

```
char *get(Dict * const dict, int key) 
```

规则是：`const`应用于它左边的单词，除非它在类型名称中的第一个，然后应用于下一个单词。

此外，更改`dict`不会更改主程序中的指针，因为指针是按值传递的。

分配给`currDict`指针时，编译器会检查类型是否兼容，在这种情况下，这意味着您只能添加顶级`const`限定符，而不能像您一样删除。

你应该在哪里使用 const：

在`get()`函数中，您应该在所有 s 上使用 const `Dict`（就像您所做的那样），因为您可能不想在那里更改字典。

在`del()`, 函数中，我不会使用任何`const`s，因为要在那里更改数据。一个好的签名是：

```
char *get(Dict ** dict, int key) 
```

这样您就可以更改调用函数的指针以删除第一个元素。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-02T17:23:59.920

请记住，它可能出现在指针声明的任一侧`const`或*两侧，这在语义上很重要......*`*`

```
const char * foo = bar; 
```

不一样

```
char * const foo = bar; 
```

第一个说*内容*是`const`，第二个说*指针*是`const`。

对于最大的常数有：

```
const char * const foo = bar; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-02T17:28:26.227

编译器会跟踪什么是 const，什么不是 const。一开始，让它们正确可能会很棘手。

对于您的第一点，您正在传递`const Dict *dict`，这意味着您承诺您不会通过 修改任何内容`dict`。然后你将它分配给`Dict * currptr`. 既然`currptr`不是`const`，您可以通过`*currptr`. 编译器必须在某些时候警告您，即使它是 const，您也正在尝试修改某些东西，而正确的位置是当您将 const 指针分配给非 const 指针时。

对于您的第二点，您完全错过了`const`. 如果有`const Dict * currptr`，则将其描述`currptr`为指向 的指针`const Dict`，这意味着您可以更改`currptr`但不能更改`*currptr`。您可以`currptr` `const`使用`Dict * const currptr`，或使其成为指向 const 值的 const 指针`const Dick * const currptr`。

我真的不明白你的第三点。您应该在发布时收到编译器警告`del()`，因为您将指向 const 值的指针分配给指向值的指针。您需要使用`prevptr`非常量，因为您使用它来修改值。函数签名应该是`Dict *del(Dict *dict, int key)`，因为它是你承诺不修改任何`dict`指向的东西，并且无论如何都要这样做。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-02T17:41:00.377

我明白你们所说的大部分内容，而我现在不明白的是，这是...

考虑以下**list()**函数：

```
void list(Dict *dict) {
    if(!dict) return;

    while(dict) {
        printf("KEY: %d\n", dict->key);
        printf("VALUE: %s\n", dict->value);

        dict = dict->next;
    }
} 
```

（使用这个比使用 get() 更简单）

在我的主要我有两个调用这个函数，比如：

```
list(dict);
list(dict); 
```

当然，**dict**插入了一些条目......

据我了解，只有第**一个 list()**应该输出一些东西，因为**dict 指针在****list()**函数中被更改并且最终将指向**NULL**（否则我们将在 list() 调用中处于无限循环中）。发生的事情是**第二个 list()**调用也输出相同的字典，当我认为它不应该输出任何东西时，因为 dict 应该是 NULL，不是吗？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-02T17:50:12.243

“ const 傻瓜指南”：

尽可能使用它。

# c# - ContainsKey 线程安全

> ID：710696
> 
> 赞同：10
> 
> 时间：2009-04-02T17:14:36.603
> 
> 标签：c#, multithreading, dictionary

在以下代码中：

```
public class StringCache
{
    private readonly object lockobj = new object();

    private readonly Dictionary<int, string> cache = new Dictionary<int, string>();

    public string GetMemberInfo(int key)
    {
        if (cache.ContainsKey(key))
            return cache[key];
        lock (lockobj)
        {
            if (!cache.ContainsKey(key))
                cache[key] = GetString(key);
        }
        return cache[key];
    }

    private static string GetString(int key)
    {
        return "Not Important";
    }
} 
```

1) ContainsKey 线程安全吗？IOW，如果在另一个线程向字典中添加内容时正在执行该方法会发生什么？2）第一次返回cache[key]，有没有可能返回乱码？

TIA,

MB

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-02T17:17:35.893

ContainsKey 的固有线程安全性无关紧要，因为 ContainsKey 和 cache[key] 之间没有同步。

例如：

```
if (cache.ContainsKey(key))
   // Switch to another thread, which deletes the key.
   return cache[key]; 
```

MSDN 在这一点上非常清楚：

> 要允许集合被多个线程访问以进行读写，您必须实现自己的同步。

[有关更多信息，JaredPar 在http://blogs.msdn.com/jaredpar/archive/2009/02/11/why-are-thread-safe-collections-so-hard.aspx](http://blogs.msdn.com/jaredpar/archive/2009/02/11/why-are-thread-safe-collections-so-hard.aspx)上发布了一篇关于线程安全的精彩博客文章收藏品。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-02T17:33:13.143

不，如果您在尝试读取时写入值，则 ContainsKey 不是线程安全的。

是的，您有可能取回无效结果——但您可能首先会开始看到异常。

看看 ReaderWriterLockSlim 在这种情况下的锁定 - 它是为做这种事情而构建的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T17:19:36.577

[这是MSDN 文档](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)中所说的：

> 此类型的公共静态（在 Visual Basic 中为 Shared）成员是线程安全的。不保证任何实例成员都是线程安全的。
> 
> Dictionary<(Of <(TKey, TValue>)>) 可以同时支持多个读取器，只要不修改集合即可。即便如此，通过集合枚举本质上不是线程安全的过程。在枚举与写访问竞争的极少数情况下，必须在整个枚举期间锁定集合。要允许集合被多个线程访问以进行读写，您必须实现自己的同步。

如果我没看错，我不相信它是线程安全的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T17:38:37.513

字典不是*线程安全的*。

如果你这么说的话

> 如果另一个线程正在向字典中添加内容时正在执行该方法会发生什么？

那么我想其他功能`cache`也可以访问。您需要将访问（读取和写入）同步到`cache`. 在所有这些操作中使用您的锁定对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T17:40:29.553

我相信它不是线程安全的，

我建议通过下面的链接，它显示了线程安全字典的实现，或者更好地开发自己的同步。

[http://lysaghtn.weebly.com/synchronised-dictionary.html](http://lysaghtn.weebly.com/synchronised-dictionary.html)

# asp.net-mvc - ASP .NET 匿名用户未存储在数据库中

> ID：710701
> 
> 赞同：2
> 
> 时间：2009-04-02T17:15:37.367
> 
> 标签：asp.net-mvc, asp.net-membership, anonymous-users

我正在尝试在 MVC 中设置匿名用户。由于某种原因，它不会将用户存储在数据库中。我在 web.config 中添加了以下内容

```
<anonymousIdentification enabled="true" /> 
```

当我访问该站点时，它成功创建了 .ASPXANONYMOUS cookie，但没有在数据库中创建用户。这是我必须手动做的事情吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T17:17:37.423

如果您尝试保存一些数据，例如此用户配置文件中的某些数据，它将被存储。

# ruby-on-rails - 是否可以在 rails 中自动派生缓存键的组件？

> ID：710712
> 
> 赞同：2
> 
> 时间：2009-04-02T17:18:55.767
> 
> 标签：ruby-on-rails, model-view-controller, caching, introspection, fragment-caching

在 Web 应用程序中为呈现的内容生成缓存键时，您必须考虑所有可能改变结果的变量。
在像 rails 这样的动态环境中，这些可以在不同的地方定义：控制器、模型、会话或服务器环境。它们可以在模板中、在模板中呈现的模板或助手中引用。你能想出一种方法来自动生成有助于渲染模板内容的变量列表，也许使用[ParseTree](http://rubyforge.org/projects/parsetree/)？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-02-09T02:49:20.750

我在我的缓存键中使用了一个“新鲜度键”，可能是从这篇文章中学到的：http: [//blog.leetsoft.com/2007/5/22/the-secret-to-memcached](http://blog.leetsoft.com/2007/5/22/the-secret-to-memcached)

这使我可以轻松地使与资源相关的所有缓存无效，而不管 url，尽管事实上 memcached 不提供用于迭代现有键的工具。

我通常使用 request.url 和登录的用户 id 和 freshness_key 的组合来生成我的，例如

```
# 
# return the freshness_key for caching this particular collection
def get_freshness_key_for(collection_name)
  Rails.cache.fetch("#{self.id}:#{collection_name}") { "#{self.send(collection_name).maximum(:updated_at).to_i}:#{Time.now.to_i}" }
end

# 
# set the freshness_key for caching this particular collection;
# typically called after_save from an Observer for this collection
# 
def set_freshness_key_for(collection_name)
  Rails.cache.write("#{self.id}:#{collection_name}", "#{self.send(collection_name).maximum(:updated_at).to_i}:#{Time.now.to_i}")
end

# returns the cache_key for this client, the desired collection, and the
# current url with the latest freshness_key
# 
# the url is hashed so as not to overrun memcached's key length limit
def cache_key_for(collection_name, request_url)
  freshness_key = self.get_freshness_key_for(collection_name)
  "#{self.id}:#{Digest::MD5.hexdigest(request_url)}:#{freshness_key}"
end 
```

我将在控制器中使用它：

```
@posts_cache_key = cache_key_for(:posts)

@posts = cache(@posts_cache_key) do
  Post.paginate(
    :page => params[:page],
    :per_page => params[:pp]
  )
end 
```

...在视图中：

```
<% cache(:key => "#{@posts_cache_key}:posts_list_fragment") do -%>
  ... html here ...
<% end -%> 
```

通常我会有一个收集模型的观察者：

```
class PostObserver < ActiveRecord::Observer

  def after_save(post)
    post.client.set_freshness_key_for(:posts)
  end

  def after_destroy(post)
    post.client.set_freshness_key_for(:posts)
  end

end 
```

希望这可以帮助

# .net - 什么数据库用于 Windows 应用程序？

> ID：710718
> 
> 赞同：3
> 
> 时间：2009-04-02T17:20:32.050
> 
> 标签：.net, xml, database

我正在.net 中开发一个小型 Windows 应用程序。我应该使用什么数据库？

数据库结构

表 1：不超过 3 个字段：50+ 条记录（添加、删除）

表 2：不超过 10 个字段：10-20 条记录（添加、删除）

我曾想过使用 XMLDatabase，但有人说不建议使用它。造成这种情况的原因是什么？如果可以使用 XML 文件作为数据库，那么您能推荐一些教程或最佳实践吗？我以前使用过 XML 文件。将它用作数据库时有什么不同吗？

我还计划稍后将应用程序分发给我的朋友，这些人不是程序员，他们不太懂技术。

那么如果我使用的是 SQL 服务器，我该如何将它部署在其他机器上呢？如何将其添加到安装文件中？

更新：感谢您的回答。我要使用 SQLite，如果有人感兴趣，这里是关于 SQLite 和 .net的[教程。](http://www.kirupa.com/net/sqllite_vb_pg1.htm)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-02T17:26:33.657

SQLite 是适合小型应用程序的好方法。它速度快、能力强、占地面积小。

对于 .Net，我在以前的项目中使用过一个很棒的托管 SQLite 库：

[http://sqlite.phxsoftware.com/](http://sqlite.phxsoftware.com/)

编辑：

在 SQLite 和 SQL Server Compact 版本之间进行选择时，您几乎总是希望使用 SQLite，除非您需要一些 SQLite 不支持的高级功能。

[我对 SQL Server Compact Edition 的安装大小持正确态度。上次我看它时，它更加不利。现在可能一样好。]

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-02T17:28:54.773

根据您提到的内容，我会查看 SQLite 或查看 SQL Server Compact Edition。

精简版的建议是没有 SQL Server 进程一直在运行。精简版仅在应用程序运行时运行。

*更新*

当谈到两者之间的大小时，SQLite 的大小略低于 1 mb。SQL Server Compact 版本为 1.8mb（请参阅[MS 文档](http://download.microsoft.com/download/A/4/7/A47B7B0E-976D-4F49-B15D-F02ADE638EBE/Compact_Express_Comparison.doc)进行确认）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-02T17:30:06.783

好吧..由于您预计的数据库大小如此之小，一个快速而肮脏的解决方案（比肮脏的恕我直言更快）将是在 XML 中维护您的数据（或将对象集合序列化/反序列化为 XML）并使用 LINQ 进行查询。它很快而且有效。此外，没有与您的应用程序一起分发的数据库引擎。

免责声明：请记住，如果您的数据需求仍然很小（并且假设它是单个用户），那么您的数据需求仍然很小。一旦您有多个用户同时访问您的数据，或者数据大小增加，或者您需要在使用某种 RDBMS 时最有效的功能，这种快速而肮脏的解决方案就会消失，很快您的应用程序将在所有人的重压下崩溃您需要添加额外的代码才能使其正常工作。=)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T17:25:06.280

像 SQLite 这样的小东西，或者你可以在你的应用程序中使用内置的 SQLServer Express 数据库。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-02T17:26:25.840

如果您使用 SQL Server，则有一项功能允许您生成脚本来创建整个数据库。通过通常的 .NET Sql 类（SqlConnection 等），一旦给出有效的连接字符串，就可以很容易地执行脚本。

但是，对于这样一个简单的数据模型，SQL Server 可能是矫枉过正。您应该调查其他较小的数据库，如 SQLite。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-02T18:17:24.267

John Saunders 提到了 SQL Server Express。公平地说，还有 Oracle Express 和 DB2 Express。它们各自的功能列表几乎相同。所有这些都是免费的，至少供个人使用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-02T17:38:54.517

我不确定在您的情况下谁建议不要使用 XML 进行持久性，但在我看来，考虑到持久数据的潜在总大小，XML 非常适合您，因为它可以简单地集成到 .NET 应用程序中。

在我看来，我们只是在谈论 100 条记录，一条记录最多包含 10 个字段。这可以很容易地从 XML 持久数据中进行预处理并在内存中处理。我同意 NoCarrier 关于可能使用 LINQ 进行查询的观点。

您正在寻找简单性，而您的用户听起来就像他们可以在没有 3rd 方依赖的情况下做到这一点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-02T17:27:55.400

查看 SQL Server Express 或 SQL Server Compact Edition。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-02T18:01:08.877

我同意 XML 作为数据源解决方案。有一本很好的 XML 书：[No Nonsense XML Development with PHP](http://www.sitepoint.com/books/xml1/)。您可以轻松地将 PHP 转换为 ASP.NET。还有用于 XML 和 ASP.NET 的免费电子书。

XML 为您提供的优势是它是一种简单的数据传输语言，您不需要在部署到的机器上安装第三方数据库服务器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-02T18:12:14.843

> 表 1：不超过 3 个字段：50+ 条记录（添加、删除）
> 
> 表 2：不超过 10 个字段：10-20 条记录（添加、删除）

如果您的记录大小合适（您不想在应用程序中存储电影或类似内容，对吗？）我建议在启动时从平面文本或 xml 文件中读取并将所有内容保存在内存中。您可以不时将缓冲区刷新到磁盘。

我不知道您的其他要求（并发性如何？），但恕我直言，真正的 DBMS 可能对您的问题来说太过分了，而 sqlite（我非常喜欢）可能不是解决方案（同样，并发性，它不是 sqlite 的优势之一）。

# c# - 如何在 DB2 Text Search 中使用参数化语句？

> ID：710723
> 
> 赞同：1
> 
> 时间：2009-04-02T17:21:05.993
> 
> 标签：c#, search, parameters, full-text-search, db2

我试过这个：

```
select * from ourschema.mytable 
    where contains(mysearchablefield, @searchTerms) = 1; 
```

@searchTerms 设置为“搜索词”的位置

不幸的是，它只产生了一个错误：

```
ERROR [42610] [IBM][DB2/NT] SQL0418N A statement contains a use of a parameter marker that is not valid. SQLSTATE=42610 
```

有没有办法在 DB2 中使用参数化查询进行文本搜索？如果没有，是否有文档详细描述了手动（ugh）转义搜索词（引号等）的语法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T18:12:27.120

~~Instead of @field you need to use "?". Everything is basically the same.~~

Okay, here is a live code sample.

```
 sqlStmt = "SELECT COMPLAINT_NUMBER, VIOLATION_NUMBER, COMMON_ADDRESS_KEY, " +
            "DEPT_CODE, DEPT_CODE_DESC, DIVISION_CODE, DIVISION_CODE_DESC, " +
            "EMPLOYEE_NAME, COMPLAINT_CODE, COMPLAINT_CODE_DESC, COMPLAINT_DATE, " +
            "COMMON_ADDRESS_OWNER, RESOLUTION_CODE, 1 AS SORTORDER " +
            "FROM QMFILES/NVMASTP " +
            "WHERE VCLOSEDATE = 0 AND " +
            "DEPT_CODE LIKE @DEPT_CODE1 AND " +
            "DIVISION_CODE LIKE @DIVISION_CODE1 AND " +
            "COMPLAINT_DATE BETWEEN @FROM_COMPLAINT_DATE1 AND @TO_COMPLAINT_DATE1 " +
            statusQry +
            "UNION " +
            "SELECT COMPLAINT_NUMBER, VIOLATION_NUMBER, COMMON_ADDRESS_KEY, " +
            "DEPT_CODE, DEPT_CODE_DESC, DIVISION_CODE, DIVISION_CODE_DESC, " +
            "EMPLOYEE_NAME, COMPLAINT_CODE, COMPLAINT_CODE_DESC, COMPLAINT_DATE, " +
            "COMMON_ADDRESS_OWNER, RESOLUTION_CODE, 2 AS SORTORDER " +
            "FROM QMFILES/NVMASTP " +
            "WHERE VCLOSEDATE <> 0 AND " +
            "DEPT_CODE LIKE @DEPT_CODE2 AND " +
            "DIVISION_CODE LIKE @DIVISION_CODE2 AND " +
            "COMPLAINT_DATE BETWEEN @FROM_COMPLAINT_DATE2 AND @TO_COMPLAINT_DATE2 " +
            statusQry +
            "ORDER BY DEPT_CODE, DIVISION_CODE, COMPLAINT_CODE, SORTORDER";

        iDB2Command cmd = new iDB2Command(sqlStmt, conn);
        conn.Open();
        cmd.DeriveParameters();
        conn.Close();
        cmd.Parameters["@DEPT_CODE1"].Value = dept;
        cmd.Parameters["@DIVISION_CODE1"].Value = serviceArea;
        cmd.Parameters["@DEPT_CODE2"].Value = dept;
        cmd.Parameters["@DIVISION_CODE2"].Value = serviceArea;
        cmd.Parameters["@FROM_COMPLAINT_DATE1"].Value = Convert.ToDecimal(fromDateString);
        cmd.Parameters["@TO_COMPLAINT_DATE1"].Value = Convert.ToDecimal(toDateString);
        cmd.Parameters["@FROM_COMPLAINT_DATE2"].Value = Convert.ToDecimal(fromDateString);
        cmd.Parameters["@TO_COMPLAINT_DATE2"].Value = Convert.ToDecimal(toDateString); 
```

I hope this helps you out more.

# asp.net - 重写 ASP.NET 页面输出

> ID：710725
> 
> 赞同：1
> 
> 时间：2009-04-02T17:21:12.657
> 
> 标签：asp.net, session

一点背景知识：我正在尝试使用高度剥离的 ASP.NET 实现来创建一个轻量级的无 cookie 数据库支持的用户会话。该站点的受众将是通过蜂窝网络连接的移动用户，因此页面大小需要非常小。我没有使用 .NET 会话、视图状态等，并且大多数页面包含很少（如果有的话）服务器控件。

我希望能够处理页面请求的输出，以便我可以使用自己的会话信息修改响应中的内部链接。我已经读到有一个 ISAPI 过滤器允许 ASP.NET 之前的无 cookie 会话。这基本上就是我想要构建的，就在应用程序内部。

有没有人做过这样的事情？由于其他原因，我已经为我的页面库继承了 System.Web.UI.Page 类。看来我应该可以从这里做点什么了。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T17:24:21.197

考虑为此使用 HttpModule。您可以在退出时处理整个响应。

您还可以使用基类做一些事情——也许在 PreRenderComplete 事件中浏览所有可能在其中包含链接的服务器端控件。但是，这不会帮助您处理 HTML`<A>`标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T17:32:30.647

HttpModules 可以让您完全控制您的输出，但您还可以做一些其他更简单的事情。

1.  为 Response.Filter 创建一个自定义过滤器。您或多或少地创建了一个流，您可以在将其发送到底层流之前运行所有内容，让您在那里进行更改。

2.  覆盖页面的渲染事件并将所有内容写入字符串，然后在那里进行更改......例如......

.

```
//this is from memory, you might need to check it
override void Render(HtmlTextWriter writer) {

StringWriter html = new StringWriter();
HtmlTextWriter render = new HtmlTextWriter(html);
base.Render(render);
string output = html.ToString()

//make your changes to output
//output = ???

writer.Write(output);

} 
```

# html - 有没有办法在 Eclipse 中将代码导出为 HTML？

> ID：710726
> 
> 赞同：11
> 
> 时间：2009-04-02T17:21:16.603
> 
> 标签：html, eclipse, export

我知道 NetBeans 有这个功能，但我在 Eclipse 中找不到。快速搜索插件没有成功。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T17:26:30.647

[Java2Html - Eclipse 插件](http://www.java2html.de/eclipse.html)：

> **转换文件：**
> 在 Package Explorer、Navigator 或其他视图中选择项目，然后右键单击以打开上下文菜单。有一个 Java2Html 菜单项可以打开转换对话框。
> 
> **从文本编辑器转换文本：**
> 右键单击编辑器并选择 Java2Html 上下文菜单项以转换当前选定的文本。
> 
> **调整首选项：**
> 可以在首选项页面（菜单“窗口”-“首选项”-“Java”-“Java2Html”）上调整转换的颜色、选项卡大小等...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T17:28:00.767

Hackish 方式：
至少在 Windows 上，当您执行`Ctrl`- `A`（全选）、`Ctrl`+ `C`（复制）时，实际复制到剪贴板的是格式化文本（包含所有颜色和字体）。`Ctrl`然后，您可以将 ( - )粘贴`V`到可以接受格式化文本的内容上，例如 Microsoft **Word**甚至是**写字板**，然后将其保存为您希望的任何格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T19:51:19.873

> Copy as HTML eclipse IDE 插件允许我们直接将代码复制为 HTML 并将其粘贴到我们的博客或论坛中，无需任何格式。
> 
> [下载 Copy as HTML eclipse 插件![下载图标](https://i.stack.imgur.com/GBwtd.jpg)](https://docs.google.com/uc?export=download&confirm=no_antivirus&id=0B5oSxq3ttZaEQjA2OXhfMGM1YkE)
> 
> 安装插件步骤：
> 
> 1.  下载 Copy as HTML eclipse 插件
> 2.  将其复制到 Eclipse 安装的“dropins”文件夹中
> 3.  如果“dropins”文件夹不存在，则将其复制到 Eclipse 安装的“plugins”文件夹中
> 4.  重启eclipse IDE
> 5.  就是这样
> 
> 使用步骤
> 
> 1.  选择要复制的代码或文本
> 2.  选择“复制为 HTML”选项或按“cntrl+shift+3”
> 3.  将它粘贴到您的精彩博客中
> 
> ![复制为 HTML](https://i.stack.imgur.com/H7YgE.png)

取自这里：http:
[//java-sample-program.blogspot.hu/2012/12/copy-as-html-eclipse-plugin.html](http://java-sample-program.blogspot.hu/2012/12/copy-as-html-eclipse-plugin.html)

# c# - 将 ISerializable 与 DataContractSerializer 一起使用时，如何阻止序列化程序输出类型信息？

> ID：710745
> 
> 赞同：13
> 
> 时间：2009-04-02T17:26:15.407
> 
> 标签：c#, .net, xml, datacontractserializer, serializable

为了更好地控制序列化，我将一个类从 转换`[DataContract]`为`[Serializable]`，同时实现`GetObjectData`了特殊的反序列化构造函数。当我这样做时，发出的 XML 现在具有应用于所有元素的类型信息。我不想要这些多余的信息，我想知道如何通知序列化程序不要输出它。

这是使用的示例代码`[DataContract]`：

```
[DataContract(Namespace = "")]
class Test 
{
    public Test() { }
    [DataMember]
    public Nullable<int> NullableNumber = 7;
    [DataMember]
    public int Number = 5;

    public static void Go()
    {
        var test = new Test();
        var dcs = new DataContractSerializer(typeof(Test));
        using (var s = new StreamWriter("test.xml"))
        {
            dcs.WriteObject(s.BaseStream, test);
        }
    }        
} 
```

这将输出以下 XML（注意 Nullable Number 和 Number 上没有类型信息——这是所需的输出）：

```
<Test xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
  <NullableNumber>7</NullableNumber>
  <Number>5</Number>
</Test> 
```

如果我将上面的代码修改如下（添加[Serializable]，：ISerializable，以及两个序列化方法）：

```
[Serializable]
class Test : ISerializable
{
    public Test() { }
    public Nullable<int> NullableNumber = 7;
    public int Number = 5;

    public static void Go()
    {
        var test = new Test();
        var dcs = new DataContractSerializer(typeof(Test));
        using (var s = new StreamWriter("test.xml"))
        {
            dcs.WriteObject(s.BaseStream, test);
        }
    }        
    public Test(SerializationInfo info, StreamingContext context)
    {
        NullableNumber = info.GetInt32("NullableNumber");
        Number = info.GetInt32("Number");
    }

    public void GetObjectData(SerializationInfo info, StreamingContext context)
    {
        info.AddValue("NullableNumber", NullableNumber);
        info.AddValue("Number", Number);
    }
} 
```

它现在发出以下 XML。注意添加到每个元素的类型信息 (i:type="x:int")。

```
<Test xmlns="http://schemas.datacontract.org/2004/07/XMLSerialization" xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns:x="http://www.w3.org/2001/XMLSchema">
  <NullableNumber i:type="x:int" xmlns="">7</NullableNumber>
  <Number i:type="x:int" xmlns="">5</Number>
</Test> 
```

为什么要这样做？我该如何阻止它这样做？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T23:00:19.813

你需要`ISerializable`这里吗？常客`DataContractSerializer`没有给你什么？如果你切换回这个，它应该可以正常工作。

基本上，通过实现自定义序列化，数据不再是基于契约的——所以它*必须*包含这些额外的信息以保证它以后能够理解它。

那么：在这种情况下是否有理由实施`ISerializable`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-29T22:18:39.700

如果要完全控制对 xml 的序列化，可以使用 XmlSerializer

```
public class Test
{
    [XmlIgnore]
    public Nullable<int> NullableNumber = 7;

    [XmlElement("NullableNumber")]
    public int NullableNumberValue
    {
        get { return NullableNumber.Value; }
        set { NullableNumber = value; }
    }

    public bool ShouldSerializeNullableNumberValue()
    {
        return NullableNumber.HasValue;
    }

    [XmlElement]
    public int Number = 5;
} 
```

示例序列化代码：

```
static void Main(string[] args)
{
    XmlSerializer serializer = new XmlSerializer(typeof(Test));
    serializer.Serialize(Console.Out, new Test());
} 
```

结果：

```
<Test xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Number>5</Number>
  <NullableNumber>7</NullableNumber>
</Test> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-06T20:32:31.373

从 .Net Framework 4.5（和 .Net Core 1.0）开始，可以使用以下`DataContractJsonSerializerSettings`类：

```
DataContractJsonSerializerSettings settings = new DataContractJsonSerializerSettings
{
    EmitTypeInformation = EmitTypeInformation.Never
};
var dcs = new DataContractSerializer(typeof(Test), settings); 
```

设置告诉序列化器在序列化过程中`EmitTypeInformation`不要输出（烦人的？）`__type`参数。

还有一系列其他有用的设置可用。 [这](https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.json.datacontractjsonserializersettings)是`DataContractJsonSerializerSettings`.

# javascript - ie8 var w= window.open() - “消息：无效参数。”

> ID：710756
> 
> 赞同：113
> 
> 时间：2009-04-02T17:27:47.337
> 
> 标签：javascript, internet-explorer-8

我有一个仅存在 IE8 问题的网站：

代码是：

```
var w = window.open(urlstring, wname, wfeatures, 'false'); 
```

错误是：

> 消息：无效的参数。
> 行：419 字符：5
> 代码：0
> URI：[http://HOSTNAME/js_context.js](http://HOSTNAME/js_context.js)

我已经确认了代码的行号（“Line”和“URI”是正确的），并且我理解在IE8的更高版本中，这被认为是准确的。

我通过转储警报检查了调用中的所有传入参数，它们看起来都有效。

这个问题不会发生在FF上（可能是3）。

更新：

问题似乎在于在执行“var w”时使用分配 window.open() 的结果。当我将该行分成两个语句时，它可以在 IE8 中使用。

更新2：

基于：

[http://javascript.crockford.com/code.html](http://javascript.crockford.com/code.html)

> 当要立即调用函数时，应将整个调用表达式包裹在括号中，以便清楚地生成的值是函数的结果，而不是函数本身。

这不完全是这里发生的事情，但我发现应用该原理解决了问题，在 IE8 的兼容模式下。

```
var w = (window.open(urlstring, wname, wfeatures, false)); 
```

* * *

## 回答 #1

> 赞同：251
> 
> 时间：2009-09-22T20:46:36.193

这是一个旧帖子，但可能对某人仍然有用。

我有同样的错误信息。最后问题是第二个参数的名称无效，即我有这样一行：

```
 window.open('/somefile.html', 'a window title', 'width=300'); 
```

问题是“窗口标题”，因为它无效。它适用于以下行：

```
 window.open('/somefile.html', '', 'width=300'); 
```

事实上，仔细阅读我意识到微软不支持`name`作为第二个论点。当您查看[官方文档页面](http://msdn.microsoft.com/en-us/library/ms536651%28v=vs.85%29.aspx)时，您会看到 Microsoft 只允许使用以下参数，如果使用该参数的话：

*   _空白的
*   _媒体
*   _父
*   _搜索
*   _自己
*   _最佳

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2010-01-12T21:30:10.503

IE 对窗口名称参数很挑剔。它不喜欢空格、破折号或其他标点符号。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2011-01-13T15:29:48.103

当您`window.open`在 IE 中调用时，第二个参数（窗口名称）必须是预定义的**目标**字符串之一或一个字符串，该字符串在 JavaScript*中具有有效标识符的形式。*

那么在 Firefox 中有效：“Job Directory 9463460”，在 Internet Exploder**中无效**，必须替换为：例如“Job_Directory_9463460”（没有空格，没有减号，没有点，它必须是一个有效的标识符） .

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-29T21:22:11.383

问题可能是 wname，尝试使用上面链接中显示的名称之一，我引用：

> 选修的。指定窗口名称的字符串。此名称用作表单或锚元素上的 TARGET 属性的值。
> 
> *   _blank sURL 被加载到一个新的、未命名的窗口中。
> *   _media url 在 Microsoft Internet Explorer 6 的媒体栏中加载。Microsoft Windows XP Service Pack 2 (SP2) 及更高版本。不再支持此功能。默认情况下，url 被加载到新的浏览器窗口或选项卡中。
> *   _parent sURL 被加载到当前框架的父级。如果框架没有父框架，则此值充当值 _self。
> *   _search 在 Windows Internet Explorer 7 中禁用，有关详细信息，请参阅 Internet Explorer 7 中的安全性和兼容性。否则，将在 Internet Explorer 5 或更高版本的浏览器搜索窗格中打开 sURL。
> *   _self 当前文档被替换为指定的 sURL。
> *   _top sURL 替换任何可能加载的框架集。如果没有定义框架集，则此值充当值 _self。

如果使用另一个 wname，window.open 将不会执行...

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-06-11T20:48:45.147

实际上可以使用名称，但它不能有空格，所以 `window.open("../myPage","MyWindows",...)`应该没有问题（[window.open](http://www.w3schools.com/jsref/met_win_open.asp)）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-12-05T10:31:11.643

我在使用以下代码时也遇到了这个问题：

```
window.open('test.html','Window title','width=1200,height=800,scrollbars=yes'); 
```

但是当我删除**“窗口标题”的空白**时，下面的代码正在工作：

```
window.open('test.html','Windowtitle','width=1200,height=800,scrollbars=yes'); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-06-20T13:11:32.227

嗨使用以下代码它的工作...

```
onclick="window.open('privacy_policy.php','','width=1200,height=800,scrollbars=yes'); 
```

以前我输入喜欢

```
onclick="window.open('privacy_policy.php','Window title','width=1200,height=800,scrollbars=yes'); 
```

意味着微软不允许您输入窗口名称，它在`window.open`功能中应该是空白的......

谢谢， Nilesh Pangul

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-11-08T04:47:14.367

对我来说，问题在于窗口名称字段中的破折号“-”。我删除了破折号，IE 没有出错，实际上打开了窗口。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-02T17:30:03.507

位置四代表什么，具有“假”作为值的位置？那不应该是错误的（即没有引号吗？）。早期版本的 IE 可能会将字符串强制转换为布尔值，但较新的版本不会。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-01-23T18:46:17.053

这里的答案是正确的，因为在 window.open() 中设置标题时 IE 不支持空格，似乎没有一个提供解决方法。

我从 window.open 调用中删除了标题（您可以使用 null 或 ''），然后 hten 将以下内容添加到正在打开的页面中：

```
<script>document.title = 'My new title';</script> 
```

无论如何都不理想，但这将允许您在所有浏览器中将标题设置为您想要的任何内容。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-02T17:29:38.017

尝试删除最后一个参数。除此之外，请确保存在 urlstring、wname 和 wfeatures。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-05T15:54:27.827

我发现了同样的问题，在阅读了假设问题是由窗口名称引起的第一个答案后，将其更改为：首先更改为“_blank”，它工作正常（兼容性和常规视图），然后更改为之前的值，仅减去值中的空间:) - 也有效。IMO，问题（或部分问题）是由 IE 无法使用普通字符串值作为 wname 引起的。如果有人遇到同样的问题，希望这会有所帮助。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-03-24T20:54:50.623

如果您想使用新窗口的名称等将表单发布到此窗口，那么在 IE、FF、Chrome 中工作的解决方案：

```
 var ret = window.open("", "_blank");
  ret.name = "NewFormName";

  var myForm = document.createElement("form");
  myForm.method="post";
  myForm.action = "xyz.php";
  myForm.target = "NewFormName";

      ... 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-04-17T18:01:27.923

似乎即使使用 window.open 使用“有效”自定义窗口名称（不是 _blank 等）来启动新窗口，仍然存在问题。第一次单击链接时它工作正常，但如果再次单击它（第一个启动的窗口仍然打开），您会收到“错误：不支持此类接口”脚本调试。

# apache-flex - 如何在 Flex 中实现链接列表？

> ID：710772
> 
> 赞同：0
> 
> 时间：2009-04-02T17:32:43.377
> 
> 标签：apache-flex, flexbuilder

我有一个代表链接的字符串数组。我想在列表中显示它们并使它们像链接一样工作。我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T17:40:16.777

您可以使用 LinkBut​​ton 作为 itemRenderer 创建一个列表。您还需要将事件侦听器添加到列表中以实际进行导航。使用 navigateToURL 运行链接。列表的 MXML：

```
<mx:List id="myList" 
    itemRenderer="mx.controls.LinkButton"
    click="navigateToURL(new URLRequest(myList.selectedItem.text))"> 
</mx:List> 
```

然后在 actionscript 部分（或者如果你愿意，你也可以在 MXML 中设置它）。

```
myList.dataProvider = arrayOfLinkStrings; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T11:48:25.357

将 LinkBar 与 ViewStack 一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T03:54:14.030

navigateToURL 在 AIR 中工作。它将打开默认的系统浏览器并打开被点击的页面。对于列表，您将需要使用 itemClick 而不是常规点击。就我个人而言，我会将 click 事件处理程序添加到 ItemRender，扩展标签（使用 buttonMode=true 并且可能是翻转）并将对 navigateToURL 的调用放在自定义 itemRenderer 中。

[Peter Ent 的 5 部分 itemRender 系列非常棒。](http://weblogs.macromedia.com/pent/archives/2008/05/itemeditors_-_p.html)

# sql-server - 单元测试 TSQL

> ID：710776
> 
> 赞同：10
> 
> 时间：2009-04-02T17:33:44.247
> 
> 标签：sql-server, unit-testing, tsql, testing

有没有人为他们的 TSQL 存储过程、触发器、函数等编写单元测试？

我最近开始制作数据库并恢复和安装我们自动化巡航控制构建过程的一部分。现在我正在考虑将其提升到我们进行安装的下一个级别，然后运行存储过程测试列表等。

我打算自己使用 MsBuild Extensions 来调用测试。但是我知道[http://www.tsqltest.org/](http://www.tsqltest.org/)和[http://tsqlunit.sourceforge.net/](http://tsqlunit.sourceforge.net/)。我也知道 TFS 有 sql 测试。

我只是想看看现实世界中的人们在做什么，以及他们是否有任何建议。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T18:53:50.420

关键部分：

*   使其**自动化**并与您的构建/测试**集成**（因此您的构建中有绿色或红色）
*   轻松添加新测试
*   让您的测试保持最新

先进的：

*   测试代码中的失败条件
*   确保您的测试自行清理（TSqlTest 的示例脚本使用 @beforeCount 和 @afterCount 变量来验证清理）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T17:54:43.777

存储过程。我通常在 SP 标头的注释中包含测试查询，并记录正确的结果和查询时间。但是，这仍然将其保留为手动练习。）

功能。同样，将 SQL 语句放在具有相同信息的标题中。

触发器。我避免使用它们的原因有很多，其中一个原因是与将相同的逻辑放在另一层相比，它们很难测试和调试，但收益很少。这就像询问如何测试参照完整性。

然而，这仍然是一个手动过程。但是，由于我认为应该有意将 SQL 工件设计为完全解耦（例如，没有 SP 调用 SP，与函数相同，以及另一个针对触发器的攻击恕我直言），它相对不那么复杂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T18:58:06.090

我已经在 java 中使用 dbunit 完成了这项工作。

基本上，您在数据库中所做的任何事情：返回结果集或更改数据库的状态。

数据库的状态可以描述为数据库所有模式中所有表中所有行中的所有值；任何子集的状态是受某些测试影响的所有数据的状态。

因此，从一个充满足够测试数据的数据库开始，您可以执行测试，称之为基线。使用 dbunit 或您选择的工具提取快照。

鉴于您的数据库处于基线状态，任何结果集都是确定性的（只要您的 sp 是确定性的，如果它执行“select random();”则更少）。

获取所有 SP 的基线结果集，使用 dbunit 或您正在使用的任何工具将它们保存为快照。

要测试不更改状态的操作，只需测试您获得的结果集是否是您最初获得的结果集。要测试更改数据库的操作，请测试基线 + 操作 = 预期更改。在每次可能更改数据库的测试之后，将其恢复到基线。

基本上，恢复到基线的能力使测试成为可能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T08:29:54.200

Have you tried using the red-gate.com API?

They have a bunch of products for comparing things in SQL Server and the API allows virtually the same functionality programmatically.

[http://help.red-gate.com/help/SQLDataCompareAPIv5/4/en/GettingStartedAPI.html](http://help.red-gate.com/help/SQLDataCompareAPIv5/4/en/GettingStartedAPI.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T17:51:26.077

我在这里的一个项目中使用了内置于 Visual Studio 2008 数据库版中的数据库测试。它运行良好，但感觉更像是 Visual Studio 的第三方插件，而不是原生组件。我感受到的一些痛苦是：

*   由于 SQL 代码位于 res 文件中，并且单个代码文件可以包含多个测试，因此根据表/列名称搜索测试并不容易。
*   因为多个测试存在于同一个代码文件中，所以您会遇到一些烦人的变量名称冲突（例如，如果您在一个代码文件中有两个测试，那么这些测试的所有断言都必须具有唯一的名称；这意味着您的断言名称将可能看起来像“testname_assertionname”，实际上没有必要）。
*   重构你的测试并不容易——例如，如果你想将一个测试从一个代码文件移动到另一个，最简单的方法是在新文件中从头开始创建测试，因为测试的零碎分散在res文件和代码文件。

所有这一切都说，正如我开始的那样 - 它确实运作良好。不幸的是，我们还没有将这些测试添加到我们的持续集成服务器中，所以我无法评论自动化运行这些测试有多么容易。我们将 TFS 用于 CI，我假设测试的自动化与标准单元测试的自动化非常相似；换句话说，似乎应该有一个 MSTest 命令行来运行测试。

当然，如果您获得了运行 Visual Studio 2008 DB 版的许可（据我所知，它现在包含在 VS 2008 Pro 许可中），这只是一个选项。

# php - 插入 6000 行 - 最佳实践

> ID：710777
> 
> 赞同：3
> 
> 时间：2009-04-02T17:34:00.643
> 
> 标签：php, mysql, api, insert

我有一个 PHP 脚本，它调用一个可以轻松返回 6k+ 结果的 API 方法。

我使用 PEAR DB_DataObject 将 foreach 循环中的每一行写入数据库。

上面的脚本一次批处理 20 个用户——虽然有些人只会从 API 中得到一些结果，但其他人会得到更多。最坏的情况是所有人都有 1000 个结果。

调用 API 的循环似乎没问题，每 5 分钟 20 批工作正常。我唯一担心的是每个用户有 1000 个 mysql INSERTs（每个用户之间有很长的暂停以进行新的 API 调用）

有没有好的方法来做到这一点？还是我做得很好？！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T17:40:25.073

好吧，最快的方法是执行一个包含大量值的插入语句，如下所示：

```
INSERT INTO mytable (col1, col2) VALUES ( (?,?), (?,?), (?,?), ...) 
```

但这可能需要放弃您现在使用的 DB_DataObject 方法。您只需权衡这样做的性能优势与使用 DB_DataObject 的“易用性”优势。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T17:53:41.393

就像 Kalium 所说，检查瓶颈在哪里。如果它真的是数据库，您可以尝试一些 DBMS 提供的批量导入功能。

例如，在 DB2 中，它被称为 LOAD。它在没有 SQL 的情况下工作，但直接从命名管道读取。当您需要将大量新行带入数据库时​​，它的设计速度特别快。它可以配置为跳过检查和索引构建，使其更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T17:36:07.863

那么，您的方法产生的负载是否超出您的处理能力？如果它有效，那么我认为没有任何理由立即更改它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T18:03:35.067

I have a few ideas, but you will have to verify them with testing.

If the table you are inserting to has indexes, try to make sure they are optimized for inserts.

Check out optimization options here: [http://dev.mysql.com/doc/refman/5.0/en/insert-speed.html](http://dev.mysql.com/doc/refman/5.0/en/insert-speed.html)

Consider mysqli directly, or Pear::MDB2 or PDO. I understand that Pear::DB is fairly slow, though I don't use PEAR myself, so can't verify.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T20:15:53.733

我认为几千条记录不会对您的数据库造成任何压力。甚至我的笔记本电脑也应该能很好地处理它。如果您不进行任何清理或分区，您最大的担忧*可能是（来）巨大的表。*避免对该部分进行过早优化。

至于您的方法，请确保您在单独的事务中处理每个用户（或批次）。如果是 mysql，请确保您使用的是 innodb 以避免不必要的锁定。如果您已经在使用支持事务的 innodb/postgres/其他数据库，您可能会看到性能显着提高。

考虑使用 COPY（至少在 postgres 上 - 不确定 mysql）。

确保您的表已正确索引（包括删除未使用的表）。索引会损害插入速度。

记得定期优化/清理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T17:55:38.970

数据库抽象层通常会增加相当多的开销。我发现，至少在 PHP 中，为了速度而使用普通的 mysql_query 比优化您选择的库要容易得多。

就像 Eric P 和 weinzierl.name 所说的那样，使用多行插入或 LOAD 将为您提供最佳的直接性能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T19:41:42.957

MySQL **LOAD DATA INFILE**功能可能是做你想做的最快的方法。

您可以查看MySQL 文档[中 INSERT statements 的速度一章。](http://dev.mysql.com/doc/refman/5.1/en/insert-speed.html)

它谈到了很多改进 MySQL 中的 INSERTING 的方法。

# asp.net - Asp.Net SQL 中的唯一记录

> ID：710780
> 
> 赞同：1
> 
> 时间：2009-04-02T17:34:33.293
> 
> 标签：asp.net, sql, unique, record

我之前问过这个问题，但答案不是我想要的。

我在没有使用代码的情况下在 Asp.net 中创建了一个表。它包含两列。

YourUserId 和 FriendUserId

这是多对多的关系。

这是我想要的：

可以有多个记录以您的名字作为 UserId，也可以有多个记录 FriendUserId 相同...但不能有多个记录两者都相同。例如：

戴夫：格雷格

戴夫：克里斯

格雷格：克里斯

克里斯：格雷格

很好

戴夫：格雷格

戴夫：格雷格

不好。

我右键单击表格并选择索引/键。然后，我将两列都放在列部分并选择使其唯一。我认为这会使它们作为一个整体独一无二，但单独不是独一无二的。

如果您转到数据集，它会在两列旁边显示键，并表示检查两列时存在约束。

有没有一种方法可以确保您没有将记录的重复副本插入到表中而没有单个列是唯一的？

我尝试用我的 sql insert 语句来控制它，但没有奏效。这是我尝试过的。

在不存在的情况下插入 [FriendRequests] ([UserId], [FriendUserId]) 值 ('"+UserId+"', '"+PossibleFriend+"') (SELECT [UserId], [FriendUserId] FROM [FriendRequests])

由于某种原因，这不起作用。感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T17:39:00.680

您应该创建一个复合主键以防止重复行。

```
ALTER TABLE FriendRequests
ADD CONSTRAINT pk_FriendRequests PRIMARY KEY (UserID, FriendUserID) 
```

或者在表格设计器中选择两列并右键单击以将其设置为键。

为了防止自我友谊，您将创建一个`CHECK`约束：

```
ALTER TABLE FriendRequests
ADD CONSTRAINT ck_FriendRequests_NoSelfFriends CHECK (UserID <> FriendUserID) 
```

您可以通过右键单击表设计器中的任意位置，单击“检查约束”，单击“添加”，并将表达式设置为来在设计器中添加检查约束`UserID <> FriendUserID`

你可能想看看[这个问题](https://stackoverflow.com/questions/669483/modeling-friends-and-followers-in-an-rdbms)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T17:38:48.917

听起来您需要一个复合键才能使两个字段成为一个键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T17:45:27.747

我有一个更好的主意。创建一个新表。称为 FriendRequestRelationships。有以下列

FriendRelationshipId（主键） UserId_1（外键约束） UserId_2（外键约束）

放置一个唯一约束以仅允许与 UserId_1 和 UserId_2 的一个关系。该表现在用作您的多对多关系工具。

创建一个可以返回 UserId 的 FriendUserId 的标量函数，假设它被称为 fn_GetFriendUserIdForUserId

您现在可以通过运行以下查询来显示您的关系

从 FriendRelationshipId 中选择 dbo.fn_GetFriendUserIdForUserId(UserId_1) 作为“Friend1”，dbo.fn_GetFriendUserIdForUserId(UserId_2) 作为“Friend2”

# ruby - 在 Ruby 中处理多个进程

> ID：710785
> 
> 赞同：4
> 
> 时间：2009-04-02T17:35:30.953
> 
> 标签：ruby, multiprocessing

是否有一个 Ruby 模块可以轻松地在多个进程之间共享对象？我正在寻找类似于 Python 的[multiprocessing](http://docs.python.org/library/multiprocessing.html)的东西，它支持可以在进程之间共享的进程安全队列和管道。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T18:17:06.873

我认为您可以使用 Ruby IO 的功能做很多您想做的事情；你在进程之间共享，而不是线程，对吗？

如果是这种情况， IO.pipe 会做你需要的。Ruby 没有任何内置的方式来处理跨进程队列（据我所知），但您也可以使用 FIFO（如果您在 Unix 上）。

如果您想要更细粒度的东西，并且具有良好的线程支持，我相当肯定如果您使用 JRuby，您可以搭载 java.util.concurrent。MRI 具有相当糟糕的线程/并发支持，所以如果这是您的目标，JRuby 可能是一个更好的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T07:53:23.340

我遇到了这个库，但我还没有尝试过。

Parallel::ForkManager — 一个简单的并行处理分支管理器。

[http://parallelforkmgr.rubyforge.org/](http://parallelforkmgr.rubyforge.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T17:40:28.820

将 DRb（提供简单的进程间通信）与 Queue 或 SizedQueue（它们都是线程安全的队列）结合起来，应该可以满足您的需求。

您可能还想查看同样托管在[github上的](http://github.com/kr/beanstalkd/tree/master)[beanstalkd](http://xph.us/software/beanstalkd/)

# visual-sourcesafe - 在与 VSS 6.0 相同的服务器上运行 VSS 2005 客户端

> ID：710786
> 
> 赞同：0
> 
> 时间：2009-04-02T17:35:37.193
> 
> 标签：visual-sourcesafe, visual-sourcesafe-2005

是否可以在同一个机器上运行 VSS 2005（客户端）/VSS 6.0（服务器）的客户端-服务器组合？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T17:39:34.467

是的，一点没错。我已经做了大约一年了，没有任何问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T17:37:54.037

我相信这应该工作得很好。我不相信客户端和服务器共享任何组件，并且我能够使用 VSS 2005 连接到 VSS 6.0 数据库。

# actionscript-3 - 如何在 actionscript 3.0 中捕获鼠标点击

> ID：710792
> 
> 赞同：0
> 
> 时间：2009-04-02T17:37:55.940
> 
> 标签：actionscript-3

如何使用 Actionscript 3.0 在我的 Flash 窗口中捕获用户的鼠标点击位置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T01:30:50.560

Ron DeVera 很接近，但我不会使用内联函数，并且传递给函数的对象不是 Event，而是 MouseEvent。

```
stage.addEventListener(MouseEvent.CLICK, _onStageMouseDown);

function _onStageMouseDown(e:MouseEvent):void
{
    trace(e);
}

//traces
//[MouseEvent type="click" bubbles=true cancelable=false eventPhase=2 localX=96 localY=96 stageX=96 stageY=96 relatedObject=null ctrlKey=false altKey=false shiftKey=false buttonDown=false delta=0] 
```

上面输出中的所有属性都可以通过传递给事件侦听器方法的对象 _onStageMouseDown(e:MouseEvent); 因此以下

```
function _onStageMouseDown(e:MouseEvent):void
{
    trace(e.localX);
    trace(e.stageX);
    //Note that the above two traces are identical as we are listening to the stage for our MouseEvent.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T00:57:07.320

他们解释得很好，但这里有完整的代码来为你说明更多：

```
addEventListener(MouseEvent.CLICK, clickHandler);

函数clickHandler（事件：MouseEvent）：无效
{
    // 这些是相对于对象的 x 和 y
    var localMouseX: Number = event.localX;
    var localMouseY: Number = event.localY;

    // 这些是相对于整个舞台的 x 和 y
    var stageMouseX: Number = event.stageX;
    var stageMouseY: Number = event.stageY;
}

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T17:51:54.003

位置由什么上下文定义？整个页面？一个或多个特定的可点击控件？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T17:54:57.193

您可以随时查询任何 DisplayObject 的 mouseX 和 mouseY。

# c# - 静态字段初始化如何在 C# 中工作？

> ID：710793
> 
> 赞同：30
> 
> 时间：2009-04-02T17:38:03.677
> 
> 标签：c#, compiler-construction

是否应该在调用构造函数之前完成静态字段初始化？

以下程序提供的输出对我来说似乎不正确。

```
new A()
_A == null
static A()
new A()
_A == A 
```

编码：

```
public class A
{
    public static string _A = (new A()).I();

    public A()
    {
        Console.WriteLine("new A()");
        if (_A == null)
            Console.WriteLine("_A == null");
        else
            Console.WriteLine("_A == " + _A);
    }

    static A()
    {
        Console.WriteLine("static A()");
    }

    public string I()
    {
        return "A";
    }
}

class Program
{
    static void Main(string[] args)
    {
       var a = new A();
    }
} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-02T17:40:28.773

这是对的。

您的静态初始化程序，然后静态构造函数在您的标准构造函数之前运行，但是当它运行时，它使用 new A()，因此通过您的非静态构造函数路径。这会导致您看到的消息。

下面是完整的执行路径：

当你第一次调用`var a = new A();`你的程序时，这是第一次访问 A。

这将触发的静态初始化`A._A`

此时，A._A 构造为`_A = (new A()).I();`

这击中

```
 Console.WriteLine("new A()");
if (_A == null)
    Console.WriteLine("_A == null"); 
```

因为此时，_A 尚未设置为返回的构造类型（还）。

接下来，`A { static A(); }`运行静态构造函数。这将打印“静态 A()”消息。

最后，您的原始语句 ( `var a = new A();`) 被执行，但此时，构造了静态变量，因此您得到了最终的打印结果。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-10-14T18:53:07.130

一个额外的附注 - C# 规范（我正在查看 4.0，但它也在 3.0 中）在 10.5.5.1 静态字段初始化中说：

> 如果类中存在静态构造函数（第 10.12 节），则在执行该静态构造函数之前立即执行静态字段初始值设定项。否则，静态字段初始化器在第一次使用该类的静态字段之前的依赖于实现的时间执行。

您有一个静态构造函数，因此“否则”子句不适用。但我认为与您的问题相关的信息是，如果您没有静态构造函数，则可以“在依赖于实现的时间”执行静态字段初始值设定项。如果您的静态字段初始值设定项正在执行某种类型的数据初始化或对象创建，而您在不访问静态字段本身的情况下依赖这些数据初始化或对象创建，这可能很重要。

我想这很深奥，但我今天看到它发生了，因为“依赖于实现的时间”似乎在 C# 3.0 和 4.0 之间发生了变化——至少对于我所看到的情况而言。简单的解决方案当然很简单 - 只需添加一个静态构造函数......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T17:46:18.727

我实际上相信它正在按照您的想法行事。你的测试很难说。

_A 的初始化

```
public static string _A = (new A()).I(); 
```

首先创建一个新的 A 实例，因此你写的 new A() 和 _A = null。因为它启动时为空，因为这是初始化。初始化后，调用静态构造函数，返回新实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T18:01:26.147

看来编译器正在做预期的事情。

**1st - 在类中执行所有静态代码（首先是字段，然后是静态构造函数）：**

```
public static string _A = (new A()).I();

// and

static A()
{
    Console.WriteLine("static A()");
} 
```

**2nd - 类构造函数被调用：**

```
public A()
{
    Console.WriteLine("new A()");
    if (_A == null)
        Console.WriteLine("_A == null");
    else
        Console.WriteLine("_A == " + _A);
} 
```

你问为什么这是可能的。好吧，在我看来，实例并不绝对需要在创建时初始化所有类变量。它只要求它们必须存在。我认为这种特殊情况支持这种想法，因为在所有静态初始化完成之前创建了一个实例。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-02T17:45:43.207

是的，静态字段初始化应该在调用构造函数之前完成。但是你把编译器放在不正常的情况下，它就不能遵守这个规则。

这是一个有趣的技巧，但在正常应用中不会发生。

# asp.net-mvc - 维护消息完整性

> ID：710805
> 
> 赞同：6
> 
> 时间：2009-04-02T17:40:19.817
> 
> 标签：asp.net-mvc, language-agnostic, hash, digital-signature

我有一条消息要传递给自己，该消息将受到中间人攻击。正因为如此，我担心在我发送消息和接收回消息之间保持消息的完整性。

应该假设，一旦我将消息发送给自己，将来我将无法获得有关所发送消息的任何信息。该消息是完全独立的。

为此，我知道应该在发送消息之前对消息内容进行哈希处理并比较哈希值，在我发送消息之后，如果它们不同，则表明消息已被篡改。

当然，如果中间人知道哈希实际上只是消息内容的哈希，那么由于消息是自包含的，他可以创建新内容并应用相同的哈希算法的内容。

问题是，在生成哈希时，我应该将消息内容随机化到多长？什么时候达到收益递减点？

在这种情况下，我有一组键/值对。为此，我知道我必须采取的步骤是：

1.  在消息中添加盐。盐是世界其他地方的秘密。它在散列之前附加到消息的内容。
2.  在生成哈希之前以一致的方式对键/值对进行排序。
3.  虽然不*直接*相关，但将在散列之前将时间戳添加到每条消息的内容中，以防止重放攻击。

这些是我正在考虑的可选步骤：

1.  在我订购之前转换钥匙。我考虑过颠倒它们，然后按计数/键排序。
2.  使用分隔键/值对的分隔符（用于键/值的分隔符和对的分隔符）。

**笔记**

**这里不需要**消息隐私，所以我不是在寻找加密。这些值*必须*以纯文本形式传输。

最后，我应该避免哪些哈希算法？

* * *

**细节**

我有一个 ASP.NET MVC 站点，我有一个控制器来处理输入验证和持久性。

如果（基于启发式，哪个并不重要）输入被确定为自动垃圾邮件尝试，`IDictionary<string, string>`则使用输入值创建一个模型，并将 ViewResult 发送到一般 CAPTCHA 页面。

在该视图中，在包含 CAPTCHA 控件的表单中，`IDictionary<string, string>`将在隐藏的输入字段中写入内容，并且表单的操作将与内容最初发布到的操作相同。这样，MVC 可以在重新提交表单时获取这些值。

正因为如此，我无法加密键/值对（或者我可以而且应该告诉我为什么以及如何加密！）。

当然，我需要再添加一个值，它包含经过哈希处理的消息内容。如果该值存在，则控制器将检查消息完整性是否得到维护，如果有，则允许持久化输入。

**解决方案**

我选择使用 System.Security.Cyrptography.Pkcs 命名空间中的 SignedCms 类，它代表 CMS/PKCS #7 消息的签名和验证。

为了详细说明，我使用 MAKECERT.EXE 创建了一个自行颁发的证书，然后在我的代码中，我使用此处的示例对数据进行数字签名：

[http://blogs.msdn.com/shawnfa/archive/2006/02/27/539990.aspx](http://blogs.msdn.com/shawnfa/archive/2006/02/27/539990.aspx)

现在，应该确保导出的私钥上的密码安全，以及服务器上的安全性，这使得编程变得不那么重要了。

我必须为重放攻击的时间戳添加一个额外的密钥，但这不会太难。

答案[归于 Kalium](https://stackoverflow.com/users/85763/kalium)，不是因为他[最初的帖子](https://stackoverflow.com/questions/710805/maintaining-message-integrity/710816#710816)，而是因为他的后续评论指出了数字签名的方向，最终我发现了如何在 .NET 中使用它们。

感谢所有做出贡献的人。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T17:42:20.373

我认为 PGP/GPG 是你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T18:22:11.357

允许您的应用程序验证其自己的消息未被篡改的最直接的方法是使用带密钥的散列消息身份验证代码。该消息以明文形式发送，但它还包含一个散列以防止篡改。哈希取决于消息内容和密钥。中间的人在不知道密钥的情况下无法在更改的消息上伪造散列。由于您的应用程序同时创建和验证消息，它永远不需要透露密钥。

我特别推荐 RFC-2104 [http://www.ietf.org/rfc/rfc2104.txt](http://www.ietf.org/rfc/rfc2104.txt)中描述的实现，因为它已经过仔细考虑以避免大多数可能的陷阱。

如果消息还必须由不受信任的方验证真实性，那么您应该使用数字签名方案。

.Net 库中可能对这两者都有一些支持。Miles 提供了（作为评论）一个指向 MSDN 网页的链接，该链接用于使用 SHA1 哈希实现键控 HMAC 的 .Net 库函数：http: [//msdn.microsoft.com/en-us/library/system.security。密码学.hmacsha1.aspx](http://msdn.microsoft.com/en-us/library/system.security.cryptography.hmacsha1.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T17:48:00.970

你想要一个[数字签名的消息](http://en.wikipedia.org/wiki/Digital_signature)。使用 GPG，您可以在*不*加密的情况下签署消息。但是没有人能够篡改它，因为*他们*无法生成散列——**只有你可以，因为散列使用了你的私钥**。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T17:48:01.173

您可能应该对消息进行数字签名（因此 Kalium 推荐的 PGP/GPG 作为一个选项是相关的）。您可以创建的任何纯哈希都可以被攻击者重新创建。数字签名 - 使用您的私人签名密钥，以便您的公钥可用于验证它 - 是解决方案。其他任何事情都是徒劳的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T17:49:33.477

假设您不能通过“安全”通道（即散列）传递任何信息，您可以这样做：

1.  散列消息，然后使用私钥对散列进行签名。在消息中包含签名的哈希。
2.  当您收到消息时，使用公钥解密签名的散列并验证它是否与消息的实际散列匹配。

攻击者将无法“伪造”消息，因为他们需要拥有您的私钥才能加密他们的新哈希。

正如其他人所提到的，这只是普通的数字签名，可以由 PGP/GPG 之类的东西处理

# c++ - 通过引用使用临时对象和参数的规则

> ID：710807
> 
> 赞同：2
> 
> 时间：2009-04-02T17:40:27.867
> 
> 标签：c++, reference, object, temporary

说我有一堂课：

```
class A
{
 public:
 A() {}
}; 
```

和一个功能：

```
void x(const A & s) {} 
```

我这样做：

```
x(A()); 
```

有人可以向我解释有关通过引用传递临时对象的规则吗？就编译器允许的内容而言，您需要 const 的位置，是否发生隐式副本等。从玩耍中，您似乎需要 const 是有道理的，但是关于这一切是否有正式的规则？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-02T17:46:15.357

有一条正式规则——C++ 标准（如果您有兴趣，请参见第 13.3.3.1.4 节）规定临时只能绑定到 const 引用——如果您尝试使用非 const 引用，编译器必须将其标记为一个错误。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-02T17:45:08.543

Herb Sutter 在这里做了很好的解释：[http ://www.gotw.ca/gotw/081.htm](http://www.gotw.ca/gotw/081.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T17:45:49.197

x() 必须采用对临时 A 的 const 引用，或者 x() 必须采用 A 按值。

# c# - 无法对继承对象的属性使用 nMock GetProperty 例程

> ID：710817
> 
> 赞同：0
> 
> 时间：2009-04-02T17:43:01.573
> 
> 标签：c#, unit-testing, nunit, resharper, nmock

尝试对从 MembershipUser 继承的我模拟的对象设置期望时出现此错误：

ContactRepositoryTests.UpdateTest：FailedSystem.InvalidProgramException：JIT 编译器遇到内部限制。

服务器堆栈跟踪：在 MockObjectType1.ToString()

在 [0] 处重新抛出异常：在 System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(ref MessageData msgData, Int32 type) 在 System.Object NMock2.Internal.ExpectationBuilder.On（对象接收器）处的 .ToString()

这是我正在使用的工具...

VS2008 (SP1) 框架 3.5 nUnit 2.4.8 nMock 2.0.0.44 Resharper 4.1

我不知道为什么会发生这种情况。任何帮助，将不胜感激。

测试班...

```
 [TestFixture]
public class AddressRepositoryTests
{
    private Mockery m_Mockery;
    private Data.IAddress m_MockDataAddress;
    private IUser m_MockUser;

    [SetUp]
    public void Setup()
    {
        m_Mockery = new Mockery();

        m_MockDataAddress = m_Mockery.NewMock<Data.IAddress>();

        m_MockUser = m_Mockery.NewMock<IUser>();
    }

    [TearDown]
    public void TearDown()
    {
        m_Mockery.Dispose();
    }

    [Test]
    public void CreateTest()
    {
        string line1 = "unitTestLine1";
        string line2 = "unitTestLine2";
        string city = "unitTestCity";
        int stateId = 1893;
        string postalCode = "unitTestPostalCode";
        int countryId = 223;
        bool active = false;
        int createdById = 1;

        Expect.Once
            .On(m_MockUser)
            .GetProperty("Identity")
            .Will(Return.Value(createdById));

        Expect.Once
            .On(m_MockDataAddress)
            .Method("Insert")
            .With(
                line1,
                line2,
                city,
                stateId,
                postalCode,
                countryId,
                active,
                createdById,
                Is.Anything
            )
            .Will(Return.Value(null));

        IAddressRepository addressRepository = new AddressRepository(m_MockDataAddress);
        IAddress address = addressRepository.Create(
            line1,
            line2,
            city,
            stateId,
            postalCode,
            countryId,
            active,
            m_MockUser
        );

        Assert.IsNull(address);
    }
} 
```

用户类...

```
public interface IUser
{
    int? Identity { get; set; }
    int? CreatedBy { get; set; }
    DateTime CreatedOn { get; set; }
    int? ModifiedBy { get; set; }
    DateTime? ModifiedOn { get; set; }
    string UserName { get; }
    object ProviderUserKey { get; }
    string Email { get; set; }
    string PasswordQuestion { get; }
    string Comment { get; set; }
    bool IsApproved { get; set; }
    bool IsLockedOut { get; }
    DateTime LastLockoutDate { get; }
    DateTime CreationDate { get; }
    DateTime LastLoginDate { get; set; }
    DateTime LastActivityDate { get; set; }
    DateTime LastPasswordChangedDate { get; }
    bool IsOnline { get; }
    string ProviderName { get; }
    string ToString();
    string GetPassword();
    string GetPassword(string passwordAnswer);
    bool ChangePassword(string oldPassword, string newPassword);
    bool ChangePasswordQuestionAndAnswer(string password, string newPasswordQuestion, string newPasswordAnswer);
    string ResetPassword(string passwordAnswer);
    string ResetPassword();
    bool UnlockUser();
}

public class User : MembershipUser, IUser
{
    #region Public Properties
    private int? m_Identity;
    public int? Identity
    {
        get { return m_Identity; }
        set
        {
            if (value <= 0)
                throw new Exception("Address.Identity must be greater than 0.");

            m_Identity = value;
        }
    }

    public int? CreatedBy { get; set; }

    private DateTime m_CreatedOn = DateTime.Now;
    public DateTime CreatedOn
    {
        get { return m_CreatedOn; }
        set { m_CreatedOn = value; }
    }

    public int? ModifiedBy { get; set; }
    public DateTime? ModifiedOn { get; set; }
    #endregion Public Properties

    #region Public Constructors
    public User()
    { }
    #endregion Public Constructors

} 
```

地址类...

```
public interface IAddress
{
    int? Identity { get; set; }
    string Line1 { get; set; }
    string Line2 { get; set; }
    string City { get; set; }
    string PostalCode { get; set; }
    bool Active { get; set; }
    int? CreatedBy { get; set; }
    DateTime CreatedOn { get; set; }
    int? ModifiedBy { get; set; }
    DateTime? ModifiedOn { get; set; }
}

public class Address : IAddress
{
    #region Public Properties
    private int? m_Identity;
    public int? Identity
    {
        get { return m_Identity; }
        set
        {
            if (value <= 0)
                throw new Exception("Address.Identity must be greater than 0.");

            m_Identity = value;
        }
    }

    public string Line1 { get; set; }
    public string Line2 { get; set; }
    public string City { get; set; }
    public string PostalCode { get; set; }
    public bool Active { get; set; }

    public int? CreatedBy { get; set; }

    private DateTime m_CreatedOn = DateTime.Now;
    public DateTime CreatedOn
    {
        get { return m_CreatedOn; }
        set { m_CreatedOn = value; }
    }

    public int? ModifiedBy { get; set; }
    public DateTime? ModifiedOn { get; set; }
    #endregion Public Properties

} 
```

地址存储库类...

```
public interface IAddressRepository
{
    IAddress Create(string line1, string line2, string city, int stateId, string postalCode, int countryId, bool active, IUser createdBy);
}

public class AddressRepository : IAddressRepository
{
    #region Private Properties
    private Data.IAddress m_DataAddress;
    private Data.IAddress DataAddress
    {
        get
        {
            if (m_DataAddress == null)
                m_DataAddress = new Data.Address();

            return m_DataAddress;
        }
        set
        {
            m_DataAddress = value;
        }
    }
    #endregion Private Properties

    #region Public Constructor
    public AddressRepository()
    { }

    public AddressRepository(Data.IAddress dataAddress)
    {
        DataAddress = dataAddress;
    }
    #endregion Public Constructor

    #region Public Methods
    public IAddress Create(string line1, string line2, string city, int stateId, string postalCode, int countryId, bool active, IUser createdBy)
    {
        if (String.IsNullOrEmpty(line1)) throw new Exception("You must enter a Address Line 1 to register.");
        if (String.IsNullOrEmpty(city)) throw new Exception("You must enter a City to register.");
        if (stateId <= 0) throw new Exception("You must select a State to register.");
        if (String.IsNullOrEmpty(postalCode)) throw new Exception("You must enter a Postal Code to register.");
        if (countryId <= 0) throw new Exception("You must select a Country to register.");

        DataSet dataSet = DataAddress.Insert(
            line1,
            line2,
            city,
            stateId,
            postalCode,
            countryId,
            active,
            createdBy.Identity,
            DateTime.Now
        );

        return null;
    }
    #endregion Public Methods
} 
```

数据地址类...

```
public interface IAddress
{
    DataSet GetByAddressId (int? AddressId);
    DataSet Update (int? AddressId, string Address1, string Address2, string City, int? StateId, string PostalCode, int? CountryId, bool? IsActive, Guid? ModifiedBy);
    DataSet Insert (string Address1, string Address2, string City, int? StateId, string PostalCode, int? CountryId, bool? IsActive, int? CreatedBy, DateTime? CreatedOn);
}

public class Address : IAddress
{
    public DataSet GetByAddressId (int? AddressId)
    {
        Database database = DatabaseFactory.CreateDatabase();
        DbCommand dbCommand = database.GetStoredProcCommand("prAddress_GetByAddressId");
        DataSet dataSet;

        try
        {
            database.AddInParameter(dbCommand, "AddressId", DbType.Int32, AddressId);

            dataSet = database.ExecuteDataSet(dbCommand);
        }
        catch (SqlException sqlException)
        {
            string callMessage = "prAddress_GetByAddressId " + "@AddressId = " + AddressId;
            throw new Exception(callMessage, sqlException);
        }

        return dataSet;
    }

    public DataSet Update (int? AddressId, string Address1, string Address2, string City, int? StateId, string PostalCode, int? CountryId, bool? IsActive, Guid? ModifiedBy)
    {
        Database database = DatabaseFactory.CreateDatabase();
        DbCommand dbCommand = database.GetStoredProcCommand("prAddress_Update");
        DataSet dataSet;

        try
        {
            database.AddInParameter(dbCommand, "AddressId", DbType.Int32, AddressId);
            database.AddInParameter(dbCommand, "Address1", DbType.AnsiString, Address1);
            database.AddInParameter(dbCommand, "Address2", DbType.AnsiString, Address2);
            database.AddInParameter(dbCommand, "City", DbType.AnsiString, City);
            database.AddInParameter(dbCommand, "StateId", DbType.Int32, StateId);
            database.AddInParameter(dbCommand, "PostalCode", DbType.AnsiString, PostalCode);
            database.AddInParameter(dbCommand, "CountryId", DbType.Int32, CountryId);
            database.AddInParameter(dbCommand, "IsActive", DbType.Boolean, IsActive);
            database.AddInParameter(dbCommand, "ModifiedBy", DbType.Guid, ModifiedBy);

            dataSet = database.ExecuteDataSet(dbCommand);
        }
        catch (SqlException sqlException)
        {
            string callMessage = "prAddress_Update " + "@AddressId = " + AddressId + ", @Address1 = " + Address1 + ", @Address2 = " + Address2 + ", @City = " + City + ", @StateId = " + StateId + ", @PostalCode = " + PostalCode + ", @CountryId = " + CountryId + ", @IsActive = " + IsActive + ", @ModifiedBy = " + ModifiedBy;
            throw new Exception(callMessage, sqlException);
        }

        return dataSet;
    }

    public DataSet Insert (string Address1, string Address2, string City, int? StateId, string PostalCode, int? CountryId, bool? IsActive, int? CreatedBy, DateTime? CreatedOn)
    {
        Database database = DatabaseFactory.CreateDatabase();
        DbCommand dbCommand = database.GetStoredProcCommand("prAddress_Insert");
        DataSet dataSet;

        try
        {
            database.AddInParameter(dbCommand, "Address1", DbType.AnsiString, Address1);
            database.AddInParameter(dbCommand, "Address2", DbType.AnsiString, Address2);
            database.AddInParameter(dbCommand, "City", DbType.AnsiString, City);
            database.AddInParameter(dbCommand, "StateId", DbType.Int32, StateId);
            database.AddInParameter(dbCommand, "PostalCode", DbType.AnsiString, PostalCode);
            database.AddInParameter(dbCommand, "CountryId", DbType.Int32, CountryId);
            database.AddInParameter(dbCommand, "IsActive", DbType.Boolean, IsActive);
            database.AddInParameter(dbCommand, "CreatedBy", DbType.Int32, CreatedBy);
            database.AddInParameter(dbCommand, "CreatedOn", DbType.DateTime, CreatedOn);

            dataSet = database.ExecuteDataSet(dbCommand);
        }
        catch (SqlException sqlException)
        {
            string callMessage = "prAddress_Insert " + "@Address1 = " + Address1 + ", @Address2 = " + Address2 + ", @City = " + City + ", @StateId = " + StateId + ", @PostalCode = " + PostalCode + ", @CountryId = " + CountryId + ", @IsActive = " + IsActive + ", @CreatedBy = " + CreatedBy + ", @CreatedOn = " + CreatedOn;
            throw new Exception(callMessage, sqlException);
        }

        return dataSet;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T11:38:31.360

刚刚解决了同样的问题。

**不要**将 ToString() 添加到接口定义中。它已经包含在每个对象中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T09:01:09.993

```
 public interface IUser
    {

        // Base class public properties
        string UserName { get; }
        object ProviderUserKey { get; }
        string Email { get; set; }
        string PasswordQuestion { get; }
        string Comment { get; set; }
        bool IsApproved { get; set; }
        bool IsLockedOut { get; }
        DateTime LastLockoutDate { get; }
        DateTime CreationDate { get; }
        DateTime LastLoginDate { get; set; }
        DateTime LastActivityDate { get; set; }
        DateTime LastPasswordChangedDate { get; }
        bool IsOnline { get; }
        string ProviderName { get; }
        string ToString();
        string GetPassword();
        string GetPassword(string passwordAnswer);
        bool ChangePassword(string oldPassword, string newPassword);
        bool ChangePasswordQuestionAndAnswer(string password, string newPasswordQuestion, string newPasswordAnswer);
        string ResetPassword(string passwordAnswer);
        string ResetPassword();
        bool UnlockUser();
    }

    public class Caller
    {
        public Caller(IUser newUser)
        {
            user = newUser;
        }

        public IUser user { get; private set; }
    }

    [Test]
    public void RhinoTest()
    {
        var userId = Guid.NewGuid();
        var mocks = new MockRepository();
        var mockUser = mocks.StrictMock<IUser>();
        var caller = new Caller(mockUser);

        Expect.Call(mockUser.ProviderUserKey).Return(userId);

        mocks.ReplayAll();
        var userFromCaller = caller.user.ProviderUserKey;
        Assert.AreEqual(userId, userFromCaller, "Incorrect userId");

        mockUser.VerifyAllExpectations();
    }

    [Test]
    public void AnotherRhinoTest()
    {
        var userId = Guid.NewGuid();
        var mockUser = MockRepository.GenerateMock<IUser>();
        var caller = new Caller(mockUser);

        mockUser.Expect(m=>m.ProviderUserKey).Return(userId);

        var userFromCaller = caller.user.ProviderUserKey;

        Assert.AreEqual(userId, userFromCaller, "Incorrect userId");

        mockUser.VerifyAllExpectations();

    } 
```

有有效的犀牛模拟测试。在 rhino 模拟测试中，您错过了对预期属性的调用（由 Expect.call 设置）

通过查看代码，您似乎在 nMock 场景中犯了同样的错误

# c# - 在 C# 中查找一组文件中的模式的最快方法是什么？

> ID：710818
> 
> 赞同：1
> 
> 时间：2009-04-02T17:43:10.683
> 
> 标签：c#, regex, performance, file

```
using System;
using System.IO;
using System.Reflection;
using System.Text.RegularExpressions;

namespace regex
{
  class MainClass
  {
    public static void Main(string[] args)
    {
      Regex exp = new Regex(@"e(-)?m[a@]il(s)?|input|output|padr(ão|ões)|máquina(s)?|reconhecimento",
                            RegexOptions.IgnoreCase | RegexOptions.Compiled |
                            RegexOptions.Multiline  | RegexOptions.ExplicitCapture);

      for (int filecount = 0 ; filecount < 22 ; filecount++)
      {
        string file = "/home/files/file"+ string.Format("{0:0#}",filecount) + ".txt";
        StreamReader reader = new StreamReader(file);

        string text = reader.ReadToEnd();
        int c=0;

        MatchCollection matchList = exp.Matches(text);
        c = matchList.Count;

        Console.WriteLine("Reading " + file + " -> " + c + " matches");
      }
    }
  }
} 
```

如果我注释掉该行

```
c = matchList.Count; 
```

它非常快。但我需要知道它找到的匹配数量。

这是最快的方法吗？对于我拥有的文件组，解析每个文件需要 14 秒。Perl 需要 1 秒来输出完全相同的信息。

PS：每个文件（文本文件）都有 +/- 1Mb，所以要处理大约 20Mb。

谢谢 ;）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T17:46:41.377

您可以使用 BackgroundWorker 来并行化文件的搜索。您必须跟踪计数并在最后汇总。每个文件或一组文件都可以有一个 BGWorker。4.0 框架将简化此代码，因为它具有并行数据结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T00:07:00.237

使用

```
StreamReader reader = new StreamReader(file); 
```

很危险，它不会关闭您的文件句柄。

利用：

```
using(Streamreader reader = new StreamReader(file). 
```

确保您的文件句柄已关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T17:50:03.100

在这里可能对您不利的一件事是您将文件连接保持打开状态，这会增加一些不必要的开销。

请务必`reader.Close();`在执行 ReadToEnd(); 后调用

# asp.net - 获取ASPNET账号密码

> ID：710834
> 
> 赞同：2
> 
> 时间：2009-04-02T17:46:23.547
> 
> 标签：asp.net, iis, windows-server-2003, passwords

有什么方法可以获取（不更改）Windows Server 2003 服务器上 ASPNET 帐户的密码？我需要将我的工作站的 ASPNET 帐户密码与我尝试连接的服务器上的密码进行同步。

我正在尝试解决我的 ASP.NET 应用程序的以下[问题](https://stackoverflow.com/questions/637090/access-denied-when-trying-to-connect-to-remote-iis-server-c)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T14:02:53.060

有一种简单的方法可以获取此密码。此帐户是自动创建的，因此它不像“询问您的网络管理员”那么简单。

首先从您的域控制器[转储密码](http://foofus.net/fizzgig/pwdump/)哈希，大多数防病毒软件会将 PWDUMP 视为病毒，因此请务必在运行之前禁用 AV。

其次，在您转储这些密码后，将它们输入[John the Ripper](http://www.openwall.com/john/)（注意：John the ripper 不是用于执行此操作的最佳程序，但它确实是免费的）

这是一个（有点过时的）[用约翰破解密码的教程](http://www.osix.net/modules/article/?id=455)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T17:48:25.757

基本上没有，没有办法检索 Windows 帐户密码。您可以使用各种工具更改它们，但检索的可能性很小。

您始终可以在域控制器上创建代理帐户并设置应用程序池以在代理帐户下运行，以便权限可以跨工作站。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T17:49:45.270

获得 NT 服务帐户密码的唯一方法是询问知道的人。如果应该知道的人不知道，那么同一个人应该能够为您重置它。换句话说，您可能应该与您的网络管理员交谈。

# sql-server - Sql Server 安装错误

> ID：710838
> 
> 赞同：1
> 
> 时间：2009-04-02T17:47:00.050
> 
> 标签：sql-server

当我在我的系统上安装 SQl server 2005 时，我收到一条类似这样的错误消息。“安装程序无法启动 sqlserver 服务，只需手动引用热 ststrt 服务”

我正在使用 Windows 7 Beta 作为操作系统

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T23:03:47.560

他得到了它的工作。 [http://itknowledgeexchange.techtarget.com/sql-server/windows-7-after-my-first-week/](http://itknowledgeexchange.techtarget.com/sql-server/windows-7-after-my-first-week/)

也许您的服务帐户有问题。

# machine-learning - 智能代码完成？有人工智能通过学习编写代码吗？

> ID：710843
> 
> 赞同：7
> 
> 时间：2009-04-02T17:48:26.257
> 
> 标签：machine-learning, artificial-intelligence, computer-science, genetic-algorithm

我问这个问题是因为我知道这里有很多读得很好的 CS 类型可以给出明确的答案。

我想知道这样的人工智能是否存在（或正在研究/开发），它通过自己生成和编译代码来编写程序，然后通过从以前的迭代中学习来进步。我说的是努力让我们这些程序员过时。我正在想象通过反复试验来学习编程语言中哪些有效，哪些无效的东西。

我知道这听起来像是天方夜谭，所以我想知道已经做了什么，如果有的话。

当然，即使是人类程序员也需要输入和规范，所以这样的实验必须有仔细定义的参数。就像人工智能要探索不同的计时功能一样，这方面必须明确定义。

但是有了一个复杂的学习人工智能，我很想知道它会产生什么。

我知道有很多人类品质是计算机无法复制的，比如我们的判断、品味和偏见。但是我的想象力喜欢这样的想法：一个程序经过一天的思考后会吐出一个网站，让我看看它想出了什么，即使如此，我仍然经常认为它是垃圾；但也许每天一次，我可能会给它反馈并帮助它学习。

这种想法的另一个途径是提供一个高级描述，如“菜单式网站”或“图像工具”，它会生成足够深度的代码，作为代码完成模块，然后我可以在细节。但我想这可以设想为一种非智能的静态分层代码完成方案。

这个怎么样？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-02T18:03:45.080

存在这样的工具。[它们是称为遗传编程](http://en.wikipedia.org/wiki/Genetic_programming)的学科的主题。您如何评估它们的成功取决于它们的应用范围。

他们在设计用于管理工业过程、自动医疗诊断或集成电路设计的最佳程序方面非常成功（比人类效率高出几个数量级）。这些过程受到很好的约束，具有明确且不可变的成功衡量标准，以及大量的“宇宙知识”，即关于什么是有效的、有效的、什么是无效的程序的大量规则。

他们在尝试构建需要用户交互的主流程序时完全没有用，因为学习的系统需要的主要项目是明确的“[适应度函数](http://en.wikipedia.org/wiki/Fitness_function)”，或者评估它提出的当前解决方案的质量。

在处理“程序学习”时可以看到的另一个领域是[归纳逻辑编程](http://en.wikipedia.org/wiki/Inductive_logic_programming)，尽管它更多地用于提供自动演示或语言/分类学习。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-10-16T18:17:15.550

**免责声明：**我不是以英语为母语的人，也不是该领域的专家，我是*[业余爱好者](http://en.wikipedia.org/wiki/Amateur)*- 期待以下内容不精确和/或错误。因此，本着 stackoverflow 的精神，不要害怕纠正和改进我的散文和/或我的内容。另请注意，这**不是对**[自动编程](http://en.wikipedia.org/wiki/Automatic_programming)技术的完整调查（来自[模型驱动架构（MDA）的](http://en.wikipedia.org/wiki/Model-driven_architecture)[代码生成](http://www.codegeneration.net/cg2009/)（CG）至少值得一提）。

我想在[Varkhan](https://stackoverflow.com/users/64331/varkhan)回答的内容中添加更多内容（这基本上是正确的）。

[自动编程](http://en.wikipedia.org/wiki/Automatic_programming)的[遗传编程](http://en.wikipedia.org/wiki/Genetic_programming)(GP) 方法结合其[适应度函数](http://en.wikipedia.org/wiki/Fitness_function)，将两个不同的问题（“自编译”在概念上是显而易见的）：

*   自我改进/适应 - 合成程序，如果需要，合成器本身；和
*   [程序综合](http://en.wikipedia.org/wiki/Program_synthesis)。

wrt **self-improvement/adaptation**参考 Jürgen Schmidhuber 的[Goedel 机器](http://www.idsia.ch/~juergen/goedelmachine.html)：*自我参照的通用问题解决者，可证明最佳的自我改进*。（附带说明：有趣的是他在[人工好奇心](http://www.idsia.ch/~juergen/interest.html)方面的工作。）与本次讨论相关的是[自主系统](http://en.wikipedia.org/wiki/Autonomic_system_%28computing%29)。

wrt**[程序综合](http://en.wikipedia.org/wiki/Program_synthesis)**，我认为可以分为 3 个主要分支：*[随机](http://en.wikipedia.org/wiki/Stochastic)*（概率 - 像上面提到的 GP）、*归纳*和*演绎*。

*[GP](http://en.wikipedia.org/wiki/Genetic_programming)*本质上是*[随机](http://en.wikipedia.org/wiki/Stochastic)*的，因为它通过交叉、随机突变、基因复制、基因删除等启发式方法生成可能程序的空间……（而不是使用[适应度函数](http://en.wikipedia.org/wiki/Fitness_function)测试程序并让适者生存和繁殖）。

*归纳程序综合*通常被称为[归纳编程](http://www.inductive-programming.org/)（IP），其中[归纳逻辑编程](http://en.wikipedia.org/wiki/Inductive_logic_programming)（ILP）是一个子领域。也就是说，一般而言，该技术不限于[逻辑程序](http://en.wikipedia.org/wiki/Logic_programming)合成或以逻辑编程语言编写的合成器（也不限于“ *..自动演示或语言/分类学习*”）。

[IP](http://www.inductive-programming.org/)通常是**确定性**的（但也有例外）：从不**完整**的规范（例如输入/输出对示例）开始，并使用它来限制满足此类规范的可能程序的搜索空间，然后对其进行测试（*生成和测试）方法*）或直接合成一个程序来检测给定示例中的重复，然后对其进行概括（*数据驱动*或*分析*方法）。整个过程本质上是[**统计**归纳/推理](http://en.wikipedia.org/wiki/Statistical_induction)——即考虑将什么包含在不完整的规范中类似于随机抽样。

[*生成和测试*和*数据驱动/分析*](http://www.ecmlpkdd2007.org/CD/workshops/AAIP/kitzelmann/kitzelmann.pdf)§方法可以相当快，所以两者都是有希望的（即使直到现在只有很少的综合程序被公开展示），但是*生成和测试*（如 GP）是[令人尴尬的并行](http://en.wikipedia.org/wiki/Embarrassingly_parallel)然后可以预期显着的改进（缩放到实际的程序大小）。但请注意，[本质上是顺序的增量归纳编程](http://www.inf.ed.ac.uk/publications/thesis/online/IM080649.pdf)(IIP)§ 已证明比非增量方法更有效几个数量级。

§ 这些链接直接指向 PDF 文件：抱歉，我找不到摘要。

[演示编程](http://en.wikipedia.org/wiki/Programming_by_demonstration)(PbD) 和[示例编程](http://en.wikipedia.org/wiki/Programming_by_example)(PbE) 是已知可实际利用*归纳程序综合的*[最终用户开发](http://en.wikipedia.org/wiki/End-user_development)技术。

 **[演绎程序综合](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.51.817)*从（假定的）**完整**（正式）规范（逻辑条件）开始。其中一种技术利用了[自动定理证明器](http://en.wikipedia.org/wiki/Automated_theorem_prover)：为了合成一个程序，它构造一个满足规范的对象存在的证明；因此，通过[Curry-Howard-de Bruijn 同构](http://en.wikipedia.org/wiki/Curry-Howard_isomorphism)（证明作为程序对应和公式作为类型对应），它从证明中提取程序。其他变体包括使用[约束求解](http://www.springerlink.com/content/uyfb5c6t7f7vg90j/)和[子程序库的演绎组合](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.18.1335)。

在我看来**，实践中的***归纳*和*演绎*综合是从两个稍微不同的角度来解决同一个问题，因为什么构成了*完整*的规范是有争议的（此外，今天的完整规范明天可能会变得不完整——世界不是静止的）。

 ***When (if) these techniques (self-improvement/adaptation and program synthesis) will mature, they promise to rise the amount of automation provided by [declarative programming](http://en.wikipedia.org/wiki/Declarative_programming) (that such setting is to be considered "*programming*" is [sometimes debated](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.43.7930)): we will concentrate more on [Domain Engineering](http://www2.imm.dtu.dk/~db/domain-papers/) and [Requirements Analysis and Engineering](http://en.wikipedia.org/wiki/Requirements_analysis) than on software manual design and development, manual debugging, manual system performance tuning and so on (possibly with less [accidental complexity](http://en.wikipedia.org/wiki/Accidental_complexity) compared to that introduced with current manual, not self-improving/adapting techniques). This will also promote a level of [agility](http://en.wikipedia.org/wiki/Agile_software_development) yet to be demonstrated by current techniques.

# diff - 如何提取统一差异样式的补丁子集？

> ID：710845
> 
> 赞同：3
> 
> 时间：2009-04-02T17:49:06.410
> 
> 标签：diff, patch

每次我想获取补丁的一个子集时，我都不得不编写一个脚本来只提取我想要的索引。

例如，我有一个适用于子目录“yay”和“foo”的补丁。

有没有办法创建新补丁或仅应用补丁的子集？即从现有补丁创建一个新补丁，该补丁只获取子目录'yay'下的所有索引。或不在子目录“foo”下的所有索引

如果我有一个补丁（请原谅下面的伪补丁）：

```
Index : foo/bar
 yada
 yada
- asdf
+ jkl
 yada
 yada
Index : foo/bah
 blah
 blah
- 28
+ 29
 blah
 blah
 blah
Index : yay/team
 go
 huskies
- happy happy
+ joy joy
 cougars
 suck 
```

如何仅提取或应用“yay”子目录，例如：

```
Index : yay/team
 go
 huskies
- happy happy
+ joy joy
 cougars
 suck 
```

我知道如果我编写一个解决方案，我将重新发明轮子......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-02T20:48:26.397

查看`filterdiff`实用程序，它是[patchutils](http://cyberelk.net/tim/software/patchutils/)的一部分。

例如，如果您有以下补丁：

```
$ cat example.patch
diff -Naur orig/a/bar new/a/bar
--- orig/a/bar  2009-12-02 12:41:38.353745751 -0800
+++ new/a/bar   2009-12-02 12:42:17.845745951 -0800
@@ -1,3 +1,3 @@
 4
-5
+e
 6
diff -Naur orig/a/foo new/a/foo
--- orig/a/foo  2009-12-02 12:41:32.845745768 -0800
+++ new/a/foo   2009-12-02 12:42:25.697995617 -0800
@@ -1,3 +1,3 @@
 1
 2
-3
+c
diff -Naur orig/b/baz new/b/baz
--- orig/b/baz  2009-12-02 12:41:42.993745756 -0800
+++ new/b/baz   2009-12-02 12:42:37.585745735 -0800
@@ -1,3 +1,3 @@
-7
+z
 8
 9 
```

然后，您可以运行以下命令来仅为`a`目录中的内容提取补丁，如下所示：

```
$ cat example.patch | filterdiff -i 'new/a/*'
--- orig/a/bar  2009-12-02 12:41:38.353745751 -0800
+++ new/a/bar   2009-12-02 12:42:17.845745951 -0800
@@ -1,3 +1,3 @@
 4
-5
+e
 6
--- orig/a/foo  2009-12-02 12:41:32.845745768 -0800
+++ new/a/foo   2009-12-02 12:42:25.697995617 -0800
@@ -1,3 +1,3 @@
 1
 2
-3
+c 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T18:46:20.907

这是我快速而肮脏的 Perl 解决方案。

```
perl -ne '@a = split /^Index :/m, join "", <>; END { for(@a) {print "Index :", $_ if (m, yay/team,)}}' < foo.patch 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-27T16:42:51.790

为了响应 sigjuice 在评论中的要求，我发布了我的脚本解决方案。它不是 100% 防弹的，我可能会使用它`filterdiff`。

```
base_usage_str=r'''
    python %prog index_regex patch_file

description:
    Extracts all indices from a patch-file matching 'index_regex'

    e.g.
        python %prog '^evc_lib' p.patch > evc_lib_p.patch

        Will extract all indices which begin with evc_lib.

        -or-

        python %prog '^(?!evc_lib)' p.patch > not_evc_lib_p.patch

        Will extract all indices which do *not* begin with evc_lib.

authors:
    Ross Rogers, 2009.04.02
'''

import re,os,sys
from optparse import OptionParser

def main():

    parser = OptionParser(usage=base_usage_str)

    (options, args) = parser.parse_args(args=sys.argv[1:])

    if len(args) != 2:
        parser.print_help()
        if len(args) == 0:
            sys.exit(0)
        else:
            sys.exit(1)

    (index_regex,patch_file) = args
    sys.stderr.write('Extracting patches for indices found by regex:%s\n'%index_regex)
    #print 'user_regex',index_regex
    user_index_match_regex = re.compile(index_regex)

    # Index: verification/ring_td_cte/tests/mmio_wr_td_target.e
    # --- sw/cfg/foo.xml      2009-04-30 17:59:11 -07:00
    # +++ sw/cfg/foo.xml      2009-05-11 09:26:58 -07:00

    index_cre = re.compile(r'''(?:(?<=^)|(?<=\n))(--- (?:.*\n){2,}?(?![ @\+\-]))''')

    patch_file = open(patch_file,'r')
    all_patch_sets = index_cre.findall(patch_file.read())
    patch_file.close()

    for file_edit in all_patch_sets:
        # extract index subset
        index_path = re.compile('\+\+\+ (?P<index>[\w_\-/\.]+)').search(file_edit).group('index').strip()
        if user_index_match_regex.search(index_path):
            sys.stderr.write("Index regex matched index: "+index_path+"\n")
            print file_edit,

if __name__ == '__main__':
    main() 
```

# asp.net - showModalDialog 会干扰 ClientScript.RegisterStartupScript 吗？

> ID：710846
> 
> 赞同：0
> 
> 时间：2009-04-02T17:49:06.817
> 
> 标签：asp.net, showmodaldialog

我正在通过“window.showModalDialog(...”显示一个模式对话框，这发生在一个 vbscript 函数中(显示的页面是 aspx)。我想根据 a 中的行数调整窗口大小数据表回来了。所以我很自然地去注册一个根据行数调整窗口大小的启动脚本。好吧，那没有用，所以我尝试注册一个只显示 msgbox 的脚本。

代码看起来像（在 OnLoad 事件处理程序中）：

```
 if (!this.ClientScript.IsStartupScriptRegistered(typeof(MyPageClassName), "hello"))
        {
            this.ClientScript.RegisterStartupScript(typeof(MyPageClassName), "hello",
                    @"<script language=vbscript>
                        sub fnWindowOnLoad()
                            MsgBox ""hello""
                        end sub
                        <script>", false);
        }
        if (!this.ClientScript.IsStartupScriptRegistered(typeof(MyPageClassName), "hello"))
        {
            throw new Exception("Failed to load script");
        } 
```

在我看来，这应该可以工作，并在页面加载时显示一个消息框，上面写着“你好”（我已将窗口的 onload 事件设置为 fnWindowOnLoad）。但所发生的一切都没有，没有例外，没有警觉。我已经尝试了 typeof 调用中我能想到的所有类型。似乎没有任何效果。我唯一能想到的是，由于对话框是模态 ClientScript.RegisterStartupScript 将无法正常运行。但这对我来说没有任何意义。

我将 MsgBox “hello” 调用直接放入我的脚本块并显示警报，所以这是可能的。但我需要修改后面代码中的一些参数，所以我必须使用 RegisterStartupScript。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T18:10:50.133

您是否尝试过通过 window.open() 而不是 window.showModalDialog() 打开窗口？我在网上看到了一些关于 showModalDialog() 和 RegisterStartupScript 之间不兼容的帖子。

showModalDialog() 是一个仅限 IE 的方法，所以无论如何都不推荐。我知道这很方便，因为它返回一个值，但是有多种方法可以模拟此功能。

**编辑：** showModalDialog() 的另一个问题是 IE 经常缓存结果。这意味着，如果您有一次调用该对话框，但您没有调整它的大小，那么另一次您这样做，那么第二次可能会获得您的第一个缓存对话框。解决这个问题的一种方法是在末尾添加一个唯一的查询字符串。像 MyDialog.aspx?q=320934 （随机生成或基于服务器 tic 生成）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T19:32:54.053

解决方案是有一个脚本从隐藏字段中读取一个值，然后调整对话框的大小。该值是在 Page_Load 上设置的。使用 RegisterStartupScript 似乎从来没有工作过，RegisterClientScript 也没有，所以我很确定模态对话框和 RegisterXxx 不能相处。需要在 vbscript 中使用 window.dialogHeight & window.dialogWidth。

# php - Gmail 喜欢使用 jQuery 上传文件

> ID：710852
> 
> 赞同：21
> 
> 时间：2009-04-02T17:50:18.983
> 
> 标签：php, ajax, jquery

我想像谷歌邮件一样上传文件。我想使用 jQuery 和 PHP 来完成它是否有获取进度条等？

在这里，我添加了一段关于谷歌如何做到这一点的视频。[http://dl.getdropbox.com/u/5910/Jing/2009-04-02_1948.swf](http://dl.getdropbox.com/u/5910/Jing/2009-04-02_1948.swf)

请不要闪存，不要 perl 或 cgi..

我想我现在可以不用进度条了

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-03-04T22:20:30.437

奇怪的是人们说gmail不使用flash，而你可以在gmail界面中清楚地看到swf文件。尝试右键单击“附加文件”。这就是允许一次多次上传的原因。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-02T17:58:17.327

最简单的方法是使用[SWFUpload](http://swfupload.org/)，它是一个用 Flash 编写的小按钮，带有所有在 JS 中驱动它的钩子。非常易于使用并且与 PHP 配合得很好

但是，如果您真的希望它是纯 JS，则需要服务器提供一些帮助。具体来说，您需要开始上传，并定期向服务器查询进展情况。不幸的是，PHP 上传处理直到下载完成后才会收到任何通知。你必须用别的东西代替它。正因为如此，有一些纯 JS 上传器包含示例 Perl 服务器代码。

IOW：JS 和 PHP 没有（完全）削减它。要么向客户端添加闪存，要么在服务器上添加更好的上传处理程序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-02-09T22:33:53.567

在我看来，关于这个主题的优秀文章： [http ://robertnyman.com/html5/fileapi-upload/fileapi-upload.html](http://robertnyman.com/html5/fileapi-upload/fileapi-upload.html)

不幸的是，缺乏对 IE 和 Opera 的支持，但希望这会改变。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-02T18:08:04.057

[Uploadify](http://www.uploadify.com/)是另一个使用 jquery 的 swf（对不起）上传按钮。与哈维尔提到的想法相同。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-02T18:05:09.010

PHP 不支持直接报告上传进度。所以没有办法读回上传状态。但是，有一个[补丁](http://pdoru.from.ro/)可能会起作用。不过我没试过。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-23T21:03:37.717

GMail 使用 Flash 在后台上传文件。[SWFUpload](http://swfupload.org/)是一个开源项目，它反对类似的东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-01-08T05:15:58.780

...gmail 使用具有样式 display:hidden; 的 iFrame；然后当您在表单上上传时，它会将 iFrame 发送到上传网址。根本不涉及闪光。Google 在 Gmail 上使用 flash 所做的唯一事情就是为聊天发出声音。你必须在设置中允许它。他们并没有真正过多地使用闪存，只是因为它在内存和 cpu 使用方面非常糟糕。Javascript 可以做任何 flash 可以做的事情（尽管在某些情况下需要更多的代码），但 99% 的情况下，Javascript 更快，并且在内存方面更好。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-10-31T15:58:18.733

也许你可以使用 PlUpload。它支持很多类型并且是高度可定制的。您可以查看网站上的演示。在主页上它还显示了它在主页上支持的内容并具有回退机制。

[http://www.plupload.com/](http://www.plupload.com/)

编辑：它可以作为一个 jQuery 插件使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-06-25T14:17:01.400

SWFUpload 是 gud 并且与所有类型的 Web 应用程序兼容

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-01-08T07:50:13.047

关于表单提交时 Ajax 不支持二进制数据.. 有一个解决方法；[如果你是 jQuery，那么你可以在http://www.malsup.com/jquery/form/](http://www.malsup.com/jquery/form/)使用这个表单插件（来自 malsup）。我已经用了很多年了...

plupload 似乎也很有希望……为此竖起大拇指；）我必须说它有点笨重！！！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-12-20T01:38:11.123

2018 年，使用纯 JavaScript 的网站可以上传文件，就像 Google Mail 为邮件附件所做的那样。单击即可调出 Web 浏览器的文件浏览器对话框。开始上传不需要单独的提交按钮。诀窍是使用隐藏的 HTML`<input type="file">`元素。

示例 HTML 和 JavaScript：

```
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>File Upload</title>
  <!-- Demo a button to upload files from a local computer to a web server. -->
</head>
<body>
  <input type="file" id="inputFileElement" multiple style="display:none">
  <button id="fileSelectButton">Select some files</button>

  <script>
    const fileSelectButton = document.getElementById("fileSelectButton");
    const inputFileElement = document.getElementById("inputFileElement");

    // When the user presses the upload button, simulate a click on the
    // hidden <input type="file"> element so the web browser will show its
    // file selection dialog.
    fileSelectButton.addEventListener("click", function (e) {
      if (inputFileElement) {
        inputFileElement.click();
      }
    }, false);

    // When the user selects one or more files on the local host,
    // upload each file to the web server.
    inputFileElement.addEventListener("change", handleFiles, false);
    function handleFiles() {
      const fileList = inputFileElement.files;
      const numFiles = fileList.length;
      for (let i = 0; i < numFiles; i++) {
        const file = fileList[i];
        console.log("Starting to upload " + file.name);
        sendFile(file);
      }
    }

    // Asynchronously read and upload a file.
    function sendFile(file) {
      const uri ="serverUpload.php";
      const xhr = new XMLHttpRequest();
      const fd = new FormData();
      xhr.open("POST", uri, true);
      xhr.onreadystatechange = function() {
        if (xhr.readyState == 4 && xhr.status == 200) {
          console.log("Finished uploading: " + xhr.responseText); // handle response.
        }
      };
      fd.append('myFile', file);
      // Initiate a multipart/form-data upload
      xhr.send(fd);
    }
  </script>
</body>
</html> 
```

PHP代码：

```
<?php
if (isset($_FILES['myFile'])) {
    // Example:
    move_uploaded_file($_FILES['myFile']['tmp_name'], "uploads/" . $_FILES['myFile']['name']);
    echo $_FILES['myFile']['name'];
    exit;
}
?> 
```

This works on Internet Explorer 11, Edge, Firefox, Chrome, Opera. This example was derived from [https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications](https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications)

For a progress bar, see [How to get progress from XMLHttpRequest](https://stackoverflow.com/questions/76976/how-to-get-progress-from-xmlhttprequest)

# c# - Base64 字符串抛出无效字符错误

> ID：710853
> 
> 赞同：14
> 
> 时间：2009-04-02T17:51:05.267
> 
> 标签：c#, string, ado.net, base64, invalid-characters

我不断收到 Base64 无效字符错误，即使我不应该这样做。

该程序获取一个 XML 文件并将其导出为文档。如果用户需要，它也会压缩文件。压缩工作正常并返回一个 Base64 字符串，该字符串编码为 UTF-8 并写入文件。

当需要将文档重新加载到程序中时，我必须检查它是否压缩，代码很简单：

```
byte[] gzBuffer = System.Convert.FromBase64String(text);
return "1F-8B-08" == BitConverter.ToString(new List<Byte>(gzBuffer).GetRange(4, 3).ToArray()); 
```

它检查字符串的开头以查看其中是否包含 GZips 代码。

现在的问题是，我所有的测试都有效。我取一个字符串，对其进行压缩、解压缩，然后将其与原始字符串进行比较。问题是当我得到从 ADO 记录集返回的字符串时。该字符串正是写入文件的内容（最后添加了“\ 0”，但我认为它甚至不会做任何事情，即使修剪掉它仍然会抛出）。我什至将整个字符串复制并粘贴到测试方法中并压缩/解压缩。工作正常。

测试将通过，但代码将使用完全相同的字符串失败？唯一的区别是不是仅仅声明一个常规字符串并将其传递给我，而是从记录集中返回一个。

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-02T18:00:40.580

你说

> 该字符串正是写入文件的内容（最后添加了“\ 0”，但我认为这甚至没有任何作用）。

事实上，它确实做了一些事情（它会导致您的代码抛出`FormatException`：“Base-64 字符串中的无效字符”），因为[`Convert.FromBase64String`](http://msdn.microsoft.com/en-us/library/system.convert.frombase64string.aspx)它不认为“\0”是一个有效的 Base64 字符。

```
 byte[] data1 = Convert.FromBase64String("AAAA\0"); // Throws exception
  byte[] data2 = Convert.FromBase64String("AAAA");   // Works 
```

**解决方案：摆脱零终止。** （也许打电话`.Trim("\0")`）

**备注**：

[MSDN 文档`Convert.FromBase64String`](http://msdn.microsoft.com/en-us/library/system.convert.frombase64string.aspx)说它会抛出一个`FormatException`when

> s 的长度，忽略空格字符，不为零或 4 的倍数。
> 
> -或者-
> 
> s 的格式无效。s 包含非 base 64 字符、两个以上的填充字符或填充字符中的非空白字符。

然后

> 从零开始按升序排列的 64 位基数是大写字符“A”到“Z”、小写字符“a”到“z”、数字“0”到“9”以及符号“+”和“/” .

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T18:08:58.563

是否允许 null char 实际上取决于所讨论的 base64 编解码器。鉴于 Base64 标准的模糊性（没有权威的确切规范），许多实现会忽略它作为空白。然后其他人可以将其标记为问题。最有问题的人不会注意到，并会很高兴地尝试对其进行解码...... :-/

但听起来 c# 实现不喜欢它（这是一种有效的方法），所以如果删除它有帮助，应该这样做。

一个小的附加评论：UTF-8 不是必需的，ISO-8859-x aka Latin-x 和 7 位 Ascii 也可以。这是因为 Base64 专门设计为仅使用 7 位子集，该子集适用于所有 7 位 ascii 兼容编码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-16T10:58:27.747

```
string stringToDecrypt = HttpContext.Current.Request.QueryString.ToString() 
```

//更改为字符串 stringToDecrypt = HttpUtility.UrlDecode(HttpContext.Current.Request.QueryString.ToString())

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T19:28:41.617

如果无法从字符串末尾删除 \0，您可以为您编码的每个字符串添加自己的字符，并在解码时将其删除。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-16T06:33:21.187

从字符串转换 Base64 的一个问题是，一些转换函数使用前面的“data:image/jpg;base64”，而其他函数只接受实际数据。

# wcf - 如何使用 WCF 发送复杂对象？它有效吗？好吗？

> ID：710856
> 
> 赞同：1
> 
> 时间：2009-04-02T17:51:57.807
> 
> 标签：wcf, data-binding, datacontract

我可以有这种形状的数据合同吗？

```
[DataContract]

public class YearlyStatistic{

[DataMember]
public string Year{get;set;}

[DataMember]
public string StatisticName {get;set;}

[DataMember]
public List<MonthlyStatistic> MonthlyStats {get;set}
}; 
```

我在这里假设 MonthlyStatistic 类也需要是 DataContract。您可以在 Web 服务中执行此操作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T18:13:46.743

要将相同的模型用于 Web 服务，请将您的类标记为可序列化，使用 System.Xml.Serialization 命名空间中的 XmlRoot 和 XmlElement。这是使用您的示例的示例：

```
[Serializable]
[XmlRoot("YearlyStatistic")]
public class YearlyStatistic
{
    [XmlElement("Year")]
    public string Year { get; set; }

    [XmlElement("StatisticName")]
    public string StatisticName { get; set; }

    [XmlElement("MonthlyStats")]
    public List<MonthlyStatistic> MonthlyStats { get; set; } 
} 
```

您必须对父对象的复杂对象属性执行相同的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T18:05:57.930

是的，这就是标准的 WCF 序列化。您是想说 MonthlyStats 集合有一个名为 WeeklyStats 的属性，还是说每个单独的 MonthlyStatistic 都有一个 WeeklyStat 集合？如果它是前者，那它本身在 WCF 中不起作用。你必须做一些摆弄才能让它工作。如果是后者，那完全没问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-28T04:50:28.760

是的，您可以从 WCF 服务来回发送您上面提到的数据合同。就像你说的，MonthlyStatistic 及其所有成员必须自己定义为数据合约或内置类型（如字符串）。

您甚至可以发送和接收更复杂的类型，例如当您有一个基类但想要发送或接收派生类的对象时（您可以使用 KnownType 属性来做到这一点）。在从 Javascript 接收（反序列化）时，有一个技巧，您必须使用它指定 WCF 的类型。如果您有兴趣，请随时询问。

# php - 如何在 PHP 中隐藏文件扩展名？

> ID：710857
> 
> 赞同：0
> 
> 时间：2009-04-02T17:52:29.210
> 
> 标签：php, jquery

我正在使用带有 PHP 连接器的 jquery 插件[jqueryFileTree](http://abeautifulsite.net/notebook/58)（稍作修改以提供目录单独的类）来显示目录的内容。但是，我想隐藏所有文件扩展名。有没有人做过类似的事情？我可以想到一两种实现它的方法，但它们似乎过于复杂......

在 PHP 中有相对简单的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T18:03:23.617

Looking at the PHP connector code, you want to replace this:

```
// All files
foreach( $files as $file ) {
    if( file_exists($root . $_POST['dir'] . $file) && $file != '.' && $file != '..' && !is_dir($root . $_POST['dir'] . $file) ) {
        $ext = preg_replace('/^.*\./', '', $file);
        echo "<li class=\"file ext_$ext\"><a href=\"#\" rel=\"" . htmlentities($_POST['dir'] . $file) . "\">" . htmlentities($file) . "</a></li>";
    }
} 
```

With this:

```
// All files
foreach( $files as $file ) {
    if( file_exists($root . $_POST['dir'] . $file) && $file != '.' && $file != '..' && !is_dir($root . $_POST['dir'] . $file) ) {
        $parts = explode(".", $file);
        $ext = array_pop($parts);
        $name = implode(".", $parts);
        echo "<li class=\"file ext_$ext\"><a href=\"#\" rel=\"" . htmlentities($_POST['dir'] . $file) . "\">" . htmlentities($name) . "</a></li>";
    }
} 
```

Please note that the code in this provided connector script is not all that safe and you should take steps to prevent users abusing it to get access to sensitive folders.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T00:58:31.807

查看[directoryIterator](http://php.net/manual/en/class.directoryiterator.php)类和[pathinfo()](http://php.net/manual/en/function.pathinfo.php)函数。

# java - JCA有什么好处？

> ID：710859
> 
> 赞同：14
> 
> 时间：2009-04-02T17:53:07.103
> 
> 标签：java, jakarta-ee, backend, connector, jca

我们的应用程序经常通过 Web 服务、MQ、JDBC、专有（直接通过套接字）和其他类型的传输连接到不同类型的后端。我们已经有许多实现可以让我们从应用程序连接到这些后端，虽然所有这些实现都实现了通用的 java 接口，但它们不共享任何其他内容。

我们已经意识到，对于所有这些特定的连接器实现来说，存在一些通用的代码部分，我们决定通过一个通用连接器来简化未来连接器的开发。此连接器将能够将消息格式化为后端预期的格式，并使用可用的传输机制发送它们。例如，通过 MQ 或通过套接字的固定长度消息格式。

我们面临的困境之一是最适合这种连接器的技术。到目前为止，我们的连接器是实现通用 java 接口的基本 java 类。由于我们通常将我们的应用程序托管在一些 Java EE 应用程序服务器中，因此 Java 连接器架构似乎是最适合该软件的技术。但是，实现符合 JCA 的连接器似乎相对复杂。采用标准 - JCA 有哪些明显的好处，这些好处是否证明了额外努力的合理性？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-09T13:01:36.950

事实上，JCA**似乎**是最适合您的技术。已经提出了很好的论据，即可移植性、标准化接口、连接池和事务支持。不要忘记安全。

使用 WebSphere Process 服务器，适配器可以作为 SCA 服务公开，如果这对您很重要，它会带来很多好处。

此外，一些开发工具为开发和测试 JCA 连接器提供了广泛的支持。

另一个好处是（经验丰富的）Java EE 管理员和 Java EE 开发人员（应该）了解标准，因此管理和开发应该很容易简化。

但最终你应该根据你的项目范围、你对项目的未来计划或者可能在你公司的政策范围内找到实施 JCA 的理由。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-12T14:15:07.673

简短回答：我认为选择 JCA 与其他技术相比没有任何好处，我认为这是一个缺点，因为您需要 Java EE 容器。

长答案：

一段时间以来，我一直对这些 Java EE 标准持怀疑态度。我不再认为使用全功能 Java EE 服务器有令人信服的*技术理由，因为提供的**每个*功能都有更好的开源实现。在进出“企业解决方案”时，我曾多次被实施不兼容所困扰。

JCA 的想法现在在这里浮出水面，我正在努力尝试[apache camel](http://camel.apache.org)或[spring 集成](http://www.springsource.org/spring-integration)。我完全支持你可以在任何地方使用的开源实现。并且发生了很多事情。检查[此组件列表](http://camel.apache.org/components.html)。诚然，可能比已经使用 JCA 开发的要小，但每一点都是开源的，而且都在一个位置。另外，我相信文档更简单、更完整。集成的需求需要一个强大的 SPI，其中包含大量开源、真实的示例，以相同的方式开发，并且可以在同一个地方找到。

I am hating the negativity, but I don't like full featured application servers. For instance, I would go for tomcat and terracota *any day* over other "enterprisey" products, just as I would go with camel before JCA, until the need for JCA gets proven. I don't like the idea of the Java Committee to tell how I should develop my own applications because I don't trust them. I believe it is in my best interest when the piece of software can work just as easily on Java SE/RCP as in a Java EE environments or in a pure Servlet container.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-04T02:55:03.360

我刚刚为通过专有协议进行通信的 gps 设备开发了一个入站资源适配器。这并没有那么麻烦，尽管我的印象是开发出站可能需要更多的工作。JCA 最糟糕的事情是缺乏文档。所有书籍和文章似乎都有相同的愚蠢示例。

我最满意的是便携性。编写完适配器后，您可以将 rar（资源适配器存档）插入任何应用程序服务器，以使部署的应用程序能够与您的 ra 支持的 eis 进行通信。或者您可以将 rar 捆绑到 war/ear 中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T20:06:35.993

这些好处主要适用于希望将连接器出售给专有后端系统以与任何应用程序服务器一起使用的供应商，以及希望能够插入连接器而不担心它是否仅适用于 WebLogic 而不是 Websphere 等的客户。确实这是 Java EE 的总体目标。

请注意，JBoss 已决定将几件事放入 JCA，例如 JDBC 连接通过 JCA。

您未来的客户端代码将具有标准化的接口、一些池和事务支持等，但重要的是要着眼大局；也就是说，好处不是专门针对您和您的一个项目，而是针对由许多应用程序服务器、许多后端系统、许多连接器等组成的软件生态系统。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T21:17:20.717

听起来对带有绑定组件 的[JBI容器很有用。](http://www.netbeans.org/kb/60/soa/jbi-tech-overview.html)[JCA 与 JBI 的讨论](http://blogs.iona.com/newcomer/archives/000182.html)。

# log4net - log4net 与 Nlog

> ID：710863
> 
> 赞同：355
> 
> 时间：2009-04-02T17:53:42.967
> 
> 标签：log4net, nlog

有人有这两种经验吗？它们如何相互叠加？

我们计划使用其中一个来登录企业应用程序。

参考：

[log4net](http://logging.apache.org/log4net/index.html)

[日志](http://www.nlog-project.org/)

编辑：我们没有对 nlog 或 log4net 的现有依赖项。

* * *

## 回答 #1

> 赞同：383
> 
> 时间：2010-01-22T23:47:01.890

我最近的任务是为即将到来的项目“制作一些登录原型”。我没有任何日志框架经验。我在 Log4Net、NLog 和 Enterprise Library 上研究、浏览教程、制作玩具应用程序等几天。3-4 周后回来，将它们组合成一个有凝聚力的演示。希望其中一些对您有用。

我对我们项目的建议是：

1.  使用日志外观（例如[Common.Logging](http://netcommon.sf.net/)、[SimpleLoggingFacade](https://slf.codeplex.com/)）来避免直接依赖。
2.  如果我们最终将 Enterprise Library 用于其他设施，那么也将它用于 Logging。
3.  如果我们最终使用依赖于 Log4Net 的东西，请使用 Log4Net。
4.  如果以上都不是，请使用 NLog。我更喜欢哪个。

这是基于这些发现（意见！）：

*   所有 3 个框架都有能力并且可以做一些复杂的事情。我们想要一个高质量的解决方案，但坦率地说不需要超高性能或 60 种类型的事件接收器。
*   这三个都有非常相似的基本概念。
*   每个都有自己很酷的技巧，比如真正的高级路由、动态日志文件名、文件截断等。
*   所有这 3 个都以自己的方式得到了很好的记录。
*   对于像我这样的新手来说，一开始他们都有些尴尬。对于基础知识，这里没有太大的区别。我克服了它。
*   几周后重新访问时，NLog*显然*是最容易恢复的。我几乎不需要刷它。使用 Log4Net，我不得不重新访问一些在线示例才能开始。使用 EntLib，我放弃了，从头开始重新学习教程——我完全迷失了。
*   我不知道如何让 EntLib 做一些事情，比如登录到数据库。这可能很容易，但这超出了我的时间限制。
*   Log4Net 和 NLog 的代码内占用空间很小。EntLib 是垃圾邮件，但无论如何我都会使用外观。
*   我不小心错误地配置了 EntLib，它在运行时告诉我。Log4Net 没有。我没有意外错误配置 NLog。
*   EntLib 带有一个漂亮的 app.config 编辑器，你 100% 需要它。NLog 有一个配置文件架构，因此您可以获得“智能感知”。Log4Net 带有 nada。

很明显，到目前为止我喜欢 NLog。尽管有其他解决方案可用，但仍不足以使用它。

* * *

## 回答 #2

> 赞同：158
> 
> 时间：2010-10-01T17:05:01.990

没有太多讨论的一个关键考虑因素是支持和更新。

[**自 2006 年 4 月 19 日发布 1.2.10 版以来，Log4Net 尚未更新**](https://issues.apache.org/jira/browse/LOG4NET/fixforversion/11128)。

相比之下，NLog 自 2006 年以来一直受到积极支持，即将发布[**NLog 2.0 支持许多在 log4net 上次更新时不存在的平台，**](http://nlog-project.org/2010/09/26/nlog-2-0-beta-1-has-been-released.html)例如：

*   NET Framework 2.0 SP1 及更高版本、3.5 和 4.0（客户端和扩展配置文件）
*   银光 2.0、3.0、4.0
*   .NET Compact Framework 2.0、3.5
*   单声道 2.x 配置文件

* * *

## 回答 #3

> 赞同：97
> 
> 时间：2011-12-27T23:15:32.670

最近有两个框架的经验，我想我可以分享我对每个框架的看法。

我被要求评估现有 Web 应用程序的日志框架，在浏览了各种在线论坛后，我将选择范围缩小到 NLog (v2.0) 和 log4net (v1.2.11)。以下是我的发现：

1.  使用 NLog 设置/启动非常简单。你在他们的网站上浏览入门教程，你就完成了。你有一个公平的想法，nlog 的情况如何。配置文件非常直观，任何人都可以理解配置。例如：如果要设置内部日志记录，则在 Nlog 配置文件的标头节点中设置标志，这是您期望的位置。在 log4net 中，您可以在 web.config 的 appSettings 部分设置不同的标志。

2.  在 log4net 中，内部日志不会输出令人讨厌的时间戳。在 Nlog 中，您会得到一个带有时间戳的漂亮日志。我发现它在我的评估中非常有用。

3.  log4net 中的过滤器 - 你最好检查我的这个问题 - [log4net 过滤器 - 如何编写 AND 过滤器以忽略日志消息](https://stackoverflow.com/q/8604041/984438)，如果你找到答案/解决方案，请告诉我。我了解，这个问题有一个解决方法，因为您可以编写自己的自定义过滤器。但是在 log4net 中不容易获得的东西。

4.  性能 - 我使用存储过程将大约 3000 条日志消息记录到数据库。我使用简单的 for 循环 (int i=0; i<3000; i++... 记录相同的消息 3000 次。对于写入：log4net AdoAppender 花费的时间几乎是 NLog 的两倍。

5.  Log4net 不支持异步 appender。

选择 NLog 作为日志框架对我来说已经足够了。:)

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2010-08-31T18:06:48.003

For anyone getting to this thread late, you may want to take a look back at the .Net Base Class Library (BCL). Many people missed the changes between .Net 1.1 and .Net 2.0 when the **TraceSource** class was introduced (circa 2005).

Using the TraceSource is analagous to other logging frameworks, with granular control of logging, configuration in app.config/web.config, and programmatic access - without the overhead of the enterprise application block.

*   [.Net BCL Team Blog: Intro to Tracing - Part I](http://blogs.msdn.com/b/bclteam/archive/2005/03/15/396431.aspx) *(Look at Part II a,b,c as well)*

There are also a number of comparisons floating around: "log4net vs TraceSource"

* * *

## 回答 #5

> 赞同：34
> 
> 时间：2009-10-22T10:19:24.263

对我们来说，关键的区别在于整体性能......

看看`Logger.IsDebugEnabled`NLog 与 Log4Net，从我们的测试来看，NLog 的开销更少，这就是我们所追求的（低延迟的东西）。

干杯，弗洛里安

* * *

## 回答 #6

> 赞同：25
> 
> 时间：2009-04-02T18:03:21.540

First look at the rest of your stack.

If you are using NHibernate, it utilizes Log4Net directly. Other frameworks might have other specific loggers they need.

Other than that: both work fine.

I've settled on Log4Net myself. It can be a pain to configure, and if it isn't configured correctly it is a pain to figure out what went wrong. But you can make it do almost anything you would want from a logger.

If you don't have a standing issue with Log4Net, here is an article I wrote on how to get started with it: [http://elegantcode.com/2007/12/07/getting-started-with-log4net/](http://elegantcode.com/2007/12/07/getting-started-with-log4net/)

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2010-10-07T20:10:11.907

好吧..我使用企业库来执行数据库日志记录任务，现在由于性能瓶颈而切换到 NLog。

一些比较信息：

[http://pauliusraila.blogspot.com/2010/10/solving-database-logging-bottlenecks.html](http://pauliusraila.blogspot.com/2010/10/solving-database-logging-bottlenecks.html)

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2010-06-27T14:50:20.777

我回应上述内容并且更喜欢nLog。Entlib 是不必要的臃肿。

Re:Log4net 对 log4net 来说总是让我感到困惑的一件事是忘记将以下内容添加到 global.asax 以初始化组件：

```
log4net.Config.XmlConfigurator.Configure(); 
```

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2010-09-25T10:14:33.210

如果你去[这里，](http://www.dotnetlogging.com/comparison/)你可以找到一个包含 NLog 和 Log4Net 库以及 Enterprise Lib 和其他产品的综合矩阵。

有人可能会争辩说，矩阵的完成方式是为了强调矩阵中唯一商业库的特征。我认为这是真的，但无论如何推动我的选择与 NLog 是有用的。

问候

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2013-10-05T03:45:24.487

Shameless plug for an open source project I run, but given the lively discussion about which .NET logging framework is more active I thought I'd post an obligatory link to [Serilog](http://serilog.net).

To use within an application, Serilog is similar to (and draws heavily on) log4net. Unlike other .NET logging options, however, Serilog is about preserving the structure of log events for offline analysis. When you write:

```
Log.Information("The answer is {Answer}", 42); 
```

Most logging libraries immediately render the message into a string. Serilog can do that too, but it preserves the `{ Answer: 42 }` property so that later on, using one of a number of NoSQL data stores, you can properly query events based on the value of `Answer`.

We're close to a 1.0 and support all of the modern (.NET 4.5, Windows Store and Windows Phone 8) platforms.

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2009-09-04T16:53:40.883

正如我所注意到的，log4net 在应用程序运行的整个过程中都会锁定它们的输出文件，因此您无法删除它们。否则它们是相似的。

所以我更喜欢NLog。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2011-01-05T13:36:26.257

I second NLog too because it works with unmanaged code too. I suppose it could be possibe to use log4net and log4cxx together, but NLog handles both managed and unmanaged code out of the box.

I also looked at [Common.Logging](http://netcommon.sf.net/), a facade that makes abstraction of the logging api, it supports log4net, NLog and Entreprise Library. I don't think i'll use it, but i like how they use lambdas to improve performance when logging is disabled (a feature shared with NLog and probably others).

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-04-02T18:18:36.730

You might also consider [Microsoft Enterprise Library Logging Block](http://msdn.microsoft.com/en-us/library/ff664569(v=pandp.50).aspx). It comes with nice designer.

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-05-04T01:44:48.837

我认为普遍的共识是 nlog 更容易配置和使用。不过，两者都相当有能力。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-08-10T11:18:09.410

根据我的经验，[SmartInspect](http://www.gurock.com/smartinspect/)击败了 NLog 和 log4net。

它非常易于使用，文档很棒，您可以使用他们的交互式日志查看器**查看和过滤以前记录的消息**，这是一个巨大的现实世界优势。

我喜欢的一件事是数据的选项卡式视图，例如 Chrome 中的浏览器选项卡。每个选项卡都可以提供不同的日志过滤视图。

# visual-studio - VS SDK 1.1 MSI 安装程序属性是什么？

> ID：710869
> 
> 赞同：0
> 
> 时间：2009-04-02T17:54:58.097
> 
> 标签：visual-studio, sdk, installation, windows-installer

我的问题是：我遇到了 TFS 构建失败，我已将其追溯到 SOFTWARE\Microsoft\VisualStudio\9.0Exp 下似乎缺少的注册表项。

这台机器通过命令行安装了 VS SDK 1.1：msiexec vsski.msi

所以，我猜我需要将一些属性传递给 msiexec 来告诉它应该安装一些默认情况下没有安装的组件——这是正确的吗？如果是这样，谁能指出我正确的财产？

msiexec vssdk.msi WHATPROPERTY=”我想控制安装哪些组件”</p>

还是我在这里偏离轨道？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T19:33:06.160

好的，我找到了答案，但我有点偏离了轨道。

更多背景：调用自定义任务VsTemplatePaths时，Microsoft.VsSDK.targets文件的VsTemplatePathsTarget出现错误。一个小反射器（很棒的工具！）告诉我它正在尝试找到上面的注册表项。

当我更仔细地跟踪它时，我发现密钥不在 HKLM 下，而是在 HKCU 下，但是反射器和一些跟踪消息说它正在使用 HKCU。更准确地说，有问题的密钥存在于我在 HKEY_USERs 中的帐户下，而不是运行 TFS 构建的帐户下。

事实证明，我的自动安装顺序是在安装 VS SDK 之后创建构建帐户，因此当它配置注册表设置时，它只对现有用户而不是默认用户这样做。

# visual-studio - 找不到引用的组件“系统”。（或与此相关的任何其他组件）

> ID：710890
> 
> 赞同：42
> 
> 时间：2009-04-02T18:03:13.257
> 
> 标签：visual-studio, visual-studio-2008

**问题：**`The referenced component 'SomeComponent' could not be found.`今天刚开始，在尝试构建时，对解决方案之外的任何程序集的所有引用都无法解决。这发生在第 3 方组件（全部 15 个左右）以及所有 .NET Framework 程序集上——基本上任何不是同一解决方案中的另一个项目的东西。

尝试加载其他一些解决方案会产生相同的问题。但是，创建一个新的 WinForms 项目没有问题。（从头开始，它在重新安装 VS 之前工作，现在也不起作用。我创建了一个新的 WinForms 应用程序和一个 WPF 应用程序，设计器也无法加载程序集。我尝试定位 3.5 和 2.0 并且没有运气。）

**我尝试过的事情：**

*   修复 Visual Studio 安装
*   重新启动计算机
*   使用 /resetsettings 标志启动 VS
*   系统还原到 2 天前已知可以正常工作
*   卸载VS并重新安装
*   来自 SVN 的新鲜结帐

有没有人有这方面的经验并且知道如何让它再次工作？我最强大的 Google-fu 让我失望了，所以我在这里问。如果需要，可以标记社区 wiki。

更新：我尝试“升级”Windows（到相同版本），因为我没有看到 Vista 的修复选项，而且它仍然不行。我重新安装了所有看起来相关的东西。到目前为止，看起来我只需要备份并重新格式化我想除非明天之前的某个时间出现解决方案。

更新 2：我刚刚备份了数据并重新格式化，所以我不再能够验证我还没有尝试过的任何想法，所以我将让赏金自行过期，并作为投票最多的答案参考以后可能遇到此问题的任何其他人。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2015-12-01T12:51:24.930

我有同样的问题。事实证明，NuGet 出了点问题。我删除了`*.csproj`-File 的以下部分（在文本编辑器中打开）。这为我解决了这个问题：

```
<Target Name="EnsureNuGetPackageBuildImports" BeforeTargets="PrepareForBuild">
    <PropertyGroup>
        <ErrorText>This project references NuGet package(s) that are missing on this computer. Enable NuGet Package Restore to download them.  For more information, see http://go.microsoft.com/fwlink/?LinkID=322105\. The missing file is {0}.</ErrorText>
    </PropertyGroup>
    <Error Condition="!Exists('$(SolutionDir)\.nuget\NuGet.targets')" Text="$([System.String]::Format('$(ErrorText)', '$(SolutionDir)\.nuget\NuGet.targets'))" />
</Target> 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2014-06-02T14:14:45.173

就我而言，解决方案完全不同。看起来这是 NuGet 路径的问题（由于我将项目移动到不同的解决方案然后又返回。

我编辑了 .csproj 并删除了对 NuGet 和相关包的所有引用。我还从解决方案文件夹中删除了 packages 文件夹。

然后系统组件神奇地重新出现。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-06T18:13:47.083

建议的下一个调试步骤：查看**Project Designer: References -> Reference Paths**以验证系统和第三方组件的路径是否正确显示。（注意可能会滑过旧的 Mark I Eyeball 的东西，比如驱动器号。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-10T04:55:56.503

在使用 fuslogvw 启用程序集负载日志记录后尝试运行 VS。您将能够看到运行时在尝试定位和加载程序集时捕获的其他错误。

在 Vista 中，您必须以管理员身份运行 fuslogvw，并且有时会指定一个显式路径来保存日志。

您还可以尝试通过从另一个实例附加到 Visual Studio 来调试它，或者使用 .NET SDK 中包含的基本调试器。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-14T15:47:15.007

不久前我遇到了类似的问题。

我发现这个问题是由于 git 在从一个分支跳转到另一个分支时没有正确创建 .exe 引起的（我们在路径中有 nuget.exe，并且在跳转分支时它被删除/添加了）。当您尝试运行 nuget 时，Windows 会对 exe 产生影响。

多次重置分支后，我终于让 exe 正常运行。然后我注意到 repo 中所有目录的安全性都被重置了，所以我不得不处理这个问题。

毕竟，Visual Studio 开始表现不错。

希望这对某人有帮助！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-29T12:24:07.757

同一解决方案中其他项目的引用也可能存在问题。我只想构建一个项目，但收到有关另一个项目中引用的消息。尽管另一个项目中的问题是正确的，但我认为消息不正确：

1.  我没想到关于另一个项目的消息（另一个项目没有依赖关系，所以它不需要“构建”）
2.  我无法“解释”它，因为它没有提到它所涉及的项目）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-01T18:58:20.723

好吧，如果你点击错误，在VS 2012 RC中，然后调试它，错误就消失了......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-08-04T23:31:32.720

我知道这是一个老问题，但它仍在最新版本的 Visual Studio (2015) 中发生。我以不同的方式修复了它，当被问到问题时可能无法使用它。基本上，它与VS找不到.Net Library包的事实有关。要在最新版本的 Visual Studio (2015) 中修复：

*   在解决方案管理器中右键单击您的解决方案。选择“管理解决方案的 NuGet 包...”
*   在 NuGet 窗口中，转到“已安装”。
*   如果您有与 Microsoft.Net 相关的内容，例如“Microsoft.NetCore.UniversalWindowsPlatform”，请记住名称并卸载该软件包。
*   现在转到浏览选项卡并找到软件包并再次安装。不要忘记选择正确的所需项目。
*   现在一切都应该好了。

我希望这对某人有帮助！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-08T09:36:54.640

我不想这么说，但听起来系统很糟糕。必须有一点，重新安装操作系统比继续尝试修复当前安装更快。

我只是希望你以正确的精神接受这个......对不起。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-10T13:40:00.737

在这里黑暗中拍摄，但我遇到了同样（相似）的问题。我遇到的问题与拥有一台 64 位机器并运行一个混合了 64 位和 32 位第三方 dll 的项目有关。解决方案是确保我有正确的位（32v64），然后以 32 位模式构建项目：项目属性 > 构建 > 平台目标：x86。

另一次发生这种情况，我不得不删除所有 64 位 dll 并重新安装 32 位 dll

HTH

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-06-18T13:52:34.163

.nu​​get 文件夹丢失。添加带有 nuget 文件（通常是 3 个文件）的 .nuget 文件夹。打开解决方案，参考文献没有警告。我的子模块有 nuget 引用，当我提取最新版本时，解决方案需要项目文件夹中的 .nuget 文件夹。IE

```
 project
   /.nuget
   /submodule
     /.nuget 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-12-17T13:36:07.163

Visual Studio 无法找到我的任何参考资料。我所做的，并遵循上面的一些解决方案，是：

*   右键单击解决方案管理器窗口中的解决方案条目；
*   在新打开的 NuGet 窗口中转到已安装，选择所有条目并更新。

问题就解决了！

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-04-10T14:31:37.633

使用 ILDASM 检查您的输出，以确保引用正确显示——将它们与有效的程序集进行比较，看看是否有任何问题。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2021-05-21T07:51:31.010

我曾经遇到过一个问题，在 *.csproj 文件中。它在 Target 节点中定义了一个 Error 节点，如果一个引用/nuget-library 不存在，它会在构建时抛出错误。问题是VS没有显示其他库的正确状态，因此所有引用的库看起来都没有加载，在属性窗口中找不到本地文件路径。

这是一个示例。

```
 <Target Name="EnsureNuGetPackageBuildImports" BeforeTargets="PrepareForBuild">
<PropertyGroup>
  <ErrorText>This project references NuGet package(s) that are missing on this computer. Use NuGet Package Restore to download them.  xxx.</ErrorText>
</PropertyGroup>
<Error Condition="!Exists('..\packages\...\Microsoft.CodeDom.Providers.DotNetCompilerPlatform.props')" Text="$([System.String]::Format('$(ErrorText)', '..\packages\...\Microsoft.CodeDom.Providers.DotNetCompilerPlatform.props'))" />
<Error Condition="!Exists('..\packages\NOT-Exist.targets')" Text="$([System.String]::Format('$(ErrorText)', '..\packages\NOT-Exist.targets'))" />
    </Target> 
```

...

# c# - .Net 中的多个音频输出

> ID：710896
> 
> 赞同：7
> 
> 时间：2009-04-02T18:05:07.730
> 
> 标签：c#, .net, audio

我正在寻找一个可以将多达 16 个音频文件（mp3/wav）播放到 16 个模拟设备（将其视为 16 组扬声器）的 PC 盒。音频文件与模拟输出之间存在一对一的关系。提出的硬件明智的解决方案是使用多个声卡，所以我的问题是，是否有可用的库可以让我将音频文件播放到特定的声卡/通道？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T21:32:04.410

是的，BASS 库可以做到这一点。 [http://www.un4seen.com](http://www.un4seen.com)

C# 包装器也可用，一个商业包装器：
[Bass.NET](http://bass.radio42.com/)
和一个优秀的替代开源 C# 包装器，用于 Bass：[Mathew Sachin](https://stackoverflow.com/users/5377194/mathew-sachin)的
[ManagedBass](https://github.com/ManagedBass)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T00:57:32.620

我也在寻找的时候发现了这个。 [http://www.alvas.net/alvas.audio.aspx](http://www.alvas.net/alvas.audio.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T18:10:04.567

[FMOD](http://www.fmod.org/)应该做你正在寻找的东西。它也是一个非常快速、可靠和流行的库。

# svn - 强大的 SVN 导出和复制脚本？

> ID：710899
> 
> 赞同：2
> 
> 时间：2009-04-02T18:05:42.503
> 
> 标签：svn, batch-file

我正在寻找运行夜间脚本的最佳方法，该脚本将一组文件从 SVN 存储库导出到本地目录。导出完成后，将本地目录的内容复制到多个远程服务器。

这将是在 Windows Server 2003 机器上运行的计划回程作业。远程服务器都在网络上，所以不需要 FTP 等。

伪代码会像这样运行

```
1\. svn export repo localdir (plus some switches)
2\. ... wait to make sure export is finished ...
3\. robocopy localdir \\remotedir1
4\. robocopy localdir \\remotedir2, etc 
```

我对编写批处理作业非常陌生，但我希望它尽可能健壮： - 复制在导出完成之前不会开始 - 如果复制到 remotedir1 失败，脚本仍会继续复制到 remotedir2、3 等- 如果其中一个步骤有任何问题，是否可以记录问题？

任何关于批处理作业的输入将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T06:38:30.070

您可能不需要第 2 步等待，因为 SVN 在导出时会阻塞。除此之外，它看起来不错。您可以使用

```
svn export ... || (echo SVN export failed > log.txt & goto :eof) 
```

记录失败并在导出失败时停止批处理。`||`基本上告诉`||`只有在前面的命令失败（错误级别> 0）时才执行的命令。`goto :eof`退出批处理文件（或子程序），或者您可以使用`exit /b`它。

您也可以将此链接应用于 robocopy 命令：

```
robocopy ... || echo Copy to remotedir1 failed > log.txt 
```

或类似的东西。

另一种更详细的方法是`if`在您要保护的每个命令之后添加一个块：

```
if errorlevel 1 (
  echo Stuff > log.txt
) 
```

但是，所有这些方法都需要来自工具的正确退出代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T18:14:51.810

[Ant](http://ant.apache.org/)（需要 Java）可能是此类工作的不错选择。

Ant 是一个构建工具，对您描述的那种依赖链有很强的支持。语法也相当简单，因为它只是 XML。

# c# - 将颜色淡化为白色（增加亮度）

> ID：710902
> 
> 赞同：7
> 
> 时间：2009-04-02T18:06:28.367
> 
> 标签：c#, .net, winforms, colors, interpolation

我想在.NET“发光”黄色中制作一个文本框，然后“淡化”为白色（基本上，通过逐渐增加亮度）。我认为 Stackoverflow 在您发布答案后会这样做。我知道增加亮度并不是那么简单（它不仅仅是均匀地增加/减少 RGB），但我不确定如何做到这一点。

完美的色彩准确度对此并不重要。我正在使用 C#，尽管 VB 示例也可以。

**编辑：**这是针对 Winforms 的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T18:18:24.047

这可能超出您的需要，这是我使用的类的代码：

```
public class ControlColorAnimator
{
    private const int INTERVAL = 100;

    private readonly decimal _alphaIncrement;
    private readonly decimal _blueIncrement;
    private readonly Color _endColor;
    private readonly decimal _greenIncrement;
    private readonly int _iterations;
    private readonly decimal _redIncrement;
    private readonly Color _startColor;

    private decimal _currentAlpha;
    private decimal _currentBlueValue;
    private decimal _currentGreenValue;
    private decimal _currentRedValue;

    private Timer _timer;

    public ControlColorAnimator(TimeSpan duration, Color startColor, Color endColor)
    {
        _startColor = startColor;
        _endColor = endColor;
        resetColor();

        _iterations = duration.Milliseconds / INTERVAL;
        _alphaIncrement = ((decimal) startColor.A - endColor.A) / _iterations;
        _redIncrement = ((decimal) startColor.R - endColor.R) / _iterations;
        _greenIncrement = ((decimal) startColor.G - endColor.G) / _iterations;
        _blueIncrement = ((decimal) startColor.B - endColor.B) / _iterations;
    }

    public Color CurrentColor
    {
        get
        {
            int alpha = Convert.ToInt32(_currentAlpha);
            int red = Convert.ToInt32(_currentRedValue);
            int green = Convert.ToInt32(_currentGreenValue);
            int blue = Convert.ToInt32(_currentBlueValue);

            return Color.FromArgb(alpha, red, green, blue);
        }
    }

    public event EventHandler<DataEventArgs<Color>> ColorChanged;

    public void Go()
    {
        disposeOfTheTimer();
        OnColorChanged(_startColor);

        resetColor();

        int currentIteration = 0;
        _timer = new Timer(delegate
            {
                if (currentIteration++ >= _iterations)
                {
                    Stop();
                    return;
                }
                _currentAlpha -= _alphaIncrement;
                _currentRedValue -= _redIncrement;
                _currentGreenValue -= _greenIncrement;
                _currentBlueValue -= _blueIncrement;
                OnColorChanged(CurrentColor);
            }, null, TimeSpan.FromMilliseconds(INTERVAL), TimeSpan.FromMilliseconds(INTERVAL));
    }

    public void Stop()
    {
        disposeOfTheTimer();
        OnColorChanged(_endColor);
    }

    protected virtual void OnColorChanged(Color color)
    {
        if (ColorChanged == null) return;
        ColorChanged(this, color);
    }

    private void disposeOfTheTimer()
    {
        Timer timer = _timer;
        _timer = null;

        if (timer != null) timer.Dispose();
    }

    private void resetColor()
    {
        _currentAlpha = _startColor.A;
        _currentRedValue = _startColor.R;
        _currentGreenValue = _startColor.G;
        _currentBlueValue = _startColor.B;
    }
} 
```

这使用`DataEventArgs<T>`（如下所示）

```
/// <summary>
/// Generic implementation of <see cref="EventArgs"/> that allows for a data element to be passed.
/// </summary>
/// <typeparam name="T">The type of data to contain.</typeparam>
[DebuggerDisplay("{Data}")]
public class DataEventArgs<T> : EventArgs
{
    private T _data;

    /// <summary>
    /// Constructs a <see cref="DataEventArgs{T}"/>.
    /// </summary>
    /// <param name="data">The data to contain in the <see cref="DataEventArgs{T}"/></param>
    [DebuggerHidden]
    public DataEventArgs(T data)
    {
        _data = data;
    }

    /// <summary>
    /// Gets the data for this <see cref="DataEventArgs{T}"/>.
    /// </summary>
    public virtual T Data
    {
        [DebuggerHidden]
        get { return _data; }
        [DebuggerHidden]
        protected set { _data = value; }
    }

    [DebuggerHidden]
    public static implicit operator DataEventArgs<T>(T data)
    {
        return new DataEventArgs<T>(data);
    }

    [DebuggerHidden]
    public static implicit operator T(DataEventArgs<T> e)
    {
        return e.Data;
    }
} 
```

在您的表单中使用如下：

```
private ControlColorAnimator _animator;

private void runColorLoop()
{
    endCurrentAnimation();
    startNewAnimation();
}

private void endCurrentAnimation()
{
    ControlColorAnimator animator = _animator;
    _animator = null;
    if (animator != null)
    {
        animator.ColorChanged -= _animator_ColorChanged;
        animator.Stop();
    }
}

private void startNewAnimation()
{
    _animator = new ControlColorAnimator(TimeSpan.FromSeconds(.6), Color.Yellow, BackColor);
    _animator.ColorChanged += _animator_ColorChanged;
    _animator.Go();
}

private void _animator_ColorChanged(object sender, DataEventArgs<Color> e)
{
    invokeOnFormThread(delegate { setColor(e); });
}

private void setColor(Color color)
{
    // code to set color of the controls goes here
}

private void invokeOnFormThread(MethodInvoker method)
{
    if (IsHandleCreated)
        Invoke(method);
    else
        method();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T18:15:21.747

只需根据时间在颜色之间进行插值。

如果你的橙色是 (r1,g1,b1) 并且你希望淡化成不同的颜色 (r2,g2,b2)，线性插值的公式是 (r1 + (r2-r1) * t, g1 + (g2) -g1) * t, b1 + (b2-b1) * t)，其中 t 在 [0.0 1.0] 的范围内。

在您的示例中，您的第一种颜色可能类似于 (255,200,0)，而您的第二种颜色可能是 (255,255,255)。

如果您希望获得更平滑的过渡，请查找不同的插值方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T18:12:47.463

当我提交此答案时，您最初并没有指定一种技术，但这是您使用 jQuery 的方法。

[用户界面/效果/突出显示](http://docs.jquery.com/UI/Effects/Highlight)。

```
$("div").click(function () {
      $(this).effect("highlight", {}, 3000);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T18:17:43.190

如果您想快速顺利地完成此操作，请查看 ColorMatrix 类。

# nhibernate - NHibernate 2 + Fluent Nhibernate medium trust

> ID：710903
> 
> 赞同：3
> 
> 时间：2009-04-02T18:06:38.600
> 
> 标签：nhibernate, fluent-nhibernate, medium-trust

Will NHibernate 2 and\or Fluent Nhibernate work in a medium trust environment. If not are there any work-arounds?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T18:14:02.810

Not sure about fluent NH - I assume it should - it just translates to XML.

With NH itself you will loose bytecode optimization, all your setters/constructors will need to be public. If you need to use lazy loading you will have to have your proxies generated with build ([NH proxy generator](http://nhforge.org/wikis/proxygenerators10/default.aspx)).

Should you have some permissions enabled in your medium trust settings you can relax some of the restrictions.

# c - Can I make a GUI using NetBeans but implement functionality using C?

> ID：710904
> 
> 赞同：1
> 
> 时间：2009-04-02T18:06:57.507
> 
> 标签：c, netbeans6.5

I want to use NetBeans to build the GUI for my project, but implement the functionality using C code. Is there any way I can make the C code run when a button in the GUI is clicked?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T19:40:42.010

我相信您可以将标准 JNI 与 netbeans 一起使用。

这是 6.0 版的链接（[http://www.netbeans.org/kb/60/cnd/beginning-jni-linux.html](http://www.netbeans.org/kb/60/cnd/beginning-jni-linux.html)），我希望它仍然适用于 6.5。

一旦你设置了一个带有适当头文件的基本 JNI C 库，它就很容易从 java 端使用。一旦你完成了这么多，甚至可以从 C 代码中抛出 Java 异常 ( [http://www.codeproject.com/KB/debug/jni_ex.aspx](http://www.codeproject.com/KB/debug/jni_ex.aspx) )

但是您应该注意，如果您来回发送大量数据，则 JNI 数据传递的开销可能大于将 C 用于速度关键部分的增益。

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T19:46:19.810

您可以使用新技术 Java Native Access (JNA)。使用 JNA，Java 应用程序可以在没有 JNI 的情况下从 Java 动态访问本机库。JNA 允许您使用自然 Java 方法调用直接调用本机函数。

项目主页在这里：

[https://jna.dev.java.net/](https://jna.dev.java.net/)

维基媒体文章：

[http://en.wikipedia.org/wiki/Java_Native_Access](http://en.wikipedia.org/wiki/Java_Native_Access)

# wpf - 如何为 MyUserControl 添加 DrawingGroup

> ID：710908
> 
> 赞同：1
> 
> 时间：2009-04-02T18:08:32.590
> 
> 标签：wpf, user-controls

我有一个自定义控件

```
public partial class MyUserControl : UserControl { ... } 
```

我接到“空”电话

```
VisualTreeHelper.GetDrawing(this) 
```

如何更改 MyUserControl 以返回非空值？任何超载，还是什么？

这不是一项实际任务，只是一项研究。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T21:19:18.870

尽管文档没有说明这一点，但似乎只返回了实现 OnRender 功能的视觉效果的绘图。我在一个形状上测试了它，也在一个覆盖 OnRender 的窗口上测试了它，并且都返回了绘图。

但是，如果 Window 不覆盖 OnRender，则该方法返回 null。我还在控件加载后拨打了电话，以防您不这样做。

# php - 如何让 PHP 避免延迟评估？

> ID：710919
> 
> 赞同：2
> 
> 时间：2009-04-02T18:09:50.403
> 
> 标签：php, function, lazy-evaluation, boolean-logic

关于 PHP 评估布尔表达式的方式，我有一个有趣的问题。例如，当你有，

```
$expression = $expression1 and $expression2; 
```

或者

```
if ($expression1 and $expression2) 
```

PHP 首先检查`$expression1`计算结果是否为**`true`**. 如果不是这种情况，则`$expression2`简单地跳过，以避免不必要的计算。在我正在编写的脚本中，我有：

```
if ($validator->valid("title") and $validator->valid("text")) 
```

`$validator->valid("text")`即使第一个语句的计算结果为假，我也需要对第二个语句 ( ) 进行评估。我想问你是否有一些简单的方法可以强制 PHP 总是评估这两个语句。谢谢！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-02T18:12:40.753

```
$isValidTitle = $validator->valid("title");
$isValidText = $validator->valid("text");
if($isValidTitle && $isValidText)
{
    ...
} 
```

那会适合吗？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-02T18:13:55.447

这称为[短路评估](http://en.wikipedia.org/wiki/Short-circuit_evaluation)，为避免它，您需要使用单个`&`：

```
if($validator->valid("title") & $validator->valid("text")) {

} 
```

请注意，这不是使用[逻辑运算符](http://www.php.net/language.operators.logical)，而是使用[位运算符](http://www.php.net/manual/en/language.operators.bitwise.php)：

> 它们是作用于数字的二进制表示的运算符。在不先将它们分别转换为数字 1 和 0 的情况下，它们不会将逻辑值（即“真”或“假”）作为参数。它们也不返回逻辑值，而是返回数字。当然，您可以稍后将这些数字视为逻辑值（在这种情况下，0 被强制转换为“false”，其他任何内容都被强制转换为“true”），但这是 PHP 类型转换规则的结果，无需执行任何操作与运营商的行为有关。

因此，对于使用这种副作用来规避短路评估是否是一种好的做法存在*一些争论。*我个人至少会发表评论说 & 是故意的，但如果你想尽可能纯粹，你应该先评估它们是否有效，然后再做 if。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-02T18:15:38.063

尝试分别评估每个术语：

```
$term1 = $validator->valid("title");
$term2 = $validator->valid("text");
if($term1 && $term2) {
//things to do
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-02T18:13:25.947

这可能不是最好的实现，但你总是可以这样做：

```
$a=$validator->valid("title");
$b=$validator->valid("text");
if($a && $b) {...} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-20T10:28:17.347

您可以定义如下函数：

```
function logical_and($x,$y) {return ($x && $y);} 
```

由于 PHP 使用按值调用，因此这是可行的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T19:53:16.207

或者，如果您可以修改类 $validator 实例化，则可以使有效方法接受字符串或数组。如果它是一个数组，它会运行每个项目上已经存在的代码，并且只有在所有项目都“有效”时才返回 TRUE。

# solaris - How do I move/copy a symlink to a different folder as a symlink under Solaris?

> ID：710933
> 
> 赞同：3
> 
> 时间：2009-04-02T18:11:51.613
> 
> 标签：solaris, symlink, cp

It is an odd behaviour seen only on Solaris that when I try to copy a symbolic link with the "`cp -R -P`" command to some other folder with a different name, it copies the entire directory/file it's pointing to.

For example:

```
link -> dir

cp -R -P link folder/new_link 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-11-08T23:46:12.747

我相信“-d”参数是您所需要的。

根据[cp 手册页](http://unixhelp.ed.ac.uk/CGI/man-cgi?cp)：

```
-d     same as --no-dereference --preserve=link 
```

例子：

```
cp -d -R -P link folder/new_link 
```

我正在使用“cp -d”，这对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T18:20:59.050

[cp 手册页](http://docs.oracle.com/cd/E23823_01/html/816-5165/cp-1.html "Solaris 10 手册页第 1 节：用户命令：cp(1)")似乎说您想使用“-H”来保留源目录中的符号链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T18:17:46.250

Try using [cpio](http://docs.oracle.com/cd/E19683-01/816-0210/6m6nb7m6q/index.html "Solaris 9 man pages section 1: User Commands: cpio(1)") (with the -p (pass) option) or the old tar in a pipe trick.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T18:18:17.307

You might consider copying via tar, like tar -cf - srcdir|(cd somedir;tar -xf -)

# sql - 你将如何解决这个棘手的 SQL 问题？

> ID：710941
> 
> 赞同：-1
> 
> 时间：2009-04-02T18:13:29.113
> 
> 标签：sql, mysql, database

假设您有如下表格布局：

**原因**：

```
id (INT), 
courseName (VARCHAR) 
```

**导师：**

```
id (INT),
courseId(INT),
instructor(VARCHAR) 
```

创建一个查询，该查询将打印所有课程，如果有一名教师在场，则显示他们的姓名，如果有两名教师在场，则按排序顺序在行上打印他们的姓名，如果在场的教师超过两名，而不是显示教师姓名“委员会”。

例如，您的输出看起来像这样

```
    courseId 讲师1 讲师2
    0 爱德华·尤登  
    1 爱德华·迪杰斯特拉·尼古拉斯·沃斯
    2 委员会    

```

注意：取自[TheDailyWtf](http://thedailywtf.com/Articles/You-Get-What-You-Ask-For.aspx)上的问卷。不是作业问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T18:20:22.687

是的，是的，业务逻辑等等。这是一个游戏，不是你的老板让你去做的。

在 T-SQL 中：

```
 select
    id
     , courseName
     , case (select count(*) from instructors i where i.courseid=c.courseid)
         when 0 then 'No Instructor'
         when 1 then (select top 1 instructor from instructors where i.courseid=c.courseid)
         when 2 then (select top 1 instructor from instructors where i.courseid=c.courseid order by instructor desc)
         else 'Committee'
         end as instructor_1
     , case (select count(*) from instructors i where i.courseid=c.courseid)
         when 2 then (select top 1 instructor from instructors where i.courseid=c.courseid order by instructor asc)
         else ''
         end as instructor_2
 from courses c 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T18:24:22.177

在 SQL Anywhere 中，您可以这样做：

```
select courseid as cid,
if ( select count(*) from instructor where courseid = cid ) > 2 
   then 'Committee' 
else 
   list(name order by name) 
endif as profs
from instructor
group by courseid
order by cid 
```

请注意，这会选择“教授”作为教授列表（如问题中所述）作为单列。

我对 MySQL 不够熟悉，不知道是否有与该功能等效的`list()`功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T18:36:23.753

我认为这会起作用，但我还没有测试过。如果您决定要开始展示 3 位或 4 位或更多位讲师，则它的可扩展性不是很高。

```
SELECT
    C.id AS course_id,
    CASE
        WHEN I3 IS NOT NULL THEN 'Committee'
        ELSE I1.instructor + COALESCE(', ' + I2.instructor, '')
    END AS instructors
FROM
    Courses C
LEFT OUTER JOIN Instructors I1 ON
    I1.course_id = C.id
LEFT OUTER JOIN Instructors I_CHK1 ON
    I_CHK1.course_id = C.id AND
    I_CHK1.instructor < I1.instructor
LEFT OUTER JOIN Instructors I2 ON
    I2.course_id = C.id AND
    I2.instructor > I1.instructor
LEFT OUTER JOIN Instructors I_CHK2 ON
    I_CHK2.course_id = C.id AND
    I_CHK2.instructor > I1.instructor AND
    I_CHK2.instructor < I2.instructor
LEFT OUTER JOIN Instructors I_CHK2 ON
    I3.course_id = C.id AND
    I3.instructor > I2.instructor AND
WHERE
    I_CHK1.id IS NULL AND
    I_CHK2.id IS NULL 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T18:21:16.677

您正在寻找的是“数据透视表”或“交叉表”报告。它们可以使用普通 SQL 获得：

> [http://en.wikibooks.org/wiki/MySQL/Pivot_table](http://en.wikibooks.org/wiki/MySQL/Pivot_table)

这里可能还有其他关于 SO 的问题以及更多信息。查看此处的信息，其中显示了您可以如何在 SQL 或应用程序逻辑中执行此操作（通过连续查询）：

> [https://stackoverflow.com/search?q=pivot+table](https://stackoverflow.com/search?q=pivot+table)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T18:28:03.260

不是世界上最好的查询，但总之它很丑，我有点喜欢。具体来说，我喜欢这样一个事实，即您不必处理多个案例陈述，如果您有许多必须将案例应用于的领域，这可能会很痛苦：

```
--- Single instructor case.
select
    c.id as courseId, i.instructor as instructor1, null as instructor2
from
    courses as c inner join instructors as i on i.courseId = c.id
where
    (
        select 
            count(instructor) 
        from 
            instructors as i2 
        where 
            i2.courseId = c.id
    ) = 1
union
--- Committee case.
select
    c.id as courseId, "committee" as instructor1, null as instructor2
from
    courses as c inner join instructors as i on i.courseId = c.id
where
    (
        select 
            count(instructor) 
        from 
            instructors as i2 
        where 
            i2.courseId = c.id
    ) > 2
union
--- Two instructor case.
select
    c.id as courseId, i1.instructor as instructor1, 
    i2.instructor as instructor2
from
    courses as c, instructor as i1, instructor as i2
where
    --- Course ids must match.
    c.id = i1.courseId and c.id = i2.courseId and

    --- Instructor ids do not match.
    i1.id <> i2.id and

    --- There are only two instructors.
    (
        select 
            count(instructor) 
        from 
            instructors as i2 
        where 
            i2.courseId = c.id
    ) > 2 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T19:33:34.757

还有另一种选择。笔记：

1-我不相信到目前为止提出的任何解决方案都可以在 SQL 方言之间移植。如果允许第 4 列计数（*），我相信以下解决方案可能非常便携，因为它主要使用“标准 SQL”。但是我只在 SQLite3 上测试过。

2-我故意通过复制 couses 表的错字来遵守您的规范。[我想它的目的是作为课程而不是课程]

```
select 
  c.id, c.courseName, i.instructor as instructor1, null as instructor2 
from 
  couses c, instructors i 
where 
  c.id = i.courseId 
group by 
  courseId having count(*) = 1
union
select /* Case 2: Two instructors */
  c.id, c.courseName, i1.instructor as instructor1, i2.instructor as instructor2 
from 
  couses c, instructors i1, instructors i2 
where 
  c.id = i1.courseId and c.id = i2.courseId and i1.id != i2.id and i1.id < i2.id 
group by 
  c.id having count(*) = 1
union
select /* Case 3: Three or more instructors */
  c.id, c.courseName, "Commitee" as instructor1, null as instructor2 
from 
  couses c, instructors i1, instructors i2, instructors i3 
where 
  c.id = i1.courseId and c.id = i2.courseId and c.id = i3.courseId and 
  i1.id != i2.id and i1.id != i3.id and i2.id != i3.id and i1.id < i2.id 
  and i2.id < i3.id 
```

# jsp - How do you get glassfish to show debug information for JSPs?

> ID：710943
> 
> 赞同：-1
> 
> 时间：2009-04-02T18:13:41.827
> 
> 标签：jsp, tomcat, jakarta-ee, glassfish

I'm switching from Tomcat to Glassfish for an app server. Glassfish is so much more complicated its a little overwhelming. Anyway now I'm getting an exception:

java.lang.NullPointerException at org.apache.jsp.jsps.login_jsp._jspService(login_jsp.java from :67)

Where tomcat shows you the line number and gives me some information on the stderr or stdout, this just shows the error in the compliled jsp file, which is pretty much useless to me. How can I get it to show more information - at least the line in the JSP throwing the exception?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T08:14:01.557

登录管理控制台并转到配置 -> 您的配置 -> 记录器设置 -> 日志级别。将您的日志级别设置为最好或其他。

问候

# javascript - 我如何从该脚本中获取脚本文件名？

> ID：710957
> 
> 赞同：55
> 
> 时间：2009-04-02T18:16:58.293
> 
> 标签：javascript, html

我很确定答案是否定的，但我想我还是会问。

如果我的网站引用了一个名为“whatever.js”的脚本，是否可以从该脚本中获取“whatever.js”？像：

```
var scriptName = ???

if (typeof jQuery !== "function") {
    throw new Error(
        "jQuery's script needs to be loaded before " + 
        scriptName + ". Check the <script> tag order.");
} 
```

可能比依赖检查更麻烦，但到底是什么。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-02T18:25:11.253

```
var scripts = document.getElementsByTagName('script');
var lastScript = scripts[scripts.length-1];
var scriptName = lastScript.src;
alert("loading: " + scriptName); 
```

测试于：FF 3.0.8、Chrome 1.0.154.53、IE6

* * *

### 另请参阅：[如何引用加载当前执行脚本的脚本标记？](https://stackoverflow.com/questions/403967/how-may-i-reference-the-script-tag-that-loaded-the-currently-executing-script)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-11-06T08:44:45.147

我知道这很旧，但我开发了一个更好的解决方案，因为以上所有内容都不适用于异步脚本。通过一些调整，以下脚本可以涵盖几乎所有用例。这对我有用：

```
function getScriptName() {
    var error = new Error()
      , source
      , lastStackFrameRegex = new RegExp(/.+\/(.*?):\d+(:\d+)*$/)
      , currentStackFrameRegex = new RegExp(/getScriptName \(.+\/(.*):\d+:\d+\)/);

    if((source = lastStackFrameRegex.exec(error.stack.trim())) && source[1] != "")
        return source[1];
    else if((source = currentStackFrameRegex.exec(error.stack.trim())))
        return source[1];
    else if(error.fileName != undefined)
        return error.fileName;
} 
```

不确定是否支持 Internet Explorer，但在我测试过的所有其他浏览器中都可以正常工作。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-05-18T16:31:49.257

您可以使用...

```
var scripts = document.getElementsByTagName("script"),
  currentScriptUrl = (document.currentScript || scripts[scripts.length - 1]).src; 
```

[`currentScript()`](https://developer.mozilla.org/en/DOM/document.currentScript)除 IE 外，所有浏览器都支持。

确保它在文件被解析和执行时运行，而不是在 DOM 准备好或`window`加载时运行。

如果它是一个空字符串，则您的`script`块没有或空`src`属性。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-04-24T11:16:06.153

在 Node.js 中：

```
var abc = __filename.split(__dirname+"/").pop(); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-09-08T22:39:29.910

Shog9 的建议更短：

```
alert("loading: " + document.scripts[document.scripts.length-1].src); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-02T18:27:28.910

您可以返回页面中的脚本元素列表：

```
var scripts = document.getElementsByTagName("script"); 
```

然后评估每一个并检索其位置：

```
var location;

for(var i=0; i<scripts.length;++i) {
   location = scripts[i].src;

   //Do stuff with the script location here
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-10-30T12:23:02.923

由于“src”属性包含脚本文件的完整路径，您可以添加子字符串调用来仅获取文件名。

```
var path = document.scripts[document.scripts.length-1].src;

var fileName = path.substring(path.lastIndexOf('/')+1); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-11-28T15:42:10.503

当调用代码包含在 .html 文件中时，我在提取脚本名称时遇到了上述代码的问题。因此我开发了这个解决方案：

```
var scripts = document.getElementsByTagName( "script" ) ;
var currentScriptUrl = ( document.currentScript || scripts[scripts.length - 1] ).src ;
var scriptName = currentScriptUrl.length > 0 ? currentScriptUrl : scripts[scripts.length-1].baseURI.split( "/" ).pop() ; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-11-08T16:33:46.420

您可以尝试将其放在 JavaScript 文件的顶部：

```
window.myJSFilename = "";
window.onerror = function(message, url, line) {
    if (window.myJSFilename != "") return;
    window.myJSFilename =  url;
}
throw 1; 
```

确保您只有以下功能。myJSFilename 变量将包含 JavaScript 文件的完整路径，可以从中解析文件名。在 IE11 中测试，但它应该可以在其他地方工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-04-06T06:57:17.133

如果您不想使用 jQuery：

```
function getCurrentFile() {
    var filename = document.location.href;
    var tail = (filename.indexOf(".", (filename.indexOf(".org") + 1)) == -1) ? filename.length : filename.lastIndexOf(".");
    return (filename.lastIndexOf("/") >= (filename.length - 1)) ? (filename.substring(filename.substring(0, filename.length - 2).lastIndexOf("/") + 1, filename.lastIndexOf("/"))).toLowerCase() : (filename.substring(filename.lastIndexOf("/") + 1, tail)).toLowerCase();
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-03T10:38:27.170

如果没有 jQuery 脚本会发生什么？你只是要输出一条消息吗？我想如果出现问题，调试会稍微好一些，但对用户来说并不是很有帮助。

我想说只是设计你的页面，这样就不会发生这种情况，并且在极少数情况下，让脚本失败。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-12-22T16:03:08.447

防水的唯一方法：

```
var code = this.__proto__.constructor.toString();
$("script").each(function (index, element) {
    var src = $(element).attr("src");
    if (src !== undefined) {
        $.get(src, function (data) {
            if (data.trim() === code) {
                scriptdir = src.substring(0, src.lastIndexOf("/"));
            }
        });
    }
}); 
```

“var code”也可以是函数名，但是使用原型构造函数你不必修改任何东西。此代码将其自己的内容与所有当前脚本进行比较。不再需要硬编码的文件名。 [Korporal Nobbs](https://stackoverflow.com/users/2703106/korporal-nobbs)的方向是正确的，但比较不完整。

# mysql - 2 db之间的MySQL同步

> ID：710961
> 
> 赞同：0
> 
> 时间：2009-04-02T18:17:20.913
> 
> 标签：mysql, linux, mysqldump

我目前正在寻找一种快速同步生产数据库和开发数据库的方法。

我正在考虑这样做：

```
mysqladmin -u <user> -p<password> <dev-db_name> | mysqldump -u <user> -p<password> --databases <production-db-name> --add-drop-table 
```

但似乎它只是在屏幕上打印了所有的drump，而不是通过管道将它传递给mysqladmin util。有什么建议可以改进吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T18:21:52.713

现在，您正在将输出管道输入`mysqladmin`到`mysqldump`.

翻转它们，而不是`mysqladmin`使用常规`mysql`，命令看起来像这样：

```
mysqldump ... | mysql ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T18:23:52.757

您还可以查看主/从复制范例...如果您只需要从 dev-db 中读取，这是完美的...

# c# - 如何将 RSS 显示为弹出窗口？

> ID：710966
> 
> 赞同：1
> 
> 时间：2009-04-02T18:18:13.080
> 
> 标签：c#, asp.net, popup, rss

在我的网站上，用户可以对文档发表评论。现在我想在发表评论时向网站管理员发送 RSS 提要。我希望通过页面右上角的一个小弹出窗口通知网站管理员。所以这就是正在发生的事情：

1.  用户添加评论
2.  系统检查网站管理员是否登录
3.  如果网站管理员已登录；在右上角显示带有评论标题的弹出窗口。

如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T18:25:16.183

1.  如果用户是网站管理员，则设置一个 javascript 计时器以定期（每 5 秒一次？）调用网络服务。此 Web 服务可以确定自上次检查后是否添加了新评论。如果没有新评论，则 Web 服务不返回任何内容，如果有新评论，则 Web 服务不会返回有关该评论的一些信息。
2.  如果 web 服务返回评论，则将该信息放入您在页面上创建的 div 标记中并使其可见。如果您确定网站管理员使用的是现代浏览器，您可以使用[position:fixed](http://www.w3schools.com/Css/pr_class_position.asp)将此 div 标签放在右上角。如果没有，您将不得不使用一些 javascript 来完成此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T18:31:23.003

除非您使用彗星式服务将通知推送到网站管理员的浏览器，否则您将需要创建一个页面，以预定义的时间间隔轮询新通知。然后，您可以对服务进行 AJAX 调用，并将响应解析到只有网站管理员可以访问的网页上。

如果您对 comet（可以将数据推送到连接的客户端的服务）感兴趣，可以从[Wikipedia](http://en.wikipedia.org/wiki/Comet_(programming))开始：

[彗星（编程）](http://en.wikipedia.org/wiki/Comet_(programming))

# asp.net - 会话对象的 ASP.NET 混合 Windows/窗体身份验证问题

> ID：710972
> 
> 赞同：1
> 
> 时间：2009-04-02T18:19:25.013
> 
> 标签：asp.net, expired-sessions, mixed-authentication

这里有一个奇怪的问题，我们正在运行一些混合环境的 Web 应用程序，这些应用程序使用 Windows 或 Forms 身份验证，具体取决于用户来自哪里。

我很好奇其他人如何处理过期的会话，以避免有人将空闲会话打开太久然后尝试恢复工作，主要是寻找有关该主题的最佳实践。

任何建议或意见将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T18:45:45.543

我不确定您的身份验证方法如何影响会话超时，他们用来进入的机制不应该影响他们可以停留多长时间。

一般来说，如果某人确实有一个过期的会话，您可以添加代码来检查他们的会话是否处于活动状态。如果不是，只需将它们重定向到登录页面，或显示一些其他友好文本。

基本上是这样的：

```
if (Session.IsNewSession) 
   Response.Redirect("login.aspx"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T19:02:29.650

*   不要在会话中存储不必要的信息。
*   如果您要存储可以重新加载的内容，请使用适当的代码在会话中找不到它时重新加载它
*   考虑是否某些流程需要长时间处理，在这种情况下将中间信息保存到数据库中。
*   如果用户正在执行使用会话的过程，并且数据丢失，请将他们带到第 1 步（如果您在其他地方没有信息，您无能为力）。

# asp.net - Hard file on the server or binary for sound and image files in SQL with ASP.Net application

> ID：710976
> 
> 赞同：1
> 
> 时间：2009-04-02T18:20:52.403
> 
> 标签：asp.net, sql, optimization, file

I am building an ASP.Net C# web application that will be using lots of sound files and image files. Considering performance, would it be best to store all files in SQL as image data type and retrieve from the database or store/archive the hard file on the server and store the path in sql? Im curious about the pros and cons - other than the obvious of storage space and manageability.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T18:42:35.613

我当前的客户目前正在寻找相同的选项。有一些权衡需要考虑：

存储为 IMAGE 数据类型：

*   你只需要备份你的数据库而不是数据库和文件系统上的地方
*   您不必担心在没有使用新位置更新数据库的情况下移动文件或与挂起指向不存在文件的指针有关的任何其他问题

在数据库中存储为带有路径的文件：

*   访问速度稍快（我们将在接下来的几天内对此进行量化）

本来我以为客户端缓存图片也会有问题。例如，当 .NET 从数据库中获取图像时，客户端浏览器无法缓存它——每次它看起来都像是一张新图像。然后我了解到，除非您授予用户文件级访问权限（安全禁止），否则使用直接文件访问会遇到同样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T18:27:45.663

从性能的角度来看，您最好将声音/图像存储为文件并仅保留对数据库中位置的引用。这将使您不必将数据从数据库传输到 Web 服务器，并在引用时通过处理程序重构“文件”。当然，缓存可以对此有所帮助，但您仍然会为每次缓存未命中付出代价。就我的钱而言，这个解决方案在需要开发的代码方面也稍微不那么复杂，尽管您确实遇到了冲突问题，并且如果您启用上传，则需要进行一些额外的安全设置（可能）。

# c# - 为什么在混合显式实现和多态时在 C# 中出现错误？

> ID：710989
> 
> 赞同：0
> 
> 时间：2009-04-02T18:23:47.700
> 
> 标签：c#, .net, design-patterns

我收到此错误：

> 类型 Bar 没有实现接口 IFoo

从这段代码：

```
public interface IFoo
{
   void DoA();

   void DoB();
}

public class Foo:IFoo
{

    void IFoo.DoA()
    {

    }

    void IFoo.DoB()
    {

   }
}

public class Bar:Foo
{

     void IFoo.DoA()
      {
          base.doA();

      }

      void IFoo.DoB()
      {
          base.doB();

      }
  } 
```

我正在使用 C# 2.0。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T18:27:10.470

```
public class Bar : Foo, IFoo
{ 
    // Your code
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T18:39:30.410

请参阅[n8wrl 的回答](https://stackoverflow.com/questions/710989/why-am-i-getting-an-error-in-c-when-mixing-explicit-implementation-and-polymorph/711082#711082)，了解您*应该*如何执行此操作。原因见下文。

`void IFoo.DoA()`隐式实现接口时，您不能显式实现接口成员 ( )。换句话说，因为 Bar 仅`IFoo`通过扩展来实现`Foo`，所以不能使用显式实现。

这将起作用：

```
public class Bar : Foo
{
    public void DoA()
    {
        ...
    }

    public void DoB()
    {
        ...
    } 
```

或这个：

```
public class Bar : Foo, IFoo
{
    void IFoo.DoA()
    {
        ...
    }

    void IFoo.DoB()
    {
        ...
    } 
```

您可能会面临的一个更大的问题是，由于`Foo`它不是抽象的，它必须实现`DoA`and `DoB`。如果您*还在*bar 中实现这些方法，您将不会多态地执行它。如果代码具有类型的句柄，您将[隐藏](http://www.akadia.com/services/dotnet_polymorphism.html)实现。`Foo``Bar`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T18:45:57.180

我也遇到过这个。什么是“更糟糕”，取决于你如何看待它，你不能将接口实现定义为虚拟的，以便在后代类中被覆盖。我已经养成这样做的习惯：

```
public class Foo:IFoo
{    
     void IFoo.DoA()
     {
          DoACore();
     }
     void IFoo.DoB()
     {
          DoBCore();
     }
     protected virtual void DoACore()
     {
     }
     protected virtual void DoBCore()
     {
     }
}
public class Bar:Foo
{     protected override void DoACore()
      {
          base.DoACore();
      }
      protected override void DoBCore()
      {
          base.DoBCore();
      }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T18:55:35.550

我怀疑接口是如何在 C++ 中实现的，作为抽象类和多重继承，会产生混淆。

在 .NET 中，接口只是一个合同，表明您将实现这些方法。

您的代码无法编译，原因与此代码无法编译的原因相同（使用 C++ 编译）：

```
public interface IFoo
{
    void DoSomething();
}

public abstract class Foo : IFoo
{
} 
```

Foo 声明 Foo 实现了 IFoo，它没有说明任何其他人。

如果你想强制派生类实现它，你会这样做：

```
public interface IFoo
{
    void DoSomething();
}

public abstract class Foo : IFoo
{
    public abstract void DoSomething();
} 
```

或者，如果您真的希望通过显式实现隐藏接口方法，那么上面发布的 n8wrl 之类的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T20:31:50.903

起初，不清楚这是什么任务？如果目标是尽快解决问题，那么“Bar : Foo, IFoo”是最短的解决方案。

如果您只是想了解“隐式/显式”接口的区别，请查看这篇[文章](https://stackoverflow.com/questions/598714/implicit-vs-explicit-interface-implementation)。

另请注意，“n8wrl”解决方案是有争议的。仅当 Foo 确实需要显式实现 IFoo 时才可以。如果没有，比有一个更简单的方法：

```
public interface IFoo
{
    void DoA();
}

public class Foo : IFoo
{
    public virtual void DoA() {}
}

public class Bar : Foo
{
    public override void DoA() {}
} 
```

希望这可以帮助。

# delphi - 如何使用 Delphi 7 将文本文件从 ANSI 转换为 UTF-8？

> ID：710992
> 
> 赞同：10
> 
> 时间：2009-04-02T18:23:59.807
> 
> 标签：delphi, utf-8, character-encoding, delphi-7, ansi

我用 Delphi 7 编写了一个程序，它`*.srt`在硬盘驱动器上搜索文件。该程序在备忘录中列出了这些文件的路径和名称。现在我需要将这些文件从 ANSI 转换为 UTF-8，但我没有成功。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-07-04T05:15:43.647

Utf8Encode 函数将 WideString 字符串作为参数并返回 Utf-8 字符串。

样本：

```
procedure ConvertANSIFileToUTF8File(AInputFileName, AOutputFileName: TFileName);
var
  Strings: TStrings;
begin
  Strings := TStringList.Create;
  try
    Strings.LoadFromFile(AInputFileName);
    Strings.Text := UTF8Encode(Strings.Text);
    Strings.SaveToFile(AOutputFileName);
  finally
    Strings.Free;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-06T15:41:05.670

看一下[GpTextStream](http://17slon.com/gp/gp/gptextstream.htm)，它看起来可以与 Delphi 7 一起使用。它能够在旧版本的 Delphi 中读取/写入 unicode 文件（尽管可以与 Delphi 2009 一起使用）并且应该有助于您的转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-31T14:54:14.853

## 在开始编码之前，请阅读整个答案。

* * *

**问题的正确答案**-*这并不容易*- 基本上包括树步骤：

1.  您必须确定计算机上使用的 ANSI 代码页。您可以通过使用 Windows API 中的 GetACP() 函数来实现此目标。（**重要：**您必须在文件名检索后尽快检索代码页，因为它可以由用户更改。）
2.  您必须使用正确的 CodePage 参数（在上一步中检索）调用 MultiByteToWideChar() Windows API 函数，将 ANSI 字符串转换为 Unicode。在这一步之后，您将获得一个包含文件名列表的 UTF-16 字符串（实际上是一个 WideString）。
3.  您必须使用 UTF8Encode() 或 WideCharToMultiByte() Windows API 将 Unicode 字符串转换为 UTF-8。此函数将返回您需要的 UTF-8 字符串。

但是，此解决方案将返回一个包含输入 ANSI 字符串的 UTF-8 字符串，这可能不是解决问题的最佳方法，因为当 ANSI 函数返回文件名时，文件名可能已经损坏，因此**不能保证正确的文件名**.

* * *

**正确解决您的问题**方法更复杂：

如果您想**确保**您的文件名列表完全干净，您必须确保它根本不会*转换为 ANSI*。您可以通过显式使用文件处理 API 的“W”版本来做到这一点。在这种情况下——当然——你不能使用 TFileStream 和其他 ANSI 文件处理对象，而是直接调用 Windows API。

不是*这样*难，但是如果您已经有一个基于例如 TFileStream 构建的复杂框架，那么在@ss 中可能会有点痛苦。在这种情况下，最好的解决方案是创建一个使用适当 API 的 TStream 后代。

我希望我的回答对您或任何必须处理相同问题的人有所帮助。（不久前我不得不这样做。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-03T19:25:53.547

```
var
  Latin1Encoding: TEncoding;
begin
  Latin1Encoding := TEncoding.GetEncoding(28591);
  try
       MyTStringList.SaveToFile('some file.txt', Latin1Encoding);
  finally
      Latin1Encoding.Free;
  end;
end; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-25T20:35:30.480

我只做了这个：

```
procedure TForm1.FormCreate(Sender: TObject);
begin
  Strings := TStringList.Create;
end;  

procedure TForm1.Button3Click(Sender: TObject);
begin
   Strings.Text := UTF8Encode(Memo1.Text);
   Strings.SaveToFile('new.txt');
end; 
```

使用无 BOM 的 Notepad++ UTF8 验证

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-02T18:40:06.350

你是说ASCII吗？

ASCII 向后兼容 UTF-8。 [http://en.wikipedia.org/wiki/UTF-8](http://en.wikipedia.org/wiki/UTF-8)

# emacs - 为什么这个 Emacs Lisp 片段会破坏 list-colors-display？

> ID：710995
> 
> 赞同：1
> 
> 时间：2009-04-02T18:24:50.240
> 
> 标签：emacs, elisp

我喜欢 Emacs 使用尾随空白面突出显示制表符，我将其设置为背景颜色的稍微灰色的版本。这样，我认为不需要的所有空格（制表符和尾随空格）都将具有略带灰色的背景。

这是我使用的代码：

```
(add-hook 'font-lock-mode-hook
  '(lambda ()
     (font-lock-add-keywords
       nil
        '(("\t" 0 'trailing-whitespace prepend))
     )
   )
) 
```

但是，它似乎破坏了 list-colors-display：这个函数仍然列出所有颜色，但它们是单色的。我没有得到它应该提供的令人眼花缭乱的光谱。

为什么会这样？可以修复吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T19:54:20.620

不确定为什么会出错。wiki 上有一种模式可以显示标签（[show-wspace.el](http://www.emacswiki.org/emacs/show-wspace.el)），效果很好。

```
(require 'show-wspace)
(show-ws-toggle-show-tabs) ; default is no tabs shown, turn it on
;; the face used is 'show-ws-tab, which you can customize at will 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T19:12:33.123

您可以包装您的函数，这样它就不会在以 * 开头/结尾的缓冲区中执行空格操作。无论如何，您可能不希望在这些类型的缓冲区中使用它：

```
(add-hook ...
  (unless (string-match "\\*.+\\*" (buffer-name))
    (font-lock-add-keywords ...))) 
```

# objective-c - 将对象编码/解码为字典的最优雅方法是什么

> ID：710999
> 
> 赞同：2
> 
> 时间：2009-04-02T18:26:10.597
> 
> 标签：objective-c, cocoa

有问题的对象由键/值对（又名@property）组成。有没有一种优雅的方法可以将此对象编码/解码为字典？手动提取每个属性并手动创建字典似乎是蛮力的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T18:33:15.493

Objective-C 的“对象作为字典”支持来自[键值编码](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Protocols/NSKeyValueCoding_Protocol/Reference/Reference.html)：

```
NSArray *myAttributes; // Assume this exists
NSDictionary *dictRepresentation = [object dictionaryWithValuesForKeys:myAttributes]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T20:11:41.483

它绝对需要是一本字典吗？因为`NSKeyedArchiver`给你的 memento-stored-by-key 行为实际上是`NSDictionary`- 并且具有额外的好处，它可以归档许多属性列表序列化不自动支持的对象。在 CocoaDev wiki 上有一个关于[使用归档器和取消归档器](http://www.cocoadev.com/index.pl?UsingArchiversAndUnarchivers)的很好的描述。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T00:30:42.950

如果您想要的键是相关类的 ObjC-2.0 属性，您可以执行类似于以下的操作：

```
// Assume MyClass exists
unsigned int count = 0;
objc_property_t *properties = class_copyPropertyList([myClassInstance class], &count);
NSMutableDictionary *propertiesDict = [NSMutableDictionary dictionary];
unsigned int i;
for(i = 0; i < count; ++i) {
  NSString *propertyName = [NSString stringWithCString:property_getName(properties[i]) encoding:NSASCIIStringEncoding];
  id propertyValue = [self valueForKey:propertyName];
  if(propertyValue)
    [propertiesDict setObject:propertyValue forKey:propertyName];
}
free(properties), properties = NULL;
// Do something with propertiesDict 
```

这也可以是一个简单的类扩展。*****************``*****