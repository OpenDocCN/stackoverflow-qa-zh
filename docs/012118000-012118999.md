# StackOverflow 问答 12118000-12118999

# c# - M 中有多少逻辑，在 MVC 中？

> ID：12118004
> 
> 赞同：4
> 
> 时间：2012-08-24T23:46:53.027
> 
> 标签：c#, asp.net-mvc

我有一个服务层，将方法暴露给我的 MVC '层'。可以说我有一个方法：

```
Public List<StateObjects> GetStates() 
```

然后从我的模型对象的构造函数调用该方法来为我的视图构建一个状态选择列表是好还是坏的设计？模型是否应该引用我的服务层，并且还允许我的控制器引用我的服务层？还是应该在控制器中完成模型变量的填充，所以所有逻辑都在控制器中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T00:07:30.130

根据应用程序的大小和范围，这可能不是一个明确的答案，但是当与服务层结合使用时，我倾向于使 MVC 的“M”更像是一个视图模型。

与 MVVM 类似，模型成为一个平面对象，仅包含将显示给视图的属性。控制器访问服务层，然后使用[AutoMapper](http://automapper.codeplex.com/)将域对象的属性映射到模型。

你最终得到的是瘦控制器和瘦模型，大部分逻辑都留在你的服务层。模型真正具有任何逻辑的唯一时间是将列表（例如您的 StateObject 列表）映射到 SelectList，或其他与视图相关的函数/计算。如果您正在进行任何类型的异步 JavaScript 开发，它还允许您轻松地将模型映射到 JSON 对象，因为模型相对扁平。

让您的模型直接引用您的服务层意味着如果您尝试使用某种类型的依赖注入，则必须将所有服务传递给构造函数，这会使模型的实例化变得非常痛苦。

我不知道这是否打破了 MVC 范式，但它在我过去做过的项目中运行良好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T00:14:16.340

答案是：

**这取决于您的应用程序和编码风格。**

很多人练习精益模型和肥控制器，但是来自沉重的面向对象背景，拥有肥模型和精控制器感觉更自然。这是我的想法：

模型应该了解自己。这意味着依赖于模型的函数属于模型。

模型应该与其他模型无关。控制器应该处理模型到模型的交互（以及不单独涉及实例的其他交互）。

这样你就可以拥有优雅`instance.function()`和`controller.staticLikeFunction()`.

IMO 这是在你有一个面向对象的应用程序的情况下最漂亮的方法。

如果您的应用程序不需要面向对象的设计，那就没有意义了。在这种情况下，将所有内容都放入控制器并保留您的模型纯数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T04:26:59.423

最好使用视图模型作为模型，并保持精简。它应该只有足够的信息来与视图和控制器通信，仅此而已。

控制器所需的其他逻辑可以包含在类中，并由控制器实例化。这使您的逻辑保持松散耦合，因此更易于维护。你会帮自己一个忙。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T00:30:23.487

正如您所指出的，有两个真正的选择：

*   使用从业务/域层返回的数据在控制器中填充模型
*   通过其构造函数、属性或方法在模型中填充模型数据。

还有第三种选择，即在您的域层中拥有 MVC 的 MC 部分。这使得模型填充变得更容易，但确实有点模糊了业务层所做的界限（如果您是纯粹主义者）。实际上，在您建立一个巨大的企业模型之前，这并不重要。

我特别喜欢有一个静态的

`public static MyModel FromDomainObject(DomainObject object)`

模型上的方法。然后，您可以在控制器中使用它并在操作中传递域对象以获取模型，然后将其传递给您的视图。

重要的部分是确保模型中的属性不会按需填充，并且视图无法访问方法。实际上，您或团队将调用这些方法/属性并知道其含义，但这有助于保持关注点的分离并减少耦合。

# java - 损坏的 Eclipse 项目 - classNotFoundException - 找不到主类

> ID：12118008
> 
> 赞同：5
> 
> 时间：2012-08-24T23:47:03.300
> 
> 标签：java, eclipse, noclassdeffounderror, classnotfoundexception

我有一个项目，我一直在 Ubuntu 12.04 上的 Eclipse 3.7.2 中开发。最近，我重组了涉及在包之间移动类的类层次结构。我没有移动包含我的`public static void main(String[] args)`方法的主类（“ob3.converter.Converter”）。

现在，当我尝试运行它时，我得到：

```
Exception in thread "main" java.lang.NoClassDefFoundError: ob3/converter/Converter
Caused by: java.lang.ClassNotFoundException: ob3.converter.Converter
    at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
Could not find the main class: ob3.converter.Converter. Program will exit. 
```

我只真正使用过 Eclipse（在 java 中），它为我处理了所有的开销——因此我对这个错误或可能导致它的原因知之甚少。我已经查看了我的运行配置/类路径等，但不知道要寻找什么，但毫无结果。

有人能指出我正确的方向吗？我用谷歌搜索/搜索了 SO，大多数事情都在谈论清单文件，但我无法在任何地方找到它。我的工作区文件夹只包含我的源文件。

我可以验证：

*   “转换器”类存在于包“ob3.converter”中。
*   “转换器”类包含一个`public static void main(String[] args)`方法。
*   Project Properties 中 Java Build Path 页面上的“Source”选项卡显示“converter/lib”和“converter/src”——这两个文件夹包含我的整个项目源代码。
*   运行配置/JRE 中使用的 JRE 是“java-6-openjdk-amd64”。
*   运行配置中的 ClassPath 选项卡如下所示：
    *   Boostrap 条目：
        *   JRE 系统库 [java-6-openjdk-amd64]
    *   用户条目：
        *   转换器（默认类路径）
            *   转换器
*   自从我上次成功运行以来，Converter.java 的路径没有改变。

很感谢任何形式的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T19:36:14.993

我认为你应该重建你的项目。您可以通过单击 Projects > Clean... 来执行此操作

有时 Eclipse 的自动构建在重构或移动类时会出现问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-16T18:41:43.323

我遇到了同样的错误消息。对我来说，我在 linux 上，发出 java 命令的用户对类路径上的 jar 目录没有足够的权限。

# c# - DateTimeOffset localTime = DateTimeOffset.Now;

> ID：12118010
> 
> 赞同：0
> 
> 时间：2012-08-24T23:47:31.943
> 
> 标签：c#

上面的代码返回应用程序运行的本地时间和偏移数据。对于同一时间点，上述代码的结果将根据执行代码的位置而有所不同。这是对的吗？

它是如何获得当地时间的？它使用系统时间还是使用服务器的地理位置？史密斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:50:37.287

它从正在运行的机器的时间设置开始工作。如果您将机器带到国外并且不更新时间（或将其设置为自动），或者只是将其弄错了，那么结果将是错误的。

出错可能也一样好，因为你的错误与机器上的所有其他应用程序一样。在非常本地化的环境中，这使您正确；）

# python - 监控远程FTP目录

> ID：12118011
> 
> 赞同：6
> 
> 时间：2012-08-24T23:47:40.180
> 
> 标签：python, ftp

我只能通过 FTP 访问远程服务器上的目录，并且希望在新文件出现在目录中时立即获取它们的内容。

有没有像 FAM for Python 这样的东西可以让我通过 FTP 监控新文件？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-25T08:46:16.913

如果轮询服务器是一个选项：

```
from ftplib import FTP
from time import sleep

ftp = FTP('localhost')
ftp.login()

def changemon(dir='./'):
    ls_prev = set()

    while True:
        ls = set(ftp.nlst(dir))

        add, rem = ls-ls_prev, ls_prev-ls
        if add or rem: yield add, rem

        ls_prev = ls
        sleep(5)

for add, rem in changemon():
    print('\n'.join('+ %s' % i for i in add))
    print('\n'.join('- %s' % i for i in remove))

ftp.quit() 
```

# joomla2.5 - Joomla 2.5 工具提示不分隔标题::文本

> ID：12118012
> 
> 赞同：0
> 
> 时间：2012-08-24T23:47:49.970
> 
> 标签：joomla2.5, tooltip

我正在开发一个小模块，当我将图像悬停时，我想显示一个工具提示。

tooltip 部分工作正常，但似乎在 title::text 分离中存在错误，因为所有内容都按如下方式放入 tip-title div 中。

```
<div class="tip">
  <div class="tip-title">Title::Text</div>
  <div class="tip-text"></div>
</div> 
```

我的工具提示垃圾邮件看起来像这样

```
<span title="Title::Text" class="tooltip-class">
  <img src="<?php echo $row->thumbnail; ?>" title="<?php echo $row->title?>" />
</span> 
```

有没有人遇到过同样的问题？

只是为了记录，工具提示正在工作，所以它在悬停图像时出现，但所有工具提示内容都放在工具提示标题div中，所以没有“::”分隔。

谢谢指教！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T02:17:31.047

好吧，我错误配置了 JHTML::_('behavior.tooltip'); 我需要如下设置

```
$toolTipArray = array(
    'className'     => 'tooltipsClass',
    'offsets'       => array('x'=>-23, 'y'=>-14),
    'fixed'         => true,
    'windowPadding' => array('x'=>-500, 'y'=>-500)
);

JHTML::_('behavior.tooltip', '.tooltip_data_class' . $params->get( 'moduleclass_sfx' ), $toolTipArray); 
```

此致！

# c++ - 我可以 lint 使用 boost 的 ptr_vector.hpp 的文件吗？

> ID：12118014
> 
> 赞同：0
> 
> 时间：2012-08-24T23:48:26.017
> 
> 标签：c++, windows, eclipse, embedded, lint

我刚刚开始在我的嵌入式环境中使用 boost。我更改了一个向量以使用 ptr_vector 并且代码编译和测试都很好。我用了：

```
#include <boost/ptr_container/ptr_vector.hpp> 
```

然后我去 lint 文件（使用 Gimpel 的 PC Lint），我得到一个奇怪的错误：

```
#... mpl/aux_/preprocessed/plain/.hpp)
#   include BOOST_PP_STRINGIZE(boost/mpl/aux_/preprocessed/AUX778076_PREPROCESSED_HEADER)
LINT Error: C:\SW_DEV\boost_1_51_0\boost\mpl\aux_\include_preprocessed.hpp:37  
322 Unable to open include file 'boost\mpl\aux_\preprocessed\plain\.hpp' 
```

该目录存在，但当然没有名为`.hpp`. 我不确定 BOOST_PP_STRINGIZE 或 AUX778076_PREPROCESSED_HEADER 是什么，或者我是否必须执行一些特殊的安装步骤。我主要计划处理只是 .hpp 的部分。我刚刚下载了 boost 并将它放在我的硬盘上，然后告诉 Eclipse 项目在哪里可以找到根 boost 包含目录。（我确实也告诉了 lint 关于 boost 目录的根目录）。

## 编辑

我尝试使用 linting 文件`#include <boost/scoped_ptr.hpp>`并且它有效，所以它看起来确实是包含文件特定的。我更新了帖子标题以反映这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T11:18:50.330

AFAIR，它是根据编译器从 boost\mpl\aux_\preprocessed 中选择要包含的文件。所以请参考[Gimpel 文档](http://www.gimpel.com/html/pub90/gcc-readme.txt)如何配置 pclint 来模仿 gcc 编译器。

# file - 如何在 MATLAB 中读取具有十进制和十六进制/二进制值的文件

> ID：12118016
> 
> 赞同：0
> 
> 时间：2012-08-24T23:49:02.193
> 
> 标签：file, matlab, binary

假设您有一个包含许多列的简单文本文件。有些列已经是十进制值。有些是十六进制的。这些列是已知的。

测试.txt >>

```
1.4 1.9 21 0030 0D12
0.3 3.3 91 FFFF 1111 
```

我想将前三列读取为十进制，并将后两列读取为十六进制。

这可以轻松完成吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:00:36.067

它可以很容易地完成[`textread`](http://www.mathworks.com/help/techdoc/ref/textread.html)。对于您的示例，只需执行以下操作：

```
[col1, col2, col3, col4, col5] = textread('myfile.txt', '%f %f %f %s %s'); 
```

这将正常读取十进制值，并将十六进制值视为字符串。

如果您还希望将字符串转换为十进制值，请使用[`hex2dec`](http://www.mathworks.com/help/techdoc/ref/hex2dec.html)with [`cellfun`](http://www.mathworks.com/help/techdoc/ref/cellfun.html)：

```
[col4, col5] = cellfun(@hex2dec, col4, col5); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T00:02:44.443

您可以使用[fscanf](http://www.mathworks.com/help/techdoc/ref/fscanf.html)。十六进制值应该都是正数吗？如果是这样，您可以像这样扫描它：

```
fscanf(file_id,'%f %f %d %x %x') 
```

# javascript - 可以在 Javascript 文件中引用定义的 CSS 类吗？

> ID：12118020
> 
> 赞同：0
> 
> 时间：2012-08-24T23:49:33.523
> 
> 标签：javascript, jquery, html, css

我有`.js`Javascript 文件，在其中我引用了在单独的样式表文件中定义的 CSS 类。

通过引用，我的意思是这样的：

`.attr("class", "link")`

其中`link`是样式表文件中定义的类。

如果我在一个文件中链接上面的`.js`和文件，样式会正确应用吗？`.css``.html`

**编辑**：到目前为止我尝试过的

HTML：

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Graph Test</title>
        <link type="text/css" href="../css/graph.css" rel="stylesheet">
    </head>
    <body>
        <div id="graph-container">
            <div style="width:700px; height:600px" id="graph"></div>
        </div>
        <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/d3/2.10.0/d3.v2.min.js"></script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script type="text/javascript" src="../js/graph1.js"></script>
    </body>
</html> 
```

`graph1.js`是有`.js`问题的文件，我在其中引用了`graph.css`. 这两个文件都存在于指定的位置，但没有将 中定义的样式`graphs.css`应用于由`graph1.js`.

注意：起飞`<!DOCTYPE html>`消除了问题，但它不是解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T23:52:49.953

是的，一点没错。它们将被正确引用。许多框架（如 JQuery）都会做这种事情来设置控件的样式。

# ios - 如何通过 iOS 应用在 Facebook 上分享应用信息？

> ID：12118021
> 
> 赞同：0
> 
> 时间：2012-08-24T23:49:52.400
> 
> 标签：ios, facebook, status

好吧，也许以前有人问过，如果它有十亿个链接，请不要激怒我。如果用户喜欢我的 iPhone 应用程序，我希望他们单击​​我的应用程序上的一个按钮，这将允许他们在他们的 facebook 墙上发布带有图像或链接的状态。

注意：我不是在问如何通过 iPhone 应用在 FB 墙上发布状态。我希望文本已经填写在状态内容中。我将我的应用程序的营销方式委托给用户，因此如果用户喜欢该应用程序，他可以单击“在 FB 上共享应用程序信息”，这将允许他发布一个由诸如“哇”之类的促销策略填写的 FB 状态，看看这个应用程序，太棒了！” .

既然您知道我的意图是什么，请建议我使用与操作方法相关的有用链接来执行此操作。我并不特别关注它是如何完成的，但逻辑是：

iPhone app->IBaction-> 会导致 FB 状态消息，其中包含已填写的文本和链接。

现在请用你的创造性思维来帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:10:50.903

除此之外，您实际上应该搜索更多，但我为您找到了它。

这`IBAction`将推送一个重定向到的 WebView：

```
"sharer.php", with parameters "u" and "t" 
```

URL格式如下（以CNN.com为例，为了方便查看，进行了换行）：

```
http://www.facebook.com/sharer.php

?u=http%3A%2F%2Fwww.cnn.com%2F

&t=CNN%26s+website 
```

希望我有所帮助！

来源：[http ://askville.amazon.com/add-Share-Facebook-button-webpage/AnswerViewer.do?requestId=1539369](http://askville.amazon.com/add-Share-Facebook-button-webpage/AnswerViewer.do?requestId=1539369)

# mysql - MySQL：根据值排除列

> ID：12118023
> 
> 赞同：0
> 
> 时间：2012-08-24T23:50:27.797
> 
> 标签：mysql, database

我有一个数据库，其中有一行称为形状，并包含矩形、正方形和圆形的条目。我目前有以下代码来仅获取用户请求的形状。（目前它是矩形和圆形、正方形和圆形或只有圆形）。由于某种原因，它无法正常工作并引发数据库错误。谁能帮我？“MEMBER_FROM”是他们所在的列

```
$where = "";
    if($context['no_sq'] == 1 && $context['no_rec'] == 0) {
        $where .= " WHERE MEMBER_FROM != 'Square'";
    } else if($context['no_sq'] == 1 && $context['no_rec'] == 0) {
        $where .= " WHERE MEMBER_FROM != 'Rectangle'";
    } else if($context['no_sq'] == 1 && $context['no_rec'] == 1) {
        $where .= " WHERE MEMBER_FROM != 'Square' AND MEMBER_FROM != 'Rectangle'";
    }
    $request = mysql_query("SELECT ID_SHAPES FROM {$db_prefix}shapes WHERE ID_MEMBER = {$memID}{$where}", __FILE__, __LINE__); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:53:06.797

你不能说 WHERE 两次。使用和...

```
 $where = "";
        if($context['no_squ'] == 1 && $context['no_rec'] == 0) {
            $where .= " AND MEMBER_FROM != 'Square'";
        } else if($context['no_sq'] == 1 && $context['no_rec'] == 0) {
            $where .= " AND MEMBER_FROM != 'Rectangle'";
        } else if($context['no_sq'] == 1 && $context['no_rec'] == 1) {
            $where .= " AND MEMBER_FROM != 'Square' AND MEMBER_FROM != 'Rectangle'";
        } 

     $request = mysql_query("SELECT ID_SHAPES FROM {$db_prefix}shapes WHERE ID_MEMBER = {$memID}{$where}", __FILE__, __LINE__); 
```

**更新：** 根据您的声明，您的形状是排除复选框，将这些框命名为数组然后基于循环构建查询会更有意义。否则这段代码可能很难维护......

```
<input type="checkbox" name="exclude[]" value="Square"> Square
<input type="checkbox" name="exclude[]" value="Rectangle"> Rectangle
<input type="checkbox" name="exclude[]" value="Circle"> Circle 
```

然后在 PHP

```
foreach($_POST['exclude'] AS $exclude)
{
    $where .= " AND MEMBER_FROM != '".$exclude."'";
} 
```

...显然转义了 $exclude var，但为简单起见，我们假设您正在转义用户输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T00:04:20.340

您正在向`WHERE`查询中添加多个子句，这是非法的。`NOT IN`此外，在这种情况下，您可能更喜欢 better 的语法。请注意，我还冒昧地清理了您的逻辑结构。

```
$sql = "SELECT ID_SHAPES FROM {$db_prefix}shapes WHERE ID_MEMBER = {$memID}";
$disallowed = array();
if($context['no_squ']) $disallowed[] = 'Square';
if($context['no_rec']) $disallowed[] = 'Rectangle';
if(count($disallowed)) {
    $sql .= 'AND MEMBER_FROM NOT IN ("' . implode('", "', $disallowed) . '")';
}
$request = mysql_query($sql); 
```

# html - 如何使父级 div 与具有固定位置的子级一起增长？

> ID：12118031
> 
> 赞同：0
> 
> 时间：2012-08-24T23:51:41.187
> 
> 标签：html, css

我有这 2 个 div：

```
<div id="parent" style="border:1px silid;background-color:#fff">
    <div id="child" style="position:fixed;width:100px;height:100px; border:solid 1px;">
    </div> 
</div> 
```

基本上我希望固定的孩子留在父 div 内，所以每次页面向下滚动（孩子向下移动）时，父 div 都应该调整其高度。

是否有 css 解决方案或者我应该在 js 中制作它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:58:57.247

Javascript应该这样做。

不要认为css可以做到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T00:05:13.530

你不能用 CSS 做到这一点（遗憾的是，孩子们不能通过 CSS 控制父母）。

但是，您可以在 JavaScript 中执行此操作。您可以使用`.height()`and`.width()`从父母的角度，使用孩子的价值`.outerHeight()`和`.outerWidth()`作为价值。

这是一个小提琴： http: [//jsfiddle.net/TfNXs/](http://jsfiddle.net/TfNXs/)（*我更改了样式中的一些内容，以使更改更容易看到。*）

请注意，我只在页面加载时完成了它；您可能需要考虑将该代码用于' 大小可能会发生变化的`bind`任何事件。`#child`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-04T00:18:26.400

您应该尝试应用“溢出：隐藏；” 在你的 CSS 中给你的父母。删除“高度”属性（或将其设置为“自动”），以及。

# maven - linux shell/windows bat 脚本在 maven 源代码层次结构中应该放在哪里？

> ID：12118032
> 
> 赞同：2
> 
> 时间：2012-08-24T23:51:57.630
> 
> 标签：maven

我的 maven 项目有以 bash shell 和 windows bat 格式编写的启动器。

像这样的项目在 Maven 层次结构中应该放在哪里？

也许

```
module/src/main/resources
or
module/src/main/scripts 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T04:49:54.953

我要去

```
module/src/main/scripts 
```

正如maven网站上提到的那样。

# php - 具有可变目标日期的倒计时javascript函数

> ID：12118035
> 
> 赞同：0
> 
> 时间：2012-08-24T23:52:20.893
> 
> 标签：php, javascript, date, countdown

大家好，我正在尝试（1）一个javascript倒计时函数（2）一个接受php变量目标日期的倒计时函数（例如用户点击“开始”后4秒）（3）一个onclick（）到运行 stopstart() 和 updateAlarmTime() 函数。

这是我用于基本代码的：[http ://stopwatch.onlineclock.net/](http://stopwatch.onlineclock.net/)

在我的主 php 页面上，我有：

```
<script src="js/stopwatch.js" type="text/javascript"></script>
<?php $alarmsecond2=4; ?>

<form name='stopwatch'....
<input type='button' onclick='stopstart()'  onfocus='this.blur()' 
name='startstopbutton' id='startstopbutton' ... value='Start'> 
</form> 
```

stopstart() 像上面写的那样工作，如果我使用下拉选择菜单设置时间变量，例如 $alarmsecond2，updateAlarmTime() 工作，但我不希望那样。

我尝试使用一次 onclick() 调用 stopstart() 和 updateAlarmTime('')，但只执行 stopstart。我还尝试使用 onclick() 调用一个函数来调用 stopstart() 和 updateAlarmTime() ，但这也不起作用。

在 stopwatch.js 我有：

```
function stopstart() {

t[t[2]]=(new Date()).valueOf();
t[2]=1-t[2];

if (0==t[2]) {
    clearInterval(t[4]);
    t[3]+=t[1]-t[0];
    document.getElementById("startstopbutton").value="Start";
    document.getElementById('split').innerHTML+=
        (t[7]++)+' Stop: '+format(t[1]-t[0])+'<br>';
    t[4]=t[1]=t[0]=0;
    disp();
    firstsplitflag = 0;
} else {
    document.getElementById("startstopbutton").value="Stop";
    t[4]=setInterval(disp, 43);
}
//GA
urchinTracker('http://stopwatch.onlineclock.net/conversions/stopstartbutton'); 
}

function updateAlarmTime()
{
var hour1 = alarmhour1;
var hour2 = ahour2;
var minute1 = aminute1;
var minute2 = aminute2;
var second1 = asecond1;
var second2 = asecond2;
var second_10th = asecond_10th;
var second_100th = asecond_100th;
var second_1000th = asecond_1000th;

alarmTime = (hour1 + hour2 + minute1 + minute2 + second1 + 
second2 + second_10th + second_100th + second_1000th);

} 
```

如何实现我的三个目标？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T18:59:42.743

> 我尝试使用一次 onclick() 调用 stopstart() 和 updateAlarmTime('')，但只执行 stopstart。

使用逗号运算符：

```
onclick='stopstart(), updateAlarmTime()' 
```

> 我还尝试使用 onclick() 调用一个函数来调用 stopstart() 和 updateAlarmTime() ，但这也不起作用。

使用命名函数，例如`foo()`：

```
onclick='foo()' 
```

其定义如下：

```
<script>
function foo()
  {
  stopstart();
  updateAlarmTime();
  }
</script> 
```

# c - 为什么 calloc 无法在具有 4GB RAM 的系统上分配 1GB？

> ID：12118040
> 
> 赞同：3
> 
> 时间：2012-08-24T23:53:06.077
> 
> 标签：c, windows, memory, ram, calloc

我需要`calloc`1 个超过 1 GB 的元素。此调用返回`NULL`，检查 errno 显示内存不足错误。但是，在测试期间，我有将近 4 GB 的空闲 RAM，更不用说可用的虚拟内存了。

在研究了这个问题之后，我唯一能想到的`calloc`失败原因是我没有足够的*连续*内存可用。但是，在我看来，如果我有 4Gb 可用内存，那么拥有 ~= 1Gb 连续内存应该很容易。有没有办法检查连续的内存可用性？如果这是问题所在，是否有一种直接的方法来“整理”内存？

或者这是否与分配内存的块大小有关，因此它实际上试图分配比我可用的内存更多的内存？我有哪些选择来确定失败的原因？成功分配这么多内存的选择是什么？

我在具有 12Gb 内存的本机 Windows 系统上。接下来我将尝试在 VM 中运行，并给 VM 几 GB 的内存，并检查虚拟机是否可以非透明地访问足够的连续内存。如果我今天完成，我会在这里发布结果。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T00:03:23.177

成功的一个重要关键是为您的应用程序提供 1GB 的虚拟地址空间。对于 32 位 Windows 应用程序，默认情况是应用程序以基本上 2GB 的地址空间启动。

如果您在应用程序失败之前在应用程序中进行了很多分配，那么您很可能已经分配了足够的原始地址空间，以至于没有留下 1GB 的连续地址空间。一个应用程序可以只执行两个小的“策略性放置”分配，这些分配会破坏地址空间，使得剩余部分都小于 1GB。

# bash - 在 bash 中实现 netcat

> ID：12118046
> 
> 赞同：5
> 
> 时间：2012-08-24T23:53:49.590
> 
> 标签：bash, netcat

作为我正在尝试编写的更大脚本的基础，我正在尝试基本上在 bash 中实现一个基本的 netcat 客户端。我当前的脚本在技术上有效，它看起来像这样：

```
#!/bin/bash

exec 3<>/dev/tcp/$1/$2         

cat <&3 &                      
cat <&1 >3 
```

它的问题是它留下了一个需要杀死的挂猫进程，但我想不出一种自动的方法来做到这一点，而且手动运行`pkill cat`似乎并不运动。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-27T19:21:38.277

我已经接受杰里米的回答是正确的，但对于任何好奇的人来说，这里是我最终得到的完整脚本：

```
#!/bin/bash

exec 3<>/dev/tcp/$1/$2         

control_c()
{
    kill $CAT_PID
    exit $?
}

trap control_c SIGINT

cat <&3 &                      
CAT_PID=$!
cat >&3 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-25T00:01:01.940

这是一个可怕的组合，但你可以产生一个子shell，所以像这样：

```
CAT1_PID=$$
echo CAT1_PID > /tmp/CAT1_PID
exec cat <&3 & 
```

然后，当然，如果该脚本的多个副本碰巧正在运行，您就会遇到竞争条件。

根据您的外壳，您可能能够在 PS 列表中调用某种形式的 exec 和“重命名”cat。那么你就可以

```
pkill the_cat_that_ate_the_network 
```

# php - XML, php foreach

> ID：12118050
> 
> 赞同：0
> 
> 时间：2012-08-24T23:55:07.373
> 
> 标签：php, xml, foreach, simplexml

我正在尝试从 XML 文件中输出数据。

以下是 XML 文件的摘录：

```
<TAF>
<raw_text>
TAF AMD EGBB 242124Z 2421/2518 11006KT 6000 BKN020 TEMPO 2421/2424 4000 +SHRA TSRA BECMG 2421/2424 BKN009 PROB30 2500/2506 4000 BR BKN004 BECMG 2506/2508 9999 SCT020 TEMPO 2508/2518 7000 SHRA PROB30 TEMPO 2508/2518 33015G25KT 4000 +TSRA BECMG 2515/2518 35010KT
</raw_text>
<station_id>EGBB</station_id>
<issue_time>2012-08-24T21:24:00Z</issue_time>
<valid_time_from>2012-08-24T21:00:00Z</valid_time_from>
<valid_time_to>2012-08-25T18:00:00Z</valid_time_to>

<forecast>
    <fcst_time_from>2012-08-24T21:00:00Z</fcst_time_from>
    <fcst_time_to>2012-08-25T18:00:00Z</fcst_time_to>
    <wind_dir_degrees>110</wind_dir_degrees>
    <wind_speed_kt>6</wind_speed_kt>
    <visibility_statute_mi>3.73</visibility_statute_mi>
    <sky_condition sky_cover="BKN" cloud_base_ft_agl="2000"/>
</forecast>
<forecast>
    <fcst_time_from>2012-08-24T21:00:00Z</fcst_time_from>
    <fcst_time_to>2012-08-25T00:00:00Z</fcst_time_to>
    <change_indicator>TEMPO</change_indicator>
    <visibility_statute_mi>2.49</visibility_statute_mi>
    <wx_string>+SHRA TSRA</wx_string>
</forecast>
</TAF> 
```

也许还有几个`<forecast>`。我的问题是如何将它们填充到 foreach 循环中以输出`<forecast>`下每个元素的数据`<TAF>`？

我目前正在使用：

```
$xml_taf->data->TAF[0]->forecast 
```

使用 SimpleXML 访问 XML 中的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T09:00:55.007

我不确定你在做什么，但这有效

```
$xml = '<TAF>
<raw_text>
TAF AMD EGBB 242124Z 2421/2518 11006KT 6000 BKN020 TEMPO 2421/2424 4000 +SHRA TSRA BECMG 2421/2424 BKN009 PROB30 2500/2506 4000 BR BKN004 BECMG 2506/2508 9999 SCT020 TEMPO 2508/2518 7000 SHRA PROB30 TEMPO 2508/2518 33015G25KT 4000 +TSRA BECMG 2515/2518 35010KT
</raw_text>
<station_id>EGBB</station_id>
<issue_time>2012-08-24T21:24:00Z</issue_time>
<valid_time_from>2012-08-24T21:00:00Z</valid_time_from>
<valid_time_to>2012-08-25T18:00:00Z</valid_time_to>

<forecast>
    <fcst_time_from>2012-08-24T21:00:00Z</fcst_time_from>
    <fcst_time_to>2012-08-25T18:00:00Z</fcst_time_to>
    <wind_dir_degrees>110</wind_dir_degrees>
    <wind_speed_kt>6</wind_speed_kt>
    <visibility_statute_mi>3.73</visibility_statute_mi>
    <sky_condition sky_cover="BKN" cloud_base_ft_agl="2000"/>
</forecast>
<forecast>
    <fcst_time_from>2012-08-24T21:00:00Z</fcst_time_from>
    <fcst_time_to>2012-08-25T00:00:00Z</fcst_time_to>
    <change_indicator>TEMPO</change_indicator>
    <visibility_statute_mi>2.49</visibility_statute_mi>
    <wx_string>+SHRA TSRA</wx_string>
</forecast>
</TAF>';

echo "<pre>";
$xml = new SimpleXMLElement($xml);
foreach ( $xml->forecast as $forecast ) {
    print( $forecast->fcst_time_from . ","  . $forecast->fcst_time_to . "," . $forecast->visibility_statute_mi . PHP_EOL);
} 
```

输出

```
2012-08-24T21:00:00Z,2012-08-25T18:00:00Z,3.73
2012-08-24T21:00:00Z,2012-08-25T00:00:00Z,2.49 
```

[观看现场演示](http://codepad.viper-7.com/aen1Oa)

# javascript - 如何在three.js中实现不同摄像机/场景之间的交叉淡入淡出？

> ID：12118056
> 
> 赞同：1
> 
> 时间：2012-08-24T23:57:07.777
> 
> 标签：javascript, webgl, three.js

有没有可能，如果有，在three.js中实现以下效果的最佳方法是什么：

我正在显示从相机 C1 和从那里看到的场景 S1：

1.  从摄像机 C2 观看时淡入淡出到场景 S2，或
2.  从摄像机 C3 看到的淡入淡出到场景 S1

任何帮助我思考这个问题的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:32:50.063

这样的事情很简单：

*   使用 2 个渲染目标从不同的摄像机绘制不同的场景
*   将此混合着色器使用两个渲染目标[https://github.com/mrdoob/three.js/blob/master/examples/js/ShaderExtras.js#L1099](https://github.com/mrdoob/three.js/blob/master/examples/js/ShaderExtras.js#L1099)

# javascript - 使用 javascript 搜索 XML 文件并显示结果

> ID：12118057
> 
> 赞同：2
> 
> 时间：2012-08-24T23:57:43.237
> 
> 标签：javascript, xml, search

在过去的 3 个小时里，我一直在到处寻找，但找不到任何可以帮助我的东西。如果周围有任何答案，我很抱歉，但我无法得到它。

所以我有这个xml文件，例如：

```
<entry>
    <title>The Title</title>
    <description>Description here</description>
</entry> 
```

所以我想做的是有一个带有搜索表单的 html，然后根据搜索词在同一页面中显示与该词匹配的所有结果（例如空 div）。

那可能吗？

非常感谢任何可以帮助我的人！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-25T01:25:10.923

我对此感到好奇，但没有人回答，所以我尝试了一些事情并找到了最好和最简单的方法是使用 jQuery

测试.xml

```
<item>
    <entry>
        <title>The Title</title>
        <description>Description here</description>
    </entry>

    <entry>
        <title>The Title 2 </title>
        <description>Description here second</description>
    </entry>
</item> 
```

索引.html

```
<!DOCTYPE html>
<html>
<head>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>
<input type="text" id="search"  autocomplete="off" />
<p id="output"></p>

<script type="text/javascript">
$(document).ready(function(){
    $('#search').on('keyup', function(){
        $.ajax({
            type: "GET",
            url: "test.xml",
            dataType: "xml",
            success: parseXML
        });
    });
});
function parseXML(xml){
    var searchFor = $('#search').val();
    var reg = new RegExp(searchFor, "i");
    $(xml).find('entry').each(function(){
        var title = $(this).find('title').text();
        var titleSearch = title.search(reg);
        var desc = $(this).find('description').text();
        var descSearch = desc.search(reg);
        $('#output').empty();
        if(titleSearch > -1){
            $('#output').append('Found <i>'+searchFor+'<\/i> in title: '+title.replace(reg, '<b>'+searchFor+'</b>')+'<br \/>');
        }
        if(descSearch > -1){
            $('#output').append('Found <i>'+searchFor+'<\/i> in description: '+desc.replace(reg, '<b>'+searchFor+'</b>')+'<br \/>');
        }
    });    
}
</script>
</body>
</html> 
```

# scala - 在 Factory 中避免显式强制转换

> ID：12118058
> 
> 赞同：1
> 
> 时间：2012-08-24T23:57:44.967
> 
> 标签：scala, types, casting, factory

我有一个外部 DSL（Combinator-Parsers）来定义`Extractor[A]`A 是在执行 Extractor 时提取的类型。

提取器由将下一步称为延续的步骤组成。提取器创建中间提取（基于字符串的键/值对），最终`A`由工厂转换为正确的 s。

提取器：`case class Extractor[A](id: String, start: Step[A], factory: Factory[A])`

步：`sealed trait Step[A] { def process(ctx: Context[A]): List[A] }`

工厂：`trait Factory[A] { def create(extracts: List[(String,String)]): List[A] }`

目前我的提取器解析器如下所示：

```
 val extractor: Parser[Extractor[_]] = trace ~ "EXTRACT" ~ extractorType ~ extractorId ~ step ^^ {
    case t ~ _ ~ ty ~ id ~ step => {
      val extr = ty match {
        case "SUBTITLES" => {
          Extractor[MovieInfos.Subtitle](id, step.asInstanceOf[Step[MovieInfos.Subtitle]], new SubtitleFactory)
        }
        case x => throw new InvalidExtractorType(x)
      }
      extr.trace(t)
    }
  } 
```

**编辑**： step-parser 有签名`val step: Parser[Step[_]]`（step-parser 无法知道它的类型`Step[A]`是完全解析的。最后，step `A`-parser 通过提取器解析器获得它的正确类型`asInstanceOf`）

上面的提取器解析器目前只能解析 extractorType 的提取器`"SUBTITLES"`。我想连续添加其他extractorTypes，例如`case "REVIEWS" => ...`。

对于每个提取器`Extractor[A]`，我必须提供一个专门的工厂（例如`new SubtitleFactory`）来创建类型`A`（例如`MovieInfos.Subtitle`）的东西并将匹配`step`的 s 传递给提取器（这就是它的`asInstanceOf`用途）。

解析器必须解析不同的提取器类型（字幕、图像、音轨等），所以我使用`Parser[Extractor[_]]`，这是正确输入还是有更好的方法？

此外，我想避免`step.asInstanceOf[Step[MovieInfos.Subtitle]]`看起来有点可疑，因为我已经提供了正确的类型`Extractor[MovieInfos.Subtitle]`

最后，我想要一个更灵活的工厂，可以通过某种配置/挂钩进行扩展。

任何建议表示赞赏，谢谢。

# jquery - 使用 jquery 在 mouseout 上恢复类

> ID：12118059
> 
> 赞同：0
> 
> 时间：2012-08-24T23:57:55.800
> 
> 标签：jquery, jquery-selectors

这是关于堆栈溢出的第一个问题，所以请耐心等待。

为了便于阅读，我有一个按行列出的约会列表，背景颜色由灰色类决定。

```
 <div class="grid_13 alpha omega entry grey">
    <div class="grid_3 alpha start">Sat 05/05/2012 10:00 am</div>
    <div class="grid_3">Sat 05/05/2012 10:15 am</div>
    <div class="grid_3">ME</div>
    <div class="grid_3 omega">Attended</div>
</div>
<div class="grid_13 alpha omega entry">
    <div class="grid_3 alpha start">Tue 01/05/2012 9:00 am</div>
    <div class="grid_3">Tue 01/05/2012 10:00 am</div>
    <div class="grid_3">MDH</div>
    <div class="grid_3 omega">Scheduled</div>
</div>
<div class="grid_13 alpha omega entry grey">
    <div class="grid_3 alpha start">Mon 30/04/2012 8:45 am</div>
    <div class="grid_3">Mon 30/04/2012 9:45 am</div>
    <div class="grid_3">ME</div>
    <div class="grid_3 omega">Scheduled</div>
</div>
<div class="grid_13 alpha omega entry">
    <div class="grid_3 alpha start">Thu 26/04/2012 11:00 am</div>
    <div class="grid_3">Thu 26/04/2012 12:00 pm</div>
    <div class="grid_3">ME</div>
    <div class="grid_3 omega">Scheduled</div>
</div> 
```

在鼠标悬停时，我试图删除我能够做到的灰色类，然后添加另一种背景颜色作为突出显示，然后在我也可以管理的 mouseout 上将其删除。

```
 $(".entry").mouseover(function(){
        $(this).removeClass("grey");
        $(this).addClass("highlight");
    });
    $(".entry").mouseout(function(){
        $(this).removeClass("highlight");
    }); 
```

但是我不知道如何恢复灰色类，但前提是它首先具有灰色类。我努力了

```
 if ($(".entry").attr('class') == "grey") {
            $(this).hover(
            function(){ $(this).removeClass("grey"); $(this).addClass("highlight"); },
            function(){ $(this).removeClass("highlight"); $(this).addClass("grey"); }
        )
    } else{
        $(this).hover(
            function(){ $(this).addClass("highlight"); },
            function(){ $(this).removeClass("highlight"); } 
        )
    }; 
```

加上其他一些组合，似乎都不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:07:47.513

```
$('.parentElementClass').on('mouseover mouseout', '.entry', function() {
    $(this).toggleClass('grey highlight');
}); 
```

[**演示**](http://jsfiddle.net/ricardolohmann/9sFMb/)

检查[toggleClass](http://api.jquery.com/toggleClass/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T00:05:20.243

就像我在评论中所说的那样，`canhavegray`在每个具有 class 的元素上添加一个名为 example 的类`gray`。然后这个功能应该工作：

```
$('.entry').mouseover(function(){
    $(this).removeClass('grey'); // Will only happen if the element has the class gray
    $(this).addClass('highlight');
})
$('.entry').mouseout(function(){
    if ($(this).hasClass('canhavegray')) // If the element has this class, it will readd it here
        $(this).addClass('grey');
    $(this).removeClass('highlight');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T00:30:55.287

也许甚至像这样的东西也会起作用：

```
$('div.entry:even').hover(function(){$(this).toggleClass('highlight');}); 
```

[在这里演示](http://jsfiddle.net/Vxu2s/)

[:even 选择器](http://api.jquery.com/even-selector/)

# java - 将 PropertyChangeListener 添加到 JComboBox

> ID：12118060
> 
> 赞同：0
> 
> 时间：2012-08-24T23:58:24.037
> 
> 标签：java, swing, jcombobox, propertychangelistener

我该如何`PropertyChangeListener`使用`JComboBox`？当我在 editable 中写入时`JComboBox`，我会立即写入文本，因为我更改了组合框箭头按钮的图标；关键听众不再工作。这是我尝试过的，但我不知道如何完成：

```
editor = (JTextComponent) jComboBox1.getEditor().getEditorComponent();

editor.addPropertyChangeListener(new PropertyChangeListener()
{
    @Override
    public void propertyChange(PropertyChangeEvent evt) 
    {

    }       

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T01:18:22.243

从帖子中理解您想要实现的目标有点困难，但如果您有兴趣了解编辑器内容何时更改，您可以尝试

```
final JComboBox combo = new JComboBox();
combo.setEditable(true);
((JTextComponent) combo.getEditor().getEditorComponent()).getDocument().addDocumentListener(new DocumentListener() {
    protected void updatePopup() {

        if (combo.isDisplayable()) {

            if (!combo.isPopupVisible()) {

                combo.showPopup();

            }

        }

    }

    @Override
    public void insertUpdate(DocumentEvent e) {
        updatePopup();
    }

    @Override
    public void removeUpdate(DocumentEvent e) {
        updatePopup();
    }

    @Override
    public void changedUpdate(DocumentEvent e) {
        updatePopup();
    }
}); 
```

通常，我会创建一个“DocumentHandler”作为具体类并使用它，但该示例演示了基本思想

**更新了一个 UI 示例**

```
public class TestComboBox extends JFrame {

    public TestComboBox() {

        setTitle("Test");
        setSize(200, 200);
        setLayout(new GridBagLayout());
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setLocationRelativeTo(null);

        final JComboBox combo = new JComboBox();

        /**** You have to do this first
         **** Doing this invalidates any previous listeners
         ****/
        combo.setUI(ColorArrowUI.createUI(combo));

        combo.setEditable(true);
        ((JTextComponent) combo.getEditor().getEditorComponent()).getDocument().addDocumentListener(new DocumentListener() {
            protected void updatePopup() {

                if (combo.isDisplayable()) {

                    if (!combo.isPopupVisible()) {

                        combo.showPopup();

                    }

                }

            }

            @Override
            public void insertUpdate(DocumentEvent e) {
                updatePopup();
            }

            @Override
            public void removeUpdate(DocumentEvent e) {
                updatePopup();
            }

            @Override
            public void changedUpdate(DocumentEvent e) {
                updatePopup();
            }
        });

        combo.setModel(createComboBoxModel());

        add(combo);

        setVisible(true);

    }

    protected ComboBoxModel createComboBoxModel() {

        DefaultComboBoxModel model = new DefaultComboBoxModel();

        File file = new File("../TestWords/Words.txt");
        BufferedReader reader = null;

        try {

            reader = new BufferedReader(new FileReader(file));
            String text = null;
            while ((text = reader.readLine()) != null) {

                model.addElement(text);

            }

        } catch (Exception e) {
        } finally {

            try {
                reader.close();
            } catch (Exception e) {
            }

        }

        return model;

    }

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
        } catch (InstantiationException ex) {
        } catch (IllegalAccessException ex) {
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        }
        new TestComboBox();
    }

    public static class ColorArrowUI extends BasicComboBoxUI {

        public static ComboBoxUI createUI(JComponent c) {
            return new ColorArrowUI();
        }

        @Override
        protected JButton createArrowButton() {
            return new BasicArrowButton(
                            BasicArrowButton.SOUTH,
                            Color.cyan, Color.magenta,
                            Color.yellow, Color.blue);
        }
    }
} 
```

使用 UI 设置

![由用户界面设置](../Images/877b2a2e3df45582327be305b091b720.png)

使用画家设置

![由画家设置](../Images/798e272eda9cc96f5cbdcf7714feeb22.png)

**更新**

这是 kleopatra 向您展示的代码

```
Painter painter = new Painter<JComponent>() {

    @Override
    public void paint(Graphics2D g, JComponent object, int width, int height) {

        g.setColor(Color.WHITE);
        g.fillRect(0, 0, width, height);

    }

};

JButton org = null;
for (int i = 0; i < combo.getComponentCount(); i++) {
    if (combo.getComponent(i) instanceof JButton) {
        org = (JButton) combo.getComponent(i);
        UIDefaults buttonDefaults = new UIDefaults();
        buttonDefaults.put("ComboBox:\"ComboBox.arrowButton\"[Enabled].foregroundPainter", painter);
        org.putClientProperty("Nimbus.Overrides.InheritDefaults", false);
        org.putClientProperty("Nimbus.Overrides", buttonDefaults);
        break;
    }
} 
```

# jquery - 调用停止并重新启动后 jQuery 动画变慢

> ID：12118067
> 
> 赞同：0
> 
> 时间：2012-08-24T23:59:08.917
> 
> 标签：jquery, jquery-animate

我已经定义了一个函数来动画 7 个 div 到顶部。我尝试使用 stop(true, false) 函数来停止所有元素。并通过再次调用该函数重新启动动画。请看下面的代码。问题是我调用函数重新启动动画后动画变得非常慢。它慢了几秒钟，然后又恢复了正常速度。有谁知道原因。请帮忙！！！谢谢

我的代码附在下面

```
autoAnimate(5000);
$('#scroller_container').mouseenter(function(){
    $('#scroller .galleryThumb').stop(true, false);
});
$('#scroller_container').mouseleave(function(){
    autoAnimate(5000);
});

function autoAnimate(speed) {
    $('#scroller .galleryThumb:eq(0)')
        .animate({'top':'-122px'},speed,'linear',function(){
          if(!autoFlag) {
            index       = $('#scroller .galleryThumb:last').attr('id');
            index       = index.substr(5, index.length);
            index       = parseInt(index);
            index       = index + 1;
            autoFlag    = true;
          }
          if(index == numberOfAds) { index = 0; }

          $('#scroller .galleryThumb:eq(0)').remove();
          $('#scroller').append(adUnitContainer[index]);
          $('#scroller .galleryThumb:eq(6)').css('top','732px');
          index++;
          autoAnimate(speed);
    });
    $('#scroller .galleryThumb:eq(1)').animate({'top':'0px'},speed,'linear');
    $('#scroller .galleryThumb:eq(2)').animate({'top':'122px'},speed,'linear');
    $('#scroller .galleryThumb:eq(3)').animate({'top':'244px'},speed,'linear');
    $('#scroller .galleryThumb:eq(4)').animate({'top':'366px'},speed,'linear');
    $('#scroller .galleryThumb:eq(5)').animate({'top':'488px'},speed,'linear');
    $('#scroller .galleryThumb:eq(6)').animate({'top':'610px'},speed,'linear');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T01:11:52.647

如果你有一个 5 秒的动画并且你在中间停止它然后你用相同的动画终点重新开始相同的动画并告诉它运行 5 秒，它会变慢，因为它的距离更短在 5 秒内。

如果您希望它以与之前相同的速度重新启动，那么您必须减少第二个动画中的时间量以反映按比例分配的时间量。

记住`speed = distance / time`。如果您重新启动的动画的行驶距离较短但时间相同，则速度会较慢，除非您也按比例减少时间。

# php - 如何从 MySQL 数据库中提取项目的类别和标签？

> ID：12118068
> 
> 赞同：0
> 
> 时间：2012-08-24T23:59:12.160
> 
> 标签：php, mysql, sql, codeigniter, join

我的数据库中有 5 个表。
[Items] - id、name 等...
[Categories] - id、name
[Tags] - id、name

2 连接表
[Items_Categories] - item_id, category_id
[Items_Tags] - item_id, tag_id

在给定 item_id = $id 的情况下，我只需要知道性能最佳的查询（必要时使用 JOINS）即可从数据库中提取 1 个或多个项目及其所有信息，包括类别和标签。

到目前为止，我有以下工作，但在 25 - 50 个查询中，它很慢（有人有更好的东西吗？）：

```
 SELECT `items`.`name`, `items`.`etc`,
group_concat(DISTINCT categories.name ORDER BY categories.name DESC SEPARATOR ", ") AS category, 
group_concat(DISTINCT tags.name ORDER BY tags.name DESC SEPARATOR ", ") AS tag, 
`items`.`id` AS id 
FROM (`items` AS items, `item_categories` AS categories, `items_to_categories` AS items_cats, `item_tags` AS tags, `items_to_tags` AS items_tags) 
JOIN `item_categories` ON `categories`.`id` = `items_cats`.`category_id` AND items_cats.item_id = $id 
JOIN `item_tags` ON `tags`.`id` = `items_tags`.`tag_id` AND items_tags.item_id = $id WHERE `items`.`id` = $id 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T00:17:21.343

问题是您实际上是首先进行完全交叉连接（通过按您所做的方式列出表），而不是有选择地“按顺序”连接并允许查询计划简化连接。尝试像这样加入以显式地仅加入适当的行。

```
SELECT 
  `items`.`name`, 
  `items`.`etc`,
  group_concat(DISTINCT `categories`.`name` ORDER BY `categories`.`name` DESC SEPARATOR ", ") AS category, 
  group_concat(DISTINCT `tags`.`name` ORDER BY `tags`.`name` DESC SEPARATOR ", ") AS tag, 
  `items`.`id` AS id 
FROM `items`, 
  LEFT JOIN `item_categories` ON `items`.`id` = `item_categories`.`item_id`
  LEFT JOIN `categories` ON `item_categories`.`category_id` = `categories`.`id`,
  LEFT JOIN `item_tags` ON `items`.`id` = `item_tags`.`item_id`
  LEFT JOIN `tags` ON `item_tags`.`tag_id` = `tags`.`id` 
WHERE `item`.`id` = $id
GROUP BY `item`.`id` 
```

这将产生一个闪电般的快速查询，并且通过添加适当的索引很容易使其更快。然而，我的理念是，您应该首先进行快速查询，然后通过索引快速获得它；不使用索引作为第一方法。

# c# - 将 javascript 用于自定义目的

> ID：12118077
> 
> 赞同：-1
> 
> 时间：2012-08-25T00:00:23.917
> 
> 标签：c#, javascript, 3d, raytracing

我正在编写一个光线追踪器作为我完整的 3d 引擎的一部分。我打算使用 javascript 作为脚本语言，而不是自己编写。问题是我该如何使用它？顺便说一句，光线追踪器和 UI 是用 C# 编写的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T00:27:37.387

这显示了 Javascript 和 c# 之间的双向交互。

1.  Javascript 调用 ac# 方法
2.  C# 获取 Javascript 中表达式的结果

-

```
Type scriptType = Type.GetTypeFromCLSID(Guid.Parse("0E59F1D5-1FBE-11D0-8FF2-00A0D10038BC"));

dynamic obj = Activator.CreateInstance(scriptType, false);
obj.Language = "javascript";
obj.AddObject("MyClass",new JSAccessibleClass());

obj.Eval("MyClass.MsgBox('Hello World')"); //<--1
var result = obj.Eval("3+5"); //<--2

[ComVisible(true)]
public class JSAccessibleClass
{
    public void MsgBox(string s)
    {
        MessageBox.Show(s);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T00:03:24.630

有许多 JavaScript 的独立实现可以用于此目的：

这是 JavaScript 上的 stackoverflow 信息页面的链接，其中列出了许多这些实现：[https ://stackoverflow.com/tags/javascript/info](https://stackoverflow.com/tags/javascript/info)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T00:07:55.337

虽然可以使用 JavaScript 作为 .Net 应用程序的脚本，但它不是最流行的选择。如果您可以选择其他语言 - IronPython 或 LUA.Net 可能是您将获得更好支持的选择。我最近在类似问题中列出了几个链接：[Write npc scripts to be executed by c# using class with npc methods](https://stackoverflow.com/questions/11589289/write-npc-scripts-to-be-executed-by-c-sharp-using-class-with-npc-methods/11589365#11589365)。

否则，JavaScript.Net（.Net 框架的一部分）或其他显式 .Net 或具有 .Net 绑定的实现将用作脚本语言。

# python - PySide Qt Creator 消息对话框退出

> ID：12118078
> 
> 赞同：0
> 
> 时间：2012-08-25T00:00:28.700
> 
> 标签：python, qt-creator, pyside

所以我用 Qt Creator 创建了一个 ui 文件，其中有一个 QPushButton。只是为了测试目的，我想弹出一个 QMessageDialog 说你好！在主窗口类中打开 ui 后，我将 ui 中的按钮连接到 def hello(self)：

```
myWidget.helloButton.clicked.connect(self.hello) 
```

然后稍后

```
def hello(self):
    QtGui.QMessageBox.question(self,'Message',"hello!",QtGui.QMessageBox.Ok) 
```

弹出消息说“你好！” 在消息对话框中单击“确定”后，整个 python 程序退出，有效地使主窗口 GUI 崩溃

当我不使用 UI 文件时，这并没有发生在我身上。有谁知道为什么会这样？

提前致谢。

编辑：只要我点击“确定”就会发生这种情况

```
Traceback (most recent call last):
File "C:\Users\George\Desktop\loadui..py", line 25, in <module>
main()
File "C:\Users\George\Desktop\loadui..py", line 23, in main
sys.exit(app.exec_())
SystemExit: 0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-09T22:07:12.867

`QDialog`将from的父级更改为`self`对`QtGui.QApplication.activeWindow()`我有用。

# ruby-on-rails-3 - Stripe：创建客户和/或费用时的错误消息 - Ruby on Rails

> ID：12118086
> 
> 赞同：4
> 
> 时间：2012-08-25T00:01:44.617
> 
> 标签：ruby-on-rails-3, debugging, token, railscasts, stripe-payments

我正在我的 Rails 应用程序中实现 Stripe，当我加载输入表单时出现 Invalid Token 错误 - 我还没有提交客户数据。我主要遵循[http://railscasts.com/episodes/288-billing-with-stripe](http://railscasts.com/episodes/288-billing-with-stripe)教程。我做了一些修改，因为它有些不完整。

books/show.html.erb 是我链接到表单的页面：

```
<b>Title:</b>  <%= @book.title %> </p>
<b>Author:</b>  <% authorid = @book.author %></p>

<%= @book.id %>
<%= link_to "Buy Now", new_purchase_path(:book_id => @book.id) %> 
```

purchase/new.html.erb 是用户填写信息的地方。加载时，我收到 Invalid Token 错误：

```
<%= form_for @purchase do |f| %>
  <% if @purchase.errors.any? %>
    <%= pluralize(@purchase.errors.count, "error") %> prohibited this purchase from being saved.
    <% @purchase.errors.full_messages.each do |msg| %>
      <%= msg %>
    <% end %>
  <% end %>

  <%= f.hidden_field :stripe_card_token %>

  <% if @purchase.stripe_card_token.present? %>
    Credit card has been provided.
  <% else %>
    <%= label_tag :card_number, "Credit Card Number" %>
    <%= text_field_tag :card_number, nil, name: nil %><p>

    <%= label_tag :card_code, "Security Code on Card (CVV)" %>
    <%= text_field_tag :card_code, nil, name: nil %><p>

    <%= label_tag :card_month, "Card Expiration" %>
    <%= select_month nil, {add_month_numbers: true}, {name: nil, id: "card_month"} %>
    <%= select_year nil, {start_year: Date.today.year, end_year: Date.today.year+15}, {name: nil, id: "card_year"} %>
  <% end %>

<div id="stripe_error">
  <noscript>JavaScript is not enabled and is required for this form. First enable it in your web browser settings.</noscript>
</div>

  <%= f.submit "Purchase" %>
<% end %> 
```

purchase.js.coffee 与教程中的几乎相同。我添加了一些警报。根据我的 Stripe 仪表板的状态是 402。这是一个 POST /v1/tokens 错误，响应正文是：

```
error:
  type: "card_error"
  message: "This card number looks invalid"
  param: "number" 
```

购买.js.coffee：

```
jQuery ->
  Stripe.setPublishableKey($('meta[name="stripe-key"]').attr('content'))
  purchase.setupForm()

purchase =
   setupForm: ->
    $('#new_purchase').submit ->
      $('input[type=submit]').attr('disabled', true)
     if $('#card_number').length
       purchase.processCard()
       false
     else
       true

  processCard: ->
    card =
      number: $('#card_number').val()
      cvc: $('#card_code').val()
      expMonth: $('#card_month').val()
      expYear: $('#card_year').val()
    Stripe.createToken(card, purchase.handleStripeResponse)

  handleStripeResponse: (status, response) ->
    if status == 200
      alert('This token can still be charged.')
      alert(response.id)
      $('#purchase_stripe_card_token').val(response.id)
      $('#new_purchase')[0].submit()
    else
      alert(response.error.message) 
      alert('The token was invalid, or has been used.')
      $('#stripe_error').text(response.error.message)
      $('input[type=submit]').attr('disabled', false) 
```

我已经尝试了几个版本的 purchase.rb 模型，例如注释掉 Stripe::Charge 函数，但仍然得到 402 Token 错误。但是创建客户是成功的（代码 200）。

```
class Purchase < ActiveRecord::Base

  attr_accessible :stripe_customer_token, :author_id, :book_id
  attr_accessor :stripe_card_token

  belongs_to :book

def save_with_payment
  if valid?

    customer = Stripe::Customer.create(
      :description => "customer email", 
      :card => stripe_card_token
    )
    self.stripe_customer_token = customer.id

#    charge = Stripe::Charge.create(  - this code doesn't work either
#      :amount => 1000,
#      :currency => "usd",
#      :card => stripe_card_token,
#      :description => "book title"
#    )
    save!
  end

  rescue Stripe::InvalidRequestError => e
    logger.error "Stripe error while creating customer: #{e.message}"
    errors.add :base, "There was a problem with your credit card."
    false
  end
end 
```

如果我取消注释 Stripe::Charge 代码，我得到的错误是：Stripe::CardError in PurchasesController#create 无法向没有活动卡的客户收费

而且，我的 purchase_controller.rb 中的 create 方法

```
def create
  @purchase = Purchase.new(params[:purchase])
  if @purchase.save_with_payment
    redirect_to @purchase, :notice => "Thank you for purchasing this book!"
  else
    render :new
  end
end 
```

这是我在 purchase_controller.rb 中的新方法：

> 定义新
> 
> ```
>  book = Book.find(params[:book_id])    
> 
>  @purchase = book.purchases.build 
> ```
> 
> 结尾

但是如果我在提交购买后点击返回按钮（返回购买/new.html.erb 页面），第二个“购买”将输入到我的数据库中，并且我的 Stripe 日志中该 POST 令牌的代码是 200 （经过）！！！

这是从 coffeescript 编译的 javascript：

> （功能（） {
> 
> var 购买；
> 
> jQuery（函数（）{
> 
> Stripe.setPublishableKey($('meta[name="stripe-key"]').attr('content'));
> 
> return purchase.setupForm();
> 
> });
> 
> 购买 = {
> 
> setupForm：函数（）{
> 
> ```
>  $('#new_purchase').submit(function() {
> 
>    return $('input[type=submit]').attr('disabled', true);
> 
>  });
> 
>  if ($('#card_number').length) {
> 
>    purchase.processCard();
> 
>    return false;
> 
>  } else {
> 
>    return true;
> 
>  } 
> ```
> 
> },
> 
> 进程卡：函数（）{
> 
> ```
>  var card;
> 
>  card = {
> 
>    number: $('#card_number').val(),
> 
>    cvc: $('#card_code').val(),
> 
>    expMonth: $('#card_month').val(),
> 
>    expYear: $('#card_year').val()
> 
>  };
> 
>  return Stripe.createToken(card, purchase.handleStripeResponse); 
> ```
> 
> },
> 
> handleStripeResponse：函数（状态，响应）{
> 
> ```
>  if (status === 200) {
> 
>    alert('This token can still be charged.');
> 
>    alert(response.id);
> 
>    $('#purchase_stripe_card_token').val(response.id);
> 
>    return $('#new_purchase')[0].submit();
> 
>  } else {
> 
>    alert(response.error.message);
> 
>    alert('The token was invalid, or has been used.');
> 
>    $('#stripe_error').text(response.error.message);
> 
>    return $('input[type=submit]').attr('disabled', false);
> 
>  } 
> ```
> 
> }
> 
> };
> 
> }).call(this);

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T23:40:05.050

正如我在上面的评论中提到的，CoffeeScript 的缩进有点偏离（空白在 CS 中很重要）。这不是语法错误，所以它仍然可以编译，但生成的 JS 不是您想要的。这是正确缩进的代码。

```
purchase =
  setupForm: ->
    $('#new_purchase').submit ->
      $('input[type=submit]').attr('disabled', true)
      if $('#card_number').length
        purchase.processCard()
        false
      else
        true
  # ... 
```

在您发布的 JS 中，条件`if ($('#card_number').length)`存在于绑定到提交事件的匿名函数之外。这会导致条件在页面加载后立即运行，而不是在提交表单时运行。由于最初加载页面时“#card_number”输入中没有任何内容，因此条件的替代项（`else`分支）被静默执行。这是 JS 的样子：

```
$('#new_purchase').submit(function() {
  $('input[type=submit]').attr('disabled', true);
  if ($('#card_number').length) {
    purchase.processCard();
    return false;
  } else {
    return true;
  }
}); 
```

您在导航“返回”到新页面时看到的行为是在“#card_number”字段（执行函数）中输入页面加载*的*`processCard`结果，这是您想要的，而不是*在*您想要的时候。

如果我的推测是正确的，那么修复 CoffeeScript 中的缩进就是解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T04:11:19.387

是否在页面加载时提交表单？（可能是来自应用程序另一部分的错误 jQuery 请求？）我发现这个页面在设置/测试 Stripe 时帮助了我很多：[https ://stripe.com/docs/testing](https://stripe.com/docs/testing)

**更新**

先试试这个

```
def new
  @book = Book.find(params[:book_id])
  @purchase = @book.purchases.new
end 
```

如果这不起作用，请将您的表格更改为

```
<%= form_for [@book, Purchase.new] do |f| %> 
```

# c++ - 清洁与破坏

> ID：12118096
> 
> 赞同：7
> 
> 时间：2012-08-25T00:03:33.817
> 
> 标签：c++, compilation

我编译了一个大项目：我运行了一个编译，但它因“未完成的作业”错误而失败当我 make clean /clobber 它在另一个地方失败并出现同样的错误？

编译的 clean 和 clobber 有什么区别？以及如何解决上述寒冷的问题？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-25T02:21:32.497

Keith 是对的，clean 和 clobber 可以意味着 makefile 的作者想要的任何东西。

在实践中，虽然我认为通常两者之间的区别是：

*   `clean`: 删除所有创建的目标文件
*   `clobber`: 删除所有目标文件和生成的指定 cpp 文件依赖关系的中间依赖文件。

至少在我从事的项目中是这样的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-25T00:24:20.567

我想你是说你运行命令

```
make clean 
```

或者

```
make clobber 
```

这些是您在`Makefile`. 它们的含义取决于 Makefile 所说的内容；它们不是预定义的。通常，它们都会删除编译时生成的文件（可执行文件、目标文件）。`clean`之间的差异（如果有的话）`clobber`取决于`Makefile`.

# android - Mono for Android 安装没有进行..！

> ID：12118099
> 
> 赞同：0
> 
> 时间：2012-08-25T00:03:45.660
> 
> 标签：android, installation, xamarin.android

我已经从 xamarin.com/trial 下载了安装文件“1.5 MB”..我使用的是 Windows 7 并安装了 VS 2010..

当我运行安装文件时它只显示第一个屏幕并在显示下一个屏幕之前突然消失..

问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T06:49:09.393

它很可能是防火墙/防病毒阻止安装到达其服务器。检查他们的日志或尝试轮流禁用它们，看看是什么原因造成的。似乎安装程序是可执行文件而不是正确的安装程序

# clojure - 如何使用旋转将集合添加到 DynamoDB？

> ID：12118101
> 
> 赞同：0
> 
> 时间：2012-08-25T00:04:09.940
> 
> 标签：clojure

我正在使用来自 clojure 的旋转客户端测试亚马逊 DynamoDB，但在插入集合时遇到了麻烦。

例如，如果我这样做

```
(put-item aws-cred "MyTbl" {"id" 123 "abc" "something "bcd" 42}) 
```

它工作得很好。我可以看到 AWS Explore Table 中的字段，并在执行操作时将其取回

```
(get-item aws-cred "MyTbl" 123) 
```

但我不知道如何插入一个集合（DynamoDB 支持字符串集和数字集）。我已经通过在 AWS 探索表中手动设置属性来验证这一点。

我试过了

```
(put-item aws-cred "MyTbl" {"id" 123 "abc" #{"A" "B"}})

(put-item aws-cred "MyTbl" {"id" 123 "abc" ["A" "B"]})

(put-item aws-cred "MyTbl" {"id" 123 "abc" '("A" "B")})

(put-item aws-cred "MyTbl" {"id" 123 "abc" (java.util.ArrayList. ["A" "B"])}) 
```

他们都成功了，但除了 id 之外，没有任何东西出现在表格中。我尝试了最后一个版本，因为当我在手动输入的行上执行 get-item 时，该集合返回为该类型。

有没有人设法做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T01:33:16.747

有一个支持java api 提供的功能[的旋转分支。](https://github.com/mrgordon/rotary)`update-item`我用它来将项目插入到集合中：

```
(rotary/update-item cred "MyTbl" "HashKey" {"mysetattribute" [:add #{"newvalue"}]} :return-values "NONE")) 
```

# c# - 将 Byte[] 程序集加载到新的 AppDomain

> ID：12118105
> 
> 赞同：2
> 
> 时间：2012-08-25T00:05:21.800
> 
> 标签：c#, byte, appdomain

我目前从远程流中获取一个作为字节数组的程序集。无论如何将其加载到新的 AppDomain 中？

AppDomain.Load(byte[]) 不起作用，因为它给了我 FileNotFoundException，我假设程序集必须在我的计算机上。

```
 AppDomain domain = AppDomain.CreateDomain("Test");

        Thread t = new Thread(() =>
        {
            Assembly assembly = domain.Load(bytes);
            MethodInfo method = assembly.EntryPoint;
            if (method != null)
            {
                object o = assembly.CreateInstance(method.Name);
                try
                {
                    method.Invoke(o, null);
                }
                catch (TargetInvocationException ex)
                {
                    Console.WriteLine(ex.ToString());
                }
            }
        });
        t.Start(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:17:51.650

您需要将该字节数组传递给在新 AppDomain 中运行的代码，并对该数据调用[Load(byte[]) 。](http://msdn.microsoft.com/en-us/library/h538bck7)

现在与任何加载程序集一样，您需要了解在使用不同的加载程序集方法时如何解决依赖关系。在大多数情况下，您必须将依赖项预加载到新的 AppDomain 或添加 AssemblyResolver 事件处理程序。搜索[“C# LoadFrom Cook”](http://www.bing.com/search?q=c%23+loadfrom+cook)以获取 Suzanne Cook 关于加载程序集的文章集。

# xml - 如何遍历每个值

> ID：12118106
> 
> 赞同：1
> 
> 时间：2012-08-25T00:05:26.047
> 
> 标签：xml, xslt, xsd, xslt-2.0

所以我有这个 .inc 文件，它有一组`<li>`元素，比如

```
<li class="closed"><a title="x" href="x.html">x</a></li>
<li class="closed"><a title="y" href="y.html">y</a></li>
<li class="closed"><a title="z" href="a.html">z</a></li> 
```

我可以使用以下 XSL 代码获取每个值：

```
<xsl:variable name="vText" select="unparsed-text('/abc/abcd/leftnav.inc')"/>
<xsl:variable name="vExtracted" as="xs:token*">
  <xsl:analyze-string select="$vText" regex="&gt;([^&lt;]*)&lt;/a&gt;" flags="m">
    <xsl:matching-substring>
      <xsl:value-of select="regex-group(1)"/>
    </xsl:matching-substring>
  </xsl:analyze-string>
</xsl:variable> 
```

所以现在如果我想打印每个值，我会使用类似的东西：

```
<xsl:value-of select="$vExtracted[1]"/><br/>
<xsl:value-of select="$vExtracted[2]"/><br/>
<xsl:value-of select="$vExtracted[3]"/><br/>
.
.
and so on which outputs like:
x
y
z 
```

我的问题是我如何才能遍历 $vExtracted 并打印所有值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T02:04:03.380

**使用**：

```
<xsl:for-each select="$vExtracted">
  <xsl:value-of select="."/><br/>
</xsl:for-each > 
```

# javascript - 原型继承和静态方法

> ID：12118107
> 
> 赞同：3
> 
> 时间：2012-08-25T00:05:46.180
> 
> 标签：javascript, static-methods, ecmascript-5, prototypal-inheritance

我正在尝试习惯 JavaScript (ECMAScript 5) 的“真正”原型继承，但不知何故，我的思绪似乎陷入了经典继承模式。

我想创建一个 Vector 对象，它执行简单的操作，例如加法、减法等。

现在有两种情况：

*   #1：将向量 B“添加到”向量 A（向量 A 被修改）
*   #2：将向量 B“添加到”向量 B（创建一个新的向量 C，它是 A 和 B 的总和）

在经典继承中，我会为场景 #1 创建一个实例方法，为案例 #2 创建一个静态方法，但原型继承中似乎没有静态函数。

那么，实现这两个场景的干净方法是什么？

这是我到目前为止所得到的：

```
var Vector = {

  x: 0,
  y: 0,
  z: 0,

  initialize: function(x,y,z) {
    this.x = x;
    this.y = y;
    this.z = z;
    return this;
  },

  add: function(vec) {
    this.x += vec.x;
    this.y += vec.y;
    this.z += vec.z;
    return this;  
  },

  print: function() {
    console.log('x:', this.x, 'y:', this.y, 'z:', this.z);
  }
};

var firstVector = Object.create(Vector).initialize(1,2,3);
var secondVector =  Object.create(Vector).initialize(4,5,6);

firstVector.print();  // Outputs: x:1, y:2, z:3
secondVector.print(); // Outputs: x:4, y:5, z:6

firstVector.add(secondVector); 
firstVector.print(); // Outputs: x:5,y:7,z:9

// What I'm looking for:

var thirdVector = Vector.add(firstVector, secondVector); 
```

感谢您的任何建议！

**Update**:

Here is my attempt to implement a static function using Paul's advice (thanks!):

```
var vectorPrototype = {
  hello: function() { console.log('hello I am the prototype'); }
};

var Vector = Object.create(vectorPrototype);

Vector.hello = function() { console.log('hello I am the static function'); };

Vector.init = function() {
  return Object.create(vectorPrototype);
}

var vec1 = Vector.init();

vec1.hello(); // says: 'hello I am the prototype'
Vector.hello(); // says: 'hello I am the static function' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T00:26:09.627

Your `Vector` object is really just the prototype. You can use it with the `Object.create` function to create your `Vector` base/sub class. Then stick your static properties on your newly created `Vector` class. See here: [http://jsfiddle.net/agYNc/1/](http://jsfiddle.net/agYNc/1/)

```
var vectorPrototype = {

  x: 0,
  y: 0,
  z: 0,

  initialize: function(x,y,z) {
    this.x = x;
    this.y = y;
    this.z = z;
    return this;
  },

  add: function(vec) {
    this.x += vec.x;
    this.y += vec.y;
    this.z += vec.z;
    return this;  
  },

  print: function() {
    console.log('x:', this.x, 'y:', this.y, 'z:', this.z);
  }
};

//create your base Vector type
var Vector = Object.create( vectorPrototype );

//Your static functions here
Vector.staticFunction = function ( vec1, vec2 ) {};

var firstVector = Object.create(Vector).initialize(1,2,3);
var secondVector =  Object.create(Vector).initialize(4,5,6);

firstVector.print();  // Outputs: x:1, y:2, z:3
secondVector.print(); // Outputs: x:4, y:5, z:6

firstVector.add(secondVector); 
firstVector.print(); // Outputs: x:5,y:7,z:9​ 
```

Here is a good example of using `Object.create` with inheritance, static and instance properties. [https://github.com/webadvanced/takeCommand/blob/master/src/takeCommand.module.js](https://github.com/webadvanced/takeCommand/blob/master/src/takeCommand.module.js)

# python - PyQt4 - 如何将不同的信号连接到同一个可调用对象，但能够区分信号的来源并采取相应的行动

> ID：12118108
> 
> 赞同：1
> 
> 时间：2012-08-25T00:06:05.107
> 
> 标签：python, pyqt4

对不起，标题是满嘴巴，但基本上我在这里要做的是我有3个按钮，它们都打开QFileDialog供用户选择要使用的文件。由于动作相同，我想对所有 3 个使用相同的功能，但根据按下的按钮，我需要更新不同的 QLineEdit 以反映 GUI 中的文件路径。我该如何实现呢？

```
 #Create the prompt for user to load in the q script to use
        self.qFileTF = QtGui.QLineEdit("Choose the q script file to use")
        self.qFileButton = QtGui.QPushButton("Open")
        self.qFileButton.setFixedSize(100,27)
        self.fileLayout1.addWidget(self.qFileTF)
        self.fileLayout1.addWidget(self.qFileButton)

        #Create the prompt for user to load in the light house file to use
        self.lhFileTF = QtGui.QLineEdit("Choose the light house file to use")
        self.lhButton = QtGui.QPushButton("Open")
        self.lhButton.setFixedSize(100,27)
        self.fileLayout2.addWidget(self.lhFileTF)
        self.fileLayout2.addWidget(self.lhButton)

        #Create the prompt for user to choose to reference an older version of q script
        self.oldQCB = QtGui.QCheckBox("Reference an older version Q script")
        self.oldQTF = QtGui.QLineEdit("Choose the q script file to use")
        self.oldQTF.setEnabled(False)
        self.oldQButton = QtGui.QPushButton("Open")
        self.oldQButton.setEnabled(False)
        self.oldQButton.setFixedSize(100,27)
        self.fileLayout3.addWidget(self.oldQTF)
        self.fileLayout3.addWidget(self.oldQButton) 

        self.connect(self.qFileButton, QtCore.SIGNAL("clicked()"), self.loadFile)
        self.connect(self.lhButton, QtCore.SIGNAL("clicked()"), self.loadFile)
        self.connect(self.oldQButton, QtCore.SIGNAL("clicked()"), self.loadFile)

    def loadFile(self):     
        selFile = QtGui.QFileDialog.getOpenFileName()           

        if self.qFileButton:
            self.qFileTF.setText(selFile)
        elif self.lhFileTF:
            self.lhFileTF.setText(selFile)
        else:
            self.oldQTF.setText(selFile) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T00:11:02.003

尝试使用以下`sender`方法：

```
def loadFile(self):
    selFile = QtGui.QFileDialog.getOpenFileName()
    if self.sender() == self.qFileButton:
        self.qFileTF.setText(selFile)
    elif self.sender() == self.lhFileTF:
        self.lhFileTF.setText(selFile)
    else:
        self.oldQTF.setText(selFile) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T02:37:46.830

您可以使用 lambda 函数（或[偏](http://docs.python.org/library/functools.html#functools.partial)函数）将`QLineEdit`to change 作为附加参数传递给插槽：

```
 def loadFile(lineEdit):
        return lambda: self.loadFile(lineEdit)

    self.qFileButton.clicked.connect(loadFile(self.qFileTF))
    self.lhButton.clicked.connect(loadFile(self.lhFileTF))
    self.oldQButton.clicked.connect(loadFile(self.oldQTF))

def loadFile(self, lineEdit):     
    selFile = QtGui.QFileDialog.getOpenFileName()           
    lineEdit.setText(selFile) 
```

# google-app-engine - GAE 同步生产和开发数据存储

> ID：12118109
> 
> 赞同：2
> 
> 时间：2012-08-25T00:06:14.173
> 
> 标签：google-app-engine, google-cloud-datastore, database-backups

我能够下载我的生产 GAE 数据存储的备份，但我无法将备份上传到我的开发应用程序。这是我的尝试：

从生产中下载商店，按预期工作：

```
appcfg.py download_data --application=s~myApp --url=http://myApp.appspot.com/_ah/remote_api --filename=backup1 
```

将备份上传到开发存储，失败：

```
appcfg.py upload_data --application=dev~myApp  --url=http://localhost:8080/_ah/remote_api --filename=backup1
Uploading data records.
[INFO    ] Logging to bulkloader-log-20120823.225047
[INFO    ] Throttling transfers:
[INFO    ] Bandwidth: 250000 bytes/second
[INFO    ] HTTP connections: 8/second
[INFO    ] Entities inserted/fetched/modified: 20/second
[INFO    ] Batch Size: 10
[INFO    ] Opening database: bulkloader-progress-20120823.225047.sql3
Please enter login credentials for localhost
Email: myemail@gmail.com
Password for myemail@gmail.com: 
[INFO    ] Connecting to localhost:8080/_ah/remote_api
[INFO    ] Starting import; maximum 10 entities per post
............................................................................................................................................................[INFO    ] Unexpected thread death: WorkerThread-5
[INFO    ] An error occurred. Shutting down...
.........[ERROR   ] Error in WorkerThread-5: <urlopen error [Errno 61] Connection refused>

[INFO    ] 2670 entities total, 0 previously transferred
[INFO    ] 1650 entities (1207416 bytes) transferred in 431.1 seconds
[INFO    ] Some entities not successfully transferred 
```

似乎错误 61 是一个端口错误。该应用程序正在运行，我已通过浏览器以管理员身份登录，并且我还输入了我的电子邮件/密码作为 CLI 命令的一部分。有些记录总是被上传，然后上传过程被切断。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:25:33.633

我一直发现将数据上传到本地数据存储更可靠，将线程数设置为 1。请记住，开发服务器本质上是单线程的。尝试使用`--num_threads=1`.

我还建议设置`--db_filename=DB_FILENAME`创建一个进度数据库，这意味着如果失败，您可以从它到达的位置重新启动。

在尝试编写大型实体时，我有时也不得不减少批量大小。

干杯

# html - 从 SVG 文件中提取路径的坐标

> ID：12118118
> 
> 赞同：6
> 
> 时间：2012-08-25T00:08:23.010
> 
> 标签：html, xml, xml-parsing, imagemap

我试图从 Adob​​e Illustrator 中的路径中找到精确坐标以在 HTML 图像映射中使用，有人建议我将路径保存为 SVG 文件，但是当我在记事本中打开 SVG 时，我得到以下信息：

```
<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
     width="300.96px" height="248.16px" viewBox="0 0 300.96 248.16" enable-background="new 0 0 300.96 248.16" xml:space="preserve">
<path fill-rule="evenodd" clip-rule="evenodd" fill="none" d="M81.6,152.64c7.519,0,15.041,0,22.56,0
    c-0.64,2.88-1.28,5.76-1.92,8.64c-0.16,2.4-0.32,4.8-0.48,7.2c-0.16,0-0.32,0-0.48,0c0,2.56,0,5.121,0,7.68
    c-0.659,2.333,0.264,6.49-0.48,9.12c-0.16,0-0.32,0-0.48,0c0,1.6,0,3.2,0,4.8c-0.16,0-0.32,0-0.48,0
    c-0.584,2.076,0.248,5.349,0.48,6.72c0,1.6,0,3.2,0,4.8c-0.16,0-0.32,0-0.48,0c-0.364,1.869,0.809,1.523,0.96,1.92
    c0.56,1.47-0.759,3.551-0.96,4.32c0.16,1.12,0.32,2.24,0.48,3.36c0.16,0,0.32,0,0.48,0c0.488,1.604-0.283,3.241-0.48,4.32
    c-0.96-0.16-1.92-0.32-2.88-0.48c-0.48,1.44-0.96,2.88-1.44,4.32c0,0.8,0,1.6,0,2.4c-0.16,0-0.32,0-0.48,0c0,1.12,0,2.24,0,3.36
    c-0.16,0-0.32,0-0.48,0c0,1.12,0,2.24,0,3.36c-0.16,0-0.32,0-0.48,0c0.16,2.24,0.32,4.48,0.48,6.72c-0.16,0-0.32,0-0.48,0
    c0,0.64,0,1.28,0,1.92c-0.16,0-0.32,0-0.48,0c0,0.32,0,0.64,0,0.96c-0.32,0.16-0.64,0.32-0.96,0.48c0,0.32,0,0.64,0,0.96
    c-0.32,0.16-0.64,0.32-0.96,0.48c-0.451,1.146,1.519,3.296,0,4.32c-0.32,0-0.64,0-0.96,0c-1.875,2.142-4.972,1.148-7.2,0.48
    c-2.72,0-5.44,0-8.16,0c-0.933-1.886-1.007-2.403-3.84-2.4c0-0.48,0-0.96,0-1.44c1.326-0.347,1.074-0.134,1.44-1.44
    c0.16,0,0.32,0,0.48,0c0-0.64,0-1.28,0-1.92c0.16,0,0.32,0,0.48,0c0.32-1.76,0.64-3.52,0.96-5.28c-0.48-0.16-0.96-0.32-1.44-0.48
    c-0.16-0.8-0.32-1.6-0.48-2.4c-1.045-0.202-1.367-0.318-1.92-0.96c1.975-1.655,1.015-4.196,1.92-6.72c2.88-0.64,5.76-1.28,8.64-1.92
    c0.633-2.939,2.051-6.325,2.88-9.12c0.455-1.531-0.247-3.995-0.48-4.8c-0.32-3.199-0.64-6.4-0.96-9.6c0-1.027,0.48-0.96,0.48-0.96
    c-0.16-5.6-0.32-11.201-0.48-16.8c0-2.879,0-5.76,0-8.64c-0.16,0-0.32,0-0.48,0c0-1.6,0-3.2,0-4.8c-0.16,0-0.32,0-0.48,0
    c0-1.76,0-3.52,0-5.28C81.954,157.702,81.619,155.542,81.6,152.64z"/>
</svg> 
```

有人能告诉我如何从这个 XML 数据中提取坐标，以便我可以将它们与 HTML 图像地图一起使用吗？我显然没有解析 XML 文件的经验，而且我不知道从哪里开始准备脚本。

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-22T14:38:14.987

好吧，关于 SVG，你首先要了解的是路径是如何组成的：

'd' 属性包含创建路径的规范。每个命令都以一个字母开头，匹配以下内容：

```
M = moveto
L = lineto
H = horizontal lineto
V = vertical lineto
C = curveto
S = smooth curveto
Q = quadratic Bézier curve
T = smooth quadratic Bézier curveto
A = elliptical Arc
Z = closepath 
```

您的路径有点复杂，因为它是由 Illustrator 生成的，无论如何 M81.6,152.64 是第一步，它告诉渲染器将光标定位在那里。

然后开始绘制：c7.519,0,15.041,0,22.56,0，意思是“曲线到”，这四个数字是生成三次贝塞尔曲线的值（你可以[在这里](http://en.wikipedia.org/wiki/B%C3%A9zier_curve)了解更多）。

你的路径中有很多曲线（“c”和四个数字），它以“z”结尾，这意味着“关闭路径”。

你能做什么？好吧，您可以解析路径标记的属性“d”，例如使用[xml javascript parser](http://www.hiteshagrawal.com/javascript/javascript-parsing-xml-in-javascript)（或者只是将文件的内容解析为字符串并搜索属性 d="" 的内容），并使用此字符串，您可以获得路径的原点。

如果你想显示你的路径，用 javascript 实时渲染它，你可以使用[raphael.js](http://raphaeljs.com/)。它需要像属性“d”这样的字符串来创建路径，正如您[在此处](http://raphaeljs.com/reference.html#Paper.path)看到的那样，也许使用 raphael 创建具有关联事件的对象比 HTML 图像映射更容易。

如果要提取绘图的每个点，SVG 路径不能以这种方式工作，您可以从 xml 中获取所有点的高度和宽度。我建议您将 raphael svg 路径与您的图像重叠。

# windows-8 - 扩展 Windows 8 消息中心

> ID：12118121
> 
> 赞同：5
> 
> 时间：2012-08-25T00:08:58.130
> 
> 标签：windows-8, instant-messaging

在 Windows 8 中，消息传递中心提供了一种通过 Windows Live Messenger 和 Facebook 协议发送消息的单一机制。

除了这些之外，是否有任何扩展点可用于添加其他协议/帐户，以便您可以插入自己的聊天协议？

如果可能的话，我想创建一个 Steam 聊天扩展，但我需要一个合适的点来从第一个扩展。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T00:51:38.203

否。目前没有任何扩展点可向消息传递中心添加功能。

# c++ - 多维数组，等效数组对象，带键字符串的向量

> ID：12118122
> 
> 赞同：0
> 
> 时间：2012-08-25T00:09:12.467
> 
> 标签：c++, multidimensional-array

我搜索了互联网但找不到任何相关内容，我需要执行以下操作，

仅示例说明：

```
int Main(){
    int i;
    string Key;
    myArray = Array(); //Blank
    char s[ 11 ] = { 'H', 'e', 'l', 'l', 'o', ' ', 'W', 'o', 'r', 'l', 'd', '!' };

    for(i=0;i<5;i++){//
        myArray.push("Key"+i, s[i]);//push(key,value) -- imaginary function
    }

    forEach(myArray as Key){// -- imaginary function
        cout << "Key: " << Key << " - Value: " << myArray[Key] << endl;
    }
} 
```

我需要我可以设置 ARRAY KEYS 特定的，因为这些键是控制数据源而不混合信息。

它不需要完全一样，但我需要的是我的最终结果以同样的方式。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T00:21:26.883

我认为您应该考虑使用地图容器，请看一下@这个示例，它与您要实现的目标非常相似。

[http://www.yolinux.com/TUTORIALS/CppStlMultiMap.html](http://www.yolinux.com/TUTORIALS/CppStlMultiMap.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T00:19:12.450

您是否考虑过使用[std::map](http://www.cplusplus.com/reference/stl/map/)？

```
std::map<std::string, char> myMap;

// Add an element to the map with key = "key1" and value = 'a'
myMap["key1"] = 'a';

// Access the element with key = "key1"
cout << mymap["key1"]; 
```

# wordpress - Dropbox 是如何创建登录页面的？

> ID：12118124
> 
> 赞同：0
> 
> 时间：2012-08-25T00:09:33.200
> 
> 标签：wordpress, video, embed, dropbox

我希望创建一个模拟 DropBox（在 wordpress 中）的登录页面。我想知道他们是如何实现单击覆盖背景框的播放按钮然后变成视频的效果的？

我从消息来源看到他们正在使用 JW 播放器，但再次不知道从哪里开始。有没有可以买到的皮肤？任何将我引向正确方向的想法都值得赞赏。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T02:50:55.383

可以使用 jquery 和 css 轻松完成。首先，将两个 div 绝对定位在页面中央，以便当可见时一个在另一个之上，然后将视频 div css 设置为“display:none;”。然后您可以使用 jquery 显示视频并在点击时隐藏播放按钮，如下所示：

```
$(function(){
    $('#play-btn').click(function(){
        $('#play-btn').hide();
        $('#video').show();
    });
}); 
```

简单地完成了mi amigo。请记住，它们不必居中，只需将它们定位在另一个之上......

# java - 使用 MouseListener Java 小程序拖动对象

> ID：12118125
> 
> 赞同：0
> 
> 时间：2012-08-25T00:09:44.423
> 
> 标签：java, applet, mouseevent

我正在尝试创建一个小程序，将一个圆圈（定义为一个对象）绘制到屏幕上，然后可以使用鼠标在屏幕上拖动这个圆圈。到目前为止，当按下鼠标时，对象被绘制并可以拖动，但我想要它做的是在小程序启动时绘制对象，然后允许用户单击对象并拖动它。任何帮助或线索将不胜感激。这是代码：

```
import java.applet.Applet;
import java.awt.*;
import java.awt.event.*;

public class sheepDog extends Applet implements ActionListener, MouseListener, MouseMotionListener
{
    manAndDog dog;
    int xposR;
    int yposR;

    public void init()
    {
        addMouseListener(this);
        addMouseMotionListener(this);

    }
    public void paint(Graphics g)
    {
        dog.display(g);

    }
    public void actionPerformed(ActionEvent ev)
    {}
    public void mousePressed(MouseEvent e)
    {

    }
    public void mouseReleased(MouseEvent e)
    {

    }
    public void mouseEntered(MouseEvent e)
    {}
    public void mouseExited(MouseEvent e)
    {}
    public void mouseMoved(MouseEvent e)
    {
    }
    public void mouseClicked(MouseEvent e)
    {}
    public void mouseDragged(MouseEvent e)
    {
        dog = new manAndDog(xposR, yposR);
        xposR = e.getX();
        yposR = e.getY();
        repaint();

    }
}

class manAndDog implements MouseListener, MouseMotionListener
{
    int xpos;
    int ypos;
    int circleWidth = 30;
    int circleHeight = 30;
    Boolean mouseClick;

    public manAndDog(int x, int y)
    {
        xpos = x;
        ypos = y;
        mouseClick = true;
        if (!mouseClick){
            xpos = 50;
            ypos = 50;
        }

    }

    public void display(Graphics g)
    {
        g.setColor(Color.blue);
        g.fillOval(xpos, ypos, circleWidth, circleHeight);
    }

    public void mousePressed(MouseEvent e)
    {
        mouseClick = true;
    }
    public void mouseReleased(MouseEvent e)
    {

    }
    public void mouseEntered(MouseEvent e)
    {}
    public void mouseExited(MouseEvent e)
    {}
    public void mouseMoved(MouseEvent e)
    {}
    public void mouseClicked(MouseEvent e)
    {}
    public void mouseDragged(MouseEvent e)
    {
        if (mouseClick){
            xpos = e.getX();
            ypos = e.getY();
        }

    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:15:46.640

最简单的方法是在您的方法中创建`ManAndDog`对象`init()`，例如：

```
dog = new ManAndDog(0, 0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T00:14:54.053

在`start`您的小程序的方法中，为对象分配一个位置`manAndDog`并调用`repaint`

Reimeus 更正确，该`init`方法是初始化 manAndDog 的更好地方。

希望你不介意一些反馈；）

1.  你应该调用`super.paint(g)`你的`paint`方法。事实上，我鼓励你使用`JApplet`和覆盖`paintComponent`，但这只是我
2.  我认为不需要不断地重新创建 manAndDog 对象。

例如。如果您添加了一个方法`setLocation`，您可以在拖动鼠标时简单地调用“setLocation”。

```
public void mouseDragged(MouseEvent e) {
    dog.setLocation(xposR, yposR);
    xposR = e.getX();
    yposR = e.getY();
    repaint();
} 
```

这更有效，因为它不会连续创建短寿命的对象。这也意味着您可以对`manAndDog`对象执行更多操作，例如应用动画。恕我直言

# python - Python 在使用 multiprocessing.pool.map() 调用的函数中增加一个数字

> ID：12118126
> 
> 赞同：3
> 
> 时间：2012-08-25T00:10:21.583
> 
> 标签：python, multithreading, multiprocessing

我试图在 multiprocessing.pool.map() 调用的函数中按顺序递增一个数字。当我运行以下代码时，我得到的数字增加了与每个数字的池相同的次数。

```
import time
import multiprocessing
import decimal
import random

lists = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h','i', 'j', 'k']
def thefunction(listi):
    global number
    number += 1
    time.sleep(decimal.Decimal(random.random()))
    print time.strftime('%H:%M:%S'), number, listi

number = 0
pool = multiprocessing.Pool(4)
pool.map(thefunction, lists)
print number 
```

结果像这样打印出来

```
01:01:28 1 b
01:01:28 2 e
01:01:28 1 a
01:01:28 1 c
01:01:28 1 d
01:01:28 2 h
01:01:29 2 i
01:01:29 2 g
01:01:29 3 f
01:01:29 3 j
01:01:29 3 k
0 
```

如何正确增加数字？

（time.sleep(decimal.Decimal(random.random())) 仅用于停止脚本打印到同一行）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T01:26:29.563

该示例不起作用的原因是正在分别创建和递增计数器的几个实例。

您需要创建一个共享计数器和锁，并为每个启动的进程适当地初始化：

```
import time
from multiprocessing import Pool, Value, Lock
import decimal
import random

number = Value('i', 0)
lock = Lock()
lists = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h','i', 'j', 'k']

def thefunction(listi):
    time.sleep(decimal.Decimal(random.random()))
    with lock:
        number.value += 1
        print time.strftime('%H:%M:%S'), number.value, listi

def initializer(*args):
    global number, lock
    number, lock = args

pool = Pool(4, initializer, (number, lock))
pool.map(thefunction, lists)
print number.value 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T00:38:06.903

您可能想要一个[`multiprocessing.Value`](http://docs.python.org/library/multiprocessing.html#multiprocessing.Value)共享状态。

或者更确切地说，这会满足您的*要求*，但可能不是您真正*想要*的；并行上下文中的共享状态通常是设计缺陷的标志。您可以做的一件事是让每个进程跟踪它已处理的项目数量，并将*该*计数返回给父进程；然后，父母可以合计每个人完成的工作数量，以理清到目前为止已经完成了多少工作。

您尝试跨流程边界计数的原因是什么？

# java - 在 weka 中添加一个新的实例

> ID：12118132
> 
> 赞同：8
> 
> 时间：2012-08-25T00:11:11.780
> 
> 标签：java, machine-learning, weka

如何将新实例添加到我创建的现有实例对象？

这是一个例子：

```
ArrayList<Attribute> atts = new ArrayList<Attribute>(2);
ArrayList<String> classVal = new ArrayList<String>();
classVal.add("A");
classVal.add("B");
atts.add(new Attribute("content",(ArrayList<String>)null));
atts.add(new Attribute("@@class@@",classVal));

Instances dataRaw = new Instances("TestInstances",atts,0); 
```

我想向 dataRaw 添加一个新实例。据我所知，我必须使用 dataRaw.add(Instance i) .... 如果 Instance 类是接口，我如何创建实例对象？

提前致谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-25T09:19:24.057

让我们从一些亮点开始。

*   weka 将每个实例值存储为 double[]。因此，您创建 double[] instanceValue1 并将值添加到此数组。
*   甚至字符串也存储在这个 double[] 中。您使用以下代码添加字符串值：

> instanceValue1[0] = dataRaw.attribute(0).addStringValue("这是一个字符串！");

*   Instance 是接口，它由两个类实现，{ SparseInstance , DenseInstance}。我们使用以下代码将值数组添加到数据集：

> dataRaw.add(new DenseInstance(1.0, instanceValue1));

这是完整的运行示例：

```
import java.util.ArrayList;

import weka.core.Attribute;
import weka.core.DenseInstance;
import weka.core.Instance;
import weka.core.Instances;

public class Program {
    public static void main(String[] args) {
        ArrayList<Attribute> atts = new ArrayList<Attribute>(2);
        ArrayList<String> classVal = new ArrayList<String>();
        classVal.add("A");
        classVal.add("B");
        atts.add(new Attribute("content",(ArrayList<String>)null));
        atts.add(new Attribute("@@class@@",classVal));

        Instances dataRaw = new Instances("TestInstances",atts,0);
        System.out.println("Before adding any instance");
        System.out.println("--------------------------");
        System.out.println(dataRaw);
        System.out.println("--------------------------");

        double[] instanceValue1 = new double[dataRaw.numAttributes()];

        instanceValue1[0] = dataRaw.attribute(0).addStringValue("This is a string!");
        instanceValue1[1] = 0;

        dataRaw.add(new DenseInstance(1.0, instanceValue1));

        System.out.println("After adding a instance");
        System.out.println("--------------------------");
        System.out.println(dataRaw);
        System.out.println("--------------------------");

        double[] instanceValue2 = new double[dataRaw.numAttributes()];

        instanceValue2[0] = dataRaw.attribute(0).addStringValue("This is second string!");
        instanceValue2[1] = 1;

        dataRaw.add(new DenseInstance(1.0, instanceValue2));

        System.out.println("After adding second instance");
        System.out.println("--------------------------");
        System.out.println(dataRaw);
        System.out.println("--------------------------");

    }

} 
```

它的输出如下：

```
Before adding any instance
--------------------------
@relation TestInstances

@attribute content string
@attribute @@class@@ {A,B}

@data

--------------------------
After adding a instance
--------------------------
@relation TestInstances

@attribute content string
@attribute @@class@@ {A,B}

@data
'This is a string!',A
--------------------------
After adding second instance
--------------------------
@relation TestInstances

@attribute content string
@attribute @@class@@ {A,B}

@data
'This is a string!',A
'This is second string!',B
-------------------------- 
```

# c++ - 共享库 QT 资源

> ID：12118133
> 
> 赞同：5
> 
> 时间：2012-08-25T00:11:17.677
> 
> 标签：c++, qt, resources, shared

我又遇到了另一个问题。这一次，我有一个 .dll，一个包含 .qrc（QT 资源）文件的共享库，问题是，当我尝试访问该库的某个资源时，它不起作用。我尝试实施：

```
Q_INIT_RESOURCE(resourcefilename) 
```

它仍然无法正常工作。（它说没有找到“qInitResources_resourcefilename（）”。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T00:44:19.943

没关系。我找到了解决方案。未找到 qInitResources_name()。所以，我在共享库中创建了一个函数

```
int RmiLib::startResources(){
    extern int qInitResources_rmi();
    return qInitResources_rmi();
} 
```

然后，在主应用程序上，我调用了该函数，耶！有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-29T12:21:53.053

我将假设您使用的是 Windows，因为您说您有一个 .dll

我刚刚遇到了同样的问题，即找不到函数 qInitResources_resourcefilename。如果您的库有 .qrc 文件（检查映射文件），则此函数确实存在于共享库中。问题是这个函数没有被导出，所以链接器在链接主应用程序时找不到它。我将函数 qInitResources_resourcefilename 添加到共享库的导出表中，如下所示。

将新文件添加到共享库 **export.def**

```
LIBRARY
EXPORTS
  qInitResources_resourcefilename 
```

将以下内容添加到您的共享库 .pro 文件中

```
QMAKE_LFLAGS += /DEF:\"$${PWD}\\export.def\"
OTHER_FILES += \
    export.def 
```

您的解决方案可以解决此问题，因为 RmiLib::startResources 包含在导出表中。

我正在使用 Windows 7、MSVC 2010、Qt 5.2.0

# jquery - 添加/删除 div 类

> ID：12118134
> 
> 赞同：3
> 
> 时间：2012-08-25T00:11:25.443
> 
> 标签：jquery, html, css

首先让我说我对这一切都很陌生，但我正在努力学习。话虽如此，我一直在绞尽脑汁想弄清楚如何使用按钮 id 添加/删除 div 类。任何帮助都将不胜感激，因为我要制作大约 200 个这样的文本框。附件是示例 html（用于带有论文主题的 wordpress）和我正在使用的 css。我还包含了一个指向 jsfiddle 的链接，这样你就可以看到我想要完成的事情（但失败了）。

[http://jsfiddle.net/EXPH77/rz683/](http://jsfiddle.net/EXPH77/rz683/)

CSS：

```
#the_box {
  font-family: Georgia, "Times New Roman", Times, serif;
  font-weight: 300;
  color: #oooooo;
  background-color: #ddddee;
  width: 320px;

}

.box_header {
  padding-top: .5em;
  font-weight: 600;
  color: #ffffff;
  background-color: #477ede;
  text-align: center;
  height: 25px;
  font-size:1.2em;

}

.box_text {
  text-align: left;
  padding: 1px;
  margin-bottom: 3px;
  font-size:0.84em;

}

.media {
  text-align: center;
  padding: 4px;
  margin-bottom: 3px;

}

.box_expand {
  text-align: left;
  padding: 1px;
  margin-bottom: 3px;
  font-size:0.84em;

}

p.headtext {
  color: #000000;
  font-weight: 600;
  margin-bottom: 3px;
  text-align: left;
  font-size:1.2em;

} 
```

HTML：

```
<div id="the_box">
<div class="box_header"> Exercise Title </div> 
<div class="media"> 
<iframe width="300" height="195" src="http://www.youtube.com/embed/Ok97QIq2f4E" frameborder="0" allowfullscreen></iframe> 
</div> 
<div class="box_text"> 
<p class="headtext">Muscles</p> 
<ul style="list-style: none; "> 
  <li><strong>Primary:</strong>&nbsp;&nbsp;MM</li> 
  <li><strong>Secondary:</strong>&nbsp;&nbsp;MM</li>
<button id="addClass">Instructions</button>
<script type="text/javascript">
    $("#addClass").click(function () {    
      $('#the_box').addClass('box_expand');
    $("#removeClass").click(function () {
      $('#the_box').removeClass('box_expand');
    });  
</script>
</div> <div class="box_expand"> 
<p class="headtext">Preparation</p> 
<ol> 
  <li>Instructions</li> 
  <li>Go</li> <li>Right</li> 
  <li>Here</li> 
</ol> 
<p class="headtext">Movement</p> 
<ol> 
  <li>Instructions</li> 
  <li>Go</li> 
  <li>Right</li> 
  <li>Here</li> 
</ol> 
<p class="headtext">Comments/Tips</p> 
<ul> 
  <li>Instructions</li> 
  <li>Go</li> 
  <li>Here</li> 
</ul> 
</div> 
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:25:46.800

首先是；调用 jQuery 库到 DOM 并在需要在 jQuery 上初始化函数时始终使用[**document.ready() 。**](http://api.jquery.com/ready/)

第二件事，你忘了用这个关闭第一次点击功能：`)};`

**编辑：**如果要显示和隐藏选择器；*[这是工作的jsFiddle。](http://jsfiddle.net/qaAfk/4/)*

**jQuery：**如果你想用动画来做这个，你可以使用`fadeOut() fadeIn()`方法。

```
$("#hide").click(function () {
    $('#the_box').fadeOut(300);
    //$('#the_box').hide();
});
$("#show").click(function () {
    $('#the_box').fadeIn(300);
    //$('#the_box').show();
}); 
```

**html:**

```
<div id="the_box"> The Box </div>
<button id="hide"> Hide </button>
<button id="show"> Show </button>​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T00:51:31.940

[.toggleClass()](http://api.jquery.com/toggleClass/)应该做。

```
$("#addClass").click(function () {$('#the_box').toggleClass('box_expand')}); 
```

[在这里演示](http://jsfiddle.net/eWHSJ/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T00:26:01.183

您可以使用 jquery 的 addClass("someClass") 和 removeClass("someclass")。你可以使用这样的东西：

```
$("#AddClass").click( $("#the_box").addClass("someClass") ); 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T00:26:01.870

需要注意的几件事：

*   您传入的第一个函数`.click()`缺少关闭`}`。这将导致 JS 失败。
*   在您的 JSfiddle 中，您没有选择 jQuery 作为库，因此您的 jQuery 将无法工作。
*   如果您尝试为整个事物设置动画，请查看 .animate() 或[.slideDown()](http://api.jquery.com/slideDown/) jQuery 方法。

坚持下去，你就快到了！

我简化了你的标记并在这里做了一个简单的例子：http: [//jsfiddle.net/ZyHSr/](http://jsfiddle.net/ZyHSr/)

希望能帮助到你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-25T00:33:07.530

正如其他人所说，您需要在原始侦听器函数中添加右大括号和括号。但是，我建议，如果您将来尝试调试类似的东西，请将您的脚本分解为您可以尝试找出的最小示例。

[http://jsfiddle.net/XrUmr/](http://jsfiddle.net/XrUmr/)

例如，要找出你遇到的错误，你真的只需要这个 html：

```
<div id="the_box"> Something </div>
<button id="addClass"> Instructions </button>
<button id="removeClass"> Remove class </button>​ 
```

而这个javascript：

```
 $("#addClass").click(function () {    
    $('#the_box').addClass('box_expand')
 });
 $("#removeClass").click(function () {
      $('#the_box').removeClass('box_expand');
 }); 
```

（使用一些 css 来区分添加和删除的类）。

此外，您应该尝试找到一个编辑器：

1.  自动添加缩进（因此您可以更轻松地判断您何时错过了开/关大括号等）
2.  语法高亮（再次，有助于查看此类问题）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-25T22:37:49.247

尽管已经选择了答案，但我只是想提出一个很好的说明和相当异想天开的方式来学习 Jquery [http://www.codecademy.com/tracks/jquery](http://www.codecademy.com/tracks/jquery)。

希望这有助于并祝您学习 Jquery 好运！

# php - aptana javascript 代码帮助（缺少一些代码帮助）

> ID：12118135
> 
> 赞同：2
> 
> 时间：2012-08-25T00:11:37.963
> 
> 标签：php, javascript, html, aptana

我目前正在 Aptana 3 IDE 上学习和使用 javascript。我喜欢 Aptana 的代码完成和模板功能，但我无法为我的 javascript 开发获得完整的代码帮助。例如，如果我有一个新的 Image 实例，例如

```
var imgSprite = new Image(); 
```

如果我通过说 imgSprite 来调用它，它不会向我建议代码建议：

```
imgSprite.addEventListener('load', loadImage, false); 
```

但它确实向我建议了代码建议，包括`imgSprite.src`

那么是否有任何扩展或插件可以安装以使所有这些代码辅助功能在我的 Aptana 3 IDE 中工作？或者您可以向我推荐其他嵌入了所有这些功能的 IDE？谢谢

# requirejs - 尽管文件正在加载，但仍需要给出“未加载”消息

> ID：12118136
> 
> 赞同：1
> 
> 时间：2012-08-25T00:11:41.623
> 
> 标签：requirejs, amd

我有一个定义如下的模块：

```
define(
    ['backbone', 'View/Sidebar', 'View/ControlBar'],
    function() {
        ...
    }
); 
```

在该模块中有一个名为 loadView 的方法，它分配一个变量，如下所示：

```
loadView: function(name, bootstrap_function, into) {
    var _class  = require('View/'+name);
    ...
} 
```

因此，我们可以看到这两个`View/Sidebar`和`View/ControlBar`都被定义调用（第一个参数）加载。当我使用时`require('Sidebar')`，我没有收到任何错误，但如果我使用，`require('ControlBar')`我确实得到了臭名昭著的：

```
Error: Module name "View/ControlBar" has not been loaded yet for context: _ 
```

( [http://requirejs.org/docs/errors.html#notloaded](http://requirejs.org/docs/errors.html#notloaded) )

我已经重新编写、复制和粘贴，验证了它是否已加载到 Firebug 等等，但我一生都无法弄清楚为什么我 100% 的时间都会收到此错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T15:31:33.007

我认为这与如何调用参数有关。我发现以下会引发错误

```
define(
    ['mymodule1', 'mymodule2'],
    function(mod1, mod2) {
        ...
        var x = require('mymodule2');
        ...
    }
); 
```

而以下没有：

```
define(
    ['mymodule1', 'mymodule2'],
    function() {
        ...
        var x = require('mymodule2');
        ...
    }
); 
```

区别在于加载的模块是否被声明为函数的参数。至少这在我看来是这样的，但是，它没有多大意义……

# php - 数组元素作为函数查看其他元素？

> ID：12118143
> 
> 赞同：-1
> 
> 时间：2012-08-25T00:13:26.967
> 
> 标签：php, arrays

我的英语不是很好，不确定标题，所以会尝试解释我需要做什么：

我正在制作日志解析器。我有 3 个包含相应元素的动态数组（从 .log 文件中读取）：

```
$personName //array of strings, can contain same name
$itemName   //array of strings, can contain same name
$itemAmount //array of numbers 
```

示例数组：

```
$personName = array("Adam", "Maria", "Adam", "Adam");
$itemName = array("paper", "paper", "pen", "paper");
$itemAmount = array(11, 25, 2, 64); 
```

我想对这些数组进行排序（按人和项目）和计数（按数量），例如。打印：

```
Total there are '100' 'paper' and '2' 'pen'.
'Adam' have '75' 'paper' and '2 'pen'.
'Maria' have '25' 'paper'. 
```

这将允许我获得每个人拥有的每个项目的百分比，例如：

```
'Adam' have '75'% of all 'paper' and '100'% of all 'pen'.
'Maria' have '25'% of all 'paper'. 
```

我有具有唯一名称的数组：

```
$persons = array_keys (array_flip ($personName));
$items = array_keys (array_flip ($itemName)); 
```

我确实尝试了 for 循环与 foreach 的不同组合，但我很难找到任何解决方案。
有人可以帮我找到正确的方法吗？
（对不起，如果这太基本了，我真的试图寻找解决方案，我对编程很陌生，3天前开始学习这个项目）
谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T00:34:46.017

像这样：

```
<?php
    $personName = array("Adam", "Maria", "Adam", "Adam", "Mihai");
    $itemName = array("paper", "paper", "pen", "paper", 'pencil');
    $itemAmount = array(11, 25, 2, 64, '18');

    $items = array();
    $persons = array();
    foreach($itemName as $id => $name){
        $items[$name] += $itemAmount[$id]; // we are adding amount for each item to $items array
        $persons[$personName[$id]][$name] += $itemAmount[$id]; // we are adding every item with amount to each persons
    }

    echo "Total there are "; // we are looping in each $items to display totals
    $i = 0;
    foreach($items as $nr => $item){

        echo "'".$item."' '".$nr."'";

        if($i < count($items)-2){ // this is for 'and' or ',' in case of multiple items
            echo ", ";
        } elseif($i < count($items)-1){
            echo " and ";
        }
        $i++;
    }

    echo '<br />';

    foreach($persons as $one => $value ){ // we are looping in each persons to display what they have
        echo "'".$one."' have ";
        $i = 0;
        foreach($value as $val => $number){

            echo "'".$number."' '".$val."'";

            if($i < count($value)-2){ // this is for 'and' or ',' in case of multiple items
                echo ", ";
            } elseif($i < count($value)-1){
                echo " and ";
            }

            $i++;
        }
        echo '.<br />';

    }

    // print_r($items); // will result in all items
    // print_r($persons); // will result in every person with every item

?> 
```

现在您可以管理`%`.

# php - 将一组子元素返回给 PHP 类？

> ID：12118150
> 
> 赞同：0
> 
> 时间：2012-08-25T00:15:44.410
> 
> 标签：php, object

假设我有一个像这样的课程：

```
class father {
    function __construct() {
        $msg = "Blah...\n";
        print $msg;
    }

    function doSomething() {
        $msg = get_class($this) . " does something...\n";
        print $msg;
    }
} 
```

还有一个像这样的子类：

```
class child extends father {
    function __construct() {
        $this->doSomething()
    }
} 
```

和：

```
class eldest extends father {
    function __construct() {
        $this->doSomething()
    }
} 
```

有没有办法返回父类的孩子*的当前实例的数组（在这种情况下是孩子和最年长的）？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:23:23.757

如果你的意思是让每个类都扩展`father`，你应该通过[反射遍历](http://us3.php.net/manual/en/class.reflectionclass.php)所有声明的类：

```
$subclasses = array();

foreach(get_declared_classes() as $class)
{

    $reflection = new ReflectionClass($class);  
    $reflection -> isSubClassOf('father') && $subclasses[] = $class;

}

var_dump($subclasses); 
```

并检查结果。

编辑：如果您需要了解有关*instances*的信息，请迭代`get_defined_vars()`- 但您为什么需要知道这一点？

# ssh - SSH 代理转发

> ID：12118152
> 
> 赞同：3
> 
> 时间：2012-08-25T00:16:00.670
> 
> 标签：ssh, github

我正在尝试在运行 Mountain Lion 的 MacBook Air 上设置代理转发。

在本地，我可以运行`ssh -T git@github.com`并成功连接到 github。

当我尝试 ssh 到我的服务器并运行`ssh -T git@github.com`时，它说权限被拒绝。

这里是`~/.ssh/config`

```
Host <my host>
  ForwardAgent yes 
```

的输出`ssh -v <my server>`

```
debug1: Reading configuration data /Users/tombleymaier/.ssh/config
debug1: /Users/tombleymaier/.ssh/config line 1: Applying options for <host>
debug1: Reading configuration data /etc/ssh_config
debug1: /etc/ssh_config line 20: Applying options for *
debug1: Connecting to <host> [<ip>] port 22.
debug1: Connection established. 
```

`/etc/ssh_config`（第 20+ 行）

```
 Host *
   SendEnv LANG LC_*
#   ForwardAgent no
#   ForwardX11 no
#   RhostsRSAAuthentication no
#   RSAAuthentication yes
#   PasswordAuthentication yes
#   HostbasedAuthentication no
#   GSSAPIAuthentication no
#   GSSAPIDelegateCredentials no
#   GSSAPIKeyExchange no
#   GSSAPITrustDNS no
#   BatchMode no
#   CheckHostIP yes
#   AddressFamily any
#   ConnectTimeout 0
#   StrictHostKeyChecking ask
#   IdentityFile ~/.ssh/identity
#   IdentityFile ~/.ssh/id_rsa
#   IdentityFile ~/.ssh/id_dsa
#   Port 22
#   Protocol 2,1
#   Cipher 3des
#   Ciphers aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-cbc,3des-cbc
#   MACs hmac-md5,hmac-sha1,umac-64@openssh.com,hmac-ripemd160
#   EscapeChar ~
#   Tunnel no
#   TunnelDevice any:any
#   PermitLocalCommand no
#   VisualHostKey no
#   ProxyCommand ssh -q -W %h:%p gateway.example.com 
```

我在另一台运行 Mountain Lion 的 MacBook 上进行了设置，没有问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T21:16:47.047

事实证明，每次重新启动时，都会从本地 ssh-agent 中删除身份。`ssh-add`必须使用`-k`命令运行：`ssh-add -K ~/.ssh/privateKey.txt`

来自：[SVN+SSH，不用每次都做 ssh-add 吗？（苹果系统）](https://stackoverflow.com/questions/1909651/svnssh-not-having-to-do-ssh-add-every-time-mac-os)

# firefox - 如何使用 Firebug 一次单击页面上的所有图像？

> ID：12118153
> 
> 赞同：0
> 
> 时间：2012-08-24T11:26:12.243
> 
> 标签：firefox, firebug, jquery, xpath

我有一个包含很多图像的页面，每个图像都包含一个 onclick 事件。例如：

```
<a onclick=javascript:xxx(y,z)><img id="myclass" src="yyy"></a> 
```

以下命令正确返回所有图像：

```
$x("//img") 
```

这不会（返回 null）：

```
$("img") 
```

我假设，因为这些 img 标签是动态创建的，所以不是直接在源代码中。

我的想法是在最后添加 .click() ，但不知何故它不起作用。

* * *

所以问题是：

如何模拟一次单击所有图像以触发所有关联的 javascript 函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T11:36:09.523

您不能`.click()`收集，因为它只是某些对象的容器，并且它没有来自内部对象的任何方法。您需要遍历每个对象并`.click()`单独调用：

```
for (var idx = document.images.length - 1; idx >= 0; idx--){ document.images[idx].click() } 
```

我刚刚在控制台中运行它并在侧边栏上打开了您的个人资料和广告。

# iphone - 获取从相机/照片库中获取的图像的名称

> ID：12118158
> 
> 赞同：0
> 
> 时间：2012-08-25T00:17:44.917
> 
> 标签：iphone, objective-c, xcode, cocoa-touch

我在获取从照片库或相机拍摄的图像名称时遇到问题。我已成功选择图像，但我想使用 MFMailComposeViewController 将选择的图像作为电子邮件附件发送。问题是 MFMailComposeViewController 需要图像的特定名称。我使用以下代码获取图像名称，它总是返回“assest.JPG”，这不适用于 MFMailComposeViewController

```
- (void) imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)image editingInfo:(NSDictionary *)editingInfo{
[imageView setImage:image];
image_ = image;
image_ = [UIImage imageNamed:@"file.jpg"];
NSURL *imagePath = [editingInfo objectForKey:@"UIImagePickerControllerReferenceURL"];
imageName = [imagePath lastPathComponent];

NSLog(@"%@",imageName);
[self dismissModalViewControllerAnimated:YES];
if (CAMORLIB == 1) {
    UIImageWriteToSavedPhotosAlbum(image, self, @selector(image:didFinishSavingWithError:contextInfo:), nil);
}} 
```

有没有其他方法来处理这个问题？

谢谢，

穆罕默德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T01:24:57.393

你的代码在这里：

```
image_ = image;
image_ = [UIImage imageNamed:@"file.jpg"]; 
```

没有意义，因为它分配了`image_`两次。该`UIImage`方法`-imageNamed:(NSString*)name`尝试加载`file.jpg`从磁盘命名的文件。

你`MFMailComposeViewController`不工作的原因是上面的代码导致因为`image_`没有找到一个名为那个的文件（并且结果返回）`nil``[UIImage imageNamed:@"filename"]``nil`

## 附加到邮件

将图像附加到 MFMailComposeViewController 时，您告诉它您希望图像具有的文件名以及图像的数据：

```
NSData* myData = UIImageJPEGRepresentation(image, .70f);
[picker addAttachmentData:myData mimeType:@"image/jpg" fileName:@"desiredfilename.jpg"]; 
```

在这里，`image`是 a`UIImage`并且`@"desiredfilename.jpg"`是您希望图像在电子邮件中显示的文件名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T01:53:21.333

从资产库中提取图像只会为您提供项目的 guid url。

资产库中没有真正的名称结构。照片库有一些属性，但它们如下

```
ALAssetPropertyType
ALAssetPropertyLocation
ALAssetPropertyDuration
ALAssetPropertyOrientation
ALAssetPropertyDate 
```

所有这些都可以在`AssetsLibrary.framework\ALAsset.h`

为了给我从那里收集的图像命名，我通常把

```
[NSString stringWithFormat:"Image%@.png",imageNumber] 
```

当我添加图像时，图像编号会增加。

希望有帮助

# wordpress - 获取 wordpress 小部件/菜单功能

> ID：12118160
> 
> 赞同：0
> 
> 时间：2012-08-25T00:18:18.723
> 
> 标签：wordpress, function, menu, widget, admin

我正在查看 codex，但找不到从中获取小部件和选项的功能。我想要菜单创建和操作的相同功能。

是否有任何函数可以获取这些值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T00:29:50.823

所有[Widget API](http://codex.wordpress.org/Widgets_API)都可以在 Wordpress Codex 中找到。

以下api对您有用。

*   [wp_get_sidebars_widgets](http://codex.wordpress.org/Function_Reference/wp_get_sidebars_widgets)
*   [获取选项](http://codex.wordpress.org/Function_Reference/get_option)

与SO 相比，在[http://wordpress.stackexchange.com](http://wordpress.stackexchange.com)上遇到特定的法典问题时，您将获得更好的运气。

# android - 从 Activity 或 Fragment 访问 mainThread 中的成员

> ID：12118161
> 
> 赞同：0
> 
> 时间：2012-08-25T00:18:35.493
> 
> 标签：android, android-layout, android-fragments

我有一个名为 MainGamePanel 的类，它扩展了 SurfaceView，我在其中运行一个线程来处理我的更新和绘图代码。然后我有一个运行 editor.xml 文件的活动，该文件包含一个相对布局，它运行我的 MainGamePanel 和一个 FrameLayout，我用它作为容器来保存片段。所以我让 MainGamePanel 占据了屏幕的 2/3，而片段在右侧，占据了屏幕的剩余 1/3。

该片段包含一个按钮，我想用它来重置位于我的 MainGamePanel 中的对象。如何从我的片段访问 MainGamePanel 的成员，反之亦然？

这是我检查按钮单击的片段的代码

```
Button button = (Button) view.findViewById(R.id.resetGrid_button);

// A simple OnClickListener for our button. You can see here how a Fragment can encapsulate
// logic and views to build out re-usable Activity components.
button.setOnClickListener(new OnClickListener() 
{
    public void onClick(View v)
    {
        Activity activity = getActivity();

        if (activity != null) 
            Toast.makeText(activity, R.string.reset_button, Toast.LENGTH_LONG).show();

    }

}); 
```

我想让它重置位于我的 MainGamePanel surfaceView 类中的一些对象，而不是仅仅做祝酒词。感谢您抽出宝贵的时间以及您可以发送给我的任何信息。

回答：我发现我必须在我的活动中处理我的视图并让活动访问信息。然后当用户单击我的片段中的按钮时，我让活动知道并更新信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T10:07:16.333

你需要创建一个接口来在Activity和Fragment之间进行通信，

按照这个例子 - [http://developer.android.com/training/basics/fragments/communicating.html](http://developer.android.com/training/basics/fragments/communicating.html)

一旦您的 Activity 知道按下的按钮，您应该在您的自定义类中调用一个公共方法，该方法将处理所需的逻辑。

# python - 如何以编程方式确定 Dropbox 文件夹位置？

> ID：12118162
> 
> 赞同：20
> 
> 时间：2012-08-25T00:18:35.837
> 
> 标签：python, directory, dropbox

我有一个旨在由多个用户在多台计算机上运行的脚本，他们的 Dropbox 文件夹并不都在各自的主目录中。我不想在脚本中硬编码路径。我宁愿以编程方式找出路径。

欢迎任何建议。

编辑：我没有在脚本中使用 Dropbox API，脚本只是读取用户之间共享的特定 Dropbox 文件夹中的文件。我唯一需要的是 Dropbox 文件夹的路径，因为我当然已经知道 Dropbox 文件结构中的相对路径。

编辑：如果重要的话，我使用的是 Windows 7。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-25T00:54:23.467

[我在这里](https://stackoverflow.com/questions/9660280/how-do-i-programmatically-locate-my-dropbox-folder-using-c?rq=1)找到了答案。设置`s`等于第 2 行，`~\AppData\Roaming\Dropbox\host.db`然后用 base64 解码它给出了路径。

```
def _get_appdata_path():
    import ctypes
    from ctypes import wintypes, windll
    CSIDL_APPDATA = 26
    _SHGetFolderPath = windll.shell32.SHGetFolderPathW
    _SHGetFolderPath.argtypes = [wintypes.HWND,
                                 ctypes.c_int,
                                 wintypes.HANDLE,
                                 wintypes.DWORD,
                                 wintypes.LPCWSTR]
    path_buf = wintypes.create_unicode_buffer(wintypes.MAX_PATH)
    result = _SHGetFolderPath(0, CSIDL_APPDATA, 0, 0, path_buf)
    return path_buf.value

def dropbox_home():
    from platform import system
    import base64
    import os.path
    _system = system()
    if _system in ('Windows', 'cli'):
        host_db_path = os.path.join(_get_appdata_path(),
                                    'Dropbox',
                                    'host.db')
    elif _system in ('Linux', 'Darwin'):
        host_db_path = os.path.expanduser('~'
                                          '/.dropbox'
                                          '/host.db')
    else:
        raise RuntimeError('Unknown system={}'
                           .format(_system))
    if not os.path.exists(host_db_path):
        raise RuntimeError("Config path={} doesn't exists"
                           .format(host_db_path))
    with open(host_db_path, 'r') as f:
        data = f.read().split()

    return base64.b64decode(data[1]) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-03-20T14:27:32.673

Dropbox 帮助中心对此有答案 -[如何以编程方式查找 Dropbox 文件夹路径？](https://www.dropbox.com/help/4584)

## 简洁版本：

使用`~/.dropbox/info.json`或`%APPDATA%\Dropbox\info.json`

## 长版：

以这种方式访问​​有效`%APPDATA%`或`%LOCALAPPDATA%`位置：

```
import os
from pathlib import Path
import json

try:
    json_path = (Path(os.getenv('LOCALAPPDATA'))/'Dropbox'/'info.json').resolve()
except FileNotFoundError:
    json_path = (Path(os.getenv('APPDATA'))/'Dropbox'/'info.json').resolve()

with open(str(json_path)) as f:
    j = json.load(f)

personal_dbox_path = Path(j['personal']['path'])
business_dbox_path = Path(j['business']['path']) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T00:43:32.263

您可以使用搜索文件系统`os.walk`。*Dropbox*文件夹可能位于用户的主目录中，因此为了节省一些时间，您可以将搜索限制在此范围内。例子：

```
import os
dropbox_folder = None

for dirname, dirnames, filenames in os.walk(os.path.expanduser('~')):
    for subdirname in dirnames:
        if(subdirname == 'Dropbox'):
            dropbox_folder = os.path.join(dirname, subdirname)
            break
    if dropbox_folder:
        break

# dropbox_folder now contains the full path to the Dropbox folder, or
# None if the folder wasn't found 
```

* * *

或者，您可以提示用户输入 Dropbox 文件夹位置，或通过配置文件对其进行配置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-25T00:17:51.103

这种基于[JF Sebastian](https://stackoverflow.com/users/4279/j-f-sebastian)建议的改编适用于我在 Ubuntu 上：

```
os.path.expanduser('~/Dropbox') 
```

并实际设置工作目录：

```
os.chdir(os.path.expanduser('~/Dropbox')) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-16T00:31:18.240

注意：*答案适用于 Dropbox v2.8 及更高版本*

**视窗**

```
jq -r ".personal.path" < %APPDATA%\Dropbox\info.json 
```

这需要安装[jq](https://stedolan.github.io/jq/download/) - JSON 解析器实用程序。如果您是 Chocolatey 包管理器的满意用户，请先运行`choco install jq`。

**Linux**

```
jq -r ".personal.path" < ~/.dropbox/info.json 
```

就像 Windows使用发行版的包管理器安装[jq一样。](https://stedolan.github.io/jq/download/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-02-11T16:21:59.397

注意：需要 Dropbox >= 2.8

[Dropbox 现在将路径以 json 格式存储在一个名为`info.json`](https://www.dropbox.com/en/help/4584). 它位于以下两个位置之一：

```
%APPDATA%\Dropbox\info.json
%LOCALAPPDATA%\Dropbox\info.json 
```

我可以通过 访问`%APPDATA%`Python 中的环境变量`os.environ['APPDATA']`，但是我同时检查了 和`os.environ['LOCALAPPDATA']`。然后我将 JSON 转换为字典并读取`'path'`相应 Dropbox（企业或个人）下的值。

下面代码调用`get_dropbox_location()`会返回企业Dropbox的文件路径，同时`get_dropbox_location('personal')`会返回个人Dropbox的文件路径。

```
import os
import json

def get_dropbox_location(account_type='business'):
    """
    Returns a string of the filepath of the Dropbox for this user

    :param account_type: str, 'business' or 'personal'
    """
    info_path = _get_dropbox_info_path()
    info_dict = _get_dictionary_from_path_to_json(info_path)
    return _get_dropbox_path_from_dictionary(info_dict, account_type)

def _get_dropbox_info_path():
    """
    Returns filepath of Dropbox file info.json
    """
    path = _create_dropox_info_path('APPDATA')
    if path:
        return path
    return _create_dropox_info_path('LOCALAPPDATA')

def _create_dropox_info_path(appdata_str):
    r"""
    Looks up the environment variable given by appdata_str and combines with \Dropbox\info.json

    Then checks if the info.json exists at that path, and if so returns the filepath, otherwise
    returns False
    """
    path = os.path.join(os.environ[appdata_str], r'Dropbox\info.json')
    if os.path.exists(path):
        return path
    return False

def _get_dictionary_from_path_to_json(info_path):
    """
    Loads a json file and returns as a dictionary
    """
    with open(info_path, 'r') as f:
        text = f.read()

    return json.loads(text)

def _get_dropbox_path_from_dictionary(info_dict, account_type):
    """
    Returns the 'path' value under the account_type dictionary within the main dictionary
    """
    return info_dict[account_type]['path'] 
```

这是一个纯 Python 解决方案，与其他使用`info.json`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-25T00:45:52.597

一种选择是您可以搜索`.dropbox.cache`目录（至少在 Mac 和 Linux 上）是 Dropbox 目录中的隐藏文件夹。

我相当肯定 Dropbox 将其首选项存储在一个加密`.dbx`容器中，因此使用 Dropbox 使用的相同方法提取它并非易事。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-13T23:17:46.977

这应该适用于Win7。使用`getEnvironmentVariable("APPDATA")`代替`os.getenv('APPDATA')`支持 Unicode 文件路径 - 请参阅题为“ [python appdata environvent 变量中的变音符号](https://stackoverflow.com/questions/2608200/problems-with-umlauts-in-python-appdata-environvent-variable)问题”的问题。

```
import base64
import ctypes
import os

def getEnvironmentVariable(name):
    """ read windows native unicode environment variables """
    # (could just use os.environ dict in Python 3)
    name = unicode(name) # make sure string argument is unicode
    n = ctypes.windll.kernel32.GetEnvironmentVariableW(name, None, 0)
    if not n:
        return None
    else:
        buf = ctypes.create_unicode_buffer(u'\0'*n)
        ctypes.windll.kernel32.GetEnvironmentVariableW(name, buf, n)
        return buf.value

def getDropboxRoot():
    # find the path for Dropbox's root watch folder from its sqlite host.db database.
    # Dropbox stores its databases under the currently logged in user's %APPDATA% path.
    # If you have installed multiple instances of dropbox under the same login this only finds the 1st one.
    # Dropbox stores its databases under the currently logged in user's %APPDATA% path.
    # usually "C:\Documents and Settings\<login_account>\Application Data"
    sConfigFile = os.path.join(getEnvironmentVariable("APPDATA"),
                               'Dropbox', 'host.db')

    # return null string if can't find or work database file.
    if not os.path.exists(sConfigFile):
        return None

    # Dropbox Watch Folder Location is base64 encoded as the last line of the host.db file.
    with open(sConfigFile) as dbxfile:
        for sLine in dbxfile:
            pass

    # decode last line, path to dropbox watch folder with no trailing slash.
    return base64.b64decode(sLine)

if __name__ == '__main__':
    print getDropboxRoot() 
```

# iphone - NSRegularExpression 搜索未知值

> ID：12118163
> 
> 赞同：0
> 
> 时间：2012-08-25T00:18:55.027
> 
> 标签：iphone, ios, regex

所以我正在开发一个 iPhone 应用程序，它拍摄一些文本的图片，图片被 OCR 处理并发送回给我，然后我使用正则表达式在字符串中搜索最多为 xxxx.xx 的双值.

```
NSRegularExpression *regex = [NSRegularExpression
                              regularExpressionWithPattern:@"\\d?\\d?\\d?\\d?\\.\\d?\\d?"
                              options:0
                              error:&error];

NSRange range   = [regex rangeOfFirstMatchInString:result
                                           options:0
                                             range:NSMakeRange(0, [result length])];

if([result length] > 0)
{
    NSString *subString = [result substringWithRange:range];

    double r = [subString doubleValue]; 
```

现在它正在按我的意愿工作，但它只得到第一个数字。双打的数量可能不确定，我需要得到最大的一个。最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:37:26.463

使用 matchesInString:options:range: 代替 rangeOfFirstMatchInString。这将为您提供一个 NSTextCheckingResult 对象数组，您可以从中提取范围。

```
NSRegularExpression *regex = [NSRegularExpression
                                   regularExpressionWithPattern:@"\\d?\\d?\\d?\\d?\\.\\d?\\d?"
                                   options:0
                                   error:&error];
    NSArray *arr = [regex matchesInString:string options:NSMatchingReportCompletion range:NSMakeRange(0,string.length)];
    for (NSTextCheckingResult *obj in arr) {
        double r = [[string substringWithRange:obj.range] doubleValue];
        NSLog(@"%f",r);
    } 
```

# python - 组合字符串格式

> ID：12118164
> 
> 赞同：2
> 
> 时间：2012-08-25T00:18:57.463
> 
> 标签：python, string, format

我正在尝试用来`.format()`格式化我的输出。我正在尝试将浮动对齐以居中，占据 12 的宽度并且只显示 2 个小数点。

我已经让它居中并占据 12 的宽度，如下所示：

`print "{:^12}".format(dig)`

但是，如何将两位小数格式添加到其中？我知道它是`.2f`，但我如何将它们结合起来？我尝试在 12 之后、之前`:`和各种地方添加它——它总是会抛出一个错误。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T00:22:07.383

只需使用`12.2f`：

```
>>> print "|{:^12.2f}|".format(145.6798)
|   145.68   | 
```

仅用于`|`证明`12`宽度有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T00:22:03.133

这是[格式规范](http://docs.python.org/library/string.html#formatspec)的文档：

```
dig = 22/7.0   # 3.142857142857143

print "->123456789012<-"
print "->{:^12.2f}<-".format(dig)   # using .2f as you expected
              ^^^ 
```

会给你

```
->123456789012<-
->    3.14    <- 
```

# php - 在 PHP 中防止 CSRF 攻击的最佳方法

> ID：12118170
> 
> 赞同：1
> 
> 时间：2012-08-25T00:21:30.033
> 
> 标签：php, security, csrf

什么是保护`CSRF`PHP 再次攻击的最佳方法。

建议使用表单标记，因此基本上生成一个随机值并将其存储在隐藏字段中。然后还将这个随机值存储在用户会话中。

最后在表单操作中，确保会话和表单令牌匹配。

```
if($_SESSION['token'] !== $_POST['token']) {
   die("bad... spanking...");
} 
```

有没有更好/更简单的方法，因为这需要在我的应用程序中进行大量代码修改（大量表单和操作）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T00:24:12.313

不可以。为了防止 CSRF，您需要确保仅在您有理由相信用户实际提交了您的表单时才信任自动附加到请求（如 cookie）的凭据。做到这一点的唯一方法是让表单携带服务器用来授权处理的某种秘密。

如果您使用框架或库来编写表单，它可能会通过生成随机数、设置 cookie 或会话属性以及将隐藏输入添加到表单来有所帮助，但这三个步骤确实需要进行。

# android - Android 蓝牙获取绑定设备

> ID：12118171
> 
> 赞同：0
> 
> 时间：2012-08-25T00:21:43.247
> 
> 标签：android, textview, android-arrayadapter

我不知道如何通过此代码将绑定的设备列入列表：

```
bt_scan.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            Set<BluetoothDevice> pairedDevices = mBluetoothAdapter.getBondedDevices();
            // If there are paired devices
            if (pairedDevices.size() > 0) {
                // Loop through paired devices
                for (BluetoothDevice device : pairedDevices) {
                    // Add the name and address to an array adapter to show in a ListView
                    mArrayAdapter.add(device.getName() + "\n" + device.getAddress());
                }
            }

                                                        }});} 
```

我不知道如何在文本视图或列表视图中获得相同的布局，或者如果可能的话，甚至在另一种布局中。我想与其中一个找到的设备建立联系，但那是另一回事了。

（如果有帮助，这是我的完整代码：http: [//pastie.org/4582924](http://pastie.org/4582924)）

非常感谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T00:57:02.373

查看 Android SDK 中提供的蓝牙聊天应用程序，它提供了一种清晰的方式来显示您当前配对的手机。

它还提供了一个 BluetoothChatService 类，您可以轻松地调整它以连接找到的设备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T02:36:09.973

是的，我同意 Vishwa，蓝牙聊天应用程序非常有帮助，我已经做了同样的（和你的一样）开发，这是我的代码，

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <TextView android:id="@+id/title_new_devices"
        android:layout_width="fill_parent" android:layout_height="wrap_content"
        android:background="#666" android:textColor="#fff"
        android:paddingLeft="5dp" />
    <ListView android:id="@+id/new_devices" android:layout_width="fill_parent"
        android:layout_height="wrap_content" />
</LinearLayout> 
```

活动课

```
private static BluetoothAdapter mBtAdapter;
private static ArrayAdapter<String> mNewDevicesArrayAdapter;

private static ArrayList<String> nameList = null;
private static ArrayList<String> macList = null;

private static ListView newDevicesListView = null;

        // Register for broadcasts when a device is discovered
        IntentFilter filter = new IntentFilter(BluetoothDevice.ACTION_FOUND);
        this.registerReceiver(mReceiver, filter);

        // Register for broadcasts when discovery has finished
        filter = new IntentFilter(BluetoothAdapter.ACTION_DISCOVERY_FINISHED);
        this.registerReceiver(mReceiver, filter);

        filter = new IntentFilter( BluetoothAdapter.ACTION_DISCOVERY_STARTED );
        this.registerReceiver( mReceiver, filter );

        // Get the local Bluetooth adapter
        mBtAdapter = BluetoothAdapter.getDefaultAdapter(); 
```

广播接收器类

```
 private final BroadcastReceiver mReceiver = new BroadcastReceiver() 
    {
        @Override
        public void onReceive(Context context, Intent intent) 
        {
            try
            {
                String action = intent.getAction();

                // When discovery finds a device
                if ( BluetoothDevice.ACTION_FOUND.equals(action) ) 
                {
                    // Get the BluetoothDevice object from the Intent
                    BluetoothDevice device = intent.getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);

                    String deviceName = device.getName();
                    String deviceAddress = device.getAddress();

                    if ( !nameList.contains( deviceName.trim() + " " + deviceAddress.trim() ) )
                    {
                        nameList.add( deviceName.trim() + " " + deviceAddress.trim() );
                        macList.add( deviceAddress.trim() + "&" + ConstantCodes.TIME + ConstantCodes.EQUALS + DateUtility.getDateTime() );
                    }

//                  System.out.println ( device.getName() );
                    mNewDevicesArrayAdapter.notifyDataSetChanged();
                } 
                else if (BluetoothAdapter.ACTION_DISCOVERY_FINISHED.equals(action)) 
                {
                    mNewDevicesArrayAdapter.notifyDataSetChanged();
                }
                else if ( BluetoothAdapter.ACTION_DISCOVERY_STARTED.equals( action ) )
                {
//                  nameList.clear();
                }
            }
            catch ( Exception e )
            {
                System.out.println ( "Broadcast Error : " + e.toString() );
            }
        }
    }; 
```

该代码将搜索活动的蓝牙设备并将其显示在 listView 中。

# c++ - 指针周围的括号是什么意思

> ID：12118172
> 
> 赞同：1
> 
> 时间：2012-08-25T00:21:49.043
> 
> 标签：c++, pointers

研究一些资料我经常来看这个：（部分真实资料）

```
void CUserMng::AddText( LPCTSTR szMessage )
{
    map<u_long,CUser*>::iterator it;
    for( it = m_users.begin(); it != m_users.end(); ++it )
    {
        CUser *pUser = it->second;
        if( !IsValidObj( pUser ) )
            continue;

            (pUser)->AddTextNotice( szMessage );
    }
} 
```

周围的括号是什么`pUser`意思？

我想出了：

```
struct bar
{
    int value;
}

void foo()
{
    bar *ptr = NULL; //new bar;
    (ptr)->value = 1;
    //delete bar
} 
```

我的猜测是，带括号“ `(ptr)`”的调用是为了防止在指针无效时进行调用，但似乎不是。我经常看到的另一个例子是：

```
classB* ptr = new classB;
((classA*)ptr)->callfunctionfromclassA; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T00:33:24.030

在第一个示例中，括号没有做任何事情。

在第二种情况下，它们是必需的，因为如果省略它们，则表达式的含义会发生变化。通过`->`运算符选择成员的[优先级](http://en.cppreference.com/w/cpp/language/operator_precedence)高于类型转换。所以，如果你要写

```
(classA*)ptr->callfunctionfromclassA(); 
```

这意味着您将`ptr->callfunctionfromclassA()`调用的返回值转换为 a `classA *`。如示例中所写，您首先转换`ptr`为`classA *`type 然后调用`callfunctionfromclassA`;

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T00:24:35.050

第一个示例中的括号什么也不做。

在第二个示例中，parens 在取消引用之前强制转换指针。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-25T00:40:57.257

> 周围的括号是什么`pUser`意思？

这意味着编写该代码的人不知道他在做什么。

> 我经常看到的另一个例子是：
> 
> ```
> classB* ptr = new classB;
> ((classA*)ptr)->callfunctionfromclassA; 
> ```

这意味着无论谁写的仍然是*用 Classes 编写 C*，这种语言现在应该已经死了 15 年。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T00:25:18.730

在第一种情况下，括号是多余的。它们可能是重构或样式偏好的结果。

在第二种情况下，这意味着`classA*`在取消引用之前将 ptr 强制转换为 a 。如果没有括号，您必须知道运算符的优先级才能知道发生了什么，因此代码更清晰、更安全。

# ruby-on-rails - heroku db:push 点击了错误的红宝石

> ID：12118173
> 
> 赞同：1
> 
> 时间：2012-08-25T00:21:55.430
> 
> 标签：ruby-on-rails, heroku

我正在使用 OSX Mountain Lion 并尝试 db:push。

```
$ ruby -v
ruby 1.9.2p320 (2012-04-20 revision 35421) [x86_64-darwin12.0.0]
$ bundle exec heroku db:push --confirm ancient-falls-9918
Loaded Taps v0.3.24
Auto-detected local database: mysql2://root@127.0.0.1/lottery_portal_development?encoding=utf8
Warning: Data in the app 'ancient-falls-9918' will be overwritten and will not be recoverable.
/Users/psmy/.rvm/gems/ruby-1.9.2-p320@lpr31/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle: [BUG] Segmentation fault
ruby 1.8.7 (2012-02-08 patchlevel 358) [universal-darwin12.0]

Abort trap: 6 
```

为什么要尝试使用 1.8.7？

```
$ rvm list

rvm rubies

ree-1.8.7-2011.03 [ i686 ]
=* ruby-1.9.2-p320 [ x86_64 ]
ruby-1.9.3-p194 [ x86_64 ] 
```

我已经在项目和全局级别卸载并重新安装了 heroku 和水龙头。我已经删除了 ruby​​ 内置版本的任何痕迹（我认为）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T02:40:36.237

*免责声明：这可能会或可能不会破坏东西。这就是我为解决问题所做的。*

试试这个[解决方案。](http://josediazgonzalez.com/2012/07/25/upgrading-from-lion-to-mountain-lion/)

卸载 RVM：

```
rvm implode
sudo rm -r ~/.rvm 
```

安装 rbenv

```
brew update
brew install rbenv
brew install ruby-build
rbenv install 1.9.3-p194
rbenv global 1.9.3-p194 
```

将此添加到您的 ~/.bash_profile 或 ~/.zshrc

```
eval "$(rbenv init -)" 
```

安装捆绑器

```
sudo gem install bundler 
```

安装宝石

```
bundle install 
```

重新安装[Heroku Toolbelt](https://toolbelt.heroku.com/)

关闭所有终端窗口并重新打开它们。我做了所有这些，db:pull 又开始工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-20T16:49:47.813

因为您尝试使用`bundle exec heroku`. 改为使用`heroku`，应该可以解决它。

如果您想将 Heroku CLI 使用的 Ruby 设置为您使用 RVM 指定的 Ruby，请在此处查看我的答案：[https ://stackoverflow.com/a/28632883/380607](https://stackoverflow.com/a/28632883/380607)

# ruby-on-rails - 在 Grails 中是否提供 Rails 样式的链式查询？

> ID：12118174
> 
> 赞同：2
> 
> 时间：2012-08-25T00:21:56.050
> 
> 标签：ruby-on-rails, grails, groovy, grails-orm, chaining

我正在一个新的 Grails 2.1.0 应用程序中编写调度功能。我正在从 Ruby on Rails 项目过渡，我的大部分查询策略都源自 Rails 风格。我有以下域类：

时间表.groovy

```
class Schedule {

    // Number of minutes between available appointment slots
    int defaultAppointmentInterval
    Time officeOpenStart
    Time officeOpenEnd
    Time lunchStart
    Time lunchEnd

    static hasMany = [inventorySlots: InventorySlot]

    static constraints = {
       // long validation rules
    }

    def boolean isAvailableAt(Date dateTime) {
        def isAvailable = true
        if (inventorySlots.isEmpty()) {
            isAvailable = false
        } else if (inventorySlotsSurroundingTime(dateTime).isEmpty()) {
            isAvailable = false
        }
        isAvailable
    }

    def inventorySlotsSurroundingTime(Date dateTime) {
        InventorySlot.surroundingTime(dateTime) {
            and {
                inventorySlot.schedule = this
            }
        }
    }
} 
```

InventorySlot.groovy

```
class InventorySlot {

    Date startTime

    static belongsTo = [schedule: Schedule]

    static constraints = {
        startTime nullable: false, blank: false
    }

    static mapping = {
        tablePerHierarchy true
        schedule lazy: false
    }

    static namedQueries = {}

    def static surroundingTime(Date time) {
        [UnboundedInventorySlot.surroundingTime(time), BoundedInventorySlot.surroundingTime(time)].flatten()
    }

    def endTime() {
        return ((BoundedInventorySlot) this).endTime?: (UnboundedInventorySlot (this)).endTime()
    }
} 
```

UnboundedInventorySlot.groovy

```
class UnboundedInventorySlot extends InventorySlot {

    static namedQueries = {
    //        surroundingTime { time ->
    //            le 'startTime', time
    //            ge 'startTime', time - 1
    //        }
    }

    @Override
    def static surroundingTime(Date time) {
        findAllByStartTimeLessThanEqualsAndStartTimeGreaterThanEquals(time, time - 1)
    }

    def Date endTime() {
        def endTime

        // If the office closing is defined, use that, otherwise use tonight @ 23:59:59
        endTime = schedule?.officeOpenEnd?: new DateTime(startTime + 1).withTimeAtStartOfDay().plusSeconds(-1).toDate()

        return endTime
    }
} 
```

BoundedInventorySlot.groovy

```
class BoundedInventorySlot extends InventorySlot {

    Date endTime

    static constraints = {
        endTime nullable: false, blank: false, validator: {val, obj ->
            if (val.date != obj.startTime.date) { return ["invalid.differentDate", val.date] }
        }
    }

    static namedQueries = {
    //        surroundingTime { time ->
    //            le 'startTime', time
    //            ge 'endTime', time
    //        }
    }

    @Override
    def static surroundingTime(Date time) {
        findAllByStartTimeLessThanEqualsAndEndTimeGreaterThanEquals(time, time)
    }

    @Override
    def Date endTime() {
        endTime
    }
} 
```

我想做的是实现 Schedule#isAvailableAt(Date) 方法，如下所示：

```
def boolean isAvailableAt(Date dateTime) {
    def isAvailable = true

    if (inventorySlots.isEmpty()) {
        isAvailable = false
    } else if (inventorySlots.surroundingTime(dateTime).isEmpty()) {
        isAvailable = false
    }

    isAvailable
} 
```

其中`inventorySlots.surroundingTime()`调用本质上是`InventorySlot.surroundingTime()`但不是查询 InventorySlots 的宇宙，它仅对与计划实例关联的实例进行预过滤。这在 Rails 中很常见，但是在 Grails 中对“链式查询”或“集合查询”的任何搜索似乎都没有提供好的文档。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T01:54:51.357

我可以想到两种可行的方法：

更复杂的动态查找器：

```
InventorySlots.findAllByScheduleAndStartTimeLessThanEqualsAndEndTimeGreaterThanEquals(this, time, time -1) 
```

您可以将命名查询链接在一起，然后使用任何自动装配的查找器来运行实际查询，因此如果您取消注释命名查询：

```
static namedQueries = {
        surroundingTime { time ->
            le 'startTime', time
            ge 'startTime', time - 1
        }
} 
```

您可以简单地调用：

`InventorySlots.surroundingTime(time).findAllBySchedule(this)`

如果您不喜欢标准构建器语法，您可能还想查看Grails 2 中的[*where*查询。](http://grails.org/doc/latest/guide/GORM.html#whereQueries)它们比标准查询更安全，并且可以以相同的方式链接。

更新：不幸的是，我不熟悉命名查询如何与多态性一起工作的内部工作原理，我认为这就是您将其注释掉的原因。我认为最坏的情况是，您可以像这样在父级上构建一个查询：

```
surroundingTime { time ->
            or {
                and {
                    eq('class', BoundedInventorySlot.name)
                    le 'startTime', time
                    ge 'startTime', time
                }
                and {
                    eq('class', UnboundedInventorySlot.name)
                    le 'startTime', time
                    ge 'startTime', time - 1
                }
            }
        } 
```

***更新：您能否利用价差运算符来简化您的任务？即保留此代码，但删除 .flatten() 并将环境时间称为命名查询或 where 查询。

```
def static surroundingTime(Date time) {
        [UnboundedInventorySlot.surroundingTime(time), BoundedInventorySlot.surroundingTime(time)]
    } 
```

然后你可以打电话： `Schedule.surroundingTime(time)*.findAllBySchedule(this).flatten()`

调用者需要知道组合结果并不理想，但可能是一种有趣的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-03T14:06:41.990

作为参考：

Grails 文档中的查询链：http: [//grails.org/doc/latest/guide/GORM.html#querying](http://grails.org/doc/latest/guide/GORM.html#querying)

请参阅“查询组合”部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-03T22:07:43.977

添加答案，因为这是第一个搜索结果。根据文档，where 子句是“分离标准”。

例子：

```
def query = Person.where {
     lastName == "Simpson"
}
def bartQuery = query.where {
     firstName == "Bart"
}
Person p = bartQuery.find() 
```

[Where 查询组合](http://grails.github.io/grails-doc/latest/guide/GORM.html#whereQueries)

# php - 获取 dompdf 以在 PDF 中打印 iframe 内容？

> ID：12118177
> 
> 赞同：0
> 
> 时间：2012-08-25T00:22:31.750
> 
> 标签：php, pdf-generation, dompdf

我正在将 dompdf 用于我正在构建的项目，并且该项目的一部分需要以 PDF 格式生成报告。

在报告的 HTML 版本中，我将报告的一些详细信息显示在 iFrame 中，如下所示：

```
 <?php foreach ($jobsheets as $jobsheet) { ?>
            <iframe src="http://localhost/modal/customers/<?php echo $company['Company']['id']; ?>/jobs/<?php echo $jobsheet['Jobsheet']['id']; ?>/viewlite/" id="jbif<?php echo $jobsheet['Jobsheet']['id']; ?>" frameborder="0" width="975px" height="272px" scrolling="no" class="<?php echo $jobsheet['Jobsheet']['jobdate']; ?>"></iframe>
        <?php } ?> 
```

但是，在没有呈现这些 iframe 的情况下生成的 PDF。我可以做些什么来让 dompdf 模块呈现它们，还是我必须在不使用 iframe 的情况下物理包含数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T09:22:59.730

Dompdf 不支持在文档中呈现 iframe。您可以在跟踪器中提交问题。你现在需要使用别的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-07-15T23:23:14.400

要显示从 dompdf 生成的 pdf 文件，请尝试将文件保存到磁盘，然后在 object 标记内调用。

PHP

```
try {
    $buffer = ob_get_contents();
    ob_clean();

    $dompdf = new \Dompdf\Dompdf();

    $dompdf->setPaper('A4');
    $dompdf->loadHtml($buffer);

    $dompdf->set_option('isHtml5ParserEnabled', true);

    // Render the HTML as PDF
    $dompdf->render();

    // save the generated PDF to Browser
    file_put_contents('file.pdf', $dompdf->output());
    chmod('file.pdf', 0777);
} catch (Exception $ex) {
    echo $ex->getMessage();
} 
```

HTML

```
<html>
<head>
    <title>FILE PDF</title>
</head>
<body style="margin: 0; padding: 0">
    <div style="width: 740px; margin-left: auto; height: 20%; padding: 0; margin: 0;">
        <a href="">SEND PDF</a>
    </div>
    <object data="http://<?=$_SERVER['HTTP_HOST']?>/file.pdf" type="application/pdf" style="margin: 0; width:100%; height: 80%; padding: 0;">
      <embed src="http://<?=$_SERVER['HTTP_HOST']?>/file.pdf" type="application/pdf" />
    </object>
</body> 
```

# google-app-engine - app.yaml 中的静态目录，目录名称中有空格，我该如何处理？

> ID：12118178
> 
> 赞同：0
> 
> 时间：2012-08-25T00:22:58.497
> 
> 标签：google-app-engine, webapp2

我有一个 GAE + webapp2 应用程序，我的 html 中的 href 行出现此错误，

```
INFO     2012-08-25 00:08:47,461 dev_appserver.py:2891] "GET /components%20copy_files/bootstrap-typeahead.js HTTP/1.1" 404 -
INFO     2012-08-25 00:08:47,470 dev_appserver.py:2891] "GET /components%20copy_files/application.js HTTP/1.1" 404 - 
```

（我有一堆但是..）

问题是我的 html 引用了 css/js "components copy_files" 的这个文件夹

我如何在我的 app.yaml 中映射它？我试过了

```
- url: /components%20copy_files
    static_dir: templates/components%20copy_files 
```

和

```
- url: /components copy_files
      static_dir: templates/components copy_files 
```

和

```
- url: /components\%20copy_files
      static_dir: templates/components\%20copy_files 
```

但我无法让我的网站加载它的 css/js ......？在此先感谢您的帮助。

同样作为后续问题，如果我从不同的托管服务器移植 html/css/js 并且所有 href 链接和目录都已到位，我如何让 app.yaml/webapp2 路由到所有这些文件.. 做我必须在我的 app.yaml 中声明每个静态目录？顺便说一句：我正在移植一个使用 twitter bootstrap（由其他人编写）的项目，但我不想通过他们的代码返回并编辑所有的 href，有没有什么快速的解决方案可以让这些嵌套的资源文件很好地播放gae+app.yaml/webapp2?

如果你能提供帮助，非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T02:21:19.653

```
- url: /components%20copy_files
  static_dir: you can have whatever name you want here(doesn't have to match the url) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T02:05:35.380

正确的配置是：

```
- url: /components%20copy_files
  static_dir: templates/components copy_files 
```

# c++ - 独立于操作系统的位域编程

> ID：12118181
> 
> 赞同：1
> 
> 时间：2012-08-25T00:23:32.357
> 
> 标签：c++, visual-studio, gcc, bit-fields

我必须在跨越多个 DWORDS 的位域中编写独立位。我目前使用的结构如下

```
typedef struct _myStruct
{
    union 
    {
        struct 
        {
            DWORD   field1       : 16
            DWORD   field2       : 8
            DWORD   field3       : 8
        };
        DWORD   value0;
    };
    union 
    {
        struct 
        {
            DWORD   field4       : 32; 
        } 
        DWORD   value1;
    };
} myStruct; 
```

我这样做是为了让程序员可以直接访问独立的字段，而不是记住相应的 DWORD 即`myStruct.field1`等。这在 Visual Studio 中运行良好，但是当我使用未命名的结构和联合时 GCC 会抱怨。为了纠正这个问题，我尝试如下命名联合和结构：

```
 union _DW0
    {
        struct _BF
        {
            DWORD   field1       : 16
            DWORD   field2       : 8
            DWORD   field3       : 8
        } BF;
        DWORD   value0;
    } DW0; 
```

但是现在访问对程序员不友好.. 即尝试对此进行编程的人必须记住每个字段属于哪个 DWORD。例如：`myStruct.DW0.field1`

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T02:04:53.213

位域本质上是不可移植的。当你编写`DWORD field1 : 16;`标准时并没有确定是否`field1`应该具有结构的高位或低位 16 位。另一方面，如果您使用正确的类型和联合（在您的情况下就足够了，因为您的所有位域都与大多数平台中的类型匹配），那么它*可以*是可移植的。

使用 C++11 类型（您也可以使用具有适合您平台的类型的库）：

```
union {
   struct {
      uint16_t  _1;
      uint8_t   _2;
      uint8_t   _3;
   } field;
   uint32_t value;
};
// ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T00:44:28.707

匿名联合通常是可以的，但结构需要有一个名称。您可以使用它从语法中删除一级“点”。

*但是，如果您需要通过命名结构成员单独（作为位域）和*作为一个整体（作为 DWORDS）访问字段，那么您将不得不使用稍微混乱的语法。这种用例需要联合，这需要内部结构，这会导致问题。您总是可以隐藏 getter/setter 函数后面的所有杂乱语法，但如果结构很大，那么该方法将不是很容易维护。

这是您可以考虑的替代方案：

```
typedef struct
{
    // DWORD 0
    DWORD   field1   : 16;
    DWORD   field2   : 8;
    DWORD   field3   : 8;
    // DWORD 1
    DWORD   field4   : 32; 
} bitfield_struct; 
```

这只会为您提供位域级别的访问权限，但语法更简洁。如果需要，您仍然可以访问 DWORD 级别的数据，但是：

```
bitfield_struct foo;
DWORD* bar = (DWORD*)&foo;

bar[0] = ...;
bar[1] = ...; 
```

如果您通常通过位域访问数据并且很少通过 DWORD 访问数据，那么这可能是一个可以接受的解决方案。

# ios - 设计模块化 iOS 项目的建议？

> ID：12118182
> 
> 赞同：2
> 
> 时间：2012-08-25T00:23:43.693
> 
> 标签：ios, ios5, uikit

*我在programmers.stackexchange.com 上阅读了几个问题，以确定这个问题是否更适合在那里提出。我认为这个问题属于 SO，但我不完全确定。*

我对 Objective-C 和 UIKit 有基本的了解。几年前，我读过 Aaron Hillegass 的大部分*Cocoa Programming for OS X（第 2 版）*；这就是我大部分知识的来源。其余的来自各种站点、SO 问题、SDK 文档和小型个人项目（OS X 和 iOS）。

我正在为我工​​作的大学启动一个 iOS（特别是 iPhone）项目。此应用程序将具有具有不同功能的不同部分。“部分”的一些示例是：虚拟学生证、当前学期的课程表（针对用户）、校园地图等。我希望能够在应用程序的未来版本中轻松添加新部分。因此，我想设计项目，使一个部分独立于主项目的代码组（尽可能）。

除了能够通过创建新模块来添加新功能之外，我还希望该项目能够被更多的开发人员使用，而不仅仅是我自己。也就是说，我希望团队中的其他开发人员能够按照“最佳实践”为应用程序开发新模块。

目前，我的项目基于 a `UITabBarController`，我的“模块”是 new `UIViewController`s 和 NIB。我觉得这可能不是建立我的项目的最佳方式。因此我的问题是：

对于我所描述的这样一个项目，有哪些最佳实践？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T00:27:49.763

我认为你在正确的轨道上。UIViewControllers 是打破这种情况的好方法。

当你有很多选项时，UITabBarControllers 通常会很尴尬；带有可能性表格视图的欢迎屏幕可能更具可扩展性。例如，请参阅 Facebook 的左侧面板或内置的设置应用程序。

我通常发现在 iOS 项目中重用的难点不是视图控制器（它们通常是隔离良好的），而是底层基础设施，例如网络请求、数据存储、帐户管理等。你可能想从一个现有的框架（比如 Parse 或 RestKit），或者至少看看它们是如何分解的。

关于良好的、可重用的 iOS 设计主题，您可能会发现[Matt Gemmell 关于 API 设计的文章](http://mattgemmell.com/2012/05/24/api-design/)很有帮助，如果不是您正在寻找的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T01:21:03.567

*   建立编码风格和资源位置的约定。
*   开发静态库。
*   如果您的静态库需要自己的资源（这可能是一种必要的痛苦），您可能希望为您的资源使用捆绑包以最大程度地减少资源冲突。
*   集中您的构建配置文件，而不是尝试在每个项目中定义每个设置（使用 xcconfigs）。

然后您可以将这些库配置为您的应用程序项目中的依赖项，并适当地构建、链接和复制。

一个重要的注意事项：在这些情况下（如果适用），我经常对 C 和 C++ 符号犯错，因为 ObjC 符号（以及它们引用的内容）不能被​​剥离。这可以减少很多不使用的“二元脂肪”。因此，您的“核心”库和主要处理在其他库（例如系统库）中声明的符号的库可能在 C 和 C++ 中，而您的更高级别的抽象和派生类型可能在 ObjC 中。

# php - Mysql_fetch_assoc 无法正常工作

> ID：12118183
> 
> 赞同：-3
> 
> 时间：2012-08-25T00:23:55.440
> 
> 标签：php, mysql, sql

无论如何，我无法弄清楚我的代码中出现此错误的原因：

> mysql_fetch_assoc()：提供的参数不是有效的 MySQL 结果资源

这是我的PHP代码：

```
<?php

$session_id = $_SESSION['id'];

$getall = mysql_query("SELECT * FROM users WHERE id='' . $dbuser_id . ''");
$row = mysql_fetch_assoc($getall);

$fullnameDB         = $row['name'];
$emailDB            = $row['email'];
$usernameDB         = $row['username'];

$fullname           = strip_tags($_POST['fullname']);
$username           = strip_tags($_POST['username']);
$email              = strip_tags($_POST['email']);

if ($_POST['submit']) {

    $namecheck = mysql_query("SELECT username FROM users WHERE username='' . $username . ''");

    $count = mysql_num_rows($namecheck);

    if ($count !=0) {

        echo 'That username is already taken!';

    } else {

        mysql_query("UPDATE users SET username=' . $username . ' WHERE id='' . $dbuser_id . ''");

        echo 'Your UN has been updated';

    }

}                        

?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T00:26:04.693

```
"SELECT username FROM users WHERE username='" . $username . "'" 
```

不是

```
"SELECT username FROM users WHERE username='' . $username . ''" 
```

但考虑使用 mysqli 或 pdo 切换到参数化语句

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T00:27:09.340

这是您的代码的改进版本：

```
<?php

$session_id = $_SESSION['id'];

$getall = mysql_query("SELECT * FROM users WHERE id='" . $dbuser_id . "'");
$row = mysql_fetch_assoc($getall);

$fullnameDB         = $row['name'];
$emailDB            = $row['email'];
$usernameDB         = $row['username'];

$fullname           = mysql_real_escape_string($_POST['fullname']);
$username           = mysql_real_escape_string($_POST['username']);
$email              = mysql_real_escape_string($_POST['email']);

if ($_POST['submit']) {

    $namecheck = mysql_query("SELECT username FROM users WHERE username='" . $username . "'");

    $count = mysql_num_rows($namecheck);

    if ($count !=0) {

        echo 'That username is already taken!';

    } else {

        mysql_query("UPDATE users SET username='" . $username . "' WHERE id='" . $dbuser_id . "'");

        echo 'Your UN has been updated';

    }

}                        

?> 
```

你做错了什么，在你的查询中，你用双引号（“）开始它，但你试图在中途结束它，用单引号（'）连接你的用户名，所以它不起作用。我还帮助清理了你的输入，以使其不易受到 SQL 注入的攻击（如果不安全）。

**编辑：**正如其他用户所提到的，认真考虑切换到准备好的语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T00:43:45.750

您的代码中有错误，并且容易受到[SQL 注入攻击](http://bobby-tables.com)。

使用此代码：

```
<?php
try {
    $session_id = session_id();
    $conn = mysqli_connect('localhost', 'any_user_other_than_root', 'secure_password', 'database');
    if(!$conn) throw new Exception('Could not connect to the database.');
    $dbuser_id = mysqli_real_escape_string($dbuser_id);
    $query = "SELECT * FROM users WHERE id='$dbuser_id'";
    $getall = mysqli_query($conn, $query);
    if(!$getall) throw new Exception('Database query failed!');
    $row = mysqli_fetch_assoc($getall);
    $fullname_db = $row['name'];
    $email_db = $row['email'];
    $username_db = $row['username'];
    $fullname = mysqli_real_escape_string($_POST['fullname']);
    $username = mysqli_real_escape_string($_POST['username']);
    $email = mysqli_real_escape_string($_POST['email']);
    if(isset($_POST['submit'])) {
        $namecheck = mysqli_query($conn, "SELECT username FROM users WHERE username='$username'");
        if(!$namecheck) throw new Exception('Name check failed!');
        $count = mysqli_num_rows($namecheck);
        if($count > 0) {
            echo 'That username is already taken!';
        } else {
            $result = mysqli_query($conn, "UPDATE users SET username='$username' WHERE id='$dbuser_id'");
            if(!$result) throw new Exception('Could not update your UN.');
            echo 'Your UN has been updated';
        }
    }
} catch(Exception $e) {
    echo 'Error: ' . $e->getMessage();
}
?> 
```

# c++ - 函数返回另一个类中定义的枚举（致命链接错误）

> ID：12118188
> 
> 赞同：0
> 
> 时间：2012-08-25T00:25:02.730
> 
> 标签：c++, enums, linker-errors

这似乎是一个常见的问题。我在classA中定义了一个枚举，然后在classB中包含了classA。然后，在 classB 中，我定义了一个函数，该函数返回 classA 中定义的枚举类型......见下文。我收到以下错误：

> aFirst.obj：错误 LNK2019：函数 _wmain 1>C 中引用的未解析的外部符号“public: enum justEnum::things_t __thiscall usesTheEnum::returnsThings(void)”(?returnsThings@usesTheEnum@@QAE?AW4things_t@justEnum@@XZ) :\Documents and Settings\Ben\My Documents\Visual Studio 2010\Projects\aFirst\Debug\aFirst.exe : 致命错误 LNK1120: 1 unresolved externals

```
#pragma once
class justEnum
{

public:
    justEnum(void);
    ~justEnum(void);
    enum things_t{ONE, TWO};
};

#pragma once
#include "justEnum.h"

class usesTheEnum
{
public:
    usesTheEnum(void);
    ~usesTheEnum(void);
    justEnum::things_t returnsThings(void);
};

#include "StdAfx.h"
#include "usesTheEnum.h"
#include "justEnum.h"

usesTheEnum::usesTheEnum(void)
{
}

usesTheEnum::~usesTheEnum(void)
{
}

justEnum::things_t returnsThings()
{
    return justEnum::ONE;
}

// tester.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include <stdio.h>
#include <iostream>
#include "justEnum.h"
#include "usesTheEnum.h"

using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{
    usesTheEnum aUser;
    justEnum anEnum;
    justEnum::things_t anotherEnum;
    anotherEnum = justEnum::ONE;
    aUser.returnsThings();
    cout << anotherEnum;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T00:32:47.720

您需要指定您的定义`returnsThings()`是`usesTheEnum`该类的一部分。

```
justEnum::things_t usesTheEnum::returnsThings()
{
    return justEnum::ONE;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T00:28:58.797

> 错误 LNK2019：未解析的外部符号“公共：枚举 justEnum::things_t __thiscall **usesTheEnum::returnsThings** (void)”

编译器抱怨`usesTheEnum::returnThings()`未定义，我在您发布的代码中看不到定义。您应该在一个翻译单元中提供函数的定义。

我认为我不能足够强调学习**阅读错误信息**的重要性。编译器正在尽最大努力告诉您出了什么问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T00:32:15.000

不舒尔，但你不能把枚举移出课堂吗？

或者在类的 .cpp 上写一些类似 extern enum classname::things_t; 只是将枚举添加到生成的库中，这就是将要链接的内容。

# python - 烧瓶教程；无法导入flaskr（初始化数据库）

> ID：12118192
> 
> 赞同：15
> 
> 时间：2012-08-25T00:25:41.820
> 
> 标签：python, import, flask

我是编程新手，并尝试完成烧瓶教程。 [http://flask.pocoo.org/docs/tutorial/](http://flask.pocoo.org/docs/tutorial/)

尝试运行应用程序时，我被困在这部分（来自 github 上的自述文件）： [https ://github.com/mitsuhiko/flask/tree/master/examples/flaskr/](https://github.com/mitsuhiko/flask/tree/master/examples/flaskr/)

启动一个 python shell 并运行它：

```
from flaskr import init_db; init_db() 
```

当我尝试在 python shell 中运行命令时出现此错误：

```
Import error: No module named flaskr 
```

当我尝试在本地运行应用程序时出现此错误：

```
sqlite3.OperationalError
OperationalError: unable to open database file 
```

我一直在寻找解决方案几个小时，但无济于事。关于我可以检查什么的任何想法？谢谢你。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2016-07-12T06:31:43.340

为我解决问题的事情正在改变

```
export FLASK_APP=flaskr 
```

至

```
export FLASK_APP=flaskr.py 
```

取自[这里](https://github.com/pallets/flask/issues/1902)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-25T01:19:50.240

完成所需任务的最简单方法是在与 flaskr 相同的文件夹中启动 Python shell：

```
# I'm assuming that python is available on the command line
$ cd path/to/flaskr
$ python

# Python then runs and you can import flaskr
>>> from flaskr import init_db; init_db()
>>> exit() 
```

诀窍是，当您运行 Python 时，它只会在一定数量的位置查找[模块和包](http://docs.python.org/tutorial/modules.html)- 您可以通过运行来查看哪些位置：

```
>>> from sys import path
>>> for fp in path:
...     print fp 
```

来自 Python 解释器。如果flaskr 的路径不在该列表中，则无法导入flaskr。默认情况下，Python 会将启动它的目录添加到其搜索路径中（这就是我们在包含 flaskr 的目录中启动 Python 的原因。）

运行后`init_db`，您应该能够运行应用程序并看到一切正常。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-06-08T19:17:01.243

如果您使用的是 Flask < 0.11 的版本，则该`flask`命令不可用。在这种情况下安装`flask-cli`软件包。

```
pip install flask-cli 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-22T20:11:53.797

对于发现此内容的任何其他人，请将`init_db()`主执行器添加到应用程序的末尾，`flaksr`如下所示：

```
if __name__ == '__main__':
    init_db()
    app.run() 
```

这应该可以解决 sqlite 错误并阻止您`init_db()`手动运行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-09-27T09:50:50.487

当我们说：

```
export FLASK_APP=flaskr 
```

python 绝不理解包“flaskr.py”的存在位置。

解决问题的方法之一是选择“flaskr.py”所在的正确路径。例如，将您当前的工作目录更改为文件所在的位置，并且：

```
export PYTHONPATH=`pwd` 
```

然后你可以在任何你想要的地方执行“烧瓶运行”。

PS：烧瓶教程似乎坏了。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-23T23:17:22.567

Sean Viera 的回答非常好，尽管我想补充一点，我遇到了同样的问题并想添加到解决方案中。从同一个 flaskr 文件夹中运行 Python 对我来说还不够。在运行 $Python 之前，还需要通过运行“.venv/bin/activate”命令来激活 Flask，如下所示：

```
$ cd path/to/flaskr
#active 
$ . venv/bin/activate 
(venv)$ python

# Python then runs and you can import flaskr
>>> from flaskr import init_db; 
>>> init_db()
>>> exit()
$ 
```

希望额外的信息有所帮助！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-28T13:23:15.553

```
$set FLASK_APP=flaskr
$python -m flask initdb
$python -m flask run 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-25T17:20:32.163

尝试这个：

操作系统：Windows

```
(venv)$pip install -I --no-deps Flask
(venv)$set FLASK_APP=flaskr
(venv)$set FLASK_DEBUG=1
(venv)$flask run 
```

解释：

`$where flask`将有助于找到*flask.exe*

如果 virtual-env从 system- env 继承*烧瓶*

```
(venv)$where flask
>> /system/environment/path/to/flask.exe

(root)$where flask
>> /system/environment/path/to/flask.exe 
```

显然它调用了为 system-env 安装的*flask.exe*

`(venv)$pip install -I Flask`可以强制（重新）为虚拟环境安装*烧瓶*

```
(venv)$pip install -I Flask
(venv)$where flask
>> /virtual/environment/path/to/flask.exe
>> /system/environment/path/to/flask.exe 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-11-18T03:48:29.920

我有同样的问题，我已经解决了。步骤1：

1.  sudo ln -sf /usr/bin/python3.4 /usr/bin/python
2.  easy_install_3.4 烧瓶。
3.  蟒蛇路径=`pwd`

step2：使用easy_install_3.4安装falsk。第三步：

# 标题

# c# - RAM 优化 SDK，如 RAMRush，用于图像处理

> ID：12118194
> 
> 赞同：0
> 
> 时间：2012-08-25T00:25:49.733
> 
> 标签：c#, .net, memory-management, memory-leaks, ram

我的应用程序有问题，它需要大量内存优化，但现在我必须交付应用程序的测试版本，我需要类似“ramrush”的东西，因为 api 可以从我的应用程序调用而无需任何可执行文件，Ramrush 正在解决我的问题现在神奇地出现了，但我无法用我的应用程序提供它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T04:54:02.877

解决 OP 的迫切需求（即使今天有点晚了）

*   [C# 内存配置文件](https://stackoverflow.com/questions/6144084/c-sharp-memory-profile)
*   [Microsoft DebugDiag](http://www.microsoft.com/en-us/download/details.aspx?id=26798)，请参阅[博客文章](http://blogs.msdn.com/b/kaevans/archive/2011/09/06/capturing-a-memory-dump-using-debugdiag-1-2.aspx)

* * *

图像处理代码中有两个级别的内存优化。

*   在更简单的层面上，程序员尽可能频繁和尽早地（即在每一行代码之后）尝试删除不再需要的图像对象。
*   更困难的级别需要将一些图像处理步骤实现为内存高效的管道。

一个例子：

```
class RgbToGray : ImageSource
{
    private ImageSource m_src;
    public RgbToGray(ImageSource src)
    {
        m_src = src;
    }
    public void GetPixels(int x0, int y0, int rectWidth, int rectHeight, out Pixel[,] result)
    {
        // omitted: validate parameters
        Pixel[,] temp = new Pixel[rectHeight, rectWidth];
        m_src.GetPixels(x0, y0, rectWidth, rectHeight, out temp);
        for (int y = y0; y < y0 + rectHeight; ++y)
        {
            for (int x = x0; x < x0 + rectWidth; ++x)
            {
                result[y,x] = SomeCalculation(temp[y,x]);
            }
        }
    }
}; 
```

在此示例中，`RgbToGray`按需执行图像处理，无需使用自己的永久内存，而是依赖于临时缓冲区。为了使这个实现工作，调用者必须`GetPixels`以特定的“缓冲区粒度”调用，该粒度必须小于完整的图像大小，以达到节省内存的效果。

（我想到的特定框架是[Windows Imaging Component](http://msdn.microsoft.com/en-us/library/windows/desktop/ee719654(v=vs.85).aspx)，但类似的想法可以在许多其他框架中找到，例如[OpenCV 的`MatExpr`](http://opencv.willowgarage.com/documentation/cpp/core_operations_on_arrays.html)模板。）

显然，并非所有框架都允许这种优化。

# javascript - 即使什么都没有，是否可以保持（自动）滚动？

> ID：12118195
> 
> 赞同：0
> 
> 时间：2012-08-25T00:25:54.133
> 
> 标签：javascript, jquery, scroll

我正在开发一个在（Windows）平板电脑上运行的网络应用程序。我不会详细介绍，但基本上用户有一个任务列表，并在完成时检查每个任务。

当他们检查一个任务时，我使用 jQuery (scrollTop()) 滚动，以便他们可以在同一个位置单击下一个任务，而不必手动滚动（这在这个特定的平板电脑上很棘手）。

问题是，当他们可以到最后 5 或 6 个任务时，它是 div 的结尾，所以滚动停止，这很奇怪，因为他们已经习惯了在同一个地方点击。

我想保持它滚动，但我不知道如何。

我的猜测只是在底部添加空格，但是我不确定如何检测它何时到达底部以添加空格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:33:34.460

在页面加载时找到最后一个列表项。然后添加空格，以便它可以滚动到页面顶部。我为我的一个网站这样做，这样当人们访问锚点时，它们就会出现在页面顶部。当他们没有我自己时讨厌它！

```
var $lastinput = $('input').last();
if ($lastinput.length > 0) {
    var headerTop = $lastinput.offset().top;
    var spacing = $(window).height() - ($('body').height() - headerTop);
    $('#setpageheight').height(spacing);
} 
```

在内容区域的底部，我有一个零高度 div，称为`setpageheight`. 我根据需要给它一个高度。

[http://jsfiddle.net/Ge7nM/](http://jsfiddle.net/Ge7nM/)

# nhibernate - 如何在 MVC4 项目中处理 NHibernate 会话

> ID：12118196
> 
> 赞同：3
> 
> 时间：2012-08-25T00:25:56.207
> 
> 标签：nhibernate, asp.net-mvc-4

我目前从 globalasax 获得我的会话如下......

```
public class MvcApplication : HttpApplication
{
    public static readonly ISessionFactory SessionFactory =                                        NHibernateHelper.CreateSessionFactory();

    public MvcApplication()
    {
        BeginRequest += delegate
                            {
                                if (!HttpContext.Current.Request.Url.AbsolutePath.StartsWith("/_cassette/"))
                                {
                                    CurrentSession = SessionFactory.OpenSession();
                                    CurrentSession.FlushMode = FlushMode.Auto;
                                }
                            };
        EndRequest += delegate
                        {
                            if (CurrentSession != null)
                            {
                                CurrentSession.Flush();
                                CurrentSession.Dispose();
                            }
                        };
    }

    public static ISession CurrentSession
    {
        get { return (ISession) HttpContext.Current.Items["current.session"]; }
        set { HttpContext.Current.Items["current.session"] = value; } 
```

我正在查看 Sharp Architecture Transaction 属性和一个类似的[http://weblogs.asp.net/srkirkland/archive/2009/09/03/asp-net-mvc-transaction-attribute-using-nhibernate.aspx](http://weblogs.asp.net/srkirkland/archive/2009/09/03/asp-net-mvc-transaction-attribute-using-nhibernate.aspx)但是什么在 MVC4 项目中处理会话以利用非隐式事务的最佳方式[http://nhprof.com/Learn/Alerts/DoNotUseImplicitTransactions](http://nhprof.com/Learn/Alerts/DoNotUseImplicitTransactions)

我可以通过将事务/提交添加到开始请求/结束请求来轻松包装所有内容，但属性方法看起来更干净（实际上处理错误）；还是我现在应该使用过滤器？

MVC4 与 NHibernate 的最佳实践是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T05:30:27.337

您当前的会话处理有一个严重的问题（在那里做过；））。CurrentSession 是静态的，因此它在所有并发请求之间共享。NHibernate 的 ISession 不是线程安全的（不像 ISessionFactory 是线程安全的）。

NHibernate 提供会话上下文，会话可以绑定到其中，之后可以从会话工厂获取绑定的会话（.GetCurrentSession() -方法）。为了能够像在下一个示例中那样使用 CurrentSessionContext，您需要告诉 NHibernate 使用哪个会话上下文。对于 Web 应用程序 WebSessionContext 是不错的选择。

当我使用 MVC 时，我编写了一个处理会话处理的操作过滤器。这是一个示例（为 MVC 2 编写）：

```
[AttributeUsage(AttributeTargets.Method, AllowMultiple = false)]
public class TransactionAttribute : ActionFilterAttribute
{
    public TransactionAttribute()
    {
        Order = 100;
    }

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        CurrentSessionContext.Bind(NHibernateManager.SessionFactory.OpenSession());
    }

    public override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        var session = CurrentSessionContext.Unbind(NHibernateManager.SessionFactory);
        session.Close();
        session.Dispose();
    }
} 
```

将事务管理也添加到同一个过滤器中应该不是什么大问题。在 OnActionExecuting-method 中，您可以使用 ISession 的 .BeginTransaction() 打开事务，在 OnActionExecuted 中，您可以从 ISession 的 Transaction-property 获取当前事务，然后可以提交和处置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T21:43:51.600

还有另一种实现“每个请求模式的会话”的方法 - httpModule。

```
public class NHibernateModule : IHttpModule
{
    public void Init(HttpApplication context)
    {
        context.BeginRequest += context_BeginRequest;
        context.EndRequest += context_EndRequest;
    }

    private static void context_BeginRequest(object sender, EventArgs e)
    {
        //use my session manager
        ISession session = SessionManager.Instance.OpenSession();
        CurrentSessionContext.Bind(session);
    }

    private static void context_EndRequest(object sender, EventArgs e)
    {
        ISessionFactory sessionFactory = SessionManager.Instance.SessionFactory;
        ISession session = CurrentSessionContext.Unbind(sessionFactory);

        if (session == null) return;
        if (session.Transaction != null)
        {
            if (session.Transaction.IsActive)
            {
                //if there is an active session, commit it
                session.Transaction.Commit();
            }
            else
            {
                //
                session.Transaction.Rollback();
            }
        }

        session.Close();
    }

<configuration>

   <!-- IIS 6 -->
    <system.web>
         <httpModules>
            <add name="NHibernateModule" type="NHibernateModule"/>
        </httpModules>
     </system.web>
     <!-- IIS 7 and Cassini. -->
    <system.webServer>
         <modules>
            <add name="NHibernateModule" type="NHibernateModule"/>
        </modules>
    </system.webServer>
</configuration> 
```

ActionFilterAttribute 方式有一个问题：在一个 HTTP 请求中它会如何处理一些操作？

这种模式建议每个 HTTP 请求打开一个 NHibernate 会话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-01T20:05:46.797

这里有一些很好的答案，但我的建议是使用依赖注入框架（我喜欢[Ninject](http://www.ninject.org/)）来实现每个请求的会话。这允许您在控制器上使用构造函数注入来注入 ISession。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-26T20:50:51.773

跟进 Ultor 的回答，加上 Ayende 的“重构无摩擦和无气味的代码：交易怎么样？” 文章，最后，因为我已经使用以下内容在 Application_Start 中设置了应用程序的依赖解析器：

`DependencyResolver.SetResolver(new MyDependencyResolver())`

我将 TransactionAttribute 类更改为如下：

```
[AttributeUsage(AttributeTargets.Method, AllowMultiple = false)]
public class SessionAttribute : ActionFilterAttribute {
    static readonly ISessionFactory SessionFactory = BuildSessionFactory();

    static ISessionFactory BuildSessionFactory() {
        return (ISessionFactory) DependencyResolver.Current.GetService(typeof (ISessionFactory));
    }

    public override void OnActionExecuting(ActionExecutingContext filterContext) {
        var sessionController = filterContext.Controller as SessionController;

        if (sessionController == null)
            return;
        if (sessionController.NHibernateSession == null) {
            sessionController.NHibernateSession = SessionFactory.OpenSession();
        }
        sessionController.NHibernateSession.BeginTransaction();
        CurrentSessionContext.Bind(sessionController.NHibernateSession);
    }

    public override void OnActionExecuted(ActionExecutedContext filterContext) {
        var sessionController = filterContext.Controller as SessionController;

        if (sessionController == null) return;

        var session = CurrentSessionContext.Unbind(SessionFactory);
        if (session == null) return;
        if (session.Transaction != null) {
            if (!session.Transaction.IsActive) return;

            if (filterContext.Exception != null)
                session.Transaction.Rollback();
            else
                session.Transaction.Commit();
        }
        session.Close();
        session.Dispose();
    }
} 
```

基本控制器定义如下：

```
public class SessionController : Controller {
    public ISession NHibernateSession { get; set; }
} 
```

现在，我的控制器中的持久性变得如此简单：

```
[HttpGet, Session]
public ActionResult CreateOrUpdate(Guid id = new Guid()) {
    var company = GetCompany(id);
    if (company == null) throw new HttpException(404, "Not Found");
    return View(company);
}

[HttpPost, ValidateAntiForgeryToken, Session] 
public ActionResult CreateOrUpdate(Company passedInCompany) {
    var company = NHibernateSession.Get<Company>(passedInCompany.Id);
    if (company == null) throw new HttpException(404, "Not Found");
    UpdateModel(company);
    if (ModelState.IsValid) {
        NHibernateSession.SaveOrUpdate(company);
        return RedirectToAction("Index");
    }
    return View(company);
}

Company GetCompany(Guid id) {
    Company company;
    if (id == Guid.Empty) {
        company = companyBuilder.Create();
    } else {
        company = NHibernateSession.Get<Company>(id);
        NHibernateSession.Flush();
    }
    return company;
} 
```

# python - python中的数据库抽象级别

> ID：12118198
> 
> 赞同：0
> 
> 时间：2012-08-25T00:26:00.963
> 
> 标签：python, database, sqlalchemy, wrapper

我正在寻找 Python 的数据库包装器。我不想使用闪亮的 ORM，我只是不喜欢它们，而且我想涉及更多的数据库功能，所以我预计 ORM 会出现问题。

我想写我自己的小包装器，但首先在发明轮子之前，我想问一下你是否已经想推荐一些不错的实现？

我还考虑过使用 SQLAlchemy，但只使用没有 ORM 的引擎部分（核心）。它会给我各种数据库的支持，而且也很稳定，我想使用数据库的方法很安全。你怎么看这个计划？

还有什么要建议的吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T01:51:18.237

也许你应该看看[PEP 249](http://www.python.org/dev/peps/pep-0249/)。

这是 DB 模块应遵循的声明接口。如果您正在寻找一个低级的非 ORM 访问层，这就是大多数 DB 模块应该说的，而不管所说的 DB 模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T09:47:40.683

Ignas，您可以查看 Web2py DAL（数据库抽象层），它支持 SQLite、PostgreSQL、MySQL、Oracle、MSSQL、FireBird、DB2、Informix 和 Ingres 以及（部分）Google App Engine（SQL 和 NoSQL）

*   [http://web2py.com/books/default/chapter/29/6](http://web2py.com/books/default/chapter/29/6)

    也可以独立运行：

*   [http://caglartoklu.blogspot.it/2011/06/standalone-usage-of-web2pys-dal-gluon.html](http://caglartoklu.blogspot.it/2011/06/standalone-usage-of-web2pys-dal-gluon.html)

# javascript - jQuery / Twitter Bootstrap 数据加载文本按钮延迟

> ID：12118202
> 
> 赞同：59
> 
> 时间：2012-08-25T00:26:24.317
> 
> 标签：javascript, jquery, css, twitter-bootstrap

我试图让这个确切的例子在我的网站上运行：

[http://getbootstrap.com/2.3.2/javascript.html#buttons](http://getbootstrap.com/2.3.2/javascript.html#buttons)

但是，只需包含此 HTML：

```
<button type="button" class="btn btn-primary" data-loading-text="Loading...">Loading state</button> 
```

不工作。我正在运行 jQuery 1.7.x 并加载了 Bootstrap JS 文件。

具体来说：我希望按钮移动到“加载”文本更改稍有延迟，然后返回常规文本。我的谷歌搜索似乎没有一个很好的在线示例（大多数都要求永久状态更改或切换），并且 Bootstrap 站点本身在此处缺少文档。

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-08-25T00:33:17.277

在文档页面中，正在加载一个名为 application.js 的文件。[http://twitter.github.com/bootstrap/assets/js/application.js](http://twitter.github.com/bootstrap/assets/js/application.js)

```
// button state demo
$('#fat-btn')
    .click(function () {
        var btn = $(this)
        btn.button('loading')
        setTimeout(function () {
            btn.button('reset')
        }, 3000)
    }); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-06-19T10:33:04.300

或者只是添加它，以便它获取 Twitter Bootstrap 属性。

```
$('button[data-loading-text]').click(function () {
    $(this).button('loading');
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-20T00:45:13.187

记下接受的答案如何在运行 button('loading') 之前将 jQuery 按钮对象转换为 js var，因为虽然这有效，但直接在 jQuery 按钮对象上使用时 button('loading') 将不起作用.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-25T18:05:04.000

只包括引导库：

```
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap.js "></script> 
```

这是一个例子：

```
<!DOCTYPE html>
<HTML>
<HEAD>
    <TITLE>Bootstrap Example</TITLE>
    <link type="text/css" rel="stylesheet" href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css ">
<STYLE>
</STYLE>
</HEAD>
<BODY>
    <button type="button" class="btn btn-primary" id="btnD" data-loading-text="=)">hola!!!</button>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/bootstrap.js "></script>
    <script type="text/javascript">
        $(function(){
            $('#btnD').click(function(){
                  var btn = $(this); 
                  btn.button('loading');
            });
        });
    </script>
</BODY>
</HTML> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-19T19:30:40.353

此外，jquery 有 .delay() 方法，它可能比 setTimeout 更容易使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-16T10:19:35.400

我的按钮

```
<button type="submit" id="upgrade-subscription" class="btn btn-primary btn-subscribe" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Payment Processing">upgrade</button> 
```

江青

```
$('#upgrade-subscription').click(function () {
    $(this).button('loading');
}); 
```

* * *

## 回答 #7

> 赞同：-7
> 
> 时间：2013-05-18T16:48:54.637

放个小js就行了

```
onclick="$(this).button('loading');" 
```

# java - 从全局变量读取和写入

> ID：12118214
> 
> 赞同：0
> 
> 时间：2012-08-25T00:28:36.640
> 
> 标签：java, arrays, global

我想做的是有一个全局变量类和函数可以读/写。

我现在拥有的是

```
import java.lang.*;             
import lab1.Global;
public class SecondProgram {
     public static void main ( String args[] ) {
            System.out.println("hi ");
            Global.b[0] = " zero ";
            Global.b[1] = " One ";
            Global.b[2] = " Two ";
            Global.b[3] = " Three ";

        }
} 
```

我创建了一个类来存储全局变量

```
public class Global {
  public static String a = "hi" ;
  public static String [] b;
} 
```

当然，重要的是数组的大小不是硬编码的常量，而是我可以在某个时候找到并插入的变量。

我希望你能从代码中看到我正在尝试做的事情，并且你知道如何让它工作。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T01:14:23.190

> 我想要全局变量，因为我让线程将文本文件中的数据读取到数组中，并且在线程完成工作后数组及其数据保持存在很重要。

好吧，那是行不通的。或者至少，它不会*可靠地*工作（从某种意义上说，这是一个更糟糕的结果！）

在多线程 Java 程序中，您需要确保线程在信息从一个传递到另一个的点处正确同步。同步的目的有两个：

*   防止竞争条件；即一个线程在另一个线程读取值之前尝试读取它，并且
*   确保线程不会因为内存缓存效应而看到*过时的值副本。*

同步裸全局变量将非常困难。我的建议是

*   注意注释（上面）并使用类来封装状态设计和实现。

*   使用实用程序类`java.util.concurrent`来实现共享数据结构......并处理线程创建/管理。以 ExecutorService API 为例，

*   获得一本关于 Java 并发编程的好教科书。Java 中的并发并不简单，如果您不知道自己在做什么，您可以花费数小时/数天/数周/数月来追踪间歇性故障的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T00:47:31.593

我认为这是一种更好的方法，可以帮助您入门....

```
import java.util.ArrayList;

public class SecondProgram {

    private static ArrayList <String>file = new ArrayList();

    public synchronized boolean  writeFile(String str){
        //wrtite file to your list
        file.add(str);
        return true;
    }
    public static void main(String args[]) {
        //read file and use the synchronized method to write it to your list
    } 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T01:19:11.653

我不提倡使用全局变量，但如果必须，您可以执行以下操作。一般来说：让每个线程建立自己的数据。完成工作后，将其数据添加到同步的全局集合（在本例中为 a `List<List<String>>`）。然后在所有线程完成工作后阅读该集合。

收集数据的全局：

```
public class GlobalDataBroker {
    public static List<List<String>> data = Collections.synchronizedList(new LinkedList<List<String>>());
} 
```

一个示例实现：

```
public static void main(String[] args) throws InterruptedException {
    for (int i=0; i < 10; i++) {
        new Thread(new Runnable(){
            @Override
            public void run() {
                List<String> list = new LinkedList<String>();
                list.add(String.format("I'm a Thread and my name is %s.",Thread.currentThread()));
                for (int i = 0; i < 5; i++) {
                    list.add("Data!");
                }
                GlobalDataBroker.data.add(list);
            }
        }).start();
    }

    // When the threads are done ...            
    Iterator<List<String>> i = GlobalDataBroker.data.iterator();
    while (i.hasNext()) {
        System.out.println(i.next());
    }
} 
```

输出：

```
[I'm a Thread and my name is Thread[Thread-8,5,main]., Data!, Data!, Data!, Data!, Data!]
[I'm a Thread and my name is Thread[Thread-5,5,main]., Data!, Data!, Data!, Data!, Data!]
...
[I'm a Thread and my name is Thread[Thread-7,5,main]., Data!, Data!, Data!, Data!, Data!] 
```

请注意，您应该只在完成写入数据后才开始迭代数据。（否则，您可能会遇到可怕的`ConcurrentModificationException`.)

# php - PHP二十一点王牌算法

> ID：12118219
> 
> 赞同：1
> 
> 时间：2012-08-25T00:30:19.180
> 
> 标签：php

我正在编写二十一点的 PHP 版本。我在处理 ace 时遇到了麻烦。我知道在编写这个游戏时这是一个特殊的问题。我环顾了其他人提出的其他一些问题，但我找不到我正在寻找的东西。

我认为问题在于，一旦为特定卡调用 getValue 函数，它就不会再为该卡调用它。有没有办法让它再次调用 getValue 函数，例如，如果你用 ace 和 7（即 8 或 18）击中并且你得到 10（将​​其变为 18 或 28）。在我构建的游戏中，它在那种情况下会失败，因为它不会再次检查卡片以获得总数。

代码如下。我希望它在上下文中有意义，并且我已经很好地解释了这个问题。

```
function getValue($drawn, $total){
    $splitter = str_split($drawn);
    $value = $splitter[0];
    if($value == 'j' or $value == 'q' or $value == 'k' or $value == 1){
        $value = 10;
    }else if($value == 'a' and (($total + 11) > 21)){
        $value = 1;
    }else if($value == 'a' and (($total + 11) <= 21)){
        $value = 11;
    }else{
        $value = $value;
    }
    return $value;
}

function calculateScore($cardsArray){
    for($i = 0; $i < count($cardsArray); ++$i){
        $total += getValue($cardsArray[$i]);
    }
    return $total;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T00:55:55.177

如果您只想要 final 的最终分数`cardsArray`，您可以将数组从高到低排序，`rsort()`这样 ace 值总是最后计算，因此您以后不需要重新评估它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T07:53:37.907

需要“知道”当你有两个基于一组常见卡片的总价值可能性时，这是在这里使用 OOP 的一个很好的理由。

你可以有一个`hand`类，你处理`card`s，如果你的卡是`ace`你知道它有两个值。

收到 ace 后，您可以复制您的手并运行双手直到结束，或者您可以编写您的`hand`和`card`类，以便返回一个包含*所有可能总数*`$hand->getTotal()`的数组。

 *这对于 OOP 来说非常简单。*

# git - git：使用 --since 不会显示我想查看的所有提交

> ID：12118222
> 
> 赞同：1
> 
> 时间：2012-08-25T00:30:50.963
> 
> 标签：git

我正在使用这个：

```
git log --since="3 months ago" 
```

但它只是向我展示了最后 8 次提交（在过去两个月内或多或少地完成了）。

从我的 bitbucket 帐户中可以看到，我有一个更大的提交列表......那么我怎样才能从我的终端中看到它们呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T12:21:15.527

`git log`只会显示作为当前`HEAD`提交（您已签出的提交）的直接祖先的提交，因此它可能不会显示您期望的提交，因为它们位于其他分支上。

您可以添加`--all`标志，`git log`以便它显示所有分支上的提交：

```
git log --all --since='3 months ago' 
```

如果 bitbucket 中的提交是由其他人推送的，那么您也可能尚未获取它们，因此您可能需要先运行`git fetch`以确保您的远程跟踪分支是最新的。

# title - 前置轴标题

> ID：12118224
> 
> 赞同：0
> 
> 时间：2012-08-25T00:31:04.767
> 
> 标签：title, prefuse

如何在 prefuse 散点图中为轴赋予标题？

目前，我的代码从文件中读取数据，并且 x 轴和 y 轴的范围都在代码中起作用。我现在需要做的就是为轴添加标题/名称。我目前拥有的代码显示：

```
//set up the actions
AxisLayout xaxis = new AxisLayout(group, "GD",
Constants.X_AXIS, VisiblePredicate.TRUE); 

AxisLayout yaxis = new AxisLayout(group, POINTS,
Constants.Y_AXIS, VisiblePredicate.TRUE);

//yaxis.setScale(Constants.LOG_SCALE);
yaxis.setRangeModel(receiptsQ.getModel());
receiptsQ.getNumberModel().setValueRange(0,120,0,120);

xaxis.setLayoutBounds(m_dataB);
yaxis.setLayoutBounds(m_dataB);

// sets group,axis,values,bounds 
AxisLabelLayout ylabels = new AxisLabelLayout("ylab", yaxis, m_ylabB);
NumberFormat nf= NumberFormat.getInstance();
nf.setMaximumFractionDigits(0);
ylabels.setNumberFormat(nf);

// AxisLabelLayout xlabels = new AxisLabelLayout("goal diff", xaxis, m_xlabB, 15);
AxisLabelLayout xlabels = new AxisLabelLayout("xlab",xaxis,m_xlabB,5);

// vis.putAction("xlabels", xlabels);
vis.putAction("xlabels", xlabels); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T05:38:39.097

你必须手工完成。我已经这样做了，我的代码是开源的，所以欢迎你看一下：

[https://github.com/brycecr/msmexplorer/blob/acacia/MSMExplorer/src/edu/stanford/folding/msmexplorer/util/axis/AxisRotateRenderer.java](https://github.com/brycecr/msmexplorer/blob/acacia/MSMExplorer/src/edu/stanford/folding/msmexplorer/util/axis/AxisRotateRenderer.java)

[https://github.com/brycecr/msmexplorer/blob/acacia/MSMExplorer/src/edu/stanford/folding/msmexplorer/util/axis/AxisLabelLabelLayout.java](https://github.com/brycecr/msmexplorer/blob/acacia/MSMExplorer/src/edu/stanford/folding/msmexplorer/util/axis/AxisLabelLabelLayout.java)

在标签渲染器中，所有标签都绘制为线条和标签的组合。在这个类中，我们只是在我们的图表的布局中添加了一个额外的项目。

这根本不是超级干净......特别是，仍然为标签呈现一条线（实际上是一个像素），但我很懒，这适合我的需要......我认为如果有必要你可以改进它，但是您可能需要进入轴渲染器并使其不为您的标签项目绘制线条。

如果您对此操作有任何疑问，请告诉我。

```
 @Override
    public void run(double frac) {
        super.run(frac);

        setLabPos(item, length/2.0d + width, bounds);
    }

    /**
     * Set the layout values for an axis label item.
     */
    protected void setLabPos(VisualItem item, double xOrY, Rectangle2D b) {
        switch (getAxis()) {
            case Constants.X_AXIS:
                xOrY = super.isAscending() ? xOrY + b.getMinX() : b.getMaxX() - xOrY;
                PrefuseLib.updateDouble(item, VisualItem.X,  xOrY);
                PrefuseLib.updateDouble(item, VisualItem.Y,  b.getMaxY() + label.getFont().getSize()/3.0d + gridLab.getFont().getSize());
                PrefuseLib.updateDouble(item, VisualItem.X2, xOrY);
                PrefuseLib.updateDouble(item, VisualItem.Y2, b.getMaxY() + label.getFont().getSize()/3.0d + gridLab.getFont().getSize());
                break;
            case Constants.Y_AXIS:
                xOrY = super.isAscending() ? b.getMaxY() - xOrY - 1 : xOrY + b.getMinY();
                PrefuseLib.updateDouble(item, VisualItem.X,  b.getMinX());
                PrefuseLib.updateDouble(item, VisualItem.Y,  xOrY);
                PrefuseLib.updateDouble(item, VisualItem.X2, b.getMinX());
                PrefuseLib.updateDouble(item, VisualItem.Y2, xOrY);
        }
    }
   } 
```

# ruby-on-rails - <%= form_tag ... do %> 是如何实现的？

> ID：12118236
> 
> 赞同：4
> 
> 时间：2012-08-25T00:33:34.140
> 
> 标签：ruby-on-rails, erb

我试图弄清楚如何在 <%= ... %> 发射器中预示 Ruby 块。

'<% form_tag do %>' 部分没有问题，但是当我深入研究 Rails 内部结构并查看它如何使用 erb 处理模板时，生成的 Ruby 代码是无效的，因为挂起的 'do'。是否有一个隐藏在 Rails 中的后处理器在运行之前整理代码？如果是，它在哪里？如果不是，Rails 是如何从这种形式中提取 HTML 和 Ruby 代码的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T00:55:04.990

Rails 添加了一个[hack](https://github.com/rails/rails/blob/master/actionpack/lib/action_view/template/handlers/erb.rb#L17)，它使用正则表达式来确定传递给 erb 的内容是否是块表达式，然后以不同的方式处理它。

更详细的解释：[http ://timelessrepo.com/block-helpers-in-rails3](http://timelessrepo.com/block-helpers-in-rails3)

# javascript - iFrame 滚动条

> ID：12118237
> 
> 赞同：1
> 
> 时间：2012-08-25T00:33:50.937
> 
> 标签：javascript, iframe, scrollbar, same-origin-policy

又一个跨域 iFrame 问题！我到处搜索并相信这是不可能的，所以这里是：

iframe 的滚动条是该 iframe 窗口元素的一部分，因此由于相同的来源策略，我无法直接设置它们的样式。起初我认为我会很聪明，并在“轨道”容器中使用 jQuery UI 可拖动事件创建一个可滚动的 DIV。我设置了一个虚拟滚动条，一切正常，除了能够滚动 iframe ......再次因为相同的起源问题。

所以..

1.  如果 iframe 内容来自不同的域，是否可以设置 iframe 滚动条的样式？

或者

1.  如果 iframe 内容来自不同的域，有没有办法滚动 iframe？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T00:53:03.187

假设您可以以某种方式确定网站的大小，您可以将 iframe 的大小设置为该内容的大小......

```
<html>
<body>
<div style="width:400px; height:400px; overflow:scroll">
    <iframe src="http://www.w3schools.com/" style="width:1000; height:1300"></iframe>
</div>
</body>
</html> 
```

当然，那么你需要定期弄清楚网站的大小......

# python - SQLAlchemy 中的每列时间戳

> ID：12118238
> 
> 赞同：1
> 
> 时间：2012-08-25T00:34:06.830
> 
> 标签：python, sqlalchemy

我正在尝试在我的 SQLAlchemy 数据源中的实体和从其他地方（外部 REST API）拉入的实体之间执行每个字段的合并。我想做的是这样的：

```
class Person:
    __tablename__ = "people"
    id = Column(Integer,primary_key=True)
    name = Column(String)
    nameDatestamp = Column(DateTime)
    address = Column(String)
    addressDatestamp = Column(DateTime)

def merge(myPerson, foreignPerson):
   if myPerson.nameDateStamp < foreignPerson.nameDateStamp:
      myPerson.name = foreignPerson.name
      myPerson.nameDateStamp = foreignPerson.nameDateStamp
   if myPerson.addressDatestamp < foreignPerson.addressDateStamp:
      myPerson.addressDatestamp = foreignPerson.addressDateStamp
      myPerson.address = foreignPerson.address 
```

对于很多课程和很多领域。这似乎太冗长而不能成为最佳实践。

*   我可以引入新的数据模型，例如 DateStampedString（它将由一个日期戳和一个字符串组成）、DateStampedRelationship 等，但我担心使用多个表的额外间接性会提高合并的速度

*   我可以使用带有参数的 Python 装饰器，这些参数会在运行时和创建表之前将额外的日期戳列动态添加到我的模型中，例如

    ```
    @datestamp(name,address)
    class Person:
       ... 
    ```

*   也许我可以以某种方式利用`sqlalchemy.types.TypeDecorator`, 来构建一个新的数据类型，但它似乎对从 (opaque type)->(sqlalchemy type) 开始而不是将两种类型捆绑在一起感兴趣。

我正在尝试做的事情是否有最佳实践？

*编辑*：我正在寻找

1.  一种更简洁的方式来声明某些字段有日期戳
2.  某种方式来迭代带日期标记的字段，这样我的合并函数就不必知道它正在合并哪个键
3.  每当值更改时，通过某种方式使日期戳保持最新

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T01:12:56.780

## 通用合并

您可以通过查询对象轻松地迭代 ( `thing`, )。`datestamp`例如，如果您想获取地址和日期戳，您可以这样做：

```
session.query(Person.address, Person.addressDatestamp).all() 
```

这将返回一组 ( `address`, `addressDatestamp`) 元组。（它们实际上是命名元组，但您可以只使用索引）。如果您有一堆要更新的属性，则实际上不需要这样做。您可以动态执行此操作的一种方法是传递合并属性元组列表和作为 (Person, foreignPerson) 元组的查询并执行以下操作：

```
attrs = [("address", "addressDatestamp"), ("name", "nameDatestamp")]
person_tuples = # some way to generate (Person, ForeignPerson) tuples
def merge(attrs, person_tuples):
    for person, foreign in person_tuples:
        for attr, date in attrs:
            if getattr(person, date) < getattr(foreign, date):
                setattr(person, attr) = getattr(foreign, attr)
                setattr(person, date) = getattr(foreign, date)

    return person_tuples 
```

这将检查每个属性的日期戳，然后存储属性，如果外国是较新的（+ 也存储日期）。

如果您的属性始终在表单中`<attr>`，`<attr>Datestamp`那么您可以将其缩短为：

```
attrs = ["name", "address"]
def merge(attrs, person_tuples):
    for person, foreign in person_tuples:
        for attr in attrs:
            date = attr + "Datestamp"
            if getattr(person, date) < getattr(foreign, date):
                setattr(person, attr) = getattr(foreign, attr)
                setattr(person, date) = setattr(foreign, date) 
```

如果该属性有时可能不存在，您可以将 getattr 调用更改为`getattr(object, attr, default)`，它不会引发错误。

## 动态类

如果您希望能够动态生成带有日期戳的模型，您可以使用元类（稍微复杂一点，特别是因为它会干扰 SQLA 的声明性基础等），或者您可以创建一个类工厂，如下所示：

```
def datestamped_factory(class_name, attrlist, timestamp="Datestamp", superclass_list=None):
    superclass_list = superclass or (object,)
    cols = dict((attr, Column(String)) for attr in attrlist)
    cols.update(dict((attr + timestamp, Column(DateTime)) for attr in attrlist)
    cols["timestamped_attrs"] = attrlist
    # create a merge specific to the class (so only need to pass person_tuples)
    cols["merge"] = classmethod(lambda cls, person_tuples: merge(cls.timestamped_attrs, person_tuples))
    return type(class_name, superclass_list, cols) 
```

（可以将其添加到工厂`cols["class_merge"] = classmethod(lambda cls, person_tuples: merge(cls.timestamped_attrs, person_tuples`）））

要创建您的 person 方法，您可以执行以下操作：

```
class Base(sqlalchemy.declarative_base()):
     id = Column(Integer, primary_key=True)

Person = datestamped__factory("Person", ["name", "address"], superclass_list = (Base,))
Person.__tablename__ = "person" 
```

（替换`sqlalchemy.declarative_base()`为您正在使用的任何 Base 类......假设您正在使用 ORM）。

您可能会更花哨并编写一个元类，该元类可以找到所有作为字符串的列并向它们添加日期戳+创建适当的合并并创建适当地更新时间戳的方法，但这可能比您需要的更花哨。

# php - RadPHP、Xcode、Phonegap 和 Cordova 问题

> ID：12118241
> 
> 赞同：0
> 
> 时间：2012-08-25T00:35:34.500
> 
> 标签：php, xcode, cordova, radphp

简而言之，（尽可能简短）这是我的场景：

我刚刚试用了 RADPHP XE2，并为单页 iPad 应用程序创建了一个简单的界面。我已经通过 PhoneGap 导出了 PHP 设计，并将生成的 Xcode 文件移动到我的一台 Mac Mini 上。我的 Mac 上安装了 PhoneGap 和 Cordova。发生了两个问题，让我死在水里：

1.  当我将 PhoneGap bin 文件复制到终端应用程序并使用 .create 时，我没有得到预期的结果。相反，我收到一条错误消息，显示 cp 命令的用法。（？？）

2.  如果我尝试打开从 RADPHP 导出的项目文件，Xcode 将无法打开，说它是一个无效的项目文件。

我目前在最新版本的 OSX Mountain Lion、Xcode 4.4.1 和 iOS 5.1 上运行。

有什么建议或见解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:33:02.437

确保下载所需版本的 Cordova 以将其安装在 Mac OS X 系统中。请参阅[RadPHP XE2 文档的此页面](http://docwiki.embarcadero.com/RadPHP/en/IOS_Setup)，其中包括**Cordova 1.3.0**的下载链接。

# mysql - BASH 脚本从 mySQL 获取行数据并使用它来启动 PHP 脚本

> ID：12118243
> 
> 赞同：0
> 
> 时间：2012-08-25T00:35:50.760
> 
> 标签：mysql, bash

我已经尝试了几个小时将行数据存储到 BASH var 中，然后使用它来启动一些 PHP 脚本。

到目前为止，我只能回显整个结果集。我已经破坏了那个脚本，所以我什至不能把它粘贴到这里。这就是我所拥有的，根本不起作用。

```
#! bin/bash
query=`echo "SELECT id FROM searches WHERE running=1 AND id_user=2" | mysql -u root` 
```

我以前从未使用过 BASH，所以我完全迷路了。

我要的是一些资源，可以告诉我如何连接到 mysql，然后使用该行中的数据循环遍历结果集。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T01:01:55.303

您可以使用以下命令将`mysql --silent`输出读入 Bash var `while read`：

```
>sql="SELECT id FROM searches WHERE running=1 AND id_user=2"
>mysql --silent -u ctrahey test -e "$sql" |while read myid; do
 php -f my_processor.php $myid; 
done
> 
```

笔记：

*   `sql="...`设置你的 sql 的 Bash 变量（实际上不是必需的，只是帮助可读性）
*   `mysql -e`-e 选项允许您传入查询，因此您不需要 STDIN
*   `mysql --silent`--silent 抑制 mysql 通常会进行的额外格式化。在我的测试中，这实际上也是不必要的（输出中的管道字符并没有弄乱 Bash）
*   `php -f ..`这将执行一个 php 文件，将当前 id 作为 arg 传递。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T00:50:18.877

Bash 不是与 mysql 交互的好语言，它只适用于非常非常简单的情况。改用php（因为你提到了php），它有一个用于与mysql数据库进行交互的api。是的，您可以像运行bash 脚本一样[运行 php脚本。](http://php.net/manual/en/features.commandline.usage.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T00:59:10.420

如果要使用 MySQL 运行单个命令，请使用`mysql -e`或`mysql --execute`。它们是相同的命令，但第二个版本更令人难忘。如果将此标志添加到上面，则行将存储在变量中。

但是，正如geirha 所说，BASH 可能不是获取行数据的最佳语言。但是如果你选择解析它希望 BASH，`mysql -e`是正确的命令来执行查询。

# java - Java：使用 JOptionPane.showInputDialog(null, "Text"); 的多行文本

> ID：12118244
> 
> 赞同：15
> 
> 时间：2012-08-25T00:36:07.040
> 
> 标签：java, swing, text, joptionpane

我需要弹出一个文本，就像你`JOptionPane.showInputDialog(null, "Text");`用多行得到的那样，比如......

```
I'm new to java.
I have no background in programming.
I could use some help 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-25T00:41:27.617

你可以像这样使用'\n'：

```
JOptionPane.showMessageDialog(null, "Hello\nworld"); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-25T00:40:38.343

可能有十几种其他方法可以做到这一点，但我能想到的最简单的是

```
JOptionPane.showMessageDialog(null, "<html>I'm new to java.<br>I have no background in programming.<br>I could use some help Thanks!</html>"); 
```

另一种展示力量的方法`JOptionPane`

```
JTextArea msg = new JTextArea("This is a really silly example of what can be achieved with a JOptionPane, but this is going to excese for what you have asked for");
msg.setLineWrap(true);
msg.setWrapStyleWord(true);

JScrollPane scrollPane = new JScrollPane(msg);

JOptionPane.showMessageDialog(null, scrollPane); 
```

# objective-c - iOS应用程序冻结，但不会崩溃？

> ID：12118245
> 
> 赞同：1
> 
> 时间：2012-08-25T00:36:11.703
> 
> 标签：objective-c, ios, core-data, nspredicate

所以我的应用程序冻结并且不会响应触摸事件。它不会崩溃它只是坐在那里？

如果我按下暂停按钮 ||，它将在以下代码行停止。

```
 NSArray *results = [context executeFetchRequest:request error:&error]; 
```

如果我然后推送播放该应用程序仍然被冻结，如果我再次按下暂停它仍然指向上面的代码行。

这是它暂停的完整代码。

```
NSManagedObjectContext *context = [NSManagedObjectContext contextForCurrentThread];
NSEntityDescription *entity = [self entityDescriptionInContext:context];
NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:[entity name]];

NSPredicate *predicate = [NSPredicate predicateWithFormat:@"(thingId like[c] %@)", sessionID];
[request setPredicate:predicate];

NSError *error = nil;
NSArray *results = [context executeFetchRequest:request error:&error];  **<-- Pause lands me here**

if (!results || error || 0 == results.count){
    return nil;
}

return [results objectAtIndex:0]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T00:40:29.427

您正在执行的查询很可能会经过大量记录，并且需要很长时间才能获取这些记录。尝试在后台线程中进行获取，并将记录的 objectID 移动到主线程。应用程序不会崩溃，因为此时您正在运行调试器。如果直接从设备而不是 Xcode 运行应用程序，很可能会发生崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T18:26:36.190

找到了我不再使用“LIKE [c]”而现在使用“==”的答案。在获取任何内容时，我也不再在我的应用程序中使用 [AppDelegate managedObjectContext]，而是使用 contextForCurrentThread。

通过执行这两项操作，我的应用程序已停止冻结。

# haskell - Haskell IRC 机器人失速

> ID：12118246
> 
> 赞同：0
> 
> 时间：2012-08-25T00:36:12.953
> 
> 标签：haskell, bots, irc

我非常了解 Haskell，我正在为我的机器人编写 IRC 接口。我有以下问题：

运行代码后..

```
module Main (main) where

import Network
import Data.List
import System.IO

server = "irc.freenode.org"
port   = 6667
chan   = "#tanuki"
nick   = "DuckBot01"

main :: IO ()
main = do
    bot <- connect 
    run bot

connect :: IO Handle
connect = notify $ do
    h <- connectTo server (PortNumber (fromIntegral port))
    hSetBuffering h NoBuffering
    return $ Bot { socket = h }
  where
    notify a = do
        putStrLn ("Connecting to " ++ server ++ " ... ") >> hFlush stdout
        putStrLn "done."
        a

run :: Handle -> IO () 
run h = do
    write h "NICK" nick
    write h "USER" (nick++" 0 * :tutorial bot")
    write h "JOIN" chan
    listen h 
--
-- Process each line from the server
--
listen :: Handle -> IO ()
listen h = forever $ do
    s <- init `fmap` hGetLine h
    putStrLn s
    if ping s then pong s else eval h (clean s)
  where
    forever a = a >> forever a
    clean     = drop 1 . dropWhile (/= ':') . drop 1
    ping x    = "PING :" `isPrefixOf` x
    pong x    = write h "PONG" (':' : drop 6 x)

eval :: Handle -> String -> IO ()
eval     h "!quit"               = write h "QUIT" ":byebye" 
eval     _ _                     = return () -- ignore everything else

privmsg :: Handle -> String -> IO ()
privmsg h s = write h "PRIVMSG" (chan ++ " :" ++ s)

write :: Handle -> String -> String -> IO ()
write handle s t = do
    hPrint handle $ s ++ " " ++ t ++ "\r\n"
    putStrLn $ "> " ++ s ++ " " ++ t ++ "\n" 
```

我在终端中得到以下输出：

```
Loading package bytestring-0.9.2.1 ... linking ... done.
Loading package transformers-0.2.2.0 ... linking ... done.
Loading package mtl-2.0.1.0 ... linking ... done.
Loading package array-0.4.0.0 ... linking ... done.
Loading package deepseq-1.3.0.0 ... linking ... done.
Loading package text-0.11.1.13 ... linking ... done.
Loading package parsec-3.1.2 ... linking ... done.
Loading package unix-2.5.1.0 ... linking ... done.
Loading package network-2.3.0.10 ... linking ... done.
Connecting to irc.freenode.org ... 
done.
> NICK DuckBot01

> USER DuckBot01 0 * :tutorial bot

> JOIN #tanuki

:cameron.freenode.net NOTICE * :*** Looking up your hostname...
:cameron.freenode.net NOTICE * :*** Checking Ident
:cameron.freenode.net NOTICE * :*** Found your hostname
:cameron.freenode.net NOTICE * :*** No Ident response
ERROR :Closing Link: 127.0.0.1 (Connection timed out)
*** Exception: <socket: 8>: hGetLine: end of file 
```

为什么会超时？这不是我的连接，我的普通 IRC 客户端工作正常。帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T00:51:26.660

不是 100% 肯定，但我怀疑您的客户端在连接时动作太快。

IRC 服务器应该响应您发送的命令，但事实并非如此。IRC 服务器向您发送 ERROR 行的事实也表明这不是连接问题，但 IRC 服务器正在断开您的连接，因为您的客户端未按照协议运行。

尝试确保在代码发送它所做的三行之前等待 IRC 服务器开始发送数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T05:51:19.487

使用`hPutStr`而不是`hPrint`这样，您`\r\n`将正确呈现并发送到服务器。`hPrint`将为您提供与 相同的输出`show`，这不是您想要的。我最近也按照 Roll Your Own IRC Bot 页面制作了一个机器人，我坚持使用`hPrintf`.

`hPutStrLn`自动附加到您的字符串，因此如果这不是您想要的，则`\n`无需将其放入您的字符串中。`write`

此外，您应该更改此位。

```
return $ Bot { socket = h } 
```

您的函数应该返回 a`Handle`但您返回的是`Bot`尚未定义的 a 。只需将其更改为`return h`，您应该就可以了。（既然你已经编译好了，我假设你已经修复了它。）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-27T07:57:38.257

嗯，这里的问题是它连接的端口应该是 irc.freenode.net 的 8001 而不是 irc.freenode.org 的 6667。

# ubuntu - 为 OpenERP 创建 PPA

> ID：12118248
> 
> 赞同：1
> 
> 时间：2012-08-25T00:36:58.730
> 
> 标签：ubuntu, openerp, software-packaging

我正在调查是否值得在 Launchpad 中设置一个配方来为 OpenERP 创建一个 PPA，其中包括官方源代码以及我们的自定义模块。有没有人为 OpenERP 或其他软件包做过这个？值得付出努力吗？是否有该过程的简单指南？

我们目前正在使用一个脚本`bzr`来检查存储库中的新修订，将它们签出，然后将它们复制到实时服务器的安装文件夹中。听起来 PPA 会让升级过程更像是标准的 Ubuntu 升级。

我找到了[Launchpad 文档](https://help.launchpad.net/Packaging/PPA)和[Ubuntu 打包指南](http://developer.ubuntu.com/packaging/html/)，所以我正在研究这些内容。看起来[credativ 团队](https://code.launchpad.net/~credativ/+recipes)已经创建了 OpenERP 的 PPA。我可以复制这些并将它们指向我自己的分支吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T19:06:53.280

I've almost got it working, so here's a summary of what I've done so far.

It's well worth reading through the [Ubuntu packaging guide](http://developer.ubuntu.com/packaging/html/) and following the "Hello, World" example, just so you know what the packaging files do.

Specific to OpenERP, I stumbled across the [OpenERP Tools project](https://launchpad.net/openerp-tools), and used the `packaging61` script to create the Debian package. I published [a modified version](https://code.launchpad.net/~zaber/openerp-tools/zaber) that targets a Launchpad PPA.

I now have a package in [my PPA](https://launchpad.net/~donkirkby/+archive/ppa) that installs and runs, but there's something wrong with the web server. It supports the GTK client, though.

# c# - 并行 linq 排列

> ID：12118249
> 
> 赞同：0
> 
> 时间：2012-08-25T00:37:12.500
> 
> 标签：c#, linq, parallel-processing, compression, permutation

我想使用并行 linq 来加快对 GetCompressionRatio 的 where 调用，但所有 Plinq 语句的语法都不同，这是我第一次使用 linq。我无法处理并行输出，但我想尽快填写查询。

[并行 Linq 到对象集合](https://stackoverflow.com/questions/8745203/parallel-linq-to-object-collection)

```
static double GetCompressionRatio(string input)
{
    if (string.IsNullOrEmpty(input))
        throw new ArgumentNullException();

    MemoryStream ms = new MemoryStream();

    GZipStream gzip2 = new GZipStream(ms, CompressionMode.Compress, true);

    byte[] raw = Encoding.UTF8.GetBytes(input);
    gzip2.Write(raw, 0, raw.Length);
    gzip2.Close();

    byte[] zipped = ms.ToArray(); // as a BLOB
    int startsize = raw.Length;

    double percent = Convert.ToDouble(zipped.Length) / Convert.ToDouble(startsize);
    return percent;
}

var query = 
             from sp1 in polar
                    ...
             from vp15 in polar                           
             where GetCompressionRatio(sp1+...+vp15)>1.5      
             select sp1+...+vp15;

foreach (var element in query)
{
    //output
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T01:08:55.213

我将*.AsParallel()*添加到*极地*，它使处理器使用率增加了一倍

# c++ - libevent：未初始化的结构指针

> ID：12118250
> 
> 赞同：1
> 
> 时间：2012-08-25T00:37:19.867
> 
> 标签：c++, pointers, segmentation-fault, libevent

我在代码中有结构指针

```
struct evkeyvalq *headers; 
```

现在我调用一个函数来填充结构中的一些信息。

```
evhttp_parse_query(uri, headers) 
```

我在这条线上遇到分段错误。这样做的正确方法是什么。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T00:46:16.863

您需要为 struct evkeyvalq 分配一些内存。正如您的代码现在一样，您将未初始化的指针传递给 evhttp_parse_query() ，并且 evhttp_parse_query() 无法正常运行。

在堆栈上分配结构：

```
struct evkeyvalq headers;
evhttp_parse_query(uri, &headers); 
```

或者使用动态分配的内存：

```
struct evkeyvalq *headers = malloc(sizeof *headers);
if(headers != NULL) {
    evhttp_parse_query(uri, headers);
} 
```

# c# - C#中的exe字符串表？

> ID：12118253
> 
> 赞同：0
> 
> 时间：2012-08-25T00:37:29.423
> 
> 标签：c#, .net, string-table

如何在 C# 中读取/设置 exe 的字符串表？我不是指资源文件。我的意思是获取任何 exe，在 Visual Studio 中打开它，右键单击并选择“添加资源”，然后选择字符串表，它是一个 uint16 键和字符串值。

我如何在 C# 中访问它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T00:51:08.063

嗯......这很容易回答......虽然更难实现。

你需要做的是：

1.  创建一个[Visual Studio 扩展](http://msdn.microsoft.com/en-us/library/dd885119.aspx)。
2.  熟悉文件格式[Portable Executable](http://en.wikipedia.org/wiki/Portable_Executable)。
3.  了解如何将数据注入所述[Portable Executable](http://en.wikipedia.org/wiki/Portable_Executable)。
4.  编写代码来实现上述内容。

另一方面，我们在谈论哪种类型的可执行文件？有很多不同的种类，如果你的意思是任何种类，那么你会玩很长时间很长时间。

# c# - Linq 表达式中的 Int.Parse

> ID：12118258
> 
> 赞同：15
> 
> 时间：2012-08-25T00:38:48.823
> 
> 标签：c#, linq, entity-framework

我有以下 LINQ 表达式。`nvarchar`我想计算字段中数值的总和。我正在使用以下代码来执行此操作，但是当我尝试运行它时出现错误。

```
var m = new MaterialModelContainer();

var list = 
    (from x in
        (
            from inv in m.INVs
            join l in m.LIBs on inv.MESC equals l.MESC
            join o in m.OUTs on inv.MESC equals o.MESC
            join t in m.TRANs on inv.MESC equals t.MESC
            where t.TYPE == "60"
            select new
            {
                l.MESC,
                l.LINE_NO,
                l.UNIT_LINE,
                Description = l.DES + " " + l.PART_NO,
                inv.NEW_QTY,
                o.PJ,
                o.DATE,
                o.QTY,
                o.QTY_REC,
                TranQty = t.QTY,
                tranDate = t.DATE
            }
        )
        group x by
            new
            {
                x.MESC,
                x.LINE_NO,
                x.UNIT_LINE,
                x.Description,
                x.NEW_QTY,
                x.PJ,
                x.DATE,
                x.QTY,
                x.QTY_REC
            }
        into g
        select new
        {
            QTY_Consum_1 = g.Where(c => int.Parse(c.tranDate) >= cuDate && int.Parse(c.tranDate) <= endDate).Sum(d => int.Parse(d.TranQty))
        }
    ).ToList(); 
```

**错误描述：**

> LINQ to Entities 无法识别方法“Int32 Parse(System.String)”方法，并且该方法无法转换为存储表达式

我怎样才能解决这个问题并写出比这更好的代码？

我将代码更改为：

```
select new
{
    QTY_Consum_1 = g.Where(c => SqlFunctions.StringConvert(c.tranDate) >= cuDate && SqlFunctions.StringConvert(c.tranDate) <= endDate).Sum(d => SqlFunctions.StringConvert(d.TranQty)),
   g.Key.MESC
}
).ToList(); 
```

但收到此错误： ![在此处输入图像描述](../Images/571323a613c58ef4a4e509283220b34f.png)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-06-25T13:52:07.143

**英孚 5：**

而不是`int.Pasrse`使用`Convert.ToInt32`. Entity Framework 将`CAST`在 SQL 中生成适当的函数。

**英孚 6：**

*简短的回答：*

```
youEntity.Where(c=>SqlFunctions.StringConvert((decimal?)c.INTFIELD).Trim() == STRINGVALUE) 
```

*长答案：*

[在 EF 6 中，您必须使用SqlFunctions.StringConvert](http://msdn.microsoft.com/en-us/library/system.data.entity.sqlserver.sqlfunctions.stringconvert(v=vs.113).aspx)将数值转换为字符串。但它有一个问题。它会在结果中添加不必要的空格。所以比较会失败。这就是我放在`Trim()`那里的原因。我已经用 EF 6.1.1 对其进行了测试。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-25T01:10:40.773

实体框架无法将这种类型的转换转换为 SQL。

您是否有机会更改数据结构以使用正确的数据类型，例如实际`DateTime`类型？对于大数据量，这样的转换会影响性能。

我建议要么更改您的数据模型类型以避免这些转换，或者**如果数据量总是很小**，那么先获取数据，然后使用 Linq to Objects。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-25T00:44:08.680

在您的 where 子句中，您不能调用`int.Parse`. 实体框架不知道如何将其转换为 SQL。考虑修改你的`Where`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-25T00:59:10.997

`int.Parse`将您的所有替换为`SqlFunctions.StringConvert(variable)`. 没有将 String 转换为 Int 的函数。您应该尝试做相反的事情并使用 StringConvert 将您的 Int 转换为 String。

SqlFunctions 实用程序将能够将命令转换为 SQL 命令。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-08-25T01:58:47.813

你不能使用 int.parse in `where`。您可以像这样重写您的查询：

```
var list = (from x in
                (
                    from inv in m.INVs
                    join l in m.LIBs on inv.MESC equals l.MESC
                    join o in m.OUTs on inv.MESC equals o.MESC
                    join t in m.TRANs on inv.MESC equals t.MESC
                    where t.TYPE == "60" && t.QTY!=""
                    select new
                       {
                           l.MESC,
                           l.LINE_NO,
                           l.UNIT_LINE,
                           Description = l.DES + " " + l.PART_NO,
                           inv.NEW_QTY,
                           o.PJ,
                           o.DATE,
                           o.QTY,
                           o.QTY_REC,
                           TranQty = t.QTY,
                           tranDate = t.DATE

                      }
                ).ToList()
            group x by
                new
                    {
                        x.MESC,
                        x.LINE_NO,
                        x.UNIT_LINE,
                        x.Description,
                        x.NEW_QTY,
                        x.PJ,
                        x.DATE,
                        x.QTY,
                        x.QTY_REC
                    }
            into g
            select new
                {
                    QTY_Consum_1 = g.Where(c => int.Parse(c.tranDate) >= cuDate && int.Parse(c.tranDate) <= endDate).Sum(d => int.Parse(d.TranQty)),
                    g.Key.MESC
                }
           ).ToList(); 
```

调用`.ToList()`方法，然后使用`int.Parse(variable)`.

祝你今天过得愉快。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-03-11T16:37:45.647

有一个糟糕的数据库，我无法编辑，但必须使用它。

我在 Linq-To-Sql 中使用它并且它有效。

首先将字符串转换为对象，然后将其转换为 int。

```
 from s in db.Students
 select new
 {
     s.Name,
     s.Surname,
     Birthday = new DateTime((int)(object)(s.dateStr.Substring(0, 4)),
                             (int)(object)(s.dateStr.Substring(4, 2)),
                             (int)(object)(s.dateStr.Substring(6, 2))),
 } 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-08-31T14:49:19.503

当您需要确保可以在 LINQ to Entities 中使用 CLR 方法时，您最好查阅以下来源：[https://msdn.microsoft.com/en-us/library/vstudio/dd456828(v=vs.100) .aspx](https://msdn.microsoft.com/en-us/library/vstudio/dd456828(v=vs.100).aspx)。

不是快速阅读，这需要时间，但这是您问题的答案（还有更多类似的问题）。

# sql - 回滚 SQL Server 2012 序列

> ID：12118268
> 
> 赞同：3
> 
> 时间：2012-08-25T00:42:00.603
> 
> 标签：sql, sql-server, tsql, sql-server-2012, rollback

我有一个 SQL Server 2012 序列对象：

```
/****** Create Sequence Object ******/
CREATE SEQUENCE TestSeq
START WITH 1
INCREMENT BY 1; 
```

我有一个在事务中运行一些查询的 SP：

```
BEGIN TRAN

SELECT NEXT VALUE FOR dbo.TestSeq

<here all the query update code......>

ROLLBACK TRAN 
```

如果事务失败，所有更新都会毫无问题地回滚，但我猜序列没有回滚，因为它超出了事务的范围。

有什么线索可以处理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-21T10:26:24.997

声明一个存储所有序列号的表，然后使用如下所示的语句：

声明@SequenceNo int

```
 UPDATE MySequenceNumberTable
    SET @SequenceNo = SequenceNo = SequenceNo + 1
    WHERE SequenceName = 'Your sequence name' 
```

这里单个语句递增值，分配给变量并更新数据库表，以保证其原子操作。由于它是一个简单的数据库更新操作，它在数据库事务中起作用。如果事务回滚，则 SequenceNo 字段值将恢复为之前的值。

只有 catch 是下一个需要相同序列名称的下一个值的事务必须等到第一个事务由于行级锁定而被提交或回滚。在 DB 序列的情况下，没有序列锁定，因此它永远不会阻塞需要下一个值的其他事务。

在我们的例子中，我们根本不能有漏洞并且需要并发保护，所以我们使用上述方法并且它对我们来说工作正常。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-09-08T09:35:26.770

ROLLBACK 语句以下列方式用于取消整个事务：

```
BEGIN TRANSACTION
...
SQL Statement(s)

...
ROLLBACK TRANSACTION 
```

ROLLBACK 命令也可用于以下列方式取消部分事务：

```
BEGIN TRANSACTION
...
SQL Statement(s)

SAVE TRANSACTION savepoint_name

SQL Statement(s)

ROLLBACK TRANSACTION savepoint_name 
```

# c++ - 如果插槽对象包含互斥锁和条件变量，则 Boost signals2 connect() 调用无法编译

> ID：12118271
> 
> 赞同：0
> 
> 时间：2012-08-25T00:42:49.300
> 
> 标签：c++, boost, boost-thread

编译器：MSVS 2008

提升：1.49

代码：

```
#include <boost/signals2.hpp>
#include <boost/thread.hpp>

class SigOwner
{
public:
    typedef boost::signals2::signal<void (int)> OSig;
    OSig _signal;

    void doConnect(OSig::slot_type slot) { _signal.connect(slot); }
};

class SigUser
{
public:
#if defined(FAIL2)
    boost::mutex sync;
#endif
#if defined(FAIL1)
    boost::condition_variable evSig;
#endif

    void setup(SigOwner &so)
    {
        so.doConnect(*this);   // failure 1 traces back to this line
    }

    void operator()(int value) // signature to make SigUser a slot
    {
    }
};                             // failure 2 flags on this line 
```

如前所述，这可以编译。

如果我定义**FAIL1**（带或不带 FAIL2），编译器错误发生在`signals2/slot_template.hpp`：错误 C2679：二进制“=”：未找到采用“const SigUser”类型的右手操作数的运算符（或没有可接受的转换）

我不知道为什么`*this`被认为是 const。

如果我定义**了 FAIL2**（没有定义 FAIL1），在指示的行会发生编译器错误：错误 C2248：'boost::mutex::mutex'：无法访问在类'boost::mutex'中声明的私有成员

我不知道试图访问哪个私人成员。

谁能给我一个线索？最好是允许我定义 FAIL1 和 FAIL2 并获得成功编译的线索。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T09:17:08.937

既不`mutex`是也不`condition_variable`是可复制的，所以你的`SigUser`是不可复制的，所以你不能把它传递给`doConnect`这种方式。解决此问题的一种方法是将`sync`和定义`evSig`为（智能）指针。

# php - 在视图中显示会话数据

> ID：12118274
> 
> 赞同：0
> 
> 时间：2012-08-25T00:43:27.467
> 
> 标签：php, codeigniter

我正在从我的数据库中返回会话数据，但我无法显示我的表的 LastName 属性，而且我不知道为什么，因为 FirstName 成功返回。我的数据库中确实有 LastName 属性。我的观点给了我错误：消息：未定义索引：姓氏//文件名：控制器/home.php

这是我的模型

```
Class Membership_model extends CI_Model 
{

function __construct()
{
parent::__construct();
}

function validate_student($username,$password){
   $this -> db -> select('Student_ID, Firstname,Lastname, password');

   $this -> db -> from('Student');

   $this -> db -> where('Student_ID = ' . "'" . $username . "'");
   $this -> db -> where('password = ' . "'" . MD5($password) . "'");
   $this -> db -> limit(1);

    //If it is all correct

    $query = $this -> db -> get();

    if($query->num_rows() == 1){

         return $query->result();

    }else{
        return false;
    }
} 
```

## 控制器：家庭

```
 class Home extends CI_Controller {

     function __construct()
     {
       parent::__construct();
     }

     function index()
     {
       if($this->session->userdata('logged_in'))
       {
         $session_data = $this->session->userdata('logged_in');
         $data['Firstname'] = $session_data['Firstname'];
         $data['Lastname'] = $session_data['Lastname'];
         $this->load->view('home_view', $data);
       } 
```

* * *

主页视图：

```
<h2>Welcome <?php echo $Lastname; ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T01:25:41.937

打印会话数据，用它更新你的问题，`$session_data`错误是你没有索引**姓氏**， `$session_data['Lastname'];`

设置会话数据的表单`logged_in`，请同时更新您的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T09:28:21.320

这是一个简单的解决方案，肯定会解决问题

在控制器上添加此调试行并在内部数组说服后对其进行注释

```
$session = $this->session->userdata;

echo '<pre>';
   print_r($session);
echo '</pre>'; 
```

这是您查看会话变量的调试工具

并且请注意在条件上添加此行的条件会做

```
 function index()
         {
$session = $this->session->userdata;
           if(array_key_exists('logged_in',$session)) //Check if array key exists in session
           {
             $session_data = $this->session->userdata('logged_in');
             $data['Firstname'] = $session_data['Firstname'];
             $data['Lastname'] = $session_data['Lastname'];
             $this->load->view('home_view', $data);
           } 
```

# android - Android：动态分布的LinearLayout内容？

> ID：12118284
> 
> 赞同：0
> 
> 时间：2012-08-25T00:45:10.983
> 
> 标签：android, xml, android-linearlayout

我已经尝试了所有可以尝试的方法，但我开始怀疑这是不可能的。

我正在寻找的是基于宽度的（水平）LinearLayout 中 N 个子项的动态分布。有点像 HTML 表格，通过动态计算列宽。基本上我想把我的 ListView 变成一个动态计算宽度的表格，如下所示：

```
<table class="ListView">
  <tr class="LinearLayout"><td class="TextView">John:</td><td class="TextView">123-456-789</td></tr>
  <tr class="LinearLayout"><td class="TextView">Mike:</td><td class="TextView">321-654-987</td></tr>
  <tr class="LinearLayout"><td class="TextView">Sally:</td><td class="TextView">789-456-123</td></tr>
</table> 
```

我如何在 Android 中做类似的事情？请记住，我不只是想把它分成两个同样长的部分。我需要内容来确定列宽*并*填充整个 LinearLayout。像这样（假设只有两个子元素）：

```
[ [--TextView--] [--------TextView--------] ] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T02:29:45.117

无法使用`LinearLayout`. 您必须将 a`TableLayout`与`TableRow' having width`wrap_content` 中的所有元素一起使用。如果要显示的行数是动态的，那么您必须在 ViewGroup 中动态创建和插入行，否则对于静态数据来说非常简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T01:23:55.740

您可以`android:layout_weight="1"`为所有的`TextView`in进行设置`TableRow`，但使用过多的**权重**对性能不利。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T01:50:22.267

我猜你正在寻找这样的东西？

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:weightSum="100" >

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="This will take up much more space"
            android:layout_weight="20" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="test"
            android:layout_weight="80" />
    </LinearLayout>

</LinearLayout> 
```

![它会是什么样子。](../Images/4ece499e95d57c7a2bcf664824184080.png)

注意：“这将占用更多空间”的背景是灰色的，因为我在将鼠标悬停在该 TextView 上时截取了屏幕截图，以使其全长可见。

# objective-c - UIViewController 或 UIView 作为 UIWindow 顶部的 hud？

> ID：12118288
> 
> 赞同：0
> 
> 时间：2012-08-25T00:46:03.290
> 
> 标签：objective-c, uiview, uiviewcontroller, uiwindow, hud

无论我在应用程序中的哪个位置，我都想在我的应用程序顶部呈现一个`UIViewController`。`UIView`我想将此添加到`UIWindow`作为 hud 视图中。这可能吗？我应该如何开始接近这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:56:15.763

您可能可以使用 UIWindow 执行此操作，但很难做到这一点，尤其是当您需要用户能够同时与两个窗口进行交互时。更新、更好的方法（如果您愿意以 iOS 5 为目标）是使用新的视图控制器包含 API。

您创建一个根视图控制器，它承载两个子控制器：一个用于 HUD，一个用于主要内容。然后根视图控制器将它们放置在彼此之上，您可以与其中任何一个进行交互。

另一种选择是直接在（主）UIWindow 中使用原始 UIView（放置在普通视图控制器上方），而不使用 UIViewController。如果您愿意放弃使用视图控制器的便利（例如旋转回调、nib 加载、内存警告等），则此方法有效。为此，只需将您的视图添加为主窗口的子视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:17:04.060

看看我的答案：[https ://stackoverflow.com/a/4960988/202451](https://stackoverflow.com/a/4960988/202451)

它应该让你更接近做这样的自定义事情:)

# javascript - jQuery slideDown＆然后在计时器上滑动

> ID：12118292
> 
> 赞同：1
> 
> 时间：2012-08-25T00:46:28.787
> 
> 标签：javascript, jquery, timer, slidedown, slideup

我有一个简单的`.slideDown`功能：

```
$globalTabs.find('.seeMore a').live("click", function(){
     $globalTabs.find(".allTabs").slideDown('slow');
 }); 
```

当用户点击一个`<a>`in 时`.allTabs`，`.allTabs`执行一个`.slideUp`.

我想要做的是，如果用户没有单击任何内容`.allTabs`并且鼠标不再在 内`.allTabs`，则计时器启动以等待 x 时间量，然后执行`.slideUp`. 此外，如果鼠标`.allTabs`在触发之前再次进入`.slideUp`- 则计时器停止并在鼠标移出时重置`.allTabs`

不知道如何接近。任何帮助，将不胜感激。

基础标记：

```
<div class="allTabs">
   <a href="#">link 1</a>
   <a href="#">link 2</a>
   <a href="#">link 3</a>
   <a href="#">link 4</a>
</div> 
```

和：

```
<li class="seeMore"><a href="#">see more</a></li> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T01:12:20.300

你可以使用`setTimeout`and`clearTimeout`函数，注意`live`方法已经被弃用，你可以使用`on`方法来代替。

```
var timeout;

$(document).on({
    mouseenter: function(){
        clearTimeout(timeout)
    },
    mouseleave: function(){
        var $this = $(this)    
        timeout = setTimeout(function(){
           $this.slideUp('slow')         
        }, 500)
    },
}, ".allTabs") 
```

[小提琴](http://jsfiddle.net/72xSD/1/)

**更新：**

```
var timeout;

$(document).delegate(".allTabs", "mouseenter", function() {
    clearTimeout(timeout)
})

$(document).delegate(".allTabs", "mouseleave", function() {
    var $this = $(this)
    timeout = setTimeout(function() {
        $this.slideUp('slow')
    }, 1000)
}) 
```

[小提琴](http://jsfiddle.net/72xSD/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T01:03:35.770

设置一个计时器以在 的和 on的`slideup`回调中执行。取消定时器on 。`slidedown``mouseout``.allTabs``mouseover``.allTabs`

```
var $timer;

function hideAllTabs() {
    $globalTabs.find(".allTabs").slideUp('slow');
}
$globalTabs.find('.seeMore a').live("click", function(){
    $globalTabs.find(".allTabs").slideDown('slow', function() {
        $timer = setTimeout(hideAllTabs, 1000);
    });
});
$globalTabs.find(".allTabs").live("mouseout",function() {
    $timer = setTimeout(hideAllTabs, 1000);
});
$globalTabs.find(".allTabs").live("mouseover",function() {
    clearTimeout($timer);
}); 
```

​</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T01:12:32.747

试试这个方法：

```
$(function() {
    var $allTabs = $globalTabs.find(".allTabs");
    var timer;
    $globalTabs.find('.seeMore a').live("click", function(){
        $allTabs.slideDown('slow');
    });
    $allTabs.mouseout(function(){
        timer = setTimeout(function() {$allTabs.slideUp()}, 3000);
    });
    $allTabs.mouseover(function() {
        clearTimeout(timer);
    });
}); 
```

# php - 你能加载一个带有 JS 超时的 PHP 包含吗？

> ID：12118298
> 
> 赞同：0
> 
> 时间：2012-08-25T00:47:51.513
> 
> 标签：php, javascript, load, timeout

我有一些我不想立即加载的 PHP。

有可能做这样的事情吗？

```
<?php
  // ... snip ...
?>
<div class="footer">
    <other divs/>
    <script type="text/javascript">
        setTimeout( function() { 
            <?php include(CHILD_DIR . '/modules/partner-init.php'); ?>
        }, 10000);
    </script>
</div> 
```

这似乎有点草率，但在我开始之前，我想知道它是否是 a) 可能的，或者 b) 是否有更好的方法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T00:51:03.500

这是不可能的，包含将被放置在那里。PHP 在发送到客户端以执行 JS 之前在服务器上执行。

此外，只是这样做并看看会发生什么不会有什么坏处，它会帮助你学习。

如果您希望稍后执行 PHP，您可以在 AJAX 请求中请求页面。这将使 PHP 从请求中执行，这可以由 JS 控制/定时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T02:08:50.090

你真正想要的是不可能的，但显而易见的解决方案是在页面加载时在 html 中回显所有内容，并简单地隐藏有`div`问题的 or 元素。然后，您可以随时使用 javascript 显示它。

无需 ajax 或其他请求；它为您节省了往返服务器的时间。

# css - 将 li 标签垂直放置在 ul 标签的中间

> ID：12118304
> 
> 赞同：1
> 
> 时间：2012-08-25T00:49:24.803
> 
> 标签：css, stylesheet

我有一个`ul`标签，里面有`height:300px`一些标签。`li`

```
<ul>
   <li> some text</li>
   <li> some other text</li>
</ul> 
```

我想将此列表垂直放置在 ul 标签的中间。
我不想设置`posittion:absolute`。我测试了下面的css，但它不起作用！

```
ul{
  height: 300px;
  vertical-align: middle;
}
li{
  margin:auto;
} 
```

请给我一些CSS！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T01:30:13.760

像这样？

### CSS

```
ul {
    height: 300px;
    display: table-cell;
    vertical-align: middle;
    background-color: lime;
}

li {
    display: inline-block;
    background-color: fuchsia;
}​ 
```

### 演示

[JSFiddle](http://jsfiddle.net/WUAzv/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T01:44:21.267

这是我的解决方案，但它需要一个具有固定高度的附加元素（在本例中为 300px）。然后允许该`UL`元素默认为`height: auto;`，并通过隐藏的伪元素垂直对齐到中间。

[jsfiddle：元素垂直对齐到中间](http://jsfiddle.net/thirdender/RD3Fy/)

伪元素位于包含元素的外部和左侧，并设置为`vertical-align: middle;`.

```
container:before {
  cotent: '';
  display: inline-block;
  width: 100%;
  height: 100%;
  margin-left: -100%;
  vertical-align: middle;
} 
```

这允许容器的子元素与具有父元素高度的伪元素垂直对齐。

# python - 引用文件、路径和完整文件路径的 Pythonic 方式？

> ID：12118305
> 
> 赞同：0
> 
> 时间：2012-08-25T00:50:13.133
> 
> 标签：python

寻找一种清晰的方式来命名我的变量。下面是他们将存储的值的示例。

```
'IMG_5123.JPG'
'/path/to/IMG_5123.JPG'
'/path/to/'
 'JPG' 
```

我在想文件名，filename_full，路径，扩展名。是否有一种“正确”的方式来命名这些项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T00:52:50.650

你的变量对我来说看起来不错。如果您需要额外的灵感，您可以查看处理许多这些概念的 std lib ofr os.path：http: [//docs.python.org/library/os.path.html](http://docs.python.org/library/os.path.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T01:48:43.593

这只是我的观点，您当然可以选择任何您想要的方案。

因为它们都代表同一个文件名的一部分，所以我会在它们前面加上“文件名”或“fn”（如果它真的很清楚它的含义的话）。因此：filename、filename_abs、filename_path、filename_ext 或类似的集合。

如果他们要专门表示图像，我可能会修改它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T00:53:31.743

您应该阅读[pep 8](http://www.python.org/dev/peps/pep-0008/#descriptive-naming-styles)以了解 Python 中的正确样式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T06:53:26.073

在 Unix 和类 Unix 操作系统中，您有 dirname 和 basename 命令。如果您使用他们广泛使用的命名法，那么：

```
file basename: 'IMG_5123.JPG'
file name:     '/path/to/IMG_5123.JPG'
file dirname:  '/path/to/'
file suffix:   'JPG' 
```

但没有什么比这更整洁了。基名也称为文件名；该名称也称为完整路径名；目录名通常称为路径，后缀通常称为扩展名。

# windows - 通过 windows 命令提示符使用密码验证执行 ssh

> ID：12118308
> 
> 赞同：100
> 
> 时间：2012-08-25T00:50:41.653
> 
> 标签：windows, ssh, command-line, passwords

我需要通过以非交互方式提供密码来从**Windows 命令行执行****ssh 。**我可以实现基于密钥的身份验证并能够像执行 ssh 命令一样

 **```
ssh <user>@<host> <command> 
```

有没有类似的命令

```
ssh <user>@<host> -P <password> <command> 
```

[![在此处输入图像描述](../Images/e36255d9fc6cc711cab948d24a48f066.png)](https://i.stack.imgur.com/j08GP.png)

我不知道这是否可行。但是，可以有一些解决方法。给我一些想法来完成同样的事情。

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2013-01-23T21:53:16.727

[sshpass](http://sourceforge.net/projects/sshpass/)实用程序正是为此而设计的。首先，通过键入以下命令安装 sshpass：

```
sudo apt-get install sshpass 
```

然后在你的 ssh/scp 命令前面加上

```
sshpass -p '<password>' <ssh/scp command> 
```

使用 Linux 时，该程序最容易安装。

用户应考虑改用 SSH 更安全的公钥认证（使用`ssh`命令）。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2014-09-08T13:01:48.007

这个期望脚本呢？

```
#!/usr/bin/expect -f
spawn ssh root@myhost
expect -exact "root@myhost's password: "
send -- "mypassword\r"
interact 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-08-25T02:50:40.737

PuTTY 的 plink 有[一个 password 的命令行参数](http://the.earth.li/~sgtatham/putty/0.62/htmldoc/Chapter7.html#plink-usage)。[在这个问题的答案中](https://stackoverflow.com/q/1340366/163956)还提出了一些其他建议：使用 Expect（可用于 Windows），或使用 Paramiko 在 Python 中编写启动器。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-07-09T11:37:12.610

**视窗**解决方案

1.  安装[腻子](https://putty.org/)
2.  按`Windows-Key + R`
3.  进入`putty.exe -ssh [username]@[hostname] -pw [password]`

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-03-08T04:06:09.347

**PowerShell 解决方案**

使用 Posh-SSH：

```
New-SSHSession -ComputerName 0.0.0.0 -Credential $cred | Out-Null
Invoke-SSHCommand -SessionId 1 -Command "nohup sleep 5 >> abs.log &" | Out-Null 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-07T20:34:21.653

这篇[文章](https://stackoverflow.com/a/57479820)是您问题的有效解决方案。

1.  在你的 Windows 机器上安装 PuTTY
2.  执行'plink your_username@yourhost -pw your_password'

如果您使用 Windows 终端并且希望您的 shell 在打开新选项卡时登录到远程计算机，您可以配置命令行参数（设置 -> 外壳 -> 命令行）：

```
C:\Users\USERNAME\AppData\Local\Microsoft\WindowsApps\Microsoft.PowerShell.ID\pwsh.exe
-Command "plink USERNAME@192.168.0.1 -pw PASSWORD" 
```**

# asp.net - nHibernate 3.3.1 System.Security.Permissions.ReflectionPermission 错误

> ID：12118315
> 
> 赞同：0
> 
> 时间：2012-08-25T00:52:23.663
> 
> 标签：asp.net, nhibernate, medium-trust

我试图让我的 Web 应用程序用 ASP.NET 4.0 编写，使用中等信任在本地工作。我使用 Go Daddy 作为网络主机，他们在共享主机上使用中等信任。我已经读到 nHibernate 现在可以在 3.3 中开箱即用地与 Medium Trust 站点一起使用，但我无法终生工作。

只需添加：

```
<trust level="Medium" /> 
```

在我的 web.config 中，我的 Web 应用程序因以下错误和堆栈跟踪而崩溃：

```
Request for the permission of type 'System.Security.Permissions.ReflectionPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.

at System.Security.CodeAccessSecurityEngine.Check(Object demand, StackCrawlMark& stackMark, Boolean isPermSet)
   at System.Security.CodeAccessSecurityEngine.Check(CodeAccessPermission cap, StackCrawlMark& stackMark)
   at System.Security.CodeAccessPermission.Demand()
   at System.Reflection.Emit.DynamicMethod.PerformSecurityCheck(Type owner, StackCrawlMark& stackMark, Boolean skipVisibility)
   at System.Reflection.Emit.DynamicMethod..ctor(String name, Type returnType, Type[] parameterTypes, Type owner, Boolean skipVisibility)
   at NHibernate.Bytecode.Lightweight.ReflectionOptimizer.CreateDynamicMethod(Type returnType, Type[] argumentTypes)
   at NHibernate.Bytecode.Lightweight.ReflectionOptimizer.GenerateGetPropertyValuesMethod(IGetter[] getters)
   at NHibernate.Bytecode.Lightweight.ReflectionOptimizer..ctor(Type mappedType, IGetter[] getters, ISetter[] setters)
   at NHibernate.Bytecode.Lightweight.BytecodeProviderImpl.GetReflectionOptimizer(Type mappedClass, IGetter[] getters, ISetter[] setters)
   at NHibernate.Tuple.Entity.PocoEntityTuplizer.SetReflectionOptimizer()
   at NHibernate.Tuple.Entity.PocoEntityTuplizer..ctor(EntityMetamodel entityMetamodel, PersistentClass mappedEntity)
   at NHibernate.Tuple.Entity.EntityEntityModeToTuplizerMapping..ctor(PersistentClass mappedEntity, EntityMetamodel em)
   at NHibernate.Tuple.Entity.EntityMetamodel..ctor(PersistentClass persistentClass, ISessionFactoryImplementor sessionFactory)
   at NHibernate.Persister.Entity.AbstractEntityPersister..ctor(PersistentClass persistentClass, ICacheConcurrencyStrategy cache, ISessionFactoryImplementor factory)
   at NHibernate.Persister.Entity.SingleTableEntityPersister..ctor(PersistentClass persistentClass, ICacheConcurrencyStrategy cache, ISessionFactoryImplementor factory, IMapping mapping)
   at NHibernate.Persister.PersisterFactory.CreateClassPersister(PersistentClass model, ICacheConcurrencyStrategy cache, ISessionFactoryImplementor factory, IMapping cfg)
   at NHibernate.Impl.SessionFactoryImpl..ctor(Configuration cfg, IMapping mapping, Settings settings, EventListeners listeners)
   at NHibernate.Cfg.Configuration.BuildSessionFactory()
   at NHibernate.DataAccess.WebTest.Code.NHibernateHelper.get_SessionFactory()
   at NHibernate.DataAccess.WebTest.Code.NHibernateHelper.OpenSession()
   at NHibernate.DataAccess.WebTest._Default.Page_Load(Object sender, EventArgs e)
   at System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e)
   at System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e)
   at System.Web.UI.Control.OnLoad(EventArgs e)
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) 
```

这似乎与我读到的错误相同，但到目前为止我发现的所有修复程序似乎都没有对我有用。我什至尝试过 NHibernate.DependencyInjection Nuget 包，但出现相同错误但堆栈跟踪不同的错误，这发生在 Initializer ctor 中。

我觉得我错过了一些明显的东西来完成这项工作，但我不能指望它。有没有人在中等信任下运行 nHibernate 3.3.1 有任何成功？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T19:59:35.070

我可以通过关闭 ado 批处理来完成这项工作。我在这里找到了答案，[http://blog.ondrejsv.com/post/N2CMS-NHibernate-SqlCommandSet-and-medium-trust.aspx](http://blog.ondrejsv.com/post/N2CMS-NHibernate-SqlCommandSet-and-medium-trust.aspx)。警告，我还没有将它迁移到生产环境；这只是在我的笔记本电脑上（YMMV）。

```
<property name="adonet.batch_size">0</property> 
```

我尝试了 NHibernate.DependencyInjection 包，但它没有用。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T17:30:22.887

我与我的中等信任提供商一起使用开箱即用的 NH 3.3.1。但是，可能还有其他东西可以帮助您。Ranzlee安装此[软件包](http://nuget.org/packages/NHibernate.DependencyInjection)：-

```
PM> Install-Package NHibernate.DependencyInjection 
```

要启动并运行它，只需使用

```
protected void Application_Start() {
  Initializer.RegisterBytecodeProvider();
  ...
  Rest of configuration code here
} 
```

# css - HTML5 标签（自动对焦，必需，type="email" 在 IE9 中不起作用

> ID：12118317
> 
> 赞同：0
> 
> 时间：2012-08-25T00:52:45.417
> 
> 标签：css, html, internet-explorer, cross-browser

我正在使用 html 5 标签，如 header、section、nav、article、autofocus、required、input type="email" 和模式。

我注意到 autofocus,type="email" 和模式不起作用，我已经使用了 eric css reset 和

```
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]--> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T01:05:11.837

IE9 是一个无能的浏览器，在众多其他事物中，这在 IE9 中不起作用。[http://www.quirksmode.org/html5/inputs.html](http://www.quirksmode.org/html5/inputs.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T01:12:40.550

您可以在这里测试浏览器的兼容性：http: [//www.html5test.com](http://www.html5test.com) Chrome 支持 HTML5 的大部分功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T01:28:13.380

我最近发现了一个很棒的库，叫做[Webshims Lib](http://afarkas.github.com/webshim/demos/index.html)。该库与[Modernizr](http://modernizr.com/)协同工作以确定浏览器具有哪些功能，然后填充缺失的功能。

库的[表单部分](http://afarkas.github.com/webshim/demos/demos/webforms.html)非常漂亮，应该可以很好地满足您的需求。它处理尚不支持的浏览器（如 IE9）中的大多数新 HTML5 表单功能。

我强烈建议尝试一下。

# asp.net-mvc-3 - 具有多个 htmlAttributes 的 Html.BeginForm

> ID：12118322
> 
> 赞同：7
> 
> 时间：2012-08-25T00:53:27.813
> 
> 标签：asp.net-mvc-3

我正在使用 Html.BeginForm 并按如下方式传递一个 css 类：

```
@using (Html.BeginForm("Logon", "Account", FormMethod.Post, new { @class = "form" } )) 
```

这工作正常，但我想在它之后添加一个 returnURL 查询字符串参数，但这似乎不起作用：

```
@using (Html.BeginForm("Logon", "Account", FormMethod.Post, new { @class = "form", returnUrl = Request.QueryString["ReturnUrl"] })) 
```

如何添加多个 htmlAttributes 以便我可以告诉它我的 css 类和查询字符串参数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T01:01:18.243

使用以下[重载](http://msdn.microsoft.com/en-us/library/dd460542%28v=vs.108%29.aspx).`BeginForm`

```
@using (Html.BeginForm("Logon", "Account", 
        new { returnUrl = Request.QueryString["ReturnUrl"] }, FormMethod.Post, 
        new { @class = "form"})) 
```

# ios - 从 UIPopoverController 访问父控制器的成员

> ID：12118326
> 
> 赞同：1
> 
> 时间：2012-08-25T00:54:21.587
> 
> 标签：ios, uipopovercontroller, member

如何访问在该 UIPopoverController 内调用 UIPopoverController 的控制器的成员？

调用 UIPopoverController 的控制器被设置为弹出窗口的委托（不确定这是否对我有帮助）：

```
self.popover = [[UIPopoverController alloc] initWithContentViewController:theView];
[self.popover setDelegate: self]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T01:00:55.843

您访问它们的方式与从任何其他视图控制器访问成员的方式相同：您需要对父视图控制器的引用。例如，您可以在弹出视图控制器上拥有一个指向父视图控制器的成员变量。（您可能希望使此类引用变弱或不保留。）该成员通常是弹出视图控制器的“代表”。

你可以`theView`在展示它之前设置它，或者将它传递给它的初始化器。

（我不确定，但您也可以尝试查看`parentViewController`或`presentingViewController`查看弹出视图控制器。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T01:13:00.407

最好的方法是使用属性

`@property double ivar`（我记得）这种方式你会这样称呼它。

```
double test = self.popover.ivar; 
```

或者也许`double test = [self.popover ivar]`。两者都应该工作。

为此，请确保您`@synthesize ivar;`在主控制器的 .m 文件中或将方法设置为 getter

对于方法，如果是双精度，

```
- (double)ivar
{
     return 5;
} 
```

是一个例子。如果要返回实例变量，最好返回它的副本。例子：

```
return [ivar2 copy]; 
```

如果您使用方法方式，请确保方法与 .h 文件中的变量同名。

希望我有所帮助！

编辑：用 UIView 替换那个“双重”的东西，只是说

# matlab - 相当于 Matlab 在 CUDA 中的 find 命令

> ID：12118328
> 
> 赞同：4
> 
> 时间：2012-08-25T00:54:27.733
> 
> 标签：matlab, cuda, find, jacket

我想尽快找到矩阵的非零元素。考虑到`CUDA`\ `Jacket`，我了解到这比“常规” CPU 版本`Matlab`的 find 慢得多，这可能是由于内存分配问题，因为在 find 函数之前输出的大小是未知的。但是，使用`bwlabel`and `regionprops`（两者都在 中支持`Jacket`）确实有效地产生了有关非零元素的信息，并且比`Matlab`内置的 Image Processing Toolbox 函数快得多。有没有办法利用它来获得非零元素？有没有办法对使用找到的每个标记对象进行一些处理`bwlabel`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T21:50:08.390

以我的经验，Jacket 支持的 FIND 实现非常快，至少对于大于 300x300 左右的矩阵。我在笔记本电脑上对此进行了测试，并在下面分享了结果。我的硬件规格是：

```
>> ginfo
Jacket v2.2 (build 77be88c) by AccelerEyes (64-bit Windows)
License: Standalone (C:\Program Files\AccelerEyes\Jacket\2.2\engine\jlicense.dat)
Addons: MGL16, JMC, SDK, DLA, SLA
CUDA toolkit 4.2, driver 4.2 (296.10)
GPU1 GeForce GT 540M, 2048 MB, Compute 2.1 (single,double)
Display Device: GPU1 GeForce GT 540M
Memory Usage: 1697 MB free (2048 MB total) 
```

CPU是英特尔酷睿i7-2630QM。

我知道夹克在 CPU 上的 FIND 功能上达到了约 3 倍的加速。这是我使用的基准代码：

```
% time Jacket vs CPU
for n = 5:12;
    x(n) = 2^n;
    Ac = single(rand(x(n)));
    Ag = gsingle(Ac);
    t_cpu(n) = timeit(@() find(Ac > 0.5));
    t_gpu(n) = timeit(@() find(Ag > 0.5));
end

% plot results
plot(x, t_cpu ./ t_gpu);
xlabel('Matrix Edge Size', 'FontSize', 14);
ylabel('Jacket (GPU) Speedup over CPU', 'FontSize', 14); 
```

以下是运行此代码的结果：

![夹克 (GPU) 对 CPU 的加速](../Images/08fc13c067272e731bf75ec4ed1dbd0c.png)

我确信 Jacket 支持的 BWLABEL 和 REGIONPROPS 函数也非常快，但是在上面的基准测试中，您可能可以使用 FIND 本身。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-07-30T05:06:58.950

除了 arrayfire 讨论的之外，另一种可能性是使用 CUDA Thrust。下面，我将发布一个简单的示例，其中根据`(x, y)`阈值选择 2D 域上的粒子。我应该很容易适应海报感兴趣的情况，或者更一般地说，模拟`Matlab`'s的行为`find`。

**代码**

```
#include <thrust/gather.h>
#include <thrust/iterator/counting_iterator.h>
#include <thrust/iterator/permutation_iterator.h>
#include <thrust/functional.h>
#include <thrust/copy.h>
#include <thrust/device_vector.h>
#include <iostream>

struct isWithinThreshold {

    double2 thresholdPoint;

    __host__ __device__ isWithinThreshold(double2 thresholdPoint_) { thresholdPoint = thresholdPoint_; };

    __host__ __device__ bool operator()(const double2 r) {
        return ((r.x > thresholdPoint.x) && (r.y > thresholdPoint.y));
    }
};

/********/
/* MAIN */
/********/
int main()
{
    const int N = 5;
    double2 thresholdPoint = make_double2(0.5, 0.5);

    thrust::host_vector<double2> particleCoordinates(N);
    particleCoordinates[0].x = 0.45;    particleCoordinates[0].y = 0.4;
    particleCoordinates[1].x = 0.1;     particleCoordinates[1].y = 0.3;
    particleCoordinates[2].x = 0.8;     particleCoordinates[2].y = 0.9;
    particleCoordinates[3].x = 0.7;     particleCoordinates[3].y = 0.9;
    particleCoordinates[4].x = 0.7;     particleCoordinates[4].y = 0.45;

    // --- Find out the indices
    thrust::host_vector<int> indices(N);
    thrust::host_vector<int>::iterator end = thrust::copy_if(thrust::make_counting_iterator(0),
        thrust::make_counting_iterator(N),
        particleCoordinates.begin(),
        indices.begin(),
        isWithinThreshold(thresholdPoint));
    int size = end - indices.begin();
    indices.resize(size);

    // --- Fetch values corresponding to the selected indices
    thrust::host_vector<double2> values(size);
    thrust::copy(thrust::make_permutation_iterator(particleCoordinates.begin(), indices.begin()),
        thrust::make_permutation_iterator(particleCoordinates.end(), indices.end()),
        values.begin());

    for (int k = 0; k < size; k++)
        printf("k = %d; index = %d; value.x = %f; value.y = %f\n", k, indices[k], values[k].x, values[k].y);

    return 0;
} 
```

# android - 用 Flex 编写的 Facebook 应用程序的“Android 类名称”是什么？

> ID：12118337
> 
> 赞同：7
> 
> 时间：2012-08-25T00:55:57.040
> 
> 标签：android, facebook, apache-flex

设置 Facebook 应用程序时，它需要一个 Android 包名称和 Android 类名称。

第一部分很简单，Google Play 甚至在我的应用程序列表中显示了这一点。

如何找到 Flex 应用程序的 Android 类名称？

![Facebook 应用程序设置](../Images/7f2f3f15f24ec10c9266d4f70c764578.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:23:48.923

正如您猜对的那样，包名称很简单，可以通过查看 google play url 或在 google play 的应用程序列表部分中获得。
但实际上，Google Play 本身就是从 AndroidManifest.xml 文件中获取名称的。
您可以从 AndroidManifest.xml 文件中找到包名和类名。
无论您使用什么工具来构建应用程序，它最终都必须是一个 APK 文件，并且清单 xml 文件将在 apk 中。
如果查看清单 xml 文件，Android 包名称是“package=”属性元素下的值。
例如 - 如果该行读取 - package="com.example.APP1"，那么您的 Android 包名称是 - com.example.APP1。
对于 Android 类名称，您应该查看清单文件并确定它是哪个活动，它引用了 MAIN 和 LAUNCHER 操作。
它通常以“。”开头。
例如，如果它显示“.MainClass”，那么您的 Android 类名称将变为 - com.example.APP1.MainClass（使用 com.example.APP1 作为上面的应用程序包名称。
希望对您有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-30T06:02:08.733

根据这个[链接](http://www.jamesward.com/2011/05/11/extending-air-for-android/)，

> 该类名为 AppEntry，其包名称取决于 AIR 应用程序 ID，但始终以“air”开头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T07:52:00.437

“Android 类名”是指在 AndroidManifest.xml 中定义的应用程序 Launcher Activity 的类名。应在您的 Android Manifest.xml 中使用以下意图过滤器定义

```
<intent-filter >
      <action android:name="android.intent.action.MAIN" />
      <category android:name="android.intent.category.LAUNCHER" />
</intent-filter> 
```

# twitter-bootstrap - 推特引导按钮点击

> ID：12118340
> 
> 赞同：0
> 
> 时间：2012-08-25T00:56:49.823
> 
> 标签：twitter-bootstrap

我正在为我的新网站使用引导程序。我想使用按钮插件。不是将 jquery.trigger 代码添加到 bootstrap-button.js 中，而是当前的最佳做法是在单击按钮时显示警报？

引导按钮.js：

```
 Button.prototype.toggle = function () {
    var $parent = this.$element.parent('[data-toggle="buttons-radio"]')

    $parent && $parent
      .find('.active')
      .removeClass('active')

    this.$element.toggleClass('active')

      this.$element.trigger('button-change') //added code

  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:04:27.967

通过直接编辑 Bootstrap 插件，它不仅消除了使用 CDN 的可能性，而且还使升级到未来版本变得复杂。出于这个原因，通常最好的做法是在不进行此类更改的情况下实现其他行为。许多 Twitter Bootstrap 插件提供了各种事件来实现这种做法。在那些不触发事件的插件中，添加此类事件可以说是不必要的。

在这种特殊情况下，Button 插件不会更改**click**事件（不进行`preventDefault()`或`stopPropagation()`调用），因此只需将其他侦听器附加到**click**事件本身就可以了。

例如：

```
$('body').on('click.myListener', '[data-toggle=^button]', function (e) {
  // do something
  console.log(e.target); // originating button
}); 
```

# c# - 从大图像中检测图像的更快方法

> ID：12118343
> 
> 赞同：1
> 
> 时间：2012-08-25T00:57:43.593
> 
> 标签：c#, image-processing

目前我用它来查找屏幕上另一个图像中出现的位图，即一个窗口，但它的工具很慢，我希望它花费 1 秒或更短的时间，我正在考虑将图像裁剪成一个部分，即 80,60在图像的 0,0 点处的部分并在那里搜索，当它完成时，它会进行相同的裁剪，但 y+60 并继续，直到它覆盖了整个图像，假设它是 800 x 600 像素

我目前使用的代码是：

```
 public bool findImage(Bitmap small, Bitmap large, out Point location)
    {
        //Loop through large images width
        for (int largeX = 0; largeX < large.Width; largeX++)
        {
            //And height
            for (int largeY = 0; largeY < large.Height; largeY++)
            {
                //Loop through the small width
                for (int smallX = 0; smallX < small.Width; smallX++)
                {
                    //And height
                    for (int smallY = 0; smallY < small.Height; smallY++)
                    {
                        //Get current pixels for both image
                        Color currentSmall = small.GetPixel(smallX, smallY);
                        Color currentLarge = large.GetPixel(largeX + smallX, largeY + smallY);
                        //If they dont match (i.e. the image is not there)

                        if (!colorsMatch(currentSmall, currentLarge))
                            //Goto the next pixel in the large image

                            goto nextLoop;
                    }
                }
                //If all the pixels match up, then return true and change Point location to the top left co-ordinates where it was found
                location = new Point(largeX, largeY);
                return true;
            //Go to next pixel on large image
            nextLoop:
                continue;
            }
        }
        //Return false if image is not found, and set an empty point
        location = Point.Empty;
        return false;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T01:09:52.487

由于您正在寻找精确匹配，因此您可以对大图片进行下采样，并对小图片进行下采样（但多次，在不同的偏移量处）。然后搜索下采样图片的完全匹配（可能递归）。

您的大图片听起来没有*那么*大，您可以通过 Boyer-Moore 搜索其中一条线来逃脱。

# ios - 使用 UISplitViewController 进行 iOS 页面转换

> ID：12118344
> 
> 赞同：0
> 
> 时间：2012-08-25T00:58:25.360
> 
> 标签：ios, animation, uisplitviewcontroller, uisplitview

我想在 UISplitView 中为页面过渡设置动画。我正在使用的代码是...

```
NSUInteger row = indexPath.row;

    UIViewController <SubstitutableDetailViewController> *detailViewController = nil;

if (row == 0) {
    FirstDetailViewController *newDetailViewController = [[FirstDetailViewController alloc] initWithNibName:@"FirstDetailView" bundle:nil];
    detailViewController = newDetailViewController;
}

if (row == 1) {
    SecondDetailViewController *newDetailViewController = [[SecondDetailViewController alloc] initWithNibName:@"SecondDetailView" bundle:nil];
    detailViewController = newDetailViewController;
}

NSArray *viewControllers = [[NSArray alloc] initWithObjects:self.navigationController, detailViewController, nil];
splitViewController.viewControllers = viewControllers;
[viewControllers release];

if (popoverController != nil) {
    [popoverController dismissPopoverAnimated:YES];
}

if (rootPopoverButtonItem != nil) {
    [detailViewController showRootPopoverButtonItem:self.rootPopoverButtonItem];
}

[detailViewController release]; 
```

我怎样才能做到这一点？谢谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T01:06:50.007

使用[UIPageViewController](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewControllerCatalog/Chapters/PageViewControllers.html)作为拆分视图的详细视图控制器。它支持页面动画和过渡。

# user-interface - Unity3D GUI 键盘导航

> ID：12118345
> 
> 赞同：1
> 
> 时间：2012-08-25T00:58:46.053
> 
> 标签：user-interface, input, keyboard, unity3d

我为我的菜单脚本编写了代码功能，该功能允许浏览构成菜单的按钮（通过使用 GUI.FocusControl() 将焦点从按钮更改为按钮）。但是，我对如何“激活”/“选择”当前关注的按钮感到困惑。理想情况下，当用户处于他或她希望选择的选项时，用户可以在菜单中上下导航并按下“输入”。任何建议都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T22:23:26.177

我花了一段时间才弄清楚如何做到这一点，但最终我找到了解决方案。如果您仍在寻找答案，这就是我的做法。基本上你想利用 GUI 类的 SelctionGrid 函数。你可以在[这里](http://docs.unity3d.com/Documentation/ScriptReference/GUI.SelectionGrid.html)看看它是如何工作的，但这里有一些代码，其中包含你所要求的工作示例：

```
#pragma strict
@script ExecuteInEditMode;

var selGridInt : int = 0;    //This integer is the index of the button we are hovering above or have selected

var selStrings : String[] = ["Grid 1", "Grid 2", "Grid 3", "Grid 4"];

private var maxButton : int;    // The total number of buttons in our grid

function Start()
{
    maxButton = selStrings.Length;    // Set the total no. of buttons to our String array size
}

function Update()
{
    // Get keyboard input and increase or decrease our grid integer
    if(Input.GetKeyUp(KeyCode.UpArrow))
    {
        // Here we want to create a wrap around effect by resetting the selGridInt if it exceeds the no. of buttons
        if(selGridInt > 0)
        {
            selGridInt--;
        }
        else
        {
            selGridInt = maxButton - 1;
        }
    }

    if(Input.GetKeyUp(KeyCode.DownArrow))
    {
        // Create the same wrap around effect as above but alter for down arrow
        if(selGridInt < (maxButton-1))
        {
            selGridInt++;
        }
        else
        {
            selGridInt = 0;
        }
    }

    if(Input.GetKeyUp(KeyCode.Return))
    {
        switch(selGridInt)
        {
            case 0: Debug.Log("Button "+(selGridInt + 1 )+ " pressed.");
                break;
            case 1: Debug.Log("Button "+(selGridInt + 1 )+" pressed.");
                break;
            case 2: Debug.Log("Button "+(selGridInt + 1 )+ " pressed.");
                break;
            case 3: Debug.Log("Button "+(selGridInt + 1 )+ " pressed.");
                break;
        }
    }
}

function OnGUI () 
{
    selGridInt = GUI.SelectionGrid (Rect (Screen.width/2-75, Screen.height/2-25, 150, 200), selGridInt, selStrings, 1);
} 
```

# r - 如何按相同的行添加组 ID？

> ID：12118352
> 
> 赞同：2
> 
> 时间：2012-08-25T01:01:39.020
> 
> 标签：r

假设我有：

```
df <- data.frame(x = rep(as.factor(LETTERS[1:3]), c(1, 2, 3)))

df:
  x
1 A
2 B
3 B
4 C
5 C
6 C 
```

如何根据相同的字母添加另一列（组 ID）`df$x`：

```
 x group
1 A 1
2 B 2
3 B 2
4 C 3
5 C 3
6 C 3 
```

谢谢！

**- - - - - - -编辑 - - - - - - -**

对不起，我想我应该改写我的问题。在这里，我们有：

```
df <- data.frame(x = rep(as.factor(LETTERS[1:3]), c(1, 2, 3)),
                 y = rep(as.factor(LETTERS[3:1]), c(3, 2, 1)))

df
  x y
1 A C
2 B C
3 B C
4 C B
5 C B
6 C A 
```

我需要一列组 ID 来分隔 x 和 y 对：

```
df
  x y group
1 A C 1
2 B C 2
3 B C 2
4 C B 3
5 C B 3
6 C A 4 
```

感谢帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T01:04:27.230

我想这就是你要找的：

```
df$group = df$x:df$y
#  x y group
#1 A C   A:C
#2 B C   B:C
#3 B C   B:C
#4 C B   C:B
#5 C B   C:B
#6 C A   C:A 
```

`group`在这种情况下是一个因素。如果您希望它具有数字 ID：

```
df$group = as.numeric(df$x:df$y)
#  x y group
#1 A C     3
#2 B C     6
#3 B C     6
#4 C B     8
#5 C B     8
#6 C A     7 
```

ETA：如果您希望组 ID 是连续整数：

```
df$group = match(df$x:df$y, unique(df$x:df$y))
#  x y group
#1 A C     1
#2 B C     2
#3 B C     2
#4 C B     3
#5 C B     3
#6 C A     4 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T04:14:11.587

这个怎么样：

```
df$group <- as.numeric(factor(with(df, paste(x,y)))) 
```

...与其他解决方案非常相似。

# ajax - 什么是 Ajax 状态码 8？

> ID：12118354
> 
> 赞同：1
> 
> 时间：2012-08-25T01:01:56.950
> 
> 标签：ajax, http, asp.net-ajax

我在我的 ASP.Net 页面中使用 ScriptManager。当我调用 Ajax 调用时，它转到失败的回调。在响应中，Status Code = 8 并且消息是“服务器方法*methodName*失败”。

状态码 8 是什么意思？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T01:42:34.393

8 似乎不是有效的 http 状态代码，请分享您的代码或尝试这是否有帮助 - [Javascript - 调用 ASP.NET WebService - 服务器方法“methodName”失败](https://stackoverflow.com/questions/6438199/javascript-calling-asp-net-webservice-the-server-method-methodname-failed)

# python - 使用烧瓶保护静态文件

> ID：12118355
> 
> 赞同：12
> 
> 时间：2012-08-25T01:02:16.497
> 
> 标签：python, security, static, flask, password-protection

我正在构建一个烧瓶应用程序，我希望它仅在用户通过身份验证时才提供一些静态文件。这是一个非常低流量的应用程序（仅供内部使用）。我该怎么办？我正在考虑的一件事是使用serve_static()，并将其置于身份验证检查之后，但它使用flask 已经从中提供内容的静态目录。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-25T01:36:38.373

只需子类`flask.Flask`化并覆盖该[`send_static_file`](http://flask.pocoo.org/docs/api/#flask.Flask.send_static_file)方法：

```
class SecuredStaticFlask(Flask):
    def send_static_file(self, filename):
        # Get user from session
        if user.is_authenticated():
            return super(SecuredStaticFlask, self).send_static_file(filename)
        else:
            abort(403) 
            # Or 401 (or 404), whatever is most appropriate for your situation 
```

另见[定义`send_static_file`](https://github.com/mitsuhiko/flask/blob/94f436013792249a9bb7206c2868d4c6c21fd887/flask/helpers.py#L815)和以下

# r - R绘图轴不相遇，数据超出它们

> ID：12118356
> 
> 赞同：1
> 
> 时间：2012-08-24T23:39:18.450
> 
> 标签：r, data-visualization

我在 R 中有一个非常基本的情节，我想解决两个问题。这是产生情节的代码：

```
plot(o,n,bty="n",pch=21,cex=1.5,bg="gray",xlab="y",ylab="x",lwd=2) 
```

而且，这是情节 ![在此处输入图像描述](../Images/7fe2491f74e700cd2b579e0f95f1dda6.png)

我正在尝试修复此情节的两种不良行为。而且我不知道如何做任何一个（我也不明白为什么 R 还没有做这些事情......）

1.  X 轴和 Y 轴不相交。在该图中，原点附近有一个间隙。我想删除它。轴应该接触，就像任何其他图表一样。
2.  数据延伸超过轴是 X 和 Y 方向。这显然是不希望的。如何在不必手动制作自己的轴的情况下解决此问题。似乎这里应该有更直观的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T00:17:21.473

1.  `bty="l".`

2.  您可能还想使用类似的东西：

    ```
    xlim=c(0.02, 0.24), ylim=c(0.02, 0.24) 
    ```

如果您不喜欢两个轴的默认限制。

一般来说，请查看`?par`有关这两个选项和许多其他选项的指导。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T00:05:41.930

如果您真的不想要边缘在上方或右侧的框，请尝试省略`bty="n"`或替换它`bty="L"`

# javascript - 将网格动态添加到选项卡面板中的特定选项卡

> ID：12118366
> 
> 赞同：0
> 
> 时间：2012-08-25T01:04:26.417
> 
> 标签：javascript, extjs4.1

如何将网格动态添加到选项卡面板中的特定选项卡？
我的标签面板：

```
var tabs = Ext.create('Ext.tab.Panel', {
            region: 'center', // a center region is ALWAYS required for border layout
            deferredRender: false,
            activeTab: 0,     // first tab initially active
            items: [{
                title: 'grid',
                autoScroll: true
            }, {
                title: 'Center Panel',
                autoScroll: true
            }]
        }); 
```

我想将网格动态添加到选项卡中的网格选项卡！。我可以使用网格选项卡，`tabs.getComponent(0)`但我不知道如何向它添加网格！
在我的应用程序中，我有一个按钮，当用户单击它时，我将网格添加到 tabPanel 中的网格选项卡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T10:12:12.070

为了将 Grid 作为内容添加到特定选项卡，我做了这个技巧！：

```
tabs.remove(tabs.getComponent(0));
    tabs.insert(0,grid);
    tabs.getComponent(0).setTitle("grid");
    tabs.setActiveTab(0);
    tabs.doLayout(); 
```

我只删除特定选项卡并将新选项卡插入其位置并将新选项卡的标题更改为先前删除的选项卡并设置活动的新选项卡！

# c# - 无法传递参数时如何获取购物车值

> ID：12118371
> 
> 赞同：-4
> 
> 时间：2012-08-25T01:05:41.463
> 
> 标签：c#, asp.net, asp.net-mvc

我正在使用贝宝。我将值发送到 PayPal，然后取回值。我无法传递参数，因为 PayPal 对它们一无所知。如何在不传递参数的情况下在我的方法中获取购物车值？

我能够得到这样的值

```
public ViewResult Index(Cart cart, string returnUrl)
{
    return View(new CartIndexViewModel
                    {
                        Cart = cart,
                        ReturnUrl = returnUrl
                    });
} 
```

但是，如果我无法将 (Cart cart) 作为参数传递怎么办 - 我如何获取这些值？

```
 public ViewResult Index()
    {

//what do i need to do here???

        return View(new CartIndexViewModel
                        {
                            Cart = cart,
                            ReturnUrl = returnUrl
                        });
    } 
```

感谢您提供任何帮助或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T05:25:23.330

我想您可以删除存储该`Cart`会话数据的 cookie。然后，在您从贝宝或任何您可以从用户请求中读取 cookie 的帖子中收到回复后。

但是，我认为您可以将待处理的交易保存到数据库，将您发送的任何数据发送到贝宝，并使用他们必须使用的密钥或任何方法将贝宝交易链接到数据库中的待处理交易。这样会更安全。

我确信贝宝有一个简单且有据可查的交易流程，我会在尝试其中任何一个之前对其进行研究。

如果您实际上尝试与 paypal 集成，而不仅仅是将其用作示例，这里是[Paypal 和 MVC3](http://www.arunrana.net/2012/01/paypal-integration-in-mvc3-and-razor.html)的教程。

从[贝宝](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECGettingStarted)：

> **Express Checkout 与购物车的关系**
> 
> 如果您没有自己的购物车并且没有将 Express Checkout 与您的网站集成，您可以考虑使用第三方购物车。购物车是一种软件，可让买家将商品放入购物篮并在结账时计算总数。
> 
> PayPal 与各种各样的购物车合作，所有这些购物车都与 PayPal 兼容，并为您的买家提供安全的购买。购物车供应商提供了将其购物车集成到您的网站上的说明。请参阅 PayPal 合作伙伴目录 (https://www.paypal-marketing.com/emarketing/partner/directory/directory.page?type=Shopping+Cart#mode=dir&dir%5Bops%5D=either&dir%5Bkey%5D=Keyword+ term&dir%5Btyp%5D%5B%5D=1&dir%5Bind%5D%5B%5D=0&dir%5Brod%5D%5B%5D=1&dir%5Brod%5D%5B%5D=2) 用于可用的购物车。
> 
> 重要提示：如果您选择购物车，请不要联系 PayPal。PayPal 对购物车供应商没有任何权限，也无法帮助您解决与第三方购物车集成或使用时可能出现的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T04:22:39.507

控制器可能在模型绑定购物车时遇到了问题。你是如何调用这个动作的？网址是什么？也许使用提琴手或其他东西来查看正在传递的内容。另外，什么是购物车成员？

# linq - LINQ 查询何时真正执行？

> ID：12118376
> 
> 赞同：1
> 
> 时间：2012-08-25T01:07:59.193
> 
> 标签：linq

假设我们有以下 LINQ 查询：

```
var query =
    from    c in Customers
    where   c.Country == "Italy"
    orderby c.Name
    select  new { c.Name, c.City }; 
```

编译器会像这样转换它：

```
IEnumerable<Customer> query =
        Customers
        .Where( c => c.Country == "Italy" );
        .OrderBy( c => c.Name )
        .Select( c => new { c.Name, c.City } ); 
```

然后我可以使用这样的查询：

```
foreach ( var name_city_pair in query ) ... 
```

问题是：

*   当我使用 foreach 循环时，查询指定的数据似乎已经被查询**出来**。那么这个查询动作是什么时候发生的呢？是在我定义 LINQ 查询对象的时候`IEnumerable<Customer>` 吗？

*   如果数据量太大，有没有**后期查询** 机制？（我不确定描述这一点的正确词，但我希望你能理解我。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T01:11:56.010

LINQ 尽可能使用延迟执行。在您的示例中，仅当您遍历结果时才会执行查询。

`To`以（例如）开头的方法`ToList`会导致查询立即执行。还有一些返回单个值的方法，例如`Count`导致查询立即执行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-25T01:19:27.663

一般来说，LINQ 会尽可能地懒惰。例如，您希望它在幕后看起来像这样：

```
foreach ( string name in query ) ...
//Roughly translates into
while (query.MoveNext())
{
    string name = query.Current;
    ...
} 
```

它只会在需要的时候得到结果，一个接一个。这种“惰性”/“流式”思维贯穿整个查询 - Select 根据需要调用 OrderBy，根据需要调用 Where，根据需要调用 Collection。

一个奇怪的是“OrderBy”，出于实现原因，它可能会在排序之前检索所有需要的结果，然后流式传输结果。此检索将在第一次调用时发生。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T01:16:29.253

查询不会在 foreach 之前执行。foreach 循环中的每次迭代都会从您的查询中返回一个结果。

从来没有完全物化的数据结果集，所以它也不能太大。

LINQ 查询延迟执行。当您迭代时，它将应用您指定的谓词和预测在您的数据上“滑动”。

# c#-4.0 - 静态属性/方法内存分配

> ID：12118377
> 
> 赞同：1
> 
> 时间：2012-08-25T01:08:11.297
> 
> 标签：c#-4.0, static, singleton

让我们举个例子，我认为它涵盖了我所有的问题：

```
class SomeClass
{
    static SomeType PropertyA
    {
        get
        {
            if (....)
                return MethodA();
            else
                return MethodB();
        }
    }

    static SomeType MethodA() { ... }
    static SomeType MethodB() { ... }
} 
```

调用 SomeClass.PropertyA 属性会造成内存泄漏吗？我的意见是否定的，因为属性本​​身没有支持字段，这会造成内存泄漏。我问这个是因为我读过静态属性会造成内存泄漏，但我认为它是负责内存泄漏的支持字段，因为它包含对实例的引用。

所以在上面的例子中，上面例子中的 MethodA、MethodB 和 PropertyA 不应该造成任何内存泄漏。我错了吗？

我的另一个问题是：我有很多类大多没有状态或数据。他们只是充当代理。其中一些方法被非常频繁地调用。我的问题是：我应该将这些类设为单例类、静态类还是常规类？

完美的例子是一个包含 5-10 个方法并执行一些 SQL 查询的类。

1）如果我将它们作为常规，那么我需要经常创建它们（根据一些用户反应），调用一些方法，然后允许它们被垃圾收集。

2）在单例和静态之间进行选择，优缺点是什么？

3）如果我有一个包含代理方法的类，但有 2-3 个 IDbCommands，每个包含 10 个参数，并且有利于重用它们，那么在选择正确的模式时会改变什么吗？

编辑：由于我得到了一些让我更加困惑的答案，可能是由于误解，我将发布我的第一个问题的答案。我做了一个测试，我分配了一个大字节数组（300MB），它是通过PropertyA（和MethodA）检索的。**上例中的 PropertyA abd MethodA 都不会持有对这个对象的引用**，在获取它之后，一旦调用代码完成了数组，它将被 GC 处理。因此，如果我们仅将静态属性与 getter 或静态方法一起使用，则不应存在任何内存泄漏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T01:23:24.820

> 所以在上面的例子中，上面例子中的 MethodA、MethodB 和 PropertyA 不应该造成任何内存泄漏。我错了吗？

如果您的意思是它们不会创建或保留任何内存，那么这是真的 - 属性本身不会保留内存。

静态字段不会造成“内存泄漏”——该类型的类型初始化程序将在第一次使用该类之前运行，并且，如果一个字段需要内存，将分配该字段的内存。这个内存没有被清除——如果这就是你所说的“泄漏”——但没有实例可以释放，所以这是预期和期望的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T01:30:10.997

简单的答案是一个问题：“这些方法做了什么，它们是否保持状态，除了简单的垃圾收集之外，它们是否需要清理？”

如果他们不满足以上所有要求，那么按理说你不会有泄漏。仅当您不采取任何措施并且您不采取任何措施时，才会发生泄漏，您就没有泄漏。

如今，它更多的是关于“内存压力”而不是泄漏。

一般来说，我更喜欢实例方法，因为它提供垃圾收集并允许更容易地模拟和测试场景。

静态方法和变量与实例变量和方法存在相同的问题，因此泄漏（如果可能）适用于两者。

# r - 在 for 循环中拆分数据框列表（维度错误）

> ID：12118379
> 
> 赞同：1
> 
> 时间：2012-08-25T01:08:49.753
> 
> 标签：r

我有一个非常大的数据集，我已经把它分成了 50 块所以基本上文件看起来像： file1 file2 file3 。. . file50（数据帧）

```
file_total <- c(file1,...,file50) 
```

我知道这会将它组合成一个列表，但我不能使用`rbind`，因为整个所有数据都很大，而且 plyr 库只需要永远运行

在每个文件中，我必须根据 1 个因素将它们拆分，将其命名为“id”，然后能够将每个 id 子集写入 .csv 文件

到目前为止，我的代码是：

```
d_split <- split(file1, file1[1])

library(plry)
id <- unlist(lapply(d_split,"[",1,1)) # this returns the unique id

for (j in seq_along(id))
{ 
    write.csv(d_split[[j]], file=paste(id[j], "csv", sep="."))
} 
```

这行得通！

但是当我尝试将它放入另一个 for 循环时它不起作用：

```
for (i in file_total)
{
    d_split <- split(i, i[1])
    id <- unlist(lapply(d_split,"[",1,1)) 
    for (j in seq_along(id))
    {
        write.csv(d_split[[j]], file=paste(id[j], "csv", sep="."))
    }
} 
```

它返回以下错误消息：

```
Error in FUN(X[[1L]], ...) : incorrect number of dimensions 
```

我的意思是我可以通过将 50 个文件复制并粘贴到代码中来手动完成，但我只是想知道是否有人可以修复我的代码，以便一键解决。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T01:18:09.533

问题的出现取决于您如何组合数据。与其将它们与 结合`c`，不如将它们组合成一个列表：

```
file_total <- list(file1,...,file50) 
```

此时，doing`i in file_total`将按照您的意愿进行迭代。

作为解释：使用`c`数据帧（正如我假设`file1`的那样`file2`）实际上会将它们变成向量列表而不是数据帧列表。例如：

```
file1 = data.frame(x=1:20)
file2 = data.frame(y=20:40)
file_total = c(file1, file2)
# file_total will be:
# $x
#  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
#
# $y
#  [1] 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 
```

因此，对它们进行迭代实际上会将各个列作为向量进行迭代。但是，使用`list`组合它们将让您迭代数据帧本身：

```
> list(file1, file2)
[[1]]
    x
1   1
2   2
3   3
4   4
5   5
6   6
7   7
8   8
9   9
10 10
11 11
12 12
13 13
14 14
15 15
16 16
17 17
18 18
19 19
20 20

[[2]]
    y
1  20
2  21
3  22
4  23
5  24
6  25
7  26
8  27
9  28
10 29
11 30
12 31
13 32
14 33
15 34
16 35
17 36
18 37
19 38
20 39
21 40 
```

# objective-c - ios核心数据——大部分时间有实体问题？

> ID：12118380
> 
> 赞同：1
> 
> 时间：2012-08-25T01:08:53.690
> 
> 标签：objective-c, ios, core-data, entity

每当我使用 Core Data 时，我都可以让程序运行并做它应该做的事情。但是我在尝试保存数据时经常遇到问题，我收到如下错误：

> 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“+entityForName：找不到实体名称“Feedings”的 NSManagedObjectModel

据我所知，没有任何理由。

```
-(IBAction)saveData:(id)sender
{

Feedings *newFeed = [NSEntityDescription insertNewObjectForEntityForName:@"Feedings" inManagedObjectContext:self.managedObjectContext];

newFeed.time01 = time01TxtFld.text;
newFeed.time02 = time02TxtFld.text;
newFeed.time03 = time03TxtFld.text;
newFeed.time04 = time04TxtFld.text;
newFeed.time05 = time05TxtFld.text;
newFeed.time06 = time06TxtFld.text;
newFeed.time07 = time07TxtFld.text;

newFeed.feed01 = mls01TxtFld.text;
newFeed.feed02 = mls02TxtFld.text;
newFeed.feed03 = mls03TxtFld.text;
newFeed.feed04 = mls04TxtFld.text;
newFeed.feed05 = mls05TxtFld.text;
newFeed.feed06 = mls06TxtFld.text;
newFeed.feed07 = mls07TxtFld.text;

[self.managedObjectContext save:nil];  // write to database

[self.delegate theSaveButtonOnTheAddAppVCWasTapped:self];

UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Feedings" message:@"A new feeding record has been added." delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
[alert show];
 } 
```

这是我用于向数据库添加信息的代码，Xcode 没有错误 - 为什么让应用程序正常工作如此困难？

断点图片 ![断点图片](../Images/e3974b1651fc8c6c6c01a90908a94ce0.png)

* * *

我将此行添加到 ViewDidLoad 方法：

```
NSLog(@"Entities : %@",[[self.managedObjectContext.persistentStoreCoordinator.managedObjectModel entities] valueForKey:@"time01"]); 
```

哪个返回：

> 2012-08-25 13:33:43.572 喂养[735:fb03] 实体：（空）

这是崩溃的正确原因

# android - 在android设备上运行ffmpeg并选择输入设备时出现“文件描述符处于错误状态”错误

> ID：12118382
> 
> 赞同：0
> 
> 时间：2012-08-25T01:09:14.517
> 
> 标签：android, file-io, ffmpeg

下面是 ffmpeg 命令的输出：**# ./ffmpeg -y -f s16le -i /dev/snd/pcmC3D0c 1640.wmv** - 在 Android 设备上从 Logitech 网络摄像头创建音频文件。

如输出所示，我收到一个**File descriptor in bad state 错误**，因为我将麦克风输入称为**/dev/snd/pcmC3D0c我通过查看****/proc/asound**的内容确定了设备（网络摄像头麦克风）的值。网络摄像头麦克风是 card3，它的**STREAM0**文件表明麦克风的音频格式为**S16_LE**

格式还确认它是一个捕获设备，它的 pcm id 是**pcmC3D0c（C3 是卡号，D0 是设备号**. 然后我通过检查**/dev/snd/**目录来确认正确的设备，以确认其正确和完整的描述。/dev/snd 文件夹确认麦克风是**/dev/snd/pcmC3D0c**

然后我检查了权限和所有权以确保我可以使用该设备。因此，就识别要使用的正确设备而言，我相信**/dev/snd/pcmC3D0c**是正确的设备。我确实相信这个错误可能与操作系统有关，但是在所有这些检查之后，我仍然无法弄清楚是什么导致了错误的文件描述符状态错误。

请注意，我测试了不同的输出格式等，但没有任何区别。有什么线索或建议吗？

# ./ffmpeg -y -f s16le -i /dev/snd/pcmC3D0c 1640.wmv

> ffmpeg 版本 N-43170-gd84dd35 版权所有 (c) 2000-2012 FFmpeg 开发人员于 2012 年 8 月 24 日 09:16:05 使用 gcc 4.4.3 (GCC) 配置构建：--enable-cross-compile --arch=arm - -cpu=cortex-a9 --target-os=linux --enable-runtime-cpudetect --prefix=/output --enable-pic --cross-prefix=/home/jasongipsyblues/Desktop/apps/android-ndk- r8b/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/arm-linux-androideabi---sysroot=/home/jasongipsyblues/Desktop/apps/android-ndk-r8b/platforms/android -14/arch-arm --enable-version3 --enable-gpl --enable-memalign-hack --disable-doc --enable-yasm --enable-libx264 --enable-zlib --extra-cflags=- I../x264 --extra-ldflags='-L../x264 -lc'
> 
> libavutil 51\. 66.100 / 51\. 66.100
> libavcodec 54\. 48.100 / 54\. 48.100
> libavformat 54\. 22.100 / 54\. 22.100
> libavdevice 54\. 2.100 / 54\. 2.100
> libavfilter 3\. 5.102 / 3\. 5.102
> libswscale 2\. 1.100 / 2\. 1.100
> libswresample 0\. 15.100 / 0\. 15.100 [libpostproc 6 2.0.s
> ]
> 
> @ 0xfd84f0] 使用默认值 44100 指定的无效采样率 0
> [s16le @ 0xfd84f0] 从比特率估计持续时间，这可能是不准确
> 的 输入流 #0.0 的猜测通道布局：单声道
> 输入 #0，s16le，来自**'/dev/snd/pcmC3D0c '：**
> 持续时间：N/A，比特率：705 kb/s
> 流 #0:0：音频：pcm_s16le，44100 Hz，单声道，s16，705 kb/s
> 输出 #0，asf，到 '1640.wmv'：
> 元数据：WM/EncodingSettings：Lavf54.22.100 Stream #0:0：音频：wmav2 (a[1][0][0] / 0x0161)，44100 Hz，单声道，s16，128 kb/s 流映射：Stream #0 :0 -> #0:0 (pcm_s16le -> wmav2)
> 按 [q] 停止，[?] 寻求帮助
> **/dev/snd/pcmC3D0c: 文件描述符处于错误状态**
> 大小= 1kB 时间=00:00:00.00 比特率= 0.0kbits/s
> 视频：0kB 音频：0kB 字幕：0 全局标题：0kB 复用开销 5340.000000%

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T14:49:38.723

您可能需要引入操作系统管道来处理实时音频... ffmpeg 有详细记录的使用管道的脚本示例。

看[这里](http://ubuntuforums.org/showthread.php?t=1544946)

根据您的情况，除了 ffmpeg 之外，您还可以查看 VLC。

# delphi - IdHTTP.Get 停止执行

> ID：12118384
> 
> 赞同：0
> 
> 时间：2012-08-25T01:10:13.547
> 
> 标签：delphi, delphi-2010, bho, idhttp

我正在开发一个 .dll 文件（更具体地说是浏览器帮助对象 - BHO）。我需要接收一些托管在一个 TXT 文件中的设置。要读取这个 TXT 文件，我使用的是 IdHTTP，但是当我 .get 进入 TXT 地址时，它只会停止一切。我将粘贴下面的代码：

```
procedure TMyClass.ReadTXT;
  function LoadTxt(HTTP: TidHTTP; Body: TStringList; URLTxt: string): boolean;
    begin
      try
        Body.Text:= HTTP.Get(URLTxt);
        Result := true;
      except
        Result := false;
      end;
    end;
var
  HTTP: TidHTTP;
  Body: TStringList;
  ValidTXT: boolean;
  Line: string;
  i, aux: integer;
begin
  HTTP := TIDHttp.Create(Nil);
  try
    HTTP.ConnectTimeout:= 5000;
    HTTP.Request.UserAgent:= 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; SLCC1';
    Body := TStringList.Create;
    try
      ValidTXT := false;
      i := 0;
      while (ValidTXT = false) and (i < TXTs.Count) do
        begin
        if (LoadTXT(HTTP, Body, TXTs.Strings[i]) = true) and (Body.Count > 0) then
          begin
...
end; 
```

所以在这个过程的开始我有一个函数，看看我是否成功地得到了一些 TXT，因为你可以看到我正在使用一个名为**TXTs**的 TStringList 。所以，我在这个 TStringList 中添加了 3 个 TXTs 地址，并尝试连接直到找到一些有效地址。但是在函数的第一行（**Body.Text:= HTTP.Get(URLTxt);**）即使有一个有效的 TXT 地址，它也会停止......有人知道发生了什么吗？

* * *

我弄清楚发生了什么。但不知道为什么......当我设置时：

```
HTTP.ConnectTimeout:= 10000;
HTTP.Request.UserAgent:= 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; SLCC1'; 
```

.Get 方法不起作用...如果有人可以向我澄清这一点，我将非常感激。

# android - Android：当文本比 textview 短时启用文本选取框

> ID：12118388
> 
> 赞同：0
> 
> 时间：2012-08-25T01:11:01.367
> 
> 标签：android, marquee

当文本比 textview 短时，有什么方法可以启用文本选取框？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T03:14:41.730

将TextView中的elipsize属性设置为xml文件中的marquee

> android:ellipsize="选框"

然后在活动的 onCreate 方法中为 TextView 创建一个对象，并将 setSelectedProperty 设置为 true

> textview1.setSelected(true)

[来源：以前的 Stackoverflow 答案](https://stackoverflow.com/questions/4332819/textview-marquee)

# javascript - 在 express.js 中为每个请求设置全局 res.local 变量

> ID：12118392
> 
> 赞同：2
> 
> 时间：2012-08-25T01:12:26.017
> 
> 标签：javascript, node.js, coffeescript, express, pug

基本上我想构建一个站点范围的导航栏，其中包含在 express.js 中的局部变量中指定的链接

所以我建立了我想在页面上包含的链接列表：

```
class NavigationLink
  constructor: (@title,@url) ->

app.use (req,res,next) ->
  res.locals.navigationLinks = [
    new NavigationLink "About", "/about"
    new NavigationLink "Projects", "/projects"
    new NavigationLink "Skills", "/skills"
    new NavigationLink "Contact", "/contact"
  ]
  next() 
```

然后，如果我点击主页：

```
app.get '/', (req,res) ->
  res.render('about') 
```

Jade 尝试渲染这个布局文件，它应该循环遍历 navigationLinks 数组并为每个数组渲染：

```
!!! 5
html
include header
body
    .container
        .row
            .span3
                ul.nav.nav-tabs.nav-stacked
                    for navigationLink in navigationLinks
                        include navigationLink
            .span9
                block content 
```

但是，我收到一个参考错误“未定义导航链接”，我认为这意味着本地人没有通过。希望获得有关如何解决问题的建议，或者更适合此类事情的另一种设计范例（在网站的每个页面上动态构建链接）。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T02:57:56.100

乔纳森·翁是正确的。您上面的代码应该以默认的中间件顺序工作，该顺序将在`app.use`中间件之前运行所有`app.router`中间件。因此，我同意在您的代码的其他地方，您的代码片段中可能有一行`app.use app.router`出现`app.use`在您的代码片段之前。

# objective-c - 绑定 MonoTouch NSObject 类别

> ID：12118400
> 
> 赞同：1
> 
> 时间：2012-08-25T01:14:44.107
> 
> 标签：objective-c, ios5, binding, xamarin.ios

如何使用 ? 绑定它`MonoTouch`？

```
#if __IPHONE_OS_VERSION_MAX_ALLOWED < 60000
@interface NSObject (SubscriptingSupport)

- (id)objectAtIndexedSubscript:(NSUInteger)idx;
- (void)setObject:(id)obj atIndexedSubscript:(NSUInteger)idx;
- (void)setObject:(id)obj forKeyedSubscript:(id <NSCopying>)key;
- (id)objectForKeyedSubscript:(id)key;

@end
#endif 
```

尝试了以下[文档](http://docs.xamarin.com/ios/advanced_topics/binding_objective-c_types#Binding_Class_Extensions)，但没有运气

```
[BaseType (typeof (NSObject)), Bind ("NSObject")]
public interface NSObject2 
{
    [Bind("objectAtIndexedSubscript:")]
    NSObject ObjectAtIndexedSubscript (uint idx);

    [Bind("setObject:atIndexedSubscript:")]
    void SetObjectAtIndexedSubscript (NSObject obj, uint idx);

    [Bind("setObject:forKeyedSubscript:")]
    void SetObjectForKeyedSubscript (NSObject obj, NSObject key);

    [Bind("objectForKeyedSubscript:")]
    NSObject ObjectForKeyedSubscript (NSObject key);
} 
```

它给出了大量的错误，比如

> 错误 CS0115：“DocParser.Dispose(bool)”被标记为覆盖，但找不到合适的覆盖方法 (CS0115)

提前致谢

亚历克斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T02:28:31.703

绑定工具不支持为核心类的扩展生成存根。

好消息是，从根本上说，这项工作非常简单：您必须向实例 NSObject 的对象发送消息。

这意味着您可以手动编写代码，执行以下操作：

```
 void GetObjectAtIndex (NSObject target, int objectAt)
 {
     Runtime.GetNSObject (Messaging.objc_msgSend_int (target.Handle, Selector.GetHandle ("objectAtIndexedSubscript:", objectAt));
 } 
```

上面写起来可能很麻烦，所以你可以在一个虚构的类上运行生成器，然后将结果复制/粘贴到你自己的类中，该类带有一个参数“NSObject target”，如上所示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T23:23:30.393

我认为你需要保持类名相同，只要你有不同的命名空间`MonoTouch.Foundation`：

```
namespace WhateverNamespaceYouWantBesidesMonoTouch.Foundation
{
  [BaseType (typeof (MonoTouch.Foundation.NSObject))]
  public interface NSObject
  {
    [Export("objectAtIndexedSubscript:")]
    MonoTouch.Foundation.NSObject ObjectAtIndexedSubscript (uint idx);

    [Export("setObject:atIndexedSubscript:")]
    void SetObjectAtIndexedSubscript (MonoTouch.Foundation.NSObject obj, uint idx);

    [Export("setObject:forKeyedSubscript:")]
    void SetObjectForKeyedSubscript (MonoTouch.Foundation.NSObject obj, MonoTouch.Foundation.NSObject key);

    [Export("objectForKeyedSubscript:")]
    MonoTouch.Foundation.NSObject ObjectForKeyedSubscript (MonoTouch.Foundation.NSObject key);
  }
} 
```

我也不确定 [Bind] 的作用，您应该使用 [Export] 代替。

# file - 如何比较二进制文件以检查它们是否相同？

> ID：12118403
> 
> 赞同：240
> 
> 时间：2012-08-25T01:16:01.963
> 
> 标签：file, binary, compare, diff

知道两个二进制文件是否相同（时间戳除外）的最简单方法是什么（在 Ubuntu Linux 上使用图形工具或命令行）？我不需要实际提取差异。我只需要知道它们是否相同。

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2012-08-25T01:17:41.247

标准的 unix`diff`将显示文件是否相同：

```
[me@host ~]$ diff 1.bin 2.bin
Binary files 1.bin and 2.bin differ 
```

如果命令没有输出，则表示文件没有差异。

* * *

## 回答 #2

> 赞同：133
> 
> 时间：2013-04-24T03:51:11.323

使用`cmp`命令。如果它们是二进制相等的，这将干净地退出，或者它将打印出第一个差异发生的位置并退出。

* * *

## 回答 #3

> 赞同：133
> 
> 时间：2014-05-18T16:34:29.750

我发现[Visual Binary Diff](http://www.cjmweb.net/vbindiff/)是我正在寻找的，可在：

*   Ubuntu：

    ```
    sudo apt install vbindiff 
    ```

*   Arch Linux：

    ```
    sudo pacman -S vbindiff 
    ```

*   Mac OS X 通过[MacPorts](https://www.macports.org/)：

    ```
    port install vbindiff 
    ```

*   Mac OS X 通过 Homebrew：

    ```
    brew install vbindiff 
    ```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2012-08-25T01:21:06.613

使用 sha1 生成校验和：

```
sha1 [FILENAME1]
sha1 [FILENAME2] 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2015-12-10T03:46:19.433

我最终使用 hexdump 将二进制文件转换为十六进制表示，然后在 meld / kompare / 任何其他差异工具中打开它们。不像你，我是在文件的差异之后。

```
hexdump tmp/Circle_24.png > tmp/hex1.txt
hexdump /tmp/Circle_24.png > tmp/hex2.txt

meld tmp/hex1.txt tmp/hex2.txt 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2015-04-27T15:19:49.547

您可以使用 MD5 哈希函数来检查两个文件是否相同，这样您就无法在低级别看到差异，但这是比较两个文件的快速方法。

```
md5 <filename1>
md5 <filename2> 
```

如果两个 MD5 散列（命令输出）相同，则两个文件没有区别。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-12-08T23:50:30.353

使用 cmp 命令。有关详细信息，请参阅[二进制文件和强制文本比较](http://www.gnu.org/software/diffutils/manual/diffutils.html#Binary)。

```
cmp -b file1 file2 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-03-09T14:05:54.180

为了发现闪存缺陷，我必须编写这个脚本来显示所有包含差异的 1K 块（不仅仅是第一个块`cmp -b`）

```
#!/bin/sh

f1=testinput.dat
f2=testoutput.dat

size=$(stat -c%s $f1)
i=0
while [ $i -lt $size ]; do
  if ! r="`cmp -n 1024 -i $i -b $f1 $f2`"; then
    printf "%8x: %s\n" $i "$r"
  fi
  i=$(expr $i + 1024)
done 
```

输出：

```
 2d400: testinput.dat testoutput.dat differ: byte 3, line 1 is 200 M-^@ 240 M- 
   2dc00: testinput.dat testoutput.dat differ: byte 8, line 1 is 327 M-W 127 W
   4d000: testinput.dat testoutput.dat differ: byte 37, line 1 is 270 M-8 260 M-0
   4d400: testinput.dat testoutput.dat differ: byte 19, line 1 is  46 &  44 $ 
```

免责声明：我在 5 分钟内破解了脚本。它不支持命令行参数，也不支持文件名中的空格

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-08-11T16:19:38.597

具有以下选项的 Diff 将进行二进制比较以检查文件是否完全不同，并且如果文件也相同，它将输出：

```
diff -qs {file1} {file2} 
```

如果您要比较不同目录中的两个同名文件，则可以改用以下形式：

```
diff -qs {file1} --to-file={dir2} 
```

OS X 埃尔卡皮坦

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-03-05T12:02:56.380

# 试试 diff -s

简短`diff`的回答：使用`-s`开关运行。

长答案：请阅读下文。

* * *

这是一个例子。让我们首先创建两个具有随机二进制内容的文件：

```
$ dd if=/dev/random bs=1k count=1 of=test1.bin
1+0 records in
1+0 records out
1024 bytes (1,0 kB, 1,0 KiB) copied, 0,0100332 s, 102 kB/s

$ dd if=/dev/random bs=1k count=1 of=test2.bin
1+0 records in
1+0 records out
1024 bytes (1,0 kB, 1,0 KiB) copied, 0,0102889 s, 99,5 kB/s 
```

现在让我们复制第一个文件：

```
$ cp test1.bin copyoftest1.bin 
```

现在 test1.bin 和 test2.bin 应该是不同的：

```
$ diff test1.bin test2.bin
Binary files test1.bin and test2.bin differ 
```

...并且 test1.bin 和 copyoftest1.bin 应该相同：

```
$ diff test1.bin copyoftest1.bin 
```

可是等等！为什么没有输出？！？

答案是：这是设计使然。相同文件没有输出。

但是有不同的错误代码：

```
$ diff test1.bin test2.bin
Binary files test1.bin and test2.bin differ

$ echo $?
1

$ diff test1.bin copyoftest1.bin

$ echo $?
0 
```

现在幸运的是，您不必每次都检查错误代码，因为您可以使用[`-s`(or `--report-identical-files`) 开关](https://www.freebsd.org/cgi/man.cgi?query=diff&apropos=0&sektion=0&manpath=CentOS%207.1)使 diff 更详细：

```
$ diff -s test1.bin copyoftest1.bin
Files test1.bin and copyoftest1.bin are identical 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-01-27T16:46:34.083

> [Radiff2](https://radare.gitbooks.io/radare2book/tools/radiff2/intro.html)是一个旨在比较二进制文件的工具，类似于常规 diff 比较文本文件的方式。

试试`radiff2`哪个是`radare2`反汇编程序的一部分。例如，使用以下命令：

```
radiff2 -x file1.bin file2.bin 
```

你会得到非常格式化的两列输出，其中突出显示了差异。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-04-23T18:26:15.670

我最喜欢的是使用 vim 包中的 xxd hex-dumper ：

1) 使用 vimdiff (vim 的一部分)

```
#!/bin/bash
FILE1="$1"
FILE2="$2"
vimdiff <( xxd "$FILE1" ) <( xxd "$FILE2" ) 
```

2）使用差异

```
#!/bin/bash
FILE1=$1
FILE2=$2
diff -W 140 -y <( xxd $FILE1 ) <( xxd $FILE2 ) | colordiff | less -R -p '  \|  ' 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-01-25T05:34:37.387

```
md5sum binary1 binary2 
```

如果 md5sum 相同，则二进制文件相同

例如

```
md5sum new*
89c60189c3fa7ab5c96ae121ec43bd4a  new.txt
89c60189c3fa7ab5c96ae121ec43bd4a  new1.txt
root@TinyDistro:~# cat new*
aa55 aa55 0000 8010 7738
aa55 aa55 0000 8010 7738

root@TinyDistro:~# cat new*
aa55 aa55 000 8010 7738
aa55 aa55 0000 8010 7738
root@TinyDistro:~# md5sum new*
4a7f86919d4ac00c6206e11fca462c6f  new.txt
89c60189c3fa7ab5c96ae121ec43bd4a  new1.txt 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-08-09T22:43:56.663

# wxHexEditor

wxHexEditor 既免费又能够区分高达 2^64 字节（2 ExaByte）的大文件。有一个图形用户界面。跨平台。很多功能。

要免费获得它，请选择以下选项之一：

*   选项：[Ubuntu 软件包](https://packages.ubuntu.com/search?keywords=wxHexEditor&searchon=names&suite=hirsute&section=all)
*   选项：[SourceForge](https://sourceforge.net/projects/wxhexeditor/)
*   选项：[GitHub](https://github.com/EUA/wxHexEditor)

* * *

以下是与上述相同的建议。但如果您对这些感兴趣，请提供详细信息。

# 截屏

[![在此处输入图像描述](../Images/78d12ab9c4b9e560d84699b1a4437d6c.png)](https://i.stack.imgur.com/azml7.png)

# 力量

• 十六进制(Hex) 编辑器。这有助于进行逆向工程。

• 跨平台。Linux、Mac 操作系统、Windows

• 易于使用的图形用户界面 (GUI)

• 支持高达 2^64 字节 (2 ExaByte) 的超大文件

• 并排比较两个大文件(diff)。（可选）列出并搜索所有差异。

• 非常快速的搜索

• 使用少量 RAM

• 不要创建临时文件。所以它使用了非常小的存储空间。

• 黑暗或明亮的主题

• 多语言 15 种语言

• 开源。如果您不熟悉“开源”，则意味着该软件具有更强的安全性和更强的隐私性。[因为它的代码在https://github.com/EUA/wxHexEditor](https://github.com/EUA/wxHexEditor)或 SourceForge 在[https://sourceforge.net/p/wxhexeditor/code/](https://sourceforge.net/p/wxhexeditor/code/)上公开供审查和贡献

• 有吸引力的 GNU 通用公共许可证版本 2。这意味着此扩展的软件代码由友好的非营利社区拥有和支持。而不是营利性公司。[https://github.com/EUA/wxHexEditor/blob/master/LICENSE](https://github.com/EUA/wxHexEditor/blob/master/LICENSE)

# 挑战

• 两个代码库之间的混淆。在撰写本文时，也就是 2021 年 8 月，GitHub 存储库似乎更新了。由于它的最后一次更新是在 2021 年[https://github.com/EUA/wxHexEditor](https://github.com/EUA/wxHexEditor) 相比之下，位于[https://sourceforge.net/projects/wxhexeditor/](https://sourceforge.net/projects/wxhexeditor/)的 SourceForge 存储库是 wxHexEditor 的最后一次更新是 2017 年 12 月 31 日。

# 表示您的支持

• 如果您喜欢这个应用程序，请通过以下方式向作者和贡献者表示支持：

___• 在[https://www.paypal.com/cgi-bin/webscr?item_name=Donation+to+wxHexEditor&cmd=_donations&business=erdem.ua%40gmail.com捐款](https://www.paypal.com/cgi-bin/webscr?item_name=Donation+to+wxHexEditor&cmd=_donations&business=erdem.ua%40gmail.com)

___• 支持[https://sourceforge.net/projects/wxhexeditor/support上的票证](https://sourceforge.net/projects/wxhexeditor/support)

___• 支持[https://sourceforge.net/p/wxhexeditor/discussion/上的论坛](https://sourceforge.net/p/wxhexeditor/discussion/)

___• 补丁在[https://sourceforge.net/p/wxhexeditor/patches/](https://sourceforge.net/p/wxhexeditor/patches/)

# 使用

• wxHexEditor 0.23

• Debian 10 克星

• GNOME 3.30.2

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2018-10-24T00:14:33.220

有一种比较简单的方法可以检查两个二进制文件是否相同。

如果您在编程语言中使用文件输入/输出；您可以将两个二进制文件的每一位存储到它们自己的数组中。

此时检查很简单：

```
if(file1 != file2){
    //do this
}else{
    /do that
} 
```

# ruby - Ruby 的 OpenSSL::Random 种子是否足够？

> ID：12118406
> 
> 赞同：8
> 
> 时间：2012-08-25T01:16:32.950
> 
> 标签：ruby, security, cryptography, prng

我对 Ruby 知之甚少，所以如果这个问题的答案很明显，请原谅我。我在[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/securerandom/rdoc/SecureRandom.html](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/securerandom/rdoc/SecureRandom.html)注意到Ruby 在调用 random_bytes 时使用 pid 和当前时间播种 OpenSSL::Random制作。除非在幕后发生其他事情，否则这不是 Netscape 在 90 年代中期最初的 SSL 实施中使用的种子吗？ [http://en.wikipedia.org/wiki/Random_number_generator_attack#Prominent_examples_of_random_number_generator_security_issues](http://en.wikipedia.org/wiki/Random_number_generator_attack#Prominent_examples_of_random_number_generator_security_issues)

当然，Ruby 并没有让一个 18 岁的 bug 复活。我在这里想念什么？

编辑：这是 random_bytes 的来源。请注意第一次检查 ruby​​ 是否使用 OpenSSL 编译，在这种情况下，它会使用 pid 和当前时间为其播种。

```
def self.random_bytes(n=nil)
  n = n ? n.to_int : 16

  if defined? OpenSSL::Random
    @pid = 0 if !defined?(@pid)
    pid = $$
    if @pid != pid
      now = Time.now
      ary = [now.to_i, now.nsec, @pid, pid]
      OpenSSL::Random.seed(ary.to_s)
      @pid = pid
    end
    return OpenSSL::Random.random_bytes(n)
  end

  if !defined?(@has_urandom) || @has_urandom
    flags = File::RDONLY
    flags |= File::NONBLOCK if defined? File::NONBLOCK
    flags |= File::NOCTTY if defined? File::NOCTTY
    begin
      File.open("/dev/urandom", flags) {|f|
        unless f.stat.chardev?
          raise Errno::ENOENT
        end
        @has_urandom = true
        ret = f.readpartial(n)
        if ret.length != n
          raise NotImplementedError, "Unexpected partial read from random device: only #{ret.length} for #{n} bytes"
        end
        return ret
      }
    rescue Errno::ENOENT
      @has_urandom = false
    end
  end

  if !defined?(@has_win32)
    begin
      require 'Win32API'

      crypt_acquire_context = Win32API.new("advapi32", "CryptAcquireContext", 'PPPII', 'L')
      @crypt_gen_random = Win32API.new("advapi32", "CryptGenRandom", 'LIP', 'L')

      hProvStr = " " * 4
      prov_rsa_full = 1
      crypt_verifycontext = 0xF0000000

      if crypt_acquire_context.call(hProvStr, nil, nil, prov_rsa_full, crypt_verifycontext) == 0
        raise SystemCallError, "CryptAcquireContext failed: #{lastWin32ErrorMessage}"
      end
      @hProv, = hProvStr.unpack('L')

      @has_win32 = true
    rescue LoadError
      @has_win32 = false
    end
  end
  if @has_win32
    bytes = " ".force_encoding("ASCII-8BIT") * n
    if @crypt_gen_random.call(@hProv, bytes.size, bytes) == 0
      raise SystemCallError, "CryptGenRandom failed: #{lastWin32ErrorMessage}"
    end
    return bytes
  end

  raise NotImplementedError, "No random device"
end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T03:55:52.713

所使用的种子`SecureRandom`禁止在 PID 被回收时出现的可预测随机数。如果没有 中的修复`SecureRandom`，OpenSSL 的随机数生成器将在拥有相同 PID 的不同进程中生成完全相同的值。

[#4579](http://bugs.ruby-lang.org/issues/4579)概述了这是如何发生的， OpenSSL 邮件列表中的[相应条目](http://marc.info/?l=openssl-dev&m=130289811108150&w=2)或多或少地告诉我们，这必须在客户端代码中处理。这就是为什么在 Ruby 中选择这个种子来防止安全威胁的原因。如果不相信，请在此修复之前运行附加在 Ruby 版本上的[脚本](http://bugs.ruby-lang.org/attachments/1604/test_fork_random.rb)Eric Wong 以查看所有内容。

添加到 owlstead 的解释中，此时播种 OpenSSL 的 RNG 并不会损害安全性，因为未初始化的随机生成器将始终`RAND_poll`首先调用，这将收集足够的熵，而不管先前是否播种/添加了值。

然而，由于种子值`SecureRandom`显然是可预测的，我们不应该假设它们增加了任何熵。OpenSSL 的内部行为可能会在某些时候发生变化，如果认为已经播种的值包含足够的熵，它可能会跳过初始熵收集。

因此，我打开了[#6928](http://bugs.ruby-lang.org/issues/6928)，它将选择一种更具防御性的方法，即假设添加到熵池中以区分不同进程的值没有熵——这将迫使 OpenSSL 在所有情况下可靠地收集足够的熵。

总之，值（PID 和时间）的选择是明智的，它甚至增加了整体安全性（通过防止“循环 PID 攻击”）而不是减少它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-25T15:31:54.303

这取决于使用 RNG 的 Ruby 的配置：

> **安全的随机数生成器接口。**
> 
> 该库是安全随机数生成器的接口，适用于在 HTTP cookie 等中生成会话密钥。
> 
> 它支持以下安全随机数生成器。
> 
> *   openssl
>     
>     
> *   `/dev/urandom`
>     
>     
> *   Win32

以上三项通常都被认为是安全的。`SecureRandom`但是，如果它实际上是安全的，则取决于类的实现。了解这一点的唯一方法是对实现进行广泛研究。

[**查看问题中的代码很明显，Ruby 在额外**](http://www.openssl.org/docs/crypto/rand.html#INTERNALS)播种 PID后直接使用 OpenSSL 生成的字节：

> 每当添加种子数据时，都会将其插入到“状态”中，如下所示。
> 
> 输入被分成 20 个字节的单位（最后一个块或更少）。这些块中的每一个都通过散列函数运行如下：传递给散列函数的数据是当前的“md”，与当前“状态”（由递增循环索引确定的位置）的字节数相同“block”、新的关键数据“block”和“count”（每次使用后递增）。其结果保存在“md”中，并在用作散列函数输入的相同位置处异或到“状态”中。我相信这个系统解决了点 1（散列函数；目前是 SHA-1）、3（“状态”）、4（通过“md”）、5（通过使用散列函数和 xor）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-25T18:08:27.433

我的一位同事对此进行了调查，发现引入种子的选择是对这个错误的回应：

[http://bugs.ruby-lang.org/issues/4579](http://bugs.ruby-lang.org/issues/4579)

幸运的是，OpenSSL 使用来自 /dev/urandom（如果可用）或 egd（“熵收集守护进程”——/dev/urandom 的前身）的 256 位熵为自己播种，具体取决于它的编译方式。播种在第一次调用 RAND_status() 或 RAND_bytes() 时自动发生，并且如果显式调用 RAND_seed() 则不会被抑制。感谢 OpenSSL 人员的这一决定。这是特定 OpenSSL 代码的链接：

[http://cvs.openssl.org/dir?d=openssl/crypto/rand](http://cvs.openssl.org/dir?d=openssl/crypto/rand)

有趣的文件是 md_rand.c、rand_lib.c 和 rand_unix.c。

# regex - 正则表达式中的符号

> ID：12118407
> 
> 赞同：2
> 
> 时间：2012-08-25T01:16:54.917
> 
> 标签：regex, notation

我正在尝试学习正则表达式。我看过几个教程，但我没有发现它们清晰或全面。我的问题是何时使用 ^$ 以及何时使用 "\b"。用过的？我知道他们的意思，但只是确定如何。

一些例子：

```
1\. \((\d+)\)\.\((\d+)\)\.\((\d+)\)
2\. \b1?264[)- ]*\d{3}[- ]*\d{4}\b
3\. ^[a-g]{4}$ 
```

不是所有的正则表达式都必须以 "^" 开头并以 "$" 结尾吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-25T01:19:16.490

在查看它们何时使用之前，首先您需要了解它们的含义：

*   `^`是线[锚](http://www.regular-expressions.info/anchors.html)的开始。
*   `$`是线锚的终点。
*   `\b`匹配[单词边界](http://www.regular-expressions.info/wordboundaries.html)。换句话说，它匹配单词字符`\w`和非单词字符`\W`或字符串的开头或结尾。

例如：

*   要检查字符串是否以数字*开头*，请使用`^\d`.
*   要检查字符串是否以数字*结尾*，请使用`\d$`.
*   检查字符串是否包含单词`foo`use `\bfoo\b`。省略单词边界会导致它匹配包含`foo`诸如`seafood`.

# jquery - 在 .load()'ed 的 div 上使用 jquery 效果

> ID：12118410
> 
> 赞同：0
> 
> 时间：2012-08-25T01:17:07.600
> 
> 标签：jquery, load

我有一些 jQuery 效果（`slideUp()`等）可以正常工作。

现在我`.load()`在`setTimeout`那里的 div 之后，效果不再起作用。

`.load()`这是因为在我推测之前 div 并不存在。

效果和效果`.load()`都在同一个JS文件中，并且都被包裹在`jQuery(document).ready(function($) { /*They are here*/ });`

`.load()`在'ed in之后，如何在这些 div 上调用这些效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T01:19:47.263

由于您没有发布设置 .slideUp() 方法等的代码。我假设您有这样的事情：

```
$(function) () {

   $('.class').slideUp(300);
   $('.wrapper').load('someurl.html'); // this loads some elements with .class
   // these elements won't get slideUp applied because they are not in the DOM at the time of the slideUp call

)}; 
```

您需要在负载回调中设置事件/函数：

```
$('#result').load('ajax/test.html', function() {
  //apply events to new elements
  $('.class').slideUp(300);  // this would be inside a click event I'm assuming
}); 
```

或者如评论中所述......您可以（应该）使用 .on 可以处理委派。我的意思是尝试帮助您理解为什么不应用这些事件

# python - PickleDb 无法从数据库中检索对象

> ID：12118411
> 
> 赞同：2
> 
> 时间：2012-08-25T01:17:19.970
> 
> 标签：python, django

我正在使用 PickleDb 保存 Django 应用程序的状态。问题是虽然我可以保存到数据库中，但我无法从中检索。这是我的（简化的）代码，当我在 Django 开发服务器上本地运行它时，它实际上工作得很好。

```
import pickledb

gamesdb = pickledb.load('games.db', False)

def play(request):

    game = Game()
    game.players = ['Adam', 'Eve']

    gamesdb.set(game.uid, game)

    return render_to_response('index.html', {})

def current_player(request, game_uid):

    game = gamesdb.get(game_uid)
    current_player = game.players[0] 

    return HttpResponse(play_data, mimetype='application/json') 
```

当我尝试检索`game.players[0]`时，它告诉我那`game`是`None`

# javascript - 有什么理由不在不同的源文件中提供相同的模块吗？

> ID：12118427
> 
> 赞同：2
> 
> 时间：2012-08-25T01:21:35.183
> 
> 标签：javascript, module, google-closure-library

例如：

```
// a.js
goog.provide('mypackage.a');
goog.provide('mypackage.commands');

mypackage.a.somevar = 1;

mypackage.commands.save = function(...) {...};

// b.js
goog.provide('mypackage.b');
goog.provide('mypackage.commands');

mypackage.b.somevar = 1;

mypackage.commands.read = function(...) {...};

// mypackage/commands.js
goog.provide('mypackage.commands');

mypackage.commands.runCommand = function(commandText, args) {
  return mypackage.commands[commandText](args);
} 
```

这是提供一组可扩展命令的好方法，还是有什么东西可以使我没有想到的复杂？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T01:53:20.147

没有理由不能或不应该在不同的源文件中提供相同的模块。如果它对您的源代码组织方案有意义，那么这是一件非常好的事情。我们拥有的主要原因之一`goog.provide()`是可以在多个不同的地方使用相同的符号，但在恰好首先运行的任何文件中定义。

如果我理解`goog.provide()`正确，它所做的就是确保声明了一个对象。因此， goog.provide('mypackage.commands `) makes sure that`mypackage.commands` 是在全局范围内声明的。

所以`goog.provide('mypackage.commands');`只需完成类似的事情：

```
window.mypackage = window.mypackage || {};
window.mypackage.commands = window.mypackage.commands || {}; 
```

只有当您计划在此源文件中向该对象添加内容时，您才需要这样做。因此，如果多个源文件都在向 中添加新项目`mypackage.commands`，那么每个源文件都会执行`goog.provide('mypackage.commands`)` 以确保声明了正确的全局变量结构。

这似乎是您在代码示例中所做的事情，这是一件非常好的事情。这取决于你自己对代码组织的感觉，是让多个源文件都贡献给同一个对象（就像你有的那样）更好，还是应该组织你的源文件，以便与一个特定命名空间有关的所有代码都在同一个对象中文件。这完全取决于您以及您认为如何最好地组织源代码 - 没有正确或错误的答案，除了它的组织方式应该有一些押韵和原因。

有用的参考文章：[https ://developers.google.com/closure/library/docs/tutorial](https://developers.google.com/closure/library/docs/tutorial)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T19:01:55.333

使用`goog.provide()`在多个文件中定义相同的命名空间不会覆盖命名空间，因为从左到右检查命名空间的每一级是否存在。但是，[闭包库](https://developers.google.com/closure/library/)遵循每个命名空间仅在一个文件中提供的约定。

从[***关闭：权威指南***](https://rads.stackoverflow.com/amzn/click/com/1449381871)第 49 页：

> Every JavaScript file in the Closure Library starts with at least one call to `goog.provide().` **All elements added to the namespace being provided are added in that file.** Like Java, files live in a directory structure that parallels the namespace, though this is not required for Closure as it is for Java. This convention does make it easier to find the file responsible for a given namespace, however. It is recommended that you follow this convention in your own JavaScript projects that use Closure.

In addition, when using [Closure Builder](https://developers.google.com/closure/library/docs/closurebuilder) to manage dependencies, the following error is generated when the same namespace is provided by multiple files.

> depstree.MultipleProvideError: Namespace "your.namespace" provided more than once in sources

但是，如果您仍想在多个文件中提供相同的命名空间，则可以使用[Closure Compiler](https://developers.google.com/closure/compiler/)标志管理依赖项`--only_closure_dependencies`而不会出错。

# jquery - 使用 ICanHaz 从 JSON 渲染 HTML 字符串

> ID：12118428
> 
> 赞同：2
> 
> 时间：2012-08-25T01:21:56.480
> 
> 标签：jquery, json, asp.net-mvc-4, icanhaz.js

我正在使用 MVC 4 和新的 WebAPI 开发一个简单的博客应用程序。我还使用 ICanHaz.js 来呈现从我创建的 webAPI 方法返回的结果。我已经能够让渲染工作，但评论的实际文本是 HTML，所以从 webAPI 方法返回的 JSON 如下所示：

```
{"Title":"just a small title",
"Body":"<p>blah blah blah</p><p>blah blah <strong>blah</strong></p>"} 
```

我的模板看起来像这样。

```
<article>
    <h2><a href="#" onclick="GetSingePost({{Id}})">{{ Title }}</a></h2>

    {{ Body }}
</article> 
```

如何从 JSON 对象获取 HTML 以实际呈现为 HTML？我试过三重括号：

```
{{{ Body }}} 
```

那没有用。任何建议都会非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T20:50:03.220

您可以只使用 JQuery 将 html 设置为模板中的元素。

```
<article>
  <h2><a href="#" onclick="GetSingePost({{Id}})">{{ Title }}</a></h2>
  <div class="content"></div>
</article>

var data = {
  first_name: "Henrik",
  last_name: "Joreteg",
  html : "<h1>Hello</h1>"
}

// I can has user??
html = ich.user(data)
$(html).find('.content').html(data.html); 
```

不理想，但会工作。

# objective-c - AVCaptureStillImageOutput 缺少元数据

> ID：12118432
> 
> 赞同：1
> 
> 时间：2012-08-25T01:23:23.413
> 
> 标签：objective-c, exif, avcapturesession

我使用以下代码来捕获图像：

```
[self.stillImageOutput captureStillImageAsynchronouslyFromConnection:videoConnection completionHandler:^(CMSampleBufferRef imageSampleBuffer, NSError *error) {
     CFDictionaryRef exifAttachments = CMGetAttachment(imageSampleBuffer, kCGImagePropertyExifDictionary, NULL);
     NSData *imageData = [AVCaptureStillImageOutput jpegStillImageNSDataRepresentation:imageSampleBuffer];
     UIImage *image = [[UIImage alloc] initWithData:imageData];
     NSDictionary *metadata = (__bridge NSDictionary*)exifAttachments;
     NSLog(@"%@",metadata");
}]; 
```

这是记录的输出：

```
ApertureValue = "2.526068811667588";
BrightnessValue = "-0.5270684580355165";
ExposureMode = 0;
ExposureProgram = 2;
ExposureTime = "0.06666666666666667";
FNumber = "2.4";
Flash = 16;
FocalLenIn35mmFilm = 35;
FocalLength = "4.28";
ISOSpeedRatings =     (
    500
);
MeteringMode = 5;
PixelXDimension = 3264;
PixelYDimension = 2448;
SceneType = 1;
SensingMethod = 2;
ShutterSpeedValue = "3.906905022631062";
SubjectArea =     (
    1631,
    1223,
    881,
    881
);
WhiteBalance = 0; 
```

为什么我没有得到任何时间相关的元数据？我想知道这张照片是什么时候拍摄的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T02:25:04.570

我确定日期和时间在添加到相机胶卷后添加到元数据中（开发人员部分没有任何工作）。无需担心信息丢失！

# jquery - 使用 jquery 在活动 div 上添加类

> ID：12118434
> 
> 赞同：1
> 
> 时间：2012-08-25T01:23:31.807
> 
> 标签：jquery

[JSF](http://jsfiddle.net/sureshmonster/b3VaX/2/)中。我想在当前活动的 div 上添加类。我知道我需要使用 addClass() 但我不知道我必须在哪里使用它？

html:

```
<div class="myclass selected">
Content 1
</div>
<div class="myclass">
    Content 2
</div>
<div class="myclass">
Content 3
</div>

<ul>
  <li><img     src="http://www.lillehammer.com/ImageVault/Images/id_2122/scope_66/ImageVaultHandler.aspx"     /></li>
  <li><img     src="http://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/Valued_image_seal.svg/40px-            Valued_image_seal.svg.png" /></li>
  <li><img src="http://www.iconico.com/i/icoImageFilterPro100.gif" /></li>
</ul>

<a class="next">next</a> 
```

jQuery：

```
$('img', 'ul').on('click', function() {
    $(".myclass").eq($(this).parent('li').index()).show()
                 .siblings('div').hide();
});

$('.selected').show();

$(".next").click(function(){
    if ($('.myclass:visible').length) {
        var curr = $('.myclass:visible'),
            next = curr.next('.myclass').length?    curr.next('.myclass'):$('.myclass').first();

        curr.hide();
        next.show();
    }else{
        $('.myclass').first().show();
    }
}); 
```

​ ​</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T01:57:42.270

您是否打算突出显示`li`当前处于活动状态的内容？[http://jsfiddle.net/b3VaX/50/](http://jsfiddle.net/b3VaX/50/)

您的代码很好，但是如果您的 css 专注于突出显示和显示，您的 javascript 只需担心切换 css 类以获取活动元素。

```
setActive(0);

$('li').click(function() {
    setActive($(this).index());
});

$(".next").click(function(){
    var current = $('ul li.selected').index(),
        maxIndex = $('ul li').length - 1,
        next = (current + 1) >  maxIndex ? 0 : (current + 1);

    setActive(next);
});

function setActive(i) {
    var li = $('ul li').eq(i);

    $('ul li').removeClass('selected');
    li.addClass('selected');
    $('.myclass').removeClass('selected');
    $('.myclass').eq(i).addClass('selected');
}

​ 
```

CSS：

```
.myclass.selected {
    display: block;
}

ul li.selected {
    background-color: yellow;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T01:32:49.167

不完全确定您实际上要在哪里添加/删除类，但请看一下：

```
$(".next").click(function(){
    if ($('.myclass:visible').length) {
        var curr = $('.myclass:visible'),
            next = curr.next('.myclass').length?curr.next('.myclass'):$('.myclass').first();

        curr.hide().removeClass('someClassHere');
        next.show().addClass('someOtherClassHere');
    }else{
        $('.myclass').first().show();
    }
}); 
```

[**JSFiddle**](http://jsfiddle.net/b3VaX/6/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T01:44:43.833

听起来您正在尝试向您正在显示的元素添加一个类并将其从您正在隐藏的元素中删除。这应该做到这一点：http: [//jsfiddle.net/cjc343/b3VaX/15/](http://jsfiddle.net/cjc343/b3VaX/15/)

我所做的更改非常简单：在您的每个点击事件中，当您显示（）某些内容时，会添加“选定”类，而当您隐藏（）某些内容时，它会被删除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T01:49:50.160

也许这就是你想要做的 [http://jsfiddle.net/unloco/b3VaX/39/](http://jsfiddle.net/unloco/b3VaX/39/)

CSS：

```
li.active img{border:1px solid red} 
```

首先，“激活”第一个 li，

```
$('ul#myul li:first').addClass('active'); 
```

然后点击激活下一个：

```
$('ul#myul li.active').removeClass('active').next().addClass('active').length ||
$('ul#myul li:first').addClass('active'); 
```

# ruby-on-rails - Rails 设计密码恢复来自：地址

> ID：12118436
> 
> 赞同：0
> 
> 时间：2012-08-25T01:24:10.677
> 
> 标签：ruby-on-rails, devise, google-apps

除了用于登录 smtp 服务器的电子邮件之外，还有什么方法可以将密码恢复期间的“发件人：”地址更改为其他地址？

这是我的设置方式：

应用程序/配置/环境/development.rb

```
config.action_mailer.smtp_settings = {
 :address              => "smtp.gmail.com",
 :port                 => 587,
 :domain               => 'domain.com',
 :user_name            => 'USERNAME@domain.com',
 :password             => 'PASSWORD',
 :authentication       => :plain,
 :enable_starttls_auto => true
 } 
```

应用程序/初始化程序/Devise.rb

```
config.mailer_sender = 'no-reply@domain.com' 
```

当您收到密码恢复电子邮件时，“发件人：”地址是 USERNAME@domain.com，当您点击回复时，它被设置为发送到 no-reply@domain。我也想将“发件人：”地址更改为 no-reply@domain.com，或者如果可能的话，可以将其更改为我在谷歌应用程序中设置的通讯组之一（有什么方法可以进行身份​​验证使用群组电子邮件？）。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:05:39.690

不幸的是，这来自 Google 的 SMTP 服务器，与任何 Rails 配置无关。GMail 将始终默认使用您登录的帐户作为发件人地址。

有一些方法可以在 GMail 中更改它，但是所有邮件都会默认从该地址发送。此外，GMail 不允许针对组进行身份验证。

这和谷歌每天发送 200 封电子邮件的限制都迫使我寻找替代方案。目前，我在所有应用程序中都使用[SendGrid](http://sendgrid.com/)发送电子邮件。就您的邮件 smtp 设置而言，这些配置与 GMail 的配置完全相同。然后，您可以覆盖您想要的电子邮件中的 from。

# web-applications - 使用 sinatra 创建一个小型 Web 应用程序

> ID：12118443
> 
> 赞同：0
> 
> 时间：2012-08-25T01:25:31.543
> 
> 标签：web-applications, sinatra

我想用 ruby​​ 和 sinatra 创建一个小型 Web 应用程序，我可以在没有 Javascript 的情况下过得很好吗？它不需要具有高级用户界面。

我刚开始学习 ruby​​，对网络的东西还不太了解。我会在完成应用程序后学习 JS，但同时学习两种语言有点困难。

以后可以轻松添加 JS 来改进 UI 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T22:14:11.380

是的！事实上，事后添加 JavaScript 通常是最简洁的处理方式，因为它可以帮助您将内容与行为清晰地分开，并确保您的网站可访问。

而且，当然，你总是可以永远不用 JavaScript。这通常很好，但无论如何都不是必需品。

# c - Linux 上 C 代码的编译错误（在 OSX 上编译相同的代码）

> ID：12118447
> 
> 赞同：3
> 
> 时间：2012-08-25T01:26:28.543
> 
> 标签：c, linux, gcc, ubuntu, linker

我正在尝试在 linux 上编译一些我知道在 OSX 上编译的代码，但我遇到了一些问题。

所有文件都有名为 .h 的标题，并且所有文件都在同一个目录中。我是这样编译的：

```
gcc *.c -std=c99 -lpthread 
```

虽然这段代码确实在 OSX 上编译，但我在安装 Ubuntu 时遇到了一堆奇怪的链接器错误。我是否缺少一些编译器选项？它是一个默认的 Ubuntu 服务器安装，带有附加的软件包`gcc`并`build-essential`已安装。

```
In file included from errorLogger.h:24:0,
                 from configParser.h:17,
                 from configParser.c:9:
signalHandling.h:24:18: error: unknown type name ‘sigset_t’
configParser.c: In function ‘parseConfigFile’:
configParser.c:114:5: warning: implicit declaration of function ‘getline’ [-Wimplicit-function-declaration]
In file included from errorLogger.h:24:0,
                 from global.h:18,
                 from connection.h:19,
                 from connection.c:10:
signalHandling.h:24:18: error: unknown type name ‘sigset_t’
connection.c: In function ‘createConnectionQueue’:
connection.c:189:28: warning: assignment makes integer from pointer without a cast [enabled by default]
In file included from errorLogger.h:24:0,
                 from database.h:16,
                 from database.c:9:
signalHandling.h:24:18: error: unknown type name ‘sigset_t’
In file included from errorLogger.h:24:0,
                 from errorLogger.c:10:
signalHandling.h:24:18: error: unknown type name ‘sigset_t’
errorLogger.c: In function ‘reportError’:
errorLogger.c:63:5: warning: implicit declaration of function ‘strerror_r’ [-Wimplicit-function-declaration]
errorLogger.c: In function ‘logMessage’:
errorLogger.c:87:5: warning: implicit declaration of function ‘localtime_r’ [-Wimplicit-function-declaration]
errorLogger.c: In function ‘processErrorQueue’:
errorLogger.c:131:17: warning: implicit declaration of function ‘open’ [-Wimplicit-function-declaration]
errorLogger.c:131:57: error: ‘O_APPEND’ undeclared (first use in this function)
errorLogger.c:131:57: note: each undeclared identifier is reported only once for each function it appears in
errorLogger.c:131:68: error: ‘O_CREAT’ undeclared (first use in this function)
errorLogger.c:131:78: error: ‘O_WRONLY’ undeclared (first use in this function)
errorLogger.c:131:88: error: ‘S_IWRITE’ undeclared (first use in this function)
errorLogger.c:131:99: error: ‘S_IREAD’ undeclared (first use in this function)
errorLogger.c:146:13: warning: implicit declaration of function ‘fsync’ [-Wimplicit-function-declaration]
errorLogger.c: In function ‘startErrorLogger’:
errorLogger.c:167:36: error: ‘O_APPEND’ undeclared (first use in this function)
errorLogger.c:167:47: error: ‘O_CREAT’ undeclared (first use in this function)
errorLogger.c:167:57: error: ‘O_WRONLY’ undeclared (first use in this function)
errorLogger.c:167:67: error: ‘S_IWRITE’ undeclared (first use in this function)
errorLogger.c:167:78: error: ‘S_IREAD’ undeclared (first use in this function)
errorLogger.c:214:57: error: ‘O_EXCL’ undeclared (first use in this function)
errorLogger.c:231:27: warning: assignment makes integer from pointer without a cast [enabled by default]
errorLogger.c: In function ‘closeErrorLogger’:
errorLogger.c:246:9: warning: implicit declaration of function ‘pthread_kill’ [-Wimplicit-function-declaration]
In file included from errorLogger.h:24:0,
                 from global.h:18,
                 from global.c:9:
signalHandling.h:24:18: error: unknown type name ‘sigset_t’
In file included from main.c:23:0:
signalHandling.h:24:18: error: unknown type name ‘sigset_t’
main.c: In function ‘main’:
main.c:53:5: warning: implicit declaration of function ‘blockSignals’ [-Wimplicit-function-declaration]
main.c:61:45: error: invalid application of ‘sizeof’ to incomplete type ‘struct addrinfo’ 
main.c:62:29: error: invalid application of ‘sizeof’ to incomplete type ‘struct addrinfo’ 
main.c:64:10: error: dereferencing pointer to incomplete type
main.c:65:10: error: dereferencing pointer to incomplete type
main.c:66:10: error: dereferencing pointer to incomplete type
main.c:66:23: error: ‘AI_PASSIVE’ undeclared (first use in this function)
main.c:66:23: note: each undeclared identifier is reported only once for each function it appears in
main.c:69:5: warning: implicit declaration of function ‘getaddrinfo’ [-Wimplicit-function-declaration]
main.c:73:9: warning: implicit declaration of function ‘gai_strerror’ [-Wimplicit-function-declaration]
main.c:73:9: warning: format ‘%s’ expects argument of type ‘char *’, but argument 4 has type ‘int’ [-Wformat]
main.c:73:9: warning: format ‘%s’ expects argument of type ‘char *’, but argument 4 has type ‘int’ [-Wformat]
main.c:81:41: error: dereferencing pointer to incomplete type
main.c:83:30: error: dereferencing pointer to incomplete type
main.c:83:46: error: dereferencing pointer to incomplete type
main.c:83:64: error: dereferencing pointer to incomplete type
main.c:96:30: error: dereferencing pointer to incomplete type
main.c:96:44: error: dereferencing pointer to incomplete type
main.c:112:5: warning: implicit declaration of function ‘freeaddrinfo’ [-Wimplicit-function-declaration]
main.c:138:9: error: unknown type name ‘fd_set’
main.c:142:9: warning: implicit declaration of function ‘FD_ZERO’ [-Wimplicit-function-declaration]
main.c:143:9: warning: implicit declaration of function ‘FD_SET’ [-Wimplicit-function-declaration]
main.c:145:9: warning: implicit declaration of function ‘pselect’ [-Wimplicit-function-declaration]
In file included from signalHandling.c:10:0:
signalHandling.h:24:18: error: unknown type name ‘sigset_t’
signalHandling.c:12:18: error: unknown type name ‘sigset_t’
signalHandling.c: In function ‘setHandler’:
signalHandling.c:51:53: error: invalid application of ‘sizeof’ to incomplete type ‘struct sigaction’ 
signalHandling.c:52:36: error: invalid application of ‘sizeof’ to incomplete type ‘struct sigaction’ 
signalHandling.c:54:5: warning: implicit declaration of function ‘sigemptyset’ [-Wimplicit-function-declaration]
signalHandling.c:54:30: error: dereferencing pointer to incomplete type
signalHandling.c:60:9: warning: implicit declaration of function ‘sigaddset’ [-Wimplicit-function-declaration]
signalHandling.c:60:35: error: dereferencing pointer to incomplete type
signalHandling.c:67:17: error: dereferencing pointer to incomplete type
signalHandling.c:72:9: warning: implicit declaration of function ‘sigaction’ [-Wimplicit-function-declaration] 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-25T01:34:07.193

你可能错过了一些`#include`在 OS X 上隐式引入的 s，但在 Linux 上却没有。

从错误消息来看，您可能至少缺少包括：

*   `<signal.h>`（为`sigset_t`和其他人）
*   `<fcntl.h>`（对于`O_*`）
*   `<unistd.h>`（一堆东西）
*   `<netdb.h>`（用于各种网络函数和常量）
*   `<stdio.h>`（对于`getline`）

您可能还需要定义一些功能宏（例如`_POSIX_C_SOURCE`）来获得某些系统相关的功能，包括`strerror_r`和`pselect`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-25T01:33:17.277

我假设直接目标是完全编译代码，一旦完成，您将返回并修改源代码，以便它在两个平台上开箱即用。这意味着黑客在短期内是可以接受的；当您了解可移植性问题时，它们将得到正确修复。（如果有什么安慰的话，最初开发软件的系统的第一个替代系统通常是最难的；之后，它通常会变得更容易。）

首先要尝试的是：

```
gcc *.c -std=gnu99 -lpthread 
```

这告诉系统头文件定义比`-std=c99`. （关于这个主题有一些异议，这没关系。至少，如果您添加`-pedantic`到`-std=c99`编译中，那么除非您还请求 POSIX 支持，否则不会公开 POSIX 定义的标准 C 标头中的符号 - 见下文。因为您不have `-pedantic`，这可能不是编译中的一个因素，在这种情况下，悄悄地转向下一个建议，这是未来可移植到 POSIX 系统的基础。）

如果这不足以让你回到正轨，那么你可能需要使用类似的东西：

```
gcc *.c -std=gnu99 -D_XOPEN_SOURCE=700 -lpthread 
```

这表示“为我提供与 POSIX 2008 对应的 POSIX 和 X/Open 函数”。您可以为旧版本尝试 600 和 500，但在 Linux 上您可能不需要这样做。在适当的时候，您可能会`_XOPEN_SOURCE`通过配置标头或通过配置工具自动设置。当您完全编译时，在命令行上指定它是可以的。在适当的时候，您将使用 a`makefile`或等效程序来控制编译，而不是`gcc`在 shell 中键入命令行。）

在 POSIX 下定义`sigset_t`。`<signal.h>`因此，明确请求 POSIX 支持应该让事情再次正确编译。如果您仍然得到诸如`sigset_t`undeclared 之类的类型，那么 Mac OS X 上必须有一个标头，其中包含标准标头，例如`<signal.h>`但它在 Linux 上执行一些不相关的任务（因此不包括`<signal.h>`）。这将需要源代码审查。但是，它相对不太可能是必要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-25T01:33:49.207

您需要包含其他头文件，因为不同的系统头文件包含其他不同的系统头文件。

此外，例如 gcc 一直在努力不包含它不应该包含的标题。

是否`signalHandling.h`包括`#include <signal.h>`sigset_t 的定义位置？

**编辑**

与 OP 交谈后，问题似乎是编译/链接问题。首先将源代码编译为目标文件，然后链接它们似乎已经解决了他们的问题。

# php - 使用 Ajax/Javascript 更改 PHP URL 变量

> ID：12118457
> 
> 赞同：1
> 
> 时间：2012-08-25T01:28:20.520
> 
> 标签：php, ajax, url, variables, dynamic

作为完整网站重新设计的一部分，我在私人服务器上制作了一个网页。该页面使用 AJAX 代码调用诸如 contact.php 之类的文件以显示 DIV 层中的内容，因此实际页面仍然是 index.php，但看起来像一个联系人页面。

我想要做的是有一个功能，当单击此类链接以进行 AJAX 调用时，将动态更改 URL，以便如果有人单击联系人链接，页面 URL 看起来像 index.php?page=contact（如一个例子）。

当您单击新闻提要中的照片然后更改为来自同一用户/图库的另一张照片时，Facebook 具有我希望使用的那种系统。我不想要只是从哈希标记 (#) 更改 URL 的东西，因为这只会增加设计的复杂性，而将 PHP 变量放入 URL 仅意味着我可以编写 PHP 代码来包含文件如果设置了变量，则直接。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T01:51:52.447

您是否考虑过使用 History.js？

听起来您实际上是想使用 $_GET 变量来指示页面上提供的内容……有点。虽然看起来你也是通过基于这个 var 的 ajax 调用该内容，所以 php 在这种情况下大多是无关紧要的，因为它将是 js 解析 url 并决定 ajax 的内容。历史将为你做这一切. 它将 url 读取为一种状态，并按照您的指示服务。显然它不是那么简单，但是如果您阅读文档，就会很清楚如何使用它。 [https://github.com/balupton/jquery-history](https://github.com/balupton/jquery-history)

# delphi - 调整状态栏面板的大小以适应内容

> ID：12118459
> 
> 赞同：6
> 
> 时间：2012-08-25T01:29:30.950
> 
> 标签：delphi

假设我的状态栏有 3 个面板，最左边的是应用程序正在运行的文件的名称。

那可能是我`c:\my.log`或`c:\a\very\deeply\nested\sub-directory\extremely_long_file_name_indeed.log`

加载新文件时，是否有一种简单的方法可以调整 3 个状态栏面板的大小？（甚至可能是 FOSS VCL 组件——尽管我找不到）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-25T03:06:22.420

这实际上更像是 TLama 删除的答案的第一个版本，我更喜欢它：

```
type
  TForm1 = class(TForm)
    StatusBar1: TStatusBar;
    procedure FormResize(Sender: TObject);
  private
    procedure SetLeftPanelWidth;
  ..

uses
  filectrl, commctrl;

...

procedure TForm1.SetLeftPanelWidth;
var
  Borders: array[0..2] of Integer;
  PanelWidth, MaxWidth: Integer;
begin
  // calculate a little indent on both sides of the text (credit @TLama)
  SendMessage(StatusBar1.Handle, SB_GETBORDERS, 0, LPARAM(@Borders));

  StatusBar1.Canvas.Font := StatusBar1.Font;
  PanelWidth := StatusBar1.Canvas.TextWidth(StatusBar1.Panels[0].Text)
      + 2 * Borders[1] + 2;

  // Per Ken's comment, specify a maximum width, otherwise the panel can overgrow
  MaxWidth := StatusBar1.Width div 4 * 3; // arbitrary requirement
  if PanelWidth > MaxWidth then begin
    StatusBar1.Panels[0].Text := MinimizeName(TFileName(StatusBar1.Panels[0].Text),
        StatusBar1.Canvas, MaxWidth);
    // recalculate
    PanelWidth := StatusBar1.Canvas.TextWidth(StatusBar1.Panels[0].Text) +
        2 * Borders[1] + 2;
  end;
  StatusBar1.Panels[0].Width := PanelWidth;
end;

procedure TForm1.FormResize(Sender: TObject);
begin
  // have to set the text again since original filename might have been minimized
  StatusBar1.Panels[0].Text := ...;
  SetLeftPanelWidth;
end; 
```

如果路径不适合最大宽度，则上面会缩短路径，但原始文件名对用户不可见。为了能够对状态栏面板使用本机提示支持，面板的宽度必须小于文本可以容纳的宽度。

因此，作为替代方案，当文件名的长度超过最大宽度时，下面会截断文件名的尾随部分，并在鼠标悬停时显示工具提示：

```
type
  TStatusBar = class(comctrls.TStatusBar)
  protected
    procedure CreateParams(var Params: TCreateParams); override;
  end;

  TForm1 = class(TForm)
    StatusBar1: TStatusBar;
    procedure FormResize(Sender: TObject);
  private
    procedure SetLeftPanelWidth;
  ..

procedure TStatusBar.CreateParams(var Params: TCreateParams);
begin
  inherited;
  Params.Style := Params.Style or SBT_TOOLTIPS;
end;

procedure TForm1.SetLeftPanelWidth;
var
  Borders: array[0..2] of Integer;
  PanelWidth, MaxWidth: Integer;
begin
  SendMessage(StatusBar1.Handle, SB_GETBORDERS, 0, LPARAM(@Borders));

  StatusBar1.Canvas.Font := StatusBar1.Font;
  PanelWidth := StatusBar1.Canvas.TextWidth(StatusBar1.Panels[0].Text)
      + 2 * Borders[1] + 2;

  MaxWidth := StatusBar1.Width div 4 * 3; // arbitrary requirement
  if PanelWidth > MaxWidth then begin
    SendMessage(StatusBar1.Handle, SB_SETTIPTEXT, 0,
        NativeInt(PChar(StatusBar1.Panels[0].Text)));
    PanelWidth := MaxWidth;
  end else
    SendMessage(StatusBar1.Handle, SB_SETTIPTEXT, 0, 0);

  StatusBar1.Panels[0].Width := PanelWidth;
end;

procedure TForm1.FormResize(Sender: TObject);
begin
  SetLeftPanelWidth;
end; 
```

# javascript - 添加测验计时器，如果计时器达到0，则淡出/跳到下一个

> ID：12118474
> 
> 赞同：7
> 
> 时间：2012-08-25T01:33:23.940
> 
> 标签：javascript, jquery, setinterval

我对 jQuery 很陌生，但熟悉其他一些语言。我最近买了一个测验类型的脚本，我试图为每个问题添加一个简单的 15 秒计时器。这只是一个有趣的测验，因此无需担心用户使用 javascript 来增加时间等。

基本上，如果用户在 15 秒内没有选择一个问题，它将自动进入下一个问题，并且计时器重新开始。

Answers have the `.next`tag, and when chosen it moves onto the next question as the code below shows (hopefully).

```
superContainer.find('.next').click(function () {

            $(this).parents('.slide-container').fadeOut(500, function () {
                $(this).next().fadeIn(500)
            });

            return false
}); 
```

我遇到的问题是，如果我使用`setInterval`，我不知道如何再次选择适当的 div 来淡化它并淡入下一个。我已经尝试了下面的代码和一些类似的好斗的想法，但它不起作用，但也许它会让我更好地了解我所追求的。

```
superContainer.find('.next').click(function () {

    $active_count = $count;

    countInterval = setInterval(function() {
                $active_count--;
                if($active_count <= 0){
                    clearInterval(countInterval);
                    $active_count = $count;
                    $(this).parents('.slide-container').fadeOut(500, function () {
                        $(this).next().fadeIn(500)
                    });
                }
                $('.question-timer').html($active_count);
            }, 1000);

            $(this).parents('.slide-container').fadeOut(500, function () {
                $(this).next().fadeIn(500)
            });

            return false
}); 
```

我只使用 JQuery 一两天，所以请原谅任何明显的错误和糟糕的代码！如果您需要任何其他代码或信息，请告诉我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T05:05:32.277

对于第一个 jQuery 项目来说，这有点棘手。

诀窍（在这个解决方案中）是分解出一个`goNext`可以通过两种方式调用的函数——响应点击事件和响应 15 秒`setTimeout()`，而不是`setInterval()`.

```
$(function(){
    var questionTimeout = null;

    function goNext($el) {
        clearTimeout(questionTimeout);
        var $next = $el.next();
        $el.fadeOut(500, function() {
            if($next.length > 0) {
                $next.fadeIn(500, function() {
                    questionTimeout = setTimeout(function() {
                        goNext($next);
                    }, 15000);
                });
            }
            else {
                afterLastQuestion();
            }
        });
    }
    function afterLastQuestion(){
        alert("last question complete");
        $start.show();
    }

    var $superContainer = $("#superContainer").on('click', '.next', function() {
        goNext($(this).closest('.slide-container'));
        return false;
    });

    var $start = $("#start").on('click', function(){
        $(this).hide();
        $superContainer.find(".slide-container")
            .eq(0).clone(true,true)
            .prependTo(superContainer)
            .find(".next").trigger('click');
        return false;
    });
}); 
```

[演示](http://jsfiddle.net/wAA9L/)

该过程通过单击“开始”链接开始，导致第一个问题被克隆，然后模拟单击克隆的“下一个”链接。这确保了（实际）第一个问题的处理方式与所有其他问题完全相同。

我还包括了一个`afterLastQuestion()`功能。在回答最后一个问题（或超时）后，修改其操作以执行任何必要的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T01:57:20.807

您可以将当前问题保存在变量中，通过`next`单击和计时器将其重置，例如

```
var $current;
superContainer.find('.next').click(function (e) {

    e.preventDefault();
    $(this).parents('.slide-container').fadeOut(500, function () {
        $(this).next().fadeIn(500);
        $current = $(this).next();
    });

});​ 
```

您只需将其设置为初始化时的第一个问题，并记住`next`单击即可重置计时器

此外，通常最好使用`e.preventDefault()`而不是`return false`.

# actionscript-3 - TypeError：错误＃1006：值不是函数

> ID：12118488
> 
> 赞同：0
> 
> 时间：2012-08-25T01:38:27.653
> 
> 标签：actionscript-3, flash, actionscript

我有这段代码，但是当我运行它时，它给了我：

```
TypeError: Error #1006: value is not a function.
    at Main/startUp()
    at Main/refresh() 
```

我不明白为什么会这样说，有人可以启发我吗？代码检查 currentFrame 是否为 2，如果是，则运行启动并将主菜单添加到舞台，然后将事件侦听器添加到按钮，代码如下：

```
package 
{
    import flash.display.MovieClip;
    import flash.display.StageQuality;
    import flash.events.Event;
    import flash.events.MouseEvent;

    /**
     * ...
     * @author Andre
     */
    public class Main extends MovieClip 
    {
        var toStart:Boolean = true;
        public function Main()
        {
            stage.addEventListener(Event.ENTER_FRAME, refresh);
        }

        function refresh(e:Event):void 
        {
            if (this.currentFrame == 2 && toStart == true)
            {
                startUp();
                toStart = false;
            }

        }

        function startUp():void
        {
            var startScreen:lstartScreen = new lstartScreen();
            addChild(startScreen);
            //startScreen.startScreen_play.addEventListener(MouseEvent.CLICK, startGame)
            startScreen.startScreen_quality.startScreen_quality_high(MouseEvent.CLICK, changeQuality);
            startScreen.startScreen_quality.startScreen_quality_medium(MouseEvent.CLICK, changeQuality);
            startScreen.startScreen_quality.startScreen_quality_low(MouseEvent.CLICK, changeQuality);
        }

        function changeQuality(e:MouseEvent):void
        {

        }

    }

} 
```

如果您需要更多信息，或者我忘记了什么，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T01:53:59.890

对不起大家，我刚刚意识到我的愚蠢错误，当我写道：

```
startScreen.startScreen_quality.startScreen_quality_high(MouseEvent.CLICK, changeQuality);
startScreen.startScreen_quality.startScreen_quality_medium(MouseEvent.CLICK, changeQuality);
startScreen.startScreen_quality.startScreen_quality_low(MouseEvent.CLICK, changeQuality); 
```

我没有写 .addEventListener。我多么愚蠢。

# codeigniter - 什么是 100% 面向对象的优秀 php mvc 框架？

> ID：12118491
> 
> 赞同：0
> 
> 时间：2012-08-25T01:40:18.233
> 
> 标签：codeigniter, php

> **可能重复：**
> [PHP 中的完全面向对象的框架](https://stackoverflow.com/questions/535385/fully-object-oriented-framework-in-php)

我对 CodeIgniter 感到沮丧的一件事是，您既不能扩展控制器也不能扩展模型。我知道你可以用一个 mod 做 HMVC，这在一定程度上给了你继承能力，但我对此并不满意。是否有一个面向对象并且基本上允许扩展控制器、模型的 PHP MVC 框架？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T01:47:35.640

[CodeIgniter](http://codeigniter.com/user_guide/general/core_classes.html)的文档另有说明 - 第一个示例是：

> 如果您需要做的只是向现有库添加一些功能 - 可能添加一两个功能 - 那么用您的版本替换整个库就有点过头了。在这种情况下，最好简单地扩展类。扩展一个类几乎与替换一个类相同，但有几个例外：
> 
> 类声明必须扩展父类。您的新类名和文件名必须带有前缀`MY_`（此项是可配置的。见下文。）。

```
class MY_Controller extends CI_Controller {

    function __construct()
    {
        parent::__construct();
    }
}

// Then you can use it like this:
class Welcome extends MY_Controller {

    function __construct()
    {
        parent::__construct();
    }

    function index()
    {
        $this->load->view('welcome_message');
    }
} 
```

# android - 在移动设备上访问音乐

> ID：12118493
> 
> 赞同：0
> 
> 时间：2012-08-25T01:41:04.410
> 
> 标签：android, iphone, mobile

想开发一个利用移动设备音乐库的应用程序。对移动开发相当陌生（具有网络编程背景），并且正在寻找有关如何访问它的任何帮助。

从本质上讲，我想从图书馆（Itunes，无论如何）中获取一首随机歌曲并让它播放一段时间。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T01:46:16.027

您是否查看过 iOS 或 android SDK？媒体 API 是用于 android 设备的我相信[http://developer.android.com/reference/android/media/package-summary.html](http://developer.android.com/reference/android/media/package-summary.html)

# qt - 在 Qt QObject::connect 问题与 move()

> ID：12118495
> 
> 赞同：0
> 
> 时间：2012-08-25T01:41:29.320
> 
> 标签：qt

好的，所以当我运行它时（写出来只是为了显示问题）：

```
#include <QtGui/QApplication>
#include "mainwindow.h"
#include <QtGUI>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);

    QWidget *window = new QWidget;

    QPushButton *MainInter = new QPushButton("Push me!",window);

    QObject::connect(MainInter,SIGNAL(released()),MainInter,SLOT(move(100,100)));

    window->resize(900,500);
    window->show();
    return a.exec();
} 
```

为什么单击时按钮不移动？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T02:34:59.010

信号和槽必须具有相同的[签名](http://en.wikipedia.org/wiki/Type_signature)。实际上 slot 的签名可以比信号更短：

[http://qt-project.org/doc/qt-4.8/signalsandslots.html](http://qt-project.org/doc/qt-4.8/signalsandslots.html)

在您的情况下，情况正好相反：插槽具有更长的签名。您可以尝试[`QSignalMapper`](http://qt-project.org/doc/qt-4.8/qsignalmapper.html)创建一个“经纪人”来传递带有附加参数的信号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T23:01:23.987

`move`不是插槽，而是更改`pos`属性的访问器，它不能直接连接到信号。但是您可以将信号连接到将更改该属性的`start()`插槽：`QPropertyAnimation`

```
QPushButton *MainInter = new QPushButton("Push me!",window);

QPropertyAnimation *animation = new QPropertyAnimation(MainInter, "pos");
// To make the move instantaneous
animation->setDuration(0);
animation->setEndValue(QPoint(100,100));

QObject::connect(MainInter, SIGNAL(released()), animation, SLOT(start()));
... 
```

或者使该属性值成为 a 状态的一部分`QStateMachine`并使用信号转换到该状态：

```
QPushButton *MainInter = new QPushButton("Push me!",window);

QStateMachine *machine = new QStateMachine();
QState *s1 = new QState(machine);
QState *s2 = new QState(machine);
// the transition replaces the connect statement
s1->addTransition(MainInter, SIGNAL(released()), s2);
s2->assignProperty(MainInter, "pos", QPoint(100,100));
machine->setInitialState(s1);
machine->start();    
... 
```

# bash - 当我直接和通过 sh 执行 bash 脚本时，执行结果是不同的

> ID：12118498
> 
> 赞同：1
> 
> 时间：2012-08-25T01:42:52.670
> 
> 标签：bash, sh, increment

我有一个文件 new.sh

```
i=5
i=$[i+1]
echo $i 
```

当我执行 ./new.sh 时，它显示 6。但是当我执行“sh new.sh”时，它显示

```
$[i+1] 
```

作为输出。我只是想知道为什么，我需要一个适用于两者的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T02:37:13.470

许多 Linux 发行版使用 dash 作为脚本的标准 shell，因此 /bin/sh 只是 /bin/dash 的符号链接，它更轻量级，但与 bash 相比落后了一些功能。检查：

```
ls -l /bin/sh 
```

如果你想编写 POSIX 兼容的脚本，你应该使用 foo=$n; $((n=n+1)) 代替 foo=$((n++)) 和 foo=$((n=n+1)) 代替 foo=$((++n))。$[] 形式已弃用，应避免使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T01:47:34.977

操作系统根据第一行决定它是什么类型的文件。做了：

```
#!/bin/bash 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T01:58:43.603

行为是不同的，因为当`bash`作为 运行时`sh`，它会关闭`bash`特定功能并更接近[POSIX shell](http://pubs.opengroup.org/onlinepubs/9699919799/idx/shell.html)标准。

`bash`如果您希望您的代码在和下都能正常工作`sh`，您将需要使用语法`sh`子集编写代码。`bash`

# uml - 在 UML 状态机操作中指定触发器的正确 语法是什么？

> ID：12118499
> 
> 赞同：0
> 
> 时间：2012-08-25T01:44:20.370
> 
> 标签：uml, state-machine

我在一台子机内，我想触发从包含子机状态到另一个状态的转换。什么是正确的符号？那是，

子机：就绪 [Is_Conencted] / 触发 Go -> 终止节点

机器：Go / -> 运行

说“触发 Go”的 UML 语法正确的方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T02:03:09.247

在状态图中，如 IAR visualSTATE，带有信号（除了事件），触发`Go`信号的语法是

```
 Ready [Is_Conencted] / ^Go 
```

状态图不会触发事件——它们来自外部来源。

# trigger.io - 使用 jquery Trigger.io 应用程序的 UI 非常扭曲

> ID：12118502
> 
> 赞同：0
> 
> 时间：2012-08-25T01:45:29.660
> 
> 标签：trigger.io

**我有几个问题**：

1）我正在使用[Trigger.io](http://trigger.io)创建应用程序并尝试制作一个加载列表视图并显示数据的搜索表单。然而，当我在安卓模拟器上尝试时，用户界面非常扭曲，我也在我的安卓平板电脑上进行了测试。

列表视图中的所有圆角边框和图标看起来都非常混乱。有没有人对此有任何解决方案？

2) 如何在我的应用程序中添加广告？我可以使用admob吗？

3) 如何根据屏幕尺寸缩放 YouTube 视频？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T10:42:54.450

1) Android 2.x 对 CSS 圆角的渲染很丑陋，再加上旧的 2.x 手机具有较低的分辨率显示，导致一些看起来非常怪异的边框、阴影和斜角。也会大大降低页面速度 - 如果您想针对这些设备，如果可能的话，我会避免这些 CSS 效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T23:08:26.953

1) 您的 HTML 是否在浏览器中正确显示？不幸的是，我们不控制 HTML 呈现，因此您需要以与 webkit 兼容的方式编写标记。

2) 我们在中期计划中集成了 AdMob

3）如果你想全屏播放视频，请参阅[forge.media](http://docs.trigger.io/en/v1.4/modules/media.html)。对于内嵌视频，我们应该以与股票浏览器相同的方式运行 - 如果不是，请告诉我！

# xml - XSL 如何通过 ID 匹配值递归遍历节点

> ID：12118503
> 
> 赞同：0
> 
> 时间：2012-08-25T01:45:32.967
> 
> 标签：xml, xslt

我有以下 XML 示例，我需要一些帮助。示例 XML 具有匹配其他节点以找到我所追求的结果所需的 PackageID 和 SourcePackageID 值。
我为此提前道歉，这让我很难解释。如果您需要更多信息来理解这一点，请告诉我。:)

所需的结果是为 CompositionPackage 中其 Usage 元素为“TopLevel”的每个 Source 元素找到一个 MaterialPackage 匹配项。

有些结果更容易找到，因为它们是一场比赛。其他人虽然需要循环多个匹配项才能找到结果。

例如：生成的 /Name 元素引用具有匹配 PackageID 的 CompositionPackage 的 PackageName。但是：生成的 /Source 元素需要引用匹配的 CompositionPackage 的 SourcePackageID，然后使用其 PackageID 查找材料包的 PackageName。

在一种情况下，CompositionPackage/SourcePackageID 直接引用 MaterialPackage。如果 CompositionPackage 的 /Operation 值为“RepeatTransfer”，那么它会更困难一些，它会在链接到 MaterialPackage 之前引用另一个 CompositionPackage。嗯

任何帮助将不胜感激。

示例输入 XML：

```
<AAG version="1.1">
<Preface>
<ContentStorage>
  <MaterialPackage>
    <PackageTracks>
      <TimelineTrack>
        <TrackSegment>
            <ComponentLength>5066</ComponentLength>
        </TrackSegment>
      </TimelineTrack>
    </PackageTracks>
    <PackageName>Tape011</PackageName>
    <PackageID>urn:MM111</PackageID>
  </MaterialPackage>
  <CompositionPackage>
    <PackageTracks>
      <TimelineTrack>
        <TrackSegment>
            <SourcePackageID>urn:MM111</SourcePackageID>
            <ComponentLength>10099</ComponentLength>
        </TrackSegment>
      </TimelineTrack>
    </PackageTracks>
    <Operation>Transfer</Operation>
    <PackageName>NameABC</PackageName>
    <PackageID>urn:CC111</PackageID>
  </CompositionPackage>
  <CompositionPackage>
    <PackageTracks>
      <TimelineTrack>
        <TrackSegment>
            <SourcePackageID>urn:CC333</SourcePackageID>
            <ComponentLength>222</ComponentLength>
        </TrackSegment>
      </TimelineTrack>
    </PackageTracks>
    <Operation>RepeatTransfer</Operation>
    <PackageName>NameBCD</PackageName>
    <PackageID>urn:CC222</PackageID>
  </CompositionPackage>
  <CompositionPackage>
    <PackageTracks>
      <TimelineTrack>
        <TrackSegment>
            <SourcePackageID>urn:MM222</SourcePackageID>
            <ComponentLength>444</ComponentLength>
        </TrackSegment>
      </TimelineTrack>
    </PackageTracks>
    <Operation>Transfer</Operation>
    <PackageName>NameCDE</PackageName>
    <PackageID>urn:CC333</PackageID>
  </CompositionPackage>
  <CompositionPackage>
    <PackageTracks>
      <TimelineTrack>
        <TrackSegment>
            <SourcePackageID>urn:MM333</SourcePackageID>
            <ComponentLength>555</ComponentLength>
        </TrackSegment>
      </TimelineTrack>
    </PackageTracks>
    <Operation>Transfer</Operation>
    <PackageName>NameDEF</PackageName>
    <PackageID>urn:CC444</PackageID>
  </CompositionPackage>
  <MaterialPackage>
    <PackageTracks>
      <TimelineTrack>
        <TrackSegment>
        <ComponentLength>864</ComponentLength>
        </TrackSegment>
      </TimelineTrack>
    </PackageTracks>
    <PackageName>Tape012</PackageName>
    <PackageID>urn:MM222</PackageID>
  </MaterialPackage>
  <MaterialPackage>
    <PackageTracks>
      <TimelineTrack>
        <TrackSegment>
        <ComponentLength>864</ComponentLength>
        </TrackSegment>
      </TimelineTrack>
    </PackageTracks>
    <PackageName>Tape013</PackageName>
    <PackageID>urn:MM333</PackageID>
  </MaterialPackage>
  <CompositionPackage>
    <PackageTracks>
      <TimelineTrack>
        <TrackSegment>
            <Sequence>
                <Source>
                    <SourcePackageID>urn:CC111</SourcePackageID>
                </Source>
                <Source>
                    <SourcePackageID>urn:CC222</SourcePackageID>
                </Source>
                <Unknown>urn:0000</Unknown>
                <Source>
                    <SourcePackageID>urn:CC444</SourcePackageID>
                </Source>
            </Sequence>
        </TrackSegment>
      </TimelineTrack>
    </PackageTracks>
    <Usage>TopLevel</Usage>
    <Operation>Transfer</Operation>
    <PackageName>NameXXX</PackageName>
    <PackageID>urn:CCXXX</PackageID>
  </CompositionPackage>
</ContentStorage>
</Preface>
</AAG> 
```

预期输出 XML：

```
<AAG>
<Preface>
    <Book>
        <Name>NameABC</Name>
        <Source>Tape011</Source>
    </Book>
    <Book>
        <Name>NameBCD</Name>
        <Source>Tape012</Source>
    </Book>
    <Book>
        <Name>NameDEF</Name>
        <Source>Tape013</Source>
    </Book>
</Preface>
</AAG> 
```

当前 XSL：

```
<?xml version="1.0" encoding="UTF-8"?>

<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" omit-xml-declaration="no" indent="yes"/>
<xsl:strip-space elements="*"/>

<xsl:template match="@*|node()">
<xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
</xsl:copy>
</xsl:template>

<xsl:template match="AAG">

<AAG>
<Preface>
    <xsl:for-each select="/AAG/Preface/ContentStorage/CompositionPackage/PackageTracks/TimelineTrack/TrackSegment/Sequence[../../../../Usage='TopLevel']">

    <xsl:choose>
        <xsl:when test = "self::Source">
            <Book>
                <Name><xsl:value-of select="../../../../*[self::CompositionPackage or self::MaterialPackage]
                                                            [PackageID=current()
                                                            /SourcePackageID]/PackageName"/></Name>

                <!-- cant work out how to do this bit 
                                    need to find MaterialPackage/PackageName from a CompositionPackage that in turn references another CompositionPackage that in turn references the MaterialPackage. -->
                                    <xsl:choose>
                <xsl:when test = "CompositionPackage[Operation='RepeatTransfer']">
                <Source><xsl:value-of select="../../../../*[self::CompositionPackage or self::MaterialPackage]
                                                            [PackageID=current()
                                                            /SourcePackageID]/PackageName"/></Source>
                </xsl:when>
                <xsl:otherwise>
                <Source><xsl:value-of select="../../../../*[self::CompositionPackage or self::MaterialPackage]
                                                            [PackageID=current()
                                                            /SourcePackageID]/PackageName"/></Source>
                </xsl:otherwise>
                </xsl:choose>
            </Book>
        </xsl:when>

    </xsl:choose>
    </xsl:for-each>

</Preface>
</AAG>

</xsl:template> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T09:34:14.507

解决此问题的一种方法是使用**xsl:key**通过 PackageID查找**CompositionPackage**和**MaterialPackage元素**

```
<xsl:key name="CompositionPackage" match="CompositionPackage" use="PackageID"/>
<xsl:key name="MaterialPackage" match="MaterialPackage" use="PackageID"/> 
```

然后，假设您位于“顶级” **Source**元素上，您将首先为包选择相关的**CompositionPackage**

```
<xsl:apply-templates select="key('CompositionPackage', SourcePackageID)" mode="Source" /> 
```

注意**模式**的使用。这将是必需的，因为在生成的 xslt 中，将有多个模板匹配**CompositionPackage**元素。不过，在它的第一个模板中，您将从输出**Book**元素开始

```
<xsl:template match="CompositionPackage" mode="Source">
   <Book>
      <Name><xsl:value-of select="PackageName" /></Name>
      <Source><xsl:apply-templates select="." /></Source>
   </Book>
</xsl:template> 
```

对于***Source**元素，您将开始潜在的递归查找。您将有另一个模板来匹配**CompositionPackage**元素，但在这个模板中，您将检查包是否在另一个**CompositionPackage**或**MaterialPackage**中。这将利用密钥

```
<xsl:template match="CompositionPackage">
  <xsl:apply-templates select="
    key('MaterialPackage',PackageTracks/TimelineTrack/TrackSegment/SourcePackageID)
    |key('CompositionPackage', PackageTracks/TimelineTrack/TrackSegment/SourcePackageID)"/>
</xsl:template> 
```

如果它是**CompositionPackage**，则模板将递归匹配自身。但是，对于**MaterialPackage**，您只需输出包名称。

这是完整的 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>
   <xsl:key name="CompositionPackage" match="CompositionPackage" use="PackageID"/>
   <xsl:key name="MaterialPackage" match="MaterialPackage" use="PackageID"/>

   <xsl:template match="/AAG">
      <AAG>
         <Preface>
            <xsl:apply-templates select="Preface/ContentStorage/CompositionPackage[Usage='TopLevel']/PackageTracks/TimelineTrack/TrackSegment/Sequence/Source"/>
         </Preface>
      </AAG>
   </xsl:template>

   <xsl:template match="Source">
      <xsl:apply-templates select="key('CompositionPackage', SourcePackageID)" mode="Source" />
   </xsl:template>

   <xsl:template match="CompositionPackage" mode="Source">
      <Book>
         <Name><xsl:value-of select="PackageName" /></Name>
         <Source>
            <xsl:apply-templates select="." />
         </Source>
      </Book>
   </xsl:template>

   <xsl:template match="CompositionPackage">
      <xsl:apply-templates select="key('MaterialPackage', PackageTracks/TimelineTrack/TrackSegment/SourcePackageID)|key('CompositionPackage', PackageTracks/TimelineTrack/TrackSegment/SourcePackageID)"/>
   </xsl:template>

   <xsl:template match="MaterialPackage">
      <xsl:value-of select="PackageName" />
   </xsl:template>   

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

当应用于您的 XSLT 时，将输出以下内容

```
<AAG>
   <Preface>
      <Book>
         <Name>NameABC</Name>
         <Source>Tape011</Source>
      </Book>
      <Book>
         <Name>NameBCD</Name>
         <Source>Tape012</Source>
      </Book>
      <Book>
         <Name>NameDEF</Name>
         <Source>Tape013</Source>
      </Book>
   </Preface>
</AAG> 
```

# weather - 在哪里可以获得世界各地的气候数据库？

> ID：12118506
> 
> 赞同：0
> 
> 时间：2012-08-25T01:46:36.853
> 
> 标签：weather

我想展示一些世界各地特定地点的气候图表和历史天气数据。

我当前的数据库有城市名称、国家、经度、纬度，可以在气候数据库中查询。有很多天气 api，但我搜索静态气候信息，在互联网上找不到任何东西。数据库不必更新，我不认为气候变化太快。

XML、json 甚至 api 都可以。希望任何人都可以帮助我。

每月最高/最低温度的格式，也许平均降雨量和日照时间会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T02:06:05.313

NOAA 保存全球气候数据，您是否看过：

```
http://www.ncdc.noaa.gov/oa/ncdc.html 
```

似乎有一个API：

```
http://www.ncdc.noaa.gov/cdo-web/webservices 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-04T18:08:20.350

对于非常详细的加拿大气候数据，我只能通过“基于 URL 的程序从气候网站自动批量下载数据”获得运气。

然后您必须首先找到您感兴趣的“电台”，这里是电台列表。 [https://drive.google.com/uc?authuser=0&id=1egfzGgzUb0RFu_EE5AYFZtsyXPfZ11y2&export=download](https://drive.google.com/uc?authuser=0&id=1egfzGgzUb0RFu_EE5AYFZtsyXPfZ11y2&export=download)

您可以请求数据：格式： [https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&stationID={STATION}&Year={YEAR}&Month={MONTH}&Day={ DAY}&timeframe=1](https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&stationID=%7BSTATION%7D&Year=%7BYEAR%7D&Month=%7BMONTH%7D&Day=%7BDAY%7D&timeframe=1)

这是一个示例： [https ://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&stationID=10183&Year=2018&Month=3&Day=31&timeframe=1](https://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&stationID=10183&Year=2018&Month=3&Day=31&timeframe=1)

您可以在此处找到有关列的信息：
[https ://climate.weather.gc.ca/glossary_e.html#weather](https://climate.weather.gc.ca/glossary_e.html#weather)

以及这里的一些一般数据信息：
[https ://climate.weather.gc.ca/about_the_data_index_e.html](https://climate.weather.gc.ca/about_the_data_index_e.html) [https://drive.google.com/drive/folders/1WJCDEU34c60IfOnG4rv5EPZ4IhhW9vZH](https://drive.google.com/drive/folders/1WJCDEU34c60IfOnG4rv5EPZ4IhhW9vZH)

# animation - Maxscript Animated“烟花”脚本动画卡住

> ID：12118510
> 
> 赞同：0
> 
> 时间：2012-08-25T01:47:45.993
> 
> 标签：animation, maxscript

我创建了以下脚本来按照我的导师的指示生成“烟花”（松散使用的术语）。它基于我必须使用的骨架脚本。

有微调器来控制某些参数，但是对于我的生活，我无法弄清楚出了什么问题！请帮我！！！

任务是通过脚本制作动画，这是一个向上的球体，面部“爆炸”并通过时间尺度向下改变方向。

（烟花升起，爆炸，碎片落到地上）

我相信我写的是正确的，但是实际上没有生成动画。尽管我尽了最大的努力和数月的辛勤工作。

我是编码新手，没有注册任何编码。我想做的就是学习如何建模。然而，我的导师掌握着我通行证的钥匙。

目前，我已经准备好“愤怒退出”，并且只是要离开我的矿井。任何帮助将不胜感激。

这是我到目前为止写的脚本...

```
-- Empty varables to be called in or adjusted by spinners

numOfSpheres = 0 --number of exploding spheres
sphereRadius = 0
creationBoxSize = 0 -- spawn radius in what box size?
objs = #() -- objs created go to empty array! 
maxHeight = 0
startTime = 0

dropping = false --boolean flag to trigger the falling sphere stage

animate on
(
    for i = 1 to numOfSpheres by 1 do
    (
        at time (startTime + 50.000) ( meshop.bevelFaces objs[i]  #{1..objs[i].numFaces} 0.0000001 0 )
        at time (startTime + 50.001) ( meshop.bevelFaces objs[i]  #{1..objs[i].numFaces} 0.0000001 0 )
        at time (startTime + 100)    ( meshop.bevelFaces objs[i]  #{1..objs[i].numFaces} 100 0 )

        at time (startTime) ( objs[i].pos = objs[i].pos )

        local height = maxHeight

        for t = 5 to 100 by 5 do
        (
            height = height - 2
            at time (startTime + t) ( objs[i].pos = objs[i].pos + [ 0, 0, height] )
        )
    )
)

rollout FireWorks "FireWorks" 
( -- button ui code starts here
    label lbl1 "By Luke Fahy" style_sunkenedge:true width:67 height:17
    spinner count "FireWorks: " type:#integer range:[1,100,10]  -- 1 to a 100: default value of 10: integer = whole number not fraction!
    spinner size "Size: " type:#float range:[0.1,30,1] 
    spinner sPlane "Spawn Plane: " type:#integer range:[1,200,30]
    spinner maxHeightSpinner "Max Height: " type:#float range:[1,100,14]
    spinner startTimeSpinner "Start Time: " type:#float range:[1,100,1]
    button create "Create Fireworks"

    on create pressed do -- Event handler code start
    (
        numOfSpheres = count.value
        sphereRadius = size.value 
        creationBoxSize = sPlane.value 
        maxHeight = maxHeightSpinner.value 
        startTime = startTimeSpinner.value

        dropping = false

        --create spheres
        for i = 1 to numOfSpheres by 1 do
        (
            objs[i] = sphere radius:sphereRadius
            local r = random 0 255
            local g = random 0 255
            local b = random 0 255
            objs[i] .wirecolor = (color r g b)
            objs[i] .pos = [random creationBoxSize -creationBoxSize, random creationBoxSize -creationBoxSize, 0]   -- random possative and negative x/y values to create spawn box. 

            convertToMesh objs[i]
            meshOp.explodeAllFaces objs[i] 0
        )
    )
) -- button ui code end 

createDialog FireWorks width:200 
```

此外，对我的评论和缩进的任何建议将不胜感激。（格式似乎在剪切和过去时被扔出窗外，我很抱歉我是这个论坛的新手。文件作为附件）

亲切的问候， ShineSmith :)

附加信息：

此外，这是我的导师给我的脚本，用于我的工作。

*（此处需要对象数组，或单个对象的名称。其他人使用单个球体的 $name 及其实例来复制多个“烟花”）*

```
convertToMesh $

meshop.explodeAllFaces $ 0

update $

v = 20

animate on
(
    at time (sliderTime+50.000) ( meshop.bevelFaces $ #{1..$.numFaces} 0.0000001 0 )
    at time (sliderTime+50.001) ( meshop.bevelFaces $ #{1..$.numFaces} 0.0000001 0 )
    at time (sliderTime+100)    ( meshop.bevelFaces $ #{1..$.numFaces} 100 0 )

    at time (sliderTime) ( $.pos = $.pos )
    for t = 5 to 100 by 5 do
    (
        v = v - 2
        at time (sliderTime+t) ( $.pos = $.pos + [0,0,v] )
    )
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T09:25:44.670

`Rollout`在创建任何球体之前，甚至在创建球体之前，您都在运行动画代码。在处理程序中移动`animate on (...)`块`on create`，或使其成为单独的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-08T07:33:19.160

将 antimation 代码移动到一个函数中：

```
fn doanimate =
(
    animate on
    (
        for i = 1 to numOfSpheres by 1 do
        (
            at time (startTime + 50.000) ( meshop.bevelFaces objs[i]  #{1..objs[i].numFaces} 0.0000001 0 )
            at time (startTime + 50.001) ( meshop.bevelFaces objs[i]  #{1..objs[i].numFaces} 0.0000001 0 )
            at time (startTime + 100)    ( meshop.bevelFaces objs[i]  #{1..objs[i].numFaces} 100 0 )

            at time (startTime) ( objs[i].pos = objs[i].pos )

            local height = maxHeight

            for t = 5 to 100 by 5 do
            (
                height = height - 2
                at time (startTime + t) ( objs[i].pos = objs[i].pos + [ 0, 0, height] )
            )
        )
    )
) 
```

在按下按钮的最后调用函数：

```
 on create pressed do -- Event handler code start
    (
        numOfSpheres = count.value
        sphereRadius = size.value 
        creationBoxSize = sPlane.value 
        maxHeight = maxHeightSpinner.value 
        startTime = startTimeSpinner.value

        dropping = false

        --create spheres
        for i = 1 to numOfSpheres by 1 do
        (
            objs[i] = sphere radius:sphereRadius
            local r = random 0 255
            local g = random 0 255
            local b = random 0 255
            objs[i] .wirecolor = (color r g b)
            objs[i] .pos = [random creationBoxSize -creationBoxSize, random creationBoxSize -creationBoxSize, 0]   -- random possative and negative x/y values to create spawn box. 

            convertToMesh objs[i]
            meshOp.explodeAllFaces objs[i] 0
        )
        doanimate()
    ) 
```

完整的脚本现在看起来像这样：

```
-- Empty varables to be called in or adjusted by spinners

numOfSpheres = 0 --number of exploding spheres
sphereRadius = 0
creationBoxSize = 0 -- spawn radius in what box size?
objs = #() -- objs created go to empty array! 
maxHeight = 0
startTime = 0

dropping = false --boolean flag to trigger the falling sphere stage
fn doanimate =
(
    animate on
    (
        for i = 1 to numOfSpheres by 1 do
        (
            at time (startTime + 50.000) ( meshop.bevelFaces objs[i]  #{1..objs[i].numFaces} 0.0000001 0 )
            at time (startTime + 50.001) ( meshop.bevelFaces objs[i]  #{1..objs[i].numFaces} 0.0000001 0 )
            at time (startTime + 100)    ( meshop.bevelFaces objs[i]  #{1..objs[i].numFaces} 100 0 )

            at time (startTime) ( objs[i].pos = objs[i].pos )

            local height = maxHeight

            for t = 5 to 100 by 5 do
            (
                height = height - 2
                at time (startTime + t) ( objs[i].pos = objs[i].pos + [ 0, 0, height] )
            )
        )
    )
)
rollout FireWorks "FireWorks" 
( -- button ui code starts here
    label lbl1 "By Luke Fahy" style_sunkenedge:true width:67 height:17
    spinner count "FireWorks: " type:#integer range:[1,100,10]  -- 1 to a 100: default value of 10: integer = whole number not fraction!
    spinner size "Size: " type:#float range:[0.1,30,1] 
    spinner sPlane "Spawn Plane: " type:#integer range:[1,200,30]
    spinner maxHeightSpinner "Max Height: " type:#float range:[1,100,14]
    spinner startTimeSpinner "Start Time: " type:#float range:[1,100,1]
    button create "Create Fireworks"

    on create pressed do -- Event handler code start
    (
        numOfSpheres = count.value
        sphereRadius = size.value 
        creationBoxSize = sPlane.value 
        maxHeight = maxHeightSpinner.value 
        startTime = startTimeSpinner.value

        dropping = false

        --create spheres
        for i = 1 to numOfSpheres by 1 do
        (
            objs[i] = sphere radius:sphereRadius
            local r = random 0 255
            local g = random 0 255
            local b = random 0 255
            objs[i] .wirecolor = (color r g b)
            objs[i] .pos = [random creationBoxSize -creationBoxSize, random creationBoxSize -creationBoxSize, 0]   -- random possative and negative x/y values to create spawn box. 

            convertToMesh objs[i]
            meshOp.explodeAllFaces objs[i] 0
        )
        doanimate()
    )
) -- button ui code end 

createDialog FireWorks width:200 
```

# arrays - object[] 数组如何存储在内存中？

> ID：12118511
> 
> 赞同：3
> 
> 时间：2012-08-25T01:47:52.677
> 
> 标签：arrays, memory-management, random-access

据我了解，数组的元素连续存储在内存中，访问特定的元素是通过将所需索引和每个元素的大小与基数组地址的乘积相加来找到元素的地址.

因为在像 C# 这样的语言中，我可以创建一个`object[]`s 数组并在其中放入我想要的任何数据类型，如果我使用不同大小的类型同时仍然允许随机，那么数组的每个元素如何以统一的长度存储（并保持）使用权？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T01:50:14.027

这取决于所讨论的语言以及“对象”的含义-

正如您提到的 C#，在 C# (.NET) 中， an`object[]`包含对单个对象实例的引用数组。该数组是一个引用数组——对象实例仍然需要分配给数组的一个元素。*引用*具有统一的大小，但对象实例本身是单独存储的，并且不必具有相同的大小。

在大多数语言中，当存储“引用”或“指针”数组时，这是相同的，而不是对象实例本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T01:49:17.247

对象是引用类型。地址处的值实际上是指向真正元素的指针。

# ruby-on-rails - 用于 nil:nilClass 的 Mongoid 未定义方法 []

> ID：12118517
> 
> 赞同：2
> 
> 时间：2012-08-25T01:49:08.227
> 
> 标签：ruby-on-rails, mongodb, mongoid

我有一个查询 API 的应用程序，然后尝试将该查询存储在 Mongo 文档中。从文档中看起来很简单，但我似乎错过了一步，但我不知道出了什么问题。你们中的一个人能指出我正确的方向吗？谢谢！

我有一行从数据库中选择一些记录，然后运行一个循环查询 API。`undefined method`当程序到达该行时，我遇到了 nil:NilClass` 的错误[]'

`EntityMetadata.where(id: c['id'].to_s).add_to_set(:mood, result["mood"])`

控制台还输出这个：`MOPED: 127.0.0.1:27017 COMMAND database=admin command={:ismaster=>1}`，我不知道它是如何到达那里的。

如果您有兴趣，这是完整的代码

```
puts "Getting sentiment for all entities from Viralheat..."
api_key = '___________------_____-----'
puts "a"
base_uri 'viralheat.com/api/sentiment'

content_sql = 'SELECT content,id FROM entities'   
puts content_sql

content = ActiveRecord::Base.connection.select_all(content_sql , "Entity Content")
query = {:api_key => api_key}
asdf = {}
content.each do |c| 
   puts c["content"]
   puts "Getting Sentiment for " + c["content"].to_s 
   query[:text] = c["content"]
   result = self.get('/review.json', :query => query)
   puts "asdf"
   EntityMetadata.where(id: c['id'].to_s).add_to_set(:mood, result["mood"])
   puts "ss"
   EntityMetadata.where(id: c['id'].to_s).add_to_set(:prob, result["prob"])
   #update_mood_sql = "UPDATE entities SET mood = '#{result["mood"]}' WHERE id ='" + c["id"].to_s + "'"
   #update_prob_sql = "UPDATE entities SET probability = '#{result["prob"]}' WHERE id ='" + c["id"].to_s + "'"
   #ActiveRecord::Base.connection.update_sql(update_mood_sql, "Updating mood")
   #ActiveRecord::Base.connection.update_sql(update_prob_sql, "Updating prob")  
end 
```

这是模型代码：

```
class EntityMetadata
  include Mongoid::Document
  field :_id, type: Integer
  field :fingerprint, type: String
  index({ fingerprint: 1 }, { sparse: true })

  # TODO: change this to use the entity_id as the :_id field, to save space
  # field :entity_id, type: Integer
  # index({ entity_id: 1 }, { unique: true })

  def entity
    @entity ||= Entity.find_by_id(self._id)
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T09:45:52.673

纯粹从错误消息来看，我会说这个问题与 Mongoid 无关，而是与`c`or无关`result`：

```
EntityMetadata.where(id: c['id'].to_s).add_to_set(:mood, result["mood"]) 
```

如果这两个中的任何一个未设置 ( `nil`)，则该语句将失败，并且您永远不会真正到达 Mongoid。

尝试使用 pry (pry-rails) 并在上面的行中插入 a`binding.pry`来检查这两个变量，看看它们是否都不是 nil。

# ruby - 如何允许将多个参数传递给define_singleton_method

> ID：12118520
> 
> 赞同：4
> 
> 时间：2012-08-25T01:49:33.250
> 
> 标签：ruby, metaprogramming, block

我想创建一个可以动态添加方法并允许多个参数的类。

例如：

```
r = Robot.new
r.learn_maneuvering('turn') { |degree| puts "turning #{degree} degrees" }
r.turn 50 # => turning 50 degrees
r.turn 50, 60 # => turning 50 degrees # => turning 60 degrees 
```

我的第一次尝试是这样的：

```
def learn_maneuvering(name, &block)
    define_singleton_method(name, &block) 
end 
```

但是，它只占一个参数..

然后我开始：

```
def learn_maneuvering(name, &block)
    define_singleton_method(name) do |*args|
        # to do
    end
end 
```

我相信这会循环，直到所有参数都被使用对吗？Anywho，我不确定如何将这些参数传递给给定的块。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-25T02:27:23.483

你很接近：

```
def learn_maneuvering(name, &block)
  define_singleton_method(name) do |*args|
    args.each do |arg|
      block.call(arg)
    end
  end
end

r = Robot.new
r.learn_maneuvering('turn') { |degree| puts "turning #{degree} degrees" }

r.turn 50, 60 
```

印刷：

> 转50度
> 转60度

但这真的是你想要的吗？好像只是在做

```
r.turn 50
r.turn 60 
```

对我来说更有意义。

# java - java - jcomponents如何绘制？

> ID：12118521
> 
> 赞同：2
> 
> 时间：2012-08-25T01:49:39.020
> 
> 标签：java, swing, repaint, jcomponent

我想知道一个 jcomponent 是如何在屏幕上绘制的，它是在 Graphics 的 paintComponent() 中绘制的吗？还是单独画的。我问这个是因为它奇怪的是 jbutton 如何在鼠标悬停时改变颜色，即使 repaint() 从未被调用。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T02:03:22.240

`Component`s是用他们的[`paint`](http://docs.oracle.com/javase/7/docs/api/java/awt/Component.html#paint%28java.awt.Graphics%29)方法画的。`repaint`只是一个有用的方法，它将`paint`在不久的将来在[Event Dispatch Thread](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)上调用。

* * *

当鼠标进入 a`JButton`时，会调用以下方法（对于`JButton`带有默认 UI 的 s）：

```
public void mouseEntered(MouseEvent e) {
    AbstractButton b = (AbstractButton) e.getSource();
    ButtonModel model = b.getModel();
    if (b.isRolloverEnabled() && !SwingUtilities.isLeftMouseButton(e)) {
        model.setRollover(true);
    }
    if (model.isPressed())
            model.setArmed(true);
} 
```

[`ButtonModel.setRollover`](http://docs.oracle.com/javase/7/docs/api/javax/swing/ButtonModel.html)将触发 a `ChangeEvent`，其处理`AbstractButton`方式如下：

```
public void stateChanged(ChangeEvent e) {
    Object source = e.getSource();

    updateMnemonicProperties();
    if (isEnabled() != model.isEnabled()) {
        setEnabled(model.isEnabled());
    }
    fireStateChanged();
    repaint();
} 
```

当鼠标进入 a 时`repaint` *调用*so `JButton`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-25T02:03:36.070

> ..a jbutton 在鼠标悬停时改变颜色，即使 repaint() 从未被调用。

是的。这段代码就是证明。当然，没有证据表明 Kindle Fire 很可能没有 JRE，但是，Kindle Fire 是一个完全不合适的工具，用于与问答网站进行交流，同时讨论不运行的编程语言的技术点在设备上。

```
import javax.swing.*;

public class ButtonRepaint {

    public static void main(String[] args) {
        Runnable r = new Runnable() {
            @Override 
            public void run() {
                JButton b = new JButton("Hover Over Me!") {
                    @Override
                    public void repaint() {
                        super.repaint();
                        System.out.println("Repaint");
                    }
                };
                JOptionPane.showMessageDialog(null, b);
            }
        };
        SwingUtilities.invokeLater(r);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-25T02:05:44.783

请注意，`paint()`被调用的方法属于按钮的 UI 委托，通常派生自[`BasicButtonUI`](http://docs.oracle.com/javase/7/docs/api/javax/swing/plaf/basic/BasicButtonUI.html). [这里](https://stackoverflow.com/a/5755124/230513)有一个使用`MetalButtonUI`.

# python - 套接字服务器中的换行符？

> ID：12118530
> 
> 赞同：0
> 
> 时间：2012-08-25T01:52:01.333
> 
> 标签：python, sockets, line-breaks

谁能告诉我如何摆脱其中的换行符？每次回显字符串时，都会有一个换行符。基本上是一个空字符。我怎样才能摆脱它？

```
from socket import *
import threading
import thread

def handler(clientsock,addr):
    while 1:
        data = clientsock.recv(BUFSIZ)
        if not data:
            break
        msg = data
        print msg
        clientsock.send(msg)
    clientsock.close()

if __name__=='__main__':
    host = 'localhost'
    port = 20000
    BUFSIZ = 1024
    ADDR = (host, port)
    serversock = socket(AF_INET, SOCK_STREAM)
    serversock.bind(ADDR)
    serversock.listen(2)

print 'Version 0.1','-',host,':',port

while 1:
    clientsock, addr = serversock.accept()
    print 'initiated',addr[0],'on',addr[1]
    thread.start_new_thread(handler, (clientsock, addr)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T01:57:04.727

代替

```
print msg 
```

和

```
sys.stdout.write(msg) 
```

显然`import sys`在顶部。出现换行符的原因是为了便于使用`print`，它会自动添加到每次打印中。`sys.stdout.write`不这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T02:22:39.610

@nightcracker 已经回答了这个问题，我只想在这里留下另一个可能的解决方案。可以在语句后添加逗号`print`以禁止在字符串后添加换行符。

```
print msg, # <- notice the comma 
```

从[语言参考](http://docs.python.org/reference/simple_stmts.html#print)：

> 一个`'\n'`字符写在末尾，除非`print`语句以逗号结尾。如果语句仅包含关键字，则这是唯一的操作`print`。

# php - 解码加密的 PHP 文件帮助

> ID：12118531
> 
> 赞同：0
> 
> 时间：2012-08-25T01:52:12.123
> 
> 标签：php, decode, encryption

我有一个要解码的文件，但我不确定最好的方法。我已经尝试通过一些在线工具将其放入，但运气不佳……代码如下所示：

```
<?php

$zAkSoSavjFOn='jumbledcodeinhere';

$THkNltHSOjsXfQLzr=';))))aBSwinFbFxNm$(ireegf(rqbprq_46rfno(rgnysavmt(ynir';

$DzbOntpeGhMcan=strrev($THkNltHSOjsXfQLzr);

$WnJYuMUwKmRxBh=str_rot13($DzbOntpeGhMcan);

eval($WnJYuMUwKmRxBh);

?> 
```

在我所有的演奏中，我设法用一个 php 脚本提取了以下内容：

`eval(gzinflate(base64_decode(strrev($zAkSoSavjFOn))));`

有人可以指出我在这个过程中的正确方向吗？任何帮助，将不胜感激。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T01:55:38.330

“混乱的代码”是 gzip 压缩、base64 编码的反向 PHP 代码，几乎可以肯定是恶意的。

替换`eval`并`echo`查看它为您提供的内容，这就是尝试运行的代码。

# css - 是否可以让阴影成为渐变？

> ID：12118536
> 
> 赞同：6
> 
> 时间：2012-08-25T01:53:24.513
> 
> 标签：css

我试图弄清楚这是否可以通过 css 实现。我想要一个有阴影的正方形。在正方形的底部，投影完全可见。在正方形的顶部，应该没有明显的阴影。这将是一个渐变，因此在顶部和底部之间，阴影将是一半可见。

关于如何实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-25T11:11:37.817

可以*模拟*在绝对定位的伪元素上使用渐变`z-index`，使其出现在其父元素下方。

HTML：

```
<div class='e'></div> 
```

CSS：

```
.e {
    position: relative;
    width: 10em;
    height: 10em;
    margin: 1em;
    background: lemonchiffon;
}
.e:before {
    position: absolute;
    z-index: -1;
    top: 10%; left: 10%;
    width: 100%;
    height: 100%;
    background: linear-gradient(transparent, navy);
    content: '';
} 
```

如果你想让阴影有一个褪色的边缘，那么你必须给伪元素一个嵌入的阴影（与`.e`父元素的背景颜色相同）。

```
box-shadow: inset 0 0 .5em .5em white; 
```

请注意，这在 IE9 和更早版本中不起作用。您可以`filter`对这些使用渐变，但*不能在 pseudo-elements 上*使用，因此在这种情况下您必须做的是向元素添加一个子元素（仅适用于 IE）并设置它的样式，就像您设置伪元素的样式一样。

* * *

**编辑**：如果你想让它在图像、渐变背景上工作，那么恐怕它有点棘手，并且不能只在 IE9 和更早版本中使用 CSS 来完成。但是，在其他浏览器的当前版本中，这可以使用线性渐变和三个径向渐变来实现。

相关CSS：

```
.e {
    width: 25em; /* give it whatever width and height you like */
    height: 25em;
    /* make padding on right and bottom larger by adding the amount taken by
     * the "shadow"
     */
    padding: 5% 10% 10% 5%;
    box-sizing: border-box;
    /* change navy to red in each of these at one time to see what each
     * gradient covers
     */
    background:radial-gradient(at top right, navy, transparent 70.71%) 0 100%,
        radial-gradient(at top left, navy, transparent 70.71%) 100% 100%,
        radial-gradient(at bottom left, navy, transparent 70.71%) 100% 0,
        linear-gradient(navy, transparent) 50% 100%;
    background-repeat: no-repeat;
    background-size: 95% 95%, 5%, 5%, 5% 95%, 90% 5%;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-05-28T17:29:54.627

我只需要为我的一个开发人员模拟这个......也许对某人有用：

**代码笔**
[http://codepen.io/anon/pen/aOpOMV](http://codepen.io/anon/pen/aOpOMV)

**HTML**

```
<div class="element">
  <div class="inner">
    lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah lorem ipsum blahblah 
  </div>
</div> 
```

**CSS**

```
.element {
  width:500px; min-height:500px; box-shadow:0 0 8px 0 rgba(0,0,0,.4); margin:0 auto; position:relative;
}
.element:before {
  position:absolute; bottom:0; width:100%; height:80%; content:''; background: linear-gradient(transparent 0%,#fff 100%);transform:scale(1.2);
}
.inner {
  position:relative; z-index:2; padding:20px;
} 
```

**注意：**不需要宽度/高度..只是为了模拟

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T02:20:30.770

CSS3 的`box-shadow`属性只接受一个`<color>`值，没有什么比图像或 CSS 渐变更复杂的了，但我可以想出一些方法来破解它。

首先是让父元素具有渐变背景，然后应用内阴影（假设您可以使用纯色，内阴影与页面背景颜色相同）。然后你把你的实际盒子放在里面。

另一种方法是使用 CSS3 图像边框（使用`stretch`而不是平铺）。您可以将阴影概括为 CSS 图像边框的特定情况，因此只需在 Photoshop 中创建自己的渐变图像并将其设置为边框。

最后，唯一的其他选项是 CSS2 样式的包装元素和预定义图像。我认为这不再是必要的了，因为现在没有人关心 IE6 和 7。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T06:08:49.630

如果我理解正确，你想要这样的东西：

`box-shadow: black 0 -60px 50px -50px inset`

最终值 (-50px) 将阴影在所有边向后剪掉 50px。然后第二个值（-60px）在垂直方向上沿底部取消它，并在底部阴影上增加 10px。第三个值是散布，这是我决定在第四个值中剪裁多少阴影的方式。

但是你会很难使用盒子阴影来做到这一点。除非您知道元素的高度，否则您绝对不能覆盖一半的盒子。最好只使用带有 CSS3 渐变的 background-image 属性。查看此链接了解详情：[http ://www.impressivewebs.com/css3-linear-gradient-syntax/](http://www.impressivewebs.com/css3-linear-gradient-syntax/)

**编辑**哦，我想明白你的意思。你实际上想要一个阴影，而不是一个嵌入的阴影，但你希望它看起来像一个渐变。大卫的回答更适用。我无法添加评论，但您可以使用 :before 和/或 :after 伪元素作为他的第一个选项。

# java - Java 新手 - 对于初学者程序员来说，这是一个很好的资源

> ID：12118540
> 
> 赞同：0
> 
> 时间：2012-08-25T01:54:53.570
> 
> 标签：java

我是一名今年秋天要去大学学习计算机科学的学生，我想在 Java 编程方面取得成功。网络上最有用和最容易理解的编程教程是什么？我去过一些网站，但他们都跳过了对某些关键概念的解释（比如什么是包或导入！）

任何帮助将不胜感激 ：）

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T01:59:16.223

我会推荐在[这里](http://docs.oracle.com/javase/tutorial/)找到的 oracle 教程。他们几乎从最基本的开始引导你。他们并没有真正教你如何编程，而是教你语言可以做什么。

在那里，“[学习 Java 语言](http://docs.oracle.com/javase/tutorial/java/index.html)”是一个很好的起点。在进入 Java 之前，它提供了更多关于一般编程的概述，并涵盖了大部分基础知识。

就我个人而言，我发现您通常会得到您所支付的费用，而且免费的在线教程（oracle 教程除外）通常不是非常好。我会投资一本好书（或几本），因为它们往往更有条理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T02:04:19.153

我会推荐我的博客：

[http://howtoprogramwithjava.com](http://howtoprogramwithjava.com)

这是我刚刚建立的一个新站点，用于帮助教授 Java 的基本概念，我觉得它使用起来相当简单。到目前为止，我收到了很好的反馈，并且在 lifehacker 上出现过：

[http://lifehacker.com/5933073/learn-to-code](http://lifehacker.com/5933073/learn-to-code)

希望对您有所帮助，祝您在学校好运！:)

# ruby - 在 ruby 中使用字符串访问命名参数

> ID：12118543
> 
> 赞同：0
> 
> 时间：2012-08-25T01:56:12.437
> 
> 标签：ruby

我是红宝石的新手，我不确定这个问题是否合适，但这是我的问题。

我有一个带有无限字符串参数的函数。我想知道它们是否都在http请求中。这是我的代码：

```
def http__params_exists *list
    list.each do |p|
        if params[:'#{p}'].nil?
            return false
        end
    end
    true
end 
```

举个例子：我有一个带有“lat”参数的查询。我想要执行的条件是`if params[:lat].nil?`

我尝试了一些技巧，但都失败了。谢谢。

ps：关于红宝石的另一个问题。我不确切知道符号`:method_not_allowed`（例如）是什么类型的对象。我知道我们可以调用一个函数来命名一些参数，但是这个对象已经在某个地方定义了，好像它是控制器的公共变量，但它似乎不是。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T02:02:22.753

您需要使用`"`而不是`'`这样才能解释变量。例子

```
a = 'string'

:'#{a}'
==> :"\#{a}"

:"#{a}"
==> :string

:"#{a}" == :string
==> true 
```

所以，你的代码应该是

```
...
if params[:"#{p}"].nil?
  return false
end
... 
```

[这](http://www.randomhacks.net/articles/2007/01/20/13-ways-of-looking-at-a-ruby-symbol)是一个有趣的链接，可以了解更多关于 Ruby 符号的信息。

# google-app-engine - 将 GAE 上的 AppStats 与 NDB 一起使用，我如何知道正在执行什么查询？

> ID：12118547
> 
> 赞同：3
> 
> 时间：2012-08-25T01:57:14.613
> 
> 标签：google-app-engine, appstats

我正在查看 RPC 调用，但堆栈都是 tasklet 和 ndb。这让我很难判断正在运行哪些查询。是否有我需要使用的 appstats 配置设置？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T10:16:18.963

在 appengine_config.py 中添加：（如果没有这个，您的代码调用将不会进入查询堆栈）

```
appstats_MAX_STACK = 20 
```

在 AppStats 中的请求历史记录下，单击一个请求。

在 RPC 调用跟踪中，单击 datastore_v3.RunQuery 的“+”

在堆栈跟踪中，您可以看到指向已执行代码的链接。

# php - 你能在php电子邮件中插入if语句吗

> ID：12118551
> 
> 赞同：0
> 
> 时间：2012-08-25T01:57:37.953
> 
> 标签：php, email, if-statement

```
// from the form
$name = trim(strip_tags($_POST['name']));
$email = trim(strip_tags($_POST['email']));
$message = htmlentities($_POST['message']);

// set here
$subject = "Contact form submitted!";
$to = 'your@email.com';

$body = HTML
$message
HTML;

$headers = "From: $email\r\n";
$headers .= "Content-type: text/html\r\n";

// send the email
mail($to, $subject, $body, $headers);

// redirect afterwords, if needed
header('Location: thanks.html'); 
```

问题是，天气与否，您可以在 html 电子邮件正文中插入一个 php if 语句，或者在其中添加它的最佳方式。我正在创建一个详细的清单，一旦提交，它需要通过电子邮件发送到电子邮件。但我不想通过电子邮件发送完整的库存（包括空输入），它应该只通过电子邮件发送非 0 的字段。我在想：

```
if ($armChair > 0) { echo '扶手椅：' . $_POST['armChair']; }]
```

但它似乎并没有真正起作用......有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T02:00:37.613

这是一个结构糟糕的问题。

是的，你绝对可以做到这一点，但你需要以一种理智的方式做到这一点。我们无法通过您在此处发布的内容来判断，因为您刚刚插入了定义正文的“HTML”。

```
$body = "Hi there,\r\n";
$body .= $armChair > 0 ? "Arm Chairs: ".$_POST['armCharis']."\r\n" : "";
$body.= "some more text"; 
```

如果您的意思是覆盖 $message 的一部分，是的，您也可以使用机器标签 {INVENTORY} 之类的东西来做到这一点......

```
$message = $armChair > 0 ? str_replace('{INVENTORY}', "Arm Chairs: ".$_POST['armCharis']."\r\n", $message) : ""; 
```

这当然需要在 $message var 中的某处使用字符串 {INVENTORY}

# django - 在 django-allauth 中，如何添加 OpenId 社交应用程序？

> ID：12118553
> 
> 赞同：2
> 
> 时间：2012-08-25T01:57:45.910
> 
> 标签：django, openid, django-allauth

刚开始学习 django，我想加入 allauth 应用程序。一直试图弄清楚这一点，并没有在其他问题中找到答案。每当我尝试添加其中一个社交登录时，我什至无法获得登录屏幕并且 django 抱怨：

```
get_login_url() keywords must be strings 
```

当它试图呈现提供者列表时。（我从 allauth 附带的示例中复制了 base、index 和 profile）

我已经阅读过，在使用其中一个登录名之前，我需要在管理界面中添加社交应用程序。所以在管理界面中，我想尝试一个更简单的，所以我选择了 OpenId。由于我还没有 facebook 应用程序 ID 或任何东西，所以我认为使用 OpenId，我不需要它。

我对如何使用密钥和秘密来注册社交应用程序感到困惑。我对这些东西很陌生，但我认为这更适用于 OAuth。但如果我不包括它，它会将这些字段标记为红色并要求它们。我在哪里可以找到/生成密钥/秘密？

另外，要使用 OpenId，我应该指定一个像 Google 或 Yahoo 这样的网站，还是只有一个“OpenId”网站？

我仍在使用 manage.py runserver，如果这有什么不同的话。但我认为我仍然可以让页面“渲染”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T22:05:17.133

你运行的是什么版本的 Python？如果您使用的是旧的 2.6 版本，那么您可能会遇到此处描述的问题：

[http://cuu508.wordpress.com/2011/01/27/keywords-must-be-strings/](http://cuu508.wordpress.com/2011/01/27/keywords-must-be-strings/)

请让我知道这是否能确定您的问题。如果是这样，我会检查我是否可以`allauth`与您的版本一起玩得很好......

更新：还没有时间自己测试这个，你能试试这个改变吗？：

```
--- a/allauth/socialaccount/templatetags/socialaccount.py
+++ b/allauth/socialaccount/templatetags/socialaccount.py
@@ -13,7 +13,7 @@ class ProviderLoginURLNode(template.Node):
     def render(self, context):
         provider_id = self.provider_id_var.resolve(context)
         provider = providers.registry.by_id(provider_id)
-        query = dict([(name, var.resolve(context)) for name, var
+        query = dict([(str(name), var.resolve(context)) for name, var
                       in self.params.iteritems()])
         request = context['request']
         if not query.has_key('next'): 
```

# cordova - phonegap 中 android 构建代码的警报显示

> ID：12118556
> 
> 赞同：5
> 
> 时间：2012-08-25T01:59:08.187
> 
> 标签：cordova

我在使用 android 中的电话间隙技术在模拟器中启动时收到警报。

“异常构建 coredova js 全局变量：ReferenceError：找不到变量：org for key“exec”。

实际上我不明白为什么这个 come.same 代码适用于黑莓。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T07:04:05.180

黑莓和安卓的cordova.js是不同的。将您的 coredova.js 文件替换为 android 的相应 js。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-31T07:42:26.037

谢谢@AnhSirk...

我也犯了那个愚蠢的错误......将黑莓的相同“cordova.js”文件复制到android项目中......并收到相同的警报消息 -

构建cordova JS全局变量的异常：参考：没有为键“exec”定义org</p>

通过用 Android 的“cordova.js”文件替换，问题得到解决。

谢谢， 拉贾尼·达万

# java - 捕获错误的输入异常

> ID：12118559
> 
> 赞同：4
> 
> 时间：2012-08-25T01:59:42.113
> 
> 标签：java, android, exception

我有以下两种方法

方法一

```
public String[] getSongIds(String whereClause) 
    {
        String countQuery = "SELECT  songid FROM TABLE_INDEX WHERE " + whereClause;
        Cursor cursor = db.rawQuery(countQuery, null);
        int cursorSize = cursor.getCount();

        int[] songIds = new int[cursorSize];
        int count=0;
        if (cursor != null ) {
            if (cursor.moveToFirst()){
                   do{
                       songIds[count] = cursor.getInt(cursor.getColumnIndex("songid"));
                      count++;
                   }while(cursor.moveToNext());
                }
        }
        cursor.close();
        db.close();
        return getSongTitles(songIds);
    } 
```

方法二

```
private String[] getSongTitles(int[] songIds) {

    /some algorithm
    return songTitles;

} 
```

方法 1 是从不同的包中调用的。方法 1 对 SQLite 数据库运行查询并调用第二个方法。我需要通过在方法 1 中执行 SQLite 查询来捕获通常导致的异常。最好返回 (-1) 或其他内容，以便我可以从最初调用这些方法的包中向用户显示一条消息。因此，如果存在（错误输入）SQL 异常，我希望方法 1 避免调用方法 2，而是将某些内容返回给另一个包

ps 我看到了几种捕获此异常的方法，但对他们的方法不满意。想知道解决这个问题的最佳方法是什么。干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T02:41:03.840

捕获异常，将其包装在自定义异常中，然后将其抛出：

```
public String[] getSongIds(String whereClause) throws FetchSongException {
  String countQuery = "SELECT  songid FROM TABLE_INDEX WHERE " + whereClause;
  try {
    Cursor cursor = db.rawQuery(countQuery, null);
    int cursorSize = cursor.getCount();

    int[] songIds = new int[cursorSize];
    int count=0;
    if (cursor != null) {
      if (cursor.moveToFirst()) {
        do {
          songIds[count] = cursor.getInt(cursor.getColumnIndex("songid"));
          count++;
        } while(cursor.moveToNext());
      }
      cursor.close(); // you should put this in a finally block
      db.close();
      return getSongTitles(songIds);
    }
  } catch (SQLException sqle) {
    throw new FetchSongException("Unable to fetch song ids.", sqle);
  }
} 
```

然后，无论谁调用都`getSongIds`需要捕获这个新异常：

```
try {
  String[] result = getSongsIds("something");
} catch (FetchSongException e) {
  // Display user message with e.getMessage();
} 
```

# javascript - 启用具有不同元素的复选框

> ID：12118560
> 
> 赞同：1
> 
> 时间：2012-08-25T02:00:00.510
> 
> 标签：javascript, jquery, drop-down-menu, checkbox, textbox

好的，我已经编写了一段时间的网站，这是我没有找到答案的第一个“无法克服”的问题，所以现在我转向你，专家。

在我的表单上，我有三个下拉菜单、一个文本框和一个禁用的复选框。我希望它能够工作，以便当用户从每个下拉菜单中选择一个选项并在文本框上写一些东西时，复选框就会启用。

当我一直在寻找解决方案时，我发现[了这段代码，它与我的问题非常相似。](http://jsfiddle.net/JKmkL/1/)但是，当我尝试添加另一个下拉菜单时，当我从第一个菜单中选择一个选项并完全忽略第二个菜单时，它仍然启用该按钮。对不起，我是 Jquery/JavaScript 的新手，我只是认为当两个菜单上的类名相同时它应该以这种方式工作（jQuery 类选择器：（'.dropdown'））。

我还发现[了一个与 textboxes 类似的代码](http://jsfiddle.net/WQcdq/4/)。我只是不知道如何组合这些代码，所以它会按照我想要的方式运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T02:06:26.910

**我假设下拉菜单的默认值为 value=""**

```
 $('#form_submit_button').click(function(){  

        $('.checkbox').attr('disabled',true);
        var all_selected = true;

        $('.dropdown').each(function(){

             if(!$(this).val())
             {
                  all_selected = false; 
             }
        });

        if(!$('#text_box').text())
        {
           all_selected = false;
        }

        if(all_selected)
        {      
            $('.checkbox').attr('disabled',false);
        }       
  }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T02:18:04.680

在这里看到它：http: [//jsfiddle.net/JKmkL/109/](http://jsfiddle.net/JKmkL/109/)

```
$(document).ready(function() {
    $('.required').change(function() {
        var done=true;
        $('.required').each(function(){
            if(!$(this).val()){
                $('.myCheckBox').prop('disabled',true);
                done=false;
                return false;
            }
        });
        if(done){$('.myCheckBox').prop('disabled',false);}
    });
}); 
```

`required`并为元素添加类。

**编辑：**

上面的代码假定默认`<option>`具有`value=""`. 如果没有，您可以使用[http://jsfiddle.net/JKmkL/114/](http://jsfiddle.net/JKmkL/114/)

```
$(document).ready(function() {
    $('.required').change(function() {
        var done=true;
        function quit(){
            $('.myCheckBox').prop('disabled',true);
            done=false;
            return false;
        }
        $('.required.dropdown').each(function(){
            if($(this).children(':selected').hasClass("disablenext")){
                return quit();
            }
        });
        $('.required[type=text]').each(function(){
            if(!$(this).val()){
                return quit();
            }
        });
        if(done){$('.myCheckBox').prop('disabled',false);}
    });
}); 
```

**编辑2：**

如果要在选中复选框时显示 div 并在禁用复选框时隐藏它，请使用

JavaScript：

```
$(document).ready(function() {
    $('.required').change(function() {
        var done=true;
        function quit(){
            $('.myCheckBox').prop('disabled',true).removeAttr('checked');
            done=false;
            $('#div2').addClass('hide');
            return false;
        }
        $('.required.dropdown').each(function(){
            if($(this).children(':selected').hasClass("disablenext")){
                return quit();
            }
        });
        $('.required[type=text]').each(function(){
            if(!$(this).val()){
                return quit();
            }
        });
        if(done){$('.myCheckBox').prop('disabled',false);}
    });
    $('.myCheckBox').click(function(){
        $('#div2')[(this.checked?'remove':'add')+'Class']('hide');
    });
}); 
```

CSS：

```
.hide{display:none} 
```

在这里看到它：http: [//jsfiddle.net/JKmkL/133/](http://jsfiddle.net/JKmkL/133/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T02:18:11.590

首先，说三个下拉菜单的 id 被称为`d1`,`d2`和`d3`; 文本框是`txt`；和复选框是`chk`。然后，您可以定义一个函数来确定何时必须启用复选框：

```
function shouldEnableCheckbox() {
    var nonEmptyFields = $("#d1,#d2,#d3,#txt").filter(function() {
        return this.value;    
    });
    return nonEmptyFields.length == 4;
} 
```

本质上，您选择所有 4 个元素，过滤那些非空的元素，并将生成的过滤数组与 4 进行比较。如果为真，则意味着您应该启用该复选框。

然后，将[`change`](http://api.jquery.com/change/)事件处理程序分配给所有 4 个元素，调用前面的函数，并将结果分配给`disabled`复选框的属性：

```
$("#d1,#d2,#d3,#txt").change(function() {
    $("#chk").prop("disabled", !shouldEnableCheckbox());
});​ 
```

这是有效的**[DEMO](http://jsfiddle.net/Z7RxU/)**和另一个有效的、更通用的**[DEMO](http://jsfiddle.net/wGmnY/)**，它使用类而不是 id 来标识所需的元素。

# c# - EF - 在 HTTP 请求期间创建模型时无法使用上下文

> ID：12118562
> 
> 赞同：19
> 
> 时间：2012-08-25T02:00:37.707
> 
> 标签：c#, asp.net-mvc-3, entity-framework, entity-framework-4.1

我收到“创建模型时无法使用上下文”。我的一个网页中的 Web 应用程序中的问题。此特定网页每 2-3 秒 POST 到服务器以刷新屏幕。从我的测试中，我发现如果我有 2 个或更多浏览器实例打开此页面，几分钟后我会收到来自存储库深处的“在创建模型时无法使用上下文”异常。

此代码调用“服务”来检索所需的数据。此代码在 MVC 控制器类的自定义授权属性中执行。

```
// Code in custom "Authorization" attribute on the controller
int? stationId = stationCookieValue;  // Read value from cookie
RoomStationModel roomStationModel = RoomStationService.GetRoomStation(stationId); // Error occurs inside this call 
```

这是“RoomStationModel”

```
public class RoomStationModel
{
    [Key]
    public int RoomStationId { get; set; }

    public int? RoomId { get; set; }
    [ForeignKey("RoomId")]
    public virtual RoomModel Room { get; set; }
    /* Some other data properties.... */
 }

public class RoomModel
{
    [Key]
    public int RoomId { get; set; }

    public virtual ICollection<RoomStationModel> Stations { get; set; }
} 
```

以下是上述服务调用的代码：

```
public RoomStationModel GetRoomStation(int? roomStationId)
{
    RoomStationModel roomStationModel = null;
    if (roomStationId.HasValue)
    {
        using (IRepository<RoomStationModel> roomStationRepo = new Repository<RoomStationModel>(Context))
        {
            roomStationModel = roomStationRepo.FirstOrDefault(rs => rs.RoomStationId == roomStationId.Value, false, new string[] { "Room" });
        }
    }

    return roomStationModel;
} 
```

这是存储库....发生错误的地方

```
 public class Repository<TObject> : IRepository<TObject> where TObject : class
    {
        protected MyContext Context = null;

        public Repository(IDataContext context)
        {
            Context = context as MyContext;
        }

        protected DbSet<TObject> DbSet { get { return Context.Set<TObject>(); } }

    public virtual TObject FirstOrDefault(Expression<Func<TObject, bool>> predicate, bool track = true, string[] children = null)
    {
        var objectSet = DbSet.AsQueryable();

        if (children != null)
            foreach (string child in children)
                objectSet = objectSet.Include(child);

        if (track)
            return objectSet.Where(predicate).FirstOrDefault<TObject>(predicate);

        return objectSet.Where(predicate).AsNoTracking().FirstOrDefault<TObject>(predicate);
    }
} 
```

错误截图： ![发生错误的屏幕截图](../Images/010c669c144be6b3f3a4efcd2cabe9bb.png)

**堆栈跟踪**：

```
 at System.Data.Entity.Internal.LazyInternalContext.InitializeContext()
   at System.Data.Entity.Internal.InternalContext.Initialize()
   at System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType)
   at System.Data.Entity.Internal.Linq.InternalSet`1.Initialize()
   at System.Data.Entity.Internal.Linq.InternalSet`1.Include(String path)
   at System.Data.Entity.Infrastructure.DbQuery`1.Include(String path)
   at System.Data.Entity.DbExtensions.Include[T](IQueryable`1 source, String path)
   at Vanguard.AssetManager.Data.Repository`1.FirstOrDefault(Expression`1 predicate, Boolean track, String[] children) in C:\Work\VanguardAssetManager\Main\Vanguard.AssetManager.Data\Repository.cs:line 100
   at Vanguard.AssetManager.Services.Business.RoomStationService.GetRoomStation(Nullable`1 roomStationId) in C:\Work\VanguardAssetManager\Main\Vanguard.AssetManager.Services\Business\RoomStationService.cs:line 61
   at Vanguard.AssetManager.Web.Attributes.RoomStationAuthorizeAttribute.OnAuthorization(AuthorizationContext filterContext) in C:\Work\VanguardAssetManager\Main\Vanguard.AssetManager.Web\Attributes\RoomStationAuthorizeAttribute.cs:line 52
   at System.Web.Mvc.ControllerActionInvoker.InvokeAuthorizationFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor)
   at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) 
```

EF 版本：4.1（代码优先）

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-28T19:52:17.490

您的存储库是短暂的（您为每次调用创建它，`GetRoomStation()`但您的实际上下文似乎是长期存在的（`RoomServiceStation.Context`属性）。这意味着对您的 Web 应用程序的每次调用都将使用相同的上下文。

这是“N 层中的 EF”场景，您试图在 Web 应用程序的架构无状态模型中保持某些状态（上下文）。所有这些请求都被引导到不同线程上的相同上下文，并且您正在获得竞争条件。

一个线程可能会启动上下文的首次初始化以响应请求，而另一个线程可能会尝试使用上下文。第二个请求认为上下文已准备好使用，并且您收到此异常。[如果您有多个上下文尝试按照另一个 SO 线程](https://stackoverflow.com/questions/6099781/how-can-i-prevent-ef-the-context-cannot-be-used-while-the-model-is-being-create?rq=1)中的建议同时“启动”，您甚至可能会得到这个。

你可以做几件事。您可以尝试对上下文的访问进行悲观锁定，但您会遇到不必要的瓶颈。您可以尝试创建某种“在客户呼叫我之前，初始化上下文”代码，但您必须找到一个好地方来执行此操作，也许使用[MSDN 线程中建议](http://social.msdn.microsoft.com/Forums/en-AU/adodotnetentityframework/thread/18c993be-c357-4c99-908e-f879f28c5ee0)的“蛮力”方法。

更好的做法是为后端服务的*每个*请求简单地创建一个新上下文。有一些开销，是的，但很少。开销可能比悲观锁定更不可能影响性能，并且不会受到应用程序池回收事件的影响，从而在农场等上扩展您的 Web 应用程序。

如果您依赖于更改跟踪或上下文的其他状态性质，您将失去此优势。在这种情况下，您将不得不提出一种不同的机制来跟踪和最小化数据库命中。

从[MSDN 文章](http://msdn.microsoft.com/en-us/magazine/dd882522.aspx#id0420025)中总结了这一点（强调我的）：

> 如果您将实体从一层序列化到另一层，则推荐的模式是**将上下文保留在中间层上的时间仅足够用于单个服务方法调用。**随后的调用将启动上下文的新实例以完成每个任务。

[一个关于 EF/WCF/N-tier 的帖子也可能会给您一些见解](http://social.msdn.microsoft.com/Forums/en/adodotnetentityframework/thread/46811556-f8e7-450a-9b59-c885e702abc3)，并且 Jorge 的[博客文章 #5](http://blog.jorgef.net/2010/09/n-tiers-pocos-ef-5.html)讨论了 N-Tiers 中的 EF（整个系列可能是一个很好的阅读）。顺便说一句，我遇到了完全相同的事情：许多客户同时访问上下文，导致了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-16T03:05:40.010

我遇到了这个错误，并且似乎已经通过在控制器中提供对 Dispose() 方法的覆盖来解决它。似乎在尝试打开新连接之前强制关闭数据库连接会破坏此错误。

```
protected override void Dispose(bool disposing)
{
   if(disposing)
   {
        _fooRepository.Dispose();
   }
   base.Dispose(disposing);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T06:37:00.697

这似乎是两件事之一，某种竞争条件或“上下文范围”问题。您应该确保上下文以线程安全的方式进行初始化，并且上下文没有被不同的线程访问以防止竞争条件。这个错误的一个难以捕捉的原因也是在 OnModelCreation 覆盖中访问模型本身。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-08T13:03:08.663

我今天遇到了这个问题。问题是我不小心在请求中使用了同一个 DbContext 实例。第一个请求将创建实例并开始构建模型，第二个请求将进入并尝试检索仍在构建的数据。

我的错误很愚蠢。我不小心使用了 HttpContext.Current.Cache 而不是 HttpContext.Current.Items :)

# symfony - SonataAdminBundle model_type 值过滤器形式的过滤器

> ID：12118564
> 
> 赞同：5
> 
> 时间：2012-08-25T02:01:07.020
> 
> 标签：symfony, symfony-sonata, sonata-admin

我有这样的领域

```
 /**
     * @ORM\ManyToOne(targetEntity="Town")
    **/
    protected $town; 
```

和具有这种方法的管理类

```
protected function configureDatagridFilters(DatagridMapper $datagridMapper)
    {
        $datagridMapper
        ...
        ->add('town', null, array('label' => 'Town'), null, array('expanded' => true, 'multiple' => true))
        ;
    } 
```

它给了我这样的过滤器：

![symfony2 SonataAdminBundle 带有学说实体的完整示例](../Images/f7e8f02b1a8c8df0d30e12df80216932.png) 我的问题是：我可以为**Town**实体检索设置自定义 sql\dql 吗？例如，仅选择 ID 为 IN (1, 2) 的城镇？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-25T02:08:00.233

好，我知道了。这是一个解决方案：

```
protected function configureDatagridFilters(DatagridMapper $datagridMapper)
{
    $datagridMapper
    ...
    ->add('town', null, array('label' => 'Town'), null, array(
        'expanded' => true,
        'multiple' => true,
        'query_builder' => function (\Doctrine\ORM\EntityRepository $repository) {
            return $repository->createQueryBuilder('t')
                    ->where('t.id = ?1')
                    ->setParameter(1, 1)
                    ->add('orderBy', 't.name ASC');
        }
    ))
    ...
    ;
} 
```

# intellij-idea - 初始化对象时的 Intellij 类型自动完成

> ID：12118565
> 
> 赞同：0
> 
> 时间：2012-08-25T02:01:15.913
> 
> 标签：intellij-idea

是否可以将 Intellij 设置为在新建对象时自动完成类型。例如我输入

`String name = new`

如果我按 CTRL + SHIFT + Space 它会添加类似的类型

`String name = new String();`

当我在新关键字后点击空格时，我希望它自动执行此操作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T02:17:39.740

考虑使用**Introduce Variable**重构，如[本答案](https://stackoverflow.com/a/11892034/104891)中所述。

# python - 安装 Flask - 结构

> ID：12118568
> 
> 赞同：1
> 
> 时间：2012-08-25T02:01:44.420
> 
> 标签：python, flask, virtualenv

我即将开始学习`Flask`，我已按照[http://flask.pocoo.org/docs/installation/#installation](http://flask.pocoo.org/docs/installation/#installation)上的安装说明进行操作。

我遵循了该`virtualenv`方法，而不是系统范围的安装。我只是不明白 Flask 的结构`virtualenv`以及它与 Flask 的关系。

我在一个目录中运行了所有命令。这是否意味着`virtualenv`Flask 和 Jinga2 都只在那个目录中运行？这是否意味着我每次在该项目的目录中启动一个烧瓶项目时都需要设置 virtualenv 和烧瓶？

其次，当我在目录外导航时，我的提示仍然有`venv`. 我怎么能阻止它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-25T02:29:19.493

Virtualenv 创建了一个隔离环境，您可以在其中安装 python 包，而无需在系统上全局安装它们。在你运行`venv/bin/activate`任何新安装的包之后，这个virtualenv（即myproject/venv/lib）中，如果你退出virtualenv，那么系统范围的python 将无法识别安装在virtualenv 中的包。

使用`pip`. 当您执行时，`virtualenv venv`会创建一个名为 venv 的文件夹，并且所有已安装的软件包都将复制到那里。

最后，为了退出虚拟环境，只需运行`deactivate`.

# html - 使用 Perl 从 XML 配置文件生成 HTML Web 表单，反之亦然

> ID：12118570
> 
> 赞同：0
> 
> 时间：2012-08-25T02:02:36.490
> 
> 标签：html, xml, perl, perl-module

我需要帮助解决以下问题。有一个我共同编写并目前管理的应用程序是用 C 和 Haskell 组合编写的。该应用程序可以通过单个 XML 文件进行定制和配置。它是一个没有用户界面的后端应用程序。我们被要求通过 Web 界面为该应用程序提供图形界面。每个配置选项都是 html 表单中的一个表单字段，如下所示

```
configuration1  string1
configuration2  string2
etc
etc 
```

图形前端必须是将用户输入的数据转换为包含应用程序设置的 XML 文件的 Web 表单。当用户保存表单时，更改将写入 XML 文件。当用户打开表单时，来自 XML 文件的配置会显示在 HTML 表单字段中。

我们的团队只处理后端的东西，我们对 GUI 之类的东西一无所知。我们的限制是前端必须用 Perl 编写并使用 LibXML 模块以符合公司标准。我们的团队纯粹是 C 和 Haskell，这是我们收到的第一个类似的请求。我将不胜感激您能提供的任何帮助。如果您可以包含尽可能详细的代码示例，那将是一个很大的帮助。我们对 Perl 知之甚少，但通过一个足够清晰的例子我们可以做到。通常处理这类事情的团队正在重组，我们迫不及待地需要尽快建立这个接口。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T10:35:23.523

致 OP：您没有正确描述配置格式，XML 片段会帮助我们。因为它是您可能必须修改下面的解决方案以匹配您的格式。

我假设了以下格式：

```
<conf>
  <option><name>configuration1</name><value>string1 modified</value></option>
  <option><name>configuration2</name><value>string2 re-modded</value></option>
  <option><name>configuration3</name><value>string3</value></option>
</conf> 
```

处理这种格式的代码是：

```
#!/usr/bin/perl 

use strict;
use warnings;

use CGI qw( -nosticky -utf8 :standard form );
use XML::LibXML;

my $CONF="/web/data/conf.xml"; # or wherever your XML is located

# dispatch table, action => code to process it
my $dispatch= { display => \&display_conf,
                edit    => \&display_edit_form,
                save    => \&save_edits,
              };

# action is "what to do"
my $action= param( 'action') || 'display';

$dispatch->{$action}->() || exit_error( "wrong action");
exit;

# load the XML and build a table to display it
sub display_conf
  { my $conf= XML::LibXML->load_xml( location => $CONF);
    my $content;
    foreach my $option ($conf->findnodes( '/conf/option'))
      { $content .= Tr( td( $option->findvalue( './name')), 
                        td( $option->findvalue( './value'))
                      );
      }
    $content= table( $content);
    # add a link to the edit form
    $content .= p( a({ href => url() . '?action=edit' }, 'edit')); 
    output( $content);                
  }

# load the XML and build a form that will let you edit it
sub display_edit_form
  { my $conf= XML::LibXML->load_xml( location => $CONF);
    my $content;
    foreach my $option ($conf->findnodes( '/conf/option'))
      { $content .= Tr( td( $option->findvalue( './name')), 
                        td( input( { type => "text", size => 40, 
                                     name => $option->findvalue( 'name'), 
                                     value => $option->findvalue( './value')}
                                 )
                          )
                      );
      }
    $content= table( $content);
    $content= form( { action => url() }, 
                    hidden( { name => 'action', value => 'save', override => 1 }),
                    $content,
                    submit( 'Save'),
                  );
    output( $content);                
  }

# load the XML, go through all options, update the value from the form, 
# save the XML, display it value, from the form
sub save_edits
  { my $conf= XML::LibXML->load_xml( location => $CONF);
    foreach my $option ($conf->findnodes( '/conf/option'))
      { my $new_value= param( $option->findvalue( './name'));
        my( $value_node)= $option->findnodes( './value');
        $value_node->removeChildNodes();
        $value_node->appendText( $new_value);
      }
    $conf->toFile( $CONF);
    display_conf();
  }

# placeholder, 
sub exit_error
  { my $message= shift;
    print header(), p($message);
  }

# output subs, load the template, inject the content and output (with header)   

sub output
  { my $content= shift;
    print header(), fill_in_string( template(), content => $content );
  }

sub fill_in_string
  { my( $template, %param)= @_;
    $template=~ s{<<(\w+)>>}{$param{$1}}g;
    return $template;
  }

sub template
  { return join '', <DATA>; }

# template, very simple
__DATA__
<html>
  <head>
    <title>Configuration Editor</title>
  </head>
  <body>
    <h1>Configuration Editor</h1>
    <h2>Configuration</h2>
      <<content>>
    </h2>
  </body>
</html> 
```

部署：将代码放在可以作为 CGI 运行的地方，并确保`conf.xml`可以被 Web 服务器读取和写入。将它放在网络树之外可能会更好。

这在某种程度上是史前 Perl。CGI 被广泛认为是过时的，Perl 中提供了更多现代和花哨的选项。如果您的配置比键/值列表更复杂，如果您想为每个字段提供自定义帮助，或者如果您需要使用更复杂的模板来符合您公司的外观，那么像 Dancer 或 Mojolicious 这样的 Web 框架会比上面的简单解决方案更适合。

OTOH 它可以工作，我仍然是这样编写很多小工具的，这些工具有一些内部用户并且在 UI 方面不需要太多。

对于那些建议对不熟悉 Perl 的人来说这太复杂而无法执行的人，你们走好了！这不是航天科技。正是这种让人们开始使用 Perl 的代码，我们为什么不帮助编写它呢？这实际上是[The Reluctant Perl Programmer](http://www.modernperlbooks.com/mt/2012/06/the-reluctant-perl-programmer.html)的完美例证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T12:48:21.037

不要自己这样做。您不了解 Perl 或 web-apps，您提到的有关 libxml 的限制可能只是其中之一。每一个微小的配置和输入错误都将花费您数小时或数天的时间才能弄清楚。你最终会感到痛苦和压力，用户也会如此。

您的网络团队中的某个人可以在一天内生成一个简单的表单，其中包含支持测试和文档。然后，您可以在从工作应用程序开始的知识中安全地扩展和修复错误。

如果你不能在内部找人，你可以冷聘编码员，但要尽你所能先在内部完成。不要自己这样做。

# jquery - 将 jQuery 元素添加到对象？

> ID：12118575
> 
> 赞同：1
> 
> 时间：2012-08-25T02:04:01.927
> 
> 标签：jquery, arrays, object

我想创建一个对象来存储 jQuery 对象。到目前为止，这是我的代码：

```
var tabList = $();

function addTab(){
    console.log($(this));
    var theConcept = 'conceptName';
    var $tab = $('<li />');
    $tab.append('<a>' + theConcept + '</a>').data("concept", theConcept);
    $tab.append('<span class="closeTab">Close</span>');
    console.log($tab);
    tabList.push($tab);
    console.log(tabList);
} 
```

当我记录 tabList 时，它输出：[>e.fn.ei]

我真正想做的是有一个数组或对象，我可以从中添加和删除元素，然后根据这个数组刷新 DOM。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T02:06:05.037

用于[`.add()`](http://api.jquery.com/add/)向 jQuery 对象添加元素。`tabList = tabList.add($tab);`

# iphone - 如何在选择时替换 UIViewController 中的 UITableView

> ID：12118581
> 
> 赞同：1
> 
> 时间：2012-08-25T02:04:44.273
> 
> 标签：iphone, user-interface

我在 xCode 4.3 中编码这是我的第一个应用程序。

我有一个 UIViewController，顶部是公司徽标，然后是搜索栏，然后是中间的 UITableView（带有产品名称）和底部页脚图像。现在我希望一旦在 UITableView 上单击一个项目，只有 TableView 被替换为显示产品详细信息的视图。

现在我可以用以下代码替换整个视图：

```
if (!self.prodDetailViewController_) 
{        
    self.prodDetailViewController_ = [[PCS1ProdDetailViewController alloc] initWithNibName:@"PCS1ProdDetailViewController" bundle:[NSBundle mainBundle]];
}
[self presentModalViewController:prodDetailViewController_ animated:YES]; 
```

但这只会增加我的工作量，因为我将不得不在我的所有视图中重做顶部栏和底部栏（在整个应用程序中保持相同）。有没有办法将我的主 UIViewController 的元素更改为 UITableView。

感谢你在期待。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T05:44:57.970

在您的“tableViewDidSelectRowAtIndex”方法中，在选择行时，只显示特定的自定义视图（包含所选行的详细信息），同时隐藏表格视图，这样您就可以拥有您想要的视图。并在该自定义视图上创建一个后退按钮，并在该按钮操作上，隐藏您当前的视图并再次显示 tableview。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T02:45:12.860

在视图中准备所有详细信息，然后将此视图添加到当前屏幕。就是这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T05:55:41.537

我假设您可以在这里使用 iOS 5 的功能。您可以做的是实现一个容器视图控制器 - 很像 UINavigationController，但具有您自己的视图布局，因此您可以将徽标、搜索栏等全部保留在适当的位置，并且仅在视图的一部分中的视图之间进行转换。

我创建了一个名为`ViewController`. 它有一个`containerView`在 .xib 文件中设置的 UIView 出口，以及一个顶部栏、搜索栏和底部栏（对应于您在应用程序中描述的其他视图）。它还具有属性`tableViewController`和`detailViewController`. 在其`viewDidLoad`实现中，它添加了一个`TableViewController`实例作为子视图控制器。当点击表视图时，视图控制器添加一个`DetailViewController`实例作为子视图控制器并转换到它。点击详细视图上的按钮将转换回表格视图，并将详细视图控制器作为子视图移除。

这是我的`viewDidLoad`方法：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    self.tableViewController = [[TableViewController alloc] init];
    self.tableViewController.delegate = self; // I implement a protocol TableViewControllerDelegate to know when row is tapped

    // Fix for origin being 20 by default.
    CGRect frame = self.tableViewController.view.frame;
    frame.origin.y = 0.0f;
    self.tableViewController.view.frame = frame;

    [self addChildViewController:self.tableViewController];
    [self.containerView addSubview:self.tableViewController.view];
    [self.tableViewController didMoveToParentViewController:self];
} 
```

我有一个委托方法，以便容器知道何时点击表格行，并在表格视图和详细视图之间进行转换。其实现如下：

```
- (void)tableViewController:(TableViewController *)tvc didSelectIndex:(NSInteger)index
{
    self.detailViewController = [[DetailViewController alloc] init];
    self.detailViewController.backButtonBlock = [self backButtonBlock]; // This block handles the transiton from detail back to table
    CGRect detailStartingFrame = self.detailViewController.view.frame;
    detailStartingFrame.origin.x = self.containerView.frame.size.width;
    self.detailViewController.view.frame = detailStartingFrame;

    [self addChildViewController:self.detailViewController];
    [self transitionFromViewController:self.tableViewController
                      toViewController:self.detailViewController
                              duration:0.5
                               options:0
                            animations:^{
                                CGRect newTableFrame = self.tableViewController.view.frame;
                                newTableFrame.origin.x = (-1.0f * newTableFrame.size.width);
                                self.tableViewController.view.frame = newTableFrame;

                                [self.containerView addSubview:self.detailViewController.view];
                                CGRect newDetailFrame = self.detailViewController.view.frame;
                                newDetailFrame.origin.x = 0.0f;
                                self.detailViewController.view.frame = newDetailFrame;
                            } completion:^(BOOL finished) {
                                [self.detailViewController didMoveToParentViewController:self];
                            }];
} 
```

如上所述，当点击后退按钮时，详细视图会执行一个块。我在这里创建这个块`ViewController`：

```
- (GoBackButtonBlock)backButtonBlock
{
    GoBackButtonBlock block = ^ {
        [self.detailViewController willMoveToParentViewController:nil];

        [self transitionFromViewController:self.detailViewController toViewController:self.tableViewController duration:0.5 options:0 animations:^{
            CGRect newDetailFrame = self.detailViewController.view.frame;
            newDetailFrame.origin.x = self.containerView.frame.size.width;
            self.detailViewController.view.frame = newDetailFrame;

            CGRect newTableFrame = self.tableViewController.view.frame;
            newTableFrame.origin.x = 0.0f;
            self.tableViewController.view.frame = newTableFrame;
        } completion:^(BOOL finished) {
            [self.detailViewController removeFromParentViewController];
            [self.detailViewController.view removeFromSuperview];
        }];
    };

    return [block copy];
} 
```

这就是它的全部内容。请务必阅读[UIViewController 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)的“实现容器视图控制器”部分以获取更多详细信息。希望这可以帮助！

# javascript - 为什么这个 JS var 在 AJAX 之后会失去价值？

> ID：12118583
> 
> 赞同：0
> 
> 时间：2012-08-25T02:05:04.977
> 
> 标签：javascript, jquery, ajax

考虑这个片段：

```
$('.job-details-apply').live('click', function () {
    var url = $('#apply-job-url').val();
    var id = $(this).attr('value');
    var selected = $(this);
    $.ajax({
        url: url,
        data: { id: id },
        success: function (data) {
            $(selected).html('Test!');//selected is undefined at this point
        },
        error: function () {
        }
    });
    return false;
}); 
```

在`var` `selected`成功处理程序中未定义。我是否需要将其范围限定在点击功能之外？例如

```
var selected = null;
$('.job-details-apply').live('click', function () {
    selected = $(this);
    //blah
} 
```

对我来说，这似乎有些不对劲。

编辑：如果从控制器 id a 返回的值有所不同`JsonResult`（目前它只是一个布尔值）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T02:16:57.890

您无需更改`selected`变量的声明方式。它将在您的 ajax 函数的成功处理程序中可用。

作为 jQuery ajax 成功处理程序中偶尔混淆的一点，但不是导致此问题的原因，`this`您的 ajax 成功处理程序中的值会有所不同（它将指向一个 ajax 对象），但这不会影响对变量的访问在您的父函数中声明，因为它们可以直接使用而无需使用`this`.

所以，既然你问的不是问题，如果你确实对`selected`变量有问题，那么原因一定是你在到目前为止显示的代码中没有向我们透露的其他原因。我们可能需要查看更完整的示例来说明您遇到此问题的位置，甚至是指向工作页面的链接，以便可以设置断点并检查内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T09:06:36.813

When you do

```
var selected = $(this); 
```

`selected` is now a jQuery object built from the element you clicked (`this` is the DOM object for the element you clicked; it doesn't have any jQuery methods; `selected` *does* get jQuery methods).

```
$.ajax({
    url: url,
    data: { id: id },
    success: function (data) {
        $(selected).html('Test!');//selected is undefined at this point 
```

`selected` should certainly be defined at this point, since it's an outer variable incorporated into a closure. However, `$(selected)` resolves to an attempt to pass what's already a jQuery object into a jQuery constructor, and jQuery is probably getting a little confused, since a jQuery constructor is generally expecting to see a DOM object (convert to jQuery object), an HTML string (build a corresponding DOM fragment and convert to jQuery object), a function (run it when the DOM is loaded), or an extended CSS selector (convert it into a jQuery object that represents one or more elements in the page). So the result of `$(selected)` isn't officially defined.

Obviously if this is the source of the problem, changing the code to `selected.html(...)` should at least give a different result, and should preferably work. },

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-25T02:27:54.283

是的，需要存储`this`在一个变量中。

```
$('.job-details-apply').live('click', function () {
  var url = $('#apply-job-url').val();
  var id = $(this).attr('value');
  var _this = this;
  $.ajax({
      url: url,
      data: { id: id },
      success: function (data) {
          $(_this).html('Test!');
      },
      error: function () {
      }
  });
  return false;
}); 
```

# php - MySQL 错误 #1064 - 您的 SQL 语法有错误；

> ID：12118584
> 
> 赞同：0
> 
> 时间：2012-08-25T02:05:12.460
> 
> 标签：php, mysql, mysql-error-1064

请帮忙！我真的不知道这里发生了什么。我已经阅读了很多关于此的内容，但我似乎没有发现这个查询有什么问题：

```
INSERT INTO clients (water_bill_doc_url) VALUES ('client-uploads/01/water_bill.png') WHERE `client_id` = '74' 
```

但我仍然不断收到此错误：

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'WHERE `client_id` = '74'' at line 1 
```

如果有帮助，这个`clients`表就是 InnoDB。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T02:07:54.190

`INSERT INTO table (fields) VALUES (values) WHERE condition`

等等，什么？从什么时候开始`INSERT`允许`WHERE`子句？

您要么想做一个，`UPDATE`要么把它`client_id`放在要插入的字段中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T02:08:29.510

`INSERT`语句没有子句，`WHERE`因为它用于创建*新*行。我们可以假设您想要一个`UPDATE`语句，因为您希望匹配现有行：

```
UPDATE 
  clients 
SET water_bill_doc_url = 'client-uploads/01/water_bill.png' 
WHERE `client_id` = '74' 
```

查看[MySQL`UPDATE`语法参考](http://dev.mysql.com/doc/refman/5.0/en/update.html)以获取有关语法的完整详细信息。

# ef-code-first - 如何在不使用迁移的情况下使用 LocalDB 和 EF

> ID：12118594
> 
> 赞同：7
> 
> 时间：2012-08-25T02:06:59.633
> 
> 标签：ef-code-first, asp.net-mvc-4, entity-framework-5, localdb

我正在使用 EF 5 的 VS 2012 RTM。我正在执行 Code First，但由于我刚刚处于开发阶段，因此试图忽略代码迁移。为了避免它们，我有这一套

```
Database.SetInitializer(new DropCreateDatabaseIfModelChanges<SomeContext>()); 
```

有时，即使我认为我没有接触过模型，它也会决定重新创建。没关系。但它通常会导致错误

> 无法删除数据库，因为它当前正在使用中。

所以我决定完全删除数据库。我进入 VS，进入“SQL Server 对象资源管理器”，找到数据库并将其删除。现在我被困在

> 无法将文件“{0}”附加为数据库“{1}”

我昨晚发生了这种情况，我只是摆弄直到它工作（关闭任务，重新启动VS，更改web.config中的数据库和文件名等）

所以问题1）我如何摆脱这种状态？

但更重要的问题是，我如何完全防止自己进入这种状态？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-01T04:52:16.443

**SQL Server 对象资源管理器**窗口可以保持与数据库的连接。关闭窗口和从它打开的所有窗口都会释放连接。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-04T08:43:00.843

我有同样的问题并设法解决它。主要问题是 EF 不会自动创建数据库。解决方案不是很难。

首先，转到解决方案资源管理器并手动创建数据库。为此，请转到数据库所在的文件夹（通常是`App_Data`）。右键单击此文件夹，然后单击**Add -> New Item**。选择**数据**选项卡并选择**SQL Server 数据库**。确保输入 Entity Framework 期望的名称（在`Cannot attach the file '{0}' as database '{1}'`错误消息中指定）。

然后很可能您会收到一条错误消息，指出数据库不包含任何模型元数据。为了避免这种情况，请将您的数据库初始化更改为：

```
Database.SetInitializer(new DropCreateDatabaseAlways<SomeContext>()); 
```

现在运行应用程序，数据库应该已经正确创建了表。成功执行此步骤后，将数据库初始化程序更改回：

```
Database.SetInitializer(new DropCreateDatabaseIfModelChanges<SomeContext>()); 
```

# javascript - JSON.parse 在尝试解析存储在 cookie 中的单个字符串时抛出“SyntaxError: Unexpected Number”

> ID：12118596
> 
> 赞同：2
> 
> 时间：2012-08-25T02:07:52.593
> 
> 标签：javascript, django

我将此字符串存储在 cookie 中

```
"d967fac49ef2466239168bbbde0a8d755a27ba81$[[\"__json_message\"\05425\054\"This is a message.\"]]" 
```

又名

```
"\"d967fac49ef2466239168bbbde0a8d755a27ba81$[[\\\"__json_message\\\"\\05425\\054\\\"This is a message.\\\"]]\"" 
```

（用于粘贴到控制台）

但我无法用 JSON.parse 解析它。但是，它适用于 eval （这是邪恶的）。错误是`SyntaxError: Unexpected number`。

值得注意的是转义的逗号。这是使用 Django 消息传递 API 生成的。

有谁知道一个好的正则表达式或其他可以做到这一点的技术？

我首先需要对字符串进行转义（因为它是正确的 javascript 字符串），然后我需要美元( )*之后的数组*`s.substring(s.indexOf("$")+1)`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T23:56:54.787

很抱歉不清楚，我想通了，感谢 jfriend00 对 json.org 的[链接](http://www.json.org)。下面是一个有效的等效字符串，以及正确的输出应该是什么。它是一个已编码字符串中的 JSON 数组，我需要轻松地对其进行转义。

```
var s = JSON.parse("\"d967fac49ef2466239168bbbde0a8d755a27ba81$[[\\\"__json_message\\\"\\u002C25\\u002C\\\"This is a message.\\\"]]\"")
// s = "d967fac49ef2466239168bbbde0a8d755a27ba81$[["__json_message",25,"This is a message."]]"
// and then I get what I actually want
var a = JSON.parse(s.substring(s.indexOf("$")+1)) 
```

问题是，当为 cookie 准备字符串时，逗号被转换为 JSON 不允许的八进制转义码。错误代码应该是`JSON forbids octal prefixes`. 处理好之后就好了。所以我只检查八进制转义码并用十六进制转义码替换它们。

* * *

### TL；DR：“SyntaxError：意外数字”表示“SyntaxError：JSON 禁止使用八进制前缀”

* * *

这是我使用的功能

```
var s = "\"d967fac49ef2466239168bbbde0a8d755a27ba81$[[\\\"__json_message\\\"\\05425\\054\\\"This is a message.\\\"]]\""
var re = /\\0([0-7]{2})/g
JSON.parse(s.replace(re, function(m, n){return "\\x"+("0000"+parseInt(n,8).toString(16)).slice(-4)})) 
```

# sql-server - Windows Azure - Web 角色和虚拟机安全通信

> ID：12118599
> 
> 赞同：2
> 
> 时间：2012-08-25T02:08:28.400
> 
> 标签：sql-server, azure, virtual-machine, azure-web-roles, azure-virtual-machine

我正在尝试将应用程序部署到 Windows Azure，但由于缺乏文档和 Azure 基础架构的新颖性，我在弄清楚如何实现最佳配置时遇到了一些麻烦。我需要配置两台虚拟机（一台 Linux 机器和一台带有 SQL Server 的 Windows Server）才能与一个 Web 角色实例通信。Web 角色应该具有可从外部世界访问的唯一端点。它应该能够与 SQL Server 和 Linux 机器通信（这些机器不需要相互通信）。如果我在 VM 上打开端点（例如 Windows 机器上的端口 1433 和 VM 防火墙中的相同端口），我可以实现这一点，但是我担心这样做会带来安全风险，因此我宁愿让 Web 角色直接与我的虚拟机通信，而无需打开端点（使用 Azure 门户）。我已经阅读了一些将项目部署为云服务的示例，但没有一个示例包括 Web 角色和自定义虚拟机。我已经看到有关使用虚拟网络的参考，但没有示例。我到处寻找没有成功的解决方案。这似乎是一个常见的场景，所以我认为它不应该这么困难。我错过了什么吗？我到处寻找没有成功的解决方案。这似乎是一个常见的场景，所以我认为它不应该这么困难。我错过了什么吗？我到处寻找没有成功的解决方案。这似乎是一个常见的场景，所以我认为它不应该这么困难。我错过了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T07:29:38.407

好吧，这里有 2 个选项：使用 Windows Azure Connect 或使用虚拟网络。由于您真的想建立一个由不同机器组成的网络，我建议使用虚拟网络（我认为这是最灵活的选择）。将您的虚拟机连接到您的云服务非常简单：

1.  如此处所述[创建虚拟网络：在 Windows Azure 中创建虚拟网络](http://msdn.microsoft.com/en-us/library/windowsazure/jj156091)
2.  如下所述将您的虚拟机添加到该网络：[将虚拟机添加到虚拟网络](http://www.windowsazure.com/en-us/manage/services/networking/add-a-vm-to-a-virtual-network/)
3.  修改您的云服务的 ServiceConfiguration.cscfg 以连接到您的虚拟网络。该架构[可在 MSDN](http://msdn.microsoft.com/en-us/library/windowsazure/ee758710.aspx)上找到，或者您可以关注[Michael Washam 博客上的博](http://michaelwasham.com/2012/08/06/connecting-web-or-worker-roles-to-a-simple-virtual-network-in-windows-azure/)文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T02:47:25.450

我将上面的答案标记为正确，因为它确实提供了答案，尤其是在您仅使用 MS 产品创建虚拟网络时。他们在大部分文档中没有指出的是，Linux 机器的 VN 功能受到限制，而 VM 和 VN 处于当前预览状态。但是，这并不意味着您不能将 Linux VM 添加到 VN。在搜索某个时间并将信息拼凑在一起后，可以将 Linux 机器添加到现有的 VN 中，而只需使用 PowerShell 和 cmdlet。可以使用您自己的信息从 PowerShell ISE 运行以下通用脚本，以便在您的 VN 中创建和添加 Linux VM。

```
$vm = New-AzureVMConfig -Name $vmname -InstanceSize ExtraSmall -ImageName $img  | 
Add-AzureProvisioningConfig -Linux –LinuxUser $user -Password $pass  | 
Set-AzureSubnet -SubnetNames $subnet

New-AzureVM -ServiceName $cloudSvcName -AffinityGroup $affinitygroup -VNetName $vnetname -VMs $vm 
```

希望这可以帮助某人拔掉头发。

# javascript - onsubmit 检查是否选中并更改源

> ID：12118603
> 
> 赞同：0
> 
> 时间：2012-08-25T02:10:09.587
> 
> 标签：javascript, forms, if-statement, onsubmit

这似乎不起作用，并重置检查...只想在检查后更新

```
<iframe id="time" name="time" type="text/html" src="http://time.is/"></iframe>

<form id="url" onsubmit="" method="post">
<input type="text" name="target" id="target" value="http://time.is" size="40"></form>

<input type="checkbox" name="check1" /> 
```

```
$('.url').submit {
    if($('input[name="check1"]', this).is(':checked')) {
        document.getElementById(time).src = url;
    } else {
        alert('no');
    }
    return false;
}); 
```

[http://jsfiddle.net/ZZe5X/57/](http://jsfiddle.net/ZZe5X/57/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T02:15:08.557

因为您将复选框放在表单之外，但是在您调用的代码`if ($('input[name="check1"]', this).is(':checked')) {`中应该将复选框移到表单内并删除`onsubmit=""`

```
<div class="c">
   <iframe id="time" name="time" type="text/html" src="http://time.is/" frameborder="0" allowtransparency="true"></iframe>
</div>
<form id="url" method="post" target="time">
   <div>
      <input type="text" name="target" id="target" value="http://time.is" size="40">
      <input type="checkbox" name="check1" />
   </div>
</form>

<script>
   $(function(){
       $('#url').submit (function(){
          if ($('input[name="check1"]', this).is(':checked')) {
            document.getElementById('time').src = url;
          } else {
            alert('no');
          }
          return false;
       });
   });
</script> 
```

[http://jsfiddle.net/ZZe5X/66/](http://jsfiddle.net/ZZe5X/66/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T02:36:16.830

有多个错误：

1.您需要在html表单中添加提交按钮（或有办法使用JavaScript触发表单提交），如下所示：

```
<input type="submit"/> 
```

2.该变量`url`未定义，您可以在JavaScript中添加以下行

```
var url = $('#target').val(); 
```

3.

```
document.getElementById(time).src = url; 
```

应该

```
document.getElementById('time').src = url; 
```

4.将脚本的第一行从

```
$('.url').submit { 
```

到

```
$('#url').submit(function() { 
```

5.正如Trinh Hoang Nhu所说，复选框应该在表格内，因为您正在使用

```
if ($('input[name="check1"]', this)... 
```

这是[更新的测试](http://jsfiddle.net/su__/hzSBW/1/)

# php - 获取文件系统的最有效方法

> ID：12118605
> 
> 赞同：2
> 
> 时间：2012-08-25T02:10:57.027
> 
> 标签：php, mysql, filesystems, innodb

> **可能重复：**
> [php / Mysql 最佳树形结构](https://stackoverflow.com/questions/5916482/php-mysql-best-tree-structure)

我目前正在用 PHP 和 MySQL 编写文件系统。

文件夹存储在数据库表“文件夹”中，字段为：“id”、“name”、“parent_id”。我认为这将是最快的方法。

文件存储在系统中，由数据库表“files”与字段“id”、“name”、“parent_id”和“realUrl”链接。

假设我会创建这样的路径：One/Folder/After/Another/Folder。这是表“文件夹”然后：

```
+++++++++++++++++++++++++++++
+ id |   name   | parent_id +
+----|----------|-----------+
+ 1  | One      |     0     +
+ 2  | Folder   |     1     +
+ 3  | After    |     2     +
+ 4  | Another  |     3     +
+ 5  | Folder   |     4     + 
```

很明显，要找出文件夹的路径之类的东西并不是那么简单。当我请求文件夹“文件夹”的数据时，我想知道这个特定文件夹的路径。除了选择数据库表的所有内容然后用 PHP 遍历它之外，我想不出使用 MySQL 的好方法。但是当我有数千个文件夹时，这可能需要很长时间？

你有什么建议？我考虑过创建一个单独的表“父母”来存储所有依赖项：

```
++++++++++++++++++++++++++
+ folders_id | parent_id +
+------------|-----------+
+     2      |      1    +
+     3      |      1    +
+     3      |      2    +
+     4      |      1    +
+     4      |      2    +
+     4      |      3    +
+     5      |      1    +
+     5      |      2    +
+     5      |      3    +
+     5      |      4    + 
```

所以如果我想获得从“一个”到“文件夹”的路径，我只需要

```
SELECT parent_id FROM parents WHERE folders_id=5 
```

出错的风险很大，当然这只是冗余数据。那么可能有更智能的解决方案吗？我什至可以直接通过 MySQL 命令遍历表“文件夹”吗？

当然我的问题也是关于速度的。进行多个简单查询会更快还是更好地只获取一个大的数据？

使用“父母”表，我可以通过一个查询（合并两个表）和一些 PHP 找出文件夹的路径。没有表“父母”，除了全选，我不知道怎么办，这不是解决办法吗？

# python - Python - “str”对象没有属性“close”

> ID：12118609
> 
> 赞同：15
> 
> 时间：2012-08-25T02:11:54.753
> 
> 标签：python, file-io

我很想弄清楚为什么我写的这几行代码不需要关闭属性：

```
from sys import argv
from os.path import exists

script, from_file, to_file = argv

file_content = open(from_file).read()
new_file = open(to_file, 'w').write(file_content)

new_file.close()

file_content.close() 
```

我读了一些东西和其他人的帖子，但他们的脚本比我目前正在学习的要复杂得多，所以我不知道为什么。

我正在艰难地学习 Python，希望能得到任何帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-25T02:16:10.183

`file_content`是一个字符串变量，它包含文件的内容——它与文件无关。您打开的文件描述符`open(from_file)`将自动关闭：文件会话在文件对象退出范围后关闭（在这种情况下，紧接在 之后`.read()`）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-25T02:18:09.327

`open(...)`返回对文件对象的引用，调用`read`读取文件返回字符串对象，调用`write`写入返回的文件`None`，两者都没有`close`属性。

```
>>> help(open)
Help on built-in function open in module __builtin__:

open(...)
    open(name[, mode[, buffering]]) -> file object

    Open a file using the file() type, returns a file object.  This is the
    preferred way to open a file.

>>> a = open('a', 'w')
>>> help(a.read)
read(...)
    read([size]) -> read at most size bytes, returned as a string.

    If the size argument is negative or omitted, read until EOF is reached.
    Notice that when in non-blocking mode, less data than what was requested
    may be returned, even if no size parameter was given.
>>> help(a.write)
Help on built-in function write:

write(...)
    write(str) -> None.  Write string str to file.

    Note that due to buffering, flush() or close() may be needed before
    the file on disk reflects the data written. 
```

有几种方法可以解决这个问题：

```
>>> file = open(from_file)
>>> content = file.read()
>>> file.close() 
```

或使用 python >= 2.5

```
>>> with open(from_file) as f:
...     content = f.read() 
```

这`with`将确保文件已关闭。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T02:17:53.593

当您这样做时`file_content = open(from_file).read()`，您将设置`file_content`为文件的内容（由 读取`read`）。你不能关闭这个字符串。您需要将文件对象与其内容分开保存，例如：

```
theFile = open(from_file)
file_content = theFile.read()
# do whatever you need to do
theFile.close() 
```

你有一个类似的问题`new_file`。您应该将`open(to_file)`呼叫与`write`.

# git - 如何使用 Sourcetree 创建跨越提交的补丁？

> ID：12118610
> 
> 赞同：6
> 
> 时间：2012-08-25T02:12:03.703
> 
> 标签：git, patch, atlassian-sourcetree

我观察到，当我“创建补丁”时，对话框会创建补丁，该补丁“指向”我“从”它的前身“选择”的提交。

在对话框中，我可以诱人地选择两个单独的提交，差异面板会显示这两个提交之间的差异——这就是我想要的补丁。

但是当我按下“OK”时，我仍然得到了单个提交补丁。

有没有办法使用Sourcetree来实现我的意思？

（注意：有一个“sourcetree”标签可能会很好？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T05:58:03.827

您可以使用`git diff oldHash..newHash > file.patch`命令为多个提交获取单个补丁。

# c# - 如何使用 linq 添加“获取所有”方法

> ID：12118611
> 
> 赞同：0
> 
> 时间：2012-08-25T02:12:04.587
> 
> 标签：c#, asp.net, asp.net-mvc, linq, entity-framework

我想在我的班级中添加一个“获取所有”项目方法。使用 lineCollection 我可以看到 (.find(), .findall(), .findindex() ) 但我认为这不是我需要的？有什么帮助吗？

```
using System.Collections.Generic;
using System.Linq;

namespace SportsStore.Domain.Entities
{
    public class Cart
    {
        private readonly List<CartLine> lineCollection = new List<CartLine>();

        public IEnumerable<CartLine> Lines
        {
            get { return lineCollection; }
        }

        public void AddItem(Product product, int quantity)
        {
            CartLine line = lineCollection
                .Where(p => p.Product.ProductID == product.ProductID)
                .FirstOrDefault();

            if (line == null)
            {
                lineCollection.Add(new CartLine {Product = product, Quantity = quantity});
            }
            else
            {
                line.Quantity += quantity;
            }
        }

        public void RemoveLine(Product product)
        {
            lineCollection.RemoveAll(l => l.Product.ProductID == product.ProductID);
        }

        public decimal ComputeTotalValue()
        {
            return lineCollection.Sum(e => e.Product.Price*e.Quantity);
        }

        public void Clear()
        {
            lineCollection.Clear();
        }

    }

    public class CartLine
    {
        public Product Product { get; set; }
        public int Quantity { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T02:16:15.323

lineCollection 已经是一个列表。只需返回 List 即可获取所有元素。如果你想对这些元素做点什么，你可以使用 foreach 循环。如果需要将 IQueryable 转换为 List，请使用 .ToList()

# google-apps-script - 应用脚本将过滤器控件绑定到使用 setDataSourceUrl 的图表

> ID：12118614
> 
> 赞同：0
> 
> 时间：2012-08-25T02:12:50.587
> 
> 标签：google-apps-script, google-visualization

我在 Google Apps 脚本中使用图表服务。修复了[问题 1304](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1304)后，我可以使用 setDataSourceUrl 将我的图表绑定到 Google 电子表格。通过这种方式，我能够在数据源 url 中嵌入[类似 SQL 的查询](https://developers.google.com/chart/interactive/docs/querylanguage)。是否也可以将过滤器控件（CategoryFilter、NumberRangeFilter 等）绑定到数据源 url？我的过滤器在绑定到使用 setDataSourceUrl 的图表时不起作用。

```
 var lineFilter = Charts.newCategoryFilter()
  .setFilterColumnIndex(1)
  .build();

 var pieChart = Charts.newPieChart()
 .setDataSourceUrl(url) 
 .build();

 var dashboard = Charts.newDashboardPanel()
 //not using setDataTable() because my chart is using setDataSourceUrl
 .bind([lineFilter], [pieChart])
 .build(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T17:29:38.390

当您使用仪表板时，您需要确保您没有在图表上单独设置任何数据源，因为它们应该从仪表板中提取数据。不幸的是，DashboardPanel 目前不接受数据源 URL，只接受一个 DataTable。如果您希望支持数据源 URL，请提交[功能请求。](http://code.google.com/p/google-apps-script-issues/issues/list)

# robots.txt - robots.txt 删除整个子域/目录

> ID：12118617
> 
> 赞同：0
> 
> 时间：2012-08-25T02:14:13.280
> 
> 标签：robots.txt

我有一个子域 forums.example.com

它在 public_html/forums

如果我将以下 robots.txt 放在 public_html/forums 中，它会从索引中删除所有论坛吗？（我将论坛迁移到不同的提供商，并希望从谷歌的索引中删除所有论坛页面）

```
User-agent: *
Disallow: / 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:16:32.027

```
User-agent: *
Disallow: /forums/ 
```

如果您不输入文件夹名称“forums”，您将被完全从 google/spider robots 中删除，因为您在该虚拟主机中的所有内容。

# cakephp - Cake HABTM 没有正确删除连接表中的行

> ID：12118619
> 
> 赞同：0
> 
> 时间：2012-08-25T02:15:05.700
> 
> 标签：cakephp, has-and-belongs-to-many

几天来，这一直让我感到非常悲伤，所以我向社区寻求帮助。

假设有两个表 - Album HABTM Customer 连接表是 customer_albums PK(album_id, customer_id)

我有两个控制器功能：

```
public function like($album_id) {
 if ($this->request->is('post')) {
  $this->Album->CustomerAlbum->save(array('album_id' => $album_id,'customer_id' => $this->Auth->user('id')));
  $this->redirect(Controller::referer());

 }
} 
```

和这个...

```
public function unlike($album_id) {
 $this->log($album_id);
 if ($this->request->is('post')) {
  $this->Album->CustomerAlbum->deleteAll(array('album_id' => $album_id,'customer_id' => $this->Auth->user('id'),false));
  $this->redirect(Controller::referer());

 }
} 
```

“Like”函数生成 SQL：

`INSERT INTO gre49302_digital.customer_albums (album_id, customer_id) VALUES (1, 62)`

这是我所期望的。

但是，“Unlike”函数会导致：

`SELECT CustomerAlbum.album_id FROM gre49302_digital.customer_albums AS CustomerAlbum WHERE album_id = 1 AND customer_id = 62`

`DELETE CustomerAlbum FROM gre49302_digital.customer_albums AS CustomerAlbum WHERE CustomerAlbum.album_id = (1)`

这向我表明 CakePHP 不理解复合主键的概念。

因此，当试图删除客户和专辑之间的“喜欢”时，我最终会删除所选专辑的所有内容。

理想情况下，“unlike”函数应该使用复合主键作为选择器从 customer_albums 中简单地删除一条记录。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-26T07:20:59.467

这*可能*是原因。您当前的代码是：

```
deleteAll(array('album_id' => $album_id, 'customer_id' => $this->Auth->user('id'), false)); 
```

我将假设您打算设置`cascade`为`false`. 如果是这种情况，则说明右括号的顺序错误。

将您的代码更改为：

```
deleteAll(array('album_id' => $album_id, 'customer_id' => $this->Auth->user('id')), false); 
```

注意`('id')), false)`vs `('id'), false))`。

# mysql - 错误 1049 (42000)：未知数据库

> ID：12118627
> 
> 赞同：23
> 
> 时间：2012-08-25T02:16:47.007
> 
> 标签：mysql

我似乎无法登录到我的教程数据库开发环境：

```
Ayman$ mysql -u blog -p blog_development
Enter password: 
ERROR 1049 (42000): Unknown database 'blog_development' 
```

我可以在没有 blog_development 部分的情况下很好地登录数据库：

```
Ayman$ mysql -u blog -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 1858 
```

当我授予所有访问权限时，不确定提供了什么：

```
mysql> GRANT ALL PRIVILEGES ON blog_development.*
    -> TO 'blog'@'localhost'
    -> IDENTIFIED BY 'newpassword';
Query OK, 0 rows affected (0.01 sec)

mysql> SHOW GRANTS FOR 'blog'@'localhost'
    -> ;
+----------------------------------------------------------------------------------------- --------------------+
 | Grants for blog@localhost                                                                                        |
 +----------------------------------------------------------------------------------------- --------------------+
| GRANT USAGE ON *.* TO 'blog'@'localhost' IDENTIFIED BY PASSWORD    '*FE4F2D624C07AAEBB979DA5C980D0250C37D8F63' |
| GRANT ALL PRIVILEGES ON `blog`.* TO 'blog'@'localhost'                                                        |
| GRANT ALL PRIVILEGES ON `blog_development`.* TO 'blog'@'localhost'                                           |
+----------------------------------------------------------------------------------------- --------------------+
3 rows in set (0.00 sec) 
```

有人知道要尝试什么吗？谢谢！另外，旁注 - 我有多个 root 用户很奇怪吗？：

```
mysql> select User from mysql.user;
+------+
| User |
+------+
| root |
| root |
|      |
| root |
|      |
| blog |
| root |
+------+
7 rows in set (0.00 sec) 
```

编辑：对于那些询问-我在 MySql 中使用 CREATE DATABASE 命令创建了数据库博客。这是我的活动数据库：

```
mysql> SHOW DATABASES;
+--------------------+
| Database           |
+--------------------+  
| information_schema |
| blog               |
| mysql              |
| performance_schema |
| test               |
+--------------------+ 
5 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-25T02:28:01.170

blog_development 不存在

`0 rows affected`您可以通过消息在 sql 中看到这一点

在mysql中创建它

```
mysql> create database blog_development 
```

但是，当您使用 rails 时，您应该习惯使用

```
$ rake db:create 
```

做同样的任务。它将使用您的 database.yml 文件设置，其中应包括以下内容：

```
development:
  adapter: mysql2
  database: blog_development
  pool: 5 
```

还要熟悉：

```
$ rake db:migrate  # Run the database migration
$ rake db:seed     # Run thew seeds file create statements
$ rake db:drop     # Drop the database 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-25T11:09:19.617

非常简单的解决方案。只需重命名您的数据库并在您的项目中配置您的新数据库名称。

问题是当您导入数据库时​​，出现任何错误，然后数据库将被损坏。日志文件将具有损坏的数据库名称。您可以使用 phpmyadmin for mysql 轻松重命名数据库。

```
phpmyadmin -> operations -> Rename database to 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-11T13:37:25.277

当我们尝试访问不存在的数据库时，会发生这种常见错误。所以创建数据库使用

```
CREATE DATABASE blog_development; 
```

当我们使用删除数据库时，通常会发生该错误

```
DROP DATABASE blog_development; 
```

然后尝试访问数据库。

# objective-c - 本程序中的浅拷贝

> ID：12118631
> 
> 赞同：0
> 
> 时间：2012-08-25T02:17:34.403
> 
> 标签：objective-c

这是一个加法计算器的代码，它通过先输入两个操作数再输入运算来进行运算；像“5 enter 2 enter +”会导致“7”。当用户点击一个数字时，a`double`将被发送到`pushOperand:`当用户点击添加按钮时，字符串`@"+"`将被发送至`performOperation:`。我的问题是制作这些副本有什么意义？`program`如果`runProgram:`它们都是浅拷贝，并且它们的元素最终都指向 , 和 , 的相同元素`NSNumber`和`NSString`对象?`_programStack``program``stack`

```
#import <Foundation/Foundation.h>

@interface CalculatorBrain : NSObject
@property (nonatomic, readonly) id program;

+(double)runProgram:(id)program; 
-(double)performOperation:(NSString *)operation;

@end 
```

* * *

```
#import "CalculatorBrain.h"     

@interface CalculatorBrain ()
@property (nonatomic, strong) NSMutableArray *programStack;
@end

@implementation CalculatorBrain
@synthesize programStack = _programStack;

-(NSMutableArray *) programStack {
    if (!_programStack)
        _programStack = [[NSMutableArray alloc] init];
    return _programStack;
}

-(void)pushOperand:(double)operand {
    [self.programStack addObject: [NSNumber numberWithDouble: operand]];
}

-(double)performOperation:(NSString *)operation {
        [self.programStack addObject: operation];
        double result = [CalculatorBrain runProgram: self.program];
        return result;
    }

-(id)program {
    return [self.programStack copy];
}

+(double)runProgram:(id)program {
    NSMutableArray *stack;
    if ([program isKindOfClass: [NSArray class]])
        stack = [program mutableCopy];
    return [self popOperandOffProgramStack: stack];
}

+(double)popOperandOffProgramStack:(NSMutableArray *)stack {
    double result = 0;
    id topOfStack = [stack lastObject];
    if (topOfStack)
        [stack removeLastObject];

    if ([topOfStack isMemberOfClass: [NSNumber class]])
        result = [topOfStack doubleValue];

    if ([topOfStack isKindOfClass: [NSString class]]) {
        NSString *operation = topOfStack;

        if ([operation isEqualToString: @"+"]) {
            result = [self popOperandOffProgramStack: stack] + [self popOperandOffProgramStack: stack];
    }
    return result;
} 
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T03:16:11.083

`NSNumber`并且`NSString`是不可变的，因此制作无法更改的对象集合的浅表副本是安全的。

`program`重要的是返回一个副本而`programStack`不是实际的可变数组。这是因为`programStack`它是在类扩展中声明的私有内部属性，因此它在外部不可见。如果您`programStack`直接返回外部用户可以更改它，因为它是一个`NSMutableArray`. 该`program`方法返回一个，`NSArray`因为可变对象的副本是不可变的，它具有正确的语义。您想为外部用户提供`programStack`数组的快照，而不是访问您的类内部。

在`runProgram`情况不同。外部用户将`CalculatorBrain`一个传递`NSArray`给进程，并且类的内部逻辑要求堆栈在处理时从数组中弹出元素。因此，您需要制作 a`mutableCopy`以便可以对其进行变异以进行处理。

# python - 在 Python 中将浮点数转换为整数 - 无效的文字错误

> ID：12118633
> 
> 赞同：0
> 
> 时间：2012-08-25T02:17:39.470
> 
> 标签：python, json, floating-point

如何将此数字转换为可以进行简单数学运算的整数？！（例如，低于 10.5200。）

```
{"bid":["10.52000000","0.70824000"],"ask":["10.54000000","2.07336000"],"seq":2456916} 
```

我收到以下错误，这让我心烦意乱：

```
ValueError: invalid literal for int() with base 10: '10.52' 
```

这就是我正在运行的：

```
bitfl = json.loads(bitfl)
bid = bitfl['bid']
ask = bitfl['ask']
bidd = bid[0] #edit - this is actually in, as it's a list
askk = ask[0]
print('diff: %i' % (int(bidd[0]) - int(askk[0]))) 
```

我不知道为什么只接受“10.52”作为字符串、浮点数或 unicode 并将其转换为正常的、可计算的整数会如此困难！

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T02:18:43.183

问题是您试图将包含非整数的*字符串转换为整数。*

最简单/最好的解决方案是使用`int(float(yourstring))`

由于您以 JSON 格式接收数据，因此您还应该考虑要求任何提供数据的客户端不要将字符串用于非字符串数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T02:34:55.483

简单地写`int(float(bidd[0]))`

# php - 如何在 symfony2 的自定义表单字段中获取表单变量

> ID：12118634
> 
> 赞同：1
> 
> 时间：2012-08-25T02:17:44.793
> 
> 标签：php, forms, symfony

我有这个自定义表单域

```
{# src/Acme/DemoBundle/Resources/views/Form/fields.html.twig #}
{% block gender_widget %}
    {% spaceless %}
        {% if expanded %}
            <ul {{ block('widget_container_attributes') }}>
            {% for child in form %}
                <li>
                    {{ form_widget(child) }}
                    {{ form_label(child) }}
                </li>
            {% endfor %}
            </ul>
        {% else %}
            {# just let the choice widget render the select tag #}
            {{ block('choice_widget') }}
        {% endif %}
    {% endspaceless %}
{% endblock %} 
```

这将呈现复选框。但我无法找到如何获得复选框的值

即`child.form.value`不工作。

假设我有在表单中被命名为任务的实体。

我怎样才能得到taskid的值。

就像是

`child.form.vars.task.id`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T03:03:06.003

好像在`{{ choice.value }}`

看看[这个](https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/Twig/Resources/views/Form/form_div_layout.html.twig)，看看继承是如何工作的。

```
<option value="{{ choice.value }}"{% if choice is selectedchoice(value) %} selected="selected"{% endif %}>{{ choice.label|trans({}, translation_domain) }}</option> 
```

# actionscript-3 - 包括 fl.motion.Color

> ID：12118640
> 
> 赞同：1
> 
> 时间：2012-08-25T02:18:14.780
> 
> 标签：actionscript-3, flash, actionscript

我正在阅读这篇文章：[在 as3 中调整形状的亮度不能通过编码工作](https://stackoverflow.com/questions/9786594/in-as3-adjusting-brightness-of-the-shape-is-not-working-via-coding)，它说要导入“fl.motion.Color”，但它似乎不在默认库中。我如何包含它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T13:29:39.870

您必须包含 fl 库。

您可以在以下安装文件夹中找到它：

*\Adobe\Adobe Flash CS5\en\Configuration\ActionScript 3.0\Classes*

您需要安装 Adob​​e Flash CS5（或其他版本）。

# jquery - jQuery对话框未在提交确认时触发

> ID：12118642
> 
> 赞同：0
> 
> 时间：2012-08-25T02:18:34.087
> 
> 标签：jquery

好的，我已经为此工作了一段时间，我快要拔掉头发了。这是场景。我正在创建一个讨论板，使用 AJAX 调用发布表单，当用户提交表单时，我希望触发一个包含警告和评论的对话框，以便他们查看并在需要时继续编辑。

问题：我无法启动该死的对话框。我已经尝试过这里发布的大多数 jQuery 对话框答案，但没有一个有效。

我在这里发布主要代码，但如果需要，我会发布整个页面。我正在使用 ckEditor，这个表单最初是从 AJAX 调用本身调用的。

这是有问题的代码。

```
$('#postComment_' + id).click( function() {
                // Warn the user about submitting. Let them review their comment.
CKupdate()
$('#confirmSubmit').dialog("destroy");
var commentTitle = $('#commentSubject_' + id).val();

// This is the warning dialog that isn't working!

var commentBody = CKEDITOR.instances['comment_' + id].getData();
var NewDialog = $('<div>You are about to submit your comment.</div>'); 
// This will be where the user content will be. I stripped it out until I can get a simple warning to show.
$(NewDialog).dialog({
    modal: true,
    autoOpen: false,
    buttons: {
    'Submit': function() {
        $(this).dialog('close');
        // Just close and submit.
        $('#discussionComment_' + id).ajaxForm({
            beforeSend: function() {
                $('#discussionComment_' + id + ' input:submit').html('Sending...');
                $('#newEntry').attr('id', '');
                                },
            success: function(data) {
                $('#commentBox_' + id).after(data);
                $('#discussionComment_' + id).remove();
                $('#discussionComment_' + id).hide('puff', function() { $(this).remove() }, 'fast');
                $('#content_' + id + ' a.remove').removeClass('remove').addClass('respond').html('Respond');
                $('.expand').show();
                window.location + $('#newEntry');
                $('#newEntry').children().effect("highlight", {}, 3000);
            },
            error: function () {
                alert('There was a problem posting your comment. Please try again.');
            }
             }); // Form submit
            },
            'Edit': function() {
                $(this).dialog('close');
                return false; // Don't submit the form.
            }
            }
        }); 
        return false;
        });// Click to submit form. 
```

好的，让我感谢所有做到这一点的人。我的脸皮也很厚，因为我搞砸了其他垃圾，或者我用过的糟糕的形式。我正在尝试使用好习惯。

# buddypress - buddypress 隐藏个人资料字段

> ID：12118647
> 
> 赞同：2
> 
> 时间：2012-08-25T02:19:48.893
> 
> 标签：buddypress

我知道 BuddyPress 中有一种方法可以帮助隐藏一些配置文件字段：

```
function bp_has_profile( $args = '' ) {
    global $profile_template;

    // Only show empty fields if we're on the Dashboard, or we're on a user's profile edit page,
    // or this is a registration page
    $hide_empty_fields_default = ( !is_network_admin() && !is_admin() && !bp_is_user_profile_edit() && !bp_is_register_page() );

    // We only need to fetch visibility levels when viewing your own profile
    if ( bp_is_my_profile() || bp_current_user_can( 'bp_moderate' ) || bp_is_register_page() ) {
        $fetch_visibility_level_default = true;
    } else {
        $fetch_visibility_level_default = false;
    }

    $defaults = array(
        'user_id'             => bp_displayed_user_id(),
        'profile_group_id'    => false,
        'hide_empty_groups'   => true,
        'hide_empty_fields'   => $hide_empty_fields_default,
        'fetch_fields'        => true,
        'fetch_field_data'    => true,
        'fetch_visibility_level' => $fetch_visibility_level_default,
        'exclude_groups'      => false, // Comma-separated list of profile field group IDs to exclude
        'exclude_fields'      => false  // Comma-separated list of profile field IDs to exclude
    );

    $r = wp_parse_args( $args, $defaults );
    extract( $r, EXTR_SKIP );

    $profile_template = new BP_XProfile_Data_Template( $user_id, $profile_group_id, $hide_empty_groups, $fetch_fields, $fetch_field_data, $exclude_groups, $exclude_fields, $hide_empty_fields, $fetch_visibility_level );
    return apply_filters( 'bp_has_profile', $profile_template->has_groups(), $profile_template );
} 
```

我不确定如何调用此方法并传递 'exclude_fields' => $IDs_to_hide

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T05:56:46.023

是的，可以从个人资料页面隐藏某些字段。

首先进入你的主题文件夹中的edit.php。这里如果你想隐藏文本框并且名称是“全名”。

```
<?php if ( 'textbox' == bp_get_the_profile_field_type() ) : ?>
    <?php if ( 'Full Name' != bp_the_profile_field_name() ) : ?>
         <label for="<?php bp_the_profile_field_input_name(); ?>"><?php bp_the_profile_field_name(); ?> <?php if ( bp_get_the_profile_field_is_required() ) : ?><?php _e( '(required)', 'buddypress' ); ?><?php endif; ?></label>
         <input type="text" name="<?php bp_the_profile_field_input_name(); ?>" id="<?php bp_the_profile_field_input_name(); ?>" value="<?php bp_the_profile_field_edit_value(); ?>" <?php if ( bp_get_the_profile_field_is_required() ) : ?>aria-required="true"<?php endif; ?>/>
      <?php endif; ?>
<?php endif; ?> 
```

上面的代码与 profile.php 文件中的代码相同，但我只会将新的 if 条件放入其他 Radiobutton 和 Selectbox 等中。

您的个人资料中不会显示您的全名个人资料字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-08T17:09:08.520

不确定是否有办法使用您的主题功能执行此操作，但您可以轻松地将其隐藏在编辑循环中。将 /buddypress/members/single/profile/edit.php 复制到您的主题并添加以下行：

`<?php if ( 'Field Name' == bp_get_the_profile_field_name() ) continue; ?>`

就在这条线的下方：

`<?php while ( bp_profile_fields() ) : bp_the_profile_field(); ?>`

这类似于 Chirag 的方法，但会跳过与该字段相关的所有内容，包括包装器 div，因此您没有多余的 HTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-02T16:40:05.930

您可以使用 CSS 隐藏带有 id 选择器的特定字段。

```
#field_1 {
display:none;
}
#signup_username {
display:none;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-25T20:13:58.067

您可以通过`bp_before_has_profile_parse_args`过滤器做到这一点：

```
function skip_xprofile_fields( $args ){
    global $bp, $wpdb;
    $field_name = 'First Name';
    $field_id = $wpdb->get_var( "SELECT id FROM {$bp->profile->table_name_fields} WHERE `name` = '".esc_sql($field_name)."'");
    $args['exclude_fields'] = ','.$field_id;
    return $args;
}
add_filter('bp_before_has_profile_parse_args', 'skip_xprofile_fields' ); 
```

只需将`$field_name`var 替换为您的字段名称即可。

# php - php日期的问题

> ID：12118649
> 
> 赞同：4
> 
> 时间：2012-08-25T02:20:36.980
> 
> 标签：php, date

我试图根据今天的日期（2012 年 8 月 24 日）计算以下三个值：

1.  本月第一个星期六的日期。
2.  本月第三个星期六的日期。
3.  下个月第一个星期六的日期。

这就是我在 PHP 脚本中的操作方式：

```
// Returns August 2012
$this_month = date("F Y");

// Returns September 2012
$next_month = date("F Y", strtotime("next month"));

// Returns August 04th, Saturday
$t_sat_1st=date('U', strtotime($this_month.' First Saturday'));

// Returns August 18th, Saturday
$t_sat_3rd=date('U', strtotime($this_month.' Third Saturday'));

// Returns September 08th, Saturday
$n_sat_1st=date('U', strtotime($next_month.' First Saturday') ); 
```

为什么最后一行代码返回了错误的日期？我预计它会在 2012 年 9 月 1 日返回。我的代码有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T02:29:06.117

我不知道为什么你的代码不能完全正常工作，一定是它的解析方式..但是试试

```
$n_sat_1st=date('U', strtotime('first saturday of ' . $next_month) ) 
```

注意'of'是必要的。此代码仅适用于 5.3+

> 应该注意的是，这些字符串中的一些显然只在 PHP 5.3 中有效，特别是：
> 
> 例如“本月的第一天”和“本月的最后一天”。根据在另一个网站上找到的信息，PHP 5.3 中添加了“xxx day of”功能。

评论此页面 - [http://www.php.net/manual/en/datetime.formats.relative.php](http://www.php.net/manual/en/datetime.formats.relative.php)

我已经在 php 5.3 和 5.4 的 windows 和 ubuntu 上对此进行了测试，并且可以正常工作。

如果这不起作用，试试这个

```
 $d = new DateTime($next_month);
 $d->modify('first saturday of this month');
 echo $d->format('U'); 
```

# c# - 为什么我得到异常：调用的目标抛出了异常？

> ID：12118650
> 
> 赞同：1
> 
> 时间：2012-08-25T02:20:53.723
> 
> 标签：c#

我首先有这个代码的构造函数和按钮点击事件：

```
using System.Text;
using System.Windows.Forms;
using System.Xml;
using System.Xml.Linq;
using System.Xml.XPath;
using System.IO;
using System.Collections;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        DirectoryInfo dirinf = new DirectoryInfo(@"C:\");
        List<FileSystemInfo> fsi = new List<FileSystemInfo>();

        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            backgroundWorker1.RunWorkerAsync();
            button1.Enabled = false;
        } 
```

然后我有一个搜索功能和一个 backgroundowrker DoWork 事件：

```
public void Search(string strExtension,
                            DirectoryInfo di,
                            List<FileSystemInfo> pResult)
        {
            try
            {

                foreach (FileInfo fi in di.GetFiles())
                {
                    if (InvokeRequired)
                    {
                        BeginInvoke(new Action(() => label2.Text = fi.Name));
                    }
                    if (fi.Name == "MessageLog.xsl")
                    {
                        foreach (FileInfo fii in di.GetFiles())
                        {
                        if (fii.Extension == strExtension)
                            pResult.Add(fii);
                        }
                        if (InvokeRequired)
                        {
                            BeginInvoke(new Action(() => textBox1.AppendText("Number Of History Files Found: ===> " + pResult.Count.ToString() + Environment.NewLine)));
                        }

                    }
                }

                    foreach (DirectoryInfo diChild in di.GetDirectories())
                        Search(strExtension, diChild, pResult);

            }
            catch (Exception e)
            {
            }
        }

        private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
        {
            Search(".xml", dirinf, fsi);
            for (int i = 0; i < fsi.Count; i++)
            {
                if (InvokeRequired)
                {
                    BeginInvoke(new Action(() => textBox1.AppendText(fsi[i - 1].FullName + Environment.NewLine)));
                }

            }
        } 
```

当它到达 DoWork 事件中的部分时：

```
for (int i = 0; i < fsi.Count; i++)
                {
                    if (InvokeRequired)
                    {
                        BeginInvoke(new Action(() => textBox1.AppendText(fsi[i - 1].FullName + Environment.NewLine)));
                    }

                } 
```

经过一两次迭代后，它在 Program.cs 中抛出异常就行了：

```
Application.Run(new Form1()); 
```

调用的目标已抛出异常

通过向后台工作人员完成事件报告来解决它：

```
private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
        {
            Search(".xml", dirinf, fsi);
            backgroundWorker1.ReportProgress(100);

        }

        private void backgroundWorker1_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            for (int i = 0; i < fsi.Count; i++)
            {                
                    textBox1.AppendText(fsi[i].FullName + Environment.NewLine);
            }
        } 
```

工作刚刚好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T05:39:22.247

您已经解决了这个问题（正确地，这应该在 Completed 事件中完成）。

剩下的就是一个解释：

您正在`i`Action lambda 中使用 DoWork 方法的本地变量。这意味着所有代码都使用变量的 1 个共享（盒装）版本。它被称为“关闭循环变量”。

症状适合：当第二个或第三个开始执行主循环时，lambdas 是异步执行的`i == fsi.Count`。（内部）异常应该是“索引超出范围”。

```
for (int i = 0; i < fsi.Count; i++)
{
    if (InvokeRequired)
    {
        BeginInvoke(new Action(() => 
            textBox1.AppendText(fsi[i - 1].FullName   // captured 'i'
            + Environment.NewLine)));
    }
} 
```

可以这样修复：

```
for (int i = 0; i < fsi.Count; i++)
{
    if (InvokeRequired)   
    {
        int iCopy = i;     // 1 instance per loop

        BeginInvoke(new Action(() => 
            textBox1.AppendText(fsi[iCopy - 1].FullName  
            + Environment.NewLine)));
    }
} 
```

# c++ - 如何定义可扩展的 C++ 枚举系统

> ID：12118654
> 
> 赞同：2
> 
> 时间：2012-08-25T02:21:36.403
> 
> 标签：c++, templates, macros, enums

我在枚举项目中遇到了问题。在 EventDef.h 中，

```
enum EventDef {
    EVT1 = 0,
    EVT2,
    EVT3,
    EVT_NUM,
} 
```

这样，我可以在另一个头 UIEventDef.h 中扩展 EventDef 系统

```
#include "EventDef.h"
enum UIEventDef {
    UIEVT1 = EVT_NUM,
    UIEVT2,
    UIEVT3,
} 
```

但是，有一个限制，我不能以相同的方式在 NetEvent.h 中执行此操作。

```
#include "EventDef.h"
enum NetEventDef {
    NETEVT1 = EVT_NUM,
    NETEVT2,   //wrong: this will have the same value as UIEVT2
    NETEVT3,  
} 
```

C++ 中是否有更好的编译时解决方案，例如可以提供帮助的模板？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T04:50:24.023

可扩展枚举的想法本质上并不是“糟糕的设计”。在其他语言中有它们的历史，即使 c++ 不直接支持它们。有不同种类的可扩展性。

可扩展枚举有用的东西

*   错误代码
*   消息类型
*   设备标识（OID 是一个分层枚举系统）

枚举可扩展性示例

*   目标模块二具有可通过继承之类的类进行扩展的枚举。
*   [Java 中的可扩展枚举模式](http://binkley.blogspot.com/2005/11/extensible-enum-pattern-in-java.html)，可以在 c++ 中实现。
*   Java 枚举是可扩展的，因为额外的数据和方法可以成为枚举的一部分。
*   在 c++ 中，typeid 运算符本质上是编译器生成的带有附加值的枚举。

您在示例代码中展示的那种可扩展性在独立的 c++ 中没有优雅的实现。事实上，正如你所指出的，它很容易导致问题。

考虑一下您希望如何使用可扩展枚举。也许一组不可变的单例对象将满足您的需求。

在 c++ 中使用可扩展枚举的另一种方法是使用代码生成器。每个想要添加到可扩展枚举的编译单元都将 id 记录在自己的单独的 .enum 文件中。在构建时，在编译之前，一个脚本（即 perl、bash、...）会查找所有 .enum 文件，读取它们，为每个 id 分配数值，并写出一个头文件，该文件与其他文件一样包含在内。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T02:37:13.847

为什么你希望你的事件枚举被这样声明？如果你愿意的话，通过将它们“链接”起来，你会得到什么，就像你描述的那样？

我会让它们成为完全独立的枚举。其次，我建议您不要再使用旧式枚举。c++11 在这里并且在 gcc 中可用。您应该使用枚举类：

```
enum class EventDef  : unsigned { Evt1 = 0, Evt2, Evt3, ... LastEvt }
enum class NetEvtDef : unsigned { NetEvt1 = 0, NetEvt2, NetEvt3, ... NetLastEvt } 
```

如果要切换，可以这样做：

```
void doSwitch(EventDef evt_def)
{
  switch(evt_def)
  {
    case EventDef::Evt1
    {
     // Do something;
     break;
    }
    default:
    // Do something;
  };
}

void doSwitch(NetEvtDef net_def)
{
  switch(net_def)
  {
    case NetEvtDef::NetEvt1
    {
     // Do something;
     break;
    }
    default:
    // Do something;
  };
} 
```

通过为 doSwitch 创建重载函数，您可以隔离所有枚举类型。将它们放在不同的类别中是一种好处而不是问题。它为您提供了以不同方式处理每个事件枚举类型的灵活性。

如您所描述的那样将它们链接在一起会使问题不必要地复杂化。

我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-10T05:51:35.290

我发现以下是复杂性、功能和类型安全之间的有用折衷。它使用具有默认构造函数的自定义类的全局变量来简化初始化。下面的示例是一组可扩展的错误代码。您可能还想包含在名称空间中（但我通常不打扰）。

```
//
//  ErrorCodes.h
//  ExtendableEnum
//
//  Created by Howard Lovatt on 10/01/2014.
//

#ifndef ErrorCodes_h
#define ErrorCodes_h

#include <string>

class ErrorCodes {
public:
    static int nextValue_;
    explicit ErrorCodes(std::string const name) : value_{nextValue_++}, name_{name} {}
    ErrorCodes() : ErrorCodes(std::to_string(nextValue_)) {}
    int value() const { return value_; }
    std::string name() const { return name_; }
private:
    int const value_;
    std::string const name_;
    ErrorCodes(const ErrorCodes &);
    void operator=(const ErrorCodes &);
};

int ErrorCodes::nextValue_ = 0; // Weird syntax, does not declare a variable but rather initialises an existing one!
ErrorCodes first;
ErrorCodes second;
// ...

#endif

//
//  ExtraErrorCodes.h
//  ExtendableEnum
//
//  Created by Howard Lovatt on 10/01/2014.
//

#ifndef ExtraErrorCodes_h
#define ExtraErrorCodes_h

#include "ErrorCodes.h"

ErrorCodes extra{"Extra"};

#endif

//
//  ExtraExtraExtraCodes.h
//  ExtendableEnum
//
//  Created by Howard Lovatt on 10/01/2014.
//

#ifndef ExtendableEnum_ExtraExtraCodes_h
#define ExtendableEnum_ExtraExtraCodes_h

#include "ErrorCodes.h"

ErrorCodes extraExtra{"ExtraExtra"};

#endif

//
//  main.cpp
//  ExtendableEnum
//
//  Created by Howard Lovatt on 10/01/2014.
//

#include <iostream>
#include "ErrorCodes.h"
#include "ExtraErrorCodes.h"
#include "ExtraExtraErrorCodes.h"

// Need even more error codes
ErrorCodes const localExtra;

int main(int const notUsed, const char *const notUsed2[]) {
    std::cout << first.name() << " = " << first.value() << std::endl;
    std::cout << second.name() << " = " << second.value() << std::endl;
    std::cout << extra.name() << " = " << extra.value() << std::endl;
    std::cout << extraExtra.name() << " = " << extraExtra.value() << std::endl;
    std::cout << localExtra.name() << " = " << localExtra.value() << std::endl;
    return 0;
} 
```

输出是：

```
0 = 0
1 = 1
Extra = 2
ExtraExtra = 3
4 = 4 
```

如果您有多个编译单元，那么您需要使用单例模式的变体：

```
class ECs {
public:
    static ErrorCode & first() {
        static ErrorCode instance;
        return instance;
    }
    static ErrorCode & second() {
        static ErrorCode instance;
        return instance;
    }
private:
    ECs(ECs const&);
    void operator=(ECs const&);
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-11T03:23:31.240

我们可以在 C++ 中构造一个可扩展的“枚举”，如下所示：

```
struct Last {};

struct D 
{
    using Next = Last;
    static const char* name = “D”;
};

struct C
{
    using Next = D;
    static const char* name = “C”;
};

struct B 
{
    using Next = C;
    static const char* name = “B”;
};

using First = B; 
```

我们可以使用这些构造遍历上述内容：

```
void Process(const B&)
{
    // do something specific for B
    cout << “Call me Ishmael” << endl;
}

template <class T>
void Process(const T&)
{
    // do something generic
    cout << “Call me “ << T::name << endl;
}

template <class T>
struct IterateThru
{
   static void iterate() 
   {
       Process(T());
       IterateThru<T::Next>::iterate();
   }
};

template <>
struct IterateThru<Last>
{
    static void iterate()
   {
       // end iteration
   }
}; 
```

遍历“枚举”：

```
IterateThru<First>::iterate(); 
```

扩展“枚举”：

```
struct A
{
    using Next = B;
    static const char* name = “A”;
}:

using First = A: 
```

# graph - 无向和完整图中的最短路径？

> ID：12118656
> 
> 赞同：2
> 
> 时间：2012-08-25T02:22:20.437
> 
> 标签：graph, shortest-path, dijkstra, quickgraph

我有一个可能很简单的问题，但是当最后期限迫近时，大脑停止工作，所以有：

我有一个包含 N 个节点的无向​​完整图。我有一个起始节点，并且我有从每个节点到其他节点的距离矩阵。我想运行 Dijkstra 算法或任何其他可以找到从起始节点访问所有节点的最短方法的算法。我只想访问每个节点一次。我相信它是一个完整的图，其中每个节点都连接到其他节点，这会使问题变得更容易，但我无法全神贯注地对其进行编码。我正在使用 C#。我之前已经问过另一个问题，但这是在较早的阶段，我对这个问题知之甚少。是否有任何可用的代码片段或伪代码，或者如果有人可以让我开始，我将非常感激。

我一直在查看 QuickGraph 及其文档和其他在线资源，但我无法弄清楚我需要什么作为参数来运行算法。更准确地说，我不明白下面的代码：

```
IVertexAndEdgeListGraph<TVertex, TEdge> graph = ...;
Func<TEdge, double> edgeCost = e => 1; // constant cost
TVertex root = ...;
// compute shortest paths
TryFunc<TVertex, TEdge> tryGetPaths = graph.ShortestPathDijkstra(edgeCost, root); 
```

上面的代码片段取自：[http](http://quickgraph.codeplex.com/wikipage?title=Dijkstra%20Shortest%20Distance%20Example)
: //quickgraph.codeplex.com/wikipage?title=Dijkstra%20Shortest%20Distance%20Example 如果任何有 quickgraph 经验的人可以简单地向我解释我需要做什么使用以下可以拯救我的功能。

为了解释我所拥有的，我有一个点 (x,y) 列表，我想从中构建一个图表，但只显示最短路径的边缘。

链接到我的旧帖子：
[在 C# 中的 List<Point> 上运行 Dijkstra 算法](https://stackoverflow.com/questions/12058722/run-dijkstras-algorithm-on-a-listpoint-in-c-sharp)

# javascript - 在调用 Save() 之后，Backbone.js 的“模型”期望从服务器返回什么？

> ID：12118659
> 
> 赞同：4
> 
> 时间：2012-08-25T02:24:00.423
> 
> 标签：javascript, rest, backbone.js

Backbone.js“模型”在调用后期望从服务器返回`Save()`什么？

我问的原因是因为我在调用`Save()`. 我摆弄着模型的`parse()`方法。我发现返回一个空对象或`null`没有产生这种行为。但是，服务器正在返回一些 JSON 作为“成功”消息，并且此信息似乎覆盖了模型：

```
{
    message: 'SUCCESS'
} 
```

服务器响应`Save()`来自 Backbone 的请求的“正确”方式是`model`什么？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-25T02:29:52.150

服务器应该以 200 的 HTTP 状态响应，并且应该返回服务器为模型生成或更新的任何数据。通常，这只是模型的服务器生成`id`字段。从服务器返回的任何字段都将应用于模型。因此，如果您将其发送到服务器：

```
 {
  foo: "bar"
} 
```

以及服务器对此的响应：

```
 {
  id: 1, // or some other server generated ID, from a database, etc.
  message: "SUCCESS"
} 
```

您的模型最终将如下所示：

```
 {
  id: 1,
  foo: "bar",
  message: "SUCCESS"
} 
```

如果您的模型在调用 save 方法时不需要从服务器更新任何数据，那么您应该返回一个空`{}`对象字面量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-25T05:32:51.493

好吧，这个问题经常出现在这里，我已经在 SO 上问过了。似乎将此添加到评论中不会对未来的提问者有所帮助，因此这里是回答和提问的链接

[开始使用backbonejs - 服务器应该返回什么](https://stackoverflow.com/questions/9706260/getting-started-with-backbonejs-what-should-a-server-return)

# iphone - 如何参考CoreData中同一实体的单个属性更新实体的属性？

> ID：12118664
> 
> 赞同：0
> 
> 时间：2012-08-25T02:25:30.537
> 
> 标签：iphone, database-design, core-data, ticoredatasync

我的问题类似于此链接上的问题：[基于属性评估创建 CoreData 实体](https://stackoverflow.com/questions/6489364/creating-a-coredata-entity-based-on-attribute-evaluation)

我刚刚开始编写我的第一个使用 Core Data 的项目，其中我有 5 个实体，即公司、会议、议程、子议程和会议记录。公司将与会议相关，每次会议都应与其“议程”和“会议记录”相关......随后，会议的每个议程都应与其“子议程”相关

以下代表我项目的基本数据模型：

公司{标题：字符串}

会议{标题：字符串日期：日期}

议程{名称：字符串}

子议程{名称：字符串}

分钟{名称：字符串}

我需要以这样一种方式进行编码，即如果有关这些实体中的任何属性的任何信息发生更改，则必须对其进行同步。它涉及为每个实体创建新的属性值或更新现有的属性值。为此，我正在计划为每个实体拥有一个名为 ID 或标签的属性，这样一旦我设置了每个实体之间的关系，我就可以参考该唯一标签值来更新实体的所有其他属性值。

如果我的问题令人困惑，请原谅我。如果您能理解，请告诉我我打算做的事情是否正确。我完全不知道编码部分，但我想我可以管理是否有人可以帮助我处理已用于类似要求的示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T10:36:43.023

你正在以错误的方式解决这个问题。您的“标签值”实际上只不过是传统数据库编程中的所谓外键。

但是 Core Data 不是“数据库”，它是一个*Object Graph*。因此，您不需要使用这些外键，您只需在实体之间建立关系，其他一切都在幕后发生。

因此，要更改属性，只需执行以下操作：

```
agenda.name = @"New agenda name";
subagenda.agenda.meeting.title = @"New Meeting Title"; 
```

所以不需要通过外键更新任何东西。欢迎来到 Core Data 的精彩世界。

**请阅读[核心数据编程指南](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreData/cdProgrammingGuide.html)以掌握这些概念。**

# xcode - 自定义后退按钮像真正的后退按钮 xcode 一样工作

> ID：12118672
> 
> 赞同：2
> 
> 时间：2012-08-25T02:28:19.640
> 
> 标签：xcode, xcode4, xcode4.3

我正在制作一个自定义的后退按钮，它的工作原理与真正的后退按钮完全一样。下面是我的代码

```
UIButton *cusBack = [UIButton buttonWithType:101];
[cusBack setTitle:@"Back" forState:UIControlStateNormal];
[cusBack addTarget:self action:@selector(clickBack) forControlEvents:UIControlEventTouchUpInside];

self.view addSubView:cusBack; 
```

这是我的选择器：

```
-(void)clickBack{
PrevPage *pPage = [[PrevPage alloc] init];
[self.navigationController pushViewController:pPage animated:YES];
[pPage release];
} 
```

实际上，它有效，但它创建的方向是从右到左。但我希望页面从左移到右，因为它会回到最近的页面

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T11:14:32.053

如果您想具有与后退按钮相同的行为，您应该尝试另一种方法：

```
-(void)clickBack{          //Your presenting view controller will always be the last view controller on the stack.                  
[self.navigationController popToViewController:[self.navigationController.viewControllers objectAtIndex:self.navigationController.viewControllers.count-1] animated:YES];
} 
```

此外，如果您需要对之前的视图控制器进行一些更改，您需要做的就是导入它的头文件，然后您可以在弹出视图控制器之前使用它的属性和公共方法。

```
#import "MyPreviousViewController.h"
...
-(void)clickBack{
[self.navigationController.viewControllers objectAtIndex:self.navigationController.viewControllers.count-1].title = @"Change title for previous view controller";
[self.navigationController popToViewController:[self.navigationController.viewControllers objectAtIndex:self.navigationController.viewControllers.count-1] animated:YES];
} 
```

目前，您的后退按钮不像真正的后退按钮那样工作，因为您实际上不是将最后一个视图控制器从堆栈中弹出（也释放对象），而是实际上一直在堆栈上推送新的视图控制器。如果这个堆栈变得太大，你可能会遇到一些问题。

# layout - 如何在 JavaFX 中创建调整大小的分隔符？

> ID：12118681
> 
> 赞同：10
> 
> 时间：2012-08-25T02:30:25.843
> 
> 标签：layout, javafx

首先，我是一名长期的 Java/Swing 开发人员。我最近安装了 JavaFX 2.2 来玩玩。

我正在创建一个相当简单的应用程序，它的主窗口顶部有一个工具栏，窗口的其余部分有内容。实现这一点的明显方法是使用 a `BorderPane`，并将 a 粘贴`ToolBar`到顶部。到目前为止，一切都很好。但是，我希望工具栏中的某些控件位于窗口的左边缘，而某些位于右边缘。我找不到办法做到这一点。我可以在工具栏中放一个不可见的间隔对象，但我只知道如何给它一个固定的宽度；调整窗口大小时它不会调整大小。

所以我认为我不会使用 ToolBar 对象，而是使用`HBox`; 它应该相当于一个水平方向的 Swing`Box`对象，对吧？Swing`Box`类有一个`createHorizontalGlue()`方法可以插入一个自动调整大小的分隔符。好吧，我在 JavaFX HBox 类中找不到等价物。没有简单的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-25T04:11:26.063

我想出了如何使用 a`HBox`而不是 a`ToolBar`来控制控件；关键是`HBox.setHgrow()`方法，它允许您将间隔对象设置为增长以填充可用空间。我仍然不知道是否可以使用实际的 ToolBar 实例来做到这一点。

```
/**
 * Creates and populates the Node that serves as the window toolbar.
 *
 * @return a newly constructed and populated toolbar component
 */
private Node makeToolbar() {
    // Auto-sizing spacer
    Region spacer = new Region();
    HBox.setHgrow(spacer, Priority.ALWAYS);

    // Horizontal box containing toolbar controls
    HBox box = new HBox();
    box.setPadding(new Insets(8));
    box.setAlignment(Pos.CENTER);
    box.getChildren().addAll(openButton, spacer, resizeSlider);

    // Colored background panel with drop shadow
    Pane bgRect = new Pane();
    bgRect.setStyle("-fx-background-color: #e0e0e0;");
    bgRect.setEffect(DropShadowBuilder.create().width(1).build());

    // StackPane to hold box and rectangle
    StackPane stack = new StackPane();
    stack.getChildren().addAll(bgRect, box);

    return stack;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-11-14T07:15:22.350

我这样做：

```
private Node makeFooter(Node left, Node right) {
        ToolBar footer = new ToolBar();
        Region spacer = new Region();
        HBox.setHgrow(spacer, Priority.ALWAYS);     
        spacer.setMinWidth(Region.USE_PREF_SIZE);
        footer.getItems().addAll(left, spacer, right);
        return footer;
} 
```

希望我能帮助别人

# batch-file - 如何从目录中的多个文件中删除空白行

> ID：12118686
> 
> 赞同：0
> 
> 时间：2012-08-25T02:32:34.650
> 
> 标签：batch-file

我需要替换目录中多个文件的空行。我可以为单个文件执行此操作，但我无法为文件夹中的多个文件执行此操作。

这是适用于单个文件的代码

```
@echo off
for /F "tokens=* delims=" %%A in (input.txt) do echo %%A >> output.txt 
```

请帮助我，因为我对批处理编程完全陌生

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T19:17:12.573

感谢您发布这行代码，我正在寻找它，并且有点急于自己推理它:)

要将其用于一系列文件，您可以执行以下操作：（您可以将整个代码复制到单个批处理文件中）

```
:: Say you have several files named Input1.txt, Input2.txt, Input3.txt, etc 
:: this will call a subroutine within the same batch file, called :Strip
:: using each file as parameter:

for %%A in ("input*.txt") do call :Strip %%A
Goto End

:Strip
:: The subroutine starts here
:: First we take the name of the input file and use it to generate
:: the name of an output file, Input1.txt would output to output_(Input1).txt, etc
For %%x in (%*) do set OutF=output_(%%~nx).txt

:: I now erase the output file it it already exists, so if you run this twice
:: it won't duplicate output
del %OutF%

:: Now comes the line you already supplied
for /F "tokens=* delims=" %%B in (%*) do echo %%B >> %OutF%

:: and now we return from the subroutine
Goto :EOF

:End 
```

# c# - 跨 HTTP 方法的永久重定向？

> ID：12118687
> 
> 赞同：0
> 
> 时间：2012-08-25T02:32:39.120
> 
> 标签：c#, asp.net-mvc-3, redirect, routing

我的`CommentsController`.

```
 [HttpGet]
    [Authorize]
    public ActionResult New(long id)
    {
        return RedirectToAction("Details", "Posts", new { id }); // lets be graceful.
    }

    [HttpPost]
    [Authorize]
    public ActionResult New(long id, string comment, IMiniPrincipal principal)
    {
        throw new NotImplementedException();
    } 
```

两者都通过任何`posts/{id}/comment`id 为数值的路由解析。我添加了该`GET`操作主要是为了避免混淆（当他们尝试手动而不是通过表单访问路由时，我不只是告诉用户它不存在，而是`POST`将他们重定向到评论将被提交到的帖子）。

问题是我是否可以在 HTTP GET 请求中使用永久重定向结果，但在 HTTP POST 请求期间仍然无法永久重定向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T02:44:29.170

将 POST 处理程序映射到模型可能会更好，这样可以大大降低相同的 URL 映射到两个操作的可能性。

因此，您的代码可能会更改为：

```
[HttpPost]
[Authorize]
public ActionResult New(CommentModel model)
{
    // { ...code... }
} 
```

模型看起来像：

```
public class CommentModel
{
    public long ID { get; set; }

    public string Comment { get; set; }

    public IMiniPrincipal Principal { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T15:27:22.357

永久重定向在每个方法的基础上工作，因此您实际上可以对`POST`给定 url 执行永久重定向，同时为`GET`对同一 url 的请求提供内容。

# jquery - 如何从 json 输出生成图像组件？

> ID：12118690
> 
> 赞同：1
> 
> 时间：2012-08-25T02:34:26.530
> 
> 标签：jquery, html, json

如何用 imageArray[0] 中的值重新填充图像 src？

```
$.getJSON("http://xxxx",function(data) {
    var imageArray=[];
    imageArray=data.images;
    alert(imageArray[0]);
    $('#loader').empty();
    var imageOne= '<img style="display:none;" src="imageArray[0]" id="1" wdith="100" />';
    $("#ajax_content").html(imageOne);
    $('img#1').fadeIn();
}); 
```

我想重新填充 imageArray[0] 如下

```
var imageOne= '<img style="display:none;" src="http://i2.cdn.turner.com/cnn/dam/assets/120824111207-storm-isaac-t1-main.jpg" id="1" wdith="100" />'; 
```

@谢谢未定义

我想将它们全部放在一个数组中，并且只显示第一张图像。稍后我将努力让上一个/下一个按钮移动到下一个图像。你可以纠正以下工作吗？

```
for (var i=0;i<imageArray.length;i++){
                        imageOne[i]='<img style="display:none;" src="'+imageArray[i]+'" id="i" wdith="100" />;';
                    }
                    $("#ajax_content").html(imageOne);
                    $('img#1').fadeIn(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T02:44:49.560

您需要更改`src="imageArray[0]"`为`src=\"' + imageArray[0] + '\"`.

现在，您插入的`src`只是“imageArray[0]”。您需要让它由 JavaScript 评估，以便它可以插入正确的值`imageArray[0]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T02:48:44.937

```
$.getJSON("http://xxxx", function(data){
    var imageArray=[];
    imageArray = data.images;
    $('#loader').empty();
    for (var i = 0; i < imageArray.length; i++) {
        var img = '<img style="display:none;" src="'+imageArray[i]+'" id=img"'+i+'" wdith="100" />';        
        $("#ajax_content").append(img);
        $('#img'+i).fadeIn();
    }
}); 
```

更新：

```
var img = [];
for (var i = 0; i < imageArray.length; i++) {
    img[i] = '<img style="display:none;" src="'+imageArray[i]+'" id="'+(i+1)+'" width="100"/>';
}
$("#ajax_content").html(img[0]);
$('img#1').fadeIn(); 
```

请注意，如果您的页面的文档类型不是 HTML5，则 ID 必须以字母开头，并注意*字符串文字* `wdith`中的拼写错误应该是`width`.

# asp.net-mvc-3 - Evil DICOM -destination 数组不够长检查 destindex 和长度以及数组的下限

> ID：12118691
> 
> 赞同：0
> 
> 时间：2012-08-25T02:34:44.643
> 
> 标签：asp.net-mvc-3, dicom, evil-dicom

我正在使用 EVIL DICOM 图像阅读器，它适用于某些文件，但某些文件给我这个错误：目标数组不够长检查 destindex 和长度以及数组的下限我找不到我购买的原始网站该程序。将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T16:53:30.153

通过查看 Evil DICOM 代码（版本 0.5.7），我假设您正在以`ImageMatrix`未完全计划好的方式使用构造函数。

您所指的构造函数采用一组 DICOM 图像文件，其中每个图像的大小应该对于所有图像都是相同的。

在构造时，`Image`数组属性的大小等于一个图像的大小乘以私有方法中的 DICOM 图像数组的长度`IntializeMatrix`。

接下来，构造函数遍历所有图像文件，并将每个文件中的像素数据插入到方法中的`Image`属性中`AppendImageToMatrix`。复制的像素数据在 DICOM 文件中的起始位置`Image`由 DICOM 文件确定`ImageNumber`。

如果`ImageNumber`相对于数组的大小太高，则将`Image`像素数据复制到`Image`数组中的位置 0。

**然而！**如果起始位置*等于*`Image`数组的长度，如果`ImageNumber`恰好比文件数大一，就会发生这种情况，起始位置不会被修改，并且会尝试写入不存在的位置数组`Image`！

发生这种情况的行是 中的第四行`AppendImageToMatrix`，内容如下：

```
if (offset > Image.Length) { offset = 0; } 
```

如果您自己构建库，您可能希望将运算符更改为`>`运算`>=`符，那么应用程序至少不会抛出。或者，您可以考虑对像素数据复制进行更安全的处理。不过，这里没有详细说明的空间:-)

我无法立即在[Evil DICOM](https://github.com/rexcardan/Evil-DICOM)`ImageMatrix`的更新版本中找到该课程。但是，如果您在使用旧代码或新代码时遇到问题，请考虑在 Evil DICOM Github 存储库的“问题”[选项卡上报告这些问题。](https://github.com/rexcardan/Evil-DICOM/issues)

**更新**请注意，该`ImageNumber`属性等于 DICOM 属性*Instance Number*，标记 (0020,0013)。

# python - 从字典中删除带有空字符串的键的有效方法

> ID：12118695
> 
> 赞同：137
> 
> 时间：2012-08-25T02:35:11.740
> 
> 标签：python, dictionary

我有一个字典，想删除所有有空值字符串的键。

```
metadata = {u'Composite:PreviewImage': u'(Binary data 101973 bytes)',
            u'EXIF:CFAPattern2': u''} 
```

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2012-08-25T02:36:42.863

蟒蛇2.X

```
dict((k, v) for k, v in metadata.iteritems() if v) 
```

* * *

Python 2.7 - 3.X

```
{k: v for k, v in metadata.items() if v} 
```

请注意，您的所有键都有值。只是其中一些值是空字符串。没有值的字典中没有键之类的东西；如果它没有价值，它就不会在字典中。

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2014-01-31T14:07:19.483

它甚至可以比[BrenBarn 的解决方案](https://stackoverflow.com/a/12118700/1641609)更短（我认为更具可读性）

```
{k: v for k, v in metadata.items() if v} 
```

使用 Python 2.7.3 测试。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-08-25T03:09:03.010

如果确实需要修改原字典：

```
empty_keys = [k for k,v in metadata.iteritems() if not v]
for k in empty_keys:
    del metadata[k] 
```

请注意，我们必须创建一个空键列表，因为我们无法在迭代字典时修改它（您可能已经注意到）。但是，这比创建一个全新的字典要便宜（在内存方面），除非有很多具有空值的条目。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2016-02-08T05:09:47.353

如果您想要一种功能齐全但简洁的方法来处理经常嵌套甚至可以包含循环的实际数据结构，我建议您查看[Boltons 实用程序包中的 remap 实用程序](http://boltons.readthedocs.org/en/latest/iterutils.html#nested)。

在`pip install boltons`或将[iterutils.py](https://github.com/mahmoud/boltons/blob/master/boltons/iterutils.py)复制到您的项目之后，只需执行以下操作：

```
from boltons.iterutils import remap

drop_falsey = lambda path, key, value: bool(value)
clean = remap(metadata, visit=drop_falsey) 
```

[此页面](http://sedimental.org/remap.html)有更多示例，包括使用 Github API 中更大的对象的示例。

它是纯 Python，因此可以在任何地方使用，并且在 Python 2.7 和 3.3+ 中经过全面测试。[最重要的是，我是为这样的情况写的，所以如果你发现它不能处理的情况，你可以让我在这里](https://github.com/mahmoud/boltons/issues)修复它。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2014-07-22T16:51:59.367

根据[Ryan 的解决方案](https://stackoverflow.com/a/24688773/394647)，如果您还有列表和嵌套字典：

对于 Python 2：

```
def remove_empty_from_dict(d):
    if type(d) is dict:
        return dict((k, remove_empty_from_dict(v)) for k, v in d.iteritems() if v and remove_empty_from_dict(v))
    elif type(d) is list:
        return [remove_empty_from_dict(v) for v in d if v and remove_empty_from_dict(v)]
    else:
        return d 
```

对于 Python 3：

```
def remove_empty_from_dict(d):
    if type(d) is dict:
        return dict((k, remove_empty_from_dict(v)) for k, v in d.items() if v and remove_empty_from_dict(v))
    elif type(d) is list:
        return [remove_empty_from_dict(v) for v in d if v and remove_empty_from_dict(v)]
    else:
        return d 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2012-08-25T03:00:14.600

[BrenBarn 的解决方案](https://stackoverflow.com/a/12118700/1142167)是理想的（我可能会补充说 Pythonic）。但是，这是另一个（fp）解决方案：

```
from operator import itemgetter
dict(filter(itemgetter(1), metadata.items())) 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-07-11T01:16:45.567

如果您有一个嵌套字典，并且您希望它甚至适用于空子元素，您可以使用 BrenBarn 建议的递归变体：

```
def scrub_dict(d):
    if type(d) is dict:
        return dict((k, scrub_dict(v)) for k, v in d.iteritems() if v and scrub_dict(v))
    else:
        return d 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2017-01-30T14:28:06.370

对于蟒蛇 3

```
dict((k, v) for k, v in metadata.items() if v) 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2015-10-31T19:29:37.567

## 快速回答 (TL;DR)

### Example01

```
### example01 -------------------

mydict  =   { "alpha":0,
              "bravo":"0",
              "charlie":"three",
              "delta":[],
              "echo":False,
              "foxy":"False",
              "golf":"",
              "hotel":"   ",                        
            }
newdict =   dict([(vkey, vdata) for vkey, vdata in mydict.iteritems() if(vdata) ])
print newdict

### result01 -------------------
result01 ='''
{'foxy': 'False', 'charlie': 'three', 'bravo': '0'}
''' 
```

## 详细解答

### 问题

*   **上下文：** Python 2.x
*   **场景：**开发人员希望修改字典以排除空白值
    *   又名从字典中删除空值
    *   又名删除具有空白值的键
    *   又名过滤字典，用于每个键值对上的非空值

### 解决方案

*   example01 使用带有简单条件的 python 列表理解语法来删除“空”值

### 陷阱

*   example01 只对原始字典的副本进行操作（不就地修改）
*   example01 可能会产生意想不到的结果，具体取决于开发人员所说的“空”的含义
    *   开发人员的意思是保留虚假的值[吗](https://stackoverflow.com/a/9573259/42223)？
    *   如果字典中的值不保证是字符串，开发人员可能会出现意外的数据丢失。
    *   result01 显示原始集合中仅保留了三个键值对

### 替代示例

*   example02 帮助处理潜在的陷阱
*   方法是通过更改条件来使用更精确的“空”定义。
*   在这里，我们只想过滤掉评估为空白字符串的值。
*   在这里，我们还使用 .strip() 过滤掉仅包含空格的值。

### Example02

```
### example02 -------------------

mydict  =   { "alpha":0,
              "bravo":"0",
              "charlie":"three",
              "delta":[],
              "echo":False,
              "foxy":"False",
              "golf":"",
              "hotel":"   ",
            }
newdict =   dict([(vkey, vdata) for vkey, vdata in mydict.iteritems() if(str(vdata).strip()) ])
print newdict

### result02 -------------------
result02 ='''
{'alpha': 0,
  'bravo': '0', 
  'charlie': 'three', 
  'delta': [],
  'echo': False,
  'foxy': 'False'
  }
''' 
```

### 也可以看看

*   [列表理解](https://en.wikipedia.org/w/index.php?title=Python_syntax_and_semantics&oldid=684110148#List_comprehensions)
*   [假的](https://stackoverflow.com/a/9573259/42223)
*   [检查空字符串](https://stackoverflow.com/questions/9573244/)
*   [原地修改原词典](https://stackoverflow.com/a/12118839/42223)
*   [字典推导](https://stackoverflow.com/a/21482035/42223)
*   [检查空字符串的陷阱](https://stackoverflow.com/a/9573278/42223)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-11-16T14:55:22.447

基于[patriciasz](https://stackoverflow.com/a/21482035/3381305)和[nneonneo](https://stackoverflow.com/a/12118839/3381305)的答案，并考虑到您可能想要删除仅具有某些虚假内容（例如`''`）但没有其他内容（例如）的密钥的可能性`0`，或者您甚至可能想要包含一些真实的事情（例如`'SPAM'`） ，那么您可以制作一个高度具体的命中列表：

```
unwanted = ['', u'', None, False, [], 'SPAM'] 
```

不幸的是，这并不完全有效，因为例如`0 in unwanted`评估为`True`. 我们需要区分`0`和其他虚假的东西，所以我们必须使用`is`：

```
any([0 is i for i in unwanted]) 
```

...评估为`False`.

现在将它用于`del`不需要的东西：

```
unwanted_keys = [k for k, v in metadata.items() if any([v is i for i in unwanted])]
for k in unwanted_keys: del metadata[k] 
```

如果您想要一个新字典，而不是`metadata`就地修改：

```
newdict = {k: v for k, v in metadata.items() if not any([v is i for i in unwanted])} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-03-26T18:12:33.913

我阅读了这个线程中的所有回复，有些回复也提到了这个线程： [Remove empty dicts in nested dictionary with recursive function](https://stackoverflow.com/questions/33529312/remove-empty-dicts-in-nested-dictionary-with-recursive-function)

我最初在这里使用了解决方案，效果很好：

**尝试 1：太热（性能不佳或面向未来）**：

```
def scrub_dict(d):
    if type(d) is dict:
        return dict((k, scrub_dict(v)) for k, v in d.iteritems() if v and scrub_dict(v))
    else:
        return d 
```

但是在 Python 2.7 世界中提出了一些性能和兼容性问题：

1.  使用`isinstance`而不是`type`
2.  将列表组合展开到`for`循环中以提高效率
3.  使用 python3 安全`items`而不是`iteritems`

**尝试 2：太冷（缺乏记忆）**：

```
def scrub_dict(d):
    new_dict = {}
    for k, v in d.items():
        if isinstance(v,dict):
            v = scrub_dict(v)
        if not v in (u'', None, {}):
            new_dict[k] = v
    return new_dict 
```

哦！这不是递归的，根本不是记忆。

**尝试 3：恰到好处（到目前为止）**：

```
def scrub_dict(d):
    new_dict = {}
    for k, v in d.items():
        if isinstance(v,dict):
            v = scrub_dict(v)
        if not v in (u'', None, {}):
            new_dict[k] = v
    return new_dict 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-01-29T01:53:08.710

# 字典与数组混合

*   尝试 3的答案： [BlissRage 的答案](https://stackoverflow.com/a/49497994/433814)中的**Just Right（到目前为止）**没有正确处理数组元素。我包括一个补丁，以防有人需要它。该方法是带有语句块的句柄列表，它使用原始实现擦洗列表。`if isinstance(v, list):``scrub_dict(d)`

```
 @staticmethod
    def scrub_dict(d):
        new_dict = {}
        for k, v in d.items():
            if isinstance(v, dict):
                v = scrub_dict(v)
            if isinstance(v, list):
                v = scrub_list(v)
            if not v in (u'', None, {}, []):
                new_dict[k] = v
        return new_dict

    @staticmethod
    def scrub_list(d):
        scrubbed_list = []
        for i in d:
            if isinstance(i, dict):
                i = scrub_dict(i)
            scrubbed_list.append(i)
        return scrubbed_list 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-07-22T10:04:25.897

“由于我目前还为我的 Python 工作编写了一个桌面应用程序，我在数据输入应用程序中发现有很多条目并且其中一些不是强制性的，因此用户可以将其留空，用于验证目的，很容易抓取所有条目，然后丢弃字典的空键或值。所以我上面的代码展示了我们如何轻松取出它们，使用字典理解并保持字典值元素不为空。我使用 Python 3.8.3

```
data = {'':'', '20':'', '50':'', '100':'1.1', '200':'1.2'}

dic = {key:value for key,value in data.items() if value != ''}

print(dic)

{'100': '1.1', '200': '1.2'} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-03-18T15:15:51.907

要保留 0 和 False 值但摆脱空值，您可以使用：

```
{k: v for k, v in metadata.items() if v or v == 0 or v is False} 
```

对于具有混合类型值的嵌套字典，您可以使用：

```
def remove_empty_from_dict(d):
  if isinstance(d, dict):
    return dict((k, remove_empty_from_dict(v)) for k, v in d.items() \
            if v or v == 0 or v is False and remove_empty_from_dict(v) is not None)
  elif isinstance(d, list):
    return [remove_empty_from_dict(v) for v in d 
            if v or v == 0 or v is False and remove_empty_from_dict(v) is not None]
  else:
    if d or d == 0 or d is False:
      return d 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-02-26T19:09:21.937

您可以这样做的另一种方法是使用字典理解。这应该兼容`2.7+`

```
result = {
    key: value for key, value in
    {"foo": "bar", "lorem": None}.items()
    if value
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-07-20T21:55:04.253

如果您正在使用，这是一个选项`pandas`：

```
import pandas as pd

d = dict.fromkeys(['a', 'b', 'c', 'd'])
d['b'] = 'not null'
d['c'] = ''  # empty string

print(d)

# convert `dict` to `Series` and replace any blank strings with `None`;
# use the `.dropna()` method and
# then convert back to a `dict`
d_ = pd.Series(d).replace('', None).dropna().to_dict()

print(d_) 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-02-07T16:02:47.887

上面提到的一些方法会忽略是否有任何整数和浮点数，值为 0 和 0.0

如果有人想避免上述情况，可以使用以下代码（从嵌套字典和嵌套列表中删除空字符串和 None 值）：

```
def remove_empty_from_dict(d):
    if type(d) is dict:
        _temp = {}
        for k,v in d.items():
            if v == None or v == "":
                pass
            elif type(v) is int or type(v) is float:
                _temp[k] = remove_empty_from_dict(v)
            elif (v or remove_empty_from_dict(v)):
                _temp[k] = remove_empty_from_dict(v)
        return _temp
    elif type(d) is list:
        return [remove_empty_from_dict(v) for v in d if( (str(v).strip() or str(remove_empty_from_dict(v)).strip()) and (v != None or remove_empty_from_dict(v) != None))]
    else:
        return d 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-04-23T23:27:34.730

```
metadata ={'src':'1921','dest':'1337','email':'','movile':''}
ot = {k: v for k, v in metadata.items() if v != ''}
print(f"Final {ot}") 
```

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2017-03-09T16:56:59.200

# 一些基准测试：

## 1.列表理解重新创建dict

```
In [7]: %%timeit dic = {str(i):i for i in xrange(10)}; dic['10'] = None; dic['5'] = None
   ...: dic = {k: v for k, v in dic.items() if v is not None} 
   1000000 loops, best of 7: 375 ns per loop 
```

## 2\. 列表理解使用 dict() 重新创建 dict

```
In [8]: %%timeit dic = {str(i):i for i in xrange(10)}; dic['10'] = None; dic['5'] = None
   ...: dic = dict((k, v) for k, v in dic.items() if v is not None)
1000000 loops, best of 7: 681 ns per loop 
```

## 3\. 如果 v 为 None，则循环并删除键

```
In [10]: %%timeit dic = {str(i):i for i in xrange(10)}; dic['10'] = None; dic['5'] = None
    ...: for k, v in dic.items():
    ...:   if v is None:
    ...:     del dic[k]
    ...: 
10000000 loops, best of 7: 160 ns per loop 
```

所以循环和删除在 160ns 时最快，列表理解在 ~375ns 时慢`dict()`一半，调用 to 又是 ~680ns 慢一半。

将 3 包装到一个函数中会使它再次下降到大约 275ns。同样对我来说，PyPy 的速度大约是 neet python 的两倍。

# actionscript-3 - 如何让对象在特定半径内来回悬停？

> ID：12118701
> 
> 赞同：1
> 
> 时间：2012-08-25T02:36:50.287
> 
> 标签：actionscript-3, flash, math, trigonometry, flash-cs6

我在电影符号中有一个精灵，我想在 360 半径范围内来回悬停。我希望让它变得流畅和随机。从来没有真正从它原来的 xy 坐标冒险。

我试图用 if 语句和起始动力创建一些规定。像这样：

```
var num = 2;

stage.addEventListener(Event.ENTER_FRAME, hover);
function hover(evt:Event):void{

      //start it moving
cloudWhite.y += num;
cloudWhite.x += num;

//declare these variables
var cX = cloudWhite.x;
var cY = cloudWhite.y;

//  object travels 10 pixels 
var cXP = cX + 10;
var cXN = cX - 10;
var cYP = cY + 10;
var cYN = cY - 10;

 //  if object goes 10 pixels reverse direction of momentum (maybe)

if (cX >= cXP) {
    num = -2;
}
if (cX <= cXN){
    num = 2;
}
if (cY >= cYP) {
    num = 2;
}
if (cY <= cYN){
    num = 2;
} 
```

显然这是非常错误的，因为当它运行对象时，要么转到 0,0，要么转到只有数学之神知道的某个地方。

我显然是这种数学的菜鸟，所以我很抱歉，但我很高兴能了解这背后的原因。

感谢您的帮助，感谢您的阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T15:02:26.523

您在 ENTER_FRAME 循环内设置所有变量，因此您的条件都不会计算为真。在每一帧上你都这样做：

```
cloudWhite.x += 2;
cX = cloudWhite.x;
cXP = cX + 10; // Must == cloudWhite's previous x + 10 + 2;
cXN = cX - 10; // Must == cloudWite's previous x -10 + 2;
if(cX > cXP)... // Can never be true.
if(cX < cXN)... // Can never be true. 
```

你需要做的是：

1）将cloudWhite的原始位置存储在循环之外的某处，并在循环开始之前存储。

2) 在循环开始之前再次定义相对于 cloudWhite 的原始位置的边界。还要定义每次迭代要改变位置的数量。

3）开始你的循环。

4) 在每次迭代时增加 cloudWhite 的当前位置。如果您希望形状以随机方式移动，请在此处添加一点随机。

5）检查cW的新位置是否在你的范围之外，如果是则调整方向。

下面的示例是粗糙和生涩的，但我不知道你在寻找什么效果。如果您想要在每个方向上更平滑、更长的移动，请考虑使用[Tween](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/fl/transitions/Tween.html?filter_flash=cs5&filter_flashplayer=10.2&filter_air=2.6)类或 Tween 库（例如流行的[Greensock](http://www.greensock.com/tweenlite/)库），而不是手动增加/减少位置。这里有一个有用的讨论：[http ://www.actionscript.org/forums/archive/index.php3/t-163836.html](http://www.actionscript.org/forums/archive/index.php3/t-163836.html)

```
import flash.display.MovieClip;
import flash.events.Event;

// Set up your variables
var original_x:Number = 100; // Original x
var original_y:Number = 100; // Original y
var x_inc:Number = 5; // X Movement
var y_inc:Number = 5; // Y Movenent
var bounds:Number = 50; // Distance from origin allowed
// Doesn't take into account width of object so is distance to nearest point.

// Create an MC to show the bounds:
var display:MovieClip = addChild(new MovieClip()) as MovieClip;
display.graphics.lineStyle(1, 0x0000FF);
display.graphics.beginFill(0x0000FF, 0.5);
display.graphics.drawRect(0-bounds, 0-bounds, bounds * 2, bounds *2);
display.x = original_x;
display.y = original_y;
addChild(display);

// Create our moving mc:
var mc:MovieClip = addChild(new MovieClip()) as MovieClip;
mc.graphics.beginFill(0xFF0000, 1);
mc.graphics.drawCircle(-10, -10, 20);
// Position it:
mc.x = original_x;
mc.y = original_y;
addChild(mc);

// Loop:
function iterate($e:Event = null):void
{
    // Move the mc by a random amount related to x/y inc
    mc.x += (Math.random() * (2 * x_inc))/2;
    mc.y += (Math.random() * (2 * y_inc))/2;
    // If the distance from the origin is greater than bounds:
    if((Math.abs(mc.x - original_x)) > bounds)
    {
        // Reverse the direction of travel:
        x_inc == 5 ? x_inc = -5 : x_inc = 5;
    }
    // Ditto on the y axis:
    if((Math.abs(mc.y - original_y)) > bounds)
    {
        y_inc == 5 ? y_inc = -5 : y_inc = 5;
    }
}
// Start the loop:
addEventListener(Event.ENTER_FRAME, iterate); 
```

这应该让你开始。我确信有许多其他方法可以使用正式触发来做到这一点，但这具有非常简单的好处，并且只是您现有方法的扩展。

# .net - 在多个项目中使用 DI/IoC 的模式

> ID：12118705
> 
> 赞同：3
> 
> 时间：2012-08-25T02:37:29.023
> 
> 标签：.net, dependency-injection, inversion-of-control, ninject

我有一个具有以下项目的解决方案：

*   核心（包含用于处理的类，与业务对象/域无关）
*   域（包含业务对象）
*   线束（控制台应用程序）
*   MVC4 应用程序
*   持久性（包含存储库接口、EF 映射等的实现）
*   存储库（包含存储库接口）
*   测试（包含单元测试）

我想使用 NInject 作为我的 IoC 容器，因为我有使用它的经验，但是我愿意接受更适合我需求的建议。

域对象需要了解存储库，以便他们可以进行数据访问（即，Person 类可能想要检索所有 AddressDetails）。一切都被编码为接口，以帮助单元测试中的模拟。

我不希望域项目依赖于 IoC 容器，但我需要某种方式让域项目中创建的所有实例都注入正确的存储库。我怎样才能做到这一点？我还希望能够在必要时从线束和测试项目中进行注入。我能想到的唯一方法是在 Domain 类中有一个静态对象，该对象包装来自 NInject 的 StandardKernel 并调用它来填充依赖项。如果我可以让构造函数注入工作，我认为它不会使用该方法，那也很好。我能想到的另一种选择是有一个工厂来构建具有正确依赖关系的域对象，但我宁愿能够拥有 IPerson person = new Person() 而不是每次都必须调用工厂。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T08:25:03.410

> 域对象需要了解存储库，以便他们可以进行数据访问（即，Person 类可能想要检索所有 AddressDetails）。一切都被编码为接口，以帮助单元测试中的模拟。

域对象是内存中的对象和持久的无知，因此它不需要知道任何存储库。如果使用 ORM，AddressDetails 应该是延迟加载的，或者应该在 Person 实体之外分配。

因此，通过这种方式，无需将域实体放入 IoC 容器中。请注意，不要*过度使用*IoC Container，考虑一下应该放入哪些类型。如果所有东西都放入 IoC Container 中，那将是*杂乱无章*的类型池。

应该放入 IoC 的适当类是每一层的主要类，例如：

1.  服务。
2.  存储库。
3.  甲骨文。
4.  控制器。
5.  横切关注点：日志、缓存...

不应放入其他内存中的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T09:25:50.947

听起来您应该将[Composition Root](http://blog.ploeh.dk/2011/07/28/CompositionRoot.aspx)引入 MVC4 项目和控制台应用程序。因此，所有依赖项将仅在整个生产代码中耦合。您也可以定义自己的实现`StandardKernel`，或使用自动发现来查找所有实现。

有两个示例如何实现`composition root` [重载`StandartKernel`](https://github.com/ninject/ninject.web.mvc/blob/master/README.markdown)和[自动发现](https://github.com/ninject/ninject.web.mvc/tree/master/mvc3/src/SampleApplication)，`ninject.web.mvc`这可能是有用的起点。`Composition root`对于控制台应用程序通常有简单的实现。

对于测试项目，您可以使用[`ninject.mockingkernel`适当的模拟库](https://github.com/ninject/ninject.mockingkernel)，或者自己构建所有依赖项。对于纯单元测试，第二个选项应该很明显，但对于集成测试，第一个更合适。

领域对象的注入

*   首先有几种众所周知的注入方法：

    *   通过构造函数，
    *   财产，
    *   方法
    *   语境。

    例如，只为域对象实现一个非默认构造函数，它定义了该对象的所有必需依赖项。如果它依赖于存储库，请在域对象的构造函数中指定它，并且没有其他方法可以创建这个特定的域对象而不指定它。

*   其次，这样做可以避免对任何依赖注入库的依赖

# asp.net-mvc - 在模型中构建一个下拉列表？

> ID：12118706
> 
> 赞同：0
> 
> 时间：2012-08-25T02:37:36.793
> 
> 标签：asp.net-mvc, asp.net-mvc-3, html.dropdownlistfor

我有一个服务层，它公开了一个方法，它返回一个名为 GetStates 的列表。

```
public List<StateObject> GetStates() 
```

我的状态对象只是我创建的自定义对象：

```
public class StateObject
{
    public int stateId { get; set; }
    public string description { get; set; }
    public Boolean isDefault { get; set; }
} 
```

在我的模型中，我正在尝试创建一个模型，用于显示和修改任务屏幕。这将用于处理下拉框的显示和选择，这将提供可用于我的任务的状态列表。所以，我的模型看起来像这样（删除了我们不关心的属性 - 它比这个大一点：

```
public class TaskModifyModel
{
    public int stateId { get; set; }
    public string state { get; set; }

    public SelectList states { get; private set; }

    public TaskModifyModel()
    {

        states = new SelectList(
            (new ReferenceService().GetStates()),
            "stateId",
            "description",
            1);

    }
} 
```

所以，stateId 保存选中状态，state 保存选中状态的文本描述。在构造函数中，我试图为视图创建一个 states SelectList ... 并填充它。

在视图中，我尝试显示下拉列表：

```
@Html.DropDownListFor(m=>m.stateId, new SelectList(Model.states, "stateId", "description", Model.priorityId)) 
```

这是失败的，令人沮丧。

**DataBinding：“System.Web.Mvc.SelectListItem”不包含名为“stateId”的属性。**

我已经搜索过了，我认为我这样做是正确的，但是错误说我不是……很清楚。:) 有人可以指导我为什么它不起作用，而且，这是做事的正确方法吗？

编辑：在下面的帮助之后，它现在可以工作了。如果我正在创建一个新任务（taskId==0），那么我必须获取存储在我的数据库中的下拉列表的默认值......那么，这干净吗？这是我的对象的工作构造函数：

公共 TaskModifyModel() { var referenceService = new ReferenceService(); var p = referenceService.GetPriorities(); var s = referenceService.GetStates();

```
 var defaultP = (from a in p where a.isDefault select a).FirstOrDefault();
    var defaultS = (from a in s where a.isDefault select a).FirstOrDefault();

    priorities = new SelectList(
        (p),
        "priorityId",
        "description"
        );
    priorityId = taskId == 0 ? defaultP.priorityId : priorityId;

    states = new SelectList(
        s,
        "stateId",
        "description");
    stateId = taskId == 0 ? defaultS.stateId : stateId;

} 
```

可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T02:43:48.040

你`public SelectList states { get; private set; }`已经是一个 SelectList，所以你不需要在你的视图中再次投射它。

试试这个：

```
@Html.DropDownListFor(m=>m.stateId, Model.states) 
```

在您的 ViewModel 中，删除参数“SelectedValue”。@Html.DropDownListFor 会将下拉列表初始化为正确的值。

```
public class TaskModifyModel
{
    public int stateId { get; set; }
    public string state { get; set; }

    public SelectList states { get; private set; }

    public TaskModifyModel()
    {

        states = new SelectList(
            (new ReferenceService().GetStates()),
            "stateId",
            "description");
    }
} 
```

# c++ - 在俄罗斯方块游戏 C++ Visual 2008 中调用对象方法的箭头键

> ID：12118708
> 
> 赞同：0
> 
> 时间：2012-08-25T02:38:33.343
> 
> 标签：c++, visual-studio-2008, keydown, tetris

我试图使用箭头键来左右移动俄罗斯方块块并旋转，但是当块落下gameGrid时它不起作用。这是我的代码。

//这是我在计时器处理程序中的游戏周期

```
private: System::Void timer1_Tick(System::Object^  sender, System::EventArgs^  e) 
         {  

            mainGameBoard->drawGrid();
            newBlock->draw();
            newBlock->moveDown();

            if(newBlock->canMoveDown()==false)
            {
                                //If block hits bottom or block, add block to grid
                newBlock->addMySelfToGameBoard();

                                //Update the grid by deleting full rows & move
                                //the game grid down
                mainGameBoard->updateGrid();

                                //Create new block
                                //Havnt sorted yet

            }

         } 
```

这是我使用箭头键移动和旋转块的代码，移动方法和旋转方法在​​ TTetrisBlock 类中。

```
private: System::Void Form1_KeyDown(System::Object^  sender, System::Windows::Forms::KeyEventArgs^  e) 
             {
                 if(e->KeyData == Keys::Left)
                 {
                     newBlock->moveLeft();
                 }

                 if(e->KeyData == Keys::Right)
                 {
                     newBlock->moveRight();
                 }

                 if(e->KeyData == Keys::Up)
                 {
                     newBlock->rotate();
                 }

             } 
```

//现在，当块在计时器上沿游戏网格向下移动时，按下箭头键时不会移动对象。但是如果我将 newBlock->moveLeft() 放入计时器中，该块将开始向左移动。所以我的 moveLeft() 方法正在工作。请帮忙 - 我是一名学习 C++ 的学生。这是我的 moveLeft() 方法：

```
void TTetrisBlock::moveLeft()
{
    array<Point>^ temporaryCopy = gcnew array<Point>(4);

    for(int i=0;i<mySquares->Length;i++)
    {
        //Set future move
        temporaryCopy[i].X = mySquares[i].X-1;
        temporaryCopy[i].Y = mySquares[i].Y;
    }

    if(checkBounds(temporaryCopy) == true)
    {
        for(int i=0;i<temporaryCopy->Length;i++)
        {
            mySquares[i].X = temporaryCopy[i].X;
            mySquares[i].Y = temporaryCopy[i].Y;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T03:39:35.560

Form1_KeyDown 是否注册为表单的回调？这样做检查：

```
private: System::Void Form1_KeyDown(System::Object^  sender, System::Windows::Forms::KeyEventArgs^  e) 
             {
                 System::Console::WriteLine(S"KeyDown is working");

             } 
```

# php - 配置 exim 的外发电子邮件地址

> ID：12118712
> 
> 赞同：1
> 
> 时间：2012-08-25T02:39:58.887
> 
> 标签：php, email, debian, exim4

我忘了我是怎么设置的。我有两个网站，我通过第二个网站发送电子邮件。这是我的`/etc/exim4/passwd.client`文件：

```
*.google.com:noreplyn@firstsite.com:password
*.google.com:noreply@secondsite.com:password 
```

我正在通过 PHP 的`mail()`函数发送带有以下标题的邮件：

```
$headers = 'From: no-reply <noreply@secondsite.com>' . "\r\n";
$headers .= 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Reply-To: noreply@secondsite.com' . "\r\n";
$headers .= 'Content-type: text/html; charset=utf-8' . "\r\n"; 
```

但是我在客户的电子邮件中收到了这个标题：

```
from:    no-reply firstsite.com
reply-to:    secondsite.com
to:  apathetic012@gmail.com 
```

如何正确设置 exim 的自定义外发电子邮件地址？

> PS：我正在使用智能主机（谷歌应用程序）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T13:47:24.773

设置你的信封`From`。

```
mail($recipient, $subject, $body, $headers, '-f noreply@secondsite.com'); 
```

# android - 如何在 Android 中“释放”意图？

> ID：12118714
> 
> 赞同：0
> 
> 时间：2012-08-25T02:40:43.687
> 
> 标签：android, android-intent, nfc, android-pendingintent

我的 Android 应用程序中有两个处理 NFC 的活动。一个在 中声明`IntentFilter`，而另一个在使用和`AndroidManifest.xml`处于活动状态时只接受 NFC 动作。但是，有时在后一项活动中，我实际上想将 NFC 动作传递给前者。如何在不丢失任何 NFC 信息的情况下将 Intent“释放”到不同的活动？`PendingIntent``onNewIntent();`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:07:30.987

使用`startActivity(Intent intent)`但不是`Intent`使用特定形式（显式 Intent）创建，而是在其清单部分（隐式 Intent ）中添加第一个设置为做出反应`MyActivity.class`的动作/类别。`Activity``<intent-filter>`

# ada - 学习Ada：源码和新手“论坛”？

> ID：12118715
> 
> 赞同：6
> 
> 时间：2012-08-25T02:40:53.067
> 
> 标签：ada

我一直在阅读有关 Ada 的文章，它看起来是一门很棒且成熟的语言。但是，尽管它的历史和实际使用（甚至是一个相当不错的 IDE！），它并不是很“互联网流行”。所以我现在正在寻找资源，因为谷歌不再为我做太多了。wikibook 的范围很广，但非常简洁，我发现很难理解。我已经在亚马逊上查看了书籍场景，我确信有几个不错的，但它们通常更旧而且相当昂贵，所以我还没有冒险。

Rosetta Code Ada 示例很有帮助，但我肯定会欣赏介于两者之间的东西和像 GNAT 这样的大东西。

如果它存在，我会喜欢一个可以进行一些讨论和问答的地方，欢迎新的 Ada 程序员。（我确信可能有一个 comp.lang.ada 或其他东西，但自从我尝试在 comp.lang.lisp 上向初学者提问后，我往往对用他们觉得不感兴趣的问题来烦扰那些老生常谈的问题持谨慎态度。 )

无论如何，我认为如果有人有建议，问一下也无妨。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T08:52:41.960

不要去*Ada Home*；Ada 社区很想更新它，但所有者不感兴趣。

[Ada Information Clearinghouse](http://www.adaic.org/)，尤其是“学习[资料](http://www.adaic.org/learn/materials/)”部分，是一个好的开始。[“免费在线书籍/课程](http://en.wikibooks.org/wiki/Ada_Programming#Free_online_books.2Fcourses)”中也有类似的信息。我特别喜欢 John English 的书（使用[这个链接](http://faculty.cs.wwu.edu/reedyc/AdaResources/bookhtml/contents.htm)而不是 AdaIC 的那个）。其他人推荐*Ada Distilled*。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-27T18:06:53.093

[实际上，如果您单击了解更多链接，我们自己的](https://stackoverflow.com/tags/ada/info)[ada](/questions/tagged/ada "显示标记为“ada”的问题")标签 wiki上有一个非常好的 Ada 资源列表。

关于它的好处是，通过社区审核的魔力，它永远不会变成一个令人尴尬的蜘蛛网，没有人可以做任何事情，不像我可以提到的一些网站。{*咳嗽*AdaHome*咳嗽*}

社区在 SO 上也有存在，所以也可以在这里提问。

最后我检查了 comp.lang.ada 是真正的编译器编写者和语言设计者以及其他人的聚会场所。在大多数情况下，他们都是非常乐于助人的人，并且可以为奥术派上用场。但有时对于简单的问题，它可能有点像向 Robert Goddard 或 Werner von Braun 询问有关使您的模型火箭飞得更直的技巧。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-25T10:49:11.990

我发现 comp.lang.ada 是该去的地方。很多爱好者，有丰富经验的人（甚至是一些语言设计师），但也不介意帮助新手的人。

在一些 IRC（也许是 freenode？）中也有一个#ada 频道，这可能是快速问答的好地方，尽管我不能以个人经验说。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-06T10:01:37.833

comp.lang.ada 是一个非常好的地方，他们对初学者很好。我从经验中知道。不要害怕问“简单”的问题。

如需更多 Ada 资源，您可以查看[Ada 在丹麦](http://ada-dk.org)维护的[Ada 资源](http://wiki.ada-dk.org/ada_resources)页面。

这是一个新旧混合的集合。你可能会发现一些有用的东西。:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-25T13:54:10.833

我支持 comp.lang.ada 的推荐，它对新手非常友好——除非你是一名学生，试图让成员为你做作业。

如果您是[LinkedIn](http://www.linkedin.com/)会员，那里有一些 Ada 组。

[Ada sub-reddit](http://www.reddit.com/r/ada)是一个发布新闻、公告、问题等链接的网站（我是那里的版主）。

而且，不言而喻，StackOverflow 也是[Ada 问题](https://stackoverflow.com/questions/tagged/ada)的好地方。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-25T03:05:09.030

IMO，Ada 是一种（不值得！）从未得到足够爱的语言。

查看[http://www.adahome.com/](http://www.adahome.com/)。它看起来令人尴尬地过时了......但您可能会在浏览时偶然发现一两个有用的资源。

不太老式（但可能仍然不是很有用），请查看 Ada Clearinghouse： http: [//www.adaic.org/](http://www.adaic.org/)

坦率地说，我不知道有任何重要的“Ada 社区”。我惊讶地发现 Ada 仍然在 TIOBE 索引上的“前 20 名”编程语言中：

*   [http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)

# python - Python：tf-idf-cosine：查找文档相似度

> ID：12118720
> 
> 赞同：107
> 
> 时间：2012-08-25T02:41:26.323
> 
> 标签：python, machine-learning, nltk, information-retrieval, tf-idf

我正在关注[第 1](http://blog.christianperone.com/?p=1589)部分和[第 2](http://blog.christianperone.com/?p=1747)部分中提供的教程。不幸的是，作者没有时间在最后一节中使用余弦相似度来实际找到两个文档之间的距离。[我在stackoverflow](https://stackoverflow.com/questions/11911469/tfidf-for-search-queries)的以下链接的帮助下遵循了文章中的示例，包括上面链接中提到的代码（只是为了让生活更轻松）

```
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.feature_extraction.text import TfidfTransformer
from nltk.corpus import stopwords
import numpy as np
import numpy.linalg as LA

train_set = ["The sky is blue.", "The sun is bright."]  # Documents
test_set = ["The sun in the sky is bright."]  # Query
stopWords = stopwords.words('english')

vectorizer = CountVectorizer(stop_words = stopWords)
#print vectorizer
transformer = TfidfTransformer()
#print transformer

trainVectorizerArray = vectorizer.fit_transform(train_set).toarray()
testVectorizerArray = vectorizer.transform(test_set).toarray()
print 'Fit Vectorizer to train set', trainVectorizerArray
print 'Transform Vectorizer to test set', testVectorizerArray

transformer.fit(trainVectorizerArray)
print
print transformer.transform(trainVectorizerArray).toarray()

transformer.fit(testVectorizerArray)
print 
tfidf = transformer.transform(testVectorizerArray)
print tfidf.todense() 
```

由于上面的代码，我有以下矩阵

```
Fit Vectorizer to train set [[1 0 1 0]
 [0 1 0 1]]
Transform Vectorizer to test set [[0 1 1 1]]

[[ 0.70710678  0\.          0.70710678  0\.        ]
 [ 0\.          0.70710678  0\.          0.70710678]]

[[ 0\.          0.57735027  0.57735027  0.57735027]] 
```

我不确定如何使用此输出来计算余弦相似度，我知道如何针对两个长度相似的向量实现余弦相似度，但在这里我不确定如何识别这两个向量。

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2012-08-26T08:45:15.370

首先，如果您想提取计数特征并应用 TF-IDF 归一化和逐行欧几里得归一化，您可以通过以下操作在一个操作中完成`TfidfVectorizer`：

```
>>> from sklearn.feature_extraction.text import TfidfVectorizer
>>> from sklearn.datasets import fetch_20newsgroups
>>> twenty = fetch_20newsgroups()

>>> tfidf = TfidfVectorizer().fit_transform(twenty.data)
>>> tfidf
<11314x130088 sparse matrix of type '<type 'numpy.float64'>'
    with 1787553 stored elements in Compressed Sparse Row format> 
```

现在要找到一个文档（例如数据集中的第一个文档）和所有其他文档的余弦距离，您只需要计算第一个向量与所有其他文档的点积，因为 tfidf 向量已经被行归一化。

正如 Chris Clark 在评论中所解释的，[这里](https://github.com/taki0112/Vector_Similarity)的余弦相似度没有考虑向量的大小。行归一化的大小为 1，因此线性内核足以计算相似度值。

scipy 稀疏矩阵 API 有点奇怪（不如密集的 N 维 numpy 数组灵活）。要获得第一个向量，您需要按行对矩阵进行切片以获得具有单行的子矩阵：

```
>>> tfidf[0:1]
<1x130088 sparse matrix of type '<type 'numpy.float64'>'
    with 89 stored elements in Compressed Sparse Row format> 
```

scikit-learn 已经提供了成对度量（机器学习用语中的内核），适用于向量集合的密集和稀疏表示。在这种情况下，我们需要一个点积，也称为线性核：

```
>>> from sklearn.metrics.pairwise import linear_kernel
>>> cosine_similarities = linear_kernel(tfidf[0:1], tfidf).flatten()
>>> cosine_similarities
array([ 1\.        ,  0.04405952,  0.11016969, ...,  0.04433602,
    0.04457106,  0.03293218]) 
```

因此，要找到前 5 个相关文档，我们可以使用`argsort`和一些负数组切片（大多数相关文档具有最高的余弦相似度值，因此在排序索引数组的末尾）：

```
>>> related_docs_indices = cosine_similarities.argsort()[:-5:-1]
>>> related_docs_indices
array([    0,   958, 10576,  3277])
>>> cosine_similarities[related_docs_indices]
array([ 1\.        ,  0.54967926,  0.32902194,  0.2825788 ]) 
```

第一个结果是完整性检查：我们发现查询文档是最相似的文档，余弦相似度得分为 1，其文本如下：

```
>>> print twenty.data[0]
From: lerxst@wam.umd.edu (where's my thing)
Subject: WHAT car is this!?
Nntp-Posting-Host: rac3.wam.umd.edu
Organization: University of Maryland, College Park
Lines: 15

 I was wondering if anyone out there could enlighten me on this car I saw
the other day. It was a 2-door sports car, looked to be from the late 60s/
early 70s. It was called a Bricklin. The doors were really small. In addition,
the front bumper was separate from the rest of the body. This is
all I know. If anyone can tellme a model name, engine specs, years
of production, where this car is made, history, or whatever info you
have on this funky looking car, please e-mail.

Thanks,
- IL
   ---- brought to you by your neighborhood Lerxst ---- 
```

第二个最相似的文档是引用原始消息的回复，因此有许多常用词：

```
>>> print twenty.data[958]
From: rseymour@reed.edu (Robert Seymour)
Subject: Re: WHAT car is this!?
Article-I.D.: reed.1993Apr21.032905.29286
Reply-To: rseymour@reed.edu
Organization: Reed College, Portland, OR
Lines: 26

In article <1993Apr20.174246.14375@wam.umd.edu> lerxst@wam.umd.edu (where's my
thing) writes:
>
>  I was wondering if anyone out there could enlighten me on this car I saw
> the other day. It was a 2-door sports car, looked to be from the late 60s/
> early 70s. It was called a Bricklin. The doors were really small. In
addition,
> the front bumper was separate from the rest of the body. This is
> all I know. If anyone can tellme a model name, engine specs, years
> of production, where this car is made, history, or whatever info you
> have on this funky looking car, please e-mail.

Bricklins were manufactured in the 70s with engines from Ford. They are rather
odd looking with the encased front bumper. There aren't a lot of them around,
but Hemmings (Motor News) ususally has ten or so listed. Basically, they are a
performance Ford with new styling slapped on top.

>    ---- brought to you by your neighborhood Lerxst ----

Rush fan?

--
Robert Seymour              rseymour@reed.edu
Physics and Philosophy, Reed College    (NeXTmail accepted)
Artificial Life Project         Reed College
Reed Solar Energy Project (SolTrain)    Portland, OR 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-08-25T19:27:53.153

在@excray 评论的帮助下，我设法找出答案，我们需要做的实际上是编写一个简单的 for 循环来遍历代表训练数据和测试数据的两个数组。

首先实现一个简单的 lambda 函数来保存余弦计算公式：

```
cosine_function = lambda a, b : round(np.inner(a, b)/(LA.norm(a)*LA.norm(b)), 3) 
```

然后只需编写一个简单的 for 循环来迭代 to 向量，逻辑是针对每个“对于 trainVectorizerArray 中的每个向量，您必须找到与 testVectorizerArray 中的向量的余弦相似度。”

```
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.feature_extraction.text import TfidfTransformer
from nltk.corpus import stopwords
import numpy as np
import numpy.linalg as LA

train_set = ["The sky is blue.", "The sun is bright."] #Documents
test_set = ["The sun in the sky is bright."] #Query
stopWords = stopwords.words('english')

vectorizer = CountVectorizer(stop_words = stopWords)
#print vectorizer
transformer = TfidfTransformer()
#print transformer

trainVectorizerArray = vectorizer.fit_transform(train_set).toarray()
testVectorizerArray = vectorizer.transform(test_set).toarray()
print 'Fit Vectorizer to train set', trainVectorizerArray
print 'Transform Vectorizer to test set', testVectorizerArray
cx = lambda a, b : round(np.inner(a, b)/(LA.norm(a)*LA.norm(b)), 3)

for vector in trainVectorizerArray:
    print vector
    for testV in testVectorizerArray:
        print testV
        cosine = cx(vector, testV)
        print cosine

transformer.fit(trainVectorizerArray)
print
print transformer.transform(trainVectorizerArray).toarray()

transformer.fit(testVectorizerArray)
print 
tfidf = transformer.transform(testVectorizerArray)
print tfidf.todense() 
```

这是输出：

```
Fit Vectorizer to train set [[1 0 1 0]
 [0 1 0 1]]
Transform Vectorizer to test set [[0 1 1 1]]
[1 0 1 0]
[0 1 1 1]
0.408
[0 1 0 1]
[0 1 1 1]
0.816

[[ 0.70710678  0\.          0.70710678  0\.        ]
 [ 0\.          0.70710678  0\.          0.70710678]]

[[ 0\.          0.57735027  0.57735027  0.57735027]] 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-09-20T10:48:00.077

我知道它是一个旧帖子。但我尝试了[http://scikit-learn.sourceforge.net/stable/](http://scikit-learn.sourceforge.net/stable/)包。这是我查找余弦相似度的代码。问题是你将如何计算这个包的余弦相似度，这是我的代码

```
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.metrics.pairwise import cosine_similarity
from sklearn.feature_extraction.text import TfidfVectorizer

f = open("/root/Myfolder/scoringDocuments/doc1")
doc1 = str.decode(f.read(), "UTF-8", "ignore")
f = open("/root/Myfolder/scoringDocuments/doc2")
doc2 = str.decode(f.read(), "UTF-8", "ignore")
f = open("/root/Myfolder/scoringDocuments/doc3")
doc3 = str.decode(f.read(), "UTF-8", "ignore")

train_set = ["president of India",doc1, doc2, doc3]

tfidf_vectorizer = TfidfVectorizer()
tfidf_matrix_train = tfidf_vectorizer.fit_transform(train_set)  #finds the tfidf score with normalization
print "cosine scores ==> ",cosine_similarity(tfidf_matrix_train[0:1], tfidf_matrix_train)  #here the first element of tfidf_matrix_train is matched with other three elements 
```

这里假设查询是 train_set 的第一个元素，而 doc1、doc2 和 doc3 是我想借助余弦相似度对文档进行排名。然后我可以使用这段代码。

问题中提供的教程也非常有用。这是它的所有部分 [part-I](http://pyevolve.sourceforge.net/wordpress/?p=1589) , [part-II](http://pyevolve.sourceforge.net/wordpress/?p=1747) , [part-III](http://pyevolve.sourceforge.net/wordpress/?p=2497)

输出如下：

```
[[ 1\.          0.07102631  0.02731343  0.06348799]] 
```

这里 1 表示查询与自身匹配，其他三个是查询与相应文档匹配的分数。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2015-09-09T07:40:58.790

让我再给你一个我写的教程。它回答了你的问题，但也解释了我们为什么要做一些事情。我也试着让它简洁。

所以你有一个`list_of_documents`只是一个字符串数组，另一个`document`只是一个字符串。您需要从`list_of_documents`最相似的文档中找到此类文档`document`。

让我们将它们组合在一起：`documents = list_of_documents + [document]`

让我们从依赖关系开始。很清楚为什么我们使用它们中的每一个。

```
from nltk.corpus import stopwords
import string
from nltk.tokenize import wordpunct_tokenize as tokenize
from nltk.stem.porter import PorterStemmer
from sklearn.feature_extraction.text import TfidfVectorizer
from scipy.spatial.distance import cosine 
```

可以使用的一种方法是[词袋](https://en.wikipedia.org/wiki/Bag-of-words_model)方法，我们将文档中的每个词独立于其他词，然后将它们全部放在一个大袋子中。从一个角度来看，它丢失了很多信息（比如单词是如何连接的），但从另一个角度来看，它使模型变得简单。

在英语和任何其他人类语言中，有很多“无用”的词，如“a”、“the”、“in”，它们很常见，以至于它们没有太多意义。它们被称为[停用词](https://en.wikipedia.org/wiki/Stop_words)，最好删除它们。人们可以注意到的另一件事是，“分析”、“分析器”、“分析”等词非常相似。它们有一个共同的词根，并且都可以转换为一个单词。这个过程称为[词干提取](https://en.wikipedia.org/wiki/Stemming)，存在不同的词干分析器，它们在速度、攻击性等方面有所不同。因此，我们将每个文档转换为没有停用词的词干列表。我们也丢弃了所有的标点符号。

```
porter = PorterStemmer()
stop_words = set(stopwords.words('english'))

modified_arr = [[porter.stem(i.lower()) for i in tokenize(d.translate(None, string.punctuation)) if i.lower() not in stop_words] for d in documents] 
```

那么这个词袋将如何帮助我们呢？假设我们有 3 个袋子`[a, b, c]`：`[a, c, a]`和`[b, c, d]`。我们可以将它们转换为[基础中的向量](https://en.wikipedia.org/wiki/Basis_(linear_algebra)) `[a, b, c, d]`。所以我们最终得到向量`[1, 1, 1, 0]`：`[2, 0, 1, 0]`和`[0, 1, 1, 1]`。我们的文档也是如此（只有向量会更长）。现在我们看到我们删除了很多单词并删除了其他单词以减少向量的维度。这里有一个有趣的观察。较长的文档将比较短的文档具有更多的正元素，这就是规范化向量的好处。这称为词频 TF，人们还使用了有关该词在其他文档中使用频率的附加信息——逆文档频率 IDF。我们一起有一个度量[TF-IDF，它有几种风格](https://en.wikipedia.org/wiki/Tf%E2%80%93idf). 这可以通过 sklearn 中的一行来实现 :-)

```
modified_doc = [' '.join(i) for i in modified_arr] # this is only to convert our list of lists to list of strings that vectorizer uses.
tf_idf = TfidfVectorizer().fit_transform(modified_doc) 
```

实际上矢量化[器允许做很多事情，](http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html)比如删除停用词和小写。我在单独的步骤中完成了它们，只是因为 sklearn 没有非英语停用词，但 nltk 有。

所以我们计算了所有的向量。最后一步是找到与最后一个最相似的一个。有多种方法可以实现这一点，其中之一是欧几里得距离，由于[这里讨论](https://youtu.be/ZEkO8QSlynY)的原因，它并不是那么大。另一种方法是[余弦相似度](https://en.wikipedia.org/wiki/Cosine_similarity)。我们迭代所有文档并计算文档与最后一个文档之间的余弦相似度：

```
l = len(documents) - 1
for i in xrange(l):
    minimum = (1, None)
    minimum = min((cosine(tf_idf[i].todense(), tf_idf[l + 1].todense()), i), minimum)
print minimum 
```

现在 minimum 将拥有有关最佳文档及其分数的信息。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2014-04-04T18:29:28.053

这应该可以帮助你。

```
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity  

tfidf_vectorizer = TfidfVectorizer()
tfidf_matrix = tfidf_vectorizer.fit_transform(train_set)
print tfidf_matrix
cosine = cosine_similarity(tfidf_matrix[length-1], tfidf_matrix)
print cosine 
```

输出将是：

```
[[ 0.34949812  0.81649658  1\.        ]] 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-09-10T17:05:43.787

这是一个将您的测试数据与训练数据进行比较的函数，其中 Tf-Idf 转换器与训练数据相匹配。优点是您可以快速旋转或分组以找到 n 个最接近的元素，并且计算是按矩阵向下的。

```
def create_tokenizer_score(new_series, train_series, tokenizer):
    """
    return the tf idf score of each possible pairs of documents
    Args:
        new_series (pd.Series): new data (To compare against train data)
        train_series (pd.Series): train data (To fit the tf-idf transformer)
    Returns:
        pd.DataFrame
    """

    train_tfidf = tokenizer.fit_transform(train_series)
    new_tfidf = tokenizer.transform(new_series)
    X = pd.DataFrame(cosine_similarity(new_tfidf, train_tfidf), columns=train_series.index)
    X['ix_new'] = new_series.index
    score = pd.melt(
        X,
        id_vars='ix_new',
        var_name='ix_train',
        value_name='score'
    )
    return score

train_set = pd.Series(["The sky is blue.", "The sun is bright."])
test_set = pd.Series(["The sun in the sky is bright."])
tokenizer = TfidfVectorizer() # initiate here your own tokenizer (TfidfVectorizer, CountVectorizer, with stopwords...)
score = create_tokenizer_score(train_series=train_set, new_series=test_set, tokenizer=tokenizer)
score

   ix_new   ix_train    score
0   0       0       0.617034
1   0       1       0.862012 
```

# c# - 如何使用 C# 4.0 编译器让 MonoDevelop 以 .NET 2.0 框架为目标？

> ID：12118721
> 
> 赞同：3
> 
> 时间：2012-08-25T02:41:53.843
> 
> 标签：c#, .net, dll, mono, monodevelop

使用 Visual Studio 很容易做到这一点，但我需要使用 MonoDevelop 来实现这一点，因为 Visual Studio 编译的 DLL 不能很好地与 Unity 配合使用。MonoDevelop DLL 工作正常，但我想在针对 .NET 2.0 运行时使用默认函数参数（C# 4.0 功能）。

MonoDevelop 可以做到这一点吗？我该如何设置？

**添加：为 Visual Studio 和 MonoDevelop 构建命令行**

我对参数进行了排序以便于比较：

*MonoDevelop：目标 = Mono / .NET 4*

```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe
/noconfig
/warn:4
"/define:TRACE"
/optimize+
"/out:C:\TestLibraries\TestEditor\bin\Release\TestEditor.dll"
/t:library

/nologo

"/r:C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0\System.dll"
"/r:C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0\System.Core.dll"
"/r:C:\Program Files (x86)\Unity\Editor\Data\Managed\UnityEditor.dll"
"/r:C:\Program Files (x86)\Unity\Editor\Data\Managed\UnityEngine.dll"

/fullpaths
/utf8output 
```

*MonoDevelop：Target = Mono / .NET 3.5（第一个有趣的）*

```
C:\Windows\Microsoft.NET\Framework\v3.5\csc.exe
/warn:4
"/define:TRACE"
/optimize+
"/out:C:\TestLibraries\TestEditor\bin\Release\TestEditor.dll"
/t:library

/nologo
-nostdlib

"/r:C:\Windows\Microsoft.NET\Framework\v2.0.50727\System.dll"
"/r:C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\v3.5\System.Core.dll"
"/r:C:\Program Files (x86)\Unity\Editor\Data\Managed\UnityEditor.dll"
"/r:C:\Program Files (x86)\Unity\Editor\Data\Managed\UnityEngine.dll"

/fullpaths
/utf8output 
```

*Visual Studio：目标 = .NET 4*

```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\Csc.exe
/noconfig
/nowarn:1701,1702
/warn:4
/define:TRACE
/optimize+
/out:obj\Release\TestEditor.dll
/target:library

/nostdlib+ /errorreport:prompt

/reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0\mscorlib.dll"
/reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0\System.Core.dll"
/reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0\System.dll"
/reference:"C:\Program Files (x86)\Unity\Editor\Data\Managed\UnityEngine.dll"

/debug:pdbonly
/filealign:512 
```

*Visual Studio : Target = .NET 3.5 (第二个有趣的)*

```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\Csc.exe
/noconfig
/nowarn:1701,1702
/warn:4
/define:TRACE
/optimize+
/out:obj\Release\TestEditor.dll
/target:library

/nostdlib+ /errorreport:prompt

/reference:C:\Windows\Microsoft.NET\Framework\v2.0.50727\mscorlib.dll
/reference:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\v3.5\System.Core.dll"
/reference:C:\Windows\Microsoft.NET\Framework\v2.0.50727\System.dll
/reference:"C:\Program Files (x86)\Unity\Editor\Data\Managed\UnityEngine.dll"

/debug:pdbonly
/filealign:512 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T02:51:59.570

这里有两个问题：

Q1) 如何使用当前的 MonoDevelop 构建与 .Net 2.0 兼容的 .dll 或 .exe？

A：我不知道你*能不能*。一种解决方法是下载并安装 MonoDevelop 2.4.x。

Q2) 我想要 C# 4.0 默认函数参数，但我想针对 .Net 2.0

答：你不能 :) 如果你想以 .Net 2.0 为目标，那么你需要使用与 .Net 2.0 兼容的 C# 语言特性的子集。如果您想使用 C# 4.0 语言功能，那么您可能至少需要*一些*.Net 4.0 库……这实际上意味着您将需要 .Net 4.0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T10:40:42.553

最新的稳定 Mono 版本 (2.10.9) 附带的 2.0 C# 编译器 (mcs/gmcs) 支持默认函数参数。我刚刚新建了一个控制台项目，把目标框架改成2.0，编译默认函数参数成功。

# android - PDF 标记和注释工具

> ID：12118723
> 
> 赞同：4
> 
> 时间：2012-08-25T02:42:21.800
> 
> 标签：android, pdf, annotations

各位开发者您好，

我正在为 Android 平板电脑开发 PDF 注释，并希望在我的 android 应用程序中打开/显示 PDF 文件以进行编辑。我对如何打开 PDF 文件进行了研究，大多数方法和库都建议将 PDF 转换为图像文件。我不想转换为图像文件，因为当我提高分辨率时图像文件会像素化。现在我面临的问题是。

1）我必须使用哪种方法在我的应用程序中显示 pdf 文件以进行注释 2）我还想在我的应用程序中实现文本重排

请建议。

谢谢你。

问候， 马塞洛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T14:21:06.930

如果您阅读 pdf 文件规范，您会发现，该 pdf 没有任何类型的流。实际上，每个字母都在页面上严格协调。所以：

1.  通过任何渲染内容上的坐标标记来注释 pdf 文档的任何内容都很简单。
2.  将 pdf 用作“所见即所得”的编辑器是不可能的。甚至不可能将解析 pdf 完美地纠正为可编辑并返回。这样做基本上是错误的想法，因为 PDF 只是表示，而不是设计。
3.  pdf 中最有趣的部分是文本。特别是 - unicode 文本。我想说，从 pdf 文件中捕获非英语文本将返回不可预测的结果。

谢谢！

# subsonic - 得到亚音速编译错误

> ID：12118725
> 
> 赞同：0
> 
> 时间：2012-08-25T02:43:38.470
> 
> 标签：subsonic

我使用 Visual Studio 2010 并尝试使用亚音速，但出现以下错误。

错误 2 编译转换：找不到元数据文件 'MySql.Data' D:\TradingTools\CODE\ConsoleApplication8\subsoniccomponents\Structs.tt 1 1 backtester

正如您从屏幕截图中看到的那样，我的参考资料中确实有 mysql.data。我不知道如何解决这个问题。你能帮忙解决这个问题吗？ [http://postimage.org/image/s1es0mr79/](http://postimage.org/image/s1es0mr79/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T12:34:21.347

SubSonic 使用 DbProviderFactory 模式。DbProviderFactory 方法允许在不知道具体类型的情况下创建 Connections/Commands/...。

```
// without factory
var con = new MySqlConnection();
var cmd = new MySqlCommand();

// with factory
var factory = DbProviderFactories.GetFactory("MySql.Data.MySqlClient");
var con = factory.CreateConnection();
var cmd = factory.CreateCommand(); 
```

这是一种更通用的方法。

但是，为了使其工作，您必须安装 MySql.Data（msi-Package），它会在`machine.config`文件中创建一些条目。

也就是说，

我也更喜欢我的构建环境不依赖于已安装的软件，这使得在不安装多个依赖项的情况下切换到新机器变得更加容易。

但这需要一些工作：

修改您的 app.config/web.config 文件并将其放在`<configuration>`和之间的某个位置`</configuration>`

```
 <system.data>
    <DbProviderFactories>
      <remove invariant="MySql.Data.MySqlClient"/>
      <add name="MySQL Data Provider" invariant="MySql.Data.MySqlClient"
       description=".Net Framework Data Provider for MySQL" type="MySql.Data.MySqlClient.MySqlClientFactory, MySql.Data, Version=6.4.3.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d" />
    </DbProviderFactories>
  </system.data> 
```

我刚刚复制并粘贴了来自

```
%windir%\Microsoft.NET\Framework\<version>\Config 
```

安装 MSI 后。

如果您的解决方案有多个项目，您必须对主项目（以便 subsonic 可以在运行时找到您的提供程序）和您的 DAL 项目（以便 subsonic 可以在代码生成期间找到您的提供程序）执行此操作。

如果你使用另一个 MySQL 版本，你可以改变它。

您要做的第二件事是告诉模板在哪里可以找到 MySql.Data.dll（如果它不在 GAC 中）。

您可以通过编辑`MySQL.ttinclude`文件来做到这一点（查看`assembly`指令）

```
<#@ include file="Settings.ttinclude" #>
<#@ assembly name="$(SolutionDir)\Dependencies\MySql.Data.dll" #>
<#@ import namespace="MySql.Data.MySqlClient" #>
<#+ 
```

通过这些更改，我的解决方案运行 find 并且模板生成也可以在没有安装任何 MySql 组件的全新安装上运行。

# javascript - 如何展开 div / 显示隐藏内容

> ID：12118731
> 
> 赞同：0
> 
> 时间：2012-08-25T02:44:46.877
> 
> 标签：javascript, jquery, html, css

我的目标是扩展 .sort 宽度并显示 .sort-expand div 中的所有内容。当单击“更多”时，它向右扩展，.sort 从 200 像素扩展到 400 像素。并且，当再次单击时，会缩小。

```
 <div class="sort">
    <div class="mainimg"></div>
    <div class="infoarea">
        <h3>Main Name</h3>
        <p>Title of position</p>
        <p><span class="floatl">Tag01, Tag02</span><span class="floatr"><a href="#" class="show">more</a></span></p>
    </div>
    <div class="sort-expand">
        <div class="votes"></div>
        <div class="full-info"></div>
        <div class="other"></div>
    </div>
</div> 
```

这还需要推动所有其他 .sort 区域，以免它们重叠。有任何想法吗？我将发布我开始但遇到困难的内容。非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T02:46:52.937

您应该能够使用 jQuery 的[.slideDown()](http://api.jquery.com/slideDown/)。 `.slideDown()`将在向下动画时推动其他元素并显示 div 的内容。在您想要的 div 上调用它：`$("#myDiv").slideDown()` 如果您希望它在再次单击时缩小，请使用[.slideToggle()](http://api.jquery.com/slideToggle/)

# .net - 下载 .NET 4 源代码

> ID：12118735
> 
> 赞同：25
> 
> 时间：2012-08-25T02:46:17.463
> 
> 标签：.net, download

从昨天开始，我一直在尝试下载 .NET 4 ( [http://referencesource.microsoft.com/netframework.aspx](http://referencesource.microsoft.com/netframework.aspx) ) 的源代码，但它不起作用。

在 IE 中点击下载链接，FF 确实刷新了页面，但下载没有开始。

单击 Chrome 中的下载链接确实会开始下载，但它被称为 netframework.aspx，没有迹象表明下载有多大。无论如何，尝试使用 DAP 下载也没有结果。

我已经在 2 台不同的机器上尝试过，结果相同。我的所有安装（包括 Windows）都保持最新状态。

任何建议或真实的替代品将不胜感激。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-25T03:15:24.047

我以前也发生过很多次这种情况。它*正在*下载安装程序，只是名称错误。我不认为它在几个月内正常工作。

您可以将扩展名从 aspx 更改为 msi，然后安装它。

```
netframework.aspx -> netframework.msi 
```

* * *

IE10 现在似乎可以工作了，以前没有（不确定这是否适用于现在的所有 IE 版本）。

看来，当您下载文件时，网页正在使用回发`netframework.aspx`并设置 HTTP 标头以通知浏览器内容。请注意`content-disposition`Chrome 忽略的标头中设置的文件名。

```
缓存控制：私有
内容处置：附件；扩展令牌；文件名=DotNET.msi
内容类型：应用程序/二进制流
日期：格林威治标准时间 2013 年 5 月 10 日星期五 18:31:05
服务器：Microsoft-IIS/7.5
传输编码：分块
X-AspNet-版本：2.0.50727
X-Powered-By:ASP.NET

```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-02-26T15:50:52.523

Microsoft 最近更新了 .NET Framework Sources 网站，请参阅此博客文章：[A new look for .NET Reference Source](http://blogs.msdn.com/b/dotnet/archive/2014/02/24/a-new-look-for-net-reference-source.aspx)。

所有资源，包括项目文件，现在都可以直接下载：[http](http://referencesource-beta.microsoft.com/download.html) ://referencesource-beta.microsoft.com/download.html没有安装程序，没有愚蠢的 javascript 保护，只是一个 ZIP 文件的直接链接。

# java - Java - URLConnections 停止连接？

> ID：12118737
> 
> 赞同：0
> 
> 时间：2012-08-25T02:47:15.017
> 
> 标签：java, multithreading, threadpool, urlconnection

我正在做一个家庭作业，目的是展示增加线程数如何有助于或损害程序的性能。*基本思想是对来自网站的数据的单个请求进行线程化，然后确定当一个人同时运行n 个*查询时执行所有查询需要多长时间。

我想我已经正确完成了线程和时钟，但是请求发生了一些奇怪的事情。我`java.net.URLConnection`用来连接到数据库。我的前三千个左右连接将成功并加载。然后，数百个调用失败，没有任何证据表明 Java 已经尝试了指定的超时期限。

我在一个线程中运行的代码如下：

```
/* This code to get the contents from an URL was adapted from a
 * StackOverflow question found at http://goo.gl/QPqR4 .
 */
private static String loadContent(String address) throws Exception {
  String toReturn = "";

  try {
    URL url = new URL(address);
    URLConnection con = url.openConnection();
    con.setConnectTimeout(5000);
    con.setReadTimeout(5000);
    InputStream stream = con.getInputStream();
    Reader r = new InputStreamReader(stream, "ISO-8859-1");

    while (true) {
      int ch = r.read();
      if (ch < 0) {
        break;
      }
      toReturn += (char) ch;
    }

    r.close();
    stream.close();
  } catch (Exception e) {
    System.out.println(address + ": " + e.getMessage());
    throw e;
  }

  return toReturn;
} 
```

运行线程的代码如下。该`NormalPerformance`课程是我为简化计算一系列观察结果的均值和方差而编写的课程。

```
/* This code is patterned after code provided by my professor.
 */
private static NormalPerformance performExperiment(int threads, int runs)
  throws Exception
{
  NormalPerformance toReturn = new NormalPerformance();

  for (int i = 0; i < runs; i++) {
    final List<Callable<Void>> tasks = new ArrayList<Callable<Void>>();
    for (int j = 0; j < URLS.length; j++) {
      final String url = URLS[i];
      tasks.add(new Callable<Void>() {
        public Void call() throws Exception {
          loadContent(url);
          return null;
        }
      });
    }

    long start = System.nanoTime();
    final ExecutorService exectuorPool = Executors.newFixedThreadPool(threads);
    executorPool.invokeAll(tasks);
    executorPool.shutdown();
    double time = (System.nano() - start) / 1000000000.;
    toReturn.addObservation(time);

    System.out.println("" + threads + " " + (i + 1) + ": " + time);
  }

  return toReturn;
} 
```

为什么我会看到这种奇怪的成功和失败模式？更奇怪的是，有时杀死程序并重新启动并不能阻止失败的运行。我已经尝试过诸如强制线程休眠、调用`System.gc()`、增加连接和读取超时值之类的方法，但这些都没有单独或组合解决这个问题。

我如何保证我的连接有最好的连接机会？

环境：Windows 7 64 位、Eclipse Juno 64 位、JRE 7

# c - float 变量如何自动提升为 double 类型？

> ID：12118738
> 
> 赞同：4
> 
> 时间：2012-08-25T02:47:38.333
> 
> 标签：c, floating-point, double, ieee-754, type-promotion

我知道在 C 和 Java 中，float 的底层表示是 IEEE754-32，double 是 IEEE754-64。

在表达式中，`float`将自动提升为`double`. 又怎样？以 3.7f 为例。过程是这样的吗？

> 1.  3.7f 将使用 IEEE754 在内存中表示。它适合 4 个字节。
> 2.  在计算过程中，它可能会被加载到一个 64 位寄存器（或任何 64 位位置），将 3.7f 转换为 IEEE754-64 表示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T03:00:35.693

它非常依赖于实现。

例如，在 x86 平台上，FPU 命令集包括以 IEEE754`float`和`double`格式（以及许多其他格式）加载/存储数据的命令。数据被加载到具有 80 位宽度的内部 FPU 寄存器中。所以实际上在 x86 上，所有浮点计算都是以 80 位浮点精度执行的。即所有浮点数据实际上都提升为 80 位精度。这些寄存器中的数据如何表示完全无关紧要，因为无论如何您都无法直接观察它们。

这意味着在 x86 平台上不存在单步浮点到双精度转换之类的东西。每当需要这种转换时，它实际上是作为两步转换实现的：float-to-internal-fpu 和 internal-fpu-to-double。

这个 BTW 在 x86 FPU 计算模型和 C/C++ 计算模型之间产生了显着的语义差异。为了完全匹配语言模型，处理器必须强制降低中间浮点结果的精度，从而对性能产生负面影响。许多编译器为用户提供控制 FPU 计算模型的选项，允许用户选择严格的 C/C++ 一致性、更好的性能或介于两者之间的选项。

就在几年前，FPU 单元还是 x86 平台的*可选*组件。无 FPU 平台上的浮点计算是在软件中执行的，要么通过模拟 FPU，要么通过生成完全没有任何 FPU 指令的代码。在这样的实现中，事情可能会有所不同，例如，直接执行从 IEEE754`float`到 IEEE754的软件转换`double`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-19T14:42:15.953

> 我知道在 C/Java 中，浮点数的底层表示是 IEEE754-32，双点是 IEEE754-64。

错误的。C 标准从未指定整数和浮点类型大小的固定、特定限制，尽管它们确实确保了类型之间的关系

```
1 == sizeof(char) <= sizeof(short) <= sizeof(int) <= sizeof(long)
sizeof(float) <= sizeof(double) <= sizeof(long double) 
```

尽管现在大多数使用 IEEE-754 及其后代格式，但 C 实现允许使用任何类型的浮点格式。同样，他们可以自由使用任何整数表示，例如 1 的补码或符号大小

关于提升规则，C 的预标准版本将表达式中的浮点数提升为双倍，但在 C89/90 中，规则已更改并`float * float`产生`float`结果。

> ```
> If either operand has type long double, the other operand is converted to long double
> Otherwise, if either operand is double, the other operand is converted to double.
> Otherwise, if either operand is float, the other operand is converted to float. 
> ```
> 
> [C++ 运算符中的隐式类型转换规则](https://stackoverflow.com/a/5563131/995714)

但在 Java 或 C# 中确实如此，因为它们在虚拟机中运行字节码，并且 VM 的类型跨平台是一致的

# html - 将 CSS 宽度分配给位置：固定元素

> ID：12118739
> 
> 赞同：4
> 
> 时间：2012-08-25T02:47:47.320
> 
> 标签：html, css, css-position, fixed-width

我想要一个固定元素的宽度，以匹配紧挨其下方放置的 div 的宽度。想象一个标题和一个主要内容 div。当标题和内容 div 嵌套在外部 div 内时，会出现匹配宽度的问题。在这种情况下，每个元素的 % 宽度不再匹配它们的父宽度（例如，`<body>`标签），并且固定元素的宽度基于一些让我感到困惑的东西。

为了更好地解释我的意思，对比这两个 js fiddles：

1.  [http://jsfiddle.net/2dudX/4/](http://jsfiddle.net/2dudX/4/)
    **对比**
2.  [http://jsfiddle.net/2dudX/10/](http://jsfiddle.net/2dudX/10/)

这是每个的代码：

```
<div id="fixed"></div>
<div id="content"></div>​

#fixed{ position:fixed; z-index:2; width:90%;
        height:25px; background:yellow;}
#content{ width:90%; height:300px; background:red} 
```

**对比**

```
<div id="main">
   <div id="fixed"></div>
   <div id="content"></div>    
</div > 

#main{ width:95%}
#fixed{ position:fixed; z-index:2; width:90%;
        height:25px; background:yellow;}
#content{ width:90%; height:300px; background:red} 
```

请注意，仅在 jsfiddle #1 中，无论您如何调整浏览器大小，黄色和红色 div 的宽度都会匹配。不幸的是，jsfiddle#2 更像是一个真实世界的场景，我想知道如何更正`id="fixed"`div 以使其宽度也与`id="content"`div 匹配。

想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T02:54:19.217

您可以通过这种方式[FIDDLE](http://jsfiddle.net/2dudX/11/)（设置相对于#main 的百分比）固定元素的尺寸始终是相对于根元素计算的，因此在需要设置`%`的这种特殊情况下，您需要相应地重置 -unit：

```
#fixed {
    width: 85.5%;
} 
```

情况`#main`是 95%，你的静态元素相对于主元素是 90%。所以你需要计算它朝向根元素的宽度（`1`* `.95`* `.9`= `.855`）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-25T02:57:52.933

轻松一个我的朋友。固定宽度的元素从它们的父元素中拉出，现在与窗口的宽度是相对的，所以在这两种情况下，固定的 div 总是相对于窗口的大小，但是当在宽度不是 100% 的父容器中时，固定的元素将保持相对于窗口宽度，但非固定位置元素现在相对于父宽度。因此，非固定元素成为 95% 窗口的 90%，而固定元素仅保持恒定的 90% 窗口。

编辑：

如果你想匹配宽度，你可以像这样使用 jquery：

```
$(function(){
    $('#fixed').width($('#content').outerWidth());
}); 
```

# php - 如何在 div 中为 CodeIgniter 加载页面

> ID：12118741
> 
> 赞同：0
> 
> 时间：2012-08-25T02:48:32.630
> 
> 标签：php, codeigniter, html

[我在这里](http://i48.tinypic.com/svs3kp.jpg)有布局，我想将[菜单](http://i46.tinypic.com/4t6kd2.jpg)插入到菜单布局中。最近，我使用框架集来解决这个问题，但这一次，我想尝试使用 a`div`而不是框架集，也可以通过 CodeIgniter。

当菜单成功时，我可以将表单加载到表单布局：D

我如何通过 CodeIgniter 框架做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T09:22:53.553

你有两个选择是像这样直接在视图中加载视图

```
<div id="sidebar">

<?php $this->load->view('template/sidebar.php'); ?>

</div> 
```

或者将其作为变量从控制器传递并在视图中回显，如下所示

```
function index(){

$data['sidebar'] = $this->_get_sidebar();
$this->load->view('home',$data);
}

function _get_sidebar(){

return $this->load->view('template/sidebar',TRUE);

} 
```

并且在视图中

```
<div id="sample">
     <?php echo $sidebar;?>
</div> 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T04:30:37.817

您不会在 div 中加载*页面，而是在***views**中加载页面。我会这样：

控制器`main.php`

```
Class Main extends CI_Controller{

  function index()
  {
     $this->load->model('mymodel');
     $data['menu_items'] = $this->mymodel->get_menu();
     $this->load->view('layout', $data);
  }
} 
```

现在，您的视图 layout.php 中有可用的 $menu_items 变量。一种简洁的方法是在“主”视图中加载“部分”视图（在另一个视图中加载的所有视图都有可用的变量）。所以，像这样：

意见/布局.php

```
<!DOCTYPE html>
<html><head><title></title></head>
<body>
    <header>
      <?php $this->load->view('partials/header'); ?>
    </header>

    <section>
    <aside>
     <nav>
      <?php $this->load->view('partials/menu');?>
     </nav>
    </aside>
      <article>
        <?php $this->load->view('partials/content');?>
      </article>
    </section>
    <footer>
      <?php $this->load->view('partials/footer');?>
</footer>
</body>
</html> 
```

现在您在文件夹 view/partials/ 中创建局部视图，它们将在您的控制器中将变量传递给布局视图。

文件`views/partials/menu.php`

```
<ul>
  <?php foreach($menu_items as $item): ?>
  <li><?php echo $item['name'];?></li>
  <?php endforeach;?>
</ul> 
```

# jqgrid - jqgrid php SELECT查询问题

> ID：12118742
> 
> 赞同：0
> 
> 时间：2012-08-25T02:48:35.260
> 
> 标签：jqgrid

我试图在我的 SELECT 语句中使用一个变量，但我遇到了一些非常奇怪的问题。代码如下。

**不工作，没有数据！**

代码：

$fid= $_GET['f']; echo $fid;//prints 3 $SQL = "SELECT threadid, thumb, title, stage, status, startdate ,duedate, forumid FROM thread WHERE forumid = '$fid' ";

**工作正常！**

```
**Code:**

   $SQL = "SELECT threadid, thumb, title, stage, status, startdate ,duedate, forumid FROM thread WHERE forumid ='3' "; 
```

**谢谢你！**

**网格.php**

```
 <?php include ("add/add_config.php");?>
<?php include ("php/jqAutocomplete.php");?>
<?php include ("php/jqCalendar.php");?>
<?php include ("php/jqGrid.php");?>
<?php
ini_set("display_errors","1");
$fid= $_GET['f'];

include ("php/jqGridPdo.php");

$conn = new PDO(DB_DSN,DB_USER,DB_PASSWORD);

$conn->query("SET NAMES utf8");

// Create the jqGrid instance
$grid = new jqGridRender($conn);

echo $fid;

$grid->SelectCommand ="SELECT threadid, thumb, title, stage, status, startdate ,duedate FROM thread WHERE forumid='3'";
//$g="SELECT threadid, thumb, title, stage, status, startdate ,duedate, forumid FROM thread WHERE forumid='$fid'";
//echo $g;
// set the ouput format to json
$grid->dataType = 'json';
$grid->table ="thread";
$grid->setPrimaryKeyId("threadid");

$grid->setUrl('grid.php');
$grid->cacheCount = true;

$grid->addCol(array(
    "name"=>"actions",
    "formatter"=>"actions",
    "editable"=>false,
    "sortable"=>false,
    "resizable"=>false,
    "fixed"=>true,
    "width"=>60,
    "formatoptions"=>array("keys"=>true)
    ), "first");

$grid->setGridOptions(array(
    "caption"=>"cdbdev",
    "rownumbers"=>true, 
     "toppager"=>true, 
    "rowNum"=>10,
    "sortname"=>"threadid",
    "hoverrows"=>true,
    "rowList"=>array(10,20,50),
    "postData"=>array("grid_recs"=>776),    
    "height"=>"auto",
    "width"=>"auto"

    ));

$grid->addCol(array("name"=>"fileToUpload",  "editable"=>true, "edittype"=>"file", "editrules"=>array("edithidden"=>true))); 

$upload = <<<UPLOAD
function(formid) {
//These are needed for fileupload plugin
$(formid).attr("method","POST");
$(formid).attr("action","");
$(formid).attr("enctype","multipart/form-data");

$("<br/><button id='buttonUpload'>Upload</button>").insertAfter("#fileToUpload",formid);
// bind a event
$("#buttonUpload",formid).click(function(){
    $.ajaxFileUpload({
        url:'doajaxfileupload.php',
        secureuri:false,
        fileElementId:'fileToUpload',
        dataType: 'json',
        success: function (data, status) {
            console.log(data);
            if(typeof(data.error) != 'undefined')
            {
                if(data.error != '')
                {
                    alert(data.error);
                }else{
                    $("#fileToUpload").val("");
                    alert(data.msg);
                }
            }
        },
        error: function (data, status, e)
        {
            alert(e);
        }
    });
    return false;
});
}
UPLOAD;

$grid->setJSCode($upload);

$image = <<<CUSTOM
function formatImage(cellValue, options, rowObject) {
    var imageHtml = "<img src='images/" + cellValue + "' originalValue='" + cellValue + "' />";
return imageHtml;
}
function unformatImage(cellValue, options, cellObject) {
    return $(cellObject.html()).attr("originalValue");
}
function formatRating(cellValue, options, rowObject) {
    var color = (parseInt(cellValue) > 0) ? "green" : "red";
    var cellHtml = "<span style='color:" + color + "' originalValue='" +
                   cellValue + "'>" + cellValue + "</span>";
    return cellHtml;
}
function unformatRating(cellValue, options, cellObject) {
    return $(cellObject.html()).attr("originalValue");
}
CUSTOM;
$grid->setJSCode($image);

$grid->setSelect('stage', "SELECT id, name FROM selection where statid=1"); 
$grid->setSelect('status', "SELECT id,name FROM selection where statid=2 ");

$grid->setColProperty("threadid", array( "width"=>80 , "align"=>center));
$grid->setColProperty("stage", array( "width"=>120 , "align"=>center));
$grid->setColProperty("forumid", array( "width"=>0 ,));
$grid->setColProperty("status", array( "width"=>120 , "align"=>center ));

$grid->setColProperty("title", array( "width"=>280, "align"=>center ,"formatter"=>"showlink","formatoptions"=>array("baseLinkUrl"=>"showthread.php", "target"=>"_blank", "idName"=>"t")));

$grid->setColProperty("startdate", array("width"=>130,"align"=>center,
    "formatter"=>"date",
    "formatoptions"=>array("srcformat"=>"Y-m-d H:i:s","newformat"=>"m/d/Y")
    )
);

$grid->setColProperty("duedate", array("width"=>130,"align"=>center,
    "formatter"=>"date",
    "formatoptions"=>array("srcformat"=>"Y-m-d H:i:s","newformat"=>"m/d/Y")
    )
);
$grid->setColProperty("CustomerID", array("editrules"=>array("required"=>true)));
$grid->setAutocomplete("CustomerID",false,"SELECT CustomerID, CompanyName FROM customers WHERE CompanyName LIKE ? ORDER BY CompanyName",null,true,true);

$grid->setUserTime("m/d/Y");
$grid->setUserDate("m/d/Y");
$grid->setDatepicker("startdate",array("buttonOnly"=>false));
$grid->datearray = array('startdate');

$grid->setUserTime("m/d/Y");
$grid->setUserDate("m/d/Y");
$grid->setDatepicker("duedate",array("buttonOnly"=>false));
$grid->datearray = array('duedate');

$grid->navigator = true;

$grid->setNavOptions('navigator', array("cloneToTop"=>true,"excel"=>true,"add"=>false,"edit"=>false,"del"=>false,"view"=>false));

$grid->exportfile = 'Report.xls'; 

$grid->setNavOptions('navigator', array("cloneToTop"=>true,"pdf"=>true,"add"=>false,"edit"=>false,"del"=>false,"view"=>false));

$grid->inlineNav = true;
$grid->setNavEvent('edit', 'onInitializeForm', $upload);

$grid->renderGrid('#grid','#pager',true, null, null, true,true);
$conn = null;

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T03:06:38.793

您使用的是什么 SQL 引擎？如果是 MySQL，您可以使用：

```
 echo mysql_error(); 
```

运行选择以查看您遇到的错误后

还尝试在生成 SELECT 语句后对其进行回显，以确保没有将额外的空格等添加到 $fid

# css - 如何使用媒体查询使页面居中

> ID：12118744
> 
> 赞同：-2
> 
> 时间：2012-08-25T02:49:07.620
> 
> 标签：css, media-queries

在我正在开发的这个[网站](http://djkarmamusic.com/)上，我在将内容集中在第一个媒体查询中断上时遇到了问题。768px 的大小没有与浏览器窗口的左侧对齐，并允许我向下调整窗口的大小，有些东西使它保持打开状态。该页面通常以 960 像素和更大的浏览器大小为中心，但不是 768 像素。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T02:51:44.683

去掉`min-width: 980px`你身上的那块给我修好了。

# javascript - jwplayer 从另一个域流式传输 m3u

> ID：12118750
> 
> 赞同：3
> 
> 时间：2012-08-25T02:51:14.977
> 
> 标签：javascript, jwplayer, m3u

希望在我的网站上流式传输广播电台，我们还托管流式传输，但来自不同的域。刚刚收到此错误：

```
Task Queue failed at step 5: Playlist could not be loaded due to crossdomain policy restrictions 
```

域 A 上的代码：

```
 <div id="mediaplayer">Loading...</div>
<script type="text/javascript" src="/jwplayer/jwplayer.js"></script>
<script type="text/javascript">
    jwplayer("mediaplayer").setup({
        flashplayer: "/jwplayer/player.swf",
        playlistfile: "http://domainB/stream.m3u",
        image: "/images/listening.jpg",
        type: "sound",
        allowscriptaccess:"always",
        width:300,
        height:300
    });
</script> 
```

只是运气不好，尝试了多种选择......我是否在域 B 上没有 crossdomain.xml 浪费我的时间？（我目前无法访问，但也许很快就能访问）

流在 iTunes、winamp 等上运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T05:57:04.537

好的，问题是：m3u 文件的 url 不是流的实际 url。我需要在文本编辑器中打开 m3u 文件，并使用该 url，其中包括端口等。

```
<script type='text/javascript' src='/jwplayer/jwplayer.js'></script>
<div id='media'></div>
<script type='text/javascript'>
  jwplayer('media').setup({
    'flashplayer': '/jwplayer/player.swf',
    'file': 'http://xx.xxxxxx.xxx:80/xxxxfm',
    'provider': 'sound',
    'controlbar': 'bottom',
    'image': "/images/listening.jpg",
    'width': '300',
    'height': '300'
  });
</script> 
```

这段代码似乎可以工作，不需要 crossdomain.xml，它只是因为 url 不正确才请求一个。

# javascript - 为什么我的网页的 facebook 喜欢计数与该网页的 facebook 页面不匹配？

> ID：12118751
> 
> 赞同：1
> 
> 时间：2012-08-25T02:51:26.650
> 
> 标签：javascript, html, facebook-like

我使用 facebook 生成的代码在`https://developers.facebook.com/docs/reference/plugins/like`我的网站上显示一个赞按钮。

Javascript：

```
 <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script> 
```

html代码：

```
<div class="fb-like" data-layout="button_count" data-ref="https://facebook.com/mybusinesspage" data-send="false" data-width="100">
<div class="fb-root"></div> 
```

但是当我的企业 facebook 页面本身有 200 个赞时，它显示了 10 个赞。当我点击网站页面上的“喜欢”按钮时，用户显示他喜欢该页面的网站地址 INSTEAD 的 facebook 业务页面喜欢。我的代码中有什么地方做错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T06:11:47.067

Facebook 将您的网站和您的 Facebook 页面视为完全独立的实体。如果您想显示您的 200 个赞，则需要使用您的 Facebook 页面 URL 而不是您的实际 .com 网站生成一个新的 Facebook 赞按钮代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T03:20:57.897

那可能是facebook错误。你应该向 facebook 报告。

# python - Python 术语：Learn Python the Hard Way 练习 13 中“= argv”左边的东西

> ID：12118752
> 
> 赞同：3
> 
> 时间：2012-08-25T02:51:41.953
> 
> 标签：python, terminology, iterable-unpacking

Zed Shaw 的“Learn Python the Hard Way”经常要求您“用英语写出”脚本的每一行的作用。我正在努力使用与函数（命令？）**argv**相关的一些东西来做到这一点，因为我不知道如何命名代码的某些部分。哎呀，我什至不知道如何调用 argv——一个函数？命令？多变的？我知道这是一个模块。但回到正轨：

这是[练习 13](http://learnpythonthehardway.org/book/ex13.html)中的代码：

```
from sys import argv

script, first, second, third = argv

print "The script is called:", script
print "Your first variable is:", first
print "Your second variable is:", second
print "Your third variable is:", third 
```

Zed 声明“‘argv’是‘参数变量’。我的问题是，**第三行等号左边的东西的名称是什么？**

通俗地说，我的冲动是自己称“脚本”、“第一”等词为变量——但这似乎不对，因为根据 Zed argv 是“参数变量”。

我也不认为称它们为“论点”是正确的。我只在命令行参数方面阅读了“参数”。

“参数”似乎很可能，因为它在练习的标题中被提及，但是使用“等号”、“=”、“python”、“argv”、“定义”等的组合进行网络搜索却不是很有启发性。当你不知道它们叫什么时，搜索东西是非常困难的。

我很清楚这个脚本中发生了什么，只是不清楚其中一部分的名称。我很确定，当我回答这个问题时，我会拍拍我的额头。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T02:53:35.510

左边的东西是从右边的`"="`变量*中*获取*值*的变量。

鉴于：

```
script, first, second, third = argv 
```

`argv`是一个字符串*列表*，在这种情况下包含 4 个项目。这些字符串被“解包”并分配给`=`.

`argv`获取它的值是从命令行调用 Python 程序时，如下所示：

```
test.py this is sure cool 
```

在这种情况下`argv`将包含 `['test.py', 'this', 'is', 'sure', 'cool']`. 命令后的这些字符串称为“**命令行参数**”（参见本[教程](http://www.tutorialspoint.com/python/python_command_line_arguments.htm)）和脚本的名称，任何参数都存储在`argv`. 这是一种在启动脚本时向脚本发送信息的方法。

在这种情况下，变量获得以下值：

```
 script is set to  "this.py"  # the string is in argv[0]
  first to "is"     # argv[1]
  second to "sure"  # argv[2] 
```

和

```
 third to "cool"   # argv[3] 
```

所以：

```
 script, first, second, third = argv 
```

真的相当于：

```
 script = argv[0]
  first = argv[1]
  second = argv[2]
  third = argv[3] 
```

只是 Python 让您一举完成这项任务。

请注意，您可以使用适当的索引值以任何顺序提取命令行参数。

此机制用于将信息传递给 Python 脚本。您可以想象运行一个需要输入文件和输出文件的程序。您可以在命令行中提供它们，而不是在脚本中硬编码它们。例如，

```
 computeData.py input.txt result.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T02:57:19.903

有时在交互式 python 提示符中输入一些代码会更容易，看看这些东西是如何工作的。

虽然 sys.argv 是一个由 Python 本身为您定义的列表，但它与您自己定义的任何列表或元组（Python 的可变和非可变数组类类型）没有什么不同。因此，尝试自己定义一个并使用它。在您声明了一个名为`argv = ['123','456','789']`列表类型的变量后，请尝试将其分配给另一个名称：

```
 anothername = argv 
```

请注意，没有什么特别的事情发生。现在请注意，如果您尝试分配三个不同的变量会发生什么：

```
 v1,v2,v3 = argv 
```

argv 中的第一个（技术上是“zeroeth”）元素存储在 v1 中，argv 的第二个元素存储在 v2 中，依此类推。

我相信我会将 v1,v2,v3 称为“变量列表，这些变量将包含曾经是列表 argv 中的元素的内容，但我希望将其解包并存储在自己的位置”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T02:56:57.033

回答你的第一个问题，是模块`argv`的一个*属性*`sys`。至于您的第二个问题，Python 的文档没有为赋值表达式的右侧指定名称，但是`script`,`first`等在这种情况下可以称为变量。

# jquery - 如何解决 IE7 中复杂的 Z-index 问题

> ID：12118762
> 
> 赞同：0
> 
> 时间：2012-08-25T02:53:24.563
> 
> 标签：jquery, html, css

我在处理 IE7 的 z-index 时遇到问题。我已经进行了大量研究，但仍然无法解决我的问题。

我有

```
4 buttons with drop down menu. The dropdown menu has absolute position and have z-index of 9999;

 ----     ----    -----    -----
|    |   |    |  |     |  |     |
 ----     ----    -----    -----
dmenu    dmenu    dmenu    dmenu

another 4 buttons with popup images that pop on top of the button. The images also have absolute position and have z-index of 9999;

 pop img   pop img  pop img     pop img
 ----       ----    -----      -----
|    |     |    |  |     |    |     |
 ----       ----    -----      -----

 I want dropdown menu will cover the buttons below and and pop images will cover the button above. 
```

在 Chrome 和 FF 中一切正常，但在 IE 中。下拉菜单将显示在底部按钮的后面，而不是覆盖它们。

顶部按钮是下拉菜单的父级，底部按钮是弹出图像的父级。

我努力了

1.设置顶部和底部按钮的相对位置。

2.运行这个脚本

```
 var zIndexNumber = 1000;
       // Put your target element(s) in the selector below!
       $("div").each(function() {
               $(this).css('zIndex', zIndexNumber);
               zIndexNumber -= 10;
               console.log($(this));
       }); 
```

上面的脚本将修复下拉菜单以覆盖底部按钮，但也会使顶部按钮覆盖流行图像，因为流行图像的 z-index 较低。

我现在很沮丧，需要帮助。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T03:02:33.180

试试这个：确保下拉列表的父母有一个位置：相对。 [IE 6 & IE 7 Z-Index 问题](https://stackoverflow.com/questions/672228/ie-6-ie-7-z-index-problem) 我通常确保在这种情况下 ul 也会有一个 display:block 。

我要做的另一件事是将父级的 z-index 设置为较小的数字，并通过将 z-index 应用到 body 来设置页面上的 z-index。

# python - Python - 尝试比较两个格式不同的文本文件

> ID：12118765
> 
> 赞同：3
> 
> 时间：2012-08-25T02:53:51.657
> 
> 标签：python

文件 1 的格式如下：

```
1111111111
2222222222 
```

文件 2 的格式如下：

```
3333333333:4444444444
1111111111:2222222222 
```

我正在尝试找出一种方法来获取文件一中的内容，并查看它是否*仅*与文件二中冒号*右侧*的内容匹配。最终目标是如果有匹配项，则删除文件二中的 FULL 行。

我知道我可以使用标准命令剪切文件 2，因此它们的格式完全相同。问题是我需要 88888:99999 格式的完成文件，将它们分开似乎太复杂了，只是为了把它们放回正确的顺序。

我试过嵌套循环、正则表达式、集合、列表，我的头在旋转。

我希望这是有道理的。提前致谢。

```
Traceback (most recent call last):
 File "test.py", line 17, in <module>
   if line.split(":")[1] in keys:
IndexError: list index out of range 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T02:59:54.613

假设您想要删除文件 2 中的行，如果该行的第二部分与文件 1 中的*任何*值匹配，您将执行以下操作：

```
# Warning: Untested code ahead
with open("file1", "r") as f1:
    # First, get the set of all the values in file 1
    # Sets use hash tables under the covers so this should
    # be fast enough for our use case (assuming sizes less than
    # the total memory available on the system)
    keys = set(f1.read().splitlines())

# Since we can't write back into the same file as we read through it
# we'll pipe the valid lines into a new file
with open("file2", "r") as f2:
    with open("filtered_file", "w") as dest:
        for line in f2:
            line = line.strip()  # Remove newline
            # ASSUMPTION: All lines in file 2 have a colon
            if line.split(":")[1] in keys:
                continue
            else:
                dest.writeline(line) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T03:00:38.607

这就是你如何让文件 2 中的冒号正确的元素。也许不是最干净的，但你明白了。

```
 str2 = open(file2).read()
 righttocolon = [s.split(":")[1] for s in [ln for ln in str2.split("\n")] if len(s.split(":")) == 2] 
```

# sql - 我在 mysql 中的成就排名有问题

> ID：12118766
> 
> 赞同：1
> 
> 时间：2012-08-25T02:53:53.857
> 
> 标签：sql, ruby-on-rails, activerecord, group-by

我正在制作一个系统，用户可以通过网站上的某些操作来获得成就。

数据库分为三个，用户、成就和表链接两者。

对于排名来说，重要的是连接用户和成就的表格。结构如下（称为 user_achievements）：

```
| id | user_id | achievement_id | created_at | updated_at | 
```

排名靠前的人应该是成就最多的人，并且谁首先赢得了那个人。

组装的查询：

```
SELECT user_id, 
       COUNT(achievement_id) AS 'total', 
       created_at 
FROM `user_achievements` 
GROUP BY user_id ORDER BY total DESC, created_at ASC LIMIT 10 
```

此查询有效，但问题是谁拥有最多成就（“总数”）的“分组依据”，它不支持最后一个 created_at 用户。来第一个 created_at 那个用户，这不适合谁是第一个获得这么多成就的人。

我的系统使用 Ruby on Rails，ActiveRecord 中是否有此查询的解决方案，将有很大帮助。

非常感谢！对不起我的英语不好...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T03:07:09.750

```
SELECT user_id, 
       COUNT(achievement_id) AS 'total', 
       MAX(created_at) as 'lastTS' 
FROM `user_achievements` 
GROUP BY user_id 
ORDER BY total DESC, lastTS ASC LIMIT 10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T02:38:13.073

我知道你已经选择了你的答案，但如果你仍然想要 ActiveRecord 中的解决方案......

```
class User < ActiveRecord::Base
    scope :ranked, order('achievements.count DESC, achievements.created_at ASC').limit(10)
end 
```

然后你只需要打电话`Users.ranked`或`@users.ranked`得到你需要的回报。

# linux - 使用 LINUX top 命令计算已用内存百分比

> ID：12118767
> 
> 赞同：0
> 
> 时间：2012-08-25T02:54:04.397
> 
> 标签：linux, bash

我正在将顶部命令输出写入文本文件。我正在尝试编写一个简单的 bash 脚本来计算已用内存的百分比，并在内存使用百分比超过 90% 时发送电子邮件。

这是我到目前为止的 bash 脚本。

```
#!/bin/bash
top -n 1 -b | grep "Mem" > /home/modadm/top-output.txt
MAXMEM=/home/modadm/top-output.txt | grep "Mem" | cut -c 7-14 
USEDMEM=/home/modadm/top-output.txt | grep "Mem" | cut -c 25-31
$USEDPCT='echo $USEDMEM / $MAXMEM * 100 | bc'
$USEDPCT | mail -s "Test Email from MOD Server" test@test.com 
```

当我保存并执行脚本时，我收到错误“没有这样的文件或目录”：

```
-bash-3.2$ ./memcheck.sh
./memcheck.sh: line 4: =echo $USEDMEM / $MAXMEM * 100 | bc: No such file or directory
Null message body; hope that's ok
-bash-3.2$ 
```

有人可以帮忙吗？我是 bash 脚本的新手，这是我的第一个脚本。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T06:56:08.287

其他答案的内容我不再赘述；`top`相反，当您需要的只是有关系统内存使用情况的信息时，我会质疑解析 的输出是否明智。

的输出`top`是供人类使用的，并且还包含许多不需要且生产成本高的每个进程的信息。的输出[`free`](http://linux.die.net/man/1/free)更适合这种特殊用途。

其次，从脚本中的计算来看，您似乎不了解在 Linux 和其他类 Unix 系统上测量系统内存使用的方式。与*其他*操作系统相反，使用的内存大小包含用于磁盘缓存和其他缓冲区的内存。在任何已经运行了一段时间的系统上，可用内存趋向于零 - 未使用的内存是浪费的内存。

找出进程使用的内存量的第一步是从使用的内存大小中减去用于缓冲区的内存量。但即使这样在现代系统上也是不够的 - 甚至在一定程度`free`上会出错，正如[我在这个较早的答案中](https://stackoverflow.com/a/4417121/507519)`top`提到的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T04:02:04.243

你在这里有几个问题。

首先，这不会做你想做的事。

```
USEDMEM=/home/modadm/top-output.txt | grep "Mem" | cut -c 25-31 
```

您不能将文件名通过管道传输到命令中。您实际上希望将文件的内容通过管道传输到命令中。你可以用“猫”来做到这一点。但是， grep 实际上是为在文件中搜索而设计的，因此您可以这样做

```
USEDMEM=$(grep "Mem" /home/modadm/top-output.txt | cut -c 25-31) 
```

请注意，$(cmd) 是您在子 shell 中执行命令的方式。即，您可以运行一些命令来计算脚本中变量的值。您也可以使用 `cmd`（反引号；通常在波浪号键上），但语法不太清楚。

同样，您可能希望在子外壳中计算此结果。另外，分配给变量时不要使用 $ 。

```
$USEDPCT='echo $USEDMEM / $MAXMEM * 100 | bc' 
```

这可以重写为

```
USEDPCT=$(echo "scale=3; $USEDMEM / $MAXMEM * 100" | bc) 
```

最后，您希望将变量的内容通过管道传输到邮件程序中。管道期望程序位于左侧。您可以通过将变量的值回显到管道中来做到这一点。

```
echo "$USEDPCT" | mail -s "Test Email from MOD Server" test@test.com 
```

将所有内容重新组合在一起：

```
#!/bin/bash
top -n 1 -b | grep "Mem" > /home/modadm/top-output.txt
MAXMEM=$(grep "Mem" /home/modadm/top-output.txt | cut -c 7-14)
USEDMEM=$(grep "Mem" /home/modadm/top-output.txt | cut -c 25-31)
USEDPCT=$(echo "$USEDMEM / $MAXMEM * 100" | bc -l)
echo "$USEDPCT" | mail -s "Test Email from MOD Server" test@test.com 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-25T11:59:01.620

其他人已经指出您的代码存在问题，但对此有更简单的选择，即根本不解析`top`输出。使用`/proc/meminfo`, 和`awk`- 您将不需要临时文件。

```
$ awk '/MemTotal:/{total=$2} \
       /MemFree:/{free=$2} \
       END{ \
        print "Free mem percent: "(free*100/total); \
        print "Used mem percent: "((total-free)*100/total) \
       }' /proc/meminfo 

Free mem percent: 87.7348
Used mem percent: 12.2652 
```

管它`mail`或任何你想要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T04:00:06.127

我已经纠正了你的语法错误。PL。注意命令替换的使用，就像你写的一样

```
MAXMEM=/home/modadm/top-output.txt | grep "Mem" | cut -c 7-14. 
```

这是错误的，你需要写

```
 grep "Mem" /home/modadm/top-output.txt | cut -c 7-14 
```

然后将其括在反引号（制表键左侧的键）中，以将最终值分配给变量。你也写过，

```
$USEDPCT='echo $USEDMEM / $MAXMEM * 100 | bc' 
```

美元符号使用错误。$ 应该在使用变量的值时使用。引号应该是 `（反引号）而不是 '（单引号）。反引号表示命令将被命令的输出替换。同样对于浮点 bc 需要设置比例。

PL。查看修改后的代码。希望这可以帮助。PL。注意我没有检查邮件命令的功能，如果它正在发送邮件。

```
top -n 1 -b | grep "Mem" > /home/modadm/top-output.txt
MAXMEM=`grep "Mem" /home/modadm/top-output.txt | cut -c 7-14`
USEDMEM=`grep "Mem" /home/modadm/top-output.txt | cut -c 25-31`
USEDPCT=`echo   "scale=2; $USEDMEM / $MAXMEM * 100" | bc `
echo $USEDPCT | mail -s "Test Email from MOD Server" test@test.com 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-25T04:02:41.900

试试下面的脚本。

```
#! /bin/bash

memusage=`top -n 1 -b | grep "Mem"`
MAXMEM=`echo $memusage | cut -d" " -f2 | awk '{print substr($0,1,length($0)-1)}'`
USEDMEM=`echo $memusage | cut -d" " -f4 | awk '{print substr($0,1,length($0)-1)}'`

USEDMEM1=`expr $USEDMEM \* 100`
PERCENTAGE=`expr $USEDMEM1 / $MAXMEM`%

echo $PERCENTAGE | mail -s "Test Email" test@test.com 
```

# java - Java中的枚举可以有不等号的名字吗？

> ID：12118768
> 
> 赞同：1
> 
> 时间：2012-08-25T02:54:11.307
> 
> 标签：java, enums

我是 Java 新手，正在尝试使用枚举设置 switch 语句。对于我的枚举的声明，但是我收到编译错误，例如“非法类型开始”，所以我的问题是这样的名称是否合适？

```
public enum Types
{
 <CD>, <Title>
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T02:56:40.327

不，[枚举常量](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.9.1)和所有 Java[标识符](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.8)一样，必须以字母、货币字符 ($) 或连接字符（最常见的是`_`）开头。

# php - 转义表单数据

> ID：12118771
> 
> 赞同：0
> 
> 时间：2012-08-25T02:54:40.997
> 
> 标签：php, security, escaping

我在转义数据方面遇到了一些问题，或者至少是与它相关的代码的清洁度。

假设，我正在转义一个名为“FirstName”的文本字段，它看起来像这样：

```
$FirstName = mysqli_real_escape_string($link, $_POST['FirstName']);
$FirstName = preg_replace( "/[<>#$%]/", "", $FirstName);
$FirstName = preg_replace('/\s\s+/', ' ', $FirstName); 
```

无论如何我可以将最后两行放在某种循环中，让我们这样说：

```
foreach($_POST as $name => $value)
{
    $value = preg_replace( "/[<>#$%]/", "", $value);
    $value = preg_replace('/\s\s+/', ' ', $value);
} 
```

那么我以后要做的就是

```
$FirstName = mysqli_real_escape_string($link, $_POST['FirstName']); 
```

$_POST['FirstName'] 已经被剥夺了其他字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T02:57:37.100

当然。使`foreach`循环按引用而不是按值，如下所示：

```
foreach($_POST as $name => &$value)
{
    $value = preg_replace( "/[<>#$%]/", "", $value);
    $value = preg_replace('/\s\s+/', ' ', $value);
} 
```

注意前面的 & 符号`$value`。这意味着`$value`您在遍历数组时得到的是对数组本身值的*引用*，而不是该值的副本。

# php - 对标题中的社交图标的悬停效果？

> ID：12118772
> 
> 赞同：-4
> 
> 时间：2012-08-25T02:54:53.600
> 
> 标签：php, css, wordpress

我想在我的社交图标上有一个半透明的悬停效果，但无法弄清楚。这是我的 header.php：

```
<div align = "right"><a href="https://twitter.com/#!/ideviceguys"><img src="/wp-includes/images/twitter.png"/></a>
<a href="http://www.facebook.com/ideviceguys"><img src="/wp-includes/images/facebook.png"/></a>
<a href="mailto:info@ideviceguys.com"><img src="/wp-includes/images/mail.png"/></a> 
```

我看到很多人说要编辑 css，但我在我的 css 中找不到这个

这是我的网站[http://ideviceguys.com](http://ideviceguys.com)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T03:06:24.220

你的 CSS 代码需要一个钩子。给你的 div 一个 id 或类。尝试将 class="socialIcons 添加到您的主 div。

```
<div class="socialIcons">
    <a href="https://twitter.com/#!/ideviceguys"><img src="/wp-includes/images/twitter.png"/></a>
    <a href="http://www.facebook.com/ideviceguys"><img src="/wp-includes/images/facebook.png"/></a>
    <a href="mailto:info@ideviceguys.com"><img src="/wp-includes/images/mail.png"/></a>
</div> 
```

然后将这个小块添加到您的 CSS 中。

```
.socialIcons a:hover {
opacity:0.7; filter:alpha(opacity=40); /* Damn MS and IE8 and earlier */
} 
```

这应该给你的图标 30% 的透明度。考虑一下其他人在这里说的话。他们比我聪明得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T03:10:17.597

您必须在 css 中定义它。首先给您的菜单一个 id 或类，以便您的 css 可以以非通用方式定位它。

```
<div class="nav">
    <a href="https://twitter.com/#!/ideviceguys"><img src="/wp-includes/images/twitter.png"/></a>
    <a href="http://www.facebook.com/ideviceguys"><img src="/wp-includes/images/facebook.png"/></a>
    <a href="mailto:info@ideviceguys.com"><img src="/wp-includes/images/mail.png"/></a>
</div> 
```

在 CSS 中：

```
.nav{
    float:right;
}

.nav a{
    display:block;
    float:left;
    margin-right:10px;
}

.nav a:hover{
    box-shadow: 0px 0px 10px #ff6600;
} 
```

显然这只是一个例子。我不知道你的实际设计需要什么。我只是向您展示具有导航类的父元素可以选择其中的 a 标签并在悬停时分配效果。这是微不足道的介绍级 css。更具体的回答需要更详细的问题。

# java - 组织数据的最佳方式：可变数量的特定数据点

> ID：12118773
> 
> 赞同：0
> 
> 时间：2012-08-25T02:55:22.450
> 
> 标签：java, data-structures, code-organization

我正在编写一个有趣的足球模拟器，但我不确定如何组织我的球员的属性评级。我知道随着游戏的改进，属性的数量会发生变化。我需要单独访问每个，即

```
SoccerPlayer.getSpeed()
SoccerPlayer.getShooting() 
```

我也知道我希望能够使用单个函数对它们进行平均以获得总体评分。

```
SoccerPlayer.getOverall() 
```

我的第一个倾向是使用列表或数组，使用常量来定义数组中每个属性的索引。

```
static final int SPEED_INDEX = 0;
static final int SHOOTING_INDEX = 1;

static final int NUM_ATTRIBUTES = 2;

int[] attributes = new int[NUM_ATTRIBUTES];

int getSpeed() {
    return attributes[SPEED];
}

int getOverall() {
    int total = 0;

    for (int i : attributes) {
        total += i;
    }

    return (total / attributes.length);
} 
```

这样，每当我添加一个新属性时，我只需要更改总常数，并添加一个新的索引常数，总函数将始终有效。但是有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T19:00:32.727

您可以使用枚举作为属性，使用地图作为评分：

```
enum Attributes {
    SPEED, SHOOTING;
};

private Map<Attributes,Integer> ratings = new LinkedHashMap<Attributes, Integer>();

int getRating(Attribute attribute) {
    return ratings.get(attribute);
}

int getSpeed() {
    return getAttribute(Attributes.SPEED);
}

int getOverall() {
    int total = 0;
    for (int i : ratings.values()) {
        total += i;
    }
    return total / Attributes.values().length;
} 
```

然后添加一个新属性只需将其添加到枚举中。

在调试时，评级会更容易理解，因为属性有名称而不是数字。

此外，如果您想为属性添加诸如比例因子之类的东西（例如，速度的权重是射击的两倍），枚举是一个方便的放置位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T18:25:05.530

我很惊讶你会对玩家的属性总和感兴趣。我的意思是，将我的跑步能力与准确投篮能力相结合真的有意义吗？

假设您真的想这样做，那么您所描述的似乎足够明智。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T18:37:06.243

在我看来，你的整体排名系统是有效的。但是，有一件事您可能需要检查并确保它是正确的。为了使您的排名准确，1分的射击指数必须与1分的速度指数具有相同的竞争力。如果速度指数的变化比投篮指数更有价值，反之亦然，排名将不准确。到目前为止，它似乎是一个优雅的设计，只要它得到适当的平衡。

EG：4速4射可能每次都可以击败10速1射，但还是会排名靠后。您将不得不调整每个速度/射击实际上给某人带来的奖励，以确保排名较高的球队有更好的获胜机会。

# django - Django - 向查询集添加字段以存储计算结果

> ID：12118776
> 
> 赞同：13
> 
> 时间：2012-08-25T02:56:22.480
> 
> 标签：django, list, append

我对 Django 很陌生，来自 PHP 世界。我试图在计算完之后向查询集“添加”一个字段，但不知道该怎么做。在 PHP 中，我只需在数组中添加一列并将我的东西存储在其中。

这是我的代码：

```
def (id):
    mystuff_details    = mystuff_details.objects.filter(stuff_id=id)
    newthing = '';
    for mystuff in mystuff_details:
        newthing_lists = //some query to get another queryset
        for newthing_list in newthing_lists:
            newthing = newthing_list.stuffIwant
            //Here I want to make some computation, and ADD something to newthing, let's say:  
            to_add = (mystuff.score+somethingelse)
            //I've heard about the .append but I'm sure I'm screwing it up
            newthing.append(to_add) 
```

所以基本上在我的模板中我希望能够调用： {% for newthing in newthings_list %} {{ newthing.to_add }} {% end %}

**TL;DR：**我基本上想从我的数据库中检索一个东西列表，并在这个对象列表中添加一个包含计算值的字段。

如果不清楚，请告诉我，我很难从 php 切换到 django 哈哈。

谢谢！

编辑：

所以，我正在尝试使用字典，但我必须缺少逻辑：

```
def (id):
    mystuff_details    = mystuff_details.objects.filter(stuff_id=id)
    newthing = {};
    for mystuff in mystuff_details:
        newthing_lists = //some query to get another queryset
        for newthing_list in newthing_lists:
            //Newthing_list can have several times the same I, and the scores need to add up
            if newthing[newthing_list.id] > 0: //This doesn't seem to work and throws an error (KeyError)
                newthing[newthing_list.id] = newthing[newthing_list.id] + some_calculated_thing
            else: 
                newthing[newthing_list.id] = some_calculated_thing 
```

然后当我开始工作时，我不知道如何在模板中访问它：

```
 {% for id in my_list %}
     {{newthing[id]}} ? Or something like newthing.id ?
 {% end %} 
```

谢谢！

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-26T11:58:24.007

您可以在 python 对象上设置任何内容：

```
for obj in self.model.objects.all() :
    obj.score = total_score / total_posts 
```

即使 obj 没有 score 属性，这也会起作用。在模板请求中是这样的：

```
{{ obj.score }} 
```

是的，就是这么简单。但是，如果您正在执行的计算可以在数据库中完成，您应该查看[annotate](https://docs.djangoproject.com/en/stable/ref/models/querysets/#annotate)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-25T03:59:22.823

为什么不用字典？

```
newthing = {}
newthing['your_key'] = to_add 
```

在模板中，您可以通过以下方式访问字典值：

```
{{newthing.your_key}} 
```

或者，如果您有字典，请使用 for 循环

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-09-08T19:34:47.157

如果@Melvyn 的解决方案对您不起作用：

确保在修改查询集时不要`.all()`在查询集上调用 etc，因为`.all()`返回查询集的副本，例如

```
qs = foo.objects.filter(bar=1); 
for obj in qs.all(): 
    obj.caz = 1;  # Will not persist 
```

现在`qs`将保持不变。

相当：

```
qs = foo.objects.filter(bar=1).all(); 
for obj in qs: 
    obj.caz = 1; 
```

现在您可以`.caz`在模板中访问。

# python - Python：检查用户对 raw_input() 的响应

> ID：12118777
> 
> 赞同：1
> 
> 时间：2012-08-25T02:56:26.333
> 
> 标签：python, list, function

我试图让用户输入一个特定的词。

我的代码：

```
import os

os.system("clear")

def get_answer():
    print "\nWould you like to 'hit', 'stick', 'double' down or 'split'?"
    x = raw_input('> ')
    answers = ['hit', 'stick', 'double', 'split']
    y = [i for i in answers if i in x]
    if y == []:
        get_answer()
    print y
    # exit(0)
    return y

def foo():
    a = get_answer()
    print a

foo() 
```

如果我第一次回答“命中”，这是我的输出；

```
Would you like to 'hit', 'stick', 'double' down or 'split'?
> hit 
['hit']
['hit'] 
```

如果我第一次输入“blah”然后“hit”，这是我的输出：

```
Would you like to 'hit', 'stick', 'double' down or 'split'?
> blah

Would you like to 'hit', 'stick', 'double' down or 'split'?
> hit
['hit']
[]
[] 
```

我什至不知道如何研究这个。这是一个简单的语法错误还是我不明白的更深层次的问题？我很想知道如何正确地做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T02:58:06.800

您只想简单地测试`if x in answers`，它检查输入是否是 中的元素之一`answers`。

此外，由于您使用递归来获取用户的输入，因此输入不正确的值`get_answer()`会在堆栈上再次调用。结果是，当最里面的调用`get_answer`获得有效输入时，外部`get_answer`调用继续执行，导致您看到奇怪的输出。

例如，在您的第二种情况下，`['hit']`由最里面的调用生成`print y`，第一个`[]`由外部调用生成`print y`（因为内部`get_answer`完成），最后一个`[]`由`print a`in `foo()`（因为外部`get_answer`返回`[]`）生成。

相反，您可能想要做的是（a）将`get_answer`调用更改为`return get_answer()`以便将最里面的调用的值发送回堆栈，或者（b）将`get_answer`调用更改为循环，并在您得到一个好的答案时中断。

假设您正试图让用户准确输入其中一个选项，以下是您如何构造代码以使用循环而不是递归：

```
def get_answer():
    answers = ['hit', 'stick', 'double', 'split']
    while True:
        print "\nWould you like to 'hit', 'stick', 'double' down or 'split'?"
        answer = raw_input('> ')
        if answer in answers:
            return answer

print get_answer() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T03:11:23.230

这个问题有点更根本。在`get_answer()`函数中，您通过从自身内部调用函数来进行[递归](http://en.wikipedia.org/wiki/Recursion)：

```
if y == []:
    get_answer() 
```

虽然这可行，但我怀疑这是您的预期行为。您必须调用`get_answer()`外部`get_answer()`才能很好地提示值。

无论如何，这就是我将如何构建您的代码：

```
def get_answer(question, answers):
    response = raw_input(question)

    while response not in answers:
        response = raw_input(question)

    return response

if __name__ == '__main__':
    question = "Would you like to 'hit', 'stick', 'double' down or 'split'?\n> "
    answers = ['hit', 'stick', 'double', 'split']

    print get_answer(question, answers) 
```

# javascript - 使用 Jekyll 链接外部 JavaScript 时遇到问题

> ID：12118780
> 
> 赞同：5
> 
> 时间：2012-08-25T02:57:00.780
> 
> 标签：javascript, jquery, jekyll, github-pages

我有一个由 GitHub Pages 托管的站点，它使用 Jekyll，并且我已经成功地在每个布局中使用了一个内部定义的脚本，该脚本将从它们的数组中生成一个随机的标语。

我正在尝试将此脚本移动到 external `tagline.js`，但到目前为止我一直没有成功。

这是基本的标语生成脚本，以防代码中的某些内容导致此问题（老实说，由于其简单性，我对此表示怀疑；但总是有可能）：

```
var tags = [ 'tag1', 'tag2', 'tag3' ];

function getTag() {
    return tags[Math.floor(Math.random() * tags.length)];
}

$(document).ready(function() {
    $("#tagline").text(getTag());
}); 
```

就像我说的那样，它在内部时工作正常，但当我尝试链接到外部时却不行。我很确定这只是我指向的`<script>`情况：包含的 HTML 文件`<script>`位于`_layouts/default.html`，但脚本位于`scripts/tagline.js`：

```
<script type="text/javascript" href="../scripts/tagline.js"></script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T13:56:24.853

您要用于脚本调用的属性`src`不是`href`. 例如：

```
<script type="text/javascript" src="../scripts/tagline.js"></script> 
```

我还强烈建议使用来自站点根目录（又名 docroot）的路径，而不是相对于文件的路径。这样你就可以在多个地方使用同一个调用，并且它总是会到达正确的位置。要使用 docroot 相对 URL，路径以`/`.

假设您的脚本位于`http://example.com/scripts/tagline.js`，您将拨打的电话是：

```
<script type="text/javascript" src="/scripts/tagline.js"></script> 
```

如果不使用 docroot，您将不得不根据调用脚本的 HTML 文件在树中的位置不断调整路径。如果所有文件都在同一个地方，那没什么大不了的，但是养成避免以后出现问题的好习惯。

# java - GWT 应用程序的客户端 AOP 选项

> ID：12118784
> 
> 赞同：9
> 
> 时间：2012-08-25T02:57:40.557
> 
> 标签：java, gwt, aop

如果能够定义我自己的方法拦截器（建议）并将它们编织到我的客户端 GWT 方法中，并让 GWT 与我的应用程序的其余部分一起自动将它们编译成 JavaScript，那就太好了。

我检查了`gwt-ent`，但自 2009 年以来，它似乎并没有得到稳固的发展，并且存在很多问题。我也听说过，`gwt-tiny-aop`但听说非常有限。

我在这里还有其他选择吗？我知道 AOP 需要动态字节码生成，这反过来又需要大量反射，而且 GWT 不包含很多支持（并且似乎不鼓励）反射的做法，但我想知道是否有任何稳定的、众所周知的用于 GWT 的 AOP 库。至少我可以用来编写类似 AOP 联盟的拦截器：

```
public class MyInterceptor implements MethodInterceptor {
    @Override
    public void onIntercept(MethodInvocation mi) {
        // Do some stuff...

        // Let the method execute
        Object results = mi.proceed();

        // Analyze results...

        // Returns results
        return results;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T00:41:21.317

您可以使用 GWT 生成器：

[https://developers.google.com/web-toolkit/doc/latest/DevGuideCodingBasicsDeferred#generators](https://developers.google.com/web-toolkit/doc/latest/DevGuideCodingBasicsDeferred#generators)

# java - Java - 无法从文本字段中获取数据

> ID：12118788
> 
> 赞同：1
> 
> 时间：2012-08-25T02:59:08.970
> 
> 标签：java, string, swing, jframe, jtextfield

我已经构建了这个应用程序并尝试运行它，但我无法从`JTextField`. 我不知道出了什么问题...这是相关的代码...

构造 JTextFeild：（文件 Main.java）

```
public class Constructor extends javax.swing.JFrame {

   public Constructor() {
      initComponents();
   }

   private void initComponents() {    
      refernce = new javax.swing.JTextField();
      /*Some other code in here*/
   }

   private javax.swing.JTextField refernce;
      /*Some other code in here*/       
   } 
```

从文本字段中获取数据：（文件 Save.java）

```
public class Save {

   /*Some other code in here*/

   private javax.swing.JTextField refernce;

   String refernceText = refernce.toString();

} 
```

错误报告：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
at Save.<init>(Save.java:79)
at Constructor.saveMouseClicked(Constructor.java:444)
at Constructor.access$200(Constructor.java:15)
at Constructor$3.mouseClicked(Constructor.java:210)
at java.awt.AWTEventMulticaster.mouseClicked(AWTEventMulticaster.java:270)
... (it carry on(ask if you need it)) 
```

那我哪里错了？？？也没有语法错误等...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T03:05:55.663

这里有个问题，

```
public class Save {
  private javax.swing.JTextField refernce; <---- ISSUE
  ...
  String refernceText = refernce.toString();  
} 
```

*类*Save中的**引用*字段用初始化`null`。*

 *您必须将类的*JTextField*对象引用的引用传递`Constructor`给`Save`类。

例如，

```
public class Save {
  private javax.swing.JTextField refernce;
  public Save(javax.swing.JTextField refernce){
    this.refernce=refernce;
  } 
  ...
  //and use JTextField in your methods
  void testMethod() {
    if(refernce!=null){
     String refernceText = refernce.getText();
     .....
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T03:05:45.067

看起来您在 Save 类中声明了 JTextField 类型的引用（顺便说一句，这是一个可怕的变量名称），但您从未初始化它。这就是您收到 NullPointerException 的原因。

你在 Constructor 类中新建它。

在构造函数类中新建 JTextField 后，需要将 JTextField 变量作为参数传递给 Save 类的构造函数或 Save 类的方法，并使用它从文本中获取文本场地。

此外，您不想在 JTextField 上调用 toString。toString 不会为您获取文本字段中的数据。你想要getText()。*

# javascript - 数据和 HTML 下拉菜单

> ID：12118797
> 
> 赞同：1
> 
> 时间：2012-08-25T03:00:42.743
> 
> 标签：javascript, jquery, html, drop-down-menu

所以我正在尝试使用 Javascript/Jquery 填充 HTML 下拉列表。我希望每个`<option>`标签都有一些与之关联的数据，比如 searchPurpose、searchTime、startDate、endDate。然后我有两个问题-

1.  我应该如何关联这些数据 - 通过数据标签或其他方式？
2.  一旦我的用户点击了某个选项，我如何访问该数据？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T03:12:23.613

你在使用 jQuery 吗？如果是这样，您可能需要使用内置数据模块。如果没有，请使用数据标签。我建议将所有数据放在一个数据标签中。IE

```
data="searchPurpose: thing, searchTime: sometime" 
```

并像这样分开它：

```
function data(elem) {
    var data = {};
    var a = elem.getAttribute('data').split(',');
    var i = 0;
    while(i < a.length){
        data[a[i].split(':')[0]] = a[i].split(':')[1];
        i++;
    }
    return data;
} 
```

所以：

```
data() returns an object literal like this: { searchPurpose: 'thing', searchTime: 'sometime' } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T03:13:49.353

使用 HTML5，`data-*`属性绝对是要走的路。假设您有以下内容：

```
<select id="ddl">
  <option data-start-date="25-08-2012" value="1">A</option>
  <option data-start-date="25-08-2013" value="1">B</option>
</select> 
```

要使用纯 JavaScript 访问它们的值，请使用：

```
selectedOption.getAttribute("data-start-date"); 
```

使用 jQuery [`data()`](http://api.jquery.com/data/)：

```
$("#ddl").on('change', function () {
  var selectedOption = this.options[this.selectedIndex];
  alert($(selectedOption).data("start-date"));
}); 
```

**[演示](http://jsfiddle.net/RVVpN/)**。 **[演示](http://jsfiddle.net/e6zZB/)**（jQuery）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T03:15:10.507

有很多方法可以将数据与`option`标签相关联。我脑子里冒出的一些想法：

*   使用隐藏输入：`<option id="option1">Option 1</option><input type="hidden" id="option1data" value="option1 data here" />`
*   使用`data-`属性（并非所有浏览器都支持）：`<option id="option1" data-searchPurpose="searchPurpose">Option 1</option>`
*   如果你使用 jQuery，你可以使用[它的 .data() 方法](http://api.jquery.com/data/)：`$('#option1').data('searchPurpose', 'data...');`

就访问数据而言，这取决于您对下拉列表的操作。如果它们以表单的形式提交，您可以使用一些`onSubmit`JavaScript **a)**返回 false *，然后* **b)**`post`使用附加的额外数据或`get`附加数据提交表单。（在隐藏输入解决方案的情况下，不需要这种 JavaScript 干预。）

否则，使用 Javascript 访问/修改数据应该非常简单。

# java - 通过 Ant 编译 GWT

> ID：12118800
> 
> 赞同：10
> 
> 时间：2012-08-25T03:01:28.780
> 
> 标签：java, gwt, ant, build

是否可以从 Ant 构建文件运行 GWT 编译器（Java 到 JavaScript）并可能运行其他 GWT 工具（例如编译报告、在开发模式下运行等）？如果是这样，这些 Ant 任务是在哪里定义的？我在 SDK 中看不到任何内容。

我*无法*想象 Google 会做出像 GWT 一样强大的东西，并*迫使*开发人员只在他们的本地 Eclipse 实例中运行构建...... CI 构建如何启动这些东西？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-25T09:30:34.227

在文档中，Google 会告诉您编译器、DevMode、JUnit 等的命令行参数。

*   [开发模式选项](https://developers.google.com/web-toolkit/doc/latest/DevGuideCompilingAndDebugging#What_options_can_be_passed_to_development_mode)
*   [GWT 编译器选项](https://developers.google.com/web-toolkit/doc/latest/DevGuideCompilingAndDebugging#DevGuideCompilerOptions)
*   [启动代码服务器](https://developers.google.com/web-toolkit/articles/superdevmode#Starting)（超级开发模式）
*   [运行 JUnit 测试用例](https://developers.google.com/web-toolkit/doc/latest/DevGuideTesting)（搜索`TestRunner`）

当然，还有[命令行工具](https://developers.google.com/web-toolkit/doc/latest/RefCommandLineTools)，它谈到了`webAppCreator`生成 Ant 构建文件的工具。该工具也出现在[Getting Started](https://developers.google.com/web-toolkit/gettingstarted)页面（直接使用 Ant 作为构建工具，甚至不谈论 Eclipse）和[教程](https://developers.google.com/web-toolkit/doc/latest/tutorial/create)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-25T03:37:55.417

你正在寻找这样的东西吗？

```
 <target name="gwt-compile" depends="compile" description="GWT compile to JavaScript">
<java failonerror="true" fork="true" classname="com.google.gwt.dev.Compiler">
    <classpath>
        <pathelement location="${src.dir}" />
        <pathelement location="${build.classes}" />
        <path refid="compile.classpath" />
        <path refid="gwt-dev.classpath" />
    </classpath>
    <jvmarg value="-Xmx256M" />
    <arg value="com.xxxx.xxx.xxx.xxx" />
</java>  
</target>

 <target name="devmode" depends="" description="Run development mode">
<java fork="true" classname="com.google.gwt.dev.DevMode" 
    dir="${basedir}/war" spawn="true">
    <classpath>
        <pathelement location="src" />
        <path refid="project.class.path" />
        <path refid="tools.class.path" />
    </classpath>
    <jvmarg value="-Xmx512M" />
    <jvmarg value="-javaagent:${appengine.folder}/lib/agent/appengine-agent.jar" />
    <jvmarg value="-Duser.dir=${basedir}/war" />
    <arg line="-war" />
    <arg value="${basedir}/war" />
    <arg line="-logLevel" />
    <arg value="INFO" />
    <arg value="-server" />
    <arg value="com.google.appengine.tools.development.gwt.AppEngineLauncher" />
    <arg value="net.bookedin.bam.BAM" />
</java>
</target> 
```

# mysql - SQL语句4表连接

> ID：12118802
> 
> 赞同：0
> 
> 时间：2012-08-25T03:02:27.750
> 
> 标签：mysql, sql

您好，目前我的数据库中有 4 个表：tb_student、tb_history、tb_section 和 tb_adviser。到目前为止，我用这条线向我展示了一个给定学生的历史：

```
 $qry_display = "SELECT
        a.student_id, a.section_id, a.level, a.photo, a.address, a.father_occupation, a.father_phone, a.father_company, a.mother_occupation, a.mother_phone, a.mother_company,a.gpa,
        b.fname, b.sex, b.lname, b.mname, b.birth_date, b.birth_place, b.address, b.father, b.father_degree, b.mother, b.mother_degree,
        c.section_name, c.adviser_id
        FROM tbl_er AS a
        LEFT OUTER JOIN tbl_enroll AS b ON a.student_id = b.student_id
        LEFT OUTER JOIN tbl_section AS c ON a.section_id = c.section_id
        WHERE a.student_id=".$id." AND a.level='1st Year'"; 
```

我的主要问题是现在我需要在这些其他信息中显示顾问的姓氏。所以我想把。请注意，tb_adviser 仅通过 advisor_id 连接到 tb_section

```
 LEFT OUTER JOIN tbl_adviser AS d ON a.student_id = c.adviser_id 
```

我在 where 语句之前添加了这一行。并将这一行插入到我的 SELECT 字段中。

```
 d.lname_adviser 
```

目前它不起作用。任何人都会对我的问题有所了解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T03:14:15.233

查看 db 结构会有所帮助，但看起来您正试图在两个不匹配的列上加入 JOIN。a.student_id 会匹配 c.adviser_id 吗？

假设 advisor_id 是 tbl_advisor 中的 id 然后只需添加

```
 LEFT OUTER JOIN tbl_advisor AS d 
 ON d.id = c.advisor_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T03:11:41.070

尝试这个：

我认为你应该这样做

```
LEFT OUTER JOIN tbl_adviser AS d ON d.adviser_id = c.adviser_id 
```

所以你的查询是：

```
Select .....
FROM tbl_er AS a
LEFT OUTER JOIN tbl_enroll AS b ON a.student_id = b.student_id
LEFT OUTER JOIN tbl_section AS c ON a.section_id = c.section_id
LEFT OUTER JOIN tbl_adviser AS d ON d.adviser_id = c.adviser_id 
WHERE a.student_id=".$id." AND a.level='1st Year' 
```

# sql - 为什么 AVG(x) 给出的答案与 AVR((isnull(x,0)) 不同？

> ID：12118805
> 
> 赞同：1
> 
> 时间：2012-08-25T03:03:06.580
> 
> 标签：sql, null, aggregate-functions

X 是混合了数值和空值的列。

我不明白为什么将空值视为 0 会更改 AVG 值的结果。

不应该是这样吗

```
(2 + null + 2) / 3 = 2 -- with null value

(2 + 0 + 2) / 3 = 2     -- no null value 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T03:04:37.410

如果您有`null`值，则不会将其考虑在内，因此元素的数量（您的`n`）不会增加，而`0`被视为有效值。

例如，如果您有：`1,1,6,7,null,3,2`它将被总数`20`除以**`6`**(ie `3.33`)。但是，如果你用它替换`null`它`0`就会变成`20` `/`**`7`**（即`2.86`）。

[SQLFiddle](http://sqlfiddle.com/#!2/b2b3c/2)在 MySQL 服务器上演示了这种行为。

**参考**：查看表格下方的[文档：](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)

```
This section describes group (aggregate) functions that operate on sets of values. Unless otherwise stated, group functions ignore NULL values. 
```

# web-services - Spring webservices如何传递文件字节

> ID：12118807
> 
> 赞同：0
> 
> 时间：2012-08-25T03:03:44.723
> 
> 标签：web-services, spring, spring-mvc

我正在尝试编写一个 spring webservices，它将用于将文件作为 byte[] 值传递。这可以使用网络服务吗？任何人都可以在任何网站上展示一个例子吗？我已经搜索了很多，我找不到一个。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T16:45:35.580

你有几个选择：

*   [mtom](/questions/tagged/mtom "显示标记为“mtom”的问题")规范，例如在[jaxb](/questions/tagged/jaxb "显示标记为“jaxb”的问题")中支持，在[spring-ws](/questions/tagged/spring-ws "显示标记为“spring-ws”的问题")中也类似：[Stream MTOM Web Services in Spring Web Services Framework](https://stackoverflow.com/questions/1842843)

*   [xml-schema](/questions/tagged/xml-schema "显示标记为“xml-schema”的问题")中有一些特殊的数据类型可以处理二进制数据，请参阅：[JAXB (un)marshalling of xsd types: xsd:base64Binary and xsd:hexBinary](https://stackoverflow.com/questions/4202108)

*   最后，您可以自己将这些数据序列化为文本格式（例如使用[base64](/questions/tagged/base64 "显示标记为“base64”的问题")`xsd:string` ）并使用简单类型作为请求的一部分传递

# java - java导入用户定义的包 - 错误：找不到符号

> ID：12118809
> 
> 赞同：1
> 
> 时间：2012-08-25T03:04:14.747
> 
> 标签：java, package

我的目录结构如下：

```
/WorkingDirectory
    MyCollection.java
    /au/edu/au
        /UserInterface
            UserInterface.java
        /Collection
            Album.java
            CDAlbum.java
            DVDAlbum.java
            CollectionFactory.java 
```

其中 Album.java 是 CDAlbum.java 和 DVDAlbum.java 实现的接口。每个 .java 文件都有相应的

```
package au.edu.uow.UserInterface; 
```

或者

```
package au.edu.uow.Collection; 
```

线。

在 UserInterface.java 我声明了一个 Album 类型的 ArrayList，这给了我编译错误

```
.\au\edu\uow\UserInterface\UserInterface.java:9: error: cannot find symbol
    private ArrayList<Album> myCollection;
                      ^
symbol:   class Album
location: class UserInterface 
```

我正在从 MyCollection.java 编译，其中包含两个包的导入语句。

是什么导致了这个错误？我尝试添加

```
import au.edu.uow.Collection 
```

到 UserInterface.java，但无济于事。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-25T03:09:26.297

您需要：

```
import au.edu.uow.Collection.*; 
```

或者：

```
import au.edu.uow.Collection.Album; 
```

使用通配符导入更方便，但有些人认为这是一种不好的做法。这是风格问题；自己决定。

包名称全小写也被认为是一种很好的风格，尽管编译器没有强制要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T03:16:00.643

所以，你的文件夹结构看起来像`/au/edu/au`&你试图从`au.edu.uow`

除了 JimN 的建议之外，我想你会发现 Java 会抱怨 te`package`不存在或其中的文件`/au/edu/au`有误`package`

更改目录结构或`package`结构以相互匹配

# batch-file - for循环批处理文件中的算术

> ID：12118810
> 
> 赞同：8
> 
> 时间：2012-08-25T03:04:19.747
> 
> 标签：batch-file, cmd

我在一个批处理文件中有一个 for 循环，如下所示：

```
for %%y in (100 200 300 400 500) do (
    set /a x = y/25     
    echo %x%
) 
```

该行：

```
set /a x = y/25 
```

似乎没有进行任何划分。将每个 y 除以 25 的正确语法是什么？我只需要这个除法的整数结果。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-25T03:24:42.487

无需扩展环境变量即可在 SET /A 语句中使用。但是必须扩展 FOR 变量。

此外，即使您的计算有效，ECHO 也会失败，因为在解析语句时会发生百分比扩展，并且一次解析整个 FOR 构造。因此 %x% 的值将是执行循环之前存在的值。要获取在循环中设置的值，您应该使用延迟扩展。

此外，您应该删除赋值运算符之前的空格。您正在声明一个名称中带有空格的变量。

```
@echo off
setlocal enableDelayedExpansion
for %%A in (100 200 300 400 500) do (
  set n=%%A

  REM a FOR variable must be expanded
  set /a x=%%A/25

  REM an environment variable need not be expanded
  set /a y=n/25

  REM variables that were set within a block must be expanded using delayed expansion
  echo x=!x!, y=!y!

  REM another technique is to use CALL with doubled percents, but it is slower and less reliable
  call echo x=%%x%%, y=%%y%%
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T03:12:22.473

它什么也没做，因为“y”只是一个字母。您需要百分号来引用变量。

```
set /a x = %%y/25 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-04T15:32:26.260

我遇到了同样的问题，但结果是一个整数问题。我在除法后乘法，但之前需要。发生的事情是这样的： 1/100x100 运行方式类似于 1\100=0 然后 0x100=0 我将其更改为 1x100/100 运行方式类似于 1x100=100 然后 100/100=1

```
@echo off
setlocal ENABLEDELAYEDEXPANSION
for /f "usebackq" %%b in (`type List.txt ^| find "" /v /c`) do (
    set Count=%%b
    )
)
REM Echo !Count! -->Returns the correct number of lines in the file
for /F "tokens=*" %%A in (List.txt) do (
    set cName=%%A
    set /a Number+=1
    REM Echo !Number! -->Returns the correct increment of the loop
    set /a Percentage=100*!Number!/!Count!
    REM Echo !Percentage! -->Returns 1 when on the first line of a 100 line file
    set a=1
    set b=1000
    set /a c=100*1/100
    Rem -->echo c = !c! --Returns "C = 1"
) 
```

# javascript - 在 UIWebView 中查找并突出显示带有变音符号文本的阿拉伯语

> ID：12118812
> 
> 赞同：5
> 
> 时间：2012-08-25T03:04:37.697
> 
> 标签：javascript, objective-c, search, uiwebview, arabic

我正在 UIWebView 中查看带有变音符号（tashkel）文本的阿拉伯语。我也有一个搜索视图。

我想给 UIWebView 一个关键字，UIWebView 会找到并突出显示它，但搜索应该忽略变音符号。

正文应保留变音符号。

示例：如果文本是“ الَلَهُم صَلِ عَلى مُحَمّد و آل مُحمد ”，我告诉 UIWebView 搜索“ محمد ”，它应该突出显示“ مُحَمّد ”和“ مُحمد ”，而不管所有变音符号。

我想到了两种方法： 1-我在 UIWebView 加载后通过 Javascript 进行查找和突出显示。2-我在加载 UIWebView 之前通过 Objective-C 编辑文本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T05:15:27.697

您必须首先从字符串中删除所有变音符号，然后您可以在没有任何变音符号的情况下进行比较。使用正则表达式删除不需要的字符。看看我做的[这个小提琴](http://jsfiddle.net/kdaker/6JeWb/4/)`strip()`，在函数里面你需要添加你需要取出的所有变音符号。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-08T10:24:39.440

以下版本不会删除 sukoon。这是我的版本。我已将八个变音符号（fatha、kasrah、damma、shaddah、sukoon 和 tanween）转换为对应的 Unicode。在任何文本编辑器中操作转换为拉丁字符的阿拉伯语要容易得多 **试试下面**：

```
<html>
 <head><meta charset="UTF-8"></head>
<body>
<script>document.write("حَرْفٌ".replace(/(\u0652)|(\u0650)|(\u064C)|(\u064E)|(\u064B)|(\u064F)|(\u064D)|(\u0651)/g,""));</script>
</body>
</html>
```

使用的资源： [带有变音符号的阿拉伯语键盘](http://www.arabic-keyboard.org/) [Unicode 代码转换器](http://rishida.net/tools/conversion/)

# javascript - .ajax 调用在 chrome 中不起作用

> ID：12118813
> 
> 赞同：0
> 
> 时间：2012-08-25T03:04:38.037
> 
> 标签：javascript, jquery, html, ajax, google-chrome

我有一个解析 xml 文件的 ajax 调用。我已将异步设置为 false，但它仍然无法正常工作。我在 ajax 调用之前和之后都有警报，它似乎在连续工作。任何人都可以让我知道我哪里出错了。这是我正在做的代码段

```
var i = 0;

var xmlLength = 0;
var arr = new Array();

alert("1");
$.ajax({
  type: "GET",
  url: "sample.xml",
  async: false,
  dataType: "xml",
  success: function (xml) {
    $(xml).find('CD').each(function () {
      alert("2");
      i = i + 1;
      xmlLength += 1;

      var title;
      var getTo;
      var artist;
      var getToNode;
      var $allToElements = 'TO';

      var country = $(this).find('COUNTRY').text();
      getTo = $(this).find('TO'); //.text();

      if (getTo.length > 1) {
        var $divId = "window" + i;
        $('<div class="window" id="window' + i + '" />')
          .append('<div class="topright" id="topright' + i + '"/>')
          .append('<div class="topleft" id="topleft' + i + '"/>')
          .append('<div class="bottomright" id="bottomright' + i + '"/>')
          .append('<div class="bottomleft" id="bottomleft' + i + '"/>')
          .appendTo('div#demo1');
        var countr = $(this).find('COUNTRY').text();
        $('div#topright' + i).append(countr);
        $('div#topleft' + i).append('NW');
        $('div#bottomleft' + i).append('SW');
        $('div#bottomright' + i).append('SE');
        var j = 0;
        $(this).find('TO').each(function () {
          var $name = $(this).text();
          j += 1;
          $('div#window' + i).append($('<p id="to' + i + '">').text($name));
        });
      } else {
        var $divId = "window" + i;

        $('<div class="window" id="window' + i + '" />')
          .append('<div class="topright" id="topright' + i + '"/>')
          .append('<div class="topleft" id="topleft' + i + '"/>')
          .append('<div class="bottomright" id="bottomright' + i + '"/>')
          .append('<div class="bottomleft" id="bottomleft' + i + '"/>')

          .append($('<p id="to' + i + '">').text(getTo.text()))
          .appendTo('div#demo1');
        var countr = $(this).find('COUNTRY').text();

        $('div#topright' + i).append(countr);
        $('div#topleft' + i).append('NW');
        $('div#bottomleft' + i).append('SW');
        $('div#bottomright' + i).append('SE');
      }

      arr[i] = getTo;
    }); //end of find
  }
}); //end of ajax function

var j;
alert("3"); 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T03:12:39.243

请注意，Google Chrome 无法通过 XmlHttpRequest（用于 ajax 和`jQuery.ajax`函数）处理本地文件。所以你不能加载路径看起来像的文件`file://...`。

# php - 我如何覆盖 symfony 使用的“实体”自定义表单类型

> ID：12118816
> 
> 赞同：2
> 
> 时间：2012-08-25T03:05:03.037
> 
> 标签：php, symfony, doctrine-orm

我正在制作我自己的自定义表单类型，它是从实体扩展而来的。像这样

```
public function getParent()
    {
        return 'entity';
    }

    public function getName()
    {
        return 'gender';
    } 
```

现在在自定义表单字段中，我用这个显示表单

```
{% for child in form %}
               {{ form_widget(child) }} 
```

所以这意味着，我得到了基于否的表格集合。从查询中收到的实体。

现在对于每种形式，我都`label , value`存储在`vars`变量中。

现在有什么方法可以在这些变量中存储一个额外的变量，例如 category_id。这样我就可以为表单的每个子项设置差异值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T18:05:09.627

您应该实现 buildView 方法：

```
public function buildView(FormView $view, FormInterface $form, array $options)
{
    $view->vars = array_replace($view->vars, array(
        'yourfield' => 'yourvalue'
    ));
} 
```

# ruby-on-rails - 为什么我无法在 has_one 关系中保存关联对象？

> ID：12118820
> 
> 赞同：0
> 
> 时间：2012-08-25T03:05:10.323
> 
> 标签：ruby-on-rails, activerecord

我有一个有一个结果的pickem 对象。我在将结果正确保存到数据库时遇到问题。

pickems_controller.rb

```
def results
 @pickem = Pickem.find params[:id]
 # @pickem.result = @pickem.build_result if @pickem.result.blank?
 @pickem.result = Result.new
end

def update_results
 @pickem = Pickem.find params[:id]
 @pickem.result = Result.new params[:pickem][:result_attributes]

 if @pickem.result.update_attributes params[:pickem][:result_attributes]
  redirect_to edit_pickem_results_path(@pickem), :notice => 'The results have been successfully updated.'
 else
  render "edit"
 end
end 
```

结果.html.erb

```
<%= simple_form_for @pickem, :url => edit_pickem_results_path(@pickem), :method => :put,  do |f| %>

 <%= f.simple_fields_for :result do |r| %>
  <%= r.input :first_name %>
  ...
 <% end %>

 <%= f.submit :class => 'btn btn-success', :label => 'Submit Results' %>

<% end %> 
```

皮克姆.rb

```
has_one :result, :dependent => :destroy
accepts_nested_attributes_for :result 
```

结果.rb

```
belongs_to :pickem 
```

我最初使用的是在控制器中注释掉但不得不退出的 build_result 代码。使用 build_result，结果记录会在有人点击结果表单的瞬间保存到数据库中。如果输入了结果，应用程序中有一些规则不允许用户进行任何选择。因此，即使用户点击了结果表单但没有提交，结果仍在创建中。

如何构建表单并仅在用户单击保存时才保存结果记录，而不是在加载表单时？我在上面粘贴的当前解决方案不起作用。它使用适当的外键保存结果记录，但从不获取表单数据。如果我转储@pickem.result 正确的表单数据在结果对象中，我就无法正确保存它。我尝试过正确保存表单数据但外键为 0 的其他解决方案。

编辑：无论出于何种原因`@pickem.result = Result.new`仍在将记录保存到数据库中，所以我将其更改为`@result = Result.new`并更新表格如下：

```
<%= simple_form_for @result, :url => edit_pickem_results_path(@pickem), :method => :put,  do |r| %>

 <%= r.input :first_name %>
 <%= r.submit :class => 'btn btn-success', :label => 'Submit Results' %>

<% end %> 
```

然后使用 Chuck W of 的建议`@result = @pickem.result.build params[:result]`，我得到`undefined method`了 nil:NilClass` 的 build'。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T05:43:33.017

pickems_controller.rb

```
def results
  @pickem = Pickem.find params[:id]
  @pickem.result.blank? ? @result = Result.new : @result = @pickem.result
end

def update_results
  @pickem = Pickem.find params[:id]
  @result = @pickem.result.build params[:pickem][:result]   
  if @result.save
   redirect_to edit_pickem_results_path(@pickem), :notice => 'The results have been successfully updated.'
  else
   render "edit"
  end
end 
```

然后，您的视图应如下所示：

```
<%= simple_form_for @pickem, :url => edit_pickem_results_path(@pickem), :method => :put,  do |f| %>

 <%= f.simple_fields_for @result do |r| %>
  <%= r.input :first_name %>
  ...
 <% end %>

 <%= f.submit :class => 'btn btn-success', :label => 'Submit Results' %>

<% end %> 
```

您可能不得不考虑如何将参数传递回 update_results 操作（我对 rails 很陌生），但我认为您明白了它的要点。

# windows-8 - 引用自定义 WinRT 组件会破坏 javascript 类？

> ID：12118821
> 
> 赞同：2
> 
> 时间：2012-08-25T03:05:27.717
> 
> 标签：windows-8, microsoft-metro, windows-runtime, winjs

我有一个我正在处理的 javascript Windows Store 应用程序，我需要创建一个 WinRT 组件来进行一些处理。一旦我添加对该组件的引用，我就会收到一个 javascript 错误：

0x800a01bd - Javascript 运行时错误：对象不支持此操作。

这发生在带有以下内容的行上：

```
engine = new MyApp.Engine(); 
```

定义：

```
WinJS.Namespace.define("MyApp", {
  Engine: WinJS.Class.define(function() {
    //constructor stuff
    //other stuff snipped for brevity
  }
}); 
```

我什至没有访问我的自定义组件中的任何代码，只是添加引用会导致它中断。有人遇到这个吗？谷歌搜索/Binging 没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T05:19:53.997

我找到了答案。

所以在我的 Javascript 代码中，我有一个命名空间的声明。

在我的 WinRT C# 组件中，我使用了相同的命名空间。那个命名空间显然踩了我的 JS 命名空间声明。我从这里更改了我的 WinRT 组件：

```
namespace MyApp
{
  public sealed class SomeClass
  {
  }
} 
```

到：

```
namespace MyAppUtils
{
  public sealed class SomeClass
  {
  }
} 
```

现在一切都很好......所以，教训：如果您使用 JS 和自定义 WinRT 组件，您（显然）不能在两者中使用相同的命名空间。

# mysql - 表达式中的 REPLACE 和 IF 导致前一行的连接

> ID：12118824
> 
> 赞同：3
> 
> 时间：2012-08-25T03:05:50.963
> 
> 标签：mysql, if-statement, replace

下面的sql语句：

```
SELECT 
    profile_pic
FROM
    (`member`) 
WHERE 
    `active` = 1 
```

产生以下结果：

```
profile_pic
    1_1345694557.jpg
    <blank_value>
    <blank_value>
    <blank_value> 
```

我希望“空白值”默认为“no_prof_thumb.jpg”。

所以我创建了这个声明：

```
SELECT 
    REPLACE(IF (CHAR_LENGTH(profile_pic) > 0, profile_pic, 'no_prof.jpg' ), '.jpg', '_thumb.jpg') AS profile_pic 
FROM 
    (`member`) 
WHERE 
    `active` = 1 
```

结果如下：

```
profile_pic
1_1345694557_thumb.jpg
no_prof_thumb.jpg
no_prof_thumb_thumb.jpg
no_prof_thumb_thumb_thumb.jpg 
```

为什么`_thumb`不断将自己附加到上一行中的值？

我应该如何修复我的表情？

* * *

# 更新

此问题发生在 GoDaddy mySQL 数据库上。我通过 SQLyog 远程连接以及登录 GoDaddy 并通过 phpMyAdmin 运行它时重现。

但是，我无法在本地重现，也无法在 sqlFiddle 上重现。
所以它一定是某种配置问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T04:07:13.367

您需要在这样的语句`IF`之外使用。`REPLACE`

```
SELECT 
    IF (profile_pic = '', 'no_prof.jpg', 
        REPLACE(profile_pic, '.jpg', '_thumb.jpg')) AS profile_pic 
FROM 
    (`member`) 
WHERE 
    `active` = 1 
```

您也可以使用[`CASE`](http://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html)语句而不是`IF`这样：

```
SELECT
  CASE  profile_pic
    WHEN '' THEN 'no_prof.jpg'
    ELSE REPLACE(profile_pic, '.jpg', '_thumb.jpg')
  END AS profile_pic
FROM member
WHERE active = 1; 
```

# [*看到这个小提琴*](http://sqlfiddle.com/#!2/2fb8d/13)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T03:13:21.130

嵌套逻辑有点奇怪。`CASE`你可以用一个语句来简化它。如果值为空字符串，则返回`no_prof_thumb.jpg`。否则，替换`.jpg`为`_thumb.jpg`。

```
SELECT
  CASE  
    WHEN profile_pic = '' THEN 'no_prof_thumb.jpg'
    ELSE REPLACE(profile_pic, '.jpg', '_thumb.jpg')
  END AS profile_pic
FROM member
WHERE active = 1 
```

我不能解释为什么你会得到奇怪的结果，但没有进一步的测试。

# php - 下拉框发布错误的值

> ID：12118826
> 
> 赞同：0
> 
> 时间：2012-08-25T03:06:10.877
> 
> 标签：php, forms

我希望这是一件小事。在梳理了几个小时并尝试了各种变化之后，我决定让专业人士对此有所了解。我有一个页面设置来轻松管理数据库。基本上只是为了更新一行或删除它。对于每一行，我都有一个复选框来更新行，复选框来删除，三列来自数据库的信息，然后两列带有下拉框来更改值。问题是无论我从下拉列表中选择什么值，它总是发布相同的值。使用 print_r($_POST) 我可以看到它实际上返回了错误的值。废话不多说，代码：

这是我页面的顶部（表单发布到自身）：

```
 if(isset($_POST['checkbox'])){
    $product = $_POST['product_choice'];
    $status = $_POST['status_choice'];
    $checkbox = $_POST['checkbox'];
    if(isset($_POST['update'])){
    $update = $_POST["update"];
    }
    $id = "('" . implode( "','", $checkbox ) . "');" ;
    $sql="UPDATE test_orders SET product='$product',status = '$status' WHERE ordNum IN $id" ;
    $result = mysql_query($sql) or die(mysql_error());
      } 
```

和形式：

```
<table width="400" border="0" cellspacing="1" cellpadding="0">
<tr>
<td><form name="frmactive" method="post" action="">
<table width="400" border="0" cellpadding="3" cellspacing="1">

<!--BUTTONS--> 

<tr>  
<td colspan="6"><input name="update" type="submit" id="update" value="Upate" />
<input name="delete" type="submit" id="delete" value="Delete" /></td>
</tr>

<tr>
<td>&nbsp;</td>
<td colspan="5"><strong>Update multiple rows in mysql with checkbox</strong> </td>
</tr>
<tr>
<td style="background: #ddd; padding:5px; border-left:1px solid #ccc; border-top:1px solid #ccc;">Update?</td>

<td style="background: #ddd; padding:5px; border-left:1px solid #ccc; border-top:1px solid #ccc;">Delete?</td>

<td style="background: #ddd; padding:5px; border-left:1px solid #ccc; border-top:1px solid #ccc;">Order #</td>

<td style="background: #ddd; padding:5px; border-left:1px solid #ccc; border-top:1px solid #ccc;">Name</td>

<td style="background: #ddd; padding:5px; border-left:1px solid #ccc; border-top:1px solid #ccc;">Job Name</td>

<td style="background: #ddd; padding:5px; border-left:1px solid #ccc; border-top:1px solid #ccc;">Product</td>

<td style="background: #ddd; padding:5px; border-left:1px solid #ccc; border-top:1px solid #ccc;">Status</td>

</tr>
<?php
while($rows=mysql_fetch_array($result)){
?>

<tr>
<td align="center"><input name="checkbox[]" type="checkbox" id="checkbox[]" value="<? echo $rows['ordNum']; ?>"></td>
<td bgcolor="#FF0000" align="center"><input type="checkbox" name="delete[]" id="delete[]" value="<? echo $rows['ordNum']; ?>" /></td>
<td><? echo $rows['ordNum']; ?></td>
<td><? echo $rows['name']; ?></td>
<td><? echo $rows['OrderDesc']; ?></td>
<td>
<select name="product_choice" id="product" style="font-size:10px;">

            <option value="<? echo $rows['product']; ?>" selected="selected"><? echo $rows['product']; ?>
            </option>
            <option value="Color Correction"> Color Correction </option>
            <option value="Basic retouch"> Basic retouch </option>
            <option value="Extensive Retouch"> Extensive Retouch </option>
            <option value="Signature Work"> Signature Work </option>
            <option value="Signature Oil"> Signature Oil </option>
            <option value="Web Design"> Web Design </option>
            <option value="Print Design"> Print Design </option>
            <option value="Other"> Other </option>
          </select>

</td>

<td>
   <select name="status_choice" id="status" style="font-size:10px;">

            <option value="<? echo $rows['status']; ?>" selected="selected"><? echo $rows['status']; ?></option>
            <option value="Order Received"> Order Received </option>
            <option value="in the works"> in the works </option>
            <option value="waiting to upload"> waiting to upload </option>
            <option value="uploading"> uploading </option>
            <option value="ON HOLD"> ON HOLD </option>
            <option value="awaiting decision"> awaiting decision </option>
            <option value="proof sent"> proof sent </option>
            <option value="next invoice"> next invoice </option>
            <option value="waiting images/order"> waiting images/order </option>
            <option value="invoiced"> invoiced </option>
            <option value="complete"> complete </option>
            <option value="paid"> paid </option>
            <option value="making changes"> making changes </option>
          </select>

    </td>

    </tr>

<?php
}
?>
<tr>
<td colspan="6" align="center">&nbsp;</td>
</tr>
</table>
</form>
</td>
</tr>
</table> 
```

这是 print_r($_POST); 的结果 无论我在下拉菜单中选择什么选项。[product_choice] 和 [status_choice] 始终相同。

```
Array ( [update] => Upate [checkbox] => Array ( [0] => 113 ) [product_choice] => Extensive Retouch [status_choice] => Order Received ) 
```

谢谢你的帮助。

****** *** *已***解决****** ** *** ** *** **** 得到朋友的帮助，工作良好如下**

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T03:22:32.260

问题是您在循环中有一个带有静态名称的选择

```
<select name="product_choice" id="product" style="font-size:10px;"> 
```

所以你会有一堆同名的选择框，所以它们会互相覆盖，只有页面上的最后一个是正确的。您可以给它们一个唯一的名称或使其成为一个数组。

这与您的状态一相同

```
<select name="status_choice" id="status" style="font-size:10px;"> 
```

所以做类似的事情

```
<select name="status_choice[<?=$rows['id']?>]> 
```

然后得到结果..

```
foreach($_POST['product_choice'] as $key => $product)
{
    $status = $_POST['status_choice'][$key];
    $sql = sprintf('UPDATE test_orders SET product = "%s", status="%s" WHERE ordNum = %s', 
        mysql_real_escape_string($product), mysql_real_escape_string($_POST['status_choice'][$key]), mysql_real_escape_string($_POST['checkbox'][$key]));
    $result = mysql_query($sql) or die(mysql_error());     
} 
```

然后将您的复选框名称更改为`checkbox[<?=$rows['product']?>]`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-28T19:56:22.483

打开 foreach 循环：

```
foreach($_POST as $key => $value) {
    if(!is_array($value)) {
        $_POST[$key] = mysql_real_escape_string($value);
    } else {
        foreach($value as $key => $value) {
            $_POST[$key][$key] = mysql_real_escape_string($value);
        }
    }
}

//print_r($_POST);

// * Delete multiple via checkboxes * START *
if(isset($_POST['delete'])) { 
    if(is_array($_POST['delete'])) {
        foreach($_POST['delete'] as $value) { 
            if(intval($value)) {
                echo 'The order number '.$value.' has been deleted';
                $sql_query = mysql_query("DELETE FROM $tbl_name WHERE ordNum = $value"); 
            }
        } 
    }
} elseif(isset($_POST['checkbox'])) {
    if(isset($_POST['product_choice'])) {
        foreach($_POST['product_choice'] as $key => $value) {
            if(intval($key)) {
                $sql_query = 'UPDATE '.$tbl_name.' SET product = "'.$_POST['product_choice'][$key].'", 
                              status = "'.$_POST['status_choice'][$key].'" WHERE ordNum = '.$key;
                echo $result = mysql_query($sql_query) or die(mysql_error()); 
            }
        }
    }
} 
```

和下拉框：

```
<td>
<?//php echo $rows['product']; ?>
<select name="product_choice[<?php echo $rows['ordNum']?>] id="product" style="font-size:10px;">
            <option value="<?php echo $rows['product']; ?>" selected="selected"><?php echo $rows['product']; ?></option>
            <option value="Color Correction"> Color Correction </option>
            <option value="Basic retouch"> Basic retouch </option>
            <option value="Extensive Retouch"> Extensive Retouch </option>
            <option value="Signature Work"> Signature Work </option>
            <option value="Signature Oil"> Signature Oil </option>
            <option value="Web Design"> Web Design </option>
            <option value="Print Design"> Print Design </option>
            <option value="Other"> Other </option>
          </select>

</td>

<td>
   <select name="status_choice[<?php echo $rows['ordNum']?>] id="status" style="font-size:10px;">

            <option value="<?php echo $rows['status']; ?>" selected="selected"><?php echo $rows['status']; ?></option>
            <option value="Order Received"> Order Received </option>
            <option value="in the works"> in the works </option>
            <option value="waiting to upload"> waiting to upload </option>
            <option value="uploading"> uploading </option>
            <option value="ON HOLD"> ON HOLD </option>
            <option value="awaiting decision"> awaiting decision </option>
            <option value="proof sent"> proof sent </option>
            <option value="next invoice"> next invoice </option>
            <option value="waiting images/order"> waiting images/order </option>
            <option value="invoiced"> invoiced </option>
            <option value="complete"> complete </option>
            <option value="paid"> paid </option>
            <option value="making changes"> making changes </option>
          </select>

    </td> 
```**

# asp.net-mvc - MVC 4 移动视图未正确呈现

> ID：12118829
> 
> 赞同：0
> 
> 时间：2012-08-25T03:06:33.317
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我遇到了与下一页列出的完全相同的问题。还尝试了论坛中所说的所有内容，但无法正常工作。请问有什么帮助吗？？？？？？

[ASP.NET MVC 4 移动显示模式停止工作](https://stackoverflow.com/questions/9354188/asp-net-mvc-4-mobile-display-modes-stop-working/12118815)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T16:01:44.613

好的，这是 MVC 4 RC 中的一个错误。 [http://aspnetwebstack.codeplex.com/workitem/280](http://aspnetwebstack.codeplex.com/workitem/280)

# php - 电子商务优惠券代码：生成许多映射到一个折扣的独特优惠券？

> ID：12118830
> 
> 赞同：2
> 
> 时间：2012-08-25T03:06:37.553
> 
> 标签：php, e-commerce, coupon

我正在使用 php 制作自己的电子商务网站。我想向我过去的客户提供优惠券代码，而不向可能像野火一样四处传播的每个人发送通用的“10%OFF”。我希望每个代码都是唯一的，但映射到已知的折扣值。

是否有我可以使用的插件/框架/简单功能可以即时评估优惠券代码（字符串），而无需使用所有可能的组合为我的数据库播种？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-12-07T11:38:26.123

试用[Voucherify](http://www.voucherify.io/?utm_source=stackoverflow&utm_medium=answer&utm_campaign=acq) - 它是优惠券代码的 API。使用他们的[网络应用程序](http://app.voucherify.io/#/signup)，您将能够创建优惠券活动，即生成数千个映射到相同折扣的唯一代码：

[![在此处输入图像描述](../Images/a595c29a8d336ee5e84f11e84fb670e3.png)](https://i.stack.imgur.com/sgLZt.png)

[然后您可以使用PHP SDK](https://github.com/rspective/voucherify-php-sdk)将其集成到您的电子商务网站中。要兑换优惠券：

```
$result = $voucherify->redeem("unique-voucher-code", "customer-id"); 
```

`$result->voucher->discount->percent_off`如果给定的代码有效，结果将包括指定的折扣。

*完全披露，我是 Voucherify 的开发人员。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T03:29:45.603

您可以以某种方式构造优惠券代码，使您无需检查数据库即可确定优惠券的类型（或者您可以将它们存储在一个只包含优惠券类型的表中（见下文），这样您就不需要存储每个可能的组合），然后在末尾附加一个唯一编号，可用于检查优惠券之前是否已使用过。例如：

`d8h7bb0778719945`->`d8h7bb`是优惠券类型（与此类型的所有其他优惠券相同）并且`0778719945`是唯一编号（*所有*优惠券不同，无论类型如何）。

检查优惠券类型是否对首先购买的商品有效。如果是，请检查`0778719945`您的优惠券数据库以查看它是否已被认领。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T18:12:31.183

对于我工作的公司，我们创建了一个“优惠券代码”生成器，它允许我们生成数百万个自我验证代码，而无需将它们加载到数据库中。

代码计算如下：

1.  创建并存储 16 个字符或更多字符的盐。

2.  将计数器从 0 循环到代码数 - 1。对于每个计数器：

    一个。生成计数器和盐的哈希值，比如说`md5(counter + salt)`

    湾。生成优惠券代码作为计数器加上哈希值

然后当收到优惠券代码时，我们提取计数器，并对计数器 + salt 进行哈希处理，并将其与代码中找到的哈希值进行比较。如果它们相同，我们就知道代码是有效的。

如果使用代码生成销售，我们将其使用记录在表中，因此不能再次使用。

对于印刷媒体，我们使用大写 base-32 值（2-9、AH、JN、PZ）生成优惠券代码。对于电子邮件和 URL，我们使用修改后的 base-64 值（请参阅[urlsafe_b64encode()](http://docs.python.org/library/base64.html#base64.urlsafe_b64encode)）

不幸的是，我无法提供实际代码，因为它在 NDA 之下。祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T03:21:58.003

既然你是自己写的，这就是我的建议。

创建一个新的优惠券类型，在应用优惠券时，它会检查已登录用户的订单历史记录，以确保他们之前已经下过订单。

在您的优惠券表中，添加以下字段`requireSignIn`和`requirePastOrders`。创建一张设置了这些字段的优惠券。当客户尝试使用该优惠券时，请进行必要的检查以确保他们已登录并之前已下订单。如果这些测试失败，则显示适当的错误消息。

# c# - 设置没有日期或月份的日期

> ID：12118835
> 
> 赞同：0
> 
> 时间：2012-08-25T03:07:11.607
> 
> 标签：c#, .net, asp.net-mvc-3

我需要用户能够选择一个日期，但可能会发生用户不知道确切的日期或月份，而是年份。

我正在考虑创建一个带有下拉列表的选择器，每个列表中都有可选项目，并将其保存在一个`DateTime`属性中。但我不知道如何指定未知部分的值。

我可以为日、月和年使用单独`int?`的字段，但我想知道是否有更好的方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T03:40:27.497

DateTime 必须是有效日期，因此您不能只将年份放入其中，您至少还需要日期和月份。这在您的情况下是有问题的，因为您无法区分日期 01/01/2012 和 2012 年。除非您还有日期和月份，否则我看不出如何将值保留在 DateTime 中。

正如您所说，这里最好的解决方案是将这些值保存在整数中，并将值 0 放在未指定的字段中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T16:46:52.907

我建议您创建一个自定义类。

```
public class CustomDate
{
   public int? Day { get; set; }

   public int? Month { get; set; }

   public int Year { get; set; }

   public DateTime? Date
   {
      get
      {
        if(Year > 0 && Day.HasValue && Day.Value > 0 
           && Month.HasValue && Month.Value > 0)

            return new DateTime(Year, Month.Value, Day.Value);

         return null;
      }
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T04:02:33.603

在用户界面上，您可以使用日期范围而不是单个日期吗？

如果他们只知道年份，则选择该年份的 1/1 到 12/31 的范围。无论哪种方式，最好选择一个完整的日期，而不是一个无效/部分日期。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T04:04:51.730

是的，使用单独的字段。具有在 mdl 中选择月份、1、2、3...12 和在 ddl 中选择日期 1、2、3...31 的值。ydl 中没有选择年份。而是保留一些理想值，例如选择当前年份

ddl,mdl,ydl 我的意思是你的下拉列表的名称分别为日、月、年

显示强制选择年份的用户指南标签

可选（示例代码）：

当用户提交时，为了检查月份和日期，您应该进行验证

```
string userDate = ""
if (ddl.SelectedIndex>0)
{ //then you can try to validate date as
try
{
string temp=ydl.SelectedItem.ToString()+"-"+ydl.SelectedItem.ToString();
temp += " "+ydl.SelectedItem.ToString()
DateTime dt=Convert.ToDateTime(temp);
userDate=dt.ToString("yyyy-MM-dd");
}
catch
{
//Display message on some label that chosen date is invalid
return;
}
}
else
{
userDate=ydl.SelectedItem.ToString();
if (mdl.SelectedIndex>0)
{
userDate += mdl.SelectedItem.ToString();
}
} 
```

现在您可以将 userDate (string) 用于您想要使用的目的

记住这里你不应该使用 dateDatime 而不是像 userDate 这样的字符串，因为用户输入会变成像 2012-01-01 一样的固定日期。在这种情况下，您不能仅使用年份

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-21T18:08:05.450

在css中试试这个

```
input[type=date] {
::-webkit-datetime-edit-month-field[disabled]{}
::-moz-datetime-edit-day-field[disabled]{};
::-ms-datetime-edit-day-field[disabled]{};
::-o-datetime-edit-day-field[disabled]{};
} 
```

[http://qnimate.com/guide-to-styling-html5-input-elements/](http://qnimate.com/guide-to-styling-html5-input-elements/)

# java - 如何在hadoop中读取由特殊字符分隔的文本源

> ID：12118836
> 
> 赞同：1
> 
> 时间：2012-08-25T03:07:46.173
> 
> 标签：java, hadoop, mapreduce, cascading

我的数据格式使用 \0 而不是换行符。所以默认的 hadoop textLine 阅读器不起作用。如何将其配置为读取由特殊字符分隔的行？

如果无法配置 LineReader，也许可以应用特定的流处理器(tr "\0" "\n") 不确定如何执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-26T16:32:48.417

`"textinputformat.record.delimiter"`为此目的有一个配置属性。您可以通过将此属性值更改为“\0”来更改默认 EOL（“\n”）分隔符。

有关更多信息，请访问此处：[http ://amalgjose.wordpress.com/2013/05/27/custom-text-input-format-record-delimiter-for-hadoop](http://amalgjose.wordpress.com/2013/05/27/custom-text-input-format-record-delimiter-for-hadoop)

关于更改 spark 中的默认分隔符还有一个类似的问题，这也可能很有用：[Setting textinputformat.record.delimiter in spark](https://stackoverflow.com/questions/17692857/setting-textinputformat-record-delimiter-in-spark)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T18:20:28.583

您可以编写自己的 InputFormat 类来拆分数据`\0`而不是`\n`. 有关如何执行此操作的演练，请在此处查看：http: [//developer.yahoo.com/hadoop/tutorial/module5.html#fileformat](http://developer.yahoo.com/hadoop/tutorial/module5.html#fileformat)

它的要点是您需要继承默认[InputFormat](http://hadoop.apache.org/common/docs/current/api/org/apache/hadoop/mapred/InputFormat.html)类或其任何子类，并`RecordReader`使用自定义规则定义您自己的。有关更多信息，您可以参考 InputFormat 文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T05:52:48.473

怎么样，使用`TextDelimited`方案会起作用吗？[http://docs.cascading.org/cascading/1.2/javadoc/cascading/scheme/TextDelimited.html](http://docs.cascading.org/cascading/1.2/javadoc/cascading/scheme/TextDelimited.html)

这避免了必须编写自己的`InputFormat`等。

分隔文本的示例位于 [https://github.com/Cascading/Impatient/wiki/Part-2](https://github.com/Cascading/Impatient/wiki/Part-2)

# windows - 为什么有些网络 API 能够接受远程连接而有些则不能？

> ID：12118837
> 
> 赞同：1
> 
> 时间：2012-08-25T03:08:48.747
> 
> 标签：windows, tomcat, networking, wininet, windows-firewall

我无法用 Windows 上的 Web 服务器来解释这种行为。它位于将 Windows 防火墙设置为域策略的域环境中。

*   本地 Web 服务器 - 作为 localhost:port 和 FQDM:port
    *   雄猫好
    *   IIS 正常
    *   WEBrick OK
    *   詹金的服务器 - 好的
*   远程访问 - 使用 FQDM:port
    *   Tomcat没有连接
    *   IIS 无连接
    *   WEBrick **OK**
    *   詹金的服务器 -**好的**

我不明白 WEBRick 和 Jenkins 用来接受远程连接的服务器是什么。

还有其他我应该研究的诊断吗？是否可以将 Tomcat 配置为使用类似的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T19:27:05.623

听起来您的远程请求永远不会到达不回复的服务。这意味着这是防火墙或 NAT 问题。我认为这不是配置问题，因为您从本地机器 localhost:port 和 FQDN:port 中说两者都可以工作。

要进行诊断，第一步是查看是否有任何与 telnet 的远程通信。

> telnet 主机名端口

如果您没有看到`Connected to FQDN.`响应，则说明防火墙、硬件或本地软件防火墙阻止了连接。您将需要确保路上的防火墙打开所有正确的端口、转发等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T09:08:06.150

关于 WEBRick 或 Jenkins，我不能说太多，但对于 Tomcat - 如果您查看 Tomcat 7 源代码 ( `StandardServer.java`)，您会看到：

```
// Set up a server socket to wait on
try {
    awaitSocket = new ServerSocket(port, 1,
              InetAddress.getByName(address));
 } catch (IOException e) { ... } 
```

这意味着，无论您在地址中（在您的`server.xml`）中指定什么，都会经历这个。

的[合同](http://docs.oracle.com/javase/6/docs/api/java/net/InetAddress.html)`InetAddress.getByName`说：

> 主机名可以是机器名，例如“java.sun.com”，也可以是其 IP 地址的文本表示。如果提供了文字 IP 地址，则仅检查地址格式的有效性。

如果我是你，我会先尝试设置 IP 地址，看看是否有任何问题。

第二步是检查你是否有错误的本地名称解析策略（`hosts`文件）。我遇到过本地`hosts`文件不正确或包含不可解析条目的情况，从而导致各种奇怪的问题，例如您遇到的问题。

# php - 在Mysql php中一次搜索多个单词

> ID：12118838
> 
> 赞同：0
> 
> 时间：2012-08-25T03:08:51.997
> 
> 标签：php, mysql

我是 Mysql Php 的初学者。我想制作一个搜索框，它可以找到包含在 mysql 中搜索表的多个单词的行。我通过互联网获得了一个脚本，如下所示。当我输入多个单词时，它会显示搜索单词最少的行。但我希望它只显示搜索多个单词的行。请帮我。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=UTF-8'/>
<title>Page title</title>
<style type="text/css">
table {
border-collapse: collapse;
border: solid 1px black;
}
td {
padding: 2px 6px;
border: solid 1px black;
}
</style>
</head>
<body>
<form action='<?php echo $_SERVER['PHP_SELF']; ?>' method='post'>
<p>Search for: <input type='text' name='search' size='20'
maxlength='64'></p>
<p><input type='submit' value='Search'></p>
</form>
<?php
if(isset($_POST['search']))
{
$connx = mysql_connect('localhost', '*****', '*****') or
die("connx");
$db = mysql_select_db('test') or die(mysql_error());
# convert to upper case, trim it, and replace spaces with "|":
$search = (ini_get('magic_quotes_gpc')) ?
stripslashes($_POST['search']) :
$_POST['search'];
$search = mysql_real_escape_string($search);
$search = strtoupper(preg_replace('/\s+/', '|',
trim($_POST['search'])));
# create a MySQL REGEXP for the search:
$regexp = "REGEXP '[[:<:]]($search)[[:>:]]'";
$query = "SELECT * FROM `users` WHERE UPPER(`description`) $regexp
OR ".
"`name` $regexp";
$result = mysql_query($query) or die($query . " - " .
mysql_error());
echo "<table>\n";
while($row = mysql_fetch_assoc($result))
{
echo "<tr>";
foreach($row as $key => $value)
{
echo "<td>$value</td>";
}
echo "</tr>\n";
}
}
?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T03:21:09.380

这是一个选项：

```
$search = explode(" ", $_POST['search']);
$description = "";
$name = "";
foreach($search AS $s)
{
    $description .= "`description` LIKE '%".mysql_real_escape_string($s)."%' AND ";
    $name .= "`name` LIKE '%".mysql_real_escape_string($s)."%' AND ";
}

$description = substr($description, 0, -4);
$name = substr($name, 0, -4);

$query = "SELECT * FROM `users` WHERE ($description) OR ($name)"; 
```

如果您的搜索词类似于“Doctor John”，您的查询将如下所示：

```
SELECT * FROM `users` WHERE (`description` LIKE '%Doctor%' AND `description` LIKE '%John%') OR (`name` LIKE '%Doctor%' AND `name` LIKE '%John%') 
```

这显然使这两个词成为描述或名称字段中的要求。这和你要找的一样吗？

PS - 查看 PHP 的[PDO 库](http://php.net/manual/en/book.pdo.php)。mysql_ 函数太老了，不能再被视为标准了。他们会工作，但你应该升级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T03:20:00.003

我不完全确定你想说什么，但我认为你想要的是：

```
$words = explode(" ", $_POST["search"]);
$sql = "SELECT * FROM `users` WHERE ";
$where = array();
foreach ($words as $word) {
    $where[] = "UPPER(`description`) LIKE '%".mysql_real_escape_string($word)."%'";
}
$sql .= implode(" OR ", $where);
$result = mysql_query($sql); 
```

# matlab - Matlab基础数据作图

> ID：12118840
> 
> 赞同：1
> 
> 时间：2012-08-25T03:09:10.073
> 
> 标签：matlab, graph, plot, vectorization

我对 matlab 非常陌生，需要一些帮助来找到正确的语法来执行简单的数据绘图任务。我有一个脚本，可以分析波形并保存一个称为特征的六点向量（其值为 <3791x6 double>）。我需要检查第五个数据空间中的值，记录它们是否高于某个阈值，然后绘制结果（时间与高于/低于阈值）。

这是基本的伪代码。什么是正确的 Matlab 语法？

```
create a time vs. boolean vector 'threshold'
fifth column of 'features' equals new vector 'data'
for each value in 'data'
     if (data[index] > threshold value) threshold[index] = true
     else threshold[index] = false
graph(threshold) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T03:24:43.270

而不是循环和 if 条件，请尝试：

`data=features(:,5);`

`plot(data(data>threshold));`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T03:51:40.817

尝试这样的事情：

```
vtime = 1:length(features(:, 5));
plot(vtime, features(:, 5) > threshold, '.'); 
```

如果这是不同的，请更改`vtime`为您的时间向量。

# sql - 始终先显示一组数据，然后按列排序其余数据

> ID：12118845
> 
> 赞同：0
> 
> 时间：2012-08-25T03:11:25.267
> 
> 标签：sql

我有一个包含 3 个字段的表，让我们说 field1、field2 和 field3。field2 中的值为 0 或 1。

我试图以某种方式获取 field1，以始终首先显示 field2 中值为 1 的所有行并由 field3 排列，然后显示其余数据，也由 field3 排列。

我的研究告诉我可以按两个字段排序，让我们说“按字段 2 Desc，字段 3 排序”，但这确实没有给出预期的结果。任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T03:18:44.890

MySQL 需要做一个小改动：

```
ORDER BY field2 = 1 DESC, field3 
```

或者对于标准 SQL：

```
ORDER BY CASE WHEN field2 = 1 THEN 1 ELSE 0 END DESC, field3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T03:22:17.383

试试这个：

```
order by 
case when field2=1 then 0 else 1 end,
     field3 
```

# ruby - Ruby：这两个公案难倒了我

> ID：12118847
> 
> 赞同：1
> 
> 时间：2012-08-25T03:11:46.003
> 
> 标签：ruby

我本来希望下面两个 koans 的答案是

```
:default_value 
```

但正确的答案显然是`:false_value`。

在第一个中，我理解除非语句的意思是，

```
result = :false_value but not if the control statement is false. 
```

由于控制语句为“假”，即`unless false`，因此结果应为：default_value。第二个公案也是如此。

请解释

```
def test_unless_statement
    result = :default_value
    unless false
      result = :false_value
    end
    assert_equal __, result
  end

  def test_unless_statement_modifier
    result = :default_value
    result = :false_value unless false

    assert_equal __, result
  end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T03:20:02.233

在这两种情况下，正确答案都是`:false_value`。你可以这样想：

`unless`方法`if !(...)`

`unless false`意思是`if !(false)`什么意思`if true`

或者只是注意双重否定相互抵消。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T18:51:19.370

布尔文字混淆了公案。一个更好的例子是

```
p customers unless customers.empty? 
```

意思是，'打印数组`customers`，除非它是空的'。等效地，

```
p customers if customers.size > 0 
```

# c++ - boost::shared_ptr 销毁回调

> ID：12118850
> 
> 赞同：0
> 
> 时间：2012-08-25T03:12:22.630
> 
> 标签：c++, boost, shared-ptr

我正在挖掘 boost 的文档，寻找在 boost::shared_ptr 中的对象被删除之前调用的回调，因此我可以将对象状态写回硬盘驱动器，并从 std::map 中删除 weak_ptr 元素。

有谁知道如何处理这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T03:13:53.720

当共享指针被删除时，它应该调用你的对象析构函数。您可以在那时将对象写入磁盘，就在其析构函数中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T03:17:32.140

您可以将删除器函数传递给共享 ptr 并在此函数中写入对象状态。

```
template<class Y, class D> shared_ptr(Y * p, D d); 
```

# ruby - 在 ruby 中生成散列数组的快速方法？

> ID：12118858
> 
> 赞同：1
> 
> 时间：2012-08-25T03:13:29.733
> 
> 标签：ruby

我正在尝试使用每个文件夹中包含的文件构建一个文件夹数组。因此，如果您的目录结构是：

```
DirA
  |- FileA
  \- FileB
DirB
  \- FileC 
```

我得到了这个数组：

```
files = ["DirA/FileA", "DirA/FileB", "DirB/FileC"] 
```

我正在尝试构建这样的哈希

```
{DirA => [FileA, FileB], DirB => [FileC]} 
```

现在我正在以我认为相当非 Rubyish 的方式进行操作（假设 String 定义了一个获取父目录的方法）：

```
h = {}
files.each do |f|
    parent = f.getParentDir
    if not h[parent] then h[parent] = [] end
    h[parent].push f
end 
```

有没有更优雅的方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T03:38:19.620

我会做

```
h = {}
files.each do |f|
    (h[f.getParentDir] ||= []) << f
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T03:42:44.720

这可以解决问题：

```
result = files.group_by { |i| i.split("/").first }
result.each_key { |k| result[k] = result[k].map { |f| f.split("/").last } } 
```

如果您想简洁，可以将第二行替换为

```
result.merge!(result) { |k, v| v.map { |f| f.split("/").last } } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T03:43:36.593

我认为你需要这个哈希（带数组）

```
{DirA => [FileA, FileB], DirB => [FileC]}

files.each_with_object(Hash.new{|h,k|h[k]=[]}) do |m,res|
  k,v = m.split('/')
  res[k] << v
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T03:44:24.690

```
files = ["DirA/FileA", "DirA/FileB", "DirB/FileC"]

files.each_with_object(Hash.new { |h,k| h[k] = [] }) do |path, hash|
  parent, file = path.split('/', 2)
  hash[parent] << file
end

#=> {"DirA"=>["FileA", "FileB"], "DirB"=>["FileC"]} 
```

# f# - 如何创建可在 C# 中使用的 F# 类型提供程序？

> ID：12118866
> 
> 赞同：28
> 
> 时间：2012-08-25T03:14:47.853
> 
> 标签：f#, type-providers

如果我使用程序集 FSharp.Data.TypeProviders 4.3.0.0 中的 F# 类型提供程序，我可以在一个非常简单的 F# 库中创建类型。然后我可以使用这些类型而不依赖于程序集 FSharp.Data.TypeProviders。那是相当甜蜜的！这是一个例子：

我创建了一个名为 TryTypeProviders 的 F# 库项目。我把它放在.fs中：

```
module TryTypeProviders
type Northwind = Microsoft.FSharp.Data.TypeProviders.ODataService
```

然后我可以使用 C# 项目中的 F# 库：

```
public static void Main()
{
    var c = new TryTypeProviders.Northwind();
    foreach (var cust in c.Customers)
        Console.WriteLine("Customer is: " + cust.ContactName);
    Console.ReadKey(true);
}
```

我还没有找到任何关于如何创建这样的类型提供程序的工作示例。FSharpx.TypeProviders 中的类型提供程序无法从 C# 访问。我的猜测是它们是擦除类型而不是生成类型。我仍然有点模糊哪个是哪个，但它[在这里定义为](https://stackoverflow.com/questions/7458028/f-type-provider-only-return-generated-types)：

1.  生成的类型是嵌入到使用类型提供程序的程序集中的真实 .NET 类型（这是包装代码生成工具（如 sqlmetal）使用的类型提供程序）
2.  擦除类型是在编译代码时由其他类型表示的模拟类型。

[MSDN教程](http://msdn.microsoft.com/en-us/library/hh361034)中提到的[F# 3.0 示例包](http://fsharp3sample.codeplex.com/)中的示例不适用于我。它们构建，但是当我尝试使用它们时，我得到了错误。

```
open Samples.FSharp.RegexTypeProvider
type PhoneNumberRegEx = CheckedRegexProvider< @"(?<AreaCode>^\d{3})-(?<PhoneNumber>\d{3}-\d{4}$)">
```

```
open Samples.FSharp.MiniCsvProvider
type csv = MiniCsvProvider<"a.csv">
```

它最后一次发布是在 2011 年 3 月，我的猜测是它们还没有反映 Visual Studio 2012 附带的类型提供程序的最终版本。

F# Type Providers 看起来是一项很棒的技术，但我们需要帮助来构建它们。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-08-25T03:38:21.973

标准类型提供程序（用于 OData、LINQ to SQL 和 WSDL）与 C# 一起使用的原因是它们在幕后生成真正的 .NET 类型。这称为**生成类型提供程序**。事实上，如果您以标准方式从 C# 中使用这些技术，它们只是调用代码生成工具。因此，这些类型提供程序只是一些标准 .NET 工具的包装。

大多数新编写的提供程序都写为**擦除类型提供程序**。这意味着它们只生成“假”类型，告诉 F# 编译器可以调用哪些成员（等等），但是当编译器编译它们时，“假”类型会被其他一些代码替换。这就是为什么在使用 C# 库时看不到任何类型的原因 - 编译代码中实际上不存在任何类型。

*除非您要包装现有的代码生成器，否则编写擦除类型提供程序*会更容易，因此大多数示例都是以这种方式编写的。擦除类型提供程序还有其他好处 - 即它们可以生成大量“假”类型而不会生成过大的程序集。

Anyway, there is a brief note ["Providing Generated Types" in the MSDN tutorial](http://msdn.microsoft.com/en-us/library/hh361034), which has some hints on writing generative providers. However, I'd expect most of the new F# type providers to be written as erasing. It notes that you must have a real .NET assembly (with the generated types) and getting that is not simplified by the F# helpers for building type providers - so you'll need to emit the IL for the assembly or generate C#/F# code and compile that (i.e. using CodeDOM or Roslyn).

# java - 带有数组的语句

> ID：12118873
> 
> 赞同：0
> 
> 时间：2012-08-25T03:15:42.717
> 
> 标签：java, arrays, for-loop

我正在研究一种更改某些代码长度的方法。

我有这个：

```
 rects[1].setLocation(0, 0);
    rects[2].setLocation(100, 0);
    rects[3].setLocation(200, 0);
    rects[4].setLocation(300, 0);
    rects[5].setLocation(400, 0);
    rects[6].setLocation(500, 0);
    rects[7].setLocation(0, 50);
    rects[8].setLocation(100, 50);
    rects[9].setLocation(200, 50);
    rects[10].setLocation(300, 50);
    rects[11].setLocation(400, 50);
    rects[12].setLocation(500, 50);
    rects[13].setLocation(0, 100);
    rects[14].setLocation(100, 100);
    rects[15].setLocation(200, 100);
    rects[16].setLocation(300, 100);
    rects[17].setLocation(400, 100);
    rects[18].setLocation(500, 100);
    rects[19].setLocation(0, 150);
    rects[20].setLocation(100, 150);
    rects[21].setLocation(200, 150);
    rects[22].setLocation(300, 150);
    rects[23].setLocation(400, 150);
    rects[24].setLocation(500, 150); 
```

我把它改成这样：

```
 for(int i = 1; i < 25; i++)
    {
        for(int j = 0; j < 550; j +=50)
        {
            for(int k = 0; k < 550; k +=50)
            {
                rects[i].setLocation(j, k);
            }
        }
    } 
```

问题是后者不起作用，尽管它应该起作用。我的问题是，问题是什么？我已经尝试了很多解决问题的方法，但没有任何效果。我不得不谷歌这个问题，因为我不知道问题是什么。如果值得注意的话，这也是来自小程序的代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T03:20:56.370

您的循环应如下所示：

```
for (int i=0; i<24; i++) {
    int x = (i%6)*100;
    int y = (i/6)*50;
    //Array indexes start from 1, whereas this  
    //loop starts from 0, hence adjusting below
    rects[i+1].setLocation(x, y);
} 
```

您不需要三个嵌套循环，因为您只分配给一个数组。

顺便说一句，您的数组索引不应该`rects`从 0 开始吗​​？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-25T03:20:51.877

您正在执行最里面的语句 24 * 10 * 10 = 2400 次。

您应该将其编写为一个循环，并将 x 和 y 值作为序列计算。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-25T03:22:54.650

如果您稍微跟踪一下您的代码，您会发现您的代码执行以下操作：

```
rects[1].setLocation(0, 0);
rects[1].setLocation(0, 50);
rects[1].setLocation(0, 100);
rects[1].setLocation(0, 150);
... 
```

这显然不是你想要的。您总共只需要设置 24 个值，因此只有一个循环。您可以使用模运算符来获取适当的值。

```
for(int i = 1; i < 25; i++)
{
    rects[i].setLocation(((i-1)%6)*100, ((i-1)/6)*50);
} 
```

* * *

**几个解释：**

[模运算符描述](http://www.dreamincode.net/forums/topic/273783-the-use-of-the-modulo-operator/)

原因`(i-1)/6`是这是整数除法。结果将被截断为整数。例如，`11/6 = 1`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-25T03:22:08.570

我想你想要这样的东西：

```
/**  
  *  Do two things every 6th iteration:
  *
  *    1.) Reset j to zero
  *    2.) Increment k by 50
  *
  *  Otherwise increment j by 100 every iteration.
  *
  */

for (int i = 1; i < 25; i ++) {
    if (isMultipleOfSix(i)) {
        j = 0;
        k += 50;
    }
    rects[i].setLocation(j, k);
    j += 100;
}

private boolean isMultipleOfSix(int num) {
    return ( num % 6 == 0 );
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-25T03:22:47.057

您正在循环遍历所有`j`和`k`每个值`i`，这最终会将所有位置设置为 (500, 500)。

您应该做的是将`j`和`k`作为循环外部的单独变量（可能称为`x`, `y`）并在每个循环中更新它们，例如

```
int x = 0;
int y = 0;
for(int i=0; i<25; i++) {
    rects[i].setLocation(x, y);
    if(x == 500) {
        x = 0;
        y += 50;
    } else {
        x += 100;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-25T07:24:50.080

我在您的代码中看到了几个可能会给您带来问题的问题：

1.  您的原始代码将 setLocation 函数的第一个参数显示为递增 100，而您的 for 循环将其显示为递增 50。我原来的就是您想要的。
2.  您的整数 i、j 和 k 是在它们自己的本地范围内创建的。这意味着一旦你完成你的'k' for 循环，k 就会从内存中删除。为避免这种情况，您可以在原始 for 循环之外创建所有变量。
3.  你不需要所有那些嵌套的 for 循环

这是我要做的：

```
for(int i = 1, j = 0, k = 0; i < 24; j += 100) 
{
  if(j > 500)
  {
    j = 0;
  }

  if(i%6 == 0)
  {
    k += 50;
  }

  rects[i].setLocation(j, k);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-25T03:59:01.090

尝试这样的事情也许：

```
for (int i = 0, y = 0; i <= 24; y += 50) {
  for (int x = 0; x <= 500; x += 100) {
    locs[++i].setLocation(x, y);
  }
} 
```

而且，不，我不是优化编译器。

# c - 如何修复netbeans中的这个错误？

> ID：12118877
> 
> 赞同：0
> 
> 时间：2012-08-25T03:17:19.460
> 
> 标签：c, netbeans

我收到此错误消息。我试图用 CYGWIN 做正确的事情，我做错了什么吗？你需要更多信息？

```
"/usr/bin/make" -f nbproject/Makefile-Debug.mk QMAKE= SUBPROJECTS= .build-conf
make[1]: Entering directory `/cygdrive/c/Users/Liam/Documents/NetBeansProjects/playing with c'
cygwin warning:
  MS-DOS style path detected: build/Debug/Cygwin_4.x-Windows/hello\.d
  Preferred POSIX equivalent is: build/Debug/Cygwin_4.x-Windows/hello/.d
  CYGWIN environment variable option "nodosfilewarning" turns off this warning.
  Consult the user's guide for more details about POSIX paths:
    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
"/usr/bin/make"  -f nbproject/Makefile-Debug.mk dist/Debug/Cygwin_4.x-Windows/playing_with_c.exe
make[2]: Entering directory `/cygdrive/c/Users/Liam/Documents/NetBeansProjects/playing with c'
mkdir -p dist/Debug/Cygwin_4.x-Windows
gcc     -o dist/Debug/Cygwin_4.x-Windows/playing_with_c build/Debug/Cygwin_4.x-Windows/hello\ world.o  build/Debug/Cygwin_4.x-Windows/main.o  
nbproject/Makefile-Debug.mk:63: recipe for target `dist/Debug/Cygwin_4.x-Windows/playing_with_c.exe' failed
make[2]: Leaving directory `/cygdrive/c/Users/Liam/Documents/NetBeansProjects/playing with c'
nbproject/Makefile-Debug.mk:60: recipe for target `.build-conf' failed
make[1]: Leaving directory `/cygdrive/c/Users/Liam/Documents/NetBeansProjects/playing with c'
nbproject/Makefile-impl.mk:39: recipe for target `.build-impl' failed
build/Debug/Cygwin_4.x-Windows/main.o: In function `main':
/cygdrive/c/Users/Liam/Documents/NetBeansProjects/playing with c/main.c:14: multiple definition of `_main'
build/Debug/Cygwin_4.x-Windows/hello world.o:/cygdrive/c/Users/Liam/Documents/NetBeansProjects/playing with c/hello world.c:3: first defined here
collect2: ld returned 1 exit status
make[2]: *** [dist/Debug/Cygwin_4.x-Windows/playing_with_c.exe] Error 1
make[1]: *** [.build-conf] Error 2
make: *** [.build-impl] Error 2

BUILD FAILED (exit value 2, total time: 3s) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T03:19:17.010

您已经在多个地方定义了 main 方法：main.c:14 和 hello world.c:3。

一个程序只能有 1 个 main 方法。

从项目中删除这些文件之一，或删除主要方法定义之一。

# .htaccess - htaccess 重定向文件夹和文件名

> ID：12118879
> 
> 赞同：1
> 
> 时间：2012-08-25T03:17:33.153
> 
> 标签：.htaccess, directory, filenames

我在这样的文件夹中有一个文件`folder1/folder2/folder3/filename.htm`。我也有另一个这样的文件`folder1/folder2/folder3-filename.htm`。当我浏览 url`mysite.com/folder1/folder2/folder3/filename.htm`时，我希望`folder3-filename.htm`将被提供（显示）

我知道一些关于文件名重写规则的基础知识，但我还没有看到文件夹名和文件名的任何混合组合。

谁能帮我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T03:22:59.377

使用表达式`[^/]+`匹配直到但不包括下一个的所有字符`/`，然后`.+`匹配最后一个之后的所有字符`/`，以下将起作用：

```
RewriteEngine On
RewriteRule ^folder1/folder2/([^/]+)/(.+)$ folder1/folder2/$1-$2 [L] 
```

# c# - 如何使用文本框检索记录？

> ID：12118888
> 
> 赞同：-1
> 
> 时间：2012-08-25T03:20:44.747
> 
> 标签：c#, asp.net, sql, sql-server, sql-server-2005

我正在尝试使用通配符查询在 gridview 中显示行，但它不符合标准......

```
protected void Button1_Click(object sender, EventArgs e)
{
    SqlCommand com = new SqlCommand("select * from Alphabates where Word 
                     like'"+TextBox1.Text+"'", new SqlConnection("data source=
                     USER\\SQLEXPRESS;initial catalog=vicky;integrated 
                     security=true"));

    try
    {
        com.Connection.Open();
        GridView1.DataSource = com.ExecuteReader();
        GridView1.DataBind();
        com.Connection.Close();
        com.Connection.Dispose();
    }
    catch (SqlException ex)
    {
        Label1.Text = ex.Message;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T03:28:03.667

尝试这个：

更改您的查询以在文本框值周围添加 %

通配符搜索需要一个 % 符号才能获得所需的结果，否则它与使用等于 (=) 符号相同

```
"select * from Alphabates where Word like %'"+TextBox1.Text+"%'" 
```

根据您的评论，如果您想要以给定单词开头的行，那么：

```
"select * from Alphabates where Word like '"+TextBox1.Text+"%'" 
```

前任：

```
select * from Alphabates where Word like 'Some value' 
```

和

```
select * from Alphabates where Word ='Some value' 
```

所以你应该把它改成

```
select * from Alphabates where Word like '%Some value%' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T03:59:02.590

请注意sql注入。

您应该在文本值周围添加 %，然后使用参数化的 sql 来运行它，而不是使用字符串组合它。您将对各种聪明的 sql 开放。

看看这里的例子：

[http://www.codinghorror.com/blog/2005/04/give-me-parameterized-sql-or-give-me-death.html](http://www.codinghorror.com/blog/2005/04/give-me-parameterized-sql-or-give-me-death.html)

# python-2.7 - python：无法打开文件'setup.py'：[Errno 2]没有这样的文件或目录

> ID：12118890
> 
> 赞同：1
> 
> 时间：2012-08-25T03:20:55.353
> 
> 标签：python-2.7, ubuntu-12.04

我是编程领域的新手，也是 Ubuntu 和 Python 的新手。我目前正在尝试在终端中访问我的 setup.py 模块。截至目前，它给我的错误是：

```
python: can't open file 'setup.py': [Errno 2] No such file or directory 
```

老实说，我不确定如何获取此模块或从何处获取此模块。我在 Windows 上有它，它似乎工作得很好。我假设由于 python 已经安装在 Ubuntu 上，setup.py 已经在这里了。我想我假设错了。

在这个问题上的任何帮助都会很棒。如果我需要提供更多信息，请告诉我。:)

# php - 在单个页面上禁用 iPhone 缩放

> ID：12118894
> 
> 赞同：1
> 
> 时间：2012-08-25T03:21:08.007
> 
> 标签：php, iphone, forms, mobile, zooming

我希望在具有表单但允许在其他页面上的单个页面上禁用 iPhone 的缩放。有没有办法全局启用缩放，然后在特定页面上禁用它？

我正在使用 php。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T03:38:46.903

在您的 php 代码中尝试这一行：

```
<meta name = "viewport" content = "initial-scale = 1.0, user-scalable = no"> 
```

或者

```
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"> 
```

我使用的是相同的功能，第一个和第二个的区别在于 iPhone 中安装的 iOS 版本。因此，有了这个，您可能想找到知道哪个 iOS 版本正在运行用户的 iPhone 的方法。

# android - SearchView 或 EditText 更适合搜索栏功能？

> ID：12118896
> 
> 赞同：0
> 
> 时间：2012-08-25T03:21:33.997
> 
> 标签：android, android-layout

我想知道使用 SearchView widgit 或带有 Button widgit 的 EditText widgit 是否是我想要创建的搜索栏的更好实现（搜索栏意味着您输入一个单词，然后单击 go，它会带您到某种结果）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T06:28:26.133

它取决于您对数据库的要求很大，提示结果不能在单个屏幕中显示，然后最好使用带有 go 按钮的编辑文本进行搜索。如果列表视图中的数据有限或可以使用编辑搜索的内容盒子。

# c++ - 什么时候应该使用字符串而不是字符串流？

> ID：12118899
> 
> 赞同：32
> 
> 时间：2012-08-25T03:22:15.167
> 
> 标签：c++, string, performance, iostream, stringstream

我什么时候应该使用`stringstream`而不是`string::append()`？假设我要连接字符串。

```
stringstream ss;
ss << str1 << "str2" << ...
Write(ss.str()); 
```

或者：

```
string str;
str.reserve(10000);
str.append(str1);
str.append("str2");
...
Write(str); 
```

哪个更快？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-25T03:26:20.660

我不知道哪个会更快，但如果我不得不猜测我会说你的第二个例子是，特别是因为你已经调用了`reserve`成员函数来分配一个大的扩展空间。

如果您只是连接字符串，请使用`string::append`(或[`string::operator+=`](http://en.cppreference.com/w/cpp/string/basic_string/operator+=))。

如果您要将数字转换为其字符串表示形式，并在转换期间对其进行格式化，然后将转换结果附加在一起，请使用 stringstreams。我明确提到了格式化部分，因为如果您不需要格式化[`std::to_string`](http://en.cppreference.com/w/cpp/string/basic_string/to_string)可用于将数字类型转换为字符串的 C++11 产品。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-25T03:25:02.123

string.append 要快得多。尤其是当你预订时。

如果你只连接字符串，我会使用 string.append。当我需要自动将非字符串转换为字符串时，我只会使用 stringstream，例如：

```
const int x(42);
stringstream ss;
ss << "My favorite number is: " << x << std::endl; 
```

这里 stringstream 自动将 x 转换为字符串并附加它。我不需要打电话给atoi。Stringstream 将自动为您转换所有基本类型。它非常适合这个目的。

此外，如果您只是将数据定向到字符串流以稍后将其转换为字符串。您可以使用用于输出的 ostringstream。

我希望这会有所帮助。

# bash - 来自 Codesourcery arm-2011.03 的 Bash 脚本找不到 grep 或 sed

> ID：12118906
> 
> 赞同：1
> 
> 时间：2012-08-25T03:23:17.137
> 
> 标签：bash, path

我正在尝试在 Ubuntu 12.04 中运行 CodeSourcery arm-2011.03.42 BASH 脚本。脚本顶部是以下内容：

```
#! /usr/bin/env bash 
```

但是，当我执行它时，我收到以下错误：

*第 140 行：grep：找不到命令*

*第 140 行：sed：找不到命令*

我可以从命令行运行 grep 和 sed，但不能在脚本中运行。

这是第 140 行的样子

```
env_var_list=$(export | \
    grep '^declare -x ' | \
    sed -e 's/^declare -x //' -e 's/=.*//') 
```

如果我将第一行更改为

```
#!/bin/sh 
```

我收到以下错误：

*第 51 行：语法错误：“（”意外（预期为“}”）*

这是第 51 行的样子

```
check_pipe() {
    local -a status=("${PIPESTATUS[@]}")  #<-- Line 51
    local limit=$1
    local ix 
```

`#<-- Line 51`实际上并没有出现在 shell 脚本中。为了清楚起见，我只是将其添加到这篇文章中。

我尝试了 dos2unix 和其他一些东西，但我就是赢不了。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T13:00:13.257

我在脚本中更改了这一行

```
pushenvvar PATH /usr/local/tools/gcc-4.3.3/bin 
```

到

```
pushenvvar PATH /usr/local/tools/gcc-4.3.3/bin:/bin 
```

它现在似乎工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T05:22:59.430

Shell 脚本必须是 bash，因为 sh 中不存在数组。

检查您的 PATH 环境变量，以及 grep 和 sed /bin 的路径。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-25T05:54:56.967

可能有几个可能的原因。

1.  正如@AntonioD 指出的那样，'#!' 之间不能有任何空格 和文件开头的“/usr/bin/env”。
2.  `grep`and命令在您的`sed`$PATH 中不存在，检查您的`/bin`and`/user/bin`以查看它们是否存在，或者在您的 shell 中运行`which grep`and 。`which sed`
3.  如果`grep`并且`sed`确实存在，则需要确保它们具有正确的访问权限。它们应该是可访问和可执行的，一般来说，这种情况不应该发生。
4.  您不能使用`#!/bin/sh`instead of`#!/usr/bin/evn`或`#!/bin/bash`，因为这会导致 shell 在 POSIX 兼容模式下运行，在这种模式下，大多数 bash 高级功能（如数组）都不起作用。

如果以上都不是，那真的很奇怪。

# c++ - C++ 静态函数和变量

> ID：12118909
> 
> 赞同：0
> 
> 时间：2012-08-25T03:23:44.463
> 
> 标签：c++, static-functions

我写了一个类，如下所示：

```
#include<iostream>
using namespace std;
class A
{
static int cnt;
static void inc()
{
cnt++;  
}
int a;
public:
A(){ inc(); }
};
int main()
{
A d;
return 0;
} 
```

我想通过构造函数调用函数 inc ，但是当我编译时出现错误：

```
/tmp/ccWR1moH.o: In function `A::inc()':
s.cpp:(.text._ZN1A3incEv[A::inc()]+0x6): undefined reference to `A::cnt'
s.cpp:(.text._ZN1A3incEv[A::inc()]+0xf): undefined reference to `A::cnt' 
```

我无法理解错误是什么......请帮助......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T03:25:38.803

未定义静态字段- 看看*为什么*[具有静态数据成员的类会出现链接器错误？](http://www.parashift.com/c++-faq/link-errs-static-data-mems.html).

```
#include<iostream>
using namespace std;
class A
{
  static int cnt;
  static void inc(){
     cnt++;  
  }
  int a;
  public:
     A(){ inc(); }
};

int A::cnt;  //<---- HERE

int main()
{
   A d;
   return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T03:38:20.447

类里面`static int cnt;`只有声明的，需要定义的。在 C++ 中，您通常在 .h .hpp 文件中声明，然后在 .c 和 .cpp 文件中定义静态类成员。

在您的情况下，您需要添加

```
int A::cnt=0; // = 0 Would be better, otherwise you're accessing an uninitialized variable. 
```

# c++ - 将浮点向量转换为 16 位 int 而不饱和

> ID：12118910
> 
> 赞同：14
> 
> 时间：2012-08-25T03:23:45.397
> 
> 标签：c++, c, performance, sse

我想将浮点值转换为 16 位无符号整数而不饱和（改为环绕/溢出）。

```
#include <iostream>
#include <xmmintrin.h>

void satur_wrap()
{
    const float bigVal = 99000.f;
    const __m128 bigValVec = _mm_set1_ps(bigVal);

    const __m64 outVec64 =_mm_cvtps_pi16(bigValVec);

#if 0
    const __m128i outVec = _mm_movpi64_epi64(outVec64);
#else

    #if 1
        const __m128i outVec  = _mm_packs_epi32(_mm_cvttps_epi32(bigValVec), _mm_cvttps_epi32(bigValVec));
    #else
        const __m128i outVec  = _mm_cvttps_epi32(bigValVec);
    #endif

#endif

    uint16_t *outVals = NULL;
    posix_memalign((void **) &outVals, sizeof(__m128i), sizeof(__m128i));

    _mm_store_si128(reinterpret_cast<__m128i *>(outVals), outVec);

    for (int i = 0; i < sizeof(outVec) / sizeof(*outVals); i++)
    {
        std::cout << "outVals[" << i << "]: " << outVals[i] << std::endl;
    }

    std::cout << std::endl
        << "\tbigVal: " << bigVal << std::endl
        << "\t(unsigned short) bigVal: " << ((unsigned short) bigVal)  << std::endl
        << "\t((unsigned short)((int) bigVal)): " << ((unsigned short)((int) bigVal)) << std::endl
        << std::endl;
} 
```

示例执行：

```
$ ./row
outVals[0]: 32767
outVals[1]: 32767
outVals[2]: 32767
outVals[3]: 32767
outVals[4]: 32767
outVals[5]: 32767
outVals[6]: 32767
outVals[7]: 32767

        bigVal: 99000
        (unsigned short) bigVal: 65535
        ((unsigned short)((int) bigVal)): 33464 
```

该`((unsigned short)((int) bigVal))`表达式按需要工作（但它可能是 UB，对吗？）。但我找不到与 SSE 非常相似的东西。我一定遗漏了一些东西，但我找不到将四个 32-bit 转换为四个 32-bit`float`的原语`int`。

* * *

编辑：糟糕，我认为 32 位整数 -> 16 位无符号整数转换使用环绕是“正常的”。但我从那以后了解到`_mm_packs_epi32`使用有符号饱和（并且似乎没有 a `_mm_packus_epi32`）。有没有办法设置模式，或者除此之外的其他原语`_mm_packus_epi32`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-25T19:17:42.750

我认为您可能正在寻找`CVTTPS2DQ`指令，其内在函数是`_mm_cvttps_epi32`. 请参阅：http: [//msdn.microsoft.com/en-us/library/c8c5hx3b (v=vs.71).aspx#vcref_mm_cvttps_epi32](http://msdn.microsoft.com/en-us/library/c8c5hx3b(v=vs.71).aspx#vcref_mm_cvttps_epi32)

* * *

这是一个完整的实现，它采用 2 x SSE 浮点向量并将它们转换为带有环绕的单个打包 8 x 16 位无符号向量：

```
#include <stdio.h>
#include <tmmintrin.h>

__m128i vec_float_to_short(const __m128 v1, const __m128 v2)
{
    __m128i v1i = _mm_cvttps_epi32(v1);
    __m128i v2i = _mm_cvttps_epi32(v2);
    v1i = _mm_shuffle_epi8(v1i, _mm_setr_epi8(0, 1, 4, 5, 8, 9, 12, 13, 255, 255, 255, 255, 255, 255, 255, 255));
    v2i = _mm_shuffle_epi8(v2i, _mm_setr_epi8(255, 255, 255, 255, 255, 255, 255, 255, 0, 1, 4, 5, 8, 9, 12, 13));
    return _mm_or_si128(v1i, v2i);
}

int main(void)
{
    __m128 v1 = _mm_setr_ps(0.0f, 1.0f, -1.0f, 32767.0f);
    __m128 v2 = _mm_setr_ps(-32768.0f, 32768.0f, 99999.0f, -99999.0f);
    __m128i v3 = vec_float_to_short(v1, v2);

    printf("v1 = %vf\n", v1);
    printf("v2 = %vf\n", v2);
    printf("v3 = %vhu\n", v3);

    return 0;
} 
```

请注意，这使用`PSHUFB`( `_mm_shuffle_epi8`) 需要 SSSE3 aka SSE3.5 aka MNI（请参阅`tmmintrin.h`），因此这仅适用于当前合理的 CPU（过去 6 年左右来自 Intel 的任何 CPU）。

```
$ gcc -Wall -mssse3 vec_float_to_short.c -o vec_float_to_short
$ ./vec_float_to_short 
v1 = 0.000000 1.000000 -1.000000 32767.000000
v2 = -32768.000000 32768.000000 99999.000000 -99999.000000
v3 = 0 1 65535 32767 32768 32768 34463 31073
$ 
```

请注意，并非所有版本的 gcc 都支持`v`SIMD 向量的 printf 格式说明符（在本例中，我在 OS X 上使用 Apple 的 gcc）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-28T11:23:08.637

我只回答有关 32 位整数 -> 16 位无符号整数转换的部分问题。

由于您需要回绕，因此只需取每个包含 32 位整数的双字的低位字。这些 16 位整数与 16 位未使用数据交错，因此将它们打包成一个连续数组可能会很方便。最简单的方法是使用`_mm_shuffle_epi8`内在 (SSSE3)。

如果您希望您的程序更具可移植性并且只需要 SSE2 指令集，您可以使用 打包这些值`_mm_packs_epi32`，但使用以下技巧禁用其饱和行为：

```
x = _mm_slli_epi32(x, 16);
y = _mm_slli_epi32(y, 16);

x = _mm_srai_epi32(x, 16);
y = _mm_srai_epi32(y, 16);

x = _mm_packs_epi32(x, y); 
```

这个技巧有效，因为它执行 16 位值的符号扩展，这使得有符号饱和成为空操作。

同样的技巧适用于`_mm_packus_epi32`：

```
x = _mm_and_si128(x, _mm_set1_epi32(65535));
y = _mm_and_si128(y, _mm_set1_epi32(65535));
x = _mm_packus_epi32(x, y); 
```

这个技巧有效，因为它执行 16 位值的零扩展，这使得无符号饱和成为无操作。执行零扩展更容易，但您需要 SSE4.1 指令集才能`_mm_packus_epi32`使用。

可以使用一条指令打包 8 个 16 位整数：`_mm_perm_epi8`. 但这需要非常少见的 XOP 指令集。

* * *

这里有几个关于饱和转换的词。

事实上，如果您更改为or `_mm_packus_epi32`，则内在是可用的。您需要 CPU 和编译器来支持 SSE4.1 扩展。`#include <xmmintrin.h>``#include <smmintrin.h>``#include <x86intrin.h>`

如果您没有与 SSE4.1 兼容的 CPU 或编译器，或者希望您的程序更具可移植性，请`_mm_packus_epi32`使用以下代码替换内部代码：

```
__m128i m1 = _mm_cmpgt_epi32(x, _mm_set1_epi32(0));
__m128i m2 = _mm_cmpgt_epi32(x, _mm_set1_epi32(65535));
x = _mm_and_si128(x, m1);
x = _mm_or_si128(x, m2); 
```

# javascript - 漂亮的照片不起作用：“prettyPhoto 不是函数”？

> ID：12118912
> 
> 赞同：0
> 
> 时间：2012-08-25T03:24:03.217
> 
> 标签：javascript, jquery, wordpress, prettyphoto

我正在尝试在 wordpress 网站上设置 PrettyPhoto。

加载脚本的页面示例：http: [//kaarma.pixelworklab.com/quick-pay/](http://kaarma.pixelworklab.com/quick-pay/)

这是 Firefox 控制台中输出的错误之一：

```
[cycle] terminating; zero elements found by selector

jquery...test.js (line 27)

TypeError: $("a[href$='.jpg'], a[href$='.jpeg'], a[href$='.gif'], a[href$='.png']").prettyPhoto is not a function
[Break On This Error]   

showTitle: true /* true/false */ 
```

基本上，当您单击图像（底部 3）时，它们会在新屏幕中打开并且永远不会触发 prettyPhoto..

任何想法都非常感谢！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T05:48:26.037

PrettyPhoto javascript 和 CSS 文件未加载，您指定了错误的 url

*   http: **//kaarma.pixelworklab.comLIBRARIES_URIprettyPhoto** /css/prettyPhoto.css?ver=3.4.1
*   http: **//kaarma.pixelworklab.comLIBRARIES_URIprettyPhoto** /js/jquery.prettyPhoto.js?ver=3.4.1

# python - Python/Psycopg2/PostgreSQL Copy_From 循环随着它的进行而变慢

> ID：12118913
> 
> 赞同：4
> 
> 时间：2012-08-25T03:24:36.257
> 
> 标签：python, database, postgresql, psycopg2

我编写了一个 Python 脚本，它采用 1.5 G XML 文件，解析数据并使用 copy_from 将其提供给数据库。它每 1000 个解析的节点调用以下函数。总共有大约 170k 个节点更新大约 300k 行或更多。它开始时非常快，然后随着时间的推移逐渐变慢。关于为什么会发生这种情况以及我能做些什么来解决它的任何想法？

这是我将数据提供给数据库的函数。

```
 def db_update(val_str, tbl, cols):

    conn = psycopg2.connect("dbname=<mydb> user=postgres password=<mypw>")
    cur = conn.cursor()
    output = cStringIO.StringIO()
    output.write(val_str)
    output.seek(0)
    cur.copy_from(output, tbl, sep='\t', columns=(cols))
    conn.commit() 
```

我没有包含 xml 解析，因为我认为这不是问题。如果没有 db，解析器将在 2 分钟内执行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T03:43:03.470

随着表的增长，有几件事会减慢插入速度：

*   随着数据库的增长，触发器必须做更多的工作
*   索引，随着它们的增长，更新成本会更高

禁用任何非关键触发器，或者如果不可能重新设计它们以在恒定时间内运行。

删除索引，然后在加载数据后创建它们。如果您需要实际`INSERT`s 或`UPDATE`s 的任何索引，则需要保持它们的磨损成本。

如果您正在做很多`UPDATE`s，请考虑`VACUUM`定期对 table 进行操作，或者将 autovacuum 设置为非常积极地运行。这将有助于 Pg 重用空间，而不是从文件系统中更昂贵地分配新空间，并有助于避免表膨胀。

您还可以通过不为每个工作块重新连接来节省时间。保持连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T16:52:22.693

根据个人经验，copy_from 在你提交任何内容后不会更新任何索引，所以你必须稍后再做。当您完成插入所有内容时，我会将您移出`conn = psycopg2.connect("dbname=<mydb> user=postgres password=<mypw>"); cur = conn.cursor()`函数并执行 commit() （我建议每 ~ 100k 行提交一次，否则它会开始变慢）。

此外，它可能看起来很愚蠢，但它经常发生在我身上：确保在调用 db_update 后重置 val_str。对我来说，当 copy_from /inserts 开始变慢时，这是因为我插入了相同的行加上更多的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-22T13:49:53.000

我使用以下内容，据我所见，我的性能没有受到任何影响：

```
import psycopg2
import psycopg2.extras

local_conn_string = """
    host='localhost'
    port='5432'
    dbname='backupdata'
    user='postgres'
    password='123'"""
local_conn = psycopg2.connect(local_conn_string)
local_cursor = local_conn.cursor(
    'cursor_unique_name',
     cursor_factory=psycopg2.extras.DictCursor) 
```

我在代码中进行了以下输出来测试运行时（并且我正在解析很多行。超过 30.000.000）。

```
Parsed 2600000 rows in 00:25:21
Parsed 2700000 rows in 00:26:19
Parsed 2800000 rows in 00:27:16
Parsed 2900000 rows in 00:28:15
Parsed 3000000 rows in 00:29:13
Parsed 3100000 rows in 00:30:11 
```

我不得不提到我不“复制”任何东西。但是我正在将我的行从远程 PostGreSQL 移动到本地行，并且在此过程中创建了更多的表来更好地索引我的数据，因为 30.000.000+ 在常规查询中处理起来有点太多了。

# 注意：时间是向上计数的，不是针对每个查询的。

我相信这与 my`cursor`的创建方式有关。

# 编辑1：

我正在使用以下内容来运行我的查询：

```
local_cursor.execute("""SELECT * FROM data;""")

row_count = 0
for row in local_cursor:
    if(row_count % 100000 == 0 and row_count != 0):
        print("Parsed %s rows in %s" % (row_count,
                                        my_timer.get_time_hhmmss()
                                        ))
    parse_row(row)
    row_count += 1

print("Finished running script!")
print("Parsed %s rows" % row_count) 
```

这`my_timer`是我制作的一个计时器类，该`parse_row(row)`函数格式化我的数据，将其传输到我的本地数据库，并在数据被验证为已移动到我的本地数据库后最终从远程数据库中删除。

# 编辑2：

即使在解析了大约 4.000.000 个查询之后，解析我的数据库中每 100.000 行大约需要 1 分钟：

```
Parsed 3800000 rows in 00:36:56
Parsed 3900000 rows in 00:37:54
Parsed 4000000 rows in 00:38:52
Parsed 4100000 rows in 00:39:50 
```

# ruby-on-rails - 不了解 Bundler 与 Gems 的交互

> ID：12118918
> 
> 赞同：2
> 
> 时间：2012-08-25T03:25:48.020
> 
> 标签：ruby-on-rails, gem, rake, bundler, rubymine

我以为我了解 Bundler 如何使用 gems，但是在最近发生的事情之后，我不确定我是否正确。

我正在开发一个 Rails 应用程序。开始时（只是为了让我熟悉以前没有工作过的 Rails 环境），我没有使用 IDE。但是，因为我错过了 IDE 的一些优点，所以我才开始使用 RubyMine。作为 RubyMine 设置的一部分，它要求更新我现有项目的所有 gem。

之后，我无法运行“rake [anything]”。每次我这样做时，我都会收到以下错误：

> 您已经激活了 rake 0.9.3.beta.1，但您的 Gemfile 需要 rake 0.9.2.2。使用 bundle exec 可以解决这个问题。

我可以更新到 rake 的下一个版本——这不是问题——但我不明白一开始发生了什么。我“激活”了更新版本的 rake 发生了什么。最终，我最终解决了这个问题

```
gem 'rake', '0.9.3.beta.1' 
```

在我的 Gemfile 中并运行

```
bundle update rake 
```

但是，我仍然不确定这里发生了什么。如果我之前使用的是 9.2.2，为什么它会突然像那样爆炸，我以后如何防止这种情况发生？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-12T12:31:30.177

如果您使用的是 Rubymine，则应将其配置为使用`bundle exec`.

转到： *运行 -> 编辑配置 -> 默认值 -> Rake -> Bundler 选项卡*并选中“在包的上下文中运行脚本（**bundle exec**）”

删除所有已创建的任务，下次您再次创建它们时将应用默认设置。您还可以单独配置创建的每个任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T04:35:25.673

你真的应该考虑安装和使用**[RVM](https://rvm.io/)**或**[Rbenv](https://github.com/sstephenson/rbenv)**来管理你的 ruby​​ 版本和 gemset。如果您采用 Rbenv 方式，则**[rbenv-gemset](https://github.com/jamis/rbenv-gemset)**插件可用于管理 gemset，类似于 RVM 原生的方式。

> 您已经激活了 rake 0.9.3.beta.1，但您的 Gemfile 需要 rake 0.9.2.2。使用 bundle exec 可以解决这个问题。

在您上次`bundle`执行和安装/配置/运行 RubyMine 之间的某个时间点，您必须安装`rake 0.9.3.beta.1`. 因为你不是通过像 RVM 或 Rbenv 这样的 gemsets 来管理你的 gems，所以 Rake 的默认版本变成`0.9.3.beta.1`了而不是 bundler 安装的版本，`0.9.2.2`.

上面的错误表明你`Gemfile`有类似的东西

```
gem 'rake', '0.9.2.2' 
```

这不允许使用 rake 的版本除了`0.9.2.2`.

如果您确实在`0.9.2.2`您的系统上除了`0.9.3.beta.1`并且您`Gemfile`的配置为`0.9.2.2`，而不是运行

```
rake some:task 
```

你可以跑

```
bundle exec rake some:task 
```

bundler 将`some:task`通过`0.9.2.2`rake 版本运行。 无论使用 RVM 还是 Rbenv，运行与`Gemfile`通过捆绑器中找到的 gem 相关的任务都被认为是一种好的做法。`bundle exec ...`

你可以在`bundle exec` **[这里](http://gembundler.com/man/bundle-exec.1.html)**阅读。

# ios - 在 iOS 单视图应用程序中，self.view.bounds 最早设置正确的时间是什么时候？

> ID：12118920
> 
> 赞同：5
> 
> 时间：2012-08-25T03:26:04.400
> 
> 标签：ios, uiview, uiviewcontroller

我正在尝试添加一个`UITableView`覆盖整个屏幕的对象，通过

```
 UITableView *tabelView = [[UITableView alloc] initWithFrame:self.view.bounds];
  [self.view addSubview:tabelView]; 
```

但我意识到即使物理 iPad 2 旋转到横向模式，`self.view.bounds`也`{{0, 0}, {768, 1004}}`处于`viewDidLoad`和`viewWillAppear`. 只有在`viewDidAppear`终于`{{0, 0}, {1024, 748}}`

`self.view.bounds`正确设置的最早时间是`{{0, 0}, {1024, 748}}`多少？如果`viewDidAppear`是那个，那么我必须在`UITableView`那里创建，如果“启动图像”是一个静态的横向空白表，那么屏幕会在调用时闪烁一个白屏`viewDidAppear`，然后添加并看到该表，所以一个看到白色屏幕的闪光。

那么`self.view.bounds`正确设置的最早时间是什么时候`{{0, 0}, {1024, 748}}`？好像需要稍微往前一点`viewDidAppear`，这样才能画出空白表（用灰线），并显示出来，无缝显示以掩盖Launch图像。如果表格是在`viewDidLoad`或`viewWillAppear`使用中创建的`self.view.bounds`，则表格最终为 768 点宽，适用于纵向模式。

**更新：我只是尝试添加启动图像，由于某种原因，即使`UITableView`添加了`viewDidAppear`，“白屏闪烁”也没有发生......我不知道为什么，但以前如果我使用`CALayer`和位图显示内容，并且没有使用任何视图或`drawRect`，然后出现了flash ...顺便说一句，我发现的最早的是`viewWillLayoutSubviews`，然后是`viewDidLayoutSubviews`，两者都发生在之前`viewDidAppear`，并且都显示`self.view.bounds`为`{{0, 0}, {1024, 748}}`**

**更新 2：如果视图制作复杂且耗时怎么办？为了测试，我在每个单元格中添加了一个`usleep(100000);`睡眠`tableView:cellForRowAtIndexPath`0.1 秒，并且确实发生了“闪光”......但是单元格和表格应该重量轻且制作速度快，但是如果有其他类型的视图怎么办？制作更耗时？如果我将`UITableView`创作移动到`viewWillLayoutSubviews`，那么显示某些东西仍然很慢，但至少没有“闪光”。但是，稍后当我旋转设备时，它实际上`viewWillLayoutSubviews`再次调用并将另一个表格添加到主视图（具有正确的屏幕尺寸），因此`viewWillLayoutSubviews`需要首先删除任何旧的表格视图（如果有的话），或者只是调整旧的大小和不添加一个新的。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T07:44:54.330

避免flash的最简单方法是在其中创建表格视图`viewDidLoad`并正确设置表格视图的自动调整大小掩码，以便系统自动使表格视图填充其父视图：

```
- (void)viewDidLoad {
    [super viewDidLoad];
    UITableView *tableView = [[UITableView alloc] initWithFrame:self.view.bounds];
    tableView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
    [self.view addSubview:tableView];
} 
```

否则，您可以看到最终视图边界的最早时间是在视图控制器的`viewWillLayoutSubviews`方法中。您将在 中添加一次表格视图`viewDidLoad`，然后在其中调整其框架`viewWillLayoutSubviews`或之后调用的方法。[看到我对UIViewController 返回无效帧](https://stackoverflow.com/questions/9539676/uiviewcontroller-returns-invalid-frame)的回答了吗？更多细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T22:36:37.063

我试图解决一个类似的问题——我想根据`UIView`Interface Builder 中添加的大小以编程方式加载一些 UI 元素。

在`viewDidLoad`and内部`viewWillAppear`，`UIView`仍然没有设置它的框架/边界。将我的代码放入`viewDidAppear`其中是可行的，但这意味着 UI 会随着更新而“闪烁”，而不是在将`UIViewController`其推送到导航堆栈时显示为已经加载。

我发现覆盖`viewDidLayoutSubviews`解决了这个问题——在这一点上，视图有它的边界和框架集——我可以在我自己的子视图中添加相对于它的大小，所有之前`viewDidAppear`。

最终结果是 UI 在它出现之前正确加载，因此没有为用户“闪现”。

# javascript - 使用 JavaScript 正则表达式进行条件渲染

> ID：12118921
> 
> 赞同：2
> 
> 时间：2012-08-25T03:26:09.570
> 
> 标签：javascript, regex, sitecore, web-forms-for-marketers

我需要匹配这样的字符串：

`'if Country equals "United States" then Show'`

我正在使用 Sitecore 中的营销人员网络表单模块。Sitecore 是一个基于 .NET 的 CMS。营销人员模块的 Webforms 是一个模块，它为非开发人员提供 GUI 来设计带有文本框、下拉列表、复选框等的表单......前一个字段中的选项。例如：仅当用户从 Country 下拉列表中选择“United States”时才显示 States 下拉列表。问题是，WFFM 模块不支持字段的条件渲染，所以我尝试用 JavaScript 自己实现它。我的想法是这样的：

*   我将使用所有可能的字段在模块中构建表单
*   当页面加载时，我将使用 JavaScript 隐藏依赖于先前字段值的字段
*   当用户与某个字段交互时，我将运行一些 JavaScript 来检查该字段的值并确定是否应该显示我在页面加载时隐藏的一个或多个字段。

我基本上是在为`if`声明编写解释器；我正在为营销人员提供一种“编程”表单的方法。 `Country`是我页面上下拉列表的名称。 `equals`是一个条件。 `"United States"`是下拉列表中的值之一。如果用户`United States`在下拉列表中选择，`then` `Show`States 下拉列表。

因此，正则表达式测试的输入将始终遵循以下格式：

*   总是以关键字开头`if`
*   后跟 1 个或多个空格
*   后跟任意数量的数字和/或字母和/或空格
    *   控件名称可以包含多个带空格和偶数的单词
        *   例如：名字或地址行 1
*   后跟 1 个或多个空格
*   后跟关键字`equals`
*   后跟 1 个或多个空格
*   后跟 1 个双引号
*   后跟任意数量的数字和/或字母和/或空格
    *   控件的值可以包含多个带有空格和偶数的单词
*   后跟 1 个双引号
*   后跟 1 个或多个空格
*   后跟关键字`then`
*   后跟关键字`Show`或关键字`Hide`

我有这么多有用的东西，但这并不是我上面列出的所有要求。此行一直匹配到控件名称后的空白处。

`var pattern = /^if\s+(\d*|\w*)\s+.*$/;`

但是当我尝试匹配双引号时它不起作用；我真的不知道在双引号上匹配的语法。我已经尝试了以下所有方法，没有任何工作：

`var pattern = /^if\s+(\d*|\w*)\s+["].*$/;`

`var pattern = /^if\s+(\d*|\w*)\s+\".*$/;`

`var pattern = /^if\s+(\d*|\w*)\s+\"{1}.*$/;`

您能提供的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T04:05:19.130

我建议这样的表达：

```
/^if\s+([\w\s]+)\s+equals\s+"([\w\s]*)"\s+then\s+(\w*)$/ 
```

你可以这样使用：

```
var expression = // set this to your input
var matches = expression.match(/^if\s+([\w\s]+)\s+equals\s+"([\w\s]*)"\s+then\s+(\w*)$/);

if (matches) { // if matches isn't null
    // matches[1] is the field name
    // matches[2] is the value in quotes
    // matches[3] is the operation to perform 
```

我没有将“隐藏”和“显示”硬编码到正则表达式中——而是返回“then”之后的任何字符串。我认为这将使以后添加更多操作变得更加容易。如果您想对这些操作名称进行硬编码，只需将最终名称更改`(\w*)`为`(Hide|Show)`. 如果引号中的部分是空字符串，此表达式也将起作用，这可能对某些字段值有效。

演示：http: [//jsfiddle.net/2UFHN/1/](http://jsfiddle.net/2UFHN/1/)

注意：您说 _“任意数量的数字，和/或字母和/或空格” - 为此您只需要`[\w\s]+`. 在您的表达式中，您有`(\d*|\w*)\s+`，这意味着“零个或多个数字或零个或多个单词字符后跟一个或多个空格”。\w 已经匹配数字（以及 az 和下划线），因此您也不需要 \d。

您*可能*希望在`i`表达式中添加一个标志，`/expressionhere/i`以使其不区分大小写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T03:30:19.633

只需使用 "; 无需逃避它。

此外，您显然是在尝试匹配 " 而不首先匹配`equals`，因此它不会匹配您的任何测试用例。

```
/^if\s+(\d*|\w*)\s+".*$/.test("if abc \"xyz\"") // ==> true
/^if\s+(\d*|\w*)\s+".*$/.test("if abc equals \"xyz\"") // ==> false 
```

# javascript - 在 Chrome 中将图像数据传输到 Web Worker 时发生内存泄漏

> ID：12118923
> 
> 赞同：3
> 
> 时间：2012-08-25T03:26:14.213
> 
> 标签：javascript, html, google-chrome, memory-leaks, web-worker

我使用[Transferrable Object](http://updates.html5rocks.com/2011/12/Transferable-Objects-Lightning-Fast)`canvas`反复将图像数据从 HTML5传递给 Web Worker——

精简代码：

```
var worker = new Worker("test.js");
setInterval(function () {
    var data = context.getImageData(0, 0, canvas.width, canvas.height);

    worker.webkitPostMessage(data, [data]);
}, 100); 
```

问题是内存使用量每隔几秒就会以天文数字的速度增加，并且在不调用函数时似乎并没有减少。对于内存使用量超过某个阈值的情况，chrome 实际上会因为这种泄漏而崩溃。我欢迎任何和所有建议，包括将数据发送到 Web Worker 的替代方法。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T04:01:36.677

好吧，我想这与网络工作者无关。

```
var canvas = document.getElementById('canvas');
var context = canvas.getContext('2d');

setInterval(function () {
  var data = context.getImageData(0, 0, canvas.width, canvas.height);
}, 100); 
```

我认为这段代码提供了相同的内存泄漏。我也发现了这个问题：

1.  [http://code.google.com/p/chromium/issues/detail?id=51171](http://code.google.com/p/chromium/issues/detail?id=51171)
2.  [画布的 JavaScript 内存问题](https://stackoverflow.com/questions/1745861/javascript-memory-problem-with-canvas)

# ios - 如何从 iPhone (xcode) 获取短信？

> ID：12118926
> 
> 赞同：2
> 
> 时间：2012-08-25T03:27:04.667
> 
> 标签：ios, sms, jailbreak

我看到很多帖子说不可能。
然而，对我来说很奇怪的是，它可以越狱手机（这会让苹果赔钱），可以用 xcode 发送文本或获取请求（这可能是垃圾邮件），但不能阅读文本。
你们中有人尝试过并成功了吗？
毕竟，iPhone 确实会读取 SMS'es，所以数据就在其中，只需将其取出即可。
非常感谢您对此的任何想法。

问题是：如何获取 iPhone 上所有短信的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T07:15:35.393

It most certainly is possible. Since the **Jailbreak** tag was applied to your question, I assume you're ok with writing an app that requires a jailbroken phone, and won't be submitted to the iTunes App Store.

If so, look [at my answer to this other question](https://stackoverflow.com/a/11026338/119114) recently. See the `mostRecentSMS` method I posted. That only reads the newest SMS, but if you simply modify my sqlite code to loop over **all** messages (rows), you can get whatever SMS content you want.

(e.g. uncomment the while loop I show there: `while (sqlite3_step(statement) == SQLITE_ROW)` instead of using the `if` statement)

# java - 使用带有 HTML 表单的复杂对象播放 Framework 2 Java

> ID：12118929
> 
> 赞同：0
> 
> 时间：2012-08-25T03:27:55.833
> 
> 标签：java, playframework, playframework-2.0

我找不到解释如何在 play.data.Form 对象中填充复杂对象以及稍后在 Scala 模板中读取表单值的示例或文档。

顺便说一句 - 我正在使用 java（我看到 Scala 有一些关于此的文档，但我正在使用 java）

通过复杂对象，我指的是：

附有 Shopping Cart 实体的 Person 实体以及该购物车中的 X Item 实体：

person.cart.size person.cart.item 迭代等

一个代码示例 - 非常感谢。

谢谢！CB

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T14:54:21.260

您可以查看Play 中包含的[表单示例。](https://github.com/playframework/Play20/tree/master/samples/java/forms)

特别是，您应该对[Contact 模型](https://github.com/playframework/Play20/blob/master/samples/java/forms/app/models/Contact.java)及其[关联视图](https://github.com/playframework/Play20/blob/master/samples/java/forms/app/views/contact/form.scala.html)感兴趣。

# objective-c - mouseEntered 事件上的 NSButton 图像阴影

> ID：12118932
> 
> 赞同：2
> 
> 时间：2012-08-25T03:28:31.123
> 
> 标签：objective-c, cocoa, mouseevent, nsbutton, nsevent

我有一个无边框的 NSButton，它包含一个图像，并且是我的 ButtonEffect 类的子类，以检测 mouseEntered 和 mouseExited 事件。我的目标是在鼠标进入按钮区域时让图像的边缘发光。我知道我可以通过使用两个不同的图像（一个有阴影，另一个没有）来实现这一点，但我需要用一个图像来做到这一点。

这是我希望为 mouseEntered 事件实现的示例： ![鼠标进入按钮区域](../Images/557da9f9452713c1fccee4381af2e2f7.png)

这是光标离开按钮区域后的样子： ![鼠标退出按钮区域](../Images/9b1c97bc234953f9f579970c27a8fc92.png)

这是我通过设置单元格背景的尝试，但它改变了整个按钮区域的颜色。

```
#import "ButtonEffect.h"

@interface ButtonEffect ()

@property NSTrackingArea *trackingArea;

@end

@implementation ButtonEffect

- (void)updateTrackingAreas {
    [super updateTrackingAreas];

    if (_trackingArea) {
        [self removeTrackingArea:_trackingArea];
    }

    NSTrackingAreaOptions options = NSTrackingInVisibleRect | NSTrackingMouseEnteredAndExited | NSTrackingActiveInKeyWindow;
    _trackingArea = [[NSTrackingArea alloc] initWithRect:NSZeroRect options:options owner:self userInfo:nil];
    [self addTrackingArea:_trackingArea];
}

- (void)mouseEntered:(NSEvent *)event {
    [[NSCursor pointingHandCursor] set];
    [self.cell setBackgroundColor:NSColor.redColor];
    NSLog(@"mouse entered button");
}

- (void)mouseExited:(NSEvent *)event {
    [[NSCursor arrowCursor] set];
    [self.cell setBackgroundColor:nil];
    NSLog(@"mouse exited button");
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T14:39:19.800

你想要这样的东西吗？

```
 - (void)mouseEntered:(NSEvent *)event {
    CALayer *lay=[btn layer];
    CGColorRef myColor=CGColorCreateGenericRGB(1, 1, 1, 1);
    CGColorRelease(myColor);
    myColor=CGColorCreateGenericRGB(0, 0, 0.8, 1);
    [lay setBorderColor:myColor];
    [lay setBorderWidth:1];
    [btn setWantsLayer:YES];
    [btn setLayer:lay];
    CGColorRelease(myColor);

}

- (void)mouseExited:(NSEvent *)event {
    CALayer *lay=[btn layer];
    CGColorRef myColor=CGColorCreateGenericRGB(1, 1, 1, 1);
    CGColorRelease(myColor);
    myColor=CGColorCreateGenericRGB(0, 0, 0.8, 1);
    [lay setBorderColor:myColor];
    [lay setBorderWidth:0];
    [btn setWantsLayer:YES];
    [btn setLayer:lay];
    CGColorRelease(myColor);

} 
```

# git - 特定要求的代码存储库——Git 可以提供“少量下载”吗？

> ID：12118937
> 
> 赞同：1
> 
> 时间：2012-08-25T03:29:42.253
> 
> 标签：git, open-source, cvs, repository, code-sharing

我的代码目前是“开源”但不容易访问，因为它不能从存储库中获得。这个想法是通过 SourceForge 或 Github 提供它，但我愿意使用任何支持这些要求的免费站点。

## 项目介绍

该项目由许多模块（层次结构下的Java包`org.pscode`）中的代码和一些依赖项（例如50兆的交叉编译插件，5-10兆的MP3..）中的代码组成。该项目包含许多独立的应用程序，如面向开发人员的交叉编译编译器和面向最终用户的音乐点唱机。但是也有单个类（例如[`BigClip`](https://stackoverflow.com/a/9470886/418556)可以容纳大声音剪辑的类），它们在不是来自项目本身的其他应用程序中很有用。虽然有些包实际上是“自包含的”（例如[JaNeLA](http://pscode.org/janela/)），但其他包是在一系列现有应用程序中使用的组件。

我机器上存在的整个项目已经在推动 200 Meg。

作为一个想要播放长剪辑的开发人员，我会犹豫下载 200 多兆字节的项目，只是为了得到一个代码短到可以在 SO 上发布的课程。

## 代码库要求

*   一个代码库/共享系统，允许用户只下载他们需要的部分。
*   如果它由主项目的许多独立部分组成，它们会自动下载。
*   提供一种自动方式来计算（以向用户显示）每个“子”项目需要多少下载量。好的，这不是我的选择“成败”的要求，但它会非常方便。

我一直在看 Git，因为它似乎比旧形式的 CVS 有很多进步，并且正在阅读[Git For Eclipse Users并开始阅读](http://wiki.eclipse.org/EGit/Git_For_Eclipse_Users)[分布式版本控制系统](http://wiki.eclipse.org/EGit/Git_For_Eclipse_Users#Distributed_Version_Control_Systems)的第 3 点。

> 鉴于没有主存储库，很明显存储库必须完整地存在于 DVCS 中的每个节点上。..

这让我很担心，但我不确定我是否完全理解它，或者 Git 中是否有另一种机制来提供所需的行为。

## 问题）

Git 能满足上述要求吗？

另一方面，对于大多数开发人员来说，这是一个“非问题”吗？如果人们通常会下载 200 meg 的项目只是为了获得 3 Kb 的代码来解析逗号分隔值的文件，那么也许我什么都不担心。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T03:33:35.347

您可以使用 git 子模块。git 存储库中的子模块是对另一个 git 存储库的引用。通常，当您克隆 git 存储库时，您必须复制所有内容。但是，子模块是将大型项目拆分为许多单独存储库的一种方式。

但是请注意，子模块需要位于单独的子目录中，因此如果您在单独的子模块中拥有所需的源代码，则可能需要移动它们，并且可能需要更改链接。

克隆主项目时，它不会自动下载所有子模块。您需要指定要手动拉取所有子模块。但是，可以快速下载所有子模块，以获取更多详细信息：

[轻松拉出所有子模块的最新版本](https://stackoverflow.com/questions/1030169/git-easy-way-pull-latest-of-all-submodules)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T03:38:31.680

这对于 Git 来说真的是不可能的。但是，如果您将代码托管在 github 等 Git 存储库上，用户可以浏览您的文件并下载他们认为必要的文件。请参阅[Git 与 Subversion](https://git.wiki.kernel.org/index.php/GitSvnComparison)：

> Git 要求您克隆整个存储库（包括历史记录）并创建一个工作副本，该副本至少反映受版本控制的项目的一个子集

尽管 Git 的子模块功能可以帮助解决这个问题，但您必须管理多个存储库并确保它们之间的协调。如果您仍主要处于开发阶段，这可能会有些混乱，并且可能需要进行一些重构。

# python - 如何让 PyQT4 窗口跳到最前面？

> ID：12118939
> 
> 赞同：22
> 
> 时间：2012-08-25T03:30:14.413
> 
> 标签：python, pyqt4

当应用程序从另一台机器接收到指定消息时，我想让 PyQT4 窗口（`QtGui.QMainWindow`）跳转到前面。通常窗口被最小化。

我尝试了`raise_()`and`show()`方法，但它不起作用。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-25T05:38:43.193

这有效：

```
# this will remove minimized status 
# and restore window with keeping maximized/normal state
window.setWindowState(window.windowState() & ~QtCore.Qt.WindowMinimized | QtCore.Qt.WindowActive)

# this will activate the window
window.activateWindow() 
```

我在Win7上都需要这两个。

`setWindowState`恢复最小化的窗口并给予焦点。但是，如果窗口只是失去焦点而不是最小化，它就不会获得焦点。

`activateWindow`提供焦点但不恢复最小化状态。

使用两者都有预期的效果。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2019-06-11T18:46:45.547

这对我来说可以提高窗户但不能一直放在上面：

```
# bring window to top and act like a "normal" window!
window.setWindowFlags(window.windowFlags() | QtCore.Qt.WindowStaysOnTopHint)  # set always on top flag, makes window disappear
window.show() # makes window reappear, but it's ALWAYS on top
window.setWindowFlags(window.windowFlags() & ~QtCore.Qt.WindowStaysOnTopHint) # clear always on top flag, makes window disappear
window.show() # makes window reappear, acts like normal window now (on top now but can be underneath if you raise another window) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-09-22T08:56:46.660

我对上述方法没有任何运气，最终不得不直接使用 win32 api，在[此处](http://qt-project.org/forums/viewthread/6164)使用 C 版本的 hack 。这对我有用：

```
from win32gui import SetWindowPos
import win32con

SetWindowPos(window.winId(),
             win32con.HWND_TOPMOST, # = always on top. only reliable way to bring it to the front on windows
             0, 0, 0, 0,
             win32con.SWP_NOMOVE | win32con.SWP_NOSIZE | win32con.SWP_SHOWWINDOW)
SetWindowPos(window.winId(),
             win32con.HWND_NOTOPMOST, # disable the always on top, but leave window at its top position
             0, 0, 0, 0,
             win32con.SWP_NOMOVE | win32con.SWP_NOSIZE | win32con.SWP_SHOWWINDOW)
window.raise_()
window.show()
window.activateWindow() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-03T02:08:11.450

对于使用 NVidia GPU 的 Windows 10 上的我来说，这很有效：

```
from PyQt4 import QtCore
# create window here...
window.setWindowFlags(QtCore.Qt.WindowStaysOnTopHint) 
```

我在这个答案上找到了它：[https ://stackoverflow.com/a/12280956/4549682](https://stackoverflow.com/a/12280956/4549682)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-01T13:47:35.247

对于被这个问题激怒并且没有设法使用作为答案给出的任何一种方法来修复它的人（例如，对我来说，如果我在启动 python 脚本后但在 Qt 窗口出现之前立即单击另一个窗口，则 PyQt5 没有任何效果），这是最终对我有用的技巧：

```
wnd.showMinimized() # this is the trick: minimize first
wnd.show() # or wnd.showMaximized() if you want it shown maximized 
```

# regex - 正则表达式 - 将非字母数字符号的任意组合折叠成一个“.”

> ID：12118942
> 
> 赞同：4
> 
> 时间：2012-08-25T03:30:53.033
> 
> 标签：regex, autohotkey

我希望将两个或多个非字母数字字符的任意组合折叠成一个“。”

在这个之前我已经有一个过滤器，所以我需要担心的只有 3 个这样的字符是“_”、“-”和“。”

这就是我想出的

```
OutNameNoExt:= RegExReplace(OutNameNoExt,"[\._-]+" , ".") 
```

可悲的是，它失败了，因为我只阅读了我的正则表达式书的前 3 章。

我想清理这样的字符串

```
98788._Interview__with_a_booger..876789_-_.avi 
```

这样它就会读到

```
98788.Interview.with.a.booger.876789.avi 
```

我也相信我必须使用一个全新的运算符，以便替换发生在所有事件中，而不仅仅是第一个，对吗？

准备好让知识流淌！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T03:46:44.640

```
OutNameNoExt:= RegExReplace(OutNameNoExt,"[^A-Za-z0-9]{2,}" , ".") 
```

`[^A-Za-z0-9]`匹配一个非字母数字字符（`^`代表括号表达式上下文中的否定）；`{2,}`匹配前一个表达式中的 2 个或更多字符。它与 基本相同`[^A-Za-z0-9][^A-Za-z0-9]+`。

# javascript - 如何检查是否在文本区域上按下了 Shift+Enter

> ID：12118944
> 
> 赞同：1
> 
> 时间：2012-08-25T03:31:13.687
> 
> 标签：javascript, extjs, extjs4, dom-events

如果按下，我想提交表单并在按下+`Enter`时停止事件。此回调具有参数，该参数不提供任何方法来检查是否按下了 shiftkey。`Shift``Enter``Ext.EventObject`

它有两种方法`.hasModifier`和`.isSpecialKey`。两者都返回`boolean`。没有办法找到是否按下了 shiftkey。我该如何追踪它？

这是我的文本区域组件：

```
{
    region : 'center',
    margins : '5 0 0 0',
    xtype : 'textarea',
    name : 'chatmessage',
    enableKeyEvents: true,
    listeners: {
        keydown: function(textfield, evt, eOpts){
            console.log(evt.getKey());
        }
    }
} 
```

我试过了`evt.shiftKey`。它的未定义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T19:24:51.700

这可以通过带有 keydown 和 keyup 事件标志的小技巧来完成。

```
listeners : {
    keydown : function(tf, e, opt) {
        if (e.getKey() == e.SHIFT) {
            this.shiftKeyPressed = true; // a flag
            return;
        }
        if (e.getKey() != e.ENTER && (this.shiftKeyPressed == undefined || (this.shiftKeyPressed == false))) {
            // Submit form
            e.stopEvent();
        }
    },
    keyup : function(tf, e, eOpts) {
        if (e.getKey() == e.SHIFT) {
            this.shiftKeyPressed = false;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T08:22:21.420

你为什么不在你的文本区域使用键盘映射（[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.util.KeyMap ）？](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.util.KeyMap)无法在这里测试代码，但应该是这样的：

```
var textArea= Ext.create('Ext.form.field.TextArea', {
    region : 'center',
    margins : '5 0 0 0',
    xtype : 'textarea',
    name : 'chatmessage',
    enableKeyEvents: true
});

var map = new Ext.util.KeyMap({
    target: textArea,
    binding: [{
        key: Ext.EventObject.ENTER,
        fn: function(){ alert('Enter pressed!'); }
    }, {
        key: Ext.EventObject.ENTER,
        shift:true,
        fn: function(){ alert('Shift+ENTER pressed!'); }
    }]
}); 
```

# javascript - 文件阅读器访问网络图像

> ID：12118949
> 
> 赞同：0
> 
> 时间：2012-08-25T03:33:25.203
> 
> 标签：javascript, filereader

如果我使用它从本地 pc 中选择图像，则下面的代码效果很好：

```
var outerImg=document.getElementById("img");

    if(!outerImg.files[0])
    {
        return;
    }
    var imgdat=outerImg.files[0];
    var reader = new FileReader();
    reader.onload=function(event)
    {
        var img=new Image; 
            img.onload=function()
        {
            doThings(this);
        }
            img.src=event.target.result;
            alert(img.src);
    }
    reader.readAsDataURL(imgdat); 
```

我的问题是，是否可以使用类似的方式访问网络图像？假设我有 10 张图像并`<img src="xxx.jpg" id="img1">`使用阅读器显示它们并使用它们来访问它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T05:22:46.983

图像元素上没有`files`属性。这应该可以解释您在到达 FileReader 位之前遇到的 javascript 错误。

# php - 动态形成代码并 eval() 它以获得可重复的代码块 - 赞成和反对？

> ID：12118951
> 
> 赞同：0
> 
> 时间：2012-08-25T03:34:23.127
> 
> 标签：php, eval

我正在阅读 OpenCart 和 phpBB 引擎的源代码，并注意到有很多字符串（有时是全屏列表）带有重复的代码，它们仅在一个参数上有所不同。如：

```
$this->data['button_cart'] = $this->language->get('button_cart');
$this->data['button_wishlist'] = $this->language->get('button_wishlist');
$this->data['button_compare'] = $this->language->get('button_compare');
$this->data['button_continue'] = $this->language->get('button_continue'); 
```

我正在考虑使用函数来使用模式生成代码，然后`eval()`是它。

一些这样的功能：

```
function CodeGenerator($patern, $placements_arr){
    $echo_str = '';
    foreach($placements_arr as $placement){
        $echo_str .= str_replace('=PATERN=', $placement, $patern);
    }
    if(substr($echo_str, -1)!==';'){
        $echo_str .= ';'; # for correct eval() working
    }
    return $echo_str;
} 
```

然后对于具有相同模式的大量重复代码块：

```
$patern = "$this->data['=PATERN='] = $this->language->get('=PATERN=');";
$placements_arr = array('button_cart', 'button_wishlist', 'button_compare', 'button_continue');
$echo_str = CodeGenerator($patern, $placements_arr);
eval($echo_str); 
```

***我想了解这种设计的PRO和CONTRA，因为我正在考虑在我未来的发展中使用这种设计。***

我现在在这里看到的唯一问题 - 执行速度有点慢。还有其他人吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T03:42:09.057

好吧，对于您展示的代码块，您可以像这样重写它

```
$params = array('button_cart', 'button_wishlist', 'button_compare', 'button_continue');

foreach($params as $param)
   $this->data[$param] = $this->language->get($param); 
```

无论如何，您都在写出参数，因此我看不出您的代码比我上面显示的代码有什么好处。另外，这只有 3 行代码，而你的代码只有 11 行，而且我的代码可以立即阅读

在你编写的 99.9% 的代码中，你可以在没有 eval 的情况下编写它。在某些极端情况下 eval 是有意义的，但到目前为止，在我 5 年的 php 编码中，我可能已经使用过一两次，如果我回到代码中，我可能会重写它，所以它没有。

如果我必须使用您编写的代码来维护一个项目，那我会抓狂的。看看 OpenCart 写了什么，看看你写了什么。哪一个更容易理解？实际上，我必须多次查看您的代码才能了解它在做什么，我可以浏览 OpenCart 代码并立即了解正在发生的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T03:42:01.057

可维护性 - 如果这是一个词 - 可能是一个小问题。我会鄙视这样的结构，因为它看起来不必要地复杂。作为 Web 开发人员，我继承了许多设计不佳的 php 站点，并且在几乎为零的情况下，我记得必须通过上面的 var 分配列表进行假脱机被认为是一件令人讨厌的事情。然而，我会因为不得不处理奇怪的懒惰函数而变得愤怒，这些函数试图逃避重复输入的陈词滥调。

最后，您谈论的是几分之一秒的处理时间，因此这几乎不是做这样的事情的论据。如果微秒是一个问题，请使用缓存机制写入纯文本并一起消除所有冗余处理。

嘿，我的 2 美分。如果这是您的项目，并且您不希望其他人来维护它，那么请自己淘汰。

# java - 如何将对象的成员字段声明为 volatile？

> ID：12118954
> 
> 赞同：1
> 
> 时间：2012-08-25T03:34:43.143
> 
> 标签：java, volatile

如果我有一个 SomeClass 类型的变量和它的一个公共成员，比如说`public int counter`将被多个线程访问，如果我无法修改 SomeClass，我该如何声明该成员字段的易变性？理想情况下，我猜这`counter`将被宣布`volatile`，但我无法做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T03:57:28.467

您要实现的目标与单独编译不兼容，因此是不可能的。volatile 限定符指示编译器在每次访问时对变量进行不同的处理，因此从模块到您无权访问的源对该变量的每次访问也需要更改。由于该模块已经编译，因此无法更改它处理某些变量的方式。

# php - 将一个数组值添加到另一个

> ID：12118962
> 
> 赞同：0
> 
> 时间：2012-08-25T03:38:17.717
> 
> 标签：php, arrays

这是数组＃1

```
Array
(
    [0] => Array
        (
            [first] => LightSpeed
            [last] => Administrator
        )

    [1] => Array
        (
            [first] => Tyler
            [last] => Nichol
        ) 
```

这是数组＃2

```
Array
(
    [I-10] => Array
        (
            [user] => 2
            [total] => 46.64
        )

    [I-11] => Array
        (
            [user] => 2
            [total] => -46.64
        ) 
```

我只想将 [total] => $value 添加到第一个数组中，使其看起来像。

```
Array
(
    [0] => Array
        (
            [first] => LightSpeed
            [last] => Administrator
            [total] => 46.64
        )

    [1] => Array
        (
            [first] => Tyler
            [last] => Nichol
            [total] => -46.64
        ) 
```

很确定它是 array_push 但不知道如何循环它。有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T04:03:30.443

这有点低技术，但我只是遍历你的数组并插入整个项目。假设您只是匹配数组中项目位置的第二个数组：

```
$vals = array_values($arr2);
foreach($arr1 as $i=>$item) {
    $arr1[$i]['total'] = $vals[$i]['total'];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T04:04:01.400

你不必一直循环..`array_merge`可以做到这一点

```
function superMerge($a, $b) {
    $a['total'] = $b['total'];
    return $a;
}

$array1 = array(0 => Array("first" => "LightSpeed","last" => "Administrator"),1 => Array("first" => "Tyler","last" => "Nichol"));
$array2 = array("I-10" => Array("user" => 2,"total" => 46.64),"I-11" => Array("user" => 2,"total" => - 46.64));

var_dump(array_map("superMerge", $array1, $array2)); 
```

输出

```
array
  0 => 
    array
      'first' => string 'LightSpeed' (length=10)
      'last' => string 'Administrator' (length=13)
      'total' => float 46.64
  1 => 
    array
      'first' => string 'Tyler' (length=5)
      'last' => string 'Nichol' (length=6)
      'total' => float -46.64 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T04:16:15.140

您的数组格式不正确，所以我在回答中已经这样做了。您可能想更新您的问题

```
<?php
$arr1 = Array
(
     Array
        (
            'first' => 'LightSpeed',
            'last' => 'Administrator'
        ),

     Array
        (
            'first' => 'Tyler',
            'last' => 'Nichol'
        )
);

$arr2 = Array
(
    'I-10' => Array
        (
            'user' => 2,
            'total' => 46.64
        ),

    'I-11' => Array
        (
            'user' => 2,
            'total' => -46.64
        )
);

$n = count($arr1);
$i = 0;
foreach($arr2 as $arr)
{
   $arr1[$i]['total'] = $arr['total'];
   $i++;
}

var_dump($arr1);
?> 
```

的结果`var_dump`

```
array
  0 => 
    array
      'first' => string 'LightSpeed' (length=10)
      'last' => string 'Administrator' (length=13)
      'total' => float 46.64
  1 => 
    array
      'first' => string 'Tyler' (length=5)
      'last' => string 'Nichol' (length=6)
      'total' => float -46.64 
```

# seo - 您可以在 schema.org 微数据值中使用 utf-8 或 HTML 实体转义（十六进制）代码吗？

> ID：12118963
> 
> 赞同：2
> 
> 时间：2012-08-25T03:38:17.303
> 
> 标签：seo, google-plus, html-encode, microdata, schema.org

我经常在元标题和元描述中使用转义码，它们在 Google SERPS 中正确呈现......但是......

您可以在 schema.org 微数据值中使用它们（例如`&mdash`; 例如）吗？我希望在 G+ 片段中正确传递和呈现这些字符，如下所述：

[https://developers.google.com/+/plugins/snippet/](https://developers.google.com/+/plugins/snippet/)

... utf-8 呢？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T13:48:50.453

根据规格，这当然是合法的，我希望它可以正常工作。

# jquery - 页面加载触发已定义绑定更改的 jQuery

> ID：12118967
> 
> 赞同：0
> 
> 时间：2012-08-25T03:38:24.517
> 
> 标签：jquery, bind, keypress, onchange

我的代码：

```
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>TEST</title>
</head>

<body>
    How can I get the code to fire on load, maintaining the change/keypress?<br/>
<select id="textFieldId" name="textFieldId">
    <option value="1">End Date</option>
    <option value="2">End Date Plus 30</option>
    <option value="3">End Date Plus Custom</option>
    <option value="4">Print Date Plus Custom</option>
    <option value="5">Static Expiration Date (New)</option>
</select>
    <pre id="ONE">If user selects 1</pre>
    <pre id="TWO">If user selects 2</pre>
    <pre id="THREE">If user selects 3</pre>
    <pre id="FOUR">If user selects 4</pre>
    <pre id="FIVE">If user selects 5</pre>
</body>
</html>

$(document).ready(function(){
    $("#textFieldId").val("3").change();
    $("#textFieldId").on("change keyup", function(){
        var selectedVal = $(this).val();
        $("pre").hide();
        if(selectedVal == "1"){
            $("pre#ONE").show();
        }
        else if(selectedVal == "2"){
            $("pre#TWO").show();
        }
        else if(selectedVal == "3"){
            $("pre#THREE").show();
        }
        else if(selectedVal == "4"){
            $("pre#FOUR").show();
        }
        else{
            $("pre#FIVE").show();
        }
        return false;
    });
}); 
```

[JSfiddle在这里](http://jsfiddle.net/86MPT/11/)

1.  页面具有绑定更改/keyup 事件的下拉列表
2.  用户使用鼠标或向上/向下箭头键选择一个值以显示/隐藏页面上的图层

我的问题是，如果 jQuery 中有一个内置函数，它不仅可以让我设置列表的选定值，还可以触发它绑定的函数。

我有一个解决方法，即在其自己的功能中删除显示/隐藏层，并在更改/键控和初始加载时触发它。

这是最好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T07:01:34.183

[用更少的代码JSFIDDLE](http://jsfiddle.net/hScLa/)试试这个

```
$(document).ready(function(){
    // INITIAL LOAD OF SCREEN - PRELOAD DATA
    myFunction("4");

    // SUBSEQUENT ACTIO NFROM USER
    $("#textFieldId").on("change keyup", function(){
       myFunction($(this).val());
        return false;
    });
});

function myFunction(i){
     var selectedVal = i;
        $("pre").hide();
        var temp = '#id'+selectedVal
        $(temp).show();

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T03:55:35.757

你可以做 switch 来调用绑定到它的函数

[小提琴演示](http://jsfiddle.net/86MPT/12/)

```
$(document).ready(function(){
    $("#textFieldId").val("3").change();
    $("#textFieldId").on("change keyup", myFunction);
});

function myFunction(){
    var selectedVal = $(this).val();
    $("pre").hide();
    $("#id" + selectedVal).show();
    switch(selectedVal){
        case "1":
            //call a function
        break;
        case "2":
            //call a function
        break;           
    }       
    return false;
} 
```

HTML -`pre`稍微修改了 id

```
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>TEST</title>
</head>

<body>
    How can I get the code to fire on load, maintaining the change/keypress?<br/>
<select id="textFieldId" name="textFieldId">
    <option value="1">End Date</option>
    <option value="2">End Date Plus 30</option>
    <option value="3">End Date Plus Custom</option>
    <option value="4">Print Date Plus Custom</option>
    <option value="5">Static Expiration Date (New)</option>
</select>
    <pre id="id1">If user selects 1</pre>
    <pre id="id2">If user selects 2</pre>
    <pre id="id3">If user selects 3</pre>
    <pre id="id4">If user selects 4</pre>
    <pre id="id5">If user selects 5</pre>
</body>
</html> 
```

# r - 在 R 中使用日期格式创建 <=> 条件

> ID：12118968
> 
> 赞同：0
> 
> 时间：2012-08-25T03:38:31.097
> 
> 标签：r, datetime, parallel-processing

我有以下数据框：

```
id<-c(1,2,3,4)
date<-c("23-01-08","01-11-07","30-11-07","17-12-07")
df<-data.frame(id,date)
df$date2<-as.Date(as.character(df$date), format = "%d-%m-%y") 
```

在我的表的第 4 列中，我想根据日期将我的数据划分为 calib 和有效，这样 date <=2007-12-16 第四列应该是`calib`，否则它应该是`valid`

我写了以下几行：

```
for ( i in 1:4)
if (df[i,3]<=2007-12-16)(df[i,4]="calib")else (df[i,4]="valid") 
```

第一个问题是，通过执行此命令，第 4 列中的所有单元格都将变为`valid`，并且似乎无法正确处理日期条件。所以我的第一个问题是我该如何解决这个问题。

第二个问题是我的真实数据框有 600000 行，执行这个命令需要几个小时。我想知道是否有任何方法可以更快地执行此命令并具有完整的 CPU 容量。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T03:44:10.477

R 是**矢量化**的，因此您可以在单个语句中执行此操作：

```
R> df <- within(df,state <- ifelse(date2<=as.Date("2007-12-16"),"calib","valid"))
R> df
  id     date      date2 state
1  1 23-01-08 2008-01-23 valid
2  2 01-11-07 2007-11-01 calib
3  3 30-11-07 2007-11-30 calib
4  4 17-12-07 2007-12-17 valid
R> 
```

如果`within`, `with`, 或者`transform`看起来很奇怪，你也可以直接这样做：

```
R> df$state <- ifelse(df$date2<=as.Date("2007-12-16"),"calib","valid")
R> df
  id     date      date2 state
1  1 23-01-08 2008-01-23 valid
2  2 01-11-07 2007-11-01 calib
3  3 30-11-07 2007-11-30 calib
4  4 17-12-07 2007-12-17 valid
R> 
```

# javascript - window.document 是否曾经为空或未定义？

> ID：12118971
> 
> 赞同：8
> 
> 时间：2012-08-25T03:39:10.693
> 
> 标签：javascript, dom

我一直在对 window.document 对象进行一些研究，以确保我的 JavaScript 解决方案之一是可靠的。是否存在 window.document 对象为 null 或未定义的情况？

为了讨论，这里有一段不相关的示例代码。是否有任何情况下这段代码会失败（也就是抛出异常）？

```
$(document).ready(function() {
    var PageLoaded = (window.document.readyState === "complete");
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T13:24:59.160

> 是否存在 window.document 对象为 null 或未定义的情况？

是的，对于不在文档中的 JavaScript 代码（例如 node.js）。但是这样的代码也可能没有窗口对象（尽管它会有一个全局对象）。

对于符合 W3C DOM 的用户代理中的 HTML 文档中的代码，没有。

```
> Are there any situations in which this piece of code will fail (i.e. throw
> an exception)?
> 
> [snip jQuery code] 
```

它会在以下位置失败：

1.  jQuery 就绪功能失败（可能至少在某些浏览器中，但不是桌面和某些移动设备流行使用的浏览器），
2.  没有`window object`，或
3.  没有`window.document`对象

为了确保代码在各种主机中工作，您可以执行以下操作：

```
 if (typeof window != 'undefined' && window.document &&
      window.document.readyState == whatever) {
      // do stuff
  } 
```

这并不需要额外编写，并且可能只需要完成一次。

备择方案：

```
(function (global) {
  var window = global;
  if (window.document && window.document.readyState == whatever) {
    // do stuff
  }
}(this)); 
```

和

```
(function (global) {
  var window = global;

  function checkState() {
    if (window.document && window.document.readyState) {
      alert(window.document.readyState);
    } else {
      // analyse environment 
    }
  }
  // trivial use for demonstration
  checkState();
  setTimeout(checkState, 1000);
}(this)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T03:45:45.667

我认为文档总是被定义的，因为浏览器向您显示的所有内容都是 html 文档，甚至`site is not available`. 更多，`document`是只读属性

```
window.document = null; 
console.log(window.document); //Document some.html# 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T03:47:13.957

忽略 Javascript 在 Web 浏览器/用户代理之外的其他地方运行的事实，您的 pageLoaded 测试可能会在 iframe 上失败（未经测试，但我知道它们会变得很奇怪）。

可能还有一些关于“页面加载”是什么意思的问题。您是否正在尝试查看 DOM 是否已呈现并且元素是否已准备好进行操作？或者您是否正在检查页面加载是否确实完成，其中包括加载所有其他元素，例如图形。

这个讨论可能很有用： [How to check if DOM is ready without a framework?](https://stackoverflow.com/questions/8100576/how-to-check-if-dom-is-ready-without-a-framework)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T04:53:33.520

因为你的javascript代码必须写在html文档中，所以你的代码不能在文档外执行，换句话说，没有文档，就没有javascript。

# ruby-on-rails - 根据用户“下注”创建验证，这样他们就不能在“余额”上下注？

> ID：12118980
> 
> 赞同：1
> 
> 时间：2012-08-25T03:42:38.603
> 
> 标签：ruby-on-rails, ruby

用户有余额（user.balance）。

用户可以在游戏上下注 (bet.amount)。

我怎样才能阻止用户投注超过他们的余额？

我假设我可以创建一个看起来像这样的验证？

```
def enough_funds?
  @bet.bet_amount > self.current_user.balance 
  flash[:notice] = "You do not have the available funds for this bet"
end 
```

我还是新手，要温柔:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T04:48:53.820

你在正确的轨道上：

```
class Bet < ActiveRecord::Base
  belongs_to :user

  validate :funds_suffiency

  def funds_sufficiency
    errors.add :bet_amount, "is more than your available balance" if bet_amount < user.balance
  end
end 
```

如果`Bet`'s`:bet_amount`小于相关`User`的 available `:balance`，错误将被添加到`:bet_amount`属性中，使模型实例无效。

# uitableview - UIStoryboards、UITableViewControllers 和 UIToolbars：无法将工具栏放置在我想要的位置

> ID：12118986
> 
> 赞同：1
> 
> 时间：2012-08-25T03:44:36.203
> 
> 标签：uitableview, uitoolbar, uistoryboard, ios5

这让我很头疼，因为我似乎找不到办法。我想将 UIToolbar 直接放在 UITabBar 的顶部，但是每当我拖动组件时，它就会移动并添加到 UITableViewCell 下方。

这就是发生的事情：

![在此处输入图像描述](../Images/bf6b1eb9e573d4d0478e4b3db71eb5d0.png)

工具栏应该在标签栏的顶部，而不是 UITableViewCell 的下方。这些单元格是动态的，而不是静态的（如果重要的话）。

任何帮助将不胜感激！

编辑：我只是认为它将工具栏添加为单元格而不是另一个组件。不过，我似乎无法在表格外添加工具栏。呃呃呃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T04:50:03.157

首先创建一个 ViewController，而不是 TableViewController。

将 TableView 拖到 ViewController 中并相应调整大小，然后在其下方添加 UIToolBar。

希望它有效。

# c++ - 编译时具有不同值的 N 个符号

> ID：12118989
> 
> 赞同：1
> 
> 时间：2012-08-25T03:45:00.027
> 
> 标签：c++, templates, enums

原始问题是[SO 12118654](https://stackoverflow.com/questions/12118654/how-to-define-an-extensible-c-enum-system/12118799#12118799)

但我真正想做的是在编译时定义具有不同值的 N 个 const 符号。N 个符号将被分隔在几个标题中。

我希望有一个优雅的 C++ 解决方案，可能使用模板等

# mysql - MYSQL Echo Value 只有一次来自多列

> ID：12118993
> 
> 赞同：0
> 
> 时间：2012-08-25T03:45:53.320
> 
> 标签：mysql, echo, unique, multiple-columns

我想打印出一个名字列表，每个名字只有一次。问题：我有两个不同的列，其中包含名称，但我只想显示每个名称一次，而不取决于列。我将使用 PHP 来回显结果，因此如果没有仅 MYSQL 的解决方案，则循环或其他 PHP 操作也是可能的。

可视化一个示例：（我还有一个 ID 列，如下所示）

```
ID     |Name1  |  Name2
-------|-------|-------
01     |  A    |   B
02     |  A    |   C
03     |  B    |   A 
```

如上所示，两列中的名称相同，但我只想获取每个名称一次。

像这样锁定（例如）：

```
(List:)
A
B
C 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T04:03:44.913

像这样的事情应该这样做：

```
select distinct name
from (
    select Name1 name from table_name
    union all
    select Name2 name from table_name
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T04:29:19.323

试试这个：

```
 select distinct(name) from (select a.name1 as name from tablename as a
    union select b.name2 as name from tablename as b)name; 
```

# php - 如何从文本文件中回显随机行

> ID：12118995
> 
> 赞同：4
> 
> 时间：2012-08-25T03:46:32.000
> 
> 标签：php, file

我的文本文件格式是：

> 这是第一行。
> 这是第二行。
> 这是第三行。

文本文件中可能有更多行。如何在每次刷新时使用 php.ini 从文本文件中回显一个随机行。感谢所有评论。谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-25T03:55:55.073

我们说的文件有多大？简单的方法是将整个文件作为字符串数组加载到内存中，然后选择一个从 0 到 N 的随机数组索引并显示该行。

如果文件的大小可以变得非常大，那么您必须实施某种流解决方案..

# 流媒体解决方案解释！

以下解决方案将从相对较大的文件中产生均匀分布的随机行，每个文件的最大行大小可调整。

```
<?php
function rand_line($fileName, $maxLineLength = 4096) {
    $handle = @fopen($fileName, "r");
    if ($handle) {
        $random_line = null;
        $line = null;
        $count = 0;
        while (($line = fgets($handle, $maxLineLength)) !== false) {
            $count++;
            // P(1/$count) probability of picking current line as random line
            if(rand() % $count == 0) {
              $random_line = $line;
            }
        }
        if (!feof($handle)) {
            echo "Error: unexpected fgets() fail\n";
            fclose($handle);
            return null;
        } else {
            fclose($handle);
        }
        return $random_line;
    }
}

// usage
echo rand_line("myfile.txt");
?> 
```

假设文件有 10 行，选择第 X 行的概率为：

*   P(1) =`1`
*   P(2) =`1/2 * P(1)`
*   P(3) =`2/3 * P(2)`
*   P(N) = `(N-1)/N * P(N-1)`=`1/N`

这最终将为我们提供来自任意大小文件的均匀分布的随机行，而无需实际将整个文件读入内存。

我希望它会有所帮助。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-25T03:47:32.893

处理这种情况的一般好方法是：

1.  使用将行读入数组[`file()`](http://us3.php.net/manual/en/function.file.php)
2.  `echo`使用随机数组值[`array_rand()`](http://us3.php.net/manual/en/function.array-rand.php)

您的代码可能如下所示：

```
$lines = file('my_file.txt');

echo $lines[array_rand($lines)]; 
```