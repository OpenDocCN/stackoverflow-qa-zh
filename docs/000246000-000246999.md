# StackOverflow 问答 000246000-000246999

# .net - 发送右箭头键

> ID：246000
> 
> 赞同：0
> 
> 时间：2008-10-29T06:51:56.747
> 
> 标签：.net

.net中rightarrow的sendkey的语法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T06:54:13.747

{正确的}

[http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T06:54:56.803

[谷歌是你的朋友。](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.send.aspx)

{正确的}

# linux - 如何确定给定的 Linux 是 32 位还是 64 位？

> ID：246007
> 
> 赞同：472
> 
> 时间：2008-10-29T06:59:40.757
> 
> 标签：linux, shell, 32bit-64bit, processor

当我输入`uname -a`时，它会给出以下输出。

```
Linux mars 2.6.9-67.0.15.ELsmp #1 SMP Tue Apr 22 13:50:33 EDT 2008 i686 i686 i386 GNU/Linux 
```

我怎么知道给定的操作系统是 32 位还是 64 位？

这在编写脚本时很有用`configure`，例如：我要为什么架构构建？

* * *

## 回答 #1

> 赞同：739
> 
> 时间：2008-10-29T07:06:42.973

试试[`uname -m`](http://linuxmanpages.net/manpages/fedora16/man1/uname.1.html)。缺少`uname --machine`它并输出：

```
x86_64 ==> 64-bit kernel
i686   ==> 32-bit kernel 
```

* * *

否则，**不是针对 Linux 内核，而是针对 CPU**，您键入：

```
cat /proc/cpuinfo 
```

或者：

```
grep flags /proc/cpuinfo 
```

在“flags”参数下，你会看到各种值：见“ [/proc/cpuinfo中的flags是什么意思？](https://unix.stackexchange.com/a/43540) ”其中一个名为`lm`：`Long Mode`（[x86-64](http://en.wikipedia.org/wiki/X86-64)：amd64，也称为Intel 64，即64位有能力的）

```
lm ==> 64-bit processor 
```

或[使用`lshw`](http://linux.die.net/man/1/lshw)（如[下面](https://stackoverflow.com/a/32717681/6309)的[Rolf of Saxony](https://stackoverflow.com/users/4637585/rolf-of-saxony)所述），不使用`sudo`（仅用于获取 cpu 宽度）：

```
lshw -class cpu|grep "^       width"|uniq|awk '{print $2}' 
```

**注意：您可以拥有一个安装了 32 位内核的 64 位 CPU**。
（正如[ysdx](https://stackoverflow.com/users/637866/ysdx)在[他/她自己的回答](https://stackoverflow.com/a/32665383/6309)中提到的那样，“现在，系统可以是**[多架构](https://wiki.debian.org/Multiarch)**的，所以无论如何它都没有意义。您可能想要找到编译器的默认目标”）

* * *

## 回答 #2

> 赞同：155
> 
> 时间：2008-10-29T07:06:16.563

[如果您运行的是 64 位平台，您会在uname](http://manpages.ubuntu.com/manpages/intrepid/man1/uname.html "无名") -a的输出中看到 x86_64 或非常相似的内容

让您的特定机器硬件名称运行

```
uname -m 
```

你也可以打电话

```
getconf LONG_BIT 
```

返回 32 或 64

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2012-07-17T02:00:30.023

[`lscpu`](http://linuxmanpages.net/manpages/fedora16/man1/lscpu.1.html)将列出有关您的 CPU 的其他信息：

```
Architecture:          x86_64
CPU op-mode(s):        32-bit, 64-bit
... 
```

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2014-01-17T14:39:55.173

另一个便于确定的有用命令如下：

命令：

```
getconf LONG_BIT 
```

回答：

*   32，如果操作系统是 32 位
*   64，如果操作系统是 64 位

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-06-16T16:43:28.127

命令

```
$ arch 
```

相当于

```
$ uname -m 
```

但打字速度快两倍

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2011-08-11T18:18:40.437

我想知道这个专门用于在[Debian](http://en.wikipedia.org/wiki/Debian)中构建软件（安装的 Debian 系统可以是带有 32 位内核、库等的 32 位版本，或者它可以是带有为 64- 编译的东西的 64 位版本）位而不是 32 位兼容模式）。

Debian 包本身需要知道它们的架构（当然），当他们实际创建包含所有元数据的包时，包括平台架构，所以有一个打包工具可以输出它以供其他打包工具和脚本使用，称为**dpkg 架构**。它既包括配置为构建的目标，也包括当前主机。（但通常这些是相同的。）64 位机器上的示例输出：

```
DEB_BUILD_ARCH=amd64
DEB_BUILD_ARCH_OS=linux
DEB_BUILD_ARCH_CPU=amd64
DEB_BUILD_GNU_CPU=x86_64
DEB_BUILD_GNU_SYSTEM=linux-gnu
DEB_BUILD_GNU_TYPE=x86_64-linux-gnu
DEB_HOST_ARCH=amd64
DEB_HOST_ARCH_OS=linux
DEB_HOST_ARCH_CPU=amd64
DEB_HOST_GNU_CPU=x86_64
DEB_HOST_GNU_SYSTEM=linux-gnu
DEB_HOST_GNU_TYPE=x86_64-linux-gnu 
```

[您可以只打印其中一个变量，或者使用dpkg](http://en.wikipedia.org/wiki/Dpkg) -architecture 的命令行选项对它们的值进行测试。

我不知道 dpkg-architecture 是如何推断架构的，但你可以查看它的文档或源代码（dpkg-architecture 和大部分 dpkg 系统通常都是 Perl）。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2012-08-15T14:09:31.597

```
#include <stdio.h>

int main(void)
{
    printf("%d\n", __WORDSIZE);
    return 0;
} 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2008-10-29T07:09:19.567

如果你有一个 64 位操作系统，而不是 i686，你有`x86_64`或`ia64`在`uname -a`. 因为您没有这两个字符串中的任何一个；您有一个 32 位操作系统（请注意，这并不意味着您的 CPU 不是 64 位）。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-10-29T07:08:47.383

那个系统是32位的。iX86 in`uname`表示它是 32 位架构。如果是 64 位，它将返回

```
Linux mars 2.6.9-67.0.15.ELsmp #1 SMP Tue Apr 22 13:50:33 EDT 2008 x86_64 i686 x86_64 x86_64 GNU/Linux 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2015-09-19T07:10:27.717

如今，一个系统可以是多架构的，所以无论如何它都没有意义。您可能希望找到编译器的默认目标：

```
$ cc -v 2>&1 | grep ^目标
目标：x86_64-pc-linux-gn

```

你可以尝试编译一个hello world：

```
$ echo 'int main() { return 0; }' | cc -xc - -o foo
$ 文件 foo
foo：ELF 64 位 LSB 可执行文件，x86-64，版本 1 (SYSV)，动态链接，解释器 /lib64/ld-linux-x86-64.so.2，用于 GNU/Linux 2.6.32，BuildID[sha1] =b114e029a08abfb3c98db93d3dcdb7435b5bba0c，未剥离

```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2011-06-01T11:38:51.197

关于[答案 "getconf LONG_BIT"](https://stackoverflow.com/a/246012/63550)。

我在“C”中编写了一个简单的函数来完成它：

```
/*
 * check_os_64bit
 *
 * Returns integer:
 *   1 = it is a 64-bit OS
 *   0 = it is NOT a 64-bit OS (probably 32-bit)
 *   < 0 = failure
 *     -1 = popen failed
 *     -2 = fgets failed
 *
 * **WARNING**
 * Be CAREFUL! Just testing for a boolean return may not cut it
 * with this (trivial) implementation! (Think of when it fails,
 * returning -ve; this could be seen as non-zero & therefore true!)
 * Suggestions?
 */
static int check_os_64bit(void)
{
    FILE *fp=NULL;
    char cb64[3];

    fp = popen ("getconf LONG_BIT", "r");
    if (!fp)
       return -1;

    if (!fgets(cb64, 3, fp))
        return -2;

    if (!strncmp (cb64, "64", 3)) {
        return 1;
    }
    else {
        return 0;
    }
} 
```

好主意，'getconf'！

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2014-11-10T13:51:59.017

在 Bash 中，使用整数溢出：

```
if ((1 == 1<<32)); then
  echo 32bits
else
  echo 64bits
fi 
```

它比调用另一个进程或打开文件要高效得多。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2016-02-28T20:25:00.183

您还可以使用环境变量进行检查：

```
echo $HOSTTYPE 
```

结果：

`i386`-> 32 位

`x86_64`-> 64 位

摘自：[http ://www.sysadmit.com/2016/02/linux-como-saber-si-es-32-o-64-bits.html](http://www.sysadmit.com/2016/02/linux-como-saber-si-es-32-o-64-bits.html)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-02-06T22:22:03.213

*getconf*使用最少的系统调用：

```
$ strace getconf LONG_BIT | wc -l
253

$ strace arch | wc -l
280

$ strace uname -m | wc -l
281

$ strace grep -q lm /proc/cpuinfo | wc -l
301 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-02-13T13:22:25.017

如果将 1 左移 32 并得到 1，则您的系统是 32 位的。如果您将 1 左移 64 并得到 1，则您的系统是 64 位的。

换句话说，

`if echo $((1<<32)) gives 1 then your system is 32 bit`.

`if echo $((1<<64)) gives 1 then your system is 64 bit`.

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-02-21T18:22:06.803

如果可用二进制文件（例如 initramfs）严重受限，我的同事建议：

```
$ ls -l /lib*/ld-linux*.so.2 
```

在我的 ALT Linux 系统上，i586 有`/lib/ld-linux.so.2`，x86_64 有`/lib64/ld-linux-x86-64.so.2`.

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-07-11T15:17:21.217

```
$ grep "CONFIG_64" /lib/modules/*/build/.config
# CONFIG_64BIT is not set 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-07-06T06:43:23.340

获取 64 位或 32 位的简单脚本

```
 if $(getconf LONG_BIT | grep '64'); then
           echo "64 bit system"
        else
            echo "32 bit system"
        fi 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-09-22T13:04:50.840

我不敢相信，在这段时间里，没有人提到：

```
sudo lshw -class cpu 
```

获取有关 CPU 硬件的速度、数量、大小和功能的详细信息。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-12-13T08:44:36.563

`[ -z `uname -m | grep 64` ] && echo "32-bit" || echo "64-bit"`

基于通常是 64 位`x86_64`和 32 位`i686`等的事实。

* * *

## 回答 #21

> 赞同：-5
> 
> 时间：2014-12-07T18:00:11.167

首先，您必须下载 Virtual Box。然后选择新的 32 位 Linux。然后使用它启动linux。如果它启动了，那么它是 32 位的，如果它没有启动，那么它是一个 64 位的。

# xml - Eclipse 无法识别 XML

> ID：246008
> 
> 赞同：0
> 
> 时间：2008-10-29T07:00:55.683
> 
> 标签：xml, eclipse

我正在使用 PHP Eclipse。打开 XML 文件时，Eclipse 似乎无法识别该 xml，这意味着一切看起来都是黑色的。当打开像“打开方式”这样的 XML 文件并指向 Eclipse 时，它​​工作正常。

可以设置什么设置来自动使用它，以便 eclipse 一直识别它？

实际上 HTML 文件也是如此。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-29T07:14:26.250

在 eclipse 首选项中，您可以配置为给定文件类型打开哪个编辑器。此设置可以在 Window->Preferences->General->Editors->File Associations 下找到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T08:56:38.900

您必须安装一个可以解析 xml 的插件，例如 xmlbuddy 或 eclipse WTP（Web 工具平台）。

我推荐 Eclipse WTP，因为它是 Eclipse 的标准配置，并且可以很好地集成到 IDE 中。正如您在本教程视频中看到的那样，安装也很简单：http: [//mirrors.ibiblio.org/pub/mirrors/eclipse/technology/phoenix/demos/install-wtp/install-wtp.html](http://mirrors.ibiblio.org/pub/mirrors/eclipse/technology/phoenix/demos/install-wtp/install-wtp.html)

成功

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T04:48:22.783

您上次用于文件的编辑器会被记住，因此如果您在安装 XML 编辑器之前打开了特定的 XML 文件，当您再次打开该文件时，您仍然会在纯文本编辑器中结束。从 Open With 上下文菜单中使用 XML 编辑器打开文件一次，然后它应该“粘住”。

# java - JTable 渲染器中的按钮文本不可见。为什么？

> ID：246010
> 
> 赞同：3
> 
> 时间：2008-10-29T07:04:45.723
> 
> 标签：java, swing, jtable, tablecellrenderer

我在 JTable 中设置了一个自定义单元格渲染器，它可以工作，但在按钮上可见的“x”是我看到的表格单元格“...”（三个点）。我错过了什么 ？？

```
 /***************************************************************************
 * Listener reagujący na dodanie nowej wartości
 **************************************************************************/
private static class ButtonRenderer extends JButton implements
        TableCellRenderer {
    /***********************************************************************
     * Konstruktor
     **********************************************************************/
    public ButtonRenderer() {
        super("x");
    }

    /***********************************************************************
     * @see TableCellRenderer#getTableCellRendererComponent(JTable, Object,
     *      boolean, boolean, int, int)
     **********************************************************************/
    public Component getTableCellRendererComponent(JTable table,
            Object value, boolean isSelected, boolean hasFocus, int row,
            int column) {
        return this;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T07:12:07.707

按钮的大小不足以包含渲染的“x”以及它周围的填充。

一种解决方案是扩大表格单元格或减少填充（始终假设按钮与表格单元格的大小相同）。

# emacs - 变量和符号的根本区别是什么？

> ID：246011
> 
> 赞同：2
> 
> 时间：2008-10-29T07:05:13.443
> 
> 标签：emacs, elisp

我对此比较困惑。

它们之间的关系是什么（例如，如何在另一个上下文中使用一个）？非常感谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T07:40:26.120

这[是你要找的](http://www.xemacs.org/Documentation/beta/html/internals_22.html)吗？

符号基本上只是一个具有四个字段的对象：

*   一个名字（一个字符串），
*   一个值（一些 Lisp 对象），
*   一个函数（一些 Lisp 对象），以及
*   属性列表（通常是交替的关键字/值对的列表）。

符号的特殊之处在于通常只有一个符号具有给定名称，并且该符号由名称引用。这使得符号成为一种通过名称调用数据（即*实现变量*）的便捷方式。（变量的值存储在值槽中。）

类似地，函数是按名称引用的，函数的定义存储在符号的函数槽中。这意味着可以存在同名的不同函数和变量。

属性列表用作将附加值与特定名称相关联的更通用机制，并且名称空间再次独立于函数和变量名称空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T07:59:28.593

简单地说，变量是符号和值之间的绑定。符号是变量的名称。当评估绑定符号（即变量名）时，返回变量值，

您也可以使用不是变量的符号，即。未绑定到值的名称。但是，您无法评估未绑定的符号。

在 Lisp-2 中，符号可以同时绑定到值和函数，上下文定义评估符号的结果是值还是函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T07:36:00.247

符号的概念有点难以理解。（即使我不确定我明白了:)）

您可以将符号视为行为类似于常量的特殊变量。内存中只有一个实例，无论您使用它的频率如何。

好处是节省内存，并且可以查看一个值是否以类似常量的方式使用。（提高代码可读性）

您可以在 C/C++ 中使用、在 Java 中使用或在 Delphi/Pascal/VB 中使用来做*类似*的事情，但要小心，在这些语言和许多其他语言中，“符号”意味着不同的东西。`typdef``static final``const`

# java - 如何确定正在使用的 oc4j 的版本？

> ID：246017
> 
> 赞同：4
> 
> 时间：2008-10-29T07:08:19.523
> 
> 标签：java, oracle, oc4j

我有一个没有任何发行说明或版本文档的 oc4j 安装。在没有此类文件的情况下，我如何确定我使用的是哪个版本的 oc4j？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-29T07:24:09.430

检查 HTTP 标头中的服务器标头。例如使用 wget 或 curl；

```
wget -S <url-to-server>
curl -I <url-to-server> 
```

或者使用可以显示 HTTP 标头的浏览器。

应该有一个类似的标题

```
Server: Oracle-Application-Server-10g/10.1.3.1.0 Oracle-HTTP-Server 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-31T12:00:25.077

如果您有权访问 OC4J JAR 文件，则可以执行以下操作：

```
java -jar oc4j.jar -version 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T11:42:12.727

如果您只是输入服务器的 URL（如[http://yourserver:yourport](http://yourserver:yourport)），您将获得一个说明版本的欢迎页面。

在我的例子中，[http://myserver:7777](http://myserver:7777)显示“欢迎使用 Oracle 应用服务器 10g (10.1.3.1.0)”。如果您不知道端口，请尝试 7777、7778 和 8888。

如果您知道 Oracle 软件的安装位置，请转到 ORACLE_HOME/install 目录并查看 readme.txt 文件。这将启动“Oracle 应用服务器 xx 安装成功”，其中 xx 是版本。如果您不知道该软件的位置，您可以在您的文件系统中搜索 readme.txt 文件 - 其中一个可能记录了您的 OC4J 安装。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-11T23:54:09.147

您可以显示与 OC4J 相关的系统属性。我们将以下 scriptlet 嵌入到 JSP 页面中：

```
<%= System.getProperty( "oracle.j2ee.container.name" ) %> 
```

和

```
<%= application.getAttribute( "oracle.jsp.versionNumber" ) %> 
```

样本输出：

> Oracle J2EE 容器：Oracle Containers for J2EE 10g (10.1.3.3.0)
> Oracle JSP 版本：Oracle Containers for J2EE 10g (10.1.3.1.0)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-22T22:28:31.150

此处提到的某些方法不适用于 Oracle 应用服务器，并且它们可能不再受支持。此外，应用补丁时可能不会更新 readme.txt 或其他文件。

推荐的方法是像这样使用 Oracle 的官方 OPatch 实用程序。

```
OPatch]$ ./opatch lsinventory  -invPtrLoc ../oraInst.loc |grep "Oracle Application Server"

Oracle Application Server PatchSet                                   10.1.3.4.0 
```

确保环境变量 ORALCE_HOME 设置正确，并且 -invPtrLoc 指向正确的库存位置。

请注意，这仅适用于完整安装的 Oracle 应用服务器。它不适用于独立开发的 OC4J。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-10T18:06:32.390

```
grep Version $ORACLE_HOME/config/ias.properties 
```

# asp.net - SQL 如何知道 LINQtoSQL 查询中的 @p# 是什么？

> ID：246025
> 
> 赞同：0
> 
> 时间：2008-10-29T07:13:48.607
> 
> 标签：asp.net, sql-server, linq-to-sql

我想知道 SQL Server 是如何知道@p# 在说这个 LINQtoSQL 查询的

```
SELECT 
    [t0].[MemberID], [t0].[Aspnetusername], [t0].[Aspnetpassword], 
    [t0].[EmailAddr], [t0].[DateCreated], [t0].[Location], 
    [t0].[DaimokuGoal], [t0].[PreviewImageID], 
    [t0].[LastDaimoku] AS [LastDaimoku], [t0].[LastNotefied] AS [LastNotefied], 
    [t0].[LastActivityDate] AS [LastActivityDate], [t0].[IsActivated]
FROM 
    [dbo].[Members] AS [t0]
INNER JOIN 
    [dbo].[MemberStats] AS [t1] ON [t0].[MemberID] = [t1].[MemberID]
WHERE 
    [t1].[TotalDeterminations] > @p0 
```

查看 SQL Server Profiler 时，这是对数据库执行的操作......但是没有任何东西告诉 SQL Server 的值，`@p0`那么它如何知道该值是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T07:26:18.580

它是由 LINQ to SQL 生成的参数化查询，以便 SQL Server 可以缓存查询计划以供以后重用。参数值在执行时被发送到 SQL Server，只是 RPC:Completed 事件没有显示它，如果我没记错的话。

# .net - MVP 事件或财产

> ID：246028
> 
> 赞同：1
> 
> 时间：2008-10-29T07:19:14.803
> 
> 标签：.net, mvp

我在 Windows 窗体应用程序中使用 MVP 模式。我需要更改视图上的单选按钮。我可以通过在视图上公开一个布尔属性来做到这一点，但是我应该使用事件来操作视图吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-29T07:28:55.877

这是纯洁与务实的问题……还有一点个人风格。没关系...事件只是比普通方法更有效，但更解耦。 **亲自**

*   我喜欢保持视图解耦或不知道演示者，因此*视图通过引发事件与演示者进行通信*。这消除了视图对演示者的引用的需要。保持视图薄而愚蠢。
*   另一方面，演示者通常具有对视图（和模型）的成员引用。因此*，它可以通过接口进行方法调用来与视图对话*（只要视图符合 IView 接口，就可以替换视图）。例如，在您的情况下， Set_X_Option(eOptionEnum) 将是 IView 接口的成员，然后演示者可以适当地调用该接口。

但是，您也可以通过两种方式使用事件来删除此 IView 依赖项（演示者引用了需要实例化和插入的 IView）......但是我发现它的工作量太大。上述方案从未让我失望过……然而。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T07:23:34.657

使用“普通语言”分析，我会说“单选按钮是否显示是视图的**属性**”，因此使用实际属性将其传达给视图。

另一种（技术）可能性是在 Presenter 上发生一个事件，即`RadioButtonVisibilityChanged`View 监听该事件并通过`EventArgs`. 这与 View 独立且不了解 Presenter 背道而驰，因此破坏了 MVP 模式。我建议不要这样胡说八道。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T07:30:21.100

通常，控制器通过属性更改视图并订阅视图引发的事件以了解更改。这是[MVP 的一个很好的例子](http://haacked.com/archive/2006/08/09/ASP.NETSupervisingControllerModelViewPresenterFromSchematicToUnitTestsToCode.aspx)，尽管在 Asp.NET 中对于 Windows 窗体的工作原理基本相同。

# c# - 单元测试无效方法？

> ID：246038
> 
> 赞同：208
> 
> 时间：2008-10-29T07:28:12.883
> 
> 标签：c#, unit-testing, void

对不返回任何内容的方法进行单元测试的最佳方法是什么？特别是在 c# 中。

我真正想要测试的是一种获取日志文件并将其解析为特定字符串的方法。然后将字符串插入数据库。以前没有做过任何事情，但是对于 TDD 来说是非常新的，我想知道是否有可能对此进行测试，或者它是否真的没有经过测试。

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2008-10-29T07:39:52.050

如果一个方法没有返回任何东西，它是以下之一

*   **命令式**-您要么要求对象对自己做某事..例如更改状态（不期望任何确认..假设它会完成）
*   **信息**性 - 只是分别通知某人发生了某事（不期望采取行动或回应）。

命令式方法 - 您可以验证任务是否实际执行。验证状态更改是否实际发生。例如

```
void DeductFromBalance( dAmount ) 
```

可以通过验证发送此消息的余额是否确实小于初始值 dAmount 来进行测试

信息方法 - 作为对象公共接口的成员很少见......因此通常不经过单元测试。但是，如果必须，您可以验证是否要对通知进行处理。例如

```
void OnAccountDebit( dAmount )  // emails account holder with info 
```

可以通过验证电子邮件是否正在发送来进行测试

*发布有关您的实际方法的更多详细信息，人们将能够更好地回答。*
**更新**：您的方法正在做两件事。我实际上将它分成两种现在可以独立测试的方法。

```
string[] ExamineLogFileForX( string sFileName );
void InsertStringsIntoDatabase( string[] ); 
```

通过为第一个方法提供一个虚拟文件和预期的字符串，可以轻松地验证 String[]。第二个有点棘手..您可以使用 Mock（谷歌或在模拟框架上搜索 stackoverflow）来模仿数据库或点击实际的数据库并验证字符串是否插入到正确的位置。检查[此线程](https://stackoverflow.com/questions/31837/best-books-about-tdd)以获取一些好书...如果您处于紧缩状态，我会推荐实用单元测试。
在代码中，它将像

```
InsertStringsIntoDatabase( ExamineLogFileForX( "c:\OMG.log" ) ); 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2008-10-29T07:39:58.977

测试它的副作用。这包括：

*   它会抛出任何异常吗？（如果应该，请检查它是否存在。如果不应该，请尝试一些极端情况，如果你不小心可能会 - 空参数是最明显的事情。）
*   它的参数可以很好地发挥作用吗？（如果它们是可变的，它会在不应该改变它们的时候改变它们吗？反之亦然？）
*   它对你调用它的对象/类型的状态有正确的影响吗？

当然，您可以测试的数量是有限度*的。*例如，您通常无法测试所有可能的输入。务实地测试 - 足以让您确信您的代码设计得当并正确实施，并且足以充当调用者可能期望的补充文档。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-10-29T07:34:25.413

与往常一样：测试该方法应该做什么！

它应该在某处改变全局状态（呃，代码味道！）吗？

它应该调用一个接口吗？

使用错误的参数调用时是否应该抛出异常？

当使用正确的参数调用时它是否应该不抛出异常？

应该是 ...？

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2016-05-12T07:47:27.413

试试这个：

```
[TestMethod]
public void TestSomething()
{
    try
    {
        YourMethodCall();
        Assert.IsTrue(true);
    }
    catch {
        Assert.IsTrue(false);
    }
} 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-05-30T16:47:38.103

无效返回类型/子例程是旧消息。我已经有 8 年没有做过 Void 返回类型了（除非我非常懒惰）（从这个答案开始，所以就在这个问题被问到之前）。

而不是像这样的方法：

```
public void SendEmailToCustomer() 
```

创建一个遵循 Microsoft 的 int.TryParse() 范例的方法：

```
public bool TrySendEmailToCustomer() 
```

也许从长远来看，您的方法不需要返回任何信息以供使用，但是在方法执行其工作后返回方法的状态对调用者来说是一个巨大的用途。

此外，bool 不是唯一的状态类型。很多时候，以前制作的子程序实际上可以返回三个或更多不同的状态（好、正常、坏等）。在这些情况下，您只需使用

```
public StateEnum TrySendEmailToCustomer() 
```

然而，虽然 Try-Paradigm 在某种程度上回答了这个关于如何测试 void return 的问题，但还有其他考虑因素。例如，在“TDD”周期期间/之后，您将“重构”并注意到您正在用您的方法做两件事......从而打破了“单一责任原则”。所以应该先处理好。其次，您可能已经识别出依赖关系......您正在触摸“持久”数据。

如果您在有问题的方法中进行数据访问，则需要重构为 n 层或 n 层架构。但是我们可以假设，当您说“然后将字符串插入数据库”时，您实际上的意思是您正在调用业务逻辑层或其他东西。是的，我们会假设。

当您的对象被实例化时，您现在了解您的对象具有依赖关系。这是您需要决定是否要对对象或方法进行依赖注入的时候。这意味着您的构造函数或有问题的方法需要一个新参数：

```
public <Constructor/MethodName> (IBusinessDataEtc otherLayerOrTierObject, string[] stuffToInsert) 
```

现在您可以接受业务/数据层对象的接口，您可以在单元测试期间对其进行模拟，并且无需依赖或担心“意外”集成测试。

因此，在您的实时代码中，您传入一个 REAL`IBusinessDataEtc`对象。但是在您的单元测试中，您传入一个 MOCK`IBusinessDataEtc`对象。在该 Mock 中，您可以包含非接口属性，例如`int XMethodWasCalledCount`在调用接口方法时更新其状态的东西。

因此，您的单元测试将通过您的 Method(s)-In-Question，执行它们具有的任何逻辑，并调用一个或两个，或在您的`IBusinessDataEtc`对象中选择一组方法。当您在单元测试结束时执行断言时，您现在有几件事要测试。

1.  “子程序”的状态，现在是 Try-Paradigm 方法。
2.  你的 Mock`IBusinessDataEtc`对象的状态。

有关构建级别的依赖注入思想的更多信息......因为它们与单元测试有关......请查看构建器设计模式。它为您拥有的每个当前接口/类添加了一个更多接口和类，但它们非常小并且为更好的单元测试提供了巨大的功能增加。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2019-05-29T10:16:40.013

你甚至可以这样尝试：

```
[TestMethod]
public void ReadFiles()
{
    try
    {
        Read();
        return; // indicates success
    }
    catch (Exception ex)
    {
        Assert.Fail(ex.Message);
    }
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-29T07:30:33.160

它会对对象产生一些影响....查询效果的结果。如果它没有明显的效果，则不值得进行单元测试！

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-29T07:39:21.847

大概该方法做了一些事情，而不是简单地返回？

假设是这种情况，那么：

1.  如果它修改了它的所有者对象的状态，那么您应该测试状态是否正确更改。
2.  如果它接受某个对象作为参数并修改该对象，那么您应该测试该对象是否被正确修改。
3.  如果在某些情况下抛出异常，请测试是否正确抛出了这些异常。
4.  如果它的行为根据自己的对象或其他对象的状态而变化，则预设状态并通过上述三种测试方法之一测试该方法是否正确）。

如果你让我们知道该方法的作用，我可能会更具体。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-29T08:03:53.827

使用[Rhino Mocks](http://ayende.com/projects/rhino-mocks.aspx)设置可能预期的调用、操作和异常。假设您可以模拟或存根您的方法的某些部分。如果不知道这里有关该方法甚至上下文的一些细节，很难知道。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-29T07:33:02.140

取决于它在做什么。如果它有参数，则传入你可以稍后询问它们是否已使用正确的参数集调用的模拟。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-02-27T15:52:35.363

无论您使用什么实例来调用 void 方法，您都可以使用，`Verfiy`

例如：

在我的情况下，它`_Log`是实例并且`LogMessage`是要测试的方法：

```
try
{
    this._log.Verify(x => x.LogMessage(Logger.WillisLogLevel.Info, Logger.WillisLogger.Usage, "Created the Student with name as"), "Failure");
}
Catch 
{
    Assert.IsFalse(ex is Moq.MockException);
} 
```

是否`Verify`由于测试失败的方法失败而引发异常？

# java - 如何使用 Eclipse 获取 Java 中 2 个接口的通用子类？

> ID：246041
> 
> 赞同：0
> 
> 时间：2008-10-29T07:30:13.333
> 
> 标签：java, eclipse

实际上我试图找到一个 InputStream 的子类，它也是可序列化的。我认为那是不存在的。由于两个接口都有许多子类，因此很难找到两者的子类。

到目前为止，我还没有找到任何可以帮助我在 Eclipse 中进行搜索的内容。任何人的想法？

编辑：我现在明白序列化 Stream 并不是真正应该做的。但问题的本质是：如何找到两个接口的公共子类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T14:50:41.767

在 Eclipse 中，快捷键 Ctrl+T 打开类型层次结构。您甚至可以在基类或接口上使用此功能，并获得包含此类型的所有实现/子类的列表。

如果您这样做两次并比较两个结果，您将找到您的课程。但是，在例如 Serializable 和 Comparable 的情况下，交叉点可能会变得非常大......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T14:55:20.290

不要被冒犯，但在我看来，你正试图解决错误的问题。你**真正**想要达到什么目的？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T09:11:19.867

序列化 InputStream 不是一个非常可行的解决方案。为了说明这一点，假设您有一个来自套接字的 InputStream 并且您将其序列化。在反序列化之前，套接字已关闭。现在，当您真正反序列化它时，资源已经消失，并且您手中有一个令人讨厌的异常。

如果您需要序列化资源，您应该做的是序列化它的位置或如何获取它。在套接字示例中：主机名和端口，对于文件：文件路径等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T09:26:14.080

我不确定您实际上是否可以做到这一点（或者至少以一种简单的方式......）。

无论如何，我喜欢“[开放实现](http://eclipse-tools.sourceforge.net/implementors/index.html)”插件，它允许您右键单击类或接口（或类/接口本身）的方法并询问该方法/接口/类的所有已知实现。这个插件可以帮助你（你现在可以搜索 InputStream 的所有实现

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-22T14:01:28.717

[您可以使用Reflections](https://github.com/ronmamo/reflections)库以编程方式获取一组子类型。两组的交集将是你的答案。

```
Set<Class<? extends Serializable>> subTypes = 
           reflections.getSubTypesOf(Serializable.class); 
```

但是，这不是 Eclipse 特定的解决方案。

# linux - 登录时如何在linux命令行中添加显示消息？

> ID：246043
> 
> 赞同：7
> 
> 时间：2008-10-29T07:30:23.627
> 
> 标签：linux

我希望向正在对 linux shell 做腻子的个人显示某些消息。当人们登录到 linux shell 时，我如何配置某种欢迎消息？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-29T07:42:30.157

[每日消息](http://computing.vt.edu/infrastructure_services/vtaix/learning.html#4)，/etc/motd

即编辑 /etc/motd 文本文件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T10:08:44.353

另一种可能性，具体取决于您想要做什么，是使用 sysnews。这不是 linux 的标准部分，但包含在许多发行版中（debian 上的“aptitude install sysnews”）。

这将使您拥有一个希望人们在登录时看到的消息目录。当他们登录时，他们将看到他们以前从未见过的任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T07:34:18.707

将一些内容放入文件 /etc/issue

[http://www.linuxfromscratch.org/blfs/view/svn/postlfs/logon.html](http://www.linuxfromscratch.org/blfs/view/svn/postlfs/logon.html)中的更多细节

* * *

废话 /etc/motd 是我试图记住的文件。支持他的回答:)

# php - 如何在 VI 中调试

> ID：246057
> 
> 赞同：3
> 
> 时间：2008-10-29T07:37:21.010
> 
> 标签：php, debugging, vi

使用 vim 7.1，最近听说可以在 VI 中调试 php。但是怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T14:20:58.873

请参阅其他人为完整调试器发布的关于将 xdebug 与 vim 一起使用的链接，但作为额外提示，您可以从 vim 执行此操作以对当前 PHP 脚本运行语法检查：

```
:!php -l % 
```

通过将它放在我的 .vimrc 文件中（在你的主（~）目录中），我将它分配给我的 F5 键：

```
nmap <F5> :! php5 -l %<CR> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T07:42:43.243

如果您指的是调试 vim 脚本，vim -D 是第一步。

[调试 Vim 脚本](http://www.troubleshootingwiki.org/Debugging_Vim_Scripts)中的更多细节。

# c# - “System.InvalidOperationException：该对象当前正在其他地方使用” - 我该如何解决这个问题？

> ID：246058
> 
> 赞同：5
> 
> 时间：2008-10-29T07:39:01.350
> 
> 标签：c#, exception, invoke

尝试更新图像时出现此错误。这是一个跨线程更新，但我使用了.Invoke()，所以应该不是问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-29T07:42:09.797

*（回答我自己的问题，供其他人参考，以供将来参考）*

我*认为*（尚不完全确定）这是因为如果控件尚未加载/显示，InvokeRequired 将始终返回 false。我已经做了一个暂时可行的解决方法，即在其创建者中简单地引用关联控件的句柄，如下所示：

```
var x = this.Handle; 
```

（见[http://ikriv.com:8765/en/prog/info/dotnet/MysteriousHang.html](http://ikriv.com:8765/en/prog/info/dotnet/MysteriousHang.html) - down?[缓存版](http://209.85.129.132/search?q=cache:www.ikriv.com/en/prog/info/dotnet/MysteriousHang.html)）

（相关问题：[样板代码替换——这段代码有什么不好的地方吗？](https://stackoverflow.com/questions/192980/boiler-plate-code-replacement-is-there-anything-bad-about-this-code)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T08:14:24.523

如果句柄尚不存在，您可以通过子类化控件并调用`CreateHandle`; 但是，更大的问题是：您为什么要使用尚未加载的表单来做事？就我个人而言，我只会在 Load 之后开始这样的操作。

# oop - 您如何定义单一职责？

> ID：246068
> 
> 赞同：38
> 
> 时间：2008-10-29T07:43:12.043
> 
> 标签：oop, solid-principles, single-responsibility-principle

我知道“班级有一个改变的理由”。现在，那到底是什么？是否有一些气味/迹象可以表明该班级没有单一责任？或者真正的答案是否可以隐藏在 YAGNI 中，并且只在你的类第一次更改时重构为单一职责？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-25T13:20:30.890

写一个简短但准确的描述类做什么。

如果描述包含单词“and”，则需要对其进行拆分。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-10-29T07:55:55.793

### 单一职责原则

有很多明显的例子，例如`CoffeeAndSoupFactory`。同一设备中的咖啡和汤可能会导致令人不快的结果。在此示例中，设备可能会分解为 a`HotWaterGenerator`和某种`Stirrer`. 然后可以从这些组件构建一个新的`CoffeeFactory`并且`SoupFactory`可以避免任何意外混合。

在更微妙的情况下，数据访问对象 (DAO) 和数据传输对象 (DTO) 之间的紧张关系非常普遍。DAO 与数据库对话，DTO 可序列化以在进程和机器之间传输。通常 DAO 需要对您的数据库框架的引用，因此它们在您的富客户端上不可用，这些客户端既没有安装数据库驱动程序，也没有访问数据库的必要权限。

### 代码气味

*   类中的方法开始按功能区域分组（“这些是`Coffee`方法，这些是`Soup`方法”）。

*   实现许多接口。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-29T07:59:17.640

嗯，这个原理是要和一些盐一起使用的……以避免类爆炸。

单一职责不会转化为单一方法类。这意味着存在的唯一理由……对象为其客户提供的服务。

留在路上的好方法...使用对象作为人的隐喻...如果对象是人，我会要求谁这样做？将该职责分配给相应的类。但是，您不会要求同一个人来管理文件、计算工资、发放薪水和验证财务记录……为什么要一个对象来完成所有这些工作？（*如果一个类承担多个职责，只要它们都是相关且连贯的，就可以了。*）

*   如果您使用 CRC 卡，这是一个很好的微妙指南。如果您无法在 CRC 卡上获取该对象的所有职责，那么它可能做的太多了……最多 7 个可以作为一个很好的标记。
*   重构书中的另一个代码味道是巨大的类。霰弹枪手术将是另一种......对一个班级中的一个区域进行更改会导致同一班级的不相关区域出现错误......
*   发现您一次又一次地为不相关的错误修复对同一个类进行更改是另一个表明该类做得太多的迹象。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-29T08:52:18.893

检查单一职责（不仅是类，还包括类的方法）的一种简单实用的方法是名称选择。当你设计一个类时，如果你很容易找到一个准确地指定它定义的类的名称，那么你就走对了。选择一个名字的困难几乎总是糟糕设计的征兆。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-29T07:51:18.593

你的类中的方法应该是有凝聚力的......它们应该一起工作并在内部使用相同的数据结构。如果你发现你有太多看起来并不完全相关的方法，或者似乎对不同的事物进行操作，那么很可能你没有一个好的单一职责。

通常最初很难找到责任，有时您需要在几个不同的上下文中使用该类，然后在您开始看到区别时将该类重构为两个类。有时您会发现这是因为您将抽象和具体的概念混合在一起。它们往往更难看到，同样，在不同的环境中使用将有助于澄清。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-29T07:52:41.493

明显的迹象是当你的类最终看起来像一个[大泥球时](http://en.wikipedia.org/wiki/Big_ball_of_mud)，这实际上与 SRP（单一责任原则）相反。

基本上，所有对象的服务都应该专注于执行单一职责，这意味着每次您的类更改并添加不尊重这一点的服务时，您知道您正在“偏离”“正确”路径；）

原因通常是由于匆忙添加到类中以修复某些缺陷的一些快速修复。因此，**您更改课程的原因**通常是检测您是否即将打破 SRP 的最佳标准。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-12-30T10:16:14.240

Martin 的[C# 中的敏捷原则、模式和实践](https://rads.stackoverflow.com/amzn/click/com/0131857258)对我掌握 SRP 帮助很大。他将 SRP 定义为：

> 一个类应该只有一个改变的理由。

那么是什么推动了变革？

马丁的回答是：

> [...] 每项责任都是变革的轴心。（第[116](https://rads.stackoverflow.com/amzn/click/com/0131857258)页）

并进一步：

> 在 SRP 的上下文中，我们将责任定义为变更的原因。如果你能想到改变一个班级的不止一个动机，那么这个班级就有不止一个责任（第[117](https://rads.stackoverflow.com/amzn/click/com/0131857258)页）

事实上，SRP 正在封装变化。如果发生变化，它应该只会产生局部影响。

雅格尼在哪里？

YAGNI 可以与 SRP 很好地结合：当你应用 YAGNI 时，你会等到一些变化实际发生。如果发生这种情况，您应该能够清楚地看到从更改原因推断出的责任。

这也意味着责任可以随着每个新的要求和变化而发展。进一步思考 SRP 和 YAGNI 将为您提供思考灵活设计和架构的方法。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-25T13:02:38.867

也许比其他气味更具技术性：

*   如果你发现你需要几个“朋友”类或函数，那通常是不好的 SRP 的好味道——因为所需的功能实际上并没有被你的类公开。
*   如果你最终得到一个过于“深”的层次结构（一长串派生类，直到你到达叶类）或“广泛”的层次结构（很多很多类从单个父类中派生出来）。这通常表明父类做得太多或太少。什么都不做是限制，是的，我在实践中已经看到，使用“空”父类定义只是将一堆不相关的类组合在一个层次结构中。

我还发现重构为单一职责很困难。当你最终解决它时，类的不同职责将在客户端代码中交织在一起，这使得很难在不破坏另一件事的情况下将一件事分解出来。我宁愿自己犯“太少”而不是“太多”的错误。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-25T13:35:13.137

如果您最终使用`MethodA`那个用途`MemberA`并且`MethodB`那个用途`MemberB`并且它*不是*某些并发或版本控制方案的一部分，那么您可能违反了 SRP。

如果您注意到您有一个类只是将调用委托给许多其他类，您可能会陷入代理类地狱。如果您最终在任何地方都实例化代理类，而您可以直接使用特定类，则尤其如此。我见过很多这样的。思考`ProgramNameBL`和`ProgramNameDAL`类作为使用存储库模式的替代品。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-08-30T18:54:45.863

这里有一些事情可以帮助我弄清楚我的班级是否违反了 SRP：

*   填写关于类的 XML 文档注释。如果你使用 if、and、but、except、when 等词，你的类可能做得太多了。
*   如果您的类是域服务，则名称中应包含动词。很多时候你有像“OrderService”这样的类，它可能应该被分解成“GetOrderService”、“SaveOrderService”、“SubmitOrderService”等。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-12-24T18:34:19.660

我也一直在尝试了解[OOD 的 SOLID 原则](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)，特别是单一责任原则，即 SRP（作为旁注[，与 Jeff Atwood、Joel Spolsky 和“Uncle Bob”的播客](https://blog.stackoverflow.com/2009/02/podcast-41/)值得一听）。对我来说最大的问题是：SOLID 试图解决什么问题？

OOP 是关于建模的。[建模的主要目的](http://www.virtualsalt.com/crebook4.htm)是以使我们能够理解和解决问题的方式呈现问题。建模迫使我们专注于重要的细节。同时我们可以使用封装来隐藏“不重要”的细节，这样我们只需要在绝对必要的时候处理它们。

我想你应该问自己：你的班级试图解决什么问题？解决这个问题所需的重要信息是否浮出水面？是否隐藏了不重要的细节，以便您仅在绝对必要时才考虑它们？

考虑这些事情会导致程序更容易理解、维护和扩展。我认为这是 OOD 和 SOLID 原则的核心，包括 SRP。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-12-30T10:19:28.197

我想提出的另一条经验法则如下：

如果您觉得需要在测试用例中编写某种笛卡尔积，或者如果您想模拟类的某些私有方法，则违反了单一职责。

我最近通过以下方式获得了这个：我有一个协程的 cetain 抽象语法树，稍后将生成到 C 中。现在，将节点视为 Sequence、Iteration 和 Action。序列链两个协程，迭代重复一个协程，直到用户定义的条件为真，Action 执行某个用户定义的动作。此外，可以使用代码块来注释动作和迭代，这些代码块定义了在协程前进时要评估的动作和条件。

有必要对所有这些代码块进行某种转换（对于那些感兴趣的人：我需要用实际的实现变量替换概念性用户变量，以防止变量冲突。了解 lisp 宏的人可以想到 gensym 的实际应用： ））。因此，最简单的工作是一个访问者，它在内部知道操作，只需在访问时操作和迭代的注释代码块上调用它们并遍历所有语法树节点。但是，在这种情况下，我不得不在我的测试代码中为 visitAction-Method 和 visitIteration-Method 复制断言“应用了转换”。换句话说，我必须检查产品测试用例的职责 Traversion (== {traverse iteration, traverse action, traverse sequence}) x Transformation (well, 代码块转换，它爆炸成迭代转换和动作转换）。因此，我很想使用 powermock 删除转换方法并将其替换为一些 'return "I was changed!";'-Stub。

但是，根据经验，我将类拆分为一个类 TreeModifier，其中包含一个 NodeModifier-instance，它提供了 modifyIteration、modifySequence、modifyCodeblock 等方法。因此，我可以很容易地测试遍历的职责，调用 NodeModifier 和重构树并分别测试代码块的实际修改，从而消除了对产品测试的需要，因为现在职责分离了（遍历和重构和具体修改）。

有趣的是，稍后我可以在各种其他转换中大量重用 TreeModifier。:)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-25T13:22:48.590

如果您在扩展类的功能时遇到麻烦，而不必担心最终可能会破坏其他东西，或者如果不修改其大量选项就无法使用类，这些选项会修改其行为，这听起来就像您的类做的太多了。

一旦我使用具有方法“ZipAndClean”的遗留类，这显然是压缩和清理指定的文件夹......

# c++ - 带有 VS2005/8 的 C++ 中 Firefox 的可脚本化插件的基本示例

> ID：246071
> 
> 赞同：4
> 
> 时间：2008-10-29T07:50:42.027
> 
> 标签：c++, visual-studio, scripting, npapi

我为 Firefox 编写插件的经验低于零。有没有人可以指出我如何使用 VS2005/8 在 C++ 中完成此任务的示例代码？

我需要在托管 html 页面中使用 JavaScript 做的事情是这样的：

```
var obj = document.getElementById("MyFFPlugin");

var value = obj.CalculateValue;

// Work with calculated value 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-29T07:58:05.960

SDK 有关于如何编写 mozzila 插件的基本示例，可以在这里下载：http: [//mxr.mozilla.org/seamonkey/source/modules/plugin/tools/sdk/](http://mxr.mozilla.org/seamonkey/source/modules/plugin/tools/sdk/)

这是官方的 mozilla 插件站点[http://www.mozilla.org/projects/plugins/](http://www.mozilla.org/projects/plugins/)

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T19:46:49.313

我强烈推荐使用封装了 NPAPI 的 Nixysa [http://code.google.com/p/nixysa/](http://code.google.com/p/nixysa/)。从网站：

> Nixysa 是一个用 Python 编写的框架，用于自动为 NPAPI 插件（用于 Google Chrome 或 Firefox 等浏览器的插件）生成胶水代码，让您可以轻松地将 C++ 类从简单的 IDL 表示形式暴露给 Javascript。Nixysa 最初是为满足 O3D 的需求而设计的，但它足够灵活，可以支持广泛的用例。
> 
> 尝试一下
> 
> 按照此处的说明查看代码，并尝试示例/复杂中的示例。

该示例包括一个 Visual Studio 2005 项目。

# c++ - 如何声明 Windows VK_ 常量？

> ID：246077
> 
> 赞同：2
> 
> 时间：2008-10-29T07:53:55.857
> 
> 标签：c++, windows, winapi

例如 VK_LEFT、VK_DELETE、VK_ESCAPE、VK_RETURN 等。它们是如何以及在哪里声明的？它们是常量、#defines 还是其他？他们来自哪里？

如果可能，请提供声明它们的文件名/路径。或其他一些尽可能具体的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T07:58:43.930

这些是在 Platform SDK`#define`的文件中声明的。`winuser.h`在我安装的 Visual Studio 2008 中，完整路径是

```
C:\Program Files\Microsoft SDKs\Windows\v6.0A\Include\WinUser.h 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T14:45:52.627

也有 winuser.h 的在线副本，有时非常方便：

[http://www.woodmann.com/fravia/sources/WINUSER.H](http://www.woodmann.com/fravia/sources/WINUSER.H) [http://doc.ddart.net/msdn/header/include/winuser.h.html](http://doc.ddart.net/msdn/header/include/winuser.h.html)

一些谷歌搜索会让你得到更多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-29T08:50:32.077

要查找如何声明某些内容，请安装 Visual Assist，将光标放在代码中的标识符上并按 Alt+G
或者，右键单击标识符并选择“转到定义”
或按 F12

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T08:04:14.557

这些是宏定义的常量，[在 winuser.h 中声明](http://msdn.microsoft.com/en-us/library/ms646271(VS.85).aspx)。要查找声明或定义某些内容的位置，您可以阅读其文档（Microsoft 在末尾包含一个部分，在 Unix 手册页中它出现在开头），或者转到标题所在的目录并 grep 查找您的内容寻找。

# c# - EBNF 到流畅的界面

> ID：246080
> 
> 赞同：3
> 
> 时间：2008-10-29T07:56:22.640
> 
> 标签：c#, sql, linq, fluent-interface, ebnf

我最近需要为 C# 编写一个流畅的接口，它本质上将镜像 SQL。是的，我知道 LINQ to SQL，但我对“更接近金属”很感兴趣——*在*C# 中拥有的东西基本上只提供了一个 Intellisensified SQL shim。

例如，

```
var fq = new FluentQuery();
Expression<Action> =
    () => fq.SELECT.DISTINCT(Foo.ID).FROM(Foo).WHERE(Foo.Age > 22); 
```

现在，我在想这个概念可以被推广——也就是说，一个通用的 EBNF 到流利的接口生成器怎么样？有谁知道这样的野兽是否存在？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T08:31:08.030

我喜欢它，但是您必须确保返回 HasFromAndSelect 之类的类型或类似的东西，这样您就不会以`fq.SELECT(Foo.ID).SELECT(Foo.Age).WHERE(Foo.Age > 22)`or`fq.WHERE(Foo.Age > 22).SELECT(Foo.ID)`等​​结尾。

还有更多需要考虑的问题，包括大写锁定模式伤害了我的眼睛这一事实:)

# ruby - Ruby 中的 .NET 事件等价物是什么？

> ID：246091
> 
> 赞同：11
> 
> 时间：2008-10-29T08:07:17.313
> 
> 标签：ruby, events, oop

问题很简单。一个对象需要通知一些观察者可能感兴趣的事件。

当我坐下来验证我现在用 Ruby 编写的设计时只是为了验证它。我发现自己对如何实现对象事件感到困惑。在 .Net 中，这将是一个单线.. .Net 还进行处理程序方法签名验证等。例如

```
// Object with events
public delegate void HandlerSignature(int a);
public event HandlerSignature MyEvent;
public event HandlerSignature AnotherCriticalEvent;

// Client
MyObject.MyEvent += new HandlerSignature(MyHandlerMethod); // MyHandlerMethod has same signature as delegate 
```

是否有 EventDispatcher 模块或我缺少的东西可以绑在 Ruby 类上？希望得到一个符合 Ruby 最小意外原则的答案。 *事件将是事件的名称加上事件发生时需要调用的 [observer, methodName] 对象的队列。*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-29T09:37:42.543

首先，在 Ruby 中没有方法签名。最接近的是检查函数的数量。鸭子打字需要不同的思考（稍微）。

Observable 模块是一个开始，但如果您需要从一个类中获取多个事件，那可能还不够。

这是一个速写。它支持方法和块。根据需要进行修改以适应您的代码、线程方法等。例如，您可以使用 method_missing 在方法名称中包含事件名称，而不是将其作为参数。

```
class EventBase
    def initialize
        @listeners = Hash.new
    end

    def listen_event(name, *func, &p)
        if p
            (@listeners[name] ||= Array.new) << p
        else
            (@listeners[name] ||= Array.new) << func[0]
        end
    end

    def ignore_event(name, func)
        return if !@listeners.has_key?(name)
        @listeners[name].delete_if { |o| o == func }
    end

    def trigger_event(name, *args)
        return if !@listeners.has_key?(name)
        @listeners[name].each { |f| f.call(*args) }
    end
end

class MyClass < EventBase
    def raise_event1(*args)
        trigger_event(:event1, *args)
    end

    def raise_event2(*args)
        trigger_event(:event2, *args)
    end
end

class TestListener
    def initialize(source)
        source.listen_event(:event1, method(:event1_arrival))
        source.listen_event(:event2) do |*a|
            puts "event 2 arrival, args #{a}"
        end
    end

    def event1_arrival(*a)
        puts "Event 1 arrived, args #{a}"
    end
end

s = MyClass.new
l = TestListener.new(s)

s.raise_event1("here is event 1")
s.raise_event2("here is event 2") 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-02-05T08:41:00.880

为什么不编写自己的事件类？就像是

```
class Event
  def initialize
    @handlers = Array.new
  end

  def fire
    @handlers.each do |v|
      v.call
    end
  end

  def << handler
    @handlers << handler
  end
end

e = Event.new

e << lambda { puts "hello" }
e << lambda { puts "test" }
e.fire 
```

这只是一个最小的示例，但可以以任何方式扩展。在 .Net 中添加像 sender 和 eventArgs 这样的参数，或者任何你喜欢的 ;-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T13:41:50.267

我会回应说，在 Ruby 中没有语言级别的类比到 .NET 事件。rails 处理它的方式是使用[ActiveSupport::Callbacks](http://www.railsbrain.com/api/rails-2.1.0/doc/index.html?a=C00000430&name=Callbacks)（该页面上有一个示例）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-29T08:51:55.977

可[观察模块](http://ruby-doc.org/core/classes/Observable.html)?

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-10T09:34:24.403

查看各种[ruby​​ 状态机库](https://www.ruby-toolbox.com/categories/state_machines.html "国家机器")。他们打算解决一个大问题而不仅仅是事件，但可能会为您提供解决方案。

我已经成功使用了[state_machine](https://github.com/pluginaweek/state_machine) gem，**它确实包括[events](http://rdoc.info/github/pluginaweek/state_machine/master/StateMachine/Event)**。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-28T03:11:33.317

正如您所提到的，我已经创建了一个完全符合您要求的 gem，并且令人惊讶地称为 event_dispatcher。我希望它会帮助某人：[event_dispatcher](https://github.com/ThatAmine/event_dispatcher)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-16T13:21:25.327

我是个菜鸟，但 Ruby 似乎真的很强大。您可以像这样自己实现 C# 样式事件：

```
module Observable
    class Event 
        def initialize
            @to_call = []
        end
        def fire(*arguments)
            @to_call.each { |proc| proc.call(*arguments) }
        end
        def call(proc)
            @to_call << proc
        end
        def dont_call(proc)
            @to_call.delete proc
        end
    end
    def self.append_features(cls)
        def cls.event(sym)
            define_method(sym.to_s) do
                variable_name = "@#{sym}"
                if not instance_variable_defined? variable_name then
                    instance_variable_set variable_name, Event.new
                end
                instance_variable_get variable_name
            end
        end
    end
end

# Example 

class Actor 
    include Observable
    event :whenActed
    def act
        whenActed.fire("Johnny") # fire event whenActed with parameter Johnny
    end
end

actor = Actor.new

def apploud(whom)
    print "Bravo #{whom}!\n"
end

applouder = method(:apploud)

actor.whenActed.call applouder

actor.act 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-29T08:00:56.703

我为此写了一个 gem，因为我遇到了完全相同的问题。尝试这个：

```
gem install ruby_events 
```

按照[http://github.com/nathankleyn/ruby_events](http://github.com/nathankleyn/ruby_events)上的说明进行操作，但简而言之：

```
require 'rubygems'
require 'ruby_events'

class Example
  def initialize
    events.listen(:test_event) do |event_data|
      puts 'Hai there!'
      puts event_data
    end
  end

  def call_me
    events.fire(:test_event, 'My name is Mr Test Man!')
  end
end

e = Example.new
e.call_me # Fires the event, and our handler gets called! 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-03-07T08:51:29.793

关于这一点的快速说明。我建议你看看[EventMachine](https://rubygems.org/gems/eventmachine)

*   [https://rubygems.org/gems/eventmachine](https://rubygems.org/gems/eventmachine)

这是一个不同的外观相同的想法。它实现了一个事件驱动的范例，因此您比 .Net Events 的等价物高一级，并将[EventMachine](https://rubygems.org/gems/eventmachine)模块视为 CLR 事件处理程序。

同样退后一步，Ruby 遵循 Smalltalk 处理模型，其中对方法的任何调用都是发送给对象的消息（如事件一样）（参见 Send() 方法）。 [EventMachine](https://rubygems.org/gems/eventmachine)为您提供事件的单线程切片。您可以使用 Rack 之类的东西来处理线程或工作线程。

# internationalization - 国际电话和地址数据？

> ID：246097
> 
> 赞同：6
> 
> 时间：2008-10-29T08:13:24.337
> 
> 标签：internationalization, street-address

我想这是一个多部分的问题。我正在建立一个会员网站，并希望帐户尽可能国际化。

1.  在允许国际号码的表格上收集电话号码的最佳方法是什么？我不担心存储它们，只是收集和验证。我现在拥有的是一个带有国家列表的下拉列表，它将添加国家代码，然后是根据国家代码验证 us/can/uk 的号码本身，然后是扩展名。这些将作为字符串存储在 cc/number/ext 的 3 个字段中 有没有人对此有更好、更可靠的解决方案，或者可能在任何地方都看到过这种解决方案？

2.  地址同上。最好的方法是什么？地址/城市/州/邮编/国家或只是线路？我希望能够按这些排序，因此单个文本字段不是一个很好的解决方案，尽管它是最灵活的。

    这也很重要，因为我们可能会向我们的会员发送实际邮件。我想起了我在其他服务中拥有的一些成员，这些成员的地址位于我从未听说过的国家/地区，即使是邮局的女士也无法判断它们的格式是否正确。

3.  我想在数据库中至少有国家/州的地理数据，例如在选择国家、字段标准化等后填充州下拉列表。有谁知道可以用作应用程序地理数据库的优秀数据库?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T09:05:29.537

电话号码验证 - 我不确定我是否会花很多时间在这上面。编号方案经常更改（例如，在我住在英国期间，伦敦区号的电话号码至少更改了一次，在我搬到那里之前不久又更改了一次），而在德国（或至少习惯于是）通过获取旧号码并在末尾添加一两个额外数字来增加给定交换中可用电话号码的数量是很常见的。所以任何关于给定电话号码格式的假设都会改变，你最终会追赶上来。如果您坚持将电话号码拆分为国际/区号/主要号码，您可能会发现这是一种非常特定于国家/地区的信息表示方式，因此您 几乎每个国家和特定的验证规则都需要一个输入掩码。更不用说在像德国这样的地方，区号可以有两到四位数字等......

关于邮政地址，我最重要的建议是确保您可以接受非数字邮政/邮政编码，否则您将无法处理加拿大和英国（以及可能其他地方）的地址。这有点像我的爱好，因为我在其他国家/地区的网站上遇到了一些问题，这些网站根本拒绝让我输入非数字邮政编码，我不得不求助于传真我的地址信息，因为我无法填写在线申请表。在我的书中，如果你允许国际客户，那是不好的业力......

此外，假设地址的某些部分（例如州/县）存在并要求它们通常比它的价值更令人头疼。我很想提供标准门牌号+街道（将它们组合起来，不同的语言将门牌号放在不同的地方，所以恕我直言，将它们分开不是一个好主意，除非你知道如何正确地重新组合它们，而且有时你会以房屋名称而不是数字结尾），城镇和邮政编码，可能带有可选的县/州字段。如果您想对您的国际受众真正有帮助，请为那些不符合我们对地址外观的“标准”假设的地址提供一个自由格式的单一文本输入字段。并且请让它们足够大，这样地址很长的人就不会用完空间......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T22:36:25.817

电话号码有一个[国际标准](http://en.wikipedia.org/wiki/E.123)，但它留下了很大的喘息空间。分隔符不是强制性的，但仅限于空格、句点和连字符。圆括号（又名括号）将放在可选的数字周围，具体取决于您拨号的位置。例如，区号在某些地区是可选的。我会提供一个文本字段，让用户输入他们想要的号码。

对于地址，提供很多字段，不要限制太多。门牌号码有时包含字母。道路类型有时是完整的，有时是缩写的。（St = Street，Ave = Avenue 等）我会在可能的情况下提供下拉菜单（州/省），但当您没有列表时允许自由输入。当用户输入他们的地址时，可以验证安全风险，但您可能希望稍后再进行地理验证。例如，如果用户输入邮政编码 T8N 4E3 并选择安大略省作为他们的省份，则地址无效，因为给定的邮政编码是阿尔伯塔省的。向用户显示一条友好的消息，让他们知道他们需要更正他们的地址或在正确时与您联系（您的代码中可能存在错误）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T08:45:16.177

地址 - 记住不要到处都有州和邮政编码。如果你有邮政编码，它们可以是不同的格式（`[0-9]{2}-[0-9]{3}`这里）。（*编辑：*通常邮政地址有 2 个地址行，城市、州（可选）、邮政编码（可选）和国家/地区都可以）。

地理数据也是如此 - 您可以按州和城市进行连续下拉，但猜测您不会覆盖每个城市。为什么不显示一张谷歌地图，让用户点击那里标记他们的位置？

# c# - 调试 .NET 动态方法

> ID：246112
> 
> 赞同：5
> 
> 时间：2008-10-29T08:21:50.873
> 
> 标签：c#, .net, linq, debugging, dynamic-method

我们在我们的系统中非常广泛地使用 LINQ。特别是 LINQ-to-objects。因此，在某些地方，我们最终会在内存中使用一些巨大的表达式构建 LINQ 查询。当表达式中有一些错误时，问题就来了。所以我们得到 NullReferenceException 并且堆栈跟踪导致我们无处可去（到 [轻量级函数]）。异常是在 LINQ 生成的动态方法中引发的。

有没有简单的方法来调试这种动态方法？还是我必须牺牲自己来学习 WinDBG？:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T08:38:05.987

如果您正在构建自己的表达式并编译它们，或者使用 AsQueryable，那么可以；LINQ 生成的方法将是一个非常痛苦的调试。

*您可以通过使用实际*方法的小片段来节省一些痛苦- 至少有用的东西会显示在堆栈跟踪中......

另一个考虑因素是：与其拥有一个巨大的表达式，如果您可以将事物以菊花链方式连接得更多，您可能会（从堆栈跟踪）知道它失败的地方。缺点是性能 - Where(foo).Where(bar) 是两个委托调用，where-as Where(foo && bar) 可以是一个。

一种选择可能是换入扩展方法的调试版本；不幸的是，这有点不方便，因为`IQueryable<T>`和`Queryable`位于同一个命名空间中......不过，这很有效......

先输出：

```
>Where: x => ((x % 2) = 0)
<Where: x => ((x % 2) = 0)
>Count
'WindowsFormsApplication2.vshost.exe' (Managed): Loaded 'Anonymously Hosted DynamicMethods Assembly'
<Count 
```

代码：

```
using System;
using System.Diagnostics;
using System.Linq.Expressions;

namespace Demo
{
    using DebugLinq;
    static class Program
    {
        static void Main()
        {
            var data = System.Linq.Queryable.AsQueryable(new[] { 1, 2, 3, 4, 5 });
            data.Where(x => x % 2 == 0).Count(); 
        }
    }
}
namespace DebugLinq
{
    public static class DebugQueryable
    {
        public static int Count<T>(this System.Linq.IQueryable<T> source)
        {
            return Wrap(() => System.Linq.Queryable.Count(source), "Count");
        }

        public static System.Linq.IQueryable<T> Where<T>(this System.Linq.IQueryable<T> source, Expression<Func<T, bool>> predicate)
        {
            return Wrap(() => System.Linq.Queryable.Where(source, predicate), "Where: " + predicate);
        }
        static TResult Wrap<TResult>(Func<TResult> func, string caption)
        {
            Debug.WriteLine(">" + caption);
            try
            {
                TResult result = func();
                Debug.WriteLine("<" + caption);
                return result;
            }
            catch
            {
                Debug.WriteLine("!" + caption);
                throw;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T08:25:00.397

如果您使用的是 LINQ to Objects，我不希望看到创建动态方法。我希望他们使用 LINQ to SQL 等。你能举一个你看到这个的例子吗？

当谈到 LINQ 时，我真的没有任何好的调试技巧，但我很确定 MS 知道这是一个痛点。我可以建议你试试[VS2010 CTP](http://www.microsoft.com/downloads/details.aspx?FamilyId=922B4655-93D0-4476-BDA4-94CF5F8D4814&displaylang=en)看看是否更好？诚然，更多是为了改进 VS，而不是为了解决你眼前的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T23:03:31.867

看看最初由[Haibo Luo开发并由](http://blogs.msdn.com/haibo_luo/archive/2005/10/25/484861.aspx)[Roy Osherove](http://weblogs.asp.net/rosherove/archive/2006/04/25/MethodsVisualizer.aspx)进一步开发的动态方法的[调试可视化器](http://weblogs.asp.net/rosherove/archive/2007/11/02/debugger-visualizers-for-methodinfo-dynamicmethod-and-methodbase.aspx)

# svn - 如何让 svnant/svnkit 提示输入用户名/密码

> ID：246121
> 
> 赞同：3
> 
> 时间：2008-10-29T08:28:16.320
> 
> 标签：svn, ant, svnkit, svnant

我有一个需要从 Subversion 签出目录的 Ant 脚本。这可以使用 svnant/svnkit。但是，Subversion 访问是经过身份验证的，我不想将我的用户密码存储在文件中。

我可以让 svnkit 弹出密码对话框吗？或者更好的是，让它使用与 Eclipse 内部的 subversive/svnkit 相同的凭证缓存（用户名可以从 build.properties 中读取）？

我无法切换到基于公钥的身份验证，因为我不控制颠覆服务器。

现在，它只是说“svn：身份验证已取消”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-12-04T02:49:10.610

[这个答案](https://stackoverflow.com/questions/246121/how-do-i-make-svnant-svnkit-prompt-for-a-username-password/246378#246378)的模拟：

```
<input message="password:>" addproperty="password">
      <handler classname="org.apache.tools.ant.input.SecureInputHandler" />
</input> 
```

这将使该人的用户名不显示。这需要 Ant 1.7.1 或更高版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T10:46:28.710

为了回答我自己的问题，我可以使用 Ant [input] 任务向用户询问密码并将其存储在可以传递给 [svn] 任务的属性中。

```
 <target name="checkout">
    <input
        message="Please enter subversion password for ${username}:"
        addproperty="password"
      />

    <svn svnkit="${svnkit}" username="${username}" password="${password}">
        <checkout url="${urlRepos}/project" destPath="web/" />
    </svn> 
</target> 
```

不幸的是，这不会用 * * * * * 掩盖密码，我仍然想从凭证缓存中读取......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T00:37:54.163

[Jera Ant Tasks](http://www.jera.com/tools/anttasks/)提供了一个支持密码输入的[query] 任务：

```
<taskdef name="query" classname="com.jera.anttasks.Query" />
<target name="checkout">
  <query
    message="Please enter subversion password for ${username}:"
    name="password"  password="true"
  />

  <svn svnkit="${svnkit}" username="${username}" password="${password}">
    <checkout url="${urlRepos}/project" destPath="web/" />
  </svn> 
</target> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-31T14:49:09.610

使用 ant-dialog ( [http://sourceforge.net/projects/ant-dialog/](http://sourceforge.net/projects/ant-dialog/) )，它可以显示一个 java awt 窗口，以便您输入属性。它还具有类似于输入字段类型的 *** 密码。

# python - HTTP 合规性测试

> ID：246123
> 
> 赞同：2
> 
> 时间：2008-10-29T08:29:59.793
> 
> 标签：python, http, testing, standards-compliance

您将使用什么来执行 HTTP 代理的合规性测试？到目前为止，我已经看到了两个项目：

*   [网络测谎仪](http://www.web-polygraph.org/)（我从同事那里得到的反馈大多是负面的）
*   [下载](http://funkload.nuxeo.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-29T23:36:02.273

看看这里：[http ://www.measurement-factory.com/](http://www.measurement-factory.com/)

联合顾问产品可能就是您所追求的。请注意，这是由创建 Web-Polygraph/ 的同一群暴民造成的。

# c - 为什么在 C 中需要 volatile？

> ID：246127
> 
> 赞同：493
> 
> 时间：2008-10-29T08:36:39.063
> 
> 标签：c, declaration, volatile

为什么`volatile`在 C 中需要？它是干什么用的？它会做什么？

* * *

## 回答 #1

> 赞同：524
> 
> 时间：2008-10-29T08:45:30.823

`volatile`告诉编译器不要优化与`volatile`变量有关的任何内容。

使用它至少有三个常见的原因，所有这些都涉及变量的值可以在没有可见代码的操作的情况下改变的情况： 当您与改变值本身的硬件接口时；当有另一个线程在运行时也使用该变量；或者当有一个信号处理程序可能会改变变量的值时。

假设你有一小块硬件被映射到某个地方的 RAM 中，它有两个地址：一个命令端口和一个数据端口：

```
typedef struct
{
  int command;
  int data;
  int isBusy;
} MyHardwareGadget; 
```

现在你想发送一些命令：

```
void SendCommand (MyHardwareGadget * gadget, int command, int data)
{
  // wait while the gadget is busy:
  while (gadget->isbusy)
  {
    // do nothing here.
  }
  // set data first:
  gadget->data    = data;
  // writing the command starts the action:
  gadget->command = command;
} 
```

看起来很简单，但它可能会失败，因为编译器可以随意更改写入数据和命令的顺序。这将导致我们的小工具使用之前的数据值发出命令。还要看一下忙时等待循环。那一个将被优化出来。编译器会尽量聪明，`isBusy`只读取一次的值，然后进入无限循环。那不是你想要的。

解决这个问题的方法是将指针声明`gadget`为`volatile`. 这样编译器就被迫做你写的事情。它不能删除内存分配，它不能缓存寄存器中的变量，也不能改变分配的顺序

这是正确的版本：

```
void SendCommand (volatile MyHardwareGadget * gadget, int command, int data)
{
  // wait while the gadget is busy:
  while (gadget->isBusy)
  {
    // do nothing here.
  }
  // set data first:
  gadget->data    = data;
  // writing the command starts the action:
  gadget->command = command;
} 
```

* * *

## 回答 #2

> 赞同：225
> 
> 时间：2008-10-29T08:44:22.513

`volatile`实际上，C 中的存在是为了不自动缓存变量的值。它会告诉编译器不要缓存这个变量的值。`volatile`因此，每次遇到给定变量时，它都会生成代码以从主内存中获取给定变量的值。使用这种机制是因为任何时候操作系统或任何中断都可以修改该值。因此，使用`volatile`将帮助我们每次都重新访问该值。

* * *

## 回答 #3

> 赞同：207
> 
> 时间：2008-10-29T10:52:39.553

另一个用途`volatile`是信号处理程序。如果你有这样的代码：

```
int quit = 0;
while (!quit)
{
    /* very small loop which is completely visible to the compiler */
} 
```

允许编译器注意到循环体没有触及`quit`变量并将循环转换为`while (true)`循环。即使`quit`在信号处理程序上为`SIGINT`and设置了变量`SIGTERM`；编译器无法知道这一点。

但是，如果`quit`声明了变量`volatile`，编译器每次都被迫加载它，因为它可以在其他地方修改。这正是您在这种情况下想要的。

* * *

## 回答 #4

> 赞同：63
> 
> 时间：2008-10-29T08:41:28.803

`volatile`告诉编译器您的变量可能会通过其他方式更改，而不是访问它的代码。例如，它可能是一个 I/O 映射的内存位置。如果在这种情况下未指定，则可以优化某些变量访问，例如，可以将其内容保存在寄存器中，并且不会再次读回内存位置。

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2010-07-22T12:33:43.130

请参阅 Andrei Alexandrescu 的这篇文章，“ [volatile - 多线程程序员最好的朋友](http://www.drdobbs.com/184403766)”

> **volatile**关键字旨在防止在存在某些异步事件的情况下可能导致代码不正确的编译器优化。例如，如果您将原始变量声明为 **volatile**，则不允许编译器将其缓存在寄存器中——如果该变量在多个线程之间共享，这种常见的优化将是灾难性的。所以一般规则是，如果您有必须在多个线程之间共享的原始类型变量，请将这些变量声明为**volatile**. 但是你实际上可以用这个关键字做更多的事情：你可以用它来捕捉不是线程安全的代码，你可以在编译时这样做。本文展示了它是如何完成的；该解决方案涉及一个简单的智能指针，它还可以轻松序列化代码的关键部分。

本文适用于`C`和`C++`。

另请参阅 Scott Meyers 和 Andrei Alexandrescu 的文章“ [C++ 和双重检查锁定的危险](http://www.aristeia.com/Papers/DDJ_Jul_Aug_2004_revised.pdf)”：

> 所以在处理一些内存位置时（例如内存映射端口或由 ISR [中断服务例程] 引用的内存），必须暂停一些优化。volatile 存在用于指定对此类位置的特殊处理，具体而言：（1）volatile 变量的内容是“不稳定的”（可以通过编译器未知的方式更改），（2）对 volatile 数据的所有写入都是“可观察的”，因此它们必须认真执行，并且 (3) 对 volatile 数据的所有操作都按照它们在源代码中出现的顺序执行。前两条规则确保正确的读写。最后一个允许实现混合输入和输出的 I/O 协议。这是 C 和 C++ 的 volatile 保证的非正式内容。

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2015-01-24T07:01:56.197

我的简单解释是：

在某些场景下，编译器会根据逻辑或代码，对它认为不会改变的变量进行优化。`volatile`关键字防止变量被优化。

例如：

```
bool usb_interface_flag = 0;
while(usb_interface_flag == 0)
{
    // execute logic for the scenario where the USB isn't connected 
} 
```

从上面的代码中，编译器可能会认为`usb_interface_flag`定义为0，并且在while循环中它将永远为零。优化后，编译器会一直将其视为`while(true)`一直，导致无限循环。

为了避免这种情况，我们将该标志声明为volatile，我们告诉编译器这个值可能被外部接口或程序的其他模块改变，即请不要优化它。这就是 volatile 的用例。

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2010-06-30T11:34:34.697

volatile 的边际用途如下。假设您要计算函数的数值导数`f`：

```
double der_f(double x)
{
    static const double h = 1e-3;
    return (f(x + h) - f(x)) / h;
} 
```

问题是由于舍入误差`x+h-x`通常不等于。`h`想想看：当你减去非常接近的数字时，你会丢失很多有效数字，这会破坏导数的计算（想想 1.00001 - 1）。一个可能的解决方法可能是

```
double der_f2(double x)
{
    static const double h = 1e-3;
    double hh = x + h - x;
    return (f(x + hh) - f(x)) / hh;
} 
```

但是根据您的平台和编译器开关，该函数的第二行可能会被积极优化的编译器清除。所以你改写

```
 volatile double hh = x + h;
    hh -= x; 
```

强制编译器读取包含 hh 的内存位置，从而丧失最终的优化机会。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2011-07-30T04:59:31.793

有两种用途。这些在嵌入式开发中更常用。

1.  编译器不会优化使用 volatile 关键字定义的变量的函数

2.  易失性用于访问 RAM、ROM 等中的确切内存位置......这更常用于控制内存映射设备、访问 CPU 寄存器和定位特定内存位置。

请参阅带有汇编列表的示例。 [回复：在嵌入式开发中使用 C“volatile”关键字](http://www.expertcore.org/viewtopic.php?f=18&t=2674#p7737)

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2011-11-26T10:05:46.443

我将提到挥发性物质很重要的另一种情况。

假设您对文件进行内存映射以获得更快的 I/O，并且该文件可以在后台更改（例如，该文件不在您的本地硬盘驱动器上，而是由另一台计算机通过网络提供服务）。

如果您通过指向非易失性对象的指针（在源代码级别）访问内存映射文件的数据，那么编译器生成的代码可以在您不知道的情况下多次获取相同的数据。

如果该数据碰巧发生了变化，您的程序可能会使用两个或多个不同版本的数据并进入不一致的状态。如果它处理不受信任的文件或来自不受信任位置的文件，这不仅会导致程序的逻辑错误行为，而且还会导致可利用的安全漏洞。

如果您关心安全性，并且应该考虑，这是一个需要考虑的重要场景。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2008-10-29T08:46:43.380

当您想强制编译器不优化特定代码序列（例如，用于编写微基准测试）时，易失性也很有用。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2011-07-09T03:14:54.377

volatile 表示存储可能随时更改并且会更改，但超出用户程序的控制范围。这意味着如果您引用该变量，程序应始终检查物理地址（即映射的输入 fifo），而不是以缓存的方式使用它。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2018-07-13T22:28:51.867

在 Dennis Ritchie 设计的语言中，对任何对象的每次访问，除了地址未被获取的自动对象外，都会表现得好像它计算了对象的地址，然后读取或写入该地址的存储。这使得该语言非常强大，但严重限制了优化机会。

虽然可以添加一个限定符，让编译器假设特定对象不会以奇怪的方式更改，但这种假设适用于 C 程序中的绝大多数对象，并且它会为适合这种假设的所有对象添加限定符是不切实际的。另一方面，一些程序需要使用一些这样的假设不成立的对象。为了解决这个问题，标准规定编译器可能会假设未声明的对象不会`volatile`以编译器无法控制的方式观察或更改其值，或者超出编译器的合理理解范围。

因为不同的平台可能有不同的方式可以在编译器的控制之外观察或修改对象，所以这些平台的高质量编译器应该在它们对`volatile`语义的精确处理方面有所不同。不幸的是，由于该标准未能建议用于平台上低级编程的高质量编译器应该`volatile`以能够识别该平台上特定读/写操作的任何和所有相关影响的方式处理，因此许多编译器未能做到因此，以一种高效但不能被编译器“优化”破坏的方式处理后台 I/O 之类的事情变得更加困难。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2018-10-22T17:34:04.457

简单来说，它告诉编译器不要对特定变量进行任何优化。映射到设备寄存器的变量由设备间接修改。在这种情况下，必须使用 volatile。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2016-03-14T15:26:33.657

在我看来，你不应该对`volatile`. 为了说明这一点，请查看[Nils Pipenbrinck 的高票回答](https://stackoverflow.com/a/246148/1677912)中的示例。

我想说，他的例子不适合`volatile`. `volatile`仅用于： *防止编译器进行有用且理想的优化*。这与线程安全、原子访问甚至内存顺序无关。

在那个例子中：

```
 void SendCommand (volatile MyHardwareGadget * gadget, int command, int data)
    {
      // wait while the gadget is busy:
      while (gadget->isbusy)
      {
        // do nothing here.
      }
      // set data first:
      gadget->data    = data;
      // writing the command starts the action:
      gadget->command = command;
    } 
```

只有编译器在编译后的代码中才能保证before `gadget->data = data`only 。`gadget->command = command`在运行时，处理器仍可能根据处理器架构重新排序数据和命令分配。硬件可能会得到错误的数据（假设小工具映射到硬件 I/O）。数据和命令分配之间需要内存屏障。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2012-09-05T14:54:47.183

Wiki 说了所有关于`volatile`：

*   [易失性（计算机编程）](http://en.wikipedia.org/wiki/Volatile_variable)

Linux内核的文档也对以下内容做了很好的注释`volatile`：

*   [为什么不应该使用“volatile”类型的类](http://kernel.org/doc/Documentation/volatile-considered-harmful.txt)

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-10-29T08:45:31.760

一个 volatile 可以从编译后的代码外部更改（例如，一个程序可能将一个 volatile 变量映射到一个内存映射寄存器。）编译器不会对处理 volatile 变量的代码应用某些优化 - 例如，它不会t 将其加载到寄存器而不将其写入内存。这在处理硬件寄存器时很重要。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-12-08T12:16:42.743

正如许多人在这里正确建议的那样， volatile 关键字的流行用途是跳过对 volatile 变量的优化。

在阅读 volatile 后想到的最好的优点是——*防止*在`longjmp`. 非本地跳转。

这是什么意思？

*它只是意味着在您进行堆栈展开*后将保留最后一个值，以返回到先前的堆栈帧；通常在某些错误情况下。

由于它超出了这个问题的范围，我不会在`setjmp/longjmp`这里详细介绍，但值得一读；以及如何使用波动率特征来保留最后一个值。

* * *

## 回答 #18

> 赞同：-3
> 
> 时间：2010-05-21T19:23:27.940

它不允许编译器自动更改变量的值。volatile 变量用于动态使用。

# testing - 如何为 Eclipse 插件项目设置测试项目

> ID：246130
> 
> 赞同：6
> 
> 时间：2008-10-29T08:37:25.770
> 
> 标签：testing, eclipse-plugin

我正在开发一个 Eclipse 插件，并尝试创建另一个与插件分开的测试项目。我这样做的原因是不让插件在导出时依赖于jUnit。但是，我在进行测试时无法访问 Eclipse 插件 API。每当我尝试添加插件依赖项时，导入列表都是空的。

有谁知道如何将 Eclipse 插件 API 导入现有项目？工作区布局目前如下所示：

```
+- com.foo.myplugin
|     |
|     +- JRE System Library
|     |
|     +- Plug-in Dependencies
|     |
|     +- src
|     |
|     +- icons, META-INF, plugin.xml, etc...
|
+- com.foo.myplugin.test
      |
      +- JRE System Library
      |
      +- JUnit 4
      |
      +- src 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-01T01:19:29.783

推荐的方法似乎是使用插件片段：

[http://rcpquickstart.com/2007/06/20/unit-testing-plug-ins-with-fragments/](http://rcpquickstart.com/2007/06/20/unit-testing-plug-ins-with-fragments/)

该片段可以高度访问您的插件代码，并将测试逻辑/依赖项与插件本身分开。

现在，如果我能找到一种在自动化系统中测试它们的方法......（请参阅：[Automating unit tests (junit) for Eclipse Plugin development](https://stackoverflow.com/questions/255370/automating-unit-tests-junit-for-eclipse-plugin-deveopment)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T09:53:40.203

您可以从插件项目中导出插件依赖项。最简单的方法是这样的：

1.  转到您的`com.foo.plugin`项目属性

2.  转到*Java 构建路径 > 订购和导出*

3.  检查*插件依赖*项

测试项目现在应该能够使用插件 API，而无需使用插件项目所需的所有插件配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T09:06:54.557

您可以尝试将插件性质添加到新的 myplugin.test 项目中。

在您的 .project 文件中：

```
<natures>

        <nature>org.eclipse.pde.PluginNature</nature>
        [...]
</natures> 
```

然后在 .classpath 中，添加：

```
<classpath>
        [...]
        <classpathentry kind="con" path="org.eclipse.pde.core.requiredPlugins"/>
        [...]
</classpath> 
```

从工作区中删除您的 myplugin.test，重新导入该项目，看看是否可以解决问题......

# sharepoint - 是否可以将门户列表中的信息汇总到我的网站

> ID：246131
> 
> 赞同：1
> 
> 时间：2008-10-29T08:37:59.000
> 
> 标签：sharepoint, web-parts

是否可以将站点集合和/或门户站点中的列表中的信息聚合到“我的站点”？

我想在“我的网站”下的 Web 部件中显示在门户（或子网站集）中进行的所有日历约会

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T13:31:09.890

您需要一个日历汇总 Web 部件。有几个第三方工具可以做到这一点。首先想到的公司是 CorasWorks 和 Bamboo Solutions。（我也不支持。:)）如果你足够努力的话，你也许可以找到一些免费的 3rd 方汇总。

如果您有任何 sp 开发人员，他们可以毫不费力地为您编写这个 webpart。

我会看看能不能给你找到一两个链接。

祝你好运！

[CodePlex 的免费列表汇总](http://www.codeplex.com/illustris/Release/ProjectReleases.aspx?ReleaseId=16317)

[http://www.corasworks.com/](http://www.corasworks.com/)

[http://www.bamboosolutions.com/](http://www.bamboosolutions.com/)

我没有尝试过 CodePlex 汇总，但尝试了 corasworks 和竹子汇总。如果你可以让 CodePlex 汇总来做你想做的事，我会坚持下去。:)

# java - Java 中的 Web 服务

> ID：246134
> 
> 赞同：5
> 
> 时间：2008-10-29T08:40:20.210
> 
> 标签：java, xml, web-services, web-applications

在开发 Java 项目时，您通常使用什么来连接 Web 服务？

有不同的 API-s 可以完成这项工作。从我读过的不同书籍和教程中：JAX-WS、JAXB、JAXM、JAXR、JAX-RPC、Axis ans 等等。

我对您到底在使用什么以及使用多少感兴趣？如果您愿意，可以将此作为调查：)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-19T12:03:42.580

要回答您的问题，我们首先需要区分您列出的工具。

JAX-WS、JAXB、JAXM、JAXR、JAX-RPC 是 XML 和 Web 服务相关的 API，而 Axis 1 和 2 是零个、一个或多个这些 API 的实现，具体取决于版本。

JAX-B 1 和 2 是 XML 到对象绑定 API，JAX-WS 是基于 WSDL 和 SOAP 的 Web 服务 API 和 JAX-RPC 的前身，JAX-M 是较旧的 XML 消息传递 API，而 JAX-R 是抽象 API用于与 UDDI 和 ebXML 等注册中心进行交互。

从 Java.net JAX-RPC 页面：

> JAX-RPC 专家组以 Sun Microsystems 为 EG 领导者，拥有广泛的行业参与。最初的规范（JAX-RPC 1.0）是 JSR-101，于 2002 年 6 月发布。随后于 2003 年 10 月发布了一个维护版本，提供了与 JAXB 1.0 的更好集成以及对 doc/literal 的更好支持。
> 
> 该规范的下一个版本从 JAX-RPC 2.0 重命名为 JAX-WS 2.0，并且正在开发为 JSR-224；此版本将解决该领域的一些额外要求，并将增加 JAXB 和 JAX-WS 规范之间的协同作用。您可以在此处访问 JAX-WS 项目页面。

由于自 JAX-B 1.0 和 JAX-RPC 1.0 以来 SOAP 堆栈已经走过了漫长的道路，我建议远离 Axis 1.0 和 XFire（如果我没记错的话，它们甚至没有实现 JAX-RPC 1）。有许多 SOAP 堆栈实现了较新的 API（JAX-WS 2.x 和 JAX-B 2.x）。

正如其他人所提到的，Axis 2、JAX-WS RI 和 CXF 都是有效的选择。这些 SOAP 堆栈要成熟得多，并且支持许多现代 WS-* 规范。

关于使用 IDE 自动生成客户端代码的评论请注意。虽然我非常支持分别从 XSD 和 WSDL 生成 XML 数据绑定代码和 JAX-WS 接口，但我警告使用 IDE 中的内置向导来执行自动生成。如果您在一个拥有多个开发人员的团队中工作或计划修改生成的代码，您应该考虑这种方法的可维护性。

如果您有多个开发人员，那么他们中的某个人会使用不同版本的自动生成工具、不同的 IDE 或在他们的工具中具有不同的配置。此外，如果您从向导自动生成，则由开发人员记住他们是如何生成代码的，以防您将来需要重新生成代码。如果您更改 XSD 并且不记得上次自动生成的配置，则生成的代码可能与整个程序中已使用的现有代码不一致。

如果您打算修改生成的代码，请确保您只需要执行一次，并且从那时起您可以轻松地手动维护代码或定期将重新生成的代码与您的修改合并。

通过在构建过程中编写代码生成脚本可以避免这两个问题。JAX-WS 和 JAX-B 都带有 Ant 任务和/或 Maven 2 插件，它们在您的构建中很容易使用。认真对待这些警告，因为我看到多个项目在需要修改 5 年前由一名已离开公司的员工生成的代码时遇到了这些问题。

My final words of caution are to be careful when allowing a tool to auto-generate your Web service interfaces from your WSDLs. The JAX-WS RI WSDL2Java tool likes to place hard-coded paths to the WSDL in the generated interfaces. It is my opinion that you should auto-generate the interfaces once and then remove the hard-coded URLs and QName references to make the interface applicable to all Web services that implement the WSDL Binding that the interface represents and not just the one endpoint that your WSDL describes.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T08:51:53.807

[http://cxf.apache.org/](http://cxf.apache.org/)很好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-29T09:03:28.573

你可以使用，阿帕奇轴。如果您提供 WSDL，这将自动生成 java 存根。一旦生成存根，就像调用普通的 java 类一样。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-19T00:02:03.533

这里的轴心支持者需要精确。

**Axis 1.x**项目在Axis 1.4 于 2006 年 4 月发布后被放弃，三年多前。我们最近在 Axis 1.4 客户端库中遇到了几个非常关键的线程安全错误，包括 100% CPU 旋转和死锁。这些在 Axis 1.x 错误数据库中有详细记录（但仍未解决）。不用说我们正在放弃 Axis 1.x（并且只使用原始的 Apache HTTP 客户端代码）。

**Axis 2**是一个全新的代码库……也许其他人可以评论它。

根据我们的经验，我们会考虑**Metro**、**CXF**、**手动编码**和（也许）用于 SOAP Web 服务的**Axis 2 。**（只要您有选择，我们推荐基于 REST 的方法而不是 SOAP，并且使用我们喜欢的 Restlet 框架）

IMO，您绝对会疯狂地使用 Axis 1.x

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-29T08:59:05.367

因为我们对 Spring 的投入相当大，所以我们使用[Spring-WS](http://static.springframework.org/spring-ws/sites/1.5/)和 JAXB。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-29T13:42:36.543

我已经使用过 Axis 和 Axis2 并且发现它们都非常好。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-29T13:54:54.070

我认为最常见的用途是 Apache Axis2。用它创建服务非常容易，你会发现很多教程。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-29T09:04:42.190

我已经使用了[JAX-WS RI](https://jax-ws.dev.java.net/)和[Apache CXF](http://cxf.apache.org)。如果您使用的是[Spring](http://springframework.org)，那么 CXF 是一个非常好的选择。正如 Phill 提到的，还有[Spring-WS](http://static.springframework.org/spring-ws/sites/1.5/)，但 CXF 建立在 JAX-WS 规范之上。如果您不使用 Spring，那么我会说 RI 是最好的选择，特别是因为它与 Java 6 捆绑在一起。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-29T12:14:28.703

对于 POX+HTTP 或 RESTful Web 服务，[Restlet](http://www.restlet.org/)或体面的[HTTP 客户端实现](http://www.google.com/search?q=java+http+client)完全足够了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-29T13:10:14.223

+1 为 Apache Axis。

但是 JAX-WS 也是一个不错的选择。

# wpf - WPF中的大小到内容布局问题

> ID：246136
> 
> 赞同：7
> 
> 时间：2008-10-29T08:40:32.487
> 
> 标签：wpf, layout

这应该是没有道理的，但我仍然无法弄清楚。

在我的示例应用程序中，停靠面板中**有一个****按钮**和一个**文本框**。如果文本框的内容小于文本框的内容，则窗口将与显示按钮内容所需的一样大。这就是我想要的。但是，如果我在文本框中输入更多文本，窗口会变得更宽:-(

 ***我想要的行为是窗口根据按钮内容获取宽度，文本框包装其内容（或/并在必要时显示滚动条）。*

谢谢！

一些示例代码：

```
<Window x:Class="SO1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" SizeToContent="Width" FontSize="20">
    <DockPanel>
        <Button DockPanel.Dock="Top">A rather long text</Button>
        <TextBlock TextWrapping="Wrap">Short text</TextBlock>
    </DockPanel>
</Window> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-29T09:00:46.830

尝试过，似乎将`TextBlock`'s绑定到 s`MaxWidth`可以`ActualWidth`达到`Button`您所追求的效果：

```
<Button x:Name="btn" DockPanel.Dock="Top">Short text</Button>
<TextBlock TextWrapping="Wrap" 
  MaxWidth="{Binding ElementName=btn,Path=ActualWidth}">A rather long text</TextBlock> 
```

# python - 我可以同时调用和设置库中的 Python gettext 模块和使用它的模块吗？

> ID：246137
> 
> 赞同：2
> 
> 时间：2008-10-29T08:40:36.840
> 
> 标签：python, internationalization, gettext

我正在编写一个包含我需要翻译的文本反馈的库。

我将以下几行放在`_config.py`我在我的应用程序中随处导入的模块中：

```
import gettext, os, sys
pathname = os.path.dirname(sys.argv[0])
localdir = os.path.abspath(pathname) + "/locale"
gettext.install("messages", localdir) 
```

我有`*.mo`文件，`./locale/lang_LANG/LC_MESSAGES`我将`_()`函数应用于所有需要翻译的字符串。

现在我刚刚为用户（据说是程序员）添加了一项功能，以便能够创建自己的消息。我不希望他关心底层实现，所以我希望他能够让它变得简单，比如：

```
lib_object.message = "My message" 
```

我使用属性使其干净，但是如果我的用户要翻译他自己的代码（使用我的）并执行以下操作怎么办：

```
import gettext, os, sys
pathname = os.path.dirname(sys.argv[0])
localdir = os.path.abspath(pathname) + "/locale"
gettext.install("user_app", localdir)

lib_object.message = _("My message") 
```

这是个问题吗 ？我可以做些什么来避免麻烦而不打扰我的用户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T09:43:07.527

您只能 gettext.install() 一次。一般来说，它对库工作毫无用处—— gettext.install() 只有在调用它的模块负责整个程序时才会做正确的事情，因为它只会为您提供一个可供加载的目录。库代码应该做一些类似于 Mailman 所做的事情：拥有自己的 gettext() 包装器，它为此模块传递正确的参数，然后在每个想要使用它的模块中将其导入为 '_'。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T19:29:16.570

您可以使用基于类的 gettext api 来隔离消息目录。这也是[python gettext 文档](http://docs.python.org/library/gettext.html#class-based-api)中推荐的内容。

缺点是您或其他开发人员将不得不使用 gettext 方法或`_()`在本地范围内定义该方法，并绑定到特定的 gettext 类。具有自己的字符串目录的类的示例：

```
import gettext

class MyClass(object):
    def __init__(self, locale_for_instance):
        self.lang = gettext.translation("appname", localedir, \
                                         locale=locale_for_instance)

    def some_method(self, arg):
        return self.lang.gettext("You called some method")

    def other_method(self, arg): # does the same thing
        _ = self.lang.gettext
        return _("You called some method") 
```

您可以粘贴用于`_()`在装饰器中添加的代码，因此所有需要它的方法都带有类似的前缀`@with_local_gettext`

（注意，我没有测试过上述可能，但它应该可以正常工作（tm））

如果目标是不打扰您的用户（而且他不是很好），我想您可以在代码中使用基于类的方法并让用户使用全局方法。

# asp.net-mvc - 如何在 ActionFilter 中获取 actionName？

> ID：246143
> 
> 赞同：7
> 
> 时间：2008-10-29T08:43:59.097
> 
> 标签：asp.net-mvc, action-filter

这是我的旧代码

* * *

```
 protected override bool OnPreAction(string actionName, System.Reflection.MethodInfo methodInfo)
    {
        if ("|Register|RegisterPage|Login|LoginPage|Logout|Service".ToLower().Contains(actionName.ToLower()))
        {
            return base.OnPreAction(actionName, methodInfo);
        }

        Customer = CustomerHelper.GetCustomer();

        if (Customer.IsSeccessedLogin())
        {
            return base.OnPreAction(actionName, methodInfo);
        }

        Response.Redirect("Login.html");
        return false;
    } 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-06T18:05:51.757

仅供参考，从 RC1 开始，您可以这样做：

```
filterContext.ActionDescriptor.ActionName 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-29T13:24:31.823

```
string actionName = (string)filterContext.RouteData.Values["action"]; 
```

# sql - 日期的整数表示

> ID：246159
> 
> 赞同：4
> 
> 时间：2008-10-29T08:53:03.603
> 
> 标签：sql, performance

在最近的项目中，我们遇到了少数查询的性能问题，这些查询严重依赖按日期时间字段（MSSQL 2008 数据库）对结果进行排序。

当我们使用 ORDER BY RecordDate DESC（或 ASC）执行查询时，查询的执行速度比不使用时慢 10 倍。任何其他领域的排序都不会产生如此缓慢的结果。

我们尝试了所有的索引选项，使用了调整向导，没有什么真正的不同。

建议的解决方案之一是将日期时间字段转换为表示该日期时间字段中秒数或毫秒数的整数字段。它将通过一个简单的算法来计算，例如“让我知道从 RecordDate 到 1980-01-01 的秒数”。该值将在插入时存储，所有排序将在整数字段上完成，而不是在日期时间字段上。

我们从未尝试过，但我很好奇你们怎么看？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T08:58:28.117

我总是将日期存储为整数，使用标准化的[unix 时间戳](http://en.wikipedia.org/wiki/Unix_time)作为我编程使用的大多数语言，它作为默认的日期时间表示。显然，这使得对日期的排序更加有效。

所以，是的，我推荐它:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T09:08:55.300

我认为基本上这就是 SQL 日期时间数据类型在 SQL Server 中的幕后存储方式，所以我会对这些结果感到惊讶。

您能否复制 Northwinds 或 Pubs 中的缓慢 - 如果是这样，可能值得致电 MS，因为它不应该慢 10 倍。如果不是，那么您的桌子可能有些奇怪。

如果您使用的是 SQL 2008，并且您只需要存储日期（而不是时间部分），您可以尝试使用新的日期数据类型。这具有较低的精度，因此应该更快地排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T08:57:39.303

插入是否来自 .Net 代码...

您可以将[DateTime.Ticks](http://msdn.microsoft.com/en-us/library/system.datetime.ticks.aspx)值存储在数据库的 bigint 列中并在其上建立索引。

在更新现有数据库方面，编写一个用于将现有 DateTimes 转换为 TickCount 的 CLR 函数应该是相对简单的

```
ALTER TABLE dbo.MyTable ADD TickCount BigInt Null

Update dbo.MyTable Set TickCount = CLRFunction(DateTimeColumn) 
```

这绝对是可行的，并且会显着提高您的分拣能力

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-29T09:00:48.343

日期时间不是已经存储为数字了吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T09:13:30.940

你真的需要 DateTime 或更具体地说，“时间”部分吗？如果没有，我会调查将日期存储为 ISO 日期格式 (YYYYMMDD) 的整数或字符串表示形式，看看这是否能给您带来所需的性能提升。存储 ticks/time_t 值等将使您也能够存储时间，但除非您也确实需要时间组件，否则我不会真正为此烦恼。此外，存储人类可读日期的附加价值在于，调试与数据相关的问题会稍微容易一些，因为您可以阅读*和理解*程序正在运行的数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T00:25:17.667

我见过一个 BI 数据库，其中日期以 YYYMMDD 格式存储为整数。一个单独的表用于将这些整数与等效的日期时间、格式化字符串、年份编号、季度编号、月份编号、星期几、假期状态等相关联。您所要做的就是加入该表以获取与日期相关的任何内容你需要的。非常便利。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-29T09:24:24.647

我真的不明白为什么索引没有帮助，如果幕后的 SQL 将日期存储为整数表示。

按 ID 列或任何其他索引字段排序会产生出色的结果。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-29T22:21:57.603

我投票索引。正如我在上面的评论中所说，无论如何，您的日期都存储为两个 int 的幕后（无论如何是 sql 2000）。我看不出这有什么不同。很难说真正的问题是没有更多信息，但我的直觉是这不是问题。如果你有一个开发环境（你应该:)），尝试在那里创建 int 字段并运行原始查询。做起来应该不难，你会对这个想法有决定性的结果。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-29T09:09:45.347

存储日期的唯一明智方法是儒略日 - unix 时间戳的范围很短。

明智我的意思是在代码中 - 通常（但不总是）将日期存储在数据库中作为日期时间更好。

您遇到的数据库问题听起来像是一个不同的问题。我怀疑更改字段类型会产生巨大的影响。

如果不查看查询、记录数量等详细信息，很难具体说明，但一般建议是重组查询的顺序和方法，以减少订购的记录数量——因为这可能会对表现。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-29T23:49:19.813

您的 RecordDate 是 WHERE 子句中的字段之一吗？另外，RecordDate 是您唯一的 ORDER BY 标准吗？第三，您的查询是多表连接还是单表查询？如果您没有在 RecordDate 上选择，并将其用作 ORDER BY 标准，这可能是性能问题的原因，因为在这种情况下索引不会真正有助于排序。索引会尝试解决连接问题，然后再进行排序。

如果是这种情况，那么更改 RecordDate 的数据类型可能对您没有多大帮助，因为事后您仍在对记录集应用排序。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-10T21:46:32.987

我建议您使用 Excel 中使用的儒略日期（[链接文本](http://www.cpearson.com/excel/datetime.htm)）。所有金融应用程序都在使用这种表示来获得性能，它提供了相对较好的值范围。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-01-27T03:39:13.987

```
SELECT CAST(REPLACE(convert(varchar, GETDATE(), 102),'.','')AS INT) 
```

- 工作得很好（而且很快！）。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-10-29T09:27:20.740

我相信[日期时间物理存储为浮点数](http://www.sql-server-performance.com/articles/dev/date_time_search_p1.aspx)，因此改进与将浮点数转换为 INT 时相同。

我宁愿使用索引，因为这是它们的设计目的，而数据时间旨在存储带有时间的日期。有一组与日期时间相关的函数，所以如果您决定使用自定义存储类型，您需要自己处理。

# html - 我们可以用C输出图片吗？

> ID：246162
> 
> 赞同：2
> 
> 时间：2008-10-29T08:56:04.267
> 
> 标签：html, c, graphics, server-side

我们可以在 C 中输出 .jpg 图像或 .gif 图像吗？

我的意思是我们可以在 C 程序的帮助下打印一张图片作为输出吗？

同样，我们可以用 C 语言为 HTML 页面编写一个脚本，就像用 JavaScript 编写的一样吗？

浏览器可以操作吗？

如果不可能，是否有任何浏览器的插件？

请提供任何示例代码或链接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T08:58:10.613

这是很多问题！

您可以分别使用[libjpeg](http://www.ijg.org/)和[libpng](http://www.libpng.org/pub/png/libpng.html)从 C 生成 JPEG 和 PNG 文件。（是的，我故意回避你的 GIF 问题。你不需要这样做；PNG 现在得到主流浏览器的良好支持，[应该是首选](http://burnallgifs.org/archives/)。:-P）

浏览器通常只支持 JavaScript 用于客户端脚本。使用其他任何东西只会破坏您网页的可移植性。是的，就像你说的你可以使用插件，但有些人反对安装插件，而另一些人则支持不允许此类事情的公司政策。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T09:04:31.393

[您可以使用通用网关接口](http://hoohoo.ncsa.uiuc.edu/cgi/)(CGI)从 C 程序生成网页。C 程序在服务器上编译运行，这与在浏览器上运行的 Javascript 不同。

您也可以通过 CGI 生成图像。只需适当地设置内容类型，例如。image/jpeg 用于 JPEG 图像。您可以使用[libjpeg](http://en.wikipedia.org/wiki/Libjpeg)生成实际图像。

* * *

下面是一个示例 C 程序，用于生成带有 JPEG 图像的页面：

```
#include <stdio.h>

main()
{
   char *pageTitle = "Look, a JPEG!";
   char *urlImage  = "/myimage.jpeg";

// Send HTTP header.
   printf("Content-type: text/html\r\n\r\n");

// Send the generated HTML.
   printf("<html><head><title>%s</title></head>\r\n"
          "<body>\r\n"
          "<h1>%s</h1>\r\n"
          "<img src=\"%s\">\r\n"
          "</body></html>\r\n",
          pageTitle, pageTitle, urlImage);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T10:28:30.057

*   要保存 jpeg 文件，您将需要[libjpeg](http://www.ijg.org/)。我确信也有类似的 GIF 库。
*   C**不是**脚本语言。您不能像在 Javascript 中那样用 C 语言编写脚本。如果你敢的话，你可以用 CGI 编写服务器端代码，但这真的不是一个好主意。有几个更好的工具可以编写服务器端组件，包括 C#/ASP.NET、Java、Python、Perl、Ruby（使用 Rails）或 PHP。甚至对于网页来说，Coldfusion 也比 C 更好。
*   C 不是解释型语言。没有浏览器可以运行你的 C 代码，我怀疑永远不会有，出于数百万的原因。此外，没有插件。这实在是不可取。C 对于很多东西来说是一门很棒的语言，但网络是它很少使用的领域之一（除非你想用 C 编写浏览器或 http 服务器。但即使对于这些任务，C++ 通常也更好。 ) 如果您想在网页中编写客户端脚本，请使用 Javascript。一些浏览器也会解释 VBScript，但 Javascript 是首选的浏览器脚本语言。

# .net - 将相似的任务栏按钮分组

> ID：246172
> 
> 赞同：1
> 
> 时间：2008-10-29T09:01:13.990
> 
> 标签：.net, windows

我们的应用程序由多个模块组成，我们希望利用 XP 功能将这些模块组合在一起。例如，“模块 A”中的所有窗口将被分组在一起，与“模块 B”中的窗口分开。

我尝试在项目的 AssemblyInfo.cs 文件中设置 AssemblyTitle 属性，但仍然没有出现标题，只有项目数。

有什么办法可以控制它，还是全部由 Windows 控制？

这是在 Windows XP 的 WinForms 应用程序中。请注意，所有模块都由单个进程启动/托管，但我们要做的是将某个模块中包含的所有窗口组合在一起。应用程序风格是 SDI/MDI 混合，就像 MS Word。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T12:19:49.427

除了 Eoin 所说的，Windows 只会按进程对任务栏按钮进行分组。换句话说，您的应用程序中的所有窗口都将出现在一个组下。

将它们分成不同组的唯一方法是为您想要的每个组定义一个过程。然后使用 [assembly: AssemblyDescription] 自定义每个的标题。

据我所知，无法手动修改这些任务栏组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T09:09:38.827

IMo 该功能是 XP 中最糟糕的功能，我很高兴我可以禁用它。

但除此之外，如果您在任务栏中启用了组选项，那么 Windows 应该会自动执行此操作。在我们公司，我们有 Java 应用程序，所有不同的 Java 窗口总是分组，因为它们都是由 java.exe 启动的

我认为如果您使用相同的工具启动所有模块，它应该可以工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T09:11:20.350

据我所知，您需要在程序集信息文件中填写 AssemblyDescription 属性。

```
[assembly: AssemblyDescription("MyAssemblyDescription")] 
```

# c# - 你如何平衡框架/API 设计和 TDD

> ID：246185
> 
> 赞同：3
> 
> 时间：2008-10-29T09:09:48.577
> 
> 标签：c#, design-patterns, oop, interface, tdd

我们正在构建一个可供其他开发人员使用的框架，目前我们一直在使用大量的 TDD 实践。我们到处都有接口，并且有编写良好的模拟接口的单元测试。

然而，我们现在已经达到了输入类的一些属性/方法需要是内部的，并且对我们的框架用户不可见的地步（例如对象 ID）。那么问题是我们不能将这些字段/方法放在界面上，因为界面没有描述可访问性。

我们可以：

1.  在方法的第一行仍然使用接口和向上转换，但这似乎违背了接口的目的。
2.  *使用类作为输入参数——打破一切都*应该是接口的 TDD 规则
3.  提供另一层，在公共接口和内部接口之间进行一些转换

是否有现有的模式/方法来处理这个问题？TDD 人们说应该做什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-01T21:14:57.513

首先，没有通用的 TDD 规则说一切都应该是一个接口。这来自并非每个 TDDer 都实践的特定风格。见[http://martinfowler.com/articles/mocksArentStubs.html](http://martinfowler.com/articles/mocksArentStubs.html)

其次，您正在经历[public 与 published](http://martinfowler.com/ieeeSoftware/published.pdf)的二分法。我们的团队通过引入出现在 API 文档中的 @Published 注释“解决”了这个问题。据我所知，Eclipse 使用命名约定。不幸的是，我不知道有什么*好的*解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T20:44:20.733

您需要能够在您的模型对象中复制这些内部方法。并以与真实对象调用它们相同的方式调用它们。然后，您将单元测试集中在依赖于您需要测试的私有方法的公共方法上。如果这些内部方法正在调用其他对象或做大量工作，您可能需要重构您的设计。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T09:18:32.443

听起来你希望你的类有一个[依赖注入](http://www.javaranch.com/journal/200709/dependency-injection-unit-testing.htm)。也搜索stackoverflow。然后，您可以通过在构造函数中或通过 setter 选择来设置此 Id。

[1升

# eclipse - 如何更改 Eclipse 模板中使用的 ${user} 变量的值

> ID：246192
> 
> 赞同：276
> 
> 时间：2008-10-29T09:14:14.650
> 
> 标签：eclipse

我希望 Eclipse 使用从帐户信息中获取的用户真实姓名，而不是硬编码默认的 @author 模板（在 Linux 中，但也欢迎使用 Windows 解决方案）。将它输入到 Eclipse 配置中的某个位置也是可以接受的，可惜我找不到正确的位置。

* * *

## 回答 #1

> 赞同：306
> 
> 时间：2008-10-29T09:49:15.970

看来您最好的选择是`user.name`在命令行或使用`eclipse.ini`eclipse 安装根目录中的文件重新定义 java 变量。

这对我来说似乎很好用：

```
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256M
-vmargs
-Dosgi.requiredJavaVersion=1.5
-Duser.name=Davide Inglima
-Xms40m
-Xmx512m 
```

* * *

### 更新：

[http://morlhon.net/blog/2005/09/07/eclipse-username/](http://morlhon.net/blog/2005/09/07/eclipse-username/)是一个死链接...

这是一个新的：[https ://web.archive.org/web/20111225025454/http://morlhon.net:80/blog/2005/09/07/eclipse-username/](https://web.archive.org/web/20111225025454/http://morlhon.net:80/blog/2005/09/07/eclipse-username/)

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2011-07-05T13:40:45.817

打开 Eclipse，导航到 Window -> Preferences -> Java -> Code Style -> Code Templates -> Comments -> Types，然后按“编辑”按钮。在那里，您可以将生成的评论中的姓名从 @Author ${user} 更改为 @Author Rajish。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2014-04-21T09:14:36.740

```
Windows > Preferences > Java > Code Style > Code Templates > Comments 
```

![在此处输入图像描述](https://i.stack.imgur.com/Q5Zja.png)

或打开`eclipse.ini`文件并添加以下内容。

```
-Duser.name=Sumit Singh // Your Name 
```

![在此处输入图像描述](https://i.stack.imgur.com/gaeX8.png)

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2016-12-31T23:27:10.180

## EGit解决方案

人们会期望在项目、工作空间或环境的基础上创建或更改模板变量是一项标准的 Eclipse 功能。可悲的是，事实并非如此。更重要的是，鉴于 Eclipse 插件可以定义新的变量和模板，应该有插件提供解决方案。如果是，它们一定很难找到。[Eclipse Marketplace 中提供的mmm-TemplateVariable](https://marketplace.eclipse.org/content/mmm-templatevariables)是 Maven 用户朝着正确方向迈出的一步，它能够在模板中包含版本、artifactId 等。

幸运的是，[EGit](http://www.eclipse.org/egit/)是一个用于 Git 的 Eclipse 工具，它提供了非常灵活的方法来在代码模板中包含许多不同的变量。唯一的要求是您的项目使用 Git。如果您不使用 Git，但对软件开发很认真，那么现在是学习的时候了（[Pro Git 书籍](https://git-scm.com/book/en/v2)）。如果您被迫使用旧版版本控制系统，请尝试改变一些想法。

感谢[harmssk](https://github.com/harmsk)的努力，EGit 4.0 及更高版本包含了在模板中使用 Git 配置键值的能力。这允许基于存储库设置（项目）、用户设置（帐户）和/或全局设置（工作站）设置模板值。

以下示例展示了如何为多用户开发工作站设置 Eclipse 和 Git，并使用自定义 Git 配置键代替`${user}`以提供更大的灵活性。尽管该示例基于 Eclipse Mars 和 Git for Windows 的 Windows 10 安装，但该示例适用于使用各自命令行工具运行 Eclipse 和 Git 的 Linux 和 OSX。

为避免 Git 的`user.name`配置密钥和 Java 的`user.name`系统属性之间可能发生的混淆，自定义 Git 配置密钥 – `user.author`– 将用于提供作者的姓名和/或凭据。

## 配置模板

Git模板变量的格式如下

`${<name>:git_config(<key>)}`

where`<name>`是任意变量名，`<key>`是应该使用其值的 Git 配置键。鉴于此，将**Comments→Types**模板更改为

```
/**
 * @author ${author:git_config(user.author)}
 *
 * ${tags}
 */ 
```

现在将尝试从 Git 的`user.author`配置密钥中解析作者的姓名。如果没有任何进一步的配置，任何新创建的评论都不会在 之后包含名称`@author`，因为尚未定义任何名称。

## 配置 Git

# 从命令行

**Git 系统配置**- 此配置步骤对适用于工作站上所有帐户的 Git 系统范围配置进行更改，除非被用户或存储库设置覆盖。因为系统范围的配置是底层 Git 应用程序（例如 Windows 的 Git）的一部分，所以更改需要管理员权限。以管理员身份运行 Git Bash、cmd 或 PowerShell。以下命令将设置系统范围的作者。

```
git config --system user.author “SET ME IN GLOBAL(USER) or REPOSITORY(LOCAL) SETTINGS” 
```

这个“作者”的目的是提醒它应该放在别处。这在工作站上使用新用户帐户时特别有用。

要验证此设置，请创建一个使用 Git 的空 Java 项目或打开一个现有的基于 Git 的项目。创建一个类并从上下文菜单**ALT-SHIFT-J中使用****Source→Generate Element Comment**，或启动 JavaDoc 注释。生成的标签后面应该有警告。**`@author`**

 **无需管理员权限即可执行剩余的配置更改。

**Git 全局（用户）配置**- 全局或用户配置是与特定用户关联的配置，将覆盖系统范围的配置。这些设置适用于所有基于 Git 的项目，除非被存储库设置覆盖。如果由于工作、开源贡献或个人等各种项目类型导致作者姓名不同，请在此处设置最常用的。

```
git config --global user.author “Mr. John Smith” 
```

配置全局值后，返回早期使用的测试项目并应用类注释。标签现在`@author`应该显示全局设置。

**Git 存储库（本地）配置**- 最后，存储库或本地配置可用于为特定项目配置作者。与以前的配置不同，存储库配置必须在存储库内完成。使用 Git Bash、PowerShell 等导航到测试项目的存储库。

```
git config --local user.author “smithy” 
```

鉴于此，测试项目中的新评论将使用本地定义的作者姓名。其他基于 Git 的项目，仍将使用全局作者姓名。

# 从 Eclipse 内部

上面的配置更改也可以在 Eclipse 中通过其**Preferences 进行设置：Team→Git-Configuration**。Eclipse 必须以管理员身份运行才能更改系统范围的 Git 配置。

## 总共

尽管此示例专门处理了最常见的问题，即更改`${user}`，但这种方法可以用于更多。***但是，除非有特殊用途，否则应注意不要使用 Git 定义的配置键。***

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-11-03T05:00:42.140

`${user}`与其在eclipse中改变，不如引入

`-Duser.name=Whateverpleaseyou`

`eclipse.ini`其中存在于您的 eclipse 文件夹中。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-02-15T23:29:45.007

dovescrywolf 给了小费作为对Davide Inglima 链接的[文章的评论](http://morlhon.net/blog/2005/09/07/eclipse-username/)

这对我在 MacOS 上非常有用。

*   如果 Eclipse 已打开，请关闭它。
*   打开 Termnal（bash 控制台）并执行以下操作：

    ```
    $ pwd /Users/You/YourEclipseInstalationDirectory  
    $ cd Eclipse.app/Contents/MacOS/  
    $ echo "-Duser.name=Your Name" >> eclipse.ini  
    $ cat eclipse.ini 
    ```

*   关闭终端并再次启动/打开 Eclipse。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-14T09:20:47.230

这是我们都在寻找的文件（在您的 Eclipse 工作区中）：

> .plugins/org.eclipse.core.runtime/.settings/org.eclipse.jdt.ui.prefs

您将找到一个带有您要更改的名称的@author 标签。重新启动 Eclipse，它将工作。

对于重音符号，您必须使用 Unicode 格式（例如，'\u00E1' 表示 á）。

您还可以根据先前答案的建议修改“ini”文件，或为全局解决方案设置用户名 var。或者在本地解决方案的首选项菜单中覆盖@author 标签。这些都是解决这个问题的有效方法。

但是，如果您正在寻找困扰我们大多数人的“那个”作者姓名，那就在那个文件中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-07T17:43:59.647

编辑文件`/etc/eclipse.ini`，以包含条目为；

`-Duser.name=myname`

重新启动“eclipse”，现在，在创建任何新文件时，使用向导 (c/c++/java)，它将使用“myname”代替 ${user}。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-04-12T16:03:07.917

Window -> Preferences -> Java -> Code Style -> Code Templates -> Comments -> Types 将前面的标签 ${user} 更改为您的名字。

前

```
/**
 * @author ${user}
 *
 * ${tags}
 */ 
```

后

```
/**
 * @author Waqas Ahmed
 *
 * ${tags}
 */ 
```

[![在此处输入图像描述](https://i.stack.imgur.com/hUqt9.png)](https://i.stack.imgur.com/hUqt9.png)

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2012-07-11T19:28:49.880

只是其他选择。转到***PREFERENCES >> JAVA >> EDITOR >> TEMPLATES***，选择 @author 并更改变量 ${user}。

# javascript - 如何在 JavaScript 中对数字进行四舍五入？

> ID：246193
> 
> 赞同：65
> 
> 时间：2008-10-29T09:14:21.250
> 
> 标签：javascript, floating-point, numbers, rounding

在做一个项目时，我遇到了一个由前雇员创建的 JS 脚本，它基本上以以下形式创建报告

```
Name : Value
Name2 : Value2 
```

等等

问题是这些值有时可以是浮点数（具有不同的精度）、整数，甚至是`2.20011E+17`. 我要输出的是纯整数。不过，我不太了解 JavaScript。我将如何编写一种方法来获取这些有时浮点数并使它们成为整数？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-01-25T22:40:38.377

如果您需要四舍五入到一定位数，请使用以下功能

```
function roundNumber(number, digits) {
            var multiple = Math.pow(10, digits);
            var rndedNum = Math.round(number * multiple) / multiple;
            return rndedNum;
        } 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-10-29T11:23:00.163

您必须将输入转换为数字，然后将它们四舍五入：

```
function toInteger(number){ 
  return Math.round(  // round to nearest integer
    Number(number)    // type cast your input
  ); 
}; 
```

或作为一个班轮：

```
function toInt(n){ return Math.round(Number(n)); }; 
```

使用不同的值进行测试：

```
toInteger(2.5);           // 3
toInteger(1000);          // 1000
toInteger("12345.12345"); // 12345
toInteger("2.20011E+17"); // 220011000000000000 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-10-29T10:46:39.677

根据[ECMAScript 规范](http://bclary.com/2004/11/07/#a-4.3.20)，JavaScript 中的数字仅由双精度 64 位格式 IEEE 754 表示。因此 JavaScript 中实际上没有整数类型。

关于这些数字的四舍五入，有多种方法可以实现这一点。[Math](http://bclary.com/2004/11/07/#a-15.8)对象为我们提供了三种可以使用的舍入方法：

[Math.round()](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Math/round)是最常用的，它返回四舍五入到最接近整数的值。然后是[Math.floor()](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Math/floor)返回小于或等于数字的最大整数。最后，我们有[Math.ceil()](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Math/ceil)函数，它返回大于或等于数字的最小整数。

还有一个[toFixed()](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Number/toFixed)，它使用定点表示法返回一个表示数字的字符串。

Ps.：*Math.round()*方法中**没有第二个参数。***toFixed()*不是**IE 特定**的，它[也在](http://bclary.com/2004/11/07/#a-15.7.4)ECMAScript 规范中

 ***** * *

## 回答 #4

> 赞同：25
> 
> 时间：2012-05-04T16:53:48.853

这是一种能够`Math.round()`与第二个参数（四舍五入的小数位数）一起使用的方法：

```
// 'improve' Math.round() to support a second argument
var _round = Math.round;
Math.round = function(number, decimals /* optional, default 0 */)
{
  if (arguments.length == 1)
    return _round(number);

  var multiplier = Math.pow(10, decimals);
  return _round(number * multiplier) / multiplier;
}

// examples
Math.round('123.4567', 2); // => 123.46
Math.round('123.4567');    // => 123 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2012-05-07T09:59:48.743

您也可以使用`toFixed(x)`or`toPrecision(x)`其中*x*是位数。

所有主流浏览器都支持这两种方法

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2008-10-29T09:19:50.897

您可以使用[Math.round()](http://www.w3schools.com/js/js_obj_math.asp)将数字四舍五入到最接近的整数。

```
Math.round(532.24) => 532 
```

此外，您可以使用[parseInt()](http://www.w3schools.com/jsref/jsref_parseInt.asp)和[parseFloat()](http://www.w3schools.com/jsref/jsref_parseFloat.asp)将变量转换为某种类型，在本例中为整数和浮点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-11T12:41:24.727

一个非常好的舍入近似值：

```
function Rounding (number, precision){

var newNumber;
var sNumber = number.toString();

var increase = precision + sNumber.length - sNumber.indexOf('.') + 1;

if (number < 0)
  newNumber = (number -  5 * Math.pow(10,-increase));
else
  newNumber = (number +  5 * Math.pow(10,-increase));

var multiple = Math.pow(10,precision);

return Math.round(newNumber * multiple)/multiple;
} 
```

只有在某些情况下，数字的小数部分长度很长时才会出错。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-05-15T22:56:10.503

Math.floor(19.5) = 19 也应该有效。

# c# - 调试安装程序项目

> ID：246202
> 
> 赞同：5
> 
> 时间：2008-10-29T09:19:11.333
> 
> 标签：c#, windows-installer

谁能告诉我如何在安装程序项目中调试自定义安装程序类。我的自定义安装程序类和安装程序存在于同一解决方案中。

问候， 苛刻的苏曼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-29T09:24:01.043

您可以尝试在要调试的 Installer 类方法中插入 Debugger.Break() ，这将触发调试会话。

或者您可以尝试将调试器附加到 msiexec.exe

# c# - StringBuilder 的默认容量

> ID：246211
> 
> 赞同：36
> 
> 时间：2008-10-29T09:23:43.430
> 
> 标签：c#, .net, stringbuilder, capacity

a 的默认容量是`StringBuilder`多少？

什么时候应该（或不应该）使用默认值？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-10-29T09:36:56.430

StringBuilder 的默认容量是 16 个字符（我使用 .NET Reflector 来查找）。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-10-29T11:30:22.257

默认值为 16，这似乎是 .NET 框架中任何类型的数组或列表的默认容量。您在 StringBuilder 上需要的重新分配次数越少越好。同时，也没有必要分配比需要更多的东西。

我通常对 StringBuilder 的最终大小进行某种粗略估计来实例化 StringBuilder。例如，这可能基于您稍后将用于构建字符串的一些迭代计数，乘以该迭代中每个项目所需的大小。

```
// where 96 is a rough estimate of the size needed for each item
StringBuilder sb = new StringBuilder ( count * 96 );
for ( int i = 0; i < count; i++ )
{
...
} 
```

当 StringBuilder 的大小太小而无法写入下一个字符串时，StringBuilder 的内部 char 数组将重新分配为其当前大小的两倍。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-12-15T16:35:24.303

这个问题今天作为另一个问题的重复出现，但我注意到其中一部分没有得到回答。正如人们所说，默认值（假设这意味着“当没有使用足够大的字符串创建时 require ）是 16，但我在这里看不到任何关于何时应该更改它的内容。

当您可以更改它作为可能的优化时，您可以更改它。实际上，选择 16 与优化相反。*优化*是选择值和方法，以便特别适合特定情况或可能情况的子集（通常不是“让事情变得更快”，尽管我们经常使用这个词）。在这里，类的设计者必须处理*泛化*——选择值和方法，以便在广泛的案例中提供相当好的性能。

它们越小，内存的使用就越少。

它们越大，处理更大字符串的重新分配就越少。

在某些情况下，二进制回合（2 的整数次方）可能比其他数字提供更好的性能有几个原因，所以他们选择了其中一个，但除了在 4 或 16 或 1024 之间进行选择之外，还有一个问题平衡不同的可能值。

*使用* 而不是设计它的人`StringBuilder`可能对他们可能需要的尺寸有更好的了解。

如果他们要5 个 1 位数字以及总长度为 43 个字符的字符串，那么无论如何`Append`总长度将是 48 个字符，所以他们应该使用 48 的容量，因为 48 始终是`StringBuilder`长度为 48 的字符串的最有效大小。

如果他们正在做的事情可能有大约 23 到 34 个字符之间的任何长度，他们应该使用 34。

如果他们正在做的事情可能永远不会超过 60 个字符，但偶尔可能会有，他们应该使用 64（不要为大多数部分重新分配，并获得上面提到的二的幂的好处你这样做的少数情况）。

如果无法就此得出结论，或者至少很难得出结论并且不是性能热点，那么您应该使用默认值。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-29T09:36:54.170

可敬的 J. Skeet 对这个问题进行了很好的分析：

[https://jonskeet.uk/csharp/stringbuilder.html](https://jonskeet.uk/csharp/stringbuilder.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-10-11T06:15:04.460

String-Builder 的默认容量为**16 个字符**，String-Builder 的最大容量为**2147483647 个字符**。

所以无需担心存储长响应！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-20T05:11:55.477

我们可以使用类的容量属性找到容量`StringBuilder`：

```
StringBuilder builder = new StringBuilder();
var capacity = builder.Capacity;
var maxCapacity = builder.MaxCapacity; 
```

这里容量定义了默认容量`StringBuilder`。

`StringBuilder`is`Max Capacity`与 的最大值相同`Int32`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-29T09:25:59.043

[编辑：当时，被问到的问题`StringList`]

你的意思是`StringCollection`？这最初使用一个空`ArrayList`，所以答案是 0。你没有选择改变它。当你第一次添加一个项目时，容量会跳到 4，然后在它填满时使用加倍策略。

如果您的意思是`List<string>`，那么它是相似的（一个空`T[]`的，而不是一个`ArrayList`），但是如果您需要，您可以初始化一个已知的大小（即您知道您期望多少数据）。同样，第一次`Add`到 a时`List<T>`，大小会跳到 4，然后每次填满时都会翻倍。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-29T09:36:50.567

阅读有关[Stringbuilder 容量](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2754342&SiteID=1)的信息，也有示例应用程序可以证明这一点。

# linux - 如何在 Linux 中生成带有绝对路径的文件列表？

> ID：246215
> 
> 赞同：373
> 
> 时间：2008-10-29T09:24:03.850
> 
> 标签：linux, command-line, absolute-path, ls

我正在编写一个将文件路径作为输入的 shell 脚本。

出于这个原因，我需要生成具有完整路径的递归文件列表。例如，该文件`bar`具有以下路径：

```
/home/ken/foo/bar 
```

但是，据我所知，两者`ls`都只`find`给出相对路径列表：

```
./foo/bar   (from the folder ken) 
```

`find`这似乎是一个明显的要求，但我在或`ls`手册页中看不到任何内容。

如何在 shell 中生成文件列表，包括它们的绝对路径？

* * *

## 回答 #1

> 赞同：366
> 
> 时间：2008-10-29T09:26:35.093

如果您给出`find`一个绝对路径开始，它将打印绝对路径。例如，要查找当前目录中的所有 .htaccess 文件：

```
find "$(pwd)" -name .htaccess 
```

或者如果你的 shell 扩展`$PWD`到当前目录：

```
find "$PWD" -name .htaccess 
```

`find`只需将它赋予的路径添加到从该路径到文件的相对路径。

`pwd -P`如果您想解析当前目录中的符号链接，[Greg Hewgill](https://stackoverflow.com/users/893/greg-hewgill)还建议使用。

* * *

## 回答 #2

> 赞同：219
> 
> 时间：2011-01-02T04:45:05.827

```
readlink -f filename 
```

给出完整的绝对路径。但如果文件是符号链接，您将获得最终解析的名称。

* * *

## 回答 #3

> 赞同：156
> 
> 时间：2010-08-26T06:42:48.097

将此用于 dirs（bash 中需要`/`after将其限制为目录）：`**`

```
ls -d -1 "$PWD/"**/ 
```

这适用于当前目录下的文件和目录，其名称包含`.`：

```
ls -d -1 "$PWD/"*.* 
```

这适用于一切：

```
ls -d -1 "$PWD/"**/* 
```

取自这里 [http://www.zsh.org/mla/users/2002/msg00033.html](http://www.zsh.org/mla/users/2002/msg00033.html)

在 bash 中，`**`如果启用`shopt -s globstar`.

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2008-10-29T09:27:50.117

您可以使用

```
find $PWD 
```

在 bash

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2009-09-15T13:15:50.210

```
ls -d "$PWD/"* 
```

这仅在*当前*目录中查找。如果它包含空格，它会引用“$PWD”。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2019-03-19T23:35:58.273

**命令：** `ls -1 -d "$PWD/"*`

这将给出文件的绝对路径，如下所示。

```
[root@kubenode1 ssl]# ls -1 -d "$PWD/"*
/etc/kubernetes/folder/file-test-config.txt
/etc/kubernetes/folder/file-test.txt
/etc/kubernetes/folder/file-client.txt 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2021-02-20T08:38:01.467

你可以做

```
ls -1 |xargs realpath 
```

如果您需要指定绝对路径或相对路径您也可以这样做

```
 ls -1 $FILEPATH |xargs realpath 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2021-05-14T12:31:00.747

试试这个：

```
find "$PWD"/ 
```

您将获得工作目录**中的绝对路径列表**。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2010-01-29T13:43:55.030

如果你给 find 命令一个绝对路径，它会用一个绝对路径吐出结果。因此，如果您要在 Ken 目录中键入：

```
find /home/ken/foo/ -name bar -print 
```

（而不是相对路径`find . -name bar -print`）

你应该得到：

```
/home/ken/foo/bar 
```

因此，如果你想要 an`ls -l`并让它返回绝对路径，你可以告诉 find 命令`ls -l`对它找到的任何东西执行 an 。

```
find /home/ken/foo -name bar -exec ls -l {} ;\ 
```

`{}`注意：和之间有空格`;`

你会得到这样的东西：

```
-rw-r--r--   1 ken admin       181 Jan 27 15:49 /home/ken/foo/bar 
```

如果您不确定文件在哪里，您可以随时更改搜索位置。只要搜索路径以“/”开头，就会得到一个绝对路径作为回报。如果您正在搜索一个位置（如 /），您将获得很多权限被拒绝错误，那么我建议您重定向标准错误，以便您可以实际看到查找结果：

```
find / -name bar -exec ls -l {} ;\ 2> /dev/null 
```

（`2>`是 Borne 和 Bash shell 的语法，但不适用于 C shell。它也可以在其他 shell 中工作，但我只确定它在 Bourne 和 Bash 中工作）。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2011-08-09T17:27:44.460

上面的`$PWD`Matthew 是一个不错的选择。如果您只想查找打印文件，那么您还可以添加 -type f 选项以仅搜索普通文件。其他选项是“d”仅用于目录等。所以在你的情况下它会是（如果我只想搜索带有 .c ext 的文件）：

```
find $PWD -type f -name "*.c" 
```

或者如果你想要所有文件：

```
find $PWD -type f 
```

注意：您不能为上述命令创建别名，因为当 bash 设置别名时，$PWD 会自动完成到您的主目录。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2019-10-24T11:51:44.410

### [`fd`](https://github.com/sharkdp/fd)

使用`fd`(替代`find`)，使用以下语法：

```
fd . foo -a 
```

`.`搜索模式在哪里，`foo`是根目录。

`etc`例如，要以递归方式列出所有文件，请运行： `fd . /etc -a`.

> `-a`,`--absolute-path` 显示绝对路径而不是相对路径

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2020-01-07T23:10:32.857

只是一个替代品

```
ls -d "$PWD/"* 
```

查明这`*`是壳膨胀，所以

```
echo "$PWD/"* 
```

会做同样的事情（你不能用`-1`新行而不是空格来分隔的缺点）。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-05-20T07:03:20.730

如果您需要当前和子目录中所有文件的列表

```
find $PWD -type f 
```

如果您只需要当前目录中的所有文件列表

```
find $PWD -maxdepth 1 -type f 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2021-06-16T02:20:52.493

递归查找jar文件并打印绝对路径

```
`ls -R |grep "\.jar$" | xargs readlink -f` 
```

```
/opt/tool/dev/maven_repo/com/oracle/ojdbc/ojdbc8-19.3.0.0.jar
/opt/tool/dev/maven_repo/com/oracle/ojdbc/ons-19.3.0.0.jar
/opt/tool/dev/maven_repo/com/oracle/ojdbc/oraclepki-19.3.0.0.jar
/opt/tool/dev/maven_repo/com/oracle/ojdbc/osdt_cert-19.3.0.0.jar
/opt/tool/dev/maven_repo/com/oracle/ojdbc/osdt_core-19.3.0.0.jar
/opt/tool/dev/maven_repo/com/oracle/ojdbc/simplefan-19.3.0.0.jar
/opt/tool/dev/maven_repo/com/oracle/ojdbc/ucp-19.3.0.0.jar 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-03-31T00:08:33.630

```
lspwd() { for i in $@; do ls -d -1 $PWD/$i; done } 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-03-04T01:00:27.973

这是一个打印出没有额外句点的列表的示例，它还演示了如何搜索文件匹配项。希望这可以帮助：

```
find . -type f -name "extr*" -exec echo `pwd`/{} \; | sed "s|\./||" 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-10-24T08:56:04.927

这对我有用。但它没有按字母顺序列出。

```
find "$(pwd)" -maxdepth 1 
```

此命令按字母顺序列出以及列出隐藏文件。

```
ls -d -1 "$PWD/".*; ls -d -1 "$PWD/"*; 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-10-24T11:48:54.167

### `stat`

单个文件的绝对路径：

```
stat -c %n "$PWD"/foo/bar 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-03-09T08:38:35.533

你可能想试试这个。

```
for name in /home/ken/foo/bar/*
do
    echo $name
done 
```

`for`您可以使用循环获得 abs 路径，`echo`而无需`find`.

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-06-13T20:43:31.787

如果路径包含空格，则大多数（如果不是全部）建议的方法会导致无法直接在某些其他终端命令中使用的路径。理想情况下，结果前面会有斜杠。这适用于我在 macOS 上：

```
find / -iname "*SEARCH TERM spaces are okay*" -print 2>&1  | grep -v denied |grep -v permitted |sed -E 's/\ /\\ /g' 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-06-08T22:25:19.383

这将给出规范路径（将解析符号链接）：`realpath FILENAME`

如果您想要符号链接本身的规范路径，那么：`realpath -s FILENAME`

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-08-08T18:40:27.833

在 Linux 中可以通过多种方式列出递归文件。在这里，我将共享一个衬里脚本以清除`/var/log/`目录中的所有文件日志（仅文件），并第二次检查最近哪个日志文件已进入。

第一的：

```
find /var/log/ -type f  #listing file recursively 
```

第二：

```
for i in $(find $PWD -type f) ; do cat /dev/null > "$i" ; done #empty files recursively 
```

第三次使用：

```
ls -ltr $(find /var/log/ -type f ) # listing file used in recent 
```

注意：对于目录位置，您也可以通过`$PWD`而不是`/var/log`.

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-02-03T13:44:34.080

如果你没有符号链接，你可以试试

```
tree -iFL 1 [DIR] 
```

`-i`使树在每一行中打印文件名，而不使用树结构。

`-f`使树打印每个文件的完整路径。

`-L 1`避免树递归。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-09-30T18:56:31.460

如果您想要一个在函数中运行良好的动态解决方案，这种方法效果最好

```
lfp ()
{
  ls -1 $1 | xargs -I{} echo $(realpath $1)/{}
} 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2008-10-29T09:26:47.713

`find / -print`会这样做

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2010-06-23T20:37:26.000

```
ls -1 | awk  -vpath=$PWD/ '{print path$1}' 
```

# asp.net - 将 SQL 数据库导出到 Access - ASP.NET

> ID：246223
> 
> 赞同：3
> 
> 时间：2008-10-29T09:27:35.170
> 
> 标签：asp.net, sql, ms-access

有没有办法通过 asp.net 将数据（不一定是模式）导出到访问数据库？

服务器没有安装任何办公组件，该过程必须通过网页进行（如 excel 导出）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T14:16:29.877

您必须以编程方式进行。

1.  打开源表
2.  使用 ADO Extensions 创建一个新的 AccessDB（如上所示）
3.  通过读取源模式（CREATE TABLE X ...）在 AccessDB 中创建表
4.  迭代认为源表在 Access 表中插入记录

注意：来自[http://www.freevbcode.com/ShowCode.asp?ID=5797](http://www.freevbcode.com/ShowCode.asp?ID=5797)的代码张贴在这里，以防将来链接不再存在

```
 'select References from the Project Menu, choose the COM tab, 
    'and add a reference to Microsoft ADO Ext. 2.7 for DDL and Security

    Public Function CreateAccessDatabase( ByVal DatabaseFullPath As String) As Boolean
        Dim bAns As Boolean
        Dim cat As New ADOX.Catalog()
        Try

         'Make sure the folder
         'provided in the path exists. If file name w/o path 
         'is  specified,  the database will be created in your
         'application folder.

            Dim sCreateString As String
            sCreateString = _
              "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & _
               DatabaseFullPath
            cat.Create(sCreateString)

            bAns = True

        Catch Excep As System.Runtime.InteropServices.COMException
            bAns = False
            'do whatever else you need to do here, log, 
            'msgbox etc.
        Finally
            cat = Nothing
        End Try
        Return bAns
    End Function

    DEMO
    ====

    '      If CreateAccessDatabase("F:\test.mdb") = True Then
    '           MsgBox("Database Created")
    '      Else
    '           MsgBox("Database Creation Failed")
    '      End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T09:49:23.037

这是一篇非常详细的文章。这是我偶然发现的，而不是我熟悉的方法：

[Faisal Khan 使用 ASP.NET 将文件上传到 Access 数据库。](http://www.stardeveloper.com/articles/display.html?article=2003031201&page=1)

# c# - 在 C# 中创建午夜日期时间的最佳方法

> ID：246225
> 
> 赞同：85
> 
> 时间：2008-10-29T09:29:10.987
> 
> 标签：c#, datetime

我需要创建一个午夜 DateTime

我刚刚这样做了：

```
DateTime endTime = DateTime.Now;
endTime.Subtract(endTime.TimeOfDay); 
```

还没有测试它，我假设它可以工作，但有没有更好/更清洁的方法？

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2008-10-29T09:31:37.610

只需使用`foo.Date`, 或[`DateTime.Today`](https://docs.microsoft.com/en-us/dotnet/api/system.datetime.today)用于今天的日期

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-10-29T09:40:50.043

```
DateTime endTime = DateTime.Now.Date; 
```

现在`endTime.TimeOfDay.ToString()`返回`"00:00:00"`

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-29T09:32:31.370

日期时间.今天

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-10-29T09:35:41.863

[`DateTime.Now`](https://docs.microsoft.com/en-us/dotnet/api/system.datetime.now). [`AddDays(1)`](https://docs.microsoft.com/en-us/dotnet/api/system.datetime.adddays).[`Date`](https://docs.microsoft.com/en-us/dotnet/api/system.datetime.date)

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-11-24T07:32:28.613

您可以使用`DateTime.Today`午夜的精确秒数。

```
 DateTime today = DateTime.Today;
    DateTime mid = today.AddDays(1).AddSeconds(-1);
    Console.WriteLine(string.Format("Today: {0} , Mid Night: {1}", today.ToString(), mid.ToString()));

    Console.ReadLine(); 
```

这应该打印：

```
Today: 11/24/2016 10:00:00 AM , Mid Night: 11/24/2016 11:59:59 PM 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-01-22T20:26:50.377

```
var dateMidnight = DateTime.ParseExact(DateTime.Now.ToString("yyyyMMdd"), "yyyyMMdd", CultureInfo.InvariantCulture); 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2017-01-24T19:41:30.643

```
 private bool IsServiceDatabaseProcessReadyToStart()
    {
        bool isGoodParms = true;
        DateTime currentTime = DateTime.Now;
        //24 Hour Clock
        string[] timeSpan = currentTime.ToString("HH:mm:ss").Split(':');
        //Default to Noon
        int hr = 12;
        int mn = 0;
        int sc = 0;

        if (!string.IsNullOrEmpty(timeSpan[0]))
        {
            hr = Convert.ToInt32(timeSpan[0]);
        }
        else
        {
            isGoodParms = false;
        }

        if (!string.IsNullOrEmpty(timeSpan[1]))
        {
            mn = Convert.ToInt32(timeSpan[1]);
        }
        else
        {
            isGoodParms = false;
        }

        if (!string.IsNullOrEmpty(timeSpan[2]))
        {
            sc = Convert.ToInt32(timeSpan[2]);
        }
        else
        {
            isGoodParms = false;
        }

        if (isGoodParms == true )
        {
            TimeSpan currentTimeSpan = new TimeSpan(hr, mn, sc);
            TimeSpan minTimeSpan = new TimeSpan(0, 0, 0);
            TimeSpan maxTimeSpan = new TimeSpan(0, 04, 59);
            if (currentTimeSpan >= minTimeSpan && currentTimeSpan <= maxTimeSpan)
            {
                return true;
            }
            else
            {
                return false;
            }
        }
        else
        {
            return false;
        }
    } 
```

# nginx - 如何更改 nginx 返回的服务器标头？

> ID：246227
> 
> 赞同：153
> 
> 时间：2008-10-29T09:29:29.957
> 
> 标签：nginx, http-headers

有一个隐藏版本的选项，因此它只会显示 nginx，但是有没有办法隐藏它，所以它不会显示任何内容或更改标题？

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2012-02-12T22:08:16.647

如果您正在使用 nginx 代理后端应用程序并希望后端广告自己的`Server:`标头而不被 nginx 覆盖，那么您可以进入您的`server {…}`节内部并设置：

```
proxy_pass_header Server; 
```

这将说服 nginx 不理会该标头，而不是重写后端设置的值。

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2015-11-04T04:27:15.307

上次更新是在不久前，所以这对我来说在 Ubuntu 上有用：

```
sudo apt-get update
sudo apt-get install nginx-extras 
```

然后将以下两行添加到通常位于 /etc/nginx/nginx.conf的`http`部分中：`nginx.conf`

```
sudo nano /etc/nginx/nginx.conf
server_tokens off; # removed pound sign
more_set_headers 'Server: Eff_You_Script_Kiddies!'; 
```

另外，不要忘记用`sudo service nginx restart`.

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2008-10-29T10:04:42.693

与 Apache 一样，这是对源代码的快速编辑并重新编译。来自[Calomel.org](https://calomel.org/nginx.html)：

> Server: 字符串是发送回客户端的标头，以告诉他们您正在运行什么类型的 http 服务器以及可能是什么版本。Alexia 和 Netcraft 等地方使用此字符串来收集有关 Internet 上存在的 Web 服务器数量和类型的统计信息。为了支持 Nginx 的作者和统计信息，我们建议保持此字符串不变。但是，为了安全起见，您可能不希望人们知道您正在运行什么，您可以在源代码中进行更改。编辑源文件 `src/http/ngx_http_header_filter_module.c` ，查看第 48 和 49 行。您可以将字符串更改为您想要的任何内容。

```
## vi src/http/ngx_http_header_filter_module.c (lines 48 and 49)
static char ngx_http_server_string[] = "Server: MyDomain.com" CRLF;
static char ngx_http_server_full_string[] = "Server: MyDomain.com" CRLF; 
```

**2011 年 3 月编辑：**下面向 Flavius 提出建议，指出一个新选项，用分叉的[HttpHeadersMoreModule替换 Nginx 的标准](http://wiki.nginx.org/HttpHeadersMoreModule)[HttpHeadersModule](http://wiki.nginx.org/HttpHeadersModule)。重新编译标准模块仍然是快速修复，如果您想使用标准模块并且不会经常更改服务器字符串，那么它是有意义的。但是，如果您想要更多，HttpHeadersMoreModule 是一个强大的项目，它可以让您使用 HTTP 标头执行各种运行时黑魔法。

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2014-05-11T06:36:20.037

这很简单：将这些行添加到服务器部分：

```
server_tokens off;
more_set_headers 'Server: My Very Own Server'; 
```

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2011-11-15T15:51:54.090

简单，编辑 /etc/nginx/nginx.conf 并删除注释

```
#server_tokens off; 
```

搜索*http*部分。

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2017-06-02T09:34:30.653

安装 Nginx 附加功能

```
sudo apt-get update
sudo apt-get install nginx-extras 
```

通过在 nginx.conf 中添加以下两行（在 http 部分下），可以从响应中删除服务器详细信息

```
more_clear_headers Server;
server_tokens off; 
```

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2010-02-17T12:24:19.920

有一个特殊的模块：[http ://wiki.nginx.org/NginxHttpHeadersMoreModule](http://wiki.nginx.org/NginxHttpHeadersMoreModule)

> 此模块允许您添加、设置或清除您指定的任何输出或输入标头。
> 
> 这是标准[标头](https://web.archive.org/web/20100209015711/http://wiki.nginx.org/NginxHttpHeadersModule)模块的增强版本，因为它提供了更多实用程序，例如重置或清除“内置标头”，如`Content-Type`、`Content-Length`和`Server`.
> 
> 它还允许您使用该选项指定可选的 HTTP 状态代码标准，`-s`并使用该选项指定可选的内容类型标准，同时使用[more_set_headers](https://web.archive.org/web/20100209015711/http://wiki.nginx.org/NginxHttpHeadersMoreModule#more_set_headers)和[more_clear_headers](https://web.archive.org/web/20100209015711/http://wiki.nginx.org/NginxHttpHeadersMoreModule#more_clear_headers)指令`-t`修改输出标头...

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2015-04-26T18:16:44.383

如果您可以将标头更改为另一个五个字母或更少的字符串，您可以简单地修补二进制文件。

```
sed -i 's/nginx\r/thing\r/' `which nginx` 
```

作为一种解决方案，它具有一些显着的优势。也就是说，即使 nginx-extras 不适用于您的发行版，您也可以允许包管理器处理您的 nginx 版本控制（因此，不从源代码编译），并且您无需担心任何额外的像 nginx-extras 这样的代码易受攻击。

当然，您还需要设置选项`server_tokens off`、隐藏版本号或修补该格式字符串。

我说“五个字母或更少”，因为您当然可以随时替换：

> nginx\r\0

和

> 鲍勃\r\0\r\0

保持最后两个字节不变。

如果您实际上需要五个以上的字符，则需要保留 server_tokens 并替换（稍长）格式字符串，尽管格式字符串的长度再次对该长度施加了上限 - 1（对于回车）。

...如果上述方法对您没有意义，或者您以前从未修补过二进制文件，那么您可能希望远离这种方法。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-05-02T12:12:24.867

根据 nginx[文档](http://nginx.org/en/docs/http/ngx_http_core_module.html#server_tokens)，它支持自定义值甚至排除：

```
Syntax: server_tokens on | off | build | string; 
```

但遗憾的是只有*商业订阅*：

> 此外，作为我们商业订阅的一部分，从版本 1.9.13 开始，错误页面上的签名和“服务器”响应头字段值可以使用带有变量的字符串显式设置。空字符串禁用“服务器”字段的发射。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-08T11:19:46.873

唯一的方法是修改文件 src/http/ngx_http_header_filter_module.c 。我将第 48 行的 nginx 更改为不同的字符串。

您可以在 nginx 配置文件中将*server_tokens*设置为关闭。这将阻止 nginx 打印版本号。

要检查一下，试试*curl -I [http://vurbu.com/](http://vurbu.com/) | grep 服务器*

它应该返回

```
Server: Hai 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-08-08T12:32:16.773

在阅读了 Parthian Shot 的答案后，我深入研究了`/usr/sbin/nginx`二进制文件。然后我发现该文件包含这三行。

```
Server: nginx/1.12.2
Server: nginx/1.12.2
Server: nginx 
```

基本上，其中前两个用于`server_tokens on;`指令（包括服务器版本）。然后我更改搜索条件以匹配二进制文件中的那些行。

```
sed -i 's/Server: nginx/Server: thing/' `which nginx` 
```

深入挖掘后发现nginx产生的错误信息也包含在这个文件中。

```
<hr><center>nginx</center> 
```

一共有三个，一个没有版本，两个包含版本。所以我运行以下命令来替换错误消息中的 nginx 字符串。

```
sed -i 's/center>nginx/center>thing/' `which nginx` 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-06-21T13:11:09.850

我知道这篇文章有点老了，但我找到了一个简单的解决方案，它可以在基于 Debian 的发行版上运行，而无需从源代码编译 nginx。

首先安装 nginx-extras 包

> sudo apt install nginx-extras

然后通过编辑 nginx.conf 并在 server 块中添加以下行来加载 nginx http headers more 模块

> load_module 模块/ngx_http_headers_more_filter_module.so；

完成后，您将可以访问 more_set_headers 和 more_clear_headers 指令。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-05-06T06:09:12.567

Nginx-extra 包现在已弃用。

因此，以下内容现在对我有用，因为我尝试安装各种包 more_set_headers 'Server: My Very Own Server';

您只需执行以下操作，就不会发回服务器或版本信息

```
 server_tokens ''; 
```

如果您只想删除版本号，这可行

```
 server_tokens off; 
```

* * *

## 回答 #14

> 赞同：-4
> 
> 时间：2008-10-29T09:48:00.840

您是在询问响应中的 Server 标头值吗？您可以尝试使用 add_header 指令更改它，但我不确定它是否会起作用。[http://wiki.codemongers.com/NginxHttpHeadersModule](http://wiki.codemongers.com/NginxHttpHeadersModule)

# java - 为什么我的应用程序在关闭主窗口后仍然运行？

> ID：246228
> 
> 赞同：14
> 
> 时间：2008-10-29T09:31:13.510
> 
> 标签：java, swing

如果我制作这样的 JFrame

```
public static void main(String[] args) {

     new JFrame().setVisible(true);
} 
```

然后在关闭窗口后应用程序不会停止（我需要杀死它）。

显示应用程序主窗口的正确方法是什么？

我还想知道提出解决方案的原因。

提前致谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-29T09:34:45.937

你应该`setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);`在你的 JFrame 中调用。

示例代码：

```
public static void main(String[] args) {
    Runnable guiCreator = new Runnable() {
        public void run() {
            JFrame fenster = new JFrame("Hallo Welt mit Swing");
            fenster.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            fenster.setVisible(true);
        }
    };
    SwingUtilities.invokeLater(guiCreator);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T09:39:51.637

应用程序窗口和应用程序本身是有区别的……窗口在自己的线程中运行，`main()`如果其他线程仍然处于活动状态，则整理不会结束应用程序。关闭窗口时，您还应该确保关闭应用程序，可能通过调用`System.exit(0);`

尤瓦尔=8-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-29T09:59:16.870

您必须释放框架，调用窗口侦听器中的 dispose 方法或使用 setDefaultCloseOperation。对于最后一个参数，您可以使用两个选项：

`DISPOSE_ON_CLOSE`或`EXIT_ON_CLOSE`。

`DISPOSE_ON_CLOSE`只处理帧资源。

`EXIT_ON_CLOSE`处理框架资源，然后调用`System.exit`.

除非您有非守护线程，否则两者之间没有真正的区别。我更喜欢使用`DISPOSE_ON_CLOSE`这种方式，因为如果我忘记终止线程，我可以注意到，因为如果没有更多线程在运行，JVM 将停止。这也是关闭 Frame 而不进行处理不会终止应用程序的原因，因为 Swing 创建了一个线程来处理仅在调用 dispose 时才终止的事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-28T19:08:38.793

您可以为框架设置一个*窗口侦听*器，以便程序在您关闭它后终止。

```
frame.addWindowListener(new WindowAdapter() {
    public void windowClosing(WindowEvent e) {
        System.exit(0);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-30T10:16:29.063

执行此操作的正确方法（除非您正在编写一个非常简单的单窗口应用程序，即没有其他窗口或线程等）是捕获`windowClosing()`事件，然后调用`dispose();`表单的方法。

如果您的程序在此之后没有完全退出，则意味着您有其他非守护线程正在运行，您必须根据您的程序尽可能停止这些线程。

调用`System.exit()`or`setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);`将强制停止任何其他线程（以及整个程序），这意味着您的代码可移植性较差，并且强制停止线程显然是危险的（以编程方式）。

# regex - 正则表达式 nongreedy 是 greedy

> ID：246232
> 
> 赞同：7
> 
> 时间：2008-10-29T09:32:54.130
> 
> 标签：regex, regex-greedy, non-greedy

我有以下文字

```
tooooooooooooon 
```

根据我正在阅读的这本书，当`?`在任何量词之后跟随时，它变得非贪婪。

我的正则表达式`to*?n`仍在返回`tooooooooooooon`。

它应该返回`ton`不应该吗？

知道为什么吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-10-29T09:36:09.553

正则表达式只能匹配实际存在的文本片段。

因为子字符串 'ton' 在字符串中的任何位置都不存在，所以它不可能是匹配的结果。匹配只会返回原始字符串的子字符串

编辑：要清楚，如果您使用下面的字符串，带有额外的 'n'

```
toooooooonoooooon 
```

此正则表达式（未指定 'o'）

```
t.*n 
```

将匹配以下内容（在“n”之前尽可能多的字符）

```
toooooooonoooooon 
```

但是正则表达式

```
t.*?n 
```

只会匹配以下内容（在“n”之前尽可能少的字符）

```
toooooooon 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-29T09:44:46.040

正则表达式 es 总是渴望匹配。

你的表情是这样说的：

```
一个“t”，后跟*尽可能少的*“o”，然后是一个“n”。

```

这意味着任何必要的 o 都将被匹配，因为末尾有一个 'n'，表达式渴望达到。匹配所有的 o 是成功的唯一可能性。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-29T09:37:10.563

正则表达式尝试匹配其中的所有内容。因为要匹配的 'o' 不比匹配 n 的每个 o 少，所以一切都匹配。另外，因为您使用的是 o*? 而不是 o+? 您不需要在场。

例如，在 Perl

```
$a = "toooooo";
$b = "toooooon";

if ($a =~ m/(to*?)/) {
        print $1,"\n";
}
if ($b =~ m/(to*?n)/) {
        print $1,"\n";
}

~>perl ex.pl
t
toooooon 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-30T02:01:39.127

正则表达式总是尽力匹配。在这种情况下，您唯一要做的就是通过让解析器回溯到`/o*?/`节点来减慢解析器的速度。中的每个单曲`'o'`一次`"tooooon"`。`'o'`而对于普通匹配，第一次通过时会花费尽可能多的 s。由于要匹配的下一个元素是`'n'`，它不会被 匹配`'o'`，因此尝试使用最小匹配没有什么意义。实际上，当正常匹配失败时，它需要相当长的时间才能失败。它必须回溯每一个`'o'`，直到没有任何东西可以回溯。在这种情况下，我实际上会使用最大匹配`/to*+n/`。这`'o'`会尽其所能，从不归还。这将使它在失败时迅速失败。

### 最小 RE 成功：

```
'toooooon' ~~ /to*?n/

 太棒了       
{t} 匹配 [t]
[t] 匹配 [o] 0 次
[t]<n> 匹配失败 [n] -> 重试 [o]
[t]{o} 匹配 [o] 1 次
[t][o]<n> 匹配失败 [n] -> 重试 [o]
[t][o]{o} 匹配 [o] 2 次
[t][o][o]<n> 匹配失败 [n] -> 重试 [o]

. . . .

[t][o][o][o][o]{o} 匹配 [o] 5 次
[t][o][o][o][o][o]<n> 匹配失败 [n] -> 重试 [o]
[t][o][o][o][o][o]{o} 匹配 [o] 6 次
[t][o][o][o][o][o][o]{n} 匹配 [n]

```

### 正常 RE 成功：

*（注意：Maximal RE 类似）*

```
'太棒了' ~~ /to*n/

 太棒了       
{t} 匹配 [t]
[t]{o}{o}{o}{o}{o}{o} 匹配 [o] 6 次
[t][o][o][o][o][o][o]{n} 匹配 [n]

```

### 最小 RE 失败：

```
'toooooo' ~~ /to*?n/

 太棒了

. . . .

. . . .

[t][o][o][o][o]{o} 匹配 [o] 5 次
[t][o][o][o][o][o]<n> 匹配失败 [n] -> 重试 [o]
[t][o][o][o][o][o]{o} 匹配 [o] 6 次
[t][o][o][o][o][o][o]<n> 匹配失败 [n] -> 重试 [o]
[t][o][o][o][o][o][o]<o> 匹配失败 [o] 7 次 -> 匹配失败

```

### 正常 RE 失败：

```
'toooooo' ~~ /to*n/

 太棒了       
{t} 匹配 [t]
[t]{o}{o}{o}{o}{o}{o} 匹配 [o] 6 次
[t][o][o][o][o][o][o]<n> 匹配失败 [n] -> 重试 [o]
[t][o][o][o][o][o] 匹配 [o] 5 次
[t][o][o][o][o][o]<n> 匹配失败 [n] -> 重试 [o]

. . . .

[t][o] 匹配 [o] 1 次
[t][o]<o> 匹配失败 [n] -> 重试 [o]
[t] 匹配 [o] 0 次
[t]<n> 匹配失败 [n] -> 匹配失败

```

### 最大 RE 失败：

```
'toooooo' ~~ /to*+n/

 太棒了
{t} 匹配 [t]
[t]{o}{o}{o}{o}{o}{o} 匹配 [o] 6 次
[t][o][o][o][o][o][o]<n> 匹配失败 [n] -> 匹配失败

```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-29T09:35:08.180

您正在搜索的字符串（就像是大海捞针）不包含子字符串“ton”。

然而，它确实包含子字符串“tooooooooooooon”。

# c# - C#中的点阵打印？

> ID：246233
> 
> 赞同：8
> 
> 时间：2008-10-29T09:34:34.813
> 
> 标签：c#, printing, xps

我正在尝试使用 C# 打印到点阵打印机（各种型号），目前我正在使用 Win32 API（您可以在网上找到很多示例）调用从我的 C# 应用程序中将转义码直接发送到打印机。这很好用，但是...

我的问题是因为我正在生成转义码并且不依赖于 Windows 打印系统，因此无法将打印输出发送到任何“普通”打印机或 PDF 打印驱动程序之类的东西。（这现在导致了一个问题，因为我们正在尝试使用 Easy Print [基于 XPS] 在 2008 终端服务器上使用该应用程序）

问题是：如何在不使用直接打印、转义码等的情况下使用 C# 将格式化的文档（预先打印的文具上的发票）打印到点阵打印机（Epson、Oki 和 Panasonic ......各种型号）。

**澄清一下，我正在尝试 GDI+ (System.Drawing.Printing) 之类的东西，但问题是很难像旧代码那样让事情排成一行。（旧代码绕过 Windows 驱动程序将字符直接发送到打印机。）有什么建议可以改进，以便他们可以使用 GDI+，但仍然像旧代码一样排列？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-30T10:31:33.277

您可能应该使用报告工具来制作允许您或用户正确定位与预印文具相关的字段的模板。

使用点阵打印机，您基本上必须在两种模式中的任何一种模式下工作：

*   行/列文本的简单打字机模式，您可以在其中发送转义序列来管理打印机硬件中包含的少量字体，并且必须管理行返回等。
*   页面被光栅化的图形输出，打印机驱动程序仅驱动打印头和引脚以输出点。

第一种用法在 Windows 下大多被弃用，因为它没有提供太多控制输出的方式，而且每台打印机都有自己的特性，软件难以预测和定位页面上的内容（没有所见即所得）。

第二种只是使用图形页面范例，使文本和图形的定位独立于打印机的实际功能。
使用预印文具时，您的作业需要正确定位页面上的数据。
手动执行此操作会消耗资源，当然不建议在代码中创建布局，因为如果您的打印机、页面格式或打印的文具发生变化，您将无法更改代码。

最好的办法是只使用 .Net 提供的标准打印模型和一个报告工具，该工具允许您定义模型和模板来放置正确的文本和图形，然后从代码中驱动它。

Visual Studio 附带一个版本的 Crystal Reports，但还有其他更好的报告系统（例如，我使用[developer express](http://devexpress.com/)的那个），其中一些甚至是[免费](http://www.fyireporting.com/)的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-30T10:59:46.823

根据我的经验，对同一数据使用两种报告会更容易：

*   需要使用转义码和其他任何内容的点阵打印机报告，该报告保存在文本文件中，然后使用各种方法打印（`type file.txt > lpt1`或在代码中选择默认打印机并使用`NOTEPAD /P file.txt`） - 有关更多打印方法，请参阅[此页面](http://www.robvanderwoude.com/printfiles.html)。
*   使用报告生成器工具（Crystal Reports、[Report Manager](http://reportman.sourceforge.net/)、[RLIB](http://rlib.sicompos.com/)或任何可用的工具）的激光/喷墨打印机的另一份报告

由于为正确类型的报告购买正确类型的打印机并不罕见，这种方法的优点是让客户决定：用于 A3/A4 纸格式文本报告的点阵打印机（通常用于会计部门）或用于图形报告的激光/喷墨打印机。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-23T07:46:39.397

我不知道如何在 C# 中使用转义序列。但我有通用/纯文本打印机的所有转义序列。希望能帮助到你。

通用打印转义序列 1) 设置行距 a) 1/8 英寸 - 27,48 b) 1/6 英寸 - 27,50

2) 选择草稿质量 a) 27,120,0 / 27,120,48

3) 字母质量 a) 27,120,1 / 27,120,49

4) 双高 a) 27,119,n i) n = 1 On ii) n = 0 Off

5) 双向打印 a) 27,85,n i) 0 - 双向 ii) 1 - 单向

6) 增加字符空间 a) 27,32,n（增加 n / 12 英寸）

7) 选择粗体 a) 27,69

8) 取消粗体字体 a) 27,70

9) 选择斜体 a) 27,52

10) 取消斜体 a) 27,53

11) 选择 a) 10cpi 27,8 b) 12cpi 27,77 c) 15cpi 27,103 d) 18cpi 27,103

12) 设置右边距 a) 27,81,n

13) 设置左边距 a) 27,108,n

14) 换页 a) 12

15) 浓缩打印 a) 0F 开 b) 12 关

16) 双重打击印刷 a) 27,71

17) 取消罢工印刷 a) 27,72

18) 线下 a) 27,45,0 关闭 b) 27,45,1 开启

19) 双宽度 a) 27,84,0 关闭 b) 27,84,1 开启

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-27T08:41:12.413

首先将序列命令转换为字符，然后传递给打印机

示例粗体字体 27,69

string.Format("{0}{1}",Convert.ToChar(27),Convert.ToChar(69));

也许有点短：

string.Format("{0}{1}",(char)(27),(char)(69));

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T20:10:58.490

看看[System.Drawing.Printing](http://msdn.microsoft.com/en-us/library/system.drawing.printing.aspx)命名空间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-29T20:30:48.997

如果您的打印机需要安装驱动程序，那么您可以使用普通的 Windows 打印系统。大多数打印机，包括 POS 打印机，都有可用的 Windows 驱动程序。（无论如何，大多数点阵打印机都与 Epson 兼容。）一些 POS 打印机驱动程序也允许将转义码直接发送到打印机（使用特殊字体）；可能你不需要这样的功能。

如果不是这种情况，那么您可以在添加打印机向导的帮助下添加通用/纯文本打印机（驱动程序）。完成后，您可以为其配置某些命令（转义序列） - 字体大小 10/12/17、粗体开/关、下划线开/关、作业开始/停止、进纸和尺寸选择。

我正在使用与 FILE 端口关联的通用打印机来测试 POS 打印机的各种报告 - 查看文本文件以验证打印输出中的数字很容易。当然需要格式化特定的打印机驱动程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-30T07:28:05.410

看来我想做的事情是不可能的。

我对打印的选择是不受管理的直接到打印机打印（使用 winspool.drv），这使我可以对打印机做任何我喜欢的事情，并让我可以轻松地排好队。[VB.NET 示例](http://support.microsoft.com/default.aspx?scid=kb%3Ben-us%3B322090)或者我可以使用 GDI+ (System.Drawing.Printing)，这很复杂，但可以与 XPS 和 PDF 打印机等非点阵打印机一起使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-08-10T03:04:17.410

你可以参考这个[http://www.codeproject.com/Articles/29709/Line-Printer-Class-in-C](http://www.codeproject.com/Articles/29709/Line-Printer-Class-in-C) 希望有所帮助

# eclipse-plugin - 用于 TestNG 覆盖的 Eclipse 插件

> ID：246246
> 
> 赞同：5
> 
> 时间：2008-10-29T09:37:54.823
> 
> 标签：eclipse-plugin, code-coverage, testng

有人知道用于分析 TestNG 单元测试的代码覆盖率的 Eclipse 插件吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-29T09:45:44.370

[EclEmma](http://www.eclemma.org/)可以在 TestNG 测试套件上运行。您还可以使用它运行一组测试或给定的 TestNG 类。它需要[TestNg 插件](http://testng.org/doc/eclipse.html)

在 EclEmma 插件上，选择“coverage configuration...”并选择 TestNG 选项卡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-05T12:19:22.467

是的， [EclEmma](http://www.eclemma.org/)是最好的。您也可以尝试基于 maven 的[cobertura](http://blogs.codehaus.org/people/brett/archives/001334_test_ng_and_cobertura_in_maven_2.html)，这也足够好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-21T12:52:13.453

我也用 EclEmma，看过[Clover](http://www.atlassian.com/software/clover/)吗？- 非常非常好，但不是开源的。

# sql-server - SQL 到 Linq 表达式？

> ID：246248
> 
> 赞同：3
> 
> 时间：2008-10-29T09:38:55.710
> 
> 标签：sql-server, linq-to-sql

有谁知道获取 T-SQL 查询并将其转换为 LINQtoSQL 查询的工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T12:57:55.603

很抱歉，我不知道任何工具可以做到这一点。如果您的问题是您对 Linq 不够了解，您可能需要考虑这个[工具](http://www.linqpad.net)。它将帮助您学习 Linq，而且它是免费的（但不是开源的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T08:04:09.393

由于 LINQ 处理连接的方式，这是一个不平凡的问题。我过去实际上尝试过，但我只是无法正确理解语义。

（也许我会再次尝试使用 OSLO 和 MGrammar。为 LEX 和 YACC 找到一个不错的替代品将会有很长的路要走。）

# ios - 以编程方式在 iPhone 日历中添加自定义事件

> ID：246249
> 
> 赞同：184
> 
> 时间：2008-10-29T09:39:47.767
> 
> 标签：ios, iphone, calendar, eventkit

有没有办法从自定义应用程序将 iCal 事件添加到 iPhone 日历？

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2013-06-26T22:40:54.780

根据[Apple Documentation](https://developer.apple.com/library/archive/documentation/DataManagement/Conceptual/EventKitProgGuide/ReadingAndWritingEvents.html#//apple_ref/doc/uid/TP40004775-SW1)，这在 iOS 6.0 中有所改变。

1) 您应该通过“requestAccessToEntityType:completion:”请求访问用户的日历并在块内执行事件处理。

2）您需要现在提交您的事件或将“提交”参数传递给您的保存/删除调用

其他一切都保持不变...

将 EventKit 框架和代码添加`#import <EventKit/EventKit.h>`到您的代码中。

在我的示例中，我有一个 NSString *savedEventId 实例属性。

要添加事件：

```
 EKEventStore *store = [EKEventStore new];
    [store requestAccessToEntityType:EKEntityTypeEvent completion:^(BOOL granted, NSError *error) {
        if (!granted) { return; }
        EKEvent *event = [EKEvent eventWithEventStore:store];
        event.title = @"Event Title";
        event.startDate = [NSDate date]; //today
        event.endDate = [event.startDate dateByAddingTimeInterval:60*60];  //set 1 hour meeting
        event.calendar = [store defaultCalendarForNewEvents];
        NSError *err = nil;
        [store saveEvent:event span:EKSpanThisEvent commit:YES error:&err];
        self.savedEventId = event.eventIdentifier;  //save the event id if you want to access this later
    }]; 
```

删除事件：

```
 EKEventStore* store = [EKEventStore new];
    [store requestAccessToEntityType:EKEntityTypeEvent completion:^(BOOL granted, NSError *error) {
        if (!granted) { return; }
        EKEvent* eventToRemove = [store eventWithIdentifier:self.savedEventId];
        if (eventToRemove) {
            NSError* error = nil;
            [store removeEvent:eventToRemove span:EKSpanThisEvent commit:YES error:&error];
        }
    }]; 
```

这会将事件添加到您的默认日历中，如果您有多个日历，那么您将找出哪个是

*斯威夫特版本*

您需要导入 EventKit 框架

```
import EventKit 
```

添加活动

```
let store = EKEventStore()
store.requestAccessToEntityType(.Event) {(granted, error) in
    if !granted { return }
    var event = EKEvent(eventStore: store)
    event.title = "Event Title"
    event.startDate = NSDate() //today
    event.endDate = event.startDate.dateByAddingTimeInterval(60*60) //1 hour long meeting
    event.calendar = store.defaultCalendarForNewEvents
    do {
        try store.saveEvent(event, span: .ThisEvent, commit: true)
        self.savedEventId = event.eventIdentifier //save event id to access this particular event later
    } catch {
        // Display error to user
    }
} 
```

移除事件

```
let store = EKEventStore()
store.requestAccessToEntityType(EKEntityTypeEvent) {(granted, error) in
    if !granted { return }
    let eventToRemove = store.eventWithIdentifier(self.savedEventId)
    if eventToRemove != nil {
        do {
            try store.removeEvent(eventToRemove, span: .ThisEvent, commit: true)
        } catch {
            // Display error to user
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：153
> 
> 时间：2010-07-05T04:56:30.230

您可以使用 OS 4.0 中的 Event Kit 框架来执行此操作。

在窗口左侧的 Groups and Files Navigator 中右键单击 FrameWorks 组。选择“添加”，然后选择“现有框架”，然后选择“EventKit.Framework”。

然后您应该能够使用如下代码添加事件：

```
#import "EventTestViewController.h"
#import <EventKit/EventKit.h>

@implementation EventTestViewController

- (void)viewDidLoad {
    [super viewDidLoad];

    EKEventStore *eventStore = [[EKEventStore alloc] init];

    EKEvent *event  = [EKEvent eventWithEventStore:eventStore];
    event.title     = @"EVENT TITLE";

    event.startDate = [[NSDate alloc] init];
    event.endDate   = [[NSDate alloc] initWithTimeInterval:600 sinceDate:event.startDate];

    [event setCalendar:[eventStore defaultCalendarForNewEvents]];
    NSError *err;
    [eventStore saveEvent:event span:EKSpanThisEvent error:&err];       
}

@end 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-30T02:43:19.917

是的，这个（2.1）仍然没有 API。但似乎在 WWDC 上，很多人（包括我自己）已经对该功能感兴趣，建议访问以下站点并为此创建功能请求。如果有足够的兴趣，他们最终可能会将 ICal.framework 移至公共 SDK。

[https://developer.apple.com/bugreporter/](https://developer.apple.com/bugreporter/)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2010-05-18T11:53:20.623

[iPhone OS 4.0 中添加了日历访问](http://developer.apple.com/technologies/iphone/whats-new.html)：

> **日历访问**
> 应用程序现在可以使用 Event Kit 在日历应用程序中直接创建和编辑事件。
> 创建重复事件，设置开始和结束时间并将它们分配给设备上的任何日历。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-01-14T13:01:48.990

斯威夫特 4.0 实施：

在页面顶部使用 import by`import EventKit`

然后

```
@IBAction func addtoCalendarClicked(sender: AnyObject) {

    let eventStore = EKEventStore()

    eventStore.requestAccess( to: EKEntityType.event, completion:{(granted, error) in

        if (granted) && (error == nil) {
            print("granted \(granted)")
            print("error \(error)")

            let event = EKEvent(eventStore: eventStore)

            event.title = "Event Title"
            event.startDate = Date()
            event.endDate = Date()
            event.notes = "Event Details Here"
            event.calendar = eventStore.defaultCalendarForNewEvents

            var event_id = ""
            do {
                try eventStore.save(event, span: .thisEvent)
                event_id = event.eventIdentifier
            }
            catch let error as NSError {
                print("json error: \(error.localizedDescription)")
            }

            if(event_id != ""){
                print("event added !")
            }
        }
    })
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-07-09T14:36:19.873

您可以使用 Tristan 概述的 Event API 添加事件，还可以添加显示在 iOS 日历中的 Google 日历事件。

使用[Google 的 API Objective-C 客户端](http://code.google.com/p/google-api-objectivec-client/source/browse/trunk/Examples/CalendarSample/CalendarSampleWindowController.m)

```
 - (void)addAnEvent {
  // Make a new event, and show it to the user to edit
  GTLCalendarEvent *newEvent = [GTLCalendarEvent object];
  newEvent.summary = @"Sample Added Event";
  newEvent.descriptionProperty = @"Description of sample added event";

  // We'll set the start time to now, and the end time to an hour from now,
  // with a reminder 10 minutes before
  NSDate *anHourFromNow = [NSDate dateWithTimeIntervalSinceNow:60*60];
  GTLDateTime *startDateTime = [GTLDateTime dateTimeWithDate:[NSDate date]
                                                    timeZone:[NSTimeZone systemTimeZone]];
  GTLDateTime *endDateTime = [GTLDateTime dateTimeWithDate:anHourFromNow
                                                  timeZone:[NSTimeZone systemTimeZone]];

  newEvent.start = [GTLCalendarEventDateTime object];
  newEvent.start.dateTime = startDateTime;

  newEvent.end = [GTLCalendarEventDateTime object];
  newEvent.end.dateTime = endDateTime;

  GTLCalendarEventReminder *reminder = [GTLCalendarEventReminder object];
  reminder.minutes = [NSNumber numberWithInteger:10];
  reminder.method = @"email";

  newEvent.reminders = [GTLCalendarEventReminders object];
  newEvent.reminders.overrides = [NSArray arrayWithObject:reminder];
  newEvent.reminders.useDefault = [NSNumber numberWithBool:NO];

  // Display the event edit dialog
  EditEventWindowController *controller = [[[EditEventWindowController alloc] init] autorelease];
  [controller runModalForWindow:[self window]
                          event:newEvent
              completionHandler:^(NSInteger returnCode, GTLCalendarEvent *event) {
                // Callback
                if (returnCode == NSOKButton) {
                  [self addEvent:event];
                }
              }];
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-10-13T01:03:32.913

Dashrath 答案的 swift 4 更新

```
import UIKit
import EventKit

class ViewController: UIViewController {

    override func viewDidLoad() {
        super.viewDidLoad()

        let eventStore = EKEventStore()

        eventStore.requestAccess( to: EKEntityType.event, completion:{(granted, error) in

            if (granted) && (error == nil) {

                let event = EKEvent(eventStore: eventStore)

                event.title = "My Event"
                event.startDate = Date(timeIntervalSinceNow: TimeInterval())
                event.endDate = Date(timeIntervalSinceNow: TimeInterval())
                event.notes = "Yeah!!!"
                event.calendar = eventStore.defaultCalendarForNewEvents

                var event_id = ""
                do{
                    try eventStore.save(event, span: .thisEvent)
                    event_id = event.eventIdentifier
                }
                catch let error as NSError {
                    print("json error: \(error.localizedDescription)")
                }

                if(event_id != ""){
                    print("event added !")
                }
            }
        })
    }

    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }

} 
```

也不要忘记添加日历使用权限 [![私人设置的图像](https://i.stack.imgur.com/4lQEN.png)](https://i.stack.imgur.com/4lQEN.png)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-10-24T05:44:01.713

Swift-4.2 中的工作代码

```
import UIKit
import EventKit
import EventKitUI

class yourViewController: UIViewController{

    let eventStore = EKEventStore()

    func addEventToCalendar() {

    eventStore.requestAccess( to: EKEntityType.event, completion:{(granted, error) in
        DispatchQueue.main.async {
            if (granted) && (error == nil) {
                let event = EKEvent(eventStore: self.eventStore)
                event.title = self.headerDescription
                event.startDate = self.parse(self.requestDetails.value(forKey: "session_time") as? String ?? "")
                event.endDate = self.parse(self.requestDetails.value(forKey: "session_end_time") as? String ?? "")
                let eventController = EKEventEditViewController()
                eventController.event = event
                eventController.eventStore = self.eventStore
                eventController.editViewDelegate = self
                self.present(eventController, animated: true, completion: nil)

            }
        }

       })
    }

} 
```

现在我们将获得事件屏幕，您还可以在此处修改您的设置：

[![在此处输入图像描述](https://i.stack.imgur.com/rGDdS.png)](https://i.stack.imgur.com/rGDdS.png)

*现在添加委托方法来处理取消并添加事件屏幕的事件按钮操作：*

```
 extension viewController: EKEventEditViewDelegate {

    func eventEditViewController(_ controller: EKEventEditViewController, didCompleteWith action: EKEventEditViewAction) {
        controller.dismiss(animated: true, completion: nil)

    }
} 
```

**注意：**不要忘记将**NSCalendarsUsageDescription**键添加到 info plist 中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-07-08T14:34:19.267

请记住将 endDate 设置为创建的事件，这是强制性的。

否则它将失败（几乎无声）并出现以下错误：

```
"Error Domain=EKErrorDomain Code=3 "No end date has been set." UserInfo={NSLocalizedDescription=No end date has been set.}" 
```

对我来说完整的工作代码是：

```
EKEventStore *store = [EKEventStore new];
[store requestAccessToEntityType:EKEntityTypeEvent completion:^(BOOL granted, NSError *error) {
    if (!granted) { return; }
    EKEvent *calendarEvent = [EKEvent eventWithEventStore:store];
    calendarEvent.title = [NSString stringWithFormat:@"CEmprendedor: %@", _event.name];
    calendarEvent.startDate = _event.date;
    // 5 hours of duration, we must add the duration of the event to the API
    NSDate *endDate = [_event.date dateByAddingTimeInterval:60*60*5];
    calendarEvent.endDate = endDate;
    calendarEvent.calendar = [store defaultCalendarForNewEvents];
    NSError *err = nil;
    [store saveEvent:calendarEvent span:EKSpanThisEvent commit:YES error:&err];
    self.savedEventId = calendarEvent.eventIdentifier;  //saving the calendar event id to possibly deleted them
}]; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-21T10:43:58.060

谷歌的想法很好，但也有问题。

我可以成功打开 Google 日历活动屏幕 - 但仅限于主桌面版本，并且在 iPhone Safari 上无法正常显示。在 Safari 上正确显示的 Google 移动日历似乎无法使用 API 添加事件。

目前，我看不出有什么好的出路。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-28T06:16:32.440

简单......使用tapku库......你可以用谷歌搜索这个词并使用它......它的开源......享受......不需要那些代码的窃听......

# iis-6 - 在 IIS 中对网站进行排序

> ID：246256
> 
> 赞同：2
> 
> 时间：2008-10-29T09:45:18.240
> 
> 标签：iis-6

目前，我在同一个 IIS 中运行多个网站，每个网站都有多个（品牌）重复项。我想对所有网站组有一个简单的概述，所以我使用了像 [siteName].[brandCode] 这样的命名约定。但是你瞧，IIS 有它自己的（看似随机的）方式来对“网站”文件夹中的条目进行排序。

有什么建议么

（是的，我使用不同的应用程序池，但这不是我的目标）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T09:50:22.347

您需要编辑 IIS 元数据库以重新排序。我不记得是否有在 IIS6 中执行此操作的工具，但您可以将[MetaEdit](http://support.microsoft.com/kb/240225/en-us)用于 IIS7，以便向后兼容。

如果没有，元数据库只是一个 XML 文件，因此您可以在记事本中手动编辑它（先备份）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-07T11:07:58.933

当您运行 IIS6 时，安装 IIS6 资源工具包并运行 Metabase Explorer，为我做了诀窍

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T09:48:57.997

我总是单击 IIS 管理器中的“网站”文件夹，然后按说明对右侧面板中的列表进行排序。

我认为没有其他选择。

# linq - 你见过的最严重的 LINQ 语法滥用是什么？

> ID：246270
> 
> 赞同：11
> 
> 时间：2008-10-29T09:53:31.857
> 
> 标签：linq, anti-patterns, abuse

在最近的[Dot Net Rocks 播客](http://www.dotnetrocks.com/default.aspx?showNum=383)中，Jon Skeet 提到了可能滥用 LINQ 语法。人们见过哪些用 LINQ 做疯狂事情的​​例子？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-29T09:59:13.577

它必须是[在单个 LINQ 表达式中实现的光线追踪器](https://docs.microsoft.com/en-us/archive/blogs/lukeh/taking-linq-to-objects-to-extremes-a-fully-linqified-raytracer)。聪明，美丽，同时又可怕！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-29T09:58:55.997

这是[我自己的滥用](http://codeblog.jonskeet.uk/2008/02/29/odd-query-expressions)- 纯粹是为了在极客之夜开怀大笑，并展示编译器对查询表达式的实际作用。

可以说我的[“LINQ to Mandelbrot”](http://codeblog.jonskeet.uk/2008/05/18/mandelbrot-revisited-benchmark-edition)也有点辱骂:)

顺便说一句，我特别想到了滥用*语法*，但是总是有很多方法可以滥用 LINQ 的存在——当有更简单的方法可用而不使用 LINQ 时，以“LINQ 方式”做事。例如，获取`n`数组的第 th 个元素：

```
// Sensible (we know that people implements IList<Person>)
Person x = people[10];
// Insane
Person y = people.Skip(9).First(); 
```

我怀疑这样的滥用案例会比滥用查询表达式的权力更多，部分原因是许多开发人员不会意识到滥用查询表达式甚至会起作用:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-05T18:39:54.390

老实说，在某些情况下人们选择了 LINQ 语法，而代码这样做：

*   与简单循环相同或更长
*   与简单循环相比，没有提供性能*或*正确性优势（可读性/可维护性）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-07-01T13:31:33.337

我见过的*“最好的”之一来自*[thedailywtf.com](http://thedailywtf.com/Articles/The-Long-Way.aspx)

```
public string LastSixDigits
{
 get
 {
   if (string.IsNullOrWhiteSpace(this.Number) || this.Number.Length < 6)
     return string.Empty;
   return this.Number.Reverse().Take(6).Reverse().Aggregate(string.Empty, (s, c) => s += c);
 }
} 
```

# asp.net - ASP.NET 图片标签

> ID：246272
> 
> 赞同：0
> 
> 时间：2008-10-29T09:53:40.483
> 
> 标签：asp.net, javascript

我对 ASP.Net 如何生成**img**标签有疑问。我有一个这样的服务器控件：

```
<asp:Image runat="server" ID="someWarning" ImageUrl="~/images/warning.gif" AlternateText="Warning" /> 
```

我希望它产生这个：

```
<img id="ctl00_ContentPlaceHolder1_ctl00_someWarning" src="../images/warning.gif" /> 
```

但相反，它会生成：

```
<img alt="" src="/Image.ashx;img=%2fimages%2fwarning.gif"</img> 
```

当我执行以下 js 时，这给了我错误：

```
document.getElementById('ctl00_ContentPlaceHolder1_someWarning') 
```

知道为什么它不会生成预期的 html 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T10:00:09.707

看起来它正在尝试使用自定义处理程序（ashx）来传递图像。您是否有任何其他模块可能会覆盖 asp:Image 的默认行为？

您的 JavaScript 将无法工作，因为在生成的 HTML 中没有为图像标签指定 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T19:06:46.763

您可以获取使用 ClientID 生成的实际 ID。我使用它来获取控件的 ID，以便使用类似于以下的语法在 JavaScript 中使用：

```
document.getElementById('<%=ddlCountry.ClientID%>').style.display  = "block"; 
```

但是，您也可以在代码隐藏中使用它来获得相同的东西。

# c# - 双向数据绑定对象

> ID：246273
> 
> 赞同：0
> 
> 时间：2008-10-29T09:57:59.493
> 
> 标签：c#, winforms

我最近使用了一个令人敬畏的应用程序。从它们自己的类和“表单”继承的所有表单都具有惊人的功能，看起来很疯狂。

我感兴趣的是表单的这个“功能”。这是一个 C# WinForms 项目，让我大吃一惊。

表单绑定到该小组编写的对象，以支持双向数据绑定（在一定程度上）。他们的行为方式非常简单：

数据输入表单都有从文本框继承的控件，这些控件绑定到对象的属性，输入数据立即对其进行验证，如果验证失败，则该框为浅粉色，如果通过则为浅绿色。如果框变成蓝色，这实际上意味着表单绑定到的数据库中的值已更改，并且当输入有效值时，您对控件的更改会立即保存。有时必须在保存之前填充一部分控件。但这一切都是自动的。您可以在任何时候停下来，稍后再回来继续，而不会真正拯救自己。

就像我说的那样，如果其他人正在编辑他们更改的相同记录值，则会导致您的文本框变为蓝色，并且您知道需要重新加载屏幕才能查看最新信息。

所有这一切都来自使用他们自己编写的表单类和绑定到对象属性的自己的文本框控件。

我主要想知道该对象到底是如何确定该值已被其他人更改的。它肯定不是轮询数据库。这个系统太棒了。光辉不止于此。

为简单起见。我如何创建一个对象或对象集合来模仿这种行为。我不会去，但我什至看不到怎么做。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T10:26:48.157

我很确定涉及其他人更改的任何内容都需要访问数据库。对于双向绑定，您*真正*需要的只是更改通知 - 即`INotifyPropertyChanged`（或`FooChanged`每个`Foo`属性的事件）。这一切都被抽象为`TypeDescriptor`- 即任何使用常规`PropertyDescriptor`实现（它应该）的绑定都将通过和`SupportsChangeEvents`知道通知。`AddValueChanged``RemoveValueChanged`

用于验证 -`IDataErrorInfo`是你的朋友；通过实现这一点，您可以自愿提供验证信息（由多个控件使用和显示，例如`DataGridView`）。IE

```
IDataErrorInfo dei = obj as IDataErrorInfo;
if(dei != null) { // supports validation
   string err = dei["PropName"]; // or .Error for overall status
   bool clean = string.IsNullOrEmpty(err);
} 
```

请注意，另一种方法是`Color`在数据对象上拥有一个属性，并将其直接绑定到文本框等。

# javascript - 从 Firefox 侧边栏监视选定选项卡中的页面加载事件

> ID：246274
> 
> 赞同：1
> 
> 时间：2008-10-29T09:58:26.810
> 
> 标签：javascript, firefox, xul, sidebar, firefox-sidebar

当重新加载或更改主内容窗口中的选定选项卡时，我希望能够在我的 Firefox 侧边栏 js 文件中运行一个函数。因此，侧边栏可以根据用户正在查看的站点而改变。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T12:31:00.337

我的解决方案是从某个地方偷来的，但不记得在哪里：

```
//add the load eventListener to the window object
window.addEventListener("load", function() { functioname.init(); }, true);

var functionname =  { 
    //add the listener for the document load event
init: function() {
    var appcontent = document.getElementById("appcontent");   // browser
    if(appcontent)
        appcontent.addEventListener("DOMContentLoaded", functionname.onPageLoad, false);
    },
    //function called on document load
    onPageLoad: function(aEvent) {
        if(aEvent.originalTarget.nodeName == "#document"){
        }
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T13:47:40.467

@oly1234 - 你的回答帮助我找到了来源：
[Mozilla 开发者中心 - 页面加载](https://developer.mozilla.org/en/Code_snippets/On_page_load)

( [https://developer.mozilla.org/en/Code_snippets/On_page_load](https://developer.mozilla.org/en/Code_snippets/On_page_load) )

# git - git 分支中的修改文件溢出到另一个分支

> ID：246275
> 
> 赞同：54
> 
> 时间：2008-10-29T09:58:30.833
> 
> 标签：git, git-branch

我正在开发一个带有主分支和另一个主题分支的 git 存储库。我已切换到主题分支并修改了一个文件。现在，如果我切换到 master 分支，相同的文件会显示为已修改。

例如：

git-build 分支中的 git 状态：

```
# On branch git-build
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#       modified:   cvsup_current
# 
```

切换到主分支

```
[root@redbull builder_scripts (git-build)]# git co master
M       builder_scripts/cvsup_current
Switched to branch "master" 
```

主分支中的 git 状态

```
[root@redbull builder_scripts (master)]# git status
# On branch master
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#       modified:   cvsup_current
# 
```

为什么文件在主分支中显示为已修改，即使它是在 git-build 分支中修改的？

我的理解是分支彼此独立，当我从一个分支更改为另一个分支时，更改不会从一个分支“溢出”到另一个分支。所以我显然在这里遗漏了一些东西。

有没有人有线索棒？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-10-29T10:06:14.343

> 为什么文件在主分支中显示为已修改，即使它在 git-build 分支中进行了修改？

要记住的关键是该文件**没有**在 git-build 分支中修改。它仅在您的工作副本中进行了修改。

仅当您提交时，更改才会放回您已签出的任何分支

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2008-10-29T10:26:37.593

如果您想在去另一个分支上工作时将更改临时存储到一个分支，您可以使用该`git stash`命令。这是使用 git 令人惊奇的小秘密之一。示例工作流程：

```
git stash #work saved
git checkout master
#edit files
git commit
git checkout git-build
git stash apply #restore earlier work 
```

`git stash`存储一堆更改，因此您可以安全地存储多个检查点。你也可以给他们名字/描述。完整的使用信息[在这里](http://git-scm.com/docs/git-stash)。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-29T10:01:24.290

这是 git 的默认行为。

如果您愿意，可以使用**-f**标志进行结帐以进行“干净结帐”。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-29T10:00:53.480

*在您添加并*提交之前，修改后的文件不会放入存储库中。如果您切换回主题分支并提交文件，则它不会出现在主分支上。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-06-11T08:13:45.463

*   它不像 git 分支是相互依赖的，但它们也没有为每个分支单独提供完整的代码库。
*   对于每次提交，Git 都会存储一个对象，其中包含指向更改的指针。所以每个分支都指向它自己的最新提交，而 HEAD 指向你当前所在的分支。
*   当您切换分支时，HEAD 指针指向该分支的特定提交。因此，如果有修改过的文件，默认行为是复制它们。

您可以执行以下操作来克服此问题。

1.  使用`-f`选项忽略更改。

如果要保存更改：

2.  在同一分支中本地提交更改，然后切换分支。
3.  使用`git stash`，切换分支，做你的工作，切换回原来的分支，然后做`git stash apply`。

# c - void** 在 ANSI-C 中是可接受的类型吗？

> ID：246280
> 
> 赞同：7
> 
> 时间：2008-10-29T09:59:27.570
> 
> 标签：c, void

我见过一个函数，其原型是：

```
int myfunc(void** ppt) 
```

此函数在 C 文件中调用为 a = myfunc(mystruct **var1);

其中 mystruct 是我们拥有的结构之一的 typedef。

这在 MSVC6.0 中没有任何编译错误，但是当我使用其他一些 C 编译器编译它时，它在调用此函数的位置出现错误并显示错误消息：

**mystruct ** 类型的参数与 void ** 类型的参数不兼容**

myfunc() 的参数保持为 void** 因为它似乎是一种通用的 malloc 函数，可以使用各种结构变量类型调用以进行内存分配

1.  C 标准/任何 C 编译器中是否允许有任何类型，例如 void **？
2.  我该如何解决？[我尝试将函数调用参数转换为`mystruct**`，但没有成功]

-广告

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-30T15:51:31.790

[comp.lang.c FAQ](http://c-faq.com/)在[问题 4.9](http://c-faq.com/ptrs/genericpp.html)中详细解决了这个问题。简而言之，他们说将任意指针指向 a**并不是严格可移植**`void **`的；他们继续解释说“这样的代码可能有效，有时也被推荐，但它依赖于具有相同内部表示的所有指针类型（这是常见的，但不是通用的）。” 他们继续解释说：“`void **`您使用的任何值都必须是`void *`某处实际值的地址；像`(void **)&dp`.

因此，您可以使用以下代码安全/便携地实现所需的行为：

```
some_type *var1 = foo();
void *tmp_void_ptr = (void *)var1;
myfunc(&tmp_void_ptr); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-29T10:03:33.850

`void**` *是*有效的，但根据您的错误消息，您可能必须显式转换参数，如下所示：

```
mystruct **var1;
x = myfunc ((void**) var1); 
```

那是因为该`myfunc`函数需要该`void**`类型。虽然`void*`可以隐式转换为任何其他指针，但对于双指针而言并非如此 - 您需要显式转换它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-29T10:44:15.483

`mystruct**`编译器无法自动从to 转换是有原因的`void**`。

考虑以下代码：

```
void stupid(struct mystruct **a, struct myotherstruct **b)
{
    void **x = (void **)a;
    *x = *b;
} 
```

编译器不会抱怨行中隐式转换 from `myotherstruct*`to ，即使`void*`该`*x = *b`行试图将指向 a 的指针`myotherstruct`放在只`mystruct`应放置指针的位置。

错误实际上在上一行，它将“指向可以放置指针的位置的指针`mystruct`”转换为“指向可以放置指向*任何东西*的指针的位置的指针”。*这*就是没有隐式强制转换的原因。当然，当您使用显式强制转换时，编译器会假定您知道自己在做什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-29T10:04:23.600

这个问题有点令人困惑。但是，是的，`void **`当然是合法有效的 C，并且意指“指向指针的指针`void`”，正如预期的那样。

我不确定您的调用示例，参数（“mystruct **var1”）没有意义。如果`var1`是 type `mystruct **`，调用应该只是 read `a = func(var1);`，这可能是一个错字。

转换应该可以工作，但您需要转换为`void **`，因为这是函数所期望的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-29T10:04:27.717

尽管看起来很脏：有时不使用 void ** 就无法解决问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-29T20:04:02.217

是的，`void **`在某些情况下完全可以接受并且非常有用。还要考虑到给定声明`void **foo`and `void *bar`，编译器将知道 foo 指向的对象的大小（它指向一个指针，并且所有指针的大小都相同，除了在一些您不必担心的古老平台上），但是它不会知道 bar 指向的对象的大小（它可以指向任何大小的对象）。因此，您可以安全地对`void **`指针而**不是**指针执行指针算术`void *`。您必须先将它们转换为其他东西，例如`char *`. GCC 将允许您假装它是等价的`void *`，`char *`每个都指向一个大小为单个字节的对象，但这是非标准且不可移植的。

# .net - 母版页上 id="end" 的 div 中断 .NET 验证

> ID：246289
> 
> 赞同：0
> 
> 时间：2008-10-29T10:03:50.043
> 
> 标签：.net, javascript, validation, webresource.axd

*快速信息：我正在使用最新版本的 .NET 2.0，以下是我为重现错误而编写的精简测试页。*

不包括标题位，（没有包含/内联 css 或 javascript）我的内容页面如下所示：

```
<asp:Content ID="Content1" ContentPlaceHolderID="cphMain" runat="server">
<div>
    <asp:ValidationSummary ID="ValidationSummary1" runat="server" />
    <asp:TextBox ID="txtStuff" runat="server"></asp:TextBox>
    <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" ControlToValidate="txtStuff" Display="None" ErrorMessage="need to fill it with words">  </asp:RequiredFieldValidator>
    <asp:Button ID="bClick" runat="server" Text="Kerlick" />
</div>
</asp:Content> 
```

我的母版页（不包括标题位）如下所示：

```
<body>
<form runat="server" id="Form1">
                <div>
                    <asp:ContentPlaceHolder ID="cphMain" runat="server">
                    </asp:ContentPlaceHolder>
                </div>
                <div id="end">

                </div>
</form>
</body> 
```

单击该按钮时，页面会在函数 **ValidationSummaryOnSubmit(validationGroup)中的****WebResource.axd中引发***“Microsoft JScript 运行时错误：对象不支持此属性或方法*”错误（第 512 行）。

 ****事实证明，如果我将**ID="end"**的 div 的 id 更改为 "end"以外的其他值，它可以解决问题。

现在，我已经解决了这个问题，但我很想知道为什么这首先会中断？

验证摘要是否有可能呈现具有相同 ID 的 div 并且在某处感到困惑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T13:14:20.750

一种确定的方法。

加载 firebug，调用 validationsummary 并浏览页面以查看添加了哪些新元素。

通常重复 ID 不会造成问题，而且您没有设置 runat 服务器，因此它不是服务器端控件。

很有意思

# c++ - c++ dynamic_cast 错误处理

> ID：246293
> 
> 赞同：24
> 
> 时间：2008-10-29T10:04:36.780
> 
> 标签：c++, dynamic-cast

是否有任何与 dynamic_cast 错误处理相关的良好做法（除非在您不需要时不使用它）？我想知道我应该如何处理它可以抛出的 NULL 和 bad_cast 。我应该检查两者吗？如果我捕捉到 bad_cast 或检测到 NULL，我可能无论如何都无法恢复……现在，我正在使用 assert 检查 dynamic_cast 是否返回非 NULL 值。你会在代码审查中接受这个解决方案吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-29T10:19:51.867

如果`dynamic_cast` *应该*成功，那么改用它是一个好习惯`boost::polymorphic_downcast`，它有点像这样：

```
assert(dynamic_cast<T*>(o) == static_cast<T*>(o));
return static_cast<T*>(o); 
```

这样，您将在调试构建中检测错误，同时避免发布构建中的运行时开销。

如果您怀疑强制转换*可能会*失败并且您想检测它，请使用`dynamic_cast`并强制转换为引用类型。如果出现错误，此演员将抛出`bad_cast`，并将取消您的程序。（这很好，如果你说，你无论如何都不会恢复）

```
T& t = dynamic_cast<T&>(o);
t.func(); //< Use t here, no extra check required 
```

`dynamic_cast`仅当 0 指针在上下文中有意义时才使用指针类型。您可能希望`if`像这样使用它：

```
if (T* t = dynamic_cast<T*>(o)) {
    t->func(); //< Use t here, it is valid
}
// consider having an else-clause 
```

使用最后一个选项，您需要确保如果`dynamic_cast`返回 0，则执行路径是有意义的。

直接回答你的问题：我更喜欢我给出的两个第一个替代方案之一，而不是`assert`在代码中有一个明确的:)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-29T10:21:21.363

bad_cast 仅在转换引用时抛出

```
dynamic_cast< Derived & >(baseclass) 
```

转换指针时返回 NULL

```
dynamic_cast< Derived * >(&baseclass) 
```

因此，无需同时检查两者。

断言是可以接受的，但这在很大程度上取决于上下文，再说一次，几乎每个断言都是如此......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-15T09:50:11.597

是和不是。

`boost::polymorphic_downcast<>``dynamic_cast<>`在调试阶段处理错误肯定是一个不错的选择。但是值得一提的是，只有在*可以预测编译时传递的多态类型*`polymorphic_downcast<>`时才应该使用它，否则应该使用 代替它。*`dynamic_cast<>`*

 *然而，一系列：

```
if (T1* t1 = dynamic_cast<T1*>(o)) 
{ }
if (T2* t2 = dynamic_cast<T2*>(o)) 
{ }
if (T3* t3 = dynamic_cast<T3*>(o)) 
{ } 
```

表示一个非常糟糕的设计，应该通过**多态性**和**虚函数**来解决。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-29T10:16:44.073

这取决于... ;-）

如果我真的希望`dynamic_cast`给我一些有用的东西，例如，如果我和其他人没有将多态类型添加到指向基类的指针的容器中，那么我将使用引用强制转换并让`std::bad_cast`我的应用程序终止 - 不会真的没什么可做的。

但是，如果我正在查询多态类型以获取它不一定必须实现的接口公开的某些功能，那么我会使用指针强制转换，然后 NULL 不会是错误（除非，当然，我希望这种能力*真的*存在——但后来我一开始就去找参考演员了……）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-29T10:21:36.013

我同意“视情况而定”的答案，并添加“优雅降级”：仅仅因为某个地方的演员表失败并不足以让应用程序失败（并且用户失去他/她的工作等）。我建议结合使用断言和防御性编程：

```
ptr = dynamic_cast<MyClass>(obj);
ASSERT(ptr);
if(ptr)
{
   // do stuff
} 
```

# visual-studio - Visual Studio 中是否有“便笺本”窗口

> ID：246295
> 
> 赞同：9
> 
> 时间：2008-10-29T10:04:55.517
> 
> 标签：visual-studio, visual-studio-2008

我目前使用记事本来为自己存储关于我的代码的小笔记。这通常是代码和要求的混合。

VS 中是否有一个“便笺簿”类型的窗口，我可以在其中执行此操作。

另一种选择是在源文件中使用代码注释块，但这并不是我想要的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-29T10:07:21.423

尝试添加便笺

[http://www.davidhayden.com/blog/dave/archive/2008/03/18/VisualStudio2008AddInStickyNotes.aspx](http://www.davidhayden.com/blog/dave/archive/2008/03/18/VisualStudio2008AddInStickyNotes.aspx)

[http://code.msdn.microsoft.com/StickyNotes](http://code.msdn.microsoft.com/StickyNotes)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T10:06:13.673

在“解决方案级别”上，您可以添加文件（文本、html 或代码）以充当注释文件。

同样在项目中，您可以添加文件，并将*Build Action*设置为*None*。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-29T10:08:35.663

大多数时候，我只是简单地在解决方案中添加一个 .txt 文件或滥用评论来做到这一点。但是，如果您使用便笺簿来存储待办事项列表等，您可以使用 TODO：在您的评论中，Visual Studio 会将它们添加到内置的待办事项列表中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-19T19:50:19.133

我刚刚发现 Visual Studio 支持 git 样式 .md 或 markdown：![.md 文件打开时 Visual Studio 的屏幕截图](https://i.stack.imgur.com/GeLSj.png)

这提供了存储注释、需求和开发人员说明（如自述文件）的好方法。

*   要使用：只需将文件添加到您的解决方案中，扩展名为 .md。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T10:59:26.697

我认为 Stick notes 不会支持 VS 2005。无论如何，WinDBG 摇滚。

# php - MySQL身份验证错误的原因：“用户'xxx'@'yyy'的访问被拒绝”？

> ID：246296
> 
> 赞同：2
> 
> 时间：2008-10-29T10:06:04.967
> 
> 标签：php, mysql, mysql-error-1045

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-29T10:14:13.780

Sometimes in php/mysql there is a difference between localhost and 127.0.0.1

In mysql you grant access based on the host name, for localusers this would be localhost. I have seen php trying to connect with 'myservername' instead of localhost allthough in the config 'localhost' was defined.

Try to grant access in mysql for 127.0.0.1 and connect in php over 127.0.0.1 port 3306.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T09:35:34.530

In case anyone’s still interested: I never did solve this particular problem. It really seems like the problem was with the hardware I was running MySQL on. I’ve never seen anything remotely like it since.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T10:38:24.310

After I read your update I would suspect an error in/with the password. Are you using "strange" characters in your PW (something likely to cause utf-8/iso encoding problems)?

Using % in the Host field would allow the user to connect from any host. So the only thing that could be wrong would be the password.

Can you create another user. whith the "grant all on all for '...'@'%' identiefied by 'somesimplepw'" syntax, and try to connect with that user? Don't forget to 'flush privelidges'

For info on how to create a new user klick [here](http://dev.mysql.com/doc/mysql/en/adding-users.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-20T18:19:25.543

Today the FTP service of my web hosting provider is having some trouble, so I decide to realize a local virtual webserver for working on my website. I have installed EasyPHP 14.1 with phpMyAdmin and I have created my user and my database with tables.

First attempt: failed. I realized that the table I was looking for didn't exist. -> I solved creating the missing table.

Second attempt: failed. I realized that username that I set for my new user was diffrent from the username I used for my connection. -> I edited username.

Third attempt: failed. I realized that new database name was diffrent from database name I use for connection in my site. -> I edited db name.

Forth attempt: failed. I realized that between privileges of my new user there wasn't "Grant". I don't even know what "Grant" means, but let's try to enable it -> Added "Grant" privilege.

Fifth attempt: I win!

I hope my little adventure could help someone. =)

# asp.net - 寻找允许连接到 RESTful Web 服务的报表设计器

> ID：246300
> 
> 赞同：0
> 
> 时间：2008-10-29T10:07:18.053
> 
> 标签：asp.net, web-services, rest, report

我正在寻找一个允许我连接到 RESTful Web 服务的报表设计器。理想情况下，我想要一个具有免版税最终用户报告设计器的设计器。我们将把它托管在一个 ASP.NET 网站上。所以与之兼容的东西将是理想的;）

我们曾经使用[Data Dynamics Active Reports](http://www.datadynamics.com/Products/ProductOverview.aspx?Product=ARNET3)。但是，这不允许连接到 Web 服务。

任何帮助，非常感谢。

提前致谢。

狡猾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T11:29:56.297

我不确定您要求可以连接到 Web 服务的报告生成器是什么意思。

Web 服务不是您可以报告的。它们只是数据的来源。你想连接什么，你希望得到什么数据？

RESTful Web 服务的问题是你不知道你会得到什么（没有数据库表的模式）。

RESTful Web 服务的好处是您可能会返回一些 XML，而您提到的 Active Reports 产品似乎可以处理 XML 文件。

“ActiveReports for .NET 3.0 支持许多基于 XML 的文件进行数据输入。”

凸轮您调用网络服务以获取您需要的信息并首先将其存储在一些文件（或数据库）中？

或者您本质上是在要求能够以某种相当复杂的方式查询 RESTful Web 服务并以某种结构化方式返回查询结果以便报表生成器可以使用的东西？

您是否考虑过特定​​的 RESTful Web 服务，如果有，您是否知道它们将以什么格式返回数据？那么您的问题实际上是关于可以处理该返回格式的报告生成器，也许。

还是别的什么，我错过了重点？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T12:11:19.020

保罗，

感谢您的回答，我将调查您提到的有关在 Datadynamics 报告中使用 XML 支持的内容。可能无法查询 RESTful Web 服务。我不确定，所以真的想检查一下。

RESTful Web 服务使用称为[WADL](http://en.wikipedia.org/wiki/Web_Application_Description_Language)文件的东西，意思是“Web 应用程序描述语言”。它等效于更传统的 SOAP 样式 Web 服务中使用的[WSDL文件。](http://en.wikipedia.org/wiki/Web_Services_Description_Language)我相信还有一种叫做[ATOM pub](http://en.wikipedia.org/wiki/ATOM)的东西，它是另一种描述语言。所以我在想一定有人写了一些东西让你可以查询其中一个描述语言？

我刚刚发现[Telerik 创新的 WYSIWYG 报表设计器](http://www.telerik.com/products/reporting/overview.aspx#0)支持 Web 服务。没有提到关于 RESTful 的任何事情。它确实说“您可以将 Telerik Reporting 数据绑定到业务对象、XML、**Web 服务**和任何 ADO.NET 数据源。” 所以也许还有希望。

如果有人知道与 RESTful Web 服务一起使用的工具，我仍然很想听听您的意见。

谢谢狡猾

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T14:52:30.740

事实证明你是对的。您可以使用 DataDynamics Active Reports 的 XML 端连接到静止的 Web 服务。

而不是将源指向驱动器上的物理文件：

c:\MyXMLFile.xml

您可以将其指向一个宁静的网络服务，例如我创建的一个：

[http://localhost:2734/Customer/34?format=xml](http://localhost:2734/Customer/34?format=xml)

这与本地 XML 文件的工作方式完全相同。只要 RESTful 网络服务实际上使用正确的 Content-Type 返回 xml：

```
HTTP/1.1 200 OK
Server: ASP.NET Development Server/9.0.0.0
Date: Thu, 30 Oct 2008 14:30:22 GMT
X-AspNet-Version: 2.0.50727
Transfer-Encoding: chunked
Cache-Control: private
Content-Type: text/xml; charset=utf-8
Connection: Close 
```

然后，这只是使用 XPath 和使用 XML 获得的所有常用东西来创建页眉和页脚等的一个例子。

# .net - 将键码转换为键字符

> ID：246306
> 
> 赞同：11
> 
> 时间：2008-10-29T10:09:57.737
> 
> 标签：.net

如何在 .NET 中将 keycode 转换为 keychar？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-29T10:12:20.743

在 VB.NET 中：

```
ChrW(70) 
```

在 C# 中，您可以强制转换：

```
(char) 70 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-08-05T13:47:10.843

我使用 user32.dll 中的库类解决了这个问题。我更喜欢框架类，但找不到一个，所以这对我有用。

```
Imports System.Runtime.InteropServices

Public Class KeyCodeToAscii

    <DllImport("User32.dll")> _
    Public Shared Function ToAscii(ByVal uVirtKey As Integer, _
                                   ByVal uScanCode As Integer, _
                                   ByVal lpbKeyState As Byte(), _
                                   ByVal lpChar As Byte(), _
                                   ByVal uFlags As Integer) _
                                   As Integer
    End Function

    <DllImport("User32.dll")> _
    Public Shared Function GetKeyboardState(ByVal pbKeyState As Byte()) _
      As Integer

    End Function

    Public Shared Function GetAsciiCharacter(ByVal uVirtKey As Integer) _
      As Char

        Dim lpKeyState As Byte() = New Byte(255) {}
        GetKeyboardState(lpKeyState)
        Dim lpChar As Byte() = New Byte(1) {}
        If ToAscii(uVirtKey, 0, lpKeyState, lpChar, 0) = 1 Then
            Return Convert.ToChar((lpChar(0)))
        Else
            Return New Char()
        End If
    End Function

End Class 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-12T20:24:51.317

我发现此代码段对于检测来自 enter 键的按键很有帮助：

```
Private Sub StartValue_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles StartValue.KeyPress
    If ChrW(13).ToString = e.KeyChar And StartValue.Text = "" Then
        StartValue.Text = "0"
    End If
End Sub 
```

我发现这是让人们尝试在文本框中提交空值的一个不错的解决方案。这只是强制一个 0，但它使用“检测输入被按下”来运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T11:17:41.020

尝试这个：

```
Char.ConvertFromUtf32(e.KeyValue) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-08T22:12:03.733

Convert.ToChar(Keys.Enter);

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-04-12T02:14:13.440

我似乎无法回复 DaveH，但如果你按照他说的去做，那就没问题了！

```
 Private Declare Function GetAsyncKeyState Lib "user32" (ByVal vKey As Long) As Integer
  Public sub harry()
    For i = 1 to 255
      If Chr(i) = Convert.ToChar(Keys.Enter) Then
          Label1.Text &= " [Enter] "
      ElseIf Chr(i) = Convert.ToChar(Keys.Delete) Then
          Label1.Text &= " [Delete] "
      End If
    Next i
  End Sub 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-11-07T14:15:41.603

这是我身边的一个例子:)

```
#region Just for fun :D

private string _lastKeys = "";

private readonly Dictionary<string, string[]> _keyChecker = _
    new Dictionary<string, string[]>
        {
            // Key code to press, msgbox header, msgbox text
            {"iddqd", new[] {"Cheater! :-)", "Godmode activated!"}},
            {"idkfa", new[] {"Cheater! :-)", "All Weapons unlocked!"}},
            {"aAa", new[] {"Testing", "Test!"}},
            {"aaa", new[] {"function", "close"}}
        };

private void KeyChecker(KeyPressEventArgs e)
{
    _lastKeys += e.KeyChar;

    foreach (var key in _keyChecker.Keys)
        if (_lastKeys.EndsWith(key))
            if (_keyChecker[key][0] != "function")
                MessageBox.Show(_keyChecker[key][1], _keyChecker[key][0]);
            else
                KeyCheckerFunction(_keyChecker[key][1]);

    while (_lastKeys.Length > 100)
        _lastKeys = _lastKeys.Substring(1);
}

private void KeyCheckerFunction(string func)
{
    switch (func)
    {
        case "close":
            Close();
            break;
    }
}

private void FormMain_KeyPress(object sender, KeyPressEventArgs e)
{
    KeyChecker(e);
}

#endregion Just for fun :D 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-12-05T16:07:41.853

在 VBA 或 Vb6 中：

从 Button 或其他发送 KeyCode 的元素上的 KeyPress 访问：

```
Private Sub Command1_KeyDown(KeyCode As Integer, Shift As Integer)
    Label1.Caption = """" & KeyCodeToUnicodeString(CLng(KeyCode)) & """"
End Sub 
```

在模块中复制以下代码：

```
Option Explicit
'VB6
Private Declare Function ToUnicode Lib "user32" (ByVal wVirtKey As Long, ByVal wScanCode As Long, lpKeyState As Byte, ByVal pwszBuff As String, ByVal cchBuff As Long, ByVal wFlags As Long) As Long
Private Declare Function GetKeyboardState Lib "user32" (pbKeyState As Byte) As Long

''VBA
'#If VBA7 And Win64 Then
'    'VBA7 And Win64
'    Private Declare PtrSafe Function GetKeyboardState Lib "user32" (pbKeyState As Byte) As Long
'    'must be tested, maybe Long has to be replaced by Integer for 64 bit:
'    Private Declare PtrSafe Function ToUnicode Lib "user32" (ByVal wVirtKey As Long, ByVal wScanCode As Long, lpKeyState As Byte, ByVal pwszBuff As String, ByVal cchBuff As Long, ByVal wFlags As Long) As Long
'#Else
'    'VBA 32 bit
'    Private Declare Function GetKeyboardState Lib "user32" (pbKeyState As Byte) As Long
'    Private Declare Function ToUnicode Lib "user32" (ByVal wVirtKey As Long, ByVal wScanCode As Long, lpKeyState As Byte, ByVal pwszBuff As String, ByVal cchBuff As Long, ByVal wFlags As Long) As Long
'#End If

'Returns the text of the KeyCode pressed depending of the Keyboard language
'Does not work on Win98 (returns "") but works well on winXP and onwards
Public Function KeyCodeToUnicodeString(KeyCode As Long) As String
    On Error GoTo KeyCodeToUnicodeString_End
    Dim ret As Long
    Dim keyBoardState(0 To 255) As Byte
    Dim buffer As String * 256
    ret = GetKeyboardState(keyBoardState(0))
    Dim i As Long

    'Special: This portion of code is important for the function to work properly after compilation.
    'Why I do not know, but if removed, the next call to ret = ToUnicode will make a OutOfMemory Error
    'because the keyBoardState array is not yet in a correct state.
    'Tried Sleep or Byte b = keyBoardState(i) within the loop,
    'but the only way to make it work properlyIN vb6 is coded here.
    'If used in VBA, this part of code may be removed
    Dim s As String
    For i = 0 To 255
        s = s & CStr(keyBoardState(i)) & "-"
    Next i
    'end of special portion of code

    If ret <> 0 Then
        ret = ToUnicode(KeyCode, 0, keyBoardState(0), buffer, Len(buffer), 0)
        buffer = StrConv(buffer, vbFromUnicode)
        If ret <> 0 Then
            On Error Resume Next
            KeyCodeToUnicodeString = Left(buffer, InStr(buffer, vbNullChar) - 1)
        Else
            KeyCodeToUnicodeString = ""
        End If
    End If
KeyCodeToUnicodeString_End:
End Function 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-07-17T11:42:13.867

String.fromCharCode(event.keyCode)

# c++ - c++类朋友

> ID：246315
> 
> 赞同：3
> 
> 时间：2008-10-29T10:17:49.220
> 
> 标签：c++, class, inheritance, friend

我正在尝试编译这样的代码：

```
#include <iostream>
using namespace std;

class CPosition
{
  private:
    int itsX,itsY;
  public:
    void Show();
    void Set(int,int);
};

void CPosition::Set(int a, int b)
{
  itsX=a;
  itsY=b;
}

void CPosition::Show()
{
    cout << "x:" << itsX << " y:" << itsY << endl;
}

class CCube
{
  friend class CPosition;
  private:
         CPosition Position;
};

main()
{
  CCube cube1;

  cube1.Position.Show();
  cube1.Position.Set(2,3);
  cube1.Position.Show();
} 
```

但 get 'CCube::Position' 在函数 main() 中无法访问 3 次。我希望在 CCube 之外声明 CPosition 类，以便将来可以在新类中使用它，例如 CBall :) 但是如何在不使用继承的情况下使其工作。是否可以 ：）？

问候，PK

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-29T12:32:49.680

除了普通的 getter，你还应该有一个 const getter。
请注意参考退货。这允许您对 SetXX() 的任何调用来影响 CCube 内的 Position 副本，而不是您一直在更新的副本。

```
class CCube
{
    private:
        CPosition Position;
    public:
        CPosition&       getPosition()       { return Position; }
        CPosition const& getPosition() const { return Position; }
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-29T10:20:45.250

该语句`friend class CPosition;`意味着 CPosition 现在可以访问 CCube 类的私有成员。对于其他每个班级，成员仍然像您声明的那样是私有的。要使示例工作，您需要：

```
class CCube
{
     public:
         CPosition Position;
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T10:20:09.543

errr，不，位置在函数“main”中不可见

将其公开...或将公共 getter 函数放入

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-29T10:25:55.427

你的朋友声明需要是

```
friend int main(); 
```

您正在授予访问 CCube 私有成员的“主要”权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-29T10:25:53.680

好吧，你已经得到了错误的答案。不过有一件事：您是否计划让多维数据集访问 CPosition 的私有成员（itsX、itsY）？如果不是，则不需要将其声明为朋友。如果是，请考虑在 CPosition 中公开公共方法以返回 X 和 Y，您仍然不需要将其声明为友元。

我的意思是你需要确保你需要使用朋友。这是一个[很好的起点](https://stackoverflow.com/questions/17434/when-should-you-use-friend-in-c)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-29T10:52:09.243

好的，它适用于：

```
class CCube
{
  private:
         CPosition Position;
  public:
  CPosition& getPosition() { return Position; }
};

main()
{
  CCube cube1;

  cube1.getPosition().Show();
  cube1.getPosition().Set(2,3);
  cube1.getPosition().Show();
} 
```

谢谢

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-29T11:09:31.750

你有3个问题：

1.  可重用性`CPosition`
2.  如何影响形状的状态（在这种情况下包括 type 的成员`CPosition`，但也可能包括 an`int radius`或其他）
3.  `friend`关键字的使用

您清楚地说您需要 CPosition 类才能从其他地方访问。嗯，就是上课。问题1解决了。

如果您希望您`CCube`的用户能够更改 a`CCube`的位置，您需要为此提供一种方法：

1.  通过`CCube::Position`公开
2.  通过添加访问器方法 -`CCube::MoveTo( const CPosition& p )`和`CCube::GetPosition() const`.

`friend`正如@Firas 所说：在你确定你需要它之​​前不要玩。

# .net - Open 和 Closed 仅仅是 ConnectionState 枚举的相关值吗？

> ID：246316
> 
> 赞同：3
> 
> 时间：2008-10-29T10:17:53.463
> 
> 标签：.net, connection

ConnectionState 枚举上的[MSDN 页面](http://msdn.microsoft.com/en-us/library/system.data.connectionstate.aspx)显示“此值保留用于产品的未来版本”，适用于除 Open 和 Closed 之外的所有值。这意味着什么？是否使用了其他值？

但是，从这个[StackOverflow 答案](https://stackoverflow.com/questions/103532/handling-different-connectionstates-before-opening-sqlconnection#103901)看来，也使用了 ConnectionState.Broken 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T14:34:28.360

在 Reflector 中呆了一段时间后，在我看来，Broken 和 Fetching 状态至少也用于一两个地方。最好的编码实践是假设可以使用任何值，并进行防御性编码。例如，如果您需要知道连接是否打开，请检查 state == Open，而不是 state != Closed。

# tsql - 如何在 SQL 中取消删除

> ID：246317
> 
> 赞同：10
> 
> 时间：2008-10-29T10:18:22.040
> 
> 标签：tsql, triggers

我想创建一个触发器来检查正在根据业务规则删除的内容，然后在需要时取消删除。有任何想法吗？

该解决方案使用了替代删除触发器。Rollback tran 停止了删除。我担心删除时会出现级联问题，但似乎没有发生。也许触发器不能自己触发。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-29T10:19:48.903

使用`INSTEAD OF DELETE`（请参阅[MSDN](http://msdn.microsoft.com/en-us/library/ms191208.aspx)）触发器并在触发器中决定您真正想要做什么。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-29T11:10:55.447

该解决方案使用了替代删除触发器。Rollback tran 停止了删除。我担心删除时会出现级联问题，但似乎没有发生。也许触发器不能自己触发。不管怎样，谢谢大家的帮助。

```
ALTER TRIGGER [dbo].[tr_ValidateDeleteForAssignedCalls]
on [dbo].[CAL]
   INSTEAD OF DELETE
AS 
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    DECLARE @RecType VARCHAR(1)
    DECLARE @UserID VARCHAR(8)
    DECLARE @CreateBy VARCHAR(8)
    DECLARE @RecID VARCHAR(20)

    SELECT @RecType =(SELECT RecType FROM DELETED)
    SELECT @UserID =(SELECT UserID FROM DELETED)
    SELECT @CreateBy =(SELECT CreateBy FROM DELETED)
    SELECT @RecID =(SELECT RecID FROM DELETED)

     -- Check to see if the type is a Call and the item was created by a different user
    IF @RECTYPE = 'C' and not (@USERID=@CREATEBY)

    BEGIN
        RAISERROR ('Cannot delete call.', 16, 1)
        ROLLBACK TRAN
        RETURN
    END

     -- Go ahead and do the update or some other business rules here
    ELSE
        Delete from CAL where RecID = @RecID    

END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T10:49:16.457

触发器可以回滚当前事务，具有取消删除的效果。正如上面的海报还指出的那样，您也可以使用代替触发器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-29T10:59:14.173

根据有关`INSTEAD OF DELETE`触发器的 MSDN 文档：

> 发送到 DELETE 触发器的已删除表包含在发出 DELETE 语句之前存在的行的图像。

如果我理解正确，则 DELETE 实际上正在执行。我错过了什么？

无论如何，我不明白您为什么要删除记录，如果业务规则未通过，则取消删除这些记录。我会发誓，如果您在删除记录之前通过了业务规则，应该更容易测试。

我会说使用事务，我以前没有听说过`INSTEAD OF`触发器。

# c# - 在 C# 中检索 RETURN @@IDENTITY 的值

> ID：246321
> 
> 赞同：3
> 
> 时间：2008-10-29T10:19:26.377
> 
> 标签：c#, .net, ado.net

这是一个非常简单的问题。我有一个 SP，它在表中插入一行，最后有语句 RETURN @@IDENTITY。我似乎找不到在 C# 中检索此值的方法。我正在使用企业库并使用以下方法：

```
db.ExecuteNonQuery(cmd); 
```

我试过**cmd.Parameters[0].Value**来获取值，但它总是返回 0。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-29T10:27:00.510

顺便说一句，在大多数情况下，您应该使用 SCOPE_IDENTITY() 而不是 @@IDENTITY。[参考](http://msdn.microsoft.com/en-us/library/aa259185.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-29T10:22:23.390

```
Dim c as new sqlcommand("...")

Dim d As New SqlParameter()
d.Direction = ParameterDirection.ReturnValue
c.parameters.add(d)

c.executeNonQuery

(@@IDENTITY) = d.value 
```

它或多或少像这样......要么这样，要么只是从存储过程中返回值作为输出参数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-29T10:30:42.687

有一点要提。您应该真正使用 SCOPE_IDENTITY 在 INSERT 之后返回标识值。@@IDENTITY 有可能返回错误的值。特别是在使用 TRIGGERS 时，在 INSERT 之后将值写入其他表。

有关详细信息，请参阅[联机丛书](http://msdn.microsoft.com/en-us/library/ms190315.aspx)页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T10:49:59.083

有人说用

IDENT_CURRENT('表名')

[http://www.velocityreviews.com/forums/t303448-return-identity-after-sql-insert.html](http://www.velocityreviews.com/forums/t303448-return-identity-after-sql-insert.html)

-祖拜尔 [http://zubairdotnet.blogspot.com](http://zubairdotnet.blogspot.com)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-29T10:32:11.467

听起来你想用标量值执行

```
SqlCommand.ExecuteScalar() 
```

正如其他人提到的，我认为使用 SCOPE_IDENTITY() 比 @@IDENTITY 变量更安全

# wix - 如何从命令行选择功能

> ID：246329
> 
> 赞同：36
> 
> 时间：2008-10-29T10:21:26.403
> 
> 标签：wix

这可能是一个幼稚的问题。我必须手动编辑 .WXS 文件以使其支持从命令行选择功能。

例如，.WXS 文件中有 3 个特征。

```
<Feature Id="AllFeature" Level='1'>

    <Feature Id="Feature1" Level='1'> </Feature>

    <Feature Id="Feature2" Level='1'> </Feature>

    <Feature Id="Feature3" Level='1'> </Feature>

</Feature> 
```

现在，我想从命令行中选择功能。比如说，如果我输入“msiexec /i install.msi FEATURE=A”，那么会安装“Feature1”和“Feature2”；如果我键入“msiexec/i install.msi FEATURE=B”，则安装“Feature1”和“Feature3”。在这种情况下，“A”映射到特征 1 和 2；“B”映射到特征 1 和 3。

如何在 WIX 中实现这一点？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-01-21T01:52:51.373

接受的答案已经提到了 ADDLOCAL 属性，但似乎暗示您只能选择一个功能。实际上，您可以通过用逗号分隔它们来选择多个功能，如下所示：

```
msiexec /i install.msi ADDLOCAL=Feature1,Feature2 
```

或者

```
msiexec /i install.msi ADDLOCAL=Feature2,Feature3 
```

[另一个提示：您可以通过使用orca](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370557(v=vs.85).aspx)打开 msi 来发现这些功能名称。当您想使用这些技巧创建安装第三方 msi 包的某些功能的引导程序时，这非常有用。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-10-29T14:06:49.257

我会将 Feature1、Feature2 和 Feature3 更改为组件，然后声明如下内容：

```
<Feature Id="FEATUREA" Title="Super" Level="1" >
  <ComponentRef Id="Component1" />
  <ComponentRef Id="Component2" />
</Feature>

<Feature Id="FEATUREB" Title="Super1" Level="1" >
  <ComponentRef Id="Component1" />
  <ComponentRef Id="Component3"/>
</Feature> 
```

然后安装 FeatureA 或 FeatureB

```
msiexec /i install.msi ADDLOCAL=[FEATUREA | FEATUREB] 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-29T15:37:39.293

有许多属性可以控制功能的安装状态。查看此 MSI SDK 文档及其链接：http: [//msdn.microsoft.com/en-us/library/aa367536 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa367536(VS.85).aspx)

# build-process - 如何在 Visual Build Professional 中构建迭代的用户定义动作？

> ID：246338
> 
> 赞同：1
> 
> 时间：2008-10-29T10:24:24.853
> 
> 标签：build-process, build-automation, extensibility, visual-build-professional

在 VBP 中，可以通过创建自定义 COM 组件或自定义脚本来定义用户定义的操作。

我需要创建一个用户定义的操作*iterative*，这意味着它必须以迭代方式调用子步骤，就像内置操作的“流程文件”一样。

我不知道如何做到这一点，谷歌也没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T10:39:32.577

自己在[kinook 论坛](http://www.kinook.com/Forum/showthread.php?s=fb5c520b09c9816440e0f8a796f5d9e1&threadid=535&highlight=user+defined+action)上找到了答案：

无法定义迭代的用户定义操作，但可以通过在循环控制步骤中定义条件构建规则来使用解决方法。

# wix - '&' 和 '!' 是什么意思 在属性名称之前？

> ID：246357
> 
> 赞同：5
> 
> 时间：2008-10-29T10:38:29.787
> 
> 标签：wix

我正在阅读其他人编写的 WIX 脚本。有一些代码真的让我很困惑。

```
<Custom Action='UnLoadSchedulerPerfCounters' After='InstallInitialize'>
    <![CDATA[(Installed) AND (!Scheduler = 3)]]>
</Custom>
<Custom Action='RollbackSchedulerPerfCounters' After='WriteRegistryValues'>
        <![CDATA[(&Scheduler = 3)]]>
</Custom> 
```

`!Scheduler`那么，和有什么区别`&Scheduler`呢？`&`当属性以or为前缀时有什么特殊含义`!`吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-29T11:01:36.120

来自[http://www.tramontana.co.hu/wix/lesson5.php#5.3](http://www.tramontana.co.hu/wix/lesson5.php#5.3)：

> 在名称前添加一些特殊字符将赋予它们额外的含义：
> 
> ```
> %     environment variable (name is case insensitive)
> $     action state of component
> ?     installed state of component
> &     action state of feature
> !     installed state of feature 
> ```
> 
> 最后四个可以返回以下整数值：
> 
> ```
> -1   no action to be taken
> 1    advertised (only for components)
> 2    not present
> 3    on the local computer
> 4    run from the source 
> ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-29T15:39:50.880

这些是 Windows Installer 条件语法上的运算符。有关完整列表，请参阅此 MSI SDK 文档：http: [//msdn.microsoft.com/en-us/library/aa368012.aspx](http://msdn.microsoft.com/en-us/library/aa368012.aspx)。

# .net - 如何对 IDisposable 进行单元测试？

> ID：246364
> 
> 赞同：10
> 
> 时间：2008-10-29T10:40:03.760
> 
> 标签：.net, unit-testing, garbage-collection, idisposable

我正在研究一段库代码`IDisposable`。托管路径 (via `using`) 易于测试。不过，我想知道终结器：调用[`System.GC.Collect()`](http://msdn.microsoft.com/en-us/library/xe0c2357.aspx)足以强制终结器运行吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-29T10:45:54.730

不，GC.Collect() 调用是异步的，您还需要调用它：

```
System.GC.WaitForPendingFinalizers(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T18:45:23.137

我会看一下[Dispose、Finalization 和 Resource Management，](http://www.bluebytesoftware.com/blog/PermaLink.aspx?guid=88e62cdf-5919-4ac7-bc33-20c06ae539ae) 它是我所知道的主题的最佳参考。使用他们的模式：

```
~ComplexCleanupBase()
{
    Dispose(false);
}

public void Dispose()
{
    Dispose(true);
    GC.SuppressFinalize(this);
}

protected override void Dispose(bool disposing)
{
   if (!disposed)
   {
        if (disposing)
        {
            // dispose-only, i.e. non-finalizable logic
        }

        // new shared cleanup logic
        disposed = true;
    }

    base.Dispose(disposing);
} 
```

你最终得到了简单的 Finalizer/Dispose() 方法和一个可测试的 Dispose(bool)。无需强制终结或使用 GC 类的任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T10:43:09.090

你能模拟出一个`IDisposable`接口并期待调用`Dispose`吗？这至少可以让您看到对象何时被实际处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T21:31:04.057

我想我会倾向于让 Finalize() 调用另一种方法，并测试另一种方法是否符合您的要求。您不会获得 100% 的代码覆盖率，但至少您会知道该方法正确地释放了对象的资源。

# internet-explorer - 如何通过自动化在 IE 中管理全屏？（Flash 播放器之类的）

> ID：246365
> 
> 赞同：1
> 
> 时间：2008-10-29T10:40:36.363
> 
> 标签：internet-explorer, automation, fullscreen

我遇到了 IE7 全屏模式的问题。

有一个应用程序位于 IE 中嵌入的 activeX 中。在 IE6 之前，我们通过以下方式管理全屏

> IWebBrowser2::put_FullScreen(bool bIsFull) 这很好。

但是从 IE7 开始，这个技巧似乎被弃用了，因为它在从全屏返回的过程中失去了标签栏。

一种解决方案是调用

> IWebBrowser2::put_TheaterMode(bool bIsFull) 这似乎是 IE7 在抚摸 F11 时所做的

但这不是我想要的，因为标签和地址栏处于自动隐藏模式

所以我想实现一个真正的全屏模式，就像在 Flash 中为全屏 youtube 视频所做的那样。

你知道有什么方法可以实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T10:43:21.430

Flash 不使用浏览器进入全屏模式，它通过调用本机操作系统库来实现。

# iis - 如何以编程方式（在 vbscript 中）更改/设置 IIS 下站点的 tcp 端口？

> ID：246367
> 
> 赞同：3
> 
> 时间：2008-10-29T10:43:10.807
> 
> 标签：iis, vbscript

我的编程环境包括用于在干净的机器上设置我的自动构建的脚本。

一个步骤使用 vbscript 在 IIS 上配置用于监视构建的网站。

在一台特定的机器上，我将在端口 80 上运行 apache 来完成一个单独的任务。

我希望我的 vbscript 为它正在添加的新站点将端口设置为 8080。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T10:46:18.397

您将需要使用 WMI 或 ADSI 添加主机标头

[http://www.adopenstatic.com/cs/blogs/ken/archive/2006/07/28/188.aspx](http://www.adopenstatic.com/cs/blogs/ken/archive/2006/07/28/188.aspx)

那里的代码摘录（稍作编辑）

```
 Dim objWebApp
    Dim intArraySize
    Dim arrOldBindings
    Dim arrNewBindings

```
Set objWebApp = GetObject("IIS://localhost/w3svc/" WebSiteID)

If isArray(objWebApp.ServerBindings) then

arrOldBindings = objWebApp.ServerBindings
    intArraySize = UBound(arrOldBindings)
    Redim arrNewBindings(intArraySize + 1)

    For i = 0 to intArraySize
    arrNewBindings(i) = arrOldBindings(i)
    Next

arrNewBindings(intArraySize + 1) = ":mydomain.com:8080:"

    objWebApp.Put "ServerBindings", (arrNewBindings)
    objWebApp.SetInfo

End If 
``` 
            回答 #2

赞同：2

时间：2008-10-29T10:57:50.557

您可以使用`adsutil.vbs`IIS 管理脚本的一部分来更改：

```
cscript adsutil.vbs 设置 W3SVC/1/ServerBindings “:8080:”

```

在默认布局中，脚本位于`C:\Inetpub\AdminScripts\`.

        web-services - 在 JAX-WS RI 中创建了多少 Web 服务对象？

ID：246383

赞同：1

时间：2008-10-29T10:48:39.093

标签：web-services, jax-ws, java-metro-framework

当我使用“@WebService”注释 Java 类并将其与 JAX-WS RI（“Metro”）一起使用时，JAX-WS RI 创建了我的类的多少对象？是否始终最多有一个对象，或者（可能取决于使用情况）是否可以创建更多实例？

            回答 #1

赞同：1

时间：2009-06-14T15:02:55.163

JAX-WS 标准是否指定了这一点？

我希望这与 Servlet 非常相似，标准并没有说明服务器只是为应用程序创建一个 Servlet 对象，或者为每个请求创建一个。如果是这样，那么您不应该构建您的程序，以便它对 JAX-WS 实现的工作方式做出假设。

这就是我推荐的任何一种方式：编写代码，使这个问题没有实际意义。这样您就可以确定自己不会遇到意外，即使新的实现碰巧做不同的事情，您也可以将 Metro 换成其他东西。

        c# - Ms-Chart 标签格式问题

ID：246384

赞同：2

时间：2008-10-29T10:48:49.780

标签：c#, formatting, mschart

我用新的 Ms 图表控件创建了一个 PieChart。如何格式化标签（饼图中的点值），如下所示：“LabelName AbsoluteValue（百分比）”？例如：“美国 856027 (56 %)”。

这是否可能仅在 LabelFormat 中使用正确的格式信息（如何？）还是我必须使用自定义标签格式（如何？）？

非常感谢！

鲁珀特·兰德

            回答 #1

赞同：6

时间：2009-05-27T19:42:42.943

您可以在标签属性中包含关键字，可以在 GUI（通过系列集合编辑器）或代码中设置。我建议通过 GUI 设置它，因为它不需要完全了解可用的关键字。如果您想在代码中设置它，它看起来与此类似（假设我了解您请求的格式）`Chart.Series(0).Label = "#ValX #Val (#ValPercentY{P0})"`：.

        c# - VS2008 中 C# 问题的快速修复

ID：246389

赞同：0

时间：2008-10-29T10:49:26.720

标签：c#, visual-studio-2008

VisualStudio 2008 中是否有类似 Eclipse IDE 中的 Quickfix 之类的东西？

谢谢，

大神

            回答 #1

赞同：2

时间：2008-10-29T10:53:06.700

Ctrl-Period 会做各种事情（使用指令添加）等，但 VS2008 本身并没有做很多事情。我推荐[ReSharper](http://www.jetbrains.com/resharper/)，它有更多这样的功能。

        java - 如何在允许编辑 JTable 中的给定行之前进行检查

ID：246395

赞同：0

时间：2008-10-29T10:53:09.630

标签：java, swing, jtable

这个问题很基本。我有一个 JTable 显示来自数据库的缓存数据。如果用户单击单元格进行编辑，我想尝试锁定数据库中的该行。如果锁定不成功，我想阻止编辑。

但我似乎找不到任何干净的方法来实现这一点。我错过了什么吗？

            回答 #1

赞同：2

时间：2008-10-29T12:49:38.257

在编辑/设置值之前，表格模型通过 TableModel.isCellEditable(row,col) 询问此单元格是否可编辑。在这里你可以实现你的锁。在 TableModel.setValue(row,col,val) 之后，您应该解锁它。但。锁定操作应该会花费大量时间，并使您的 UI 不负责任。而且它很糟糕。尝试不同的方法。懒惰失败怎么办？您锁定该行，检查数据的有效性，如果数据较新，则失败。如果数据没问题，你就把它们放下。开锁。

            回答 #2

赞同：1

时间：2008-10-29T11:52:08.483

Oracle 有一个很好的方法来处理这个问题，但我不知道它的普遍适用性如何。

在 Oracle 中，您可以在 SELECT 语句上使用**FOR UPDATE**在读取记录时锁定它。

例如，如果您要获取一行进行显示：

```
select * into v_row from my_table where my_table_id = 1
for update; 
```

这将允许读取但阻止更新。如果另一个事务有锁，您的事务将等待它变得可用（或最终超时）。如果您希望语句在尝试锁定时抛出异常，请添加**NOWAIT**。

```
select * into v_row from my_table where my_table_id = 1
for update nowait; 
```

如果该行已被锁定，您将获得：

```
ORA-00054: resource busy and acquire with NOWAIT specified. 
```

希望有帮助。

            回答 #3

赞同：0

时间：2008-10-29T11:25:41.873

因为您必须在单击时进行测试，所以您不能使用模型的方式来执行此操作，因此您应该尝试覆盖 JTable 的[public void changeSelection(int rowIndex, int columnIndex, boolean toggle, oolean extend)](http://java.sun.com/javase/6/docs/api/javax/swing/JTable.html)方法。如果该行被锁定，则不要调用 super.changeSelection 并且它应该保持该行未选中。

            回答 #4

赞同：0

时间：2008-10-29T16:53:53.413

相反，您可以等到用户实际更改某些内容，然后覆盖 JTable.editingStopped 以在那里完成工作（您甚至可以检查值是否已更改）

这样，在用户实际更改某些内容之前，不会进行锁定。

        apache - 运行 index.php 而不是列出文件

ID：246398

赞同：3

时间：2008-10-29T10:55:16.053

标签：apache, .htaccess

我最近重新安装了 MacOSX，并且在某个时候（没有意识到）我做了它，以便没有 index.html 的目录会尝试运行 index.php。这已经停止工作。我的 localhost 可以正常运行 .php 文件；除非您明确告诉它，否则它不会这样做。

网上有很多 htaccess 指南，但我实际上找不到告诉我如何解决这个问题的指南：s

            回答 #1

赞同：8

时间：2008-10-29T10:57:32.413

我相信 .htaccess 中的“DirectoryIndex index.php”指令可以解决问题。

        php - Symfony 应用程序 - 如何将计算字段添加到 Propel 对象？

ID：246400

赞同：5

时间：2008-10-29T10:56:19.017

标签：php, orm, symfony1, propel

使用 Propel 对象的计算字段的最佳方法是什么？

假设我有一个对象“客户”，它有一个对应的表“客户”，每一列对应于我的对象的一个​​属性。我想做的是：在我的对象上添加一个计算属性“已完成订单数”，而不是在视图 B 和 C 上使用它。

计算的属性是通过 ID 链接到我的“客户”对象的“订单”对象的 COUNT()。

我现在可以做的是首先选择所有客户对象，然后迭代地计算所有这些对象的订单，但我认为在单个查询中这样做会提高性能。但我无法正确“水合”我的 Propel 对象，因为它不包含计算字段的定义。

你会如何处理它？

            回答 #1

赞同：3

时间：2008-10-29T15:30:53.237

有几种选择。首先，是在您的数据库中创建一个可以为您计算的视图，类似于我[在此处](https://stackoverflow.com/questions/234785/#235267)的回答。我为我正在处理的当前 Symfony 项目执行此操作，其中给定表的只读属性实际上比表本身宽得多。这是我的建议，因为分组列（max()、count() 等）无论如何都是只读的。

其他选项是将此功能实际构建到您的模型中。你绝对可以自己做这种补水，但这有点复杂。这是粗略的步骤

1.  将列添加到*Table*类中作为受保护的数据成员。
2.  为这些列编写适当的 getter 和 setter
3.  覆盖 hydrate 方法并在其中使用来自其他查询的数据填充新列。确保调用 parent::hydrate() 作为第一行

但是，这并不比您已经在谈论的要好得多。您仍然需要*N* + 1 个查询来检索单个记录集。但是，您可以在第 3 步中发挥创意，使*N*是计算的列数，而不是返回的行数。

*另一种选择是在您的Table* Peer 类上创建自定义选择方法。

1.  从上面执行步骤 1 和 2。
2.  编写您将通过 Propel::getConnection() 过程手动查询的自定义 SQL。
3.  通过迭代结果集手动创建数据集，并在此时处理自定义水合，以免在 doSelect 进程使用时破坏水合。

这是这种方法的一个示例

```
<?php

class TablePeer extends BaseTablePeer
{
    public static function selectWithCalculatedColumns()
    {
        //  Do our custom selection, still using propel's column data constants
        $sql = "
            SELECT " . implode( ', ', self::getFieldNames( BasePeer::TYPE_COLNAME ) ) . "
                 , count(" . JoinedTablePeer::ID . ") AS calc_col
              FROM " . self::TABLE_NAME . "
              LEFT JOIN " . JoinedTablePeer::TABLE_NAME . "
                ON " . JoinedTablePeer::ID . " = " . self::FKEY_COLUMN
        ;

        //  Get the result set
        $conn   = Propel::getConnection();
        $stmt   = $conn->prepareStatement( $sql );
        $rs = $stmt->executeQuery( array(), ResultSet::FETCHMODE_NUM );

        //  Create an empty rowset
        $rowset = array();

        //  Iterate over the result set
        while ( $rs->next() )
        {
            //  Create each row individually
            $row = new Table();
            $startcol = $row->hydrate( $rs );

            //  Use our custom setter to populate the new column
            $row->setCalcCol( $row->get( $startcol ) );
            $rowset[] = $row;
        }
        return $rowset;
    }
} 
```

您的问题可能还有其他解决方案，但它们超出了我的知识范围。祝你好运！

            回答 #2

赞同：1

时间：2009-03-23T21:16:10.447

我现在在一个项目中通过覆盖 hydrate() 和 Peer::addSelectColumns() 来访问 postgis 字段：

```
// in peer
public static function locationAsEWKTColumnIndex()
{
    return GeographyPeer::NUM_COLUMNS - GeographyPeer::NUM_LAZY_LOAD_COLUMNS;
}

public static function polygonAsEWKTColumnIndex()
{
    return GeographyPeer::NUM_COLUMNS - GeographyPeer::NUM_LAZY_LOAD_COLUMNS + 1;
}

public static function addSelectColumns(Criteria $criteria)
{
    parent::addSelectColumns($criteria);
    $criteria->addAsColumn("locationAsEWKT", "AsEWKT(" . GeographyPeer::LOCATION . ")");
    $criteria->addAsColumn("polygonAsEWKT", "AsEWKT(" . GeographyPeer::POLYGON . ")");
}
// in object
public function hydrate($row, $startcol = 0, $rehydrate = false)
{
    $r = parent::hydrate($row, $startcol, $rehydrate);
    if ($row[GeographyPeer::locationAsEWKTColumnIndex()])   // load GIS info from DB IFF the location field is populated. NOTE: These fields are either both NULL or both NOT NULL, so this IF is OK
    {
        $this->location_ = GeoPoint::PointFromEWKT($row[GeographyPeer::locationAsEWKTColumnIndex()]); // load gis data from extra select columns See GeographyPeer::addSelectColumns().
        $this->polygon_ = GeoMultiPolygon::MultiPolygonFromEWKT($row[GeographyPeer::polygonAsEWKTColumnIndex()]); // load gis data from extra select columns See GeographyPeer::addSelectColumns().
    }   
    return $r;
} 
```

AddAsColumn() 有一些愚蠢的地方，但我现在不记得了，但这确实有效。您可以[阅读有关 AddAsColumn() 问题的更多信息](http://propel.phpdb.org/trac/ticket/681)。

            回答 #3

赞同：1

时间：2010-03-26T13:21:22.423

这是我在没有任何其他查询的情况下解决此问题的方法：

**问题**

需要将自定义 COUNT 字段添加到与 Symfony Pager 一起使用的典型结果集中。但是，正如我们所知，Propel 不支持此功能。所以简单的解决方案是在模板中做这样的事情：

```
foreach ($pager->getResults() as $project):

 echo $project->getName() . ' and ' . $project->getNumMembers()

endforeach; 
```

Where为每个对象`getNumMembers()`运行一个单独的 COUNT 查询。`$project`当然，我们知道这是非常低效的，因为您可以通过将其作为列添加到原始 SELECT 查询中来动态执行 COUNT，为显示的每个结果保存一个查询。

我有几个不同的页面显示这个结果集，都使用不同的标准。因此，直接用 PDO 编写我自己的 SQL 查询字符串会太麻烦，因为我必须进入 Criteria 对象并试图根据其中的任何内容来形成查询字符串！

所以，我最终所做的一切都避免了，让 Propel 的本机代码与 Criteria 一起工作并像往常一样创建 SQL。

1 - 首先在由 doSelect() 返回的模型对象中创建 [get/set]NumMembers() 等效访问器/修改器方法。请记住，访问器不再执行 COUNT 查询，它只是保存它的值。

2 - 进入对等类并覆盖父 doSelect() 方法，并完全复制其中的所有代码

3 - 删除此位，因为 getMixerPreSelectHook 是基本对等点的私有方法（或者如果需要，将其复制到对等点）：

```
// symfony_behaviors behavior
foreach (sfMixer::getCallables(self::getMixerPreSelectHook(__FUNCTION__)) as $sf_hook)
{
  call_user_func($sf_hook, 'BaseTsProjectPeer', $criteria, $con);
} 
```

4 - 现在将您的自定义 COUNT 字段添加到对等类中的 doSelect 方法：

```
// copied into ProjectPeer - overrides BaseProjectPeer::doSelectJoinUser()
public static function doSelectJoinUser(Criteria $criteria, ...)
{
   // copied from parent method, along with everything else
   ProjectPeer::addSelectColumns($criteria);
   $startcol = (ProjectPeer::NUM_COLUMNS - ProjectPeer::NUM_LAZY_LOAD_COLUMNS);
   UserPeer::addSelectColumns($criteria);

   // now add our custom COUNT column after all other columns have been added
   // so as to not screw up Propel's position matching system when hydrating
   // the Project and User objects.
   $criteria->addSelectColumn('COUNT(' . ProjectMemberPeer::ID . ')');

   // now add the GROUP BY clause to count members by project
   $criteria->addGroupByColumn(self::ID);

   // more parent code

   ...

   // until we get to this bit inside the hydrating loop:

   $obj1 = new $cls();
   $obj1->hydrate($row);

   // AND...hydrate our custom COUNT property (the last column)
   $obj1->setNumMembers($row[count($row) - 1]);

   // more code copied from parent

   ...

   return $results;         
} 
```

就是这样。现在，您将额外的 COUNT 字段添加到您的对象中，而无需在吐出结果时执行单独的查询来获取它。此解决方案的唯一缺点是您必须复制所有父代码，因为您需要在其中添加位。但在我的情况下，这似乎是保存所有这些查询而不是编写我自己的 SQL 查询字符串的一个小妥协。

            回答 #4

赞同：0

时间：2008-10-29T14:00:11.780

将属性“orders_count”添加到客户，然后编写如下内容：

```
class Order {
...
  public function save($conn = null) {
    $customer = $this->getCustomer();
    $customer->setOrdersCount($customer->getOrdersCount() + 1);
    $custoner->save();
    parent::save();
  }
...
}
```

您不仅可以使用“保存”方法，而且想法保持不变。不幸的是，Propel 不支持这些领域的任何“魔法”。

            回答 #5

赞同：0

时间：2008-10-30T16:58:48.177

Propel 实际上是根据链接字段的名称构建了一个自动函数。假设您有这样的架构：

```
customer:
  id:
  name:
  ...

order:
  id:
  customer_id: # links to customer table automagically
  completed: { type: boolean, default false }
  ... 
```

当您构建模型时，您的 Customer 对象将具有一个 getOrders() 方法，该方法将检索与该客户关联的所有订单。然后，您可以简单地使用 count($customer->getOrders()) 来获取该客户的订单数量。

缺点是这也会获取和水合这些 Order 对象。在大多数 RDBMS 上，提取记录或使用 COUNT() 之间的唯一性能差异是用于返回结果集的带宽。如果该带宽对您的应用程序来说很重要，您可能希望在 Customer 对象中创建一个方法，该方法使用 Creole 手动构建 COUNT() 查询：

```
 // in lib/model/Customer.php
  class Customer extends BaseCustomer
  {
    public function CountOrders()
    {
      $connection = Propel::getConnection();
      $query = "SELECT COUNT(*) AS count FROM %s WHERE customer_id='%s'";
      $statement = $connection->prepareStatement(sprintf($query, CustomerPeer::TABLE_NAME, $this->getId());
      $resultset = $statement->executeQuery();
      $resultset->next();
      return $resultset->getInt('count');
    }
    ...
  } 
```

        database-design - 您总是在杀手级 应用程序中使用的数据库表/字段

ID：246401

赞同：5

时间：2008-10-29T10:56:44.727

标签：database-design, web-applications

我希望在这里利用一些集体经验，那么**您在数据库设计中总是包含哪些（如果有）实用程序表或常用字段？**

一个例子是我总是包含一个`App_Errors`表来存储任何未捕获的异常信息，以及一个`App_Audit`存储所有编辑信息的表。

我已经（在我自己的脑海中）讨论了在每个数据表中包含`RecordCreatedDate`和的好处，`RecordLastEditedDate`但对于这些信息是否真的有用，我没有得出任何结论。

给这个问题更多的方向 - 我目前的重点是全球可访问的网络应用程序（想想社交网络）。

塔！

            回答 #1

赞同：9

时间：2008-10-29T10:59:52.473

1 包含版本号的表，因此应用程序可以轻松检查架构的版本。

2 保存任意变量/值对的表，如配置文件，但在数据库中。（你可以把版本号放在这里....）

            回答 #2

赞同：6

时间：2008-10-29T11:06:02.773

我经常使用**审计日志表**来跟踪更改了哪些数据以及由谁更改。

你会惊讶于它经常带来巨大的好处。

在我处理的几乎每个数据模型中出现的其他内容是**状态表**的变体，通常与主要实体的状态生命周期有关。

            回答 #3

赞同：2

时间：2008-10-29T11:01:11.767

每个表，不管它做什么，总是以一个“ID”字段开头，int。

我还保存了一个错误表，其中包括 ID、日期时间、失败的方法和重载，以及堆栈跟踪（如果有）。

有时我有一个设置/统计表，但并非总是如此。

            回答 #4

赞同：1

时间：2008-10-29T12:08:37.403

对于报告，一个数字表（从 0 到 1Mil 的整数）和一个静态日期表（相当于 30 年的天数）。

            回答 #5

赞同：0

时间：2009-01-20T06:42:03.973

我倾向于总是有一个表格列出所有可以访问系统的用户。出于连接池的原因，我更喜欢为每个人创建单独的数据库用户。

然后通常有一个表格列出人们在系统中可以拥有的角色。连接表指示允许谁做什么。对于业务领域中特定于应用程序的规则，此设置通常会变得更加复杂。

审计表是一个非常好的主意。我包括一个人类可读的列，以便非技术人员有机会弄清楚发生了什么，以及存储各种键和重要值。

            回答 #6

赞同：0

时间：2008-10-29T11:07:54.017

包含错误代码、技术消息、用户消息、严重性和备注列的错误消息表。严重性和用户消息用于在发生错误时构建消息对话框。记录错误时，错误代码和技术消息包含在错误日志中（连同客户端的 IP、日期、时间等）。

            回答 #7

赞同：0

时间：2009-01-20T06:57:46.437

我发现包含以下字段总是很方便：  

*   不活动（或可见/停止/等）
*   不活跃的原因    

只是让“软删除”项目变得非常容易，从而保持数据完整性，并且您不会丢失有价值的历史信息。

Galwegian 提到的审计日志表 +1。

            回答 #8

赞同：0

时间：2009-01-20T07:25:25.507

会员表。无价。

            回答 #9

赞同：0

时间：2009-01-20T07:38:51.347

任何保存用户数据（与您的系统数据相反）的表都有创建日期和最后更新日期。如果有 1% 的机会，您可能需要知道某事何时发生。这将在未来省去很多麻烦。虽然我不喜欢触发器，但使用它们来维护这两个字段是值得的。如果您使用真实的数据库登录，那么 created_user 和 updated_user 也很有用。

        database - 数据库的字段名称长度对性能的影响？

ID：246406

赞同：9

时间：2008-10-29T10:59:20.757

标签：database, name-length

字段名称长度对数据库性能有什么影响？可以忽略不计吗？我应该使用长描述性名称吗？

            回答 #1

赞同：13

时间：2008-10-29T11:03:15.663

我没有测量时间，但我想可以忽略不计。字段名称将通过网络来回发送，无论是在您的 SQL 语句到数据库中还是在从数据库返回的元数据中，但我认为这些数据包中的几个字节产生的增量差异如下关爱的门槛。

可怜那些不得不阅读你的代码，并使名称具有描述性的可怜人。让电脑多做一点点额外的工作。

            回答 #2

赞同：6

时间：2008-10-29T11:02:33.857

数据库服务器将字段名称转换为内部表示。因此，名称长度影响性能的唯一时间是服务器解析您的 SQL 语句时。这对典型应用程序的性能影响可以忽略不计。

            回答 #3

赞同：5

时间：2008-10-29T11:00:42.597

**明智**- 使字段名称足够长，以便您知道它们代表什么，但又足够短，您不必向右滚动半小时即可查看列是什么。

            回答 #4

赞同：2

时间：2008-10-29T11:01:51.110

您可以获取学术知识并讨论查询解析器读取查询所需的时间，但实际上……长名称根本不会产生任何您应该担心的影响。

            回答 #5

赞同：1

时间：2008-10-29T11:05:26.750

在内部，一旦查询中的标记被解析，查询处理器就会使用数字作为字段名称。数据库对象的短名称没有明显的性能提升。

            回答 #6

赞同：1

时间：2008-10-29T11:21:37.670

如果您使用的是内联 sql 或 ORM，则会由于额外信息在网络上来回发送而产生一些影响；但我们说的真的微不足道。

        c++ - 在 Windows Mobile 6 中禁用睡眠模式

ID：246407

赞同：7

时间：2008-10-29T10:59:49.243

标签：c++, windows-mobile, pocketpc

有谁知道我如何以编程方式在 Windows Mobile 上禁用/启用睡眠模式？

谢谢！

            回答 #1

赞同：8

时间：2008-10-29T22:32:51.730

如果您希望程序在运行时不进入睡眠状态，最好的方法是创建一个调用 SystemIdleTimerReset、SHIdleTimerReset 并模拟按键触摸的 KeepAlive 类型函数。然后你需要调用它很多，基本上无处不在。

```
#include <windows.h>
#include <commctrl.h>

extern "C"
{
    void WINAPI SHIdleTimerReset();
};

void KeepAlive()
{
    static DWORD LastCallTime = 0;
    DWORD TickCount = GetTickCount();
    if ((TickCount - LastCallTime) > 1000 || TickCount < LastCallTime) // watch for wraparound
    {
        SystemIdleTimerReset();
        SHIdleTimerReset();
        keybd_event(VK_LBUTTON, 0, KEYEVENTF_SILENT, 0);
        keybd_event(VK_LBUTTON, 0, KEYEVENTF_KEYUP | KEYEVENTF_SILENT, 0);
        LastCallTime = TickCount;
    }
} 
```

此方法仅在用户手动启动应用程序时有效。

如果您的应用程序是由通知启动的（即在设备暂停时），那么您需要做更多的事情，否则您的应用程序将在很短的时间后暂停，直到用户将设备电源从暂停模式中退出。要处理此问题，您需要将设备置于无人值守电源模式。  

```
if(!::PowerPolicyNotify (PPN_UNATTENDEDMODE, TRUE))
{
    // handle error
}

// do long running process

if(!::PowerPolicyNotify (PPN_UNATTENDEDMODE, FALSE))
{
    // handle error
} 
```

在无人值守模式使用过程中，仍然需要大量调用 KeepAlive，可以使用单独的线程休眠 x 毫秒并调用 keepalive 函数。

请注意，无人值守模式不会使其退出睡眠模式，它会使设备处于奇怪的半清醒状态。

因此，如果您在设备处于挂起模式时启动无人值守模式，它不会唤醒屏幕或任何东西。无人值守模式所做的就是阻止 WM 暂停您的应用程序。另一个问题是它不适用于所有设备，某些设备的电源管理不是很好，无论你做什么它都会暂停你。

            回答 #2

赞同：6

时间：2008-10-29T13:31:31.153

修改影响您想要的特定睡眠条件（超时、电池、交流电源等）[的电源管理器注册表设置和名为“PowerManager/ReloadActivityTimeouts”的命名系统事件上的 SetEvent，以告诉操作系统重新加载设置。](http://msdn.microsoft.com/en-us/library/aa932196.aspx)

            回答 #3

赞同：1

时间：2008-10-29T11:06:50.197

[可能通过修改此处描述](http://www.codeproject.com/KB/mobile/WiMoPower1.aspx)的“系统电源状态” （但在 c# 中）

那篇文章还描述了一种防止移动设备进入睡眠状态的方法（这可能不是您想要的），方法是定期调用本机函数 SystemIdleTimerReset()（以防止设备断电）。

        ios - 如何将 iPhone 应用程序从 Xcode 部署到真正的 iPhone 设备？

ID：246422

赞同：160

时间：2008-10-29T11:06:18.137

标签：ios, xcode, deployment, certificate

如何在没有 99 美元的 Apple 证书的情况下将 iPhone 应用程序从 Xcode 部署到真实的 iPhone 设备？

            回答 #1

赞同：92

时间：2010-11-15T00:05:35.887

[*我混合使用了两种方法：[Jason's](https://stackoverflow.com/questions/37464/iphone-app-minus-app-store/37522#37522)和[alex's](http://www.alexwhittemore.com/?p=398)。有了第二个，我们就有了能够调试的优势。我将主要复制以下两者（并简化亚历克斯）：*]

[***2012 年 1 月更新：****这仍然适用于 SDK 4.2.1 和 iOS 5.0.1 - 我刚刚在新的计算机和设备上进行了测试！*]

1\. 创建自签名证书

修补您的 iPhone SDK 以允许使用此证书：

1.  启动 Keychain Access.app。在未选择任何项目的情况下，从 Keychain 菜单中选择 Certificate Assistant，然后选择 Create a Certificate。

    *   *名称：* **iPhone 开发者**

    *   *证书类型：* **代码签名**

    *   *让我覆盖默认值：* **是**

2.  点击继续

    *   *有效期：* **3650天**

3.  点击继续

4.  **空白**的*电子邮件*地址字段。

5.  单击**继续直到完成**。

    您应该看到*“此根证书不受信任”*。这是意料之中的。

6.  设置 iPhone SDK 以允许使用自签名证书：

    ```
    sudo /usr/bin/sed -i .bak 's/XCiPhoneOSCodeSignContext/XCCodeSignContext/' /Developer/Platforms/iPhoneOS.platform/Info.plist 
    ```

    如果您打开了 Xcode，请重新启动它以使此更改生效。

如果您使用的是 iOS 5，就是这样！现在就试试！它可能不允许调试，但应用程序会在那里！

[*我对此感到非常惊讶，因为[您应该知道](https://stackoverflow.com/questions/5802389/xcode-4-and-jailbroken-iphone)，我不知道所有这些黑客行为的全部内容！正如我所指出的，我所做的只是稍微改进我在其他地方发现的东西。*]

[*所以，是的，**整个方法**不再以同样的方式工作，我懒得找一个新的……除了[这个，它使用了一个名为 Theos 的工具，](http://brandontreb.com/beginning-jailbroken-ios-development-getting-the-tools/)但我无法完成整个过程。*]

[*最后，如果您出于某种原因需要**卸载它**，请查看本文末尾。就我而言，我不得不这样做，因为我无法弄清楚为什么整个方法都停止工作了，而且我已经不在乎了，因为我们已经获得了等待已久的许可证。（该死的 DUNS 号码需要很长时间......）*]

.

.

.

.

.

2\. 使 Xcode 能够在越狱设备上构建

1.  在您越狱的 iPhone 上，通过添加源来安装应用程序**AppSync **** [http://repo.hackyouriphone.org](http://repo.hackyouriphone.org) **

2.  删除代码签名和权利的 SDK 要求（我喜欢[sed](http://en.wikipedia.org/wiki/Sed)！）：

    ```
    sudo /usr/bin/sed -i .bak '/_REQUIRED/N;s/YES/NO/' /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.0.sdk/SDKSettings.plist 
    ```

3.  ***注意***部分`iPhoneOS5.0.sdk`。例如，如果您使用的是 iOS 4.2 SDK，只需相应地替换它：

    ```
    sudo /usr/bin/sed -i .bak '/_REQUIRED/N;s/YES/NO/' /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS4.2.sdk/SDKSettings.plist 
    ```

4.  通过修补 Xcode 结束需求删除。这意味着二进制编辑：

    ```
    cd /Developer/Platforms/iPhoneOS.platform/Developer/Library/Xcode/Plug-ins/iPhoneOS\ Build\ System\ Support.xcplugin/Contents/MacOS/
    dd if=iPhoneOS\ Build\ System\ Support of=working bs=500 count=255
    printf "\xc3\x26\x00\x00" >> working
    /bin/mv -n iPhoneOS\ Build\ System\ Support iPhoneOS\ Build\ System\ Support.original
    /bin/mv working iPhoneOS\ Build\ System\ Support
    chmod a+x iPhoneOS\ Build\ System\ Support 
    ```

    如果您打开了 Xcode，请重新启动它以使此更改（以及最后一个更改）生效。

5.  打开*“项目>编辑项目设置”*（从菜单中）。单击*“构建”*选项卡。在列表中找到*“Code Signing Identity”*及其子*“Any iPhoneOS Device”*，并将两者都设置为***“Don't Code Sign”***条目：

    ![替代文字](https://i.stack.imgur.com/P8FKX.png)

    在此之后，请随意撤消第 3 步。至少在我的情况下，一切正常。

6.  使用我们定制的*自签名证书*将 Xcode 设置为代码签名（第一个操作方法）。如果您不想调试，可以跳过此步骤：

    ```
    mkdir /Developer/iphoneentitlements401
    cd /Developer/iphoneentitlements401
    curl -O http://www.alexwhittemore.com/iphone/gen_entitlements.txt
    mv gen_entitlements.txt gen_entitlements.py
    chmod 777 gen_entitlements.py 
    ```

    插入你的 iPhone 并打开 Xcode。打开窗口>组织者。从左侧列表中选择设备，然后单击“用于开发”。系统将提示您登录配置网站，单击取消。它可以使合法的配置更容易，但不会使非法的不配置变得更加困难。

    现在**你必须为你所做的每一个新项目做这最后一部分**。转到菜单项目 > 新构建阶段 > 新运行脚本构建阶段。在窗口中，复制/粘贴：

    ```
    export CODESIGN_ALLOCATE=/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/codesign_allocate
    if [ "${PLATFORM_NAME}" == "iphoneos" ]; then
    /Developer/iphoneentitlements401/gen_entitlements.py "my.company.${PROJECT_NAME}" "${BUILT_PRODUCTS_DIR}/${WRAPPER_NAME}/${PROJECT_NAME}.xcent";
    codesign -f -s "iPhone Developer" --entitlements "${BUILT_PRODUCTS_DIR}/${WRAPPER_NAME}/${PROJECT_NAME}.xcent" "${BUILT_PRODUCTS_DIR}/${WRAPPER_NAME}/"
    fi 
    ```

.

.

.

.

卸载

**第一部分：**

```
sudo mv -f /Developer/Platforms/iPhoneOS.platform/Info.plist.bak /Developer/Platforms/iPhoneOS.platform/Info.plist 
```

**对于第二部分：**

```
sudo mv -f /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.0.sdk/SDKSettings.plist.bak /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.0.sdk/SDKSettings.plist
sudo mv -f iPhoneOS\ Build\ System\ Support.original iPhoneOS\ Build\ System\ Support 
```

如果您确实执行了第 3 步而不是第 2 步，只需相应地对其进行修改：

```
sudo mv -f /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS4.2.sdk/SDKSettings.plist.bak /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS4.2.sdk/SDKSettings.plist 
```

剩下的，只是恢复你在 XCode 上所做的，`/Developer/iphoneentitlements401/gen_entitlements.py`如果你想删除：

```
sudo rm -f /Developer/iphoneentitlements401/gen_entitlements.py 
```

            回答 #2

赞同：56

时间：2008-10-30T23:48:56.320

听起来应用程序没有签名。从 Cydia 下载 ldid ，然后像这样使用它：`ldid -S /Applications/AccelerometerGraph.app/AccelerometerGraph`

还要确保二进制文件被标记为可执行文件：`chmod +x /Applications/AccelerometerGraph.app/AccelerometerGraph`

            回答 #3

赞同：49

时间：2015-11-26T00:30:30.103

Xcode 7 之后的免费配置
为了在真实设备上测试您的应用程序而不是支付 Apple 开发人员费用（或越狱您的设备），您可以使用 Xcode 7 和 iOS 9 支持的新免费配置。
以下是或多或少从[文档](https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/AppStoreDistributionTutorial/LaunchingYourApponDevices/LaunchingYourApponDevices.html)中采取的步骤（这非常好，所以请阅读）：
**1\. 在 Xcode 中添加您的 Apple ID**
转到 XCode > 首选项 > 帐户选项卡 > 添加按钮 (+) > 添加 Apple ID。请参阅[文档](https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/AppStoreDistributionTutorial/AddingYourAccounttoXcode/AddingYourAccounttoXcode.html)以获取更多帮助。
[![在此处输入图像描述](https://i.stack.imgur.com/wl7Vf.png)](https://i.stack.imgur.com/wl7Vf.png)
**2\. 单击项目导航器中的常规选项卡**
[![在此处输入图像描述](https://i.stack.imgur.com/KoyWZ.png)](https://i.stack.imgur.com/KoyWZ.png)
**3\. 从团队弹出菜单中选择您的 Apple ID。**
[![在此处输入图像描述](https://i.stack.imgur.com/cWY2y.png)](https://i.stack.imgur.com/cWY2y.png)
**4.连接您的设备并在方案菜单中选择它。**
[![在此处输入图像描述](https://i.stack.imgur.com/mDHhe.png)](https://i.stack.imgur.com/mDHhe.png)
**5\. 单击修复问题按钮**
[![在此处输入图像描述](https://i.stack.imgur.com/aJj1H.png)](https://i.stack.imgur.com/aJj1H.png)
如果您收到有关捆绑名称无效的错误，请将其更改为唯一名称。
**6\. 运行你的应用**
在 Xcode 中，单击构建并运行按钮。
[![在此处输入图像描述](https://i.stack.imgur.com/Kbmm3.png)](https://i.stack.imgur.com/Kbmm3.png)
**7\. 在设备设置中信任应用开发者**
运行您的应用程序后，您将收到一个安全错误，因为您要运行的应用程序不是来自 App Store。
[![在此处输入图像描述](https://i.stack.imgur.com/UUS9G.png)](https://i.stack.imgur.com/UUS9G.png)
在您的**设备**上，前往“设置”>“通用”>“个人资料”>“*你的 Apple ID 名称*” >“信任*你的 Apple ID 名称”* >“信任”。
**8\. 再次在您的设备上运行您的应用程序。**
就是这样。您现在可以运行自己的（或您拥有源代码的任何其他应用程序），而无需花费 99 美元。谢谢你，Apple，终于允许这样做了。

            回答 #4

赞同：9

时间：2008-10-29T23:29:06.687

如果您正在谈论使用官方 SDK 构建并直接从 xcode 部署的应用程序，则不能。

            回答 #5

赞同：8

时间：2008-10-29T11:08:09.540

您必须越狱您的设备。

            回答 #6

赞同：6

时间：2010-09-11T17:28:03.637

有一种无需支付苹果费用即可部署 iPhone 应用程序的方法 您必须越狱您的设备并按照[http://www.alexwhittemore.com/?p=398中的说明进行操作](http://www.alexwhittemore.com/?p=398)

            回答 #7

赞同：5

时间：2009-11-14T07:42:02.110

我在任何地方都没有看到任何迹象表明您可以在没有（付费）证书的情况下临时部署到真正的 iPhone。

            回答 #8

赞同：4

时间：2011-02-08T05:48:31.877

我昨晚浏览了 Apple Developer，在配置证书中我发现了类似“签名团队成员”的内容。我认为有一种方法可以将团队成员添加到付费个人资料中。您可以要求 App Id Owner（付费）将您添加为团队成员。我不确定。仍在寻找。

            回答 #9

赞同：3

时间：2009-05-15T00:46:18.483

不，这很容易做到。在 Xcode 中，将 Active Configuration 设置为 Release。将设备从模拟器更改为设备 - 任何 SDK。如果要直接导出到 iPhone，请将其连接到计算机。按构建并开始。如果您的 iPhone 未连接到计算机，则会出现一条消息，提示您的 iPhone 未连接。

如果这适用于您：（未连接 iPhone）

转到您的项目文件夹，然后转到里面的构建文件夹。转到 Release-iphoneos 文件夹，将应用程序放入其中，拖放到 iTunes 图标上。当您同步您的 iTouch 设备时，它会将其复制到您的设备。它还将作为 iPhone 应用程序出现在 iTunes 中。

希望这可以帮助！

PS：如果它说证书无效，只需单击 Xcode 中的项目，左侧​​文件堆栈中的小项目图标，然后按 Apple+I，或从菜单栏中执行 Get Info。单击顶部的构建。在 Code Signing 下，将 Code Signing Identity - Any iPhone OS Device 更改为 Don't Sign。

            回答 #10

赞同：2

时间：2009-11-09T01:17:15.500

这实际上完全取决于您使用的 Xcode 版本，因为不同的版本使用不同的方法部署到您的 iPhone，而无需配置文件。

Xcode 3.2.1 是一个不错的版本，很容易整理，但是我们需要知道你使用的是什么版本。

            回答 #11

赞同：2

时间：2011-05-22T19:23:50.293

Cawas 发布的解决方案也与 XCode4 完美配合。但是，IDE 的 UI 有一些变化，因此您需要进行一些研究才能找到 Run Script :)

在 Project Navigator 视图中单击项目的根项，然后在中间窗口中选择 Target，然后单击 Build Phases 选项卡，在底部您将看到 Add Build Phase 按钮​​，单击并选择 Add Run Script，然后粘贴“codesign “卡瓦斯发布的脚本。

            回答 #12

赞同：1

时间：2009-07-27T11:29:29.890

没有解决方法。如果应用程序已在您的设备上注册，您只能临时部署应用程序。这会阻止您建立自己的应用商店。

        decimal - 如何将大数转换为十进制？

ID：246430

赞同：2

时间：2008-10-29T11:09:43.827

标签：decimal, hex, biginteger

0x34363932353433373538323038353135353439

            回答 #1

赞同：2

时间：2008-10-29T11:14:07.217

从 Unix/cygwin 命令行，您可以使用 bc。

```
$ bc
ibase=16
34363932353433373538323038353135353439
1164362276596472215941024063897591129839055929 
```

还有[一个在线版本](http://sciencesoft.at/bc/?lang=en)。如果您想在代码中执行此操作，您应该使用任意精度库工具，例如 Java 的 BigInteger、Perl 的 Math::BigInt、Tcl 的 math::bignum，或者可用于 C 的许多多精度算术库，例如[GNU GMP](http://gmplib.org/)，或[MPI](http://spinning-yarns.org/michael/mpi)。

            回答 #2

赞同：1

时间：2008-10-29T11:43:41.603

对我来说看起来像 ASCII！在大端系统上，您会得到字符串“4692543758208515549”。:-)

无论如何，要真正回答您的问题，Ruby 对此很有用：

```
ruby -e 'p 0x34363932353433373538323038353135353439' 
```

        nhibernate - NHibernate 将标识映射到没有生成器的列

ID：246434

赞同：0

时间：2008-10-29T11:11:14.447

标签：nhibernate, mapping, identity

我可以将实体的身份映射到其值不是自动生成但仍然是唯一的列吗？

如果是这样，我应该在 xml 身份/生成器标签中添加什么？

谢谢。

            回答 #1

赞同：2

时间：2008-10-29T11:32:38.007

这取决于如何创建新的身份值。如果您手动将值赋予新行（在保存它们之前），我的猜测是使用。仅供参考 - 如果您使用分配的生成器：

*由于其固有的性质，使用此生成器的实体无法通过 ISession 的 SaveOrUpdate() 方法保存。相反，您必须通过调用 ISession 的 Save() 或 Update() 方法来显式指定 NHibernate 是否应该保存或更新对象。* 

[生成器文档](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html_single/#mapping-declaration-id-generator)

        html - 换行符

ID：246438

赞同：131

时间：2008-10-29T11:14:32.100

标签：html

**可能重复：**

  [如何在 HTML 工具提示中使用回车？](https://stackoverflow.com/questions/358874/how-can-i-use-a-carriage-return-in-a-html-tooltip)  

我想知道在使用 TD 的 title 属性时是否可以强制在工具提示中显示换行符。就像是

```
<td title="lineone \n linetwo \n etc..."> 
```

这可以做到吗？

            回答 #1

赞同：184

时间：2008-10-29T11:24:37.290

这现在应该适用于 Internet Explorer、Firefox v12+ 和 Chrome 28+

```
<img src="'../images/foo.gif'" 
  alt="line 1&#013;line 2" title="line 1&#013;line 2"> 
```

尝试使用 JavaScript 工具提示库以获得更好的结果，例如[OverLib](https://github.com/overlib/overlib)。

            回答 #2

赞同：42

时间：2011-12-15T20:22:27.897

实现类似效果的一种方法是通过 CSS：

```
<td>Cell content.
  <div class="popup">
    This is the popup.
    <br>
    Another line of popup.
  </div>
</td> 
```

然后在 CSS 中使用以下内容：

```
td div.popup { display: none; }
td:hover div.popup { display: block; position: absolute; } 
```

您将需要添加一些边框和背景以使弹出窗口看起来不错，但这应该勾勒出这个想法。但是它有一些缺点，例如弹出窗口不是相对于鼠标而是相对于包含单元格定位的。

            回答 #3

赞同：27

时间：2010-07-23T08:15:40.327

可扩展标记语言 (XML) 1.1 W3C 建议说

« 所有换行符都必须按照 2.11 行尾处理中的描述在输入到 #xA 时进行规范化，因此该算法的其余部分对以这种方式规范化的文本进行操作。»

链接是[http://www.w3.org/TR/2006/REC-xml11-20060816/#AVNormalize](http://www.w3.org/TR/2006/REC-xml11-20060816/#AVNormalize)

然后你可以写：

```
<td title="lineone &#xA; linetwo &#xA; etc..."> 
```

            回答 #4

赞同：7

时间：2012-05-16T18:03:50.343

在 Chrome 中使用`&#xA;`Works 在工具提示中创建单独的行。

            回答 #5

赞同：4

时间：2008-10-29T11:16:34.140

这应该没问题，但特定于 Internet Explorer：

```
<td title="lineone
linetwo 
etc..."> 
```

正如其他人所提到的，如果您只对工具提示感兴趣，唯一的其他方法是使用基于 HTML + JavaScript 的工具提示。如果这是为了可访问性，那么您可能需要坚持单行以保持一致性。

            回答 #6

赞同：4

时间：2012-09-05T14:45:55.747

使用`&#013;`在我的 fb 应用程序中不起作用。然而，这确实很漂亮（在 Chrome FF 和 IE 中）：

```
<img src="'../images/foo.gif'" title="line 1&lt;br&gt;line 2"> 
```

            回答 #7

赞同：3

时间：2008-12-11T17:38:05.700

我为此使用了 jQuery[线索提示](http://plugins.learningjquery.com/cluetip/#)插件。

            回答 #8

赞同：2

时间：2008-10-29T11:19:51.807

如果您希望将换行符放入鼠标悬停时出现的工具提示中，则没有可靠的跨浏览器方法可以做到这一点。您必须退回到众多 Javascript 工具提示代码示例之一

            回答 #9

赞同：1

时间：2010-12-29T15:01:34.023

jquery [colortip](http://tutorialzine.com/2010/07/colortips-jquery-tooltip-plugin/)插件还支持`<br>`
 标题属性中的标签，您可能需要查看该标签。

        c# - NumericUpDown 是否有等效的 ComboBoxRenderer？

ID：246440

赞同：2

时间：2008-10-29T11:19:40.343

标签：c#, .net

我想在自定义组件上绘制微调控件，例如在 NumericUpDown 上找到的控件。如果我想绘制一个下拉按钮，我可以使用 ComboBoxRenderer。NumericUpDown 是否有等效的 ComboBoxRenderer？

            回答 #1

赞同：2

时间：2009-02-18T16:44:02.933

原来有。请参阅[VisualStyleElement.Spin 类](http://msdn.microsoft.com/en-us/library/system.windows.forms.visualstyles.visualstyleelement.spin.aspx)。

            回答 #2

赞同：0

时间：2008-11-03T15:57:37.560

我认为 Windows 窗体命名空间中不存在 ComboBoxRenderer。您需要使用互操作和 Theme API 直接绘制 UpDown 控制箭头（旋转按钮）。我没有完整的样品给你，但你需要

```
[DllImport("uxtheme.dll", ExactSpelling = true, CharSet = CharSet.Unicode)]
public static extern IntPtr OpenThemeData(IntPtr hWnd, String classList);

[DllImport("uxtheme", ExactSpelling = true)]
public extern static Int32 DrawThemeBackground(IntPtr hTheme, IntPtr hdc, int iPartId, int iStateId, ref RECT pRect, IntPtr pClipRect);

[DllImport("uxtheme.dll", ExactSpelling = true)]
public extern static Int32 CloseThemeData(IntPtr hTheme); 
```

[您可以在此页面](http://msdn.microsoft.com/en-us/library/bb773210(VS.85).aspx)中找到所需的部分和状态（查找 SPIN 样式类及其关联的部分和状态）。

        html - HTML：为什么嵌入的音频有时无法播放？

ID：246443

赞同：1

时间：2008-10-29T11:20:45.083

标签：html, internet-explorer, browser, audio, https

我在 HTML 页面上遇到了一些嵌入音频（wav 文件）的奇怪行为。我有一个 page和一个通过标签`https://server.com/listen-to-sound`嵌入其中的 Wav 文件，如下所示：`<EMBED/>`

```
<embed src='https://server.com/path-to-sound' hidden="true" autostart="true" /> 
```

该页面`https://server.com/listen-to-sound`在机器#1 上的 IE 6 SP3 中打开 - 声音在耳机中播放。在另一台机器上打开相同的页面（#2），具有**完全相同**的IE 6 SP3 版本、隐私和代理设置 - 没有声音。

总共有 6 台机器在 2 台上播放声音，在 4 台上不播放。从这 4 台机器中，当`https://server.com/listen-to-sound`在 Opera 中打开页面时，会播放声音。

我反复检查了耳机连接、音量设置和其他可能的硬件和软件驱动程序问题：问题肯定出在 IE 设置中。

我还检查了`https://server.com/path.to.sound`URL - 4 个不播放声音的机器无法打开此链接，失败并出现“无法下载页面”之类的错误。

清理 IE 缓存、临时 Internet 文件、SSL 证书缓存也不能解决问题。

谷歌搜索给了我什么特别的东西，但老的 Flash 技巧使用`<OBJECT>`标签和`<EMBED>`标签写在对象的评论中。

我错过了什么？您是否遇到过类似或相关的问题？他们是如何解决的？你对诀窍在哪里有什么建议吗？您知道一些可能影响嵌入对象执行（播放、显示）的 IE “功能”吗？

            回答 #1

赞同：1

时间：2009-05-04T17:41:52.640

我认为主要原因是在您使用的每台计算机/浏览器上表现不同，因为它是一个非标准标签。

让媒体在网页中播放一直有点痛苦。你可以尝试这样的事情：

```
<object type="audio/x-wav" data="data/test.wav" width="200" height="20">
  <param name="src" value="data/test.wav">
  <param name="autoplay" value="false">
  <param name="autoStart" value="0">
  alt : <a href="data/test.wav">test.wav</a>
</object> 
```

以上内容来自[该站点](http://joliclic.free.fr/html/object-tag/en/)，解释了如何使用对象标签。

            回答 #2

赞同：1

时间：2010-06-27T13:51:52.637

我还没有找到解决方案，但我可以确认可能的问题是 https:。我发现 Windows 媒体播放器不会播放带有完整 url/src 的文件，这些文件会导致 https。但是，quicktime 会。因此，具有 quicktime 的计算机将成功播放文件，而仅具有 WMP 的计算机将失败。

一种“解决方案”是链接到文件的 http:（非安全）版本。

            回答 #3

赞同：0

时间：2008-10-29T12:10:47.477

我找不到这方面的任何信息，但是您是否尝试过从 Javascript 播放声音？我不知道这对您来说是否可行，但这可能是一个解决方案。

你可以在这里找到不同的方法：[http ://www.phon.ucl.ac.uk/home/mark/audio/play.htm](http://www.phon.ucl.ac.uk/home/mark/audio/play.htm)

希望对您有所帮助。

            回答 #4

赞同：0

时间：2008-10-29T13:10:32.117

关于您对 jamesh 的评论，我建议您提供一个指向音频文件的链接：一些计算机（我在工作中）没有声音，不是每个人都在使用 IE，嵌入不是 HTML 的一部分（这是一个 hack各种浏览器都支持，例如在[HTML 4.01 过渡 DTD](http://www.w3.org/TR/html401/sgml/loosedtd.html "HTML 4.01 过渡 DTD")中没有定义）并且访问浏览器很可能没有插件来播放您的声音。

正如您的测试所示，它很容易出现问题......

在最坏的情况下，提供一个`<NOEMBED>`标签来提供上述链接。或者嵌套各种方法，比如`<object>`. 至少，几乎所有浏览器都支持 Flash。

        c++ - 以安全的方式从 char* 创建 std::string

ID：246445

赞同：10

时间：2008-10-29T11:22:36.687

标签：c++, exception

我有一个`char* p`，它指向一个 -`\0`终止的字符串。如何`string`以异常安全的方式从中创建 C++？

这是一个不安全的版本：

```
string foo()
{
  char *p = get_string();

  string str( p );
  free( p );
  return str;
} 
```

一个明显的解决方案是尝试捕捉 - 任何更简单的方法？

            回答 #1

赞同：25

时间：2008-10-29T11:26:02.950

您可以使用`shared_ptr`C [++11](http://en.cppreference.com/w/cpp/memory/shared_ptr)或[Boost](http://www.boost.org/libs/smart_ptr/)：

```
string
foo()
{
    shared_ptr<char> p(get_string(), &free);
    string str(p.get());
    return str;
} 
```

这使用了一个非常特殊的功能，在其他任何东西中`shared_ptr`都不可用`auto_ptr`，即指定自定义删除器的能力；在这种情况下，我将`free`其用作删除器。

            回答 #2

赞同：3

时间：2008-10-29T14:00:14.417

我能问你在你的例子中你期望什么例外吗？

在许多平台（Linux、AIX）上，new 或 malloc 永远不会失败，如果内存不足，您的应用程序将被操作系统杀死。

请参阅此链接：[Linux 内存不足时会发生什么。](http://www.linuxdevcenter.com/pub/a/linux/2006/11/30/linux-out-of-memory.html)

            回答 #3

赞同：1

时间：2008-10-29T11:26:57.550

是的 - 基于堆栈的展开。现代 C++ 设计有通用解决方案，但在这种情况下，您可以使用

```
struct Cleanup {
        void* toFree;
        Cleanup(void* toFree) : toFree(toFree) {}
        ~Cleanup() { free(toFree); }
    private:
        Cleanup(Cleanup&);
        void operator=(Cleanup&);
}; 
```

无论您的 std::string 发生什么，当您的 Cleanup 对象超出范围时，都会调用 free(toFree)。

            回答 #4

赞同：1

时间：2008-10-29T13:50:27.247

好吧，如果返回 NULL ，`p`则不指向以 0 结尾的字符串；`get_string()`这就是问题所在，因为`std::string`采用指向 0 终止 C 字符串的指针的构造函数无法处理 NULL，NULL 与 2 打香蕉一样多的 0 终止 C 字符串。

因此，如果`get_string()`是您自己的函数，而不是库函数，那么也许您应该确保它不能返回 NULL。例如，您可以让它返回所寻求的`std::string`本身，因为它知道自己的状态。否则，我会这样做，使用`Cleanup`from [this answer](https://stackoverflow.com/questions/246445/create-stdstring-from-char-in-a-safe-way#246460)作为帮助以保证`p`不会泄漏（正如 Martin York 在评论中所建议的那样）：

```
string foo()
{
    const char* p = get_string();
    const Cleanup cleanup(p);
    const std::string str(p != NULL ? p : "");

    return str;
} 
```

            回答 #5

赞同：0

时间：2008-10-29T13:57:39.743

我们通常在这些情况下使用[ScopeGuard](http://www.ddj.com/cpp/184403758)：

```
string foo()
{
  char *p = get_string();
  ScopeGuard sg = MakeGuard(&free, p);
  string str( p );
  return str;
} 
```

        currency - ISO 国家/货币数据

ID：246459

赞同：3

时间：2008-10-29T11:26:47.100

标签：currency, iso, countries

全部，

我们的应用程序需要有关 ISO 国家和货币的数据（其中数据必须是最新的）。我们确实从 ISO 自己购买了国家/货币数据，但是我们仍然需要对数据执行大量手动操作，以及编写我们自己的工具来读取和处理数据到我们的数据库中。

1.  我们是否会以错误的方式获取这些数据？

2.  获取国家/货币数据的规范是什么？

3.  是否有任何知名的提供商可以提供这些数据作为服务或通过其他可用格式的媒体？

任何帮助将不胜感激。

            回答 #1

赞同：2

时间：2008-10-29T11:31:14.080

[.NET CultureInfo](http://msdn.microsoft.com/en-us/library/ky2chs3h.aspx)类提供货币格式（以及日期、时间、数字等）。当它在 .NET 运行时免费提供时，我什至不会考虑从 ISO 购买数据。

            回答 #2

赞同：0

时间：2008-10-29T12:55:37.840

您可能对 IBM 的[Unicode 国际组件 (ICU)](http://www.icu-project.org/ "Unicode 国际组件 (ICU)")库感兴趣。

众所周知，开源支持“数字、日期、时间和货币金额”格式。

不确定它是否有助于您的情况，但此信息可能对其他人有用... :-)

        .net-3.5 - 如何在 .NET 2.0 应用程序中实现 .NET 3.5 功能的前向兼容性？

ID：246467

赞同：2

时间：2008-10-29T11:30:55.560

标签：.net-3.5, visual-studio-2005, .net-2.0

我想开始在一个当前停留在过去的应用程序中使用 .NET 3.5 功能 - 我如何以向前兼容的方式编写对 JSON 序列化等选定功能的支持？

在 JSON 序列化的情况下，我需要引用 System.ServiceModel.Web - 在 VS2005 应用程序中引用 .NET 3.5 dll 是否可以？大概这是在 GAC 中，但在部署环境中可能不是……

            回答 #1

赞同：1

时间：2008-10-29T12:00:31.587

如果您的应用程序以 .NET 2.0 为目标，则引用 .NET 3.5 DLL 不是一个好主意，因为您引用的库可能会引用其他 .NET 3.5 库，如果它们没有 . NET 3.5 运行时安装。

如果您愿意（来自项目属性|应用程序|目标框架），您可以将项目设置为以 .NET 3.5 为目标，这将克服这个问题 - 然后您的应用程序将使用其当前引用的 .NET 2.0 库（以及任何 .NET 3.5 库）您想添加以用于新代码），同时要求用户计算机上的 .NET 3.5 允许使用 DLL。

            回答 #2

赞同：0

时间：2008-10-29T11:54:36.950

您可以引用所需的任何 DLL，但如果您不要求 dll 来自的框架版本，则可能需要探索引用属性设置“Copy Local=True”。

        sql-server - 读数据库有什么设置，写数据库有什么设置？

ID：246469

赞同：1

时间：2008-10-29T11:30:59.820

标签：sql-server, database

我正在为我正在开发的项目实现复制，并希望将写入数据库中的更改复制到读取数据库。

虽然这不是问题，但我想调整一个数据库用于读取，另一个用于写入，因此它们会有不同的设置。

是否有任何资源/指南可以告诉我要研究哪些概念？我不是在寻找如何指导（同样，在这个级别，这些任务非常复杂，需要指导）。

谢谢

            回答 #1

赞同：1

时间：2008-10-29T11:35:54.647

以不同的方式索引您的数据库。与读取数据库相比，您可能需要不同的索引（可能更少的索引）来支持写入写入数据库的过程。如果索引仅用于读取，则将其从写入数据库中删除。

我不是这方面的专家，我的想法可能很模糊，但请考虑硬件/内存/甚至 RAID 配置。我不记得了.... 一种 RAID 配置是否更适合写入而另一种更适合读取，或者这是错误的...？

            回答 #2

赞同：0

时间：2008-10-30T13:20:07.133

最明显的区别将是所需的不同索引。磁盘 IO 模式也会有所不同，但不要忘记读取数据库也被复制过程写入，您不能完全优化它以供读取。其他差异在最佳内存配置和两台服务器所需的 CPU 容量等方面也可能很明显。您的第一步是了解每台服务器必须处理的工作负载类型以及工作量。虽然我没有任何具体的链接，但微软网站确实有几篇关于调整 SQL 服务器硬件大小的论文。一旦您知道 2 台服务器必须处理的工作负载，您应该能够使用相同的指南来确定它们的大小并获得配置它们的想法。

        .net - SPRING.Net 是面向方面编程（AOP）的最佳框架吗？

ID：246470

赞同：3

时间：2008-10-29T11:31:02.910

标签：.net, aop

请告诉我使用特定框架的优点和缺点。

可以给我在.net 应用程序中使用 AOP 的成功示例吗？

            回答 #1

赞同：2

时间：2008-11-04T17:35:30.030

较早的帖子，但可能会帮助您了解产品和 AOP 实现的一些优缺点。

[http://ayende.com/Blog/archive/2007/07/02/7-Approaches-for-AOP-in-.Net.aspx](http://ayende.com/Blog/archive/2007/07/02/7-Approaches-for-AOP-in-.Net.aspx)

            回答 #2

赞同：2

时间：2010-04-08T15:22:27.050

到目前为止，我们已经将 Spring.Net AOP 用于将日志记录应用到应用程序的经典 AOP 示例。我没有使用任何其他可用于 .Net 的 AOP 框架。

它工作得非常好，没有明显的性能影响，从我们的应用程序中删除了大量多余和重复的代码，并提高了日志记录覆盖率以及日志记录信息的质量和一致性。日志记录现在写在一个地方并配置在一个地方 - 一个巨大的改进。

不过有几点需要注意： Spring.Net AOP 要求建议任何对象至少实现一个接口；也就是说，如果您想记录对某个对象的方法调用，该对象必须至少实现一个接口。此外，AOP*在*建议方法中没有活动可见性；也就是说，您不能使用 AOP 实现的日志记录来记录方法中变量值的变化。

然而，在实践中，如果您试图将 AOP 追溯应用于现有应用程序，这主要是一个问题。无论如何，对接口进行编码是恕我直言的良好开发实践，如果您需要记录方法的内部工作，这很可能表明它们需要重构。

AOP 确实需要一些计划来实施，并且在您的编码实践中确实需要一定的纪律，但是，就像自动化单元测试一样，恕我直言，这通常只能用于提高代码质量。

        database - 您是否应该将自引用表列设为外键？

ID：246477

赞同：33

时间：2008-10-29T11:33:58.737

标签：database, database-design, foreign-keys

例如，要创建类别层次结构，您可以使用列“parent_id”，它指向同一个表中的另一个类别。

这应该是外键吗？缺点/优点是什么？

            回答 #1

赞同：32

时间：2008-10-29T11:40:55.807

是的。确保您没有孤儿（没有父项的条目），并且根据使用情况，如果您定义级联删除，当父项被删除时，其所有子项也将被删除。

缺点是会像任何其他外键一样对性能造成轻微影响。

            回答 #2

赞同：14

时间：2008-10-29T11:43:34.630

是的你应该。如果您在数据库关系中有一个属性作为同一数据库中另一个关系的主键，则应将其设为 FK。

您将享受与[外键相关的优势](http://dev.mysql.com/tech-resources/articles/mysql-enforcing-foreign-keys.html)：

*   假设关系设计正确，外键约束使程序员更难将不一致引入数据库。
*   由数据库服务器集中检查这些约束使得不必在应用程序端执行这些检查。这消除了不同应用程序可能无法以相同方式检查约束的可能性。
*   使用级联更新和删除可以简化应用程序代码。
*   正确设计的外键规则有助于记录表之间的关系。

缺点：

*   如果定义外键，有时会更难执行批量操作。
*   也许这意味着更多的磁盘使用和轻微的性能影响。

            回答 #3

赞同：6

时间：2008-10-29T11:43:39.077

是的你应该。

优点（对于任何外键）：

*   确保 parent_id 引用表中的真实行
*   防止意外删除有子级的父级，或确保删除级联也删除子级
*   提供优化器可以使用的信息

我想不出任何真正的缺点。

            回答 #4

赞同：4

时间：2008-10-29T11:37:41.990

是的，您应该将其设为外键。

好处将是具有更少冗余的更好的数据模型。

        asp.net - 检测何时在 ASP.NET 中禁用 JavaScript

ID：246480

赞同：11

时间：2008-10-29T11:36:54.380

标签：asp.net, javascript, controls, progressive-enhancement

在 ASP.NET Web 控件的 Render 方法中，我需要根据客户端浏览器上是否启用或禁用 JavaScript 来更改 Html 的输出，

有谁知道正确的咒语来解决这个问题？

            回答 #1

赞同：13

时间：2008-10-29T11:47:38.443

使用脚本检查是否启用了 javascript 的问题在于，您只有在脚本未运行后才能发现。

一些解决方案尝试相反 - 他们使用 javascript 设置一个值，然后在以后检测到该值时提供启用 Javascript 的控件。但是，对于 Firefox NoScript 插件等有时启用 javascript 的工具，这会失败。

一个更强大的解决方案是始终发送纯 HTML 兼容控件，然后在页面加载时运行 javascript 以添加正确的事件处理程序/额外的 DOM 元素/等。

但是我不知道这与 ASP.NET 方法对控件的影响如何。

            回答 #2

赞同：3

时间：2008-10-29T11:39:14.017

如果不执行脚本，则[noscript](http://www.w3schools.com/TAGS/tag_noscript.asp)标记用于定义替代内容（文本）。

编辑：嗨 Kieron，看看这个链接：[为 JavaScript 测试创建服务器控件](http://www.15seconds.com/issue/030303.htm)，并[检测是否在 ASPX 中启用了 JavaScript](http://www.codeproject.com/KB/aspnet/Detect_JavaScript_in_ASPX.aspx)

            回答 #3

赞同：3

时间：2008-10-29T11:49:33.683

The browser does not communicate Javascript availability with the request.

One thing that I have done, though I'm not sure it is applicable in your case, is generate the page as if Javascript is not enabled, then have some Javascript that turns off the HTML-only stuff and turns on the HTML-Javascript stuff.

You could also have the first page hit "phone home" via Javascript to record in the session whether Javascript is enabled or not.

            回答 #4

赞同：0

时间：2008-10-29T11:48:46.180

这是一种检查何时提交表单的方法。

[http://www.4guysfromrolla.com/webtech/082400-1.shtml](http://www.4guysfromrolla.com/webtech/082400-1.shtml)

我认为没有任何 Request 属性会告诉您何时首次请求该页面。有一个属性会告诉您浏览器是否支持 JS，但如果启用则不会。[看这里](http://msdn.microsoft.com/en-us/library/aa332781(VS.71,printer).aspx)

            回答 #5

赞同：0

时间：2017-12-27T16:52:46.493

What you need to do is this.  After much testing and late nights, I decided to use the most simple solution.  Drag a label onto the top of the page and make sure it reads "run at server".  Then, for the Text attribute, put Text="This website requires Javascript".  That should be the best answer.  :D

        java - 如何在 Java 中将 TIS-620 字符串转换为 UTF-8 字符串？

ID：246489

赞同：0

时间：2008-10-29T11:42:50.840

标签：java, string, type-conversion

如何在 Java 中将 TIS-620（扩展的 ASCII Thai 字符代码页）字符串转换为 UTF-8 字符串？

            回答 #1

赞同：1

时间：2008-10-29T11:50:25.913

```
import java.nio.ByteBuffer
import java.nio.CharBuffer 
```

……

```
public static ByteBuffer toByteBuffer(String content, String encode) {  
      Charset charset = Charset.forName(encode);  
      ByteBuffer bb = charset.encode(content);  
       return bb;  
   } 
```

作为编码参数“UTF-8”传递

            回答 #2

赞同：1

时间：2009-04-23T15:16:20.583

```
private byte[] convertTis620ToUTF8(byte[] encoded)
{
    try
    {
        String theString = new String(encoded, "TIS620");
        return theString.getBytes("UTF-8");
    } 
    catch(UnsupportedEncodingException uee)
    {
        /* Didn't work out */
    }
}

...

byte[] utf8 = convertTis620ToUTF8(tis620); 
```

此外，您可能需要将 charsets.jar 放在类路径中以支持 TIS620 编码。

        unit-testing - 存在哪些突变测试框架？

ID：246495

赞同：32

时间：2008-10-29T11:47:13.190

标签：unit-testing, frameworks, mutation-testing

在另一个[问题](https://stackoverflow.com/questions/242650/is-mutation-testing-useful-in-practice)中，我问[突变测试](http://en.wikipedia.org/wiki/Mutation_testing)在实践中是否有用。由于我没有得到任何让我满意的答案，我想自己检查一下当前的工具。所以我需要一个关于当前现有突变测试框架的概述。其中哪个最有用，为什么？

*   我用 Java 编程，所以我更喜欢 Java 工具，但我会冒险看看不同语言的有趣框架。
*   我想集成到一个自动构建过程中，所以我更喜欢可以通过命令行执行的工具。

            回答 #1

赞同：17

时间：2011-03-01T22:30:21.390

还有[PIT](http://pitest.org "坑")可以通过 maven 插件或命令行界面连接到您的构建中。

它提供的报告比其他具有组合突变和行覆盖的可用工具要好得多。它的运行速度也比 Jester 等基于源代码的 Java 工具快得多，大约是 Jumble 的两倍。

与 Jumble 和 Javalanche 不同，它还适用于所有主要的模拟框架（Mockito、JMock、EasyMock、PowerMock 和 JMockit）。

（披露我是作者）。

            回答 #2

赞同：16

时间：2012-04-23T14:45:16.800

我知道这是一个旧线程，但它仍然是问题的答案。我正在与一些朋友一起开发一个名为 NinjaTurtles 的开源 .NET 突变测试框架，您可以[在 CodePlex](http://ninjaturtles.codeplex.com/)和[Nuget 上](http://nuget.org/packages?q=ninjaturtles)找到该框架。主要项目网站在[这里](http://www.mutation-testing.net)。

            回答 #3

赞同：10

时间：2008-10-29T12:03:08.117

我只知道两个框架，但它们都适用于 Java :)

*   [小丑](http://jester.sourceforge.net/)
*   [杂乱无章](http://jumble.sourceforge.net/)

恐怕这两个我都没用过。

            回答 #4

赞同：10

时间：2011-06-15T19:29:09.120

CREAM 是 C#/.Net 的工具 
[http://galera.ii.pw.edu.pl/~adr/CREAM/index.php](http://galera.ii.pw.edu.pl/~adr/CREAM/index.php)

            回答 #5

赞同：5

时间：2009-02-13T11:17:32.697

Ruby 有[Heckle](http://glu.ttono.us/articles/2006/12/19/tormenting-your-tests-with-heckle)和一个叫[Boo_hiss](http://github.com/halorgium/boo_hiss/tree/master)的新人。

            回答 #6

赞同：3

时间：2009-04-15T09:35:56.367

对于 .Net 社区，有[NesTer](http://nester.sourceforge.net/)，但它有一些严重的局限性。例如，仅支持 C# 和 NUnit。

似乎也没有积极维护，但这可能是一个起点。

            回答 #7

赞同：3

时间：2010-01-28T07:56:10.353

我看了一下 Jester（实际的源代码），在我看来它不支持太多的突变。那里有一个文件，其中指定了这些突变。我可能对上述内容有误，但我绝对不喜欢从命令行启动工具和小 GUI 反馈界面之间的混合。为什么不像 JUnit 在 IDE 外运行时那样在命令行中提供反馈？

混乱是另一回事:)。它有一个简单的命令行界面，并带有一个 Eclipse 插件。反馈是控制台中的所有文本。我对这个工具很满意，我计划编写一些 ANT 目标来将它添加到我的项目持续集成中。

我也在看 Javalanche，但还没有尝试过。

几周后我会有消息。

            回答 #8

赞同：3

时间：2012-10-22T13:46:00.997

可能有点意思。微软研究院：[https ://pex4fun.com/](https://pex4fun.com/)

            回答 #9

赞同：2

时间：2008-10-29T12:13:48.923

你可以试试[µJava](http://cs.gmu.edu/~offutt/mujava/)。我没有使用过它，但看起来突变测试可能是评估测试套件的一种有趣方式。

            回答 #10

赞同：2

时间：2012-03-10T10:41:04.503

MμClipse 仅支持 JUnit 3，不再维护。至于Jester，很费力，需要复杂的配置；plus 不再维护。我能找到的最好的工具是 Javalanche
[我写了一篇关于这个的整篇文章！](http://blog.octo.com/en/mutation-testing-a-step-further-to-the-perfection/)

            回答 #11

赞同：0

时间：2010-02-15T15:42:13.233

Jester 确实为突变提供了一个文件，并且它们是有限的。在某种程度上，您可以将自己的突变添加到文件中。

我对 Jumble 和 Jester 进行了试验，发现 Jumble 提供了更多的突变和更好的文档。此外，当我向项目所有者发送电子邮件时，我得到了他们的快速回复。Jumble 的一个缺点是它使用 BCEL 对字节码进行操作。这对许多开发人员来说是一条学习曲线。

我的公司 State Farm 编写了一个 Ant 任务，我们可能会为 Jumble 项目做出贡献。根据我在他们的邮件列表中看到的内容，其他人也在为 Jumble 开发 Ant 任务。

我也在看Javalanche。完成后，我很乐意分享我所知道的。

        c# - 在 c# 中的特定时区创建日期时间

ID：246498

赞同：197

时间：2008-10-29T11:48:05.917

标签：c#, .net, datetime, timezone, .net-3.5

我正在尝试创建一个单元测试来测试机器上时区何时更改的情况，因为它已被错误地设置然后更正。

在测试中，我需要能够在非本地时区创建 DateTime 对象，以确保运行测试的人无论身在何处都可以成功地做到这一点。

从我从 DateTime 构造函数中可以看到，我可以将 TimeZone 设置为本地时区、UTC 时区或未指定。

如何创建具有特定时区（如 PST）的 DateTime？

            回答 #1

赞同：250

时间：2008-10-29T12:00:15.860

[Jon 的回答](https://stackoverflow.com/questions/246498/creating-a-datetime-in-a-specific-time-zone-in-c-fx-35#246512)谈到了[TimeZone](http://msdn.microsoft.com/en-us/library/system.timezone.aspx)，但我建议改用[TimeZoneInfo](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.aspx)。

就我个人而言，我喜欢尽可能保持 UTC 格式（至少在过去；为[*未来*](https://codeblog.jonskeet.uk/2019/03/27/storing-utc-is-not-a-silver-bullet/)[存储 UTC存在潜在问题](https://codeblog.jonskeet.uk/2019/03/27/storing-utc-is-not-a-silver-bullet/)*），所以我建议采用这样的结构：* *```
public struct DateTimeWithZone
{
    private readonly DateTime utcDateTime;
    private readonly TimeZoneInfo timeZone;

    public DateTimeWithZone(DateTime dateTime, TimeZoneInfo timeZone)
    {
        var dateTimeUnspec = DateTime.SpecifyKind(dateTime, DateTimeKind.Unspecified);
        utcDateTime = TimeZoneInfo.ConvertTimeToUtc(dateTimeUnspec, timeZone); 
        this.timeZone = timeZone;
    }

    public DateTime UniversalTime { get { return utcDateTime; } }

    public TimeZoneInfo TimeZone { get { return timeZone; } }

    public DateTime LocalTime
    { 
        get 
        { 
            return TimeZoneInfo.ConvertTime(utcDateTime, timeZone); 
        }
    }        
} 
```

您可能希望将“TimeZone”名称更改为“TimeZoneInfo”以使事情更清晰 - 我自己更喜欢更简短的名称。

* * *

## 回答 #2

> 赞同：65
> 
>             
> 
> 时间：2009-08-15T02:32:07.340

DateTimeOffset 结构正是为这种类型的使用而创建的。

请参阅：http:
 [//msdn.microsoft.com/en-us/library/system.datetimeoffset.aspx](http://msdn.microsoft.com/en-us/library/system.datetimeoffset.aspx)

下面是创建具有特定时区的 DateTimeOffset 对象的示例：

`DateTimeOffset do1 = new DateTimeOffset(2008, 8, 22, 1, 0, 0, new TimeSpan(-5, 0, 0));`

* * *

## 回答 #3

> 赞同：51
> 
>             
> 
> 时间：2012-01-27T00:24:49.180

这里的其他答案很有用，但它们没有具体介绍如何访问太平洋 - 你去吧：

```
public static DateTime GmtToPacific(DateTime dateTime)
{
    return TimeZoneInfo.ConvertTimeFromUtc(dateTime,
        TimeZoneInfo.FindSystemTimeZoneById("Pacific Standard Time"));
} 
```

奇怪的是，虽然“太平洋标准时间”通常意味着与“太平洋夏令时间”不同的东西，但在这种情况下，它通常指的是太平洋时间。事实上，如果您使用`FindSystemTimeZoneById`它来获取它，其中一个可用属性是一个布尔值，告诉您该时区当前是否处于夏令时。

您可以在一个库中看到更通用的示例，我最终根据用户要求的位置等来处理我在不同时区中需要的 DateTimes：

[https://github.com/b9chris/TimeZoneInfoLib.Net](https://github.com/b9chris/TimeZoneInfoLib.Net)

这在 Windows 之外不起作用（例如 Linux 上的 Mono），因为时间列表来自 Windows 注册表：
`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Time Zones\`

在其下方，您会找到键（注册表编辑器中的文件夹图标）；这些键的名称是您传递给`FindSystemTimeZoneById`. 在 Linux 上，您必须使用一组单独的 Linux 标准时区定义，我还没有充分探索。

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2014-04-03T06:47:01.260

我使用扩展方法为网络更改了[Jon Skeet 的答案。](https://stackoverflow.com/a/246529/1063571)它也像魅力一样适用于天蓝色。

```
public static class DateTimeWithZone
{

private static readonly TimeZoneInfo timeZone;

static DateTimeWithZone()
{
//I added web.config <add key="CurrentTimeZoneId" value="Central Europe Standard Time" />
//You can add value directly into function.
    timeZone = TimeZoneInfo.FindSystemTimeZoneById(ConfigurationManager.AppSettings["CurrentTimeZoneId"]);
}

public static DateTime LocalTime(this DateTime t)
{
     return TimeZoneInfo.ConvertTime(t, timeZone);   
}
} 
```

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2013-12-10T20:13:18.143

我喜欢 Jon Skeet 的回答，但想补充一件事。我不确定 Jon 是否期望 ctor 总是在本地时区传递。但我想将它用于其他地方的情况。  

我正在从数据库中读取值，并且我知道该数据库所在的时区。所以在 ctor 中，我将传入数据库的时区。但是我想要当地时间的价值。Jon 的 LocalTime 不会返回转换为本地时区日期的原始日期。它返回转换为原始时区的日期（无论您传递给 ctor）。

我认为这些属性名称清楚...

```
public DateTime TimeInOriginalZone { get { return TimeZoneInfo.ConvertTime(utcDateTime, timeZone); } }
public DateTime TimeInLocalZone    { get { return TimeZoneInfo.ConvertTime(utcDateTime, TimeZoneInfo.Local); } }
public DateTime TimeInSpecificZone(TimeZoneInfo tz)
{
    return TimeZoneInfo.ConvertTime(utcDateTime, tz);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T11:51:21.590

您必须为此创建一个自定义对象。您的自定义对象将包含两个值：

*   日期时间值

*   时[区](http://msdn.microsoft.com/en-us/library/system.timezone.aspx)对象

不确定是否已经存在 CLR 提供的数据类型，但至少 TimeZone 组件已经可用。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2019-10-01T16:39:38.463

使用**TimeZones**类可以轻松创建时区特定日期。

```
TimeZoneInfo.ConvertTime(DateTime.Now, TimeZoneInfo.FindSystemTimeZoneById(TimeZones.Paris.Id)); 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2021-09-16T08:46:36.500

尝试`TimeZoneInfo.ConvertTime(dateTime, sourceTimeZone, destinationTimeZone)`

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2021-11-10T12:46:38.907

对于具有特定时区（既不是本地的，也不是UTC）的偏移量的日期/时间，您可以使用 DateTimeOffset 类：

```
 var time = TimeSpan.Parse("9:00");
  var est = TimeZoneInfo.FindSystemTimeZoneById("Eastern Standard Time");
  var nationalDateTime = new DateTimeOffset(DateTime.Today.Ticks + time.Ticks, est.BaseUtcOffset); 
```

# oop - 数据库专家问：面向对象的设计理论？

> ID：246499
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-29T11:48:18.617
> 
>         
> 
> 标签：oop, solid-principles, package-design

我在设计数据库方面工作了很长时间，而这些天我也在 C# 中工作。OO 对我来说很有意义，但我觉得我对 OO 设计的深层理论没有很好的基础。

在数据库领域，有很多关于如何设计数据库结构的理论，主要概念是规范化。规范化直接控制数据库的结构，并在一定程度上决定了如何在数据库中排列实体。

如何设计面向对象程序的结构背后是否有类似的概念？

我所追求的是一个或多个基本理论原则，它们自然地引导开发人员为解决给定问题进行“正确”设计。

我在哪里可以找到更多信息？

有没有我应该阅读的工作？

## 更新：

感谢大家的回答。我正在阅读的内容似乎是说没有“面向对象设计的大理论”，但是有许多重要的原则——这些原则在很大程度上以设计模式为例。

再次感谢您的回答:)

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2008-10-29T13:12:00.677

小心一些设计模式文献。

有几种广泛的类定义。持久对象（类似于关系表中的行）和集合（类似于表本身）的类是一回事。

一些“[四人组](https://rads.stackoverflow.com/amzn/click/com/0201633612)”设计模式更适用于活动对象、应用程序对象，而不太适用于持久对象。**当你通过抽象工厂**之类的东西挣扎时，你会错过一些面向对象设计的关键点，因为它适用于持久对象。

对象导师[什么是面向对象设计？](http://www.objectmentor.com/omSolutions/oops_what.html)page 有许多人真正需要知道的从关系设计过渡到 OO 设计。

顺便说一句，规范化并不是始终适用于关系数据库的一揽子设计原则。当您有更新事务时应用规范化，以防止更新异常。这是一个 hack，因为关系数据库是被动的东西；您要么必须添加处理（例如类中的方法），要么必须通过一堆规则（规范化）。在数据仓库世界中，更新很少（或不存在）标准规范化规则不那么相关。

因此，对象数据模型没有“这样的标准化”。  

在 OO 设计中，设计持久对象最重要的规则可能是[单一职责原则](http://www.objectmentor.com/resources/articles/srp.pdf)。  

如果您将类设计为对真实世界的对象具有良好的保真度，**并且**以一种非常集中的方式为这些类分配职责，那么您将对您的对象模型感到满意。您将能够以相对较少的复杂性将其映射到关系数据库。

事实证明，当你从责任的角度来看事情时，你会发现 2NF 和 3NF 规则符合合理的责任分配。唯一键仍然很重要。派生数据成为方法函数的职责，而不是持久属性。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2008-10-29T11:51:02.977

“设计模式”一书是您的下一步。

[http://www.amazon.com/Design-Patterns-Object-Oriented-Addison-Wesley-Professional/dp/0201633612](https://rads.stackoverflow.com/amzn/click/com/0201633612)   

但是，您不必对所有事情都使用 OO 方法。不要对此抱有宗教色彩。如果更程序化的方法感觉更严格，那就去吧。刚接触 OO 的人往往会迟到一段时间。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2008-10-29T12:04:00.753

我认为[敏捷软件开发、原则、模式和实践](https://rads.stackoverflow.com/amzn/click/com/0135974445)非常好。

[它对此处](http://www.objectmentor.com/omSolutions/oops_what.html)列出的 OO 原则提供了很多深入的讨论：

*   面向对象设计和依赖管理的原则

*   SRP——单一职责原则

*   OCP——开闭原则

*   LSP — Liskov 替换原则

*   DIP——依赖倒置原则

*   ISP——接口隔离原则

*   REP——重用发布等效原则

*   CCP——共同关闭原则

*   CRP——通用重用原则

*   ADP——非循环依赖原则

*   SDP——稳定依赖原则

*   SAP——稳定的抽象原则

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T11:53:43.270

如果您习惯于构建规范化的数据库，那么面向对象的设计对您来说应该很自然。你的类结构最终看起来很像你的数据结构，除了关联表变成列表和查找表变成类中的枚举之外。

总而言之，我会说你进入具有关系数据库背景的 OO 设计比你转向另一个方向要好得多。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T11:59:02.713

如果您想真正掌握 OO，请使用[Smalltalk](http://www.cincomsmalltalk.com)。ST 是一种*纯粹*的OO 语言，而且很直接。一旦你克服了范式驼峰，你就学会了面向对象，因为没有它你就无法真正做 Smalltalk。这就是我第一次学习 OO 的方式。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T11:51:00.967

检查这个[结果](https://stackoverflow.com/questions/tagged/object-oriented-design)。从每个问题中学习。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T11:53:42.253

我真的很喜欢[Head First Design Patterns](http://www.amazon.co.uk/gp/product/0596007124/ref=sib_rdr_dp)，它*非常*平易近人，以及Arthur J. Riel的优秀[的面向对象设计启发式](http://www.amazon.co.uk/Object-oriented-Design-Heuristics-Arthur-Riel/dp/020163385X/ref=sr_1_1?ie=UTF8&s=books&qid=1225281229&sr=1-1)

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T12:00:57.357

去大卫韦斯特的对象思维。一本有趣的书……

虽然你来自黑暗的一面……根据这本书；）数据库思维一直是 OO 程序员的诅咒。它们是光谱的两端。例如

*   数据库思维将数据属性置于其他一切之上。标准化并根据它们如何适合 DB Schema 或 ER 图来创建类型。OO 思维基于行为和协作创建类型，并且不认为数据属性很重要。

*   数据库来自那些重视形式化和方法高于一切的科学家。OO 来自那些使用启发式和经验法则并在艰难而快速的过程中重视个性和社交互动的人。

关键是 COBOL 程序员即使在转向 OO 语言之后也可以编写 COBOL 程序。查看第一部分的任何一本书，比如 Thinking in Java，它总是详细说明 OO（学徒）的原则。接着是 Object Thinking（journeyman），并在适当的时候成为大师。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T12:01:03.630

[这个网站列出了 101 个标题](http://sourcemaking.com/design-patterns-and-tips)......设计模式、重构和其他......看看它......这将是一个很好的起点......

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T12:13:17.987

通过牢记真实世界的对象来建模您的对象。

我们目前正在为机器开发自动化软件。其中一台机器有两个装载口用于喂入原材料，而所有其他机器只有一个。到目前为止，在所有模块中，我们将端口信息（当前设置、当前分配给它的批号等）作为代表机器的类中的成员。

我们决定创建一个保存端口信息的新类，并将两个 LoadPort 成员添加到此 MachineXY 类。如果我们之前考虑过，我们会对所有那些单端口机器做同样的事情......

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T11:50:32.667

你应该看看UML，它是一个给OOD的整个过程。

我建议买一本书（或几本书），因为理论非常庞大，大多数人都会挑选最适合手头项目的技术。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T11:51:01.997

开始阅读 Martin Fowler 所说的设计模式。:)

它们是 OOP 最实际的用途。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T12:00:57.293

我猜你的意思是数据库世界中的面向对象。

存储对象的面向对象数据库从未真正抓住过一个，因此您目前正在寻找将对象映射到关系数据库。ORM 或对象关系映射是用于描述执行此映射的软件的术语。理想情况下，这为您提供了两全其美的优势，开发人员可以与对象进行交互，并且在数据库中，所有内容都存储在可以进行标准调整的关系表中。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2011-06-29T19:57:31.403

DBA 的俚语：面向对象设计不过是在安全操作接口后面适当规范化的数据，安全的意思，看操作，而不是直接看数据

# ruby-on-rails - 如何使用 rake 为特定插件生成 rDoc

> ID：246503
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-29T11:49:42.887
> 
>         
> 
> 标签：ruby-on-rails, ruby, rake, rdoc

好的，我正在尝试为回形针生成 rDoc，但是 rake 任务在到达另一个插件之前就被另一个插件阻塞了，所以这是不可能的：

```
rake doc:plugins 
```

我可以去修复损坏的插件，但我又忙又懒，所以我只想为回形针生成文档。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T11:50:53.040

难以置信，我刚刚想通了！

```
rake doc:plugins:paperclip 
```

那很简单。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T11:51:11.683

您始终可以从插件的单个目录运行 rdoc。这不会将它包含在您项目的 /doc 文件夹中，但它会在插件内创建一个 /doc 文件夹，您可以浏览该文件夹

# mfc - DrawItem() 方法重复执行

> ID：246518
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T11:55:47.867
> 
>         
> 
> 标签：mfc, listbox

我在派生自 CListBox 的 CMyListBox 类上使用了所有者绘制的策略。我只希望在列表框中插入项目时执行 DrawItem() 方法。但是该方法被多次调用。我如何更改以在需要时调用它。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T12:13:29.127

您始终可以通过将内容输出到内存位图然后绘制它来缓存初始绘图，这确实意味着您需要跟踪某些内容何时发生更改，以便您可以再次运行实际的渲染代码。如果有很多渲染代码，它确实可以节省每次运行渲染代码。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:14:04.260

我已经完全按照 Kieron 建议的方式缓存位图，但***仅***在非常昂贵的渲染代码中。实际上，我必须保留多个缓存的“状态”，具体取决于项目是否突出显示、禁用、正常等（这是用于工具栏按钮，而不是 listitem - 但我认为它适用）。我只在第一次需要时缓存预渲染的图像——这样我只缓存我实际需要的“状态”。

我的绘图是纯 GDI 调用。主要是位图操作和其他只需要时间的绘图，加上我经常被重绘（没有充分的理由 - 长篇大论）。

改变我正在使用的框架（MFC 和 Stingray）中的基础不是一个选项。在所有其他优化都不够好（该死的慢虚拟机！！）之后，缓存是最后的手段。

通常，当您无效时（在这种情况下为 DrawItem），绘图*速度足够快。*我会看看你在 DrawItem 中到底在做什么。除非没有其他选项，否则我会研究渲染所需的缓存数据和计算，而**不是渲染本身（例如最终位图）。**

另外，我读到 Vista 渲染更加优化，它们缓存您在窗口上绘制的内容，以减少包含无效/重绘周期，例如，当一个窗口从另一个窗口移动时。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T12:06:00.483

只要需要在列表框中绘制任何给定项目，就会调用 DrawItem() 方法。如果您不响应它，您可能会在列表框中获得一个空白区域，其中绘制的数据已被擦除并且您没有刷新它。如果你真的不认为绘图是必要的，你可以做类似的事情

```
void CMyListBox::DrawItem( LPDRAWITEMSTRUCT lpDrawItemStruct )
{
   if (!m_DrawingEnabled)
     return;
} 
```

其中 m_DrawingEnabled 是您为停止不必要的绘制而维护的成员，

# c# - 如何在 C# Web 应用程序中查找用户的 Active Directory 显示名称？

> ID：246520
> 
>         
> 
> 赞同：22
> 
>         
> 
> 时间：2008-10-29T11:56:43.747
> 
>         
> 
> 标签：c#, active-directory

我正在编写一个使用 Windows 身份验证的 Web 应用程序，我可以很高兴地使用以下内容获取用户的登录名：

```
 string login = User.Identity.Name.ToString(); 
```

但我不需要他们的登录名，我想要他们的 DisplayName。我已经敲了几个小时的头了...

我可以通过 Web 应用程序访问我组织的 AD 吗？

* * *

## 回答 #1

> 赞同：29
> 
>             
> 
> 时间：2008-10-29T13:01:40.060

这个怎么样：

```
private static string GetFullName()
    {
        try
        {
            DirectoryEntry de = new DirectoryEntry("WinNT://" + Environment.UserDomainName + "/" + Environment.UserName);
            return de.Properties["displayName"].Value.ToString();
        }
        catch { return null; }
    } 
```

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2008-10-29T12:47:18.310

请参阅相关问题：[Active Directory：检索用户信息](https://stackoverflow.com/questions/132277/active-directory-retrieve-user-information)

另请参阅：[Howto：（几乎）通过 C# 在 Active Directory 中的所有](http://www.codeproject.com/KB/system/everythingInAD.aspx)内容，更具体地说，“[枚举对象的属性](http://www.codeproject.com/KB/system/everythingInAD.aspx#26)”部分。

如果您有连接到域中组的路径，以下代码段可能会有所帮助：

```
GetUserProperty("<myaccount>", "DisplayName");

public static string GetUserProperty(string accountName, string propertyName)
{
    DirectoryEntry entry = new DirectoryEntry();
    // "LDAP://CN=<group name>, CN =<Users>, DC=<domain component>, DC=<domain component>,..."
    entry.Path = "LDAP://...";
    entry.AuthenticationType = AuthenticationTypes.Secure;

    DirectorySearcher search = new DirectorySearcher(entry);
    search.Filter = "(SAMAccountName=" + accountName + ")";
    search.PropertiesToLoad.Add(propertyName);

    SearchResultCollection results = search.FindAll();
    if (results != null && results.Count > 0)
    {
        return results[0].Properties[propertyName][0].ToString();
    }
    else
    {
            return "Unknown User";
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2013-04-03T08:56:45.067

用这个：

`string displayName = UserPrincipal.Current.DisplayName;`

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2008-11-11T13:00:25.123

万一有人在乎，我设法破解了这个：

```
 /// This is some imaginary code to show you how to use it

      Session["USER"] = User.Identity.Name.ToString();
      Session["LOGIN"] = RemoveDomainPrefix(User.Identity.Name.ToString()); // not a real function :D
      string ldappath = "LDAP://your_ldap_path";
      // "LDAP://CN=<group name>, CN =<Users>, DC=<domain component>, DC=<domain component>,..."

      Session["cn"] = GetAttribute(ldappath, (string)Session["LOGIN"], "cn");
      Session["displayName"] = GetAttribute(ldappath, (string)Session["LOGIN"], "displayName");
      Session["mail"] = GetAttribute(ldappath, (string)Session["LOGIN"], "mail");
      Session["givenName"] = GetAttribute(ldappath, (string)Session["LOGIN"], "givenName");
      Session["sn"] = GetAttribute(ldappath, (string)Session["LOGIN"], "sn");

/// working code

public static string GetAttribute(string ldappath, string sAMAccountName, string attribute)
    {
        string OUT = string.Empty;

        try
        {
            DirectoryEntry de = new DirectoryEntry(ldappath);
            DirectorySearcher ds = new DirectorySearcher(de);
            ds.Filter = "(&(objectClass=user)(objectCategory=person)(sAMAccountName=" + sAMAccountName + "))";

            SearchResultCollection results = ds.FindAll();

            foreach (SearchResult result in results)
            {
                OUT =  GetProperty(result, attribute);
            }
        }
        catch (Exception t)
        {
            // System.Diagnostics.Debug.WriteLine(t.Message);
        }

        return (OUT != null) ? OUT : string.Empty;
    }

public static string GetProperty(SearchResult searchResult, string PropertyName)
    {
        if (searchResult.Properties.Contains(PropertyName))
        {
            return searchResult.Properties[PropertyName][0].ToString();
        }
        else
        {
            return string.Empty;
        }
    } 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T13:17:30.340

如果您有兴趣，有一个用于[Linq to AD](http://www.codeplex.com/LINQtoAD)的 CodePlex 项目。

Paul Kimmel所著的*[LINQ Unleashed for C#](https://rads.stackoverflow.com/amzn/click/com/0672329832)*一书中也介绍了这一点——他使用上述项目作为他的起点。

*不隶属于任何一个来源 - 我最近刚读过这本书*

# .net - 长时间保持对行对象的“引用”

> ID：246521
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-29T11:58:07.363
> 
>         
> 
> 标签：.net, linq, linq-to-sql, .net-3.5

在我的应用程序中，我保留从数据库中获取的 LINQ 对象，并定期修改它，然后是`db.SubmitChanges()`.

我已经读到您不应该`DataContext`长时间围绕该物体。但是如果我关闭我`DataContext`的修改，我猜数据对象会失去它与实际数据库行的链接。

保持 DataContext 打开的最佳选择是什么？每次我想更新它时，我真的必须重新加载行吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T17:26:54.720

否则，您可以对数据库执行直接 SQL 查询，以尽可能快地进行更新。

由于并发问题，由于过度比较，默认 Linq UPDATE 语句不是最佳的。查看 SQL 分析器或使用 Linq SQL 可视化器。

//安迪

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T15:35:28.563

在您想要更新该行时重新加载该行应该不会对性能造成太大影响，并且它将保证您正在更新该行的最新版本（以防其他用户/进程在您第一次打开它后对其进行了修改）。

如果您不知道任何其他内容会更新该行，那么您可能会保留 DataContext 而不会出现太大问题（除非失去与数据库的连接）。

# python - 如何使用 Python 的 PIL 绘制贝塞尔曲线？

> ID：246525
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2008-10-29T11:59:08.390
> 
>         
> 
> 标签：python, python-imaging-library, bezier, imaging

我正在使用 Python 的成像库，我想绘制一些贝塞尔曲线。我想我可以逐像素计算，但我希望有更简单的东西。

* * *

## 回答 #1

> 赞同：24
> 
>             
> 
> 时间：2010-02-18T22:23:02.333

```
def make_bezier(xys):
    # xys should be a sequence of 2-tuples (Bezier control points)
    n = len(xys)
    combinations = pascal_row(n-1)
    def bezier(ts):
        # This uses the generalized formula for bezier curves
        # http://en.wikipedia.org/wiki/B%C3%A9zier_curve#Generalization
        result = []
        for t in ts:
            tpowers = (t**i for i in range(n))
            upowers = reversed([(1-t)**i for i in range(n)])
            coefs = [c*a*b for c, a, b in zip(combinations, tpowers, upowers)]
            result.append(
                tuple(sum([coef*p for coef, p in zip(coefs, ps)]) for ps in zip(*xys)))
        return result
    return bezier

def pascal_row(n, memo={}):
    # This returns the nth row of Pascal's Triangle
    if n in memo:
        return memo[n]
    result = [1]
    x, numerator = 1, n
    for denominator in range(1, n//2+1):
        # print(numerator,denominator,x)
        x *= numerator
        x /= denominator
        result.append(x)
        numerator -= 1
    if n&1 == 0:
        # n is even
        result.extend(reversed(result[:-1]))
    else:
        result.extend(reversed(result))
    memo[n] = result
    return result 
```

例如，这画了一颗心：

```
from PIL import Image
from PIL import ImageDraw

if __name__ == '__main__':
    im = Image.new('RGBA', (100, 100), (0, 0, 0, 0)) 
    draw = ImageDraw.Draw(im)
    ts = [t/100.0 for t in range(101)]

    xys = [(50, 100), (80, 80), (100, 50)]
    bezier = make_bezier(xys)
    points = bezier(ts)

    xys = [(100, 50), (100, 0), (50, 0), (50, 35)]
    bezier = make_bezier(xys)
    points.extend(bezier(ts))

    xys = [(50, 35), (50, 0), (0, 0), (0, 50)]
    bezier = make_bezier(xys)
    points.extend(bezier(ts))

    xys = [(0, 50), (20, 80), (50, 100)]
    bezier = make_bezier(xys)
    points.extend(bezier(ts))

    draw.polygon(points, fill = 'red')
    im.save('out.png') 
```

* * *

## 回答 #2

> 赞同：13
> 
>             
> 
> 时间：2008-10-29T12:39:15.877

自己画贝塞尔曲线并不难。给定三个点`A`, `B`，`C`您需要三个线性插值来绘制曲线。我们使用标量`t`作为线性插值的参数：

```
P0 = A * t + (1 - t) * B
P1 = B * t + (1 - t) * C 
```

这在我们创建的两条边之间进行插值，边 AB 和边 BC。我们现在唯一需要做的就是计算我们必须绘制的点，使用相同的 t 在 P0 和 P1 之间进行插值，如下所示：

```
Pfinal = P0 * t + (1 - t) * P1 
```

在我们实际绘制曲线之前，需要做几件事。首先，我们将走一些`dt`（delta t），我们需要意识到`0 <= t <= 1`. 正如您可能想象的那样，这不会给我们一个平滑的曲线，而是只产生一组离散的位置来绘制。解决这个问题的最简单方法是简单地在当前点和前一个点之间画一条线。

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2008-10-29T14:09:59.750

您可以在 PIL 之上使用[aggdraw ，](http://effbot.org/zone/aggdraw-index.htm)[支持](http://effbot.org/zone/pythondoc-aggdraw.htm#aggdraw.Path-class)贝塞尔曲线。

**编辑：**

我做了一个例子只是为了发现`Path`类中有一个关于`curveto`:(

无论如何，这是示例：

```
from PIL import Image
import aggdraw

img = Image.new("RGB", (200, 200), "white")
canvas = aggdraw.Draw(img)

pen = aggdraw.Pen("black")
path = aggdraw.Path()
path.moveto(0, 0)
path.curveto(0, 60, 40, 100, 100, 100)
canvas.path(path.coords(), path, pen)
canvas.flush()

img.save("curve.png", "PNG")
img.show() 
```

如果您准备重新编译模块，[这应该可以修复错误...](http://www.mail-archive.com/image-sig@python.org/msg02108.html)

* * *

## 回答 #4

> 赞同：6
> 
>             
> 
> 时间：2014-01-28T20:58:36.973

尽管如@ToniRuža 所述，贝塞尔曲线路径不适用于Aggdraw，但在Aggdraw 中还有另一种方法可以做到这一点。使用 Aggdraw 而不是 PIL 或您自己的贝塞尔函数的好处是 Aggdraw 将对图像进行抗锯齿，使其看起来更平滑（见底部图片）。

**聚集符号**

不用 aggdraw.Path() 类来绘制，你可以使用`aggdraw.Symbol(pathstring)`基本相同的类，除了你把路径写成字符串。根据 Aggdraw 文档，将路径编写为字符串的方法是使用 SVG 路径语法（参见：[http](http://www.w3.org/TR/SVG/paths.html) ://www.w3.org/TR/SVG/paths.html ）。基本上，路径的每个添加（节点）通常以

*   一个代表绘图动作的字母（大写表示绝对路径，小写表示相对路径），后跟（中间没有空格）

*   x 坐标（如果它是负数或方向，则在前面加上减号）

*   逗号

*   y 坐标（如果它是负数或方向，则在前面加上减号）

在您的路径字符串中，只需用空格分隔多个节点。创建符号后，只需记住将其作为参数之一传递给`draw.symbol(args)`.

**Aggdraw 符号中的贝塞尔曲线**

特别是对于三次贝塞尔曲线，您可以写字母“C”或“c”，后跟 6 个数字（3 组 xy 坐标 x1,y1,x2,y2,x3,y3，数字之间有逗号，但第一个数字和信）。根据文档，还有其他贝塞尔版本，使用字母“S（平滑三次贝塞尔曲线）、Q（二次贝塞尔曲线）、T（平滑二次贝塞尔曲线）”。这是一个完整的示例代码（需要 PIL 和 aggdraw）：

```
print "initializing script"

# imports
from PIL import Image
import aggdraw

# setup
img = Image.new("RGBA", (1000,1000)) # last part is image dimensions
draw = aggdraw.Draw(img)
outline = aggdraw.Pen("black", 5) # 5 is the outlinewidth in pixels
fill = aggdraw.Brush("yellow")

# the pathstring:
#m for starting point
#c for bezier curves
#z for closing up the path, optional
#(all lowercase letters for relative path)
pathstring = " m0,0 c300,300,700,600,300,900 z"

# create symbol
symbol = aggdraw.Symbol(pathstring)

# draw and save it
xy = (20,20) # xy position to place symbol
draw.symbol(xy, symbol, outline, fill)
draw.flush()
img.save("testbeziercurves.png") # this image gets saved to same folder as the script

print "finished drawing and saved!" 
```

输出是一个看起来光滑的贝塞尔曲线图：
![上述脚本使用 aggdraw 贝塞尔曲线符号的结果](https://i.stack.imgur.com/tqW5g.png)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2017-08-23T15:29:12.957

我找到了一种更简单的方法来创建贝塞尔曲线（没有 aggraw 也没有复杂的函数）。

```
import math
from PIL import Image
from PIL import ImageDraw

image = Image.new('RGB',(1190,841),'white')
draw = ImageDraw.Draw(image)
curve_smoothness = 100

#First, select start and end of curve (pixels)
curve_start = [(167,688)] 
curve_end = [(678,128)]

#Second, split the path into segments
curve = [] 
for i in range(1,curve_smoothness,1):
    split = (curve_end[0][0] - curve_start[0][0])/curve_smoothness
    x = curve_start[0][0] + split * i 
    curve.append((x, -7 * math.pow(10,-7) * math.pow(x,3) - 0.0011 * math.pow(x,2) + 0.235 * x + 682.68))

#Third, edit any other corners of polygon
other =[(1026,721), (167,688)]

#Finally, combine all parts of polygon into one list
xys = curve_start + curve + curve_end + other #putting all parts of the polygon together
draw.polygon(xys, fill = None, outline = 256)

image.show() 
```

# desktop-application - 当用户在运行时弄乱其文件时，如何防止我的桌面应用程序严重崩溃？

> ID：246536
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T12:02:25.030
> 
>         
> 
> 标签：desktop-application, application-design, defensive-programming

例如在运行期间删除输出文件，将 sw 的两个实例定向到同一个 IO 等？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-10-29T12:07:29.747

您无法阻止用户这样做，但您可以做的是应用[防御性编程](http://en.wikipedia.org/wiki/Defensive_programming)。

在您的两个示例中，您必须在每次访问资源时检测故障情况并做出适当的反应，要么抛出异常并死去，要么在无法访问该资源的情况下继续。

永远不要假设资源分配会成功，始终检查您无法控制的内容。简而言之，**尽可能少地假设并验证一切**。

*'我被告知访问此文件以写入它。它已经开放了吗？我有权限吗？它有预期的格式吗？磁盘是否有足够的空间？ETC。'*

关于这一点还有很多。只是谷歌防御性编程，你会读到很多东西。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T12:10:54.653

假设什么。每次都检查每个使用 IO 的操作。在您的软件中添加一个额外的层，用于内置检查的 IO。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T12:20:12.000

在 UI 上的每个文本框或编辑控件上设置最大输入长度。测试输入无效数据（例如，编辑中需要数字的文本），并采用一种通用的方法来检查/处理这种输入。

还要考虑通过搜索词进行的 SQL 注入攻击。例如查找姓氏为___的人，用户输入“*smith”；select * from users*"。数据库层将如何处理它？

如果用户输入的数据将显示给他们（或者更糟糕的是，显示给其他用户），请查看他们是否可以将任何标记或控制序列嵌入其中，从而在显示时滥用 UI。

您没有说明您的目标是什么操作系统和语言，而是着眼于为应用程序提供执行所需的最低权限。例如在.Net 中，查看声明性安全属性。这意味着，如果攻击者控制了您的应用程序，他们可以对它造成的损害就会减少。

创建带有故意错误输入的单元测试，以验证应用程序是否可以处理它。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:46:28.423

这里有一些很好的答案，但我认为你需要考虑你要防御什么。

该程序是否会被想要使用它的人使用？如果是这样，您需要防御愚蠢（在实际范围内）而不是破坏。您仍然想检查所有输入，但如果用户确实做了一些愚蠢的事情，那么得到不太理想的结果是合理的。如果用户有权访问系统，您可能无法阻止删除输出文件等操作，因此您无法为其编写代码。有些事情只是培训问题。

该程序是否会被不想要的人使用，例如用于记录人们何时进出的时钟应用程序？有人需要考虑物理安全（商业版本被设计成会被大量滥用）和软件安全（所以没有人可以改变时代）。您需要提供一个非常简单的界面并详细检查输入。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T15:21:25.173

如果有优秀的测试人员来模拟用户滥用呢？

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T15:27:14.570

这是一个棘手的问题。用户（甚至是愚蠢的用户）可以巧妙地以您从未考虑过的方式使用您的应用程序。

我是防御性编程的忠实粉丝（正如 Vinko 上面提到的）。您可以从危害分析的角度来处理它。查看您的应用程序使用和修改的资源（文件、设备、数据等），并集思广益这些资源可能出现的问题并围绕它进行计划。  

例如，如果您有一个专用的硬件资源，并且应用程序的多个实例将各自争夺该资源，您可以为您的应用程序强制使用单例模式，以便用户无法运行多个实例。

所有这一切都需要一些计划和工作，但是，嘿，这就是我们得到报酬的原因:)

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:30:02.623

我听说有人在做的一件事是在[VirtualPC](http://www.microsoft.com/windows/products/winfamily/virtualpc/overview.mspx)下运行不受信任的东西，这样基础系统无论如何都不会受到损坏。

# apache - Apache/Tomcat 错误 - 传递错误的页面

> ID：246540
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2008-10-29T12:03:33.810
> 
>         
> 
> 标签：apache, tomcat, ajp

这个错误一直让我发疯。我们有一台运行 Apache 和 Tomcat 的服务器，为多个不同的站点提供服务。通常服务器运行良好，但有时会在为人们提供错误页面的地方发生错误 -***其他人*****请求****的页面！**

 *线索：

*   正在传递的页面是其他用户最近请求的页面，否则会正确传递。众所周知，两个同时请求被交换。据我所知，错误传递的页面都没有超过几分钟。

*   它只影响 Tomcat 提供的文件。图像等静态文件不受影响。

*   它不会一直发生。当它发生时，它会发生在每个人身上。

*   它似乎发生在需求高峰期。然而，需求还不是很高——它肯定在 Apache 可以应付的范围内。

*   重新启动 Tomcat 修复它，但只有几分钟。重新启动 Apache 修复了它，但只有几分钟。

*   服务器运行 Apache 2 和 Tomcat 6，在 Gentoo 上使用 Java 6 VM。与 AJP13 的连接，块`JkMount`内的指令`<VirtualHost>`是正确的。

*   任何日志文件都没有任何用处。

* * *

**更多的信息：**

Apache 没有开启任何形式的缓存。httpd.conf 和相关导入中所有与缓存相关的条目都说，例如：

```
<IfDefine CACHE>
  LoadModule cache_module modules/mod_cache.so
</IfDefine> 
```

虽然 Apache 的选项不包括该标志：

```
APACHE2_OPTS="-D DEFAULT_VHOST -D INFO -D LANGUAGE -D SSL -D SSL_DEFAULT_VHOST -D PHP5 -D JK" 
```

Tomcat 同样没有打开缓存选项，我可以找到。

[工具包的建议](https://stackoverflow.com/questions/246540/apachetomcat-error-wrong-pages-being-delivered#246566)很好，但在这种情况下不合适。是什么让我相信错误不可能出现在我自己的代码中，因为它不仅仅是正在传输的几个值 - 它是整个请求，包括 URL、参数、会话 cookie 等等。人们正在返回显示“您以 John 身份登录”的页面，而他们显然不是。

* * *

**更新：**

根据几个人的建议，我将向 Tomcat 服务的页面添加以下 HTTP 标头以禁用所有形式的缓存：

```
Cache-Control: no-store
Vary: * 
```

希望这些标头不仅会受到 Apache 的尊重，而且还会受到任何其他可能阻碍的缓存或代理的尊重。不幸的是，我没有办法故意重现这个错误，所以我只能等着看它是否会再次出现。

我注意到包含以下标题 - 它们可以以任何方式相关吗？

```
Connection: Keep-Alive
Keep-Alive: timeout=5, max=66 
```

* * *

**更新：**

显然这在我睡着的时候又发生了，但现在已经停止发生了，我醒着看到它。同样，我可以看到日志中没有任何有用的信息，因此我不知道实际发生了什么或如何防止它。

是否有任何额外的信息可以放入 Apache 或 Tomcat 的日志中以使其更易于诊断？

* * *

**更新：**

由于这种情况再次发生了几次，我们改变了 Apache 连接到 Tomcat 的方式，看看它是否会影响事情。我们使用`mod_jk`这样的指令：

```
JkMount /portal ajp13 
```

我们现在切换到 using `mod_proxy_ajp`，如下所示：

```
ProxyPass /portal ajp://localhost:8009/portal 
```

我们会看看它是否有什么不同。这个错误总是令人讨厌地不可预测，所以我们永远无法确定它是否有效。

* * *

**更新：**

我们刚刚在使用 的站点上短暂收到错误`mod_jk`，而同一服务器上使用的姊妹站点`mod_proxy_ajp`没有显示错误。这并不能证明什么，但它确实提供了证据表明切换到`mod_proxy_ajp`可能有所帮助。

* * *

**更新：**

我们昨晚在使用 的网站上再次遇到错误`mod_proxy_ajp`，很明显这并没有解决它 -`mod_jk`不是问题的根源。我将尝试关闭持久连接的匿名建议：

```
KeepAlive Off 
```

如果这也失败了，我会绝望地开始调查 GlassFish。

* * *

**更新：**

该死！问题刚刚回来。我有一段时间没看到它了，所以我开始认为我们终于把它整理好了。我讨厌海森虫。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-10-29T12:14:51.370

这可能是您的 servlet 的线程安全性吗？

您的 servlet 是否在实例成员中存储任何信息。

例如，像下面这样简单的事情可能会导致与线程相关的问题：

```
public class MyServlet ... {
    private String action;

    public void doGet(...) {
         action = request.getParameter("action");
         processAction(response);
    }

    public void processAction(...) {
         if (action.equals("foo")) {
             // send foo page
         } else if (action.equals("bar")) {
             // send bar page
         }
     }
} 
```

因为 serlvet 是由多个线程访问的，所以不能保证 action 实例成员不会被其他人的请求破坏，最终返回错误的页面。

这个问题的简单解决方案是在实例成员中使用局部变量：

```
public class MyServlet ... {
    public void doGet(...) {
         String action = request.getParameter("action");
         processAction(action, response);
    }

    public void processAction(...) {
         if (action.equals("foo")) {
             // send foo page
         } else if (action.equals("bar")) {
             // send bar page
         }
     }
} 
```

**注意：这也延伸到 JavaServer Pages，如果您为您的视图分派给它们？**

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T23:00:11.927

检查您的标头是否允许在没有正确`Vary`HTTP 标头的情况下进行缓存（例如，如果您使用会话 cookie 并允许缓存，则您需要在`Vary`HTTP 标头中为 cookie 标头输入一个条目，或者缓存/代理可能会提供缓存版本的一个用户到另一个用户的页面）。

问题可能不在于您的 Web 服务器上的缓存，而在于另一层缓存（在您的 Web 服务器前面的反向代理上，或在用户附近的代理上）。如果客户端是 NAT，它们也可能位于透明代理之后（并且，为了使调试更加困难，透明代理可能被配置为在标头中不可见）。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-19T07:06:09.640

问题的 8 次更新稍后再使用一个问题来测试/复制，尽管对于公共站点来说可能很困难（或昂贵）。

您可以在网站上启用 https。这至少会清除沿途的任何其他代理缓存。看到有一些被遗忘的负载均衡器或公司缓存会干扰您的流量，这将是很糟糕的。

对于公共站点，这意味着密钥上的受信任证书，因此会涉及一些资金。对于测试自签名密钥可能就足够了。此外，请检查是否不涉及解密和重新加密流量的透明代理。（它们很容易被检测到，因为它们不能使用与原始服务器相同的证书/密钥）

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2011-01-24T19:25:15.983

尽管您确实提到在您的设置中未启用 mod_cache，但对于其他可能在启用 mod_cache 时遇到相同问题的其他人（即使在静态内容上），解决方案是确保在 Set-Cookie HTTP 标头上启用以下指令：

```
CacheIgnoreHeaders Set-Cookie 
```

mod_cache 的原因将缓存可能提供给其他用户的 Set-Cookie 标头。然后，这会将会话 ID 从上次填充缓存的用户泄漏给另一个用户。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-26T07:08:57.463

我遇到了这个问题，它真的让我发疯了。我不知道为什么，但我解决了它关闭 http.conf 上的 Keep Alive

从

保持活动状态

到

保持活动关闭

我的应用程序没有使用 keepalive 功能，所以它对我来说效果很好。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-04-19T05:59:35.807

试试这个：

```
response.setHeader("Cache-Control", "no-cache"); //HTTP 1.1
response.setHeader("Pragma", "no-cache"); //HTTP 1.0
response.setDateHeader("Expires", 0); //prevents caching at the proxy server 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-06-17T01:42:52.900

看看这个网站，它描述了 mod_jk 的一个问题。在查看一个非常相似的问题时，我偶然发现了您的帖子。基本上解决方法是升级到较新版本的 mod_jk。我还没有机会在我们的服务器中实施更改，但是我明天会尝试一下，看看它是否有帮助。  

[http://securitytracker.com/alerts/2009/Apr/1022001.html](http://securitytracker.com/alerts/2009/Apr/1022001.html)

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T17:28:30.520

我不是专家，但这可能是一些奇怪的[网络地址转换](http://en.wikipedia.org/wiki/Network_address_translation)问题吗？

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-11-16T17:49:16.460

我们将 Apache 从使用 AJP 代理切换到使用 HTTP 代理。到目前为止，它似乎已经解决了这个问题，或者至少大大减少了它 - 几个月来没有报告过这个问题，并且从那时起该应用程序的使用量有所增加。

更改在 Apache 的 httpd.conf 中。开始于`mod_jk`：

```
JkMount /portal ajp13 
```

我们切换到`mod_proxy_ajp`：

```
ProxyPass /portal ajp://localhost:8009/portal 
```

然后终于直截了当`mod_proxy`：

```
ProxyPass /portal http://localhost:8080/portal 
```

您需要确保将 Tomcat 设置为在端口 8080 上提供 HTTP 服务。请记住，如果您正在服务`/`，则需要`/`在代理的两侧都包含，否则它会开始哭泣：

```
ProxyPass / http://localhost:8080/ 
```

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2010-03-26T20:35:43.100

这可能根本不是缓存问题。尝试增加 apache2.conf 中的 MaxClients 参数。如果它太低（默认为 150？），Apache 开始对请求进行排队。当它决定通过 mod_proxy 为排队的请求提供服务时，它会拉出一个错误的页面（或者可能只是在进行所有排队时压力很大）。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2012-07-07T14:11:30.480

你确定这是其他人请求的页面还是没有参数的页面？如果你的connectionTimeout在apache后面的tomcat服务器上的server.xml上太短，你可能会得到奇怪的错误，将其增加到更大的数字：

默认配置：

```
 <Connector port="8080" protocol="HTTP/1.1"
               connectionTimeout="20000"
               redirectPort="8443" /> 
```

改变：

```
 <Connector port="8080" protocol="HTTP/1.1"
               connectionTimeout="2000000"
               redirectPort="8443" /> 
```

# wcf - WCF 端点监听

> ID：246542
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T12:05:35.617
> 
>         
> 
> 标签：wcf, web-services

在 http;//localhost:8080/xdxservice/xdsrepository 没有可以接受消息的端点侦听。这通常是由不正确的地址或 SOAP 操作引起的。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T12:38:10.060

可能是问题中的拼写错误，但您的网址无效。  

```
http;//localhost:8080/xdxservice/xdsrepository 
```

应该有一个冒号而不是一个分号

```
http://localhost:8080/xdxservice/xdsrepository 
```

这可能不是你的问题，但我认为值得指出。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T12:11:41.283

url 应该有一个 .svc 扩展名，不是吗？（在评论中回答）

您是在 ASP.NET 还是 VS 网络服务器中运行 WCF？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-06-11T08:04:20.570

.svc 文件指向什么服务类？web.config 或 app.config 文件中是否有此类的部分？此部分是否定义了元素？

如果不在 IIS 下运行，该元素是否定义了地址？或者是否定义了基地址？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-04-10T21:18:16.600

这通常只是意味着服务没有运行，或者无法监听请求。可能是输入错误的 URL，或者 IIS 应用程序未启动，或者您的端口号错误。

但基本上，它意味着信息所说的内容。

# encoding - Base 64 如何处理末尾为零的二进制数据

> ID：246548
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T12:07:44.223
> 
>         
> 
> 标签：encoding, base64

据我了解规范，Base64 编码器

a) 获取源二进制文件，并用零填充为 24 字节长的倍数。

b) 然后它一次将 6 位转码为 64 个字符的目标集（A..Z、a..z、0..9、+、-）。如果它发现最后两个字节（16 位）已被零填充，则最后两个字符被转码为“==”。如果它发现最后一个字节（8 位）已被零填充，则最后一个字符被转码为'='。

我的问题是，在步骤 (b) 中，它如何知道最后一个字节是零，因为它们已被填充，而它们是零，因为它们是有效二进制源数据的一部分？

负责 (b) 部分的子系统是否必须知道 (a) 部分期间发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T12:53:52.930

编码器（与解码器相反）将知道输入数据的长度，并能够确定是否不输出任何内容，最后是“=”还是“==”。您的问题假设您提到的两个阶段之间没有联系，但在我看到的实现中并非如此。

我必须**编写**的实现根本没有执行第一阶段，因为它有例程从输入流中一次提取一个 6 位组，每次递增 byteCount。然后在最后，表达式“ `byteCount%3`”用于决定将哪个字符串附加到输出流。

# windows - 如何递归地将特定模式的文件复制到 Windows 上的单个平面文件夹中？

> ID：246559
> 
>         
> 
> 赞同：66
> 
>         
> 
> 时间：2008-10-29T12:11:57.070
> 
>         
> 
> 标签：windows, file-io, command-line

我需要将一组 DLL 和 PDB 文件从一组文件夹递归地复制到另一个文件夹中。我不想在目标文件夹中重新创建文件夹层次结构。我想使用内置的 Windows 工具，例如 DOS 命令。

* * *

## 回答 #1

> 赞同：117
> 
>             
> 
> 时间：2008-10-29T12:19:12.250

```
mkdir targetDir
for /r %x in (*.dll, *pdb) do copy "%x" targetDir\ 
```

如果您要复制多个文件并且不想一直回答“是”，请在上述命令的末尾使用 /Y。

* * *

## 回答 #2

> 赞同：37
> 
>             
> 
> 时间：2012-12-03T11:03:42.157

**命令 XCOPY**

递归复制文件夹的示例：

```
mkdir DestFolder
xcopy SrcFolder DestFolder /E 
```

（如下面在[WIKI](http://en.wikipedia.org/wiki/List_of_MS-DOS_commands#XCOPY)之后的评论中所述，该命令自 DOS 3.2 起可用）

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2014-06-13T13:48:16.620

如果路径中有空格，请确保引号正确。

这是我的 TFS 构建服务器的构建后事件（这就是为什么有“%%”）。我需要复制所有测试文件。

```
if not exist  "$(TargetDir)..\SingleFolderOutput" mkdir -p "$(TargetDir)..\SingleFolderOutput"

for /r **%%x** in (*.dll, *.pdb, *.xml, *.xaml, *.exe, *.exe.config) do xcopy **"%%x"** "$(TargetDir)..\SingleFolderOutput" /Y 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2020-03-27T11:24:44.810

为了收集 PBD 文件，我最终得到了这个：

```
cmd /q /c for /R "<your_source_folder>" %f in (*.pdb) do xcopy "%f" "<your_destination_folder>" /I /Y 
```

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2011-04-12T08:57:09.260

```
@echo off
if %1'==' goto usage
if %2'==' goto usage
if %3'==' goto usage
for /D %%F in (%1\*) do xcopy %%F\%2 %3 /D /Y
for /D %%F in (%1\*.) do call TreeCopy %%F %2 %3
goto end
:usage
@echo Usage: TreeCopy [Source folder] [Search pattern] [Destination folder]
@echo Example: TreeCopy C:\Project\UDI *.xsd C:\Project\UDI\SOA\Deploy\Metadata
:end 
```

* * *

## 回答 #6

> 赞同：-3
> 
>             
> 
> 时间：2008-10-29T12:17:39.133

我不知道有任何命令行工具可以直接执行此操作，但您可以创建一个批处理脚本来循环遍历子文件夹，并复制您需要的文件。

但是，如果您将它们全部放在同一个文件夹中，您最终可能会得到具有重复文件名的文件。

# c++ - C++ 函数中静态变量的生命周期是多少？

> ID：246564
> 
>         
> 
> 赞同：402
> 
>         
> 
> 时间：2008-10-29T12:14:03.370
> 
>         
> 
> 标签：c++, static, lifetime

如果一个变量被声明为`static`一个函数的作用域，它只被初始化一次并且在函数调用之间保持它的值。它的寿命究竟是多少？什么时候调用它的构造函数和析构函数？

```
void foo() 
{ 
    static string plonk = "When will I die?";
} 
```

* * *

## 回答 #1

> 赞同：286
> 
>             
> 
> 时间：2008-10-29T12:16:04.987

函数`static`变量的生命周期从^([0])程序流第一次遇到声明时开始，并在程序终止时结束。这意味着运行时必须执行一些记录，以便只有在实际构建时才将其销毁。

此外，由于标准规定静态对象的析构函数必须按照其构造完成的相反顺序运行^([1])，而构造顺序可能取决于具体程序运行，因此必须考虑构造顺序.

**例子**

```
struct emitter {
    string str;
    emitter(const string& s) : str(s) { cout << "Created " << str << endl; }
    ~emitter() { cout << "Destroyed " << str << endl; }
};

void foo(bool skip_first) 
{
    if (!skip_first)
        static emitter a("in if");
    static emitter b("in foo");
}

int main(int argc, char*[])
{
    foo(argc != 2);
    if (argc == 3)
        foo(false);
} 
```

**输出：**

> C:>sample.exe在 foo 中
> 
> 创建 在 foo
> 
> 中销毁
> 
> C:>sample.exe 1
> 
> 创建于 if
> 
> 创建于 foo
> 
> 销毁于 foo
> 
> 销毁于 if
> 
> C:>sample.exe 1 2 
> 
> Created in foo 
> 
> Created in if 
> 
> Destroyed in if 
> 
> Destroyed in foo

`[0]`由于**C++98** ^([2])没有提到多线程，因此未指定在多线程环境中的行为方式，并且正如[Roddy](https://stackoverflow.com/questions/246564/what-is-the-lifetime-of-a-static-variable-in-a-c-function#246594)所提到的那样，可能会出现问题。

`[1]` **C++98**部分`3.6.3.1` *[basic.start.term]*

`[2]`在 C++11 中，静态以线程安全的方式初始化，这也称为[*Magic Statics*](http://herbsutter.com/2013/09/09/visual-studio-2013-rc-is-now-available/)。

* * *

## 回答 #2

> 赞同：132
> 
>             
> 
> 时间：2008-10-29T12:24:55.733

Motti 对订单的看法是正确的，但还有其他一些事情需要考虑：

编译器通常使用隐藏标志变量来指示本地静态变量是否已经初始化，并且在函数的每个条目上都会检查此标志。显然这是一个小的性能损失，但更令人担忧的是这个标志不能保证是线程安全的。

如果您有上面的本地静态，并且`foo`从多个线程中调用，您可能会遇到导致`plonk`错误甚至多次初始化的竞争条件。此外，在这种情况下，`plonk`可能会被与构造它的线程不同的线程破坏。

尽管标准说了什么，但我对局部静态破坏的实际顺序非常谨慎，因为您可能会不知不觉地依赖静态在它被破坏后仍然有效，这真的很难追踪。

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2014-09-11T21:08:25.050

如果没有 6.7 中的标准中的实际规则，现有的解释并不完整：

> 具有静态存储持续时间或线程存储持续时间的所有块范围变量的零初始化在任何其他初始化发生之前执行。具有静态存储持续时间的块范围实体的持续初始化（如果适用）在首次进入其块之前执行。在允许实现在命名空间范围内静态初始化具有静态或线程存储持续时间的变量的相同条件下，允许实现对具有静态或线程存储持续时间的其他块范围变量执行早期初始化。否则，此类变量在控件第一次通过其声明时被初始化；这样的变量在其初始化完成时被认为已初始化。如果初始化通过抛出异常退出，初始化没有完成，所以下次控件进入声明时会再次尝试。如果在变量初始化时控制同时进入声明，则并发执行将等待初始化完成。如果在初始化变量时控件以递归方式重新进入声明，则行为未定义。

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2008-10-29T16:27:17.290

FWIW，Codegear C++Builder 不会按照标准按预期顺序进行破坏。

```
C:\> sample.exe 1 2
Created in foo
Created in if
Destroyed in foo
Destroyed in if 
```

……这也是不依赖破坏令的另一个原因！

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2019-06-13T21:01:59.813

The *Static variables* are come into play once the *program execution starts* and it remain available till the program execution ends.

The Static variables are created in the **Data Segment of the Memory**.

# xml - 我可以在 JSON 中提供 RSS 吗？

> ID：246577
> 
>         
> 
> 赞同：22
> 
>         
> 
> 时间：2008-10-29T12:19:38.943
> 
>         
> 
> 标签：xml, json, rss

我正在写一个 RSS 提要（为了好玩），并在[此处](http://cyber.law.harvard.edu/rss/rss.html)查看规范。

> RSS 是 XML 的一种方言。所有 RSS 文件都必须符合万维网联盟 (W3C) 网站上发布的 XML 1.0 规范。

显然，这意味着如果我选择 JSON 选项，我不会提供“纯”RSS。也就是说，如果我符合规范的其余部分，（定制的）读者是否可能能够解析它？

换句话说，如果我符合规范，但使用 JSON 而不是 XML，它是一个可用的 RSS 提要吗？

*编辑*
我不确定我是否说清楚了。不涉及 XML。我想改用 JSON 编写类似于 RSS（即 XML）的东西。显然，需要编写此类提要的读者才能理解 JSON 格式。我想知道这是否已经完成。是否有以这种方式提供 Feed 的服务？是否有可以聚合/理解这种格式的程序。在这种情况下，RSS 规范（没有 XML 部分）是一个有用的规范吗？

rg

```
{
"title":"example.com",
"link":"http://www.example.com/",
"description":"Awesome news about junk",
"items":[
    {
        "title":"An article",
        "link":"http://www.example.com/an-article",
        "descrition":"Some sample text here",
        "pubDate":"2008-10-27 11:06 EST",
        "author":"example author",
    },
    {
        "title":"Second",
        "link":"http://www.example.com/Seond",
        "descrition":"Some sample text here",
        "pubDate":"2008-10-25 23:20 EST",
        "author":"author mcauthor",
    },
    {
        "title":"third article",
        "link":"http://www.example.com/third-article",
        "descrition":"Some sample text here",
        "pubDate":"2008-10-25 23:18 EST",
        "author":"some other author",
    }
]
} 
```

* * *

## 回答 #1

> 赞同：22
> 
>             
> 
> 时间：2008-10-29T12:24:50.553

不，RSS 是一种基于 XML 的格式，而 JSON 是一种不同的语言，而不是某种方言。RSS 阅读器不会理解 JSON。

你的问题类似于问“我可以用中文说法语吗？”

* * *

## 回答 #2

> 赞同：14
> 
>             
> 
> 时间：2008-10-30T21:00:50.077

我相信这已经完成了。  

看看这个 jQuery 扩展：   [jFeed - RSS/ATOM 提要解析器](https://github.com/jfhovinne/jFeed)

```
jQuery.getFeed(options); 
```

**选项：**

*   网址：

*   数据：

*   成功：

**例子：**

```
jQuery.getFeed({
       url: 'rss.xml',
       success: function(feed) {
           alert(feed.title);
       }
   }); 
```

请注意，在这种情况下，'feed' 将是一个 javascript 对象。如果您想使用 JSON 传递它，您可以使用[javascript JSON 实用程序](http://www.json.org/js.html)。

例子：

```
var myJSONText = JSON.stringify(feed); 
```

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2008-11-26T23:16:11.340

> 在这种情况下，RSS 规范（没有 XML 部分）是一个有用的规范吗？

如果您想发明另一种联合格式，我建议使用 Atom 作为基础。恕我直言，它具有更简洁、更一致的设计，并具有有用的功能，例如对过去项目的可靠更新、区分摘要和完整内容等。

> 我想知道这是否已经完成。

Flickr 有[JSON 输出格式](http://api.flickr.com/services/feeds/photos_public.gne?id=36998705@N00&lang=en-us&format=json)。他们甚至有[lolcode 提要](http://api.flickr.com/services/feeds/photos_public.gne?id=36998705@N00&lang=en-us&format=lolcode)。

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2017-05-25T16:38:24.130

您是对的，*阅读*提要的客户端必须对您的 JSON 的任何细节有自定义支持。因此，您要么需要制作自定义提要阅读器来使用该信息，要么必须有人提出 JSON 提要标准，并且必须被广泛采用。

好吧，我想你的愿望终于得到满足了，朋友！

看看[JSON 提要](https://jsonfeed.org/)。在撰写本文时，它只有大约一周的历史，但它已经开始加速，现在已经得到了[Feedly](https://twitter.com/feedly/status/875046109651116034)、[Feedbin](https://feedbin.com/blog/2017/05/22/feedbin-supports-json-feed/)、[News Explorer](https://betamagic.nl/blog.html)、[NewsBlur](http://blog.newsblur.com/post/160982162270/newsblur-now-supports-the-new-json-feed-spec)的支持，并且一直在添加更多内容。

如果在生成 RSS 的 JSON 版本时必须选择要使用的标准，我肯定会选择 JSON Feed。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2008-10-30T21:05:55.603

Json.NET - [http://james.newtonking.com/projects/json-net.aspx](http://james.newtonking.com/projects/json-net.aspx) - 支持将任何 XML 文档转换为 JSON。

```
XmlDocument doc = new XmlDocument();

doc.LoadXml(@"<?xml version=""1.0"" standalone=""no""?>
<root>
  <person id=""1"">
    <name>Alan</name>
    <url>http://www.google.com</url>
  </person>
  <person id=""2"">
    <name>Louis</name>
    <url>http://www.yahoo.com</url>
  </person>
</root>");

string jsonText = JavaScriptConvert.SerializeXmlNode(doc);
//{
//  "?xml": {
//    "@version": "1.0",
//    "@standalone": "no"
//  },
//  "root": {
//    "person": [
//      {
//        "@id": "1",
//        "name": "Alan",
//        "url": "http://www.google.com"
//      },
//      {
//        "@id": "2",
//        "name": "Louis",
//        "url": "http://www.yahoo.com"
//      }
//    ]
//  }
//}

XmlDocument newDoc = (XmlDocument)JavaScriptConvert.DeerializeXmlNode(jsonText);

Assert.AreEqual(doc.InnerXml, newDoc.InnerXml); 
```

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T19:39:50.270

有很多不同的方法可以将 RSS 序列化为 JSON。所有这些都以几乎相同的方式工作：元素和属性成为属性名称，值成为属性值，等等。参见[Piyush Shah 的](http://blogs.msdn.com/shahpiyush/archive/2007/04/12/2103116.aspx)技术，例如，它是一个 .NET 实现。  

使用 XSLT 将任意 XML 转换为 JSON 非常简单，您可以在 Google 上找到六个这样的示例。

只要始终如一地这样做，可以处理旨在复制 RSS 规范的数据结构的对象模型的 JavaScript 应该能够处理 JSON 反序列化为的对象模型。  

您打算将此 JSON 发送给谁？这才是真正的问题。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-11-07T12:55:09.783

好吧，如果您正在开发一些 javascript 应用程序，您可能希望以 JSON 格式获取任何 RSS 提要，以克服跨域查询问题。Google 提供了一个可靠的解决方案，可以将任何 RSS 转换为 JSON。对于 jQuery 爱好者来说，有一个[通用的 RSS 到 JSON 转换器插件](http://jquery-howto.blogspot.com/2009/11/cross-domain-rss-to-json-converter.html)。

例子：

```
$.jGFeed('http://twitter.com/statuses/user_timeline/26767000.rss',
  function(feeds){

    // feeds is a javascript object with RSS content

  }, 10); 
```

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2017-06-28T16:48:10.560

我知道这是一个相当古老的问题，现在可能无关紧要。

然而。我建议任何希望在 JSON 中发布类似 RSS 的提要的人都应该使用一种正在迅速被采用的新格式；JSONFeed ( [https://jsonfeed.org](https://jsonfeed.org) )。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2019-02-26T09:32:15.320

> 是否有可以聚合/理解这种格式的程序。

您可以使用[XSLT 3.0](https://www.w3.org/TR/xslt-30/)将 XML 转换为 JSON 并再次转换回 XML。有关如何在此处完成对 JSON 的转换的更多信息：

[https://www.xml.com/articles/2017/02/14/why-you-should-be-using-xslt-30/](https://www.xml.com/articles/2017/02/14/why-you-should-be-using-xslt-30/)。

# asp.net - iisreset 后应用程序池未启动

> ID：246598
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2008-10-29T12:25:41.723
> 
>         
> 
> 标签：asp.net, wcf, iis, windows-server-2003

*在我开始之前，我知道使用 iisreset 被认为是不好的做法，但无论如何都不应该发生这种情况。*

**我们有什么：**

*   在 Windows Server 2003 R2 上使用 IIS6 的几台机器（64 位和 32 位）

*   多个 WCF Web 服务（.NET 运行时 2.0）部署在多个应用程序中，每个应用程序都有自己的应用程序池，每个应用程序池在其他 Windows 帐户下运行。

**发生什么了：**

*   所有 appPools 启动，所有服务运行

*   IISReset 被执行（或机器重启）

*   IIS 重新启动，但并非所有应用程序池都正常启动。有时它们都会重新启动，有时一个或多个池无法启动。但是，它们可以手动启动。

这是“正常”的 iis 行为吗？我应该避免使用 iisreset，还是我们在 .NET 代码中做错了什么？

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2008-10-29T12:33:21.473

应用程序池应在 iisreset 时重新启动，但它们确实在 iis 之外运行（在 COM+ 中）以确保可靠性。这意味着如果应用程序行为不端，它们可能不会回来，但 IIS 和其他应用程序会（应该）回来。所以是的，这是“正常的”。  

PS 作为iisreset的**骄傲**用户，我也想“OUT”自己。不好的做法？  **呸!** ;D   

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T12:54:09.030

IIS 在第一个请求到来之前不会立即启动 ASP.NET 工作进程 (w3wp.exe)。当您说“未启动”时，是否意味着您尝试访问某些 WCF Web 服务（在 iisreset 之后），并且您得到一个由于appPool无法启动导致Service Unavailable错误？您是否在事件日志中看到任何与 IIS W3SVC 相关的条目？

如果有，他们可能会告诉你为什么他们不能开始；把它们贴在这里。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2010-01-28T05:21:11.153

原因：

在第一个请求进入之前，IIS 不会立即启动 ASP.NET 工作进程 (w3wp.exe)。当它显示“未启动”时，意味着您尝试访问某些 WCF Web 服务（在 iisreset 之后）由于对象持有一些而失败内存中的空间，并且由于无法启动 appPool，您会收到 Service Unavailable 错误。

解决方法：

使用以下命令创建批处理文件并安排它。

> 净停止 23svc
> 
> 净停止 msftpsvc
> 
> 网络停止 smtpsvc
> 
> 净停止 PleskControlPanel
> 
> 净停止 HTTPFilter
> 
> iisreset /重启
> 
> 净启动 w3svc
> 
> 网络启动 msftpsvc
> 
> 网络启动 smtpsvc
> 
> 网络启动 PleskControlPanel
> 
> net 启动 HTTPFilter

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2015-07-09T05:25:20.097

有类似的问题 - 重新启动 IIS 后，DefaultAppPool 已停止。

在应用程序事件日志中发现错误：

> Windows 无法让您登录，因为您的配置文件无法加载。检查您是否已连接到网络，或者您的网络是否正常运行。如果此问题仍然存在，请联系您的网络管理员。
> 
>   **详细信息 - 访问被拒绝。**

通过在 DefaultAppPool**高级设置**选项**Load User Profile**中设置为**False**来修复。

希望它可能有用。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T12:57:51.673

在之前的支持角色中，我管理了几台运行各种 .NET 混乱的 IIS 服务器。当 AppPool 无法启动时，通常是登录凭据错误。

* * *

## 回答 #6

> 赞同：-1
> 
>             
> 
> 时间：2021-04-13T06:07:48.313

通过应用程序池的高级设置重新设置身份（身份验证凭据）对我有用。

早些时候，我更改了我的活动目录密码，并且由于应用程序池已经在运行，它工作正常，直到我执行 IISRESET。

# c# - 如何优雅地检查 Gravatar 或第三方网站是否正常工作？

> ID：246605
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-29T12:29:43.680
> 
>         
> 
> 标签：c#, asp.net, gravatar

我刚刚发布了问题[how-to-determine-why-the-browser-keeps-trying-to-load-a-page](https://stackoverflow.com/questions/246575/how-to-determine-why-the-browser-keeps-trying-to-load-a-page)并发现我的问题出在 Gravatar 上。  

我还注意到 StackOverflow 也遭受了同样的中断。  

在尝试从中检索头像图标  **之前**，有没有人知道一种**优雅**的方式来确定 Gravatar 或任何第三方网站是否启动？

 **这将消除长页面加载和永无止境的忙碌光标......我不应该说永无止境......它只需要**很长时间**才能消失，并且当用户坐在那里等待时非常困惑...... 。 不求回报。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T12:34:17.057

您可以有一个不同的进程来定期检查站点的状态。为你设置一个关于什么是失败的规则，例如你可以说：“ping time > 1500 ms = down”。有这个过程在数据库表或配置文件中留下注释。然后，您几乎免费在每个页面呈现时检查此值。

根据此外部站点的重要性，您可以或多或少地进行检查。

此过程可能是 Web 堆栈程序之外的程序，或者是只能通过 localhost 访问的页面，该页面通过计划任务或评论中提到的 ASP.NET 工具执行。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T12:59:03.713

对于 Gravatar，您可以缓存所有这些图像，而不是每次都从服务器中获取它们。当然，如果用户更改他们的图标，它可能不会像直接访问主服务器那样快速刷新，但至少您不必每次都请求 gravar 服务器。

# vb.net - 怎么搬过去

> ID：246607
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-29T12:31:35.377
> 
>         
> 
> 标签：vb.net, methodology

大约 5 年前上坡时，我的职业生涯还算顺利，但分离、家人的死亡和一些疾病使我做出了几个糟糕的职业决定，我最终进入了一个死胡同的工作，主要是做 vb 6，虽然它是30 年中下旬结束，但最近休息了，与一家具有前瞻性的 vb.net 公司合作，我双手抓住了机会，到现在已经 5 个月了

事情进展顺利，花了很多时间在这样的地方，阅读书籍，但是来自 C / 机器代码 / VB 5 &6 背景，如果我写的话，我会发现 .NET 的一点内向性在我身上迷失了例如，我不认为使用委托的代码，有没有人对使“大脑”VB.NET 跳跃或我应该关注的培训有任何建议（请记住，我并不富有）

谢谢你的时间

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T12:39:35.877

参加 .NET 入门课程将是一项不错的投资。它让您有机会专注于 .NET 四五天并打下良好的基础。

另一种选择是使用在线资源并进行自学。一个建议（大量存在的）是关注[http://www.microsoft.com/events/series/modernsoftdev.aspx?tab=webcasts](http://www.microsoft.com/events/series/modernsoftdev.aspx?tab=webcasts)上提供的网络广播系列之一。虽然它们是一个小日期（它们专注于 Visual Studio 2005），但它们是为像你这样的人设计的。

另一个建议是找到一个本地 .NET 用户组。花一些时间与人交流并分享经验将帮助您学习，并让您有机会建立一些网络。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T12:40:12.397

只需使用 .NET 框架，就可以使用委托或接口之类的东西。由于您已经知道它们的存在，您会发现自己处于一种情况，您认为*“天哪，这可以通过使用委托轻松完成！”* 如果发生这种情况，请使用委托。

我认为这比寻找一种方法来使用所有那些闪亮的 .NET 东西要好——它们很有用，但前提是正确使用。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T12:45:42.773

恕我直言，我建议根本不要迁移到 vb.net，而是利用您的 C 背景，并迁移到 C#。这样做的原因是，您已经知道语法，而且 VB.net 还不足以像 VB6 那样使其像您期望的那样简单。另外，您更有“可能”接触到使用框架等更高级功能的开发人员。

这可能是一个有点争议的声明，但我坚信，为了重新点燃职业生涯，有时最好在精神上飞跃到新事物。你会发现在此之前你所学的一切都会巩固你将获得的新知识。

此外，找到一个你可以积极参与的个人项目，有一个切实的最终目标/可交付成果，这将使学习你的新技能变得更加有趣。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T12:35:10.550

这不像 C/Machine 代码程序员不受欢迎......随着开发人员现在对 Java 或 .NET 母乳喂养，他们变得越来越少：)

# apache-flex - 您最需要 Adob e Air 中的哪些功能？

> ID：246609
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T12:32:35.717
> 
>         
> 
> 标签：apache-flex, actionscript-3, air

我最近开始使用 Flex 3 和 Adob​​e Air 进行开发，我想知道您希望在 Adob​​e Air 的未来版本中具有哪些功能？

我想念的是：

*   直接从 Air 应用程序启动本地文件 (shellExec) 的跨系统方式（尽管您至少可以在 Windows 下使用变通方法来执行此操作）

*   能够为 Embed 语句设置动态路径（例如*Embed[(variable+"/path/to/file")]*）。我没有找到任何方法来正确地做到这一点。

*   使用 CSS 中的绝对值设置 Flex 对象位置的某种方式（顺便说一下，这听起来与 Flex 更相关）

如果您知道一些，请不要犹豫，将您的解决方法添加到这些限制中。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-11-11T22:01:01.613

*   调用本机代码的能力——你目前必须交付一个用另一种语言编写的服务器，然后调用它来做比 Air 给你的更多的事情。

*   模态窗口。您可以做一个 hack，包括设置 Application.application.enabled = false，设置 dialog.nativeWindow.alwaysInFront = true，然后在对话框关闭时重新启用应用程序，但这是冗长的，不会禁用任何本机你可能有的菜单！如此简单的事情变得如此困难，这太疯狂了。

*   一种设置应用程序图标的有用方法。前几天我花了 2 个小时尝试这样做，但在持续出现“303”错误后放弃了，这让我不知道自己做错了什么。再次，非常基本的东西。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-10-30T02:54:00.637

“调用本机代码”，“模态窗口”，同意-同意。loadLibrary 真的很棒:)

ps.： 

   如果我们不能在 AIR 中拥有这个功能，如果有机会将
   flash(AIR) 图形引擎嵌入到您自己的应用程序中，那就太好了。在这种情况下，我们将获得
   巨大的性能改进和选择写什么的自由（
   不仅仅是小工具）。

# delphi - 查找字符串是否在列表中的最佳方法（没有泛型）

> ID：246623
> 
>         
> 
> 赞同：31
> 
>         
> 
> 时间：2008-10-29T12:37:47.797
> 
>         
> 
> 标签：delphi, delphi-2007

我想做这样的事情：

```
Result = 'MyString' in [string1, string2, string3, string4]; 
```

这不能与字符串一起使用，我不想做这样的事情：

```
Result = (('MyString' = string1) or ('MyString' = string2)); 
```

另外我认为创建一个 StringList 来做到这一点太复杂了。

还有其他方法可以实现这一目标吗？

谢谢。

* * *

## 回答 #1

> 赞同：68
> 
>             
> 
> 时间：2008-10-29T13:15:48.237

您可以使用`AnsiIndexText(const AnsiString AText, const array of string AValues):integer`或`MatchStr(const AText: string; const AValues: array of string): Boolean;`（均来自`StrUtils`单元）

就像是：

```
Result := (AnsiIndexText('Hi',['Hello','Hi','Foo','Bar']) > -1); 
```

或者

```
Result := MatchStr('Hi', ['foo', 'Bar']); 
```

> AnsiIndexText 返回它在 AValues 中找到的与 AText
> **不区分大小写**的第一个字符串的 0 偏移索引。如果 AText 指定的字符串在 AValues 中没有（可能不区分大小写）匹配，则 AnsiIndexText 返回 –1。比较基于当前系统区域设置。
> 
> MatchStr 使用**区分大小写的比较**确定数组 AValues 中的任何字符串是否与 AText 指定的字符串匹配。如果数组中至少有一个字符串匹配，则返回 true，如果没有字符串匹配，则返回 false。

注意`AnsiIndexText`不区分大小写并且`MatchStr`区分大小写，所以我想这取决于您的使用

**编辑：2011-09-3**：刚刚找到这个答案，并认为我会添加一个注释，在 Delphi 2010 中还有一个与大小写`MatchText`相同`MatchStr`但不区分大小写的函数。——拉里

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2008-10-29T13:10:35.127

Burkhard 的代码有效，但即使找到匹配项，也会不必要地遍历列表。

更好的方法：

```
function StringInArray(const Value: string; Strings: array of string): Boolean;
var I: Integer;
begin
  Result := True;
  for I := Low(Strings) to High(Strings) do
    if Strings[i] = Value then Exit;
  Result := False;
end; 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T12:49:22.033

这是一个完成这项工作的函数：

```
function StringInArray(Value: string; Strings: array of string): Boolean;
var I: Integer;
begin
  Result := False;
  for I := Low(Strings) to High(Strings) do
  Result := Result or (Value = Strings[I]);
end; 
```

事实上，您确实将 MyString 与 Strings 中的每个字符串进行了比较。一旦找到一个匹配项，您就可以退出 for 循环。

# wcf - WCF - 更改端点地址会导致安全异常

> ID：246636
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-29T12:41:16.590
> 
>         
> 
> 标签：wcf

当客户端使用以下默认选项生成服务时，我的 WCF 服务使用 wsHttpBinding 并在客户端正常工作：

```
RServiceClient R = new RServiceClient(); 
```

但是，在某些时候，我需要能够指定服务的位置，大概是通过如下更改端点地址：

```
RServiceClient R = new RServiceClient();
R.Endpoint.Address = new EndpointAddress(new Uri "http://xxx.xxxx.xxx:80/RServer/RService.svc")); 
```

但是，当我指定确切的端点时，我得到一个 SecurityNegotiationException: System.ServiceModel.Security.SecurityNegotiationException is unhandled Message="The caller was not authenticated by the service." 来源="mscorlib"....

WCF 服务在 IIS 上运行，并在 IIS 管理员下启用了匿名访问。此外，当客户端与管理员帐户下的服务在同一台机器上运行时，会发生此错误 - 我还没有到通过网络运行它的可怕部分！

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2008-10-29T13:52:24.433

默认情况下，wsHttpBinding 使用 Windows 身份验证。我不确定 IIS 中的托管如何影响这种情况。  

如果你不想开启安全，你可以添加一个安全元素，并在两端的配置中将模式元素设置为“无”以关闭默认设置。

我认为这可能会奏效——我添加了 wsHttpBinding 部分并将服务的 bindingConfiguration 设置为指向新添加的绑定属性：

```
<system.serviceModel>
    <bindings>
      <wsHttpBinding>
        <binding name="wsHttpBind">
          <security mode="None">
            <transport clientCredentialType="None" protectionLevel="EncryptAndSign" />
            <message clientCredentialType="None" algorithmSuite="Default" />
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>
    <services>
        <service behaviorConfiguration="ServiceBehavior" 
            name="RService">
            <endpoint address="" 
                binding="wsHttpBinding" 
                bindingConfiguration="wsHttpBind" 
                name="RService" 
                contract="IRService"> 
                <identity>
                    <dns value="localhost" />
                </identity>
            </endpoint>
            <endpoint address="mex" 
                binding="mexHttpBinding" 
                name="MetadataExchange" 
                contract="IMetadataExchange" />
        </service>
    </services>
    <behaviors>
        <serviceBehaviors>
            <behavior name="ServiceBehavior">
            <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
                <serviceMetadata httpGetEnabled="true"/>
                <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
                <serviceDebug includeExceptionDetailInFaults="true"/>
            </behavior>
        </serviceBehaviors>
    </behaviors>
</system.serviceModel> 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T13:15:48.970

从您的配置中检查：

```
...    
     <identity>
      <dns value="localhost" />
     </identity>
... 
```

afaik wsHttpBinding**默认开启消息安全**。当它检查 dns 值“localhost”时它失败了。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T12:44:31.560

您是否将 MessageSecurity 与证书一起使用？这可能是证书问题（错误的主机名、未安装自签名证书等）

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:00:19.983

这是我的服务配置信息，我正在使用 wshttpbinding：

```
<system.serviceModel>
    <services>
  <service behaviorConfiguration="ServiceBehavior" name="RService">
<endpoint address="" binding="wsHttpBinding" bindingConfiguration=""
 name="RService" contract="IRService">
 <identity>
  <dns value="localhost" />
 </identity>
</endpoint>
<endpoint address="mex" binding="mexHttpBinding" name="MetadataExchange"
 contract="IMetadataExchange" />
   </service>
</services>
    <behaviors>
        <serviceBehaviors>
            <behavior name="ServiceBehavior">
                <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
                <serviceMetadata httpGetEnabled="true"/>
                <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
                <serviceDebug includeExceptionDetailInFaults="true"/>
            </behavior>
        </serviceBehaviors>
    </behaviors>
</system.serviceModel> 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:51:46.243

删除身份块不起作用，尽管确实给了我一个想法：如果我将端点地址更改为：

```
 R.Endpoint.Address = new EndpointAddress(new Uri("http://bigpuss.homeip.net/RServer/RService.svc")); 
```

到

```
 R.Endpoint.Address = new EndpointAddress(new Uri("http://localhost/RServer/RService.svc")); 
```

然后一切正常！Soo，它显然对非本地 url 地址感到不安。配置中是否还有其他区域设置了安全性？

# wcf - WCF 客户端的最佳方法

> ID：246638
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-29T12:42:22.390
> 
>         
> 
> 标签：wcf

我有使用 WCF 服务将一些数据插入后端数据库的客户端应用程序。客户端应用程序将在每个事件的基础上调用服务（可以是每小时或每秒）。

我想知道调用该服务的最佳方式是什么。

我应该创建通信通道并始终保持打开状态，还是应该在每次通话后关闭通道并重新创建？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T12:55:03.270

第一个问题是您的服务器是否需要直接维护有关客户端的任何状态（即您是否在进行类似会话的事务？）如果是，您将需要能够管理服务器如何在通信之间保存信息。

我对您的问题的最初感觉是，如果不需要打开连接，则每次都将其关闭并按需重新创建新连接。这将避免连接可以在调用之间进入故障状态的问题。*创建和销毁连接的开销很小，并且（可能）会在出现问题时*为您节省大量调试时间。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:02:17.437

我认为您可能想要实现一个[Keep Alive 模式](http://en.wikipedia.org/wiki/Keepalive)，它具有可配置的持续时间，以通知您的基础机制在超过 Keep-alive 持续时间且通信活动为零时关闭连接。

# installation - 先决条件和启动条件

> ID：246641
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T12:43:31.407
> 
>         
> 
> 标签：installation, prerequisites

关于设置的先决条件和启动条件，我遇到了一个小问题。

例如，我的设置有一个需要“Software1”的启动条件和一个安装“Software2”的先决条件。

因此，如果系统在安装设置时没有“Software1”和“Software2”这两个要求：

1.  它是否显示“Software2”的先决条件对话框

2.  它是否显示“Software1”的启动代码。

我正在观察使用我的设置获得先决条件对话框的行为。

有没有办法在安装设置时设置顺序或将启动条件显示为第一个对话框？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-19T17:34:38.590

如果您在安装中使用 InstallShield 先决条件，它们将由 setup.exe 安装，而不是 MSI。启动条件由 MSI 处理，在安装先决条件之前不会运行。基本上，这意味着在安装先决条件之前您无法显示启动条件。

话虽如此，您可以配置先决条件的条件，如果您提前知道启动条件是否无法满足，则不会安装先决条件。这样做的最终效果是在没有安装先决条件的情况下显示启动条件，但这并不是实现这一目标的真正简单方法。

在 InstallShield 2009 中，您可以配置在选择功能之前不会安装的“功能先决条件”。在这种情况下，与选定功能相关的先决条件将在安装 UI 序列结束时安装，或者，如果在没有 UI 的情况下运行安装，则在安装执行序列之前安装。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:06:18.443

如果没有更多关于您正在使用哪种安装程序系统的详细信息，将很难提供帮助。假设您正在使用 Visual Studio 中的内置内容，请在 google 上查找*Visual Studio msi 自定义操作*。我相信其中一项允许的操作是启动另一个可执行文件。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-30T00:49:33.937

假设您正在使用 MSI 启动条件，您无法确定将评估哪些订单启动条件。

如果您确实需要按特定顺序检查某些内容，则需要使用自定义操作而不是启动条件。

# nhibernate - NHibernate：如何组合两个类的字段？

> ID：246644
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T12:43:49.813
> 
>         
> 
> 标签：nhibernate, hibernate, nhibernate-mapping

这是我的数据库模型的简化版本。我有两个表：“Image”和“HostingProvider”，如下所示：

**[图片]**

*   ID

*   文件名

*   托管服务提供商 ID

**[托管服务提供商]**

*   ID

*   base_url

Image HostingproviderId 是与 HostingProvider 表的多对一外键关系。（每张图片都有一个托管服务提供商）。  

本质上，我希望能够让我的 Image 类看起来像这样：

**[图片]**

*   ID

*   base_url

*   文件名

在 NHibernate 中，如何创建一个映射文件，将 HostingProvider 表中的 base_url 组合到 Image 类中？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T13:26:37.980

你要找的是这个：

[http://ayende.com/Blog/archive/2007/04/24/Multi-Table-Entities-in-NHibernate.aspx](http://ayende.com/Blog/archive/2007/04/24/Multi-Table-Entities-in-NHibernate.aspx)

这是它的外观：

```
<class name="Person">

       <id name="Id" column="person_id" unsaved-value="0">

              <generator class="native"/>

       </id>

       <property name="Name"/>

       <property name="Sex"/>

       <join table="address">

              <key column="address_id"/>

              <property name="Address"/>

              <property name="Zip"/>

              <property name="Country"/>

              <property name="HomePhone"/>

              <property name="BusinessPhone"/>

       </join>

</class> 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:20:51.003

```
public class Image {
    public virtual HostingProvider HostingProvider { get; set; } // NHibernate takes care of this
    public virtual string BaseUrl { get { return HostingProvider.BaseUrl; } }
} 
```

# jira - 如何过滤掉只有特定用户才能看到和访问的JIRA项目？

> ID：246651
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-29T12:46:04.990
> 
>         
> 
> 标签：jira

目前我们有多个项目共享一个 JIRA 实例。我们想让用户只查看他们正在测试的项目。

但是，我们目前正在将这些用户分组到标准的 jira-users 分组中。

过滤掉只有特定用户才能看到和访问的 JIRA 项目的最佳方法是什么

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-04-30T16:59:00.250

就我个人而言，我完全赞成项目角色。我有一个通用权限方案，允许项目角色中定义的所有用户/组浏览项目，这让项目管理员/经理定义哪些组可以查看他们的项目。因此，通过删除或添加 jira-users（用户必须加入甚至登录 JIRA 的默认组）到他们项目的“用户”项目角色，项目经理可以控制是否所有用户都可以查看他们的项目.

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2008-10-29T13:12:38.210

您应该为您拥有的每个项目创建特殊的用户组......您可以拥有多个组，例如“project1_developers”、“project2_observers”，以便更好地组织。

您还可以将这些组与项目角色结合起来，以在每个项目中定义每个组应具有的访问权限。

制定一个权限方案来设置一个项目的权限。像这样：

浏览项目->组（project1_admins，project1_developers，project1_users，project1_observers）

创建问题->组（project1_admins，project1_developers，project1_users）

移动问题->组（project1_admins）

你也可以在这里使用你的项目角色......但是我更喜欢用组来设置一切。

最后，您可以使用问题安全方案来定义谁可以查看问题，谁不能查看问题。问题安全方案实现了许多可以分配用户/组的安全级别。

希望能有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2010-03-03T14:17:57.033

完全同意 Brian 的观点：项目角色是要走的路，否则你最终会得到太多的组。角色成员资格对项目来说是本地的。组是全球性的。

完全不同意巴拉拉米：应该非常谨慎地使用安全级别，并在一小部分问题上（在例外情况下）。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2013-03-07T13:18:51.567

我写了一个关于如何做到这一点的教程。它涉及创建权限方案、组和从默认权限方案中取消用户组。我不知道这是否是唯一的方法，但一旦掌握了它只需要大约 10 分钟就可以让一个新客户设置为只有他们自己的项目的权限。

这是您将找到的有关如何执行此操作的最简单的指南：

[为单个项目/用户权限设置 JIRA](http://testigniter.blogspot.co.uk/2013/03/setting-up-jira-for-single-project-user.html)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2010-02-16T08:50:44.107

解决此问题的最佳和动态方法是借助安全级别，并在运行时使用 post 函数根据问题设置安全级别。

# c# - 正则表达式和相对文件路径

> ID：246656
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-10-29T12:47:27.293
> 
>         
> 
> 标签：c#, regex

我正在尝试使用 C# 在相对路径中匹配文件夹名称。我正在使用表达式：`"/(.*)?/"`并将匹配从左到右反转到从右到左。当我传入`"images/gringo/"`正则表达式时，它正确地给了我`"gringo"`第一组 - 我只对括号之间的内容感兴趣。当我通过时`"images/"`，它无法接听`"images"`。我尝试过使用`[/^]`，`[/$]`但都没有工作。

谢谢，大卫

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2008-10-29T12:50:12.203

您最好使用[System.IO.DirectoryInfo](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx)类来解释您的相对路径。然后，您可以使用其成员选择文件夹或文件名：

```
DirectoryInfo di = new DirectoryInfo("images/gringo/");
Console.Out.WriteLine(di.Name); 
```

这将比您可以使用的任何正则表达式安全得多。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T12:50:20.580

不要这样做。使用 System.IO.Path 分解路径部分，然后比较它们。  

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T12:52:48.657

怎么样：

```
"([^/]+)/?$" 
```

*   1 个或多个非 / 字符

*   可选的 /

*   字符串结束

但正如[@Blair Conrad](https://stackoverflow.com/questions/246656/regular-expressions-and-relative-file-paths#246663)所说 - 最好使用一个为你封装这个的类......

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T17:07:28.160

同意“*不要这样做*”的答案，但是，因为它被标记为“*正则表达式*”......

*   你不需要`?`.  `*`已经接受 0 次重复作为匹配，因此`(.*)`完全等同于`(.*)?`

*   `.*`无论如何，您很少真正想要使用。如果您试图捕获一对斜杠之间的内容，请使用`/([^/]*)/`或针对“ *foo/bar/baz/ ”进行测试（在大多数正则表达式实现中）将为“* *bar/baz* ”返回单个匹配项，而不是匹配“ *bar* ”和“ *baz* ”分开。

# sql - 在 SQL Server 2005 中保留计算的日期时间列

> ID：246666
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-29T12:50:20.720
> 
>         
> 
> 标签：sql, sql-server, sql-server-2005

我在表中有一个 XML 列；我想将该 XML 中的某个值“提升”为计算列并将其索引以加快搜索速度。我有一个函数可以接收 XML 信息并输出感兴趣的元素，如下所示：

```
CREATE FUNCTION [dbo].[fComputeValue] (@data XML)
RETURNS datetime
WITH SCHEMABINDING
AS
BEGIN
  RETURN @data.value('(/Metadata/Value[@Key="StartDate"])[1]', 'datetime')
END 
```

但是，当我尝试创建计算列时：

```
ALTER TABLE dbo.CustomMetadataTable ADD [StartDate] AS ([dbo].[fComputeValue]([CustomMetadataColumn])) PERSISTED 
```

我收到以下错误：

> 消息 4936，级别 16，状态 1，行 2 表 'CustomMetadataTable' 中的计算列 'StartDate' 无法持久化，因为该列是不确定的。

如果我：

*   使用 varchar、int、double（即日期时间除外）值

*   删除 PERSISTED 关键字（但我无法在列上创建索引）

我还应该提到日期时间值采用 XSD 日期时间格式。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-10-29T14:50:17.360

关于什么：

```
CREATE FUNCTION [dbo].[fComputeValue] (@data XML)
RETURNS varchar(50)
WITH SCHEMABINDING
AS
BEGIN
  RETURN @data.value('(/Metadata/Value[@Key="StartDate"])[1]', 'varchar(50)')
END 
```

和：

```
ALTER TABLE dbo.CustomMetadataTable ADD [StartDate] AS (convert(datetime,([dbo].[fComputeValue]([CustomMetadataColumn]), 127)) PERSISTED 
```

或者：

```
return convert(datetime, @data.value('(/Metadata/Value[@Key="StartDate"])[1]', 'varchar(50)'), 127) 
```

来自网络书籍：

> `CONVERT`是确定性的，除非存在以下条件之一：
> 
>   
>   
> 
> 源类型是 sql_variant。
> 
>   
>   
> 
> 目标类型是 sql_variant，其源类型是不确定的。
> 
>   
>   
> 
> 源或目标类型为 datetime 或 smalldatetime，其他源或目标类型为字符串，并指定了非确定性样式。为了具有确定性，样式参数必须是常数。此外，小于或等于 100 的样式是不确定的，除了样式 20 和 21。大于 100 的样式是确定的，除了样式 106、107、109 和 113。

如果您使用`CONVERT`风格可能会有所帮助`127`

# vba - 将 Access 表数据导出到 Excel

> ID：246667
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T12:50:39.863
> 
>         
> 
> 标签：vba, excel, ms-access, ms-access-2007

我在 Access 2007 中有一个包含 11,000 行和大约 20 列的表。我想创建一个将表格导出到 Excel 工作表的表单按钮。代码需要是VBA。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T12:56:47.790

通过访问，您还可以使用[TransferSpreadsheet](http://msdn.microsoft.com/en-us/library/bb214134.aspx)方法。  

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T15:03:47.223

这是一个例子。

```
 DoCmd.TransferSpreadsheet acExport, _
                                acSpreadsheetTypeExcel8, _
                                "myQuery", _
                                "C:\myDir\myFile.xls", _
                                True 
```

您可能需要确保您的目的地没有输出文件管理器 (myFile.xls)。

# mysql - mysql导入脚本

> ID：246671
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T12:53:12.853
> 
>         
> 
> 标签：mysql, load-data-infile

是否可以将 csv 数据导入 mysql 并自动创建列名，就像我可以只创建表一样，还是必须创建表名？

是否可以在导入时检查重复条目？我有一个标识符字段，但不知道如何制作它，所以它不会被导入两次。

您如何将网站上的 jpeg 文件导入到字段中？假设该网站已存储在本地，并且具有与标识符相同的文件名，并在末尾添加了“.jpeg”。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:00:21.963

正如 tante 所说，您必须自己处理表创建，但就导入 csv 而言，您应该看看[LOAD DATA INFILE](http://dev.mysql.com/doc/refman/5.0/en/load-data.html)

```
LOAD DATA [LOW_PRIORITY | CONCURRENT] [LOCAL] INFILE 'file_name'
[REPLACE | IGNORE]
INTO TABLE tbl_name
[CHARACTER SET charset_name]
[{FIELDS | COLUMNS}
    [TERMINATED BY 'string']
    [[OPTIONALLY] ENCLOSED BY 'char']
    [ESCAPED BY 'char']
]
[LINES
    [STARTING BY 'string']
    [TERMINATED BY 'string']
]
[IGNORE number LINES]
[(col_name_or_user_var,...)]
[SET col_name = expr,...] 
```

如果您在表上设置了主键，则重复条目不会成为问题。

jpeg 问题似乎是一个完全不同的问题（除非数据在您的 csv 中）

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T12:56:15.873

当然可以，但是您可能必须自己编写几行代码，只需很少的代码即可完成。检查重复项非常容易，您可以在插入小脚本之前执行此操作。

您可以将文件存储为两个字段的组合，一个 Varchar 用于名称，一个 blob 用于文件内容。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T12:57:13.717

1.  不

2.  您可以添加一个唯一约束 - 如果找到重复项，这真的取决于您想要做什么

3.  不使用 mysql - 使用脚本语言从 URL 中提取图像数据，然后插入

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T15:14:39.930

看起来您得到的答案至少涵盖了前两项。对于 Jpeg 问题，请查看[将文件存储在数据库中而不是文件系统中？](https://stackoverflow.com/questions/8952/storing-a-file-in-a-database-as-opposed-to-the-file-system "将文件存储在数据库中而不是文件系统中？").

# c++ - Windows Ce 上的 CFile 错误

> ID：246683
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-29T12:57:07.260
> 
>         
> 
> 标签：c++, file-io, windows-ce

我正在使用 Windows CE 4.2 和 MS Embedded VC++ 4.0。下面的代码给了我错误`Access to [file name] was denied.`，它创建了文件，但没有向其中写入任何内容。

```
CString tmp;
tmp.Format(_T("%s%d"), mFileName, ++ctr);
TRY 
{
  mFile.Open(tmp, CFile::modeCreate);
  mFile.Write(&data[ctr%2], 1);
  mFile.Close();
}
CATCH (CException, e)
{
  TCHAR szCause[255];
  CString strFormatted;

  e->GetErrorMessage(szCause, 255);
  strFormatted += szCause;
  AfxMessageBox(strFormatted);
}
END_CATCH 
```

有趣的是，使用`CreateFile`效果很好：

```
CString tmp;
tmp.Format(_T("%s%d"), mFileName, ++ctr);

hFile = CreateFile(tmp, GENERIC_WRITE, 0, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL /*| FILE_FLAG_WRITE_THROUGH*/, 0);
WriteFile(hFile, &(data[ctr%2]), 1, &bytesWritten, NULL);
CloseHandle(hFile); 
```

为什么会这样？我什至可以在 WinCE 上使用 CFile 吗？我刚刚开始使用嵌入式开发。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:06:07.600

我没有在 Windows CE 上使用过 MFC，但是在普通的 Windows 上，通常的习惯用法是

```
 mFile.Open(tmp, CFile::modeCreate|CFile::modeWrite);
```

即尝试将“CFile::modeWrite”添加到构造函数中。MSDN 文档建议这是必要的：

*您可以使用按位或 (|) 运算符组合下面列出的选项。需要一项访问权限和一项共享选项；modeCreate 和 modeNoInherit 模式是可选的。*

这对我来说意味着必须始终提供“modeRead”或“modeWrite”之一。

# c# - 属性设置器的 PostSharp 方面，调用通用方法

> ID：246685
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T12:57:39.270
> 
>         
> 
> 标签：c#, properties, aop, postsharp

我们有一个用于一些类似 MVC 的系统的基础对象，其中后代中的每个属性都写成这样：

```
public String FirstName
{
    get { return GetProperty<String>("FirstName", ref _FirstName); }
    set { SetProperty<String>("FirstName", ref _FirstName, value); }
} 
```

这样做既是为了调试目的，也是为了通知和验证目的。我们使用 getter 来提醒我们代码明确标记了要读取的内容（以便基类能够仅在这些属性更改时调用它）并出错的情况，我们使用 setter用于属性更改通知、脏标志处理、验证等。

为简单起见，我们假设这些方法的实现如下所示：

```
protected T GetProperty<T>(String propertyName,
    ref T backingField)
{
    return backingField;
}

protected Boolean SetProperty<T>(String propertyName,
    ref T backingField,
    T newValue)
{
    backingField = newValue;
    return true;
} 
```

当然，这两个都有更多的代码，但是这段代码与我的问题无关，或者至少我希望如此。如果是，我将修改问题。

无论如何，我想在自动属性上编写一个自动为我实现调用的 PostSharp 方面，如下所示：

```
public String FirstName { get; set; } 
```

有没有人知道我将如何去做？

我自己制作了 OnMethodBoundaryAspect 类，但是使用 ref 参数调用泛型实现的艺术让我望而却步。

这是两个类，我想扩充 TestObject 类以自动调用属性获取和设置的正确方法。

```
public class BaseObject
{
    protected T GetProperty<T>(String propertyName,
        ref T backingField)
    {
        return backingField;
    }

    protected Boolean SetProperty<T>(String propertyName,
        ref T backingField,
        T newValue)
    {
        backingField = newValue;
    }
}

public class TestObject : BaseObject
{
    public String FirstName
    {
        get;
        set;
    }

    public String LastName
    {
        get;
        set;
    }
} 
```

* * *

**编辑：**也发布在[PostSharp 论坛](http://www.postsharp.org/forum/postsharp-laos/property-setter-aspect-calling-generic-method-t557.html#p2161)上。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-11-03T23:17:35.223

应该很简单。您覆盖 OnEntry 并根据您自己的代码设置返回值。最后你使用：

```
eventArgs.ReturnValue = GetValue(x,y);  
eventArgs.FlowBehavior = FlowBehavior.Return; 
```

这将有效地拦截原始的 Get/Set 调用。

请参阅[此博客](http://www.vbandrade.com.br/?tag=cache-aop-postsharp)，它使用相同的模式显示缓存方面...

# c# - 在 Windows 服务中使用的最佳计时器

> ID：246697
> 
>         
> 
> 赞同：108
> 
>         
> 
> 时间：2008-10-29T13:00:42.150
> 
>         
> 
> 标签：c#, timer, windows-services

我需要创建一些 Windows 服务，它将每 N 段时间执行一次。

问题是：

我应该使用哪个计时器控件：`System.Timers.Timer`还是`System.Threading.Timer`一个？它对某事有影响吗？  

我之所以问，是因为我听到了许多证据表明`System.Timers.Timer`Windows 服务中的工作不正确。

谢谢你。

* * *

## 回答 #1

> 赞同：118
> 
>             
> 
> 时间：2008-10-29T13:06:36.053

两者都[`System.Timers.Timer`](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)将为[`System.Threading.Timer`](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)服务工作。

您要避免的计时器是[`System.Web.UI.Timer`](http://msdn.microsoft.com/en-us/library/system.web.ui.timer.aspx)和[`System.Windows.Forms.Timer`](http://msdn.microsoft.com/en-us/library/system.web.ui.timer.aspx)，它们分别用于 ASP 应用程序和 WinForms。使用这些将导致服务加载一个额外的程序集，这对于您正在构建的应用程序类型来说并不真正需要。

像以下示例一样使用[`System.Timers.Timer`](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)（另外，请确保使用类级别变量来防止垃圾收集，如 Tim Robinson 的回答中所述）：

```
using System;
using System.Timers;

public class Timer1
{
    private static System.Timers.Timer aTimer;

    public static void Main()
    {
        // Normally, the timer is declared at the class level,
        // so that it stays in scope as long as it is needed.
        // If the timer is declared in a long-running method,  
        // KeepAlive must be used to prevent the JIT compiler 
        // from allowing aggressive garbage collection to occur 
        // before the method ends. (See end of method.)
        //System.Timers.Timer aTimer;

        // Create a timer with a ten second interval.
        aTimer = new System.Timers.Timer(10000);

        // Hook up the Elapsed event for the timer.
        aTimer.Elapsed += new ElapsedEventHandler(OnTimedEvent);

        // Set the Interval to 2 seconds (2000 milliseconds).
        aTimer.Interval = 2000;
        aTimer.Enabled = true;

        Console.WriteLine("Press the Enter key to exit the program.");
        Console.ReadLine();

        // If the timer is declared in a long-running method, use
        // KeepAlive to prevent garbage collection from occurring
        // before the method ends.
        //GC.KeepAlive(aTimer);
    }

    // Specify what you want to happen when the Elapsed event is 
    // raised.
    private static void OnTimedEvent(object source, ElapsedEventArgs e)
    {
        Console.WriteLine("The Elapsed event was raised at {0}", e.SignalTime);
    }
}

/* This code example produces output similar to the following:

Press the Enter key to exit the program.
The Elapsed event was raised at 5/20/2007 8:42:27 PM
The Elapsed event was raised at 5/20/2007 8:42:29 PM
The Elapsed event was raised at 5/20/2007 8:42:31 PM
...
 */ 
```

如果选择[`System.Threading.Timer`](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)，可以按如下方式使用：

```
using System;
using System.Threading;

class TimerExample
{
    static void Main()
    {
        AutoResetEvent autoEvent     = new AutoResetEvent(false);
        StatusChecker  statusChecker = new StatusChecker(10);

        // Create the delegate that invokes methods for the timer.
        TimerCallback timerDelegate = 
            new TimerCallback(statusChecker.CheckStatus);

        // Create a timer that signals the delegate to invoke 
        // CheckStatus after one second, and every 1/4 second 
        // thereafter.
        Console.WriteLine("{0} Creating timer.\n", 
            DateTime.Now.ToString("h:mm:ss.fff"));
        Timer stateTimer = 
                new Timer(timerDelegate, autoEvent, 1000, 250);

        // When autoEvent signals, change the period to every 
        // 1/2 second.
        autoEvent.WaitOne(5000, false);
        stateTimer.Change(0, 500);
        Console.WriteLine("\nChanging period.\n");

        // When autoEvent signals the second time, dispose of 
        // the timer.
        autoEvent.WaitOne(5000, false);
        stateTimer.Dispose();
        Console.WriteLine("\nDestroying timer.");
    }
}

class StatusChecker
{
    int invokeCount, maxCount;

    public StatusChecker(int count)
    {
        invokeCount  = 0;
        maxCount = count;
    }

    // This method is called by the timer delegate.
    public void CheckStatus(Object stateInfo)
    {
        AutoResetEvent autoEvent = (AutoResetEvent)stateInfo;
        Console.WriteLine("{0} Checking status {1,2}.", 
            DateTime.Now.ToString("h:mm:ss.fff"), 
            (++invokeCount).ToString());

        if(invokeCount == maxCount)
        {
            // Reset the counter and signal Main.
            invokeCount  = 0;
            autoEvent.Set();
        }
    }
} 
```

这两个示例都来自 MSDN 页面。

* * *

## 回答 #2

> 赞同：37
> 
>             
> 
> 时间：2008-10-29T13:47:50.183

不要为此使用服务。创建一个普通的应用程序并创建一个计划任务来运行它。

这是通常持有的最佳实践。  [乔恩·加洛韦同意我的看法。或者也许它反过来。](http://weblogs.asp.net/jgalloway/archive/2005/10/24/428303.aspx)  无论哪种方式，事实是创建 Windows 服务来执行间歇性任务运行计时器不是最佳实践。

> **“如果你正在编写一个运行计时器的 Windows 服务，你应该重新评估你的解决方案。”**
> 
> ——Jon Galloway，ASP.NET MVC 社区项目经理，作家，兼职超级英雄

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2008-10-29T13:03:31.303

任何一个都应该可以正常工作。事实上，System.Threading.Timer 在内部使用 System.Timers.Timer。

话虽如此，很容易误用 System.Timers.Timer。如果您不将 Timer 对象存储在某个变量中，那么它很可能被垃圾收集。如果发生这种情况，您的计时器将不再触发。调用 Dispose 方法来停止计时器，或者使用 System.Threading.Timer 类，它是一个稍微好一点的包装器。

到目前为止，您发现了哪些问题？

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:27:57.653

我同意之前可能最好考虑不同方法的评论。我的建议是编写一个控制台应用程序并使用 Windows 调度程序：

这会：

*   减少复制调度程序行为的管道代码

*   在调度行为方面提供更大的灵活性（例如仅在周末运行），所有调度逻辑都从应用程序代码中抽象出来

*   利用命令行参数作为参数，而无需在配置文件等中设置配置值

*   在开发过程中更容易调试/测试

*   允许支持用户通过直接调用控制台应用程序来执行（例如，在支持情况下很有用）

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2013-05-15T13:26:25.413

如前所述，两者都`System.Threading.Timer`将`System.Timers.Timer`起作用。两者之间的最大区别在于`System.Threading.Timer`另一个包装器。

> `System.Threading.Timer`将有更多的异常处理，同时
>   `System.Timers.Timer`会吞下所有的异常。

这在过去给了我很大的问题，所以我总是使用'​​System.Threading.Timer'并且仍然很好地处理你的异常。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2015-06-26T10:57:37.097

我知道这个线程有点旧，但它在我遇到的特定场景中派上了用场，我认为值得一提的是，还有另一个原因`System.Threading.Timer`可能是一个好方法。当您必须定期执行可能需要很长时间的作业并且您希望确保在作业之间使用整个等待时间，或者您不希望作业在前一个作业完成之前再次运行时作业花费的时间比计时器周期长。您可以使用以下内容：

```
using System;
using System.ServiceProcess;
using System.Threading;

    public partial class TimerExampleService : ServiceBase
    {
        private AutoResetEvent AutoEventInstance { get; set; }
        private StatusChecker StatusCheckerInstance { get; set; }
        private Timer StateTimer { get; set; }
        public int TimerInterval { get; set; }

        public CaseIndexingService()
        {
            InitializeComponent();
            TimerInterval = 300000;
        }

        protected override void OnStart(string[] args)
        {
            AutoEventInstance = new AutoResetEvent(false);
            StatusCheckerInstance = new StatusChecker();

            // Create the delegate that invokes methods for the timer.
            TimerCallback timerDelegate =
                new TimerCallback(StatusCheckerInstance.CheckStatus);

            // Create a timer that signals the delegate to invoke 
            // 1.CheckStatus immediately, 
            // 2.Wait until the job is finished,
            // 3.then wait 5 minutes before executing again. 
            // 4.Repeat from point 2.
            Console.WriteLine("{0} Creating timer.\n",
                DateTime.Now.ToString("h:mm:ss.fff"));
            //Start Immediately but don't run again.
            StateTimer = new Timer(timerDelegate, AutoEventInstance, 0, Timeout.Infinite);
            while (StateTimer != null)
            {
                //Wait until the job is done
                AutoEventInstance.WaitOne();
                //Wait for 5 minutes before starting the job again.
                StateTimer.Change(TimerInterval, Timeout.Infinite);
            }
            //If the Job somehow takes longer than 5 minutes to complete then it wont matter because we will always wait another 5 minutes before running again.
        }

        protected override void OnStop()
        {
            StateTimer.Dispose();
        }
    }

    class StatusChecker
        {

            public StatusChecker()
            {
            }

            // This method is called by the timer delegate.
            public void CheckStatus(Object stateInfo)
            {
                AutoResetEvent autoEvent = (AutoResetEvent)stateInfo;
                Console.WriteLine("{0} Start Checking status.",
                    DateTime.Now.ToString("h:mm:ss.fff"));
                //This job takes time to run. For example purposes, I put a delay in here.
                int milliseconds = 5000;
                Thread.Sleep(milliseconds);
                //Job is now done running and the timer can now be reset to wait for the next interval
                Console.WriteLine("{0} Done Checking status.",
                    DateTime.Now.ToString("h:mm:ss.fff"));
                autoEvent.Set();
            }
        } 
```

# database-design - 什么是标准化（或标准化）？

> ID：246701
> 
>         
> 
> 赞同：110
> 
>         
> 
> 时间：2008-10-29T13:01:41.243
> 
>         
> 
> 标签：database-design, database-normalization, relational

为什么数据库人员继续进行规范化？  

它是什么？它有什么帮助？  

它适用于数据库之外的任何东西吗？  

* * *

## 回答 #1

> 赞同：185
> 
>             
> 
> 时间：2008-10-29T13:14:59.937

规范化基本上是设计一个数据库模式，以避免重复和冗余数据。如果相同的信息在数据库中的多个位置重复出现，则可能会在一个位置更新而不在另一个位置更新，从而导致数据损坏。

从 1\. 范式到 5\. 范式有多个规范化级别。每个范式都描述了如何摆脱一些特定的问题。

第一范式 (1NF) 是特殊的，因为它与冗余无关。1NF 不允许嵌套表，更具体地说是允许表作为值的列。SQL首先不支持嵌套表，因此大多数普通关系数据库默认情况下都是1NF。所以我们可以在剩下的讨论中忽略 1NF。

范式 2NF 到 5NF 都涉及在同一个表中多次表示相同信息的情况。

例如，考虑一个卫星和行星数据库：

```
Moon(PK) | Planet  | Planet kind
------------------------------
Phobos   | Mars    | Rock
Daimos   | Mars    | Rock
Io       | Jupiter | Gas
Europa   | Jupiter | Gas
Ganymede | Jupiter | Gas 
```

冗余是显而易见的：木星是一颗气体行星的事实被重复了三遍，每个月亮一个。这是对空间的浪费，但更严重的是，这种模式会使*不一致*的信息成为可能：

```
Moon(PK) | Planet  | Planet kind
------------------------------
Phobos   | Mars    | Rock
Deimos   | Mars    | Rock
Io       | Jupiter | Gas
Europa   | Jupiter | Rock <-- Oh no!
Ganymede | Jupiter | Gas 
```

查询现在可以给出不一致的结果，这可能会产生灾难性的后果。

（当然，数据库不能防止输入*错误*的信息。但它可以防止*不一致*的信息，这同样是一个严重的问题。）

标准化设计会将表格拆分为两个表格：

```
Moon(PK) | Planet(FK)     Planet(PK) | Planet kind
---------------------     ------------------------
Phobos   | Mars           Mars       | Rock
Deimos   | Mars           Jupiter    | Gas
Io       | Jupiter 
Europa   | Jupiter 
Ganymede | Jupiter 
```

现在没有事实被重复多次，因此不存在数据不一致的可能性。（看起来仍然存在一些重复，因为行星名称是重复的，但是将主键值作为外键重复不会违反规范化，因为它不会引入数据不一致的风险。）

**经验法则**
如果相同的信息可以用更少的单个单元格值表示，不计算外键，那么应该通过将表拆分为更多表来规范化表。例如，第一个表有 12 个单独的值，而两个表只有 9 个单独的（非 FK）值。这意味着我们消除了 3 个冗余值。

我们知道相同的信息仍然存在，因为我们可以编写一个`join`返回与原始未规范化表相同的数据的查询。

**如何避免此类问题？**
通过对概念模型进行一些考虑，例如通过绘制实体关系图，可以轻松避免规范化问题。行星和卫星具有一对多的关系，这意味着它们应该在两个具有外键关联的不同表中表示。当具有一对多或多对多关系的多个实体在同一表行中表示时，就会出现规范化问题。

**标准化重要吗？**是的，这*非常*重要。通过使数据库具有规范化错误，您将面临将无效或损坏的数据放入数据库的风险。由于数据“永远存在”，因此很难在首次进入数据库时​​摆脱损坏的数据。

但我并不认为区分从 2NF 到 5NF 的不同范式很重要。当模式包含冗余时通常非常明显 - 只要问题得到解决，违反的 3NF 还是 5NF 都不那么重要。

（还有一些额外的正常形式，如 DKNF 和 6NF，它们仅与数据仓库等特殊用途系统相关。）

**不要害怕正常化**。标准化水平的官方技术定义相当迟钝。听起来归一化是一个复杂的数学过程。但是，规范化基本上只是常识，您会发现如果使用常识设计数据库模式，它通常会被完全规范化。

关于标准化有许多误解：

*   有些人认为规范化的数据库速度较慢，而非规范化提高了性能。然而，这仅在非常特殊的情况下才是正确的。通常，规范化数据库也是最快的。

*   有时标准化被描述为一个渐进的设计过程，您必须决定“何时停止”。但实际上标准化水平只是描述了不同的具体问题。由高于 3rd NF 的范式解决的问题首先是非常罕见的问题，因此您的模式很可能已经在 5NF 中。

**它适用于数据库之外的任何东西吗？**不直接，不。规范化的原则对于关系数据库来说是非常具体的。然而，一般的基本主题——如果不同的实例可能不同步，你不应该有重复的数据——可以广泛应用。这基本上就是[DRY 原则](http://www.artima.com/intv/dry.html)。

* * *

## 回答 #2

> 赞同：19
> 
>             
> 
> 时间：2008-10-29T13:07:52.777

最重要的是，它用于从数据库记录中删除重复项。例如，如果您有不止一个地方（表格）可以出现一个人的名字，您可以将该名字移动到一个单独的表格中并在其他任何地方引用它。这样，如果您以后需要更改人名，您只需在一个地方进行更改。

这对于正确的数据库设计至关重要，理论上您应该尽可能多地使用它来保持数据完整性。但是，当从许多表中检索信息时，您会失去一些性能，这就是为什么有时您会看到在性能关键应用程序中使用非规范化数据库表（也称为扁平化）。

我的建议是从良好程度的规范化开始，仅在真正需要时才进行去规范化

PS 也检查这篇文章：[http](http://en.wikipedia.org/wiki/Database_normalization) ://en.wikipedia.org/wiki/Database_normalization阅读更多关于这个主题和所谓的*范式*

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2008-10-29T13:13:54.200

规范化 用于消除表中列之间的冗余和功能依赖性的过程。

有几种范式，一般用数字表示。更高的数字意味着更少的冗余和依赖性。任何 SQL 表都是 1NF（第一个范式，几乎按照定义）规范化意味着以可逆的方式更改模式（通常对表进行分区），给出一个功能相同的模型，除了更少的冗余和依赖关系。

数据的冗余和依赖性是不可取的，因为它会在修改数据时导致不一致。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T13:14:03.700

它旨在减少数据的冗余。

有关更正式的讨论，请参阅 Wikipedia [http://en.wikipedia.org/wiki/Database_normalization](http://en.wikipedia.org/wiki/Database_normalization)

我将举一个有点简单的例子。

假设一个组织的数据库通常包含家庭成员

```
id, name, address
214 Mr. Chris  123 Main St.
317 Mrs. Chris 123 Main St. 
```

可以归一化为

```
id name familyID
214 Mr. Chris 27
317 Mrs. Chris 27 
```

和一张家庭餐桌

```
ID, address
27 123 Main St. 
```

近完全归一化（BCNF）通常不用于生产，而是一个中间步骤。将数据库放入 BCNF 后，下一步通常是以逻辑方式对其进行**反规范化**，以加快查询速度并降低某些常见插入的复杂性。但是，如果不先对其进行适当的规范化，您将无法做到这一点。

这个想法是将冗余信息减少到单个条目。这在地址等字段中特别有用，其中 Chris 先生将他的地址提交为 Unit-7 123 Main St.，而 Chris 女士列出了 Suite-7 123 Main Street，这将在原始表格中显示为两个不同的地址。

通常，使用的技术是查找重复的元素，并将这些字段隔离到另一个具有唯一 ID 的表中，并用引用新表的主键替换重复的元素。  

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2008-10-31T13:25:25.747

引用 CJ 日期：理论是实用的。

偏离规范化将导致数据库出现某些异常。

偏离第一范式将导致访问异常，这意味着您必须分解和扫描各个值才能找到您要查找的内容。例如，如果其中一个值是先前响应中给出的字符串“Ford, Cadillac”，并且您正在查找“Ford”的所有出现，您将不得不打开字符串并查看子串。这在某种程度上违背了将数据存储在关系数据库中的目的。

自 1970 年以来，第一范式的定义发生了变化，但这些差异现在不必担心。如果您使用关系数据模型设计 SQL 表，您的表将自动处于 1NF 中。

偏离第二范式及以后会导致更新异常，因为相同的事实存储在多个地方。这些问题使得在不存储其他可能不存在的事实的情况下无法存储一些事实，因此必须发明。或者当事实发生变化时，您可能必须找到存储事实的所有地方并更新所有这些地方，以免最终得到一个自相矛盾的数据库。而且，当您从数据库中删除一行时，您可能会发现，如果这样做，您将删除存储仍然需要的事实的唯一位置。  

这些是逻辑问题，而不是性能问题或空间问题。有时您可以通过仔细编程来绕过这些更新异常。有时（通常）最好通过遵守正常形式来防止出现问题。

尽管已经说过很有价值，但应该提到的是，标准化是一种自下而上的方法，而不是自上而下的方法。如果您在数据分析和初始设计中遵循某些方法，则可以保证设计至少符合 3NF。在许多情况下，设计将完全标准化。

您可能真正想要应用规范化中教授的概念的地方是，当您获得遗留数据、遗留数据库或由记录组成的文件时，并且数据的设计完全无视规范形式和离开的后果从他们。在这些情况下，您可能需要发现与规范化的偏差，并更正设计。

警告：正常化通常带有宗教色彩，好像每次偏离完全正常化都是一种罪过，是对 Codd 的冒犯。（那里有点双关语）。不要买那个。当您真正、真正地学习数据库设计时，您不仅会知道如何遵守规则，而且会知道何时可以安全地打破规则。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2015-07-27T01:20:22.697

> 什么是标准化？

规范化是一个逐步的形式化过程，它允许我们以最小化**数据冗余**和[**更新异常的方式分解数据库表。**](http://www.mahipalreddy.com/dbdesign/dbqa.htm#update)

**标准化过程**[礼貌](http://www.mahipalreddy.com/dbdesign/dbqa.htm#update)

[![在此处输入图像描述](https://i.stack.imgur.com/gMLRj.jpg)](https://i.stack.imgur.com/gMLRj.jpg)

**第一范式**当且仅当每个属性的域仅包含原子值（原子值是不能被划分的值），并且每个属性的值仅包含来自该域的单个值（例如：-性别栏是：“M”、“F”。）。  

**第一范式强制执行以下标准：**  

*   消除单个表中的重复组。  

*   为每组相关数据创建一个单独的表。  

*   用一个主键识别每组相关数据

**第二范式**= 1NF + 没有部分依赖，即所有非键属性都完全依赖于主键。

**第三范式**= 2NF + 无传递依赖，即所有非键属性完全功能依赖于主键。

**Boyce–Codd 范式**（或 BCNF 或 3.5NF）是第三范式（3NF）的稍强版本。  

注意：- Second、Third 和 Boyce-Codd 范式关注函数依赖。
[例子](http://www.1keydata.com/database-normalization)

**第四范式**= 3NF + 移除多值依赖

**第五范式**= 4NF + 移除连接依赖

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T13:09:56.827

规范化是基本概念之一。这意味着两件事不会相互影响。

在数据库中具体意味着两个（或更多）表不包含相同的数据，即没有任何冗余。

乍一看，这真的很好，因为您遇到一些同步问题的机会接近于零，您总是知道您的数据在哪里，等等。但是，您的表数量可能会增加，并且您将遇到交叉数据的问题并得到一些总结性的结果。

因此，最后您将完成非纯规范化的数据库设计，并带有一些冗余（它将处于某些可能的规范化级别）。

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2020-04-20T21:09:37.880

*正如 Martin Kleppman 在他的《设计数据密集型应用程序》一书中所说：*

有关关系模型的文献区分了几种不同的范式，但这些区别几乎没有实际意义。根据经验，如果您复制的值只能存储在一个地方，则架构不会被规范化。

# c# - 在 Master.FindControl 之后，将内容块动态添加到 Masterpage 失败

> ID：246707
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T13:03:37.653
> 
>         
> 
> 标签：c#, asp.net, master-pages, itemplate

我遇到了一个奇怪的问题，对我来说没有任何意义。我正在尝试在页面上动态设置 MasterPage 内容控件。我让它与以下代码很好地工作：

```
 protected override void OnPreInit(EventArgs e)
    {
        base.OnPreInit(e);

        MasterPageFile = "~/MasterPages/Default.master";

        string existantContentPlaceHolderID = "ContentPlaceHolder1";
        string nonExistantContentPlaceHolderID = "foo";

        //Control c = Master.FindControl(existantContentPlaceHolderID);
        //Control c1 = Master.FindControl(nonExistantContentPlaceHolderID);

        TextBox t = new TextBox
                        {
                            Text = "Text"
                        };

        ITemplate iTemplate = new GenericITemplate(container => container.Controls.Add(t));

        AddContentTemplate(existantContentPlaceHolderID, iTemplate);

    }

    public delegate void InstantiateTemplateDelegate(Control container);

    public class GenericITemplate : ITemplate
    {
        private readonly InstantiateTemplateDelegate m_instantiateTemplate;

        public void InstantiateIn(Control container)
        {
            m_instantiateTemplate(container);
        }

        public GenericITemplate(InstantiateTemplateDelegate instantiateTemplate)
        {
            m_instantiateTemplate = instantiateTemplate;
        }
    } 
```

这很好用，除了我希望能够在调用 AddContentTemplate 之前仔细检查 MasterPage 上是否存在 contentPlaceHolderID，因为如果添加指向不存在的 ContentPlaceHolder 的内容控件，页面将引发错误。

我遇到的问题是，在上面的示例中，当我调用注释的 Master.FindControl 行之一时，TextBox 不再呈现。

有没有人知道为什么会这样......我无法对正在发生的事情做出正面或反面。

谢谢，马克斯

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T15:27:50.403

问题是 AddContentTemplate 只是将其参数记录在一个哈希表中，以便在创建时与母版页实例组合。在创建母版页后调用它不会做任何事情，读取 Master 属性会导致创建母版页。

我能看到的最好的方法是使用 LoadControl 创建一个单独的母版页实例，您可以在不影响页面自己的 Master 属性的情况下对其进行检查...

```
MasterPage testMaster = (MasterPage) LoadControl( MasterPageFile );
Control c = testMaster.FindControl(existantContentPlaceHolderID); 
```

创建第二个实例有一些开销，但对我来说是否值得担心并不是很明显。

# c# - 如何在 C# 中实现单例？

> ID：246710
> 
>         
> 
> 赞同：26
> 
>         
> 
> 时间：2008-10-29T13:04:38.913
> 
>         
> 
> 标签：c#, .net, singleton

如何在 C# 中实现单例模式？我想将我的常量和一些基本函数放入其中，因为我在项目中到处使用它们。我想让它们“全局”，而不需要手动绑定我创建的每个对象。

* * *

## 回答 #1

> 赞同：29
> 
>             
> 
> 时间：2008-10-29T13:14:40.377

如果您只是存储一些全局值并且有一些不需要状态的方法，则不需要单例。只需将类及其属性/方法设为静态即可。

```
public static class GlobalSomething
{
   public static int NumberOfSomething { get; set; }

   public static string MangleString( string someValue )
   {
   }
} 
```

当你有一个普通的有状态的类时，单例是最有用的，但你只想要其中一个。其他人提供的链接对于探索单例模式应该很有用。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2008-10-29T13:13:02.843

`Singleton != Global`. 您似乎在寻找关键字`static`。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T13:27:58.587

**只有当这两个**条件都为真时，单例才有意义：

1.  对象必须是**全局的**

2.  **必须只**存在一个对象的实例

请注意，#2 并不意味着您希望*对象*只有一个实例——如果是这样，只需实例化一次——这意味着**必须**存在（如，这不正确是很危险的）只能是一个实例。

如果您想要全局，只需创建某个（非符号）对象的全局实例（或使其成为静态或其他）。如果您只想要一个实例，那么静态是您的朋友。此外，只需实例化一个对象。

反正这是我的意见。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T14:47:20.237

您可以真正简化单例实现，这就是我使用的：

```
 internal FooService() { }        
    static FooService() { }

    private static readonly FooService _instance = new FooService();

    public static FooService Instance
    {
        get { return _instance; }
    } 
```

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2008-10-30T12:00:28.183

嗯，这一切似乎有点复杂。

为什么需要依赖注入框架来获取单例？对于某些企业应用程序来说，使用 IOC 容器是可以的（当然，只要它没有被过度使用），但是，啊，这家伙只是想知道如何实现该模式。

为什么不总是急切地实例化，然后提供一个返回静态的方法，上面写的大部分代码然后就消失了。遵循古老的 C2 格言 - DoTheSimplestThingThatCouldPossiblyWork...

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T13:12:13.780

我建议您阅读MSDN 上提供的[Exploring the Singleton Design Pattern文章。](http://msdn.microsoft.com/en-us/library/ms954629.aspx)它详细介绍了使模式易于实现的框架的特性。

顺便说一句，我会查看[SO 有关 Singletons 的相关阅读](https://stackoverflow.com/search?q=singleton)。

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T13:43:37.680

忽略你是否应该使用单例模式的问题，这已经在别处讨论过，我会像这样实现一个单例：

```
/// <summary>
/// Thread-safe singleton implementation
/// </summary>
public sealed class MySingleton {

    private static volatile MySingleton instance = null;
    private static object syncRoot = new object();

    /// <summary>
    /// The instance of the singleton
    /// safe for multithreading
    /// </summary>
    public static MySingleton Instance {
        get {
            // only create a new instance if one doesn't already exist.
            if (instance == null) {
                // use this lock to ensure that only one thread can access
                // this block of code at once.
                lock (syncRoot) {
                    if (instance == null) {
                        instance = new MySingleton();
                    }
                }
            }
            // return instance where it was just created or already existed.
            return instance;
        }
    }

    /// <summary>
    /// This constructor must be kept private
    /// only access the singleton through the static Instance property
    /// </summary>
    private MySingleton() {

    }

} 
```

* * *

## 回答 #8

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T14:43:21.867

如果您想要松散耦合的设计，静态单例几乎是一种反模式。尽可能避免，除非这是一个非常简单的系统，否则我建议您查看许多可用的依赖注入框架之一，例如[http://ninject.org/](http://ninject.org/)或[http://code.google.com/p /autofac/](http://code.google.com/p/autofac/)。

要在 autofac 中注册/使用配置为单例的类型，您可以执行以下操作：

```
var builder = new ContainerBuilder()
builder.Register(typeof(Dependency)).SingletonScoped()
builder.Register(c => new RequiresDependency(c.Resolve<Dependency>()))

var container = builder.Build();

var configured = container.Resolve<RequiresDependency>(); 
```

顺便说一句，公认的答案是一个糟糕的解决方案，至少检查实际实施该模式的人。

* * *

## 回答 #9

> 赞同：2
> 
>             
> 
> 时间：2008-12-17T04:47:06.660

```
public class Globals
{
    private string setting1;
    private string setting2;

    #region Singleton Pattern Implementation

    private class SingletonCreator
    {
        internal static readonly Globals uniqueInstance = new Globals();

        static SingletonCreator()
        {
        }
    }

    /// <summary>Private Constructor for Singleton Pattern Implementaion</summary>
    /// <remarks>can be used for initializing member variables</remarks>
    private Globals()
    {

    }

    /// <summary>Returns a reference to the unique instance of Globals class</summary>
    /// <remarks>used for getting a reference of Globals class</remarks>
    public static Globals GetInstance
    {
        get { return SingletonCreator.uniqueInstance; }
    }

    #endregion

    public string Setting1
    {
        get { return this.setting1; }
        set { this.setting1 = value; }
    }

    public string Setting2
    {
        get { return this.setting2; }
        set { this.setting2 = value; }
    }

    public static int Constant1 
    {
        get { reutrn 100; }
    }

    public static int Constat2
    {
        get { return 200; }
    }

    public static DateTime SqlMinDate
    {
        get { return new DateTime(1900, 1, 1, 0, 0, 0); }
    }

} 
```

* * *

## 回答 #10

> 赞同：2
> 
>             
> 
> 时间：2008-12-21T19:04:38.607

我喜欢这种模式，尽管它不会阻止某人创建非单例实例。有时，最好教育团队中的开发人员使用正确的方法，而不是竭尽全力防止某些笨蛋以错误的方式使用您的代码……

```
 public class GenericSingleton<T> where T : new()
    {
        private static T ms_StaticInstance = new T();

        public T Build()
        {
            return ms_StaticInstance;
        }
    }

...
    GenericSingleton<SimpleType> builder1 = new GenericSingleton<SimpleType>();
    SimpleType simple = builder1.Build(); 
```

这将为您提供一个实例（以正确的方式实例化）并且实际上是惰性的，因为在调用 Build() 之前不会调用静态构造函数。

* * *

## 回答 #11

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T17:53:54.227

您所描述的只是静态函数和常量，*而不是*单例。单例设计模式（很少需要）描述了一个实例化的类，但在第一次使用时自动实例化一次*。*

它将延迟初始化与检查结合起来，以防止多次实例化。它只对包装一些物理上单一的概念的类真正有用，例如围绕硬件设备的包装器。

静态常量和函数就是这样：根本不需要实例的代码。

问问自己这个问题：“如果有多个实例，这个类会中断吗？” 如果答案是否定的，则不需要单例。

* * *

## 回答 #12

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T18:45:54.590

嗯...很少有具有相关功能的常量...通过枚举不是更好吗？我知道您可以使用方法和所有方法在 Java 中创建自定义枚举，在 C# 中也应该可以实现，如果不直接支持，那么可以使用带有私有构造函数的简单类单例来完成。

如果您的常量在语义上相关，您应该考虑枚举（或等效概念），您将获得 const 静态变量的所有优势 + 您将能够利用编译器的类型检查来发挥您的优势。

我的 2 美分

* * *

## 回答 #13

> 赞同：1
> 
>             
> 
> 时间：2008-10-30T11:37:06.000

就我个人而言，我会选择一个依赖注入框架，比如 Unity，它们都能够在容器中配置单例项，并通过从类依赖转移到接口依赖来改善耦合。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2008-10-30T01:55:17.097

通过隐藏公共构造函数，添加一个私有静态字段来保存这个唯一的实例，并添加一个静态工厂方法（带有惰性初始化器）来返回那个单一的实例

```
public class MySingleton   
{  
    private static MySingleton sngltn; 
    private static object locker;  
    private MySingleton() {}   // Hides parameterless ctor, inhibits use of new()   
    public static MySingleton GetMySingleton()       
    {     
        lock(locker)
            return sngltn?? new MySingleton();
    }   
} 
```

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2017-12-09T13:27:50.347

我使用单例模式为我的项目编写了一个类。这是非常容易使用。希望它对你有用。请找到以下代码。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace TEClaim.Models
{
public class LogedinUserDetails
{
    public string UserID { get; set; }
    public string UserRole { get; set; }
    public string UserSupervisor { get; set; }
    public LogedinUserDetails()
    {

    }

    public static LogedinUserDetails Singleton()
    {
        LogedinUserDetails oSingleton;

        if (null == System.Web.HttpContext.Current.Session["LogedinUserDetails"])
        {               
            oSingleton = new LogedinUserDetails();
            System.Web.HttpContext.Current.Session["LogedinUserDetails"] = oSingleton;
        }
        else
        {              
            oSingleton = (LogedinUserDetails)System.Web.HttpContext.Current.Session["LogedinUserDetails"];
        }

        //Return the single instance of this class that was stored in the session
        return oSingleton;
    }
}
} 
```

现在您可以像这样在应用程序中为上述代码设置变量值。

```
[HttpPost]
public ActionResult Login(FormCollection collection)
{
  LogedinUserDetails User_Details = LogedinUserDetails.Singleton();
  User_Details.UserID = "12";
  User_Details.UserRole = "SuperAdmin";
  User_Details.UserSupervisor = "815978";
  return RedirectToAction("Dashboard", "Home");
} 
```

你可以像这样检索这些值..

```
public ActionResult Dashboard()
    {
        LogedinUserDetails User_Details = LogedinUserDetails.Singleton();
        ViewData["UserID"] = User_Details.UserID;
        ViewData["UserRole"] = User_Details.UserRole;
        ViewData["UserSupervisor"] = User_Details.UserSupervisor;

        return View();
    } 
```

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2018-04-05T08:25:26.127

在 c# 中它可能是（线程安全以及延迟初始化）：

```
public sealed class MySingleton
{
    static volatile Lazy<MySingleton> _instance = new Lazy<MySingleton>(() => new MySingleton(), true);
    public static MySingleton Instance => _instance.Value;
    private MySingleton() { }
} 
```

# authentication - 有哪些方法可以利用 SecurID 和类似技术？

> ID：246717
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-29T13:06:18.707
> 
>         
> 
> 标签：authentication, securid

来自维基百科：[RSA SecurID](http://en.wikipedia.org/wiki/SecurID)是 RSA Security 开发的一种机制，用于为用户对网络资源执行双重身份验证。

我刚读到这个设备，我觉得它很有趣。但是，我不确定软件（联网或非联网）如何（甚至是否）可以利用这种身份验证方法。

我将其设为社区 wiki 帖子，因为这不是一个特定问题，而是使用 SecurID 和类似技术解决身份验证的一般概述。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-11-29T04:55:47.070

有一种类似的技术叫做[YubiKey](http://www.yubico.com/products/yubikey/)。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-30T01:10:37.263

[Verisign 的 OpenID 提供商](https://pip.verisignlabs.com/)支持此类令牌（由 EBay 和 PayPal 以折扣价出售），这无疑是开始对 Web 应用程序使用双因素身份验证的最简单方法。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2013-02-14T16:31:54.343

要真正回答最初的问题，有几种方法可以与 SecurID 集成，从“最简单”到“需要更多工作”：

1.  查看应用程序是否已经集成/认证。可在[http://www.rsasecured.com找到已由 RSA 集成](http://www.rsasecured.com)*和验证*的应用程序列表。仅列出选择通过验证的应用程序；应用程序可能可以集成但尚未经过验证。

2.  利用现有的 RSA 身份验证代理之一（与身份验证管理器服务器对话的代码片段）并与操作系统/应用程序服务器/Web 服务器集成，以便可以将身份验证“卸载”到代理，并且应用程序只需要处理核心功能。RSA 开发的代理可以从[http://www.emc.com/security/rsa-securid/rsa-securid-authentication-agents.htm](http://www.emc.com/security/rsa-securid/rsa-securid-authentication-agents.htm)下载（RSA 是 EMC 的安全部门）。

3.  如果应用程序/设备可以利用 RADIUS 协议进行外部身份验证（请参阅[http://en.wikipedia.org/wiki/RADIUS](http://en.wikipedia.org/wiki/RADIUS)），则身份验证管理器服务器也是 RADIUS 服务器。

4.  最后，如果您想将应用程序直接与 RSA 集成，RSA SecurID Agent SDK 允许您在应用程序本身中嵌入所需的功能，因此应用程序可以直接与身份验证管理器服务器对话，发送身份验证请求，接收答案，利用身份验证服务器等的 HA 功能......这就是 VPN SSL 集中器、防火墙和许多其他设备等设备的集成方式（参见第 1 点中的列表）。

希望这可以帮助

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-08T17:25:10.907

我的公司 WiKID Systems 有一个双源双因素身份验证系统。除了 radius、ldap 等，我们还有一个非常简单的 API，称为 wAuth 和 PHP、Python、Ruby、Java 和 C# 中可用的包。这些“网络客户端”软件包是 LGPL，因此您可以将它们放入开源或商业许可软件中。你可以[在这里下载](http://www.wikidsystems.com/downloads/network-clients)。做其他人也很简单。

此外，我们有软件令牌的开源版本，因此您可以根据需要将其嵌入，您可以真正了解系统是如何从端到端工作的。

# windows - 如何在 Delphi 中播放 wav 文件？

> ID：246723
> 
>         
> 
> 赞同：22
> 
>         
> 
> 时间：2008-10-29T13:08:35.020
> 
>         
> 
> 标签：windows, delphi, audio

Delphi 中有哪些功能可以播放声音文件？

* * *

## 回答 #1

> 赞同：30
> 
>             
> 
> 时间：2008-10-29T13:21:06.370

这是最快的方法：

```
uses MMSystem;

procedure TForm1.Button1Click(Sender: TObject);
begin
  sndPlaySound('C:\Windows\Media\Tada.wav',
    SND_NODEFAULT Or SND_ASYNC Or SND_LOOP);
end;

procedure TForm1.Button2Click(Sender: TObject);
begin
  sndPlaySound(nil, 0); // Stops the sound
end; 
```

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2008-10-29T13:20:25.870

使用来自 WIN32-API（单元 MMSystem）的函数 sndPlaySound：

sndPlaySound('C:\Windows\Media\Tada.wav', SND_ASYNC);

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2016-04-18T09:41:51.637

简单的：

```
procedure PlaySoundFile(FileName: string);
begin
 if FileExists(FileName)
 then PlaySound(pchar(FileName), 0, SND_ASYNC or SND_FILENAME);  

 { Flags are:
    SND_SYNC  =0 = Start playing, and wait for the sound to finish
    SND_ASYNC =1 = Start playing, and don't wait to return
    SND_LOOP  =8 = Keep looping the sound until another sound is played  }
end; 
```

人们也引用了 sndPlaySound ，但这只是为了向后兼容。**所以，不要使用它！**

您可能还对此感兴趣：

```
procedure PlayWinSound(SystemSoundName: string);
begin
 Winapi.MMSystem.PlaySound(PChar(SystemSoundName), 0, SND_ASYNC);
end;

{ All available constants are defined in the registry under the path HKEY_CURRENT_USER -> AppEvents -> Schemes -> Apps -> .Default. 
  System sounds:
    SystemEXCLAMATION        - Note)
    SystemHAND               - Critical Stop)
    SystemQUESTION           - Question)
    SystemSTART              - Windows-Start)
    SystemEXIT               - Windows-Shutdown)
    SystemASTERIX            - Star)
    RESTOREUP                - Enlarge)
    RESTOREDOWN              - Shrink)
    MENUCOMMAND              - Menu)
    MENUPOPUP                - Pop-Up)
    MAXIMIZE                 - Maximize)
    MINIMIZE                 - Minimize)
    MAILBEEP                 - New Mail)
    OPEN                     - Open Application)
    CLOSE                    - Close Application)
    APPGPFAULT               - Program Error)
    Asterisk                 - played when a popup alert is displayed, like a warning message.
    Calendar Reminder        - played when a Calendar event is taking place.
    Critical Battery Alarm   - played when your battery reaches its critical level.
    Critical Stop            - played when a fatal error occurs.
    Default Beep             - played for multiple reasons, depending on what you do. For example, it will play if you try to select a parent window before closing the active one.
    Desktop Mail Notif       - played when you receive a message in your desktop email client.
    Device Connect           - played when you connect a device to your computer. For example, when you insert a memory stick.
    Device Disconnect        - played when you disconnect a device from your computer.
    Device Connect Failed    - played when something happened with the device that you were trying to connect.
    Exclamation              - played when you try to do something that is not supported by Windows.
    Instant Message Notif    - played when you receive an instant message.
    Low Battery Alarm        - played when the battery is running low.
    Message Nudge            - played when you receive a BUZZ in an instant message.
    New Fax Notification     - played when you receive a fax via your fax-modem.
    New Mail Notification    - played when you receive an email message.
    New Text Message Notif   - played when you receive a text message.
    NFP Completion           - played when the transfer of data via NFC between your Windows device and another device is completed.
    NFP Connection           - played when your Windows device is connecting to another device via NFC.
    Notification             - played when a default notification from a program or app is displayed.
    System Notification      - played when a system notification is displayed.  } 
```

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2008-10-30T14:32:49.453

这个页面很好地解释了如何使用函数 sndPlaySound 以及如何将 wav 文件作为资源嵌入：
 [http ://www.latiumsoftware.com/en/delphi/00024.php](http://www.latiumsoftware.com/en/delphi/00024.php)

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T13:16:36.113

完整的教程可在以下网址获得：http: [//sheepdogguides.com/dt3f.htm](http://sheepdogguides.com/dt3f.htm)

它有点旧了。但它应该工作。

# python - 如何将制表符补全添加到 Python shell？

> ID：246725
> 
>         
> 
> 赞同：135
> 
>         
> 
> 时间：2008-10-29T13:09:10.090
> 
>         
> 
> 标签：python, shell, interpreter

使用 启动 django 应用程序时`python manage.py shell`，我得到一个 InteractiveConsole shell - 我可以使用制表符完成等。

```
Python 2.5.1 (r251:54863, Apr 15 2008, 22:57:26) 
[GCC 4.0.1 (Apple Inc. build 5465)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
(InteractiveConsole) 
```

刚使用 启动 python 解释器`python`时，它不提供制表符补全。

有人可以告诉我 django 正在做什么来给我一个交互式控制台，或者我需要做什么才能在没有 django 应用程序的情况下启动一个交互式控制台？

* * *

## 回答 #1

> 赞同：223
> 
>             
> 
> 时间：2008-10-29T13:24:39.607

我可能已经找到了一种方法。

创建一个文件 .pythonrc

```
# ~/.pythonrc
# enable syntax completion
try:
    import readline
except ImportError:
    print("Module readline not available.")
else:
    import rlcompleter
    readline.parse_and_bind("tab: complete") 
```

然后在你的 .bashrc 文件中，添加

```
export PYTHONSTARTUP=~/.pythonrc 
```

这似乎行得通。

* * *

## 回答 #2

> 赞同：35
> 
>             
> 
> 时间：2008-10-29T13:21:43.823

我认为 django 做了类似[https://docs.python.org/library/rlcompleter.html](https://docs.python.org/library/rlcompleter.html)

如果您想拥有一个非常好的交互式解释器，请查看 
[IPython](https://ipython.org/)。

* * *

## 回答 #3

> 赞同：27
> 
>             
> 
> 时间：2008-10-29T16:39:03.053

作为记录，这在教程中有所介绍：http: [//docs.python.org/tutorial/interactive.html](http://docs.python.org/tutorial/interactive.html)

* * *

## 回答 #4

> 赞同：13
> 
>             
> 
> 时间：2015-08-21T08:11:38.863

我使用[ptpython——](https://github.com/jonathanslenders/ptpython/)它是一个很棒的工具自动完成 shell cmd。

安装ptpython很简单，使用pip工具

```
pip install ptpython 
```

**对于 django shell，你应该像这样导入 django env**

```
import os

os.environ.setdefault("DJANGO_SETTINGS_MODULE", "testweb.settings") 
```

相信我，这是最适合你的方法！！！

* * *

## 回答 #5

> 赞同：7
> 
>             
> 
> 时间：2019-03-05T21:42:10.193

修复 Windows 10 外壳：

```
pip install pyreadline3  # previously, pyreadline but that package was abandoned
pip install ipython 
```

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2017-03-23T21:50:33.263

看起来 python3 开箱即用！

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2017-07-02T19:44:48.970

在 Python3 中，此功能默认启用。我的系统没有`readline`安装该模块。我在Manjaro。我在其他 Linux 发行版（elementary、ubuntu、mint）上没有遇到这个选项卡完成问题。

安装模块后`pip`，在导入时，它抛出以下错误 -

`ImportError: libncursesw.so.5: cannot open shared object file: No such file or directory` 

为了解决这个问题，我跑了——

`cd /usr/lib
ln -s libncursesw.so libncursesw.so.5` 

这解决了导入错误。而且，它还带来了 python repl 中的选项卡完成，而没有任何创建/更改`.pythonrc`and `.bashrc`。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2020-02-11T07:09:08.420

是的。它内置于 3.6。

```
fernanr@gnuruwi ~ $ python3.6
Python 3.6.3 (default, Apr 10 2019, 14:37:36)
[GCC 4.8.5 20150623 (Red Hat 4.8.5-16)] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import os
>>> os.
Display all 318 possibilities? (y or n)
os.CLD_CONTINUED             os.O_RDONLY                  os.ST_NOEXEC                 os.environ                   os.getpid(                   os.readlink(                 os.spawnvpe(
os.CLD_DUMPED                os.O_RDWR                    os.ST_NOSUID                 os.environb                  os.getppid(                  os.readv(                    os.st 
```

* * *

## 回答 #9

> 赞同：-1
> 
>             
> 
> 时间：2020-02-11T07:16:50.703

对于旧版本（2.x），上面的脚本就像魅力：）

```
fernanr@crsatx4 ~ $ cat .bashrc | grep -i python
#Tab completion for python shell
export PYTHONSTARTUP=~/.pythonrc
fernanr@crsatx4 ~ $ . ~/.bashrc
fernanr@crsatx4 ~ $ echo $?
0
fernanr@crsatx4 ~ $ python2
Python 2.7.5 (default, Jun 11 2019, 14:33:56)
[GCC 4.8.5 20150623 (Red Hat 4.8.5-39)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import os
>>> os.
Display all 249 possibilities? (y or n)
os.EX_CANTCREAT             os.O_WRONLY 
```

# reporting-services - 在 SSRS 中，你可以设置一个矩形来随着它的内容增长吗？

> ID：246726
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T13:09:50.947
> 
>         
> 
> 标签：reporting-services, rectangles, report-designer

我现在正在处理 SSRS（SQL Server 报告服务）中的报告，并且在获取我在报告设计器中的页面上绘制的矩形以增长时遇到问题。基本上，我画了一个矩形，然后在里面放了一个文本字段。此文本字段的内容可以很短也可以很长，因此我希望它能够增长以适应其内容。

但是当我输入长文本时，文本框会变大，然后粘在矩形的线条之外。从我阅读的 SSRS 文档中，它说矩形应该增长以包含其中的项目，并且这些项目是“对等的”。

是什么赋予了？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T14:55:56.897

我可以让文本框突破矩形边框的唯一方法是，如果文本框实际上不在矩形内部，而是在矩形下方。

当文本框在矩形内时，并且当文本框属性时，文本**`CanGrow = TRUE`**框及其矩形都垂直向下增长以容纳大量文本。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2010-11-11T19:36:36.797

我看到了同样的问题。我的问题是我先有文本框，然后将矩形放在它周围并将其发送到后面。一旦我将文本框拖出然后回到矩形上，它就会正常增长。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2013-12-05T22:47:30.120

您可以通过查看文本框的 Parent 属性来判断文本框是在矩形中还是在正文中（例如）。如果文本框在矩形之外，则可以很好地剪切文本框并将其粘贴到矩形中。在尝试将对象拖入（到）矩形时，我有时会遇到问题。

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2016-05-05T22:08:31.540

也许有点晚了 - 但它可能会在以后帮助某人。

矩形可以用作容器。  

要将矩形变成容器，请先创建矩形。只需将您的其他子对象元素（例如列表、表格等）放入容器中。

但是，您不能在创建子对象后创建容器。

# c# - C#/.Net 变更日志

> ID：246732
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-29T13:11:10.523
> 
>         
> 
> 标签：c#, .net

当 1.0 框架首次发布时，我开始编写 C# 应用程序。直到 2.0 框架发布之前，我专业地使用它工作了大约三年。

正如我现在所看到的，我看到去年发布了 3.5，并且该框架的每个新版本都添加了大量相互关联的功能。

鉴于他们已经在 .NET 中有坚实的基础，是否有一个很好的参考资料（印刷版或网络版）可以让他们了解当前的情况？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-10-29T13:14:22.670

MSDN 为他们的大多数技术提供了一系列“.. 中的新功能”。

*   [.NET Framework 2.0 版的新增功能](http://msdn.microsoft.com/en-us/library/t357fb32(VS.80).aspx)

*   [.NET Framework 3.0 版中的新增功能](http://msdn.microsoft.com/en-us/library/bb822048.aspx)

*   [.NET Framework 3.5 版中的新增功能](http://msdn.microsoft.com/en-us/library/bb332048.aspx)

*   [.NET Framework 版本 3.5 SP1 中的新增功能](http://msdn.microsoft.com/en-us/library/cc713697.aspx)

*   等搜索谷歌“什么是新的XYZ”

这是一张强调最近变化的海报[。](http://blogs.msdn.com/brada/archive/2008/10/29/net-framework-4-poster.aspx)预览：
![替代文字](https://i.stack.imgur.com/PScwg.png)

# java - 在 AJAX 和 excel 中显示汉字

> ID：246734
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-29T13:11:26.653
> 
>         
> 
> 标签：java

我目前正在开发一个 Java Struts 应用程序，我想知道如何在 AJAX 中显示中文字符以及通过 servlet 响应生成 excel 文件时。

任何人都可以分享任何指针？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:23:53.367

只要您使用 UTF8 进行字符编码，我认为您应该没问题。如果 UTF8 不是一个选项，并且您将*只*显示中文，您甚至可以尝试其中一种中文特定字符编码。

我会尝试为您提供更多详细信息，但至少要设置字符编码，您必须这样做：

```
response.setCharacterEncoding("UTF-8"); 
```

或者

```
response.setContentType("text/plain; charset=UTF-8"); 
```

请参阅 Java EE 规范 ( [http://java.sun.com/j2ee/1.4/docs/api/index.html](http://java.sun.com/j2ee/1.4/docs/api/index.html) ) 了解这些的确切含义。

# java - Java 文件游标

> ID：246744
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T13:13:47.913
> 
>         
> 
> 标签：java, performance, file, file-io

是否有一些库可以在文件上使用某种光标？我必须读取大文件，但不能一次将它们全部读入内存。我知道 java.nio，但我想使用更高级别的 API。

一点背景：我有一个用 GWT 编写的工具，可以分析提交的 xml 文档，然后漂亮地打印 xml，等等。目前我正在将漂亮打印的 xml 写入临时文件（如果我使用纯字符串，我的库会抛出 OOMException），但临时文件的大小接近 18 兆，我无法用 18 响应 GWT RPC梅格：）

所以我可以有一个小部件来只显示 xml 的一部分（检查这个[例子](http://zwitserloot.com/tipit-gwtlib/example/)），但我需要读取文件的相应部分。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-10-29T13:18:13.940

您是否看过使用 FileChannels（即内存映射文件）？内存映射文件允许您在不将整个文件放入内存的情况下操作大文件。

这是一个很好的介绍的链接：http:
 [//www.developer.com/java/other/article.php/1548681](http://www.developer.com/java/other/article.php/1548681)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T13:17:55.237

也许[java.io.RandomAccessFile](https://docs.oracle.com/javase/1.5.0/docs/api/java/io/RandomAccessFile.html)对你有用。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T23:18:40.220

当您在定位文件指针时要求“更高级别的 API”时，我不明白。可能需要控制“光标”的是更高级别。如果你想控制，就往低点，不要往高点。

我确信较低级别的 Java io 类允许您将自己定位在任何大小的文件中，而无需将任何内容读入内存，直到您愿意。我知道我以前做过。试试 RandomAccessFile 作为一个例子。

# database - 如何在 UML 中标记数据库组件？

> ID：246760
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-10-29T13:18:18.963
> 
>         
> 
> 标签：database, uml

在 UML 组件图中，如何将组件标记或标识为数据库，以便易于识别？在过去，有用于显示数据库的圆柱符号，但这不是 UML 的一部分。例如，应用程序服务器也是如此，这将如何显示？

刻板印象在这里适用吗？可以用图形元素增强元件符号吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T13:21:06.057

只需使用`<<database>>`组件图。

有关更详细的信息，请查看这篇文章：[http ://www.sparxsystems.com.au/resources/uml_datamodel.html](http://www.sparxsystems.com.au/resources/uml_datamodel.html)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:20:25.950

[根据 Scott Ambler](http://www.agilemodeling.com/artifacts/componentDiagram.htm)`<<database>>`的说法，您将数据库和服务器标记为（出现） 。我从图 1 中提取了这些信息，但我建议阅读这篇文章（以及他的其他文章——它们是很好的读物）。`<<infrastructure>>` 

我想指出的其他一点——UML 只是一种建模方法。在正式文档中，我尽量遵守标准。但是，在为团队规划和记录时，我会使用任何有意义且团队理解的东西。对您而言，这可能意味着将标有“DB”的圆柱体或 DB 名称放入组件框中。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:31:48.187

UML 可以通过配置文件进行扩展。

关键的可扩展性机制是原型、约束和标记值。

原型可以有一个可选的原型图标。

*   您也许可以找到带有 «database» 圆柱图标的现有配置文件

*   您的 UML 工具可能允许您创建自己的配置文件

# spring-mvc - 在 Spring Interceptor postHandle 方法中添加 HTTP 标头

> ID：246762
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-29T13:18:52.987
> 
>         
> 
> 标签：spring-mvc

我有一个 Spring 拦截器，它试图在 postHandle() 方法中添加一个 HTTP 标头。

```
public void postHandle(HttpServletRequest req, HttpServletResponse resp, 
             Object obj1, ModelAndView mv)
        throws Exception {
        response.setHeader("SomeHeaderSet", "set");
        response.addHeader("SomeHeaderAdd", "added");
    }
} 
```

但是，无论是使用 setHeader() 还是 addHeader() 都不会添加任何标头。

这在拦截器中是否有效？我想它会是，但它不起作用。

问候，达斯汀

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:49:38.277

您是否尝试在 preHandle 方法中设置标题？如果这不起作用，请尝试为容器编写一个过滤器并在其中设置标题。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T16:43:55.103

嗯，我想通了……有点……

事实证明，Jetty 和 Tomcat 也有同样的问题（推测可能是容器问题）。所以...

调试以确保响应对象包含正确的标头值，直到 Spring 返回容器。结果：HttpServletResponse 实例仍然具有正确的标头值。

我在我的代码中发现我在`response.setContentLength()`对标题做任何事情之前调用了它。如果我将其注释掉，一切正常。

那么，剩下的谜团是，为什么调用会`response.setContentLength()`锁定并且不允许修改任何标题？我认为内容正文与其他标题没有任何关系。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2010-06-22T12:21:21.883

我有一个类似的问题，当我在 web.xml 中有以下内容时它可以工作（还没有弄清楚为什么）

```
<filter>
  <filter-name>etagFilter</filter-name>
    <filter-class>org.springframework.web.filter.ShallowEtagHeaderFilter</filter-class>
</filter>

<filter-mapping>
  <filter-name>etagFilter</filter-name>
  <servlet-name>myServlet</servlet-name>
</filter-mapping> 
```

# nhibernate - NHibernate/ActiveRecord - 任何方式只映射到外键列？

> ID：246766
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-29T13:20:21.923
> 
>         
> 
> 标签：nhibernate, activerecord, castle-activerecord

我正在使用 Castle ActiveRecord，但这个问题也适用于 NHibernate，因为适用于 NHibernate 的解决方案应该适用于 ActiveRecord。无论如何，我拥有的是这样的底层表结构：

表A -hasMany-> 表B

我有相应的对象 EntityA 和 EntityB。EntityA 有一个 EntityB 对象的 IList。这部分工作正常。现在，我希望 EntityB 对 EntityA 有某种引用。我知道我可以使用 EntityB 上的 BelongsTo 属性为其提供对完整 EntityA 类型的实际引用，例如：

```
[BelongsTo("tableAid")]
public EntityA Parent { get; set; } 
```

但我真正想做的是：

```
[BelongsTo("tableAid")]
public int ParentId { get; set; } 
```

因此，EntityB 将仅存储父对象的 ID，而不是对实际对象的引用。这是一个微不足道的例子，但我有充分的理由想要采用这种方法。在我正在处理的应用程序中，我们有显示特定 EntityB 类对象的页面，我们希望这些页面包含指向相应父页面的链接（如超链接中的链接）。我们可以使用上面的第一种方法来做到这一点，但这需要在我真正需要的只是 ID 时加载整个 EntityA 对象。这不是什么大不了的事，但似乎很浪费。我知道我可以使用延迟加载，但同样，这对我来说更像是一种黑客行为......

我尝试使用 [Property] 属性标记外键，如下所示：

```
[Property]
public int ParentId { get; set; } 
```

这种方法的问题在于，当您在新对象树上执行 EntityA.SaveAndFlush() 时，EntityB.ParentId 仍然为空。正确的值被写入数据库，我可以通过执行 EntityA.Refresh() 将值强制回 EntityB.ParentId，但同样，这似乎有点像 hack。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-03T11:57:23.820

延迟加载正是您想要的——它也不是一个 hack，它在 NHIbernate 的一部分中经过了良好的测试和烘焙，并且是调整任何实质性 NHibernate 应用程序性能时的重要工具。

如果您要将您的“父”EntityA 标记为延迟加载，则引用 EntityB.Parent.Id 根本不会加载 EntityA（因为在幕后 NHIbernate 在加载 EntityB 时已经加载了 EntityA 的 id） - 从而让您无需设置链接即可招致性能损失。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:22:55.370

只是这个：

```
[Property] public int ParentId { get; set; } 
```

...假设`ParentId`是实际的列名。

其他一些评论。  

首先，您应该考虑延迟加载多对一属性。如果您急切地加载它们，您必须意识到急切加载可能的级联，这可能会严重影响性能。为此，您必须将延迟加载的类的所有公共成员标记为虚拟。

其次，请注意，任何时候您有一个一对多的关联，而没有从子级到父级的对应关系，您必须使数据库中的 FK 可以为空。这是因为当 NH 创建新的子项目时，它会将其插入其父 id 为 null，然后在第二步中对其进行更新。

# tfs - Team Foundation 和 64 位 windows，无法安装？

> ID：246780
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-29T13:25:55.877
> 
>         
> 
> 标签：tfs, 64-bit, windows-server-2008, windows-server-2003

那么，您不能在 windows 2008 64 位上安装 Team Foundation 是经过认证的答案吗？

**更新**

将它安装在 Windows 2003 或 2008 上会更好吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:28:21.113

简短的回答是[否定的](http://blogs.msdn.com/granth/archive/2008/09/15/can-i-run-tfs-on-a-64-bit-os.aspx)

重读我需要明确双重否定，阅读链接，官方是你不能，但如果需要，有一个解决方法。

# content-management-system - 在哪里将完整的 url 存储在 cms 中？

> ID：246787
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-29T13:28:05.670
> 
>         
> 
> 标签：content-management-system, friendly-url, slug

我正在创建一个 cms，但尚未确定在哪里存储结构中给定页面的完整 url。

每个页面都有一个 slug（页面的 url 友好名称），每个页面都有一个可以为空的（对于顶级页面）父级和子级。

我在哪里存储给定页面的完整 url (/first-page/sub-page)？这应该与页面的其他属性一起进入数据库还是一些缓存？

**更新**

这不是我要询问的数据库设计，而是将完整 url 存储到给定页面的位置，因此我不需要遍历整个 url 来获取用户请求的页面（/first-page/sub-page )

**更新 2**

我需要找到哪个页面属于当前请求的 url。如果请求的 url 是 /first-page/sub-page 我不想拆分 url 并循环访问数据库（显然）。

我宁愿将整个 url 放在表中，这样我就可以执行一个查询（WHERE url = '/first-page/sub-page'），但这似乎并不理想，如果我更改 slug 的父页面？然后我还需要更新所有后代的 url 字段。

其他人如何解决这个问题？他们是否将其放入数据库中？在将 /first-page-/sub-page 映射到页面 id 的缓存中？还是他们拆分请求的 url 并循环访问数据库？

谢谢

安德斯

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T15:21:43.990

将其存储在缓存中，因为 Web 服务器需要不断地查找 URL。除非您期望页面的 URL 变化非常迅速，否则缓存将大大减少数据库的负载，这通常是您在数据库驱动的网站中的瓶颈。

基本上，您需要一个映射 URL -> 呈现页面所需的任何内容的字典。许多 Web 服务器会自动使用操作系统的文件系统作为字典，并且通常具有内置缓存，可以识别文件系统中的文件何时发生更改。这可能比您在 CMS 中编写的任何内容都高效得多。因此，让您的 CMS 直接在文件系统中实现该结构并使用硬链接或软链接处理附加映射可能会更好。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-08-11T19:50:29.327

我只是为[MvcCms](http://www.mvccms.com/cms/url-slug)做了这个。我提出了内容类别/子类别和内容页面的想法。当创建内容类别/子类别时，我会递归地通过父母并构建整个路线，然后将其存储在类别表中。然后，当页面被请求时，我可以找到正确的内容页面，并在通过导航结构时找出当前正在构建的导航是否是当前或活动路线。

这种方法需要一些关于编辑类别时会发生什么的规则。现在的方法是，一旦为子类别设置了完整路径，以后就不能使用普通工具进行更改。

来源是 mvccms.codeplex.com

# c# - 在 C# Web 服务中调用异步调用

> ID：246791
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T13:30:34.680
> 
>         
> 
> 标签：c#, web-services, asynchronous, function-calls

我在 Web 服务中使用第三方资源（.dll），我的问题是，调用此资源（调用方法）是异步完成的 - 我需要订阅一个事件，以获得答案我的请求。我如何在 ac# web 服务中做到这一点？

**更新：**

关于[Sunny 的回答](https://stackoverflow.com/questions/246791/invoking-asynchronous-call-in-a-c-web-service/246892#246892)：

我不想让我的网络服务异步。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T17:21:42.000

假设您的第 3 方组件使用整个 .NET Framework 中使用的异步编程模型模式，您可以执行以下操作

```
 HttpWebRequest httpWebRequest = (HttpWebRequest)WebRequest.Create("http://www.stackoverflow.com");
    IAsyncResult asyncResult = httpWebRequest.BeginGetResponse(null, null);

    asyncResult.AsyncWaitHandle.WaitOne();

    using (HttpWebResponse httpWebResponse = (HttpWebResponse)httpWebRequest.EndGetResponse(asyncResult))
    using (StreamReader responseStreamReader = new StreamReader(httpWebResponse.GetResponseStream()))
    {
        string responseText = responseStreamReader.ReadToEnd();
    } 
```

由于您需要阻止 Web 服务操作，因此您应该使用 IAsyncResult.AsyncWaitHandle 而不是回调来阻止，直到操作完成。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-30T07:58:17.283

如果第 3 方组件不支持标准异步编程模型（即不使用 IAsyncResult），您仍然可以使用 AutoResetEvent 或 ManualResetEvent 实现同步。为此，请在 Web 服务类中声明 AutoResetEvent 类型的字段：

```
AutoResetEvent processingCompleteEvent = new AutoResetEvent(); 
```

然后在调用 3rd 方组件后等待事件发出信号

```
// call 3rd party component
processingCompleteEvent.WaitOne() 
```

并在回调事件处理程序中发出信号让等待线程继续执行：

```
 processingCompleteEvent.Set() 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:58:10.460

来自[MSDN 文档](http://msdn.microsoft.com/en-us/library/aa719796.aspx)：

```
using System;
using System.Web.Services;

[WebService(Namespace="http://www.contoso.com/")]
public class MyService : WebService {
  public RemoteService remoteService;
  public MyService() {
     // Create a new instance of proxy class for 
     // the XML Web service to be called.
     remoteService = new RemoteService();
  }
  // Define the Begin method.
  [WebMethod]
  public IAsyncResult BeginGetAuthorRoyalties(String Author,
                  AsyncCallback callback, object asyncState) {
     // Begin asynchronous communictation with a different XML Web
     // service.
     return remoteService.BeginReturnedStronglyTypedDS(Author,
                         callback,asyncState);
  }
  // Define the End method.
  [WebMethod]
  public AuthorRoyalties EndGetAuthorRoyalties(IAsyncResult
                                   asyncResult) {
   // Return the asynchronous result from the other XML Web service.
   return remoteService.EndReturnedStronglyTypedDS(asyncResult);
  }
} 
```

# wpf - 尝试将 ListBox 绑定到 ListBoxItem 的内容时，如何从 ListBox 访问 DisplayMemberPath？

> ID：246792
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T13:30:56.847
> 
>         
> 
> 标签：wpf, binding, listbox

我已经覆盖了 Windows ListBox，以便在每个 ListBoxItem 中显示图像和一段文本，但我需要过滤显示的文本的内容，我希望通过访问实际 ListBox 的 DisplayMemberPath 来做到这一点，但是我可以'让它工作。

```
<Setter Property="ItemContainerStyle">
        <Setter.Value>
            <!-- Simple ListBoxItem - This is used for each Item in a ListBox. The item's content is placed in the ContentPresenter -->
            <Style TargetType="{x:Type ListBoxItem}">
                <Setter Property="SnapsToDevicePixels" Value="true"/>
                <Setter Property="OverridesDefaultStyle" Value="true"/>
                <Setter Property="VerticalContentAlignment" Value="Center"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ListBoxItem}">
                            <Grid SnapsToDevicePixels="true">
                                <Border x:Name="Border">
                                    <Grid Height="40">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Image
                                            Source="{Binding Path=ThumbnailImage}"
                                            Height="30"
                                            Width="30"
                                            Grid.Column="0"/>

                                        <Label 
                                            x:Name="Text"
                                            Content="{TemplateBinding DisplayMemberPath}"
                                            VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                            VerticalContentAlignment="Center"
                                            HorizontalAlignment="Stretch"
                                            Grid.Column="1"
                                            Height="40"/>
                                    </Grid>
                                </Border>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsSelected" Value="true">
                                    <Setter Property="FontWeight" Value="Bold" TargetName="Text"/>
                                    <Setter Property="Foreground" Value="White" TargetName="Text"/>
                                    <Setter Property="Background" Value="Blue" TargetName="Border"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </Setter.Value>
    </Setter> 
```

这是我用于我的风格的代码，这是我无法工作的行：

内容="{TemplateBinding DisplayMemberPath}"

它抱怨：在“ListBoxItem”类型上找不到静态成员“DisplayMemberPathProperty”

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:49:20.803

没关系，我现在已经从 ListBox 中获取了值，我需要做的就是将其转换为从 itemssource 中的数据对象中获取我需要的属性。

以防万一有人想知道代码：

```
Content="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=ListBox}, Path=DisplayMemberPath}" 
```

# sql-server - Sql Server 中的数据时间线性能

> ID：246799
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-29T13:32:51.617
> 
>         
> 
> 标签：sql-server, performance, datetime, timeline

我有一个包含三列的表：

**用户 varchar，状态 varchar，rep int**

status 和 rep 经常更新，其中一项要求是：

**给定每个用户在给定日期的日期时间值视图状态和代表值。**

我可以在表中添加一个 updated_at 日期时间列，并使用同一用户插入新行而不是更新现有行，但是表变大了，我需要将查询结果加入到其他表的类似结果中，因此我需要一个快速查询.

在 SQL Server 中解决此问题的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:47:59.577

根据您将如何使用报告信息，最好创建一个历史表，在更新主表之前，将当前值写入历史表，添加时间戳。

如果您真的只从历史中挑选特定的日期/用户/状态，那将是最好的

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:51:33.373

我会将此存储为一个单独的相关表，因为我假设大多数时候您只会在加入时查询当前状态。如果您将进行大量此类查询并将此类数据添加到许多表中，而不仅仅是此表，我将创建一个单独的 OLAP 数据库用于报告。

顺便说一句，只要您这样做，您可能会考虑是否要记录谁进行了更改。那么你基本上已经构建了一个审计解决方案。  

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:51:38.147

一种选择是使用两个单独的表：“当前值”表和历史表。当前值表将包含每个用户的唯一最新值，这将使其保持小且易于连接。历史表将包含您列出的三列以及时间戳列，并将跟踪值随时间的变化。每当您想更改当前值表中的值时，您将同时使用 gettime() 作为时间戳向历史表中添加一行包含新值的行。

# asp.net - 启用浮出控件时悬停时突出显示 ASP.NET 菜单父菜单项

> ID：246800
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T13:32:52.647
> 
>         
> 
> 标签：asp.net, javascript, css, menu, hover

我有一个 ASP.Net 菜单控件，它具有三个级别并启用了浮出控件。每当用户将鼠标悬停在菜单项上时，我想突出显示父项（直到顶级父项）。

我不想使用此处描述的客户端解决方案：http:
 [//www.codeproject.com/KB/webforms/AspMenuParentHighlighting.aspx](http://www.codeproject.com/KB/webforms/AspMenuParentHighlighting.aspx)

有没有优雅的服务器端解决方案？

亲切的问候。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T17:29:40.783

我能想到的唯一服务器端解决方案是在页面加载时设置客户端解决方案。

您是否有理由要构建此服务器端而不是客户端？因为根据定义，强制这样的事件发生在服务器端是相当不雅的。

# javascript - 如何在 JavaScript 中将字符串编码为 Base64？

> ID：246801
> 
>         
> 
> 赞同：1044
> 
>         
> 
> 时间：2008-10-29T13:34:18.993
> 
>         
> 
> 标签：javascript, base64, binaryfiles

我有一个 PHP 脚本，可以将 PNG 图像编码为 Base64 字符串。

我想用 JavaScript 做同样的事情。我知道如何打开文件，但我不确定如何进行编码。我不习惯使用二进制数据。

* * *

## 回答 #1

> 赞同：1169
> 
>             
> 
> 时间：2008-10-29T15:31:03.237

您可以使用[`btoa()`](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/btoa)and[`atob()`](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/atob)与 base64 编码相互转换。

关于这些函数接受/返回什么的评论似乎有些混乱，所以......</p>

*   `btoa()`接受一个“字符串”，其中每个字符代表一个 8 位字节——如果你传递一个包含不能用 8 位表示的字符的字符串，[它可能会中断](https://developer.mozilla.org/en-US/docs/Web/API/window.btoa#Unicode_Strings). *如果*您实际上将字符串视为字节数组，这不是问题，但如果您尝试做其他事情，那么您必须先对其进行编码。

*   `atob()`返回一个“字符串”，其中每个字符代表一个 8 位字节——也就是说，它的值将介于`0`和之间`0xff`。这并不*意味着*它是 ASCII ——大概如果你使用这个函数，你希望使用二进制数据而不是文本。

### 也可以看看：

*   [如何使用 Javascript 和 XMLHttpRequest 加载二进制图像数据？](https://stackoverflow.com/questions/1095102/how-do-i-load-binary-image-data-using-javascript-and-xmlhttprequest)

* * *

这里的大多数评论都已过时。除非您支持真正过时的浏览器，否则您可能可以同时使用`btoa()`and 。`atob()`

在这里检查：

*   [https://caniuse.com/?search=atob](https://caniuse.com/?search=atob)

*   [https://caniuse.com/?search=btoa](https://caniuse.com/?search=btoa)

* * *

## 回答 #2

> 赞同：311
> 
>             
> 
> 时间：2008-10-29T13:39:17.783

[从这里](http://www.webtoolkit.info/javascript-base64.html)：

```
/**
*
*  Base64 encode / decode
*  http://www.webtoolkit.info/
*
**/
var Base64 = {

    // private property
    _keyStr : "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",

    // public method for encoding
    encode : function (input) {
        var output = "";
        var chr1, chr2, chr3, enc1, enc2, enc3, enc4;
        var i = 0;

        input = Base64._utf8_encode(input);

        while (i < input.length) {

            chr1 = input.charCodeAt(i++);
            chr2 = input.charCodeAt(i++);
            chr3 = input.charCodeAt(i++);

            enc1 = chr1 >> 2;
            enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
            enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
            enc4 = chr3 & 63;

            if (isNaN(chr2)) {
                enc3 = enc4 = 64;
            } else if (isNaN(chr3)) {
                enc4 = 64;
            }

            output = output +
            this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) +
            this._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);
        }
        return output;
    },

    // public method for decoding
    decode : function (input) {
        var output = "";
        var chr1, chr2, chr3;
        var enc1, enc2, enc3, enc4;
        var i = 0;

        input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");

        while (i < input.length) {

            enc1 = this._keyStr.indexOf(input.charAt(i++));
            enc2 = this._keyStr.indexOf(input.charAt(i++));
            enc3 = this._keyStr.indexOf(input.charAt(i++));
            enc4 = this._keyStr.indexOf(input.charAt(i++));

            chr1 = (enc1 << 2) | (enc2 >> 4);
            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
            chr3 = ((enc3 & 3) << 6) | enc4;

            output = output + String.fromCharCode(chr1);

            if (enc3 != 64) {
                output = output + String.fromCharCode(chr2);
            }
            if (enc4 != 64) {
                output = output + String.fromCharCode(chr3);
            }
        }

        output = Base64._utf8_decode(output);

        return output;
    },

    // private method for UTF-8 encoding
    _utf8_encode : function (string) {
        string = string.replace(/\r\n/g,"\n");
        var utftext = "";

        for (var n = 0; n < string.length; n++) {

            var c = string.charCodeAt(n);

            if (c < 128) {
                utftext += String.fromCharCode(c);
            }
            else if((c > 127) && (c < 2048)) {
                utftext += String.fromCharCode((c >> 6) | 192);
                utftext += String.fromCharCode((c & 63) | 128);
            }
            else {
                utftext += String.fromCharCode((c >> 12) | 224);
                utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                utftext += String.fromCharCode((c & 63) | 128);
            }
        }
        return utftext;
    },

    // private method for UTF-8 decoding
    _utf8_decode : function (utftext) {
        var string = "";
        var i = 0;
        var c = c1 = c2 = 0;

        while ( i < utftext.length ) {

            c = utftext.charCodeAt(i);

            if (c < 128) {
                string += String.fromCharCode(c);
                i++;
            }
            else if((c > 191) && (c < 224)) {
                c2 = utftext.charCodeAt(i+1);
                string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));
                i += 2;
            }
            else {
                c2 = utftext.charCodeAt(i+1);
                c3 = utftext.charCodeAt(i+2);
                string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));
                i += 3;
            }
        }
        return string;
    }
} 
```

此外，搜索[“JavaScript base64 encoding”](http://www.google.com/search?q=javascript+base64+encode)会出现很多其他选项，以上是第一个。

* * *

## 回答 #3

> 赞同：187
> 
>             
> 
> 时间：2014-10-22T18:06:33.560

## 互联网浏览器 10+

```
// Define the string
var string = 'Hello World!';

// Encode the String
var encodedString = btoa(string);
console.log(encodedString); // Outputs: "SGVsbG8gV29ybGQh"

// Decode the String
var decodedString = atob(encodedString);
console.log(decodedString); // Outputs: "Hello World!" 
```

* * *

## 跨浏览器

```
// Create Base64 Object
var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="";var n,r,i,s,o,u,a;var f=0;e=Base64._utf8_encode(e);while(f<e.length){n=e.charCodeAt(f++);r=e.charCodeAt(f++);i=e.charCodeAt(f++);s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)}return t},decode:function(e){var t="";var n,r,i;var s,o,u,a;var f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length){s=this._keyStr.indexOf(e.charAt(f++));o=this._keyStr.indexOf(e.charAt(f++));u=this._keyStr.indexOf(e.charAt(f++));a=this._keyStr.indexOf(e.charAt(f++));n=s<<2|o>>4;r=(o&15)<<4|u>>2;i=(u&3)<<6|a;t=t+String.fromCharCode(n);if(u!=64){t=t+String.fromCharCode(r)}if(a!=64){t=t+String.fromCharCode(i)}}t=Base64._utf8_decode(t);return t},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t},_utf8_decode:function(e){var t="";var n=0;var r=c1=c2=0;while(n<e.length){r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else if(r>191&&r<224){c2=e.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|c2&63);n+=2}else{c2=e.charCodeAt(n+1);c3=e.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63);n+=3}}return t}}

// Define the string
var string = 'Hello World!';

// Encode the String
var encodedString = Base64.encode(string);
console.log(encodedString); // Outputs: "SGVsbG8gV29ybGQh"

// Decode the String
var decodedString = Base64.decode(encodedString);
console.log(decodedString); // Outputs: "Hello World!" 
```

[jsFiddle](http://jsfiddle.net/gabrieleromanato/qAGHT/)

* * *

## 使用 Node.js

以下是在 Node.js 中将普通文本编码为 base64 的方法：

```
//Buffer() requires a number, array or string as the first parameter, and an optional encoding type as the second parameter.
// The default is "utf8". Possible encoding types are "ascii", "utf8", "ucs2", "base64", "binary", and "hex"
var b = new Buffer('JavaScript');
// If we don't use toString(), JavaScript assumes we want to convert the object to utf8.
// We can make it convert to other formats by passing the encoding type to toString().
var s = b.toString('base64'); 
```

以下是解码 base64 编码字符串的方法：

```
var b = new Buffer('SmF2YVNjcmlwdA==', 'base64')
var s = b.toString(); 
```

* * *

## 使用 Dojo.js

*使用dojox.encoding.base64*对字节数组进行编码：

```
var str = dojox.encoding.base64.encode(myByteArray); 
```

要解码 Base64 编码的字符串：

```
var bytes = dojox.encoding.base64.decode(str) 
```

* * *

## Bower 安装 angular-base64

```
<script src="bower_components/angular-base64/angular-base64.js"></script>

angular
    .module('myApp', ['base64'])
    .controller('myController', [

    '$base64', '$scope',
    function($base64, $scope) {

        $scope.encoded = $base64.encode('a string');
        $scope.decoded = $base64.decode('YSBzdHJpbmc=');
}]); 
```

* * *

## 回答 #4

> 赞同：97
> 
>             
> 
> 时间：2011-07-18T22:08:34.547

[Sunny 的代码](https://stackoverflow.com/questions/246801/how-can-you-encode-a-string-to-base64-in-javascript/246813#246813)很棒，只是它在 Internet Explorer 7 中因为引用了“this”而中断。通过用“Base64”替换这些引用来修复它：

```
var Base64 = {
    // private property
    _keyStr : "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",

    // public method for encoding
    encode : function (input) {
        var output = "";
        var chr1, chr2, chr3, enc1, enc2, enc3, enc4;
        var i = 0;

        input = Base64._utf8_encode(input);

        while (i < input.length) {

            chr1 = input.charCodeAt(i++);
            chr2 = input.charCodeAt(i++);
            chr3 = input.charCodeAt(i++);

            enc1 = chr1 >> 2;
            enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
            enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
            enc4 = chr3 & 63;

            if (isNaN(chr2)) {
                enc3 = enc4 = 64;
            } else if (isNaN(chr3)) {
                enc4 = 64;
            }

            output = output +
            Base64._keyStr.charAt(enc1) + Base64._keyStr.charAt(enc2) +
            Base64._keyStr.charAt(enc3) + Base64._keyStr.charAt(enc4);
        }

        return output;
    },

    // public method for decoding
    decode : function (input) {
        var output = "";
        var chr1, chr2, chr3;
        var enc1, enc2, enc3, enc4;
        var i = 0;

        input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");

        while (i < input.length) {

            enc1 = Base64._keyStr.indexOf(input.charAt(i++));
            enc2 = Base64._keyStr.indexOf(input.charAt(i++));
            enc3 = Base64._keyStr.indexOf(input.charAt(i++));
            enc4 = Base64._keyStr.indexOf(input.charAt(i++));

            chr1 = (enc1 << 2) | (enc2 >> 4);
            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
            chr3 = ((enc3 & 3) << 6) | enc4;

            output = output + String.fromCharCode(chr1);

            if (enc3 != 64) {
                output = output + String.fromCharCode(chr2);
            }
            if (enc4 != 64) {
                output = output + String.fromCharCode(chr3);
            }
        }

        output = Base64._utf8_decode(output);

        return output;
    },

    // private method for UTF-8 encoding
    _utf8_encode : function (string) {
        string = string.replace(/\r\n/g,"\n");
        var utftext = "";

        for (var n = 0; n < string.length; n++) {

            var c = string.charCodeAt(n);

            if (c < 128) {
                utftext += String.fromCharCode(c);
            }
            else if((c > 127) && (c < 2048)) {
                utftext += String.fromCharCode((c >> 6) | 192);
                utftext += String.fromCharCode((c & 63) | 128);
            }
            else {
                utftext += String.fromCharCode((c >> 12) | 224);
                utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                utftext += String.fromCharCode((c & 63) | 128);
            }
        }
        return utftext;
    },

    // private method for UTF-8 decoding
    _utf8_decode : function (utftext) {
        var string = "";
        var i = 0;
        var c = c1 = c2 = 0;

        while ( i < utftext.length ) {

            c = utftext.charCodeAt(i);

            if (c < 128) {
                string += String.fromCharCode(c);
                i++;
            }
            else if((c > 191) && (c < 224)) {
                c2 = utftext.charCodeAt(i+1);
                string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));
                i += 2;
            }
            else {
                c2 = utftext.charCodeAt(i+1);
                c3 = utftext.charCodeAt(i+2);
                string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));
                i += 3;
            }
        }
        return string;
    }
} 
```

* * *

## 回答 #5

> 赞同：94
> 
>             
> 
> 时间：2011-12-27T03:27:14.577

您可以使用`btoa`(to Base64) 和`atob`(from Base64)。

对于 Internet Explorer 9 及更低版本，请尝试[jquery-base64](https://github.com/carlo/jquery-base64)插件：

```
$.base64.encode("this is a test");
$.base64.decode("dGhpcyBpcyBhIHRlc3Q="); 
```

* * *

## 回答 #6

> 赞同：58
> 
>             
> 
> 时间：2017-08-23T16:24:54.277

从已接受答案下方的评论（由 SET 和 Stefan Steiger 撰写），这里是如何在不需要库的情况下将字符串编码/解码到/从 Base64 的快速摘要。

```
str = "The quick brown fox jumps over the lazy dog";
b64 = btoa(unescape(encodeURIComponent(str)));
str = decodeURIComponent(escape(window.atob(b64))); 
```

## 纯 JavaScript 演示

```
const input = document.getElementsByTagName('input')[0];
const btnConv = document.getElementById('btnConv');
const btnDeConv = document.getElementById('btnDeConv');

input.value = "The quick brown fox jumps over the lazy dog";

btnConv.addEventListener('click', () => {
  const txt = input.value;
  const b64 = btoa(unescape(encodeURIComponent(txt)));
  input.value = b64;
  btnDeConv.style.display = 'block';
  btnConv.style.display = 'none';
});

btnDeConv.addEventListener('click', () => {
  var b64 = input.value;
  var txt = decodeURIComponent(escape(window.atob(b64)));
  input.value = txt;
  btnConv.style.display = 'block';
  btnDeConv.style.display = 'none';
});
```

```
input{width:500px;}
#btnDeConv{display:none;}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<div><input type="text" /></div>
<button id="btnConv">Convert</button>
<button id="btnDeConv">DeConvert</button>
```

.

**jQuery Demo ** *（使用 jQuery 库进行显示，但不用于编码/解码）*

```
str = "The quick brown fox jumps over the lazy dog";

$('input').val(str);

$('#btnConv').click(function(){
  var txt = $('input').val();
  var b64 = btoa(unescape(encodeURIComponent(txt)));
  $('input').val(b64);
  $('#btnDeConv').show();
});
$('#btnDeConv').click(function(){
  var b64 = $('input').val();
  var txt = decodeURIComponent(escape(window.atob(b64)));
  $('input').val(txt);
});
```

```
#btnDeConv{display:none;}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<input type="text" />
<button id="btnConv">Convert</button>
<button id="btnDeConv">DeConvert</button>
```

* * *

## 回答 #7

> 赞同：27
> 
>             
> 
> 时间：2011-07-26T21:14:36.537

在`_utf8_decode`. `c1`并且由于语句`c2`的错误使用而被分配为全局变量`var`，并且`c3`根本没有初始化或声明。

它可以工作，但是这些变量将覆盖此函数之外任何具有相同名称的现有变量。

这是一个不会这样做的版本：

```
// private method for UTF-8 decoding
_utf8_decode : function (utftext) {
    var string = "";
    var i = 0;
    var c = 0, c1 = 0, c2 = 0;

    while ( i < utftext.length ) {

        c = utftext.charCodeAt(i);

        if (c < 128) {
            string += String.fromCharCode(c);
            i++;
        }
        else if((c > 191) && (c < 224)) {
            c1 = utftext.charCodeAt(i+1);
            string += String.fromCharCode(((c & 31) << 6) | (c1 & 63));
            i += 2;
        }
        else {
            c1 = utftext.charCodeAt(i+1);
            c2 = utftext.charCodeAt(i+2);
            string += String.fromCharCode(((c & 15) << 12) | ((c1 & 63) << 6) | (c2 & 63));
            i += 3;
        }
    }
    return string;
} 
```

* * *

## 回答 #8

> 赞同：21
> 
>             
> 
> 时间：2016-11-03T02:24:41.930

这个问题及其答案为我指明了正确的方向。尤其是 Unicode，不能使用*atob*和*btoa “香草”，而现在**一切*都是 Unicode...

直接来自 Mozilla，为此提供了两个不错的功能。

使用 Unicode 和 HTML 标签测试：

```
function b64EncodeUnicode(str) {
    return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, function(match, p1) {
        return String.fromCharCode('0x' + p1);
    }));
}

b64EncodeUnicode('✓ à la mode'); // "4pyTIMOgIGxhIG1vZGU="
b64EncodeUnicode('\n'); // "Cg=="

function b64DecodeUnicode(str) {
    return decodeURIComponent(Array.prototype.map.call(atob(str), function(c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));
}

b64DecodeUnicode('4pyTIMOgIGxhIG1vZGU='); // "✓ à la mode"
b64DecodeUnicode('Cg=='); // "\n" 
```

与使用自定义 JavaScript 函数的原始 Base64 解码相比，这些函数的执行速度快如闪电，因为*btoa*和*atob*在解释器之外执行。

如果您可以忽略旧 Internet Explorer 和旧手机（如 iPhone 3？），这应该是一个很好的解决方案。

* * *

## 回答 #9

> 赞同：17
> 
>             
> 
> 时间：2018-11-09T07:15:00.760

对于较新的浏览器将 Uint8Array 编码为字符串，并将字符串解码为 Uint8Array。

```
const base64 = {
    decode: s => Uint8Array.from(atob(s), c => c.charCodeAt(0)),
    encode: b => btoa(String.fromCharCode(...new Uint8Array(b)))
}; 
```

对于 Node.js，您可以使用以下代码将字符串、缓冲区或 Uint8Array 编码为字符串，并将字符串、缓冲区或 Uint8Array 解码为缓冲区。

```
const base64 = {
    decode: s => Buffer.from(s, 'base64'),
    encode: b => Buffer.from(b).toString('base64')
}; 
```

* * *

## 回答 #10

> 赞同：16
> 
>             
> 
> 时间：2012-08-20T16:07:31.417

基本上，我只是稍微清理了[原始代码，因此](https://stackoverflow.com/questions/246801/how-can-you-encode-a-string-to-base64-in-javascript/246813#246813)[JSLint](https://en.wikipedia.org/wiki/JSLint)不会抱怨太多，并且我将注释中标记为私有的方法设置为私有。我还在自己的项目中添加了两个我需要的方法，即`decodeToHex`和`encodeFromHex`.

编码：

```
var Base64 = (function() {
    "use strict";

    var _keyStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";

    var _utf8_encode = function (string) {

        var utftext = "", c, n;

        string = string.replace(/\r\n/g,"\n");

        for (n = 0; n < string.length; n++) {

            c = string.charCodeAt(n);

            if (c < 128) {

                utftext += String.fromCharCode(c);

            } else if((c > 127) && (c < 2048)) {

                utftext += String.fromCharCode((c >> 6) | 192);
                utftext += String.fromCharCode((c & 63) | 128);
            } else {

                utftext += String.fromCharCode((c >> 12) | 224);
                utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                utftext += String.fromCharCode((c & 63) | 128);
            }
        }
        return utftext;
    };

    var _utf8_decode = function (utftext) {
        var string = "", i = 0, c = 0, c1 = 0, c2 = 0;

        while ( i < utftext.length ) {

            c = utftext.charCodeAt(i);

            if (c < 128) {

                string += String.fromCharCode(c);
                i++;

            } else if((c > 191) && (c < 224)) {

                c1 = utftext.charCodeAt(i+1);
                string += String.fromCharCode(((c & 31) << 6) | (c1 & 63));
                i += 2;

            } else {

                c1 = utftext.charCodeAt(i+1);
                c2 = utftext.charCodeAt(i+2);
                string += String.fromCharCode(((c & 15) << 12) | ((c1 & 63) << 6) | (c2 & 63));
                i += 3;
            }
        }
        return string;
    };

    var _hexEncode = function(input) {
        var output = '', i;

        for(i = 0; i < input.length; i++) {
            output += input.charCodeAt(i).toString(16);
        }

        return output;
    };

    var _hexDecode = function(input) {
        var output = '', i;

        if(input.length % 2 > 0) {
            input = '0' + input;
        }

        for(i = 0; i < input.length; i = i + 2) {
            output += String.fromCharCode(parseInt(input.charAt(i) + input.charAt(i + 1), 16));
        }
        return output;
    };

    var encode = function (input) {
        var output = "", chr1, chr2, chr3, enc1, enc2, enc3, enc4, i = 0;

        input = _utf8_encode(input);

        while (i < input.length) {

            chr1 = input.charCodeAt(i++);
            chr2 = input.charCodeAt(i++);
            chr3 = input.charCodeAt(i++);

            enc1 = chr1 >> 2;
            enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
            enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
            enc4 = chr3 & 63;

            if (isNaN(chr2)) {
                enc3 = enc4 = 64;
            } else if (isNaN(chr3)) {
                enc4 = 64;
            }

            output += _keyStr.charAt(enc1);
            output += _keyStr.charAt(enc2);
            output += _keyStr.charAt(enc3);
            output += _keyStr.charAt(enc4);
        }
        return output;
    };

    var decode = function (input) {
        var output = "", chr1, chr2, chr3, enc1, enc2, enc3, enc4, i = 0;

        input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");

        while (i < input.length) {

            enc1 = _keyStr.indexOf(input.charAt(i++));
            enc2 = _keyStr.indexOf(input.charAt(i++));
            enc3 = _keyStr.indexOf(input.charAt(i++));
            enc4 = _keyStr.indexOf(input.charAt(i++));

            chr1 = (enc1 << 2) | (enc2 >> 4);
            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
            chr3 = ((enc3 & 3) << 6) | enc4;

            output += String.fromCharCode(chr1);

            if (enc3 !== 64) {
                output += String.fromCharCode(chr2);
            }
            if (enc4 !== 64) {
                output += String.fromCharCode(chr3);
            }

        }

        return _utf8_decode(output);
    };

    var decodeToHex = function(input) {
        return _hexEncode(decode(input));
    };

    var encodeFromHex = function(input) {
        return encode(_hexDecode(input));
    };

    return {
        'encode': encode,
        'decode': decode,
        'decodeToHex': decodeToHex,
        'encodeFromHex': encodeFromHex
    };
}()); 
```

* * *

## 回答 #11

> 赞同：16
> 
>             
> 
> 时间：2021-03-07T15:26:00.613

如果你使用 Node.js，你可以这样做：

```
let a = Buffer.from('JavaScript').toString('base64');
console.log(a);

let b = Buffer.from(a, 'base64').toString();
console.log(b); 
```

* * *

## 回答 #12

> 赞同：13
> 
>             
> 
> 时间：2013-02-04T12:39:58.957

请注意，这不适用于原始 Unicode 字符串！[请参阅此处](https://developer.mozilla.org/en-US/docs/DOM/window.btoa)的 Unicode 部分。

编码语法

`var encodedData = window.btoa(stringToEncode);`

解码语法

`var decodedData = window.atob(encodedData);`

* * *

## 回答 #13

> 赞同：12
> 
>             
> 
> 时间：2011-08-21T15:07:38.107

要使 Base64 编码的字符串 URL 友好，在 JavaScript 中您可以执行以下操作：

```
// if this is your Base64 encoded string
var str = 'VGhpcyBpcyBhbiBhd2Vzb21lIHNjcmlwdA=='; 

// make URL friendly:
str = str.replace(/\+/g, '-').replace(/\//g, '_').replace(/\=+$/, '');

// reverse to original encoding
str = (str + '===').slice(0, str.length + (str.length % 4));
str = str.replace(/-/g, '+').replace(/_/g, '/'); 
```

另见这个小提琴：http: [//jsfiddle.net/magikMaker/7bjaT/](http://jsfiddle.net/magikMaker/7bjaT/)

* * *

## 回答 #14

> 赞同：12
> 
>             
> 
> 时间：2013-03-19T00:56:06.827

我已经手动将这些编码和解码方法重写为一种模块化格式，以实现跨平台/浏览器兼容性以及真正的私有范围，`btoa`如果`atob`它们存在是由于速度而不是使用它自己的编码：

[https://gist.github.com/Nijikokun/5192472](https://gist.github.com/Nijikokun/5192472)

用法：

```
base64.encode(/* String */);
base64.decode(/* String */);

utf8.encode(/* String */);
utf8.decode(/* String */); 
```

* * *

## 回答 #15

> 赞同：10
> 
>             
> 
> 时间：2013-01-12T22:28:45.700

如果需要对 HTML 图像对象进行编码，可以编写一个简单的函数，例如：

```
function getBase64Image(img) {
  var canvas = document.createElement("canvas");
  canvas.width = img.width;
  canvas.height = img.height;
  var ctx = canvas.getContext("2d");
  ctx.drawImage(img, 0, 0);
  var dataURL = canvas.toDataURL("image/png");
  // escape data:image prefix
  return dataURL.replace(/^data:image\/(png|jpg);base64,/, "");
  // or just return dataURL
  // return dataURL
} 
```

通过 id 获取图像的 Base64 编码：

```
function getBase64ImageById(id){
  return getBase64Image(document.getElementById(id));
} 
```

更多在[这里](http://drcreazy.com/art/61/base64-javascript.aspx)。

* * *

## 回答 #16

> 赞同：9
> 
>             
> 
> 时间：2018-10-15T11:23:18.393

您可以使用`window.btoa`和`window.atob`...

```
const encoded = window.btoa('Alireza Dezfoolian'); // encode a string
const decoded = window.atob(encoded); // decode the string 
```

可能使用**MDN**的方式可以让你的工作做得最好......也接受 Unicode...... 使用这两个简单的功能：

```
// UCS-2 string to Base64 encoded ASCII
function utoa(str) {
    return window.btoa(unescape(encodeURIComponent(str)));
}
// Base64 encoded ASCII to UCS-2 string
function atou(str) {
    return decodeURIComponent(escape(window.atob(str)));
}
// Usage:
utoa('✓ à la mode'); // 4pyTIMOgIGxhIG1vZGU=
atou('4pyTIMOgIGxhIG1vZGU='); // "✓ à la mode"

utoa('I \u2661 Unicode!'); // SSDimaEgVW5pY29kZSE=
atou('SSDimaEgVW5pY29kZSE='); // "I ♡ Unicode!" 
```

* * *

## 回答 #17

> 赞同：8
> 
>             
> 
> 时间：2013-11-20T08:24:59.487

这是`window.atob`+的缩小 polyfill `window.btoa`：

```
(function(){function t(t){this.message=t}var e="undefined"!=typeof exports?exports:this,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.prototype=Error(),t.prototype.name="InvalidCharacterError",e.btoa||(e.btoa=function(e){for(var o,n,a=0,i=r,c="";e.charAt(0|a)||(i="=",a%1);c+=i.charAt(63&o>>8-8*(a%1))){if(n=e.charCodeAt(a+=.75),n>255)throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");o=o<<8|n}return c}),e.atob||(e.atob=function(e){if(e=e.replace(/=+$/,""),1==e.length%4)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,n,a=0,i=0,c="";n=e.charAt(i++);~n&&(o=a%4?64*o+n:n,a++%4)?c+=String.fromCharCode(255&o>>(6&-2*a)):0)n=r.indexOf(n);return c})})(); 
```

```
(function (root, factory) {
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define([], function() {factory(root);});
    } else factory(root);
// node.js has always supported base64 conversions, while browsers that support
// web workers support base64 too, but you may never know.
})(typeof exports !== "undefined" ? exports : this, function(root) {
    if (root.atob) {
        // Some browsers' implementation of atob doesn't support whitespaces
        // in the encoded string (notably, IE). This wraps the native atob
        // in a function that strips the whitespaces.
        // The original function can be retrieved in atob.original
        try {
            root.atob(" ");
        } catch(e) {
            root.atob = (function(atob) {
                var func = function(string) {
                    return atob(String(string).replace(/[\t\n\f\r ]+/g, ""));
                };
                func.original = atob;
                return func;
            })(root.atob);
        }
        return;
    }

        // base64 character set, plus padding character (=)
    var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
        // Regular expression to check formal correctness of base64 encoded strings
        b64re = /^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/;

    root.btoa = function(string) {
        string = String(string);
        var bitmap, a, b, c,
            result = "", i = 0,
            rest = string.length % 3; // To determine the final padding

        for (; i < string.length;) {
            if ((a = string.charCodeAt(i++)) > 255
                    || (b = string.charCodeAt(i++)) > 255
                    || (c = string.charCodeAt(i++)) > 255)
                throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");

            bitmap = (a << 16) | (b << 8) | c;
            result += b64.charAt(bitmap >> 18 & 63) + b64.charAt(bitmap >> 12 & 63)
                    + b64.charAt(bitmap >> 6 & 63) + b64.charAt(bitmap & 63);
        }

        // If there's need of padding, replace the last 'A's with equal signs
        return rest ? result.slice(0, rest - 3) + "===".substring(rest) : result;
    };

    root.atob = function(string) {
        // atob can work with strings with whitespaces, even inside the encoded part,
        // but only \t, \n, \f, \r and ' ', which can be stripped.
        string = String(string).replace(/[\t\n\f\r ]+/g, "");
        if (!b64re.test(string))
            throw new TypeError("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");

        // Adding the padding if missing, for semplicity
        string += "==".slice(2 - (string.length & 3));
        var bitmap, result = "", r1, r2, i = 0;
        for (; i < string.length;) {
            bitmap = b64.indexOf(string.charAt(i++)) << 18 | b64.indexOf(string.charAt(i++)) << 12
                    | (r1 = b64.indexOf(string.charAt(i++))) << 6 | (r2 = b64.indexOf(string.charAt(i++)));

            result += r1 === 64 ? String.fromCharCode(bitmap >> 16 & 255)
                    : r2 === 64 ? String.fromCharCode(bitmap >> 16 & 255, bitmap >> 8 & 255)
                    : String.fromCharCode(bitmap >> 16 & 255, bitmap >> 8 & 255, bitmap & 255);
        }
        return result;
    };
}); 
```

完整版来自[https://github.com/MaxArt2501/base64-js/blob/master/base64.js](https://github.com/MaxArt2501/base64-js/blob/master/base64.js)

* * *

## 回答 #18

> 赞同：8
> 
>             
> 
> 时间：2014-10-04T18:34:01.787

我的一个项目需要将 UTF-8 字符串编码为 Base64。在转换为 UTF-8 时，这里的大多数答案似乎都无法正确处理 UTF-16 代理对，因此，为了完整起见，我将发布我的解决方案：

```
function strToUTF8Base64(str) {

    function decodeSurrogatePair(hi, lo) {
        var resultChar = 0x010000;
        resultChar += lo - 0xDC00;
        resultChar += (hi - 0xD800) << 10;
        return resultChar;
    }

    var bytes = [0, 0, 0];
    var byteIndex = 0;
    var result = [];

    function output(s) {
        result.push(s);
    }

    function emitBase64() {

        var digits =
                'ABCDEFGHIJKLMNOPQRSTUVWXYZ' +
                'abcdefghijklmnopqrstuvwxyz' +
                '0123456789+/';

        function toDigit(value) {
            return digits[value];
        }

        // --Byte 0--    --Byte 1--    --Byte 2--
        // 1111  1122    2222  3333    3344  4444

        var d1 = toDigit(bytes[0] >> 2);
        var d2 = toDigit(
            ((bytes[0] & 0x03) << 4) |
            (bytes[1] >> 4));
        var d3 = toDigit(
            ((bytes[1] & 0x0F) << 2) |
            (bytes[2] >> 6));
        var d4 = toDigit(
            bytes[2] & 0x3F);

        if (byteIndex === 1) {
            output(d1 + d2 + '==');
        }
        else if (byteIndex === 2) {
            output(d1 + d2 + d3 + '=');
        }
        else {
            output(d1 + d2 + d3 + d4);
        }
    }

    function emit(chr) {
        bytes[byteIndex++] = chr;
        if (byteIndex == 3) {
            emitBase64();
            bytes[0] = 0;
            bytes[1] = 0;
            bytes[2] = 0;
            byteIndex = 0;
        }
    }

    function emitLast() {
        if (byteIndex > 0) {
            emitBase64();
        }
    }

    // Converts the string to UTF8:

    var i, chr;
    var hi, lo;
    for (i = 0; i < str.length; i++) {
        chr = str.charCodeAt(i);

        // Test and decode surrogate pairs in the string
        if (chr >= 0xD800 && chr <= 0xDBFF) {
            hi = chr;
            lo = str.charCodeAt(i + 1);
            if (lo >= 0xDC00 && lo <= 0xDFFF) {
                chr = decodeSurrogatePair(hi, lo);
                i++;
            }
        }

        // Encode the character as UTF-8.
        if (chr < 0x80) {
            emit(chr);
        }
        else if (chr < 0x0800) {
            emit((chr >> 6) | 0xC0);
            emit(((chr >> 0) & 0x3F) | 0x80);
        }
        else if (chr < 0x10000) {
            emit((chr >> 12) | 0xE0);
            emit(((chr >>  6) & 0x3F) | 0x80);
            emit(((chr >>  0) & 0x3F) | 0x80);
        }
        else if (chr < 0x110000) {
            emit((chr >> 18) | 0xF0);
            emit(((chr >> 12) & 0x3F) | 0x80);
            emit(((chr >>  6) & 0x3F) | 0x80);
            emit(((chr >>  0) & 0x3F) | 0x80);
        }
    }

    emitLast();

    return result.join('');
} 
```

请注意，代码未经过彻底测试。我测试了一些输入，包括`strToUTF8Base64('衠衢蠩蠨')`与在线编码工具 ( [https://www.base64encode.org/](https://www.base64encode.org/) ) 的输出进行比较的内容。

* * *

## 回答 #19

> 赞同：6
> 
>             
> 
> 时间：2013-11-17T07:05:24.533

我宁愿使用[CryptoJS](https://code.google.com/p/crypto-js/#Encoders)中的 Base64 编码/解码方法，这是最流行的库，用于使用最佳实践和模式在 JavaScript 中实现的标准和安全加密算法。

* * *

## 回答 #20

> 赞同：6
> 
>             
> 
> 时间：2014-05-25T04:27:29.120

这是@user850789 的AngularJS Factory 版本：

```
'use strict';

var ProjectNameBase64Factory = angular.module('project_name.factories.base64', []);

ProjectNameBase64Factory.factory('Base64', function () {
    var Base64 = {
        // private property
        _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",

        // public method for encoding
        encode: function (input) {
            var output = "";
            var chr1, chr2, chr3, enc1, enc2, enc3, enc4;
            var i = 0;

            input = Base64._utf8_encode(input);

            while (i < input.length) {

                chr1 = input.charCodeAt(i++);
                chr2 = input.charCodeAt(i++);
                chr3 = input.charCodeAt(i++);

                enc1 = chr1 >> 2;
                enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
                enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
                enc4 = chr3 & 63;

                if (isNaN(chr2)) {
                    enc3 = enc4 = 64;
                } else if (isNaN(chr3)) {
                    enc4 = 64;
                }

                output = output +
                         Base64._keyStr.charAt(enc1) + Base64._keyStr.charAt(enc2) +
                         Base64._keyStr.charAt(enc3) + Base64._keyStr.charAt(enc4);

            }

            return output;
        },

        // public method for decoding
        decode: function (input) {
            var output = "";
            var chr1, chr2, chr3;
            var enc1, enc2, enc3, enc4;
            var i = 0;

            input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");

            while (i < input.length) {

                enc1 = Base64._keyStr.indexOf(input.charAt(i++));
                enc2 = Base64._keyStr.indexOf(input.charAt(i++));
                enc3 = Base64._keyStr.indexOf(input.charAt(i++));
                enc4 = Base64._keyStr.indexOf(input.charAt(i++));

                chr1 = (enc1 << 2) | (enc2 >> 4);
                chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
                chr3 = ((enc3 & 3) << 6) | enc4;

                output = output + String.fromCharCode(chr1);

                if (enc3 != 64) {
                    output = output + String.fromCharCode(chr2);
                }
                if (enc4 != 64) {
                    output = output + String.fromCharCode(chr3);
                }

            }

            output = Base64._utf8_decode(output);

            return output;

        },

        // private method for UTF-8 encoding
        _utf8_encode: function (string) {
            string = string.replace(/\r\n/g, "\n");
            var utftext = "";

            for (var n = 0; n < string.length; n++) {

                var c = string.charCodeAt(n);

                if (c < 128) {
                    utftext += String.fromCharCode(c);
                }
                else if ((c > 127) && (c < 2048)) {
                    utftext += String.fromCharCode((c >> 6) | 192);
                    utftext += String.fromCharCode((c & 63) | 128);
                }
                else {
                    utftext += String.fromCharCode((c >> 12) | 224);
                    utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                    utftext += String.fromCharCode((c & 63) | 128);
                }

            }

            return utftext;
        },

        // private method for UTF-8 decoding
        _utf8_decode: function (utftext) {
            var string = "";
            var i = 0;
            var c = 0, c2 = 0, c3 = 0;

            while (i < utftext.length) {

                c = utftext.charCodeAt(i);

                if (c < 128) {
                    string += String.fromCharCode(c);
                    i++;
                }
                else if ((c > 191) && (c < 224)) {
                    c2 = utftext.charCodeAt(i + 1);
                    string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));
                    i += 2;
                }
                else {
                    c2 = utftext.charCodeAt(i + 1);
                    c3 = utftext.charCodeAt(i + 2);
                    string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));
                    i += 3;
                }

            }
            return string;
        }
    };
    return Base64;
}); 
```

* * *

## 回答 #21

> 赞同：6
> 
>             
> 
> 时间：2019-02-09T10:20:14.373

以下是JavaScript内置函数的[LIVE DEMO ：](https://codverter.com/src/webeditor?query=f1851dbe-a3fa-43ca-ae26-fab26ec50903)`atob()``btoa()`

```
<!DOCTYPE html>
<html>
  <head>
    <style>
      textarea{
        width:30%;
        height:100px;
      }
    </style>
    <script>
      // encode string to base64
      function encode()
      {
        var txt = document.getElementById("txt1").value;
        var result = btoa(txt);
        document.getElementById("txt2").value = result;
      }
      // decode base64 back to original string
      function decode()
      {
        var txt = document.getElementById("txt3").value;
        var result = atob(txt);
        document.getElementById("txt4").value = result;
      }
    </script>
  </head>
  <body>
    <div>
      <textarea id="txt1">Some text to decode
      </textarea>
    </div>
    <div>
      <input type="button" id="btnencode" value="Encode" onClick="encode()"/>
    </div>
    <div>
      <textarea id="txt2">
      </textarea>
    </div>
    <br/>
    <div>
      <textarea id="txt3">U29tZSB0ZXh0IHRvIGRlY29kZQ==
      </textarea>
    </div>
    <div>
      <input type="button" id="btndecode" value="Decode" onClick="decode()"/>
    </div>
    <div>
      <textarea id="txt4">
      </textarea>
    </div>
  </body>
</html> 
```

* * *

## 回答 #22

> 赞同：5
> 
>             
> 
> 时间：2013-07-24T06:52:31.813

对于我的项目，我仍然需要支持 IE7 并使用大量输入进行编码。

根据 Joe Dyndale 提出的代码和 Marius 在评论中的建议，可以通过使用数组而不是字符串构造结果来提高 IE7 的性能。

这是编码的示例：

```
var encode = function (input) {
    var output = [], chr1, chr2, chr3, enc1, enc2, enc3, enc4, i = 0;

    input = _utf8_encode(input);

    while (i < input.length) {

        chr1 = input.charCodeAt(i++);
        chr2 = input.charCodeAt(i++);
        chr3 = input.charCodeAt(i++);

        enc1 = chr1 >> 2;
        enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
        enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
        enc4 = chr3 & 63;

        if (isNaN(chr2)) {
            enc3 = enc4 = 64;
        } else if (isNaN(chr3)) {
            enc4 = 64;
        }

        output.push(_keyStr.charAt(enc1));
        output.push(_keyStr.charAt(enc2));
        output.push(_keyStr.charAt(enc3));
        output.push(_keyStr.charAt(enc4));

    }

    return output.join("");
}; 
```

* * *

## 回答 #23

> 赞同：5
> 
>             
> 
> 时间：2013-08-29T14:10:34.633

好吧，如果您使用的是 Dojo。它为我们提供了直接编码或解码为 Base64 的方法。

试试这个：

*使用dojox.encoding.base64*对字节数组进行编码：

```
var str = dojox.encoding.base64.encode(myByteArray); 
```

要解码 Base64 编码的字符串：

```
var bytes = dojox.encoding.base64.decode(str); 
```

* * *

## 回答 #24

> 赞同：5
> 
>             
> 
> 时间：2016-07-21T01:11:16.030

虽然需要做更多工作，但如果您想要一个高性能的原生解决方案，您可以使用一些 HTML5 函数。

如果您可以将数据放入 a[`Blob`](https://developer.mozilla.org/en-US/docs/Web/API/Blob)中，那么您可以使用[FileReader.readAsDataURL()](https://developer.mozilla.org/en-US/docs/Web/API/FileReader/readAsDataURL)函数来获取`data://`URL 并切掉它的前面以获取 Base64 数据。

但是，您可能需要进行进一步处理才能对数据进行 urldecode，因为我不确定 URL 是否对`+`字符进行了转义`data://`，但这应该很简单。

* * *

## 回答 #25

> 赞同：5
> 
>             
> 
> 时间：2021-05-06T09:47:44.567

当我使用

```
btoa("☸☹☺☻☼☾☿&quot;)) 
```

我得到：

> 错误 InvalidCharacterError：要编码的字符串包含**Latin1 范围之外的字符。**

我发现文档*[Unicode strings](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/btoa#unicode_strings)*提供了如下解决方案。

```
function toBinary(string) {
  const codeUnits = new Uint16Array(string.length);
  for (let i = 0; i < codeUnits.length; i++) {
    codeUnits[i] = string.charCodeAt(i);
  }
  return String.fromCharCode(...new Uint8Array(codeUnits.buffer));
}

function fromBinary(binary) {
  const bytes = new Uint8Array(binary.length);
  for (let i = 0; i < bytes.length; i++) {
    bytes[i] = binary.charCodeAt(i);
  }
  return String.fromCharCode(...new Uint16Array(bytes.buffer));
}

const myString = "☸☹☺☻☼☾☿"
// console.log(btoa(myString)) // Error InvalidCharacterError: The string to be encoded contains characters outside of the Latin1 range.
const converted = toBinary(myString)
const encoded = btoa(converted)
console.log(encoded)

const decoded = atob(encoded)
const original = fromBinary(decoded)
console.log(original);
```

* * *

## 回答 #26

> 赞同：4
> 
>             
> 
> 时间：2020-03-18T05:30:15.023

使用*js-base64*库作为

> btoa() 不适用于表情符号

```
var str = "I was funny ";
console.log("Original string:", str);

var encodedStr = Base64.encode(str)
console.log("Encoded string:", encodedStr);

var decodedStr = Base64.decode(encodedStr)
console.log("Decoded string:", decodedStr);
```

```
<script src="https://cdn.jsdelivr.net/npm/js-base64@2.5.2/base64.min.js"></script>
```

* * *

## 回答 #27

> 赞同：3
> 
>             
> 
> 时间：2020-07-27T11:43:48.790

#### 没有中间步骤的 JavaScript `btoa`（没有库）

在你写的关于字符串转换的问题标题中，但在你谈论二进制数据（图片）的问题中，这里有一个函数可以从 PNG 图片二进制数据开始进行适当的转换（详细信息和反转转换在[这里](https://stackoverflow.com/a/62362724/860099)）。

[![在此处输入图像描述](https://i.stack.imgur.com/g2aN7.png)](https://i.stack.imgur.com/g2aN7.png)

```
function bytesArrToBase64(arr) {
  const abc = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"; // base64 alphabet
  const bin = n => n.toString(2).padStart(8,0); // convert num to 8-bit binary string
  const l = arr.length
  let result = '';

  for(let i=0; i<=(l-1)/3; i++) {
    let c1 = i*3+1>=l; // case when "=" is on end
    let c2 = i*3+2>=l; // case when "=" is on end
    let chunk = bin(arr[3*i]) + bin(c1? 0:arr[3*i+1]) + bin(c2? 0:arr[3*i+2]);
    let r = chunk.match(/.{1,6}/g).map((x,j)=> j==3&&c2 ? '=' :(j==2&&c1 ? '=':abc[+('0b'+x)]));
    result += r.join('');
  }

  return result;
}

// TEST

const pic = [ // PNG binary data
    0x89, 0x50, 0x4e, 0x47, 0x0d, 0x0a, 0x1a, 0x0a, 0x00, 0x00, 0x00, 0x0d,
    0x49, 0x48, 0x44, 0x52, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x10,
    0x08, 0x06, 0x00, 0x00, 0x00, 0x1f, 0xf3, 0xff, 0x61, 0x00, 0x00, 0x00,
    0x01, 0x73, 0x52, 0x47, 0x42, 0x00, 0xae, 0xce, 0x1c, 0xe9, 0x00, 0x00,
    0x01, 0x59, 0x69, 0x54, 0x58, 0x74, 0x58, 0x4d, 0x4c, 0x3a, 0x63, 0x6f,
    0x6d, 0x2e, 0x61, 0x64, 0x6f, 0x62, 0x65, 0x2e, 0x78, 0x6d, 0x70, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x3c, 0x78, 0x3a, 0x78, 0x6d, 0x70, 0x6d, 0x65,
    0x74, 0x61, 0x20, 0x78, 0x6d, 0x6c, 0x6e, 0x73, 0x3a, 0x78, 0x3d, 0x22,
    0x61, 0x64, 0x6f, 0x62, 0x65, 0x3a, 0x6e, 0x73, 0x3a, 0x6d, 0x65, 0x74,
    0x61, 0x2f, 0x22, 0x20, 0x78, 0x3a, 0x78, 0x6d, 0x70, 0x74, 0x6b, 0x3d,
    0x22, 0x58, 0x4d, 0x50, 0x20, 0x43, 0x6f, 0x72, 0x65, 0x20, 0x35, 0x2e,
    0x34, 0x2e, 0x30, 0x22, 0x3e, 0x0a, 0x20, 0x20, 0x20, 0x3c, 0x72, 0x64,
    0x66, 0x3a, 0x52, 0x44, 0x46, 0x20, 0x78, 0x6d, 0x6c, 0x6e, 0x73, 0x3a,
    0x72, 0x64, 0x66, 0x3d, 0x22, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f,
    0x77, 0x77, 0x77, 0x2e, 0x77, 0x33, 0x2e, 0x6f, 0x72, 0x67, 0x2f, 0x31,
    0x39, 0x39, 0x39, 0x2f, 0x30, 0x32, 0x2f, 0x32, 0x32, 0x2d, 0x72, 0x64,
    0x66, 0x2d, 0x73, 0x79, 0x6e, 0x74, 0x61, 0x78, 0x2d, 0x6e, 0x73, 0x23,
    0x22, 0x3e, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3c, 0x72, 0x64,
    0x66, 0x3a, 0x44, 0x65, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x69, 0x6f,
    0x6e, 0x20, 0x72, 0x64, 0x66, 0x3a, 0x61, 0x62, 0x6f, 0x75, 0x74, 0x3d,
    0x22, 0x22, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x78, 0x6d, 0x6c, 0x6e, 0x73, 0x3a, 0x74, 0x69, 0x66,
    0x66, 0x3d, 0x22, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x6e, 0x73,
    0x2e, 0x61, 0x64, 0x6f, 0x62, 0x65, 0x2e, 0x63, 0x6f, 0x6d, 0x2f, 0x74,
    0x69, 0x66, 0x66, 0x2f, 0x31, 0x2e, 0x30, 0x2f, 0x22, 0x3e, 0x0a, 0x20,
    0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3c, 0x74, 0x69, 0x66,
    0x66, 0x3a, 0x4f, 0x72, 0x69, 0x65, 0x6e, 0x74, 0x61, 0x74, 0x69, 0x6f,
    0x6e, 0x3e, 0x31, 0x3c, 0x2f, 0x74, 0x69, 0x66, 0x66, 0x3a, 0x4f, 0x72,
    0x69, 0x65, 0x6e, 0x74, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x3e, 0x0a, 0x20,
    0x20, 0x20, 0x20, 0x20, 0x20, 0x3c, 0x2f, 0x72, 0x64, 0x66, 0x3a, 0x44,
    0x65, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x69, 0x6f, 0x6e, 0x3e, 0x0a,
    0x20, 0x20, 0x20, 0x3c, 0x2f, 0x72, 0x64, 0x66, 0x3a, 0x52, 0x44, 0x46,
    0x3e, 0x0a, 0x3c, 0x2f, 0x78, 0x3a, 0x78, 0x6d, 0x70, 0x6d, 0x65, 0x74,
    0x61, 0x3e, 0x0a, 0x4c, 0xc2, 0x27, 0x59, 0x00, 0x00, 0x00, 0xf9, 0x49,
    0x44, 0x41, 0x54, 0x38, 0x11, 0x95, 0x93, 0x3d, 0x0a, 0x02, 0x41, 0x0c,
    0x85, 0xb3, 0xb2, 0x85, 0xb7, 0x10, 0x6c, 0x04, 0x1b, 0x0b, 0x4b, 0x6f,
    0xe2, 0x76, 0x1e, 0xc1, 0xc2, 0x56, 0x6c, 0x2d, 0xbc, 0x85, 0xde, 0xc4,
    0xd2, 0x56, 0xb0, 0x11, 0xbc, 0x85, 0x85, 0xa0, 0xfb, 0x46, 0xbf, 0xd9,
    0x30, 0x33, 0x88, 0x06, 0x76, 0x93, 0x79, 0x93, 0xf7, 0x92, 0xf9, 0xab,
    0xcc, 0xec, 0xd9, 0x7e, 0x7f, 0xd9, 0x63, 0x33, 0x8e, 0xf9, 0x75, 0x8c,
    0x92, 0xe0, 0x34, 0xe8, 0x27, 0x88, 0xd9, 0xf4, 0x76, 0xcf, 0xb0, 0xaa,
    0x45, 0xb2, 0x0e, 0x4a, 0xe4, 0x94, 0x39, 0x59, 0x0c, 0x03, 0x54, 0x14,
    0x58, 0xce, 0xbb, 0xea, 0xdb, 0xd1, 0x3b, 0x71, 0x75, 0xb9, 0x9a, 0xe2,
    0x7a, 0x7d, 0x36, 0x3f, 0xdf, 0x4b, 0x95, 0x35, 0x09, 0x09, 0xef, 0x73,
    0xfc, 0xfa, 0x85, 0x67, 0x02, 0x3e, 0x59, 0x55, 0x31, 0x89, 0x31, 0x56,
    0x8c, 0x78, 0xb6, 0x04, 0xda, 0x23, 0x01, 0x01, 0xc8, 0x8c, 0xe5, 0x77,
    0x87, 0xbb, 0x65, 0x02, 0x24, 0xa4, 0xad, 0x82, 0xcb, 0x4b, 0x4c, 0x64,
    0x59, 0x14, 0xa0, 0x72, 0x40, 0x3f, 0xbf, 0xe6, 0x68, 0xb6, 0x9f, 0x75,
    0x08, 0x63, 0xc8, 0x9a, 0x09, 0x02, 0x25, 0x32, 0x34, 0x48, 0x7e, 0xcc,
    0x7d, 0x10, 0xaf, 0xa6, 0xd5, 0xd2, 0x1a, 0x3d, 0x89, 0x38, 0xf5, 0xf1,
    0x14, 0xb4, 0x69, 0x6a, 0x4d, 0x15, 0xf5, 0xc9, 0xf0, 0x5c, 0x1a, 0x61,
    0x8a, 0x75, 0xd1, 0xe8, 0x3a, 0x2c, 0x41, 0x5d, 0x70, 0x41, 0x20, 0x29,
    0xf9, 0x9b, 0xb1, 0x37, 0xc5, 0x4d, 0xfc, 0x45, 0x84, 0x7d, 0x08, 0x8f,
    0x89, 0x76, 0x54, 0xf1, 0x1b, 0x19, 0x92, 0xef, 0x2c, 0xbe, 0x46, 0x8e,
    0xa6, 0x49, 0x5e, 0x61, 0x89, 0xe4, 0x05, 0x5e, 0x4e, 0xa4, 0x5c, 0x10,
    0x6e, 0x9f, 0xfc, 0x5b, 0x00, 0x00, 0x00, 0x00, 0x49, 0x45, 0x4e, 0x44,
    0xae, 0x42, 0x60, 0x82
];

let b64pic = bytesArrToBase64(pic);
myPic.src = "data:image/png;base64,"+b64pic;
msg.innerHTML = "Base64 encoded pic data:<br>" + b64pic;
```

```
img { zoom: 10; image-rendering: pixelated; }
#msg { word-break: break-all; }
```

```
<img id="myPic">
<code id="msg"></code>
```

* * *

## 回答 #28

> 赞同：2
> 
>             
> 
> 时间：2022-02-08T10:53:38.293

## 2022 年弃用警告更新

我在我的 vscode 上看到了弃用警告

```
This function is only provided for compatibility with legacy web platform APIs and should never be used in new code, 
because they use strings to represent binary data and predate the introduction of typed arrays in JavaScript. 
For code running using Node.js APIs, 
converting between base64-encoded strings and binary data should be performed using Buffer.from(str, 'base64') andbuf.toString('base64'). 
```

在搜索了更多之后，我发现这个问题说它没有被弃用

[https://github.com/microsoft/TypeScript/issues/45566](https://github.com/microsoft/TypeScript/issues/45566)

所以web JS上弃用警告的解决方法，使用`window.btoa`
，警告就会消失。

* * *

## 回答 #29

> 赞同：1
> 
>             
> 
> 时间：2020-06-21T18:34:28.850

您可以在浏览器中使用 btoa()/atob()，但需要进行一些改进，如[https://base64tool.com/uncaught-domexception-btoa-on-window/](https://base64tool.com/uncaught-domexception-btoa-on-window/)和[https://developer.mozilla.org所述/en-US/docs/Web/API/WindowOrWorkerGlobalScope/btoa](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/btoa)支持 UTF 字符串！

* * *

## 回答 #30

> 赞同：0
> 
>             
> 
> 时间：2022-01-28T12:16:27.223

在某些情况下，这里的所有解决方案似乎都失败了，而且理解起来非常复杂。尤其是对于非拉丁语言，例如**ARABIC**

这是一个编码 UTF-16 的简短解决方案

```
//decodes utf-16 characters such as ARABIC, URDU,PASHTO text
function decodeBase64(s) {
    var percentEncodedStr = atob(s).split('').map(function (c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join('');
    return decodeURIComponent(percentEncodedStr);
} 
```

# javascript - 检测是否从浏览器安装了 Adob e Acrobat Reader 的最佳方法是什么？

> ID：246803
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T13:34:43.813
> 
>         
> 
> 标签：javascript, acrobat, browser

从 Web 浏览器检测是否安装了 Adob​​e Acrobat Reader 的最佳方法是什么？我假设它必须在客户端完成（我不认为 Adob​​e 添加任何用户代理字符串）。最好在 JavaScript 和 Internet Explorer 中，虽然如果它也可以在 FireFox、Safari 等中完成会很好......

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T22:47:42.030

另请注意，即使有人没有 Acrobat Reader 插件，他仍然可以阅读 PDF 文件（例如，通过告诉浏览器启动外部阅读器，例如 kpdf）。因此，即使找不到插件，也允许用户下载 PDF。更不用说禁用 Javascript 的人（或 NoScript 用户）。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:42:56.917

[Adobe 网站上的这篇文章](http://support.adobe.com/devsup/devsup.nsf/docs/52970.htm)应该可以满足您的需求。

**编辑**

在测试中它不是 100%，因为我有 acrobat，但它没有在 IE 6 中检测到它。

# c++ - 我想将 std::string 转换为 const wchar_t *

> ID：246806
> 
>         
> 
> 赞同：66
> 
>         
> 
> 时间：2008-10-29T13:35:37.790
> 
>         
> 
> 标签：c++, stl, wchar-t, stdstring

有什么方法吗？我的电脑是AMD64。

```
::std::string str;
BOOL loadU(const wchar_t* lpszPathName, int flag = 0); 
```

当我使用：

```
loadU(&str); 
```

VS2005 编译器说：

```
Error 7 error C2664:: cannot convert parameter 1 from 'std::string *__w64 ' to 'const wchar_t *' 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：104
> 
>             
> 
> 时间：2008-10-29T13:41:13.257

首先将其转换为 std::wstring：

```
std::wstring widestr = std::wstring(str.begin(), str.end()); 
```

然后获取 C 字符串：

```
const wchar_t* widecstr = widestr.c_str(); 
```

这仅适用于 ASCII 字符串，但如果底层字符串是 UTF-8 编码的，它将不起作用。使用 MultiByteToWideChar() 之类的转换例程可确保正确处理此场景。

* * *

## 回答 #2

> 赞同：47
> 
>             
> 
> 时间：2008-10-29T13:38:26.537

如果你有一个 std::wstring 对象，你可以调用`c_str()`它来获得一个`wchar_t*`：

```
std::wstring name( L"Steve Nash" );
const wchar_t* szName = name.c_str(); 
```

但是，由于您正在对窄字符串进行操作，因此您首先需要将其加宽。这里有多种选择；一种是使用 Windows 的内置[`MultiByteToWideChar`](http://msdn.microsoft.com/en-us/library/dd319072%28v=vs.85%29.aspx)例程。这会给你一个`LPWSTR`，相当于`wchar_t*`。

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2008-10-29T13:49:56.857

您可以使用 ATL 文本转换宏将窄 (char) 字符串转换为宽 (wchar_t) 字符串。例如，要转换 std::string：

```
#include <atlconv.h>
...
std::string str = "Hello, world!";
CA2W pszWide(str.c_str());
loadU(pszWide); 
```

您还可以指定代码页，因此如果您的 std::string 包含 UTF-8 字符，您可以使用：

```
CA2W pszWide(str.c_str(), CP_UTF8); 
```

非常有用，但仅限 Windows。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2010-01-14T13:54:25.343

如果您使用的是 Linux/Unix，请查看 GNU C（来自 ISO C 90）中定义的 mbstowcs() 和 wcstombs()。

*   mbs 代表“多字节字符串”，基本上是通常的以零结尾的 C 字符串。

*   wcs 代表宽字符字符串，是 wchar_t 的数组。

有关宽字符的更多背景信息，请查看[此处](http://www.delorie.com/gnu/docs/glibc/libc_86.html)的 glibc 文档。

# language-agnostic - 什么时候面向对象不是正确的解决方案？

> ID：246808
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-10-29T13:35:54.060
> 
>         
> 
> 标签：language-agnostic, oop, architecture

我最近遇到了一些意见，说不应该总是使用面向对象的设计/编程。

您是否知道一些不会受益于也不应该使用面向对象设计的用例？ 

例如：有一些问题（关注点）会从 AOP 中受益。

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2008-10-29T13:53:52.043

有些问题最好使用其他范式（例如函数式编程）来表达。此外，声明性范式允许对代码的正确性进行更健壮的形式推理。有关具有某些优势的语言的一个很好的示例，请参见[Erlang](http://www.erlang.org)，由于范式的基本性质，OO 语言无法真正与之匹敌。

其他语言范式更适合的问题域示例是[数据库查询 (SQL)](http://en.wikipedia.org/wiki/Sql)、[专家系统（Prolog、CLIPS 等）](http://en.wikipedia.org/wiki/Expert_system)或[统计计算 (R)](http://www.r-project.org)。

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2008-10-29T13:54:48.470

以我的经验，不能从 OO 设计中受益的地方之一是低端嵌入式系统。执行 OO 需要一定数量的开销，而且有时您无法承受这些开销。在标准 PC 中，开销非常小，甚至不值得考虑，但在低端嵌入式系统中，开销可能很大。    

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T13:41:49.010

横切关注点受益于面向方面的编程 (AOP)。通过横切，我的意思是可以使应用程序的各个部分受益并且实际上不属于特定对象的功能。日志记录通常作为示例给出。安全可能是另一个。例如，为什么 Person 对象应该知道有关日志记录的任何信息，或者应该允许谁访问它？

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T13:48:26.737

一个很容易想到的……数据库-y Web 应用程序。

在这种情况下，遵循一个公认的框架更有意义……而不是寻求一个好的 OOP 设计。例如，如果您必须使用 JOIN 和 ORDER BYs 进行某种复杂的查询.. SQL 将踢对象对接。

*根据问题选择解决方案......而不是锤击问题直到它适合解决方案。*

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2008-10-29T17:39:37.360

这里要理解的基本原则是，没有可以应用于所有问题领域的通用方法、范式或方法。这些通常是为解决一组特定的问题而设计的，可能不会针对其他领域进行优化。

它就像针对典型问题类型（例如排序）的算法。不可能有适用于所有可能场景或数据集的通用算法。

面向对象编程也是如此。我不会将它应用于本质上与 AI 相关的问题，并且可以使用声明式编程更好地解决。我当然不会将它用于开发需要最高性能和速度的设备驱动程序。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T13:47:46.673

OOP 和 AOP 不是相互排斥的，而是互补的。

至于OO，肯定有一些不太适用的情况。如果没有我们所拥有的只是 OO 语言。对于纯粹的数字运算任务，许多人仍然更喜欢 Fortran。当您处理并发性和并行性时，函数式语言很有用。

此外，当您的应用程序主要只是一个带有 GUI 的数据库（例如 CRM 应用程序）时，即使您可能使用 OO 语言来构建它，OO 也不是很有用。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T13:41:38.450

OO设计的优点是可扩展性和可维护性。因此，在不需要这些功能的情况下，它没有多大用处。这些将是非常小的应用程序，用于非常特定的短期需求。（您会考虑以批处理文件或脚本语言执行的操作）

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:00:42.297

如果您使用的编程语言不容易让您使用 OOP，我不会为 OOP 烦恼。我们在我的工作场所使用 BDL，它是程序化的。我曾经尝试做一些 OOP，嗯，那只是一个很大的 oops。不应该打扰。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:40:43.757

还不够好？我不知道我是否能举出一个例子，但我知道一些非常简单的应用程序在开始使用完全面向对象的设计模型时可能看不到任何“好处”。然而，如果它是真正程序化和琐碎的事情，最终可能需要重新审视。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:47:51.400

我建议你访问维基百科并阅读他们关于不同类型编程语言的文章。

说一种编程“不够好”没有任何意义。每种类型都有一个目的。你无法比较它们。他们不应该做同样的事情。

* * *

## 回答 #11

> 赞同：1
> 
>             
> 
> 时间：2008-10-30T19:04:04.663

任何时候你想不出 OO 的好理由都是避免它的好时机。（听起来很滑稽，但我是认真的。）

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:45:20.080

正如其他发帖者所说，如果您正在创建一个非常简单的应用程序或程序应用程序，那么 OOP 可能有点过分。另外，我认为 AOP 不一定需要取代 OOP，如果它有助于加强良好的 OOP 设计的话。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2008-10-30T20:34:55.603

与 Nigel 相呼应，SQL 似乎几乎隐含地与任何类型的抽象（包括子查询和函数）不兼容。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2008-10-30T20:41:42.720

好吧，OOP 与任何东西都不是特别正交（也许除了其他获得多态性的方法）所以......呃......无论如何。

* * *

## 回答 #15

> 赞同：-2
> 
>             
> 
> 时间：2008-10-30T19:09:47.740

如果您进行了良好的设计，那么面向对象的编程是一个很好的解决方案。

# function - 最佳实践：函数返回值还是 byref 输出参数？

> ID：246814
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-29T13:39:23.523
> 
>         
> 
> 标签：function, return-value, return

我有一个名为 FindSpecificRowValue 的函数，它接收一个数据表并返回包含特定值的行号。如果找不到该值，我想向调用函数表明这一点。

是最好的方法：

1.  编写一个函数，如果未找到则返回 false，如果找到则返回 true，并将找到的行号作为 byref/输出参数，或

2.  编写一个返回 int 的函数，如果未找到行值，则返回 -999，如果找到，则返回行号？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2008-10-29T13:55:15.520

就我个人而言，我不会使用该方法名称。

我会改用两种方法：

```
TryFindSpecificRow
FindSpecificRow 
```

这将遵循 Int32.Parse/TryParse 的模式，在 C# 中它们可能如下所示：

```
public static Boolean TryFindSpecificRow(DataTable table, out Int32 rowNumber)
{
    if (row-can-be-found)
    {
        rowNumber = index-of-row-that-was-found;
        return true;
    }
    else
    {
        rowNumber = 0; // this value will not be used anyway
        return false;
    }
}

public static Int32 FindSpecificRow(DataTable table)
{
    Int32 rowNumber;

    if (TryFindSpecificRow(table, out rowNumber))
        return rowNumber;
    else
        throw new RowNotFoundException(String.Format("Row {0} was not found", rowNumber));
} 
```

* * *

**编辑：**更改为更适合该问题。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T13:48:39.997

失败的函数应该抛出异常。

如果失败是预期流程的一部分，则返回带外值是可以的，除非您无法预先确定带外值是什么，在这种情况下您必须抛出异常。

如果我必须在您的选项之间进行选择，我会选择选项 2，但使用常量而不是 -999...

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T13:57:21.383

您还可以将返回值定义为[Nullable](http://msdn.microsoft.com/en-us/library/b3h38hb0.aspx)，如果没有找到，则返回 Nothing。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T13:45:26.210

我会选择选项 2。虽然我认为我只会使用 -1 而不是 -999。

理查德哈里森是对的，命名常量比裸 -1 或 -999 更好。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T14:26:13.493

我会选择 2，或者返回值指示是否找到该值的其他变体。

函数返回（或提供引用）的行的值似乎已经表明是否找到了该值。如果未找到值，则提供不包含该值的行号似乎没有意义，因此返回值应为 -1、Null 或任何其他适用于特定语言的值。否则，返回行号这一事实表明已找到该值。

因此，似乎不需要单独的返回值来指示是否找到了该值。但是，如果类型 1 适合特定语言的习语，以及在其中执行函数调用的方式，则类型 1 可能是合适的。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T14:36:05.920

使用 2) 但返回 -1 （如果返回对行的引用，则返回空引用），该习语被广泛使用（包括通过 .nets indexOf (item) 函数），这就是我可能会做的。

BTW -1 比 -999 更容易接受和广泛使用“幻数”，这就是它“正确”的唯一原因（此处使用引号是有原因的）。

然而，这在很大程度上与您的期望有关。项目是否应该一直在那里，但您只是不知道在哪里？在这种情况下，正常返回索引，如果不存在则抛出错误/异常。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T15:26:30.767

在这种情况下，该项目可能不存在，这是一个正常的条件。这是绑定到数据表的 GridView 中未选择值的错误陷阱。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2012-03-22T22:32:18.173

其他一些尚未提及的可能性：

```
// 方法一：支持协方差；失败时可以返回 default<T>。
T TryGetThing(ref bool 成功);

// 方法2：不支持协方差，但在某些情况下可能允许更简洁的代码
// 如果失败，调用代码将使用一些特定的值。
T TryGetThing(T DefaultValue);

// 方法3：不支持协方差，但在某些情况下可能允许更简洁的代码
// 如果失败，调用代码将使用一些特定的值，但应该
// 除非必要，否则不花时间计算该值。
T TryGetThing(Func<T> AlternateGetMethod);

// 方法四：是否支持协方差；如果这是应该的，ErrorMethod 可以抛出
// 发生，或者它可以设置一些其他方式对调用者可见的标志。
T TryGetThing（操作错误方法）；

```

第一种方法与 Microsoft 在支持协变接口之前开发的方法相反。最后一个在某些方面是最通用的，但可能需要在每次使用时创建几个新的 GC 对象实例（例如闭包和委托）。

# svn - 使用 NAnt 自动添加 SVN

> ID：246817
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-29T13:40:56.703
> 
>         
> 
> 标签：svn, build-automation, nant

我想使用 NAnt 自动化 SVN 添加。我想将给定目录中的所有新文件添加到 SVN。NAnt 脚本将成功执行添加命令，但是它会显示 Tortoise SVN 添加对话框，这是不可接受的，因为它将在运行 CruiseControl 的构建服务器上执行。构建服务器正在运行 Windows Server 2003。

有任何想法吗？

```
<target name="addtest">
    <exec program="c:\program files\tortoisesvn\bin\tortoiseproc.exe" 
        commandline="/command:add * --force /path:C:\svn\test /notempfile /closeonend:1"
        basedir="C:\svn\test"
        failonerror="false"/>
</target> 
```

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-10-29T17:29:39.597

不使用 exec 任务，有一个由[NAntContrib](http://nantcontrib.sourceforge.net/)任务/工具集提供的[svn 任务。](http://nantcontrib.sourceforge.net/release/0.85/help/tasks/svn.html)

```
<svn command="add" ... /> 
```

当然，这样做可能需要命令行版本的 subversion，所以在 svn.exe 上执行 exec 可能同样好。

```
<exec program="svn.exe" commandline="add..." /> 
```

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T13:48:48.247

不要使用 tortoisesvn。获取[命令行 svn 客户端](http://www.collab.net/downloads/subversion/)。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:44:41.250

不要用乌龟！

只需拖放到命令行 svn。

```
c:\>svn add ... 
```

# php - PHP5中不同的XML解析库有什么区别？

> ID：246819
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2008-10-29T13:41:23.113
> 
>         
> 
> 标签：php, xml, parsing, xhtml

**原来的问题在下面，但我改变了标题，因为我认为找到有同样疑问的其他人会更容易。归根结底，XHTML 文档就是 XML 文档。**

这是一个初学者的问题，但我想知道您认为哪个是在 PHP5 中解析 XHTML 文档的最佳库？

我已经使用 Tidy 从 HTML 文件（使用 Word :S 创建的）生成了 XHTML，并且知道我需要从中替换一些元素（比如 and 元素，替换其中的一些属性）

标签）。

我用的XML不多，PHP中解析的选项似乎很多（Simple XML、DOM等），不知道是否都可以做我需要的，这是最简单的一个使用。

对不起我的英语，我来自阿根廷。谢谢！

**我提供了更多信息：**我有很多 HTML 页面，都是在 Word 97 中完成的。我使用 Tidy 来清理并在 XHTML Strict 中转换它们，所以现在它们都与 XML 兼容。我想使用 XML 解析器来查找一些元素并替换它们（我这样做的逻辑并不重要）。例如，我希望所有页面都使用相同的 CSS 样式表和类属性，以实现统一的外观。它们都是包含法律文件的静态页面，没有什么奇怪的。我应该使用哪个扩展？SimpleXML 足够了吗？尽管更难，我应该学习 DOM 吗？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-10-29T13:53:47.223

您可以使用[SimpleXML](http://nl3.php.net/simplexml)，它包含在默认的 PHP 安装中。这个扩展提供了对 XML 结构的简单的面向对象的访问。

还有[DOM XML](http://nl2.php.net/domxml)。此扩展的“缺点”是使用起来有点困难，并且默认情况下不包含它。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2008-10-29T16:14:28.280

只是为了消除这里的混乱。PHP 有许多 XML 库，因为 php4 在这方面没有很好的选择。从 PHP5 开始，您可以在[SimpleXml](http://docs.php.net/manual/en/book.simplexml.php)、[DOM](http://docs.php.net/manual/en/book.dom.php)和[基于 sax 的 expat parser](http://docs.php.net/manual/en/book.xml.php)之间进行选择。后者也存在于php4中。php4 也有一个 DOM 扩展，这与 php5 的**不**一样。

DOM 和 SimpleXml 是同一问题域的替代方案；他们将文档加载到内存中，并让您以树结构的形式访问它。DOM 是一个相当庞大的 api，但它也非常一致，并且以多种语言实现，这意味着您可以跨语言重用您的知识（例如在 Javascript 中）。SimpleXml 最初可能更容易。

SAX 解析器是另一种野兽。它将 xml 文档视为标签流。如果您正在处理非常大的文档，这很有用，因为您不需要将它们全部保存在内存中。

对于您的使用，我可能会使用 DOM api。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-04-09T03:56:36.697

*   **DOM**是一种标准的、独立于语言的 API，用于分层数据，例如由 W3C 标准化的 XML。它是一个功能丰富的 API。它是基于对象的，因为每个节点都是一个对象。

    当您不仅想要读取或写入，而且想要对现有文档的节点进行大量操作（例如在其他节点之间插入节点、更改结构等）时，DOM 是很好的选择。

*   **SimpleXML**是一个特定于 PHP 的 API，它也是基于对象的，但旨在比 DOM 更简洁：查找节点的值或查找其子元素等简单任务需要的代码要少得多。它的 API 没有 DOM 丰富，但它仍然包含 XPath 查找等功能，以及处理多命名空间文档的基本能力。而且，重要的是，它仍然保留了文档的所有特性，例如 XML CDATA 部分和注释，即使它不包含操作它们的函数。

    SimpleXML 非常适合只读：如果您只想读取 XML 文档并将其转换为另一种形式，那么它将为您节省大量代码。当您想要生成文档或进行基本操作（例如添加或更改子元素或属性）时，它也相当不错，但是对现有文档进行大量操作可能会变得复杂（但并非不可能）。例如，在其他两个元素之间添加一个子元素并不容易；addChild 仅在其他元素之后插入。SimpleXML 也不能进行 XSLT 转换。它没有'getElementsByTagName' 或getElementById' 之类的东西，但如果你知道XPath，你仍然可以用SimpleXML 做那种事情。

    SimpleXMLElement 对象有点“神奇”。如果您 var_dump/printr/var_export 与其完整的内部表示不对应，则它公开的属性。它公开了它的一些子元素，就好像它们是可以使用 -> 运算符访问的属性一样，但仍然在内部保留完整的文档，并且您可以执行诸如访问名称是带有 [] 保留字的子元素之类的事情运算符，就好像它是一个关联数组一样。

您不必完全致力于其中之一，因为 PHP 实现了以下功能：

*   simplexml_import_dom(DOMNode)

*   dom_import_simplexml（SimpleXMLElement）

如果您使用 SimpleXML 并且需要使用需要 DOM 节点的代码，这将很有帮助，反之亦然。

PHP 还提供了第三个 XML 库：

*   **XML Parser**（*SAX*的一种实现，一种与语言无关的接口，但在手册中没有使用该名称）是一个低级得多的库，其用途完全不同。它不会为您构建对象。它基本上只是让您更容易编写自己的 XML 解析器，因为它为您完成了前进到下一个标记的工作，并找出标记的类型，例如标记名称是什么以及它是开始标记还是结束标记. 然后，您必须编写每次遇到令牌时都应运行的回调。所有任务，例如将文档表示为树中的对象/数组、操作文档等，都需要单独实现，因为使用 XML 解析器所能做的就是编写一个低级解析器。

    如果您有特定的内存或速度要求，XML Parser 函数仍然非常有用。有了它，就可以编写一个解析器来解析一个很长的 XML 文档，而无需一次将其所有内容保存在内存中。此外，如果您对所有数据不感兴趣，并且不需要或不希望将其放入树或 PHP 对象集，那么它可以更快。例如，如果您想扫描一个 XHTML 文档并找到所有链接，而您并不关心结构。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:55:17.767

我更喜欢[SimpleXMLElement](http://docs.php.net/manual/en/simplexml.examples.php)，因为它很容易用于遍历元素。

**编辑：**它说没有可用的版本信息，但它在 PHP5 中可用，至少 5.2.5 但可能更早。

不过，这确实是个人选择，有很多[XML 扩展](http://docs.php.net/manual/en/refs.xml.php)。

请记住，如果您有无效标记，许多 XML 解析器会犹豫 - XHTML 应该是 XML，但并非总是如此！

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:56:49.917

自从我在 PHP 中使用 XML 解析以来已经有很长一段时间（2 年或更长时间），但我总是从[XML_Parser Pear 包](http://pear.php.net/package/XML_Parser)中获得良好、可用的结果。话虽如此，我对 PHP5 的接触很少，所以我真的不知道这些天是否有更好的内置替代方案。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:07:58.553

去年我在 PHP5 中做了一点 XML 解析，并决定使用 SimpleXML 的组合。

如果您想创建一个新的 XML 树或添加到现有的 XML 树，DOM 会更有用一点，它稍微灵活一些。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:17:28.673

这实际上取决于您要完成的工作。为了提取相当大量的数据，例如，从商店网站获取产品信息的许多记录，我可能会使用 Expat，因为它应该更快一些......就个人而言，我有足够大的 XML 来创建一个引人注目的性能提升。在这些数量上，您还不如使用 SQL。

我推荐使用 SimpleXML。它非常直观，易于使用/编写。此外，与 XPath 配合得很好。

从来没有真正使用过 DOM，但是如果您将 XML Parser 用于您所描述的那样大的东西，您可能想要使用它，因为它比 SimpleXML 更实用。

您可以在 W3C 学校阅读所有这三个方面的信息：

[http://www.w3schools.com/php/php_xml_parser_expat.asp](http://www.w3schools.com/php/php_xml_parser_expat.asp)

[http://www.w3schools.com/php/php_xml_simplexml.asp](http://www.w3schools.com/php/php_xml_simplexml.asp)

[http://www.w3schools.com/php/php_xml_dom.asp](http://www.w3schools.com/php/php_xml_dom.asp)

# c# - ProtectedData.Protect 间歇性故障

> ID：246822
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-10-29T13:41:38.653
> 
>         
> 
> 标签：c#, .net, security, encoding, cryptography

我正在编写密码加密例程。我写了下面的应用程序来说明我的问题。大约 20% 的时间，此代码按预期工作。其余时间，解密会引发加密异常——“数据无效”。

我相信问题出在加密部分，因为解密部分每次都一样。也就是说，如果加密例程产生一个解密例程可以解密的值，它总是可以解密它。但是，如果加密例程产生一个阻塞解密例程的值，它总是阻塞。所以解密程序是一致的；加密例程不是。

我怀疑我对 Unicode 编码的使用不正确，但我尝试过其他人的结果相同。

我究竟做错了什么？

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
using System.Security.Cryptography;

namespace DataProtectionTest
{
    public partial class Form1 : Form
    {
        private static readonly byte[] entropy = { 1, 2, 3, 4, 1, 2, 3, 4 };
        private string password;
        public Form1()
        {
            InitializeComponent();
        }

        private void btnEncryptIt_Click(object sender, EventArgs e)
        {
            Byte[] pw = Encoding.Unicode.GetBytes(textBox1.Text);
            Byte[] encryptedPw = ProtectedData.Protect(pw, entropy, DataProtectionScope.LocalMachine);
            password = Encoding.Unicode.GetString(encryptedPw);     
        }

        private void btnDecryptIt_Click(object sender, EventArgs e)
        {
            Byte[] pwBytes = Encoding.Unicode.GetBytes(password);
            try
            {
                Byte[] decryptedPw = ProtectedData.Unprotect(pwBytes, entropy, DataProtectionScope.LocalMachine);
                string pw = Encoding.Unicode.GetString(decryptedPw);
                textBox2.Text = pw;
            }
            catch (CryptographicException ce)
            {
                textBox2.Text = ce.Message;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2008-10-29T14:45:38.570

在一位同事的建议下，我选择了 Convert.ToBase64String。效果很好。更正程序如下。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
using System.Security.Cryptography;

namespace DataProtectionTest
{
    public partial class Form1 : Form
    {
        private static readonly byte[] entropy = { 1, 2, 3, 4, 1, 2, 3, 4 };
        private string password;
        public Form1()
        {
            InitializeComponent();
        }

        private void btnEncryptIt_Click(object sender, EventArgs e)
        {
            Byte[] pw = Encoding.Unicode.GetBytes(textBox1.Text);
            Byte[] encryptedPw = ProtectedData.Protect(pw, entropy, DataProtectionScope.LocalMachine);
            //password = Encoding.Unicode.GetString(encryptedPw);       
            password = Convert.ToBase64String(encryptedPw);
        }

        private void btnDecryptIt_Click(object sender, EventArgs e)
        {
            //Byte[] pwBytes = Encoding.Unicode.GetBytes(password);
            Byte[] pwBytes = Convert.FromBase64String(password);
            try
            {
                Byte[] decryptedPw = ProtectedData.Unprotect(pwBytes, entropy, DataProtectionScope.LocalMachine);
                string pw = Encoding.Unicode.GetString(decryptedPw);
                textBox2.Text = pw;
            }
            catch (CryptographicException ce)
            {
                textBox2.Text = ce.Message;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2011-12-30T18:29:53.850

您永远不应该将任何`System.Text.Encoding`类用于密文。您*将*遇到间歇性错误。您应该使用 Base64 编码和`System.Convert`类方法。

1.  要从 encrypted 中获取`string`encrypted `byte[]`，您应该使用：

    ```
    Convert.ToBase64String(byte[] bytes) 
    ```

2.  `byte[]`要从要加密的 a中获取 aa raw `string`，您应该使用：

    ```
    Convert.FromBase64String(string data) 
    ```

有关更多信息，请参阅[MS 安全大师 Shawn Fanning 的帖子。](http://blogs.msdn.com/b/shawnfa/archive/2005/11/10/491431.aspx) 

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T14:31:30.143

最好的解决方案是[将字节数组转换为 base 64 字符串](https://stackoverflow.com/questions/246822/protecteddataprotect-intermittent-failure#247195)。

对于这种情况，您还可以使用 Latin-1 aka ISO-8859-1 aka codepage 28591，因为它映射 0-255 范围内的值不变。以下是可以互换的：

```
Encoding.GetEncoding(28591)
Encoding.GetEncoding("Latin1")
Encoding.GetEncoding("iso-8859-1") 
```

使用这种编码，您将始终能够转换 byte[] -> string -> byte[] 而不会丢失。

有关说明此编码使用的示例，请参阅[此帖子。](https://stackoverflow.com/questions/111460/net-8-bit-encoding#111549)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T15:13:36.097

问题是转换为 unicode 和加密方法的结束，Encoding.Unicode.GetString 仅在您给它的字节形成有效的 UTF-16 字符串时才有效。

我怀疑有时 ProtectedData.Protect 的结果不是有效的 UTF-16 字符串 - 因此 Encoding.Unicode.GetString 会从返回的字符串中删除没有意义的字节，从而导致无法转换回加密的字符串数据。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2017-03-03T13:54:30.697

这个类应该有助于：

```
public static class StringEncryptor
{
    private static readonly byte[] key = { 0x45, 0x4E, 0x3A, 0x8C, 0x89, 0x70, 0x37, 0x99, 0x58, 0x31, 0x24, 0x98, 0x3A, 0x87, 0x9B, 0x34 };

    public static string EncryptString(this string sourceString)
    {
        if (string.IsNullOrEmpty(sourceString))
        {
            return string.Empty;
        }

        var base64String = Base64Encode(sourceString);
        var protectedBytes = ProtectedData.Protect(Convert.FromBase64String(base64String), key, DataProtectionScope.CurrentUser);
        return Convert.ToBase64String(protectedBytes);
    }

    public static string DecryptString(this string sourceString)
    {
        if (string.IsNullOrEmpty(sourceString))
        {
            return string.Empty;
        }

        var unprotectedBytes = ProtectedData.Unprotect(Convert.FromBase64String(sourceString), key, DataProtectionScope.CurrentUser);
        var base64String = Convert.ToBase64String(unprotectedBytes);
        return Base64Decode(base64String);
    }

    private static string Base64Encode(string plainText)
    {
        var plainTextBytes = Encoding.UTF8.GetBytes(plainText);
        return Convert.ToBase64String(plainTextBytes);
    }

    private static string Base64Decode(string base64EncodedData)
    {
        var base64EncodedBytes = Convert.FromBase64String(base64EncodedData);
        return Encoding.UTF8.GetString(base64EncodedBytes);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:56:09.747

我强烈怀疑是对 Encoding.Unicode.GetString 的调用导致了问题。您需要确保传递给 Unprotect 调用的数据与 Protect 调用返回的数据**完全相同。**如果您将二进制数据编码为 Unicode 文本作为临时步骤，那么您无法保证这一点。为什么你仍然需要这一步——为什么不只存储字节[]？

# visual-studio-2008 - VS2008 Express：如何将所有文件默认保存为UTF-8？

> ID：246830
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T13:43:44.060
> 
>         
> 
> 标签：visual-studio-2008, utf-8, visual-studio-express

有没有办法让 Visual Studio 2008 Express 默认将所有文件存储为 UTF-8？

谢谢你的时间。最好的祝福。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T13:55:37.500

如果您在 VS 中创建一个新文件，默认情况下它将是 UTF8，但如果该文件已由其他编码创建，则必须“另存为”，然后通过按“保存”按钮中的向下箭头更改编码，然后选择“Save with enconding...”

# iphone - 如何调整图像大小？

> ID：246831
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-29T13:44:21.797
> 
>         
> 
> 标签：iphone, image-resizing

我从 中拍摄了一张图像`UIImagePickerController`，但文件看起来太大而无法通过互联网传输，我想调整图像大小。我找不到与图像处理相关的任何方法。

有什么推荐吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T14:02:31.760

您可以使用创建所需大小的上下文`UIGraphicsBeginImageContext()`，然后使用 UIImage 的方法将图像绘制到上下文`-drawInRect:`，最后使用`UIGraphicsGetImageFromCurrentImageContext()`拉出新的 UIImage。

# sql - 如何查找具有最常见标签的记录，例如 StackOverflow 中的相关问题

> ID：246841
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2008-10-29T13:47:52.493
> 
>         
> 
> 标签：sql, database, algorithm, tags

我们可能会在 StackOverflow 网站上用多个标签标记一个问题，我想知道如何用常见标签找出最相关的问题。

假设我们在一个数据库中有 100 个问题，每个问题都有几个标签。假设用户正在浏览一个特定的问题，我们想让系统在页面上显示相关的问题。相关问题的标准是它们具有最常见的标签。

例如：问题 1 标记为 AAA、BBB、CCC、DDD、EEE。

问题 2 与前 1 个相关，因为它也具有所有这 5 个标签。问题 3 与前 2 个相关，因为它只有 Questio1 具有的 4 或 3 个标签。……

所以我的问题是如何设计数据库并快速找出与问题1相关的问题。非常感谢。

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2008-10-29T14:36:32.147

也许是这样的：

```
select qt.question_id, count(*)
from   question_tags qt
where  qt.tag in
( select qt2.tag
  from   question_tags qt2
  where  qt2.question_id = 123
)
group by qt.question_id
order by 2 desc 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T15:26:28.130

如果您可以保证一个问题没有重复的标签，那么您可以执行以下操作：

```
SELECT
     QT2.question_id,
     COUNT(*) AS cnt
FROM
     Question_Tags QT1
INNER JOIN Question_Tags QT2 ON QT2.tag = QT1.tag AND QT2.question_id <> QT1.question_id
WHERE
     QT1.question_id = @question_id
GROUP BY
     QT2.question_id
ORDER BY
     cnt DESC 
```

如果您不能保证问题中标签的唯一性，那么 Tony Andrews 的解决方案将起作用。他在任何情况下都会起作用，但是如果您可以通过约束保证唯一性，您应该将您的系统上的性能与此方法进行比较。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T13:49:18.450

不完全确定您的意思，但[标签页面](https://stackoverflow.com/tags)按受欢迎程度（如标记数量）列出了标签。

**编辑：**这是关于 SO 还是关于您自己的应用程序？如果是关于您自己的应用程序，请删除 SO 标签，因为它有点误导。

**Edit2：**我会说：

```
SELECT * FROM `questions` WHERE `tag` LIKE '%tagname%' OR (looped for each tag) LIMIT 5,0 
```

其中 5 是您想要返回的最大结果（至少进行一些优化）。可能不是最好的解决方案，但我可以看到它有效。

您可能还想尝试`LIKE`使用标题进行匹配。

# c# - 存储 UI 设置的最佳实践？

> ID：246849
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2008-10-29T13:49:27.327
> 
>         
> 
> 标签：c#, wpf, settings, appsettings

我们目前正在计划一个更大的 WPF LoB 应用程序，我想知道其他人认为存储大量 UI 设置的最佳做法是什么，例如

*   扩展器状态

*   菜单订单

*   调整属性

*   ETC...

我不喜欢使用提供的 SettingsProvider（即 App.config 文件）存储数十个值的想法，尽管它可以用于使用自定义 SettingsProvider 将其存储在嵌入式数据库中。能够使用某种数据绑定也是一个问题。有没有人有同样的问题？

你做了什么来存储大量的 ui 用户设置？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2008-10-29T13:56:31.930

我们将首选项文件存储在这里：

```
Environment.SpecialFolder.ApplicationData 
```

将其存储为 xml“首选项”文件，这样如果它被损坏，就不会那么难以访问和更改。

到目前为止，这对我们来说比注册表效果要好得多，如果有任何东西损坏或需要重置，它会更干净、更容易清除。

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2008-10-29T18:19:12.133

存储 UI 设置的更快方法是使用 Properties.Settings.Default 系统。它的好处是使用 WPF 绑定到值。  [这里的例子](http://blogs.microsoft.co.il/blogs/tamir/archive/2008/04/22/quick-wpf-tip-how-to-bind-to-wpf-application-resources-and-settings.aspx)。设置会自动更新和加载。

```
<Window ...
    xmlns:p="clr-namespace:UserSettings.Properties"
    Height="{Binding Source={x:Static p:Settings.Default}, Path=Height, Mode=TwoWay}" 
    Width="{Binding Source={x:Static p:Settings.Default}, Path=Width, Mode=TwoWay}" 
    Left="{Binding Source={x:Static p:Settings.Default}, Path=Left, Mode=TwoWay}" 
    Top="{Binding Source={x:Static p:Settings.Default}, Path=Top, Mode=TwoWay}">

...
protected override void OnClosing(System.ComponentModel.CancelEventArgs e) 
{ 
    Settings.Default.Save(); 
    base.OnClosing(e); 
} 
```

问题在于，如果您的应用程序很大，它很快就会变得一团糟。

另一种解决方案（此处有人提出）是使用 ApplicationData 路径将您自己的首选项存储到 XML 中。在那里，您可以构建自己的设置类并使用 XML 序列化程序来持久化它。这种方法使您能够从版本迁移到版本。虽然功能更强大，但此方法需要更多代码。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2010-02-09T06:41:53.317

深入研究 aogan 的答案并将其与 decasteljau 的答案和他引用的博客文章相结合，这是一个示例，它填补了我不清楚的一些空白。

xml文件：

```
<Window ...
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:p="clr-namespace:MyApp"
    Height="{Binding Source={x:Static p:MyAppSettings.Default}, Path=MainWndHeight, Mode=TwoWay}"
    Width="{Binding Source={x:Static p:MyAppSettings.Default}, Path=MainWndWidth, Mode=TwoWay}"
    Left="{Binding Source={x:Static p:MyAppSettings.Default}, Path=MainWndLeft, Mode=TwoWay}"
    Top="{Binding Source={x:Static p:MyAppSettings.Default}, Path=MainWndTop, Mode=TwoWay}"
    ... 
```

和源文件：

```
namespace MyApp
{
    class MainWindow ....
    {
        ...

        protected override void OnClosing(System.ComponentModel.CancelEventArgs e)
        {
            MyAppSettings.Default.Save();
            base.OnClosing(e);
        }
    }

    public sealed class MyAppSettings : System.Configuration.ApplicationSettingsBase
    {
        private static MyAppSettings defaultInstance = ((MyAppSettings)(global::System.Configuration.ApplicationSettingsBase.Synchronized(new MyAppSettings())));
        public static MyAppSettings Default
        {
            get { return defaultInstance; }
        }

        [System.Configuration.UserScopedSettingAttribute()]
        [System.Configuration.DefaultSettingValueAttribute("540")]
        public int MainWndHeight
        {
            get { return (int)this["MainWndHeight"]; }
            set { this["MainWndHeight"] = value; }
        }

        [System.Configuration.UserScopedSettingAttribute()]
        [System.Configuration.DefaultSettingValueAttribute("790")]
        public int MainWndWidth
        {
            get { return (int)this["MainWndWidth"]; }
            set { this["MainWndWidth"] = value; }
        }

        [System.Configuration.UserScopedSettingAttribute()]
        [System.Configuration.DefaultSettingValueAttribute("300")]
        public int MainWndTop
        {
            get { return (int)this["MainWndTop"]; }
            set { this["MainWndTop"] = value; }
        }

        [System.Configuration.UserScopedSettingAttribute()]
        [System.Configuration.DefaultSettingValueAttribute("300")]
        public int MainWndLeft
        {
            get { return (int)this["MainWndLeft"]; }
            set { this["MainWndLeft"] = value; }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T13:57:40.460

我们将所有内容存储在`Isolation Storage`（我们使用 ClickOnce 运行）。我们有一些要序列化的对象（XmlSerializer）。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T17:26:07.123

在 Chris Sells 和 Ian Griffiths 编写的 Programming WPF 中，它说

*WPF 应用程序的首选设置机制是 .NET 和 VS 提供的机制：System.Configuration 命名空间中的 ApplicationSettingBase 类，带有内置设计器。*

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:52:08.910

似乎由于某种原因正在失去人气；但注册表一直是此类设置的合适位置。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T13:58:49.523

我们使用自定义的 SettingsProvider 将配置信息存储在应用程序数据库的表中。如果您已经在使用数据库，这是一个很好的解决方案。

# http - HTTP 1.0 与 1.1

> ID：246859
> 
>         
> 
> 赞同：281
> 
>         
> 
> 时间：2008-10-29T13:52:08.490
> 
>         
> 
> 标签：http, http-1.1, http-1.0

有人可以简要介绍一下 HTTP 1.0 和 HTTP 1.1 之间的区别吗？我在这两个 RFC 上都花了一些时间，但无法找出它们之间的很多区别。维基百科是这样说的：

> **HTTP/1.1 (1997-1999)**
> 
> 当前版本; 默认情况下启用持久连接，并且可以很好地与代理配合使用。还支持请求管道，允许同时发送多个请求，允许服务器为工作负载做好准备，并可能更快地将请求的资源传输到客户端。

但这对我来说意义不大。我意识到这是一个有点复杂的主题，所以我不期待一个完整的答案，但是有人可以给我简要概述一下较低级别的差异吗？

我的意思是我正在寻找实现 HTTP 服务器或应用程序所需的信息。我主要是在寻找正确的方向，以便我可以自己解决。

* * *

## 回答 #1

> 赞同：392
> 
>             
> 
> 时间：2008-10-29T14:33:30.000

**代理支持和主机字段：**

根据规范，HTTP 1.1 有一个必需的 Host 标头。

HTTP 1.0 没有正式要求 Host 标头，但添加一个也没有什么坏处，许多应用程序（代理）希望看到 Host 标头，而不管协议版本如何。

例子：

```
GET / HTTP/1.1
Host: www.blahblahblahblah.com 
```

此标头很有用，因为它允许您通过代理服务器路由消息，还因为您的 Web 服务器可以区分同一服务器上的不同站点。

所以这意味着如果你有 blahblahlbah.com 和 helohelohelo.com 都指向同一个 IP。您的 Web 服务器可以使用 Host 字段来区分客户端计算机想要哪个站点。

**持久连接：**

HTTP 1.1 还允许您拥有持久连接，这意味着您可以在同一个 HTTP 连接上拥有多个请求/响应。

在 HTTP 1.0 中，您必须为每个请求/响应对打开一个新连接。每次响应后，连接都会关闭。[由于TCP 慢启动](http://en.wikipedia.org/wiki/Slow-start)，这会导致一些大的效率问题。

**选项方法：**

HTTP/1.1 引入了 OPTIONS 方法。HTTP 客户端可以使用此方法来确定 HTTP 服务器的能力。它主要用于 Web 应用程序中的跨域资源共享。

**缓存：**

HTTP 1.0 支持通过标头进行缓存：If-Modified-Since。

HTTP 1.1 通过使用称为“实体标签”的东西在缓存支持上进行了很多扩展。如果 2 个资源相同，则它们将具有相同的实体标签。

HTTP 1.1 还添加了 If-Unmodified-Since、If-Match、If-None-Match 条件头。

还有更多与缓存相关的附加内容，例如 Cache-Control 标头。

**100 继续状态：**

HTTP/1.1 100 Continue 中有一个新的返回码。这是为了防止客户端在客户端甚至不确定服务器是否可以处理请求或被授权处理请求时发送大请求。在这种情况下，客户端只发送标头，服务器将告诉客户端 100 Continue，继续使用正文。

**多得多：**

*   摘要认证和代理认证

*   额外的新状态码

*   分块传输编码

*   连接头

*   增强的压缩支持

*   更多。

* * *

## 回答 #2

> 赞同：19
> 
>             
> 
> 时间：2015-10-29T23:47:09.870

 HTTP 1.0 (1994)

*   它仍在使用中

*   可由无法处理分块（或压缩）服务器回复的客户端使用

 HTTP 1.1 (1996-2015)

*   将许多扩展形式化为 1.0 版

*   支持持久和流水线连接

*   支持分块传输、压缩/解压缩

*   支持虚拟主机（具有单个 IP 地址的服务器托管多个域）

*   支持多种语言

*   支持字节范围传输；可用于恢复中断的数据传输

HTTP 1.1 是 HTTP 1.0 的增强版。下面列出了四大改进：

1.  通过允许从单个 IP 地址提供多个域，有效地使用 IP 地址。

2.  通过允许 Web 浏览器通过单个持久连接发送多个请求，响应更快。

3.  通过支持分块编码，可以更快地响应动态生成的页面，这允许在知道其总长度之前发送响应。

4.  通过添加缓存支持，更快的响应和更大的带宽节省。

* * *

## 回答 #3

> 赞同：12
> 
>             
> 
> 时间：2008-10-29T14:13:43.813

对于琐碎的应用程序（例如，偶尔从启用 Web 的温度计中检索温度值）HTTP 1.0 对客户端和服务器都适用。您可以用大约 20 行代码编写一个基于套接字的准系统 HTTP 1.0 客户端或服务器。

对于更复杂的场景，HTTP 1.1 是要走的路。为了处理更复杂的 HTTP 1.1 协议的复杂性，预计代码大小会增加 3 到 5 倍。复杂性主要来自于在 HTTP 1.1 中，您将需要创建、解析和响应各种标头。您可以通过让客户端使用 HTTP 库或服务器使用 Web 应用程序服务器来保护您的应用程序免受这种复杂性的影响。

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2008-10-29T14:34:15.300

一个关键的兼容性问题是对[持久连接](http://tools.ietf.org/rfcmarkup?doc=2616#section-8)的支持。我最近在“支持”HTTP/1.1 的服务器上工作，但在客户端发送 HTTP/1.0 请求时未能关闭连接。在编写支持 HTTP/1.1 的服务器时，请确保它也适用于仅支持 HTTP/1.0 的客户端。

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T13:59:23.530

我能回忆起的第一个区别是在同一服务器上运行的多个域，部分资源检索，这使您可以检索和加速资源的下载（几乎每个下载加速器都这样做）。

如果你想开发一个像网站或类似的应用程序，你不需要太担心它们之间的区别，但你至少**应该**`GET`知道和`POST`动词之间的区别。

现在，如果您想开发浏览器，那么是的，您将必须了解完整的协议，以及您是否正在尝试开发 HTTP 服务器。

如果您只对了解 HTTP 协议感兴趣，我建议您从 HTTP/1.1 而不是 1.0 开始。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2017-03-02T12:36:59.793

HTTP 1.1 是超文本传输​​协议的最新版本，它是运行在 Internet 的 TCP/IP 协议套件之上的万维网应用程序协议。与 HTTP 1.0 相比，HTTP 1.1 提供了比原始 HTTP 更快的网页交付并减少了 Web 流量。

Web 流量示例：例如，如果您正在访问服务器。同时有这么多用户访问服务器获取数据，那么就有机会挂掉服务器。这是网络流量。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2020-02-18T05:53:06.517

HTTP 1.1 在其规范中带有主机头，而 HTTP 1.0 没有正式的主机头，但它并没有拒绝添加一个。

主机头很有用，因为它允许客户端通过代理服务器路由消息，1.0 和 1.1 版本 HTTP 之间的主要区别是：

1.  HTTP 1.1 带有持久连接，它定义了我们可以在同一个 HTTP 连接上拥有多个请求或响应。

2.  而在 HTTP 1.0 中，您必须为每个请求和响应打开一个新连接

3.  在 HTTP 1.0 中它有一个 pragma，而在 HTTP 1.1 中它有 Cache-Control 这类似于 pragma

# sql - “简单”的 SQL 查询

> ID：246870
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T13:55:01.107
> 
>         
> 
> 标签：sql, sql-server

我的每个客户都可以有许多待办事项，每个待办事项都有一个截止日期。

在每个文件的截止日期前发现下一个未完成的待办事项的查询是什么？如果客户端有多个待办事项，则 id 最低的那个是正确的。

假设以下最小模式：

```
clients (id, name)

todos (id, client_id, description, timestamp_due, timestamp_completed) 
```

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T14:10:04.430

这个问题是***每组的经典选择***。它大约每天发布两次。

```
SELECT *
FROM todos t
WHERE t.timestamp_completed is null
  and
(
  SELECT top 1 t2.id
  FROM todos t2
  WHERE t.client_id = t2.client_id
    and t2.timestamp_completed is null
     --there is no earlier record
    and
    (t.timestamp_due > t2.timestamp_due
       or (t.timestamp_due = t2.timestamp_due and t.id > t2.id)
    )
) is null 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T15:05:42.337

我还没有对此进行测试，因此您可能需要对其进行调整：

```
SELECT
    TD1.client_id,
    TD1.id,
    TD1.description,
    TD1.timestamp_due
FROM
    Todos TD1
LEFT OUTER JOIN Todos TD2 ON
    TD2.client_id = TD1.client_id AND
    TD2.timestamp_completed IS NULL AND
    (
        TD2.timestamp_due < TD1.timestamp_due OR
        (TD2.timestamp_due = TD1.timestamp_due AND TD2.id < TD1.id)
    )
WHERE
    TD2.id IS NULL 
```

您基本上不是在尝试排序和汇总，而是在回答这个问题：“在此之前还有其他待办事项吗？” （基于您对“之前”的定义）。如果没有，那么这就是您想要的。

这在大多数 SQL 平台上应该是有效的。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:08:18.910

```
SELECT c.name, MIN(t.id)
FROM clients c, todos t
WHERE c.id = t.client_id AND t.timestamp_complete IS NULL
GROUP BY c.id
HAVING t.timestamp_due <= MIN(t.timestamp_due) 
```

避免子查询，相关的或其他的，但引入了一堆并没有更好的聚合操作。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:29:01.410

一些 Jet SQL，我意识到提问者不太可能使用 Jet，但读者可能会。

```
SELECT c.name, t.description, t.timestamp_due
FROM (clients c 
      INNER JOIN 
         (SELECT t.client_id, Min(t.id) AS MinOfid
          FROM todos t
          WHERE t.timestamp_completed Is Null
          GROUP BY t.client_id) AS tm 
ON c.id = tm.client_id) 
INNER JOIN todos t ON tm.MinOfid = t.id 
```

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2008-10-29T14:06:47.493

以下应该让您接近，首先获取每个客户端的最小时间，然后查找客户端/待办事项信息

```
SELECT
    C.Id,
    C.Name,
    T.Id
    T.Description,
    T.timestamp_due
FROM
{
    SELECT
        client_id,
        MIN(timestamp_due) AS "DueDate"
    FROM todos
    WHERE timestamp_completed IS NULL
    GROUP BY ClientId
} AS MinValues
    INNER JOIN Clients C
    ON (MinValues.client_id = C.Id)
    INNER JOIN todos T
    ON (MinValues.client_id = T.client_id
        AND MinValues.DueDate = T.timestamp_due)
ORDER BY C.Name 
```

**注意：**假设 SQL Server 编写

# methods - 什么是 HOME 方法？

> ID：246871
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T13:55:10.933
> 
>         
> 
> 标签：methods, process

一位客户问我是否了解 HOME 开发方法。我与维基百科和 acronymfinder 一起，画了一个完整的空白。

这里有人听说过一种叫做 HOME 的开发方法吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T14:00:00.207

我发现最接近提到 HOME 开发模型的是[Google Books 上的这个文档](http://books.google.com/books?id=m8ekYR9zRQEC&pg=PA5&lpg=PA5&dq=%22HOME+development+method%22&source=bl&ots=cyx9_Svtgv&sig=6hUB8EhiZ2m14OX3pXOXy1ZaSDM&hl=en&sa=X&oi=book_result&resnum=1&ct=result#PPA1,M1)。显然，它代表整体的、开放的多媒体开发方法。但没有上下文，我不能确定这是正确的。但我最好的猜测是，如果这不正确，那就是另一个首字母缩略词。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-21T10:10:51.920

你现在可能已经有了答案。

（开发多媒体——一种整体方法，作者 Maire Oosterbaan 和 Louise Harder Fischer）

HOME - 整体开放多媒体开发方法它是一种基于两个原则的方法：

1.  整体意味着从面向产品和面向过程的角度看待所有活动。

2.  它是开放的，这意味着它可以适应大多数开发场景和类型和产品。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2010-02-20T09:35:23.157

对此的最佳答案是点击此链接并阅读作者自己对该方法的 shrt 描述。

[http://nyttf.dk/?pagetype=book&vareid=44021-1](http://nyttf.dk/?pagetype=book&vareid=44021-1)

我可以推荐这种方法，因为我在丹麦多媒体设计师商学院教授项目管理

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T15:07:17.573

我也没听说过。

我相信有一种方法可以让你从你的客户那里获得关于他的意思的洞察力。

也许你可以问这样的问题，“你在什么情况下有兴趣了解更多关于 HOME 的信息？”

# php - PHP 破坏了我的日期

> ID：246876
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T13:55:59.327
> 
>         
> 
> 标签：php, date

```
$doba = explode("/", $dob);

$date = date("Y-m-d", mktime(0,0,0, $doba[0], $doba[1], $doba[2])); 
```

上面的代码将我通过的任何日期变成 1999-11-30，我知道它昨天还在工作。当我回显 $doba 时，日期是正确的。有人有想法么？

干杯

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T13:57:58.323

的格式是`$doba`什么？记住`mktime`的语法是小时、分钟、秒、**月、日年**，这可能会造成混淆。

这里有一些例子：

```
$doba = explode('/', '1991/08/03');
echo(date('Y-m-d', mktime(0,0,0, $doba[1], $doba[2], $doba[0]);

$doba = explode('/', '03/08/1991');
echo(date('Y-m-d', mktime(0,0,0, $doba[1], $doba[0], $doba[2]); 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T17:17:45.550

甚至更简单：`$date = date('Y-m-d', strtotime($dob))`

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:01:59.687

`mktime`在这种情况下使用有点矫枉过正。假设`$dob`格式如下：

> `MM/DD/YYYY`

您可以通过以下方式获得相同的结果（假设`$dob`始终有效）：

```
$doba = explode("/", $dob);
$date = vsprintf('%3$04d-%1$02d-%2$02d', $doba); 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T17:27:50.210

如果您对 jcoby 上面所说的内容有疑问，[strptime](http://www.php.net/strptime) () 命令还允许您指定格式，从而为您提供更多控制。

# windows-services - windows服务的好代码模板

> ID：246877
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-29T13:56:02.757
> 
>         
> 
> 标签：windows-services

任何指向 Windows 服务的好模板的链接？（寻找 C# 代码）

具有我可以扩展的基本功能的东西。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T14:21:39.007

你在找什么有点清楚。Visual Studio 中的**Windows 服务**项目类型创建一个项目，其中包含使用基本 Windows 服务所需的模板。

您也可以从 C# Online查看[这篇文章。](http://en.csharp-online.net/Creating_a_.NET_Windows_Service)它涵盖了一些想法，并包含文章的几个部分。  *（注意；页面加载速度似乎有点慢，请耐心等待）*

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-30T10:39:49.750

我使用VS2005，我喜欢从基本模板开始。

将 Service 类修改为此

```
using System;
using System.ServiceProcess;
using System.Timers;

namespace WindowsService1
{
    public partial class Service1 : ServiceBase
    {
        //better is to read from settings or config file
        private readonly Double _interval = (new TimeSpan(1, 0, 0, 0)).TotalMilliseconds;
        private Timer m_Timer;

        public Service1()
        {
            InitializeComponent();
            Init();
        }

        private void Init()
        {
            m_Timer = new Timer();
            m_Timer.BeginInit();
            m_Timer.AutoReset = false;
            m_Timer.Enabled = true;
            m_Timer.Interval = 1000.0;
            m_Timer.Elapsed += m_Timer_Elapsed;
            m_Timer.EndInit();
        }

        private void m_Timer_Elapsed(object sender, ElapsedEventArgs e)
        {
            //TODO WORK WORK WORK
            RestartTimer();
        }

        private void RestartTimer()
        {
            m_Timer.Interval = _interval;
            m_Timer.Start();
        }

        protected override void OnStart(string[] args)
        {
            base.OnStart(args);
            Start();
        }

        protected override void OnStop()
        {
            Stop();
            base.OnStop();
        }

        public void Start()
        {
            m_Timer.Start();
        }

        public new void Stop()
        {
            m_Timer.Stop();
        }
    }
} 
```

添加安装程序后，使用 InstallUtil.exe 安装：http: [//msdn.microsoft.com/en-us/library/ddhy0byf (VS.80).aspx](http://msdn.microsoft.com/en-us/library/ddhy0byf(VS.80).aspx)

保持Init函数小而快，否则你的服务将不会以服务没有及时响应的错误启动

希望这可以帮助

# c# - 更新程序设置

> ID：246884
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T13:57:19.103
> 
>         
> 
> 标签：c#, installation

我没有制作设置的经验，但我都准备好了，但现在我需要帮助，因为当我制作新版本时，我希望用户双击快捷方式并进行更新（如果有的话）。

该应用程序位于`c#`.

你能帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T14:14:44.747

以下是我如何实现我之前编写的更新程序。

首先，您从服务器中获取一个 ini 文件。此文件将包含有关最新版本和安装文件所在位置的信息。获取该文件并不难。

```
 WebClient wc = new WebClient();
                wc.DownloadFile(UrlOfIniContainingLatestVersion, PlacetoSaveIniFile); 
```

我还设置了从本地ini文件中读取信息以确定最新版本。更好的方法是直接读取文件版本，但我没有方便的代码。

接下来我们做一个非常简单的检查，看看两个版本是如何比较和下载更新的。

```
 if (LatestVersion > CurrentVersion)
            {
                //Download update.
            } 
```

下载更新就像下载原始ini一样简单。您只需更改更改这两个参数。

```
wc.DownloadFile(UrlOfLatestSetupFile, PlaceToSaveSetupFile); 
```

现在您已经下载了文件，运行安装程序很简单。

```
System.Diagnostics.Start(PathOfDownloadedSetupFile); 
```

* * *

如果您不确定如何读取 ini 文件，我在 CodeProject 的某处找到了以下类

```
using System;
using System.Runtime.InteropServices;
using System.Text;

namespace Ini
{
    /// <summary>
    /// Create a New INI file to store or load data
    /// </summary>
    public class IniFile
    {
        public string path;

        [DllImport("kernel32")]
        private static extern long WritePrivateProfileString(string section,
            string key, string val, string filePath);
        [DllImport("kernel32")]
        private static extern int GetPrivateProfileString(string section,
                 string key, string def, StringBuilder retVal,
            int size, string filePath);

        /// <summary>
        /// INIFile Constructor.
        /// </summary>
        /// <PARAM name="INIPath"></PARAM>
        public IniFile(string INIPath)
        {
            path = INIPath;
        }

        /// <summary>
        /// Write Data to the INI File
        /// </summary>
        /// <PARAM name="Section"></PARAM>
        /// Section name
        /// <PARAM name="Key"></PARAM>
        /// Key Name
        /// <PARAM name="Value"></PARAM>
        /// Value Name
        public void IniWriteValue(string Section, string Key, string Value)
        {
            WritePrivateProfileString(Section, Key, Value, this.path);
        }

        /// <summary>
        /// Read Data Value From the Ini File
        /// </summary>
        /// <PARAM name="Section"></PARAM>
        /// <PARAM name="Key"></PARAM>
        /// <PARAM name="Path"></PARAM>
        /// <returns></returns>
        public string IniReadValue(string Section, string Key)
        {
            StringBuilder temp = new StringBuilder(255);
            int i = GetPrivateProfileString(Section, Key, "", temp,
                                            255, this.path);
            return temp.ToString();

        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T15:02:07.710

听起来您可能可以使用[ClickOnce](http://msdn.microsoft.com/en-us/library/t71a733d(VS.80).aspx)

# windows-services - 更新Windows服务的过程？是自动的还是手动的？

> ID：246886
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-29T13:57:27.683
> 
>         
> 
> 标签：windows-services

如果我在服务器上有 Windows 服务，更新服务的“最佳做法”是什么？（假设其中有一个错误，或者我需要为其添加更多功能）。

有没有办法可以关闭服务、修补它并以更自动化的方式启动和运行？

（任何带有代码的链接都会很棒）

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T14:02:15.943

好吧，您总是可以在安装程序上升级版本（如果您使用过）并运行它，根据我的经验，它会用新版本覆盖旧版本。

或者您可以简单地关闭服务，复制新的 .exe（和依赖项，如果有的话）并重新启动它。这一切都可以通过脚本和我想象的 NET 启动/停止功能来完成。

我敢肯定有比这更好的方法......

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T14:13:07.373

取决于您的服务是如何编写的 - 整体 EXE - 您需要使用选择的过程停止和重新启动它，例如安装程序、脚本 + 服务控制、批处理和 NET STOP/START 等。

如果您的结构稍有不同，例如引导 EXE 将您的服务实现加载为可以卸载/重新加载的模块，那么您可以进行不同的对话。这当然要复杂得多。

我在 C# 中通过这样的托管解决方案取得了一些成功，类似的对话在这里：

> [我希望我的 C# Windows 服务自动更新](https://stackoverflow.com/questions/106765/i-want-my-c-windows-service-to-automatically-update-itself#106799)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:12:20.837

InstallShield 支持 Windows 服务。利用安装程序将使您的任务变得更加简单。

# redirect - 书签页面重定向

> ID：246890
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T13:57:51.740
> 
>         
> 
> 标签：redirect, asp-classic, coldfusion

我最近将一个站点从 asp 转换为 CF。不幸的是，很多老用户都将“主页”添加为书签。www.example.com/homepage.asp

是否有一种方法可以将任何流量从该页面重定向到当前的 index.cfm？

我通常会删除这些文件，但所有者出于自己的比较原因想要保留它。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-10-29T14:09:01.170

把这个放在旧的homepage.asp中

```
<%@ Language=VBScript %>
<%
Response.Status="301 Moved Permanently"
Response.AddHeader "Location", "/index.cfm"
%> 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T20:38:45.707

如果您根本不想在新站点上运行繁重的 asp 文件，您可以在 Web 服务器上执行自定义 404。如果将 404 页面指向 .cfm 文件，则可以通过包括以下内容从请求中提取所有各种功能：

```
<!--- parse out the text in the URL parameters into an array --->
<cfset variables.requestparams = listtoarray(cgi.query_string,'/?&')>

<!--- get rid of the first 2 items in the array since they dont represent request info --->
<cfset foo = arraydeleteat(variables.requestparams,1)>
<cfset foo = arraydeleteat(variables.requestparams,1)> 
```

您将得到一个数组，该数组表示在原始请求中传递的参数。您可以通过对 url 组件进行所需的任何分析来跟进这一点，以将其映射到 CF 站点中的类似页面。  

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-11-01T04:13:59.183

我很惊讶没有人提到 URL 重写。您可以在 *nix/apache 上使用 mod_rewrite，或者在 Windows/IIS 上使用[ISAPI Rewrite](http://www.isapirewrite.com/)或[Ionics ISAPI Rewrite 。](http://www.codeplex.com/IIRF)如果我在 IIS 上，我更喜欢 Ionics。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:00:01.003

最好的办法是在实际的 homepage.asp 页面中进行元刷新，它又快又脏，但是可以。

更好的解决方案是让 .asp 页面执行 301 重定向到新主页，这样当搜索引擎访问该页面时，他们也知道它已移动。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T15:09:52.763

当我遇到这样的事情时，我在 Linux 机器上所做的就是创建一个符号链接 ( `ln -s /path/to/source /path/to/target`)。

不确定 Windows 等效项是什么，所以最好使用[@Patrick 的回答。](https://stackoverflow.com/questions/246890/bookmarked-page-redirect#246929)

**编辑**- 制作符号链接的 NTFS 方式：

[http](http://en.wikipedia.org/wiki/NTFS_symbolic_link)
 ://en.wikipedia.org/wiki/NTFS_symbolic_link
另见[http://en.wikipedia.org/wiki/Symbolic_link](http://en.wikipedia.org/wiki/Symbolic_link)

# c# - .Net 等价于 set_unexpected()

> ID：246893
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T13:58:17.433
> 
>         
> 
> 标签：c#, .net, exception-handling, .net-2.0, unhandled

是否有与 C++ 意外（）/set_unexpected（）功能等效的 .net？

* * *

**编辑：**  对不起 - 我之前省略了一些细节：

语言：C# 2.0

我有一些遗留应用程序似乎在某处抛出了一些未处理的异常。我只是想采取一些措施来阻止客户的痛苦，直到我能够追踪问题的实际根源。据我所知，在 C++ 中，当一个未处理的异常冒泡到主例程时，set_unexpected() 指向的函数会被调用。因此，我对 .net 等效功能提出了疑问。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:11:09.840

根据应用程序的类型，处理未处理的异常有 3 种可能的场景：

1.  对于 Windows 窗体应用程序，将事件处理程序挂钩到[Application.ThreadException](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx)

2.  对于命令行应用程序，将事件处理程序挂钩到[AppDomain.UnhandledException](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)

3.  对于 ASP.NET 应用程序，在 Global.asax 中，创建：

    protected void Application_Error(Object sender, EventArgs e)

免责声明：我不是 c++ 开发人员，但从我读到的内容来看，这应该回答你的问题。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2012-07-26T09:31:40.180

这些处理程序应该在您的混合模式应用程序中捕获大多数意外异常。

```
private delegate long UnhandledExceptionFilter(IntPtr exception);

[DllImport("KERNEL32.DLL", SetLastError = true)]
private static extern IntPtr SetUnhandledExceptionFilter([MarshalAs(UnmanagedType.FunctionPtr)] UnhandledExceptionFilter filter);

// put these in your bootstrapper
AppDomain.CurrentDomain.UnhandledException += CurrentDomainUnhandledException;
Application.ThreadException += ApplicationThreadException;
SetUnhandledExceptionFilter(UnhandledExceptionFilter);

void CurrentDomainUnhandledException(object sender, UnhandledExceptionEventArgs e)
{
    ...
}

void ApplicationThreadException(object sender, ThreadExceptionEventArgs e)
{
    ...
}

long UnhandledExceptionFilter(IntPtr exception)
{
    ....
} 
```

# javascript - jCarousel - 帮助新皮肤

> ID：246901
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2008-10-29T14:00:13.467
> 
>         
> 
> 标签：javascript, jquery, html, css, css-frameworks

我正在为我将用于我的网站的 jCarousel 组件创建一个新主题，该组件的尺寸将是：宽度：485px，高度：161px，包括两个箭头，我想要的是 3 个项目每个周期，每个周期的尺寸为 140X100（宽 X 高），边距为 5px，皮肤的 3/4 已完成，但我很难使用 css。

PS：请访问此页面以实时查看组件
[http://www.amfexglobal.com/test/static_auto.html](http://www.amfexglobal.com/test/static_auto.html)
如果您对从此处下载的文件感兴趣
[http://www.mediafire.com/?ejlmmxxzdid](http://www.mediafire.com/?ejlmmxxzdid)

提前非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T16:45:07.517

也许解释你遇到的问题？

我看到它的方式（通过查看您的样本），除了第一个和最后一个元素被高边距或下边距外，您没问题，这取决于它们落在哪里。

你可以通过两种方式对抗：

*   分割你的边距，所以你使用的是 0px 3px 0px 2px 而不是 margin: 0 5px 0 0。但是，对于奇数，这有点不平衡。

*   更好的是，我认为将包含元素上的填充设置为 padding-left: 5px。这为您提供了 5px 的“领先优势”，然后每个元素的右边距负责最后一个。

祝你好运！

# allegro - 审查我的游戏项目或（如何对我的项目进行同行审查）？

> ID：246905
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T14:01:03.200
> 
>         
> 
> 标签：allegro

我刚刚用 C++/Allegro 完成了一个 2d 平台游戏。它还处于不完整的阶段...

我想知道如何让从事游戏开发的人进行同行评审。我想审查我的项目，理由是

1.  游戏

2.  碰撞检测

3.  面向对象的使用

4.  声音、效果等的编程

5.  任何进一步的想法

6.  我本可以做得更好的方法

7.  优化方法

当前的代码在某些地方看起来像垃圾......所以你能建议一些简化技术吗？

您可以在更新的链接中查看我的项目（如果您愿意） - [nincompoop ](http://ideamonk.blogspot.com/2008/09/nincompoop-all-ready-for-shaastra-2008.html) [（直接链接）](http://ideamonk.googlepages.com/nincompoop_distro.rar)

[http://ideamonk.googlepages.com/nincompoop_distro.rar](http://ideamonk.googlepages.com/nincompoop_distro.rar)

到目前为止，我正在切换到 C# 和 XNA，发现学习一切都非常容易和快速，因为我印象深刻 -

[http://catalog.xna.com/GameDetails.aspx?releaseId=341](http://catalog.xna.com/GameDetails.aspx?releaseId=341)

> 我不打算在这里销售任何产品或推广任何东西......我的目的是从更好的人那里获得更好的建议。至于我上传项目的页面，它不受任何类型的广告支持。所以请放心。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-31T17:09:41.893

我在您的源代码中注意到的第一件事是，您的大部分游戏逻辑都在 main.cpp 文件中，嵌套深度多达 11 个选项卡！出于代码组织的目的，这是一场噩梦。当然，我在第一场比赛中也这样做了。:) 您可以做的第一件事是简化您的主游戏循环，使其看起来像这样：

```
int main () 
{
    game_object gob;
    gob.init_allegro();
    gob.load_assets();
    while(true) {
        gob.handle_inputs()
        if (!gob.update())
            break;
        gob.render();
    }
    gob.cleanup();
} 
```

其他所有内容都应该重构到您的 game_object 类中。这样管理起来会容易得多，而且您的代码实际上可能适合页面，因为您可以避免深度嵌套。如果您发现代码的深度超过 3 个标签，那么无论您在做什么，都需要将其重构为另一个方法，甚至是一个单独的类。

我的第二个建议是将你的 goto 替换为更理智的东西，如下所示：

```
bool playerwins = check_win_condition();

if(playerwins) {
    // win condition code
} else {
    // lose condition code
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T14:12:01.727

**回顾上一集——**

我不明白为什么人们投票反对你并冒犯你。保持良好的工作...... – Daok（27 分钟前）

要求同行评审有什么严重的错误吗？在按下向下按钮之前想一想，明天你可能也需要同行评审！– Abhishek Mishra（26 分钟前）

@Daok：这就是我 58 秒前想知道的！– Abhishek Mishra（25 分钟前）

这很愚蠢。它可能不符合 SO 问题的典型模式，但同行评审并不是一件坏事，更不值得攻击，更不用说 4 票反对。——托马斯·欧文斯（23 分钟前）

@Mitchel Sellers：你知道吗，我在做这个项目的时候就游戏开发进行了很好的讨论......所以我认为把它放在 fr 审查会很好......但是 @stackoverflow ......事情真的伟大的！ycombinator 人群更加聪明，他们提出了惊人的反馈——Abhishek Mishra（21 分钟前）

我认为这可能是问题的短语和语气。这听起来更像是产品公告，而不是寻求帮助的问题。如果它被表述为“如何正确地对我的项目进行同行评审”等，那么人们可能就不那么苛刻了。——马克·英格拉姆（21 分钟前）

关键是，这不是 Stack Overflow 的用途。它用于询问特定的技术问题。– Remi Despres-Smyth（19 分钟前）

哎呀......是的，当我输入问题时，它在我脑海中滚动......让我把它改写成一个*真正*的问题！:) – Abhishek Mishra（18 分钟前）

并且人们也可以就如何改进游戏提供技术反馈......此外，我也将源代码提交给审查！有什么办法可以再次提出问题吗？– Abhishek Mishra（17 分钟前）

我已经要求进行代码审查，并在此处收到。Abhishek，如果有人重新打开它并且您可以对其进行编辑，请查看以下问题：[K＆R 练习：我的代码有效，但感觉很臭；清理建议？](https://stackoverflow.com/questions/161873/k-r-exercise-my-code-works-but-feels-stinky-advice-for-cleanup)作为代码审查问题示例。——约翰·鲁迪（12 分钟前）

@约翰：谢谢！希望它有效！

# java - jsp内同一张表的2个实例

> ID：246912
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T14:02:41.027
> 
>         
> 
> 标签：java, jsp

目前一个jsp文件有2个页面：其中一个显示数据，第二个用于分页。任务是在数据表上方包含完全相同的分页器表。不好意思，忍不住画了：）

```
|-----------------------------------------|
|                      Page 2 of 200  < > |
|-----------------------------------------|
|-----------------------------------------|
|   Some weird business data comes here   |
|-----------------------------------------|
|-----------------------------------------|
|                      Page 2 of 200  < > |
|-----------------------------------------| 
```

问题是：如果没有无耻的复制粘贴，我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T14:20:38.543

也许您可以在单独的 jsp 中定义分页内容，然后将其两次包含到您的主 jsp 中。例如：

```
<jsp:include page="pagination.jsp" flush="true" />

<table>...business data...</table>

<jsp:include page="pagination.jsp" flush="true" /> 
```

这样，如果您想更改分页内容，只需编辑 pagination.jsp。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:35:37.873

今天在 JSP 中进行抽象的四种机制是 jsp:include 标记、<%@ include> 指令、自定义标记库和自定义标记文件。

jsp:include 插入执行另一个 JSP 页面的结果，所以你可以这样做：

```
<jsp:include "page_naviagtor.jsp"/>
<table id="results">...</table>
<jsp:include "page_navigator.jsp"/> 
```

<%@ include> 类似于 jsp:include，不同之处在于它并不实际执行代码，而是简单地将其标记到原始 JSP 源中并与页面的其余部分一起编译。

自定义标签库（几乎）为您提供了 JSP 标签的全部功能，因此您可以执行以下操作：

```
<tag:wrap_in_page_nav>
    <table id="results"> ... </table>
</tag:wrap_in_page_nav> 
```

但是，这些要求您编写自定义 Java 代码。

最后，坦率地说，对于大多数情况来说，最好的选择是 JSP 2.0 Tag FIle。

标记文件是 jsp:include 和自定义标记之间的交叉。它们允许您执行类似于“wrap_in_page_nav”标记的操作，但您实际上使用 JSP 标记创建标记。

因此，在许多情况下，您可以简单地剪下要重构的部分，并将其粘贴到标签文件中，然后简单地使用该标签。

page.tag

```
<%@tag description="put the tag description here" pageEncoding="UTF-8"%>
<%@ taglib prefix="t" tagdir="/WEB-INF/yourtags" %>    
<%@attribute name="startPage" required="true"%>
<%@attribute name="endPage" required="true"%>    
<html>
    <head>
        <title>Page Title</title>
    </head>
    <body>
        <tag:page_nav startPage="${startPage}" endPage="${endPage}"/>
        <jsp:doBody/>
        <tag:page_nav startPage="${startPage}" endPage="${endPage}"/>
    </body>
</html> 
```

page_nav.tag

```
<%@tag description="put the tag description here" pageEncoding="UTF-8"%>
<%@ taglib prefix="t" tagdir="/WEB-INF/yourtags" %>    
<%@attribute name="startPage" required="true"%>
<%@attribute name="endPage" required="true"%>    
<div>${startPage} .. ${endPage}</div> 
```

最后，你的 JSP

```
<%@page contentType="text/html"%>
<%@page pageEncoding="UTF-8"%>
<%@ taglib prefix="t" tagdir="/WEB-INF/yourtags" %>
<tag:page startPage="1" endPage="4">
    <table> ... </table>
</tag:page> 
```

每个标签文件都拥有 JSP 的全部威力，唯一的限制是在使用自己的自定义标签文件时，您的自定义标签文件标签之间不能包含 scriptlet 代码（可以使用普通的 JSP 标签，只是现在标签文件标签）。

标记文件是在 JSP 中使用的一个非常强大的抽象工具。

# visual-studio - Visual Studio 是用 Windows 窗体编写的吗？

> ID：246913
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2008-10-29T14:02:50.810
> 
>         
> 
> 标签：visual-studio, winforms

Visual Studio 是用 .NET Windows 窗体编写的吗？还是 Windows 窗体对于编辑器类型的应用程序来说太慢了？

* * *

## 回答 #1

> 赞同：22
> 
>             
> 
> 时间：2008-10-29T14:11:40.603

这不是一个很公平的问题。:)

Visual Studio .NET (devenv.exe) 不是直接用 WinForms 编写的，因为它不是 CLR 可执行文件。（我的预感是它仍然是用 Visual C++ 生成的。）事实上，我知道 devenv.exe 的 2005 和 2008 版本都没有带有 CLR 标头。（我只是将它们都放在 ILDASM 上；它们绝对不是托管代码。）

也就是说，仅仅因为 devenv.exe 不是用 WinForms 编写的，并不意味着 WinForms 对于编辑器来说太慢了。在大多数系统上，WinForms 一点也不慢——我们的应用程序代码将成为框架之前的瓶颈。

我的预感是 devenv.exe 是用 C/C++ 编写的，因为它是对长期存在的环境的升级；微软在 .NET 中重写它的成本无疑是令人望而却步的。

同样，就 WinForms 速度而言——有不少 WinForms 应用程序没有任何性能问题，包括相当强大的 .NET IDE ( [SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/) )。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T19:40:39.690

[显然 VS 2010 有部分用 WPF 编写。](http://demiliani.com/blog/archive/2008/10/28/6520.aspx) 

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T14:09:58.783

[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)是一个 .NET Windows 窗体应用程序。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T15:40:14.043

这听起来有点像“[你还在打你的妻子吗？](http://en.wikipedia.org/wiki/Loaded_question) ”没有答案的问题，从 Visual Studio 的角度来看听起来不错。

不，Visual Studio（至少到 2008 年）不是使用 .NET 编写的。但是，SharpDevelop 和其他编辑器不一定会遇到速度问题。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:08:21.890

VS 的核心仍然是一个非托管的可执行文件，因此它不使用 winforms。可能有一些部分是用 .NET 编写的，特别是围绕一些较新的特性，但核心可扩展性模型是基于 COM 的（并且非常复杂......）

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T19:50:54.210

这是一种二合一的问题。正如其他人所提到的，Visual Studio 不使用 WinForms。您的另一个问题与第一个问题无关，因为 a）Visual Studio 不是“编辑器”，它是 IDE 并且 b）它在提出问题。

也就是说，WinForms 是任何基于 Windows 的应用程序的绝佳选择，包括 IDE（如前面提到的 SharpDevelop）和您可以想象的任何“编辑器”，包括音频和视频。所以不，对于“编辑器类型的应用程序”来说，这并不是“太慢”。

当然，您可以自由编写在 Windows 窗体应用程序中运行的慢速代码。:)

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:12:42.600

如果 VS 团队没有使用 WinForms，你的意思是唯一可能的原因是 WinForms 太慢了。那是无效的。SharpDevelop 的 IDE 是用 WinForms 编写的并且性能良好的事实表明，无论 Visual Studio 的 IDE 使用什么，它都不会“太慢”。  

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T14:07:37.570

根据我对 VS SDK 的经验，它看起来好像是用 C++/COM 构建的，但我认为这只是因为 Visual Studio 团队决定采用它（而且 Windows 窗体在发布时并不作为发布版本存在）首先开发 VS.NET IDE）。

您可以将 Windows 窗体用于编辑器类型的应用程序。我认为 SharpDevelop 是一个 WinForms 应用程序。

# asp.net - 如何将 ASP.NET 母版页存储在公共库中？

> ID：246917
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-10-29T14:06:33.873
> 
>         
> 
> 标签：asp.net, master-pages

我们希望有几个使用相同母版页的内部 Web 应用程序。有没有办法将母版页存储在所有项目引用的公共库中？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:22:30.800

你可以这样做，但它很困难并且有很多缺点。

这个过程也类似于打包用户控件。基本上，您有一个包含母版页的 Web 应用程序项目。您可以使用 aspnet_compiler 将其预编译成一组 dll。

然后您可以使用 ilmerge.exe 将它们全部放入一个 dll 中，然后您可以从其他项目中引用该 dll。

您仍然需要标记才能使您的页面在设计器中正确呈现，因此您可能还必须调查 VirtualPathProviders。

这是一个笨拙的解决方案，它有很多缺点。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T16:52:47.767

鉴于这些模块是同一个 Web 应用程序的一部分，您应该看看[这种](http://weblogs.asp.net/scottgu/archive/2006/08/16/Tip_2F00_Trick_3A00_-Creating-Sub_2D00_Web-Projects-using-the-VS-2005-Web-Application-Project-Option.aspx)方法：

基本上，您有一个根 Web，它被设置为（唯一的）IIS Web 应用程序。您可以通过创建 ASP.NET Web 应用程序项目插入新的 Web 模块并将其物理放置在根 Web 下。将构建目录设置为根 web 的 bin，例如。“..\垃圾桶”。不要创建 IIS 应用程序/虚拟目录。

因此，每个 web 模块都编译成自己的 DLL，这本身就是一件好事。编译时，它与根网站“合并”。

这是共享母版页和用户控件的好方法，并且在不同的项目/程序集中拥有网站的不同部分。母版页和用户控件甚至可以在设计模式下工作。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:16:42.310

听说这个可以用，没试过。

创建一个单独的项目来容纳您的母版页，因为所有母版页都类似于用户控件并内置在它们自己的单独程序集中。运行构建并尝试引用母版页的程序集。

同样，未经测试，只是我以前读过的东西。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-08-27T11:01:18.573

希望这有助于 
[跨应用程序共享母版页](http://dotnetkeeda.blogspot.com/2009/04/sharing-master-pages-across-web.html)

享受.. ：）

# asp.net - 像 StackOverFlow 上的页面查看计数器

> ID：246919
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2008-10-29T14:06:48.617
> 
>         
> 
> 标签：asp.net

像他们在每个问题都有一个“视图”计数器的网站上一样，实现页面视图计数器的最佳方法是什么？

考虑性能和可扩展性问题。

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2008-10-29T15:22:02.333

我对 stackoverflow 视图计数器做了两个观察：

*   标头中有一个`link`元素处理触发计数更新。对于这个问题，标记看起来像这样：

    `<link href="/questions/246919/increment-view-count" type="text/css" rel="stylesheet" />`

    我想您可以点击该 url 来更新查看次数，而无需实际查看页面，但我还没有尝试过。

*   我有一个[uservoice ticket](http://stackoverflow.uservoice.com/pages/general/suggestions/33016)，其中 Jeff 的响应表明视图不会连续两次从同一个 ip 增加。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2008-10-29T14:21:44.733

我优化的计数器是这样工作的：

```
UPDATE page_views SET counter = counter + 1 WHERE page_id = x
if (affected_rows == 0 ) {
   INSERT INTO page_views (page_id, counter) VALUES (x, 1)
} 
```

这样，您为第一个视图运行 2 个查询，其他视图只需要 1 个查询。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2008-10-29T14:18:31.790

一种有效的方法可能是：将您的计数器存储在 Application 对象中，您可以定期将其保存到文件/数据库中并在应用程序关闭时保存。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-10-13T23:53:06.030

我不会在每次访问数据库时都进行数据库调用，而是使用缓存对象增加一个计数器，并根据您每天访问网站的次数，每隔 100 次访问网站就将页面访问发送到数据库。这比每次点击更新数据库都要快。

或者另一种解决方案是分析 IIS 日志文件并通过 Windows 服务每 30 分钟更新一次命中。这就是我已经实施的，它创造了奇迹。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:24:45.617

您可以实现一个 IHttpHandler 来做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:29:18.353

我是@Guillaume 的执行风格的粉丝。我使用透明的 GIF 处理程序和内存队列来批量处理更改集，然后使用 global.asax 中创建的单独线程定期刷新这些更改集。

处理程序实现IHttpHandler，处理请求参数，例如页面id，语言等，更新队列，然后response.writes透明GIF。

通过将持久更改移动到单独的线程而不是用户请求，您还可以更好地处理来自运行多个服务器等的潜在序列化问题。

当然，您也可以花钱请其他人来完成这项工作，例如使用透明 gif。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:30:06.947

对我来说，最好的方法是在问题表中有一个字段并在访问问题时更新它

```
UPDATE Questions SET views = views + 1 WHERE QuestionID = x 
```

应用程序对象：IMO 不可扩展，因为随着访问更多问题，最终可能会消耗大量内存。

Page_views 表：不需要，你必须做一个昂贵的连接之后   

# java - 使用 AJAX 而不是 TagLib？

> ID：246921
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T14:06:56.713
> 
>         
> 
> 标签：java, annotations, taglib

我正在考虑使用 Ajax 而不是 TagLib 的想法。最优雅的方式是：使用 Java 注释。这个想法是，设计师或任何人都可以在没有任何 taglib 的情况下制作 HTML，只需使用带有 id 或 name 的“标准”HTML 标签，并调用 Javascript。这样任何所见即所得都可以使用，开发人员不必关心 HTML 格式或它的设计方式。在许多（至少是开源的）WYSIWYG 中，不会在最终结果中显示标记库（或有它的模板），因此很难“预览”。另一个原因是，开发人员应该知道 Java 和 HTML/TagLibs 不应该是必须的，因为我们有 CSS 和 AJAX。

它应该像这样工作：

**MyClass.java**：

 `````
import ...

// Use the ResourceBundle resource[.{Locale}].properties
@Jay2JI18n(resourceBundle="org.format.resource",name="MyClassForm")
public class MyClass {
    private Integer age;
    private String name
    private Date dob;
    private salary;

    @Jay2JLabel(resource="label.name")
    @Jay2JMaxLength(value=50,required=true,)
    @Jay2JException(resource="exception.message")
    public String getName() {
         ...
    }
    public void setName(String name) {
        if ( name.trim().equal("") ) {
            throw new Exception("Name is required");
        }
    }
    /* Getter and setter for age */
    ...
    @Jay2JLabel(message="Salary")
    @Jay2JFormat(format="##,###.00",language="en")
    @Jay2JFormat(format="##.###,00",language="pt_BR")
    // or you could use that to access a property of the ResourceBundle
    //@Jay2I18nResource(resource="money.format")
    public Date getSalary() {
        ...
    }
    /* Setter for salary and getter/setter for the rest */
    ...
} 
````  `**页面.html**：

 `````
<html>
  <head>
    <SCRIPT>
    </SCRIPT>
  </head>
  <body>
     <form onload="Jay2J.formalize(this)">
     </form>
  </body>
</html> 
````  `其中可以是填充字段的 HTML；
**PageWithFields.html**：

 `````
<html>
  <head>
    <SCRIPT>
    </SCRIPT>
  </head>
  <body>
     <form action="myfavoritewaytopostthis" onsubmit="return Jay2J.validate(this)" onload="Jay2J.formalizeExistField(this)">
       <label>Name</label><input type="text" name="name" id="name" />
       <label>DOB</label><input type="text" name="dateOfBirth" id="dob" />
       <label>Salary</label><input type="text" name="salary" id="salary" />
       <input type="submit" />
     </form>
  </body>
</html> 
````  `这样，注释（没有 XML，就像 HTML 一样，它只是另一个文件修改并且 XML 不是 Java）将定义如何处理 HTML。这样开发人员就可以停止使用 HTML 进行开发而只使用 JAVA（或 JavaScript），您认为这是一个有效的想法吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:37:00.350

当我看到你的主题标题时，我想：

您不能使用 Ajax 代替 taglib。AJAX 是客户端上的 javascript，而 taglib 是服务器上的 java 代码。

读完你的帖子后，我想，啊，他该怎么做[链接文本] [1]做什么

但后来不完全一样。

[1]：[http](http://code.google.com/webtoolkit/) : //code.google.com/webtoolkit/GWT

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T20:12:11.563

第一印象是......糟糕，如果不学习你的（新的、不同的、非标准的）做事方式，拿起这个的人将不知道他们在看什么。您可以通过实现一个带有 bean（值对象）的标签来做类似的事情，并且可能会进行一些小的反射/注释检查以发出正确的 html，这样您就可以省去很多心痛。  

使您的值对象实现一个简单的接口，您的标签将使用该接口来提取和格式化 html，并且您可能会在 1/2 或更少的工作中获得 80-90% 的目标。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-30T19:02:17.163

第一印象是，WTF。进一步阅读后，我的印象是您正在尝试以不同的方式解决“关注点分离”问题。对您的方法的一些观察。

1.  需要启用客户端脚本，因此无法访问可访问性指南。

2.  重新发明轮子：许多 Web 框架，如 Tapestry、Wicket 都试图解决这些问题，并做出了值得称道的工作。

3.  关于将 Java 绑定到 HTML 的评论，代码示例并没有很清楚地传达这个想法。formize() 似乎创建了 UI，这意味着您已将 UI (HTML) 编码到 java 中（坏主意？可能不是 NakedObjects 尝试为您提供 UI 的域模型，如果要编写特定于页面的代码，可能是的）

4.  validate() 是在 onSubmit() 上调用的，为什么要异步处理！！除此之外，使用令人讨厌的 java 脚本已经过时了（再次分离关注点）

5.  您关于阻止所见即所得标签库的论点虽然是有道理的，但并不完全有效。标签不能用于组成其他标签，每个标签都是一个独特的实体，要么处理行为，要么发出一些 html 代码。您的论点适用于第二种情况。但是，如果我正确理解了您的formalize()，那么您也在做同样的事情！

很高兴听到一些新想法，欢迎来到 SO。此外，请使用编辑问题选项，直到您获得足够的声誉来添加评论。添加答案不是正确的方法！

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-09-01T00:44:21.520

这个想法有一些优点，如果我理解正确的话。

您可以使用 AOP 来修改实际会为页面调用的 servlet。然后，servlet 将使用注释返回 html。

这样程序员就看不到 html 生成，如果你有一个标准的 javascript 库，那么它可能会工作。

但是，仅仅因为它有效并不意味着你应该这样做。

如前所述，有许多框架可以对程序员隐藏 javascript，例如 JSF，它基本上是标记库和不同的导航方案。

我记得使用 beehive 项目做类似的事情，它是注释驱动的，所以我基本上可以在 java 中做所有事情，并且它在几年前生成了 javascript。:)

# guid - GUID 和 UUID 之间有什么区别吗？

> ID：246930
> 
>         
> 
> 赞同：1008
> 
>         
> 
> 时间：2008-10-29T14:09:08.830
> 
>         
> 
> 标签：guid, uuid

我看到这两个首字母缩写词被抛出，我想知道 GUID 和 UUID 之间是否有任何区别？

* * *

## 回答 #1

> 赞同：948
> 
>             
> 
> 时间：2011-08-05T08:01:48.497

~~简单的**答案**是：**没有区别，它们是一样的。~~

**2020 年 8 月 20 日更新**：虽然 GUID（由 Microsoft 使用）和 UUID（由 RFC4122 定义）看起来相似并且用于相似的目的，但存在细微但偶尔重要的差异。具体来说，[一些 Microsoft GUID 文档](https://docs.microsoft.com/en-us/windows/win32/msi/guid)允许 GUID 在任何位置包含任何十六进制数字，而 RFC4122 要求`version`and`variant`字段具有某些值。此外，[per that same link]，GUID 应该全部大写，而 UUID[应该](https://www.rfc-editor.org/rfc/rfc4122#section-3)“输出为小写字符并且在输入时不区分大小写”。这可能导致代码库之间的不兼容（[例如 this](https://github.com/uuidjs/uuid/issues/511)）。

（原答案如下）

* * *

将它们视为用作唯一值的 16 字节（128 位）值。在微软语言中，它们被称为 GUID，但在不使用微软语言时称它们为 UUID。

甚至 UUID 规范的作者和微软也声称它们是同义词：

*   从IETF [RFC 4122](https://datatracker.ietf.org/doc/html/rfc4122) “ *A Universally Unique IDentifier (UUID) URN Namespace* ”的介绍：“UUIDs（Universally Unique IDentifier）的Uniform Resource Name namespaces，也称为GUIDs（Globally Unique IDentifier）。”

*   来自[ITU-T X.667 建议书、ISO/IEC 9834-8:2004 国际标准](http://www.itu.int/ITU-T/studygroups/com17/oid.html)：“UUID 也称为全球唯一标识符 (GUID)，但本建议书不使用该术语。”

*   微软甚至[声称](http://msdn.microsoft.com/en-us/library/cc246025%28v=PROT.13%29.aspx)GUID 是由 UUID RFC 指定的：“在 Microsoft Windows 编程和 Windows 操作系统中，[RFC4122] 中指定的全局唯一标识符 (GUID) 是......术语通用唯一标识符 (UUID) ) 有时在 Windows 协议规范中用作 GUID 的同义词。”

但是**正确的答案**取决于当它说“UUID”时问题的含义......

第一部分取决于提问者在说“UUID”时的想法。

Microsoft 的声明暗示所有 UUID 都是 GUID。但是所有的 GUID 都是真正的 UUID 吗？也就是说，所有 UUID 的集合只是所有 GUID 集合的适当子集，还是完全相同的集合？

查看 RFC 4122 的详细信息，UUID 有四种不同的“变体”。这主要是因为在创建 UUID 规范时将这些规范组合在一起之前使用了这样的 16 字节标识符。从[RFC 4122](https://datatracker.ietf.org/doc/html/rfc4122)的第 4.1.1 节，UUID的四种*变体是：*

1.  保留，网络计算系统向后兼容

2.  RFC 4122 中指定的*变体*（其中有五个子变体，称为“版本”）

3.  保留，Microsoft Corporation 向后兼容

4.  保留以供将来定义。

根据 RFC 4122，所有 UUID*变体*都是“真正的 UUID”，那么所有的 GUID 都是真正的 UUID。对于字面问题“GUID 和 UUID 之间是否有任何区别”，对于 RFC 4122 UUID，答案肯定是否定的：**没有区别**（但受以下第二部分的约束）。

但并非所有 GUID 都是*变体*2 UUID（例如，Microsoft COM 的 GUID 是变体 3 UUID）。如果问题是“GUID 和变体 2 UUID 之间有什么区别”，那么答案是肯定的——它们可能不同。问这个问题的人可能不知道*变体*，当他们说“UUID”这个词时，他们可能只想到*变体*2 UUID（例如，他们隐约知道 MAC 地址+时间和 UUID 的随机数算法形式，其中都是*变体*2)的两个*版本。*在这种情况下，答案是**肯定的不同**。

 ***因此，答案部分取决于提问者在说出“UUID”这个词时的想法。他们是指变体 2 UUID（因为这是他们知道的唯一变体）还是所有 UUID？

第二部分取决于使用哪个规范作为 UUID 的定义。

如果您认为这令人困惑，请阅读[ITU-T X.667 ISO/IEC 9834-8:2004](http://www.itu.int/ITU-T/studygroups/com17/oid.html)，它应该与[RFC 4122](https://datatracker.ietf.org/doc/html/rfc4122)保持一致并在技术上完全兼容。它在第 11.2 条中有一个额外的句子说：“所有符合本建议书 | 国际标准的 UUID 应具有变体位，其中八位字节 7 的位 7 设置为 1，八位字节 7 的位 6 设置为 0”。这意味着只有*变体*2 UUID 符合该标准（这两个位值表示*变体*2）。如果这是真的，那么并非所有 GUID 都符合 ITU-T/ISO/IEC UUID，因为符合 ITU-T/ISO/IEC UUID 只能是*变体*2 值。

因此，真正的答案还取决于问题所询问的 UUID 规范。假设我们清楚地谈论所有 UUID，而不仅仅是变体 2 UUID：GUID 和 IETF 的 UUID 之间**没有区别**，但GUID 和*符合*ITU-T/ISO/IEC 的 UUID之间是有**区别的！**

 ***二进制编码可能不同**

当以二进制编码（与人类可读的文本格式相反）时，GUID[可以存储](http://en.wikipedia.org/wiki/Globally_unique_identifier)在具有以下四个不同字段的结构中。此格式与 [UUID 标准] [8](https://www.rfc-editor.org/rfc/rfc4122)的区别仅在于前 3 个字段的字节顺序。

```
Bits  Bytes Name   Endianness  Endianness
                   (GUID)      RFC 4122

32    4     Data1  Native      Big
16    2     Data2  Native      Big
16    2     Data3  Native      Big
64    8     Data4  Big         Big 
```

* * *

## 回答 #2

> 赞同：690
> 
>             
> 
> 时间：2008-10-29T14:10:17.923

GUID 是微软对 UUID 标准的实现。

根据[维基百科](https://en.wikipedia.org/w/index.php?title=Globally_unique_identifier&oldid=760379804 "所有知识的堡垒")：

> 术语 GUID 通常是指 Microsoft 对[通用唯一标识符](http://en.wikipedia.org/wiki/Universally_unique_identifier)(UUID) 标准的实现。

来自同一篇维基百科文章的更新引用：

> RFC 4122 本身声明 UUID“也称为 GUID”。这一切都表明，“GUID”虽然最初是指微软使用的 UUID 的变体，但现在已成为 UUID 的简单替代名称……</p>

* * *

## 回答 #3

> 赞同：15
> 
>             
> 
> 时间：2008-10-29T14:10:59.327

并不真地。GUID 更以 Microsoft 为中心，而 UUID 使用更广泛（例如，在*urn:uuid:* URN 方案和 CORBA 中）。

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2012-07-05T16:26:24.293

GUID 在不一定是 128 位值的领域中长期使用，其方式与 UUID 相同。例如，[RSS 规范将 GUID 定义](http://cyber.law.harvard.edu/rss/rss.html#ltguidgtSubelementOfLtitemgt)为您选择的任何字符串，只要它是唯一的，并带有“isPermalink”属性来指定您使用的值只是返回到正在联合的项目的永久链接。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2019-04-26T23:39:16.600

SQL Server 中的 GUID 和 PostgreSQL 中的 UUID 之间的一个区别是字母大小写。SQL Server 输出较高，而 PostgreSQL 输出较低。

十六进制值“a”到“f”作为小写字符输出，输入时不区分大小写。- [rfc4122#section-3](https://www.rfc-editor.org/rfc/rfc4122#section-3)

* * *

## 回答 #6

> 赞同：-5
> 
>             
> 
> 时间：2017-12-06T15:01:26.810

Microsoft 的`GUID`文本表示形式可以是被两个花括号包围的 UUID `{}`。

# ruby-on-rails - 如何指定具有多态关联的“commentable_type”字段？

> ID：246931
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-29T14:09:38.457
> 
>         
> 
> 标签：ruby-on-rails, ruby

我有两个模型，文章和帖子，它们都继承自一个名为 ContentBase 的基本模型。

您可以在文章和帖子上发表评论，因此我在评论和文章或帖子之间使用多态关联。

然而，由于 Article 和 Post 都继承自 ContentBase，commentable_type 字段最终成为两者的“ContentBase”，并搞砸了一切。

有没有办法在 Article 和 Post 的 has_many 关系中指定 commentable_type 字段？

编辑：

“搞砸一切”我的意思是如果有 ID=1 的文章和 ID=1 的帖子，并且我添加了一个 commentable_id=1、commentable_type=ContentBase 的评论，那么该评论将同时出现在文章和帖子中。

这是代码：

```
class Article < BaseContent
  has_many :comments, :as => :commentable
end

class Post < BaseContent
  has_many :comments, :as => :commentable
end 
```

这是我的评论模型：

```
class Comment < ActiveRecord::Base
  belongs_to :commentable, :polymorphic => true
end 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T17:08:33.523

ContentBase 类中有什么？您可以将该代码移动到模块中而不是使用继承吗？

```
Module BaseContent
   def self.included(base)
      base.class_eval do
        validates_presence_of     :somefield
        validates_length_of       :someotherfield

        def my_method
          "hello"
        end
      end
   end

end 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T16:19:50.690

我不认为你想那样做。对于多态关联，您希望 XXX_type 字段是基本模型类，而不是实际类。我不确定原因，但我认为这与确定要从中选择以获取多态数据的表名有关。

我认为您需要查看 Single Table Inheritance，这是 ActiveRecord 用于在数据库中存储派生类的方法。它假定由于 Article 和 Post 是 ContentBase 的子类，它们都将在同一个表中（默认为“content_bases”）。如果是这种情况，您将永远不会拥有 ID=1 的文章和 ID=1 的帖子。

几个参考：

*   [Rails 单表继承 | 聚星科技](http://www.juixe.com/techknow/index.php/2006/06/03/rails-single-table-inheritance/) 

*   [Ruby on Rails 中的单表继承](http://wiki.rubyonrails.org/rails/pages/singletableinheritance)

# sql-server-2005 - MS SQL Server 2008 基本问题

> ID：246951
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-29T14:13:33.457
> 
>         
> 
> 标签：sql-server-2005, sql-server-2008, import, installation, migrate

您可以将 SQL Server 2005 数据库导入（或迁移）到 SQL Server 2008 吗？

是否可以在同一台机器上运行相同的 2005 和 2008 而不会出现并发症？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T14:17:42.323

是的。您可以在 SQL 2008 中从 SQL 2005 恢复备份。您还可以在同一台计算机上同时拥有这两者的实例。

编辑：这个问题已经被问过（或多或少）。[看这里](https://stackoverflow.com/questions/204212/can-an-ms-sql-2005-backup-be-restored-onto-an-instance-of-ms-sql-2008)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:17:49.313

是的，是的。

我发现从一个迁移到另一个的最快方法就是从 SQL 2005 进行备份并还原到 SQL 2008。

我在我的开发盒上并排运行，没有问题。

# c# - 智能感知中的错误 - 如何向 Microsoft 报告？

> ID：246952
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T14:13:43.657
> 
>         
> 
> 标签：c#, visual-studio-2008, ide, intellisense

我在 Visual Studio intellisense 的方法存根生成中发现了一个错误。

```
class A { }
class B : A
{
    A a;
    void f() { a.NewMethod(); }
} 
```

当我选择“生成方法存根”时`a.NewMethod()`，我应该得到一个公共方法。相反，智能感知会混淆自己并为我创建一个受保护的方法。

编译器正确地抱怨对生成`protected void NewMethod()`的 in的调用`A`。

有什么方法可以向 Microsoft 报告此问题？
[这篇文章](http://weblog.timaltman.com/archive/2006/03/22/reporting-bugs-microsoft)说这是一个不可能完成的任务。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-10-29T14:15:45.323

转到[Microsoft Connect](http://connect.microsoft.com)站点。至少他们在那里听。当然，您可能需要一段时间才能收到答案（或修复）。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T14:27:05.643

根据 Microsoft 的预期行为是

**“只有**通过派生类类型进行访问时，才能在派生类中访问基类的受保护成员。”

[http://msdn.microsoft.com/en-us/library/bcd5672a(VS.71).aspx](http://msdn.microsoft.com/en-us/library/bcd5672a(VS.71).aspx)

在您的情况下， a.NewMethod() 会产生错误，因为 A 不是从 B 派生的。这正是您所说的。

因此，“生成方法存根”命令是有缺陷的。

也就是说，使用[Microsoft Connect](http://connect.microsoft.com)进行错误报告。让我知道错误＃是什么，我会在那里投票。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T14:16:12.857

假设您的错误是错误，请在相关的 microsoft.public 新闻组中发布。他们通常反应灵敏。  

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T15:02:16.477

对不起，你是对的。我刚刚用 Resharper 的存根生成器尝试了这个，它创建了一个公共方法。

# string - 查找具有相似文本的文章的算法

> ID：246961
> 
>         
> 
> 赞同：63
> 
>         
> 
> 时间：2008-10-29T14:16:44.073
> 
>         
> 
> 标签：string, algorithm, text, language-agnostic, similarity

我在数据库中有很多文章（带有标题、文本），我正在寻找一种算法来找到 X 最相似的文章，比如当你提出问题时 Stack Overflow 的“相关问题”。

我尝试对此进行谷歌搜索，但仅找到有关其他“相似文本”问题的页面，例如将每篇文章与所有其他文章进行比较并将相似性存储在某处。SO 在我刚刚输入的文本上“实时”执行此操作。

如何？

* * *

## 回答 #1

> 赞同：34
> 
>             
> 
> 时间：2008-10-30T23:36:49.947

[编辑距离](http://en.wikipedia.org/wiki/Levenshtein_distance)不是一个可能的候选者，因为它取决于拼写/词序，并且考虑到您实际上有兴趣搜索的文档的大小和数量，它的计算成本比 Will 引导您相信的要高得多。

像Lucene这样的东西是要走的路。您索引所有文档，然后当您想要查找与给定文档相似的文档时，您将给定文档转换为查询，然后搜索索引。在内部，Lucene 将使用[tf-idf](http://en.wikipedia.org/wiki/Tf-idf)和[倒排索引](http://en.wikipedia.org/wiki/Inverted_index)来使整个过程花费的时间与可能匹配的文档数量成正比，而不是与集合中的文档总数成正比。

* * *

## 回答 #2

> 赞同：14
> 
>             
> 
> 时间：2008-10-29T14:57:35.333

这取决于您对相似的定义。

[编辑距离](http://googlesystem.blogspot.com/2007/04/simplified-version-of-googles-spell.html)算法是（拉丁语）词典建议的标准算法，可以处理整个文本。如果两个文本以相同的顺序具有基本相同的单词（eh 字母），则它们是相似的。因此，以下两篇书评将非常相似：

1）“这是一本好书”

2）“这些不是好书”

（移除、插入、删除或更改以将 (2) 变为 (1) 的字母数量称为“编辑距离”。）

要实现这一点，您需要以编程方式访问每条评论。这可能不像听起来那么昂贵，如果成本太高，您可以将比较作为后台任务进行，并将 n-most-simimiar 存储在数据库字段本身中。

另一种方法是了解（拉丁）语言的结构。如果您去除短（非大写或引用）单词，并为常见或独特的单词（或前缀）分配权重，您可以进行贝叶斯式比较。以下两个书评可能会被简化并发现是相似的：

3）“法国革命是胡说八道的战争与和平胡说八道的法国。” -> France/French(2) Revolution(1) War(1) Peace(1)

4）“这本书是法国美食的一场革命。” -> 法国(1) 革命(1)

为了实现这一点，您需要在创建/更新评论时识别评论中的“关键字”，并在查询的 where 子句中使用这些关键字查找类似的评论（理想情况下，如果数据库支持，则搜索“全文” )，也许对结果集进行后处理，以便对找到的候选人进行评分。

书籍也有分类——以法国为背景的惊悚片是否类似于法国的历史研究，等等？标题和文本之外的元数据可能有助于保持结果的相关性。

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2008-10-29T14:21:05.140

[此链接](http://www.catalysoft.com/articles/StrikeAMatch.html)上的教程听起来可能是您需要的。它很容易理解并且效果很好。

他的算法奖励公共子串和这些子串的公共排序，因此应该很好地挑选出相似的标题。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T14:21:56.027

我建议使用[Apache Lucene](http://lucene.apache.org/java/docs/)索引您的文章，*这是一个完全用 Java 编写的高性能、功能齐全的文本搜索引擎库。它是一种适用于几乎所有需要全文搜索的应用程序的技术，尤其是跨平台的应用程序*。编入索引后，您可以轻松找到相关文章。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T15:00:38.167

一种常用的算法是[自组织映射](http://en.wikipedia.org/wiki/Self-organizing_map)。它是一种神经网络，可以自动对您的文章进行分类。然后您可以简单地找到当前文章在地图中的位置以及它附近的所有文章都是相关的。该算法的重要部分是如何[对输入进行矢量量化](http://en.wikipedia.org/wiki/Vector_quantization)。有几种方法可以处理文本。您可以散列您的文档/标题，可以计算单词并将其用作 n 维向量等。希望对您有所帮助，尽管我可能已经为您打开了一个潘多拉的盒子，让您在 AI 中进行无尽的旅程。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:22:57.633

所以只对标题进行比较，而不是对问题的正文进行比较，所以只对相当短的字符串进行比较。

您可以在文章标题和关键字上使用他们的算法（不知道它是什么样子）。如果你有更多的 cpu 时间来刻录，也可以在你的文章摘要上。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:31:01.157

支持 Lucene 对全文的建议，但请注意 Java 不是必需的；[.NET 端口可用](http://incubator.apache.org/lucene.net/)。另请参阅[Lucene 主页](http://lucene.apache.org/)以获取其他项目的链接，包括[Lucy，一个 C 端口](http://lucene.apache.org/lucy/)。

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:33:42.400

也许您正在寻找的是可以[解释](http://en.wikipedia.org/wiki/Paraphrase)的东西。我对此只有粗略的了解，但释义是一种[自然语言处理](http://en.wikipedia.org/wiki/Natural_language_processing)概念，用于确定两段文本是否实际上*表示*相同的意思——尽管可能使用完全不同的词。

不幸的是，我不知道有任何工具可以让你做到这一点（尽管我有兴趣找到一个）

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T14:50:35.330

如果您正在寻找相似的词，您可以转换为 soundex 和要匹配的 soundex 词......对我有用

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2013-07-22T06:47:21.553

我尝试了一些方法，但没有一个效果很好。可能会得到这样一个相对满意的结果：首先：为所有文本的每个段落获取一个 Google SimHash 代码并将其存储在数据库中。第二：SimHash 代码的索引。第三：如上处理你要比较的文本，得到一个 SimHash 码，并通过 SimHash 索引搜索所有文本，它们之间形成一个 5-10 的汉明距离。然后将相似性与术语向量进行比较。这可能适用于大数据。

* * *

## 回答 #11

> 赞同：1
> 
>             
> 
> 时间：2016-03-11T06:29:35.210

你可以使用以下

1.  Minhash/LSH [https://en.wikipedia.org/wiki/MinHash](https://en.wikipedia.org/wiki/MinHash)

（另见：[http](http://infolab.stanford.edu/%7Eullman/mmds/book.pdf) : //infolab.stanford.edu/~ullman/mmds/book.pdf Minhash 章节），另见[http://ann-benchmarks.com/](http://ann-benchmarks.com/)了解最新技术

2.  如果您有用户与文章交互的信息（点击/喜欢/查看），则协同过滤：[https ://en.wikipedia.org/wiki/Collaborative_filtering](https://en.wikipedia.org/wiki/Collaborative_filtering)

3.  word2vec 或类似的嵌入来比较“语义”向量空间中的文章：[https ://en.wikipedia.org/wiki/Word2vec](https://en.wikipedia.org/wiki/Word2vec)

4.  潜在语义分析：[https ://en.wikipedia.org/wiki/Latent_semantic_analysis](https://en.wikipedia.org/wiki/Latent_semantic_analysis)

5.  使用 Bag-of-words 并应用一些距离度量，例如 Jaccard 系数来计算集合相似度[https://en.wikipedia.org/wiki/Jaccard_index](https://en.wikipedia.org/wiki/Jaccard_index)，[https://en.wikipedia.org/wiki/Bag-of-words_model](https://en.wikipedia.org/wiki/Bag-of-words_model)

* * *

## 回答 #12

> 赞同：1
> 
>             
> 
> 时间：2017-02-27T09:44:17.163

@alex77 答案中的链接指向该文章作者独立发现的[Sorensen-Dice 系数](https://en.wikipedia.org/wiki/S%C3%B8rensen%E2%80%93Dice_coefficient)- 这篇文章写得很好，值得一读。

我最终根据自己的需要使用了这个系数。但是，原始系数在处理时可能会产生错误的结果

*   包含一个拼写错误的三个字母单词对，例如`[and,amd]`和

*   三个字母词对，它们是字谜，例如`[and,dan]`

在第一种情况下，Dice 错误地报告系数为零，而在第二种情况下，系数变为 0.5，这是误导性的高。

[已经提出](https://books.google.lu/books?id=K0QwCgAAQBAJ&pg=PA185&lpg=PA185&dq=dice%20coefficient%20improvement&source=bl&ots=JOnDKshZhh&sig=ToDCsu3h2NKGkqxgQlMkQyBCRhc&hl=en&sa=X&sqi=2&ved=0ahUKEwjU0NDV9q_SAhUfOsAKHfTaDrEQ6AEIKDAB#v=onepage&q=dice%20coefficient%20improvement&f=false)了一种改进，其本质上包括取单词的第一个和最后一个字符并创建一个额外的二元组。

在我看来，只有 3 个字母的单词才真正需要改进——在更长的单词中，其他二元组具有掩盖问题的缓冲效果。下面给出了我实现此改进的代码。

```
function wordPairCount(word)
{
 var i,rslt = [],len = word.length - 1;
 for(i=0;i < len;i++) rslt.push(word.substr(i,2));
 if (2 == len) rslt.push(word[0] + word[len]);
 return rslt;
}

function pairCount(arr)
{
 var i,rslt = [];
 arr = arr.toLowerCase().split(' ');
 for(i=0;i < arr.length;i++) rslt = rslt.concat(wordPairCount(arr[i]));
 return rslt;
}

function commonCount(a,b)
{
 var t;
 if (b.length > a.length) t = b, b = a, a = t; 
 t = a.filter(function (e){return b.indexOf(e) > -1;});
 return t.length;
}

function myDice(a,b)
{
 var bigrams = [],
 aPairs = pairCount(a),
 bPairs = pairCount(b);
 debugger;
 var isct = commonCount(aPairs,bPairs);
 return 2*commonCount(aPairs,bPairs)/(aPairs.length + bPairs.length); 
}

$('#rslt1').text(myDice('WEB Applications','PHP Web Application'));
$('#rslt2').text(myDice('And','Dan'));
$('#rslt3').text(myDice('and','aMd'));
$('#rslt4').text(myDice('abracadabra','abracabadra'));
```

```
*{font-family:arial;}
table
{
 width:80%;
 margin:auto;
 border:1px solid silver;
}

thead > tr > td
{
 font-weight:bold;
 text-align:center;
 background-color:aqua;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
<table>
<thead>
<tr>
<td>Phrase 1</td>
<td>Phrase 2</td>
<td>Dice</td>
</tr>
<thead>
<tbody>
<tr>
<td>WEB Applications</td>
<td>PHP Web Application</td>
<td id='rslt1'></td>
</tr>
<tr>
<td>And</td>
<td>Dan</td>
<td id='rslt2'></td>
</tr>
<tr>
<td>and</td>
<td>aMd</td>
<td id='rslt3'></td>
</tr>
<tr>
<td>abracadabra</td>
<td>abracabadra</td>
<td id='rslt4'></td>
</tr>
</tbody>
</table>
```

请注意最后一个示例中的故意拼写错误： abraca **dabra** vs abraca **badra**。即使没有应用额外的二元校正，报告的系数也是 0.9。修正后应该是 0.91。

* * *

## 回答 #13

> 赞同：1
> 
>             
> 
> 时间：2018-09-03T15:51:26.607

给定一个示例文本，该程序列出了按相似度排序的存储库文本：[C++ 中词袋的简单实现](https://github.com/srogatch/TextMatching)。该算法在样本文本和存储库文本的总长度上是线性的。此外，该程序是多线程的，可以并行处理存储库文本。

下面是核心算法：

```
class Statistics {
  std::unordered_map<std::string, int64_t> _counts;
  int64_t _totWords;

  void process(std::string& token);
public:
  explicit Statistics(const std::string& text);

  double Dist(const Statistics& fellow) const;

  bool IsEmpty() const { return _totWords == 0; }
};

namespace {
  const std::string gPunctStr = ".,;:!?";
  const std::unordered_set<char> gPunctSet(gPunctStr.begin(), gPunctStr.end());
}

Statistics::Statistics(const std::string& text) {
  std::string lastToken;
  for (size_t i = 0; i < text.size(); i++) {
    int ch = static_cast<uint8_t>(text[i]);
    if (!isspace(ch)) {
      lastToken.push_back(tolower(ch));
      continue;
    }
    process(lastToken);
  }
  process(lastToken);
}

void Statistics::process(std::string& token) {
  do {
    if (token.size() == 0) {
      break;
    }
    if (gPunctSet.find(token.back()) != gPunctSet.end()) {
      token.pop_back();
    }
  } while (false);
  if (token.size() != 0) {
    auto it = _counts.find(token);
    if (it == _counts.end()) {
      _counts.emplace(token, 1);
    }
    else {
      it->second++;
    }
    _totWords++;
    token.clear();
  }
}

double Statistics::Dist(const Statistics& fellow) const {
  double sum = 0;
  for (const auto& wordInfo : _counts) {
    const std::string wordText = wordInfo.first;
    const double freq = double(wordInfo.second) / _totWords;
    auto it = fellow._counts.find(wordText);
    double fellowFreq;
    if (it == fellow._counts.end()) {
      fellowFreq = 0;
    }
    else {
      fellowFreq = double(it->second) / fellow._totWords;
    }
    const double d = freq - fellowFreq;
    sum += d * d;
  }
  return std::sqrt(sum);
} 
```

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:19:54.520

您可以使用 SQL Server 全文索引来进行智能比较，我相信 SO 正在使用 ajax 调用，它执行查询以返回类似的问题。

您正在使用哪些技术？

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2015-04-18T20:04:57.463

比较摘要之间相似性的最简单和最快的方法可能是利用集合概念。首先将抽象文本转换为一组单词。然后检查每组有多少重叠。Python 的 set 功能非常适合执行此任务。您会惊讶地发现这种方法与 GScholar、ADS、WOS 或 Scopus 提供的那些“相似/相关论文”选项相比有多好。

# dependency-injection - 实用单例和依赖注入问题

> ID：246963
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2008-10-29T14:17:20.047
> 
>         
> 
> 标签：dependency-injection, singleton

假设我有一个名为 PermissionManager 的类，它在我的系统中应该只存在一次，并且基本上实现了为我的应用程序中的各种操作管理各种权限的功能。现在我的应用程序中有一些类需要能够在其方法之一中检查某个权限。此类的构造函数目前是公开的，即由 API 用户使用。

直到几周前，我才会让我的班级在某处调用以下伪代码：

```
 PermissionManager.getInstance().isReadPermissionEnabled(this) 
```

但是由于我注意到这里的每个人都讨厌单例+这种耦合，所以我想知道更好的解决方案是什么，因为我读到的反对单例的论点似乎是有道理的（不可测试，高耦合等）。

那么我真的应该要求 API 用户在类的构造函数中传入一个 PermissionManager 实例吗？即使我只希望我的应用程序存在一个 PermissionManager 实例？

还是我要解决这一切都错了，应该有一个非公共构造函数和一个工厂在某个地方为我传递 PermissionManager 的实例？

* * *

**附加信息**请注意，当我说“依赖注入”时，我指的是 DI[模式](http://en.wikipedia.org/wiki/Dependency_injection)……我没有使用任何 DI 框架，例如 Guice 或 Spring。（...然而）

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T14:41:58.797

如果您使用的是依赖注入框架，则处理此问题的常用方法是在构造函数中传入 PermissionsManager 对象，或者拥有框架为您设置的 PermissionsManager 类型的属性。  

如果这不可行，那么让用户通过工厂获取此类的实例是一个不错的选择。在这种情况下，工厂在创建类时将 PermissionManager 传递给构造函数。在您的应用程序启动时，您将首先创建单个 PermissionManager，然后创建您的工厂，传入 PermissionManager。

您是正确的，类的客户通常很难知道在哪里找到正确的 PermissionManager 实例并将其传递（甚至关心您的类使用 PermissionManager 的事实）。

我见过的一种折衷解决方案是给你的类一个 PermissionManager 类型的属性。如果已设置属性（例如，在单元测试中），则使用该实例，否则使用单例。就像是：

```
PermissionManager mManager = null;
public PermissionManager Permissions
{
  if (mManager == null)
  {
    return mManager;
  }
  return PermissionManager.getInstance();
} 
```

当然，严格来说，您的 PermissionManager 应该实现某种 IPermissionManager 接口，**这**就是您的其他类应该引用的，以便在测试期间可以更轻松地替换虚拟实现。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:44:31.147

您确实可以从注入 PermissionManager 开始。这将使您的课程更具可测试性。

如果这会给该类的用户带来问题，您可以让他们使用工厂方法或抽象工厂。或者，您可以添加一个无参数构造函数，让他们调用该构造函数来注入 PermissionManager，而您的测试使用另一个构造函数，您可以使用该构造函数来模拟 PermissionManager。

更多地解耦你的类会让你的类更灵活，但也会让它们更难使用。这取决于你需要什么的情况。如果您只有一个 PermissionManager 并且测试使用它的类没有问题，那么没有理由使用 DI。如果您希望人们能够添加他们自己的 PermissionManager 实现，那么 DI 就是要走的路。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:49:30.997

如果您订阅了依赖注入的做事方式，那么无论您需要什么类，都`PermissionManager`应该将其作为对象实例注入。控制其实例化（以强制执行单例性质）的机制在更高级别上工作。如果你使用像 Guice 这样的依赖注入框架，它可以完成强制工作。如果您手动进行对象连接，则依赖注入倾向于将执行实例化（新操作员工作）的代码分组，使其远离您的业务逻辑。

然而，无论哪种方式，经典的“capital-S” Singleton 通常被视为依赖注入上下文中的反模式。

这些帖子过去对我很有见地：

*   [使用依赖注入来避免单例](http://googletesting.blogspot.com/2008/05/tott-using-dependancy-injection-to.html)

*   [如何考虑单元测试的“新”操作符](http://googletesting.blogspot.com/2008/07/how-to-think-about-new-operator-with.html)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T15:00:56.667

> 那么我真的应该要求 API 用户在类的构造函数中传入一个 PermissionManager 实例吗？即使我只希望我的应用程序存在一个 PermissionManager 实例？

是的，这就是您需要做的所有事情。依赖项是单例/每个请求/每个线程还是工厂方法是您的容器和配置的责任。在 .net 世界中，理想情况下，我们会依赖 IPermissionsManager 接口来进一步减少耦合，我认为这也是 Java 中的最佳实践。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:22:41.783

单例模式本身并不坏，丑陋的是它的常用方式，因为它只需要某个类的单个实例，我认为这是一个很大的错误。

在这种情况下，我会将 PermissionManager 设为静态类，除非出于任何原因您需要它成为可实例化的类型。

# javascript - 从 document.forms[x].elements 中的 DOM 中省略图像输入是否正常？

> ID：246966
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-29T14:17:47.190
> 
>         
> 
> 标签：javascript, html, dom, forms, input

我发现在这样的 HTML 页面中给出了一个表单：

```
<form name="form">
   <input type="image" name="foo" 
          src="somewhere.gif" alt="image" value="blah"/>
   <input type="text" name="bar" value="blah"/>
</form> 
```

在 Javascript 中通过 DOM 访问元素时，*没有*用于图像输入的元素！它只是被省略了。所以，`document.forms[0].elements.length`是 1，`document.forms[0].element[0].type`是“文本”。

在 Firefox 和 IE 中似乎就是这种情况。我在我的参考书或网络上的任何地方都找不到这个事实。我只能在这里找到一个一次性评论：

[https://bugzilla.mozilla.org/show_bug.cgi?id=163822#c4](https://bugzilla.mozilla.org/show_bug.cgi?id=163822#c4)

这表明它“就是这样”。如果是这样，那就这样吧 - 但它*真的*没有任何地方记录吗？这是一个历史错误，还是有原因的？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:27:34.520

看起来这是`elements`所有浏览器中该属性的行为。

但是，您仍然应该能够使用该`childNodes`属性通过 JavaScript 中的 DOM 访问它。

对于您的示例：

```
document.forms[0].childNodes.length; // equals 5 (2 inputs and 3 text nodes).
document.forms[0].childNodes[1];     // This is your input with type='image' 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T17:56:18.670

确实，我看到了一条评论：“ *DOM 应该以这种方式工作，这就是它在 Mozilla、NS4x 和 IE 中的工作方式。即使我们愿意，我们也无法改变它，很多网站都会崩溃。* ”所以我会倾向于历史错误。图像元素已经在 HTML 2 DTD 中...

也许这就是作者不鼓励使用像 getElement[s]ByXxx 函数（或 XPath！）这样的 Dom 层次结构的其他罪魁祸首。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:36:44.733

有趣... [DOM 1](http://www.w3.org/TR/1998/REC-DOM-Level-1-19981001/level-one-html.html)规范定义`.elements`为：

> elements 返回表单中所有控制元素的集合。

[HTML 4](http://www.w3.org/TR/REC-html40/interact/forms.html#input-control-types)规范部分 17.2.1 没有列出“图像”类型，所以我想这就是答案。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T18:02:22.527

我自己也被它咬过。它[在 MSDN DHTML docs 中有说明](http://msdn.microsoft.com/en-us/library/ie/hh826022(v=vs.85).aspx)。

# delphi - 是否可以声明一个包含另一个常量数组的常量数组？

> ID：246969
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T14:19:27.173
> 
>         
> 
> 标签：delphi

我想做这样的事情：

```
const

  MyFirstConstArray: array[0..1] of string = ('Hi', 'Foo');
  MySecondConstArrayWhichIncludesTheFirstOne: array[0..2] of string = 
    MyFirstConstArray + ('Bar'); 
```

基本上我想要以下结果：

```
MyFirstConstArray -> ('Hi', 'Foo');
MySecondConstArrayWhichIncludesTheFirstOne -> ('Hi', 'Foo', 'Bar'); 
```

有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T17:09:25.690

AFAIK，你不能那样做。

但是，如果目标是确保您只声明一次实际的常量字符串，我建议您声明单个字符串，然后将它们分组到数组中：  

```
const
  MyConst1 = 'Hi';
  MyConst2 = 'Foo';
  MyConst3 = 'Bar';
  MyFirstConstArray: array[0..1] of string = (MyConst1, MyConst2);
  MySecondConstArrayWhichIncludesTheFirstOne: array[0..2] of string = 
    (MyConst1, MyConst2, MyConst3); 
```

顺便说一句，你的语法不正确，你必须精确数组元素的类型。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T17:24:17.157

实际上，您可以使用记录来做到这一点。我大量使用这种技术来为我的软件中实体的某些行为创建定义。这是一个非常强大的技术：

```
type
      TPerson=record
        // generally you'd put all kinds of addition stuff here including enums, 
        // sets, etc
        saPets:array[0..2] of string;
      end;

const
  scDog='Dog';

  MyPeople:array[0..1] of TPerson=
    ((saPets:(scDog, 'Cat', 'Fish'); ),
     (saPets:('Iguana', 'Tarantula', ''); ));

begin
  ShowMessage(MyPeople[0].saPets[0]);

end; 
```

你不能用它做的一件事是引用资源字符串。因此，任何翻译都必须由检索该值的代码完成。我通常用枚举索引它们——这样做，我可以使软件更容易改变，因为如果我遗漏了一些重要的东西，它就不会编译。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-31T22:04:47.587

如果顺序不相关，则使用枚举集。

```
type
  TMyConsts = (tConstFoo, tConstHi, TConstBar);
const
  MyFirstConstSet = [tConstFoo, tConstHi];
  MySecondConstSet = MyFirstConstSet + [TConstBar];
  MyConstStrings: array[TMyConsts] of string = ('Foo', 'Hi', 'Bar'); 
```

如果需要，可以使用*MyConstStrings*数组将枚举解析为字符串。取决于你的目标。  

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:44:33.580

我不这么认为。您必须在代码中执行此操作。如果这些是全局常量，您可以在单元的“初始化”部分进行初始化。

# c - 在 C 中使用灵活的数组成员是不好的做法吗？

> ID：246977
> 
>         
> 
> 赞同：79
> 
>         
> 
> 时间：2008-10-29T14:21:17.853
> 
>         
> 
> 标签：c, arrays, data-structures, flexible-array-member

我最近读到在 C 中使用灵活的数组成员是糟糕的软件工程实践。但是，该声明没有得到任何论据的支持。这是公认的事实吗？

（[灵活的数组成员](https://en.wikipedia.org/wiki/Flexible_array_member)是 C99 中引入的一项 C 功能，可以将最后一个元素声明为未指定大小的数组。例如：）

```
struct header {
    size_t len;
    unsigned char data[];
}; 
```

* * *

## 回答 #1

> 赞同：35
> 
>             
> 
> 时间：2008-10-29T14:36:16.217

使用 goto 是一种糟糕的软件工程实践，这是一个公认的“事实”。这并不成立。有时 goto 很有用，特别是在处理清理和从汇编程序移植时。

灵活的数组成员让我印象深刻，因为它有一个主要用途，在我的脑海中，它是映射遗留数据格式，如 RiscOS 上的窗口模板格式。大约 15 年前，它们在这方面会非常有用，而且我敢肯定仍然有人在处理这些事情时会发现它们很有用。

如果使用灵活的数组成员是不好的做法，那么我建议我们都去告诉 C99 规范的作者。我怀疑他们可能有不同的答案。

* * *

## 回答 #2

> 赞同：19
> 
>             
> 
> 时间：2008-10-29T14:36:18.963

**请仔细阅读此答案下方的评论**

*随着 C 标准化向前发展，没有理由再使用 [1]。*

我之所以不这样做，是因为为了使用此功能而将您的代码绑定到 C99 是不值得的。

关键是您始终可以使用以下成语：

```
struct header {
  size_t len;
  unsigned char data[1];
}; 
```

那是完全便携的。然后，您可以在为数组中的 n 个元素分配内存时将 1 考虑在内`data`：

```
ptr = malloc(sizeof(struct header) + (n-1)); 
```

如果您出于任何其他原因已经将 C99 作为构建代码的要求，或者您的目标是特定的编译器，我认为没有什么坏处。

* * *

## 回答 #3

> 赞同：17
> 
>             
> 
> 时间：2017-09-16T08:37:31.417

不，在 C 中使用[灵活的数组成员](https://en.wikipedia.org/wiki/Flexible_array_member)并不是一个坏习惯。

此语言功能首先在 ISO C99 6.7.2.1 (16) 中标准化。在随后的修订版 ISO C11 中，它在第 6.7.2.1 (18) 节中指定。

你可以像这样使用它们：

```
struct Header {
    size_t d;
    long v[];
};
typedef struct Header Header;
size_t n = 123; // can dynamically change during program execution
// ...
Header *h = malloc(sizeof(Header) + sizeof(long[n]));
h->n = n; 
```

或者，您可以像这样分配：

```
Header *h = malloc(sizeof *h + n * sizeof h->v[0]); 
```

请注意，这`sizeof(Header)`包括最终的填充字节，因此，以下分配不正确，可能会产生缓冲区溢出：

```
Header *h = malloc(sizeof(size_t) + sizeof(long[n])); // invalid! 
```

具有灵活数组成员的结构将为其分配的数量减少了 1/2，即您只需要 1 个结构对象而不是 2 个分配。这意味着更少的工作量和更少的内存分配器簿记开销占用的内存。此外，您可以为一个额外的指针节省存储空间。因此，如果您必须分配大量此类结构实例，则可以显着提高程序的运行时和内存使用率（通过一个常数因子）。

与此相反，对产生未定义行为（例如 in`long v[0];`或`long v[1];`）的灵活数组成员使用非标准化构造显然是不好的做法。因此，作为任何未定义的行为，应该避免这种情况。

自从 ISO C99 于 1999 年发布，也就是 20 多年前，争取 ISO C89 兼容性是一个软弱的论据。

* * *

## 回答 #4

> 赞同：11
> 
>             
> 
> 时间：2008-10-29T14:36:12.350

你的意思是...

```
struct header
{
 size_t len;
 unsigned char data[];
}; 
```

在 C 中，这是一个常见的习惯用法。我认为许多编译器也接受：

```
 unsigned char data[0]; 
```

是的，这很危险，但话又说回来，它实际上并不比普通的 C 数组更危险 - 即，非常危险 ;-) 。小心使用它，并且仅在您真正需要未知大小的数组的情况下使用。确保你 malloc 并正确释放内存，使用类似的东西： -

```
 foo = malloc(sizeof(header) + N * sizeof(data[0]));
  foo->len = N; 
```

另一种方法是使数据只是指向元素的指针。然后，您可以根据需要将数据重新分配到正确的大小。

```
 struct header
    {
     size_t len;
     unsigned char *data;
    }; 
```

当然，如果你问的是 C++，这些都是不好的做法。然后，您通常会改用 STL 向量。

* * *

## 回答 #5

> 赞同：6
> 
>             
> 
> 时间：2010-06-01T09:30:56.123

我见过这样的事情：来自 C 接口和实现。

```
 struct header {
    size_t len;
    unsigned char *data;
};

   struct header *p;
   p = malloc(sizeof(*p) + len + 1 );
   p->data = (unsigned char*) (p + 1 );  // memory after p is mine! 
```

注意：数据不必是最后一个成员。

* * *

## 回答 #6

> 赞同：5
> 
>             
> 
> 时间：2009-05-20T14:26:34.297

附带说明一下，为了 C89 兼容性，应该像这样分配这样的结构：

```
struct header *my_header
  = malloc(offsetof(struct header, data) + n * sizeof my_header->data); 
```

或使用宏：

```
#define FLEXIBLE_SIZE SIZE_MAX /* or whatever maximum length for an array */
#define SIZEOF_FLEXIBLE(type, member, length) \
  ( offsetof(type, member) + (length) * sizeof ((type *)0)->member[0] )

struct header {
  size_t len;
  unsigned char data[FLEXIBLE_SIZE];
};

...

size_t n = 123;
struct header *my_header = malloc(SIZEOF_FLEXIBLE(struct header, data, n)); 
```

将 FLEXIBLE_SIZE 设置为 SIZE_MAX 几乎可以确保这将失败：

```
struct header *my_header = malloc(sizeof *my_header); 
```

* * *

## 回答 #7

> 赞同：5
> 
>             
> 
> 时间：2014-03-03T09:31:38.467

有时如何使用结构有一些缺点，如果您不考虑其中的含义，可能会很危险。

对于您的示例，如果您启动一个函数：

```
void test(void) {
  struct header;
  char *p = &header.data[0];

  ...
} 
```

然后结果是未定义的（因为没有为数据分配存储空间）。您通常会意识到这一点，但在某些情况下，C 程序员可能习惯于对结构使用值语义，这会以各种其他方式分解。

例如，如果我定义：

```
struct header2 {
  int len;
  char data[MAXLEN]; /* MAXLEN some appropriately large number */
} 
```

然后我可以简单地通过赋值复制两个实例，即：

```
struct header2 inst1 = inst2; 
```

或者如果它们被定义为指针：

```
struct header2 *inst1 = *inst2; 
```

但是，这不适用于灵活的数组成员，因为它们的内容不会被复制。您想要的是动态地分配结构的大小并使用`memcpy`或等效复制数组。

```
struct header3 {
  int len;
  char data[]; /* flexible array member */
} 
```

同样，编写一个接受 a 的函数也`struct header3`行不通，因为函数调用中的参数再次按值复制，因此您将获得的可能只是灵活数组成员的第一个元素。

```
 void not_good ( struct header3 ) ; 
```

使用这并不是一个坏主意，但您必须牢记始终动态分配这些结构并仅将它们作为指针传递。

```
 void good ( struct header3 * ) ; 
```

# c# - 正如进程监视器所观察到的，写入 FileStream 的行为很奇怪

> ID：246979
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-10-29T14:21:41.503
> 
>         
> 
> 标签：c#, .net, file-io, filestream, procmon

我正在使用 FileStream 写入文件，并使用[Process Monitor](http://live.sysinternals.com/procmon.exe)观察底层系统调用。我在生产部署中遇到了一些文件锁定问题，因此我正在仔细查看细节。

此示例代码：

```
 using (FileStream fs = new FileStream("c:\\temp\\test.txt", FileMode.Create, FileAccess.Write, FileShare.Read))
        {
            fs.Write(new byte[] { 1, 2, 3, 4, 5 }, 0, 5);
            fs.Close();
        } 
```

导致以下系统调用：

```
9:27:09.4561092 AM  ConsoleApplication1.vshost.exe  2320    CreateFile  C:\temp\test.txt    SUCCESS Desired Access: Generic Read/Write, Disposition: OverwriteIf, Options: Synchronous IO Non-Alert, Non-Directory File, Open No Recall, Attributes: n/a, ShareMode: Read, AllocationSize: 0, OpenResult: Overwritten
9:27:12.2217409 AM  ConsoleApplication1.vshost.exe  2320    WriteFile   C:\temp\test.txt    SUCCESS Offset: 0, Length: 5
9:27:12.2219901 AM  ConsoleApplication1.vshost.exe  2320    CloseFile   C:\temp\test.txt    SUCCESS 
9:27:12.2234484 AM  ConsoleApplication1.vshost.exe  2320    CreateFile  C:\temp\test.txt    SUCCESS Desired Access: Generic Read, Write Attributes, Disposition: Open, Options: Synchronous IO Non-Alert, Non-Directory File, Complete If Oplocked, Random Access, Attributes: N, ShareMode: Read, Write, Delete, AllocationSize: n/a, OpenResult: Opened
9:27:12.2248664 AM  ConsoleApplication1.vshost.exe  2320    QueryBasicInformationFile   C:\temp\test.txt    SUCCESS CreationTime: 10/29/2008 9:04:14 AM, LastAccessTime: 10/29/2008 9:27:12 AM, LastWriteTime: 10/29/2008 9:27:12 AM, ChangeTime: 10/29/2008 9:27:12 AM, FileAttributes: A
9:27:12.2250075 AM  ConsoleApplication1.vshost.exe  2320    SetBasicInformationFile C:\temp\test.txt    SUCCESS CreationTime: -1, LastAccessTime: -1, LastWriteTime: -1, ChangeTime: -1, FileAttributes: n/a
9:27:12.2255889 AM  ConsoleApplication1.vshost.exe  2320    QueryStandardInformationFile    C:\temp\test.txt    SUCCESS AllocationSize: 8, EndOfFile: 5, NumberOfLinks: 1, DeletePending: False, Directory: False
9:27:12.2257571 AM  ConsoleApplication1.vshost.exe  2320    ReadFile    C:\temp\test.txt    SUCCESS Offset: 0, Length: 5
9:27:12.2259825 AM  ConsoleApplication1.vshost.exe  2320    ReadFile    C:\temp\test.txt    SUCCESS Offset: 0, Length: 5
9:27:12.2261588 AM  ConsoleApplication1.vshost.exe  2320    ReadFile    C:\temp\test.txt    SUCCESS Offset: 0, Length: 5
9:27:12.2265161 AM  ConsoleApplication1.vshost.exe  2320    ReadFile    C:\temp\test.txt    SUCCESS Offset: 0, Length: 2
9:27:12.2268237 AM  ConsoleApplication1.vshost.exe  2320    ReadFile    C:\temp\test.txt    SUCCESS Offset: 0, Length: 5
9:27:12.2271332 AM  ConsoleApplication1.vshost.exe  2320    ReadFile    C:\temp\test.txt    SUCCESS Offset: 0, Length: 5
9:27:12.2272841 AM  ConsoleApplication1.vshost.exe  2320    ReadFile    C:\temp\test.txt    SUCCESS Offset: 0, Length: 5
9:27:12.2274779 AM  ConsoleApplication1.vshost.exe  2320    ReadFile    C:\temp\test.txt    SUCCESS Offset: 0, Length: 5
9:27:12.2276249 AM  ConsoleApplication1.vshost.exe  2320    ReadFile    C:\temp\test.txt    SUCCESS Offset: 0, Length: 5
9:27:12.2278766 AM  ConsoleApplication1.vshost.exe  2320    ReadFile    C:\temp\test.txt    SUCCESS Offset: 0, Length: 5
9:27:12.2282577 AM  ConsoleApplication1.vshost.exe  2320    ReadFile    C:\temp\test.txt    SUCCESS Offset: 0, Length: 5
9:27:12.2284476 AM  ConsoleApplication1.vshost.exe  2320    QueryFileInternalInformationFile    C:\temp\test.txt    SUCCESS IndexNumber: 0x2d000000016b88
9:27:12.2286183 AM  ConsoleApplication1.vshost.exe  2320    CloseFile   C:\temp\test.txt    SUCCESS 
9:27:12.2288759 AM  ConsoleApplication1.vshost.exe  2320    CreateFile  C:\temp\test.txt    SUCCESS Desired Access: Read Attributes, Write Attributes, Disposition: Open, Options: , Attributes: n/a, ShareMode: Read, Write, Delete, AllocationSize: n/a, OpenResult: Opened
9:27:12.2305722 AM  ConsoleApplication1.vshost.exe  2320    QueryBasicInformationFile   C:\temp\test.txt    SUCCESS CreationTime: 10/29/2008 9:04:14 AM, LastAccessTime: 10/29/2008 9:27:12 AM, LastWriteTime: 10/29/2008 9:27:12 AM, ChangeTime: 10/29/2008 9:27:12 AM, FileAttributes: A
9:27:12.2307379 AM  ConsoleApplication1.vshost.exe  2320    CloseFile   C:\temp\test.txt    SUCCESS 
```

前三个 IO 调用是预期的（创建、写入、关闭），但该过程继续读取文件十几次并反复打开和关闭它。

我现在在 Win XP SP2 和 Win 2003 x64 上观察到了这种行为。但是，我家中的 Windows Vista 机器的行为与预期一样（仅前三行）。

关于为什么在非 Vista 运行时发生这种情况的任何线索？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-10-29T14:26:23.053

一种可能性是您安装了病毒扫描程序，将自身注入到每个正在运行的进程中？

# sql - 这个创建表语句有什么问题

> ID：246981
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2008-10-29T14:21:52.877
> 
>         
> 
> 标签：sql, mysql, database

有谁知道这个mysql的create语句有什么问题？  

编辑：现在它指出错误已接近：在第 4 行修改了 VARCHAR(20), paypal_accept TINYINT, pre_terminat'

感谢大家的帮助

使用 sql 美化器后仍然报错

```
CREATE TABLE AUCTIONS (
  ARTICLE_NO      VARCHAR(20),
  ARTICLE_NAME    VARCHAR(100),
  SUBTITLE        VARCHAR(20),
  CURRENT_BID     VARCHAR(20),
  START_PRICE     VARCHAR(20),
  BID_COUNT       VARCHAR(20),
  QUANT_TOTAL     VARCHAR(20),
  QUANT_SOLD      VARCHAR(20),
  START           DATETIME,
  ENDS            DATETIME,
  ORIGIN_END      DATETIME,
  SELLER_ID       VARCHAR(20),
  BEST_BIDDER_ID  VARCHAR(20),
  FINISHED        VARCHAR(20),
  WATCH           VARCHAR(20),
  BUYITNOW_PRICE  VARCHAR(20),
  PIC_URL         VARCHAR(20),
  PRIVATE_AUCTION VARCHAR(20),
  AUCTION_TYPE    VARCHAR(20),
  INSERT_DATE     DATETIME,
  UPDATE_DATE     DATETIME,
  CAT_1_ID        VARCHAR(20),
  CAT_2_ID        VARCHAR(20),
  ARTICLE_DESC    VARCHAR(20),
  DESC_TEXTONLY   VARCHAR(20),
  COUNTRYCODE     VARCHAR(20),
  LOCATION        VARCHAR(20),
  CONDITION       VARCHAR(20),
  REVISED         VARCHAR(20),
  PAYPAL_ACCEPT   TINYINT,
  PRE_TERMINATED  VARCHAR(20),
  SHIPPING_TO     VARCHAR(20),
  FEE_INSERTION   VARCHAR(20),
  FEE_FINAL       VARCHAR(20),
  FEE_LISTING     VARCHAR(20),
  PIC_XXL         TINYINT,
  PIC_DIASHOW     TINYINT,
  PIC_COUNT       VARCHAR(20),
  ITEM_SITE_ID    VARCHAR(20),
    PRIMARY KEY ( `ARTICLE_NO` )); 
```

错误现在位于第 29 行的“CONDITION VARCHAR(20), REVISED VARCHAR(20), PAYPAL_ACCEPT TI”附近

实在看不出有什么问题，TINYINT需要参数吗？

MYSQL 列名必须大写吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-29T14:26:22.133

```
watch VARCHAR(20),  **????** VARCHAR(20), 
auction_type VARCHAR(20), 
```

在 watch 和auction_type 之间，您错过了一个列名。只有 varchar(20) 存在，要么删除它，要么添加缺少的列名。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2008-10-29T14:46:28.273

从最后：

> `pic_count VARCHAR(20),item_site_id);`

`item_site_id`好像没有类型。给它一个类型，你的查询就会验证......

（在这里测试它：[http](http://www.wangz.net/cgi-bin/pp/gsqlparser/sqlpp/sqlformat.tpl) ://www.wangz.net/cgi-bin/pp/gsqlparser/sqlpp/sqlformat.tpl用于查找这些类型的错误）

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T15:19:23.807

我相信列名“START”和“CONDITION”是 MySQL 中的“特殊”词？我所做的只是将美化后的代码粘贴到查询浏览器中，并注意到一些列名是“蓝色”...：P

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2008-10-29T15:59:28.577

根据 MySQL 保留字列表检查您的列名：

[http://dev.mysql.com/doc/refman/5.0/en/reserved-words.html](http://dev.mysql.com/doc/refman/5.0/en/reserved-words.html)

你会看到这`CONDITION`是一个保留字。您可以将 MySQL 保留字用于列名，但您必须将它们括在反引号中，以清楚地告诉 MySQL 您没有在其常规用法中使用该词。

```
. . .
LOCATION    VARCHAR(20),
`CONDITION` VARCHAR(20),
REVISED     VARCHAR(20),
. . . 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:52:35.967

格式化。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T14:57:39.060

提示：**格式化代码以提高可读性**。

我采用您的代码并应用简单的格式...

```
CREATE TABLE auctions (
  article_no        VARCHAR(20),
  article_name      VARCHAR(100),
  subtitle          VARCHAR(20),
  current_bid       VARCHAR(20),
  start_price       VARCHAR(20),
  bid_count         VARCHAR(20),
  quant_total       VARCHAR(20),
  quant_sold        VARCHAR(20),
  start             DATETIME,
  ends              DATETIME,
  origin_end        DATETIME,
  seller_id         VARCHAR(20),
  best_bidder_id    VARCHAR(20),
  finished          VARCHAR(20),
  watch             VARCHAR(20),
  buyitnow_price    VARCHAR(20),
  pic_url           VARCHAR(20),
  private_auction   VARCHAR(20),
  auction_type      VARCHAR(20),
  insert_date       DATETIME,
  update_date       DATETIME,
  cat_1_id          VARCHAR(20),
  cat_2_id          VARCHAR(20),
  article_desc      VARCHAR(20),
  desc_textonly     VARCHAR(20),
  countrycode       VARCHAR(20),
  location          VARCHAR(20),
  condition         VARCHAR(20),
  revised           VARCHAR(20),
  paypal_accept     TINYINT,
  pre_terminated    VARCHAR(20),
  shipping_to       VARCHAR(20),
  fee_insertion     VARCHAR(20),
  fee_final         VARCHAR(20),
  fee_listing       VARCHAR(20),
  pic_xxl           TINYINT,
  pic_diashow       TINYINT,
  pic_count         VARCHAR(20),
  item_site_id
); 
```

...我马上就可以看到**item_site_id**缺少数据类型。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T15:55:09.803

根据[MySQL 保留关键字](http://dev.mysql.com/doc/mysqld-version-reference/en/mysqld-version-reference-reservedwords-5-0.html)列表，`CONDITION`是一个保留关键字，您必须将其转义（使用反引号）才能将其用作对象的名称（例如表、列等）。

我建议不要使用保留关键字作为列的名称（即使您将其转义），因为这会在将来编写查询时导致各种问题。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T14:25:04.040

“VARCHAR(20)”没有指定名称。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-10-29T14:44:29.307

关于缺少的字段名称的答案是正确的（如果我有代表会投票），但我也建议在“cat_2_id VARCHAR(20)”之后放置以下行：

```
PRIMARY KEY (`article_no`) 
```

# sql - Informix：如何获取最后插入记录的 id

> ID：246983
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-29T14:22:09.820
> 
>         
> 
> 标签：sql, informix, identity

在 INSERT 语句之后获取 SERIAL 列的值的最有效方法是什么？即我正在寻找一种复制MS SQL`@@IDENTITY`或功能的方法`SCOPE_IDENTITY`

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2008-10-31T02:11:11.540

最后一个 SERIAL 插入的值存储在 SQLCA 记录中，作为 sqlerrd 数组中的第二个条目。Brian 的回答对于 ESQL/C 是正确的，但是您没有提到您使用的是什么语言。

如果您正在编写存储过程，则可以找到该值：

```
LET new_id = DBINFO('sqlca.sqlerrd1'); 
```

`$sth->{ix_sqlerrd}[1]`如果使用 DBI ，也可以在

有其他语言/界面的变体，但我相信你会明白的。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-29T15:06:02.397

我见过这个用过。

```
if LOCAL_SQLCA^.sqlcode = 0 then
/* return serial */
  Result := LOCAL_SQLCA^.sqlerrd[1]
else
/* return error code */
  Result := -(Abs(LOCAL_SQLCA^.sqlcode)); 
```

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2008-10-29T22:27:15.503

我不认为“高效”是您在这里寻找的词。这更多的是准确性问题。我不确定我能不能比 SQL 联机丛书更好地解释它，但一般来说，除非你真的知道你在做什么并且有使用 @@IDENTITY 的特定原因，否则请使用 SCOPE_IDENTITY。最明显的原因是@@IDENTITY 不会返回您的程序/sp/etc 添加的最新记录的标识，如果有一个触发器附加到表。此外，在大容量应用程序中可能存在两个事务同时发生的问题，并且会发生以下情况......

1.  您的插入

2.  其他用户的插入

3.  将其他用户的身份返回给您

* * *

## 回答 #4

> 赞同：-5
> 
>             
> 
> 时间：2010-01-23T05:01:01.213

OP 没有指定正在使用哪个版本的 Informix，因此可能会有不同的答案

# macos - 为了从 OSX 中完全删除 MAMP 安装需要做什么？

> ID：246998
> 
>         
> 
> 赞同：25
> 
>         
> 
> 时间：2008-10-29T14:26:35.097
> 
>         
> 
> 标签：macos, mamp, server-configuration

由于我们不会讨论的原因，我已经确定 MAMP 是一堆困扰我的系统的垃圾，除非我完全删除它，否则我将生活在耻辱中。

我已经做了显而易见的事情，并从我的 Applications 文件夹中删除了 MAMP 目录，但是，我不喜欢徘徊文件，而且我有一种痒的感觉，即 MAMP 将一些 .sock 文件放在某个地方，或者在我的文件中弄得一团糟系统。

**MAMP 在安装时会将哪些文件添加到系统中，它们在哪里？**

*如果您有证据证明 MAMP 实际上并没有将文件放在任何地方（除了 /MAMP 目录），那么这就是一个很好的答案！*

* * *

## 回答 #1

> 赞同：29
> 
>             
> 
> 时间：2008-10-29T14:51:17.747

从他们的[帮助页面](http://www.mamp.info/en/help.html)：

> 要“卸载”MAMP，您只需删除 MAMP 目录，一切都会恢复到原始状态（MAMP 不会改变“正常”OS X 上的任何内容）。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2013-02-14T01:39:36.420

当您下载 MAMP 时，您还会获得 MAMP Pro 试用版。在 MAMP Pro 文件夹中，有一个“卸载程序”。当您打开卸载程序时，它会询问您是否要删除所有痕迹（首选项等）

当我使用它时，它似乎完全删除了 MAMP 和 MAMP Pro 的所有内容。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2011-11-08T12:38:10.537

MAMP 确实改变了一个系统文件：/etc/hosts（它添加了您可能在此处的“主机”选项卡下创建的任何虚拟主机）。

您可能想要删除这些条目。

为此，请转到 Finder，从菜单中选择“Go”-“Folder”，然后输入“/etc”。然后，您需要通过右键单击并选择“获取信息”并更改权限来临时更改主机文件及其所在目录的权限。

然后，您可以在 Textedit 中编辑 hosts 文件。

完成后，您应该将权限恢复到安全的状态。

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2008-10-29T14:53:08.383

AppZapper 是一个很好的工具，可以解决这个问题。在 Google 上搜索它，前 5 次使用它是免费的。

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2008-10-29T14:54:16.087

完全卸载任何应用程序。尝试安装[AppTrap。](http://onnati.net/apptrap/)+它是免费的

每次您将应用程序移至废纸篓时，AppTrap 都会在您的库中找到首选项文件并让您也删除它们。****``````**** 
```*************